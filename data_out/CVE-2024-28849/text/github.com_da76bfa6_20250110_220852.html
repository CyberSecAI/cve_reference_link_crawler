
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpsf%2Frequests%2Fissues%2F1885)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpsf%2Frequests%2Fissues%2F1885)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=psf%2Frequests)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[psf](/psf)
/
**[requests](/psf/requests)**
Public

* [Notifications](/login?return_to=%2Fpsf%2Frequests) You must be signed in to change notification settings
* [Fork
  9.3k](/login?return_to=%2Fpsf%2Frequests)
* [Star
   52.3k](/login?return_to=%2Fpsf%2Frequests)

* [Code](/psf/requests)
* [Issues
  185](/psf/requests/issues)
* [Pull requests
  78](/psf/requests/pulls)
* [Actions](/psf/requests/actions)
* [Wiki](/psf/requests/wiki)
* [Security](/psf/requests/security)
* [Insights](/psf/requests/pulse)

Additional navigation options

* [Code](/psf/requests)
* [Issues](/psf/requests/issues)
* [Pull requests](/psf/requests/pulls)
* [Actions](/psf/requests/actions)
* [Wiki](/psf/requests/wiki)
* [Security](/psf/requests/security)
* [Insights](/psf/requests/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpsf%2Frequests%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpsf%2Frequests%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Redirect can expose netrc password #1885

Closed

[eriol](/eriol) opened this issue
Jan 27, 2014
· 20 comments

Closed

# [Redirect can expose netrc password](#top) #1885

[eriol](/eriol) opened this issue
Jan 27, 2014
· 20 comments

## Comments

[![@eriol](https://avatars.githubusercontent.com/u/212279?s=80&u=243ee66dd40117d81e0cd1e07020420f86ce4578&v=4)](/eriol)

Copy link

Contributor

### **[eriol](/eriol)** commented [Jan 27, 2014](#issue-26373742)

| Hello, Jakub Wilk reported this on the Debian Bug Tracker[¹]:  ``` If site A redirects to site B, and user had a password for site A in  their ~/.netrc, then requests would send authorization information both  to site A and to site B.  ```  Jakub wrote also some tests to show the issue, you can find them attached on the Debian Bug Tracker.  I have already updated requests Debian package (it's ready for the upload) and I can confirm that the issue is present also in requests 2.2.1.  Cheers!  [¹] <http://bugs.debian.org/733108> |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Lukasa](https://avatars.githubusercontent.com/u/1382556?s=80&u=ec0626bca59533ff690c024ed92b314b1594de52&v=4)](/Lukasa)

Copy link

Member

### **[Lukasa](/Lukasa)** commented [Jan 27, 2014](#issuecomment-33401349)

| Thanks for this!  Right now we don't strip authentication information of any kind on redirects. We could, but we can't ask the user for new credentials, we can only really go to `~/. Thoughts [@sigmavirus24](https://github.com/sigmavirus24)? |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=80&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)

Copy link

Contributor

### **[sigmavirus24](/sigmavirus24)** commented [Jan 27, 2014](#issuecomment-33403996)

| [We delete any Cookies set.](https://github.com/kennethreitz/requests/blob/master/requests/sessions.py#L152) I'm not sure I see the benefit in sending the old credentials to the site we're redirected to. Is there anything in the RFC about this? I would guess it could be considered safe if we're redirecting to the same domain, but otherwise, I don't see a point in sending it along as well.  That said, we would be breaking backwards compatibility. Someone relying on this will need to do extra work. |
| --- |

All reactions

Sorry, something went wrong.

[![@Lukasa](https://avatars.githubusercontent.com/u/1382556?s=80&u=ec0626bca59533ff690c024ed92b314b1594de52&v=4)](/Lukasa)

Copy link

Member

### **[Lukasa](/Lukasa)** commented [Jan 27, 2014](#issuecomment-33404665)

| Agreed, this is backwards incompatible. I'd rather be secure(r) by default, though. Open question: do we reapply `~/.netrc` auth? |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=80&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)

Copy link

Contributor

### **[sigmavirus24](/sigmavirus24)** commented [Jan 27, 2014](#issuecomment-33404873)

| The more accurate question is: Do we `del headers['Authorization']`? |
| --- |

All reactions

Sorry, something went wrong.

[![@Lukasa](https://avatars.githubusercontent.com/u/1382556?s=80&u=ec0626bca59533ff690c024ed92b314b1594de52&v=4)](/Lukasa)

Copy link

Member

### **[Lukasa](/Lukasa)** commented [Jan 27, 2014](#issuecomment-33404985)

| Yes, absolutely yes. What about Proxy-Authorization?  **EDIT**: To be clear, we should *conditionally* delete the Authorization header, only if we're being redirected to a new host. |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=80&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)

Copy link

Contributor

### **[sigmavirus24](/sigmavirus24)** commented [Jan 27, 2014](#issuecomment-33408045)

| What about Proxy-Authorization?  Ehhhhhhhh maybe? That's a grey area. My typical mental model of a proxy is on your end so you shouldn't be concerned about redirects and shouldn't be concerned about your proxy authentication being broken on redirects.  One thing that's nice is we don't have to worry about times when authorization is specified in the URL itself (e.g., `http://user:pass@example.com`). |
| --- |

All reactions

Sorry, something went wrong.

[![@eriol](https://avatars.githubusercontent.com/u/212279?s=80&u=243ee66dd40117d81e0cd1e07020420f86ce4578&v=4)](/eriol)

Copy link

Contributor

Author

### **[eriol](/eriol)** commented [Jan 27, 2014](#issuecomment-33412999)

| EDIT: To be clear, we should conditionally delete the Authorization header, only if we're being redirected to a new host.  [@Lukasa](https://github.com/Lukasa) I agree! |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=80&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)

Copy link

Contributor

### **[sigmavirus24](/sigmavirus24)** commented [Jan 27, 2014](#issuecomment-33417792)

| To be clear, we should conditionally delete the Authorization header, only if we're being redirected to a new host.  This is going to be tricky. Some domains will not want you to keep them when redirecting to sub-domains. It's a safer thing to do than to preserve authorization for redirecting to different domains but it may still be tricky. |
| --- |

All reactions

Sorry, something went wrong.

[![@eriol](https://avatars.githubusercontent.com/u/212279?s=80&u=243ee66dd40117d81e0cd1e07020420f86ce4578&v=4)](/eriol)

Copy link

Contributor

Author

### **[eriol](/eriol)** commented [Jan 27, 2014](#issuecomment-33423693)

| Some domains will not want you to keep them when redirecting to sub-domains.  I think we should consider a sub-domain as a new host[¹]. Maybe we can check if user's .netrc has a stanza about the sub-domain when redirecting. Only if we find a stanza about the sub-domain, we send the credentials for the sub-domain we are redirected to. What do you think?  [¹] For example, think about \*.neocities.org: we can't presume if the owner of two sub-domains is the same. |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=80&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)

Copy link

Contributor

### **[sigmavirus24](/sigmavirus24)** commented [Jan 27, 2014](#issuecomment-33436124)

| Yeah I talked to some of the security guys at Bendyworks about this and they agree with you [@EriolV](https://github.com/EriolV). So a simple check of  ``` original_parsed = urlparse(respone.request.url) redirect_parsed = urlparse(url) if original_parsed.host != redirect_parsed.host:     del headers['Authorization'] ```  Have we decided about `Proxy-Authorization`? |
| --- |

All reactions

Sorry, something went wrong.

[![@Lukasa](https://avatars.githubusercontent.com/u/1382556?s=80&u=ec0626bca59533ff690c024ed92b314b1594de52&v=4)](/Lukasa)

Copy link

Member

### **[Lukasa](/Lukasa)** commented [Jan 28, 2014](#issuecomment-33460487)

| Agreed, subdomains have to be treated as new hosts.  We can be smart about proxy auth as well, I think. First thing to note is that our proxy model uses one proxy per scheme: if you don't get redirected to a different scheme you can safely keep sending `Proxy-Authorization` headers. Unfortunately, I don't think we can be smarter than that. I've considered whether we could attach the correct auth string for any proxy the user configures for the other scheme but I don't think we can: we need to know what came in on the original `Session.request()` call to be sure. |
| --- |

All reactions

Sorry, something went wrong.

[![@Lukasa](https://avatars.githubusercontent.com/u/1382556?s=40&u=ec0626bca59533ff690c024ed92b314b1594de52&v=4)](/Lukasa)
[Lukasa](/Lukasa)
mentioned this issue
[Jan 29, 2014](#ref-pullrequest-26545045)

[Repopulate ~/.netrc auth.
#1892](/psf/requests/pull/1892)
 Merged

[![@Lukasa](https://avatars.githubusercontent.com/u/1382556?s=80&u=ec0626bca59533ff690c024ed92b314b1594de52&v=4)](/Lukasa)

Copy link

Member

### **[Lukasa](/Lukasa)** commented [Jan 29, 2014](#issuecomment-33619218)

| Ok, take a look at [#1892](https://github.com/psf/requests/pull/1892) for a possible fix. |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=80&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)

Copy link

Contributor

### **[sigmavirus24](/sigmavirus24)** commented [Jan 31, 2014](#issuecomment-33762742)

| [@EriolV](https://github.com/EriolV) do you have experience with CVEs? This was reported to debian but is not a debian specific issue. This is our responsibility to report to MITRE, right? |
| --- |

All reactions

Sorry, something went wrong.

[![@eriol](https://avatars.githubusercontent.com/u/212279?s=80&u=243ee66dd40117d81e0cd1e07020420f86ce4578&v=4)](/eriol)

Copy link

Contributor

Author

### **[eriol](/eriol)** commented [Jan 31, 2014](#issuecomment-33790719)

| [@sigmavirus24](https://github.com/sigmavirus24) unfortunately I don't have experience with CVEs, but it's well described here: <http://people.redhat.com/kseifrie/CVE-OpenSource-Request-HOWTO.html>  Sending a request to oss-security@lists.openwall.com should be enough, but maybe security folks at Red Hat made a request for a CVE since they are following the issue too: <https://bugzilla.redhat.com/show_bug.cgi?id=1046626>  As you can see Endi Sukma Dewata also asked me if there are tests for the Proxy-Authorization case. I'm going to reply on Red Hat tracker asking if they already sent a request for a CVE. |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=80&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)

Copy link

Contributor

### **[sigmavirus24](/sigmavirus24)** commented [Jan 31, 2014](#issuecomment-33791215)

| Thanks for managing everything [@EriolV](https://github.com/EriolV). I'm going to guess none of you have submitted a CVE so I'm going to request one from MITRE since the CVE suggests just asking them.  FWIW, if you would like you can tell Endi that we're going to address the Proxy-Authorization case before the next release but in a separate PR probably. |
| --- |

All reactions

Sorry, something went wrong.

[![@Lukasa](https://avatars.githubusercontent.com/u/1382556?s=80&u=ec0626bca59533ff690c024ed92b314b1594de52&v=4)](/Lukasa)

Copy link

Member

### **[Lukasa](/Lukasa)** commented [Jan 31, 2014](#issuecomment-33793651)

| Ok, let's summarise the Proxy-Authorization case while we're here and talking about it.  **Problem**: Proxy-Authorization is never re-evaluated when we are redirected. This means that if we're redirected to a new proxy, or away from proxies entirely, we'll keep sending the Proxy-Authorization header. This is bad.  **Interesting Notes**: A few things.   1. In the primary Requests API, proxies are scheme-specific: that is, they apply to all requests to a given scheme. In principle this allows us to be clever and avoid doing anything unless a redirect takes us across a scheme. 2. Unfortunately, our use of proxy environment variables (and particularly the NO\_PROXY variable) breaks that limitation. 3. [Proxy configuration is not re-evaluated on redirects #1727](https://github.com/psf/requests/issues/1727) is tracking the fact that we don't re-evaluate NO\_PROXY on redirects. A fix for this is not yet made, but requires us re-evaluating our proxy configuration each time we're redirected. Since we expect proxy auth information to be in the proxy URL, we're probably able to fix both bugs in one move.   **Interim Fix**: If we need to rush a 'fix' out the door, we can start by unconditionally removing the Proxy-Authorization header in all cases on redirect. This covers all cases where we don't hit NO\_PROXY.  **Better Fix**: Comes in two parts:   1. Remove Proxy-Authorization during redirect. 2. Re-evaluate proxy environment variables, fixing up the proxy dictionary as required.   That should be all we need: the HTTPAdapter will handle regenerating the Proxy-Authorization header as needed. |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=80&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)

Copy link

Contributor

### **[sigmavirus24](/sigmavirus24)** commented [Jan 31, 2014](#issuecomment-33797962)

| I would *like* to have everything fixed in one release but if we have to. Stripping out the headers on redirect is enough for me. That at least removes the exposure and makes our users safer even if it temporarily inconveniences them. I mean it's a freaking open source library. Not having a file parsed and used to authenticate for you is the very definition of a First World Problem and for that I'm a bit unsympathetic. I'm also grumpy after a conversation on twitter, so feel free to ignore my bitterness. |
| --- |

All reactions

Sorry, something went wrong.

[![@Lukasa](https://avatars.githubusercontent.com/u/1382556?s=80&u=ec0626bca59533ff690c024ed92b314b1594de52&v=4)](/Lukasa)

Copy link

Member

### **[Lukasa](/Lukasa)** commented [Jan 31, 2014](#issuecomment-33798591)

| I'm pretty convinced re-evaluating the proxy configuration is a minor amount of work, I'll take a swing at it this weekend. |
| --- |

All reactions

Sorry, something went wrong.

[![@rassie](https://avatars.githubusercontent.com/u/23448?s=40&v=4)](/rassie)
[rassie](/rassie)
mentioned this issue
[Feb 7, 2014](#ref-issue-27131442)

[Proxy issues with requests
pypa/pip#1541](/pypa/pip/issues/1541)

Closed

[![@blueyed](https://avatars.githubusercontent.com/u/9766?s=80&v=4)](/blueyed)

Copy link

Contributor

### **[blueyed](/blueyed)** commented [Sep 12, 2014](#issuecomment-55453093)

| Is this issue done, given that re-evaluating is in place now, or is there something missing that has been discussed? (<https://github.com/kennethreitz/requests/blob/master/requests/sessions.py#L175-177>) |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=80&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)

Copy link

Contributor

### **[sigmavirus24](/sigmavirus24)** commented [Sep 12, 2014](#issuecomment-55453680)

| Good catch [@blueyed](https://github.com/blueyed). This was fixed in [v2.3.0](https://github.com/kennethreitz/requests/releases/tag/v2.3.0). |
| --- |

All reactions

Sorry, something went wrong.

[![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=40&u=cfe7ddccc58238bedb4176ff2a8dbc200c6a314d&v=4)](/sigmavirus24)
[sigmavirus24](/sigmavirus24)
closed this as [completed](/psf/requests/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Sep 12, 2014](#event-164947842)

[![@hdgarrood](https://avatars.githubusercontent.com/u/1270186?s=40&v=4)](/hdgarrood)
[hdgarrood](/hdgarrood)
mentioned this issue
[Mar 29, 2019](#ref-issue-258343907)

[Headers on redirect
snoyberg/http-client#300](/snoyberg/http-client/issues/300)

Closed

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
locked as **resolved** and limited conversation to collaborators
[Sep 8, 2021](#event-5275172537)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpsf%2Frequests%2Fissues%2F1885).

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@blueyed](https://avatars.githubusercontent.com/u/9766?s=52&v=4)](/blueyed) [![@eriol](https://avatars.githubusercontent.com/u/212279?s=52&v=4)](/eriol) [![@sigmavirus24](https://avatars.githubusercontent.com/u/240830?s=52&v=4)](/sigmavirus24) [![@Lukasa](https://avatars.githubusercontent.com/u/1382556?s=52&v=4)](/Lukasa)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

