The provided content relates to CVE-2024-26975.

**Root cause of vulnerability:**
A NULL pointer dereference occurs when probing the MMIO RAPL driver on platforms with CPU IDs not listed in the `intel_rapl_common` CPU model list. This happens because the `intel_rapl_common` module probes on such platforms even if `defaults_msr` is not set. Consequently, `rp->priv->defaults` becomes NULL when registering with the RAPL framework.

**Weaknesses/vulnerabilities present:**
- NULL pointer dereference.
- Lack of proper validation of `rp->priv->defaults` before accessing it.

**Impact of exploitation:**
- The vulnerability leads to a kernel crash due to a NULL pointer dereference.

**Attack vectors:**
- The vulnerability is triggered during the probe of the MMIO RAPL driver.
- It occurs when the system boots on a platform with a CPU ID that is not in the `intel_rapl_common` CPU model list and the `defaults_msr` is not set.

**Required attacker capabilities/position:**
- The attacker does not need specific capabilities other than the ability to boot a system with a non-supported CPU. This can be achieved by running the vulnerable kernel on specific hardware.

**Fix:**
The fix adds a sanity check to ensure that `rp->priv->defaults` and `rp->priv->rpi` are always valid before proceeding, returning `-ENODEV` if either is NULL.
```c
 if (!rp->priv->defaults || !rp->priv->rpi)
  return -ENODEV;
```