=== Content from www.splunk.com_c941538b_20250108_142630.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Information disclosure via the dashboard drilldown in Splunk Enterprise

**Advisory ID:** SVD-2022-0802

**CVE ID:** [CVE-2022-37438](https://www.cve.org/CVERecord?id=CVE-2022-37438)

**Published:** 2022-08-16

**Last Update:** 2022-08-16

**CVSSv3.1 Score:** 2.6, Low

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N)

**CWE:** [CWE-200](https://cwe.mitre.org/data/definitions/200.html)

**Bug ID:** SPL-221531

## Description

In Splunk Enterprise versions in the following table, an authenticated user can craft a dashboard that could potentially leak information (for example, username, email, and real name) about Splunk users, when visited by another user through the drilldown component. The vulnerability requires user access to create and share dashboards using Splunk Web.

## Solution

For Splunk Enterprise, upgrade versions to 8.1.11, 8.2.7.1, 9.0.1, or higher.

For Splunk Cloud Platform customers, Splunk is actively patching and monitoring Splunk Cloud instances.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 8.1 | Splunk Web | 8.1.10 and lower | 8.1.11 |
| Splunk Enterprise | 8.2 | Splunk Web | 8.2.0 to 8.2.7 | 8.2.7.1 |
| Splunk Enterprise | 9.0 | Splunk Web | 9.0.0 | 9.0.1 |
| Splunk Cloud Platform |  | Splunk Web | 8.2.2203.4 and lower | 9.0.2205 |

## Mitigations and Workarounds

You can mitigate this vulnerability by [configuring permissions for dashboards](https://docs.splunk.com/Documentation/Splunk/latest/Viz/DashboardPermissions#Configure_dashboard_permissions) and the knowledge objects that drive them.

## Detections

* [Splunk account discovery drilldown dashboard disclosure](https://research.splunk.com/application/f844c3f6-fd99-43a2-ba24-93e35fe84be6/)

This search uses REST functionality to query for dashboards with environment variables present in URL options that could potentially leak information about Splunk users. If an analyst sees results from this search we suggest investigating to determine if the disclosure of these environmental variables was intended.

## Severity

Splunk rates the severity as Low, 2.6 with the vector [CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:N). If the Splunk Enterprise instance [disabled Splunk Web](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents), it is not impacted and the vulnerability is informational.

## Acknowledgments

Eric LaMothe at Splunk

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)

=== Content from research.splunk.com_816566c5_20250108_142629.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk Account Discovery Drilldown Dashboard Disclosure

**EXPERIMENTAL DETECTION**

This detection status is set to experimental. The Splunk Threat Research team has not yet fully tested, simulated, or built comprehensive datasets for this detection. As such, this analytic is not officially supported. If you have any questions or concerns, please reach out to us at research@splunk.com.

Updated Date: 2024-10-17
ID: f844c3f6-fd99-43a2-ba24-93e35fe84be6
Author: Marissa Bower, Rod Soto, Splunk
[Type: TTP](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

The following analytic identifies the presence of environment variables in Splunk dashboard drilldown URLs. It uses the REST API to query dashboards for specific patterns in the XML data. This activity is significant because it can expose sensitive tokens from privileged users if an attacker shares a malicious dashboard. If confirmed malicious, this could allow an attacker to detokenize variables and potentially gain unauthorized access to sensitive information or escalate privileges within the Splunk environment.

### Search

```
1
2| rest splunk_server=local /servicesNS/-/-/data/ui/views
3| search eai:data="*$env:*" eai:data="*url*" eai:data="*options*"
4| rename author AS Author eai:acl.sharing AS Permissions eai:appName AS App eai:data AS "Dashboard XML"
5| fields Author Permissions App "Dashboard XML"
6| `splunk_account_discovery_drilldown_dashboard_disclosure_filter`

```
### Data Source

No data sources specified for this detection.

### Macros Used

| Name | Value |
| --- | --- |

| splunk\_account\_discovery\_drilldown\_dashboard\_disclosure\_filter | `search *` |

`splunk_account_discovery_drilldown_dashboard_disclosure_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1087](https://attack.mitre.org/techniques/T1087/) | Account Discovery | Discovery |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_CM

Cis18Value.CIS\_10

Aquatic Panda
FIN13

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Notable | Yes |
| Rule Title | `%name%` |
| Rule Description | `%description%` |
| Notable Event Fields | user, dest |
| Creates Risk Event | True |

This configuration file applies to all detections of type TTP. These detections will use Risk Based Alerting and generate Notable Events.
### Implementation

This search uses REST function to query for dashboards with environment variables present in URL options.

### Known False Positives

This search may reveal non malicious URLs with environment variables used in organizations.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Potential exposure of environment variables from url embedded in dashboard | 40 | 50 | 80 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://www.splunk.com/en_us/product-security.html>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | Not Applicable | N/A | N/A | N/A |
| Unit | â Failing | N/A | `N/A` | `N/A` |
| Integration | â Failing | N/A | `N/A` | `N/A` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_account_discovery_drilldown_dashboard_disclosure.yml) |
Version: **3**

[Detection: Splunk Absolute Path Traversal Using runshellscript](https://research.splunk.com/application/356bd3fe-f59b-4f64-baa1-51495411b7ad/ "Detection: Splunk Absolute Path Traversal Using runshellscript")

[Detection: Splunk App for Lookup File Editing RCE via User XSLT](https://research.splunk.com/application/a053e6a6-2146-483a-9798-2d43652f3299/ "Detection: Splunk App for Lookup File Editing RCE via User XSLT")

Â© 2005 - 2024 Splunk LLC All rights reserved.


