Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-27104

**Vulnerability:** Stored Cross-Site Scripting (XSS)

**Root Cause:** The vulnerability stems from the improper handling of user-supplied markdown content when creating and displaying dashboards within the GLPI application. Specifically, the `markdown` function in `src/Dashboard/Widget.php` was vulnerable to XSS. It appears the code was using `{$md->transform($p['markdown_content'])}` which was not sanitized before rendering in a dashboard.

**Weaknesses:**
*   **Inadequate Input Sanitization:** The application fails to properly sanitize user-provided markdown content before displaying it on dashboards.
*   **Lack of Output Encoding:** The output is not encoded to prevent the execution of embedded JavaScript.

**Impact of Exploitation:**
*   **Arbitrary JavaScript Execution:** A malicious user with the ability to create or edit dashboards can inject arbitrary JavaScript code into a dashboard.
*   **User Session Hijacking:** When another user views the compromised dashboard, the malicious JavaScript can execute in their browser, potentially leading to session hijacking, data theft, or other malicious actions.

**Attack Vectors:**
*   **Network:** The attack is network-based.
*   **Dashboard Creation/Modification:** An attacker leverages the ability to create or modify dashboards within the GLPI application.

**Required Attacker Capabilities/Position:**
*   **High Privileges:** The attacker needs to have "rights to create and share dashboards" within the GLPI application.
*   **User Interaction:**  The attack requires other users to view the compromised dashboard for the XSS payload to execute.

**Additional Details:**

*   The vulnerable code was located in `src/Dashboard/Widget.php`.
*   The vulnerability affects GLPI versions 9.5.0 and later.
*   The patch was implemented in version 10.0.13 by adding an additional sanitized HTML output `{$content}` using `RichText::getSafeHtml` alongside the unsanitized one. The unsanitized line was then removed.
*   The issue was assigned a "Moderate" severity.
*   The CVSS v3 score is 4.5, with the base metrics as AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N

This content provides more detail than the standard CVE description by specifying the vulnerable code location, the method of sanitization used in the patch, and the affected/patched versions.