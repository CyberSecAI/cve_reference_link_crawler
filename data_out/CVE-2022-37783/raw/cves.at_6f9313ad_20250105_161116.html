<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="Affected Product: Craft CMS
Affected Versions: 3.0.0 – 3.7.32
Fixed Version: &amp;gt;=3.7.33
CVE-Number: CVE-2022-37783
Severity: High - 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)
Discovered by Ing. Simon Schönegger, BSc, MSc (Office Graz), Harald Schmal, BSc (Office Vienna)
During a penetration test for a customer, researchers of TÜV Trust IT Austria were able to discover that Craft CMS discloses the users’ password hashes in CSRF-Cookies and CSRF-Tokens. The initial disclosure to the vendor was performed by the customer and the vulnerability was fixed in 3."><meta name=keywords content=",informationdisclosure,craftcms,password,hashing"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://trustcves.github.io/posts/cve-2022-37783/writeup/><title>Disclosure of password hashes in Craft CMS - CVE-2022-37783 :: Vulnerability Disclosure
</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Disclosure of password hashes in Craft CMS - CVE-2022-37783"><meta itemprop=description content="Affected Product: Craft CMS
Affected Versions: 3.0.0 – 3.7.32
Fixed Version: >=3.7.33
CVE-Number: CVE-2022-37783
Severity: High - 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)
Discovered by Ing. Simon Schönegger, BSc, MSc (Office Graz), Harald Schmal, BSc (Office Vienna)
During a penetration test for a customer, researchers of TÜV Trust IT Austria were able to discover that Craft CMS discloses the users’ password hashes in CSRF-Cookies and CSRF-Tokens. The initial disclosure to the vendor was performed by the customer and the vulnerability was fixed in 3."><meta itemprop=datePublished content="2022-12-06T12:16:50+00:00"><meta itemprop=dateModified content="2022-12-06T12:16:50+00:00"><meta itemprop=wordCount content="473"><meta itemprop=keywords content="informationdisclosure,craftcms,password,hashing,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Disclosure of password hashes in Craft CMS - CVE-2022-37783"><meta name=twitter:description content="Affected Product: Craft CMS
Affected Versions: 3.0.0 – 3.7.32
Fixed Version: >=3.7.33
CVE-Number: CVE-2022-37783
Severity: High - 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)
Discovered by Ing. Simon Schönegger, BSc, MSc (Office Graz), Harald Schmal, BSc (Office Vienna)
During a penetration test for a customer, researchers of TÜV Trust IT Austria were able to discover that Craft CMS discloses the users’ password hashes in CSRF-Cookies and CSRF-Tokens. The initial disclosure to the vendor was performed by the customer and the vulnerability was fixed in 3."><meta property="article:published_time" content="2022-12-06 12:16:50 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>Vulnerability Disclosure</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About</a></li><li><a href=/posts>CVEs</a></li><li><a href=/howto>How To</a></li><li><a href=/imprint>Imprint</a></li><li><a href=/license>Licenses</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
3 minutes</p></div><article><h1 class=post-title><a href=https://trustcves.github.io/posts/cve-2022-37783/writeup/>Disclosure of password hashes in Craft CMS - CVE-2022-37783</a></h1><div class=post-content><p><strong>Affected Product:</strong> Craft CMS<br><strong>Affected Versions:</strong> 3.0.0 – 3.7.32<br><strong>Fixed Version:</strong> >=3.7.33<br><strong>CVE-Number:</strong> CVE-2022-37783<br><strong>Severity:</strong> High - 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)</p><p><em>Discovered by Ing. Simon Schönegger, BSc, MSc (Office Graz), Harald Schmal, BSc (Office Vienna)</em></p><p>During a penetration test for a customer, researchers of TÜV Trust IT Austria were able to discover that Craft CMS discloses the users’ password hashes in CSRF-Cookies and CSRF-Tokens. The initial disclosure to the vendor was performed by the customer and the vulnerability was fixed in 3.7.33. However, all older versions of Craft CMS are still affected by this vulnerability and no security advisory was published by the vendor. Therefore, TÜV Austria decided to contact the vendor again with the goal of providing a security advisory and performing responsible disclosure. As of 5th of July 2022 the vendor integrated a message in the affected versions of Craft CMS urging the users to update to at least version 3.7.33. The public disclosure of the vulnerability was scheduled for 4th of August 2022.</p><h2 id=anatomy-of-the-vulnerability>Anatomy of the vulnerability</h2><p>Craft CMS disclosed the password hashes of all users who log into the system using E-Mail or username. Users utilizing SAML-Login are not affected by this vulnerability. The Craft-CSRF Cookie contained the password hash URL-Encoded.</p><p><img src=../images/console.png alt>
<img src=../images/decoded.png alt>
<img src=../images/realHash.png alt></p><p>The password is hashed using bcrypt which is a slow hash to crack. The disclosure of the password hash is caused by bad coding practices by mixing the users hashed password into the CSRF-Token.</p><p>Since the cookie attribute “HTTP-Only” is set per default the cookie may not be exfiltrated using an XSS attack.</p><p>However, the password hash is also included in the Craft-CSRF-Token contained in the HTML of the page. In this case the hash is not URL-Encoded, it is masked by an out of the box function of the YII-Framework. The masking of the token can be undone by minor changes to the unmasking function publicly available in the YII-Framework. Since the CSRF-Token is present in HTML an attacker can exfiltrate it using a XSS attack.</p><h2 id=vendor-contact-timeline>Vendor contact timeline</h2><table><thead><tr><th>Date</th><th>Action</th></tr></thead><tbody><tr><td>2022-01</td><td>Initial contact by the customer</td></tr><tr><td>2022-02</td><td>Fix by the vendor – no security advisory published</td></tr><tr><td>2022-06-29</td><td>Initial contact by TÜV Austria through the vendors contact form</td></tr><tr><td>2022-06-30</td><td>Response from the vendor</td></tr><tr><td>2022-06-30</td><td>TÜV Austria shares a report on this vulnerability and its impact with the vendor</td></tr><tr><td>2022-07-02</td><td>Response from the vendor that this vulnerability has already been fixed and only affects older versions</td></tr><tr><td>2022-07-03</td><td>TÜV Austria responds that all versions of the past 4 years are affected by this vulnerability and schedules 4th of August for public disclosure</td></tr><tr><td>2022-07-06</td><td>Vendor responds that release 3.7.33 is now marked as critical and users are encouraged to update to at least this version. Vendor agrees on a public disclosure on August 4th 2022</td></tr><tr><td>2022-08-04</td><td>Vulnerability is reported to a CNA</td></tr><tr><td>2022-09-13</td><td>CVE-2022-37783 is allocated for this vulnerability by the CNA</td></tr></tbody></table></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://trustcves.github.io/tags/informationdisclosure/>informationdisclosure</a></span>
<span class=tag><a href=https://trustcves.github.io/tags/craftcms/>craftcms</a></span>
<span class=tag><a href=https://trustcves.github.io/tags/password/>password</a></span>
<span class=tag><a href=https://trustcves.github.io/tags/hashing/>hashing</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
473 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2022-12-06 12:16</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://trustcves.github.io/posts/cve-2023-25263/writeup/><span class=button__icon>←</span>
<span class=button__text>Usage of static secrets in Stimulsoft Designer - CVE-2023-25263</span></a></span></div></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.b1dc444a7108174ae3d2294f982be5e99e844ae2b8d58eeea19d929bde0338be4d12ed8a4dfc67194dcc6726fa6a82705119c0d7e4edd4de9294be6535ea7b7f.js integrity="sha512-sdxESnEIF0rj0ilPmCvl6Z6ESuK41Y7uoZ2Sm94DOL5NEu2KTfxnGU3MZyb6aoJwURnA1+Tt1N6SlL5lNep7fw=="></script></body></html>