Akerva – Security advisory – Dolibarr – Cross-Site Scripting
(Authenticated) CVE-2023-38888

SECURITY ADVISORY

Dolibarr

Cross-Site Scripting
(Authenticated)

BELABED Skander

26/05/2023

CVE-2023-38888

RENNES – PARIS

Siège social - 37 Boulevard Solférino - 35000 RENNES

Tel +33(0)1 53 76 86 35  |  E-mail contact@akerva.com

26/05/2023

1

Akerva – Security advisory – Dolibarr – Cross-Site Scripting
(Authenticated) CVE-2023-38888

Table of contents

SUMMARY .......................................................................................................................................................................................... 3
Context .................................................................................................................................................................. 3
Description .......................................................................................................................................................... 3
Products and versions affected ............................................................................................................. 3
Impact .................................................................................................................................................................... 3
Mitigations ........................................................................................................................................................... 3
Disclosure timeline ........................................................................................................................................ 3
TECHNICAL DETAILS .......................................................................................................................................................................4
Vulnerability Details ...................................................................................................................................... 4
Proof of Concept (PoC) ................................................................................................................................ 5
Risk Characterization .................................................................................................................................... 6
References ........................................................................................................................................................... 6
ABOUT AKERVA ............................................................................................................................................................................... 7
Who are we? ...................................................................................................................................................... 7
Join us .................................................................................................................................................................... 7
Contact .................................................................................................................................................................. 7

26/05/2023

2

Akerva – Security advisory – Dolibarr – Cross-Site Scripting
(Authenticated) CVE-2023-38888

SUMMARY
Context

Product description:

Dolibarr ERP CRM is an open source, free software package for companies of any
size, foundations or freelancers. It includes different features for enterprise resource
planning (ERP) and customer relationship management (CRM) but also other
features for different activities.

Description

The user inputs submitted over the API are not controlled, giving the possibility to inject
malicious data and perform “Cross-Site Scripting”.

Products and versions affected

Affected products:

•  Dolibarr 17.0.1 and earlier

Impact

Any user having access to the API and the permission of writing or editing any object can
inject HTML or JavaScript content that can be executed in the browser of the other users.

Mitigations

Upgrade to the latest version of the product.

Disclosure timeline

EVENT

Initial discovery.

Initial contact with security@dolibarr.org

Vulnerability acknowledged by Dolibarr’s team

Fix published by Dolibarr’s team

Public disclosure

DATE

26/05/2023

07/07/2023

21/07/2023

18/08/2023

18/09/2023

26/05/2023

3

Akerva – Security advisory – Dolibarr – Cross-Site Scripting
(Authenticated) CVE-2023-38888

TECHNICAL DETAILS

Vulnerability Details

One of the defense mechanisms used by Dolibarr against “Cross-Site Scripting” (XSS)
attacks is to pass each user input submitted over the interface to a control function
present in htdocs/main.inc.php following this workflow:

1.  Passing POST values to analyseVarsForSqlAndScriptsInjection function if the “scan

POST data” option is enabled.

FIGURE 1: SANITY CHECK ON POST DATA (HTDOCS/MAIN.INC.PHP).

2.  Extracting each variable of the array and pass it to testSqlAndScriptInject function.

FIGURE 2: TESTSQLANDSCRIPTINJECT FUNCTION PRESENT IN HTDOCS/MAIN.INC.PHP.

This last function (testSqlAndScriptInject) performs multiple checks as: decoding strings in
order to prevent some forms of bypass or comparing strings to a tag/event handlers
blacklist.

26/05/2023

4

Akerva – Security advisory – Dolibarr – Cross-Site Scripting
(Authenticated) CVE-2023-38888

FIGURE 3: DECODING PHASE IN TESTSQLANDSCRIPTINJECT FUNCTION.

FIGURE 4: BLACKLIST COMPARISON PHASE IN TESTSQLANDSCRIPTINJECT.

But in case of an API call (POST/PUT) the data is not correctly parsed / controlled, and as a
result, it is possible to inject malicious data.

Proof of Concept (PoC)

Let’s assume that the REST API module is enabled in Dolibarr and we have an account
which has the permission of creating/editing any object type (in our case our user has the
permission to create third parties). We just need to get the API key linked to our account
and send an authenticated API request containing our malicious code in one of the body
fields:

26/05/2023

5

Akerva – Security advisory – Dolibarr – Cross-Site Scripting
(Authenticated) CVE-2023-38888

FIGURE 5: XSS EXPLOITATION STEPS.

Risk Characterization

FIGURE 6: CVSS SCORING.

CVSS v3.1 – Base Score
Network (N)
Attack Vector (AV)
Low (L)
Attack Complexity (AC)
Privileges Required (PR)  Low (L)
User Interaction (UI)
CVSS v3.1 – Temporal Score
Exploit Code Maturity
(E)
Remediation Level (RL)
Report Confidence (RC)

None (N)

High (H)

Not Defined (X)
Confirmed (C)

Scope (S)
Confidentiality (C)
Integrity (I)
Availability (A)

Changed (C)
Low (L)
Low (L)
None (N)

References

▪  Dolibarr, Wikipedia

https://www.citethisforme.com/cite/sources/websiteautociteeval

26/05/2023

6

Akerva – Security advisory – Dolibarr – Cross-Site Scripting
(Authenticated) CVE-2023-38888

ABOUT AKERVA

Who are we?

Founded  in  2013,  Akerva  is  a  consulting  firm  specialized  in  CyberSecurity  and  Risk
Management. Our Offensive Technology team (OffTech) work for our customers to provide
them with security assessments through offensive and technical audits in order to identify
credible real world compromission scenarios and business risk. Missions such as application
or network penetration testing, red team engagements or phishing and social engineering
campaigns are complemented by R&D and vulnerability research in our dedicated lab to
maintain the highest technical proficiency for our team.

Join us

Want to be part of the adventure? Join our team of experts by sending your application:
https://akerva.com/jobs/

Contact

▪  Website: https://akerva.com

▪  Blog: https://akerva.com/blog/

▪  Email: contact@akerva.com

▪  LinkedIn: https://fr.linkedin.com/company/akerva

▪  Twitter: https://twitter.com/Akerva_FR

26/05/2023

7

