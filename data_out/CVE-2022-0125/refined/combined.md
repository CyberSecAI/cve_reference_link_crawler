=== Content from gitlab.com_eb905a6e_20250108_122633.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Users can import members from projects that they are not a maintainer on through API

**[HackerOne report #1356100](https://hackerone.com/reports/1356100)** by `joaxcar` on 2021-10-01, assigned to GitLab Team:

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Security patch 14.3.1 fixed ([link to patch notes](https://about.gitlab.com/releases/2021/09/30/security-release-gitlab-14-3-1-released/#low-privileged-users-can-import-users-from-projects-that-they-they-are-not-a-maintainer-on) and [link to commit](https://gitlab.com/gitlab-org/gitlab/-/commit/63ba9ad2a1067eb74df493e273707bb64a13a197 "Fix permissions check on project members import")) an issue where a maintainer in one project could import members from another project while not being a maintainer in that target project. This is now enforced in the GitLab UI and any requests putting the target project as a project where the user is not maintainer will fail.

This check is not enforced if the same user uses the API endpoint `/projects/:id/import_project_members/:project_id` [documentation](https://docs.gitlab.com/ee/api/projects.html#import-project-members). As long as the user have maintainer access to the project with id `:id` the users can import members from any target `:project_id` as long as it is visible for the user. That is all public projects and any private project where the user have a role `Guest` or higher.

##### Steps to reproduce

1. Create a two users `user1` and `user2`
2. Log in as `user1` and create a public project `project1` in the users namespace `user1`
3. Make a note of the project ID, we call it `ID1`
4. Log in as `user2` and create a private project `project2`
5. Make a note of the project ID, we call it `ID2`
6. Go to <https://gitlab.com/-/profile/personal_access_tokens> and create an access token for `user2`, lets call it `TOKEN1`
7. Send this request in a terminal (replacing , and )
   ```
   curl --request POST --header "PRIVATE-TOKEN: <TOKEN1>" "https://gitlab.com/api/v4/projects/<ID2>/import_project_members/<ID1>"
   ```
8. Go to <https://gitlab.com/user2/project2/-/project_members> and verify that `user1` is imported from the public project where `user2` is not a member

##### Impact

Importing members is supposed to be an action that is restricted to users who are maintainers on both target projects. The API allows users to bypass this restriction.

##### What is the current *bug* behavior?

The API endpoint does not validate the role of the requester as the UI does

##### What is the expected *correct* behavior?

The API should work as the functionality in the UI

##### Output of checks

This bug happens on GitLab.com

#### Impact

Importing members is supposed to be an action that is restricted to users who are maintainers on both target projects. The API allows users to bypass this restriction.

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_e242e937_20250108_122632.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-0125.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-0125.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-0125.json)
[Permalink](/gitlab-org/cves/-/blob/c6a6f86828227186d5080abce4d5f88d42571ec9/2022/CVE-2022-0125.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Jan 16, 2022

  [b72784be](/gitlab-org/cves/-/commit/b72784be547417f03c652acb87738af14dac99ed)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b72784be547417f03c652acb87738af14dac99ed)
  繚
  b72784be

  [ GitLab Bot ](/gitlab-bot) authored Jan 16, 2022

  b72784be

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b72784be547417f03c652acb87738af14dac99ed)
  [ GitLab Bot ](/gitlab-bot) authored Jan 16, 2022

Loading


