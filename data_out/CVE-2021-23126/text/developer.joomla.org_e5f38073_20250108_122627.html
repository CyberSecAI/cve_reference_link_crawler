

* Joomla!®
  + About us
  + [Joomla Home](https://www.joomla.org)
  + [What is Joomla?](https://www.joomla.org/about-joomla.html)
  + [Benefits & Features](https://www.joomla.org/core-features.html)
  + [Project & Leadership](https://www.joomla.org/about-joomla/the-project.html)
  + [Trademark & Licensing](https://tm.joomla.org)
  + [The Joomla Foundation](https://joomlafoundation.org)
  + Support us
  + [Contribute](https://www.joomla.org/contribute-to-joomla.html)
  + [Sponsor](https://www.joomla.org/sponsor.html)
  + [Partner](https://www.joomla.org/about-joomla/partners.html)
  + [Shop](https://shop.joomla.org)
* Download & Extend
  + [Downloads](https://downloads.joomla.org)
  + [Extensions](https://extensions.joomla.org)
  + [Languages](https://community.joomla.org/translations.html)
  + [Get a free site](https://launch.joomla.org)
  + [Get a domain](https://domains.joomla.org)
* Discover & Learn
  + [Documentation](https://docs.joomla.org)
  + [Training](https://community.joomla.org/joomla-training.html)
  + [Certification](https://certification.joomla.org)
  + [Site Showcase](https://showcase.joomla.org)
  + [Announcements](https://www.joomla.org/announcements.html)
  + [Blogs](https://community.joomla.org/blogs.html)
  + [Magazine](https://magazine.joomla.org)
* Community & Support
  + [Community Portal](https://community.joomla.org)
  + [Events](https://community.joomla.org/events.html)
  + [User Groups](https://community.joomla.org/user-groups.html)
  + [Forum](https://forum.joomla.org)
  + [Service Providers Directory](https://community.joomla.org/service-providers-directory.html)
  + [Volunteers Portal](https://volunteers.joomla.org)
  + [Vulnerable Extensions List](https://extensions.joomla.org/vulnerable-extensions/vulnerable/)
* Developer Resources
  + [Developer Network](https://developer.joomla.org)
  + [Security Centre](https://developer.joomla.org/security.html)
  + [Issue Tracker](https://issues.joomla.org)
  + [GitHub](https://github.com/joomla)
  + [API Documentation](https://api.joomla.org)
  + [Joomla! Framework](https://framework.joomla.org)

Search

# [Joomla! Developer Network™](/)

[Download](https://downloads.joomla.org/)

[Launch](https://launch.joomla.org)

* [Home](/)
* [News](/news.html)
* [Project Roadmap](/roadmap.html)
* [CMS](/cms.html)
* [Framework](/framework.html)
* [Tracker](/tracker.html)
* [About](/about.html)
* [Security](/security.html)

# Security Announcements

## [20210301] - Core - Insecure randomness within 2FA secret generation

* **Project:** Joomla!
* **SubProject:** CMS
* **Impact:** Low
* **Severity:** Low
* **Versions:** 3.2.0 - 3.9.24
* **Exploit type:** Insecure Randomness
* **Reported Date:** 2021-01-12
* **Fixed Date:** 2021-03-02
* **CVE Number:** [CVE-2021-23126](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23126), [CVE-2021-23127](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23127)

### Description

Usage of the insecure rand() function within the process of generating the 2FA secret.
Usage of an insufficient length for the 2FA secret accoring to RFC 4226 of 10 bytes vs 20 bytes.

Additional details as well as a more contexts for exising sites can be found in the docs: [https://docs.joomla.org/J3.x:Changes\_to\_the\_2FA\_token\_generation\_recommendations\_for\_existing\_sites](https://docs.joomla.org/J3.x%3AChanges_to_the_2FA_token_generation_recommendations_for_existing_sites)

This issue has been coordinated with Akeeba Ltd as contributor of the original FOF codebase to the core.

### Affected Installs

Joomla! CMS versions 3.2.0 - 3.9.24

### Solution

Upgrade to version 3.9.25

### Contact

The JSST at the [Joomla! Security Centre](/security-centre.html "Contact the JSST").

**Reported By:** Hanno Böck
[Previous article: [20210305] - Core - Input validation within the template manager
 Prev](/security-centre/845-20210305-core-input-validation-within-the-template-manager.html)
[Next article: [20210302] - Core - Potential Insecure FOFEncryptRandval
Next](/security-centre/842-20210302-core-potential-insecure-fofencryptrandval.html)

1. You are here:
2. [Home](/)
3. [Security Announcements](/security-centre.html)
4. [20210301] - Core - Insecure randomness within 2FA secret generation

### Joomla! CMS

* [Current Release ![Joomla! CMS 3](/images/joomla-logo.png)](https://downloads.joomla.org/latest)
* [View known Issues](https://issues.joomla.org)
* [Development Status](https://github.com/joomla/joomla-cms#build-status)
* [Download Nightly builds](/nightly-builds.html)

### Joomla! Framework

* [Current Release ![Joomla! Framework Logo](/images/joomla-framework.png) 2**.x**](https://framework.joomla.org)
* [Development Status](https://framework.joomla.org/status)

### Resources

* [Development Strategy](/development-strategy.html)
* [Security Announcements](/security-centre.html)
* [Report Security Issues](/security/contact-the-team.html)
* [Usage Statistics](/about/stats.html)
* [Statistics API Documentation](/about/stats/api.html)
* [Joomla! API Documentation](https://api.joomla.org)
* [Coding Standards Manual](/coding-standards.html)
* [JoomlaCode Archive](/joomlacode-archive.html)

### Mailing Lists

* [Developer Network Newsletter](https://community.joomla.org/joomla-developer-network-newsletter.html)
* [General Extensions Mailing](https://groups.google.com/group/joomla-dev-general)
* [CMS Mailing](https://groups.google.com/group/joomla-dev-cms)
* [Framework Mailing](https://groups.google.com/group/joomla-dev-framework)
* [Documentation Mailing](https://groups.google.com/group/joomla-docs)

---

* [Joomla! on Twitter](https://twitter.com/joomla "Joomla! on Twitter")
* [Joomla! on Facebook](https://www.facebook.com/joomla "Joomla! on Facebook")
* [Joomla! on YouTube](https://www.youtube.com/user/joomla "Joomla! on YouTube")
* [Joomla! on LinkedIn](https://www.linkedin.com/company/joomla "Joomla! on LinkedIn")
* [Joomla! on Pinterest](https://www.pinterest.com/joomla "Joomla! on Pinterest")
* [Joomla! on Instagram](https://www.instagram.com/joomlaofficial/ "Joomla! on Instagram")
* [Joomla! on GitHub](https://github.com/joomla "Joomla! on GitHub")

* [Home](https://www.joomla.org)
* [About](https://www.joomla.org/about-joomla.html)
* [Community](https://community.joomla.org)
* [Forum](https://forum.joomla.org)
* [Extensions](https://extensions.joomla.org)
* [Services](https://community.joomla.org/service-providers-directory.html)
* [Docs](https://docs.joomla.org)
* [Developer](https://developer.joomla.org)
* [Shop](https://community.joomla.org/the-joomla-shop.html)

* [Accessibility Statement](https://www.joomla.org/accessibility-statement.html)
* [Privacy Policy](https://www.joomla.org/privacy-policy.html)
* [Cookie Policy](https://www.joomla.org/cookie-policy.html)
* [Sponsor Joomla! with $5](https://community.joomla.org/sponsorship-campaigns.html)
* [Help Translate](https://joomla.crowdin.com)
* [Report an Issue](https://github.com/joomla/joomla-websites/issues/new?title=[jdev]%20&body=Please%20describe%20the%20problem%20or%20your%20issue)
* [Log in](/component/content/article/841-20210301-core-insecure-randomness-within-2fa-secret-generation.html?layout=blog&Itemid=&catid=13)

© 2005 - 2025 [Open Source Matters, Inc.](https://opensourcematters.org) All Rights Reserved.

[![Rochen](https://cdn.joomla.org/rochen/rochen_footer_logo_white.svg)](https://www.rochen.com/joomla-hosting)
[Joomla! Hosting by Rochen](https://www.rochen.com/joomla-hosting)

Close

We have detected that you are using an ad blocker. The Joomla! Project relies on revenue from these advertisements so please consider disabling the ad blocker for this domain.

