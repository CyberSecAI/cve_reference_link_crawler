
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsyoyo%2Ftinygltf%2Fissues%2F368)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsyoyo%2Ftinygltf%2Fissues%2F368)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=syoyo%2Ftinygltf)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[syoyo](/syoyo)
/
**[tinygltf](/syoyo/tinygltf)**
Public

* [Notifications](/login?return_to=%2Fsyoyo%2Ftinygltf) You must be signed in to change notification settings
* [Fork
  427](/login?return_to=%2Fsyoyo%2Ftinygltf)
* [Star
   2.1k](/login?return_to=%2Fsyoyo%2Ftinygltf)

* [Code](/syoyo/tinygltf)
* [Issues
  32](/syoyo/tinygltf/issues)
* [Pull requests
  7](/syoyo/tinygltf/pulls)
* [Actions](/syoyo/tinygltf/actions)
* [Projects
  0](/syoyo/tinygltf/projects)
* [Wiki](/syoyo/tinygltf/wiki)
* [Security](/syoyo/tinygltf/security)
* [Insights](/syoyo/tinygltf/pulse)

Additional navigation options

* [Code](/syoyo/tinygltf)
* [Issues](/syoyo/tinygltf/issues)
* [Pull requests](/syoyo/tinygltf/pulls)
* [Actions](/syoyo/tinygltf/actions)
* [Projects](/syoyo/tinygltf/projects)
* [Wiki](/syoyo/tinygltf/wiki)
* [Security](/syoyo/tinygltf/security)
* [Insights](/syoyo/tinygltf/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsyoyo%2Ftinygltf%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsyoyo%2Ftinygltf%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Command injection via wordexp call. #368

Closed

[oliverchang](/oliverchang) opened this issue
Aug 16, 2022
· 6 comments

Closed

# [Command injection via wordexp call.](#top) #368

[oliverchang](/oliverchang) opened this issue
Aug 16, 2022
· 6 comments

Labels
[enhancement](/syoyo/tinygltf/labels/enhancement)

## Comments

[![@oliverchang](https://avatars.githubusercontent.com/u/759062?s=80&u=55560dc2acb584fa51ee6a33dfa46197569770f2&v=4)](/oliverchang)

Copy link

### **[oliverchang](/oliverchang)** commented [Aug 16, 2022](#issue-1339900556)

| **Describe the issue**  This is a security vulnerability. The `wordexp` call here allows arbitrary code execution   [tinygltf/tiny\_gltf.h](https://github.com/syoyo/tinygltf/blob/0fa56e239c77cc864dc248842e8887d985cf8e3f/tiny_gltf.h#L2640)  Line 2640 in [0fa56e2](/syoyo/tinygltf/commit/0fa56e239c77cc864dc248842e8887d985cf8e3f)   |  | int ret = wordexp(quoted\_path.c\_str(), &p, 0); | | --- | --- |    when parsing a gltf file.   **To Reproduce**   * OS: Linux * Compiler, compiler version, compile options: Clang 13.0.1-6  ``` $ git clone https://github.com/syoyo/tinygltf $ cd tinygltf && make all $ echo '{"images":[{"uri":"a`echo iamhere > poc`"}], "asset":{"version":""}}' > payload.gltf $ ./loader_example payload.gltf $ cat poc iamhere ```  **Expected behaviour** The `echo iamhere > poc` command should not be executed and the `poc` file is not created in the CWD.  **Additional context** This was found by OSS-Fuzz: <https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=49053>  One potential fix here is to pass `WRDE_NOCMD` to `wordexp` per <https://man7.org/linux/man-pages/man3/wordexp.3.html> |
| --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@syoyo](https://avatars.githubusercontent.com/u/18676?s=80&u=e13fc43f3f2dcfa1cd608a79434d363adfa76c72&v=4)](/syoyo)

Copy link

Owner

### **[syoyo](/syoyo)** commented [Aug 16, 2022](#issuecomment-1216461326)

| [@oliverchang](https://github.com/oliverchang) Thanks! In `ExpandFilePath`   [tinygltf/tiny\_gltf.h](https://github.com/syoyo/tinygltf/blob/0fa56e239c77cc864dc248842e8887d985cf8e3f/tiny_gltf.h#L1266)  Line 1266 in [0fa56e2](/syoyo/tinygltf/commit/0fa56e239c77cc864dc248842e8887d985cf8e3f)   |  | std::string ExpandFilePath(const std::string &filepath, void \*userdata); | | --- | --- |    `wordexp` is used to expand file path(i.e, expand environment variable, expand tilde(`~`) when a file path contains such symbol).   But according to glTF spec <https://registry.khronos.org/glTF/specs/2.0/glTF-2.0.html#uris> , `uri` must be URI/IRI, so file(resource) path should not contain environment variables and tilde, so we need to use URI decoder/encoder instead of `ExpandFilePath`.  Related: [#337](https://github.com/syoyo/tinygltf/issues/337) |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@syoyo](https://avatars.githubusercontent.com/u/18676?s=40&u=e13fc43f3f2dcfa1cd608a79434d363adfa76c72&v=4)](/syoyo)
[syoyo](/syoyo)
added
the
[enhancement](/syoyo/tinygltf/labels/enhancement)
label
[Aug 16, 2022](#event-7196037972)

[![@syoyo](https://avatars.githubusercontent.com/u/18676?s=80&u=e13fc43f3f2dcfa1cd608a79434d363adfa76c72&v=4)](/syoyo)

Copy link

Owner

### **[syoyo](/syoyo)** commented [Aug 16, 2022](#issuecomment-1216496342)

| Disabled file path expansion(so no `wordexp` anymore) in this commit: [52ff00a](https://github.com/syoyo/tinygltf/commit/52ff00a38447f06a17eab1caa2cf0730a119c751)  TODO: Proper/strict decoding/encoding of URI asset path:   [tinygltf/tiny\_gltf.h](https://github.com/syoyo/tinygltf/blob/9117abb45d948b025b533143f678af65c258e1eb/tiny_gltf.h#L2202)  Line 2202 in [9117abb](/syoyo/tinygltf/commit/9117abb45d948b025b533143f678af65c258e1eb)   |  | // https://github.com/syoyo/tinygltf/issues/228 | | --- | --- | |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@syoyo](https://avatars.githubusercontent.com/u/18676?s=40&u=e13fc43f3f2dcfa1cd608a79434d363adfa76c72&v=4)](/syoyo)
[syoyo](/syoyo)
closed this as [completed](/syoyo/tinygltf/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Aug 16, 2022](#event-7196292919)

[![@oliverchang](https://avatars.githubusercontent.com/u/759062?s=80&u=55560dc2acb584fa51ee6a33dfa46197569770f2&v=4)](/oliverchang)

Copy link

Author

### **[oliverchang](/oliverchang)** commented [Aug 16, 2022](#issuecomment-1216506274) • edited Loading

| Thank you very much for the amazingly fast fix [@syoyo](https://github.com/syoyo) !  Would it be possible to create a security advisory (and CVE) for this via <https://github.com/syoyo/tinygltf/security/advisories> so downstream users are notified? We (Google) can also help with this if you prefer. |
| --- |

All reactions

Sorry, something went wrong.

[![@syoyo](https://avatars.githubusercontent.com/u/18676?s=80&u=e13fc43f3f2dcfa1cd608a79434d363adfa76c72&v=4)](/syoyo)

Copy link

Owner

### **[syoyo](/syoyo)** commented [Aug 16, 2022](#issuecomment-1216515437)

| [@oliverchang](https://github.com/oliverchang) Oh, I didn't know Github has a `Security` page 😮 Will take a look it. |
| --- |

All reactions

Sorry, something went wrong.

[![@DavidKorczynski](https://avatars.githubusercontent.com/u/657617?s=40&v=4)](/DavidKorczynski)
[DavidKorczynski](/DavidKorczynski)
mentioned this issue
[Aug 16, 2022](#ref-pullrequest-1340555938)

[plugins: refine function call analyser
ossf/fuzz-introspector#473](/ossf/fuzz-introspector/pull/473)
 Merged

This was referenced Aug 16, 2022

[Add query for tainted `wordexp` calls.
github/codeql#10077](/github/codeql/pull/10077)
 Merged

[C/C++: Command injection via `wordexp`
github/securitylab#700](/github/securitylab/issues/700)

Closed

[![@oliverchang](https://avatars.githubusercontent.com/u/759062?s=80&u=55560dc2acb584fa51ee6a33dfa46197569770f2&v=4)](/oliverchang)

Copy link

Author

### **[oliverchang](/oliverchang)** commented [Aug 23, 2022](#issuecomment-1223642355)

| Hi [@syoyo](https://github.com/syoyo), have you had a chance to try generating an advisory for this issue? It's a crucial part of making sure users of this library are notified of vulnerabilities (and that they need to update). |
| --- |

All reactions

Sorry, something went wrong.

[![@oliverchang](https://avatars.githubusercontent.com/u/759062?s=80&u=55560dc2acb584fa51ee6a33dfa46197569770f2&v=4)](/oliverchang)

Copy link

Author

### **[oliverchang](/oliverchang)** commented [Sep 5, 2022](#issuecomment-1237521690)

| FYI we've requested [CVE-2022-3008](https://github.com/advisories/GHSA-ghg5-6g69-q4q3 "CVE-2022-3008") for this vulnerability: <https://nvd.nist.gov/vuln/detail/CVE-2022-3008> |
| --- |

All reactions

Sorry, something went wrong.

[Piyuuussshhh](/Piyuuussshhh)
pushed a commit
to Piyuuussshhh/blender
that referenced
this issue
[Mar 10, 2023](#ref-commit-466eb42)
[![@tokenrove](https://avatars.githubusercontent.com/u/71495?s=40&u=131b35a46920633dafff8a76257a89e81ce726bf&v=4)](/tokenrove)

`[Extern: Update TinyGLTF to include fix for](/Piyuuussshhh/blender/commit/466eb426ed96f2112494cc9ee12997255a6aaae2 "Extern: Update TinyGLTF to include fix for CVE-2022-3008

The use of wordexp(3) permits arbitrary code execution from manually-crafted
glTF files. See https://github.com/syoyo/tinygltf/issues/368 for more details.
In practice this shouldn't be an issue for Blender since the GlTF data isn't
manually crafted but from the OpenXR runtime (a bit like a driver). But
updating the library to include the fix is not a big deal anyway.

Note that the warning that required the local modification is no longer present upstream since
  https://github.com/syoyo/tinygltf/commit/0bfcb4f49e0b149c41ba67eeb3b64f297c1637f5

Pull Request: https://projects.blender.org/blender/blender/pulls/105536") [CVE-2022-3008](https://github.com/advisories/GHSA-ghg5-6g69-q4q3 "CVE-2022-3008")`
…

`[466eb42](/Piyuuussshhh/blender/commit/466eb426ed96f2112494cc9ee12997255a6aaae2)`

```
The use of wordexp(3) permits arbitrary code execution from manually-crafted
glTF files. See [syoyo/tinygltf#368](https://github.com/syoyo/tinygltf/issues/368) for more details.
In practice this shouldn't be an issue for Blender since the GlTF data isn't
manually crafted but from the OpenXR runtime (a bit like a driver). But
updating the library to include the fix is not a big deal anyway.

Note that the warning that required the local modification is no longer present upstream since
  [syoyo/tinygltf@0bfcb4f](https://github.com/syoyo/tinygltf/commit/0bfcb4f49e0b149c41ba67eeb3b64f297c1637f5)

Pull Request: <https://projects.blender.org/blender/blender/pulls/105536>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsyoyo%2Ftinygltf%2Fissues%2F368)

Assignees

No one assigned

Labels

[enhancement](/syoyo/tinygltf/labels/enhancement)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@syoyo](https://avatars.githubusercontent.com/u/18676?s=52&v=4)](/syoyo) [![@oliverchang](https://avatars.githubusercontent.com/u/759062?s=52&v=4)](/oliverchang)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

