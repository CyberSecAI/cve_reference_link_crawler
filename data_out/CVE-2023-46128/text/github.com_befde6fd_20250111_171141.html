
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnautobot%2Fnautobot%2Fcommit%2F1ce8e5c658a075c29554d517cd453675e5d40d71)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnautobot%2Fnautobot%2Fcommit%2F1ce8e5c658a075c29554d517cd453675e5d40d71)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=nautobot%2Fnautobot)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nautobot](/nautobot)
/
**[nautobot](/nautobot/nautobot)**
Public

* [Notifications](/login?return_to=%2Fnautobot%2Fnautobot) You must be signed in to change notification settings
* [Fork
  298](/login?return_to=%2Fnautobot%2Fnautobot)
* [Star
   1.1k](/login?return_to=%2Fnautobot%2Fnautobot)

* [Code](/nautobot/nautobot)
* [Issues
  853](/nautobot/nautobot/issues)
* [Pull requests
  19](/nautobot/nautobot/pulls)
* [Discussions](/nautobot/nautobot/discussions)
* [Actions](/nautobot/nautobot/actions)
* [Projects
  0](/nautobot/nautobot/projects)
* [Wiki](/nautobot/nautobot/wiki)
* [Security](/nautobot/nautobot/security)
* [Insights](/nautobot/nautobot/pulse)

Additional navigation options

* [Code](/nautobot/nautobot)
* [Issues](/nautobot/nautobot/issues)
* [Pull requests](/nautobot/nautobot/pulls)
* [Discussions](/nautobot/nautobot/discussions)
* [Actions](/nautobot/nautobot/actions)
* [Projects](/nautobot/nautobot/projects)
* [Wiki](/nautobot/nautobot/wiki)
* [Security](/nautobot/nautobot/security)
* [Insights](/nautobot/nautobot/pulse)

## Commit

[Permalink](/nautobot/nautobot/commit/1ce8e5c658a075c29554d517cd453675e5d40d71)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix `Meta` inheritance in nested serializer classes ([#4692](https://github.com/nautobot/nautobot/pull/4692))

[Browse files](/nautobot/nautobot/tree/1ce8e5c658a075c29554d517cd453675e5d40d71)
Browse the repository at this point in the history

```
* Add test coverage

* Fix issue

* Change fragment

* Add more change fragments

* Refine test implementation

* Add reference to GHSA

* Add admonition about use of fields = __all__ on serializers

* Add PR number
```

* Loading branch information

[![@glennmatthews](https://avatars.githubusercontent.com/u/5603551?s=40&v=4)](/glennmatthews)

[glennmatthews](/nautobot/nautobot/commits?author=glennmatthews "View all commits by glennmatthews")
authored
Oct 23, 2023

1 parent
[896c10c](/nautobot/nautobot/commit/896c10c92162733a9870d9e48a9e66249d7ac956)

commit 1ce8e5c

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**39 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* changes

  + changes/4692.fixed
    [4692.fixed](#diff-650bc82bead3838f87e0296e142a487d411213c2fc1cc8e214e2a6859ed98b10)
  + changes/4692.housekeeping
    [4692.housekeeping](#diff-090def7cea60d8f2147b9a424ae37690f7dbe7aab770c11cbb6ae363244551a4)
  + changes/4692.security
    [4692.security](#diff-ecac81c8e7bd805df1691842e10d1235baef698f1259b1e13c844060e625e443)
* nautobot

  + core

    - api

      * nautobot/core/api/utils.py
        [utils.py](#diff-ffd2d83bcbb181f327be8d0433d68fe6237d39a6b45b1740c4e3424592a50382)
    - testing

      * nautobot/core/testing/api.py
        [api.py](#diff-5614c0d2ff665704ff166102eca48dee1753e0a92466ef39210cf15abdcff14d)
  + docs/development/apps/migration

    - nautobot/docs/development/apps/migration/code-updates.md
      [code-updates.md](#diff-33ecc23c8407aa5f9347c69bf4aa37035abe9696cf866cf061d9f3171f5bb047)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[changes/4692.fixed](#diff-650bc82bead3838f87e0296e142a487d411213c2fc1cc8e214e2a6859ed98b10 "changes/4692.fixed")

Show comments

[View file](/nautobot/nautobot/blob/1ce8e5c658a075c29554d517cd453675e5d40d71/changes/4692.fixed)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1 @@ |
|  |  | Fixed incorrect inheritance of `Meta` attributes into nested serializers (`depth >= 1`). |

1 change: 1 addition & 0 deletions

1
[changes/4692.housekeeping](#diff-090def7cea60d8f2147b9a424ae37690f7dbe7aab770c11cbb6ae363244551a4 "changes/4692.housekeeping")

Show comments

[View file](/nautobot/nautobot/blob/1ce8e5c658a075c29554d517cd453675e5d40d71/changes/4692.housekeeping)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1 @@ |
|  |  | Added check in REST API generic test cases to detect strings like `password` and `sha256` that shouldn't generally appear in REST API responses. |

1 change: 1 addition & 0 deletions

1
[changes/4692.security](#diff-ecac81c8e7bd805df1691842e10d1235baef698f1259b1e13c844060e625e443 "changes/4692.security")

Show comments

[View file](/nautobot/nautobot/blob/1ce8e5c658a075c29554d517cd453675e5d40d71/changes/4692.security)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1 @@ |
|  |  | Fixed potential exposure of hashed user password data on certain REST API endpoints when using the `?depth=1` query parameter. For more details, please refer to [GHSA-r2hw-74xv-4gqp](https://github.com/nautobot/nautobot/security/advisories/GHSA-r2hw-74xv-4gqp). |

7 changes: 1 addition & 6 deletions

7
[nautobot/core/api/utils.py](#diff-ffd2d83bcbb181f327be8d0433d68fe6237d39a6b45b1740c4e3424592a50382 "nautobot/core/api/utils.py")

Show comments

[View file](/nautobot/nautobot/blob/1ce8e5c658a075c29554d517cd453675e5d40d71/nautobot/core/api/utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -314,14 +314,9 @@ def nested\_serializer\_factory(relation\_info, nested\_depth): |
|  |  | base\_serializer\_class = get\_serializer\_for\_model(relation\_info.related\_model) |
|  |  |  |
|  |  | class NautobotNestedSerializer(base\_serializer\_class): |
|  |  | class Meta: |
|  |  | model = relation\_info.related\_model |
|  |  | class Meta(base\_serializer\_class.Meta): |
|  |  | is\_nested = True |
|  |  | depth = nested\_depth - 1 |
|  |  | if hasattr(base\_serializer\_class.Meta, "fields"): |
|  |  | fields = base\_serializer\_class.Meta.fields |
|  |  | if hasattr(base\_serializer\_class.Meta, "exclude"): |
|  |  | exclude = base\_serializer\_class.Meta.exclude |
|  |  |  |
|  |  | NautobotNestedSerializer.\_\_name\_\_ = nested\_serializer\_name |
|  |  | NESTED\_SERIALIZER\_CACHE[nested\_serializer\_name] = NautobotNestedSerializer |
| Expand Down | |  |

33 changes: 32 additions & 1 deletion

33
[nautobot/core/testing/api.py](#diff-5614c0d2ff665704ff166102eca48dee1753e0a92466ef39210cf15abdcff14d "nautobot/core/testing/api.py")

Show comments

[View file](/nautobot/nautobot/blob/1ce8e5c658a075c29554d517cd453675e5d40d71/nautobot/core/testing/api.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -73,6 +73,31 @@ def \_get\_list\_url(self): |
|  |  | viewname = lookup.get\_route\_for\_model(self.model, "list", api=True) |
|  |  | return reverse(viewname) |
|  |  |  |
|  |  | VERBOTEN\_STRINGS = ( |
|  |  | "password", |
|  |  | # https://docs.djangoproject.com/en/3.2/topics/auth/passwords/#included-hashers |
|  |  | "argon2", |
|  |  | "bcrypt", |
|  |  | "crypt", |
|  |  | "md5", |
|  |  | "pbkdf2", |
|  |  | "scrypt", |
|  |  | "sha1", |
|  |  | "sha256", |
|  |  | "sha512", |
|  |  | ) |
|  |  |  |
|  |  | def assert\_no\_verboten\_content(self, response): |
|  |  | """ |
|  |  | Check an API response for content that should not be exposed in the API. |
|  |  |  |
|  |  | If a specific API has a false failure here (maybe it has security-related strings as model flags or something?), |
|  |  | its test case should overload self.VERBOTEN\_STRINGS appropriately. |
|  |  | """ |
|  |  | response\_raw\_content = response.content.decode(response.charset) |
|  |  | for verboten in self.VERBOTEN\_STRINGS: |
|  |  | self.assertNotIn(verboten, response\_raw\_content) |
|  |  |  |
|  |  |  |
|  |  | @tag("unit") |
|  |  | class APIViewTestCases: |
| Expand Down  Expand Up | | @@ -150,6 +175,8 @@ def test\_get\_object(self): |
|  |  | # Fields that should be absent by default (opt-in fields): |
|  |  | self.assertNotIn("computed\_fields", response.data) |
|  |  | self.assertNotIn("relationships", response.data) |
|  |  | # Content that should never be present: |
|  |  | self.assert\_no\_verboten\_content(response) |
|  |  |  |
|  |  | # If opt-in fields are supported on this model, make sure they can be opted into |
|  |  |  |
| Expand Down  Expand Up | | @@ -302,6 +329,7 @@ def test\_list\_objects\_depth\_0(self): |
|  |  | self.assertIsInstance(response.data, dict) |
|  |  | self.assertIn("results", response.data) |
|  |  | self.assertEqual(len(response.data["results"]), self.\_get\_queryset().count()) |
|  |  | self.assert\_no\_verboten\_content(response) |
|  |  |  |
|  |  | for response\_data in response.data["results"]: |
|  |  | for field in depth\_fields: |
| Expand All | | @@ -316,7 +344,8 @@ def test\_list\_objects\_depth\_0(self): |
|  |  | url = response\_data[field]["url"] |
|  |  | pk = response\_data[field]["id"] |
|  |  | object\_type = response\_data[field]["object\_type"] |
|  |  | # The response should be a brief API object, containing an ID, object\_type, and URL ending in the UUID of the relevant object |
|  |  | # The response should be a brief API object, containing an ID, object\_type, and a |
|  |  | # URL ending in the UUID of the relevant object: |
|  |  | # http://nautobot.example.com/api/circuits/providers/<uuid>/ |
|  |  | # ^^^^^^ |
|  |  | self.assertTrue(is\_uuid(url.split("/")[-2])) |
| Expand All | | @@ -340,6 +369,7 @@ def test\_list\_objects\_depth\_1(self): |
|  |  | self.assertIsInstance(response.data, dict) |
|  |  | self.assertIn("results", response.data) |
|  |  | self.assertEqual(len(response.data["results"]), self.\_get\_queryset().count()) |
|  |  | self.assert\_no\_verboten\_content(response) |
|  |  |  |
|  |  | for response\_data in response.data["results"]: |
|  |  | for field in depth\_fields: |
| Expand Down  Expand Up | | @@ -392,6 +422,7 @@ def test\_list\_objects(self): |
|  |  | self.assertIsInstance(response.data, dict) |
|  |  | self.assertIn("results", response.data) |
|  |  | self.assertEqual(len(response.data["results"]), 2) |
|  |  | self.assert\_no\_verboten\_content(response) |
|  |  |  |
|  |  | @override\_settings(EXEMPT\_VIEW\_PERMISSIONS=[]) |
|  |  | def test\_list\_objects\_filtered(self): |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[nautobot/docs/development/apps/migration/code-updates.md](#diff-33ecc23c8407aa5f9347c69bf4aa37035abe9696cf866cf061d9f3171f5bb047 "nautobot/docs/development/apps/migration/code-updates.md")

Show comments

[View file](/nautobot/nautobot/blob/1ce8e5c658a075c29554d517cd453675e5d40d71/nautobot/docs/development/apps/migration/code-updates.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -123,6 +123,9 @@ App Model Serializers for any models that could have a Generic Foreign Key or a |
|  |  |  |
|  |  | After removing existing `NestedSerializers`, you can change the `fields` attribute in your serializers' `class Meta` to `\_\_all\_\_` and that will automatically include all the model's fields in the serializer, including related-model fields that would previously have required a reference to a `NestedSerializer`. If you want to exclude certain fields of the model, you can specify a list of fields you want to display in the `fields` attribute instead. |
|  |  |  |
|  |  | !!! warning |
|  |  | Use caution around `fields = "\_\_all\_\_"` -- if your model has any fields that should \_not\_ be exposed in the REST API, you should avoid using `"\_\_all\_\_"` and instead use an explicit `fields` list to ensure that such fields are not exposed. In some cases, it may be appropriate to use `"\_\_all\_\_"` in combination with flags such as `write\_only=True` on specific fields, but proceed with caution and examine the REST API data carefully to ensure that its contents are as expected. |
|  |  |  |
|  |  | Include all model attributes: |
|  |  |  |
|  |  | ```python |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1ce8e5c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnautobot%2Fnautobot%2Fcommit%2F1ce8e5c658a075c29554d517cd453675e5d40d71) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

