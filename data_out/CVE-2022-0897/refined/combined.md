=== Content from lists.debian.org_aec823e3_20250111_171350.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 3778-1] libvirt security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3778-1] libvirt security update
* *From*: Guilhem Moulin <guilhem@debian.org>
* *Date*: Mon, 1 Apr 2024 14:19:02 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZgqmNnznSz4aPHUm%40debian.org)Â [ZgqmNnznSz4aPHUm@debian.org](msg00000.html)>
* *Mail-followup-to*: debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3778-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Guilhem Moulin
April 01, 2024                                <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : libvirt
Version        : 5.0.0-4+deb10u2
CVE ID         : CVE-2020-10703 CVE-2020-12430 CVE-2020-25637 CVE-2021-3631
                 CVE-2021-3667 CVE-2021-3975 CVE-2021-4147 CVE-2022-0897
                 CVE-2024-1441 CVE-2024-2494 CVE-2024-2496
Debian Bug     : 959447 971555 990709 991594 1002535 1009075 1066058 1067461

Multiple vulnerabilities were found in libvirt, a C toolkit to interact
with the virtualization capabilities of Linux, which could lead to
denial of service or information disclosure.

CVE-2020-10703

    A NULL pointer dereference was found in the libvirt API that is responsible for
    fetching a storage pool based on its target path.  In more detail, this flaw affects
    storage pools created without a target path such as network-based pools like gluster
    and RBD.  Unprivileged users with a read-only connection could abuse this flaw to
    crash the libvirt daemon, resulting in a potential denial of service.

CVE-2020-12430

    A memory leak was found in the virDomainListGetStats libvirt API that is responsible
    for retrieving domain statistics when managing QEMU guests.  This flaw allows
    unprivileged users with a read-only connection to cause a memory leak in the domstats
    command, resulting in a potential denial of service.

CVE-2020-25637

    A double free memory issue was found in the libvirt API that is responsible for
    requesting information about network interfaces of a running QEMU domain.  This flaw
    affects the polkit access control driver.  Specifically, clients connecting to the
    read-write socket with limited ACL permissions could use this flaw to crash the
    libvirt daemon, resulting in a denial of service, or potentially escalate their
    privileges on the system.  The highest threat from this vulnerability is to data
    confidentiality and integrity as well as system availability.

CVE-2021-3631

    An issue was found in the generation of SELinux MCS category pairs for VMs' dynamic
    labels.  This flaw allows one exploited guest to access files labeled for another
    guest, resulting in the breaking out of sVirt confinement.

CVE-2021-3667

    An improper locking issue was found in the virStoragePoolLookupByTargetPath API.  It
    occurs in the storagePoolLookupByTargetPath function where a locked virStoragePoolObj
    object is not properly released on ACL permission failure.  Clients connecting to the
    read-write socket with limited ACL permissions could use this flaw to acquire the lock
    and prevent other users from accessing storage pool/volume APIs, resulting in a denial
    of service condition.

CVE-2021-3975

    A use-after-free issue was found in libvirt in qemuProcessHandleMonitorEOF(), where
    the qemuMonitorUnregister() function is called using multiple threads without being
    adequately protected by a monitor lock.  This flaw could be triggered by the
    virConnectGetAllDomainStats API when the guest is shutting down.  An unprivileged
    client with a read-only connection could use this flaw to perform a denial of service
    attack by causing the libvirt daemon to crash.

CVE-2021-4147

    Jim Fehlig discovered that a malicious guest using the libxl driver could cause
    libvirtd on the host to deadlock or crash when continuously rebooting itself.

CVE-2022-0897

    A flaw was found in the libvirt nwfilter driver.  The virNWFilterObjListNumOfNWFilters
    method failed to acquire the driver->nwfilters mutex before iterating over
    virNWFilterObj instances.  There was no protection to stop another thread from
    concurrently modifying the driver->nwfilters object.  This flaw allows a malicious,
    unprivileged user to exploit this issue via libvirt's API virConnectNumOfNWFilters to
    crash the network filter management daemon (libvirtd/virtnwfilterd).

CVE-2024-1441

    An off-by-one error flaw was found in the udevListInterfacesByStatus() function in
    libvirt when the number of interfaces exceeds the size of the `names` array.  This
    issue can be reproduced by sending specially crafted data to the libvirt daemon,
    allowing an unprivileged client to perform a denial of service attack by causing the
    libvirt daemon to crash.

CVE-2024-2494

    The ALT Linux Team discovered that the RPC server deserialization code allocates
    memory for arrays before the non-negative length check is performed by the C API entry
    points.  Passing a negative length therefore results in a crash due to the negative
    length being treated as a huge positive number.  This flaw allows a local,
    unprivileged user to perform a denial of service attack by causing the libvirt daemon
    to crash.

CVE-2024-2496

    A NULL pointer dereference flaw was found in the udevConnectListAllInterfaces()
    function.  This issue can occur when detaching a host interface while at the same time
    collecting the list of interfaces via virConnectListAllInterfaces API.  This flaw
    could be used to perform a denial of service attack by causing the libvirt daemon to
    crash.

For Debian 10 buster, these problems have been fixed in version
5.0.0-4+deb10u2.

We recommend that you upgrade your libvirt packages.

For the detailed security status of libvirt please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/libvirt>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpTqkEWc_AqF.pgp)**

*Description:* PGP signature

---



=== Content from bugzilla.redhat.com_d7d330e3_20250111_171350.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2063883)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2063883)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2063883)+ Login using a Red Hat Bugzilla account
  + ForgotÂ Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla â€“ BugÂ 2063883

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**BugÂ 2063883**](show_bug.cgi?id=2063883)
(CVE-2022-0897)
- [CVE-2022-0897](https://access.redhat.com/security/cve/CVE-2022-0897) libvirt: missing locking in nwfilterConnectNumOfNWFilters can lead to denial of service

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2022-0897 libvirt: missing locking in nwfilterConnectNumOfNWFilters can l...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2022-0897 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2063901](show_bug.cgi?id=2063901) [2063902](show_bug.cgi?id=2063902) [2063903](show_bug.cgi?id=2063903) [2063904](show_bug.cgi?id=2063904) [2068431](show_bug.cgi?id=2068431 "CLOSED EOL - CVE-2022-0897 libvirt: missing locking in nwfilterConnectNumOfNWFilters can lead to denial of service [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2062200](show_bug.cgi?id=2062200) [2063859](show_bug.cgi?id=2063859) | | TreeView+ | [depends on](buglist.cgi?bug_id=2063883&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2063883&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2022-03-14 15:03 UTC by Mauro Matteo Cascella | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2022-12-06 13:03 UTC ([History](show_activity.cgi?id=2063883)) | | [CC List:](page.cgi?id=fields.html#cclist) | 16 users (show)  agedosier berrange clalancette crobinso eblake jdenemar jforbes jsuchane knoel laine libvirt-maint pkrempa security-response-team veillard virt-maint virt-maint | | Fixed In Version: | libvirt 8.0.0-8 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in the libvirt nwfilter driver. The virNWFilterObjListNumOfNWFilters method failed to acquire the driver->nwfilters mutex before iterating over virNWFilterObj instances. There was no protection to stop another thread from concurrently modifying the driver->nwfilters object. This flaw allows a malicious, unprivileged user to exploit this issue via libvirt's API virConnectNumOfNWFilters to crash the network filter management daemon (libvirtd/virtnwfilterd). | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2022-12-06 13:03:28 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2022:7472](https://access.redhat.com/errata/RHSA-2022%3A7472) | 0 | None | None | None | 2022-11-08 09:13:56 UTC | | Red Hat Product Errata | [RHSA-2022:8003](https://access.redhat.com/errata/RHSA-2022%3A8003) | 0 | None | None | None | 2022-11-15 09:56:00 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2063883#c0)  Mauro Matteo Cascella    2022-03-14 15:03:03 UTC  ``` The virNWFilterObjListNumOfNWFilters method iterates over the driver->nwfilters, accessing virNWFilterObj instances. However, it fails to acquire the driver mutex, thus there is no protection to stop another thread from concurrently modifying the driver->nwfilters object. An unprivileged user could exploit this issue via libvirt API virConnectNumOfNWFilters to crash the libvirtd/virtnwfilterd daemon.   ```  [Comment 2](show_bug.cgi?id=2063883#c2)  Daniel BerrangÃ©    2022-03-17 14:30:38 UTC  ``` The upstream patch is now public, merged as <https://gitlab.com/libvirt/libvirt/-/commit/a4947e8f63c3e6b7b067b444f3d6cf674c0d7f36>  commit a4947e8f63c3e6b7b067b444f3d6cf674c0d7f36 Author: Daniel P. BerrangÃ© <berrange> Date:   Tue Mar 8 17:28:38 2022 +0000      nwfilter: fix crash when counting number of network filters          The virNWFilterObjListNumOfNWFilters method iterates over the     driver->nwfilters, accessing virNWFilterObj instances. As such     it needs to be protected against concurrent modification of     the driver->nwfilters object.          This API allows unprivileged users to connect, so users with     read-only access to libvirt can cause a denial of service     crash if they are able to race with a call of virNWFilterUndefine.     Since network filters are usually statically defined, this is     considered a low severity problem.          This is assigned [CVE-2022-0897](https://access.redhat.com/security/cve/CVE-2022-0897).          Reviewed-by: Eric Blake <eblake>     Signed-off-by: Daniel P. BerrangÃ© <berrange>   ```  [Comment 3](show_bug.cgi?id=2063883#c3)  Mauro Matteo Cascella    2022-03-25 09:55:37 UTC  ``` Created libvirt tracking bugs for this issue:  Affects: fedora-all [[bug 2068431](show_bug.cgi?id=2068431 "CLOSED EOL - CVE-2022-0897 libvirt: missing locking in nwfilterConnectNumOfNWFilters can lead to denial of service [fedora-all]")]   ```  [Comment 4](show_bug.cgi?id=2063883#c4)  errata-xmlrpc    2022-11-08 09:13:53 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8  Via RHSA-2022:7472 [https://access.redhat.com/errata/RHSA-2022:7472](https://access.redhat.com/errata/RHSA-2022%3A7472)   ```  [Comment 5](show_bug.cgi?id=2063883#c5)  errata-xmlrpc    2022-11-15 09:55:58 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 9  Via RHSA-2022:8003 [https://access.redhat.com/errata/RHSA-2022:8003](https://access.redhat.com/errata/RHSA-2022%3A8003)   ```  [Comment 6](show_bug.cgi?id=2063883#c6)  Product Security DevOps Team    2022-12-06 13:03:25 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2022-0897>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2063883&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from security.gentoo.org_4c23d56f_20250111_171351.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libvirt: Multiple Vulnerabilities â€” GLSA **202210-06**

Multiple vulnerabilities have been discovered in libvirt, the worst of which could result in denial of service.

### Affected packages

| Package | **app-emulation/libvirt** on all architectures |
| --- | --- |
| Affected versions | < **8.2.0** |
| Unaffected versions | >= **8.2.0** |

| Package | **dev-python/libvirt-python** on all architectures |
| --- | --- |
| Affected versions | < **8.2.0** |
| Unaffected versions | >= **8.2.0** |

### Background

libvirt is a C toolkit for manipulating virtual machines.

### Description

Multiple vulnerabilities have been discovered in libvirt. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All libvirt users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/libvirt-8.2.0"

```

All libvirt-python users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-python/libvirt-python-8.2.0"

```
### References

* [CVE-2020-14339](https://nvd.nist.gov/vuln/detail/CVE-2020-14339)
* [CVE-2020-25637](https://nvd.nist.gov/vuln/detail/CVE-2020-25637)
* [CVE-2021-3631](https://nvd.nist.gov/vuln/detail/CVE-2021-3631)
* [CVE-2021-3667](https://nvd.nist.gov/vuln/detail/CVE-2021-3667)
* [CVE-2022-0897](https://nvd.nist.gov/vuln/detail/CVE-2022-0897)

**Release date**

October 16, 2022

**Latest revision**

October 16, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [746119](https://bugs.gentoo.org/show_bug.cgi?id=746119)
* [799713](https://bugs.gentoo.org/show_bug.cgi?id=799713)
* [812317](https://bugs.gentoo.org/show_bug.cgi?id=812317)
* [836128](https://bugs.gentoo.org/show_bug.cgi?id=836128)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**


