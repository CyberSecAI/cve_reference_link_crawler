- **Root cause of vulnerability:** The vulnerability stems from the FortiPortal relying on the `X-Forwarded-For` and other HTTP headers to determine the client IP address, instead of directly using the source IP of the incoming connection. These headers can be easily spoofed by an attacker.
- **Weaknesses/vulnerabilities present:** Use of Less Trusted Source (CWE-348) vulnerability. The system trusts user-controlled HTTP headers for IP determination, which is not reliable.
- **Impact of exploitation:** An unauthenticated attacker can bypass IP-based access restrictions, potentially gaining unauthorized access or other forms of improper access control.
- **Attack vectors:** Sending crafted HTTP or HTTPS packets with malicious headers.
- **Required attacker capabilities/position:** An attacker needs to be able to send HTTP/HTTPS requests to a vulnerable FortiPortal instance. No authentication or special privileges are needed.