- **Root cause of vulnerability**: The vulnerability lies in the `allocation_function_mem` function of Accusoft ImageGear library, where a missing check for memory bounds within a heap buffer leads to a buffer overflow. Specifically, the size of the allocated buffer (`psd_buffer_oobw`) is calculated based on the width and bits per channel from the PSD file, but this calculation doesn't account for a minimum buffer size when `bits_per_channel` is 1. This allows for a smaller buffer than required, resulting in an out-of-bounds write during subsequent operations.
- **Weaknesses/vulnerabilities present**: An out-of-bounds write vulnerability is present due to insufficient memory allocation in the `allocation_function_mem` function during the processing of PSD files. The buffer `psd_buffer_oobw` can be undersized, leading to writes beyond the allocated region.
- **Impact of exploitation**: Successful exploitation leads to memory corruption, which can potentially result in arbitrary code execution. The crash information shows an access violation due to an attempt to write to an invalid memory address.
- **Attack vectors**: The attack vector is a specially crafted PSD file. An attacker can provide a malicious PSD file that triggers the vulnerability when processed by the vulnerable Accusoft ImageGear library.
- **Required attacker capabilities/position**: The attacker needs to be able to supply a malicious PSD file to the vulnerable application or service using the affected library. No special privileges are required, but the attacker needs to be able to control the contents of the PSD file.