=== Content from sourceware.org_4a7b99a7_20250108_145109.html ===

[![git](static/git-logo.png)](https://git-scm.com/ "git homepage")[git://sourceware.org](/git) / [glibc.git](/git?p=glibc.git;a=summary) / commit

commit
grep
author
committer
pickaxe
 [?](/git?p=glibc.git;a=search_help "search help") search:

re

[summary](/git?p=glibc.git;a=summary) | [shortlog](/git?p=glibc.git;a=shortlog;h=4ad1659d8c024953b11c2f0fef2219529171da7e) | [log](/git?p=glibc.git;a=log;h=4ad1659d8c024953b11c2f0fef2219529171da7e) | commit | [commitdiff](/git?p=glibc.git;a=commitdiff;h=4ad1659d8c024953b11c2f0fef2219529171da7e) | [tree](/git?p=glibc.git;a=tree;h=b9367574447d9a76adf3878458d049232d883006;hb=4ad1659d8c024953b11c2f0fef2219529171da7e)

(parent: [3319cea](/git?p=glibc.git;a=commit;h=3319cea99e4c9b5d5adbc61b2c63582f4b2ecb67)) | [patch](/git?p=glibc.git;a=patch;h=4ad1659d8c024953b11c2f0fef2219529171da7e)

[getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)](/git?p=glibc.git;a=commitdiff;h=4ad1659d8c024953b11c2f0fef2219529171da7e)

| author | [Siddhesh Poyarekar](/git?p=glibc.git;a=search;h=4ad1659d8c024953b11c2f0fef2219529171da7e;s=Siddhesh+Poyarekar;st=author "Search for commits authored by Siddhesh Poyarekar") [<siddhesh@sourceware.org>](/git?p=glibc.git;a=search;h=4ad1659d8c024953b11c2f0fef2219529171da7e;s=siddhesh@sourceware.org;st=author "Search for commits authored by siddhesh@sourceware.org") |  |
| --- | --- | --- |
|  | Fri, 21 Jan 2022 18:02:56 +0000 (23:32 +0530) |
| committer | [Aurelien Jarno](/git?p=glibc.git;a=search;h=4ad1659d8c024953b11c2f0fef2219529171da7e;s=Aurelien+Jarno;st=committer "Search for commits committed by Aurelien Jarno") [<aurelien@aurel32.net>](/git?p=glibc.git;a=search;h=4ad1659d8c024953b11c2f0fef2219529171da7e;s=aurelien@aurel32.net;st=committer "Search for commits committed by aurelien@aurel32.net") |  |
|  | Wed, 17 Aug 2022 22:14:28 +0000 (00:14 +0200) |
| commit | 4ad1659d8c024953b11c2f0fef2219529171da7e |
| tree | [b9367574447d9a76adf3878458d049232d883006](/git?p=glibc.git;a=tree;h=b9367574447d9a76adf3878458d049232d883006;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) | [tree](/git?p=glibc.git;a=tree;h=b9367574447d9a76adf3878458d049232d883006;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) |
| parent | [3319cea99e4c9b5d5adbc61b2c63582f4b2ecb67](/git?p=glibc.git;a=commit;h=3319cea99e4c9b5d5adbc61b2c63582f4b2ecb67) | [commit](/git?p=glibc.git;a=commit;h=3319cea99e4c9b5d5adbc61b2c63582f4b2ecb67) | [diff](/git?p=glibc.git;a=commitdiff;h=4ad1659d8c024953b11c2f0fef2219529171da7e;hp=3319cea99e4c9b5d5adbc61b2c63582f4b2ecb67) |

getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)

No valid path returned by getcwd would fit into 1 byte, so reject the

size early and return NULL with errno set to ERANGE.  This change is

prompted by CVE-2021-3999, which describes a single byte buffer

underflow and overflow when all of the following conditions are met:

- The buffer size (i.e. the second argument of getcwd) is 1 byte

- The current working directory is too long

- '/' is also mounted on the current working directory

Sequence of events:

- In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG

  because the linux kernel checks for name length before it checks

  buffer size

- The code falls back to the generic getcwd in sysdeps/posix

- In the generic func, the buf[0] is set to '\0' on line 250

- this while loop on line 262 is bypassed:

    while (!(thisdev == rootdev && thisino == rootino))

  since the rootfs (/) is bind mounted onto the directory and the flow

  goes on to line 449, where it puts a '/' in the byte before the

  buffer.

- Finally on line 458, it moves 2 bytes (the underflowed byte and the

  '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.

- buf is returned on line 469 and errno is not set.

This resolves BZ #28769.

Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>

Reviewed-by: Adhemerval Zanella <adhemerval.zanella@linaro.org>

Signed-off-by: Qualys Security Advisory <qsa@qualys.com>

Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>

(cherry picked from commit [23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e](/git?p=glibc.git;a=object;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e))

| [NEWS](/git?p=glibc.git;a=blob;f=NEWS;h=de7bf22aa48908d0eb13cebab7c690bd302f3d65;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) |  | [diff](/git?p=glibc.git;a=blobdiff;f=NEWS;h=de7bf22aa48908d0eb13cebab7c690bd302f3d65;hp=8b492d48d1fec0429e33f5b9491daba0d3c57efe;hb=4ad1659d8c024953b11c2f0fef2219529171da7e;hpb=3319cea99e4c9b5d5adbc61b2c63582f4b2ecb67) | [blob](/git?p=glibc.git;a=blob;f=NEWS;h=de7bf22aa48908d0eb13cebab7c690bd302f3d65;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) | [blame](/git?p=glibc.git;a=blame;f=NEWS;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) | [history](/git?p=glibc.git;a=history;f=NEWS;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) |
| --- | --- | --- |
| [sysdeps/posix/getcwd.c](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=839d78d7b7798bf431f89ea1cbb9fc54dd5358e8;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/posix/getcwd.c;h=839d78d7b7798bf431f89ea1cbb9fc54dd5358e8;hp=f00b337a137c7b80223342b29b9109a6a2fa885b;hb=4ad1659d8c024953b11c2f0fef2219529171da7e;hpb=3319cea99e4c9b5d5adbc61b2c63582f4b2ecb67) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=839d78d7b7798bf431f89ea1cbb9fc54dd5358e8;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/posix/getcwd.c;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) | [history](/git?p=glibc.git;a=history;f=sysdeps/posix/getcwd.c;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) |
| [sysdeps/unix/sysv/linux/Makefile](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=0a0da001515f83369b67500e9887323fd0c90482;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/unix/sysv/linux/Makefile;h=0a0da001515f83369b67500e9887323fd0c90482;hp=5fbde369c397b7bb37c33519eec0f3c45a51ca74;hb=4ad1659d8c024953b11c2f0fef2219529171da7e;hpb=3319cea99e4c9b5d5adbc61b2c63582f4b2ecb67) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=0a0da001515f83369b67500e9887323fd0c90482;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/unix/sysv/linux/Makefile;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) | [history](/git?p=glibc.git;a=history;f=sysdeps/unix/sysv/linux/Makefile;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) |
| [sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) | [new file with mode: 0644] | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=4ad1659d8c024953b11c2f0fef2219529171da7e) |

GNU C Library master sources
[RSS](/git?p=glibc.git;a=rss "log RSS feed")
[Atom](/git?p=glibc.git;a=atom "log Atom feed")

This page took 0.043957 seconds  and 6 git commands to generate.



=== Content from sourceware.org_af29724e_20250108_145111.html ===

[![git](static/git-logo.png)](https://git-scm.com/ "git homepage")[git://sourceware.org](/git) / [glibc.git](/git?p=glibc.git;a=summary) / commit

commit
grep
author
committer
pickaxe
 [?](/git?p=glibc.git;a=search_help "search help") search:

re

[summary](/git?p=glibc.git;a=summary) | [shortlog](/git?p=glibc.git;a=shortlog;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a) | [log](/git?p=glibc.git;a=log;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a) | commit | [commitdiff](/git?p=glibc.git;a=commitdiff;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a) | [tree](/git?p=glibc.git;a=tree;h=b1dad22687fa90022704cc2c36308994a6b7cf4b;hb=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a)

(parent: [3438bbc](/git?p=glibc.git;a=commit;h=3438bbca90895d32825a52e31a77dc44d273c1c1)) | [patch](/git?p=glibc.git;a=patch;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a)

[NEWS: add bug entry for BZ #28769 and BZ #28770](/git?p=glibc.git;a=commitdiff;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a)

| author | [Aurelien Jarno](/git?p=glibc.git;a=search;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a;s=Aurelien+Jarno;st=author "Search for commits authored by Aurelien Jarno") [<aurelien@aurel32.net>](/git?p=glibc.git;a=search;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a;s=aurelien@aurel32.net;st=author "Search for commits authored by aurelien@aurel32.net") |  |
| --- | --- | --- |
|  | Mon, 24 Jan 2022 22:45:03 +0000 (23:45 +0100) |
| committer | [Aurelien Jarno](/git?p=glibc.git;a=search;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a;s=Aurelien+Jarno;st=committer "Search for commits committed by Aurelien Jarno") [<aurelien@aurel32.net>](/git?p=glibc.git;a=search;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a;s=aurelien@aurel32.net;st=committer "Search for commits committed by aurelien@aurel32.net") |  |
|  | Mon, 24 Jan 2022 22:45:03 +0000 (23:45 +0100) |
| commit | 1b9cd6a7214db1812a20eb3591cf42f9190a5d1a |
| tree | [b1dad22687fa90022704cc2c36308994a6b7cf4b](/git?p=glibc.git;a=tree;h=b1dad22687fa90022704cc2c36308994a6b7cf4b;hb=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a) | [tree](/git?p=glibc.git;a=tree;h=b1dad22687fa90022704cc2c36308994a6b7cf4b;hb=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a) |
| parent | [3438bbca90895d32825a52e31a77dc44d273c1c1](/git?p=glibc.git;a=commit;h=3438bbca90895d32825a52e31a77dc44d273c1c1) | [commit](/git?p=glibc.git;a=commit;h=3438bbca90895d32825a52e31a77dc44d273c1c1) | [diff](/git?p=glibc.git;a=commitdiff;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a;hp=3438bbca90895d32825a52e31a77dc44d273c1c1) |

NEWS: add bug entry for BZ #28769 and BZ #28770

| [NEWS](/git?p=glibc.git;a=blob;f=NEWS;h=c063c78b151ee62348fd5066f561f4396aed7553;hb=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a) |  | [diff](/git?p=glibc.git;a=blobdiff;f=NEWS;h=c063c78b151ee62348fd5066f561f4396aed7553;hp=8d7467d2c1b65833defadcc8113db73c0720c364;hb=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a;hpb=3438bbca90895d32825a52e31a77dc44d273c1c1) | [blob](/git?p=glibc.git;a=blob;f=NEWS;h=c063c78b151ee62348fd5066f561f4396aed7553;hb=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a) | [blame](/git?p=glibc.git;a=blame;f=NEWS;hb=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a) | [history](/git?p=glibc.git;a=history;f=NEWS;hb=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a) |
| --- | --- | --- |

GNU C Library master sources
[RSS](/git?p=glibc.git;a=rss "log RSS feed")
[Atom](/git?p=glibc.git;a=atom "log Atom feed")

This page took 0.040678 seconds  and 6 git commands to generate.



=== Content from bugzilla.suse.com_22e0e16a_20250108_145103.html ===


| Bugzilla – Invalid Bug ID |
| --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3DCVE-2021-3999%2529%252F%255BCVE%255D%2528https%253A%252F%252Fwww.suse.com%252Fsecurity%252Fcve%252FCVE-2021-3999%252F%2529%252C)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

'CVE-2021-3999)/[CVE](https://www.suse.com/security/cve/CVE-2021-3999/),' is not a valid bug number
nor an alias to a bug.

Please press **Back** and try again.

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3DCVE-2021-3999%2529%252F%255BCVE%255D%2528https%253A%252F%252Fwww.suse.com%252Fsecurity%252Fcve%252FCVE-2021-3999%252F%2529%252C)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from access.redhat.com_c20d49c7_20250108_105642.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2024 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from sourceware.org_c4771477_20250108_145107.html ===

[![git](static/git-logo.png)](https://git-scm.com/ "git homepage")[git://sourceware.org](/git) / [glibc.git](/git?p=glibc.git;a=summary) / commit

commit
grep
author
committer
pickaxe
 [?](/git?p=glibc.git;a=search_help "search help") search:

re

[summary](/git?p=glibc.git;a=summary) | [shortlog](/git?p=glibc.git;a=shortlog;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [log](/git?p=glibc.git;a=log;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | commit | [commitdiff](/git?p=glibc.git;a=commitdiff;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [tree](/git?p=glibc.git;a=tree;h=4ce71226b6ce414b7c5a08d6406e5506f2b32442;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e)

(parent: [6c2f050](/git?p=glibc.git;a=commit;h=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b)) | [patch](/git?p=glibc.git;a=patch;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e)

[getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)](/git?p=glibc.git;a=commitdiff;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e)

| author | [Siddhesh Poyarekar](/git?p=glibc.git;a=search;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;s=Siddhesh+Poyarekar;st=author "Search for commits authored by Siddhesh Poyarekar") [<siddhesh@sourceware.org>](/git?p=glibc.git;a=search;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;s=siddhesh@sourceware.org;st=author "Search for commits authored by siddhesh@sourceware.org") |  |
| --- | --- | --- |
|  | Fri, 21 Jan 2022 18:02:56 +0000 (23:32 +0530) |
| committer | [Siddhesh Poyarekar](/git?p=glibc.git;a=search;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;s=Siddhesh+Poyarekar;st=committer "Search for commits committed by Siddhesh Poyarekar") [<siddhesh@sourceware.org>](/git?p=glibc.git;a=search;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;s=siddhesh@sourceware.org;st=committer "Search for commits committed by siddhesh@sourceware.org") |  |
|  | Mon, 24 Jan 2022 05:30:17 +0000 (11:00 +0530) |
| commit | 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e |
| tree | [4ce71226b6ce414b7c5a08d6406e5506f2b32442](/git?p=glibc.git;a=tree;h=4ce71226b6ce414b7c5a08d6406e5506f2b32442;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [tree](/git?p=glibc.git;a=tree;h=4ce71226b6ce414b7c5a08d6406e5506f2b32442;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |
| parent | [6c2f050dbe11fb4ed0a401a5f25731f2aa53046b](/git?p=glibc.git;a=commit;h=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [commit](/git?p=glibc.git;a=commit;h=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [diff](/git?p=glibc.git;a=commitdiff;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;hp=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) |

getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)

No valid path returned by getcwd would fit into 1 byte, so reject the

size early and return NULL with errno set to ERANGE.  This change is

prompted by CVE-2021-3999, which describes a single byte buffer

underflow and overflow when all of the following conditions are met:

- The buffer size (i.e. the second argument of getcwd) is 1 byte

- The current working directory is too long

- '/' is also mounted on the current working directory

Sequence of events:

- In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG

  because the linux kernel checks for name length before it checks

  buffer size

- The code falls back to the generic getcwd in sysdeps/posix

- In the generic func, the buf[0] is set to '\0' on line 250

- this while loop on line 262 is bypassed:

    while (!(thisdev == rootdev && thisino == rootino))

  since the rootfs (/) is bind mounted onto the directory and the flow

  goes on to line 449, where it puts a '/' in the byte before the

  buffer.

- Finally on line 458, it moves 2 bytes (the underflowed byte and the

  '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.

- buf is returned on line 469 and errno is not set.

This resolves BZ #28769.

Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>

Reviewed-by: Adhemerval Zanella <adhemerval.zanella@linaro.org>

Signed-off-by: Qualys Security Advisory <qsa@qualys.com>

Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>

| [NEWS](/git?p=glibc.git;a=blob;f=NEWS;h=07e9eac52d531afec15297ad546157d98c1c2c20;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |  | [diff](/git?p=glibc.git;a=blobdiff;f=NEWS;h=07e9eac52d531afec15297ad546157d98c1c2c20;hp=4c392a445e327e2d317ce62f2043b95a947a7ec8;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;hpb=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [blob](/git?p=glibc.git;a=blob;f=NEWS;h=07e9eac52d531afec15297ad546157d98c1c2c20;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [blame](/git?p=glibc.git;a=blame;f=NEWS;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [history](/git?p=glibc.git;a=history;f=NEWS;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |
| --- | --- | --- |
| [sysdeps/posix/getcwd.c](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=9d5787b6f42f272d64d9b7455153e6e28b51d1ad;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/posix/getcwd.c;h=9d5787b6f42f272d64d9b7455153e6e28b51d1ad;hp=e147a31a816c4e12ec0540c386e3dd7e5ebaaf62;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;hpb=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=9d5787b6f42f272d64d9b7455153e6e28b51d1ad;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/posix/getcwd.c;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [history](/git?p=glibc.git;a=history;f=sysdeps/posix/getcwd.c;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |
| [sysdeps/unix/sysv/linux/Makefile](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=7ca9350c99bd8b3ed95227e18e8188e8a34ee290;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/unix/sysv/linux/Makefile;h=7ca9350c99bd8b3ed95227e18e8188e8a34ee290;hp=85fc8cbf7566314874d316f93e5f1421f36f46b8;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;hpb=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=7ca9350c99bd8b3ed95227e18e8188e8a34ee290;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/unix/sysv/linux/Makefile;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [history](/git?p=glibc.git;a=history;f=sysdeps/unix/sysv/linux/Makefile;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |
| [sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [new file with mode: 0644] | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |

GNU C Library master sources
[RSS](/git?p=glibc.git;a=rss "log RSS feed")
[Atom](/git?p=glibc.git;a=atom "log Atom feed")

This page took 0.044458 seconds  and 6 git commands to generate.



=== Content from security-tracker.debian.org_e4d643a2_20250108_105644.html ===

# CVE-2021-3999

| **Name** | CVE-2021-3999 |
| --- | --- |
| **Description** | A flaw was found in glibc. An off-by-one buffer overflow and underflow in getcwd() may lead to memory corruption when the size of the buffer is exactly 1. A local attacker who can control the input buffer and size passed to getcwd() in a setuid program could use this flaw to potentially execute arbitrary code and escalate their privileges on the system. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2021-3999) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2021-3999); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2021-3999), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2021-3999), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2021-3999), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2021-3999), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2021-3999), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2021-3999), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2021-3999), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2021-3999)/[CVE](https://www.suse.com/security/cve/CVE-2021-3999/), GitHub [advisories](https://github.com/advisories?query=CVE-2021-3999)/[code](https://github.com/search?type=Code&q=%22CVE-2021-3999%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2021-3999%22), [web search](https://duckduckgo.com/html?q=%22CVE-2021-3999%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DLA-3152-1](/tracker/DLA-3152-1) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [glibc](/tracker/source-package/glibc) ([PTS](https://tracker.debian.org/pkg/glibc)) | bullseye | 2.31-13+deb11u11 | fixed |
|  | bullseye (security) | 2.31-13+deb11u10 | fixed |
|  | bookworm | 2.36-9+deb12u9 | fixed |
|  | bookworm (security) | 2.36-9+deb12u7 | fixed |
|  | trixie | 2.40-4 | fixed |
|  | sid | 2.40-5 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [glibc](/tracker/source-package/glibc) | source | buster | 2.28-10+deb10u2 |  | [DLA-3152-1](/tracker/DLA-3152-1) |  |
| [glibc](/tracker/source-package/glibc) | source | bullseye | 2.31-13+deb11u4 |  |  |  |
| [glibc](/tracker/source-package/glibc) | source | (unstable) | 2.33-4 |  |  |  |

## Notes

```
<https://sourceware.org/bugzilla/show_bug.cgi?id=28769>
<https://www.openwall.com/lists/oss-security/2022/01/24/4>
<https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e>
<https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=472e799a5f2102bc0c3206dbd5a801765fceb39c>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from marc.info_89065a11_20250108_145100.html ===


| Search: [] List [] Subjects [] Authors [] Bodies for list 'oss-security' |
| --- |

Set Page Width:
[ [80](?l=oss-security&s=CVE-2021-3999),&w=1) ]
[ [90](?l=oss-security&s=CVE-2021-3999),&w=2) ]
[ [100](?l=oss-security&s=CVE-2021-3999),&w=3) ]
[ [120](?l=oss-security&s=CVE-2021-3999),&w=4) ]

[![Viewing messages in list](images/folderopen.gif) **oss-security**](?l=oss-security&r=1&w=2)
[![- ](images/bookclosed.gif) 2025-01-01 - 2025-02-01 (10 messages)](?l=oss-security&r=1&b=202501&w=2)
```
  1. 2022-02-23  [Re: [oss-security] CVE-2021-44731: Race condition in](?l=oss-security&m=164561148127019&w=2)  [oss-secur](?l=oss-security&w=2) Wire Snark
  2. 2022-02-17  [[oss-security] CVE-2021-44731: Race condition in snap](?l=oss-security&m=164512730131925&w=2) [oss-secur](?l=oss-security&w=2) Qualys Security Ad
  3. 2022-01-24  [[oss-security] CVE-2021-3998 and CVE-2021-3999 in gli](?l=oss-security&m=164303302624023&w=2) [oss-secur](?l=oss-security&w=2) Qualys Security Ad

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from access.redhat.com_34f50029_20250108_145107.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2024 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_e0764b81_20250108_145103.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2021-3999%2529%252C)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2021-3999%2529%252C)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2021-3999%2529%252C)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Invalid Bug ID

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

'CVE-2021-3999),' is not a valid bug number
nor an alias to a bug.

Please press **Back** and try again.

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_10114b26_20250108_145110.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2024637)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2024637)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2024637)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2024637

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2024637**](show_bug.cgi?id=2024637)
(CVE-2021-3999)
- [CVE-2021-3999](https://access.redhat.com/security/cve/CVE-2021-3999) glibc: Off-by-one buffer overflow/underflow in getcwd()

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2021-3999 glibc: Off-by-one buffer overflow/underflow in getcwd()

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-3999 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2025929](show_bug.cgi?id=2025929) [2025930](show_bug.cgi?id=2025930) [2032279](show_bug.cgi?id=2032279) [2032280](show_bug.cgi?id=2032280) [2032281](show_bug.cgi?id=2032281) [2039676](show_bug.cgi?id=2039676 "CLOSED CURRENTRELEASE - CVE-2021-3999 glibc: Off-by-one buffer overflow/underflow in getcwd() [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2024641](show_bug.cgi?id=2024641) | | TreeView+ | [depends on](buglist.cgi?bug_id=2024637&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2024637&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2021-11-18 14:42 UTC by Pedro Sampaio | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2022-07-12 12:02 UTC ([History](show_activity.cgi?id=2024637)) | | [CC List:](page.cgi?id=fields.html#cclist) | 34 users (show)  aoliva arjun.is ashankar bdettelb caswilli codonell dhalasz dj fjansen fweimer ganandan glibc-bugzilla jburrell jtanner jwong kaycoth law lnacshon mcascell mcermak mfabian micjohns mnewsome pfrankli psegedy rschiron rth security-response-team sipoyare sthirugn tsasak vkrizan vkumar vmugicag | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in glibc. An off-by-one buffer overflow and underflow in getcwd() may lead to memory corruption when the size of the buffer is exactly 1. A local attacker who can control the input buffer and size passed to getcwd() in a setuid program could use this flaw to potentially execute arbitrary code and escalate their privileges on the system. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2022-05-04 01:15:19 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2022:0896](https://access.redhat.com/errata/RHSA-2022%3A0896) | 0 | None | None | None | 2022-03-15 10:21:46 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2024637#c0)  Pedro Sampaio    2021-11-18 14:42:47 UTC  ``` A flaw was found in glibc. The getcwd() function is affected by an off-by-one buffer overflow and underflow that may lead to memory corruption when the size of the buffer is exactly 1 byte.   ```  [Comment 18](show_bug.cgi?id=2024637#c18)  Mauro Matteo Cascella    2022-01-12 08:37:18 UTC  ``` Created glibc tracking bugs for this issue:  Affects: fedora-all [[bug 2039676](show_bug.cgi?id=2039676 "CLOSED CURRENTRELEASE - CVE-2021-3999 glibc: Off-by-one buffer overflow/underflow in getcwd() [fedora-all]")]   ```  [Comment 22](show_bug.cgi?id=2024637#c22)  Siddhesh Poyarekar    2022-01-12 13:45:02 UTC  ``` Filed upstream as: <https://sourceware.org/bugzilla/show_bug.cgi?id=28769>   ```  [Comment 26](show_bug.cgi?id=2024637#c26)  Riccardo Schirone    2022-01-20 10:59:15 UTC  ``` I'm updating the CVSS from 8.1/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H to 7.4/CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H . This changes the Attack Vector from Network (AV:N) to Local (AV:L), because it was wrongly set in the first place. The description of the flaw already mentioned "local attacker" but we forgot to reflect this knowledge in the CVSS.  Triggering this bug indeed requires the attacker to be able to alter the current working directory of a process and configure its environment in specific ways that only a local user could do in reasonable scenarios.   ```  [Comment 27](show_bug.cgi?id=2024637#c27)  Riccardo Schirone    2022-01-20 11:18:21 UTC  ``` This flaw can be triggered only when the following conditions are respected: - The buffer size (i.e. the second argument of getcwd) is 1 byte - The current working directory is too long - '/' is also mounted on the current working directory (e.g. through a mount namespace)   ```  [Comment 28](show_bug.cgi?id=2024637#c28)  Mauro Matteo Cascella    2022-01-24 14:38:00 UTC  ``` Upstream commit: <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e>   ```  [Comment 30](show_bug.cgi?id=2024637#c30)  errata-xmlrpc    2022-03-15 10:21:43 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8  Via RHSA-2022:0896 [https://access.redhat.com/errata/RHSA-2022:0896](https://access.redhat.com/errata/RHSA-2022%3A0896)   ```  [Comment 31](show_bug.cgi?id=2024637#c31)  Product Security DevOps Team    2022-05-04 01:15:16 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2021-3999>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2024637&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from sourceware.org_67000b81_20250108_145109.html ===

[![git](static/git-logo.png)](https://git-scm.com/ "git homepage")[git://sourceware.org](/git) / [glibc.git](/git?p=glibc.git;a=summary) / commit

commit
grep
author
committer
pickaxe
 [?](/git?p=glibc.git;a=search_help "search help") search:

re

[summary](/git?p=glibc.git;a=summary) | [shortlog](/git?p=glibc.git;a=shortlog;h=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [log](/git?p=glibc.git;a=log;h=472e799a5f2102bc0c3206dbd5a801765fceb39c) | commit | [commitdiff](/git?p=glibc.git;a=commitdiff;h=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [tree](/git?p=glibc.git;a=tree;h=600e5a557e3bc43d4ff5e43ad3eb2d060e93f795;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c)

(parent: [8c8a71c](/git?p=glibc.git;a=commit;h=8c8a71c85f2ed5cc90d08d82ce645513fc907cb6)) | [patch](/git?p=glibc.git;a=patch;h=472e799a5f2102bc0c3206dbd5a801765fceb39c)

[getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)](/git?p=glibc.git;a=commitdiff;h=472e799a5f2102bc0c3206dbd5a801765fceb39c)

| author | [Siddhesh Poyarekar](/git?p=glibc.git;a=search;h=472e799a5f2102bc0c3206dbd5a801765fceb39c;s=Siddhesh+Poyarekar;st=author "Search for commits authored by Siddhesh Poyarekar") [<siddhesh@sourceware.org>](/git?p=glibc.git;a=search;h=472e799a5f2102bc0c3206dbd5a801765fceb39c;s=siddhesh@sourceware.org;st=author "Search for commits authored by siddhesh@sourceware.org") |  |
| --- | --- | --- |
|  | Fri, 21 Jan 2022 18:02:56 +0000 (23:32 +0530) |
| committer | [Siddhesh Poyarekar](/git?p=glibc.git;a=search;h=472e799a5f2102bc0c3206dbd5a801765fceb39c;s=Siddhesh+Poyarekar;st=committer "Search for commits committed by Siddhesh Poyarekar") [<siddhesh@sourceware.org>](/git?p=glibc.git;a=search;h=472e799a5f2102bc0c3206dbd5a801765fceb39c;s=siddhesh@sourceware.org;st=committer "Search for commits committed by siddhesh@sourceware.org") |  |
|  | Mon, 24 Jan 2022 06:07:06 +0000 (11:37 +0530) |
| commit | 472e799a5f2102bc0c3206dbd5a801765fceb39c |
| tree | [600e5a557e3bc43d4ff5e43ad3eb2d060e93f795](/git?p=glibc.git;a=tree;h=600e5a557e3bc43d4ff5e43ad3eb2d060e93f795;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [tree](/git?p=glibc.git;a=tree;h=600e5a557e3bc43d4ff5e43ad3eb2d060e93f795;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) |
| parent | [8c8a71c85f2ed5cc90d08d82ce645513fc907cb6](/git?p=glibc.git;a=commit;h=8c8a71c85f2ed5cc90d08d82ce645513fc907cb6) | [commit](/git?p=glibc.git;a=commit;h=8c8a71c85f2ed5cc90d08d82ce645513fc907cb6) | [diff](/git?p=glibc.git;a=commitdiff;h=472e799a5f2102bc0c3206dbd5a801765fceb39c;hp=8c8a71c85f2ed5cc90d08d82ce645513fc907cb6) |

getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)

No valid path returned by getcwd would fit into 1 byte, so reject the

size early and return NULL with errno set to ERANGE.  This change is

prompted by CVE-2021-3999, which describes a single byte buffer

underflow and overflow when all of the following conditions are met:

- The buffer size (i.e. the second argument of getcwd) is 1 byte

- The current working directory is too long

- '/' is also mounted on the current working directory

Sequence of events:

- In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG

  because the linux kernel checks for name length before it checks

  buffer size

- The code falls back to the generic getcwd in sysdeps/posix

- In the generic func, the buf[0] is set to '\0' on line 250

- this while loop on line 262 is bypassed:

    while (!(thisdev == rootdev && thisino == rootino))

  since the rootfs (/) is bind mounted onto the directory and the flow

  goes on to line 449, where it puts a '/' in the byte before the

  buffer.

- Finally on line 458, it moves 2 bytes (the underflowed byte and the

  '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.

- buf is returned on line 469 and errno is not set.

This resolves BZ #28769.

Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>

Reviewed-by: Adhemerval Zanella <adhemerval.zanella@linaro.org>

Signed-off-by: Qualys Security Advisory <qsa@qualys.com>

Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>

(cherry picked from commit [23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e](/git?p=glibc.git;a=object;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e))

| [NEWS](/git?p=glibc.git;a=blob;f=NEWS;h=8d7467d2c1b65833defadcc8113db73c0720c364;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) |  | [diff](/git?p=glibc.git;a=blobdiff;f=NEWS;h=8d7467d2c1b65833defadcc8113db73c0720c364;hp=b4f81c26684c21b3783bebdc28bff30c3887607a;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c;hpb=8c8a71c85f2ed5cc90d08d82ce645513fc907cb6) | [blob](/git?p=glibc.git;a=blob;f=NEWS;h=8d7467d2c1b65833defadcc8113db73c0720c364;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [blame](/git?p=glibc.git;a=blame;f=NEWS;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [history](/git?p=glibc.git;a=history;f=NEWS;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) |
| --- | --- | --- |
| [sysdeps/posix/getcwd.c](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=b6984a382c3e17112b788f15b614709d872cc8aa;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/posix/getcwd.c;h=b6984a382c3e17112b788f15b614709d872cc8aa;hp=13680026ffecbd5148c9ac20becfa04d923ef0c4;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c;hpb=8c8a71c85f2ed5cc90d08d82ce645513fc907cb6) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=b6984a382c3e17112b788f15b614709d872cc8aa;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/posix/getcwd.c;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [history](/git?p=glibc.git;a=history;f=sysdeps/posix/getcwd.c;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) |
| [sysdeps/unix/sysv/linux/Makefile](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=9380d3848d7cc01c34093d7ad37f5edcd25fefe2;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/unix/sysv/linux/Makefile;h=9380d3848d7cc01c34093d7ad37f5edcd25fefe2;hp=76ad06361c4323d74ceaf4d69758eddc87d2e9cd;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c;hpb=8c8a71c85f2ed5cc90d08d82ce645513fc907cb6) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=9380d3848d7cc01c34093d7ad37f5edcd25fefe2;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/unix/sysv/linux/Makefile;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [history](/git?p=glibc.git;a=history;f=sysdeps/unix/sysv/linux/Makefile;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) |
| [sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) | [new file with mode: 0644] | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=472e799a5f2102bc0c3206dbd5a801765fceb39c) |

GNU C Library master sources
[RSS](/git?p=glibc.git;a=rss "log RSS feed")
[Atom](/git?p=glibc.git;a=atom "log Atom feed")

This page took 0.04203 seconds  and 6 git commands to generate.



=== Content from www.kb.cert.org_a6622057_20250108_145104.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* Current:  Search

## Search

#### Keyword

#### Vendor

#### Year

2024

2023

2022

2021

2020

2019

2018

2017

2016

2015

2014

2013

2012

2011

2010

2009

2008

2007

2006

2005

2004

2003

2002

2001

2000

more

less

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

©2025 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from bugzilla.redhat.com_10114b26_20250108_105643.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2024637)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2024637)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2024637)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2024637

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2024637**](show_bug.cgi?id=2024637)
(CVE-2021-3999)
- [CVE-2021-3999](https://access.redhat.com/security/cve/CVE-2021-3999) glibc: Off-by-one buffer overflow/underflow in getcwd()

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2021-3999 glibc: Off-by-one buffer overflow/underflow in getcwd()

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-3999 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2025929](show_bug.cgi?id=2025929) [2025930](show_bug.cgi?id=2025930) [2032279](show_bug.cgi?id=2032279) [2032280](show_bug.cgi?id=2032280) [2032281](show_bug.cgi?id=2032281) [2039676](show_bug.cgi?id=2039676 "CLOSED CURRENTRELEASE - CVE-2021-3999 glibc: Off-by-one buffer overflow/underflow in getcwd() [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2024641](show_bug.cgi?id=2024641) | | TreeView+ | [depends on](buglist.cgi?bug_id=2024637&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2024637&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2021-11-18 14:42 UTC by Pedro Sampaio | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2022-07-12 12:02 UTC ([History](show_activity.cgi?id=2024637)) | | [CC List:](page.cgi?id=fields.html#cclist) | 34 users (show)  aoliva arjun.is ashankar bdettelb caswilli codonell dhalasz dj fjansen fweimer ganandan glibc-bugzilla jburrell jtanner jwong kaycoth law lnacshon mcascell mcermak mfabian micjohns mnewsome pfrankli psegedy rschiron rth security-response-team sipoyare sthirugn tsasak vkrizan vkumar vmugicag | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in glibc. An off-by-one buffer overflow and underflow in getcwd() may lead to memory corruption when the size of the buffer is exactly 1. A local attacker who can control the input buffer and size passed to getcwd() in a setuid program could use this flaw to potentially execute arbitrary code and escalate their privileges on the system. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2022-05-04 01:15:19 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2022:0896](https://access.redhat.com/errata/RHSA-2022%3A0896) | 0 | None | None | None | 2022-03-15 10:21:46 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2024637#c0)  Pedro Sampaio    2021-11-18 14:42:47 UTC  ``` A flaw was found in glibc. The getcwd() function is affected by an off-by-one buffer overflow and underflow that may lead to memory corruption when the size of the buffer is exactly 1 byte.   ```  [Comment 18](show_bug.cgi?id=2024637#c18)  Mauro Matteo Cascella    2022-01-12 08:37:18 UTC  ``` Created glibc tracking bugs for this issue:  Affects: fedora-all [[bug 2039676](show_bug.cgi?id=2039676 "CLOSED CURRENTRELEASE - CVE-2021-3999 glibc: Off-by-one buffer overflow/underflow in getcwd() [fedora-all]")]   ```  [Comment 22](show_bug.cgi?id=2024637#c22)  Siddhesh Poyarekar    2022-01-12 13:45:02 UTC  ``` Filed upstream as: <https://sourceware.org/bugzilla/show_bug.cgi?id=28769>   ```  [Comment 26](show_bug.cgi?id=2024637#c26)  Riccardo Schirone    2022-01-20 10:59:15 UTC  ``` I'm updating the CVSS from 8.1/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H to 7.4/CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H . This changes the Attack Vector from Network (AV:N) to Local (AV:L), because it was wrongly set in the first place. The description of the flaw already mentioned "local attacker" but we forgot to reflect this knowledge in the CVSS.  Triggering this bug indeed requires the attacker to be able to alter the current working directory of a process and configure its environment in specific ways that only a local user could do in reasonable scenarios.   ```  [Comment 27](show_bug.cgi?id=2024637#c27)  Riccardo Schirone    2022-01-20 11:18:21 UTC  ``` This flaw can be triggered only when the following conditions are respected: - The buffer size (i.e. the second argument of getcwd) is 1 byte - The current working directory is too long - '/' is also mounted on the current working directory (e.g. through a mount namespace)   ```  [Comment 28](show_bug.cgi?id=2024637#c28)  Mauro Matteo Cascella    2022-01-24 14:38:00 UTC  ``` Upstream commit: <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e>   ```  [Comment 30](show_bug.cgi?id=2024637#c30)  errata-xmlrpc    2022-03-15 10:21:43 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8  Via RHSA-2022:0896 [https://access.redhat.com/errata/RHSA-2022:0896](https://access.redhat.com/errata/RHSA-2022%3A0896)   ```  [Comment 31](show_bug.cgi?id=2024637#c31)  Product Security DevOps Team    2022-05-04 01:15:16 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2021-3999>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2024637&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from sourceware.org_12889b32_20250108_145111.html ===

[![git](static/git-logo.png)](https://git-scm.com/ "git homepage")[git://sourceware.org](/git) / [glibc.git](/git?p=glibc.git;a=summary) / commit

commit
grep
author
committer
pickaxe
 [?](/git?p=glibc.git;a=search_help "search help") search:

re

[summary](/git?p=glibc.git;a=summary) | [shortlog](/git?p=glibc.git;a=shortlog;h=bcdde07537d733eafe1f28cea3084003e140f5ff) | [log](/git?p=glibc.git;a=log;h=bcdde07537d733eafe1f28cea3084003e140f5ff) | commit | [commitdiff](/git?p=glibc.git;a=commitdiff;h=bcdde07537d733eafe1f28cea3084003e140f5ff) | [tree](/git?p=glibc.git;a=tree;h=1768129f3a2bccf81eddcfedff089badb8f96d55;hb=bcdde07537d733eafe1f28cea3084003e140f5ff)

(parent: [46a70c4](/git?p=glibc.git;a=commit;h=46a70c49ba5a40059c76d5df387ff6e3b045de21)) | [patch](/git?p=glibc.git;a=patch;h=bcdde07537d733eafe1f28cea3084003e140f5ff)

[getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)](/git?p=glibc.git;a=commitdiff;h=bcdde07537d733eafe1f28cea3084003e140f5ff)

| author | [Siddhesh Poyarekar](/git?p=glibc.git;a=search;h=bcdde07537d733eafe1f28cea3084003e140f5ff;s=Siddhesh+Poyarekar;st=author "Search for commits authored by Siddhesh Poyarekar") [<siddhesh@sourceware.org>](/git?p=glibc.git;a=search;h=bcdde07537d733eafe1f28cea3084003e140f5ff;s=siddhesh@sourceware.org;st=author "Search for commits authored by siddhesh@sourceware.org") |  |
| --- | --- | --- |
|  | Fri, 21 Jan 2022 18:02:56 +0000 (23:32 +0530) |
| committer | [Aurelien Jarno](/git?p=glibc.git;a=search;h=bcdde07537d733eafe1f28cea3084003e140f5ff;s=Aurelien+Jarno;st=committer "Search for commits committed by Aurelien Jarno") [<aurelien@aurel32.net>](/git?p=glibc.git;a=search;h=bcdde07537d733eafe1f28cea3084003e140f5ff;s=aurelien@aurel32.net;st=committer "Search for commits committed by aurelien@aurel32.net") |  |
|  | Mon, 24 Jan 2022 15:46:06 +0000 (16:46 +0100) |
| commit | bcdde07537d733eafe1f28cea3084003e140f5ff |
| tree | [1768129f3a2bccf81eddcfedff089badb8f96d55](/git?p=glibc.git;a=tree;h=1768129f3a2bccf81eddcfedff089badb8f96d55;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) | [tree](/git?p=glibc.git;a=tree;h=1768129f3a2bccf81eddcfedff089badb8f96d55;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) |
| parent | [46a70c49ba5a40059c76d5df387ff6e3b045de21](/git?p=glibc.git;a=commit;h=46a70c49ba5a40059c76d5df387ff6e3b045de21) | [commit](/git?p=glibc.git;a=commit;h=46a70c49ba5a40059c76d5df387ff6e3b045de21) | [diff](/git?p=glibc.git;a=commitdiff;h=bcdde07537d733eafe1f28cea3084003e140f5ff;hp=46a70c49ba5a40059c76d5df387ff6e3b045de21) |

getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)

No valid path returned by getcwd would fit into 1 byte, so reject the

size early and return NULL with errno set to ERANGE.  This change is

prompted by CVE-2021-3999, which describes a single byte buffer

underflow and overflow when all of the following conditions are met:

- The buffer size (i.e. the second argument of getcwd) is 1 byte

- The current working directory is too long

- '/' is also mounted on the current working directory

Sequence of events:

- In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG

  because the linux kernel checks for name length before it checks

  buffer size

- The code falls back to the generic getcwd in sysdeps/posix

- In the generic func, the buf[0] is set to '\0' on line 250

- this while loop on line 262 is bypassed:

    while (!(thisdev == rootdev && thisino == rootino))

  since the rootfs (/) is bind mounted onto the directory and the flow

  goes on to line 449, where it puts a '/' in the byte before the

  buffer.

- Finally on line 458, it moves 2 bytes (the underflowed byte and the

  '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.

- buf is returned on line 469 and errno is not set.

This resolves BZ #28769.

Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>

Reviewed-by: Adhemerval Zanella <adhemerval.zanella@linaro.org>

Signed-off-by: Qualys Security Advisory <qsa@qualys.com>

Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>

(cherry picked from commit [23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e](/git?p=glibc.git;a=object;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e))

| [NEWS](/git?p=glibc.git;a=blob;f=NEWS;h=cc026f03b14c887f2ca5b208d1d9675e119312d2;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) |  | [diff](/git?p=glibc.git;a=blobdiff;f=NEWS;h=cc026f03b14c887f2ca5b208d1d9675e119312d2;hp=5352599d7f6d5f08a0c44186f2c27f83e970505a;hb=bcdde07537d733eafe1f28cea3084003e140f5ff;hpb=46a70c49ba5a40059c76d5df387ff6e3b045de21) | [blob](/git?p=glibc.git;a=blob;f=NEWS;h=cc026f03b14c887f2ca5b208d1d9675e119312d2;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) | [blame](/git?p=glibc.git;a=blame;f=NEWS;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) | [history](/git?p=glibc.git;a=history;f=NEWS;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) |
| --- | --- | --- |
| [sysdeps/posix/getcwd.c](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=242e4dbe45a4794bf5bb59a45ff07433838a4c9c;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/posix/getcwd.c;h=242e4dbe45a4794bf5bb59a45ff07433838a4c9c;hp=f11644aae746835238c03fc4dd8fc614e5f95ea5;hb=bcdde07537d733eafe1f28cea3084003e140f5ff;hpb=46a70c49ba5a40059c76d5df387ff6e3b045de21) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=242e4dbe45a4794bf5bb59a45ff07433838a4c9c;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/posix/getcwd.c;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) | [history](/git?p=glibc.git;a=history;f=sysdeps/posix/getcwd.c;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) |
| [sysdeps/unix/sysv/linux/Makefile](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=9531641f8222547c3eec956647fa6c86a1b7c295;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/unix/sysv/linux/Makefile;h=9531641f8222547c3eec956647fa6c86a1b7c295;hp=472eab700d249f6db9034e8a7687a37fa9fdde6a;hb=bcdde07537d733eafe1f28cea3084003e140f5ff;hpb=46a70c49ba5a40059c76d5df387ff6e3b045de21) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=9531641f8222547c3eec956647fa6c86a1b7c295;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/unix/sysv/linux/Makefile;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) | [history](/git?p=glibc.git;a=history;f=sysdeps/unix/sysv/linux/Makefile;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) |
| [sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) | [new file with mode: 0644] | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=bcdde07537d733eafe1f28cea3084003e140f5ff) |

GNU C Library master sources
[RSS](/git?p=glibc.git;a=rss "log RSS feed")
[Atom](/git?p=glibc.git;a=atom "log Atom feed")

This page took 0.046794 seconds  and 6 git commands to generate.



=== Content from oss-security.openwall.org_40b4e6ca_20250108_145101.html ===

[[[vendors](/wiki/vendors?do=backlink "Backlinks")]]

[OSS-Security](/wiki/welcome "[H]")

Trace: • [vendors](/wiki/vendors "vendors")

### Table of Contents

* [Security-Related Vendor Information](#security-related-vendor-information)
  + [Amazon Linux AMI / Amazon Web Services](#amazon-linux-amiamazon-web-services)
  + [Apple Inc.](#apple-inc)
  + [Arch Linux](#arch-linux)
  + [Debian](#debian)
  + [DragonFly BSD](#dragonfly-bsd)
  + [Enea](#enea)
  + [FreeBSD](#freebsd)
  + [Frugalware Linux](#frugalware-linux)
  + [Gentoo Linux](#gentoo-linux)
  + [Homebrew](#homebrew)
  + [IBM](#ibm)
  + [Mageia](#mageia)
  + [Microsoft Linux Systems Group](#microsoft-linux-systems-group)
  + [MontaVista Software, LLC.](#montavista-software-llc)
  + [NetBSD](#netbsd)
  + [OpenBSD](#openbsd)
  + [OpenSUSE and SUSE](#opensuse-and-suse)
  + [Openwall](#openwall)
  + [Oracle Linux](#oracle-linux)
  + [Parallels Inc.](#parallels-inc)
  + [pkgsrc (NetBSD Packages Collection for multiple OS's incl. \*Bsd, Linux, Solaris, OSX, etc.)](#pkgsrc-netbsd-packages-collection-for-multiple-os-s-incl-bsd-linux-solaris-osx-etc)
  + [Qlustar](#qlustar)
  + [Red Hat Inc](#red-hat-inc)
  + [Solaris](#solaris)
  + [TurrisOS](#turrisos)
  + [Ubuntu](#ubuntu)
  + [VMware, Inc.](#vmware-inc)
  + [Wind River](#wind-river)
* [Other Resources](#other-resources)

# Security-Related Vendor Information

This page lists security contacts, bug tracker links, links to advisories, etc. for various open source-providing vendors, such as distributors of Linux, \*BSD, and other related operating systems.

When adding to this page, please include the following vendor information:

1. link to bug tracker (i.e. Bugzilla)
2. link to security advisories, errata, or any other page that provides notification of security-related updates/changes
3. email address for the security contact

As well, please keep this list in alphabetical order.

## Amazon Linux AMI / Amazon Web Services

* Security bulletins: [Amazon Linux AMI Security Center](https://aws.amazon.com/amazon-linux-ami/security-bulletins/ "https://aws.amazon.com/amazon-linux-ami/security-bulletins/") ([RSS feed](http://aws.amazon.com/rss/amazon-linux-ami.rss "http://aws.amazon.com/rss/amazon-linux-ami.rss"))
* Security contact: aws [dash] security [at] amazon [dot] com [PGP key](https://aws.amazon.com/security/aws-pgp-public-key/ "https://aws.amazon.com/security/aws-pgp-public-key/")
* [AWS Security Center](http://aws.amazon.com/security/ "http://aws.amazon.com/security/")
* [Vulnerability reporting information](http://aws.amazon.com/security/vulnerability-reporting/ "http://aws.amazon.com/security/vulnerability-reporting/")
## Apple Inc.

* [Security process information](http://www.apple.com/support/security/ "http://www.apple.com/support/security/")
* Security issues should be sent to product [dash] security [at] apple [dot] com
* Alternatively, reported through the [Apple Bug Reporter](https://developer.apple.com/bug-reporting/ "https://developer.apple.com/bug-reporting/")
* [Security advisories](https://support.apple.com/en-au/HT201222 "https://support.apple.com/en-au/HT201222")
## Arch Linux

* [Arch Linux bug tracker (public issues)](https://bugs.archlinux.org "https://bugs.archlinux.org")
* Security issues should be sent to security [at] archlinux [dot] org
## Debian

* [Debian bug tracker (public issues only)](http://bugs.debian.org "http://bugs.debian.org"), [Security issue tracker (public issues only)](http://security-tracker.debian.org "http://security-tracker.debian.org")
* Security issues should be sent to security [at] debian [dot] org
* Recent advisories are listed upon [our front page](http://security.debian.org/ "http://security.debian.org/")
## DragonFly BSD

* DragonFly Security Officer: security [at] dragonflybsd [dot] org ([PGP key](http://www.dragonflybsd.org/keys/ "http://www.dragonflybsd.org/keys/"))
## Enea

* [The process for receiving security advisories requires a Support or Maintenance subscription](http://lists.enea.com/mailman/listinfo/security-announce "http://lists.enea.com/mailman/listinfo/security-announce")
* [Bug tracking database - access requires a Support or Maintenance subscription](http://eneaissues.enea.com/ "http://eneaissues.enea.com/")
* Enea Security: [http://www.enea.com/solutions/Enea-Linux/Security](http://www.enea.com/solutions/Enea-Linux/Security "http://www.enea.com/solutions/Enea-Linux/Security")
* Enea security contacts can be reached at security [at] enea [dot] com
## FreeBSD

* [How and where to report a FreeBSD security issue](https://www.freebsd.org/security/reporting.html "https://www.freebsd.org/security/reporting.html")
  + All FreeBSD security issues should be reported to the FreeBSD Security Team at secteam [at] FreeBSD [dot] org
  + For a higher level of confidentiality, PGP-encrypted e-mail may be sent to the Security Officer Team at security [dash] officer [at] FreeBSD [dot] org ([PGP key](https://www.freebsd.org/security/so_public_key.asc "https://www.freebsd.org/security/so_public_key.asc"))
## Frugalware Linux

* Security issues should be sent to frugalware [dash] security [dash] private [at] frugalware [dot] org
* Advisories are published for the stable branch at the [Frugalware Security mailing list](http://frugalware.org/mailman/listinfo/frugalware-security/ "http://frugalware.org/mailman/listinfo/frugalware-security/")
## Gentoo Linux

* [Gentoo Bugzilla](https://bugs.gentoo.org/ "https://bugs.gentoo.org/") – see “Gentoo Security” product.
* Gentoo Linux Security Advisories (GLSA) published via [Mail](https://archives.gentoo.org/gentoo-announce/ "https://archives.gentoo.org/gentoo-announce/") ([subscribe](https://www.gentoo.org/get-involved/mailing-lists/ "https://www.gentoo.org/get-involved/mailing-lists/")), [HTTP](https://security.gentoo.org/glsa/ "https://security.gentoo.org/glsa/") and [Feeds](https://security.gentoo.org/subscribe "https://security.gentoo.org/subscribe").
* [Security Website](https://www.gentoo.org/support/security/ "https://www.gentoo.org/support/security/") with [Vulnerability Policy](https://www.gentoo.org/support/security/vulnerability-treatment-policy.html "https://www.gentoo.org/support/security/vulnerability-treatment-policy.html") and confidential contacts.
* Security contact: security [at] gentoo [dot] org, #gentoo-security on irc.freenode.net.
## Homebrew

* [Homebrew issue tracker](https://github.com/Homebrew/homebrew/issues "https://github.com/Homebrew/homebrew/issues")
* Security contact: security [at] brew [dot] sh
## IBM

* [How and where to report an IBM Product Security Incident](http://www-03.ibm.com/security/secure-engineering/report.html "http://www-03.ibm.com/security/secure-engineering/report.html")
* [Security Bulletins](http://www.ibm.com/connections/blogs/PSIRT "http://www.ibm.com/connections/blogs/PSIRT")
* [IBM Customer Support Portal](http://www-947.ibm.com/support/entry/portal/support "http://www-947.ibm.com/support/entry/portal/support")
* IBM Product Security Incident Support Team (PSIRT): psirt [at] us [dot] ibm [dot] com [PGP key](http://www-03.ibm.com/security/secure-engineering/IBM_PSIRT.asc "http://www-03.ibm.com/security/secure-engineering/IBM_PSIRT.asc")
## Mageia

* [Mageia Bugzilla](https://bugs.mageia.org "https://bugs.mageia.org")
* [Security and bugfix information)](http://advisories.mageia.org "http://advisories.mageia.org")
* Security contact: security [at] mageia [dot] org
## Microsoft Linux Systems Group

* Report security issues through the [Microsoft Security Response Center](https://www.microsoft.com/en-us/msrc "https://www.microsoft.com/en-us/msrc")
* Details on the reporting procedure are available  [here](https://portal.msrc.microsoft.com/en-us/engage/sbr "https://portal.msrc.microsoft.com/en-us/engage/sbr")
* Information about the bounty program [here](https://www.microsoft.com/en-us/msrc/bounty?rtc=1 "https://www.microsoft.com/en-us/msrc/bounty?rtc=1")
## MontaVista Software, LLC.

* The process for receiving security advisories requires a Support or Maintenance subscription.
* Bug tracking database - access requires a Support or Maintenance subscription.
* [Security Advisories](https://support.mvista.com/Security/CVE/ "https://support.mvista.com/Security/CVE/")
* MontaVista security contacts can be reached at security [at] mvista [dot] com [PGP key](https://support.mvista.com/Security/mv_psirt_pub_key.txt "https://support.mvista.com/Security/mv_psirt_pub_key.txt")
## NetBSD

* [Bug tracking database](http://www.netbsd.org/support/query-pr.html "http://www.netbsd.org/support/query-pr.html")
* [Contact and errata information](http://www.netbsd.org/support/security/ "http://www.netbsd.org/support/security/")
* Security contact: security [dash] alert [at] NetBSD [dot] org
* (for pkgsrc please see separate entry below)
## OpenBSD

* Bug tracking mailing list: bugs [at] openbsd [dot] org ([Archive](https://marc.info/?l=openbsd-bugs "https://marc.info/?l=openbsd-bugs"), [Subscribe](https://lists.openbsd.org/cgi-bin/mj_wwwusr?extra=bugs&func=lists-full-long "https://lists.openbsd.org/cgi-bin/mj_wwwusr?extra=bugs&func=lists-full-long"))
* [Security and errata information](https://www.openbsd.org/security.html "https://www.openbsd.org/security.html")
* Security contact: deraadt [at] openbsd [dot] org
## OpenSUSE and SUSE

* [Bugzilla](http://bugzilla.novell.com/ "http://bugzilla.novell.com/")
* [Security-support page](http://www.novell.com/linux/security/securitysupport.html "http://www.novell.com/linux/security/securitysupport.html")
* [SUSE Security Announcements RSS feed](http://www.novell.com/linux/security/suse_security.xml "http://www.novell.com/linux/security/suse_security.xml")
* [Mailing-list: opensuse-security-announce and opensuse-security](http://en.opensuse.org/Communicate/Mailinglists "http://en.opensuse.org/Communicate/Mailinglists")
* Security contact: security [at] suse [dot] de
## Openwall

* [Changes in the currently-maintained stable branch](http://www.openwall.com/Owl/CHANGES-stable.shtml "http://www.openwall.com/Owl/CHANGES-stable.shtml") (any security fixes are marked as such, along with issue severity information)
* [Changes in the development branch](http://www.openwall.com/Owl/CHANGES-current.shtml "http://www.openwall.com/Owl/CHANGES-current.shtml") (ditto)
* Security contact: security [at] owl [dot] openwall [dot] com
## Oracle Linux

* [Oracle Bugzilla](http://bugzilla.oracle.com/bugzilla/ "http://bugzilla.oracle.com/bugzilla/")
* [Oracle Linux Erratas](http://oss.oracle.com/pipermail/el-errata/ "http://oss.oracle.com/pipermail/el-errata/") includes security advisories
* [Security contact information](http://www.oracle.com/us/support/assurance/reporting/index.html "http://www.oracle.com/us/support/assurance/reporting/index.html") - email for reporting vulnerabilities: secalert\_us [at] oracle [dot] com
* [Oracle Linux](http://www.oracle.com/linux "http://www.oracle.com/linux") introduction, downloads, support offerings
* [Oracle security fix policy](http://www.oracle.com/us/support/assurance/fixing-policies/index.html "http://www.oracle.com/us/support/assurance/fixing-policies/index.html")
## Parallels Inc.

* Update announcements published via [Parallels KnowledgeBase](http://kb.sp.parallels.com "http://kb.sp.parallels.com") and [Parallels Cloud Server RSS](http://sp.parallels.com/products/pcs/rss "http://sp.parallels.com/products/pcs/rss"), [Parallels Containers for Linux RSS](http://sp.parallels.com/products/pvc/pcl-rss "http://sp.parallels.com/products/pvc/pcl-rss").
* Security contact: security [at] parallels [dot] com
## pkgsrc (NetBSD Packages Collection for multiple OS's incl. \*Bsd, Linux, Solaris, OSX, etc.)

* For issues in NetBSD please see the separate entry
* [Bug tracking database](http://www.netbsd.org/support/query-pr.html "http://www.netbsd.org/support/query-pr.html") – select 'pkg' Category
* [Vulnerable package versions database](http://ftp.netbsd.org/pub/NetBSD/packages/vulns/pkg-vulnerabilities "http://ftp.netbsd.org/pub/NetBSD/packages/vulns/pkg-vulnerabilities")
* Security contact: pkgsrc [dash] security [at] NetBSD [dot] org
* [PGP key](http://ftp.netbsd.org/pub/NetBSD/security/PGP/pkgsrc-security%40NetBSD.org.asc "http://ftp.netbsd.org/pub/NetBSD/security/PGP/pkgsrc-security@NetBSD.org.asc")
## Qlustar

* Qlustar Security Advisories (QSA) [Archive](https://qlustar.com/security-advisories "https://qlustar.com/security-advisories") ([subscribe](https://qlustar.com/newsletter/subscriptions "https://qlustar.com/newsletter/subscriptions")).
* Security contact: security [at] qlustar [dot] com
## Red Hat Inc

* Report security issues to secalert [at] redhat [dot] com or see [https://www.redhat.com/security/team/contact/](https://www.redhat.com/security/team/contact/ "https://www.redhat.com/security/team/contact/") for our keys and policies
* Advisories for all Red Hat products are published to [the RHSA announce mailing list](http://www.redhat.com/archives/rhsa-announce/ "http://www.redhat.com/archives/rhsa-announce/") since Nov 2007 (older are at [http://www.redhat.com/archives/enterprise-watch-list/](http://www.redhat.com/archives/enterprise-watch-list/ "http://www.redhat.com/archives/enterprise-watch-list/")).
## Solaris

* [Oracle Critical Patch Updates and Security Alerts](http://www.oracle.com/technetwork/topics/security/alerts-086861.html "http://www.oracle.com/technetwork/topics/security/alerts-086861.html")
* [Security contact information](http://www.oracle.com/us/support/assurance/reporting/index.html "http://www.oracle.com/us/support/assurance/reporting/index.html") - email for reporting vulnerabilities: secalert\_us [at] oracle [dot] com
* [Oracle security fix policy](http://www.oracle.com/us/support/assurance/fixing-policies/index.html "http://www.oracle.com/us/support/assurance/fixing-policies/index.html")
* [Changes in security policies for the Sun product lines](http://www.oracle.com/technetwork/topics/security/changesforsunsecuritypolicies-162219.html "http://www.oracle.com/technetwork/topics/security/changesforsunsecuritypolicies-162219.html")
## TurrisOS

* Use [https://gitlab.labs.nic.cz/turris/openwrt/issues](https://gitlab.labs.nic.cz/turris/openwrt/issues "https://gitlab.labs.nic.cz/turris/openwrt/issues") to report TurrisOS bugs (private security bugs can be opened by checking the “This issue is confidential and should only be visible to team members with at least Reporter access.” box).
* Security contacts for TurrisOS can be reached at security [at] turris [dot] cz.
## Ubuntu

* Use [Launchpad](https://launchpad.net/ubuntu/%2Bfilebug "https://launchpad.net/ubuntu/+filebug") to report Ubuntu bugs
  + Private security bugs can be opened by selecting the `“Private Security”` option in the `“This bug contains information that is:”` drop-down menu
* [Ubuntu Security Notices](https://usn.ubuntu.com/ "https://usn.ubuntu.com/") are sent to the [ubuntu-security-announce mailing list](https://lists.ubuntu.com/archives/ubuntu-security-announce/ "https://lists.ubuntu.com/archives/ubuntu-security-announce/")
* Security contacts for Ubuntu can be reached at security [at] ubuntu [dot] com or see the [Ubuntu Security FAQ](https://wiki.ubuntu.com/SecurityTeam/FAQ#Contact "https://wiki.ubuntu.com/SecurityTeam/FAQ#Contact") for more information
## VMware, Inc.

* VMware Security Advisories (VMSAs) are posted to [http://www.vmware.com/security/advisories](http://www.vmware.com/security/advisories "http://www.vmware.com/security/advisories").
* You can sign up for receiving security advisories at [http://www.vmware.com/security](http://www.vmware.com/security "http://www.vmware.com/security").
* Report security issues to security [at] vmware [dot] com or see the [VMware Security Response Policy](http://www.vmware.com/support/policies/security_response.html "http://www.vmware.com/support/policies/security_response.html") for more information.
## Wind River

* The process for receiving security advisories requires a Support or Maintenance subscription. [https://support.windriver.com/olsPortal/faces/basic/portal.jspx](https://support.windriver.com/olsPortal/faces/basic/portal.jspx "https://support.windriver.com/olsPortal/faces/basic/portal.jspx")
* [Info on what Wind River publicly disclose and what they don't; RSS feeds with the publicly disclosed info on security issues](http://www.openwall.com/lists/oss-security/2011/05/02/9 "http://www.openwall.com/lists/oss-security/2011/05/02/9")
* Wind River Linux security contacts can be reached at security [dash] alert [at] windriver [dot] com.
# Other Resources

There are separate wiki pages with similar information on [individual Open Source projects](/wiki/software "software") and the [infrastructure](/wiki/infrastructure "infrastructure").

There's a [similar page on the Distributions Wiki](http://distributions.freedesktop.org/wiki/DistributionLocations "http://distributions.freedesktop.org/wiki/DistributionLocations").

vendors.txt · Last modified: 2022/12/01 20:40 by akuster

Except where otherwise noted, content on this wiki is licensed under the following license: [CC Attribution-Noncommercial-Share Alike 3.0 Unported](https://creativecommons.org/licenses/by-nc-sa/3.0/)

[![Recent changes RSS feed](/wiki/lib/tpl/local/images/button-rss.png)](/wiki/feed.php "Recent changes RSS feed")
[![](/wiki/lib/images/license/button/cc-by-nc-sa.png)](https://creativecommons.org/licenses/by-nc-sa/3.0/ "CC Attribution-Noncommercial-Share Alike 3.0 Unported")
[![Donate to DokuWiki](/wiki/lib/tpl/local/images/button-donate.gif)](https://www.dokuwiki.org/donate "Donate to DokuWiki")
[![Powered by PHP](/wiki/lib/tpl/local/images/button-php.gif)](https://www.php.net "Powered by PHP")
[![Valid XHTML 1.0](/wiki/lib/tpl/local/images/button-xhtml.png)](https://validator.w3.org/check/referer "Valid XHTML 1.0")
[![Valid CSS](/wiki/lib/tpl/local/images/button-css.png)](https://jigsaw.w3.org/css-validator/check/referer?profile=css3 "Valid CSS")
[![Driven by DokuWiki](/wiki/lib/tpl/local/images/button-dw.png)](https://dokuwiki.org/ "Driven by DokuWiki")
[![Powered by OpenVZ](/wiki/lib/tpl/local/images/OpenVZ-80x15-cd.png)](https://openvz.org "Powered by OpenVZ - OS virtualization solution for Linux")
[![Powered by Openwall GNU/*/Linux](/wiki/lib/tpl/local/images/Owl-80x15-4.png)](https://www.openwall.com/Owl/ "Powered by Openwall GNU/*/Linux - security-enhanced \"Linux distribution\"")

![](/wiki/lib/exe/indexer.php?id=vendors&1736347858)


=== Content from marc.info_bafa4df2_20250108_145101.html ===


| Search: [] List [] Subjects [] Authors [] Bodies for list 'full-disclosure' |
| --- |

Set Page Width:
[ [80](?l=full-disclosure&s=CVE-2021-3999),&w=1) ]
[ [90](?l=full-disclosure&s=CVE-2021-3999),&w=2) ]
[ [100](?l=full-disclosure&s=CVE-2021-3999),&w=3) ]
[ [120](?l=full-disclosure&s=CVE-2021-3999),&w=4) ]

[![Viewing messages in list](images/folderopen.gif) **full-disclosure**](?l=full-disclosure&r=1&w=2)

No hits found for 'cve-2021-3999'

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.openwall.com_ed83ae2d_20250108_105646.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20220124140408.GA21504@localhost.localdomain>
Date: Mon, 24 Jan 2022 14:05:01 +0000
From: Qualys Security Advisory <qsa@...lys.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: CVE-2021-3998 and CVE-2021-3999 in glibc's realpath() and getcwd()

Hi all,

We discovered two vulnerabilities in the glibc, CVE-2021-3998 in
realpath() and CVE-2021-3999 in getcwd(). Patches are now available at
(many thanks to Siddhesh Poyarekar and Red Hat Product Security):

<https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=ee8d5e33adb284601c00c94687bc907e10aec9bb>
<https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=f7a79879c0b2bef0dadd6caaaeeb0d26423e04e5>

<https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e>
<https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=472e799a5f2102bc0c3206dbd5a801765fceb39c>

Below is a short write-up (which is part of a longer advisory that is
mostly unrelated to the glibc and that we will publish at a later date):

========================================================================
CVE-2021-3998: Unexpected return value from glibc's realpath()
========================================================================

While auditing umount and fusermount, we also discovered a vulnerability
in the glibc's realpath() function, which is used internally by various
programs. Normally, when the output buffer "resolved" that is passed to
realpath() is not NULL, then realpath() either returns NULL on failure,
or it returns the output buffer "resolved" on success. Unfortunately,
since commit c6e0b0b ("stdlib: Sync canonicalize with gnulib") from
January 2021, realpath() can mistakenly return a malloc()ated buffer
that is neither NULL nor the output buffer "resolved":

------------------------------------------------------------------------
430 char *
431 __realpath (const char *name, char *resolved)
432 {
...
437   struct scratch_buffer rname_buffer;
438   return realpath_stk (name, resolved, &rname_buffer);
439 }
------------------------------------------------------------------------
197 static char *
198 realpath_stk (const char *name, char *resolved,
199               struct scratch_buffer *rname_buf)
200 {
...
399   failed = false;
...
403   if (resolved != NULL && dest - rname <= get_path_max ())
404     rname = strcpy (resolved, rname);
...
410   if (failed || rname == resolved)
411     {
412       scratch_buffer_free (rname_buf);
413       return failed ? NULL : resolved;
414     }
415
416   return scratch_buffer_dupfree (rname_buf, dest - rname);
417 }
------------------------------------------------------------------------

For example, if the input path "name" is "." and if the current working
directory is longer than PATH_MAX, then:

- at line 399, "failed" is set to false;

- at lines 403-404, "rname" is NOT set to "resolved" and "resolved" is
  left untouched and uninitialized (because "dest - rname" is longer
  than PATH_MAX);

- the code block at lines 410-414 is skipped (because "failed" is false
  and "rname" is not "resolved");

- at line 416, scratch_buffer_dupfree() returns a malloc()ated buffer
  that is NOT the output buffer "resolved".

The consequences of this vulnerability depend on the affected programs;
for example, fusermount (a SUID-root program) can disclose sensitive
information (pointers) when displaying the contents of a stack-based
buffer that is mistakenly left uninitialized by realpath() (we tested
this proof of concept on Ubuntu 21.04):

------------------------------------------------------------------------
$ gcc -o CVE-2021-3998-fusermount CVE-2021-3998-fusermount.c
$ ./CVE-2021-3998-fusermount > CVE-2021-3998-fusermount.output
...

$ hexdump -C CVE-2021-3998-fusermount.output
00000000  2f 75 73 72 2f 62 69 6e  2f 66 75 73 65 72 6d 6f  |/usr/bin/fusermo|
00000010  75 6e 74 3a 20 65 6e 74  72 79 20 66 6f 72 20 f0  |unt: entry for .|
00000020  83 9b 99 ff 7f 20 6e 6f  74 20 66 6f 75 6e 64 20  |..... not found |
00000030  69 6e 20 2f 65 74 63 2f  6d 74 61 62 0a 0a 2f 75  |in /etc/mtab../u|
00000040  73 72 2f 62 69 6e 2f 66  75 73 65 72 6d 6f 75 6e  |sr/bin/fusermoun|
00000050  74 3a 20 65 6e 74 72 79  20 66 6f 72 20 39 ac b7  |t: entry for 9..|
00000060  a5 a2 7f 20 6e 6f 74 20  66 6f 75 6e 64 20 69 6e  |... not found in|
00000070  20 2f 65 74 63 2f 6d 74  61 62 0a 0a              | /etc/mtab..|
------------------------------------------------------------------------

========================================================================
CVE-2021-3999: Off-by-one buffer overflow/underflow in glibc's getcwd()
========================================================================

While studying the vulnerability in realpath(), we also discovered a
vulnerability in the glibc's getcwd() function (which is used internally
by realpath() to resolve relative pathnames) -- an off-by-one buffer
overflow and underflow, but if and only if the "size" of "buf" is
exactly 1:

------------------------------------------------------------------------
 48 __getcwd (char *buf, size_t size)
 49 {
 ..
 54   size_t alloc_size = size;
 ..
 76     path = buf;
 ..
 80   retval = INLINE_SYSCALL (getcwd, 2, path, alloc_size);
...
100   if (retval >= 0 || errno == ENAMETOOLONG)
101     {
...
110       result = __getcwd_generic (path, size);
------------------------------------------------------------------------
158 __getcwd_generic (char *buf, size_t size)
159 {
...
187   size_t allocated = size;
...
247     dir = buf;
248
249   dirp = dir + allocated;
250   *--dirp = '\0';
...
262   while (!(thisdev == rootdev && thisino == rootino))
263     {
...
441     }
...
449   if (dirp == &dir[allocated - 1])
450     *--dirp = '/';
...
457   used = dir + allocated - dirp;
458   memmove (dir, dirp, used);
------------------------------------------------------------------------

If, at line 48, the "size" of "buf" is exactly 1:

- and if, at line 80, the kernel's getcwd() syscall fails with the error
  ENAMETOOLONG (because the current working directory is longer than
  PATH_MAX),

- then, at line 110, a generic implementation of getcwd() is called;

- at line 250, a null byte is written to "dirp", which points exactly to
  "buf" (because "size", and hence "allocated", are exactly 1);

- if the code block at lines 262-441 is skipped entirely (if the current
  working directory corresponds to the "/" directory),

- then, at lines 449-450, a slash is written to "buf-1" (an off-by-one
  buffer underflow, because at line 449 "dirp" was still pointing
  exactly to "buf"),

- and, at lines 457-458, a null byte is written to "buf+1" (an
  off-by-one buffer overflow, because at line 457 "used" is exactly 2).

It may seem impossible to satisfy the condition at line 100 (the current
working directory is longer than PATH_MAX) and the condition at line 262
(the current working directory corresponds to the "/" directory), but in
reality we can:

- in a child process:

  - create an unprivileged mount namespace;

  - create a directory longer than PATH_MAX;

  - bind-mount "/" onto this directory;

  - open() this directory and send its file descriptor to the parent
    process (outside the unprivileged mount namespace);

- in the parent process:

  - receive the file descriptor of this directory (which corresponds to
    "/" and is longer than PATH_MAX) and fchdir() to it;

  - execute a SUID program that calls getcwd() with a buffer of size 1,
    which triggers the off-by-one buffer overflow and underflow.

Apparently, this vulnerability was introduced in February 1995 by the
very first commit in the glibc's git history (28f540f, "initial import")
and could be triggered without an unprivileged mount namespace, by
simply chdir()ing to the "/" directory:

------------------------------------------------------------------------
190 getcwd (buf, size)
...
218     path = buf;
...
226   pathp = path + size;
227   *--pathp = '\0';
...
242   while (!(thisdev == rootdev && thisino == rootino))
243     {
...
351     }
352
353   if (pathp == &path[size - 1])
354     *--pathp = '/';
...
359   memmove (path, pathp, path + size - pathp);
------------------------------------------------------------------------

Although "the size of buf is exactly 1" is a strong requirement,
vulnerable code like the following may exist in the wild:

------------------------------------------------------------------------
#include <unistd.h>
#include <stdio.h>

int main(int argc, char * argv[]) {
    char buf[4096];
    int len = snprintf(buf, sizeof(buf), "%s: cwd is ", argv[0]);
    if (len <= 0 || (unsigned)len >= sizeof(buf)) return __LINE__;
    if (!getcwd(buf + len, sizeof(buf) - len)) return __LINE__;
    puts(buf);
    return 0;
}
------------------------------------------------------------------------

Thank you very much! We are at your disposal for questions, comments,
and further discussions.

With best regards,

--
the Qualys Security Advisory team
```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.debian.org_5d3c5c34_20250108_105643.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DLA 3152-1] glibc security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3152-1] glibc security update
* *From*: Helmut Grohne <helmut@subdivi.de>
* *Date*: Mon, 17 Oct 2022 17:54:41 +0200
* *Message-id*: <Y016weMM/05byFW0@alf.mars>
* *Mail-followup-to*: Helmut Grohne <helmut@subdivi.de>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3152-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Helmut Grohne
October 17, 2022                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : glibc
Version        : 2.28-10+deb10u2
CVE ID         : CVE-2016-10228 CVE-2019-19126 CVE-2019-25013
                 CVE-2020-1752 CVE-2020-6096 CVE-2020-10029
                 CVE-2020-27618 CVE-2021-3326 CVE-2021-3999
                 CVE-2021-27645 CVE-2021-33574 CVE-2021-35942
                 CVE-2022-23218 CVE-2022-23219
Debian Bug     : 856503 945250 953108 953788 961452 973914 979273 981198
                 983479 989147 990542

This update fixes a wide range of vulnerabilities. A significant portion
affects character set conversion.

CVE-2016-10228

    The iconv program in the GNU C Library when invoked with multiple
    suffixes in the destination encoding (TRANSLATE or IGNORE) along with
    the -c option, enters an infinite loop when processing invalid
    multi-byte input sequences, leading to a denial of service.

CVE-2019-19126

    On the x86-64 architecture, the GNU C Library fails to ignore the
    LD_PREFER_MAP_32BIT_EXEC environment variable during program
    execution after a security transition, allowing local attackers to
    restrict the possible mapping addresses for loaded libraries and
    thus bypass ASLR for a setuid program.

CVE-2019-25013

    The iconv feature in the GNU C Library, when processing invalid
    multi-byte input sequences in the EUC-KR encoding, may have a buffer
    over-read.

CVE-2020-10029

    The GNU C Library could overflow an on-stack buffer during range
    reduction if an input to an 80-bit long double function contains a
    non-canonical bit pattern, a seen when passing a
    0x5d414141414141410000 value to sinl on x86 targets. This is related
    to sysdeps/ieee754/ldbl-96/e_rem_pio2l.c.

CVE-2020-1752

    A use-after-free vulnerability introduced in glibc was found in the
    way the tilde expansion was carried out. Directory paths containing
    an initial tilde followed by a valid username were affected by this
    issue. A local attacker could exploit this flaw by creating a
    specially crafted path that, when processed by the glob function,
    would potentially lead to arbitrary code execution.

CVE-2020-27618

    The iconv function in the GNU C Library, when processing invalid
    multi-byte input sequences in IBM1364, IBM1371, IBM1388, IBM1390,
    and IBM1399 encodings, fails to advance the input state, which could
    lead to an infinite loop in applications, resulting in a denial of
    service, a different vulnerability from CVE-2016-10228.

CVE-2020-6096

    An exploitable signed comparison vulnerability exists in the ARMv7
    memcpy() implementation of GNU glibc. Calling memcpy() (on ARMv7
    targets that utilize the GNU glibc implementation) with a negative
    value for the 'num' parameter results in a signed comparison
    vulnerability. If an attacker underflows the 'num' parameter to
    memcpy(), this vulnerability could lead to undefined behavior such as
    writing to out-of-bounds memory and potentially remote code
    execution.  Furthermore, this memcpy() implementation allows for
    program execution to continue in scenarios where a segmentation fault
    or crash should have occurred. The dangers occur in that subsequent
    execution and iterations of this code will be executed with this
    corrupted data.

CVE-2021-27645

    The nameserver caching daemon (nscd) in the GNU C Library, when
    processing a request for netgroup lookup, may crash due to a
    double-free, potentially resulting in degraded service or Denial of
    Service on the local system. This is related to netgroupcache.c.

CVE-2021-3326

    The iconv function in the GNU C Library, when processing invalid
    input sequences in the ISO-2022-JP-3 encoding, fails an assertion in
    the code path and aborts the program, potentially resulting in a
    denial of service.

CVE-2021-33574

    The mq_notify function in the GNU C Library has a use-after-free. It
    may use the notification thread attributes object (passed through
    its struct sigevent parameter) after it has been freed by the caller,
    leading to a denial of service (application crash) or possibly
    unspecified other impact.

CVE-2021-35942

    The wordexp function in the GNU C Library may crash or read arbitrary
    memory in parse_param (in posix/wordexp.c) when called with an
    untrusted, crafted pattern, potentially resulting in a denial of
    service or disclosure of information. This occurs because atoi was
    used but strtoul should have been used to ensure correct calculations.

CVE-2021-3999

    An off-by-one buffer overflow and underflow in getcwd() may lead to
    memory corruption when the size of the buffer is exactly 1. A local
    attacker who can control the input buffer and size passed to getcwd()
    in a setuid program could use this flaw to potentially execute
    arbitrary code and escalate their privileges on the system.

CVE-2022-23218

    The deprecated compatibility function svcunix_create in the sunrpc
    module of the GNU C Library copies its path argument on the stack
    without validating its length, which may result in a buffer overflow,
    potentially resulting in a denial of service or (if an application
    is not built with a stack protector enabled) arbitrary code execution.

CVE-2022-23219

    The deprecated compatibility function clnt_create in the sunrpc module
    of the GNU C Library copies its hostname argument on the stack without
    validating its length, which may result in a buffer overflow,
    potentially resulting in a denial of service or (if an application is
    not built with a stack protector enabled) arbitrary code execution.

For Debian 10 buster, these problems have been fixed in version
2.28-10+deb10u2.

We recommend that you upgrade your glibc packages.

For the detailed security status of glibc please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/glibc>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpQDxrRyjhTi.pgp)**

*Description:* PGP signature

---



=== Content from access.redhat.com_37bd4327_20250108_145107.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2024 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_892de687_20250108_145059.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%3Fquery%3DCVE-2021-3999%29%2F%255Bcode%255D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode%26q%3D%2522CVE-2021-3999%2522%29%2F%255Bissues%255D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DIssues%26q%3D%2522CVE-2021-3999%2522%29%2C)

**GitHub Advisory Database**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

"CVE-2021-3999"),

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%3Fquery%3DCVE-2021-3999%29%2F%255Bcode%255D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode%26q%3D%2522CVE-2021-3999%2522%29%2F%255Bissues%255D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DIssues%26q%3D%2522CVE-2021-3999%2522%29%2C)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# GitHub Advisory Database

Security vulnerability database inclusive of CVEs and GitHub originated security advisories from the world of open source software.

## GitHub reviewed advisories

* [All reviewed
  21,003](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed)
* [Composer
  4,299](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Acomposer)
* [Erlang
  31](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Aerlang)
* [GitHub Actions
  21](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Aactions)
* [Go
  2,064](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Ago)
* [Maven
  5,240](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Amaven)
* [npm
  3,744](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Anpm)
* [NuGet
  668](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Anuget)
* [pip
  3,424](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Apip)
* [Pub
  12](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Apub)
* [RubyGems
  892](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Arubygems)
* [Rust
  877](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Arust)
* [Swift
  36](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Aswift)

## Unreviewed advisories

* [All unreviewed
  240,045](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Aunreviewed)

[CC-BY-4.0 License](https://docs.github.com/en/github/site-policy/github-additional-product-terms#12-advisory-database)
[Language support](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database#github-reviewed-advisories)
[About GitHub Advisory Database](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database)

Filter advisories

### Filter advisories

GitHub reviewed advisories
[All reviewed

5,000+](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed)
[Composer

4,299](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Acomposer)
[Erlang

31](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Aerlang)
[GitHub Actions

21](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Aactions)
[Go

2,064](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Ago)
[Maven

5,000+](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Amaven)
[npm

3,744](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Anpm)
[NuGet

668](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Anuget)
[pip

3,424](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Apip)
[Pub

12](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Apub)
[RubyGems

892](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Arubygems)
[Rust

877](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Arust)
[Swift

36](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Areviewed+ecosystem%3Aswift)
Unreviewed advisories
[All unreviewed

5,000+](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+type%3Aunreviewed)

 Search

## 1 advisory

Filter by severity
Filter by CWE
Sort by

Severity

Filter by severity

[All severities](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode)
[Low](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+severity%3Alow)
[Moderate](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+severity%3Amoderate)
[High](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+severity%3Ahigh)
[Critical](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+severity%3Acritical)

CWE

 Loading

Sort

Sort by

[Newest](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode)
[Oldest](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+sort%3Apublished-asc)
[Recently updated](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+sort%3Aupdated-desc)
[Least recently updated](/advisories?query=CVE-2021-3999%29%2F%5Bcode%5D%28https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode+sort%3Aupdated-asc)

[A flaw was found in glibc. An off-by-one buffer overflow and underflow in getcwd() may lead to...](/advisories/GHSA-vfch-2fr8-r5c2)
High

Unreviewed

CVE-2021-3999

was published
Aug 25, 2022

**ProTip!**
Advisories are also available from the
[GraphQL API](https://docs.github.com/graphql/reference/queries#securityadvisories)

[CC-BY-4.0 License](https://docs.github.com/en/github/site-policy/github-additional-product-terms#12-advisory-database)
[Language support](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database#github-reviewed-advisories)
[About GitHub Advisory Database](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from sourceware.org_76889800_20250108_145109.html ===


Sourceware Bugzilla – Bug 28769
Off-by-one buffer overflow/underflow in getcwd() (CVE-2021-3999)
Last modified: 2022-08-18 10:01:16 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=28769&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=28769&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 28769**](show_bug.cgi?id=28769)
(CVE-2021-3999)
- Off-by-one buffer overflow/underflow in getcwd() (CVE-2021-3999)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Off-by-one buffer overflow/underflow in getcwd() (CVE-2021-3999)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-3999 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | glibc | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=glibc "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | libc ([show other bugs](buglist.cgi?component=libc&product=glibc&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.35 | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | 2.35 | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Siddhesh Poyarekar | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2022-01-12 13:44 UTC by Siddhesh Poyarekar | | --- | --- | | Modified: | 2022-08-18 10:01 UTC ([History](show_activity.cgi?id=28769)) | | CC List: | 4 users (show)  aurelien drepper.fsp fweimer pgowda.cve | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * <https://bugzilla.redhat.com/show_bug.cgi?id=2024637> | | [Host:](page.cgi?id=fields.html#cf_gcchost "A custom Free Text field in this installation of Bugzilla.") |  | | [Target:](page.cgi?id=fields.html#cf_gcctarget "A custom Free Text field in this installation of Bugzilla.") |  | | [Build:](page.cgi?id=fields.html#cf_gccbuild "A custom Free Text field in this installation of Bugzilla.") |  | | [Last reconfirmed:](page.cgi?id=fields.html#cf_reconfirmed_on "A custom Date/Time field in this installation of Bugzilla.") |  | |  | | | Flags: | siddhesh: security+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=28769&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=28769&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=28769#c0)  Siddhesh Poyarekar    2022-01-12 13:44:34 UTC  ``` For very long file names, the getcwd syscall returns ENAMETOOLONG, resulting in a call to __getcwd_generic.  That function in turn assumes a size that's suficient for at least a '/', so a size of 1 results in access that's one byte beyond bounds of buf.  We always need a minimum size of 2 bytes, so the glibc function should set ERANGE and return NULL for size of 1 byte. ```  [Comment 1](show_bug.cgi?id=28769#c1)  Sourceware Commits    2022-01-24 06:01:30 UTC  ``` The master branch has been updated by Siddhesh Poyarekar <siddhesh@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e>  commit 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e Author: Siddhesh Poyarekar <siddhesh@sourceware.org> Date:   Fri Jan 21 23:32:56 2022 +0530      getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)          No valid path returned by getcwd would fit into 1 byte, so reject the     size early and return NULL with errno set to ERANGE.  This change is     prompted by CVE-2021-3999, which describes a single byte buffer     underflow and overflow when all of the following conditions are met:          - The buffer size (i.e. the second argument of getcwd) is 1 byte     - The current working directory is too long     - '/' is also mounted on the current working directory          Sequence of events:          - In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG       because the linux kernel checks for name length before it checks       buffer size          - The code falls back to the generic getcwd in sysdeps/posix          - In the generic func, the buf[0] is set to '\0' on line 250          - this while loop on line 262 is bypassed:              while (!(thisdev == rootdev && thisino == rootino))            since the rootfs (/) is bind mounted onto the directory and the flow       goes on to line 449, where it puts a '/' in the byte before the       buffer.          - Finally on line 458, it moves 2 bytes (the underflowed byte and the       '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.          - buf is returned on line 469 and errno is not set.          This resolves BZ #28769.          Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>     Reviewed-by: Adhemerval Zanella  <adhemerval.zanella@linaro.org>     Signed-off-by: Qualys Security Advisory <qsa@qualys.com>     Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org> ```  [Comment 2](show_bug.cgi?id=28769#c2)  Sourceware Commits    2022-01-24 06:46:46 UTC  ``` The release/2.34/master branch has been updated by Siddhesh Poyarekar <siddhesh@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=472e799a5f2102bc0c3206dbd5a801765fceb39c>  commit 472e799a5f2102bc0c3206dbd5a801765fceb39c Author: Siddhesh Poyarekar <siddhesh@sourceware.org> Date:   Fri Jan 21 23:32:56 2022 +0530      getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)          No valid path returned by getcwd would fit into 1 byte, so reject the     size early and return NULL with errno set to ERANGE.  This change is     prompted by CVE-2021-3999, which describes a single byte buffer     underflow and overflow when all of the following conditions are met:          - The buffer size (i.e. the second argument of getcwd) is 1 byte     - The current working directory is too long     - '/' is also mounted on the current working directory          Sequence of events:          - In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG       because the linux kernel checks for name length before it checks       buffer size          - The code falls back to the generic getcwd in sysdeps/posix          - In the generic func, the buf[0] is set to '\0' on line 250          - this while loop on line 262 is bypassed:              while (!(thisdev == rootdev && thisino == rootino))            since the rootfs (/) is bind mounted onto the directory and the flow       goes on to line 449, where it puts a '/' in the byte before the       buffer.          - Finally on line 458, it moves 2 bytes (the underflowed byte and the       '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.          - buf is returned on line 469 and errno is not set.          This resolves BZ #28769.          Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>     Reviewed-by: Adhemerval Zanella  <adhemerval.zanella@linaro.org>     Signed-off-by: Qualys Security Advisory <qsa@qualys.com>     Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>     (cherry picked from commit 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) ```  [Comment 3](show_bug.cgi?id=28769#c3)  Siddhesh Poyarekar    2022-01-24 06:47:13 UTC  ``` Fixed on trunk and 2.34. ```  [Comment 4](show_bug.cgi?id=28769#c4)  Sourceware Commits    2022-01-24 22:46:02 UTC  ``` The release/2.34/master branch has been updated by Aurelien Jarno <aurel32@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a>  commit 1b9cd6a7214db1812a20eb3591cf42f9190a5d1a Author: Aurelien Jarno <aurelien@aurel32.net> Date:   Mon Jan 24 23:45:03 2022 +0100      NEWS: add bug entry for BZ #28769 and BZ #28770 ```  [Comment 5](show_bug.cgi?id=28769#c5)  Sourceware Commits    2022-01-24 22:49:09 UTC  ``` The release/2.33/master branch has been updated by Aurelien Jarno <aurel32@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=bcdde07537d733eafe1f28cea3084003e140f5ff>  commit bcdde07537d733eafe1f28cea3084003e140f5ff Author: Siddhesh Poyarekar <siddhesh@sourceware.org> Date:   Fri Jan 21 23:32:56 2022 +0530      getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)          No valid path returned by getcwd would fit into 1 byte, so reject the     size early and return NULL with errno set to ERANGE.  This change is     prompted by CVE-2021-3999, which describes a single byte buffer     underflow and overflow when all of the following conditions are met:          - The buffer size (i.e. the second argument of getcwd) is 1 byte     - The current working directory is too long     - '/' is also mounted on the current working directory          Sequence of events:          - In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG       because the linux kernel checks for name length before it checks       buffer size          - The code falls back to the generic getcwd in sysdeps/posix          - In the generic func, the buf[0] is set to '\0' on line 250          - this while loop on line 262 is bypassed:              while (!(thisdev == rootdev && thisino == rootino))            since the rootfs (/) is bind mounted onto the directory and the flow       goes on to line 449, where it puts a '/' in the byte before the       buffer.          - Finally on line 458, it moves 2 bytes (the underflowed byte and the       '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.          - buf is returned on line 469 and errno is not set.          This resolves BZ #28769.          Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>     Reviewed-by: Adhemerval Zanella  <adhemerval.zanella@linaro.org>     Signed-off-by: Qualys Security Advisory <qsa@qualys.com>     Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>     (cherry picked from commit 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) ```  [Comment 6](show_bug.cgi?id=28769#c6)  Sourceware Commits    2022-08-18 10:01:16 UTC  ``` The release/2.31/master branch has been updated by Aurelien Jarno <aurel32@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=4ad1659d8c024953b11c2f0fef2219529171da7e>  commit 4ad1659d8c024953b11c2f0fef2219529171da7e Author: Siddhesh Poyarekar <siddhesh@sourceware.org> Date:   Fri Jan 21 23:32:56 2022 +0530      getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)          No valid path returned by getcwd would fit into 1 byte, so reject the     size early and return NULL with errno set to ERANGE.  This change is     prompted by CVE-2021-3999, which describes a single byte buffer     underflow and overflow when all of the following conditions are met:          - The buffer size (i.e. the second argument of getcwd) is 1 byte     - The current working directory is too long     - '/' is also mounted on the current working directory          Sequence of events:          - In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG       because the linux kernel checks for name length before it checks       buffer size          - The code falls back to the generic getcwd in sysdeps/posix          - In the generic func, the buf[0] is set to '\0' on line 250          - this while loop on line 262 is bypassed:              while (!(thisdev == rootdev && thisino == rootino))            since the rootfs (/) is bind mounted onto the directory and the flow       goes on to line 449, where it puts a '/' in the byte before the       buffer.          - Finally on line 458, it moves 2 bytes (the underflowed byte and the       '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.          - buf is returned on line 469 and errno is not set.          This resolves BZ #28769.          Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>     Reviewed-by: Adhemerval Zanella  <adhemerval.zanella@linaro.org>     Signed-off-by: Qualys Security Advisory <qsa@qualys.com>     Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>     (cherry picked from commit 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=28769)
* - [XML](show_bug.cgi?ctype=xml&id=28769)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=28769)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=28769&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=28769&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.gentoo.org_7ef61bcf_20250108_145106.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Invalid Bug ID

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=CVE-2021-3999)%2C&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=CVE-2021-3999)%2C&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

'CVE-2021-3999),' is not a valid bug number
nor an alias to a bug.

Please press **Back** and try again.

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=CVE-2021-3999)%2C&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=CVE-2021-3999)%2C&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from sourceware.org_76889800_20250108_105646.html ===


Sourceware Bugzilla – Bug 28769
Off-by-one buffer overflow/underflow in getcwd() (CVE-2021-3999)
Last modified: 2022-08-18 10:01:16 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=28769&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=28769&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 28769**](show_bug.cgi?id=28769)
(CVE-2021-3999)
- Off-by-one buffer overflow/underflow in getcwd() (CVE-2021-3999)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Off-by-one buffer overflow/underflow in getcwd() (CVE-2021-3999)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-3999 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | glibc | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=glibc "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | libc ([show other bugs](buglist.cgi?component=libc&product=glibc&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.35 | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | 2.35 | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Siddhesh Poyarekar | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2022-01-12 13:44 UTC by Siddhesh Poyarekar | | --- | --- | | Modified: | 2022-08-18 10:01 UTC ([History](show_activity.cgi?id=28769)) | | CC List: | 4 users (show)  aurelien drepper.fsp fweimer pgowda.cve | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * <https://bugzilla.redhat.com/show_bug.cgi?id=2024637> | | [Host:](page.cgi?id=fields.html#cf_gcchost "A custom Free Text field in this installation of Bugzilla.") |  | | [Target:](page.cgi?id=fields.html#cf_gcctarget "A custom Free Text field in this installation of Bugzilla.") |  | | [Build:](page.cgi?id=fields.html#cf_gccbuild "A custom Free Text field in this installation of Bugzilla.") |  | | [Last reconfirmed:](page.cgi?id=fields.html#cf_reconfirmed_on "A custom Date/Time field in this installation of Bugzilla.") |  | |  | | | Flags: | siddhesh: security+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=28769&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=28769&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=28769#c0)  Siddhesh Poyarekar    2022-01-12 13:44:34 UTC  ``` For very long file names, the getcwd syscall returns ENAMETOOLONG, resulting in a call to __getcwd_generic.  That function in turn assumes a size that's suficient for at least a '/', so a size of 1 results in access that's one byte beyond bounds of buf.  We always need a minimum size of 2 bytes, so the glibc function should set ERANGE and return NULL for size of 1 byte. ```  [Comment 1](show_bug.cgi?id=28769#c1)  Sourceware Commits    2022-01-24 06:01:30 UTC  ``` The master branch has been updated by Siddhesh Poyarekar <siddhesh@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e>  commit 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e Author: Siddhesh Poyarekar <siddhesh@sourceware.org> Date:   Fri Jan 21 23:32:56 2022 +0530      getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)          No valid path returned by getcwd would fit into 1 byte, so reject the     size early and return NULL with errno set to ERANGE.  This change is     prompted by CVE-2021-3999, which describes a single byte buffer     underflow and overflow when all of the following conditions are met:          - The buffer size (i.e. the second argument of getcwd) is 1 byte     - The current working directory is too long     - '/' is also mounted on the current working directory          Sequence of events:          - In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG       because the linux kernel checks for name length before it checks       buffer size          - The code falls back to the generic getcwd in sysdeps/posix          - In the generic func, the buf[0] is set to '\0' on line 250          - this while loop on line 262 is bypassed:              while (!(thisdev == rootdev && thisino == rootino))            since the rootfs (/) is bind mounted onto the directory and the flow       goes on to line 449, where it puts a '/' in the byte before the       buffer.          - Finally on line 458, it moves 2 bytes (the underflowed byte and the       '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.          - buf is returned on line 469 and errno is not set.          This resolves BZ #28769.          Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>     Reviewed-by: Adhemerval Zanella  <adhemerval.zanella@linaro.org>     Signed-off-by: Qualys Security Advisory <qsa@qualys.com>     Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org> ```  [Comment 2](show_bug.cgi?id=28769#c2)  Sourceware Commits    2022-01-24 06:46:46 UTC  ``` The release/2.34/master branch has been updated by Siddhesh Poyarekar <siddhesh@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=472e799a5f2102bc0c3206dbd5a801765fceb39c>  commit 472e799a5f2102bc0c3206dbd5a801765fceb39c Author: Siddhesh Poyarekar <siddhesh@sourceware.org> Date:   Fri Jan 21 23:32:56 2022 +0530      getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)          No valid path returned by getcwd would fit into 1 byte, so reject the     size early and return NULL with errno set to ERANGE.  This change is     prompted by CVE-2021-3999, which describes a single byte buffer     underflow and overflow when all of the following conditions are met:          - The buffer size (i.e. the second argument of getcwd) is 1 byte     - The current working directory is too long     - '/' is also mounted on the current working directory          Sequence of events:          - In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG       because the linux kernel checks for name length before it checks       buffer size          - The code falls back to the generic getcwd in sysdeps/posix          - In the generic func, the buf[0] is set to '\0' on line 250          - this while loop on line 262 is bypassed:              while (!(thisdev == rootdev && thisino == rootino))            since the rootfs (/) is bind mounted onto the directory and the flow       goes on to line 449, where it puts a '/' in the byte before the       buffer.          - Finally on line 458, it moves 2 bytes (the underflowed byte and the       '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.          - buf is returned on line 469 and errno is not set.          This resolves BZ #28769.          Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>     Reviewed-by: Adhemerval Zanella  <adhemerval.zanella@linaro.org>     Signed-off-by: Qualys Security Advisory <qsa@qualys.com>     Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>     (cherry picked from commit 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) ```  [Comment 3](show_bug.cgi?id=28769#c3)  Siddhesh Poyarekar    2022-01-24 06:47:13 UTC  ``` Fixed on trunk and 2.34. ```  [Comment 4](show_bug.cgi?id=28769#c4)  Sourceware Commits    2022-01-24 22:46:02 UTC  ``` The release/2.34/master branch has been updated by Aurelien Jarno <aurel32@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=1b9cd6a7214db1812a20eb3591cf42f9190a5d1a>  commit 1b9cd6a7214db1812a20eb3591cf42f9190a5d1a Author: Aurelien Jarno <aurelien@aurel32.net> Date:   Mon Jan 24 23:45:03 2022 +0100      NEWS: add bug entry for BZ #28769 and BZ #28770 ```  [Comment 5](show_bug.cgi?id=28769#c5)  Sourceware Commits    2022-01-24 22:49:09 UTC  ``` The release/2.33/master branch has been updated by Aurelien Jarno <aurel32@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=bcdde07537d733eafe1f28cea3084003e140f5ff>  commit bcdde07537d733eafe1f28cea3084003e140f5ff Author: Siddhesh Poyarekar <siddhesh@sourceware.org> Date:   Fri Jan 21 23:32:56 2022 +0530      getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)          No valid path returned by getcwd would fit into 1 byte, so reject the     size early and return NULL with errno set to ERANGE.  This change is     prompted by CVE-2021-3999, which describes a single byte buffer     underflow and overflow when all of the following conditions are met:          - The buffer size (i.e. the second argument of getcwd) is 1 byte     - The current working directory is too long     - '/' is also mounted on the current working directory          Sequence of events:          - In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG       because the linux kernel checks for name length before it checks       buffer size          - The code falls back to the generic getcwd in sysdeps/posix          - In the generic func, the buf[0] is set to '\0' on line 250          - this while loop on line 262 is bypassed:              while (!(thisdev == rootdev && thisino == rootino))            since the rootfs (/) is bind mounted onto the directory and the flow       goes on to line 449, where it puts a '/' in the byte before the       buffer.          - Finally on line 458, it moves 2 bytes (the underflowed byte and the       '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.          - buf is returned on line 469 and errno is not set.          This resolves BZ #28769.          Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>     Reviewed-by: Adhemerval Zanella  <adhemerval.zanella@linaro.org>     Signed-off-by: Qualys Security Advisory <qsa@qualys.com>     Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>     (cherry picked from commit 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) ```  [Comment 6](show_bug.cgi?id=28769#c6)  Sourceware Commits    2022-08-18 10:01:16 UTC  ``` The release/2.31/master branch has been updated by Aurelien Jarno <aurel32@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=4ad1659d8c024953b11c2f0fef2219529171da7e>  commit 4ad1659d8c024953b11c2f0fef2219529171da7e Author: Siddhesh Poyarekar <siddhesh@sourceware.org> Date:   Fri Jan 21 23:32:56 2022 +0530      getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)          No valid path returned by getcwd would fit into 1 byte, so reject the     size early and return NULL with errno set to ERANGE.  This change is     prompted by CVE-2021-3999, which describes a single byte buffer     underflow and overflow when all of the following conditions are met:          - The buffer size (i.e. the second argument of getcwd) is 1 byte     - The current working directory is too long     - '/' is also mounted on the current working directory          Sequence of events:          - In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG       because the linux kernel checks for name length before it checks       buffer size          - The code falls back to the generic getcwd in sysdeps/posix          - In the generic func, the buf[0] is set to '\0' on line 250          - this while loop on line 262 is bypassed:              while (!(thisdev == rootdev && thisino == rootino))            since the rootfs (/) is bind mounted onto the directory and the flow       goes on to line 449, where it puts a '/' in the byte before the       buffer.          - Finally on line 458, it moves 2 bytes (the underflowed byte and the       '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.          - buf is returned on line 469 and errno is not set.          This resolves BZ #28769.          Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>     Reviewed-by: Adhemerval Zanella  <adhemerval.zanella@linaro.org>     Signed-off-by: Qualys Security Advisory <qsa@qualys.com>     Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>     (cherry picked from commit 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=28769)
* - [XML](show_bug.cgi?ctype=xml&id=28769)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=28769)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=28769&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=28769&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from security.netapp.com_290fe2a4_20250108_105644.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2021-3999 GNU C Library (glibc) Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20221104-0001)

## CVE-2021-3999 GNU C Library (glibc) Vulnerability in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20221104-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20221104-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20221104-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20221104-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20221104-0001
**Version:**
8.0

**Last updated:**
11/14/2024

**Status:**
Final.

**CVEs:** CVE-2021-3999

Overview
#### Summary

Multiple NetApp products incorporate GNU C. GNU C Library (aka glibc) versions prior to 2.31 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2021-3999](https://nvd.nist.gov/vuln/detail/CVE-2021-3999) | 7.8 (HIGH) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* NetApp E-Series Performance Analyzer
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp NFS Plug-in for VMware VAAI
* ONTAP Select Deploy administration utility

#### Products Not Affected

* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 6500N
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Service Processor - 8080/8060/8040/8020
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM6 SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp E-Series Performance Analyzer** | NetApp E-Series Performance Analyzer has no plans to address this vulnerability. See the [EOA announcement](https://github.com/NetApp/eseries-perf-analyzer) for more information. |
| **NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S** | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2876227.html) for more information. |
| **NetApp HCI Baseboard Management Controller (BMC) - H410C** | NetApp HCI Baseboard Management Controller (BMC) - H410C has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2876227.html) for more information. |
| **NetApp NFS Plug-in for VMware VAAI** | <https://mysupport.netapp.com/site/products/all/details/nfsplugin-vmware-vaai/downloads-tab/download/61278/2.0.1> |
| **ONTAP Select Deploy administration utility** | <https://mysupport.netapp.com/site/products/all/details/ontapselect-deploy/downloads-tab/download/62910/9.13.1> |

#### Workarounds

NetApp E-Series Performance Analyzer:

Configure the E-Series Performance Analyzer to use grafana version 9.0.3 or higher which includes a non-vulnerable version of glibc. This can be set in the .env file with the CONTAINER\_GRAFANA\_TAG variable. After the change the Performance Analyzer will need to be restarted with a 'make restart' command.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20221104-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20221104 | Initial Public Release |
| 2.0 | 20221110 | NetApp NFS Plug-in for VMware VAAI moved to Affected Products |
| 3.0 | 20230120 | NetApp NFS Plug-in for VMware VAAI added to Software Versions and Fixes |
| 4.0 | 20230228 | FAS/AFF Baseboard Management Controller (BMC) - A250/500f moved to Affected Products |
| 5.0 | 20230307 | Brocade Fabric Operating System Firmware moved to Products Not Affected, NetApp E-Series Performance Analyzer moved to Won't Fix status |
| 6.0 | 20240425 | ONTAP Select Deploy administration utility added to Software Versions and Fixes |
| 7.0 | 20241003 | FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250 moved to Affected Products |
| 8.0 | 20241114 | After additional review FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250 moved to Products Not Affected, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from duckduckgo.com_cc3912b1_20250108_145105.html ===


All Regions
Argentina
Australia
Austria
Belgium (fr)
Belgium (nl)
Brazil
Bulgaria
Canada (en)
Canada (fr)
Catalonia
Chile
China
Colombia
Croatia
Czech Republic
Denmark
Estonia
Finland
France
Germany
Greece
Hong Kong
Hungary
Iceland
India (en)
Indonesia (en)
Ireland
Israel (en)
Italy
Japan
Korea
Latvia
Lithuania
Malaysia (en)
Mexico
Netherlands
New Zealand
Norway
Pakistan (en)
Peru
Philippines (en)
Poland
Portugal
Romania
Russia
Saudi Arabia
Singapore
Slovakia
Slovenia
South Africa
Spain (ca)
Spain (es)
Sweden
Switzerland (de)
Switzerland (fr)
Taiwan
Thailand (en)
Turkey
US (English)
US (Spanish)
Ukraine
United Kingdom
Vietnam (en)

Any Time
Past Day
Past Week
Past Month
Past Year

## [Nvd - Cve-2021-3999](//duckduckgo.com/l/?uddg=https%3A%2F%2Fnvd.nist.gov%2Fvuln%2Fdetail%2FCVE%2D2021%2D3999&rut=e6478f72b64f1a91b005d9ff376ee91ea6cfd5ac00d466d7ab5c2cbd891e910b)

[![](//external-content.duckduckgo.com/ip3/nvd.nist.gov.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Fnvd.nist.gov%2Fvuln%2Fdetail%2FCVE%2D2021%2D3999&rut=e6478f72b64f1a91b005d9ff376ee91ea6cfd5ac00d466d7ab5c2cbd891e910b)

[nvd.nist.gov/vuln/detail/CVE-2021-3999](//duckduckgo.com/l/?uddg=https%3A%2F%2Fnvd.nist.gov%2Fvuln%2Fdetail%2FCVE%2D2021%2D3999&rut=e6478f72b64f1a91b005d9ff376ee91ea6cfd5ac00d466d7ab5c2cbd891e910b)
    2024-11-21T00:00:00.0000000

[A local attacker who can control the input buffer and size passed to getcwd () in a setuid program could use this flaw to potentially execute arbitrary code and escalate their privileges on the system. NVD enrichment efforts reference publicly available information to associate vector strings.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fnvd.nist.gov%2Fvuln%2Fdetail%2FCVE%2D2021%2D3999&rut=e6478f72b64f1a91b005d9ff376ee91ea6cfd5ac00d466d7ab5c2cbd891e910b)

## [Cve - Cve-2021-3999](//duckduckgo.com/l/?uddg=https%3A%2F%2Fcve.mitre.org%2Fcgi%2Dbin%2Fcvename.cgi%3Fname%3DCVE%2D2021%2D3999&rut=f2cf7732c318bddfcf02a51c1bcf0b39a3b6fb6f8e7839fccd1c58cc457f8b94)

[![](//external-content.duckduckgo.com/ip3/cve.mitre.org.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Fcve.mitre.org%2Fcgi%2Dbin%2Fcvename.cgi%3Fname%3DCVE%2D2021%2D3999&rut=f2cf7732c318bddfcf02a51c1bcf0b39a3b6fb6f8e7839fccd1c58cc457f8b94)

[cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3999](//duckduckgo.com/l/?uddg=https%3A%2F%2Fcve.mitre.org%2Fcgi%2Dbin%2Fcvename.cgi%3Fname%3DCVE%2D2021%2D3999&rut=f2cf7732c318bddfcf02a51c1bcf0b39a3b6fb6f8e7839fccd1c58cc457f8b94)
    2024-06-30T00:00:00.0000000

[This is an record on the **CVE** List, which provides common identifiers for publicly known cybersecurity vulnerabilities. The mission of the **CVE**® Program is to identify, define, and catalog publicly disclosed cybersecurity vulnerabilities.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fcve.mitre.org%2Fcgi%2Dbin%2Fcvename.cgi%3Fname%3DCVE%2D2021%2D3999&rut=f2cf7732c318bddfcf02a51c1bcf0b39a3b6fb6f8e7839fccd1c58cc457f8b94)

## [GNU C Library (glibc) vulnerability CVE-2021-3999 - F5, Inc.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fmy.f5.com%2Fmanage%2Fs%2Farticle%2FK24207649&rut=8f6c39cc60797ed4c4d57bd01175280ff7b2f310d525e45471eca5fe7f47fb96)

[![](//external-content.duckduckgo.com/ip3/my.f5.com.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Fmy.f5.com%2Fmanage%2Fs%2Farticle%2FK24207649&rut=8f6c39cc60797ed4c4d57bd01175280ff7b2f310d525e45471eca5fe7f47fb96)

[my.f5.com/manage/s/article/K24207649](//duckduckgo.com/l/?uddg=https%3A%2F%2Fmy.f5.com%2Fmanage%2Fs%2Farticle%2FK24207649&rut=8f6c39cc60797ed4c4d57bd01175280ff7b2f310d525e45471eca5fe7f47fb96)

[(**CVE-2021-3999**) Impact. A flaw was found in glibc. An off-by-one buffer overflow and underflow in getcwd() may lead to memory corruption when the size of the buffer is exactly 1.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fmy.f5.com%2Fmanage%2Fs%2Farticle%2FK24207649&rut=8f6c39cc60797ed4c4d57bd01175280ff7b2f310d525e45471eca5fe7f47fb96)

## [Cve-2021-3999 | Cve](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.cve.org%2FCVERecord%3Fid%3DCVE%2D2021%2D3999&rut=c04b6d36435bac43fd53c51931d14609f59b0634832d59c429cb7c12db0b77a5)

[![](//external-content.duckduckgo.com/ip3/www.cve.org.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.cve.org%2FCVERecord%3Fid%3DCVE%2D2021%2D3999&rut=c04b6d36435bac43fd53c51931d14609f59b0634832d59c429cb7c12db0b77a5)

[www.cve.org/CVERecord?id=CVE-2021-3999](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.cve.org%2FCVERecord%3Fid%3DCVE%2D2021%2D3999&rut=c04b6d36435bac43fd53c51931d14609f59b0634832d59c429cb7c12db0b77a5)

[Notice: Keyword searching of **CVE** Records is now available in the search box above. Keywords may include a **CVE** ID (e.g., **CVE**-2024-1234), or one or more keywords separated by a space (e.g., authorization, SQL Injection, cross site scripting, etc.). Learn more here.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.cve.org%2FCVERecord%3Fid%3DCVE%2D2021%2D3999&rut=c04b6d36435bac43fd53c51931d14609f59b0634832d59c429cb7c12db0b77a5)

## [CVE-2021-3999 Common Vulnerabilities and Exposures - SUSE](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.suse.com%2Fsecurity%2Fcve%2FCVE%2D2021%2D3999.html&rut=20b167324af975d33ceeaa145ee40274339b149ed5029d5c6dc50e87e9904b19)

[![](//external-content.duckduckgo.com/ip3/www.suse.com.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.suse.com%2Fsecurity%2Fcve%2FCVE%2D2021%2D3999.html&rut=20b167324af975d33ceeaa145ee40274339b149ed5029d5c6dc50e87e9904b19)

[www.suse.com/security/cve/CVE-2021-3999.html](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.suse.com%2Fsecurity%2Fcve%2FCVE%2D2021%2D3999.html&rut=20b167324af975d33ceeaa145ee40274339b149ed5029d5c6dc50e87e9904b19)

[Secure your Linux systems from **CVE-2021-3999**. Stay ahead of potential threats with the latest security updates from SUSE.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.suse.com%2Fsecurity%2Fcve%2FCVE%2D2021%2D3999.html&rut=20b167324af975d33ceeaa145ee40274339b149ed5029d5c6dc50e87e9904b19)

## [CVE-2021-3999 - GitHub Advisory Database](//duckduckgo.com/l/?uddg=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA%2Dvfch%2D2fr8%2Dr5c2&rut=e3a5c3a1041e6a2a1e4abfb788d465270fc0c397451466b69824d8c2c93e1582)

[![](//external-content.duckduckgo.com/ip3/github.com.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA%2Dvfch%2D2fr8%2Dr5c2&rut=e3a5c3a1041e6a2a1e4abfb788d465270fc0c397451466b69824d8c2c93e1582)

[github.com/advisories/GHSA-vfch-2fr8-r5c2](//duckduckgo.com/l/?uddg=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA%2Dvfch%2D2fr8%2Dr5c2&rut=e3a5c3a1041e6a2a1e4abfb788d465270fc0c397451466b69824d8c2c93e1582)

[An off-by-one buffer overflow and underflow in getcwd () may lead to memory corruption when the size of the buffer is exactly 1. A local attacker who can control the input buffer and size passed to getcwd () in a setuid program could use this flaw to potentially execute arbitrary code and escalate their privileges on the system.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA%2Dvfch%2D2fr8%2Dr5c2&rut=e3a5c3a1041e6a2a1e4abfb788d465270fc0c397451466b69824d8c2c93e1582)

## [Off-by-one Error in glibc | CVE-2021-3999 | Snyk](//duckduckgo.com/l/?uddg=https%3A%2F%2Fsecurity.snyk.io%2Fvuln%2FSNYK%2DDEBIAN11%2DGLIBC%2D2340919&rut=5438db2ac97af8c792f793cbe9209e5dfad6931d0c08f53a006cdebe371bb05e)

[![](//external-content.duckduckgo.com/ip3/security.snyk.io.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Fsecurity.snyk.io%2Fvuln%2FSNYK%2DDEBIAN11%2DGLIBC%2D2340919&rut=5438db2ac97af8c792f793cbe9209e5dfad6931d0c08f53a006cdebe371bb05e)

[security.snyk.io/vuln/SNYK-DEBIAN11-GLIBC-2340919](//duckduckgo.com/l/?uddg=https%3A%2F%2Fsecurity.snyk.io%2Fvuln%2FSNYK%2DDEBIAN11%2DGLIBC%2D2340919&rut=5438db2ac97af8c792f793cbe9209e5dfad6931d0c08f53a006cdebe371bb05e)

[An off-by-one buffer overflow and underflow in getcwd () may lead to memory corruption when the size of the buffer is exactly 1. A local attacker who can control the input buffer and size passed to getcwd () in a setuid program could use this flaw to potentially execute arbitrary code and escalate their privileges on the system.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fsecurity.snyk.io%2Fvuln%2FSNYK%2DDEBIAN11%2DGLIBC%2D2340919&rut=5438db2ac97af8c792f793cbe9209e5dfad6931d0c08f53a006cdebe371bb05e)

## [Understanding CVE-2021-3999: A Critical glibc Vulnerability](//duckduckgo.com/l/?uddg=https%3A%2F%2Flinuxpatch.com%2Fcve%2FCVE%2D2021%2D3999&rut=56dee15bb741ebc6e27823d42b08a2d6f62778d86d1e76f3f92798066426be52)

[![](//external-content.duckduckgo.com/ip3/linuxpatch.com.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Flinuxpatch.com%2Fcve%2FCVE%2D2021%2D3999&rut=56dee15bb741ebc6e27823d42b08a2d6f62778d86d1e76f3f92798066426be52)

[linuxpatch.com/cve/CVE-2021-3999](//duckduckgo.com/l/?uddg=https%3A%2F%2Flinuxpatch.com%2Fcve%2FCVE%2D2021%2D3999&rut=56dee15bb741ebc6e27823d42b08a2d6f62778d86d1e76f3f92798066426be52)

[Armed with the right information and tools, Linux users and administrators can effectively safeguard their systems against **CVE-2021-3999**. Proactive security measures and a robust patch management strategy are essential to protect against potential threats posed by this severe glibc vulnerability.](//duckduckgo.com/l/?uddg=https%3A%2F%2Flinuxpatch.com%2Fcve%2FCVE%2D2021%2D3999&rut=56dee15bb741ebc6e27823d42b08a2d6f62778d86d1e76f3f92798066426be52)

## [CVE-2021-3999 | Ubuntu](//duckduckgo.com/l/?uddg=https%3A%2F%2Fubuntu.com%2Fsecurity%2FCVE%2D2021%2D3999&rut=b6f7a0d5c11196554c42a671e62a6994337ba3ee9f75af277ddbe58e4c881821)

[![](//external-content.duckduckgo.com/ip3/ubuntu.com.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Fubuntu.com%2Fsecurity%2FCVE%2D2021%2D3999&rut=b6f7a0d5c11196554c42a671e62a6994337ba3ee9f75af277ddbe58e4c881821)

[ubuntu.com/security/CVE-2021-3999](//duckduckgo.com/l/?uddg=https%3A%2F%2Fubuntu.com%2Fsecurity%2FCVE%2D2021%2D3999&rut=b6f7a0d5c11196554c42a671e62a6994337ba3ee9f75af277ddbe58e4c881821)

[Reduce your average **CVE** exposure time from 98 days to 1 day with expanded **CVE** patching, ten-years security maintenance and optional support for the full stack of open-source applications. Free for personal use.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fubuntu.com%2Fsecurity%2FCVE%2D2021%2D3999&rut=b6f7a0d5c11196554c42a671e62a6994337ba3ee9f75af277ddbe58e4c881821)

## [CVE-2021-3999 | Tenable®](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.tenable.com%2Fcve%2FCVE%2D2021%2D3999&rut=e6f1c27f38f4ba800defba5e7af6c43ae6f0cc84bc1af9f11059928c8d042249)

[![](//external-content.duckduckgo.com/ip3/www.tenable.com.ico)](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.tenable.com%2Fcve%2FCVE%2D2021%2D3999&rut=e6f1c27f38f4ba800defba5e7af6c43ae6f0cc84bc1af9f11059928c8d042249)

[www.tenable.com/cve/CVE-2021-3999](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.tenable.com%2Fcve%2FCVE%2D2021%2D3999&rut=e6f1c27f38f4ba800defba5e7af6c43ae6f0cc84bc1af9f11059928c8d042249)

[A local attacker who can control the input buffer and size passed to getcwd () in a setuid program could use this flaw to potentially execute arbitrary code and escalate their privileges on the system. A flaw was found in glibc.](//duckduckgo.com/l/?uddg=https%3A%2F%2Fwww.tenable.com%2Fcve%2FCVE%2D2021%2D3999&rut=e6f1c27f38f4ba800defba5e7af6c43ae6f0cc84bc1af9f11059928c8d042249)

[Feedback](//duckduckgo.com/feedback.html)

![](//duckduckgo.com/t/sl_h)


=== Content from access.redhat.com_47444d81_20250108_145108.html ===

[Skip to main content](#rh-login-card)
![Red Hat logo](/auth/resources/wi6vu/login/rhd-theme/img/RHLogo_white.svg)

All Red Hat

[Register](/auth/realms/redhat-external/login-actions/registration?client_id=unified-downloads&tab_id=u-qFqj_55pk&client_data=eyJydSI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZG93bmxvYWRzL3NhbWwvZmluYWxpemUiLCJybSI6InBvc3QiLCJzdCI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZXJyYXRhL1JIU0EtMjAyMjowODk2JTVEKGh0dHBzOi9hY2Nlc3MucmVkaGF0LmNvbS9lcnJhdGEvUkhTQS0yMDIyJTNBMDg5NikifQ)

# Log in to your Red Hat account

#### Danger alert:

#### Log in attempt timed out

Resubmit your information.

 Red Hat login or email

Next

 Red Hat login or email

Log in with company single sign-on

Log in with Red Hat account

 Red Hat login or email

Password

Log in

[Register for a Red Hat account](/auth/realms/redhat-external/login-actions/registration?client_id=unified-downloads&tab_id=u-qFqj_55pk&client_data=eyJydSI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZG93bmxvYWRzL3NhbWwvZmluYWxpemUiLCJybSI6InBvc3QiLCJzdCI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZXJyYXRhL1JIU0EtMjAyMjowODk2JTVEKGh0dHBzOi9hY2Nlc3MucmVkaGF0LmNvbS9lcnJhdGEvUkhTQS0yMDIyJTNBMDg5NikifQ)

[Forgot your password?](/auth/realms/redhat-external/login-actions/reset-credentials?client_id=unified-downloads&tab_id=u-qFqj_55pk&client_data=eyJydSI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZG93bmxvYWRzL3NhbWwvZmluYWxpemUiLCJybSI6InBvc3QiLCJzdCI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZXJyYXRhL1JIU0EtMjAyMjowODk2JTVEKGh0dHBzOi9hY2Nlc3MucmVkaGF0LmNvbS9lcnJhdGEvUkhTQS0yMDIyJTNBMDg5NikifQ)

### Why create an account?

* ![](/auth/resources/wi6vu/login/rhd-theme/img/pricetag.png)

  #### Product trials

  Try our products hands-on to see if they’ll work for you.
* ![](/auth/resources/wi6vu/login/rhd-theme/img/book.png)

  #### Learning resources

  Get training and learning tools to help you use our products.
* ![](/auth/resources/wi6vu/login/rhd-theme/img/support.png)

  #### World-class support

  Rely on our trusted customer support and partner enablement.

A subscription may be required for some services.

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[LinkedIn](https://www.linkedin.com/company/red-hat)
[YouTube](https://www.youtube.com/user/RedHatVideos)
[Facebook](https://www.facebook.com/redhatinc)
[X/Twitter](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](https://redhat.com/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](https://redhat.com/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](https://redhat.com/en/technologies/management/ansible)
* [Cloud services](https://redhat.com/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](https://redhat.com/en/technologies/all-products)

### Tools

* [My account](https://sso.redhat.com)
* [Training and certification](https://redhat.com/en/services/training-and-certification)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Learning community](https://learn.redhat.com/)
* [Partner resources](https://connect.redhat.com/)
* [Resource library](https://redhat.com/en/resources)

### Try, buy & sell

* [Product trial center](https://redhat.com/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](http://redhat.force.com/finder/)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact consulting](https://redhat.com/en/services/consulting-overview#contact-us)
* [Contact sales](https://redhat.com/en/contact)
* [Contact training](https://redhat.com/en/services/training-and-certification/contact-us)
* [Social](https://redhat.com/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Subscribe to our newsletter, Red Hat Shares

[Sign up now](https://www.redhat.com/en/email-preferences?newsletter=RH-Shares&intcmp=7016000000154xCAAQ)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

© 2022 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from sourceware.org_c4771477_20250108_145109.html ===

[![git](static/git-logo.png)](https://git-scm.com/ "git homepage")[git://sourceware.org](/git) / [glibc.git](/git?p=glibc.git;a=summary) / commit

commit
grep
author
committer
pickaxe
 [?](/git?p=glibc.git;a=search_help "search help") search:

re

[summary](/git?p=glibc.git;a=summary) | [shortlog](/git?p=glibc.git;a=shortlog;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [log](/git?p=glibc.git;a=log;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | commit | [commitdiff](/git?p=glibc.git;a=commitdiff;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [tree](/git?p=glibc.git;a=tree;h=4ce71226b6ce414b7c5a08d6406e5506f2b32442;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e)

(parent: [6c2f050](/git?p=glibc.git;a=commit;h=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b)) | [patch](/git?p=glibc.git;a=patch;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e)

[getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)](/git?p=glibc.git;a=commitdiff;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e)

| author | [Siddhesh Poyarekar](/git?p=glibc.git;a=search;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;s=Siddhesh+Poyarekar;st=author "Search for commits authored by Siddhesh Poyarekar") [<siddhesh@sourceware.org>](/git?p=glibc.git;a=search;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;s=siddhesh@sourceware.org;st=author "Search for commits authored by siddhesh@sourceware.org") |  |
| --- | --- | --- |
|  | Fri, 21 Jan 2022 18:02:56 +0000 (23:32 +0530) |
| committer | [Siddhesh Poyarekar](/git?p=glibc.git;a=search;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;s=Siddhesh+Poyarekar;st=committer "Search for commits committed by Siddhesh Poyarekar") [<siddhesh@sourceware.org>](/git?p=glibc.git;a=search;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;s=siddhesh@sourceware.org;st=committer "Search for commits committed by siddhesh@sourceware.org") |  |
|  | Mon, 24 Jan 2022 05:30:17 +0000 (11:00 +0530) |
| commit | 23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e |
| tree | [4ce71226b6ce414b7c5a08d6406e5506f2b32442](/git?p=glibc.git;a=tree;h=4ce71226b6ce414b7c5a08d6406e5506f2b32442;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [tree](/git?p=glibc.git;a=tree;h=4ce71226b6ce414b7c5a08d6406e5506f2b32442;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |
| parent | [6c2f050dbe11fb4ed0a401a5f25731f2aa53046b](/git?p=glibc.git;a=commit;h=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [commit](/git?p=glibc.git;a=commit;h=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [diff](/git?p=glibc.git;a=commitdiff;h=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;hp=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) |

getcwd: Set errno to ERANGE for size == 1 (CVE-2021-3999)

No valid path returned by getcwd would fit into 1 byte, so reject the

size early and return NULL with errno set to ERANGE.  This change is

prompted by CVE-2021-3999, which describes a single byte buffer

underflow and overflow when all of the following conditions are met:

- The buffer size (i.e. the second argument of getcwd) is 1 byte

- The current working directory is too long

- '/' is also mounted on the current working directory

Sequence of events:

- In sysdeps/unix/sysv/linux/getcwd.c, the syscall returns ENAMETOOLONG

  because the linux kernel checks for name length before it checks

  buffer size

- The code falls back to the generic getcwd in sysdeps/posix

- In the generic func, the buf[0] is set to '\0' on line 250

- this while loop on line 262 is bypassed:

    while (!(thisdev == rootdev && thisino == rootino))

  since the rootfs (/) is bind mounted onto the directory and the flow

  goes on to line 449, where it puts a '/' in the byte before the

  buffer.

- Finally on line 458, it moves 2 bytes (the underflowed byte and the

  '\0') to the buf[0] and buf[1], resulting in a 1 byte buffer overflow.

- buf is returned on line 469 and errno is not set.

This resolves BZ #28769.

Reviewed-by: Andreas Schwab <schwab@linux-m68k.org>

Reviewed-by: Adhemerval Zanella <adhemerval.zanella@linaro.org>

Signed-off-by: Qualys Security Advisory <qsa@qualys.com>

Signed-off-by: Siddhesh Poyarekar <siddhesh@sourceware.org>

| [NEWS](/git?p=glibc.git;a=blob;f=NEWS;h=07e9eac52d531afec15297ad546157d98c1c2c20;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |  | [diff](/git?p=glibc.git;a=blobdiff;f=NEWS;h=07e9eac52d531afec15297ad546157d98c1c2c20;hp=4c392a445e327e2d317ce62f2043b95a947a7ec8;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;hpb=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [blob](/git?p=glibc.git;a=blob;f=NEWS;h=07e9eac52d531afec15297ad546157d98c1c2c20;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [blame](/git?p=glibc.git;a=blame;f=NEWS;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [history](/git?p=glibc.git;a=history;f=NEWS;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |
| --- | --- | --- |
| [sysdeps/posix/getcwd.c](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=9d5787b6f42f272d64d9b7455153e6e28b51d1ad;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/posix/getcwd.c;h=9d5787b6f42f272d64d9b7455153e6e28b51d1ad;hp=e147a31a816c4e12ec0540c386e3dd7e5ebaaf62;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;hpb=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/posix/getcwd.c;h=9d5787b6f42f272d64d9b7455153e6e28b51d1ad;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/posix/getcwd.c;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [history](/git?p=glibc.git;a=history;f=sysdeps/posix/getcwd.c;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |
| [sysdeps/unix/sysv/linux/Makefile](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=7ca9350c99bd8b3ed95227e18e8188e8a34ee290;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |  | [diff](/git?p=glibc.git;a=blobdiff;f=sysdeps/unix/sysv/linux/Makefile;h=7ca9350c99bd8b3ed95227e18e8188e8a34ee290;hp=85fc8cbf7566314874d316f93e5f1421f36f46b8;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e;hpb=6c2f050dbe11fb4ed0a401a5f25731f2aa53046b) | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/Makefile;h=7ca9350c99bd8b3ed95227e18e8188e8a34ee290;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [blame](/git?p=glibc.git;a=blame;f=sysdeps/unix/sysv/linux/Makefile;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [history](/git?p=glibc.git;a=history;f=sysdeps/unix/sysv/linux/Makefile;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |
| [sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) | [new file with mode: 0644] | [blob](/git?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/tst-getcwd-smallbuff.c;h=d460d6e7662dc5e451cb8e76e96855a7527ba06d;hb=23e0e8f5f1fb5ed150253d986ecccdc90c2dcd5e) |

GNU C Library master sources
[RSS](/git?p=glibc.git;a=rss "log RSS feed")
[Atom](/git?p=glibc.git;a=atom "log Atom feed")

This page took 0.043338 seconds  and 6 git commands to generate.


