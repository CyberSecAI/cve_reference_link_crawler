

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3137253)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3137252 "Changeset 3137252")
* [Next Changeset](/changeset/3137254 "Changeset 3137254") →

---

# Changeset 3137253

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/18/2024 02:53:28 PM
([5 months](/timeline?from=2024-08-18T14%3A53%3A28Z&precision=second "See timeline at 08/18/2024 02:53:28 PM") ago)

Author:
infosatech
Message:

Update to version 1.9.1 from GitHub

Location:
[wp-last-modified-info](/browser/wp-last-modified-info?rev=3137253)
Files:

76 edited
1 copied

* [tags/1.9.1](/browser/wp-last-modified-info/tags/1.9.1?rev=3137253 "Show entry in browser")
  (copied)
  *(copied from [wp-last-modified-info/trunk](/browser/wp-last-modified-info/trunk?rev=3052359 "Show original file (revision 3137252)"))*
* [tags/1.9.1/functions.php](/browser/wp-last-modified-info/tags/1.9.1/functions.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file1 "Show differences"))
* [tags/1.9.1/inc/Api/Callbacks/AdminCallbacks.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/AdminCallbacks.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253 "Show entry in browser")
  (modified)
  ([22 diffs](#file3 "Show differences"))
* [tags/1.9.1/inc/Base/AdminNotice.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253 "Show entry in browser")
  (modified)
  ([9 diffs](#file4 "Show differences"))
* [tags/1.9.1/inc/Base/Enqueue.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/Enqueue.php?rev=3137253 "Show entry in browser")
  (modified)
  ([4 diffs](#file5 "Show differences"))
* [tags/1.9.1/inc/Base/PluginTools.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253 "Show entry in browser")
  (modified)
  ([13 diffs](#file6 "Show differences"))
* [tags/1.9.1/inc/Core/AdminBar.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php?rev=3137253 "Show entry in browser")
  (modified)
  ([6 diffs](#file7 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/AdminColumn.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php?rev=3137253 "Show entry in browser")
  (modified)
  ([6 diffs](#file8 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/BlockEditor.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file9 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/DashboardWidget.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php?rev=3137253 "Show entry in browser")
  (modified)
  ([6 diffs](#file10 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/EditScreen.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253 "Show entry in browser")
  (modified)
  ([21 diffs](#file11 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/MetaBox.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253 "Show entry in browser")
  (modified)
  ([10 diffs](#file12 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/MiscActions.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253 "Show entry in browser")
  (modified)
  ([12 diffs](#file13 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/PluginsData.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PluginsData.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file14 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/PostStatusFilters.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PostStatusFilters.php?rev=3137253 "Show entry in browser")
  (modified)
  ([4 diffs](#file15 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/UserColumn.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253 "Show entry in browser")
  (modified)
  ([10 diffs](#file16 "Show differences"))
* [tags/1.9.1/inc/Core/Backend/WooCommerce.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/WooCommerce.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file17 "Show differences"))
* [tags/1.9.1/inc/Core/Blocks.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file18 "Show differences"))
* [tags/1.9.1/inc/Core/Elementor/Modules/AuthorName.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorName.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file19 "Show differences"))
* [tags/1.9.1/inc/Core/Elementor/Modules/AuthorUrl.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorUrl.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [tags/1.9.1/inc/Core/Elementor/Modules/ModifiedDate.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedDate.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [tags/1.9.1/inc/Core/Elementor/Modules/ModifiedTime.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedTime.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file22 "Show differences"))
* [tags/1.9.1/inc/Core/Frontend/PostView.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253 "Show entry in browser")
  (modified)
  ([9 diffs](#file23 "Show differences"))
* [tags/1.9.1/inc/Core/Frontend/Schema.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253 "Show entry in browser")
  (modified)
  ([11 diffs](#file24 "Show differences"))
* [tags/1.9.1/inc/Core/Frontend/TemplateTags.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/TemplateTags.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file25 "Show differences"))
* [tags/1.9.1/inc/Core/Notification.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file26 "Show differences"))
* [tags/1.9.1/inc/Core/RestApi.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/RestApi.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file27 "Show differences"))
* [tags/1.9.1/inc/Helpers/Ajax.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Ajax.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file28 "Show differences"))
* [tags/1.9.1/inc/Helpers/Fields.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file29 "Show differences"))
* [tags/1.9.1/inc/Helpers/HelperFunctions.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253 "Show entry in browser")
  (modified)
  ([12 diffs](#file30 "Show differences"))
* [tags/1.9.1/inc/Helpers/SettingsData.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/SettingsData.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file31 "Show differences"))
* [tags/1.9.1/inc/Loader.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Loader.php?rev=3137253 "Show entry in browser")
  (modified)
  ([4 diffs](#file32 "Show differences"))
* [tags/1.9.1/inc/Pages/Dashboard.php](/browser/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file33 "Show differences"))
* [tags/1.9.1/readme.txt](/browser/wp-last-modified-info/tags/1.9.1/readme.txt?rev=3137253 "Show entry in browser")
  (modified)
  ([2 diffs](#file34 "Show differences"))
* [tags/1.9.1/templates/admin.php](/browser/wp-last-modified-info/tags/1.9.1/templates/admin.php?rev=3137253 "Show entry in browser")
  (modified)
  ([5 diffs](#file35 "Show differences"))
* [tags/1.9.1/uninstall.php](/browser/wp-last-modified-info/tags/1.9.1/uninstall.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file36 "Show differences"))
* [tags/1.9.1/vendor/composer/installed.php](/browser/wp-last-modified-info/tags/1.9.1/vendor/composer/installed.php?rev=3137253 "Show entry in browser")
  (modified)
  ([2 diffs](#file37 "Show differences"))
* [tags/1.9.1/wp-last-modified-info.php](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253 "Show entry in browser")
  (modified)
  ([9 diffs](#file38 "Show differences"))
* [trunk/functions.php](/browser/wp-last-modified-info/trunk/functions.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file39 "Show differences"))
* [trunk/inc/Api/Callbacks/AdminCallbacks.php](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file40 "Show differences"))
* [trunk/inc/Api/Callbacks/ManagerCallbacks.php](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253 "Show entry in browser")
  (modified)
  ([22 diffs](#file41 "Show differences"))
* [trunk/inc/Base/AdminNotice.php](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253 "Show entry in browser")
  (modified)
  ([9 diffs](#file42 "Show differences"))
* [trunk/inc/Base/Enqueue.php](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=3137253 "Show entry in browser")
  (modified)
  ([4 diffs](#file43 "Show differences"))
* [trunk/inc/Base/PluginTools.php](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253 "Show entry in browser")
  (modified)
  ([13 diffs](#file44 "Show differences"))
* [trunk/inc/Core/AdminBar.php](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=3137253 "Show entry in browser")
  (modified)
  ([6 diffs](#file45 "Show differences"))
* [trunk/inc/Core/Backend/AdminColumn.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=3137253 "Show entry in browser")
  (modified)
  ([6 diffs](#file46 "Show differences"))
* [trunk/inc/Core/Backend/BlockEditor.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file47 "Show differences"))
* [trunk/inc/Core/Backend/DashboardWidget.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3137253 "Show entry in browser")
  (modified)
  ([6 diffs](#file48 "Show differences"))
* [trunk/inc/Core/Backend/EditScreen.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253 "Show entry in browser")
  (modified)
  ([21 diffs](#file49 "Show differences"))
* [trunk/inc/Core/Backend/MetaBox.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253 "Show entry in browser")
  (modified)
  ([10 diffs](#file50 "Show differences"))
* [trunk/inc/Core/Backend/MiscActions.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253 "Show entry in browser")
  (modified)
  ([12 diffs](#file51 "Show differences"))
* [trunk/inc/Core/Backend/PluginsData.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file52 "Show differences"))
* [trunk/inc/Core/Backend/PostStatusFilters.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=3137253 "Show entry in browser")
  (modified)
  ([4 diffs](#file53 "Show differences"))
* [trunk/inc/Core/Backend/UserColumn.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253 "Show entry in browser")
  (modified)
  ([10 diffs](#file54 "Show differences"))
* [trunk/inc/Core/Backend/WooCommerce.php](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file55 "Show differences"))
* [trunk/inc/Core/Blocks.php](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file56 "Show differences"))
* [trunk/inc/Core/Elementor/Modules/AuthorName.php](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorName.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file57 "Show differences"))
* [trunk/inc/Core/Elementor/Modules/AuthorUrl.php](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorUrl.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file58 "Show differences"))
* [trunk/inc/Core/Elementor/Modules/ModifiedDate.php](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedDate.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file59 "Show differences"))
* [trunk/inc/Core/Elementor/Modules/ModifiedTime.php](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedTime.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file60 "Show differences"))
* [trunk/inc/Core/Frontend/PostView.php](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253 "Show entry in browser")
  (modified)
  ([9 diffs](#file61 "Show differences"))
* [trunk/inc/Core/Frontend/Schema.php](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253 "Show entry in browser")
  (modified)
  ([11 diffs](#file62 "Show differences"))
* [trunk/inc/Core/Frontend/TemplateTags.php](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file63 "Show differences"))
* [trunk/inc/Core/Notification.php](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file64 "Show differences"))
* [trunk/inc/Core/RestApi.php](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file65 "Show differences"))
* [trunk/inc/Helpers/Ajax.php](/browser/wp-last-modified-info/trunk/inc/Helpers/Ajax.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file66 "Show differences"))
* [trunk/inc/Helpers/Fields.php](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file67 "Show differences"))
* [trunk/inc/Helpers/HelperFunctions.php](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253 "Show entry in browser")
  (modified)
  ([12 diffs](#file68 "Show differences"))
* [trunk/inc/Helpers/SettingsData.php](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=3137253 "Show entry in browser")
  (modified)
  ([3 diffs](#file69 "Show differences"))
* [trunk/inc/Loader.php](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=3137253 "Show entry in browser")
  (modified)
  ([4 diffs](#file70 "Show differences"))
* [trunk/inc/Pages/Dashboard.php](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3137253 "Show entry in browser")
  (modified)
  ([8 diffs](#file71 "Show differences"))
* [trunk/readme.txt](/browser/wp-last-modified-info/trunk/readme.txt?rev=3137253 "Show entry in browser")
  (modified)
  ([2 diffs](#file72 "Show differences"))
* [trunk/templates/admin.php](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3137253 "Show entry in browser")
  (modified)
  ([5 diffs](#file73 "Show differences"))
* [trunk/uninstall.php](/browser/wp-last-modified-info/trunk/uninstall.php?rev=3137253 "Show entry in browser")
  (modified)
  ([1 diff](#file74 "Show differences"))
* [trunk/vendor/composer/installed.php](/browser/wp-last-modified-info/trunk/vendor/composer/installed.php?rev=3137253 "Show entry in browser")
  (modified)
  ([2 diffs](#file75 "Show differences"))
* [trunk/wp-last-modified-info.php](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253 "Show entry in browser")
  (modified)
  ([9 diffs](#file76 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-last-modified-info/tags/1.9.1/functions.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/functions.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/functions.php")

  | [r2734160](/browser/wp-last-modified-info/trunk/functions.php?rev=2734160#L12 "Show revision 2734160 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/functions.php?rev=3137253#L12 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | /\*\* |
  | 13 | 13 | \* Call the republish function directly |
  | 14 |  | \* |
  |  | 14 | \* |
  | 15 | 15 | \* @since 1.8.0 |
  | 16 | 16 | \* @param bool   $escape     Escape true|false |
  | […](/browser/wp-last-modified-info/trunk/functions.php?rev=2734160#L31) | […](/browser/wp-last-modified-info/tags/1.9.1/functions.php?rev=3137253#L31) |  |
  | 31 | 31 | /\*\* |
  | 32 | 32 | \* Call the republish function directly |
  | 33 |  | \* |
  |  | 33 | \* |
  | 34 | 34 | \* @since 1.8.0 |
  | 35 | 35 | \* @param bool   $escape   Escape true|false |
  | […](/browser/wp-last-modified-info/trunk/functions.php?rev=2734160#L38) | […](/browser/wp-last-modified-info/tags/1.9.1/functions.php?rev=3137253#L38) |  |
  | 38 | 38 | function the\_last\_modified\_info( $escape = false, $date = false ) { |
  | 39 | 39 | // displays/echos the last modified info. |
  | 40 |  | echo get\_the\_last\_modified\_info( $escape, $date ); |
  |  | 40 | echo get\_the\_last\_modified\_info( $escape, $date ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 41 | 41 | } |
  | 42 | 42 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/AdminCallbacks.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/AdminCallbacks.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/AdminCallbacks.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=2930921#L1 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/AdminCallbacks.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Admin callbacks. |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=2930921#L30) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/AdminCallbacks.php?rev=3137253#L30) |  |
  | 30 | 30 | <div class="wplmi-metabox-holder"> |
  | 31 | 31 | <div class="wplmi-metabox-td"> |
  | 32 |  | <h3 class="wplmi-metabox-title"><?~~php echo~~ esc\_html( $title ); ?></h3> |
  | 33 |  | <p class="wplmi-metabox-description"><?~~php echo~~ wp\_kses\_post( $description ); ?></p> |
  |  | 32 | <h3 class="wplmi-metabox-title"><?= esc\_html( $title ); ?></h3> |
  |  | 33 | <p class="wplmi-metabox-description"><?= wp\_kses\_post( $description ); ?></p> |
  | 34 | 34 | </div> |
  | 35 | 35 | </div> |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=2930921#L38) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/AdminCallbacks.php?rev=3137253#L38) |  |
  | 38 | 38 |  |
  | 39 | 39 | public function doSettingsSection( $attr ) { ?> |
  | 40 |  | <div id="<?~~php echo esc\_attr( $attr['id'] ); ?>" class="postbox <?php echo~~ esc\_attr( $attr['class'] ); ?>"> |
  |  | 40 | <div id="<?= esc\_attr( $attr['id'] ); ?>" class="postbox <?= esc\_attr( $attr['class'] ); ?>"> |
  | 41 | 41 | <?php $this->sectionHeader( $attr['title'], $attr['description'] ); ?> |
  | 42 | 42 | <div class="inside"> |
* ## [wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L1 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Settings callbacks. |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L19) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L19) |  |
  | 19 | 19 | class ManagerCallbacks |
  | 20 | 20 | { |
  | 21 |  | use Fields, HelperFunctions, Hooker; |
  | 22 |  |  |
  | 23 |  | /\* ============================================================================================== |
  | 24 |  | Post Options |
  |  | 21 | use Fields; |
  |  | 22 | use HelperFunctions; |
  |  | 23 | use Hooker; |
  |  | 24 |  |
  |  | 25 | /\* ============================================================================================== |
  |  | 26 | Post Options |
  | 25 | 27 | ============================================================================================== \*/ |
  | 26 | 28 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L186) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L188) |  |
  | 186 | 188 | ] ); |
  | 187 | 189 | } |
  | 188 |  |  |
  | 189 |  | /\* ============================================================================================== |
  | 190 |  | Template Tags |
  |  | 190 |  |
  |  | 191 | /\* ============================================================================================== |
  |  | 192 | Template Tags |
  | 191 | 193 | ============================================================================================== \*/ |
  | 192 | 194 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L252) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L254) |  |
  | 252 | 254 | } |
  | 253 | 255 |  |
  | 254 |  | /\* ============================================================================================== |
  | 255 |  | Schema Options |
  |  | 256 | /\* ============================================================================================== |
  |  | 257 | Schema Options |
  | 256 | 258 | ============================================================================================== \*/ |
  | 257 | 259 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L271) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L273) |  |
  | 271 | 273 | ] ); |
  | 272 | 274 | } |
  | 273 |  |  |
  |  | 275 |  |
  | 274 | 276 | public function schema\_post\_types( $args ) { |
  | 275 | 277 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L284) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L286) |  |
  | 284 | 286 | ] ); |
  | 285 | 287 | } |
  | 286 |  |  |
  |  | 288 |  |
  | 287 | 289 | public function enhanced\_schema( $args ) { |
  | 288 | 290 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L295) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L297) |  |
  | 295 | 297 | ] ); |
  | 296 | 298 | } |
  | 297 |  |  |
  | 298 |  | /\* ============================================================================================== |
  | 299 |  | Notification Options |
  |  | 299 |  |
  |  | 300 | /\* ============================================================================================== |
  |  | 301 | Notification Options |
  | 300 | 302 | ============================================================================================== \*/ |
  | 301 |  |  |
  |  | 303 |  |
  | 302 | 304 | public function enable\_notification( $args ) { |
  | 303 | 305 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L309) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L311) |  |
  | 309 | 311 | ] ); |
  | 310 | 312 | } |
  | 311 |  |  |
  |  | 313 |  |
  | 312 | 314 | public function author\_notification( $args ) { |
  | 313 | 315 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L320) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L322) |  |
  | 320 | 322 | ] ); |
  | 321 | 323 | } |
  | 322 |  |  |
  |  | 324 |  |
  | 323 | 325 | public function draft\_notification( $args ) { |
  | 324 | 326 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L331) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L333) |  |
  | 331 | 333 | ] ); |
  | 332 | 334 | } |
  | 333 |  |  |
  |  | 335 |  |
  | 334 | 336 | public function recipients\_list( $args ) { |
  | 335 | 337 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L343) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L345) |  |
  | 343 | 345 | ] ); |
  | 344 | 346 | } |
  | 345 |  |  |
  |  | 347 |  |
  | 346 | 348 | public function notification\_post\_types( $args ) { |
  | 347 | 349 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L371) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L373) |  |
  | 371 | 373 | ] ); |
  | 372 | 374 | } |
  | 373 |  |  |
  |  | 375 |  |
  | 374 | 376 | public function email\_notification\_message( $args ) { |
  | 375 | 377 | $default = 'The following changes are made on a %post\_type% of your blog by %modified\_author\_name%' . "\n\n" . '<p><strong>Post: %post\_title%</strong></p><p>%post\_diff%</p>'; |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L384) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L386) |  |
  | 384 | 386 | } |
  | 385 | 387 |  |
  | 386 |  | /\* ============================================================================================== |
  |  | 388 | /\* ============================================================================================== |
  | 387 | 389 | Misc Options |
  | 388 | 390 | ============================================================================================== \*/ |
  | 389 |  |  |
  |  | 391 |  |
  | 390 | 392 | public function admin\_bar( $args ) { |
  | 391 | 393 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L397) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L399) |  |
  | 397 | 399 | ] ); |
  | 398 | 400 | } |
  | 399 |  |  |
  |  | 401 |  |
  | 400 | 402 | public function disable\_plugin\_info( $args ) { |
  | 401 | 403 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L407) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L409) |  |
  | 407 | 409 | ] ); |
  | 408 | 410 | } |
  | 409 |  |  |
  |  | 411 |  |
  | 410 | 412 | public function admin\_sort\_order( $args ) { |
  | 411 | 413 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L422) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L424) |  |
  | 422 | 424 | ] ); |
  | 423 | 425 | } |
  | 424 |  |  |
  |  | 426 |  |
  | 425 | 427 | public function sort\_order( $args ) { |
  | 426 | 428 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L437) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L439) |  |
  | 437 | 439 | ] ); |
  | 438 | 440 | } |
  | 439 |  |  |
  |  | 441 |  |
  | 440 | 442 | public function replace\_date( $args ) { |
  | 441 | 443 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L452) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L454) |  |
  | 452 | 454 | ] ); |
  | 453 | 455 | } |
  | 454 |  |  |
  |  | 456 |  |
  | 455 | 457 | public function custom\_css( $args ) { |
  | 456 | 458 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L463) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L465) |  |
  | 463 | 465 | ] ); |
  | 464 | 466 | } |
  | 465 |  |  |
  |  | 467 |  |
  | 466 | 468 | public function delete\_data( $args ) { |
  | 467 | 469 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L476) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L478) |  |
  | 476 | 478 | /\*\* |
  | 477 | 479 | \* Generate template tags output. |
  | 478 |  | \* |
  |  | 480 | \* |
  | 479 | 481 | \* @since 1.8.0 |
  | 480 | 482 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L483) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L485) |  |
  | 483 | 485 | <div class="dynamic-tags"> |
  | 484 | 486 | <div class="dynamic-tags-label"> |
  | 485 |  | <a href="https://github.com/iamsayan/wp-last-modified-info/wiki/Temaplate-Use-Cases" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Use these tags', 'wp-last-modified-info' ); ?></a>. |
  |  | 487 | <a href="https://github.com/iamsayan/wp-last-modified-info/wiki/Temaplate-Use-Cases" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Use these tags', 'wp-last-modified-info' ); ?></a>. |
  | 486 | 488 | <a href="https://github.com/iamsayan/wp-last-modified-info/wiki/Template-Tags" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Available Dynamic Tags', 'wp-last-modified-info' ); ?></a>: |
  | 487 | 489 | </div> |
  | 488 |  | <div class="dynamic-tags-content"><?~~php echo $this->get\_available\_tags( $tags );~~ ?></div> |
  |  | 490 | <div class="dynamic-tags-content"><?= $this->get\_available\_tags( $tags ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?></div> |
  | 489 | 491 | </div> |
  | 490 | 492 | <?php |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L493) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L495) |  |
  | 493 | 495 |  |
  | 494 | 496 | /\*\* |
  | 495 |  | \* Get avaialable template tags. |
  | 496 |  | \* |
  |  | 497 | \* Get available template tags. |
  |  | 498 | \* |
  |  | 499 | \* @param $tags |
  |  | 500 | \* @return string |
  | 497 | 501 | \* @since 1.8.0 |
  | 498 |  | ~~\* @return string~~ |
  | 499 | 502 | \*/ |
  | 500 |  | private function get\_available\_tags( $tags ) { |
  |  | 503 | private function get\_available\_tags( $tags ): string { |
  | 501 | 504 | $content = []; |
  | 502 | 505 | foreach ( $tags as $tag ) { |
* ## [wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L1 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Admin notices. |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L45) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253#L45) |  |
  | 45 | 45 | unset( $\_GET['activate'] ); // phpcs:ignore |
  | 46 | 46 | } |
  | 47 |  | echo '<div class="error"><p>' . \_\_( 'Your version of PHP is below the minimum version of PHP required by WP Last Modified Info plugin. Please contact your host and request that your version be upgraded to 5.6 or later.', 'wp-last-modified-info' ) . '</p></div>'; |
  |  | 47 | echo '<div class="error"><p>' . esc\_html\_\_( 'Your version of PHP is below the minimum version of PHP required by WP Last Modified Info plugin. Please contact your host and request that your version be upgraded to 5.6 or later.', 'wp-last-modified-info' ) . '</p></div>'; |
  | 48 | 48 | return; |
  | 49 | 49 | } |
  | 50 |  |  |
  |  | 50 |  |
  | 51 | 51 | // Check transient, if available display notice |
  | 52 | 52 | if ( get\_transient( 'wplmi-show-notice-on-activation' ) !== false ) { ?> |
  | 53 | 53 | <div class="notice notice-success"> |
  | 54 |  | <p><strong><?php |
  |  | 54 | <p><strong><?php |
  | 55 | 55 | /\* translators: %s: 1. Plugin Name, 2. Version, 3. Link \*/ |
  | 56 |  | printf( \_\_( 'Thanks for installing %1$s v%2$s plugin. Click <a href="%3$s">here</a> to configure plugin settings.', 'wp-last-modified-info' ), 'WP Last Modified Info', esc\_html( $this->version ), esc\_url( admin\_url( 'options-general.php?page=wp-last-modified-info' ) ) ); ?></strong></p> |
  |  | 56 | printf( esc\_html\_\_( 'Thanks for installing %1$s v%2$s plugin. Click <a href="%3$s">here</a> to configure plugin settings.', 'wp-last-modified-info' ), 'WP Last Modified Info', esc\_html( $this->version ), esc\_url( admin\_url( 'options-general.php?page=wp-last-modified-info' ) ) ); ?></strong></p> |
  | 57 | 57 | </div> <?php |
  | 58 | 58 | delete\_transient( 'wplmi-show-notice-on-activation' ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L65) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253#L65) |  |
  | 65 | 65 | $show\_rating = false; |
  | 66 | 66 | } |
  | 67 |  |  |
  |  | 67 |  |
  | 68 | 68 | if ( $show\_rating ) { |
  | 69 | 69 | $dismiss = wp\_nonce\_url( add\_query\_arg( 'wplmi\_notice\_action', 'dismiss\_rating' ), 'wplmi\_notice\_nonce' ); |
  | 70 | 70 | $no\_thanks = wp\_nonce\_url( add\_query\_arg( 'wplmi\_notice\_action', 'no\_thanks\_rating' ), 'wplmi\_notice\_nonce' ); ?> |
  | 71 |  |  |
  |  | 71 |  |
  | 72 | 72 | <div class="notice notice-success"> |
  | 73 |  | <p><?~~php echo~~ wp\_kses\_post( 'Hey, I noticed you\'ve been using WP Last Modified Info for more than 1 week – that’s awesome! Could you please do me a BIG favor and give it a <strong>5-star</strong> rating on WordPress? Just to help us spread the word and boost my motivation.', 'wp-last-modified-info' ); ?></p> |
  |  | 73 | <p><?= wp\_kses\_post( 'Hey, I noticed you\'ve been using WP Last Modified Info for more than 1 week – that’s awesome! Could you please do me a BIG favor and give it a <strong>5-star</strong> rating on WordPress? Just to help us spread the word and boost my motivation.', 'wp-last-modified-info' ); ?></p> |
  | 74 | 74 | <p><a href="https://wordpress.org/support/plugin/wp-last-modified-info/reviews/?filter=5#new-post" target="\_blank" class="button button-secondary" rel="noopener"><?php esc\_html\_e( 'Ok, you deserve it', 'wp-last-modified-info' ); ?></a>&nbsp; |
  | 75 |  | <a href="<?~~php echo~~ esc\_url( $dismiss ); ?>" class="already-did"><strong><?php esc\_html\_e( 'I already did', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  | 76 |  | <a href="<?~~php echo~~ esc\_url( $no\_thanks ); ?>" class="later"><strong><?php esc\_html\_e( 'Nope&#44; maybe later', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  | 77 |  | <a href="<?~~php echo~~ esc\_url( $dismiss ); ?>" class="hide"><strong><?php esc\_html\_e( 'I don\'t want to rate', 'wp-last-modified-info' ); ?></strong></a></p> |
  |  | 75 | <a href="<?= esc\_url( $dismiss ); ?>" class="already-did"><strong><?php esc\_html\_e( 'I already did', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  |  | 76 | <a href="<?= esc\_url( $no\_thanks ); ?>" class="later"><strong><?php esc\_html\_e( 'Nope&#44; maybe later', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  |  | 77 | <a href="<?= esc\_url( $dismiss ); ?>" class="hide"><strong><?php esc\_html\_e( 'I don\'t want to rate', 'wp-last-modified-info' ); ?></strong></a></p> |
  | 78 | 78 | </div> |
  | 79 | 79 | <?php |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L90) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253#L90) |  |
  | 90 | 90 | $dismiss = wp\_nonce\_url( add\_query\_arg( 'wplmi\_notice\_action', 'dismiss\_donate' ), 'wplmi\_notice\_nonce' ); |
  | 91 | 91 | $no\_thanks = wp\_nonce\_url( add\_query\_arg( 'wplmi\_notice\_action', 'no\_thanks\_donate' ), 'wplmi\_notice\_nonce' ); ?> |
  | 92 |  |  |
  |  | 92 |  |
  | 93 | 93 | <div class="notice notice-success"> |
  | 94 |  | <p><?~~php echo~~ wp\_kses\_post( 'Hey, I noticed you\'ve been using WP Last Modified Info for more than 2 week – that’s awesome! If you like WP Last Modified Info and you are satisfied with the plugin, isn’t that worth a coffee or two? Please consider donating. Donations help me to continue support and development of this free plugin! Thank you very much!', 'wp-last-modified-info' ); ?></p> |
  |  | 94 | <p><?= wp\_kses\_post( 'Hey, I noticed you\'ve been using WP Last Modified Info for more than 2 week – that’s awesome! If you like WP Last Modified Info and you are satisfied with the plugin, isn’t that worth a coffee or two? Please consider donating. Donations help me to continue support and development of this free plugin! Thank you very much!', 'wp-last-modified-info' ); ?></p> |
  | 95 | 95 | <p><a href="https://www.paypal.me/iamsayan" target="\_blank" class="button button-secondary" rel="noopener"><?php esc\_html\_e( 'Donate Now', 'wp-last-modified-info' ); ?></a>&nbsp; |
  | 96 |  | <a href="<?~~php echo~~ esc\_url( $dismiss ); ?>" class="already-did"><strong><?php esc\_html\_e( 'I already donated', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  | 97 |  | <a href="<?~~php echo~~ esc\_url( $no\_thanks ); ?>" class="later"><strong><?php esc\_html\_e( 'Nope&#44; maybe later', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  | 98 |  | <a href="<?~~php echo~~ esc\_url( $dismiss ); ?>" class="hide"><strong><?php esc\_html\_e( 'I don\'t want to donate', 'wp-last-modified-info' ); ?></strong></a></p> |
  |  | 96 | <a href="<?= esc\_url( $dismiss ); ?>" class="already-did"><strong><?php esc\_html\_e( 'I already donated', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  |  | 97 | <a href="<?= esc\_url( $no\_thanks ); ?>" class="later"><strong><?php esc\_html\_e( 'Nope&#44; maybe later', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  |  | 98 | <a href="<?= esc\_url( $dismiss ); ?>" class="hide"><strong><?php esc\_html\_e( 'I don\'t want to donate', 'wp-last-modified-info' ); ?></strong></a></p> |
  | 99 | 99 | </div> |
  | 100 | 100 | <?php |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L120) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253#L120) |  |
  | 120 | 120 | } |
  | 121 | 121 |  |
  | 122 |  | if ( ~~! isset( $\_REQUEST['wplmi\_notice\_action'] ) ||~~ empty( $\_REQUEST['wplmi\_notice\_action'] ) ) { |
  |  | 122 | if ( empty( $\_REQUEST['wplmi\_notice\_action'] ) ) { |
  | 123 | 123 | return; |
  | 124 | 124 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L126) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253#L126) |  |
  | 126 | 126 | check\_admin\_referer( 'wplmi\_notice\_nonce' ); |
  | 127 | 127 |  |
  | 128 |  | $notice = sanitize\_text\_field( $\_REQUEST['wplmi\_notice\_action'] ); |
  |  | 128 | $notice = sanitize\_text\_field( $\_REQUEST['wplmi\_notice\_action'] ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.MissingUnslash |
  | 129 | 129 | $notice = explode( '\_', $notice ); |
  | 130 | 130 | $notice\_type = end( $notice ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L135) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253#L135) |  |
  | 135 | 135 | update\_option( 'wplmi\_plugin\_dismiss\_' . $notice\_type . '\_notice', '1', false ); |
  | 136 | 136 | } |
  | 137 |  |  |
  |  | 137 |  |
  | 138 | 138 | if ( 'no\_thanks' === $notice\_action ) { |
  | 139 | 139 | update\_option( 'wplmi\_plugin\_no\_thanks\_' . $notice\_type . '\_notice', '1', false ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L145) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253#L145) |  |
  | 145 | 145 | } |
  | 146 | 146 | } |
  | 147 |  |  |
  | 148 |  | wp\_redirect( remove\_query\_arg( [ 'wplmi\_notice\_action', '\_wpnonce' ] ) ); |
  |  | 147 |  |
  |  | 148 | wp\_safe\_redirect( remove\_query\_arg( [ 'wplmi\_notice\_action', '\_wpnonce' ] ) ); |
  | 149 | 149 | exit; |
  | 150 | 150 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L155) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/AdminNotice.php?rev=3137253#L155) |  |
  | 155 | 155 | private function calculate\_time() { |
  | 156 | 156 | $installed\_time = get\_option( 'wplmi\_plugin\_installed\_time' ); |
  | 157 |  |  |
  |  | 157 |  |
  | 158 | 158 | if ( ! $installed\_time ) { |
  | 159 | 159 | $installed\_time = time(); |
  | 160 | 160 | update\_option( 'wplmi\_plugin\_installed\_time', $installed\_time, false ); |
  | 161 | 161 | } |
  | 162 |  |  |
  |  | 162 |  |
  | 163 | 163 | return $installed\_time; |
  | 164 | 164 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Base/Enqueue.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Base/Enqueue.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Base/Enqueue.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=2930921#L1 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/Enqueue.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Enqueue all css & js. |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=2930921#L22) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/Enqueue.php?rev=3137253#L22) |  |
  | 22 | 22 | class Enqueue extends BaseController |
  | 23 | 23 | { |
  | 24 |  | use Hooker, HelperFunctions; |
  |  | 24 | use Hooker; |
  |  | 25 | use HelperFunctions; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=2930921#L38) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/Enqueue.php?rev=3137253#L39) |  |
  | 38 | 39 |  |
  | 39 | 40 | if ( 'settings\_page\_wp-last-modified-info' === $hook ) { |
  | 40 |  |  |
  |  | 41 |  |
  | 41 | 42 | // enqueue required css |
  | 42 | 43 | wp\_enqueue\_style( 'wp-codemirror' ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=2930921#L46) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/Enqueue.php?rev=3137253#L47) |  |
  | 46 | 47 | wp\_enqueue\_script( 'jquery-ui-resizable' ); |
  | 47 | 48 | wp\_enqueue\_script( 'wp-theme-plugin-editor' ); |
  | 48 |  |  |
  |  | 49 |  |
  | 49 | 50 | // load required css & js files. |
  | 50 | 51 | $this->load( 'css', 'admin', 'admin.min.css', $this->version ); |
  | 51 | 52 | $this->load( 'css', 'selectize', 'selectize.min.css', '0.15.2' ); |
  | 52 | 53 | $this->load( 'css', 'confirm', 'jquery-confirm.min.css', '3.3.4' ); |
  | 53 |  |  |
  |  | 54 |  |
  | 54 | 55 | $this->load( 'js', 'selectize', 'selectize.min.js', '0.15.2', [ 'jquery' ] ); |
  | 55 | 56 | $this->load( 'js', 'confirm', 'jquery-confirm.min.js', '3.3.4', [ 'jquery' ] ); |
  | 56 | 57 | $this->load( 'js', 'admin', 'admin.min.js', $this->version, [ 'jquery', 'jquery-form', 'jquery-ui-resizable', 'wplmi-confirm', 'wplmi-selectize' ] ); |
  | 57 |  |  |
  |  | 58 |  |
  | 58 | 59 | $args = [ |
  | 59 | 60 | 'ajaxurl'        => admin\_url( 'admin-ajax.php' ), |
* ## [wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L1 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Plugin Tools. |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L22) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L22) |  |
  | 22 | 22 | class PluginTools |
  | 23 | 23 | { |
  | 24 |  | use Ajax, Hooker, HelperFunctions; |
  | 25 |  |  |
  |  | 24 | use Ajax; |
  |  | 25 | use Hooker; |
  |  | 26 | use HelperFunctions; |
  |  | 27 |  |
  | 26 | 28 | /\*\* |
  | 27 | 29 | \* Register functions. |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L36) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L38) |  |
  | 36 | 38 | $this->ajax( 'process\_delete\_plugin\_data', 'remove\_settings' ); |
  | 37 | 39 | } |
  | 38 |  |  |
  |  | 40 |  |
  | 39 | 41 | /\*\* |
  | 40 | 42 | \* Process a settings export that generates a .json file |
  | 41 | 43 | \*/ |
  | 42 | 44 | public function export\_settings() { |
  | 43 |  | if ( empty( $\_POST['wplmi\_export\_action'] ) || 'wplmi\_export\_settings' != $\_POST['wplmi\_export\_action'] ) { |
  |  | 45 | if ( empty( $\_POST['wplmi\_export\_action'] ) || 'wplmi\_export\_settings' !== $\_POST['wplmi\_export\_action'] ) { |
  | 44 | 46 | return; |
  | 45 | 47 | } |
  | 46 | 48 |  |
  | 47 |  | if ( ! ~~wp\_verify\_nonce( $\_POST['wplmi\_export\_nonce']~~, 'wplmi\_export\_nonce' ) ) { |
  |  | 49 | if ( ! isset( $\_POST['wplmi\_export\_nonce'] ) || ! wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_POST['wplmi\_export\_nonce'] ) ), 'wplmi\_export\_nonce' ) ) { |
  | 48 | 50 | return; |
  | 49 | 51 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L65) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L67) |  |
  | 65 | 67 | header( "Expires: 0" ); |
  | 66 | 68 |  |
  | 67 |  | echo json\_encode( $settings ); |
  |  | 69 | echo wp\_json\_encode( $settings ); |
  | 68 | 70 | exit; |
  | 69 | 71 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L73) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L75) |  |
  | 73 | 75 | \*/ |
  | 74 | 76 | public function import\_settings() { |
  | 75 |  | if ( empty( $\_POST['wplmi\_import\_action'] ) || 'wplmi\_import\_settings' != $\_POST['wplmi\_import\_action'] ) { |
  |  | 77 | if ( empty( $\_POST['wplmi\_import\_action'] ) || 'wplmi\_import\_settings' !== $\_POST['wplmi\_import\_action'] ) { |
  | 76 | 78 | return; |
  | 77 | 79 | } |
  | 78 | 80 |  |
  | 79 |  | if ( ! ~~wp\_verify\_nonce( $\_POST['wplmi\_import\_nonce']~~, 'wplmi\_import\_nonce' ) ) { |
  |  | 81 | if ( ! isset( $\_POST['wplmi\_import\_nonce'] ) || ! wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_POST['wplmi\_import\_nonce'] ) ), 'wplmi\_import\_nonce' ) ) { |
  | 80 | 82 | return; |
  | 81 | 83 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L85) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L87) |  |
  | 85 | 87 | } |
  | 86 | 88 |  |
  | 87 |  | $extension = explode( '.', sanitize\_text\_field( $\_FILES['import\_file']['name'] ) ); |
  |  | 89 | $extension = explode( '.', sanitize\_text\_field( $\_FILES['import\_file']['name'] ) ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  | 88 | 90 | $file\_extension = end( $extension ); |
  | 89 | 91 | if ( 'json' !== $file\_extension ) { |
  | 90 |  | wp\_die( \_\_( '<strong>Settings import failed:</strong> Please upload a valid .json file to import settings in this website.', 'wp-last-modified-info' ) ); |
  |  | 92 | wp\_die( sprintf( '<strong>%s</strong>: %s', |
  |  | 93 | esc\_html\_\_( 'Settings import failed', 'wp-last-modified-info' ), |
  |  | 94 | esc\_html\_\_( 'Please upload a valid .json file to import settings in this website.', 'wp-last-modified-info' ) |
  |  | 95 | ) ); |
  | 91 | 96 | } |
  | 92 | 97 |  |
  | 93 |  | $import\_file = sanitize\_text\_field( $\_FILES['import\_file']['tmp\_name'] ); |
  |  | 98 | $import\_file = sanitize\_text\_field( $\_FILES['import\_file']['tmp\_name'] ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  | 94 | 99 | if ( empty( $import\_file ) ) { |
  | 95 |  | wp\_die( \_\_( '<strong>Settings import failed:</strong> Please upload a file to import.', 'wp-last-modified-info' ) ); |
  |  | 100 | wp\_die( sprintf( '<strong>%s</strong>: %s', |
  |  | 101 | esc\_html\_\_( 'Settings import failed', 'wp-last-modified-info' ), |
  |  | 102 | esc\_html\_\_( 'Please upload a file to import.', 'wp-last-modified-info' ) |
  |  | 103 | ) ); |
  | 96 | 104 | } |
  | 97 | 105 |  |
  | 98 | 106 | // Retrieve the settings from the file and convert the json object to an array. |
  | 99 |  | $settings = (array) json\_decode( file\_get\_contents( $import\_file ) ); |
  |  | 107 | $settings = (array) json\_decode( file\_get\_contents( $import\_file ) ); // phpcs:ignore WordPress.WP.AlternativeFunctions.file\_get\_contents\_file\_get\_contents |
  | 100 | 108 | update\_option( 'lmt\_plugin\_global\_settings', $settings, false ); |
  | 101 | 109 |  |
  | 102 | 110 | // set temporary transient for admin notice |
  | 103 | 111 | set\_transient( 'wplmi\_import\_db\_done', true ); |
  | 104 |  |  |
  |  | 112 |  |
  | 105 | 113 | wp\_safe\_redirect( add\_query\_arg( 'page', 'wp-last-modified-info', admin\_url( 'options-general.php' ) ) ); |
  | 106 | 114 | exit; |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L114) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L122) |  |
  | 114 | 122 | $this->verify\_nonce(); |
  | 115 | 123 |  |
  | 116 |  | if ( ! isset( $\_POST['action\_type'] ) ) { |
  |  | 124 | if ( ! isset( $\_POST['action\_type'] ) ) { // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 117 | 125 | $this->error(); |
  | 118 | 126 | } |
  | 119 | 127 |  |
  | 120 |  | $action = sanitize\_text\_field( wp\_unslash( $\_POST['action\_type'] ) ); |
  |  | 128 | $action = sanitize\_text\_field( wp\_unslash( $\_POST['action\_type'] ) ); // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 121 | 129 | $value = ( $action == 'check' ) ? 'yes' : 'no'; |
  | 122 | 130 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L127) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L135) |  |
  | 127 | 135 | 'fields'      => 'ids', |
  | 128 | 136 | ]; |
  | 129 |  |  |
  |  | 137 |  |
  | 130 | 138 | $posts = get\_posts( $args ); |
  | 131 | 139 | if ( ! empty( $posts ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L134) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L142) |  |
  | 134 | 142 | } |
  | 135 | 143 | } |
  | 136 |  |  |
  |  | 144 |  |
  | 137 | 145 | $this->success( [ |
  | 138 | 146 | 'reload' => false, |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L148) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L156) |  |
  | 148 | 156 |  |
  | 149 | 157 | $option = get\_option( 'lmt\_plugin\_global\_settings' ); |
  | 150 |  |  |
  |  | 158 |  |
  | 151 | 159 | $this->success( [ |
  | 152 |  | 'elements' => json\_encode( $option ), |
  |  | 160 | 'elements' => wp\_json\_encode( $option ), |
  | 153 | 161 | ] ); |
  | 154 | 162 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L169) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L177) |  |
  | 169 | 177 | } |
  | 170 | 178 |  |
  | 171 |  | $data = wp\_unslash( $\_REQUEST['settings\_data'] ); |
  |  | 179 | $data = wp\_unslash( $\_REQUEST['settings\_data'] ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized |
  | 172 | 180 | $settings = (array) json\_decode( $data ); |
  | 173 | 181 |  |
  | 174 | 182 | if ( is\_array( $settings ) && ! empty( $settings ) ) { |
  | 175 | 183 | update\_option( 'lmt\_plugin\_global\_settings', $settings, false ); |
  | 176 |  |  |
  |  | 184 |  |
  | 177 | 185 | // set temporary transient for admin notice |
  | 178 | 186 | set\_transient( 'wplmi\_import\_db\_done', true ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L188) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L196) |  |
  | 188 | 196 | // security check |
  | 189 | 197 | $this->verify\_nonce(); |
  | 190 |  |  |
  |  | 198 |  |
  | 191 | 199 | // Remove options |
  | 192 | 200 | delete\_option( 'lmt\_plugin\_global\_settings' ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L212) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Base/PluginTools.php?rev=3137253#L220) |  |
  | 212 | 220 | public function admin\_notice() { |
  | 213 | 221 | if ( get\_transient( 'wplmi\_import\_db\_done' ) !== false ) { ?> |
  | 214 |  | <div class="notice notice-success is-dismissible"><p><strong><?php esc\_html\_e( 'Success! Plugin Settings has been imported successfully.', 'wp-last-modified-info' ); ?></strong></p></div><?php |
  |  | 222 | <div class="notice notice-success is-dismissible"><p><strong><?php esc\_html\_e( 'Success! Plugin Settings has been imported successfully.', 'wp-last-modified-info' ); ?></strong></p></div><?php |
  | 215 | 223 | delete\_transient( 'wplmi\_import\_db\_done' ); |
  | 216 | 224 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class AdminBar |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L32) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php?rev=3137253#L33) |  |
  | 32 | 33 | /\*\* |
  | 33 | 34 | \* Show original publish info. |
  | 34 |  | \* |
  |  | 35 | \* |
  | 35 | 36 | \* @param string  $content  Original Content |
  | 36 |  | \* |
  |  | 37 | \* |
  | 37 | 38 | \* @return string $content  Filtered Content |
  | 38 | 39 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L52) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php?rev=3137253#L53) |  |
  | 52 | 53 | return; |
  | 53 | 54 | } |
  | 54 |  |  |
  |  | 55 |  |
  | 55 | 56 | if ( 'auto-draft' === get\_post\_status() ) { |
  | 56 | 57 | return; |
  | 57 | 58 | } |
  | 58 |  |  |
  |  | 59 |  |
  | 59 | 60 | $object = get\_post\_type\_object( get\_post\_type() ); |
  | 60 | 61 | $args = array( |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L69) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php?rev=3137253#L70) |  |
  | 69 | 70 | ), |
  | 70 | 71 | ); |
  | 71 |  |  |
  |  | 72 |  |
  | 72 | 73 | $wp\_admin\_bar->add\_node( $args ); |
  | 73 | 74 | } |
  | 74 |  |  |
  |  | 75 |  |
  | 75 | 76 | /\*\* |
  | 76 | 77 | \* Generate title to show on admin bar |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L81) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php?rev=3137253#L82) |  |
  | 81 | 82 | $mod\_time = $this->get\_modified\_date( 'U' ); |
  | 82 | 83 | $org\_time = get\_post\_time( 'U', false, get\_the\_ID(), true ); |
  | 83 |  |  |
  |  | 84 |  |
  | 84 | 85 | if ( $mod\_time > $cur\_time || $org\_time > $mod\_time ) { |
  | 85 | 86 | /\* translators: %s: date time info \*/ |
  | 86 | 87 | return sprintf( \_\_( 'Updated on %1$s at %2$s', 'wp-last-modified-info' ), $this->get\_modified\_date( 'M j' ), $this->get\_modified\_date( get\_option( 'time\_format' ) ) ); |
  | 87 | 88 | } |
  | 88 |  |  |
  |  | 89 |  |
  | 89 | 90 | /\* translators: %s: time diff \*/ |
  | 90 | 91 | return sprintf( \_\_( 'Updated %s ago', 'wp-last-modified-info' ), human\_time\_diff( $this->get\_modified\_date( 'U' ), $cur\_time ) ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L100) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/AdminBar.php?rev=3137253#L101) |  |
  | 100 | 101 | return; |
  | 101 | 102 | } |
  | 102 |  |  |
  |  | 103 |  |
  | 103 | 104 | // If user can't edit post, then don't show |
  | 104 | 105 | if ( ! current\_user\_can( 'edit\_post', $post->ID ) ) { |
  | 105 | 106 | return; |
  | 106 | 107 | } |
  | 107 |  |  |
  |  | 108 |  |
  | 108 | 109 | $revision = wp\_get\_post\_revisions( $post->ID ); |
  | 109 | 110 | $latest\_revision = array\_shift( $revision ); |
  | 110 | 111 | $url = ''; |
  | 111 |  |  |
  |  | 112 |  |
  | 112 | 113 | if ( wp\_revisions\_enabled( $post ) && count( $revision ) >= 1 ) { |
  | 113 | 114 | $url = get\_admin\_url() . 'revision.php?revision=' . $latest\_revision->ID; |
  | 114 | 115 | } |
  | 115 |  |  |
  |  | 116 |  |
  | 116 | 117 | return $url; |
  | 117 | 118 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class AdminColumn |
  | 22 | 22 | { |
  | 23 |  | use Hooker, SettingsData; |
  |  | 23 | use Hooker; |
  |  | 24 | use SettingsData; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L47) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php?rev=3137253#L48) |  |
  | 47 | 48 | } |
  | 48 | 49 | } |
  | 49 |  |  |
  |  | 50 |  |
  | 50 | 51 | /\*\* |
  | 51 | 52 | \* Generate column data. |
  | 52 |  | \* |
  |  | 53 | \* |
  | 53 | 54 | \* @param string   $column   Column name |
  | 54 | 55 | \* @param int      $post\_id  Post ID |
  | 55 |  | \* |
  |  | 56 | \* |
  | 56 | 57 | \* @return string  $time |
  | 57 | 58 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L67) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php?rev=3137253#L68) |  |
  | 67 | 68 | $mod\_format = date( 'M d, Y H:i:s', strtotime( $m\_orig ) ); |
  | 68 | 69 | $disabled = ( ! empty( $p\_meta ) ) ? $p\_meta : 'no'; |
  | 69 |  |  |
  |  | 70 |  |
  | 70 | 71 | $html = $modified; |
  | 71 | 72 | if ( get\_the\_modified\_author() ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L82) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php?rev=3137253#L83) |  |
  | 82 | 83 | } |
  | 83 | 84 | $html .= '<span class="wplmi-hidden-status" style="display: none;">' . esc\_html( $post->post\_status ) . '</span>'; |
  | 84 |  |  |
  | 85 |  | echo $html; |
  |  | 85 |  |
  |  | 86 | echo $html; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 86 | 87 | } |
  | 87 | 88 | } |
  | 88 |  |  |
  |  | 89 |  |
  | 89 | 90 | /\*\* |
  | 90 | 91 | \* Column title. |
  | 91 |  | \* |
  |  | 92 | \* |
  | 92 | 93 | \* @param string   $column  Column name |
  | 93 | 94 | \* @return string  $column  Filtered column |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L95) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php?rev=3137253#L96) |  |
  | 95 | 96 | public function column\_title( $column ) { |
  | 96 | 97 | $column['lastmodified'] = \_\_( 'Last Modified', 'wp-last-modified-info' ); |
  | 97 |  |  |
  |  | 98 |  |
  | 98 | 99 | return $column; |
  | 99 | 100 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L101) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/AdminColumn.php?rev=3137253#L102) |  |
  | 101 | 102 | /\*\* |
  | 102 | 103 | \* Make Column sortable. |
  | 103 |  | \* |
  |  | 104 | \* |
  | 104 | 105 | \* @param string   $column  Column name |
  | 105 | 106 | \* @return array   $column  Filtered column |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L1 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Admin notices. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L22) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php?rev=3137253#L22) |  |
  | 22 | 22 | class BlockEditor extends BaseController |
  | 23 | 23 | { |
  | 24 |  | use Hooker, HelperFunctions; |
  | 25 |  |  |
  |  | 24 | use Hooker; |
  |  | 25 | use HelperFunctions; |
  |  | 26 |  |
  | 26 | 27 | /\*\* |
  | 27 | 28 | \* Register functions. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L31) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php?rev=3137253#L32) |  |
  | 31 | 32 | $this->action( 'init', 'register\_meta' ); |
  | 32 | 33 | $this->action( 'enqueue\_block\_editor\_assets', 'assets' ); |
  | 33 |  |  |
  |  | 34 |  |
  | 34 | 35 | // AIOSEO Integration |
  | 35 | 36 | $this->action( 'init', 'filter\_aioseo' ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L38) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php?rev=3137253#L39) |  |
  | 38 | 39 | /\*\* |
  | 39 | 40 | \* Add support for `custom-fields` for all posts. |
  | 40 |  | \* |
  |  | 41 | \* |
  | 41 | 42 | \* @param array  $args      Post type data |
  | 42 | 43 | \* @param string $post\_type Post type name |
  | 43 |  | \* |
  |  | 44 | \* |
  | 44 | 45 | \* @return array $args Post type data |
  | 45 | 46 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L50) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php?rev=3137253#L51) |  |
  | 50 | 51 |  |
  | 51 | 52 | if ( ! empty( $args['show\_in\_rest'] ) && ! post\_type\_supports( $post\_type, 'custom-fields' ) ) { |
  |  | 53 | if ( ! isset( $args['supports'] ) ) { |
  |  | 54 | $args['supports'] = []; |
  |  | 55 | } |
  | 52 | 56 | $args['supports'][] = 'custom-fields'; |
  | 53 | 57 | } |
  | 54 |  |  |
  |  | 58 |  |
  | 55 | 59 | return $this->do\_filter( 'post\_type\_args', $args, $post\_type ); |
  | 56 | 60 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L60) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php?rev=3137253#L64) |  |
  | 60 | 64 | \*/ |
  | 61 | 65 | public function register\_meta() { |
  | 62 |  | register\_meta( |
  |  | 66 | register\_meta( |
  | 63 | 67 | 'post', |
  | 64 | 68 | '\_lmt\_disableupdate', |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L71) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php?rev=3137253#L75) |  |
  | 71 | 75 | return current\_user\_can( 'edit\_posts' ); |
  | 72 | 76 | }, |
  | 73 |  | ] |
  |  | 77 | ] |
  | 74 | 78 | ); |
  | 75 | 79 |  |
  | 76 |  | register\_meta( |
  |  | 80 | register\_meta( |
  | 77 | 81 | 'post', |
  | 78 | 82 | '\_lmt\_disable', |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L111) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/BlockEditor.php?rev=3137253#L115) |  |
  | 111 | 115 | $prepared\_post->wplmi\_modified\_rest = $params['modified']; |
  | 112 | 116 | } |
  | 113 |  |  |
  |  | 117 |  |
  | 114 | 118 | if ( isset( $params['meta']['\_lmt\_disableupdate'] ) ) { |
  | 115 | 119 | $prepared\_post->wplmi\_lockmodifiedupdate = $params['meta']['\_lmt\_disableupdate']; |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L22 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class DashboardWidget |
  | 23 | 23 | { |
  | 24 |  | use HelperFunctions, Hooker; |
  |  | 24 | use HelperFunctions; |
  |  | 25 | use Hooker; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L37) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php?rev=3137253#L38) |  |
  | 37 | 38 | public function dashboard\_widget() { |
  | 38 | 39 | global $wp\_meta\_boxes; |
  | 39 |  |  |
  |  | 40 |  |
  | 40 | 41 | \wp\_add\_dashboard\_widget( |
  | 41 | 42 | 'dashboard\_last\_modified\_posts', // Widget slug. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L79) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php?rev=3137253#L80) |  |
  | 79 | 80 | while ( $posts->have\_posts() ) { |
  | 80 | 81 | $posts->the\_post(); |
  | 81 |  |  |
  |  | 82 |  |
  | 82 | 83 | $modified\_timestamp = get\_post\_modified\_time( 'U' ); |
  | 83 | 84 | if ( gmdate( 'Y-m-d', $modified\_timestamp ) == $today ) { |
  | 84 |  | $relative = \_\_( 'Today' ); |
  |  | 85 | $relative = \_\_( 'Today', 'wp-last-modified-info' ); |
  | 85 | 86 | } elseif ( gmdate( 'Y-m-d', $modified\_timestamp ) == $tomorrow ) { |
  | 86 |  | $relative = \_\_( 'Tomorrow' ); |
  |  | 87 | $relative = \_\_( 'Tomorrow', 'wp-last-modified-info' ); |
  | 87 | 88 | } elseif ( gmdate( 'Y', $modified\_timestamp ) !== gmdate( 'Y', $timestamp ) ) { |
  | 88 | 89 | /\* translators: Date and time format for recent posts on the dashboard, from a different calendar year, see https://www.php.net/date \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L92) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php?rev=3137253#L93) |  |
  | 92 | 93 | $relative = date\_i18n( 'M jS', $modified\_timestamp ); |
  | 93 | 94 | } |
  | 94 |  |  |
  |  | 95 |  |
  | 95 | 96 | // Use the post edit link for those who can edit, the permalink otherwise. |
  | 96 | 97 | $recent\_post\_link = current\_user\_can( 'edit\_post', get\_the\_ID() ) ? get\_edit\_post\_link() : get\_permalink(); |
  | 97 |  |  |
  |  | 98 |  |
  | 98 | 99 | $draft\_or\_post\_title = \_draft\_or\_post\_title(); |
  | 99 | 100 | printf( |
  | 100 | 101 | '<li><span>%1$s</span> <a href="%2$s" aria-label="%3$s">%4$s</a></li>', |
  | 101 | 102 | /\* translators: 1: Relative date, 2: Time. \*/ |
  | 102 |  | sprintf( ~~\_x( '%1$s, %2$s', 'dashboard' ), $relative, date\_i18n( get\_option( 'time\_format' ), $modified\_timestamp~~ ) ), |
  | 103 |  | ~~$recent\_post\_link~~, |
  |  | 103 | sprintf( esc\_html\_x( '%1$s, %2$s', 'dashboard', 'wp-last-modified-info' ), esc\_html( $relative ), esc\_html( date\_i18n( get\_option( 'time\_format' ), $modified\_timestamp ) ) ), |
  |  | 104 | esc\_url( $recent\_post\_link ), |
  | 104 | 105 | /\* translators: %s: Post title. \*/ |
  | 105 |  | esc\_attr( sprintf( ~~\_\_( 'Edit &#8220;%s&#8221;' ), $draft\_or\_post\_title ) ),~~ |
  | 106 |  | $draft\_or\_post\_title |
  |  | 106 | esc\_attr( sprintf( esc\_html\_\_( 'Edit &#8220;%s&#8221;', 'wp-last-modified-info' ), $draft\_or\_post\_title ) ), // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 107 | $draft\_or\_post\_title // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 107 | 108 | ); |
  | 108 | 109 | } |
  | 109 |  |  |
  |  | 110 |  |
  | 110 | 111 | echo '</ul>'; |
  | 111 | 112 | echo '</div>'; |
  | 112 |  |  |
  |  | 113 |  |
  | 113 | 114 | } else { |
  | 114 | 115 |  |
  | 115 | 116 | echo '<div class="no-activity">'; |
  | 116 | 117 | echo '<p class="smiley" aria-hidden="true"></p>'; |
  | 117 |  | echo '<p>' . ~~\_\_( 'No modified posts yet!~~' ) . '</p>'; |
  |  | 118 | echo '<p>' . esc\_html\_\_( 'No modified posts yet!', 'wp-last-modified-info' ) . '</p>'; |
  | 118 | 119 | echo '</div>'; |
  | 119 |  |  |
  |  | 120 |  |
  | 120 | 121 | } |
  | 121 | 122 | wp\_reset\_postdata(); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L129) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php?rev=3137253#L130) |  |
  | 129 | 130 | public function widget\_control\_callback() { |
  | 130 | 131 | // Update widget options |
  | 131 |  | if ( 'POST' === $\_SERVER['REQUEST\_METHOD'] && isset( $\_POST['wplmi\_widget\_options'] ) ) { |
  | 132 |  | check\_admin\_referer(); |
  |  | 132 | if ( 'POST' === $\_SERVER['REQUEST\_METHOD'] && isset( $\_POST['wplmi\_widget\_options'] ) ) { // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 133 | check\_admin\_referer( 'wplmi-dashboard-widget' ); |
  | 133 | 134 | update\_option( 'lmt\_dashboard\_widget\_options', array\_map( 'intval', $\_POST['wplmi\_widget\_options'] ), false ); |
  | 134 |  | } |
  |  | 135 | } |
  | 135 | 136 |  |
  | 136 | 137 | // Get widget options |
  | 137 | 138 | $widget\_options = get\_option( 'lmt\_dashboard\_widget\_options' ); |
  | 138 | 139 | $value = isset( $widget\_options['number'] ) ? $widget\_options['number'] : ''; |
  | 139 |  |  |
  | 140 |  | wp\_nonce\_field(); ?> |
  |  | 140 |  |
  |  | 141 | wp\_nonce\_field( 'wplmi-dashboard-widget' ); ?> |
  | 141 | 142 | <table> |
  | 142 | 143 | <tr> |
  | 143 | 144 | <td><label for="post-count"><strong><?php esc\_html\_e( 'Number of Posts to Display', 'wp-last-modified-info' ); ?>:</strong></label></td> |
  | 144 |  | <td><input class="widefat" id="post-count" name="wplmi\_widget\_options[number]" type="number" placeholder="5" min="3" max="100" value="<?~~php echo~~ esc\_attr( $value ); ?>" /></td> |
  |  | 145 | <td><input class="widefat" id="post-count" name="wplmi\_widget\_options[number]" type="number" placeholder="5" min="3" max="100" value="<?= esc\_attr( $value ); ?>" /></td> |
  | 145 | 146 | </tr> |
  | 146 | 147 | </table> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L170) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/DashboardWidget.php?rev=3137253#L171) |  |
  | 170 | 171 | padding-bottom: 0; |
  | 171 | 172 | } |
  | 172 |  |  |
  |  | 173 |  |
  | 173 | 174 | #dashboard\_last\_modified\_posts .dashboard-widget-control-form { |
  | 174 | 175 | padding-top: 12px; |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L22 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class EditScreen |
  | 23 | 23 | { |
  | 24 |  | use Ajax, Hooker, SettingsData; |
  |  | 24 | use Ajax; |
  |  | 25 | use Hooker; |
  |  | 26 | use SettingsData; |
  | 25 | 27 |  |
  | 26 | 28 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L34) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L36) |  |
  | 34 | 36 | $this->filter( 'wp\_insert\_post\_data', 'update\_data', 9999, 2 ); |
  | 35 | 37 | } |
  | 36 |  |  |
  |  | 38 |  |
  | 37 | 39 | /\*\* |
  | 38 | 40 | \* Post Submit Box HTML output. |
  | 39 |  | \* |
  |  | 41 | \* |
  | 40 | 42 | \* @param string $post WP Post |
  | 41 | 43 | \*/ |
  | 42 | 44 | public function submitbox\_edit( $post ) { |
  | 43 | 45 | global $wp\_locale; |
  | 44 |  |  |
  |  | 46 |  |
  | 45 | 47 | if ( in\_array( $post->post\_status, [ 'auto-draft', 'future' ] ) ) { |
  | 46 | 48 | return; |
  | 47 | 49 | } |
  | 48 |  |  |
  |  | 50 |  |
  | 49 | 51 | $datemodified = $post->post\_modified; |
  | 50 |  |  |
  |  | 52 |  |
  | 51 | 53 | $jj = mysql2date( 'd', $datemodified, false ); |
  | 52 | 54 | $mm = mysql2date( 'm', $datemodified, false ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L55) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L57) |  |
  | 55 | 57 | $mn = mysql2date( 'i', $datemodified, false ); |
  | 56 | 58 | $ss = mysql2date( 's', $datemodified, false ); |
  | 57 |  |  |
  |  | 59 |  |
  | 58 | 60 | $stop\_update = $this->get\_meta( $post->ID, '\_lmt\_disableupdate' ); |
  | 59 | 61 | $post\_types = get\_post\_type\_object( $post->post\_type ); |
  | 60 |  |  |
  |  | 62 |  |
  | 61 | 63 | // get modified time with a particular format |
  | 62 | 64 | $orig\_time = get\_post\_time( 'U', false, $post ); |
  | 63 | 65 | $mod\_time = get\_post\_modified\_time( 'U', false, $post ); ?> |
  | 64 |  |  |
  |  | 66 |  |
  | 65 | 67 | <div class="misc-pub-section curtime misc-pub-last-updated"> |
  | 66 |  | <span id="wplmi-timestamp"> <?php esc\_html\_e( 'Updated on:', 'wp-last-modified-info' ) ?> <strong><?~~php echo get\_the\_modified\_time( 'M j, Y \a\t H:i'~~ ); ?></strong></span> |
  |  | 68 | <span id="wplmi-timestamp"> <?php esc\_html\_e( 'Updated on:', 'wp-last-modified-info' ) ?> <strong><?= esc\_html( get\_the\_modified\_time( 'M j, Y \a\t H:i' ) ); ?></strong></span> |
  | 67 | 69 | <a href="#edit\_timestampmodified" class="edit-timestampmodified hide-if-no-js" role="button"><span aria-hidden="true"><?php esc\_html\_e( 'Edit', 'wp-last-modified-info' ); ?></span> <span class="screen-reader-text"><?php esc\_html\_e( 'Edit modified date and time', 'wp-last-modified-info' ); ?></span></a> |
  | 68 | 70 | <fieldset id="timestampmodifieddiv" class="hide-if-js" data-prefix="<?php esc\_attr\_e( 'Updated on:', 'wp-last-modified-info' ); ?>" data-separator="<?php esc\_attr\_e( 'at', 'wp-last-modified-info' ); ?>" style="padding-top: 5px;line-height: 1.76923076;"> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L76) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L78) |  |
  | 76 | 78 | $monthnum = zeroise( $i, 2 ); |
  | 77 | 79 | $monthtext = $wp\_locale->get\_month\_abbrev( $wp\_locale->get\_month( $i ) ); |
  | 78 |  | echo '<option value="' . ~~$monthnum . '" data-text="' . $monthtext . '" ' . selected( $monthnum, $mm, false ).'>' . sprintf( \_\_( '%1$s-%2$s' ), $monthnum, $monthtext~~ ) . '</option>'; |
  |  | 80 | echo '<option value="' . esc\_attr( $monthnum ) . '" data-text="' . esc\_attr( $monthtext ) . '" ' . selected( $monthnum, $mm, false ).'>' . sprintf( '%1$s-%2$s', esc\_html( $monthnum ), esc\_html( $monthtext ) ) . '</option>'; |
  | 79 | 81 | } |
  | 80 | 82 | ?> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L83) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L85) |  |
  | 83 | 85 | <label> |
  | 84 | 86 | <span class="screen-reader-text"><?php esc\_html\_e( 'Day', 'wp-last-modified-info' ); ?></span> |
  | 85 |  | <input type="text" id="jjm" class="time-modified jjm-edit" name="jjm" value="<?~~php echo $jj~~; ?>" size="2" maxlength="2" autocomplete="off" /> |
  |  | 87 | <input type="text" id="jjm" class="time-modified jjm-edit" name="jjm" value="<?= esc\_attr( $jj ); ?>" size="2" maxlength="2" autocomplete="off" /> |
  | 86 | 88 | </label>, <label> |
  | 87 | 89 | <span class="screen-reader-text"><?php esc\_html\_e( 'Year', 'wp-last-modified-info' ); ?></span> |
  | 88 |  | <input type="text" id="aam" class="time-modified aam-edit" name="aam" value="<?~~php echo $aa~~; ?>" size="4" maxlength="4" autocomplete="off" /> |
  | 89 |  | </label> <?php esc\_html\_e( 'at', 'wp-last-modified-info' ); ?><label> |
  |  | 90 | <input type="text" id="aam" class="time-modified aam-edit" name="aam" value="<?= esc\_attr( $aa ); ?>" size="4" maxlength="4" autocomplete="off" /> |
  |  | 91 | </label> <?php esc\_html\_e( 'at', 'wp-last-modified-info' ); ?><label> |
  | 90 | 92 | <span class="screen-reader-text"><?php esc\_html\_e( 'Hour', 'wp-last-modified-info'); ?></span> |
  | 91 |  | <input type="text" id="hhm" class="time-modified hhm-edit" name="hhm" value="<?~~php echo $hh~~; ?>" size="2" maxlength="2" autocomplete="off"/> |
  |  | 93 | <input type="text" id="hhm" class="time-modified hhm-edit" name="hhm" value="<?= esc\_attr( $hh ); ?>" size="2" maxlength="2" autocomplete="off"/> |
  | 92 | 94 | </label><?php esc\_html\_e(':', 'wp-last-modified-info'); ?><label> |
  | 93 | 95 | <span class="screen-reader-text"><?php esc\_html\_e( 'Minute', 'wp-last-modified-info' ); ?></span> |
  | 94 |  | <input type="text" id="mnm" class="time-modified mnm-edit" name="mnm" value="<?~~php echo $mn~~; ?>" size="2" maxlength="2" autocomplete="off" /> |
  |  | 96 | <input type="text" id="mnm" class="time-modified mnm-edit" name="mnm" value="<?= esc\_attr( $mn ); ?>" size="2" maxlength="2" autocomplete="off" /> |
  | 95 | 97 | </label> |
  | 96 | 98 | </div> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L106) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L108) |  |
  | 106 | 108 | $hh\_current = gmdate( 'H', $currentlocal ); |
  | 107 | 109 | $mn\_current = gmdate( 'i', $currentlocal ); |
  | 108 |  |  |
  |  | 110 |  |
  | 109 | 111 | $vals = [ |
  | 110 | 112 | 'mmm' => [ $mm, $mm\_current ], |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L114) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L116) |  |
  | 114 | 116 | 'mnm' => [ $mn, $mn\_current ], |
  | 115 | 117 | ]; |
  | 116 |  |  |
  |  | 118 |  |
  | 117 | 119 | foreach ( $vals as $key => $val ) { |
  | 118 |  | echo '<input type="hidden" id="hidden\_' . ~~$key . '" name="hidden\_' . $key . '" value="' . $val[0]~~ . '">'; |
  | 119 |  | echo '<input type="hidden" id="cur\_' . ~~$key . '" name="cur\_' . $key . '" value="' . $val[1]~~ . '">'; |
  |  | 120 | echo '<input type="hidden" id="hidden\_' . esc\_attr( $key ). '" name="hidden\_' . esc\_attr( $key ) . '" value="' . esc\_attr( $val[0] ). '">'; |
  |  | 121 | echo '<input type="hidden" id="cur\_' . esc\_attr( $key ) . '" name="cur\_' . esc\_attr( $key ) . '" value="' . esc\_attr( $val[1] ) . '">'; |
  | 120 | 122 | } ?> |
  | 121 |  |  |
  | 122 |  | <input type="hidden" id="ssm" name="ssm" value="<?~~php echo $ss~~; ?>"> |
  |  | 123 |  |
  |  | 124 | <input type="hidden" id="ssm" name="ssm" value="<?= esc\_attr( $ss ); ?>"> |
  | 123 | 125 | <input type="hidden" id="wplmi-change-modified" name="wplmi\_change" value="no"> |
  | 124 |  | <input type="hidden" id="wplmi-disable-hidden" name="wplmi\_disable" value="<?~~php echo ( $stop\_update ) ? $stop\_update~~ : 'no'; ?>"> |
  | 125 |  | <input type="hidden" id="wplmi-post-modified" name="wplmi\_modified" value="<?~~php echo $datemodified~~; ?>"> |
  | 126 |  |  |
  |  | 126 | <input type="hidden" id="wplmi-disable-hidden" name="wplmi\_disable" value="<?= ( $stop\_update ) ? esc\_attr( $stop\_update ) : 'no'; ?>"> |
  |  | 127 | <input type="hidden" id="wplmi-post-modified" name="wplmi\_modified" value="<?= esc\_attr( $datemodified ); ?>"> |
  |  | 128 |  |
  | 127 | 129 | <p id="wplmi-meta" class="wplmi-meta-options"> |
  | 128 |  | <a href="#edit\_timestampmodified" class="save-timestamp hide-if-no-js button"><?php esc\_html\_e( 'OK', 'wp-last-modified-info~~'~~); ?></a> |
  |  | 130 | <a href="#edit\_timestampmodified" class="save-timestamp hide-if-no-js button"><?php esc\_html\_e( 'OK', 'wp-last-modified-info' ); ?></a> |
  | 129 | 131 | <a href="#edit\_timestampmodified" class="cancel-timestamp hide-if-no-js button-cancel"><?php esc\_html\_e( 'Cancel', 'wp-last-modified-info' ); ?></a>&nbsp;&nbsp;&nbsp; |
  | 130 | 132 | </p> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L135) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L137) |  |
  | 135 | 137 | /\*\* |
  | 136 | 138 | \* Quick edit HTML output. |
  | 137 |  | \* |
  |  | 139 | \* |
  | 138 | 140 | \* @param string  $column\_name  Current column name |
  | 139 | 141 | \* @param string  $post\_type    Post type |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L156) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L158) |  |
  | 156 | 158 | $monthnum = zeroise( $i, 2 ); |
  | 157 | 159 | $monthtext = $wp\_locale->get\_month\_abbrev( $wp\_locale->get\_month( $i ) ); |
  | 158 |  | echo '<option value="' . ~~$monthnum . '" data-text="' . $monthtext . '">' . sprintf( \_\_( '%1$s-%2$s' ), $monthnum, $monthtext~~ ) . '</option>'; |
  |  | 160 | echo '<option value="' . esc\_attr( $monthnum ) . '" data-text="' . esc\_attr( $monthtext ) . '">' . sprintf( '%1$s-%2$s', esc\_html( $monthnum ), esc\_html( $monthtext ) ) . '</option>'; |
  | 159 | 161 | } |
  | 160 | 162 | ?> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L188) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L190) |  |
  | 188 | 190 | /\*\* |
  | 189 | 191 | \* Quick ecit HTML output. |
  | 190 |  | \* |
  |  | 192 | \* |
  | 191 | 193 | \* @param string  $column\_name  Current column name |
  | 192 | 194 | \* @param string  $post\_type    Post type |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L211) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L213) |  |
  | 211 | 213 | $monthnum = zeroise( $i, 2 ); |
  | 212 | 214 | $monthtext = $wp\_locale->get\_month\_abbrev( $wp\_locale->get\_month( $i ) ); |
  | 213 |  | echo '<option value="' . ~~$monthnum . '" data-text="' . $monthtext . '">' . sprintf( \_\_( '%1$s-%2$s' ), $monthnum, $monthtext~~ ) . '</option>'; |
  |  | 215 | echo '<option value="' . esc\_attr( $monthnum ) . '" data-text="' . esc\_attr( $monthtext ) . '">' . sprintf( '%1$s-%2$s', esc\_html( $monthnum ), esc\_html( $monthtext ) ) . '</option>'; |
  | 214 | 216 | } |
  | 215 | 217 | ?> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L250) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L252) |  |
  | 250 | 252 |  |
  | 251 | 253 | // we need the post IDs |
  | 252 |  | $post\_ids = ( ! empty( $\_POST['post\_ids'] ) ) ? wp\_parse\_id\_list( ~~$\_POST['post\_ids'] ) : [];~~ |
  |  | 254 | $post\_ids = ( ! empty( $\_POST['post\_ids'] ) ) ? wp\_parse\_id\_list( array\_map( 'intval', $\_POST['post\_ids'] ) ) : []; // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 253 | 255 |  |
  | 254 | 256 | // if we have post IDs |
  | 255 | 257 | if ( ! empty( $post\_ids ) && is\_array( $post\_ids ) ) { |
  | 256 |  | $mmm = sanitize\_text\_field( ~~$\_POST['modified\_month'] );~~ |
  | 257 |  | $jj = sanitize\_text\_field( ~~$\_POST['modified\_day'] );~~ |
  | 258 |  | $aa = sanitize\_text\_field( ~~$\_POST['modified\_year'] );~~ |
  | 259 |  | $hh = sanitize\_text\_field( ~~$\_POST['modified\_hour'] );~~ |
  | 260 |  | $mn = sanitize\_text\_field( ~~$\_POST['modified\_minute'] );~~ |
  | 261 |  | $disable = sanitize\_text\_field( ~~$\_POST['modified\_disable'] );~~ |
  | 262 |  |  |
  |  | 258 | $mmm = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_month'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 259 | $jj = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_day'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 260 | $aa = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_year'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 261 | $hh = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_hour'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 262 | $mn = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_minute'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 263 | $disable = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_disable'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 264 |  |
  | 263 | 265 | $mm = ( is\_numeric( $mmm ) && $mmm <= 12 ) ? $mmm : '01'; // months |
  | 264 | 266 | $jj = ( is\_numeric( $jj ) && $jj <= 31 ) ? $jj : '01'; // days |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L267) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L269) |  |
  | 267 | 269 | $mn = ( is\_numeric( $mn ) && $mn <= 60 ) ? $mn : '00'; // minutes |
  | 268 | 270 | $ss = '00'; // seconds |
  | 269 |  |  |
  |  | 271 |  |
  | 270 | 272 | $newdate = sprintf( "%04d-%02d-%02d %02d:%02d:%02d", $aa, $mm, $jj, $hh, $mn, $ss ); |
  | 271 | 273 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L276) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L278) |  |
  | 276 | 278 | $this->update\_meta( $post\_id, 'wplmi\_bulk\_update\_datetime', $newdate ); |
  | 277 | 279 | } |
  | 278 |  |  |
  |  | 280 |  |
  | 279 | 281 | if ( 'none' !== $disable ) { |
  | 280 | 282 | $this->update\_meta( $post\_id, '\_lmt\_disableupdate', $disable ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L283) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L285) |  |
  | 283 | 285 | } |
  | 284 | 286 | } |
  | 285 |  |  |
  |  | 287 |  |
  | 286 | 288 | $this->success(); |
  | 287 | 289 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L289) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L291) |  |
  | 289 | 291 | /\*\* |
  | 290 | 292 | \* Save post modified info to db. |
  | 291 |  | \* |
  |  | 293 | \* |
  | 292 | 294 | \* @param object   $data     Old Data |
  | 293 | 295 | \* @param object   $postarr  Current Data |
  | 294 |  | \* |
  |  | 296 | \* |
  | 295 | 297 | \* @return object  $data |
  | 296 | 298 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L317) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L319) |  |
  | 317 | 319 | // Get disable state. |
  | 318 | 320 | $disabled = $this->get\_meta( $postarr['ID'], '\_lmt\_disableupdate' ); |
  | 319 |  |  |
  |  | 321 |  |
  | 320 | 322 | /\*\* |
  | 321 | 323 | \* Handle post editor save |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L328) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L330) |  |
  | 328 | 330 | $disabled = $postarr['wplmi\_lockmodifiedupdate']; |
  | 329 | 331 | } |
  | 330 |  |  |
  |  | 332 |  |
  | 331 | 333 | if ( 'yes' === $disabled ) { |
  | 332 | 334 | $data['post\_modified']     = $postarr['post\_modified']; |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L350) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L352) |  |
  | 350 | 352 | $this->update\_meta( $postarr['ID'], 'wplmi\_temp\_date', $modified\_date ); |
  | 351 | 353 | } |
  | 352 |  | } |
  |  | 354 | } |
  | 353 | 355 | elseif ( ! empty( $temp\_date ) ) { |
  | 354 | 356 | $data['post\_modified']     = $temp\_date; |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L385) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L387) |  |
  | 385 | 387 | $mn = sanitize\_text\_field( $postarr['mnm'] ); |
  | 386 | 388 | $ss = sanitize\_text\_field( $postarr['ssm'] ); |
  | 387 |  |  |
  |  | 389 |  |
  | 388 | 390 | $mm = ( is\_numeric( $mm ) && $mm <= 12 ) ? $mm : '01'; // months |
  | 389 | 391 | $jj = ( is\_numeric( $jj ) && $jj <= 31 ) ? $jj : '01'; // days |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L392) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/EditScreen.php?rev=3137253#L394) |  |
  | 392 | 394 | $mn = ( is\_numeric( $mn ) && $mn <= 60 ) ? $mn : '00'; // minutes |
  | 393 | 395 | $ss = ( is\_numeric( $ss ) && $ss <= 60 ) ? $ss : '00'; // seconds |
  | 394 |  |  |
  |  | 396 |  |
  | 395 | 397 | $newdate = sprintf( "%04d-%02d-%02d %02d:%02d:%02d", $aa, $mm, $jj, $hh, $mn, $ss ); |
  | 396 | 398 | $published\_timestamp = get\_post\_time( 'U', false, $postarr['ID'] ); |
  | 397 |  |  |
  |  | 399 |  |
  | 398 | 400 | if ( strtotime( $newdate ) >= $published\_timestamp ) { |
  | 399 | 401 | $data['post\_modified'] = $newdate; |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class MetaBox |
  | 22 | 22 | { |
  | 23 |  | use Hooker, HelperFunctions; |
  |  | 23 | use Hooker; |
  |  | 24 | use HelperFunctions; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L31) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L32) |  |
  | 31 | 32 | $this->action( 'admin\_print\_footer\_scripts-post-new.php', 'default\_check', 99 ); |
  | 32 | 33 | } |
  | 33 |  |  |
  |  | 34 |  |
  | 34 | 35 | /\*\* |
  | 35 | 36 | \* Add Meta box. |
  | 36 |  | \* |
  |  | 37 | \* |
  | 37 | 38 | \* @param string $post\_type Post Type |
  | 38 | 39 | \* @param object $post      WP Post |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L51) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L52) |  |
  | 51 | 52 | return; |
  | 52 | 53 | } |
  | 53 |  |  |
  |  | 54 |  |
  | 54 | 55 | $post\_types = $this->get\_data( 'lmt\_custom\_post\_types\_list' ); |
  | 55 | 56 | if ( ! empty( $post\_types ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L60) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L61) |  |
  | 60 | 61 | /\*\* |
  | 61 | 62 | \* Generate column data. |
  | 62 |  | \* |
  |  | 63 | \* |
  | 63 | 64 | \* @param string   $column   Column name |
  | 64 | 65 | \* @param int      $post\_id  Post ID |
  | 65 |  | \* |
  |  | 66 | \* |
  | 66 | 67 | \* @return string  $time |
  | 67 | 68 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L72) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L73) |  |
  | 72 | 73 | // buid nonce |
  | 73 | 74 | $this->nonce( 'disabled' ); ?> |
  | 74 |  |  |
  |  | 75 |  |
  | 75 | 76 | <div id="wplmi-status" class="meta-options"> |
  | 76 | 77 | <label for="wplmi\_status" class="selectit" title="<?php esc\_attr\_e( 'You can disable auto insertation of last modified info on this post', 'wp-last-modified-info' ); ?>"> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L78) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L79) |  |
  | 78 | 79 | </label> |
  | 79 | 80 | </div> |
  | 80 |  | <?php |
  |  | 81 | <?php |
  | 81 | 82 | } |
  | 82 | 83 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L91) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L92) |  |
  | 91 | 92 | return; |
  | 92 | 93 | } |
  | 93 |  |  |
  |  | 94 |  |
  | 94 | 95 | // Check the user's permissions. |
  | 95 | 96 | if ( ! current\_user\_can( 'edit\_post', $post\_id ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L102) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L103) |  |
  | 102 | 103 |  |
  | 103 | 104 | // disableautoinsert string |
  | 104 |  | if ( isset( $\_POST['wplmi\_disable\_auto\_insert'] ) ) { |
  |  | 105 | if ( isset( $\_POST['wplmi\_disable\_auto\_insert'] ) ) { // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 105 | 106 | $this->update\_meta( $post\_id, '\_lmt\_disable', 'yes' ); |
  | 106 | 107 | } else { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L123) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L124) |  |
  | 123 | 124 | \* @param int $post\_id The post ID. |
  | 124 | 125 | \*/ |
  | 125 |  | private function nonce( $name, $referer = true, $~~echo~~ = true ) { |
  | 126 |  | \wp\_nonce\_field( 'wplmi\_nonce\_' . $name, 'wplmi\_metabox\_' . $name . '\_nonce', $referer, $~~echo~~ ); |
  |  | 126 | private function nonce( $name, $referer = true, $show = true ) { |
  |  | 127 | \wp\_nonce\_field( 'wplmi\_nonce\_' . $name, 'wplmi\_metabox\_' . $name . '\_nonce', $referer, $show ); |
  | 127 | 128 | } |
  | 128 | 129 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L133) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MetaBox.php?rev=3137253#L134) |  |
  | 133 | 134 | \*/ |
  | 134 | 135 | private function verify( $name ) { |
  | 135 |  | if ( ! isset( $\_REQUEST[ 'wplmi\_metabox\_' . $name . '\_nonce' ] ) || ! \wp\_verify\_nonce( ~~$\_REQUEST[ 'wplmi\_metabox\_'.  $name . '\_nonce' ], 'wplmi\_nonce\_' . $name ) ) {~~ |
  |  | 136 | if ( ! isset( $\_REQUEST[ 'wplmi\_metabox\_' . $name . '\_nonce' ] ) || ! \wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_REQUEST[ 'wplmi\_metabox\_'.  $name . '\_nonce' ] ) ), 'wplmi\_nonce\_' . $name ) ) { // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  | 136 | 137 | return false; |
  | 137 | 138 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class MiscActions |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L43) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L44) |  |
  | 43 | 44 | $this->action( 'save\_post', 'save\_post' ); |
  | 44 | 45 | } |
  | 45 |  |  |
  |  | 46 |  |
  | 46 | 47 | /\*\* |
  | 47 | 48 | \* Generate column data. |
  | 48 |  | \* |
  | 49 |  | \* @param string   $column   Column name |
  | 50 |  | \* @param int      $post\_id  Post ID |
  | 51 |  | \* |
  |  | 49 | \* |
  |  | 50 | \* @param string   $messages   Messages |
  |  | 51 | \* |
  | 52 | 52 | \* @return string  $time |
  | 53 | 53 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L55) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L55) |  |
  | 55 | 55 | global $post; |
  | 56 | 56 |  |
  | 57 |  | if ( ! $post instanceof \WP\_Post ) { |
  |  | 57 | $wp\_post = $post; |
  |  | 58 |  |
  |  | 59 | if ( ! $wp\_post instanceof \WP\_Post ) { |
  | 58 | 60 | if ( empty( $\_REQUEST['post'] ) ) { |
  | 59 | 61 | return $messages; |
  | 60 | 62 | } |
  | 61 | 63 | $post\_id = absint( $\_REQUEST['post'] ); |
  | 62 |  | $post = get\_post( $post\_id ); |
  | 63 |  | } |
  | 64 |  |  |
  |  | 64 | $wp\_post = get\_post( $post\_id ); |
  |  | 65 | } |
  |  | 66 |  |
  | 65 | 67 | // get WordPress date time format |
  | 66 | 68 | $get\_df = get\_option( 'date\_format' ); |
  | 67 | 69 | $get\_tf = get\_option( 'time\_format' ); |
  | 68 |  |  |
  | 69 |  | $m\_orig = get\_post\_field( 'post\_modified', $post->ID, 'raw' ); |
  | 70 |  | $post\_modified = '&nbsp;<strong>' . date\_i18n( $this->do\_filter( 'post\_updated\_datetime\_format', $get\_df . ' @ ' . $get\_tf, $post->ID ), strtotime( $m\_orig ) ) . '</strong>.&nbsp;'; |
  | 71 |  |  |
  |  | 70 |  |
  |  | 71 | $m\_orig = get\_post\_field( 'post\_modified', $wp\_post->ID, 'raw' ); |
  |  | 72 | $post\_modified = '&nbsp;<strong>' . date\_i18n( $this->do\_filter( 'post\_updated\_datetime\_format', $get\_df . ' @ ' . $get\_tf, $wp\_post->ID ), strtotime( $m\_orig ) ) . '</strong>.&nbsp;'; |
  |  | 73 |  |
  | 72 | 74 | // get post types returns object |
  | 73 |  | $post\_types = get\_post\_type\_object( $post->post\_type ); |
  | 74 |  | if ( is\_post\_type\_viewable( $post->post\_type ) ) { |
  | 75 |  | $post\_modified .= sprintf( ~~\_\_( '<a href="%1$s" target="\_blank">%2$s %3$s</a>' ), esc\_url( get\_permalink( $post->ID ) ),~~ \_\_( 'View', 'wp-last-modified-info' ), $post\_types->name ); |
  | 76 |  | } |
  | 77 |  |  |
  | 78 |  | if ( isset( $messages[ $post->post\_type ] ) ) { |
  | 79 |  | $messages[ $~~post->post\_type ][1] = esc\_html( $post\_types->labels->singular\_name ) . '&nbsp;' . sprintf( \_\_( '%1$s%2$s' ), \_\_( 'updated on~~', 'wp-last-modified-info' ), $post\_modified ); |
  | 80 |  | } |
  | 81 |  |  |
  |  | 75 | $post\_types = get\_post\_type\_object( $wp\_post->post\_type ); |
  |  | 76 | if ( is\_post\_type\_viewable( $wp\_post->post\_type ) ) { |
  |  | 77 | $post\_modified .= sprintf( '<a href="%1$s" target="\_blank">%2$s %3$s</a>', esc\_url( get\_permalink( $wp\_post->ID ) ), esc\_html\_\_( 'View', 'wp-last-modified-info' ), $post\_types->name ); |
  |  | 78 | } |
  |  | 79 |  |
  |  | 80 | if ( isset( $messages[ $wp\_post->post\_type ] ) ) { |
  |  | 81 | $messages[ $wp\_post->post\_type ][1] = esc\_html( $post\_types->labels->singular\_name ) . '&nbsp;' . sprintf( esc\_html\_\_( 'updated on %s', 'wp-last-modified-info' ), $post\_modified ); |
  |  | 82 | } |
  |  | 83 |  |
  | 82 | 84 | return $messages; |
  | 83 | 85 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L85) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L87) |  |
  | 85 | 87 | /\*\* |
  | 86 | 88 | \* Runs after post save. |
  | 87 |  | \* |
  |  | 89 | \* |
  | 88 | 90 | \* @param int      $post\_id  Post ID |
  | 89 | 91 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L97) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L99) |  |
  | 97 | 99 | $modified = date\_i18n( $this->do\_filter( 'custom\_field\_date\_time\_format', $get\_df . ' @ ' . $get\_tf ), $m\_stamp ); |
  | 98 | 100 | $shortcode = '[lmt-post-modified-info]'; |
  | 99 |  |  |
  |  | 101 |  |
  | 100 | 102 | // update post meta |
  | 101 | 103 | $this->update\_meta( $post\_id, 'wp\_last\_modified\_info', $modified ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L103) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L105) |  |
  | 103 | 105 | // update post meta |
  | 104 | 106 | $this->update\_meta( $post\_id, 'wplmi\_shortcode', $shortcode ); |
  | 105 |  |  |
  |  | 107 |  |
  | 106 | 108 | // update global site update time |
  | 107 | 109 | update\_option( 'wplmi\_site\_global\_update\_info', current\_time( 'timestamp', 0 ) ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L110) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L112) |  |
  | 110 | 112 | /\*\* |
  | 111 | 113 | \* Replace published time. |
  | 112 |  | \* |
  | 113 |  | \* @param string   $time  Post published time |
  |  | 114 | \* |
  |  | 115 | \* @param string   $time     Post published time |
  | 114 | 116 | \* @param string   $format   Post date format |
  | 115 | 117 | \* @param int      $post\_id  Post ID |
  | 116 |  | \* |
  |  | 118 | \* |
  | 117 | 119 | \* @return string  $time |
  | 118 | 120 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L127) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L129) |  |
  | 127 | 129 | /\*\* |
  | 128 | 130 | \* Replace published date. |
  | 129 |  | \* |
  |  | 131 | \* |
  | 130 | 132 | \* @param string   $date     Post published date |
  | 131 | 133 | \* @param string   $format   Post date format |
  | 132 | 134 | \* @param int      $post\_id  Post ID |
  | 133 |  | \* |
  |  | 135 | \* |
  | 134 | 136 | \* @return string  $time |
  | 135 | 137 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L160) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L162) |  |
  | 160 | 162 | /\*\* |
  | 161 | 163 | \* Filter query. |
  | 162 |  | \* |
  |  | 164 | \* |
  | 163 | 165 | \* @param object $query WP Query |
  | 164 | 166 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L166) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L168) |  |
  | 166 | 168 | global $pagenow; |
  | 167 | 169 | $order = $this->is\_equal( 'admin\_default\_sort\_order', 'published' ) ? 'asc' : 'desc'; |
  | 168 |  |  |
  |  | 170 |  |
  | 169 | 171 | if ( ! $this->is\_equal( 'admin\_default\_sort\_order', 'default' ) ) { |
  | 170 | 172 | if ( is\_admin() && 'edit.php' === $pagenow && ! isset( $\_GET['orderby'], $\_GET['order'] ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L177) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L179) |  |
  | 177 | 179 | /\*\* |
  | 178 | 180 | \* Filter query. |
  | 179 |  | \* |
  |  | 181 | \* |
  | 180 | 182 | \* @param object $query WP Query |
  | 181 | 183 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L204) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/MiscActions.php?rev=3137253#L206) |  |
  | 204 | 206 |  |
  | 205 | 207 | if ( ! empty( $css ) ) { |
  | 206 |  | echo '<style id="wplmi-inline-css" type="text/css">'."\n". wp\_~~unslash( wp\_kses\_post~~( $css ) ) ."\n".'</style>'."\n"; |
  |  | 208 | echo '<style id="wplmi-inline-css" type="text/css">'."\n". wp\_kses\_post( wp\_unslash( $css ) ) ."\n".'</style>'."\n"; |
  | 207 | 209 | } |
  | 208 | 210 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PluginsData.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PluginsData.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PluginsData.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3052359#L22 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PluginsData.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class PluginsData extends WP\_Background\_Process |
  | 23 | 23 | { |
  | 24 |  | use HelperFunctions, Hooker; |
  |  | 24 | use HelperFunctions; |
  |  | 25 | use Hooker; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3052359#L87) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PluginsData.php?rev=3137253#L88) |  |
  | 87 | 88 | $this->call\_api( $item ); |
  | 88 | 89 | sleep( 2 ); // stop for 2 seconds to optimize memory usage |
  | 89 |  |  |
  |  | 90 |  |
  | 90 | 91 | return false; |
  | 91 | 92 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3052359#L250) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PluginsData.php?rev=3137253#L251) |  |
  | 250 | 251 | 'stream'      => false, |
  | 251 | 252 | 'filename'    => null, |
  | 252 |  | ]; |
  | 253 |  |  |
  |  | 253 | ]; |
  |  | 254 |  |
  | 254 | 255 | $response = wp\_remote\_get( 'https://plugins.svn.wordpress.org/' . $file . '/', $args ); |
  | 255 |  |  |
  |  | 256 |  |
  | 256 | 257 | if ( is\_wp\_error( $response ) ) { |
  | 257 | 258 | $status = false; |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PostStatusFilters.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PostStatusFilters.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PostStatusFilters.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PostStatusFilters.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class PostStatusFilters |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=2930921#L76) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PostStatusFilters.php?rev=3137253#L77) |  |
  | 76 | 77 | 'update\_locked' => 1, |
  | 77 | 78 | ], |
  | 78 |  | admin\_url( 'edit.php' ) |
  |  | 79 | admin\_url( 'edit.php' ) |
  | 79 | 80 | ), |
  | 80 | 81 | $current, |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=2930921#L83) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PostStatusFilters.php?rev=3137253#L84) |  |
  | 83 | 84 | ); |
  | 84 | 85 | } |
  | 85 |  |  |
  |  | 86 |  |
  | 86 | 87 | return $views; |
  | 87 | 88 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=2930921#L101) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/PostStatusFilters.php?rev=3137253#L102) |  |
  | 101 | 102 | ], |
  | 102 | 103 | ]; |
  | 103 |  |  |
  |  | 104 |  |
  | 104 | 105 | $query->set( 'meta\_query', $meta\_query ); |
  | 105 | 106 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class UserColumn |
  | 22 | 22 | { |
  | 23 |  | use Hooker, SettingsData; |
  |  | 23 | use Hooker; |
  |  | 24 | use SettingsData; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L34) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L35) |  |
  | 34 | 35 | $this->action( 'admin\_head-users.php', 'style' ); |
  | 35 | 36 | } |
  | 36 |  |  |
  |  | 37 |  |
  | 37 | 38 | /\*\* |
  | 38 | 39 | \* Generate column data. |
  | 39 |  | \* |
  |  | 40 | \* |
  | 40 | 41 | \* @param string   $column   Column name |
  | 41 | 42 | \* @param int      $post\_id  Post ID |
  | 42 |  | \* |
  |  | 43 | \* |
  | 43 | 44 | \* @return string  $time |
  | 44 | 45 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L47) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L48) |  |
  | 47 | 48 | update\_user\_meta( $user\_id, 'profile\_last\_modified', current\_time( 'timestamp', 0 ) ); |
  | 48 | 49 | } |
  | 49 |  |  |
  |  | 50 |  |
  | 50 | 51 | /\*\* |
  | 51 | 52 | \* Make Column sortable. |
  | 52 |  | \* |
  |  | 53 | \* |
  | 53 | 54 | \* @param string   $column  Column name |
  | 54 | 55 | \* @return string  $column  Filtered column |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L65) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L66) |  |
  | 65 | 66 | return \_\_( 'Never', 'wp-last-modified-info' ); |
  | 66 | 67 | } |
  | 67 |  |  |
  |  | 68 |  |
  | 68 | 69 | return date\_i18n( $this->do\_filter( 'user\_column\_datetime\_format', $get\_df . '\<\b\r\>' . $get\_tf ), $timestamp ); |
  | 69 | 70 | break; |
  | 70 | 71 | } |
  | 71 |  |  |
  |  | 72 |  |
  | 72 | 73 | return $value; |
  | 73 | 74 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L75) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L76) |  |
  | 75 | 76 | /\*\* |
  | 76 | 77 | \* Register Column. |
  | 77 |  | \* |
  |  | 78 | \* |
  | 78 | 79 | \* @param string   $columns  Column name |
  | 79 | 80 | \* @return string  $columns  Filtered column |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L81) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L82) |  |
  | 81 | 82 | public function load\_columns( $columns ) { |
  | 82 | 83 | $columns['last-updated'] = \_\_( 'Last Updated', 'wp-last-modified-info' ); |
  | 83 |  |  |
  |  | 84 |  |
  | 84 | 85 | return $columns; |
  | 85 | 86 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L87) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L88) |  |
  | 87 | 88 | /\*\* |
  | 88 | 89 | \* Column title. |
  | 89 |  | \* |
  |  | 90 | \* |
  | 90 | 91 | \* @param string   $column  Column name |
  | 91 | 92 | \* @return string  $column  Filtered column |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L99) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L100) |  |
  | 99 | 100 | /\*\* |
  | 100 | 101 | \* Sort Column. |
  | 101 |  | \* |
  |  | 102 | \* |
  | 102 | 103 | \* @since 1.8.4 |
  | 103 | 104 | \* @param object   $user\_search  User Query |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L105) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L106) |  |
  | 105 | 106 | public function user\_column\_orderby( $user\_search ) { |
  | 106 | 107 | global $wpdb, $current\_screen; |
  | 107 |  |  |
  | 108 |  | if ( isset( $current\_screen->id ) && 'users' != $current\_screen->id ) { |
  |  | 108 |  |
  |  | 109 | if ( isset( $current\_screen->id ) && 'users' !== $current\_screen->id ) { |
  | 109 | 110 | return; |
  | 110 | 111 | } |
  | 111 |  |  |
  |  | 112 |  |
  | 112 | 113 | $vars = $user\_search->query\_vars; |
  | 113 | 114 | if ( 'lastupdated' === $vars['orderby'] ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L119) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/UserColumn.php?rev=3137253#L120) |  |
  | 119 | 120 | /\*\* |
  | 120 | 121 | \* Column title. |
  | 121 |  | \* |
  |  | 122 | \* |
  | 122 | 123 | \* @param string   $column  Column name |
  | 123 | 124 | \* @return string  $column  Filtered column |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Backend/WooCommerce.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/WooCommerce.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Backend/WooCommerce.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/WooCommerce.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class WooCommerce |
  | 22 | 22 | { |
  | 23 |  | use Hooker, SettingsData; |
  |  | 23 | use Hooker; |
  |  | 24 | use SettingsData; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=2930921#L32) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/WooCommerce.php?rev=3137253#L33) |  |
  | 32 | 33 | $this->action( 'woocommerce\_order\_status\_changed', 'update\_products', 99 ); |
  | 33 | 34 | } |
  | 34 |  |  |
  |  | 35 |  |
  | 35 | 36 | /\*\* |
  | 36 | 37 | \* Update Post Modified date from previously save meta to fix WooCommerce Product Update process. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=2930921#L55) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Backend/WooCommerce.php?rev=3137253#L56) |  |
  | 55 | 56 | 'post\_modified\_gmt' => get\_gmt\_from\_date( $modified ), |
  | 56 | 57 | ]; |
  | 57 |  |  |
  |  | 58 |  |
  | 58 | 59 | $wpdb->update( $wpdb->posts, $args, [ |
  | 59 | 60 | 'ID' => $product\_id, |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L22 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class Blocks extends BaseController |
  | 23 | 23 | { |
  | 24 |  | use HelperFunctions, Hooker; |
  |  | 24 | use HelperFunctions; |
  |  | 25 | use Hooker; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L60) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php?rev=3137253#L61) |  |
  | 60 | 61 | foreach ( $blocks as $name => $params ) { |
  | 61 | 62 | if ( $params['visible'] ) { |
  | 62 |  | register\_block\_type( $this->plugin\_path . '~~/~~blocks/build/' . $name, [ |
  |  | 63 | register\_block\_type( $this->plugin\_path . 'blocks/build/' . $name, [ |
  | 63 | 64 | 'render\_callback' => [ $this, $params['callback'] ], |
  | 64 | 65 | ] ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L73) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php?rev=3137253#L74) |  |
  | 73 | 74 | \* @param string   $content    Block default content. |
  | 74 | 75 | \* @param WP\_Block $block      Block instance. |
  | 75 |  | \* |
  |  | 76 | \* |
  | 76 | 77 | \* @return string  Returns the post modified date. |
  | 77 | 78 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L80) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php?rev=3137253#L81) |  |
  | 80 | 81 | return; |
  | 81 | 82 | } |
  | 82 |  |  |
  |  | 83 |  |
  | 83 | 84 | $post\_id = $block->context['postId']; |
  | 84 | 85 | $attributes = $this->normalize\_attributes( $attributes ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L102) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php?rev=3137253#L103) |  |
  | 102 | 103 | $styles = $this->convert\_styles( $attributes['styles'] ); |
  | 103 | 104 |  |
  | 104 |  | return sprintf( |
  |  | 105 | return sprintf( |
  | 105 | 106 | '<%1$s class="%2$s" style="%3$s">%4$s</%1$s>', |
  | 106 | 107 | ( $attributes['display'] == 'block' ) ? 'div' : 'span', |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L117) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php?rev=3137253#L118) |  |
  | 117 | 118 | \* @param string   $content    Block default content. |
  | 118 | 119 | \* @param WP\_Block $block      Block instance. |
  | 119 |  | \* |
  |  | 120 | \* |
  | 120 | 121 | \* @return string  Returns the post modified date. |
  | 121 | 122 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L130) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php?rev=3137253#L131) |  |
  | 130 | 131 | \* |
  | 131 | 132 | \* @param array    $attributes Block attributes. |
  | 132 |  | \* |
  |  | 133 | \* |
  | 133 | 134 | \* @return string  Returns the site modified date. |
  | 134 | 135 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L158) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Blocks.php?rev=3137253#L159) |  |
  | 158 | 159 | $styles = $this->convert\_styles( $attributes['styles'] ); |
  | 159 | 160 |  |
  | 160 |  | return sprintf( |
  |  | 161 | return sprintf( |
  | 161 | 162 | '<%1$s class="%2$s" style="%3$s">%4$s</%1$s>', |
  | 162 | 163 | ( $attributes['display'] == 'block' ) ? 'div' : 'span', |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorName.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorName.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorName.php")

  | [r3033702](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorName.php?rev=3033702#L12 "Show revision 3033702 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorName.php?rev=3137253#L12 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 |  |
  | 13 | 13 | use Wplmi\Helpers\Hooker; |
  | 14 |  | use ~~\~~Elementor\Controls\_Manager; |
  | 15 |  | use ~~\~~Elementor\Core\DynamicTags\Tag; |
  | 16 |  | use ~~\~~Elementor\Modules\DynamicTags\Module; |
  |  | 14 | use Elementor\Controls\_Manager; |
  |  | 15 | use Elementor\Core\DynamicTags\Tag; |
  |  | 16 | use Elementor\Modules\DynamicTags\Module; |
  | 17 | 17 |  |
  | 18 | 18 | defined( 'ABSPATH' ) || exit; |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorUrl.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorUrl.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorUrl.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorUrl.php?rev=2930921#L11 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/AuthorUrl.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | namespace Wplmi\Core\Elementor\Modules; |
  | 12 | 12 |  |
  | 13 |  | use ~~\~~Elementor\Controls\_Manager; |
  | 14 |  | use ~~\~~Elementor\Core\DynamicTags\Data\_Tag; |
  | 15 |  | use ~~\~~Elementor\Modules\DynamicTags\Module; |
  |  | 13 | use Elementor\Controls\_Manager; |
  |  | 14 | use Elementor\Core\DynamicTags\Data\_Tag; |
  |  | 15 | use Elementor\Modules\DynamicTags\Module; |
  | 16 | 16 |  |
  | 17 | 17 | defined( 'ABSPATH' ) || exit; |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedDate.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedDate.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedDate.php")

  | [r3033702](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedDate.php?rev=3033702#L11 "Show revision 3033702 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedDate.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | namespace Wplmi\Core\Elementor\Modules; |
  | 12 | 12 |  |
  | 13 |  | use ~~\~~Elementor\Controls\_Manager; |
  | 14 |  | use ~~\~~Elementor\Core\DynamicTags\Tag; |
  | 15 |  | use ~~\~~Elementor\Modules\DynamicTags\Module; |
  |  | 13 | use Elementor\Controls\_Manager; |
  |  | 14 | use Elementor\Core\DynamicTags\Tag; |
  |  | 15 | use Elementor\Modules\DynamicTags\Module; |
  | 16 | 16 |  |
  | 17 | 17 | defined( 'ABSPATH' ) || exit; |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedTime.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedTime.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedTime.php")

  | [r3033702](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedTime.php?rev=3033702#L11 "Show revision 3033702 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Elementor/Modules/ModifiedTime.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | namespace Wplmi\Core\Elementor\Modules; |
  | 12 | 12 |  |
  | 13 |  | use ~~\~~Elementor\Controls\_Manager; |
  | 14 |  | use ~~\~~Elementor\Core\DynamicTags\Tag; |
  | 15 |  | use ~~\~~Elementor\Modules\DynamicTags\Module; |
  |  | 13 | use Elementor\Controls\_Manager; |
  |  | 14 | use Elementor\Core\DynamicTags\Tag; |
  |  | 15 | use Elementor\Modules\DynamicTags\Module; |
  | 16 | 16 |  |
  | 17 | 17 | defined( 'ABSPATH' ) || exit; |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class PostView |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L33) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253#L34) |  |
  | 33 | 34 | /\*\* |
  | 34 | 35 | \* Show original publish info. |
  | 35 |  | \* |
  |  | 36 | \* |
  | 36 | 37 | \* @param string  $content  Original Content |
  | 37 |  | \* |
  |  | 38 | \* |
  | 38 | 39 | \* @return string $content  Filtered Content |
  | 39 | 40 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L143) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253#L144) |  |
  | 143 | 144 |  |
  | 144 | 145 | $template = $this->generate( $template, $post->ID, $timestamp, $author\_id ); |
  | 145 |  | $allowed\_htmls = array\_merge( wp\_kses\_allowed\_html( 'post' ), [ |
  | 146 |  | 'time' => [ |
  | 147 |  | 'class'    => [], |
  | 148 |  | 'itemprop' => [], |
  | 149 |  | 'datetime' => [], |
  | 150 |  | ], |
  | 151 |  | ] ); |
  | 152 |  |  |
  | 153 |  | echo '<div class="wplmi-frontend-template" style="display: none;">' . wp\_kses( $template, $allowed\_htmls ) . '</div>'; ?> |
  |  | 146 |  |
  |  | 147 | echo '<div class="wplmi-frontend-template" style="display: none;">' . $template . '</div>'; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?> |
  | 154 | 148 |  |
  | 155 | 149 | <script type="text/javascript"> |
  | 156 |  | const wplmiNodeList = document.querySelectorAll( '<?~~php echo~~ wp\_kses\_post( preg\_replace( "/\r|\n/", '', $selectors ) ); ?>' ); |
  |  | 150 | const wplmiNodeList = document.querySelectorAll( '<?= wp\_kses\_post( preg\_replace( "/\r|\n/", '', $selectors ) ); ?>' ); |
  | 157 | 151 | for ( let i = 0; i < wplmiNodeList.length; i++ ) { |
  | 158 | 152 | wplmiNodeList[i].outerHTML = document.querySelector( '.wplmi-frontend-template' ).innerHTML; |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L166) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253#L160) |  |
  | 166 | 160 | \* |
  | 167 | 161 | \* @param int  $post\_id  WP Post ID. |
  | 168 |  | \* |
  |  | 162 | \* |
  | 169 | 163 | \* @return string |
  | 170 | 164 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L200) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253#L194) |  |
  | 200 | 194 | \* @param int     $post\_id Post ID. |
  | 201 | 195 | \* @param string  $type    Sting type. Default subject. |
  | 202 |  | \* |
  |  | 196 | \* |
  | 203 | 197 | \* @return string |
  | 204 | 198 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L218) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253#L212) |  |
  | 218 | 212 | // Published date format |
  | 219 | 213 | $date\_format = $this->do\_filter( 'post\_published\_date\_format', get\_option( 'date\_format' ), $post\_id ); |
  | 220 |  |  |
  |  | 214 |  |
  | 221 | 215 | // Start replace |
  | 222 |  | $html = str\_replace( [ '%original\_author\_name%', '%post\_original\_author%' ], get\_the\_author(), $html ); |
  | 223 |  | $html = str\_replace( [ '%author\_name%', '%post\_author%' ], $author\_name, $html ); |
  |  | 216 | $html = str\_replace( [ '%original\_author\_name%', '%post\_original\_author%' ], get\_the\_author(), $html ); |
  |  | 217 | $html = str\_replace( [ '%author\_name%', '%post\_author%' ], $author\_name, $html ); |
  | 224 | 218 | $html = str\_replace( [ '%author\_url%', '%author\_website%' ], $author\_url, $html ); |
  | 225 | 219 | $html = str\_replace( '%author\_email%', $author\_email, $html ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L232) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253#L226) |  |
  | 232 | 226 |  |
  | 233 | 227 | $html = $this->do\_filter( 'post\_tags', $html, $post\_id ); |
  | 234 |  | return preg\_replace( "/\r|\n/", '', $html ); |
  |  | 228 | $html = preg\_replace( "/\r|\n/", '', $html ); |
  |  | 229 |  |
  |  | 230 | $allowed\_htmls = array\_merge( wp\_kses\_allowed\_html( 'post' ), [ |
  |  | 231 | 'time' => [ |
  |  | 232 | 'class'    => [], |
  |  | 233 | 'itemprop' => [], |
  |  | 234 | 'datetime' => [], |
  |  | 235 | ], |
  |  | 236 | ] ); |
  |  | 237 |  |
  |  | 238 | return wp\_kses( $html, $allowed\_htmls ); |
  | 235 | 239 | } |
  | 236 | 240 |  |
  | 237 | 241 | /\*\* |
  | 238 | 242 | \* Check archive pages |
  | 239 |  | \* |
  |  | 243 | \* |
  | 240 | 244 | \* @param string  $content      Post Content. |
  | 241 | 245 | \* @param int     $post\_id      WP Post ID. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L244) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253#L248) |  |
  | 244 | 248 | \* @param string  $output\_type  Output Type | Default post. |
  | 245 | 249 | \* @param string  $element      HTML element | Default p. |
  | 246 |  | \* |
  |  | 250 | \* |
  | 247 | 251 | \* @return string |
  | 248 | 252 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L263) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/PostView.php?rev=3137253#L267) |  |
  | 263 | 267 | /\*\* |
  | 264 | 268 | \* Check archive pages |
  | 265 |  | \* |
  |  | 269 | \* |
  | 266 | 270 | \* @return bool |
  | 267 | 271 | \*/ |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L22 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class Schema extends BaseController |
  | 23 | 23 | { |
  | 24 |  | use HelperFunctions, Hooker; |
  |  | 24 | use HelperFunctions; |
  |  | 25 | use Hooker; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L36) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L37) |  |
  | 36 | 37 | \* Echo Json-ld Schema codes. |
  | 37 | 38 | \*/ |
  | 38 |  | public function schema\_markup() { |
  |  | 39 | public function schema\_markup() { |
  | 39 | 40 | global $post; |
  | 40 | 41 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L42) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L43) |  |
  | 42 | 43 | return; |
  | 43 | 44 | } |
  | 44 |  |  |
  |  | 45 |  |
  | 45 | 46 | // get post infos |
  | 46 | 47 | $full\_content = $post->post\_content; |
  | 47 | 48 | $excerpt = $post->post\_excerpt; |
  | 48 |  |  |
  |  | 49 |  |
  | 49 | 50 | // get post modfied author ID |
  | 50 |  | $author\_id = $this->get\_meta( $post->ID, '\_edit\_last' ); |
  |  | 51 | $author\_id = $this->get\_meta( $post->ID, '\_edit\_last' ); |
  | 51 | 52 |  |
  | 52 | 53 | // Strip shortcodes and tags |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L54) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L55) |  |
  | 54 | 55 | $full\_content = wp\_strip\_all\_tags( $full\_content ); |
  | 55 | 56 | $full\_content = $this->do\_filter( 'schema\_content', $full\_content, $post->ID ); |
  | 56 |  |  |
  |  | 57 |  |
  | 57 | 58 | $desc\_word\_count = $this->do\_filter( 'schema\_description\_word\_count', 60 ); |
  | 58 | 59 | $short\_content = wp\_trim\_words( $full\_content, $desc\_word\_count, '' ); |
  | 59 | 60 | $short\_content = ( ! empty( $excerpt ) ) ? $excerpt : $short\_content; |
  | 60 |  |  |
  |  | 61 |  |
  | 61 | 62 | $json = [ |
  | 62 | 63 | '@context'         => 'https://schema.org/', |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L76) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L77) |  |
  | 76 | 77 | ], |
  | 77 | 78 | ]; |
  | 78 |  |  |
  |  | 79 |  |
  | 79 | 80 | if ( is\_page() ) { |
  | 80 | 81 | // change schema type for pages |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L82) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L83) |  |
  | 82 | 83 | unset( $json['mainEntityOfPage'] ); |
  | 83 | 84 | } |
  | 84 |  |  |
  |  | 85 |  |
  | 85 | 86 | $json = $this->do\_filter( 'schema\_items', $json, $post->ID ); |
  | 86 |  |  |
  |  | 87 |  |
  | 87 | 88 | $output = ''; |
  | 88 | 89 | if ( ! empty( $json ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L97) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L98) |  |
  | 97 | 98 | if ( $this->is\_equal( 'enable\_jsonld\_markup\_cb', 'enable' ) && ! empty( $post\_types ) ) { |
  | 98 | 99 | if ( in\_array( get\_post\_type( $post->ID ), $post\_types ) ) { |
  | 99 |  | echo $output; |
  |  | 100 | echo $output; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 100 | 101 | } |
  | 101 | 102 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L104) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L105) |  |
  | 104 | 105 | /\*\* |
  | 105 | 106 | \* Hooks the language attributes to add Extended schema compatibility. |
  | 106 |  | \* |
  |  | 107 | \* |
  | 107 | 108 | \* @param string  $input   Original Content |
  | 108 | 109 | \* @return string $output  Filtered Content |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L141) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L142) |  |
  | 141 | 142 | /\*\* |
  | 142 | 143 | \* Replace the strings. |
  | 143 |  | \* |
  |  | 144 | \* |
  | 144 | 145 | \* @param string  $html  Original Content |
  | 145 |  | \* |
  |  | 146 | \* |
  | 146 | 147 | \* @return string $html  Filtered Content |
  | 147 | 148 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L156) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L157) |  |
  | 156 | 157 | if ( ! $this->is\_equal( 'enable\_jsonld\_markup\_cb', 'disable' ) && $can\_replace ) { |
  | 157 | 158 | $replace = ' itemprop="dateModified"'; |
  | 158 |  |  |
  |  | 159 |  |
  | 159 | 160 | if ( $this->is\_equal( 'replace\_published\_date', 'remove' ) ) { |
  | 160 | 161 | $replace = ''; |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L163) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/Schema.php?rev=3137253#L164) |  |
  | 163 | 164 | $html = str\_replace( ' itemprop="datePublished"', $replace, $html ); |
  | 164 | 165 | } |
  | 165 |  |  |
  |  | 166 |  |
  | 166 | 167 | if ( $this->is\_equal( 'enable\_jsonld\_markup\_cb', 'comp\_mode' ) ) { |
  | 167 | 168 | // All in One SEO Pack Meta Compatibility |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/TemplateTags.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/TemplateTags.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/TemplateTags.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=2930921#L23 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/TemplateTags.php?rev=3137253#L23 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | \* array $params |
  | 24 | 24 | \*/ |
  | 25 |  | private ~~array~~ $params; |
  |  | 25 | private $params; |
  | 26 | 26 |  |
  | 27 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=2930921#L35) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/TemplateTags.php?rev=3137253#L35) |  |
  | 35 | 35 | $this->params = $args; |
  | 36 | 36 | } |
  | 37 |  |  |
  |  | 37 |  |
  | 38 | 38 | /\*\* |
  | 39 | 39 | \* Template tag output. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=2930921#L74) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Frontend/TemplateTags.php?rev=3137253#L74) |  |
  | 74 | 74 | // Prepare template |
  | 75 | 75 | $template = $this->generate( $template, $post->ID, $timestamp, $author\_id ); |
  | 76 |  |  |
  |  | 76 |  |
  | 77 | 77 | if ( $this->params['escape'] ) { |
  | 78 | 78 | $template = wp\_strip\_all\_tags( $template ); |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class Notification |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L32) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php?rev=3137253#L33) |  |
  | 32 | 33 | /\*\* |
  | 33 | 34 | \* Show original publish info. |
  | 34 |  | \* |
  |  | 35 | \* |
  | 35 | 36 | \* @param string  $content  Original Content |
  | 36 |  | \* |
  |  | 37 | \* |
  | 37 | 38 | \* @return string $content  Filtered Content |
  | 38 | 39 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L45) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php?rev=3137253#L46) |  |
  | 45 | 46 | return; |
  | 46 | 47 | } |
  | 47 |  |  |
  |  | 48 |  |
  | 48 | 49 | // Transitioning from an Auto Draft to Published shouldn't result in a notification. |
  | 49 | 50 | if ( $post\_before->post\_status === 'auto-draft' && $post\_after->post\_status === 'publish' ) { |
  | 50 | 51 | return; |
  | 51 | 52 | } |
  | 52 |  |  |
  |  | 53 |  |
  | 53 | 54 | // If we're purely saving a draft, and don't have the draft option enabled, skip. If we're transitioning one way or the other, send a notification. |
  | 54 | 55 | if ( ! $this->is\_enabled( 'lmt\_enable\_draft\_noti\_cb' ) && in\_array( $post\_before->post\_status, [ 'draft', 'auto-draft' ] ) && 'draft' === $post\_after->post\_status ) { |
  | 55 | 56 | return; |
  | 56 | 57 | } |
  | 57 |  |  |
  |  | 58 |  |
  | 58 | 59 | $post\_types = $this->get\_data( 'lmt\_enable\_noti\_post\_types', [ 'post' ] ); |
  | 59 | 60 | if ( ! in\_array( $post\_before->post\_type, $post\_types ) ) { |
  | 60 | 61 | return; |
  | 61 | 62 | } |
  | 62 |  |  |
  |  | 63 |  |
  | 63 | 64 | // If this is a new post, skip. |
  | 64 | 65 | $child\_posts = wp\_get\_post\_revisions( $post\_id, [ 'numberposts' => 1 ] ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L66) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php?rev=3137253#L67) |  |
  | 66 | 67 | return; |
  | 67 | 68 | } |
  | 68 |  |  |
  |  | 69 |  |
  | 69 | 70 | if ( ! $post\_before || ! $post\_after ) { |
  | 70 | 71 | return; |
  | 71 | 72 | } |
  | 72 |  |  |
  |  | 73 |  |
  | 73 | 74 | $text = ''; |
  | 74 | 75 | if ( $post\_before->post\_title !== $post\_after->post\_title ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L76) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php?rev=3137253#L77) |  |
  | 76 | 77 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Title:', 'wp-last-modified-info' ), $post\_after->post\_title ) . "\n"; |
  | 77 | 78 | } |
  | 78 |  |  |
  |  | 79 |  |
  | 79 | 80 | if ( $post\_before->post\_content !== $post\_after->post\_content ) { |
  | 80 | 81 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Post Content:', 'wp-last-modified-info' ), $post\_before->post\_content ) . "\n"; |
  | 81 | 82 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Post Content:', 'wp-last-modified-info' ), $post\_after->post\_content ) . "\n"; |
  | 82 | 83 | } |
  | 83 |  |  |
  |  | 84 |  |
  | 84 | 85 | if ( $post\_before->post\_excerpt !== $post\_after->post\_excerpt ) { |
  | 85 | 86 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Excerpt:', 'wp-last-modified-info' ), $post\_before->post\_excerpt ) . "\n"; |
  | 86 | 87 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Excerpt:', 'wp-last-modified-info' ), $post\_after->post\_excerpt ) . "\n"; |
  | 87 | 88 | } |
  | 88 |  |  |
  |  | 89 |  |
  | 89 | 90 | if ( $post\_before->post\_author !== $post\_after->post\_author ) { |
  | 90 | 91 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Author:', 'wp-last-modified-info' ), $post\_before->post\_author ) . "\n"; |
  | 91 | 92 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Author:', 'wp-last-modified-info' ), $post\_after->post\_author ) . "\n"; |
  | 92 | 93 | } |
  | 93 |  |  |
  |  | 94 |  |
  | 94 | 95 | if ( $post\_before->post\_name !== $post\_after->post\_name ) { |
  | 95 | 96 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Link:', 'wp-last-modified-info' ), esc\_url( str\_replace( $post\_after->post\_name, $post\_before->post\_name, get\_permalink( $post\_before->ID ) ) ) ) . "\n"; |
  | 96 | 97 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Link:', 'wp-last-modified-info' ), esc\_url( get\_permalink( $post\_after->ID ) ) ) . "\n"; |
  | 97 | 98 | } |
  | 98 |  |  |
  |  | 99 |  |
  | 99 | 100 | if ( $post\_before->comment\_status !== $post\_after->comment\_status ) { |
  | 100 | 101 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Comment Status:', 'wp-last-modified-info' ), $post\_before->comment\_status ) . "\n"; |
  | 101 | 102 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Comment Status:', 'wp-last-modified-info' ), $post\_after->comment\_status ) . "\n"; |
  | 102 | 103 | } |
  | 103 |  |  |
  |  | 104 |  |
  | 104 | 105 | if ( $post\_before->ping\_status !== $post\_after->ping\_status ) { |
  | 105 | 106 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Ping Status:', 'wp-last-modified-info' ), $post\_before->ping\_status ) . "\n"; |
  | 106 | 107 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Ping Status:', 'wp-last-modified-info' ), $post\_after->ping\_status ) . "\n"; |
  | 107 | 108 | } |
  | 108 |  |  |
  |  | 109 |  |
  | 109 | 110 | $text = $this->do\_filter( 'notification\_content', $text, $post\_id, $post\_before, $post\_after ); |
  | 110 | 111 | $post\_author = get\_user\_by( 'id', $post\_before->post\_author ); |
  | 111 |  |  |
  |  | 112 |  |
  | 112 | 113 | $recipients = []; |
  | 113 | 114 | $recipients = explode( ',', $this->get\_data( 'lmt\_email\_recipient', [] ) ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L122) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php?rev=3137253#L123) |  |
  | 122 | 123 | $headers = [ 'Content-Type: text/html; charset=UTF-8' ]; |
  | 123 | 124 | $headers = $this->do\_filter( 'email\_headers', $headers ); |
  | 124 |  |  |
  |  | 125 |  |
  | 125 | 126 | if ( ! empty( $text ) && ! empty( $recipients ) ) { |
  | 126 | 127 | wp\_mail( $recipients, $subject, $body, $headers ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L134) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php?rev=3137253#L135) |  |
  | 134 | 135 | \* @param object  $post  WP Post object. |
  | 135 | 136 | \* @param string  $type  Sting type. Default subject. |
  | 136 |  | \* |
  |  | 137 | \* |
  | 137 | 138 | \* @return string |
  | 138 | 139 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L140) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/Notification.php?rev=3137253#L141) |  |
  | 140 | 141 | $text = stripslashes( $text ); |
  | 141 | 142 | $text = str\_replace( '%author\_name%', get\_the\_author\_meta( 'display\_name', $post\_before->post\_author ), $text ); |
  | 142 |  | $text = str\_replace( '%modified\_author\_name%', get\_the\_author\_meta( 'display\_name', $this->get\_meta( $post\_id, '\_edit\_last' ) ), $text ); |
  | 143 |  | $text = str\_replace( '%post\_title%', $post\_before->post\_title, $text ); |
  | 144 |  | $text = str\_replace( '%post\_type%', get\_post\_type( $post\_id ), $text ); |
  |  | 143 | $text = str\_replace( '%modified\_author\_name%', get\_the\_author\_meta( 'display\_name', $this->get\_meta( $post\_id, '\_edit\_last' ) ), $text ); |
  |  | 144 | $text = str\_replace( '%post\_title%', $post\_before->post\_title, $text ); |
  |  | 145 | $text = str\_replace( '%post\_type%', get\_post\_type( $post\_id ), $text ); |
  | 145 | 146 | $text = str\_replace( '%current\_time%', date\_i18n( $this->do\_filter( 'notification\_datetime\_format', 'j F, Y @ g:i a', $post\_id ), current\_time( 'timestamp', 0 ) ), $text ); |
  | 146 |  | $text = str\_replace( '%site\_name%', wp\_specialchars\_decode( get\_bloginfo( 'name' ), ENT\_QUOTES ), $text ); |
  |  | 147 | $text = str\_replace( '%site\_name%', wp\_specialchars\_decode( get\_bloginfo( 'name' ), ENT\_QUOTES ), $text ); |
  | 147 | 148 | $text = str\_replace( '%site\_url%', esc\_url( get\_bloginfo( 'url' ) ), $text ); |
  | 148 |  |  |
  |  | 149 |  |
  | 149 | 150 | if ( $type == 'subject' ) { |
  | 150 | 151 | return stripslashes( wp\_strip\_all\_tags( $text ) ); |
  | 151 | 152 | } |
  | 152 | 153 |  |
  | 153 |  | $text = str\_replace( '%post\_link%', esc\_url( get\_the\_permalink( $post\_id ) ), $text ); |
  |  | 154 | $text = str\_replace( '%post\_link%', esc\_url( get\_the\_permalink( $post\_id ) ), $text ); |
  | 154 | 155 | $text = str\_replace( '%post\_edit\_link%', esc\_url( get\_edit\_post\_link( $post\_id ) ), $text ); |
  | 155 | 156 | $text = str\_replace( '%admin\_email%', filter\_var( get\_bloginfo( 'admin\_email' ), FILTER\_SANITIZE\_EMAIL ), $text ); |
* ## [wp-last-modified-info/tags/1.9.1/inc/Core/RestApi.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Core/RestApi.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Core/RestApi.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/RestApi.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class RestApi |
  | 22 | 22 | { |
  | 23 |  | use Hooker, SettingsData; |
  |  | 23 | use Hooker; |
  |  | 24 | use SettingsData; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=2930921#L31) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/RestApi.php?rev=3137253#L32) |  |
  | 31 | 32 |  |
  | 32 | 33 | /\*\* |
  | 33 |  | \* Show original publish info. |
  | 34 |  | \* |
  | 35 |  | \* @param string  $content  Original Content |
  | 36 |  | \* |
  | 37 |  | \* @return string $content  Filtered Content |
  |  | 34 | \* Register Rest field. |
  | 38 | 35 | \*/ |
  | 39 | 36 | public function rest\_init() { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=2930921#L49) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Core/RestApi.php?rev=3137253#L46) |  |
  | 49 | 46 | /\*\* |
  | 50 | 47 | \* Rest Api outpur callback |
  | 51 |  | \* |
  | 52 |  | \* @param object  $~~object~~ WP Post Object |
  |  | 48 | \* |
  |  | 49 | \* @param object  $rest\_object WP Post Object |
  | 53 | 50 | \* @param string  $field\_name  Field Name |
  | 54 | 51 | \* @param string  $request     Request |
  | 55 |  | \* |
  |  | 52 | \* |
  | 56 | 53 | \* @return string|null |
  | 57 | 54 | \*/ |
  | 58 |  | public function rest\_output( $object, $field\_name, $request ) { |
  | 59 |  | $author\_id = $this->get\_meta( $object['id'], '\_edit\_last' ); |
  | 60 |  |  |
  |  | 55 | public function rest\_output( $rest\_object, $field\_name, $request ) { |
  |  | 56 | $author\_id = $this->get\_meta( $rest\_object['id'], '\_edit\_last' ); |
  |  | 57 |  |
  | 61 | 58 | if ( $author\_id ) { |
  | 62 | 59 | $last\_user = get\_userdata( $author\_id ); |
  | 63 |  |  |
  |  | 60 |  |
  | 64 | 61 | if ( $last\_user && is\_object( $last\_user ) ) { |
  | 65 | 62 | return $last\_user->display\_name; |
* ## [wp-last-modified-info/tags/1.9.1/inc/Helpers/Ajax.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Helpers/Ajax.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Helpers/Ajax.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Helpers/Ajax.php?rev=2930921#L39 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Ajax.php?rev=3137253#L39 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 39 | 39 | \*/ |
  | 40 | 40 | protected function verify\_nonce( $action = 'wplmi\_admin\_nonce' ) { |
  | 41 |  | if ( ! isset( $\_REQUEST['security'] ) || ! \wp\_verify\_nonce( ~~$\_REQUEST['security']~~, $action ) ) { |
  |  | 41 | if ( ! isset( $\_REQUEST['security'] ) || ! \wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_REQUEST['security'] ) ), $action ) ) { |
  | 42 | 42 | $this->error( \_\_( 'Error: Nonce verification failed', 'wp-last-modified-info' ) ); |
  | 43 | 43 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L23 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php?rev=3137253#L23 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | \* Send AJAX response. |
  | 24 | 24 | \* |
  | 25 |  | \* @param array $data    Data to send using ajax. |
  |  | 25 | \* @param array $data    Data to send using ajax. |
  | 26 | 26 | \* @param boolean $success Optional. If this is an error. Defaults: true. |
  | 27 | 27 | \*/ |
  | 28 |  | protected function do\_field( $data ) { |
  | 29 |  | if ( ~~! isset( $data['type'] ) ||~~ empty( $data['type'] ) ) { |
  |  | 28 | protected function do\_field( array $data ) { |
  |  | 29 | if ( empty( $data['type'] ) ) { |
  | 30 | 30 | $data['type'] = 'text'; |
  | 31 | 31 | } |
  | 32 |  |  |
  |  | 32 |  |
  | 33 | 33 | $class = [ 'wplmi-form-control', 'wplmi-form-el' ]; |
  | 34 |  | if ( ~~isset( $data['class'] ) &&~~ ! empty( $data['class'] ) ) { |
  |  | 34 | if ( ! empty( $data['class'] ) ) { |
  | 35 | 35 | if ( is\_array( $data['class'] ) ) { |
  | 36 | 36 | $class = array\_merge( $class, $data['class'] ); |
  | 37 | 37 | } else { |
  | 38 |  | ~~array\_push( $class, $data['class'] )~~; |
  |  | 38 | $class[] = $data['class']; |
  | 39 | 39 | } |
  | 40 | 40 | } |
  | 41 |  |  |
  |  | 41 |  |
  | 42 | 42 | $name = $data['id']; |
  | 43 | 43 | if ( isset( $data['name'] ) ) { |
  | 44 | 44 | $name = $data['name']; |
  | 45 | 45 | } |
  | 46 |  |  |
  |  | 46 |  |
  | 47 | 47 | $attr = []; |
  | 48 | 48 | if ( isset( $data['required'] ) && true === $data['required'] ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L52) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php?rev=3137253#L52) |  |
  | 52 | 52 | $attr[] = 'data-required="no"'; |
  | 53 | 53 | } |
  | 54 |  |  |
  |  | 54 |  |
  | 55 | 55 | if ( isset( $data['checked'] ) && true === $data['checked'] ) { |
  | 56 | 56 | $attr[] = 'checked'; |
  | 57 | 57 | } |
  | 58 |  |  |
  |  | 58 |  |
  | 59 | 59 | if ( isset( $data['disabled'] ) && true === $data['disabled'] ) { |
  | 60 | 60 | $attr[] = 'disabled'; |
  | 61 | 61 | } |
  | 62 |  |  |
  |  | 62 |  |
  | 63 | 63 | if ( isset( $data['readonly'] ) && true === $data['readonly'] ) { |
  | 64 | 64 | $attr[] = 'readonly'; |
  | 65 | 65 | } |
  | 66 |  |  |
  | 67 |  | if ( ~~isset( $data['attributes'] ) &&~~ ! empty( $data['attributes'] ) && is\_array( $data['attributes'] ) ) { |
  |  | 66 |  |
  |  | 67 | if ( ! empty( $data['attributes'] ) && is\_array( $data['attributes'] ) ) { |
  | 68 | 68 | foreach ( $data['attributes'] as $key => $value ) { |
  | 69 | 69 | $attr[] = $key . '="' . $value . '"'; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L71) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php?rev=3137253#L71) |  |
  | 71 | 71 | } |
  | 72 | 72 |  |
  | 73 |  | if ( ~~isset( $data['condition'] ) &&~~ ! empty( $data['condition'] ) && is\_array( $data['condition'] ) ) { |
  |  | 73 | if ( ! empty( $data['condition'] ) && is\_array( $data['condition'] ) ) { |
  | 74 | 74 | $cattr = 'data-condition="' . htmlspecialchars( wp\_json\_encode( $data['condition'] ), ENT\_QUOTES, 'UTF-8' ) . '"'; |
  | 75 |  | ~~array\_push( $attr, $cattr )~~; |
  |  | 75 | $attr[] = $cattr; |
  | 76 | 76 | } |
  | 77 | 77 |  |
  | 78 |  | if ( ~~isset( $data['show\_if'] ) &&~~ ! empty( $data['show\_if'] ) ) { |
  |  | 78 | if ( ! empty( $data['show\_if'] ) ) { |
  | 79 | 79 | $cattr = 'data-show-if="' . $data['show\_if'] . '"'; |
  | 80 |  | ~~array\_push( $attr, $cattr )~~; |
  |  | 80 | $attr[] = $cattr; |
  | 81 | 81 | } |
  | 82 |  |  |
  | 83 |  | $value = ~~isset( $data['value'] ) ? $data['value'] :~~ ''; |
  | 84 |  |  |
  |  | 82 |  |
  |  | 83 | $value = $data['value'] ?? ''; |
  |  | 84 |  |
  | 85 | 85 | if ( $data['type'] == 'hidden' ) { |
  | 86 |  | echo '<input type="hidden" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" autocomplete="off" value="' . esc\_attr( $value ) . '" />'; |
  |  | 86 | echo '<input type="hidden" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" autocomplete="off" value="' . esc\_attr( $value ) . '" />'; |
  | 87 | 87 | return; |
  | 88 | 88 | } |
  | 89 | 89 |  |
  | 90 | 90 | $tooltip = ''; |
  | 91 |  | if ( ~~isset( $data['description'] ) &&~~ ! empty( $data['description'] ) ) { |
  |  | 91 | if ( ! empty( $data['description'] ) ) { |
  | 92 | 92 | if ( isset( $data['tooltip'] ) && $data['tooltip'] ) { |
  | 93 | 93 | $tooltip = '<span class="tooltip" title="' . esc\_attr( $data['description'] ) . '"><span title="" class="dashicons dashicons-editor-help"></span></span>'; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L96) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php?rev=3137253#L96) |  |
  | 96 | 96 | } |
  | 97 | 97 | } |
  | 98 |  |  |
  | 99 |  | if ( $data['type'] == 'checkbox' ) { |
  |  | 98 |  |
  |  | 99 | if ( $data['type'] === 'checkbox' ) { |
  | 100 | 100 | $value = ! empty( $value ) ? $value : '1'; |
  | 101 | 101 | echo '<label class="switch">'; |
  | 102 |  | echo '<input type="checkbox" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" class="wplmi-form-el" value="' . esc\_attr( $value ) . '" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' /> |
  |  | 102 | echo '<input type="checkbox" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" class="wplmi-form-el" value="' . esc\_attr( $value ) . '" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' /> |
  | 103 | 103 | <span class="slider"> |
  | 104 | 104 | <svg width="3" height="8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 6" class="toggle-on" role="img" aria-hidden="true" focusable="false"><path d="M0 0h2v6H0z"></path></svg> |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L110) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php?rev=3137253#L110) |  |
  | 110 | 110 |  |
  | 111 | 111 | if ( isset( $data['type'] ) ) { |
  | 112 |  | if ( in\_array( $data['type'], [ 'text', 'email', 'password', 'date', 'number' ] ) ) { |
  | 113 |  | echo '<input type="' . esc\_attr( $data['type'] ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" autocomplete="off" value="' . esc\_attr( $value ) . '" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' />'; |
  | 114 |  | } elseif ( $data['type'] == 'textarea' ) { |
  | 115 |  | echo '<textarea class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" id="' . esc\_attr( $data['id'] ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' autocomplete="off">' . wp\_kses\_post( $value ) . '</textarea>'; |
  | 116 |  | } elseif ( $data['type'] == 'select' ) { |
  |  | 112 | if ( in\_array( $data['type'], [ 'text', 'email', 'password', 'date', 'number' ], true ) ) { |
  |  | 113 | echo '<input type="' . esc\_attr( $data['type'] ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" autocomplete="off" value="' . esc\_attr( $value ) . '" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' />'; |
  |  | 114 | } elseif ( $data['type'] === 'textarea' ) { |
  |  | 115 | echo '<textarea class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" id="' . esc\_attr( $data['id'] ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' autocomplete="off">' . wp\_kses\_post( $value ) . '</textarea>'; |
  |  | 116 | } elseif ( $data['type'] === 'select' ) { |
  | 117 | 117 | if ( isset( $data['options'] ) && is\_array( $data['options'] ) ) { |
  | 118 |  | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' autocomplete="off">'; |
  |  | 118 | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' autocomplete="off">'; |
  | 119 | 119 | if ( ! empty( $data['options'] ) ) { |
  | 120 | 120 | foreach ( $data['options'] as $key => $option ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L128) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php?rev=3137253#L128) |  |
  | 128 | 128 | echo '</select>'; |
  | 129 | 129 | } |
  | 130 |  | } elseif ( $data['type'] == 'multiple' ) { |
  |  | 130 | } elseif ( $data['type'] === 'multiple' ) { |
  | 131 | 131 | if ( isset( $data['options'] ) && is\_array( $data['options'] ) ) { |
  | 132 |  | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . '][]" multiple="multiple" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' style="width: 90%">'; |
  |  | 132 | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . '][]" multiple="multiple" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' style="width: 90%">'; |
  | 133 | 133 | if ( ! empty( $data['options'] ) ) { |
  | 134 | 134 | foreach ( $data['options'] as $key => $option ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L138) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php?rev=3137253#L138) |  |
  | 138 | 138 | echo '</select>'; |
  | 139 | 139 | } |
  | 140 |  | } elseif ( $data['type'] == 'multiple\_tax' ) { |
  |  | 140 | } elseif ( $data['type'] === 'multiple\_tax' ) { |
  | 141 | 141 | if ( isset( $data['options'] ) && is\_array( $data['options'] ) ) { |
  | 142 |  | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . '][]" multiple="multiple" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' style="width: 90%">'; |
  |  | 142 | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . '][]" multiple="multiple" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' style="width: 90%">'; |
  | 143 | 143 | if ( ! empty( $data['options'] ) ) { |
  | 144 | 144 | foreach ( $data['options'] as $key => $option ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L154) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/Fields.php?rev=3137253#L154) |  |
  | 154 | 154 | echo '</select>'; |
  | 155 | 155 | } |
  | 156 |  | } elseif ( $data['type'] == 'wp\_editor' ) { |
  |  | 156 | } elseif ( $data['type'] === 'wp\_editor' ) { |
  | 157 | 157 | echo '<div class="wplmi-form-control wplmi-form-el wplmi-editor" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) )  . '>'; |
  | 158 | 158 | wp\_editor( html\_entity\_decode( $value, ENT\_COMPAT, "UTF-8" ), $data['id'], [ |
  | 159 |  | 'textarea\_name' => ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']', |
  |  | 159 | 'textarea\_name' => esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']', |
  | 160 | 160 | 'textarea\_rows' => '8', |
  | 161 | 161 | 'teeny'         => true, |
* ## [wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L11 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | namespace Wplmi\Helpers; |
  | 12 | 12 |  |
  | 13 |  | ~~use Wplmi\Helpers\SettingsData;~~ |
  | 14 |  |  |
  | 15 | 13 | defined( 'ABSPATH' ) || exit; |
  | 16 | 14 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L25) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L23) |  |
  | 25 | 23 | \* Get all registered public post types. |
  | 26 | 24 | \* |
  | 27 |  | \* @param bool $public Public type True or False. |
  |  | 25 | \* @param bool $post\_type\_public Public type True or False. |
  | 28 | 26 | \* @return array |
  | 29 | 27 | \*/ |
  | 30 |  | protected function get\_post\_types( ~~$public = true )~~ { |
  | 31 |  | $post\_types = get\_post\_types( [ 'public' => $public ], 'objects' ); |
  |  | 28 | protected function get\_post\_types( bool $post\_type\_public = true ): array { |
  |  | 29 | $post\_types = get\_post\_types( [ 'public' => $post\_type\_public ], 'objects' ); |
  | 32 | 30 | $data = []; |
  | 33 | 31 | foreach ( $post\_types as $post\_type ) { |
  | 34 | 32 | if ( ! is\_object( $post\_type ) ) { |
  | 35 |  | continue; |
  |  | 33 | continue; |
  | 36 | 34 | } |
  | 37 | 35 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L41) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L39) |  |
  | 41 | 39 | $label = $post\_type->name; |
  | 42 | 40 | } |
  | 43 |  |  |
  |  | 41 |  |
  | 44 | 42 | if ( $label == 'Media' || $label == 'media' || $post\_type->name == 'elementor\_library' ) { |
  | 45 | 43 | continue; // skip media |
  | 46 | 44 | } |
  | 47 |  |  |
  |  | 45 |  |
  | 48 | 46 | $data[ $post\_type->name ] = $label; |
  | 49 | 47 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L57) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L55) |  |
  | 57 | 55 | \* @param string     $format Date Format. |
  | 58 | 56 | \* @param object|int $post |
  | 59 |  | \* |
  |  | 57 | \* |
  | 60 | 58 | \* @return string |
  | 61 | 59 | \*/ |
  | 62 | 60 | protected function get\_modified\_date( $format = '', $post = null ) { |
  | 63 | 61 | $post = get\_post( $post ); |
  | 64 |  |  |
  |  | 62 |  |
  | 65 | 63 | if ( ! $post ) { |
  | 66 | 64 | $the\_time = false; |
  | 67 | 65 | } else { |
  | 68 | 66 | $\_format = ! empty( $format ) ? $format : get\_option( 'date\_format' ); |
  | 69 |  |  |
  |  | 67 |  |
  | 70 | 68 | $the\_time = get\_post\_modified\_time( $\_format, false, $post, true ); |
  | 71 | 69 | } |
  | 72 |  |  |
  |  | 70 |  |
  | 73 | 71 | return $the\_time; |
  | 74 | 72 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L77) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L75) |  |
  | 77 | 75 | \* Insert the plugins settings in proper place. |
  | 78 | 76 | \* |
  | 79 |  | \* @param ~~array   $array~~     Default setting fields. |
  | 80 |  | \* @param integer $position  Insertion position. |
  | 81 |  | \* @param ~~array~~  $insert    Field. |
  |  | 77 | \* @param array $fields    Default setting fields. |
  |  | 78 | \* @param integer $position  Insertion position. |
  |  | 79 | \* @param array $insert    Field. |
  | 82 | 80 | \* @return array |
  | 83 | 81 | \*/ |
  | 84 |  | protected function insert\_settings( $array, $position, $insert ) { |
  | 85 |  | $array = array\_merge( array\_slice( $array, 0, $position ), $insert, array\_slice( $array, $position ) ); |
  | 86 |  |  |
  | 87 |  | return $array; |
  |  | 82 | protected function insert\_settings( array $fields, int $position, array $insert ): array { |
  |  | 83 | return array\_merge( array\_slice( $fields, 0, $position ), $insert, array\_slice( $fields, $position ) ); |
  | 88 | 84 | } |
  | 89 | 85 |  |
  | 90 | 86 | /\*\* |
  | 91 | 87 | \* Check plugin settings if enabled |
  | 92 |  | \* |
  | 93 |  | \* @param ~~string~~  $name  Settings field name. |
  | 94 |  | \* |
  |  | 88 | \* |
  |  | 89 | \* @param string $name  Settings field name. |
  |  | 90 | \* |
  | 95 | 91 | \* @return bool |
  | 96 | 92 | \*/ |
  | 97 |  | protected function is\_enabled( ~~$name )~~ { |
  |  | 93 | protected function is\_enabled( string $name ): bool { |
  | 98 | 94 | $data = $this->get\_data( 'lmt\_' . $name ); |
  | 99 |  | if ( $data == 1 ) { |
  | 100 |  | return true; |
  | 101 |  | } |
  | 102 |  |  |
  | 103 |  | return false; |
  |  | 95 |  |
  |  | 96 | return $data == 1; |
  | 104 | 97 | } |
  | 105 | 98 |  |
  | 106 | 99 | /\*\* |
  | 107 | 100 | \* Check plugin settings has a particular value |
  | 108 |  | \* |
  | 109 |  | \* @param ~~string~~  $name   Settings field name. |
  |  | 101 | \* |
  |  | 102 | \* @param string $name   Settings field name. |
  | 110 | 103 | \* @param  string  $value  Settings field value. |
  | 111 |  | \* |
  |  | 104 | \* |
  | 112 | 105 | \* @return bool |
  | 113 | 106 | \*/ |
  | 114 |  | protected function is\_equal( ~~$name, $value )~~ { |
  |  | 107 | protected function is\_equal( string $name, $value ): bool { |
  | 115 | 108 | $data = $this->get\_data( 'lmt\_' . $name ); |
  | 116 | 109 | if ( $data && $data == $value ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L122) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L115) |  |
  | 122 | 115 |  |
  | 123 | 116 | /\*\* |
  | 124 |  | ~~\* Check plugin settings has in a array~~ |
  | 125 |  | ~~\*~~ |
  | 126 |  | ~~\* @param  string  $name     Settings field name.~~ |
  | 127 |  | ~~\* @param  array   $value    Settings field values.~~ |
  | 128 |  | ~~\* @param  bool    $default  Default value.~~ |
  | 129 |  | ~~\*~~ |
  | 130 |  | ~~\* @return bool~~ |
  | 131 |  | ~~\*/~~ |
  | 132 |  | ~~protected function in\_array( $name, array $values, $default = false ) {~~ |
  | 133 |  | ~~$data = $this->get\_data( 'lmt\_' . $name, $default );~~ |
  | 134 |  |  |
  | 135 |  | ~~return in\_array( $name, $data, true );~~ |
  | 136 |  | ~~}~~ |
  | 137 |  |  |
  | 138 |  | ~~/\*\*~~ |
  | 139 | 117 | \* Check current user roles. |
  | 140 |  | \* |
  |  | 118 | \* |
  |  | 119 | \* @return array |
  | 141 | 120 | \* @since  1.8.0 |
  | 142 |  | ~~\* @return bool~~ |
  | 143 | 121 | \*/ |
  | 144 | 122 | protected function get\_users( $args = [] ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L155) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L133) |  |
  | 155 | 133 |  |
  | 156 | 134 | /\*\* |
  | 157 |  | ~~\* Date Time string to seconds and also from array~~ |
  | 158 |  | ~~\*~~ |
  | 159 |  | ~~\* @since 1.8.0~~ |
  | 160 |  | ~~\* @return string~~ |
  | 161 |  | ~~\*/~~ |
  | 162 |  | ~~protected function str\_to\_second( $input ) {~~ |
  | 163 |  | ~~$times = explode( ' ', preg\_replace( '!\s+!', ' ', str\_replace( [ ',', '-', '\_' ], ' ', $input ) ) );~~ |
  | 164 |  | ~~$total\_time = 0;~~ |
  | 165 |  | ~~foreach ( $times as $time ) {~~ |
  | 166 |  | ~~$total\_time += $this->convert\_str\_to\_second( $time );~~ |
  | 167 |  | ~~}~~ |
  | 168 |  |  |
  | 169 |  | ~~return $total\_time;~~ |
  | 170 |  | ~~}~~ |
  | 171 |  |  |
  | 172 |  | ~~/\*\*~~ |
  | 173 |  | ~~\* Convert Date Time string to seconds~~ |
  | 174 |  | ~~\*~~ |
  | 175 |  | ~~\* @since 1.3.0~~ |
  | 176 |  | ~~\* @return string~~ |
  | 177 |  | ~~\*/~~ |
  | 178 |  | ~~protected function convert\_str\_to\_second( $input ) {~~ |
  | 179 |  | ~~$res = preg\_replace( "/[^a-z]/i", '', strtolower( $input ) );~~ |
  | 180 |  | ~~if ( ! in\_array( $res, [ 'y', 'm', 'd', 'w', 'h', 'i' ] ) ) {~~ |
  | 181 |  | ~~return $input \* MINUTE\_IN\_SECONDS;~~ |
  | 182 |  | ~~}~~ |
  | 183 |  |  |
  | 184 |  | ~~$input = preg\_replace( "/[^0-9]/", '', $input );~~ |
  | 185 |  | ~~switch ( $res ) {~~ |
  | 186 |  | ~~case 'y':~~ |
  | 187 |  | ~~$output = $input \* YEAR\_IN\_SECONDS;~~ |
  | 188 |  | ~~break;~~ |
  | 189 |  | ~~case 'm':~~ |
  | 190 |  | ~~$output = $input \* MONTH\_IN\_SECONDS;~~ |
  | 191 |  | ~~break;~~ |
  | 192 |  | ~~case 'd':~~ |
  | 193 |  | ~~$output = $input \* DAY\_IN\_SECONDS;~~ |
  | 194 |  | ~~break;~~ |
  | 195 |  | ~~case 'w':~~ |
  | 196 |  | ~~$output = $input \* WEEK\_IN\_SECONDS;~~ |
  | 197 |  | ~~break;~~ |
  | 198 |  | ~~case 'h':~~ |
  | 199 |  | ~~$output = $input \* HOUR\_IN\_SECONDS;~~ |
  | 200 |  | ~~break;~~ |
  | 201 |  | ~~case 'i':~~ |
  | 202 |  | ~~$output = $input \* MINUTE\_IN\_SECONDS;~~ |
  | 203 |  | ~~break;~~ |
  | 204 |  | ~~default:~~ |
  | 205 |  | ~~$output = MINUTE\_IN\_SECONDS;~~ |
  | 206 |  | ~~}~~ |
  | 207 |  |  |
  | 208 |  | ~~return $output;~~ |
  | 209 |  | ~~}~~ |
  | 210 |  |  |
  | 211 |  | ~~/\*\*~~ |
  | 212 | 135 | \* Determines whether the current screen is an edit post screen. |
  | 213 | 136 | \* |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L215) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L138) |  |
  | 215 | 138 | \* @return bool Whether or not the current screen is editing an existing post. |
  | 216 | 139 | \*/ |
  | 217 |  | protected function is\_edit\_post\_screen() { |
  |  | 140 | protected function is\_edit\_post\_screen(): bool { |
  | 218 | 141 | if ( ! \is\_admin() ) { |
  | 219 | 142 | return false; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L226) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L149) |  |
  | 226 | 149 |  |
  | 227 | 150 | /\*\* |
  | 228 |  | \* Determines whether the current screen is a~~n~~ new post screen. |
  | 229 |  | \* |
  | 230 |  | \* @since 1.8.0 |
  | 231 |  | \* @return bool Whether ~~or not the current screen is editing an~~ new post. |
  | 232 |  | \*/ |
  | 233 |  | protected function is\_new\_post\_screen() { |
  |  | 151 | \* Determines whether the current screen is a new post screen. |
  |  | 152 | \* |
  |  | 153 | \* @since 1.8.0 |
  |  | 154 | \* @return bool Whether the current screen is editing a new post. |
  |  | 155 | \*/ |
  |  | 156 | protected function is\_new\_post\_screen(): bool { |
  | 234 | 157 | if ( ! \is\_admin() ) { |
  | 235 | 158 | return false; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L247) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L170) |  |
  | 247 | 170 | \* @return bool Whether we are currently editing a post with Classic editor. |
  | 248 | 171 | \*/ |
  | 249 |  | protected function is\_classic\_editor() { |
  |  | 172 | protected function is\_classic\_editor(): bool { |
  | 250 | 173 | if ( ! $this->is\_edit\_post\_screen() && ! $this->is\_new\_post\_screen() ) { |
  | 251 | 174 | return false; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L266) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L189) |  |
  | 266 | 189 | \* @return bool Whether we are currently editing a post with Block editor. |
  | 267 | 190 | \*/ |
  | 268 |  | protected function is\_block\_editor() { |
  |  | 191 | protected function is\_block\_editor(): bool { |
  | 269 | 192 | $screen = \get\_current\_screen(); |
  | 270 | 193 | if ( \method\_exists( $screen, 'is\_block\_editor' ) && $screen->is\_block\_editor() ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L283) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/HelperFunctions.php?rev=3137253#L206) |  |
  | 283 | 206 | \* @return bool Whether or not the post can be copied to a new draft. |
  | 284 | 207 | \*/ |
  | 285 |  | protected function post\_type\_has\_admin\_bar( $post\_type ) { |
  |  | 208 | protected function post\_type\_has\_admin\_bar( $post\_type ): bool { |
  | 286 | 209 | $post\_type\_object = \get\_post\_type\_object( $post\_type ); |
  | 287 | 210 |  |
* ## [wp-last-modified-info/tags/1.9.1/inc/Helpers/SettingsData.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Helpers/SettingsData.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Helpers/SettingsData.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=2930921#L73 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/SettingsData.php?rev=3137253#L73 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 73 | 73 | \* retreive plugin data. |
  | 74 | 74 | \* |
  | 75 |  | \* @param string $key         Option key. |
  | 76 |  | \* @param mixed  $~~value~~    Default value |
  |  | 75 | \* @param string $key             Option key. |
  |  | 76 | \* @param mixed  $default\_value   Default value |
  | 77 | 77 | \* |
  | 78 | 78 | \* @return mixed |
  | 79 | 79 | \*/ |
  | 80 |  | protected function get\_data( $key, $default = false ) { |
  |  | 80 | protected function get\_data( $key, $default\_value = false ) { |
  | 81 | 81 | $settings = get\_option( 'lmt\_plugin\_global\_settings' ); |
  | 82 | 82 |  |
  | 83 |  | return ( ~~isset( $settings[ $key ] ) && ! empty( $settings[ $key ] ) ) ? $settings[ $key ] : $default~~; |
  |  | 83 | return ( ! empty( $settings[ $key ] )) ? $settings[ $key ] : $default\_value; |
  | 84 | 84 | } |
  | 85 | 85 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=2930921#L92) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/SettingsData.php?rev=3137253#L92) |  |
  | 92 | 92 | \* @return mixed |
  | 93 | 93 | \*/ |
  | 94 |  | protected function build\_meta( $post\_id, $meta\_key, $default = false, $unserialize = false, $single = true ) { |
  |  | 94 | protected function build\_meta( $post\_id, $meta\_key, $default\_value = false, $unserialize = false, $single = true ) { |
  | 95 | 95 | $meta = $this->get\_meta( $post\_id, $meta\_key, $single ); |
  | 96 | 96 | if ( $unserialize ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=2930921#L98) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Helpers/SettingsData.php?rev=3137253#L98) |  |
  | 98 | 98 | } |
  | 99 | 99 |  |
  | 100 |  | return ( ! empty( $meta ) ) ? $meta : $default; |
  |  | 100 | return ( ! empty( $meta ) ) ? $meta : $default\_value; |
  | 101 | 101 | } |
  | 102 | 102 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Loader.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Loader.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Loader.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=2930921#L18 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Loader.php?rev=3137253#L18 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 18 | 18 | /\*\* |
  | 19 | 19 | \* Store all the classes inside an array |
  | 20 |  | \* |
  |  | 20 | \* |
  | 21 | 21 | \* @return array Full list of classes |
  | 22 | 22 | \*/ |
  | 23 |  | public static function get\_services() { |
  | 24 |  | ~~$services =~~ [ |
  |  | 23 | public static function get\_services(): array { |
  |  | 24 | return [ |
  | 25 | 25 | Base\Enqueue::class, |
  | 26 | 26 | Base\MiscActions::class, |
  | […](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=2930921#L48) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Loader.php?rev=3137253#L48) |  |
  | 48 | 48 | Pages\Dashboard::class, |
  | 49 | 49 | ]; |
  | 50 |  |  |
  | 51 |  | ~~return $services;~~ |
  | 52 | 50 | } |
  | 53 | 51 |  |
  | 54 | 52 | /\*\* |
  | 55 |  | \* Loop through the classes, initialize them, |
  |  | 53 | \* Loop through the classes, initialize them, |
  | 56 | 54 | \* and call the register() method if it exists |
  | 57 | 55 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=2930921#L59) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Loader.php?rev=3137253#L57) |  |
  | 59 | 57 | foreach ( self::get\_services() as $class ) { |
  | 60 | 58 | $service = self::instantiate( $class ); |
  |  | 59 |  |
  | 61 | 60 | if ( method\_exists( $service, 'register' ) ) { |
  | 62 | 61 | $service->register(); |
  | […](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=2930921#L67) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Loader.php?rev=3137253#L66) |  |
  | 67 | 66 | /\*\* |
  | 68 | 67 | \* Initialize the class |
  | 69 |  | \* |
  | 70 |  | \* @param ~~class $class~~   class from the services array |
  | 71 |  | \* @return class instance  new instance of the class |
  |  | 68 | \* |
  |  | 69 | \* @param string $wplmi\_class  class from the services array |
  |  | 70 | \* @return class instance      new instance of the class |
  | 72 | 71 | \*/ |
  | 73 |  | private static function instantiate( $class ) { |
  | 74 |  | $service = new $class(); |
  | 75 |  |  |
  | 76 |  | return $service; |
  |  | 72 | private static function instantiate( string $wplmi\_class ) { |
  |  | 73 | return new $wplmi\_class(); |
  | 77 | 74 | } |
  | 78 | 75 | } |
* ## [wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php")

  | [r3033702](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L1 "Show revision 3033702 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Dashboard actions. |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L24) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php?rev=3137253#L24) |  |
  | 24 | 24 | class Dashboard |
  | 25 | 25 | { |
  | 26 |  | use HelperFunctions, Hooker; |
  |  | 26 | use HelperFunctions; |
  |  | 27 | use Hooker; |
  | 27 | 28 |  |
  | 28 | 29 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L84) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php?rev=3137253#L85) |  |
  | 84 | 85 | $this->sub\_pages = [ |
  | 85 | 86 | [ |
  | 86 |  | 'parent\_slug' => 'options-general.php', |
  | 87 |  | 'page\_title'  => \_\_( 'WP Last Modified Info', 'wp-last-modified-info' ), |
  | 88 |  | 'menu\_title'  => \_\_( 'WP Last Modified Info', 'wp-last-modified-info' ), |
  | 89 |  | 'capability'  => 'manage\_options', |
  | 90 |  | 'menu\_slug'   => 'wp-last-modified-info', |
  |  | 87 | 'parent\_slug' => 'options-general.php', |
  |  | 88 | 'page\_title'  => \_\_( 'WP Last Modified Info', 'wp-last-modified-info' ), |
  |  | 89 | 'menu\_title'  => \_\_( 'WP Last Modified Info', 'wp-last-modified-info' ), |
  |  | 90 | 'capability'  => 'manage\_options', |
  |  | 91 | 'menu\_slug'   => 'wp-last-modified-info', |
  | 91 | 92 | 'callback'    => [ $this->callbacks, 'adminDashboard' ], |
  | 92 | 93 | ], |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L102) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php?rev=3137253#L103) |  |
  | 102 | 103 | 'option\_group' => 'wplmi\_plugin\_settings\_fields', |
  | 103 | 104 | 'option\_name'  => 'lmt\_plugin\_global\_settings', |
  | 104 |  | 'callback'     => [ |
  |  | 105 | 'callback'     => [ |
  | 105 | 106 | 'sanitize\_callback' => [ $this, 'sanitizeOutput' ], |
  | 106 | 107 | ], |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L115) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php?rev=3137253#L116) |  |
  | 115 | 116 | \*/ |
  | 116 | 117 | public function setSections() { |
  | 117 |  | $sections = [ |
  |  | 118 | $sections = [ |
  | 118 | 119 | 'post'         => \_\_( 'Post Options', 'wp-last-modified-info' ), |
  | 119 | 120 | 'template\_tag' => \_\_( 'Template Tags', 'wp-last-modified-info' ), |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L122) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php?rev=3137253#L123) |  |
  | 122 | 123 | 'misc'         => \_\_( 'Miscellaneous Options', 'wp-last-modified-info' ), |
  | 123 | 124 | ]; |
  | 124 |  |  |
  |  | 125 |  |
  | 125 | 126 | $args = []; |
  | 126 | 127 | foreach ( $sections as $section => $title ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L222) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php?rev=3137253#L223) |  |
  | 222 | 223 | \* @return  array  $output  The sanitized input. |
  | 223 | 224 | \*/ |
  | 224 |  | public function sanitizeOutput( $input ) { |
  |  | 225 | public function sanitizeOutput( $input ) { |
  | 225 | 226 | $output = []; |
  | 226 | 227 | $fields = [ 'lmt\_last\_modified\_info\_template', 'lmt\_last\_modified\_info\_template\_tt', 'lmt\_email\_subject', 'lmt\_email\_message' ]; |
  | 227 |  |  |
  |  | 228 |  |
  | 228 | 229 | foreach ( $input as $key => $value ) { |
  | 229 | 230 | if ( in\_array( $key, $fields ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L233) | […](/browser/wp-last-modified-info/tags/1.9.1/inc/Pages/Dashboard.php?rev=3137253#L234) |  |
  | 233 | 234 | } |
  | 234 | 235 | } |
  | 235 |  |  |
  |  | 236 |  |
  | 236 | 237 | return $this->do\_filter( 'validate\_input', $output, $input ); |
  | 237 | 238 | } |
* ## [wp-last-modified-info/tags/1.9.1/readme.txt](/changeset/3137253/wp-last-modified-info/tags/1.9.1/readme.txt "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/readme.txt")

  | [r3052359](/browser/wp-last-modified-info/trunk/readme.txt?rev=3052359#L1 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/readme.txt?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === WP Last Modified Info === |
  | 2 | 2 | Contributors: infosatech |
  | 3 |  | Tags: last modified, timestamp, modified time, post modified, sort by modified~~, time, date~~ |
  |  | 3 | Tags: last modified, timestamp, modified time, post modified, sort by modified |
  | 4 | 4 | Requires at least: 4.7 |
  | 5 |  | Tested up to: 6.~~5~~ |
  | 6 |  | Stable tag: 1.9.~~0~~ |
  |  | 5 | Tested up to: 6.6 |
  |  | 6 | Stable tag: 1.9.1 |
  | 7 | 7 | Requires PHP: 7.0 |
  | 8 | 8 | Donate link: https://www.paypal.me/iamsayan/ |
  | […](/browser/wp-last-modified-info/trunk/readme.txt?rev=3052359#L165) | […](/browser/wp-last-modified-info/tags/1.9.1/readme.txt?rev=3137253#L165) |  |
  | 165 | 165 | If you like WP Last Modified Info, please take a moment to [give a 5-star rating](https://wordpress.org/support/plugin/wp-last-modified-info/reviews/?rate=5#new-post). It helps to keep development and support going strong. Thank you! |
  | 166 | 166 |  |
  |  | 167 | = 1.9.1 = |
  |  | 168 | Release Date: August 9, 2024 |
  |  | 169 |  |
  |  | 170 | \* Added changes according to WPCS. |
  |  | 171 | \* Tested with WordPress v6.6. |
  |  | 172 |  |
  | 167 | 173 | = 1.9.0 = |
  | 168 | 174 | Release Date: March 17, 2024 |
* ## [wp-last-modified-info/tags/1.9.1/templates/admin.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/templates/admin.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/templates/admin.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L11 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/templates/admin.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 |  |
  | 12 | 12 | <div id="wplmi-nav-container" class="wplmi-admin-toolbar"> |
  | 13 |  | <h2>WP Last Modified Info<span class="title-count"><?~~php echo~~ esc\_html( $this->version ); ?></span></h2> |
  | 14 |  |  |
  |  | 13 | <h2>WP Last Modified Info<span class="title-count"><?= esc\_html( $this->version ); ?></span></h2> |
  |  | 14 |  |
  | 15 | 15 | <a href="#post" class="wplmi-tab is-active" id="wplmi-tab-post"><?php esc\_html\_e( 'Posts', 'wp-last-modified-info' ); ?></a> |
  | 16 | 16 | <a href="#template" class="wplmi-tab" id="wplmi-tab-template"><?php esc\_html\_e( 'Template Tag', 'wp-last-modified-info' ); ?></a> |
  | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L142) | […](/browser/wp-last-modified-info/tags/1.9.1/templates/admin.php?rev=3137253#L142) |  |
  | 142 | 142 | </li> |
  | 143 | 143 | <li> |
  | 144 |  | <?php printf( |
  |  | 144 | <?php printf( |
  | 145 | 145 | /\* translators: %s: code html tag \*/ |
  | 146 | 146 | esc\_html\_\_( 'Do I need to add %s tag?', 'wp-last-modified-info' ), '<code>&lt;style&gt; &lt;/style&gt;</code>' ); ?> |
  | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L149) | […](/browser/wp-last-modified-info/tags/1.9.1/templates/admin.php?rev=3137253#L149) |  |
  | 149 | 149 | <li> |
  | 150 | 150 | <?php esc\_html\_e( 'How to set custom date/time format?', 'wp-last-modified-info' ); ?> |
  | 151 |  | <p><?php printf( |
  |  | 151 | <p><?php printf( |
  | 152 | 152 | /\* translators: %s: html tags \*/ |
  | 153 | 153 | esc\_html\_\_( 'Go to %1$sWordPress Date/Time Syntax%2$s page and read instructions about Date/Time Syntax.', 'wp-last-modified-info' ), '<a href="https://wordpress.org/support/article/formatting-date-and-time/" target="\_blank">', '</a>' ); ?></p> |
  | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L164) | […](/browser/wp-last-modified-info/tags/1.9.1/templates/admin.php?rev=3137253#L164) |  |
  | 164 | 164 | </li> |
  | 165 | 165 | <li><?php esc\_html\_e( 'How to use shortcodes?', 'wp-last-modified-info' ); ?> |
  | 166 |  | <p><?php printf( |
  |  | 166 | <p><?php printf( |
  | 167 | 167 | /\* translators: %s: shortcodes \*/ |
  | 168 | 168 | esc\_html\_\_( 'You can insert the last modified info by simply using the shortcode. Shortcode for posts/pages/custom post types is %1$s. To enter the shortcode directly into templates using PHP, use %2$s for any post types. You can use %3$s to display global site modified info on website frontend.', 'wp-last-modified-info' ), '<code>[lmt-post-modified-info]</code>', '<code>echo do\_shortcode( &#39;[lmt-post-modified-info]&#39; );</code>', '<code>[lmt-site-modified-info]</code>' ); ?></p> |
  | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L204) | […](/browser/wp-last-modified-info/tags/1.9.1/templates/admin.php?rev=3137253#L204) |  |
  | 204 | 204 | </div> |
  | 205 | 205 | <span class="coffee-heading"><?php esc\_html\_e( 'Buy me a coffee!', 'wp-last-modified-info' ); ?></span> |
  | 206 |  | <p style="text-align: justify;"><?php printf( |
  |  | 206 | <p style="text-align: justify;"><?php printf( |
  | 207 | 207 | /\* translators: %s: plugin name \*/ |
  | 208 | 208 | esc\_html\_\_( 'Thank you for using %s. If you found the plugin useful buy me a coffee! Your donation will motivate and make me happy for all the efforts. You can donate via PayPal.', 'wp-last-modified-info' ), '<strong>WP Last Modified Info v' . esc\_html( $this->version ) . '</strong>' ); ?></strong> |
* ## [wp-last-modified-info/tags/1.9.1/uninstall.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/uninstall.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/uninstall.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/uninstall.php?rev=2930921#L33 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/uninstall.php?rev=3137253#L33 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 33 | 33 | } else { |
  | 34 | 34 | global $wpdb; |
  | 35 |  |  |
  |  | 35 |  |
  | 36 | 36 | $blog\_ids = $wpdb->get\_col( "SELECT blog\_id FROM $wpdb->blogs" ); |
  | 37 | 37 | $original\_blog\_id = get\_current\_blog\_id(); |
  | 38 |  | foreach ( $blog\_ids as $blog\_id ) { |
  | 39 |  | switch\_to\_blog( $blog\_id ); |
  |  | 38 | foreach ( $blog\_ids as $wp\_blog\_id ) { |
  |  | 39 | switch\_to\_blog( $wp\_blog\_id ); |
  | 40 | 40 | $options = get\_option( $option\_name ); |
  | 41 | 41 | if ( isset( $options['lmt\_del\_plugin\_data\_cb'] ) && $options['lmt\_del\_plugin\_data\_cb'] == 1 ) { |
* ## [wp-last-modified-info/tags/1.9.1/vendor/composer/installed.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/vendor/composer/installed.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/vendor/composer/installed.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/vendor/composer/installed.php?rev=3052359#L4 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/vendor/composer/installed.php?rev=3137253#L4 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | 'pretty\_version' => 'dev-master', |
  | 5 | 5 | 'version' => 'dev-master', |
  | 6 |  | 'reference' => '~~a96bfe39997587b1f9b8bce640592056862701a3~~', |
  |  | 6 | 'reference' => '4101109995a08c6c2539990de6b88a792703df27', |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/wp-last-modified-info/trunk/vendor/composer/installed.php?rev=3052359#L23) | […](/browser/wp-last-modified-info/tags/1.9.1/vendor/composer/installed.php?rev=3137253#L23) |  |
  | 23 | 23 | 'pretty\_version' => 'dev-master', |
  | 24 | 24 | 'version' => 'dev-master', |
  | 25 |  | 'reference' => '~~a96bfe39997587b1f9b8bce640592056862701a3~~', |
  |  | 25 | 'reference' => '4101109995a08c6c2539990de6b88a792703df27', |
  | 26 | 26 | 'type' => 'wordpress-plugin', |
  | 27 | 27 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
* ## [wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php](/changeset/3137253/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php "Show the changeset 3137253 restricted to wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L4 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253#L4 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/wp-last-modified-info/ |
  | 5 | 5 | \* Description: Ultimate Last Modified Plugin for WordPress with Gutenberg Block Integration. It is possible to use shortcodes to display last modified info anywhere on a WordPress site running 4.7 and beyond. |
  | 6 |  | \* Version: 1.9.~~0~~ |
  |  | 6 | \* Version: 1.9.1 |
  | 7 | 7 | \* Author: Sayan Datta |
  | 8 | 8 | \* Author URI: https://www.sayandatta.co.in |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L10) | […](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253#L10) |  |
  | 10 | 10 | \* Text Domain: wp-last-modified-info |
  | 11 | 11 | \* Domain Path: /languages |
  | 12 |  | \* |
  |  | 12 | \* |
  | 13 | 13 | \* WP Last Modified Info is free software: you can redistribute it and/or modify |
  | 14 | 14 | \* it under the terms of the GNU General Public License as published by |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L23) | […](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253#L23) |  |
  | 23 | 23 | \* You should have received a copy of the GNU General Public License |
  | 24 | 24 | \* along with WP Last Modified Info. If not, see <http://www.gnu.org/licenses/>. |
  | 25 |  | \* |
  |  | 25 | \* |
  | 26 | 26 | \* @category Core |
  | 27 | 27 | \* @package  WP Last Modified Info |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L29) | […](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253#L29) |  |
  | 29 | 29 | \* @license  http://www.gnu.org/licenses/ GNU General Public License |
  | 30 | 30 | \* @link     https://wordpress.org/plugins/wp-last-modified-info/ |
  | 31 |  | \* |
  |  | 31 | \* |
  | 32 | 32 | \*/ |
  | 33 | 33 |  |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L47) | […](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253#L47) |  |
  | 47 | 47 | \* @var string |
  | 48 | 48 | \*/ |
  | 49 |  | public $version = '1.9.~~0~~'; |
  |  | 49 | public $version = '1.9.1'; |
  | 50 | 50 |  |
  | 51 | 51 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L162) | […](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253#L162) |  |
  | 162 | 162 | <div class="notice wplmi-notice notice-error"> |
  | 163 | 163 | <p> |
  | 164 |  | <?~~php echo~~ join( '<br>', $this->messages ); // phpcs:ignore ?> |
  |  | 164 | <?= join( '<br>', $this->messages ); // phpcs:ignore ?> |
  | 165 | 165 | </p> |
  | 166 | 166 | </div> |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L183) | […](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253#L183) |  |
  | 183 | 183 | \*/ |
  | 184 | 184 | private function includes() { |
  | 185 |  | include ~~dirname( \_\_FILE\_\_ )~~ . '/vendor/autoload.php'; |
  |  | 185 | include \_\_DIR\_\_ . '/vendor/autoload.php'; |
  | 186 | 186 | } |
  | 187 | 187 |  |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L191) | […](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253#L191) |  |
  | 191 | 191 | private function instantiate() { |
  | 192 | 192 | // Activation hook. |
  | 193 |  | register\_activation\_hook( WPLMI\_FILE, |
  |  | 193 | register\_activation\_hook( WPLMI\_FILE, |
  | 194 | 194 | function () { |
  | 195 | 195 | Wplmi\Base\Activate::activate(); |
  | 196 |  | } |
  |  | 196 | } |
  | 197 | 197 | ); |
  | 198 | 198 |  |
  | 199 | 199 | // Deactivation hook. |
  | 200 |  | register\_deactivation\_hook( WPLMI\_FILE, |
  |  | 200 | register\_deactivation\_hook( WPLMI\_FILE, |
  | 201 | 201 | function () { |
  | 202 | 202 | Wplmi\Base\Deactivate::deactivate(); |
  | 203 |  | } |
  |  | 203 | } |
  | 204 | 204 | ); |
  | 205 | 205 |  |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L214) | […](/browser/wp-last-modified-info/tags/1.9.1/wp-last-modified-info.php?rev=3137253#L214) |  |
  | 214 | 214 | \* @return WPLMI |
  | 215 | 215 | \*/ |
  | 216 |  | function wplmi() { |
  |  | 216 | function wplmi() { // phpcs:ignore Universal.Files.SeparateFunctionsFromOO.Mixed |
  | 217 | 217 | return WPLMI::get(); |
  | 218 | 218 | } |
* ## [wp-last-modified-info/trunk/functions.php](/changeset/3137253/wp-last-modified-info/trunk/functions.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/functions.php")

  | [r2734160](/browser/wp-last-modified-info/trunk/functions.php?rev=2734160#L12 "Show revision 2734160 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/functions.php?rev=3137253#L12 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | /\*\* |
  | 13 | 13 | \* Call the republish function directly |
  | 14 |  | \* |
  |  | 14 | \* |
  | 15 | 15 | \* @since 1.8.0 |
  | 16 | 16 | \* @param bool   $escape     Escape true|false |
  | […](/browser/wp-last-modified-info/trunk/functions.php?rev=2734160#L31) | […](/browser/wp-last-modified-info/trunk/functions.php?rev=3137253#L31) |  |
  | 31 | 31 | /\*\* |
  | 32 | 32 | \* Call the republish function directly |
  | 33 |  | \* |
  |  | 33 | \* |
  | 34 | 34 | \* @since 1.8.0 |
  | 35 | 35 | \* @param bool   $escape   Escape true|false |
  | […](/browser/wp-last-modified-info/trunk/functions.php?rev=2734160#L38) | […](/browser/wp-last-modified-info/trunk/functions.php?rev=3137253#L38) |  |
  | 38 | 38 | function the\_last\_modified\_info( $escape = false, $date = false ) { |
  | 39 | 39 | // displays/echos the last modified info. |
  | 40 |  | echo get\_the\_last\_modified\_info( $escape, $date ); |
  |  | 40 | echo get\_the\_last\_modified\_info( $escape, $date ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 41 | 41 | } |
  | 42 | 42 | } |
* ## [wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=2930921#L1 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Admin callbacks. |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=2930921#L30) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=3137253#L30) |  |
  | 30 | 30 | <div class="wplmi-metabox-holder"> |
  | 31 | 31 | <div class="wplmi-metabox-td"> |
  | 32 |  | <h3 class="wplmi-metabox-title"><?~~php echo~~ esc\_html( $title ); ?></h3> |
  | 33 |  | <p class="wplmi-metabox-description"><?~~php echo~~ wp\_kses\_post( $description ); ?></p> |
  |  | 32 | <h3 class="wplmi-metabox-title"><?= esc\_html( $title ); ?></h3> |
  |  | 33 | <p class="wplmi-metabox-description"><?= wp\_kses\_post( $description ); ?></p> |
  | 34 | 34 | </div> |
  | 35 | 35 | </div> |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=2930921#L38) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/AdminCallbacks.php?rev=3137253#L38) |  |
  | 38 | 38 |  |
  | 39 | 39 | public function doSettingsSection( $attr ) { ?> |
  | 40 |  | <div id="<?~~php echo esc\_attr( $attr['id'] ); ?>" class="postbox <?php echo~~ esc\_attr( $attr['class'] ); ?>"> |
  |  | 40 | <div id="<?= esc\_attr( $attr['id'] ); ?>" class="postbox <?= esc\_attr( $attr['class'] ); ?>"> |
  | 41 | 41 | <?php $this->sectionHeader( $attr['title'], $attr['description'] ); ?> |
  | 42 | 42 | <div class="inside"> |
* ## [wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L1 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Settings callbacks. |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L19) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L19) |  |
  | 19 | 19 | class ManagerCallbacks |
  | 20 | 20 | { |
  | 21 |  | use Fields, HelperFunctions, Hooker; |
  | 22 |  |  |
  | 23 |  | /\* ============================================================================================== |
  | 24 |  | Post Options |
  |  | 21 | use Fields; |
  |  | 22 | use HelperFunctions; |
  |  | 23 | use Hooker; |
  |  | 24 |  |
  |  | 25 | /\* ============================================================================================== |
  |  | 26 | Post Options |
  | 25 | 27 | ============================================================================================== \*/ |
  | 26 | 28 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L186) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L188) |  |
  | 186 | 188 | ] ); |
  | 187 | 189 | } |
  | 188 |  |  |
  | 189 |  | /\* ============================================================================================== |
  | 190 |  | Template Tags |
  |  | 190 |  |
  |  | 191 | /\* ============================================================================================== |
  |  | 192 | Template Tags |
  | 191 | 193 | ============================================================================================== \*/ |
  | 192 | 194 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L252) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L254) |  |
  | 252 | 254 | } |
  | 253 | 255 |  |
  | 254 |  | /\* ============================================================================================== |
  | 255 |  | Schema Options |
  |  | 256 | /\* ============================================================================================== |
  |  | 257 | Schema Options |
  | 256 | 258 | ============================================================================================== \*/ |
  | 257 | 259 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L271) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L273) |  |
  | 271 | 273 | ] ); |
  | 272 | 274 | } |
  | 273 |  |  |
  |  | 275 |  |
  | 274 | 276 | public function schema\_post\_types( $args ) { |
  | 275 | 277 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L284) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L286) |  |
  | 284 | 286 | ] ); |
  | 285 | 287 | } |
  | 286 |  |  |
  |  | 288 |  |
  | 287 | 289 | public function enhanced\_schema( $args ) { |
  | 288 | 290 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L295) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L297) |  |
  | 295 | 297 | ] ); |
  | 296 | 298 | } |
  | 297 |  |  |
  | 298 |  | /\* ============================================================================================== |
  | 299 |  | Notification Options |
  |  | 299 |  |
  |  | 300 | /\* ============================================================================================== |
  |  | 301 | Notification Options |
  | 300 | 302 | ============================================================================================== \*/ |
  | 301 |  |  |
  |  | 303 |  |
  | 302 | 304 | public function enable\_notification( $args ) { |
  | 303 | 305 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L309) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L311) |  |
  | 309 | 311 | ] ); |
  | 310 | 312 | } |
  | 311 |  |  |
  |  | 313 |  |
  | 312 | 314 | public function author\_notification( $args ) { |
  | 313 | 315 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L320) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L322) |  |
  | 320 | 322 | ] ); |
  | 321 | 323 | } |
  | 322 |  |  |
  |  | 324 |  |
  | 323 | 325 | public function draft\_notification( $args ) { |
  | 324 | 326 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L331) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L333) |  |
  | 331 | 333 | ] ); |
  | 332 | 334 | } |
  | 333 |  |  |
  |  | 335 |  |
  | 334 | 336 | public function recipients\_list( $args ) { |
  | 335 | 337 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L343) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L345) |  |
  | 343 | 345 | ] ); |
  | 344 | 346 | } |
  | 345 |  |  |
  |  | 347 |  |
  | 346 | 348 | public function notification\_post\_types( $args ) { |
  | 347 | 349 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L371) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L373) |  |
  | 371 | 373 | ] ); |
  | 372 | 374 | } |
  | 373 |  |  |
  |  | 375 |  |
  | 374 | 376 | public function email\_notification\_message( $args ) { |
  | 375 | 377 | $default = 'The following changes are made on a %post\_type% of your blog by %modified\_author\_name%' . "\n\n" . '<p><strong>Post: %post\_title%</strong></p><p>%post\_diff%</p>'; |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L384) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L386) |  |
  | 384 | 386 | } |
  | 385 | 387 |  |
  | 386 |  | /\* ============================================================================================== |
  |  | 388 | /\* ============================================================================================== |
  | 387 | 389 | Misc Options |
  | 388 | 390 | ============================================================================================== \*/ |
  | 389 |  |  |
  |  | 391 |  |
  | 390 | 392 | public function admin\_bar( $args ) { |
  | 391 | 393 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L397) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L399) |  |
  | 397 | 399 | ] ); |
  | 398 | 400 | } |
  | 399 |  |  |
  |  | 401 |  |
  | 400 | 402 | public function disable\_plugin\_info( $args ) { |
  | 401 | 403 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L407) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L409) |  |
  | 407 | 409 | ] ); |
  | 408 | 410 | } |
  | 409 |  |  |
  |  | 411 |  |
  | 410 | 412 | public function admin\_sort\_order( $args ) { |
  | 411 | 413 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L422) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L424) |  |
  | 422 | 424 | ] ); |
  | 423 | 425 | } |
  | 424 |  |  |
  |  | 426 |  |
  | 425 | 427 | public function sort\_order( $args ) { |
  | 426 | 428 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L437) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L439) |  |
  | 437 | 439 | ] ); |
  | 438 | 440 | } |
  | 439 |  |  |
  |  | 441 |  |
  | 440 | 442 | public function replace\_date( $args ) { |
  | 441 | 443 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L452) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L454) |  |
  | 452 | 454 | ] ); |
  | 453 | 455 | } |
  | 454 |  |  |
  |  | 456 |  |
  | 455 | 457 | public function custom\_css( $args ) { |
  | 456 | 458 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L463) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L465) |  |
  | 463 | 465 | ] ); |
  | 464 | 466 | } |
  | 465 |  |  |
  |  | 467 |  |
  | 466 | 468 | public function delete\_data( $args ) { |
  | 467 | 469 | $this->do\_field( [ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L476) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L478) |  |
  | 476 | 478 | /\*\* |
  | 477 | 479 | \* Generate template tags output. |
  | 478 |  | \* |
  |  | 480 | \* |
  | 479 | 481 | \* @since 1.8.0 |
  | 480 | 482 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L483) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L485) |  |
  | 483 | 485 | <div class="dynamic-tags"> |
  | 484 | 486 | <div class="dynamic-tags-label"> |
  | 485 |  | <a href="https://github.com/iamsayan/wp-last-modified-info/wiki/Temaplate-Use-Cases" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Use these tags', 'wp-last-modified-info' ); ?></a>. |
  |  | 487 | <a href="https://github.com/iamsayan/wp-last-modified-info/wiki/Temaplate-Use-Cases" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Use these tags', 'wp-last-modified-info' ); ?></a>. |
  | 486 | 488 | <a href="https://github.com/iamsayan/wp-last-modified-info/wiki/Template-Tags" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Available Dynamic Tags', 'wp-last-modified-info' ); ?></a>: |
  | 487 | 489 | </div> |
  | 488 |  | <div class="dynamic-tags-content"><?~~php echo $this->get\_available\_tags( $tags );~~ ?></div> |
  |  | 490 | <div class="dynamic-tags-content"><?= $this->get\_available\_tags( $tags ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?></div> |
  | 489 | 491 | </div> |
  | 490 | 492 | <?php |
  | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=2930921#L493) | […](/browser/wp-last-modified-info/trunk/inc/Api/Callbacks/ManagerCallbacks.php?rev=3137253#L495) |  |
  | 493 | 495 |  |
  | 494 | 496 | /\*\* |
  | 495 |  | \* Get avaialable template tags. |
  | 496 |  | \* |
  |  | 497 | \* Get available template tags. |
  |  | 498 | \* |
  |  | 499 | \* @param $tags |
  |  | 500 | \* @return string |
  | 497 | 501 | \* @since 1.8.0 |
  | 498 |  | ~~\* @return string~~ |
  | 499 | 502 | \*/ |
  | 500 |  | private function get\_available\_tags( $tags ) { |
  |  | 503 | private function get\_available\_tags( $tags ): string { |
  | 501 | 504 | $content = []; |
  | 502 | 505 | foreach ( $tags as $tag ) { |
* ## [wp-last-modified-info/trunk/inc/Base/AdminNotice.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Base/AdminNotice.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Base/AdminNotice.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L1 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Admin notices. |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L45) | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253#L45) |  |
  | 45 | 45 | unset( $\_GET['activate'] ); // phpcs:ignore |
  | 46 | 46 | } |
  | 47 |  | echo '<div class="error"><p>' . \_\_( 'Your version of PHP is below the minimum version of PHP required by WP Last Modified Info plugin. Please contact your host and request that your version be upgraded to 5.6 or later.', 'wp-last-modified-info' ) . '</p></div>'; |
  |  | 47 | echo '<div class="error"><p>' . esc\_html\_\_( 'Your version of PHP is below the minimum version of PHP required by WP Last Modified Info plugin. Please contact your host and request that your version be upgraded to 5.6 or later.', 'wp-last-modified-info' ) . '</p></div>'; |
  | 48 | 48 | return; |
  | 49 | 49 | } |
  | 50 |  |  |
  |  | 50 |  |
  | 51 | 51 | // Check transient, if available display notice |
  | 52 | 52 | if ( get\_transient( 'wplmi-show-notice-on-activation' ) !== false ) { ?> |
  | 53 | 53 | <div class="notice notice-success"> |
  | 54 |  | <p><strong><?php |
  |  | 54 | <p><strong><?php |
  | 55 | 55 | /\* translators: %s: 1. Plugin Name, 2. Version, 3. Link \*/ |
  | 56 |  | printf( \_\_( 'Thanks for installing %1$s v%2$s plugin. Click <a href="%3$s">here</a> to configure plugin settings.', 'wp-last-modified-info' ), 'WP Last Modified Info', esc\_html( $this->version ), esc\_url( admin\_url( 'options-general.php?page=wp-last-modified-info' ) ) ); ?></strong></p> |
  |  | 56 | printf( esc\_html\_\_( 'Thanks for installing %1$s v%2$s plugin. Click <a href="%3$s">here</a> to configure plugin settings.', 'wp-last-modified-info' ), 'WP Last Modified Info', esc\_html( $this->version ), esc\_url( admin\_url( 'options-general.php?page=wp-last-modified-info' ) ) ); ?></strong></p> |
  | 57 | 57 | </div> <?php |
  | 58 | 58 | delete\_transient( 'wplmi-show-notice-on-activation' ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L65) | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253#L65) |  |
  | 65 | 65 | $show\_rating = false; |
  | 66 | 66 | } |
  | 67 |  |  |
  |  | 67 |  |
  | 68 | 68 | if ( $show\_rating ) { |
  | 69 | 69 | $dismiss = wp\_nonce\_url( add\_query\_arg( 'wplmi\_notice\_action', 'dismiss\_rating' ), 'wplmi\_notice\_nonce' ); |
  | 70 | 70 | $no\_thanks = wp\_nonce\_url( add\_query\_arg( 'wplmi\_notice\_action', 'no\_thanks\_rating' ), 'wplmi\_notice\_nonce' ); ?> |
  | 71 |  |  |
  |  | 71 |  |
  | 72 | 72 | <div class="notice notice-success"> |
  | 73 |  | <p><?~~php echo~~ wp\_kses\_post( 'Hey, I noticed you\'ve been using WP Last Modified Info for more than 1 week – that’s awesome! Could you please do me a BIG favor and give it a <strong>5-star</strong> rating on WordPress? Just to help us spread the word and boost my motivation.', 'wp-last-modified-info' ); ?></p> |
  |  | 73 | <p><?= wp\_kses\_post( 'Hey, I noticed you\'ve been using WP Last Modified Info for more than 1 week – that’s awesome! Could you please do me a BIG favor and give it a <strong>5-star</strong> rating on WordPress? Just to help us spread the word and boost my motivation.', 'wp-last-modified-info' ); ?></p> |
  | 74 | 74 | <p><a href="https://wordpress.org/support/plugin/wp-last-modified-info/reviews/?filter=5#new-post" target="\_blank" class="button button-secondary" rel="noopener"><?php esc\_html\_e( 'Ok, you deserve it', 'wp-last-modified-info' ); ?></a>&nbsp; |
  | 75 |  | <a href="<?~~php echo~~ esc\_url( $dismiss ); ?>" class="already-did"><strong><?php esc\_html\_e( 'I already did', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  | 76 |  | <a href="<?~~php echo~~ esc\_url( $no\_thanks ); ?>" class="later"><strong><?php esc\_html\_e( 'Nope&#44; maybe later', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  | 77 |  | <a href="<?~~php echo~~ esc\_url( $dismiss ); ?>" class="hide"><strong><?php esc\_html\_e( 'I don\'t want to rate', 'wp-last-modified-info' ); ?></strong></a></p> |
  |  | 75 | <a href="<?= esc\_url( $dismiss ); ?>" class="already-did"><strong><?php esc\_html\_e( 'I already did', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  |  | 76 | <a href="<?= esc\_url( $no\_thanks ); ?>" class="later"><strong><?php esc\_html\_e( 'Nope&#44; maybe later', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  |  | 77 | <a href="<?= esc\_url( $dismiss ); ?>" class="hide"><strong><?php esc\_html\_e( 'I don\'t want to rate', 'wp-last-modified-info' ); ?></strong></a></p> |
  | 78 | 78 | </div> |
  | 79 | 79 | <?php |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L90) | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253#L90) |  |
  | 90 | 90 | $dismiss = wp\_nonce\_url( add\_query\_arg( 'wplmi\_notice\_action', 'dismiss\_donate' ), 'wplmi\_notice\_nonce' ); |
  | 91 | 91 | $no\_thanks = wp\_nonce\_url( add\_query\_arg( 'wplmi\_notice\_action', 'no\_thanks\_donate' ), 'wplmi\_notice\_nonce' ); ?> |
  | 92 |  |  |
  |  | 92 |  |
  | 93 | 93 | <div class="notice notice-success"> |
  | 94 |  | <p><?~~php echo~~ wp\_kses\_post( 'Hey, I noticed you\'ve been using WP Last Modified Info for more than 2 week – that’s awesome! If you like WP Last Modified Info and you are satisfied with the plugin, isn’t that worth a coffee or two? Please consider donating. Donations help me to continue support and development of this free plugin! Thank you very much!', 'wp-last-modified-info' ); ?></p> |
  |  | 94 | <p><?= wp\_kses\_post( 'Hey, I noticed you\'ve been using WP Last Modified Info for more than 2 week – that’s awesome! If you like WP Last Modified Info and you are satisfied with the plugin, isn’t that worth a coffee or two? Please consider donating. Donations help me to continue support and development of this free plugin! Thank you very much!', 'wp-last-modified-info' ); ?></p> |
  | 95 | 95 | <p><a href="https://www.paypal.me/iamsayan" target="\_blank" class="button button-secondary" rel="noopener"><?php esc\_html\_e( 'Donate Now', 'wp-last-modified-info' ); ?></a>&nbsp; |
  | 96 |  | <a href="<?~~php echo~~ esc\_url( $dismiss ); ?>" class="already-did"><strong><?php esc\_html\_e( 'I already donated', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  | 97 |  | <a href="<?~~php echo~~ esc\_url( $no\_thanks ); ?>" class="later"><strong><?php esc\_html\_e( 'Nope&#44; maybe later', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  | 98 |  | <a href="<?~~php echo~~ esc\_url( $dismiss ); ?>" class="hide"><strong><?php esc\_html\_e( 'I don\'t want to donate', 'wp-last-modified-info' ); ?></strong></a></p> |
  |  | 96 | <a href="<?= esc\_url( $dismiss ); ?>" class="already-did"><strong><?php esc\_html\_e( 'I already donated', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  |  | 97 | <a href="<?= esc\_url( $no\_thanks ); ?>" class="later"><strong><?php esc\_html\_e( 'Nope&#44; maybe later', 'wp-last-modified-info' ); ?></strong></a>&nbsp;<strong>|</strong> |
  |  | 98 | <a href="<?= esc\_url( $dismiss ); ?>" class="hide"><strong><?php esc\_html\_e( 'I don\'t want to donate', 'wp-last-modified-info' ); ?></strong></a></p> |
  | 99 | 99 | </div> |
  | 100 | 100 | <?php |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L120) | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253#L120) |  |
  | 120 | 120 | } |
  | 121 | 121 |  |
  | 122 |  | if ( ~~! isset( $\_REQUEST['wplmi\_notice\_action'] ) ||~~ empty( $\_REQUEST['wplmi\_notice\_action'] ) ) { |
  |  | 122 | if ( empty( $\_REQUEST['wplmi\_notice\_action'] ) ) { |
  | 123 | 123 | return; |
  | 124 | 124 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L126) | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253#L126) |  |
  | 126 | 126 | check\_admin\_referer( 'wplmi\_notice\_nonce' ); |
  | 127 | 127 |  |
  | 128 |  | $notice = sanitize\_text\_field( $\_REQUEST['wplmi\_notice\_action'] ); |
  |  | 128 | $notice = sanitize\_text\_field( $\_REQUEST['wplmi\_notice\_action'] ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.MissingUnslash |
  | 129 | 129 | $notice = explode( '\_', $notice ); |
  | 130 | 130 | $notice\_type = end( $notice ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L135) | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253#L135) |  |
  | 135 | 135 | update\_option( 'wplmi\_plugin\_dismiss\_' . $notice\_type . '\_notice', '1', false ); |
  | 136 | 136 | } |
  | 137 |  |  |
  |  | 137 |  |
  | 138 | 138 | if ( 'no\_thanks' === $notice\_action ) { |
  | 139 | 139 | update\_option( 'wplmi\_plugin\_no\_thanks\_' . $notice\_type . '\_notice', '1', false ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L145) | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253#L145) |  |
  | 145 | 145 | } |
  | 146 | 146 | } |
  | 147 |  |  |
  | 148 |  | wp\_redirect( remove\_query\_arg( [ 'wplmi\_notice\_action', '\_wpnonce' ] ) ); |
  |  | 147 |  |
  |  | 148 | wp\_safe\_redirect( remove\_query\_arg( [ 'wplmi\_notice\_action', '\_wpnonce' ] ) ); |
  | 149 | 149 | exit; |
  | 150 | 150 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3052359#L155) | […](/browser/wp-last-modified-info/trunk/inc/Base/AdminNotice.php?rev=3137253#L155) |  |
  | 155 | 155 | private function calculate\_time() { |
  | 156 | 156 | $installed\_time = get\_option( 'wplmi\_plugin\_installed\_time' ); |
  | 157 |  |  |
  |  | 157 |  |
  | 158 | 158 | if ( ! $installed\_time ) { |
  | 159 | 159 | $installed\_time = time(); |
  | 160 | 160 | update\_option( 'wplmi\_plugin\_installed\_time', $installed\_time, false ); |
  | 161 | 161 | } |
  | 162 |  |  |
  |  | 162 |  |
  | 163 | 163 | return $installed\_time; |
  | 164 | 164 | } |
* ## [wp-last-modified-info/trunk/inc/Base/Enqueue.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Base/Enqueue.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Base/Enqueue.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=2930921#L1 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Enqueue all css & js. |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=2930921#L22) | […](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=3137253#L22) |  |
  | 22 | 22 | class Enqueue extends BaseController |
  | 23 | 23 | { |
  | 24 |  | use Hooker, HelperFunctions; |
  |  | 24 | use Hooker; |
  |  | 25 | use HelperFunctions; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=2930921#L38) | […](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=3137253#L39) |  |
  | 38 | 39 |  |
  | 39 | 40 | if ( 'settings\_page\_wp-last-modified-info' === $hook ) { |
  | 40 |  |  |
  |  | 41 |  |
  | 41 | 42 | // enqueue required css |
  | 42 | 43 | wp\_enqueue\_style( 'wp-codemirror' ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=2930921#L46) | […](/browser/wp-last-modified-info/trunk/inc/Base/Enqueue.php?rev=3137253#L47) |  |
  | 46 | 47 | wp\_enqueue\_script( 'jquery-ui-resizable' ); |
  | 47 | 48 | wp\_enqueue\_script( 'wp-theme-plugin-editor' ); |
  | 48 |  |  |
  |  | 49 |  |
  | 49 | 50 | // load required css & js files. |
  | 50 | 51 | $this->load( 'css', 'admin', 'admin.min.css', $this->version ); |
  | 51 | 52 | $this->load( 'css', 'selectize', 'selectize.min.css', '0.15.2' ); |
  | 52 | 53 | $this->load( 'css', 'confirm', 'jquery-confirm.min.css', '3.3.4' ); |
  | 53 |  |  |
  |  | 54 |  |
  | 54 | 55 | $this->load( 'js', 'selectize', 'selectize.min.js', '0.15.2', [ 'jquery' ] ); |
  | 55 | 56 | $this->load( 'js', 'confirm', 'jquery-confirm.min.js', '3.3.4', [ 'jquery' ] ); |
  | 56 | 57 | $this->load( 'js', 'admin', 'admin.min.js', $this->version, [ 'jquery', 'jquery-form', 'jquery-ui-resizable', 'wplmi-confirm', 'wplmi-selectize' ] ); |
  | 57 |  |  |
  |  | 58 |  |
  | 58 | 59 | $args = [ |
  | 59 | 60 | 'ajaxurl'        => admin\_url( 'admin-ajax.php' ), |
* ## [wp-last-modified-info/trunk/inc/Base/PluginTools.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Base/PluginTools.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Base/PluginTools.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L1 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Plugin Tools. |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L22) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L22) |  |
  | 22 | 22 | class PluginTools |
  | 23 | 23 | { |
  | 24 |  | use Ajax, Hooker, HelperFunctions; |
  | 25 |  |  |
  |  | 24 | use Ajax; |
  |  | 25 | use Hooker; |
  |  | 26 | use HelperFunctions; |
  |  | 27 |  |
  | 26 | 28 | /\*\* |
  | 27 | 29 | \* Register functions. |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L36) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L38) |  |
  | 36 | 38 | $this->ajax( 'process\_delete\_plugin\_data', 'remove\_settings' ); |
  | 37 | 39 | } |
  | 38 |  |  |
  |  | 40 |  |
  | 39 | 41 | /\*\* |
  | 40 | 42 | \* Process a settings export that generates a .json file |
  | 41 | 43 | \*/ |
  | 42 | 44 | public function export\_settings() { |
  | 43 |  | if ( empty( $\_POST['wplmi\_export\_action'] ) || 'wplmi\_export\_settings' != $\_POST['wplmi\_export\_action'] ) { |
  |  | 45 | if ( empty( $\_POST['wplmi\_export\_action'] ) || 'wplmi\_export\_settings' !== $\_POST['wplmi\_export\_action'] ) { |
  | 44 | 46 | return; |
  | 45 | 47 | } |
  | 46 | 48 |  |
  | 47 |  | if ( ! ~~wp\_verify\_nonce( $\_POST['wplmi\_export\_nonce']~~, 'wplmi\_export\_nonce' ) ) { |
  |  | 49 | if ( ! isset( $\_POST['wplmi\_export\_nonce'] ) || ! wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_POST['wplmi\_export\_nonce'] ) ), 'wplmi\_export\_nonce' ) ) { |
  | 48 | 50 | return; |
  | 49 | 51 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L65) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L67) |  |
  | 65 | 67 | header( "Expires: 0" ); |
  | 66 | 68 |  |
  | 67 |  | echo json\_encode( $settings ); |
  |  | 69 | echo wp\_json\_encode( $settings ); |
  | 68 | 70 | exit; |
  | 69 | 71 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L73) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L75) |  |
  | 73 | 75 | \*/ |
  | 74 | 76 | public function import\_settings() { |
  | 75 |  | if ( empty( $\_POST['wplmi\_import\_action'] ) || 'wplmi\_import\_settings' != $\_POST['wplmi\_import\_action'] ) { |
  |  | 77 | if ( empty( $\_POST['wplmi\_import\_action'] ) || 'wplmi\_import\_settings' !== $\_POST['wplmi\_import\_action'] ) { |
  | 76 | 78 | return; |
  | 77 | 79 | } |
  | 78 | 80 |  |
  | 79 |  | if ( ! ~~wp\_verify\_nonce( $\_POST['wplmi\_import\_nonce']~~, 'wplmi\_import\_nonce' ) ) { |
  |  | 81 | if ( ! isset( $\_POST['wplmi\_import\_nonce'] ) || ! wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_POST['wplmi\_import\_nonce'] ) ), 'wplmi\_import\_nonce' ) ) { |
  | 80 | 82 | return; |
  | 81 | 83 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L85) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L87) |  |
  | 85 | 87 | } |
  | 86 | 88 |  |
  | 87 |  | $extension = explode( '.', sanitize\_text\_field( $\_FILES['import\_file']['name'] ) ); |
  |  | 89 | $extension = explode( '.', sanitize\_text\_field( $\_FILES['import\_file']['name'] ) ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  | 88 | 90 | $file\_extension = end( $extension ); |
  | 89 | 91 | if ( 'json' !== $file\_extension ) { |
  | 90 |  | wp\_die( \_\_( '<strong>Settings import failed:</strong> Please upload a valid .json file to import settings in this website.', 'wp-last-modified-info' ) ); |
  |  | 92 | wp\_die( sprintf( '<strong>%s</strong>: %s', |
  |  | 93 | esc\_html\_\_( 'Settings import failed', 'wp-last-modified-info' ), |
  |  | 94 | esc\_html\_\_( 'Please upload a valid .json file to import settings in this website.', 'wp-last-modified-info' ) |
  |  | 95 | ) ); |
  | 91 | 96 | } |
  | 92 | 97 |  |
  | 93 |  | $import\_file = sanitize\_text\_field( $\_FILES['import\_file']['tmp\_name'] ); |
  |  | 98 | $import\_file = sanitize\_text\_field( $\_FILES['import\_file']['tmp\_name'] ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  | 94 | 99 | if ( empty( $import\_file ) ) { |
  | 95 |  | wp\_die( \_\_( '<strong>Settings import failed:</strong> Please upload a file to import.', 'wp-last-modified-info' ) ); |
  |  | 100 | wp\_die( sprintf( '<strong>%s</strong>: %s', |
  |  | 101 | esc\_html\_\_( 'Settings import failed', 'wp-last-modified-info' ), |
  |  | 102 | esc\_html\_\_( 'Please upload a file to import.', 'wp-last-modified-info' ) |
  |  | 103 | ) ); |
  | 96 | 104 | } |
  | 97 | 105 |  |
  | 98 | 106 | // Retrieve the settings from the file and convert the json object to an array. |
  | 99 |  | $settings = (array) json\_decode( file\_get\_contents( $import\_file ) ); |
  |  | 107 | $settings = (array) json\_decode( file\_get\_contents( $import\_file ) ); // phpcs:ignore WordPress.WP.AlternativeFunctions.file\_get\_contents\_file\_get\_contents |
  | 100 | 108 | update\_option( 'lmt\_plugin\_global\_settings', $settings, false ); |
  | 101 | 109 |  |
  | 102 | 110 | // set temporary transient for admin notice |
  | 103 | 111 | set\_transient( 'wplmi\_import\_db\_done', true ); |
  | 104 |  |  |
  |  | 112 |  |
  | 105 | 113 | wp\_safe\_redirect( add\_query\_arg( 'page', 'wp-last-modified-info', admin\_url( 'options-general.php' ) ) ); |
  | 106 | 114 | exit; |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L114) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L122) |  |
  | 114 | 122 | $this->verify\_nonce(); |
  | 115 | 123 |  |
  | 116 |  | if ( ! isset( $\_POST['action\_type'] ) ) { |
  |  | 124 | if ( ! isset( $\_POST['action\_type'] ) ) { // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 117 | 125 | $this->error(); |
  | 118 | 126 | } |
  | 119 | 127 |  |
  | 120 |  | $action = sanitize\_text\_field( wp\_unslash( $\_POST['action\_type'] ) ); |
  |  | 128 | $action = sanitize\_text\_field( wp\_unslash( $\_POST['action\_type'] ) ); // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 121 | 129 | $value = ( $action == 'check' ) ? 'yes' : 'no'; |
  | 122 | 130 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L127) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L135) |  |
  | 127 | 135 | 'fields'      => 'ids', |
  | 128 | 136 | ]; |
  | 129 |  |  |
  |  | 137 |  |
  | 130 | 138 | $posts = get\_posts( $args ); |
  | 131 | 139 | if ( ! empty( $posts ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L134) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L142) |  |
  | 134 | 142 | } |
  | 135 | 143 | } |
  | 136 |  |  |
  |  | 144 |  |
  | 137 | 145 | $this->success( [ |
  | 138 | 146 | 'reload' => false, |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L148) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L156) |  |
  | 148 | 156 |  |
  | 149 | 157 | $option = get\_option( 'lmt\_plugin\_global\_settings' ); |
  | 150 |  |  |
  |  | 158 |  |
  | 151 | 159 | $this->success( [ |
  | 152 |  | 'elements' => json\_encode( $option ), |
  |  | 160 | 'elements' => wp\_json\_encode( $option ), |
  | 153 | 161 | ] ); |
  | 154 | 162 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L169) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L177) |  |
  | 169 | 177 | } |
  | 170 | 178 |  |
  | 171 |  | $data = wp\_unslash( $\_REQUEST['settings\_data'] ); |
  |  | 179 | $data = wp\_unslash( $\_REQUEST['settings\_data'] ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized |
  | 172 | 180 | $settings = (array) json\_decode( $data ); |
  | 173 | 181 |  |
  | 174 | 182 | if ( is\_array( $settings ) && ! empty( $settings ) ) { |
  | 175 | 183 | update\_option( 'lmt\_plugin\_global\_settings', $settings, false ); |
  | 176 |  |  |
  |  | 184 |  |
  | 177 | 185 | // set temporary transient for admin notice |
  | 178 | 186 | set\_transient( 'wplmi\_import\_db\_done', true ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L188) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L196) |  |
  | 188 | 196 | // security check |
  | 189 | 197 | $this->verify\_nonce(); |
  | 190 |  |  |
  |  | 198 |  |
  | 191 | 199 | // Remove options |
  | 192 | 200 | delete\_option( 'lmt\_plugin\_global\_settings' ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3052359#L212) | […](/browser/wp-last-modified-info/trunk/inc/Base/PluginTools.php?rev=3137253#L220) |  |
  | 212 | 220 | public function admin\_notice() { |
  | 213 | 221 | if ( get\_transient( 'wplmi\_import\_db\_done' ) !== false ) { ?> |
  | 214 |  | <div class="notice notice-success is-dismissible"><p><strong><?php esc\_html\_e( 'Success! Plugin Settings has been imported successfully.', 'wp-last-modified-info' ); ?></strong></p></div><?php |
  |  | 222 | <div class="notice notice-success is-dismissible"><p><strong><?php esc\_html\_e( 'Success! Plugin Settings has been imported successfully.', 'wp-last-modified-info' ); ?></strong></p></div><?php |
  | 215 | 223 | delete\_transient( 'wplmi\_import\_db\_done' ); |
  | 216 | 224 | } |
* ## [wp-last-modified-info/trunk/inc/Core/AdminBar.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/AdminBar.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/AdminBar.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class AdminBar |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L32) | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=3137253#L33) |  |
  | 32 | 33 | /\*\* |
  | 33 | 34 | \* Show original publish info. |
  | 34 |  | \* |
  |  | 35 | \* |
  | 35 | 36 | \* @param string  $content  Original Content |
  | 36 |  | \* |
  |  | 37 | \* |
  | 37 | 38 | \* @return string $content  Filtered Content |
  | 38 | 39 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L52) | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=3137253#L53) |  |
  | 52 | 53 | return; |
  | 53 | 54 | } |
  | 54 |  |  |
  |  | 55 |  |
  | 55 | 56 | if ( 'auto-draft' === get\_post\_status() ) { |
  | 56 | 57 | return; |
  | 57 | 58 | } |
  | 58 |  |  |
  |  | 59 |  |
  | 59 | 60 | $object = get\_post\_type\_object( get\_post\_type() ); |
  | 60 | 61 | $args = array( |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L69) | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=3137253#L70) |  |
  | 69 | 70 | ), |
  | 70 | 71 | ); |
  | 71 |  |  |
  |  | 72 |  |
  | 72 | 73 | $wp\_admin\_bar->add\_node( $args ); |
  | 73 | 74 | } |
  | 74 |  |  |
  |  | 75 |  |
  | 75 | 76 | /\*\* |
  | 76 | 77 | \* Generate title to show on admin bar |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L81) | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=3137253#L82) |  |
  | 81 | 82 | $mod\_time = $this->get\_modified\_date( 'U' ); |
  | 82 | 83 | $org\_time = get\_post\_time( 'U', false, get\_the\_ID(), true ); |
  | 83 |  |  |
  |  | 84 |  |
  | 84 | 85 | if ( $mod\_time > $cur\_time || $org\_time > $mod\_time ) { |
  | 85 | 86 | /\* translators: %s: date time info \*/ |
  | 86 | 87 | return sprintf( \_\_( 'Updated on %1$s at %2$s', 'wp-last-modified-info' ), $this->get\_modified\_date( 'M j' ), $this->get\_modified\_date( get\_option( 'time\_format' ) ) ); |
  | 87 | 88 | } |
  | 88 |  |  |
  |  | 89 |  |
  | 89 | 90 | /\* translators: %s: time diff \*/ |
  | 90 | 91 | return sprintf( \_\_( 'Updated %s ago', 'wp-last-modified-info' ), human\_time\_diff( $this->get\_modified\_date( 'U' ), $cur\_time ) ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=2930921#L100) | […](/browser/wp-last-modified-info/trunk/inc/Core/AdminBar.php?rev=3137253#L101) |  |
  | 100 | 101 | return; |
  | 101 | 102 | } |
  | 102 |  |  |
  |  | 103 |  |
  | 103 | 104 | // If user can't edit post, then don't show |
  | 104 | 105 | if ( ! current\_user\_can( 'edit\_post', $post->ID ) ) { |
  | 105 | 106 | return; |
  | 106 | 107 | } |
  | 107 |  |  |
  |  | 108 |  |
  | 108 | 109 | $revision = wp\_get\_post\_revisions( $post->ID ); |
  | 109 | 110 | $latest\_revision = array\_shift( $revision ); |
  | 110 | 111 | $url = ''; |
  | 111 |  |  |
  |  | 112 |  |
  | 112 | 113 | if ( wp\_revisions\_enabled( $post ) && count( $revision ) >= 1 ) { |
  | 113 | 114 | $url = get\_admin\_url() . 'revision.php?revision=' . $latest\_revision->ID; |
  | 114 | 115 | } |
  | 115 |  |  |
  |  | 116 |  |
  | 116 | 117 | return $url; |
  | 117 | 118 | } |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class AdminColumn |
  | 22 | 22 | { |
  | 23 |  | use Hooker, SettingsData; |
  |  | 23 | use Hooker; |
  |  | 24 | use SettingsData; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L47) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=3137253#L48) |  |
  | 47 | 48 | } |
  | 48 | 49 | } |
  | 49 |  |  |
  |  | 50 |  |
  | 50 | 51 | /\*\* |
  | 51 | 52 | \* Generate column data. |
  | 52 |  | \* |
  |  | 53 | \* |
  | 53 | 54 | \* @param string   $column   Column name |
  | 54 | 55 | \* @param int      $post\_id  Post ID |
  | 55 |  | \* |
  |  | 56 | \* |
  | 56 | 57 | \* @return string  $time |
  | 57 | 58 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L67) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=3137253#L68) |  |
  | 67 | 68 | $mod\_format = date( 'M d, Y H:i:s', strtotime( $m\_orig ) ); |
  | 68 | 69 | $disabled = ( ! empty( $p\_meta ) ) ? $p\_meta : 'no'; |
  | 69 |  |  |
  |  | 70 |  |
  | 70 | 71 | $html = $modified; |
  | 71 | 72 | if ( get\_the\_modified\_author() ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L82) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=3137253#L83) |  |
  | 82 | 83 | } |
  | 83 | 84 | $html .= '<span class="wplmi-hidden-status" style="display: none;">' . esc\_html( $post->post\_status ) . '</span>'; |
  | 84 |  |  |
  | 85 |  | echo $html; |
  |  | 85 |  |
  |  | 86 | echo $html; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 86 | 87 | } |
  | 87 | 88 | } |
  | 88 |  |  |
  |  | 89 |  |
  | 89 | 90 | /\*\* |
  | 90 | 91 | \* Column title. |
  | 91 |  | \* |
  |  | 92 | \* |
  | 92 | 93 | \* @param string   $column  Column name |
  | 93 | 94 | \* @return string  $column  Filtered column |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L95) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=3137253#L96) |  |
  | 95 | 96 | public function column\_title( $column ) { |
  | 96 | 97 | $column['lastmodified'] = \_\_( 'Last Modified', 'wp-last-modified-info' ); |
  | 97 |  |  |
  |  | 98 |  |
  | 98 | 99 | return $column; |
  | 99 | 100 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=2930921#L101) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/AdminColumn.php?rev=3137253#L102) |  |
  | 101 | 102 | /\*\* |
  | 102 | 103 | \* Make Column sortable. |
  | 103 |  | \* |
  |  | 104 | \* |
  | 104 | 105 | \* @param string   $column  Column name |
  | 105 | 106 | \* @return array   $column  Filtered column |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L1 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Admin notices. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L22) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3137253#L22) |  |
  | 22 | 22 | class BlockEditor extends BaseController |
  | 23 | 23 | { |
  | 24 |  | use Hooker, HelperFunctions; |
  | 25 |  |  |
  |  | 24 | use Hooker; |
  |  | 25 | use HelperFunctions; |
  |  | 26 |  |
  | 26 | 27 | /\*\* |
  | 27 | 28 | \* Register functions. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L31) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3137253#L32) |  |
  | 31 | 32 | $this->action( 'init', 'register\_meta' ); |
  | 32 | 33 | $this->action( 'enqueue\_block\_editor\_assets', 'assets' ); |
  | 33 |  |  |
  |  | 34 |  |
  | 34 | 35 | // AIOSEO Integration |
  | 35 | 36 | $this->action( 'init', 'filter\_aioseo' ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L38) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3137253#L39) |  |
  | 38 | 39 | /\*\* |
  | 39 | 40 | \* Add support for `custom-fields` for all posts. |
  | 40 |  | \* |
  |  | 41 | \* |
  | 41 | 42 | \* @param array  $args      Post type data |
  | 42 | 43 | \* @param string $post\_type Post type name |
  | 43 |  | \* |
  |  | 44 | \* |
  | 44 | 45 | \* @return array $args Post type data |
  | 45 | 46 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L50) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3137253#L51) |  |
  | 50 | 51 |  |
  | 51 | 52 | if ( ! empty( $args['show\_in\_rest'] ) && ! post\_type\_supports( $post\_type, 'custom-fields' ) ) { |
  |  | 53 | if ( ! isset( $args['supports'] ) ) { |
  |  | 54 | $args['supports'] = []; |
  |  | 55 | } |
  | 52 | 56 | $args['supports'][] = 'custom-fields'; |
  | 53 | 57 | } |
  | 54 |  |  |
  |  | 58 |  |
  | 55 | 59 | return $this->do\_filter( 'post\_type\_args', $args, $post\_type ); |
  | 56 | 60 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L60) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3137253#L64) |  |
  | 60 | 64 | \*/ |
  | 61 | 65 | public function register\_meta() { |
  | 62 |  | register\_meta( |
  |  | 66 | register\_meta( |
  | 63 | 67 | 'post', |
  | 64 | 68 | '\_lmt\_disableupdate', |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L71) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3137253#L75) |  |
  | 71 | 75 | return current\_user\_can( 'edit\_posts' ); |
  | 72 | 76 | }, |
  | 73 |  | ] |
  |  | 77 | ] |
  | 74 | 78 | ); |
  | 75 | 79 |  |
  | 76 |  | register\_meta( |
  |  | 80 | register\_meta( |
  | 77 | 81 | 'post', |
  | 78 | 82 | '\_lmt\_disable', |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3052359#L111) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/BlockEditor.php?rev=3137253#L115) |  |
  | 111 | 115 | $prepared\_post->wplmi\_modified\_rest = $params['modified']; |
  | 112 | 116 | } |
  | 113 |  |  |
  |  | 117 |  |
  | 114 | 118 | if ( isset( $params['meta']['\_lmt\_disableupdate'] ) ) { |
  | 115 | 119 | $prepared\_post->wplmi\_lockmodifiedupdate = $params['meta']['\_lmt\_disableupdate']; |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L22 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class DashboardWidget |
  | 23 | 23 | { |
  | 24 |  | use HelperFunctions, Hooker; |
  |  | 24 | use HelperFunctions; |
  |  | 25 | use Hooker; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L37) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3137253#L38) |  |
  | 37 | 38 | public function dashboard\_widget() { |
  | 38 | 39 | global $wp\_meta\_boxes; |
  | 39 |  |  |
  |  | 40 |  |
  | 40 | 41 | \wp\_add\_dashboard\_widget( |
  | 41 | 42 | 'dashboard\_last\_modified\_posts', // Widget slug. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L79) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3137253#L80) |  |
  | 79 | 80 | while ( $posts->have\_posts() ) { |
  | 80 | 81 | $posts->the\_post(); |
  | 81 |  |  |
  |  | 82 |  |
  | 82 | 83 | $modified\_timestamp = get\_post\_modified\_time( 'U' ); |
  | 83 | 84 | if ( gmdate( 'Y-m-d', $modified\_timestamp ) == $today ) { |
  | 84 |  | $relative = \_\_( 'Today' ); |
  |  | 85 | $relative = \_\_( 'Today', 'wp-last-modified-info' ); |
  | 85 | 86 | } elseif ( gmdate( 'Y-m-d', $modified\_timestamp ) == $tomorrow ) { |
  | 86 |  | $relative = \_\_( 'Tomorrow' ); |
  |  | 87 | $relative = \_\_( 'Tomorrow', 'wp-last-modified-info' ); |
  | 87 | 88 | } elseif ( gmdate( 'Y', $modified\_timestamp ) !== gmdate( 'Y', $timestamp ) ) { |
  | 88 | 89 | /\* translators: Date and time format for recent posts on the dashboard, from a different calendar year, see https://www.php.net/date \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L92) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3137253#L93) |  |
  | 92 | 93 | $relative = date\_i18n( 'M jS', $modified\_timestamp ); |
  | 93 | 94 | } |
  | 94 |  |  |
  |  | 95 |  |
  | 95 | 96 | // Use the post edit link for those who can edit, the permalink otherwise. |
  | 96 | 97 | $recent\_post\_link = current\_user\_can( 'edit\_post', get\_the\_ID() ) ? get\_edit\_post\_link() : get\_permalink(); |
  | 97 |  |  |
  |  | 98 |  |
  | 98 | 99 | $draft\_or\_post\_title = \_draft\_or\_post\_title(); |
  | 99 | 100 | printf( |
  | 100 | 101 | '<li><span>%1$s</span> <a href="%2$s" aria-label="%3$s">%4$s</a></li>', |
  | 101 | 102 | /\* translators: 1: Relative date, 2: Time. \*/ |
  | 102 |  | sprintf( ~~\_x( '%1$s, %2$s', 'dashboard' ), $relative, date\_i18n( get\_option( 'time\_format' ), $modified\_timestamp~~ ) ), |
  | 103 |  | ~~$recent\_post\_link~~, |
  |  | 103 | sprintf( esc\_html\_x( '%1$s, %2$s', 'dashboard', 'wp-last-modified-info' ), esc\_html( $relative ), esc\_html( date\_i18n( get\_option( 'time\_format' ), $modified\_timestamp ) ) ), |
  |  | 104 | esc\_url( $recent\_post\_link ), |
  | 104 | 105 | /\* translators: %s: Post title. \*/ |
  | 105 |  | esc\_attr( sprintf( ~~\_\_( 'Edit &#8220;%s&#8221;' ), $draft\_or\_post\_title ) ),~~ |
  | 106 |  | $draft\_or\_post\_title |
  |  | 106 | esc\_attr( sprintf( esc\_html\_\_( 'Edit &#8220;%s&#8221;', 'wp-last-modified-info' ), $draft\_or\_post\_title ) ), // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 107 | $draft\_or\_post\_title // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 107 | 108 | ); |
  | 108 | 109 | } |
  | 109 |  |  |
  |  | 110 |  |
  | 110 | 111 | echo '</ul>'; |
  | 111 | 112 | echo '</div>'; |
  | 112 |  |  |
  |  | 113 |  |
  | 113 | 114 | } else { |
  | 114 | 115 |  |
  | 115 | 116 | echo '<div class="no-activity">'; |
  | 116 | 117 | echo '<p class="smiley" aria-hidden="true"></p>'; |
  | 117 |  | echo '<p>' . ~~\_\_( 'No modified posts yet!~~' ) . '</p>'; |
  |  | 118 | echo '<p>' . esc\_html\_\_( 'No modified posts yet!', 'wp-last-modified-info' ) . '</p>'; |
  | 118 | 119 | echo '</div>'; |
  | 119 |  |  |
  |  | 120 |  |
  | 120 | 121 | } |
  | 121 | 122 | wp\_reset\_postdata(); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L129) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3137253#L130) |  |
  | 129 | 130 | public function widget\_control\_callback() { |
  | 130 | 131 | // Update widget options |
  | 131 |  | if ( 'POST' === $\_SERVER['REQUEST\_METHOD'] && isset( $\_POST['wplmi\_widget\_options'] ) ) { |
  | 132 |  | check\_admin\_referer(); |
  |  | 132 | if ( 'POST' === $\_SERVER['REQUEST\_METHOD'] && isset( $\_POST['wplmi\_widget\_options'] ) ) { // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 133 | check\_admin\_referer( 'wplmi-dashboard-widget' ); |
  | 133 | 134 | update\_option( 'lmt\_dashboard\_widget\_options', array\_map( 'intval', $\_POST['wplmi\_widget\_options'] ), false ); |
  | 134 |  | } |
  |  | 135 | } |
  | 135 | 136 |  |
  | 136 | 137 | // Get widget options |
  | 137 | 138 | $widget\_options = get\_option( 'lmt\_dashboard\_widget\_options' ); |
  | 138 | 139 | $value = isset( $widget\_options['number'] ) ? $widget\_options['number'] : ''; |
  | 139 |  |  |
  | 140 |  | wp\_nonce\_field(); ?> |
  |  | 140 |  |
  |  | 141 | wp\_nonce\_field( 'wplmi-dashboard-widget' ); ?> |
  | 141 | 142 | <table> |
  | 142 | 143 | <tr> |
  | 143 | 144 | <td><label for="post-count"><strong><?php esc\_html\_e( 'Number of Posts to Display', 'wp-last-modified-info' ); ?>:</strong></label></td> |
  | 144 |  | <td><input class="widefat" id="post-count" name="wplmi\_widget\_options[number]" type="number" placeholder="5" min="3" max="100" value="<?~~php echo~~ esc\_attr( $value ); ?>" /></td> |
  |  | 145 | <td><input class="widefat" id="post-count" name="wplmi\_widget\_options[number]" type="number" placeholder="5" min="3" max="100" value="<?= esc\_attr( $value ); ?>" /></td> |
  | 145 | 146 | </tr> |
  | 146 | 147 | </table> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3052359#L170) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/DashboardWidget.php?rev=3137253#L171) |  |
  | 170 | 171 | padding-bottom: 0; |
  | 171 | 172 | } |
  | 172 |  |  |
  |  | 173 |  |
  | 173 | 174 | #dashboard\_last\_modified\_posts .dashboard-widget-control-form { |
  | 174 | 175 | padding-top: 12px; |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L22 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class EditScreen |
  | 23 | 23 | { |
  | 24 |  | use Ajax, Hooker, SettingsData; |
  |  | 24 | use Ajax; |
  |  | 25 | use Hooker; |
  |  | 26 | use SettingsData; |
  | 25 | 27 |  |
  | 26 | 28 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L34) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L36) |  |
  | 34 | 36 | $this->filter( 'wp\_insert\_post\_data', 'update\_data', 9999, 2 ); |
  | 35 | 37 | } |
  | 36 |  |  |
  |  | 38 |  |
  | 37 | 39 | /\*\* |
  | 38 | 40 | \* Post Submit Box HTML output. |
  | 39 |  | \* |
  |  | 41 | \* |
  | 40 | 42 | \* @param string $post WP Post |
  | 41 | 43 | \*/ |
  | 42 | 44 | public function submitbox\_edit( $post ) { |
  | 43 | 45 | global $wp\_locale; |
  | 44 |  |  |
  |  | 46 |  |
  | 45 | 47 | if ( in\_array( $post->post\_status, [ 'auto-draft', 'future' ] ) ) { |
  | 46 | 48 | return; |
  | 47 | 49 | } |
  | 48 |  |  |
  |  | 50 |  |
  | 49 | 51 | $datemodified = $post->post\_modified; |
  | 50 |  |  |
  |  | 52 |  |
  | 51 | 53 | $jj = mysql2date( 'd', $datemodified, false ); |
  | 52 | 54 | $mm = mysql2date( 'm', $datemodified, false ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L55) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L57) |  |
  | 55 | 57 | $mn = mysql2date( 'i', $datemodified, false ); |
  | 56 | 58 | $ss = mysql2date( 's', $datemodified, false ); |
  | 57 |  |  |
  |  | 59 |  |
  | 58 | 60 | $stop\_update = $this->get\_meta( $post->ID, '\_lmt\_disableupdate' ); |
  | 59 | 61 | $post\_types = get\_post\_type\_object( $post->post\_type ); |
  | 60 |  |  |
  |  | 62 |  |
  | 61 | 63 | // get modified time with a particular format |
  | 62 | 64 | $orig\_time = get\_post\_time( 'U', false, $post ); |
  | 63 | 65 | $mod\_time = get\_post\_modified\_time( 'U', false, $post ); ?> |
  | 64 |  |  |
  |  | 66 |  |
  | 65 | 67 | <div class="misc-pub-section curtime misc-pub-last-updated"> |
  | 66 |  | <span id="wplmi-timestamp"> <?php esc\_html\_e( 'Updated on:', 'wp-last-modified-info' ) ?> <strong><?~~php echo get\_the\_modified\_time( 'M j, Y \a\t H:i'~~ ); ?></strong></span> |
  |  | 68 | <span id="wplmi-timestamp"> <?php esc\_html\_e( 'Updated on:', 'wp-last-modified-info' ) ?> <strong><?= esc\_html( get\_the\_modified\_time( 'M j, Y \a\t H:i' ) ); ?></strong></span> |
  | 67 | 69 | <a href="#edit\_timestampmodified" class="edit-timestampmodified hide-if-no-js" role="button"><span aria-hidden="true"><?php esc\_html\_e( 'Edit', 'wp-last-modified-info' ); ?></span> <span class="screen-reader-text"><?php esc\_html\_e( 'Edit modified date and time', 'wp-last-modified-info' ); ?></span></a> |
  | 68 | 70 | <fieldset id="timestampmodifieddiv" class="hide-if-js" data-prefix="<?php esc\_attr\_e( 'Updated on:', 'wp-last-modified-info' ); ?>" data-separator="<?php esc\_attr\_e( 'at', 'wp-last-modified-info' ); ?>" style="padding-top: 5px;line-height: 1.76923076;"> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L76) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L78) |  |
  | 76 | 78 | $monthnum = zeroise( $i, 2 ); |
  | 77 | 79 | $monthtext = $wp\_locale->get\_month\_abbrev( $wp\_locale->get\_month( $i ) ); |
  | 78 |  | echo '<option value="' . ~~$monthnum . '" data-text="' . $monthtext . '" ' . selected( $monthnum, $mm, false ).'>' . sprintf( \_\_( '%1$s-%2$s' ), $monthnum, $monthtext~~ ) . '</option>'; |
  |  | 80 | echo '<option value="' . esc\_attr( $monthnum ) . '" data-text="' . esc\_attr( $monthtext ) . '" ' . selected( $monthnum, $mm, false ).'>' . sprintf( '%1$s-%2$s', esc\_html( $monthnum ), esc\_html( $monthtext ) ) . '</option>'; |
  | 79 | 81 | } |
  | 80 | 82 | ?> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L83) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L85) |  |
  | 83 | 85 | <label> |
  | 84 | 86 | <span class="screen-reader-text"><?php esc\_html\_e( 'Day', 'wp-last-modified-info' ); ?></span> |
  | 85 |  | <input type="text" id="jjm" class="time-modified jjm-edit" name="jjm" value="<?~~php echo $jj~~; ?>" size="2" maxlength="2" autocomplete="off" /> |
  |  | 87 | <input type="text" id="jjm" class="time-modified jjm-edit" name="jjm" value="<?= esc\_attr( $jj ); ?>" size="2" maxlength="2" autocomplete="off" /> |
  | 86 | 88 | </label>, <label> |
  | 87 | 89 | <span class="screen-reader-text"><?php esc\_html\_e( 'Year', 'wp-last-modified-info' ); ?></span> |
  | 88 |  | <input type="text" id="aam" class="time-modified aam-edit" name="aam" value="<?~~php echo $aa~~; ?>" size="4" maxlength="4" autocomplete="off" /> |
  | 89 |  | </label> <?php esc\_html\_e( 'at', 'wp-last-modified-info' ); ?><label> |
  |  | 90 | <input type="text" id="aam" class="time-modified aam-edit" name="aam" value="<?= esc\_attr( $aa ); ?>" size="4" maxlength="4" autocomplete="off" /> |
  |  | 91 | </label> <?php esc\_html\_e( 'at', 'wp-last-modified-info' ); ?><label> |
  | 90 | 92 | <span class="screen-reader-text"><?php esc\_html\_e( 'Hour', 'wp-last-modified-info'); ?></span> |
  | 91 |  | <input type="text" id="hhm" class="time-modified hhm-edit" name="hhm" value="<?~~php echo $hh~~; ?>" size="2" maxlength="2" autocomplete="off"/> |
  |  | 93 | <input type="text" id="hhm" class="time-modified hhm-edit" name="hhm" value="<?= esc\_attr( $hh ); ?>" size="2" maxlength="2" autocomplete="off"/> |
  | 92 | 94 | </label><?php esc\_html\_e(':', 'wp-last-modified-info'); ?><label> |
  | 93 | 95 | <span class="screen-reader-text"><?php esc\_html\_e( 'Minute', 'wp-last-modified-info' ); ?></span> |
  | 94 |  | <input type="text" id="mnm" class="time-modified mnm-edit" name="mnm" value="<?~~php echo $mn~~; ?>" size="2" maxlength="2" autocomplete="off" /> |
  |  | 96 | <input type="text" id="mnm" class="time-modified mnm-edit" name="mnm" value="<?= esc\_attr( $mn ); ?>" size="2" maxlength="2" autocomplete="off" /> |
  | 95 | 97 | </label> |
  | 96 | 98 | </div> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L106) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L108) |  |
  | 106 | 108 | $hh\_current = gmdate( 'H', $currentlocal ); |
  | 107 | 109 | $mn\_current = gmdate( 'i', $currentlocal ); |
  | 108 |  |  |
  |  | 110 |  |
  | 109 | 111 | $vals = [ |
  | 110 | 112 | 'mmm' => [ $mm, $mm\_current ], |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L114) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L116) |  |
  | 114 | 116 | 'mnm' => [ $mn, $mn\_current ], |
  | 115 | 117 | ]; |
  | 116 |  |  |
  |  | 118 |  |
  | 117 | 119 | foreach ( $vals as $key => $val ) { |
  | 118 |  | echo '<input type="hidden" id="hidden\_' . ~~$key . '" name="hidden\_' . $key . '" value="' . $val[0]~~ . '">'; |
  | 119 |  | echo '<input type="hidden" id="cur\_' . ~~$key . '" name="cur\_' . $key . '" value="' . $val[1]~~ . '">'; |
  |  | 120 | echo '<input type="hidden" id="hidden\_' . esc\_attr( $key ). '" name="hidden\_' . esc\_attr( $key ) . '" value="' . esc\_attr( $val[0] ). '">'; |
  |  | 121 | echo '<input type="hidden" id="cur\_' . esc\_attr( $key ) . '" name="cur\_' . esc\_attr( $key ) . '" value="' . esc\_attr( $val[1] ) . '">'; |
  | 120 | 122 | } ?> |
  | 121 |  |  |
  | 122 |  | <input type="hidden" id="ssm" name="ssm" value="<?~~php echo $ss~~; ?>"> |
  |  | 123 |  |
  |  | 124 | <input type="hidden" id="ssm" name="ssm" value="<?= esc\_attr( $ss ); ?>"> |
  | 123 | 125 | <input type="hidden" id="wplmi-change-modified" name="wplmi\_change" value="no"> |
  | 124 |  | <input type="hidden" id="wplmi-disable-hidden" name="wplmi\_disable" value="<?~~php echo ( $stop\_update ) ? $stop\_update~~ : 'no'; ?>"> |
  | 125 |  | <input type="hidden" id="wplmi-post-modified" name="wplmi\_modified" value="<?~~php echo $datemodified~~; ?>"> |
  | 126 |  |  |
  |  | 126 | <input type="hidden" id="wplmi-disable-hidden" name="wplmi\_disable" value="<?= ( $stop\_update ) ? esc\_attr( $stop\_update ) : 'no'; ?>"> |
  |  | 127 | <input type="hidden" id="wplmi-post-modified" name="wplmi\_modified" value="<?= esc\_attr( $datemodified ); ?>"> |
  |  | 128 |  |
  | 127 | 129 | <p id="wplmi-meta" class="wplmi-meta-options"> |
  | 128 |  | <a href="#edit\_timestampmodified" class="save-timestamp hide-if-no-js button"><?php esc\_html\_e( 'OK', 'wp-last-modified-info~~'~~); ?></a> |
  |  | 130 | <a href="#edit\_timestampmodified" class="save-timestamp hide-if-no-js button"><?php esc\_html\_e( 'OK', 'wp-last-modified-info' ); ?></a> |
  | 129 | 131 | <a href="#edit\_timestampmodified" class="cancel-timestamp hide-if-no-js button-cancel"><?php esc\_html\_e( 'Cancel', 'wp-last-modified-info' ); ?></a>&nbsp;&nbsp;&nbsp; |
  | 130 | 132 | </p> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L135) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L137) |  |
  | 135 | 137 | /\*\* |
  | 136 | 138 | \* Quick edit HTML output. |
  | 137 |  | \* |
  |  | 139 | \* |
  | 138 | 140 | \* @param string  $column\_name  Current column name |
  | 139 | 141 | \* @param string  $post\_type    Post type |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L156) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L158) |  |
  | 156 | 158 | $monthnum = zeroise( $i, 2 ); |
  | 157 | 159 | $monthtext = $wp\_locale->get\_month\_abbrev( $wp\_locale->get\_month( $i ) ); |
  | 158 |  | echo '<option value="' . ~~$monthnum . '" data-text="' . $monthtext . '">' . sprintf( \_\_( '%1$s-%2$s' ), $monthnum, $monthtext~~ ) . '</option>'; |
  |  | 160 | echo '<option value="' . esc\_attr( $monthnum ) . '" data-text="' . esc\_attr( $monthtext ) . '">' . sprintf( '%1$s-%2$s', esc\_html( $monthnum ), esc\_html( $monthtext ) ) . '</option>'; |
  | 159 | 161 | } |
  | 160 | 162 | ?> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L188) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L190) |  |
  | 188 | 190 | /\*\* |
  | 189 | 191 | \* Quick ecit HTML output. |
  | 190 |  | \* |
  |  | 192 | \* |
  | 191 | 193 | \* @param string  $column\_name  Current column name |
  | 192 | 194 | \* @param string  $post\_type    Post type |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L211) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L213) |  |
  | 211 | 213 | $monthnum = zeroise( $i, 2 ); |
  | 212 | 214 | $monthtext = $wp\_locale->get\_month\_abbrev( $wp\_locale->get\_month( $i ) ); |
  | 213 |  | echo '<option value="' . ~~$monthnum . '" data-text="' . $monthtext . '">' . sprintf( \_\_( '%1$s-%2$s' ), $monthnum, $monthtext~~ ) . '</option>'; |
  |  | 215 | echo '<option value="' . esc\_attr( $monthnum ) . '" data-text="' . esc\_attr( $monthtext ) . '">' . sprintf( '%1$s-%2$s', esc\_html( $monthnum ), esc\_html( $monthtext ) ) . '</option>'; |
  | 214 | 216 | } |
  | 215 | 217 | ?> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L250) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L252) |  |
  | 250 | 252 |  |
  | 251 | 253 | // we need the post IDs |
  | 252 |  | $post\_ids = ( ! empty( $\_POST['post\_ids'] ) ) ? wp\_parse\_id\_list( ~~$\_POST['post\_ids'] ) : [];~~ |
  |  | 254 | $post\_ids = ( ! empty( $\_POST['post\_ids'] ) ) ? wp\_parse\_id\_list( array\_map( 'intval', $\_POST['post\_ids'] ) ) : []; // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 253 | 255 |  |
  | 254 | 256 | // if we have post IDs |
  | 255 | 257 | if ( ! empty( $post\_ids ) && is\_array( $post\_ids ) ) { |
  | 256 |  | $mmm = sanitize\_text\_field( ~~$\_POST['modified\_month'] );~~ |
  | 257 |  | $jj = sanitize\_text\_field( ~~$\_POST['modified\_day'] );~~ |
  | 258 |  | $aa = sanitize\_text\_field( ~~$\_POST['modified\_year'] );~~ |
  | 259 |  | $hh = sanitize\_text\_field( ~~$\_POST['modified\_hour'] );~~ |
  | 260 |  | $mn = sanitize\_text\_field( ~~$\_POST['modified\_minute'] );~~ |
  | 261 |  | $disable = sanitize\_text\_field( ~~$\_POST['modified\_disable'] );~~ |
  | 262 |  |  |
  |  | 258 | $mmm = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_month'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 259 | $jj = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_day'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 260 | $aa = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_year'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 261 | $hh = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_hour'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 262 | $mn = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_minute'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 263 | $disable = sanitize\_text\_field( wp\_unslash( $\_POST['modified\_disable'] ) );  // phpcs:ignore WordPress.Security.NonceVerification.Missing, WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  |  | 264 |  |
  | 263 | 265 | $mm = ( is\_numeric( $mmm ) && $mmm <= 12 ) ? $mmm : '01'; // months |
  | 264 | 266 | $jj = ( is\_numeric( $jj ) && $jj <= 31 ) ? $jj : '01'; // days |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L267) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L269) |  |
  | 267 | 269 | $mn = ( is\_numeric( $mn ) && $mn <= 60 ) ? $mn : '00'; // minutes |
  | 268 | 270 | $ss = '00'; // seconds |
  | 269 |  |  |
  |  | 271 |  |
  | 270 | 272 | $newdate = sprintf( "%04d-%02d-%02d %02d:%02d:%02d", $aa, $mm, $jj, $hh, $mn, $ss ); |
  | 271 | 273 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L276) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L278) |  |
  | 276 | 278 | $this->update\_meta( $post\_id, 'wplmi\_bulk\_update\_datetime', $newdate ); |
  | 277 | 279 | } |
  | 278 |  |  |
  |  | 280 |  |
  | 279 | 281 | if ( 'none' !== $disable ) { |
  | 280 | 282 | $this->update\_meta( $post\_id, '\_lmt\_disableupdate', $disable ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L283) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L285) |  |
  | 283 | 285 | } |
  | 284 | 286 | } |
  | 285 |  |  |
  |  | 287 |  |
  | 286 | 288 | $this->success(); |
  | 287 | 289 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L289) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L291) |  |
  | 289 | 291 | /\*\* |
  | 290 | 292 | \* Save post modified info to db. |
  | 291 |  | \* |
  |  | 293 | \* |
  | 292 | 294 | \* @param object   $data     Old Data |
  | 293 | 295 | \* @param object   $postarr  Current Data |
  | 294 |  | \* |
  |  | 296 | \* |
  | 295 | 297 | \* @return object  $data |
  | 296 | 298 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L317) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L319) |  |
  | 317 | 319 | // Get disable state. |
  | 318 | 320 | $disabled = $this->get\_meta( $postarr['ID'], '\_lmt\_disableupdate' ); |
  | 319 |  |  |
  |  | 321 |  |
  | 320 | 322 | /\*\* |
  | 321 | 323 | \* Handle post editor save |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L328) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L330) |  |
  | 328 | 330 | $disabled = $postarr['wplmi\_lockmodifiedupdate']; |
  | 329 | 331 | } |
  | 330 |  |  |
  |  | 332 |  |
  | 331 | 333 | if ( 'yes' === $disabled ) { |
  | 332 | 334 | $data['post\_modified']     = $postarr['post\_modified']; |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L350) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L352) |  |
  | 350 | 352 | $this->update\_meta( $postarr['ID'], 'wplmi\_temp\_date', $modified\_date ); |
  | 351 | 353 | } |
  | 352 |  | } |
  |  | 354 | } |
  | 353 | 355 | elseif ( ! empty( $temp\_date ) ) { |
  | 354 | 356 | $data['post\_modified']     = $temp\_date; |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L385) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L387) |  |
  | 385 | 387 | $mn = sanitize\_text\_field( $postarr['mnm'] ); |
  | 386 | 388 | $ss = sanitize\_text\_field( $postarr['ssm'] ); |
  | 387 |  |  |
  |  | 389 |  |
  | 388 | 390 | $mm = ( is\_numeric( $mm ) && $mm <= 12 ) ? $mm : '01'; // months |
  | 389 | 391 | $jj = ( is\_numeric( $jj ) && $jj <= 31 ) ? $jj : '01'; // days |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=2930921#L392) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/EditScreen.php?rev=3137253#L394) |  |
  | 392 | 394 | $mn = ( is\_numeric( $mn ) && $mn <= 60 ) ? $mn : '00'; // minutes |
  | 393 | 395 | $ss = ( is\_numeric( $ss ) && $ss <= 60 ) ? $ss : '00'; // seconds |
  | 394 |  |  |
  |  | 396 |  |
  | 395 | 397 | $newdate = sprintf( "%04d-%02d-%02d %02d:%02d:%02d", $aa, $mm, $jj, $hh, $mn, $ss ); |
  | 396 | 398 | $published\_timestamp = get\_post\_time( 'U', false, $postarr['ID'] ); |
  | 397 |  |  |
  |  | 399 |  |
  | 398 | 400 | if ( strtotime( $newdate ) >= $published\_timestamp ) { |
  | 399 | 401 | $data['post\_modified'] = $newdate; |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class MetaBox |
  | 22 | 22 | { |
  | 23 |  | use Hooker, HelperFunctions; |
  |  | 23 | use Hooker; |
  |  | 24 | use HelperFunctions; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L31) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L32) |  |
  | 31 | 32 | $this->action( 'admin\_print\_footer\_scripts-post-new.php', 'default\_check', 99 ); |
  | 32 | 33 | } |
  | 33 |  |  |
  |  | 34 |  |
  | 34 | 35 | /\*\* |
  | 35 | 36 | \* Add Meta box. |
  | 36 |  | \* |
  |  | 37 | \* |
  | 37 | 38 | \* @param string $post\_type Post Type |
  | 38 | 39 | \* @param object $post      WP Post |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L51) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L52) |  |
  | 51 | 52 | return; |
  | 52 | 53 | } |
  | 53 |  |  |
  |  | 54 |  |
  | 54 | 55 | $post\_types = $this->get\_data( 'lmt\_custom\_post\_types\_list' ); |
  | 55 | 56 | if ( ! empty( $post\_types ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L60) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L61) |  |
  | 60 | 61 | /\*\* |
  | 61 | 62 | \* Generate column data. |
  | 62 |  | \* |
  |  | 63 | \* |
  | 63 | 64 | \* @param string   $column   Column name |
  | 64 | 65 | \* @param int      $post\_id  Post ID |
  | 65 |  | \* |
  |  | 66 | \* |
  | 66 | 67 | \* @return string  $time |
  | 67 | 68 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L72) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L73) |  |
  | 72 | 73 | // buid nonce |
  | 73 | 74 | $this->nonce( 'disabled' ); ?> |
  | 74 |  |  |
  |  | 75 |  |
  | 75 | 76 | <div id="wplmi-status" class="meta-options"> |
  | 76 | 77 | <label for="wplmi\_status" class="selectit" title="<?php esc\_attr\_e( 'You can disable auto insertation of last modified info on this post', 'wp-last-modified-info' ); ?>"> |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L78) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L79) |  |
  | 78 | 79 | </label> |
  | 79 | 80 | </div> |
  | 80 |  | <?php |
  |  | 81 | <?php |
  | 81 | 82 | } |
  | 82 | 83 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L91) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L92) |  |
  | 91 | 92 | return; |
  | 92 | 93 | } |
  | 93 |  |  |
  |  | 94 |  |
  | 94 | 95 | // Check the user's permissions. |
  | 95 | 96 | if ( ! current\_user\_can( 'edit\_post', $post\_id ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L102) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L103) |  |
  | 102 | 103 |  |
  | 103 | 104 | // disableautoinsert string |
  | 104 |  | if ( isset( $\_POST['wplmi\_disable\_auto\_insert'] ) ) { |
  |  | 105 | if ( isset( $\_POST['wplmi\_disable\_auto\_insert'] ) ) { // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 105 | 106 | $this->update\_meta( $post\_id, '\_lmt\_disable', 'yes' ); |
  | 106 | 107 | } else { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L123) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L124) |  |
  | 123 | 124 | \* @param int $post\_id The post ID. |
  | 124 | 125 | \*/ |
  | 125 |  | private function nonce( $name, $referer = true, $~~echo~~ = true ) { |
  | 126 |  | \wp\_nonce\_field( 'wplmi\_nonce\_' . $name, 'wplmi\_metabox\_' . $name . '\_nonce', $referer, $~~echo~~ ); |
  |  | 126 | private function nonce( $name, $referer = true, $show = true ) { |
  |  | 127 | \wp\_nonce\_field( 'wplmi\_nonce\_' . $name, 'wplmi\_metabox\_' . $name . '\_nonce', $referer, $show ); |
  | 127 | 128 | } |
  | 128 | 129 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=2930921#L133) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MetaBox.php?rev=3137253#L134) |  |
  | 133 | 134 | \*/ |
  | 134 | 135 | private function verify( $name ) { |
  | 135 |  | if ( ! isset( $\_REQUEST[ 'wplmi\_metabox\_' . $name . '\_nonce' ] ) || ! \wp\_verify\_nonce( ~~$\_REQUEST[ 'wplmi\_metabox\_'.  $name . '\_nonce' ], 'wplmi\_nonce\_' . $name ) ) {~~ |
  |  | 136 | if ( ! isset( $\_REQUEST[ 'wplmi\_metabox\_' . $name . '\_nonce' ] ) || ! \wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_REQUEST[ 'wplmi\_metabox\_'.  $name . '\_nonce' ] ) ), 'wplmi\_nonce\_' . $name ) ) { // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotValidated |
  | 136 | 137 | return false; |
  | 137 | 138 | } |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class MiscActions |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L43) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L44) |  |
  | 43 | 44 | $this->action( 'save\_post', 'save\_post' ); |
  | 44 | 45 | } |
  | 45 |  |  |
  |  | 46 |  |
  | 46 | 47 | /\*\* |
  | 47 | 48 | \* Generate column data. |
  | 48 |  | \* |
  | 49 |  | \* @param string   $column   Column name |
  | 50 |  | \* @param int      $post\_id  Post ID |
  | 51 |  | \* |
  |  | 49 | \* |
  |  | 50 | \* @param string   $messages   Messages |
  |  | 51 | \* |
  | 52 | 52 | \* @return string  $time |
  | 53 | 53 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L55) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L55) |  |
  | 55 | 55 | global $post; |
  | 56 | 56 |  |
  | 57 |  | if ( ! $post instanceof \WP\_Post ) { |
  |  | 57 | $wp\_post = $post; |
  |  | 58 |  |
  |  | 59 | if ( ! $wp\_post instanceof \WP\_Post ) { |
  | 58 | 60 | if ( empty( $\_REQUEST['post'] ) ) { |
  | 59 | 61 | return $messages; |
  | 60 | 62 | } |
  | 61 | 63 | $post\_id = absint( $\_REQUEST['post'] ); |
  | 62 |  | $post = get\_post( $post\_id ); |
  | 63 |  | } |
  | 64 |  |  |
  |  | 64 | $wp\_post = get\_post( $post\_id ); |
  |  | 65 | } |
  |  | 66 |  |
  | 65 | 67 | // get WordPress date time format |
  | 66 | 68 | $get\_df = get\_option( 'date\_format' ); |
  | 67 | 69 | $get\_tf = get\_option( 'time\_format' ); |
  | 68 |  |  |
  | 69 |  | $m\_orig = get\_post\_field( 'post\_modified', $post->ID, 'raw' ); |
  | 70 |  | $post\_modified = '&nbsp;<strong>' . date\_i18n( $this->do\_filter( 'post\_updated\_datetime\_format', $get\_df . ' @ ' . $get\_tf, $post->ID ), strtotime( $m\_orig ) ) . '</strong>.&nbsp;'; |
  | 71 |  |  |
  |  | 70 |  |
  |  | 71 | $m\_orig = get\_post\_field( 'post\_modified', $wp\_post->ID, 'raw' ); |
  |  | 72 | $post\_modified = '&nbsp;<strong>' . date\_i18n( $this->do\_filter( 'post\_updated\_datetime\_format', $get\_df . ' @ ' . $get\_tf, $wp\_post->ID ), strtotime( $m\_orig ) ) . '</strong>.&nbsp;'; |
  |  | 73 |  |
  | 72 | 74 | // get post types returns object |
  | 73 |  | $post\_types = get\_post\_type\_object( $post->post\_type ); |
  | 74 |  | if ( is\_post\_type\_viewable( $post->post\_type ) ) { |
  | 75 |  | $post\_modified .= sprintf( ~~\_\_( '<a href="%1$s" target="\_blank">%2$s %3$s</a>' ), esc\_url( get\_permalink( $post->ID ) ),~~ \_\_( 'View', 'wp-last-modified-info' ), $post\_types->name ); |
  | 76 |  | } |
  | 77 |  |  |
  | 78 |  | if ( isset( $messages[ $post->post\_type ] ) ) { |
  | 79 |  | $messages[ $~~post->post\_type ][1] = esc\_html( $post\_types->labels->singular\_name ) . '&nbsp;' . sprintf( \_\_( '%1$s%2$s' ), \_\_( 'updated on~~', 'wp-last-modified-info' ), $post\_modified ); |
  | 80 |  | } |
  | 81 |  |  |
  |  | 75 | $post\_types = get\_post\_type\_object( $wp\_post->post\_type ); |
  |  | 76 | if ( is\_post\_type\_viewable( $wp\_post->post\_type ) ) { |
  |  | 77 | $post\_modified .= sprintf( '<a href="%1$s" target="\_blank">%2$s %3$s</a>', esc\_url( get\_permalink( $wp\_post->ID ) ), esc\_html\_\_( 'View', 'wp-last-modified-info' ), $post\_types->name ); |
  |  | 78 | } |
  |  | 79 |  |
  |  | 80 | if ( isset( $messages[ $wp\_post->post\_type ] ) ) { |
  |  | 81 | $messages[ $wp\_post->post\_type ][1] = esc\_html( $post\_types->labels->singular\_name ) . '&nbsp;' . sprintf( esc\_html\_\_( 'updated on %s', 'wp-last-modified-info' ), $post\_modified ); |
  |  | 82 | } |
  |  | 83 |  |
  | 82 | 84 | return $messages; |
  | 83 | 85 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L85) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L87) |  |
  | 85 | 87 | /\*\* |
  | 86 | 88 | \* Runs after post save. |
  | 87 |  | \* |
  |  | 89 | \* |
  | 88 | 90 | \* @param int      $post\_id  Post ID |
  | 89 | 91 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L97) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L99) |  |
  | 97 | 99 | $modified = date\_i18n( $this->do\_filter( 'custom\_field\_date\_time\_format', $get\_df . ' @ ' . $get\_tf ), $m\_stamp ); |
  | 98 | 100 | $shortcode = '[lmt-post-modified-info]'; |
  | 99 |  |  |
  |  | 101 |  |
  | 100 | 102 | // update post meta |
  | 101 | 103 | $this->update\_meta( $post\_id, 'wp\_last\_modified\_info', $modified ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L103) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L105) |  |
  | 103 | 105 | // update post meta |
  | 104 | 106 | $this->update\_meta( $post\_id, 'wplmi\_shortcode', $shortcode ); |
  | 105 |  |  |
  |  | 107 |  |
  | 106 | 108 | // update global site update time |
  | 107 | 109 | update\_option( 'wplmi\_site\_global\_update\_info', current\_time( 'timestamp', 0 ) ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L110) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L112) |  |
  | 110 | 112 | /\*\* |
  | 111 | 113 | \* Replace published time. |
  | 112 |  | \* |
  | 113 |  | \* @param string   $time  Post published time |
  |  | 114 | \* |
  |  | 115 | \* @param string   $time     Post published time |
  | 114 | 116 | \* @param string   $format   Post date format |
  | 115 | 117 | \* @param int      $post\_id  Post ID |
  | 116 |  | \* |
  |  | 118 | \* |
  | 117 | 119 | \* @return string  $time |
  | 118 | 120 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L127) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L129) |  |
  | 127 | 129 | /\*\* |
  | 128 | 130 | \* Replace published date. |
  | 129 |  | \* |
  |  | 131 | \* |
  | 130 | 132 | \* @param string   $date     Post published date |
  | 131 | 133 | \* @param string   $format   Post date format |
  | 132 | 134 | \* @param int      $post\_id  Post ID |
  | 133 |  | \* |
  |  | 135 | \* |
  | 134 | 136 | \* @return string  $time |
  | 135 | 137 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L160) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L162) |  |
  | 160 | 162 | /\*\* |
  | 161 | 163 | \* Filter query. |
  | 162 |  | \* |
  |  | 164 | \* |
  | 163 | 165 | \* @param object $query WP Query |
  | 164 | 166 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L166) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L168) |  |
  | 166 | 168 | global $pagenow; |
  | 167 | 169 | $order = $this->is\_equal( 'admin\_default\_sort\_order', 'published' ) ? 'asc' : 'desc'; |
  | 168 |  |  |
  |  | 170 |  |
  | 169 | 171 | if ( ! $this->is\_equal( 'admin\_default\_sort\_order', 'default' ) ) { |
  | 170 | 172 | if ( is\_admin() && 'edit.php' === $pagenow && ! isset( $\_GET['orderby'], $\_GET['order'] ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L177) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L179) |  |
  | 177 | 179 | /\*\* |
  | 178 | 180 | \* Filter query. |
  | 179 |  | \* |
  |  | 181 | \* |
  | 180 | 182 | \* @param object $query WP Query |
  | 181 | 183 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=2930921#L204) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/MiscActions.php?rev=3137253#L206) |  |
  | 204 | 206 |  |
  | 205 | 207 | if ( ! empty( $css ) ) { |
  | 206 |  | echo '<style id="wplmi-inline-css" type="text/css">'."\n". wp\_~~unslash( wp\_kses\_post~~( $css ) ) ."\n".'</style>'."\n"; |
  |  | 208 | echo '<style id="wplmi-inline-css" type="text/css">'."\n". wp\_kses\_post( wp\_unslash( $css ) ) ."\n".'</style>'."\n"; |
  | 207 | 209 | } |
  | 208 | 210 | } |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3052359#L22 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class PluginsData extends WP\_Background\_Process |
  | 23 | 23 | { |
  | 24 |  | use HelperFunctions, Hooker; |
  |  | 24 | use HelperFunctions; |
  |  | 25 | use Hooker; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3052359#L87) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3137253#L88) |  |
  | 87 | 88 | $this->call\_api( $item ); |
  | 88 | 89 | sleep( 2 ); // stop for 2 seconds to optimize memory usage |
  | 89 |  |  |
  |  | 90 |  |
  | 90 | 91 | return false; |
  | 91 | 92 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3052359#L250) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PluginsData.php?rev=3137253#L251) |  |
  | 250 | 251 | 'stream'      => false, |
  | 251 | 252 | 'filename'    => null, |
  | 252 |  | ]; |
  | 253 |  |  |
  |  | 253 | ]; |
  |  | 254 |  |
  | 254 | 255 | $response = wp\_remote\_get( 'https://plugins.svn.wordpress.org/' . $file . '/', $args ); |
  | 255 |  |  |
  |  | 256 |  |
  | 256 | 257 | if ( is\_wp\_error( $response ) ) { |
  | 257 | 258 | $status = false; |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class PostStatusFilters |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=2930921#L76) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=3137253#L77) |  |
  | 76 | 77 | 'update\_locked' => 1, |
  | 77 | 78 | ], |
  | 78 |  | admin\_url( 'edit.php' ) |
  |  | 79 | admin\_url( 'edit.php' ) |
  | 79 | 80 | ), |
  | 80 | 81 | $current, |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=2930921#L83) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=3137253#L84) |  |
  | 83 | 84 | ); |
  | 84 | 85 | } |
  | 85 |  |  |
  |  | 86 |  |
  | 86 | 87 | return $views; |
  | 87 | 88 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=2930921#L101) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/PostStatusFilters.php?rev=3137253#L102) |  |
  | 101 | 102 | ], |
  | 102 | 103 | ]; |
  | 103 |  |  |
  |  | 104 |  |
  | 104 | 105 | $query->set( 'meta\_query', $meta\_query ); |
  | 105 | 106 | } |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class UserColumn |
  | 22 | 22 | { |
  | 23 |  | use Hooker, SettingsData; |
  |  | 23 | use Hooker; |
  |  | 24 | use SettingsData; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L34) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L35) |  |
  | 34 | 35 | $this->action( 'admin\_head-users.php', 'style' ); |
  | 35 | 36 | } |
  | 36 |  |  |
  |  | 37 |  |
  | 37 | 38 | /\*\* |
  | 38 | 39 | \* Generate column data. |
  | 39 |  | \* |
  |  | 40 | \* |
  | 40 | 41 | \* @param string   $column   Column name |
  | 41 | 42 | \* @param int      $post\_id  Post ID |
  | 42 |  | \* |
  |  | 43 | \* |
  | 43 | 44 | \* @return string  $time |
  | 44 | 45 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L47) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L48) |  |
  | 47 | 48 | update\_user\_meta( $user\_id, 'profile\_last\_modified', current\_time( 'timestamp', 0 ) ); |
  | 48 | 49 | } |
  | 49 |  |  |
  |  | 50 |  |
  | 50 | 51 | /\*\* |
  | 51 | 52 | \* Make Column sortable. |
  | 52 |  | \* |
  |  | 53 | \* |
  | 53 | 54 | \* @param string   $column  Column name |
  | 54 | 55 | \* @return string  $column  Filtered column |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L65) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L66) |  |
  | 65 | 66 | return \_\_( 'Never', 'wp-last-modified-info' ); |
  | 66 | 67 | } |
  | 67 |  |  |
  |  | 68 |  |
  | 68 | 69 | return date\_i18n( $this->do\_filter( 'user\_column\_datetime\_format', $get\_df . '\<\b\r\>' . $get\_tf ), $timestamp ); |
  | 69 | 70 | break; |
  | 70 | 71 | } |
  | 71 |  |  |
  |  | 72 |  |
  | 72 | 73 | return $value; |
  | 73 | 74 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L75) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L76) |  |
  | 75 | 76 | /\*\* |
  | 76 | 77 | \* Register Column. |
  | 77 |  | \* |
  |  | 78 | \* |
  | 78 | 79 | \* @param string   $columns  Column name |
  | 79 | 80 | \* @return string  $columns  Filtered column |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L81) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L82) |  |
  | 81 | 82 | public function load\_columns( $columns ) { |
  | 82 | 83 | $columns['last-updated'] = \_\_( 'Last Updated', 'wp-last-modified-info' ); |
  | 83 |  |  |
  |  | 84 |  |
  | 84 | 85 | return $columns; |
  | 85 | 86 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L87) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L88) |  |
  | 87 | 88 | /\*\* |
  | 88 | 89 | \* Column title. |
  | 89 |  | \* |
  |  | 90 | \* |
  | 90 | 91 | \* @param string   $column  Column name |
  | 91 | 92 | \* @return string  $column  Filtered column |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L99) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L100) |  |
  | 99 | 100 | /\*\* |
  | 100 | 101 | \* Sort Column. |
  | 101 |  | \* |
  |  | 102 | \* |
  | 102 | 103 | \* @since 1.8.4 |
  | 103 | 104 | \* @param object   $user\_search  User Query |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L105) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L106) |  |
  | 105 | 106 | public function user\_column\_orderby( $user\_search ) { |
  | 106 | 107 | global $wpdb, $current\_screen; |
  | 107 |  |  |
  | 108 |  | if ( isset( $current\_screen->id ) && 'users' != $current\_screen->id ) { |
  |  | 108 |  |
  |  | 109 | if ( isset( $current\_screen->id ) && 'users' !== $current\_screen->id ) { |
  | 109 | 110 | return; |
  | 110 | 111 | } |
  | 111 |  |  |
  |  | 112 |  |
  | 112 | 113 | $vars = $user\_search->query\_vars; |
  | 113 | 114 | if ( 'lastupdated' === $vars['orderby'] ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=2930921#L119) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/UserColumn.php?rev=3137253#L120) |  |
  | 119 | 120 | /\*\* |
  | 120 | 121 | \* Column title. |
  | 121 |  | \* |
  |  | 122 | \* |
  | 122 | 123 | \* @param string   $column  Column name |
  | 123 | 124 | \* @return string  $column  Filtered column |
* ## [wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class WooCommerce |
  | 22 | 22 | { |
  | 23 |  | use Hooker, SettingsData; |
  |  | 23 | use Hooker; |
  |  | 24 | use SettingsData; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=2930921#L32) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=3137253#L33) |  |
  | 32 | 33 | $this->action( 'woocommerce\_order\_status\_changed', 'update\_products', 99 ); |
  | 33 | 34 | } |
  | 34 |  |  |
  |  | 35 |  |
  | 35 | 36 | /\*\* |
  | 36 | 37 | \* Update Post Modified date from previously save meta to fix WooCommerce Product Update process. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=2930921#L55) | […](/browser/wp-last-modified-info/trunk/inc/Core/Backend/WooCommerce.php?rev=3137253#L56) |  |
  | 55 | 56 | 'post\_modified\_gmt' => get\_gmt\_from\_date( $modified ), |
  | 56 | 57 | ]; |
  | 57 |  |  |
  |  | 58 |  |
  | 58 | 59 | $wpdb->update( $wpdb->posts, $args, [ |
  | 59 | 60 | 'ID' => $product\_id, |
* ## [wp-last-modified-info/trunk/inc/Core/Blocks.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Blocks.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Blocks.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L22 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class Blocks extends BaseController |
  | 23 | 23 | { |
  | 24 |  | use HelperFunctions, Hooker; |
  |  | 24 | use HelperFunctions; |
  |  | 25 | use Hooker; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L60) | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=3137253#L61) |  |
  | 60 | 61 | foreach ( $blocks as $name => $params ) { |
  | 61 | 62 | if ( $params['visible'] ) { |
  | 62 |  | register\_block\_type( $this->plugin\_path . '~~/~~blocks/build/' . $name, [ |
  |  | 63 | register\_block\_type( $this->plugin\_path . 'blocks/build/' . $name, [ |
  | 63 | 64 | 'render\_callback' => [ $this, $params['callback'] ], |
  | 64 | 65 | ] ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L73) | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=3137253#L74) |  |
  | 73 | 74 | \* @param string   $content    Block default content. |
  | 74 | 75 | \* @param WP\_Block $block      Block instance. |
  | 75 |  | \* |
  |  | 76 | \* |
  | 76 | 77 | \* @return string  Returns the post modified date. |
  | 77 | 78 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L80) | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=3137253#L81) |  |
  | 80 | 81 | return; |
  | 81 | 82 | } |
  | 82 |  |  |
  |  | 83 |  |
  | 83 | 84 | $post\_id = $block->context['postId']; |
  | 84 | 85 | $attributes = $this->normalize\_attributes( $attributes ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L102) | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=3137253#L103) |  |
  | 102 | 103 | $styles = $this->convert\_styles( $attributes['styles'] ); |
  | 103 | 104 |  |
  | 104 |  | return sprintf( |
  |  | 105 | return sprintf( |
  | 105 | 106 | '<%1$s class="%2$s" style="%3$s">%4$s</%1$s>', |
  | 106 | 107 | ( $attributes['display'] == 'block' ) ? 'div' : 'span', |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L117) | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=3137253#L118) |  |
  | 117 | 118 | \* @param string   $content    Block default content. |
  | 118 | 119 | \* @param WP\_Block $block      Block instance. |
  | 119 |  | \* |
  |  | 120 | \* |
  | 120 | 121 | \* @return string  Returns the post modified date. |
  | 121 | 122 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L130) | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=3137253#L131) |  |
  | 130 | 131 | \* |
  | 131 | 132 | \* @param array    $attributes Block attributes. |
  | 132 |  | \* |
  |  | 133 | \* |
  | 133 | 134 | \* @return string  Returns the site modified date. |
  | 134 | 135 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=2930921#L158) | […](/browser/wp-last-modified-info/trunk/inc/Core/Blocks.php?rev=3137253#L159) |  |
  | 158 | 159 | $styles = $this->convert\_styles( $attributes['styles'] ); |
  | 159 | 160 |  |
  | 160 |  | return sprintf( |
  |  | 161 | return sprintf( |
  | 161 | 162 | '<%1$s class="%2$s" style="%3$s">%4$s</%1$s>', |
  | 162 | 163 | ( $attributes['display'] == 'block' ) ? 'div' : 'span', |
* ## [wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorName.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorName.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorName.php")

  | [r3033702](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorName.php?rev=3033702#L12 "Show revision 3033702 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorName.php?rev=3137253#L12 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 |  |
  | 13 | 13 | use Wplmi\Helpers\Hooker; |
  | 14 |  | use ~~\~~Elementor\Controls\_Manager; |
  | 15 |  | use ~~\~~Elementor\Core\DynamicTags\Tag; |
  | 16 |  | use ~~\~~Elementor\Modules\DynamicTags\Module; |
  |  | 14 | use Elementor\Controls\_Manager; |
  |  | 15 | use Elementor\Core\DynamicTags\Tag; |
  |  | 16 | use Elementor\Modules\DynamicTags\Module; |
  | 17 | 17 |  |
  | 18 | 18 | defined( 'ABSPATH' ) || exit; |
* ## [wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorUrl.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorUrl.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorUrl.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorUrl.php?rev=2930921#L11 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/AuthorUrl.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | namespace Wplmi\Core\Elementor\Modules; |
  | 12 | 12 |  |
  | 13 |  | use ~~\~~Elementor\Controls\_Manager; |
  | 14 |  | use ~~\~~Elementor\Core\DynamicTags\Data\_Tag; |
  | 15 |  | use ~~\~~Elementor\Modules\DynamicTags\Module; |
  |  | 13 | use Elementor\Controls\_Manager; |
  |  | 14 | use Elementor\Core\DynamicTags\Data\_Tag; |
  |  | 15 | use Elementor\Modules\DynamicTags\Module; |
  | 16 | 16 |  |
  | 17 | 17 | defined( 'ABSPATH' ) || exit; |
* ## [wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedDate.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedDate.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedDate.php")

  | [r3033702](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedDate.php?rev=3033702#L11 "Show revision 3033702 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedDate.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | namespace Wplmi\Core\Elementor\Modules; |
  | 12 | 12 |  |
  | 13 |  | use ~~\~~Elementor\Controls\_Manager; |
  | 14 |  | use ~~\~~Elementor\Core\DynamicTags\Tag; |
  | 15 |  | use ~~\~~Elementor\Modules\DynamicTags\Module; |
  |  | 13 | use Elementor\Controls\_Manager; |
  |  | 14 | use Elementor\Core\DynamicTags\Tag; |
  |  | 15 | use Elementor\Modules\DynamicTags\Module; |
  | 16 | 16 |  |
  | 17 | 17 | defined( 'ABSPATH' ) || exit; |
* ## [wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedTime.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedTime.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedTime.php")

  | [r3033702](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedTime.php?rev=3033702#L11 "Show revision 3033702 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Elementor/Modules/ModifiedTime.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | namespace Wplmi\Core\Elementor\Modules; |
  | 12 | 12 |  |
  | 13 |  | use ~~\~~Elementor\Controls\_Manager; |
  | 14 |  | use ~~\~~Elementor\Core\DynamicTags\Tag; |
  | 15 |  | use ~~\~~Elementor\Modules\DynamicTags\Module; |
  |  | 13 | use Elementor\Controls\_Manager; |
  |  | 14 | use Elementor\Core\DynamicTags\Tag; |
  |  | 15 | use Elementor\Modules\DynamicTags\Module; |
  | 16 | 16 |  |
  | 17 | 17 | defined( 'ABSPATH' ) || exit; |
* ## [wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class PostView |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L33) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253#L34) |  |
  | 33 | 34 | /\*\* |
  | 34 | 35 | \* Show original publish info. |
  | 35 |  | \* |
  |  | 36 | \* |
  | 36 | 37 | \* @param string  $content  Original Content |
  | 37 |  | \* |
  |  | 38 | \* |
  | 38 | 39 | \* @return string $content  Filtered Content |
  | 39 | 40 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L143) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253#L144) |  |
  | 143 | 144 |  |
  | 144 | 145 | $template = $this->generate( $template, $post->ID, $timestamp, $author\_id ); |
  | 145 |  | $allowed\_htmls = array\_merge( wp\_kses\_allowed\_html( 'post' ), [ |
  | 146 |  | 'time' => [ |
  | 147 |  | 'class'    => [], |
  | 148 |  | 'itemprop' => [], |
  | 149 |  | 'datetime' => [], |
  | 150 |  | ], |
  | 151 |  | ] ); |
  | 152 |  |  |
  | 153 |  | echo '<div class="wplmi-frontend-template" style="display: none;">' . wp\_kses( $template, $allowed\_htmls ) . '</div>'; ?> |
  |  | 146 |  |
  |  | 147 | echo '<div class="wplmi-frontend-template" style="display: none;">' . $template . '</div>'; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?> |
  | 154 | 148 |  |
  | 155 | 149 | <script type="text/javascript"> |
  | 156 |  | const wplmiNodeList = document.querySelectorAll( '<?~~php echo~~ wp\_kses\_post( preg\_replace( "/\r|\n/", '', $selectors ) ); ?>' ); |
  |  | 150 | const wplmiNodeList = document.querySelectorAll( '<?= wp\_kses\_post( preg\_replace( "/\r|\n/", '', $selectors ) ); ?>' ); |
  | 157 | 151 | for ( let i = 0; i < wplmiNodeList.length; i++ ) { |
  | 158 | 152 | wplmiNodeList[i].outerHTML = document.querySelector( '.wplmi-frontend-template' ).innerHTML; |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L166) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253#L160) |  |
  | 166 | 160 | \* |
  | 167 | 161 | \* @param int  $post\_id  WP Post ID. |
  | 168 |  | \* |
  |  | 162 | \* |
  | 169 | 163 | \* @return string |
  | 170 | 164 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L200) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253#L194) |  |
  | 200 | 194 | \* @param int     $post\_id Post ID. |
  | 201 | 195 | \* @param string  $type    Sting type. Default subject. |
  | 202 |  | \* |
  |  | 196 | \* |
  | 203 | 197 | \* @return string |
  | 204 | 198 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L218) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253#L212) |  |
  | 218 | 212 | // Published date format |
  | 219 | 213 | $date\_format = $this->do\_filter( 'post\_published\_date\_format', get\_option( 'date\_format' ), $post\_id ); |
  | 220 |  |  |
  |  | 214 |  |
  | 221 | 215 | // Start replace |
  | 222 |  | $html = str\_replace( [ '%original\_author\_name%', '%post\_original\_author%' ], get\_the\_author(), $html ); |
  | 223 |  | $html = str\_replace( [ '%author\_name%', '%post\_author%' ], $author\_name, $html ); |
  |  | 216 | $html = str\_replace( [ '%original\_author\_name%', '%post\_original\_author%' ], get\_the\_author(), $html ); |
  |  | 217 | $html = str\_replace( [ '%author\_name%', '%post\_author%' ], $author\_name, $html ); |
  | 224 | 218 | $html = str\_replace( [ '%author\_url%', '%author\_website%' ], $author\_url, $html ); |
  | 225 | 219 | $html = str\_replace( '%author\_email%', $author\_email, $html ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L232) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253#L226) |  |
  | 232 | 226 |  |
  | 233 | 227 | $html = $this->do\_filter( 'post\_tags', $html, $post\_id ); |
  | 234 |  | return preg\_replace( "/\r|\n/", '', $html ); |
  |  | 228 | $html = preg\_replace( "/\r|\n/", '', $html ); |
  |  | 229 |  |
  |  | 230 | $allowed\_htmls = array\_merge( wp\_kses\_allowed\_html( 'post' ), [ |
  |  | 231 | 'time' => [ |
  |  | 232 | 'class'    => [], |
  |  | 233 | 'itemprop' => [], |
  |  | 234 | 'datetime' => [], |
  |  | 235 | ], |
  |  | 236 | ] ); |
  |  | 237 |  |
  |  | 238 | return wp\_kses( $html, $allowed\_htmls ); |
  | 235 | 239 | } |
  | 236 | 240 |  |
  | 237 | 241 | /\*\* |
  | 238 | 242 | \* Check archive pages |
  | 239 |  | \* |
  |  | 243 | \* |
  | 240 | 244 | \* @param string  $content      Post Content. |
  | 241 | 245 | \* @param int     $post\_id      WP Post ID. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L244) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253#L248) |  |
  | 244 | 248 | \* @param string  $output\_type  Output Type | Default post. |
  | 245 | 249 | \* @param string  $element      HTML element | Default p. |
  | 246 |  | \* |
  |  | 250 | \* |
  | 247 | 251 | \* @return string |
  | 248 | 252 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=2930921#L263) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/PostView.php?rev=3137253#L267) |  |
  | 263 | 267 | /\*\* |
  | 264 | 268 | \* Check archive pages |
  | 265 |  | \* |
  |  | 269 | \* |
  | 266 | 270 | \* @return bool |
  | 267 | 271 | \*/ |
* ## [wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L22 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L22 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 22 | 22 | class Schema extends BaseController |
  | 23 | 23 | { |
  | 24 |  | use HelperFunctions, Hooker; |
  |  | 24 | use HelperFunctions; |
  |  | 25 | use Hooker; |
  | 25 | 26 |  |
  | 26 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L36) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L37) |  |
  | 36 | 37 | \* Echo Json-ld Schema codes. |
  | 37 | 38 | \*/ |
  | 38 |  | public function schema\_markup() { |
  |  | 39 | public function schema\_markup() { |
  | 39 | 40 | global $post; |
  | 40 | 41 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L42) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L43) |  |
  | 42 | 43 | return; |
  | 43 | 44 | } |
  | 44 |  |  |
  |  | 45 |  |
  | 45 | 46 | // get post infos |
  | 46 | 47 | $full\_content = $post->post\_content; |
  | 47 | 48 | $excerpt = $post->post\_excerpt; |
  | 48 |  |  |
  |  | 49 |  |
  | 49 | 50 | // get post modfied author ID |
  | 50 |  | $author\_id = $this->get\_meta( $post->ID, '\_edit\_last' ); |
  |  | 51 | $author\_id = $this->get\_meta( $post->ID, '\_edit\_last' ); |
  | 51 | 52 |  |
  | 52 | 53 | // Strip shortcodes and tags |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L54) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L55) |  |
  | 54 | 55 | $full\_content = wp\_strip\_all\_tags( $full\_content ); |
  | 55 | 56 | $full\_content = $this->do\_filter( 'schema\_content', $full\_content, $post->ID ); |
  | 56 |  |  |
  |  | 57 |  |
  | 57 | 58 | $desc\_word\_count = $this->do\_filter( 'schema\_description\_word\_count', 60 ); |
  | 58 | 59 | $short\_content = wp\_trim\_words( $full\_content, $desc\_word\_count, '' ); |
  | 59 | 60 | $short\_content = ( ! empty( $excerpt ) ) ? $excerpt : $short\_content; |
  | 60 |  |  |
  |  | 61 |  |
  | 61 | 62 | $json = [ |
  | 62 | 63 | '@context'         => 'https://schema.org/', |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L76) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L77) |  |
  | 76 | 77 | ], |
  | 77 | 78 | ]; |
  | 78 |  |  |
  |  | 79 |  |
  | 79 | 80 | if ( is\_page() ) { |
  | 80 | 81 | // change schema type for pages |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L82) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L83) |  |
  | 82 | 83 | unset( $json['mainEntityOfPage'] ); |
  | 83 | 84 | } |
  | 84 |  |  |
  |  | 85 |  |
  | 85 | 86 | $json = $this->do\_filter( 'schema\_items', $json, $post->ID ); |
  | 86 |  |  |
  |  | 87 |  |
  | 87 | 88 | $output = ''; |
  | 88 | 89 | if ( ! empty( $json ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L97) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L98) |  |
  | 97 | 98 | if ( $this->is\_equal( 'enable\_jsonld\_markup\_cb', 'enable' ) && ! empty( $post\_types ) ) { |
  | 98 | 99 | if ( in\_array( get\_post\_type( $post->ID ), $post\_types ) ) { |
  | 99 |  | echo $output; |
  |  | 100 | echo $output; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 100 | 101 | } |
  | 101 | 102 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L104) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L105) |  |
  | 104 | 105 | /\*\* |
  | 105 | 106 | \* Hooks the language attributes to add Extended schema compatibility. |
  | 106 |  | \* |
  |  | 107 | \* |
  | 107 | 108 | \* @param string  $input   Original Content |
  | 108 | 109 | \* @return string $output  Filtered Content |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L141) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L142) |  |
  | 141 | 142 | /\*\* |
  | 142 | 143 | \* Replace the strings. |
  | 143 |  | \* |
  |  | 144 | \* |
  | 144 | 145 | \* @param string  $html  Original Content |
  | 145 |  | \* |
  |  | 146 | \* |
  | 146 | 147 | \* @return string $html  Filtered Content |
  | 147 | 148 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L156) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L157) |  |
  | 156 | 157 | if ( ! $this->is\_equal( 'enable\_jsonld\_markup\_cb', 'disable' ) && $can\_replace ) { |
  | 157 | 158 | $replace = ' itemprop="dateModified"'; |
  | 158 |  |  |
  |  | 159 |  |
  | 159 | 160 | if ( $this->is\_equal( 'replace\_published\_date', 'remove' ) ) { |
  | 160 | 161 | $replace = ''; |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=2930921#L163) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/Schema.php?rev=3137253#L164) |  |
  | 163 | 164 | $html = str\_replace( ' itemprop="datePublished"', $replace, $html ); |
  | 164 | 165 | } |
  | 165 |  |  |
  |  | 166 |  |
  | 166 | 167 | if ( $this->is\_equal( 'enable\_jsonld\_markup\_cb', 'comp\_mode' ) ) { |
  | 167 | 168 | // All in One SEO Pack Meta Compatibility |
* ## [wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=2930921#L23 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=3137253#L23 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | \* array $params |
  | 24 | 24 | \*/ |
  | 25 |  | private ~~array~~ $params; |
  |  | 25 | private $params; |
  | 26 | 26 |  |
  | 27 | 27 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=2930921#L35) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=3137253#L35) |  |
  | 35 | 35 | $this->params = $args; |
  | 36 | 36 | } |
  | 37 |  |  |
  |  | 37 |  |
  | 38 | 38 | /\*\* |
  | 39 | 39 | \* Template tag output. |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=2930921#L74) | […](/browser/wp-last-modified-info/trunk/inc/Core/Frontend/TemplateTags.php?rev=3137253#L74) |  |
  | 74 | 74 | // Prepare template |
  | 75 | 75 | $template = $this->generate( $template, $post->ID, $timestamp, $author\_id ); |
  | 76 |  |  |
  |  | 76 |  |
  | 77 | 77 | if ( $this->params['escape'] ) { |
  | 78 | 78 | $template = wp\_strip\_all\_tags( $template ); |
* ## [wp-last-modified-info/trunk/inc/Core/Notification.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/Notification.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/Notification.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class Notification |
  | 22 | 22 | { |
  | 23 |  | use HelperFunctions, Hooker; |
  |  | 23 | use HelperFunctions; |
  |  | 24 | use Hooker; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L32) | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=3137253#L33) |  |
  | 32 | 33 | /\*\* |
  | 33 | 34 | \* Show original publish info. |
  | 34 |  | \* |
  |  | 35 | \* |
  | 35 | 36 | \* @param string  $content  Original Content |
  | 36 |  | \* |
  |  | 37 | \* |
  | 37 | 38 | \* @return string $content  Filtered Content |
  | 38 | 39 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L45) | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=3137253#L46) |  |
  | 45 | 46 | return; |
  | 46 | 47 | } |
  | 47 |  |  |
  |  | 48 |  |
  | 48 | 49 | // Transitioning from an Auto Draft to Published shouldn't result in a notification. |
  | 49 | 50 | if ( $post\_before->post\_status === 'auto-draft' && $post\_after->post\_status === 'publish' ) { |
  | 50 | 51 | return; |
  | 51 | 52 | } |
  | 52 |  |  |
  |  | 53 |  |
  | 53 | 54 | // If we're purely saving a draft, and don't have the draft option enabled, skip. If we're transitioning one way or the other, send a notification. |
  | 54 | 55 | if ( ! $this->is\_enabled( 'lmt\_enable\_draft\_noti\_cb' ) && in\_array( $post\_before->post\_status, [ 'draft', 'auto-draft' ] ) && 'draft' === $post\_after->post\_status ) { |
  | 55 | 56 | return; |
  | 56 | 57 | } |
  | 57 |  |  |
  |  | 58 |  |
  | 58 | 59 | $post\_types = $this->get\_data( 'lmt\_enable\_noti\_post\_types', [ 'post' ] ); |
  | 59 | 60 | if ( ! in\_array( $post\_before->post\_type, $post\_types ) ) { |
  | 60 | 61 | return; |
  | 61 | 62 | } |
  | 62 |  |  |
  |  | 63 |  |
  | 63 | 64 | // If this is a new post, skip. |
  | 64 | 65 | $child\_posts = wp\_get\_post\_revisions( $post\_id, [ 'numberposts' => 1 ] ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L66) | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=3137253#L67) |  |
  | 66 | 67 | return; |
  | 67 | 68 | } |
  | 68 |  |  |
  |  | 69 |  |
  | 69 | 70 | if ( ! $post\_before || ! $post\_after ) { |
  | 70 | 71 | return; |
  | 71 | 72 | } |
  | 72 |  |  |
  |  | 73 |  |
  | 73 | 74 | $text = ''; |
  | 74 | 75 | if ( $post\_before->post\_title !== $post\_after->post\_title ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L76) | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=3137253#L77) |  |
  | 76 | 77 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Title:', 'wp-last-modified-info' ), $post\_after->post\_title ) . "\n"; |
  | 77 | 78 | } |
  | 78 |  |  |
  |  | 79 |  |
  | 79 | 80 | if ( $post\_before->post\_content !== $post\_after->post\_content ) { |
  | 80 | 81 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Post Content:', 'wp-last-modified-info' ), $post\_before->post\_content ) . "\n"; |
  | 81 | 82 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Post Content:', 'wp-last-modified-info' ), $post\_after->post\_content ) . "\n"; |
  | 82 | 83 | } |
  | 83 |  |  |
  |  | 84 |  |
  | 84 | 85 | if ( $post\_before->post\_excerpt !== $post\_after->post\_excerpt ) { |
  | 85 | 86 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Excerpt:', 'wp-last-modified-info' ), $post\_before->post\_excerpt ) . "\n"; |
  | 86 | 87 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Excerpt:', 'wp-last-modified-info' ), $post\_after->post\_excerpt ) . "\n"; |
  | 87 | 88 | } |
  | 88 |  |  |
  |  | 89 |  |
  | 89 | 90 | if ( $post\_before->post\_author !== $post\_after->post\_author ) { |
  | 90 | 91 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Author:', 'wp-last-modified-info' ), $post\_before->post\_author ) . "\n"; |
  | 91 | 92 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Author:', 'wp-last-modified-info' ), $post\_after->post\_author ) . "\n"; |
  | 92 | 93 | } |
  | 93 |  |  |
  |  | 94 |  |
  | 94 | 95 | if ( $post\_before->post\_name !== $post\_after->post\_name ) { |
  | 95 | 96 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Link:', 'wp-last-modified-info' ), esc\_url( str\_replace( $post\_after->post\_name, $post\_before->post\_name, get\_permalink( $post\_before->ID ) ) ) ) . "\n"; |
  | 96 | 97 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Link:', 'wp-last-modified-info' ), esc\_url( get\_permalink( $post\_after->ID ) ) ) . "\n"; |
  | 97 | 98 | } |
  | 98 |  |  |
  |  | 99 |  |
  | 99 | 100 | if ( $post\_before->comment\_status !== $post\_after->comment\_status ) { |
  | 100 | 101 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Comment Status:', 'wp-last-modified-info' ), $post\_before->comment\_status ) . "\n"; |
  | 101 | 102 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Comment Status:', 'wp-last-modified-info' ), $post\_after->comment\_status ) . "\n"; |
  | 102 | 103 | } |
  | 103 |  |  |
  |  | 104 |  |
  | 104 | 105 | if ( $post\_before->ping\_status !== $post\_after->ping\_status ) { |
  | 105 | 106 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'Old Ping Status:', 'wp-last-modified-info' ), $post\_before->ping\_status ) . "\n"; |
  | 106 | 107 | $text .= sprintf( '<strong>%1$s:</strong> %2$s', \_\_( 'New Ping Status:', 'wp-last-modified-info' ), $post\_after->ping\_status ) . "\n"; |
  | 107 | 108 | } |
  | 108 |  |  |
  |  | 109 |  |
  | 109 | 110 | $text = $this->do\_filter( 'notification\_content', $text, $post\_id, $post\_before, $post\_after ); |
  | 110 | 111 | $post\_author = get\_user\_by( 'id', $post\_before->post\_author ); |
  | 111 |  |  |
  |  | 112 |  |
  | 112 | 113 | $recipients = []; |
  | 113 | 114 | $recipients = explode( ',', $this->get\_data( 'lmt\_email\_recipient', [] ) ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L122) | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=3137253#L123) |  |
  | 122 | 123 | $headers = [ 'Content-Type: text/html; charset=UTF-8' ]; |
  | 123 | 124 | $headers = $this->do\_filter( 'email\_headers', $headers ); |
  | 124 |  |  |
  |  | 125 |  |
  | 125 | 126 | if ( ! empty( $text ) && ! empty( $recipients ) ) { |
  | 126 | 127 | wp\_mail( $recipients, $subject, $body, $headers ); |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L134) | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=3137253#L135) |  |
  | 134 | 135 | \* @param object  $post  WP Post object. |
  | 135 | 136 | \* @param string  $type  Sting type. Default subject. |
  | 136 |  | \* |
  |  | 137 | \* |
  | 137 | 138 | \* @return string |
  | 138 | 139 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=2930921#L140) | […](/browser/wp-last-modified-info/trunk/inc/Core/Notification.php?rev=3137253#L141) |  |
  | 140 | 141 | $text = stripslashes( $text ); |
  | 141 | 142 | $text = str\_replace( '%author\_name%', get\_the\_author\_meta( 'display\_name', $post\_before->post\_author ), $text ); |
  | 142 |  | $text = str\_replace( '%modified\_author\_name%', get\_the\_author\_meta( 'display\_name', $this->get\_meta( $post\_id, '\_edit\_last' ) ), $text ); |
  | 143 |  | $text = str\_replace( '%post\_title%', $post\_before->post\_title, $text ); |
  | 144 |  | $text = str\_replace( '%post\_type%', get\_post\_type( $post\_id ), $text ); |
  |  | 143 | $text = str\_replace( '%modified\_author\_name%', get\_the\_author\_meta( 'display\_name', $this->get\_meta( $post\_id, '\_edit\_last' ) ), $text ); |
  |  | 144 | $text = str\_replace( '%post\_title%', $post\_before->post\_title, $text ); |
  |  | 145 | $text = str\_replace( '%post\_type%', get\_post\_type( $post\_id ), $text ); |
  | 145 | 146 | $text = str\_replace( '%current\_time%', date\_i18n( $this->do\_filter( 'notification\_datetime\_format', 'j F, Y @ g:i a', $post\_id ), current\_time( 'timestamp', 0 ) ), $text ); |
  | 146 |  | $text = str\_replace( '%site\_name%', wp\_specialchars\_decode( get\_bloginfo( 'name' ), ENT\_QUOTES ), $text ); |
  |  | 147 | $text = str\_replace( '%site\_name%', wp\_specialchars\_decode( get\_bloginfo( 'name' ), ENT\_QUOTES ), $text ); |
  | 147 | 148 | $text = str\_replace( '%site\_url%', esc\_url( get\_bloginfo( 'url' ) ), $text ); |
  | 148 |  |  |
  |  | 149 |  |
  | 149 | 150 | if ( $type == 'subject' ) { |
  | 150 | 151 | return stripslashes( wp\_strip\_all\_tags( $text ) ); |
  | 151 | 152 | } |
  | 152 | 153 |  |
  | 153 |  | $text = str\_replace( '%post\_link%', esc\_url( get\_the\_permalink( $post\_id ) ), $text ); |
  |  | 154 | $text = str\_replace( '%post\_link%', esc\_url( get\_the\_permalink( $post\_id ) ), $text ); |
  | 154 | 155 | $text = str\_replace( '%post\_edit\_link%', esc\_url( get\_edit\_post\_link( $post\_id ) ), $text ); |
  | 155 | 156 | $text = str\_replace( '%admin\_email%', filter\_var( get\_bloginfo( 'admin\_email' ), FILTER\_SANITIZE\_EMAIL ), $text ); |
* ## [wp-last-modified-info/trunk/inc/Core/RestApi.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Core/RestApi.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Core/RestApi.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=2930921#L21 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=3137253#L21 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | class RestApi |
  | 22 | 22 | { |
  | 23 |  | use Hooker, SettingsData; |
  |  | 23 | use Hooker; |
  |  | 24 | use SettingsData; |
  | 24 | 25 |  |
  | 25 | 26 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=2930921#L31) | […](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=3137253#L32) |  |
  | 31 | 32 |  |
  | 32 | 33 | /\*\* |
  | 33 |  | \* Show original publish info. |
  | 34 |  | \* |
  | 35 |  | \* @param string  $content  Original Content |
  | 36 |  | \* |
  | 37 |  | \* @return string $content  Filtered Content |
  |  | 34 | \* Register Rest field. |
  | 38 | 35 | \*/ |
  | 39 | 36 | public function rest\_init() { |
  | […](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=2930921#L49) | […](/browser/wp-last-modified-info/trunk/inc/Core/RestApi.php?rev=3137253#L46) |  |
  | 49 | 46 | /\*\* |
  | 50 | 47 | \* Rest Api outpur callback |
  | 51 |  | \* |
  | 52 |  | \* @param object  $~~object~~ WP Post Object |
  |  | 48 | \* |
  |  | 49 | \* @param object  $rest\_object WP Post Object |
  | 53 | 50 | \* @param string  $field\_name  Field Name |
  | 54 | 51 | \* @param string  $request     Request |
  | 55 |  | \* |
  |  | 52 | \* |
  | 56 | 53 | \* @return string|null |
  | 57 | 54 | \*/ |
  | 58 |  | public function rest\_output( $object, $field\_name, $request ) { |
  | 59 |  | $author\_id = $this->get\_meta( $object['id'], '\_edit\_last' ); |
  | 60 |  |  |
  |  | 55 | public function rest\_output( $rest\_object, $field\_name, $request ) { |
  |  | 56 | $author\_id = $this->get\_meta( $rest\_object['id'], '\_edit\_last' ); |
  |  | 57 |  |
  | 61 | 58 | if ( $author\_id ) { |
  | 62 | 59 | $last\_user = get\_userdata( $author\_id ); |
  | 63 |  |  |
  |  | 60 |  |
  | 64 | 61 | if ( $last\_user && is\_object( $last\_user ) ) { |
  | 65 | 62 | return $last\_user->display\_name; |
* ## [wp-last-modified-info/trunk/inc/Helpers/Ajax.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Helpers/Ajax.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Helpers/Ajax.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Helpers/Ajax.php?rev=2930921#L39 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Helpers/Ajax.php?rev=3137253#L39 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 39 | 39 | \*/ |
  | 40 | 40 | protected function verify\_nonce( $action = 'wplmi\_admin\_nonce' ) { |
  | 41 |  | if ( ! isset( $\_REQUEST['security'] ) || ! \wp\_verify\_nonce( ~~$\_REQUEST['security']~~, $action ) ) { |
  |  | 41 | if ( ! isset( $\_REQUEST['security'] ) || ! \wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_REQUEST['security'] ) ), $action ) ) { |
  | 42 | 42 | $this->error( \_\_( 'Error: Nonce verification failed', 'wp-last-modified-info' ) ); |
  | 43 | 43 | } |
* ## [wp-last-modified-info/trunk/inc/Helpers/Fields.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Helpers/Fields.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Helpers/Fields.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L23 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3137253#L23 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | \* Send AJAX response. |
  | 24 | 24 | \* |
  | 25 |  | \* @param array $data    Data to send using ajax. |
  |  | 25 | \* @param array $data    Data to send using ajax. |
  | 26 | 26 | \* @param boolean $success Optional. If this is an error. Defaults: true. |
  | 27 | 27 | \*/ |
  | 28 |  | protected function do\_field( $data ) { |
  | 29 |  | if ( ~~! isset( $data['type'] ) ||~~ empty( $data['type'] ) ) { |
  |  | 28 | protected function do\_field( array $data ) { |
  |  | 29 | if ( empty( $data['type'] ) ) { |
  | 30 | 30 | $data['type'] = 'text'; |
  | 31 | 31 | } |
  | 32 |  |  |
  |  | 32 |  |
  | 33 | 33 | $class = [ 'wplmi-form-control', 'wplmi-form-el' ]; |
  | 34 |  | if ( ~~isset( $data['class'] ) &&~~ ! empty( $data['class'] ) ) { |
  |  | 34 | if ( ! empty( $data['class'] ) ) { |
  | 35 | 35 | if ( is\_array( $data['class'] ) ) { |
  | 36 | 36 | $class = array\_merge( $class, $data['class'] ); |
  | 37 | 37 | } else { |
  | 38 |  | ~~array\_push( $class, $data['class'] )~~; |
  |  | 38 | $class[] = $data['class']; |
  | 39 | 39 | } |
  | 40 | 40 | } |
  | 41 |  |  |
  |  | 41 |  |
  | 42 | 42 | $name = $data['id']; |
  | 43 | 43 | if ( isset( $data['name'] ) ) { |
  | 44 | 44 | $name = $data['name']; |
  | 45 | 45 | } |
  | 46 |  |  |
  |  | 46 |  |
  | 47 | 47 | $attr = []; |
  | 48 | 48 | if ( isset( $data['required'] ) && true === $data['required'] ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L52) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3137253#L52) |  |
  | 52 | 52 | $attr[] = 'data-required="no"'; |
  | 53 | 53 | } |
  | 54 |  |  |
  |  | 54 |  |
  | 55 | 55 | if ( isset( $data['checked'] ) && true === $data['checked'] ) { |
  | 56 | 56 | $attr[] = 'checked'; |
  | 57 | 57 | } |
  | 58 |  |  |
  |  | 58 |  |
  | 59 | 59 | if ( isset( $data['disabled'] ) && true === $data['disabled'] ) { |
  | 60 | 60 | $attr[] = 'disabled'; |
  | 61 | 61 | } |
  | 62 |  |  |
  |  | 62 |  |
  | 63 | 63 | if ( isset( $data['readonly'] ) && true === $data['readonly'] ) { |
  | 64 | 64 | $attr[] = 'readonly'; |
  | 65 | 65 | } |
  | 66 |  |  |
  | 67 |  | if ( ~~isset( $data['attributes'] ) &&~~ ! empty( $data['attributes'] ) && is\_array( $data['attributes'] ) ) { |
  |  | 66 |  |
  |  | 67 | if ( ! empty( $data['attributes'] ) && is\_array( $data['attributes'] ) ) { |
  | 68 | 68 | foreach ( $data['attributes'] as $key => $value ) { |
  | 69 | 69 | $attr[] = $key . '="' . $value . '"'; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L71) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3137253#L71) |  |
  | 71 | 71 | } |
  | 72 | 72 |  |
  | 73 |  | if ( ~~isset( $data['condition'] ) &&~~ ! empty( $data['condition'] ) && is\_array( $data['condition'] ) ) { |
  |  | 73 | if ( ! empty( $data['condition'] ) && is\_array( $data['condition'] ) ) { |
  | 74 | 74 | $cattr = 'data-condition="' . htmlspecialchars( wp\_json\_encode( $data['condition'] ), ENT\_QUOTES, 'UTF-8' ) . '"'; |
  | 75 |  | ~~array\_push( $attr, $cattr )~~; |
  |  | 75 | $attr[] = $cattr; |
  | 76 | 76 | } |
  | 77 | 77 |  |
  | 78 |  | if ( ~~isset( $data['show\_if'] ) &&~~ ! empty( $data['show\_if'] ) ) { |
  |  | 78 | if ( ! empty( $data['show\_if'] ) ) { |
  | 79 | 79 | $cattr = 'data-show-if="' . $data['show\_if'] . '"'; |
  | 80 |  | ~~array\_push( $attr, $cattr )~~; |
  |  | 80 | $attr[] = $cattr; |
  | 81 | 81 | } |
  | 82 |  |  |
  | 83 |  | $value = ~~isset( $data['value'] ) ? $data['value'] :~~ ''; |
  | 84 |  |  |
  |  | 82 |  |
  |  | 83 | $value = $data['value'] ?? ''; |
  |  | 84 |  |
  | 85 | 85 | if ( $data['type'] == 'hidden' ) { |
  | 86 |  | echo '<input type="hidden" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" autocomplete="off" value="' . esc\_attr( $value ) . '" />'; |
  |  | 86 | echo '<input type="hidden" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" autocomplete="off" value="' . esc\_attr( $value ) . '" />'; |
  | 87 | 87 | return; |
  | 88 | 88 | } |
  | 89 | 89 |  |
  | 90 | 90 | $tooltip = ''; |
  | 91 |  | if ( ~~isset( $data['description'] ) &&~~ ! empty( $data['description'] ) ) { |
  |  | 91 | if ( ! empty( $data['description'] ) ) { |
  | 92 | 92 | if ( isset( $data['tooltip'] ) && $data['tooltip'] ) { |
  | 93 | 93 | $tooltip = '<span class="tooltip" title="' . esc\_attr( $data['description'] ) . '"><span title="" class="dashicons dashicons-editor-help"></span></span>'; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L96) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3137253#L96) |  |
  | 96 | 96 | } |
  | 97 | 97 | } |
  | 98 |  |  |
  | 99 |  | if ( $data['type'] == 'checkbox' ) { |
  |  | 98 |  |
  |  | 99 | if ( $data['type'] === 'checkbox' ) { |
  | 100 | 100 | $value = ! empty( $value ) ? $value : '1'; |
  | 101 | 101 | echo '<label class="switch">'; |
  | 102 |  | echo '<input type="checkbox" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" class="wplmi-form-el" value="' . esc\_attr( $value ) . '" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' /> |
  |  | 102 | echo '<input type="checkbox" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" class="wplmi-form-el" value="' . esc\_attr( $value ) . '" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' /> |
  | 103 | 103 | <span class="slider"> |
  | 104 | 104 | <svg width="3" height="8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 6" class="toggle-on" role="img" aria-hidden="true" focusable="false"><path d="M0 0h2v6H0z"></path></svg> |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L110) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3137253#L110) |  |
  | 110 | 110 |  |
  | 111 | 111 | if ( isset( $data['type'] ) ) { |
  | 112 |  | if ( in\_array( $data['type'], [ 'text', 'email', 'password', 'date', 'number' ] ) ) { |
  | 113 |  | echo '<input type="' . esc\_attr( $data['type'] ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" autocomplete="off" value="' . esc\_attr( $value ) . '" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' />'; |
  | 114 |  | } elseif ( $data['type'] == 'textarea' ) { |
  | 115 |  | echo '<textarea class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" id="' . esc\_attr( $data['id'] ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' autocomplete="off">' . wp\_kses\_post( $value ) . '</textarea>'; |
  | 116 |  | } elseif ( $data['type'] == 'select' ) { |
  |  | 112 | if ( in\_array( $data['type'], [ 'text', 'email', 'password', 'date', 'number' ], true ) ) { |
  |  | 113 | echo '<input type="' . esc\_attr( $data['type'] ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" autocomplete="off" value="' . esc\_attr( $value ) . '" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' />'; |
  |  | 114 | } elseif ( $data['type'] === 'textarea' ) { |
  |  | 115 | echo '<textarea class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" id="' . esc\_attr( $data['id'] ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' autocomplete="off">' . wp\_kses\_post( $value ) . '</textarea>'; |
  |  | 116 | } elseif ( $data['type'] === 'select' ) { |
  | 117 | 117 | if ( isset( $data['options'] ) && is\_array( $data['options'] ) ) { |
  | 118 |  | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' autocomplete="off">'; |
  |  | 118 | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' autocomplete="off">'; |
  | 119 | 119 | if ( ! empty( $data['options'] ) ) { |
  | 120 | 120 | foreach ( $data['options'] as $key => $option ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L128) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3137253#L128) |  |
  | 128 | 128 | echo '</select>'; |
  | 129 | 129 | } |
  | 130 |  | } elseif ( $data['type'] == 'multiple' ) { |
  |  | 130 | } elseif ( $data['type'] === 'multiple' ) { |
  | 131 | 131 | if ( isset( $data['options'] ) && is\_array( $data['options'] ) ) { |
  | 132 |  | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . '][]" multiple="multiple" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' style="width: 90%">'; |
  |  | 132 | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . '][]" multiple="multiple" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' style="width: 90%">'; |
  | 133 | 133 | if ( ! empty( $data['options'] ) ) { |
  | 134 | 134 | foreach ( $data['options'] as $key => $option ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L138) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3137253#L138) |  |
  | 138 | 138 | echo '</select>'; |
  | 139 | 139 | } |
  | 140 |  | } elseif ( $data['type'] == 'multiple\_tax' ) { |
  |  | 140 | } elseif ( $data['type'] === 'multiple\_tax' ) { |
  | 141 | 141 | if ( isset( $data['options'] ) && is\_array( $data['options'] ) ) { |
  | 142 |  | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . '][]" multiple="multiple" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' style="width: 90%">'; |
  |  | 142 | echo '<select id="' . esc\_attr( $data['id'] ) . '" class="' . esc\_attr( implode( ' ', array\_unique( $class ) ) ) . '" name="' . esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . '][]" multiple="multiple" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) ) . ' style="width: 90%">'; |
  | 143 | 143 | if ( ! empty( $data['options'] ) ) { |
  | 144 | 144 | foreach ( $data['options'] as $key => $option ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3052359#L154) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/Fields.php?rev=3137253#L154) |  |
  | 154 | 154 | echo '</select>'; |
  | 155 | 155 | } |
  | 156 |  | } elseif ( $data['type'] == 'wp\_editor' ) { |
  |  | 156 | } elseif ( $data['type'] === 'wp\_editor' ) { |
  | 157 | 157 | echo '<div class="wplmi-form-control wplmi-form-el wplmi-editor" ' . wp\_kses\_post( implode( ' ', array\_unique( $attr ) ) )  . '>'; |
  | 158 | 158 | wp\_editor( html\_entity\_decode( $value, ENT\_COMPAT, "UTF-8" ), $data['id'], [ |
  | 159 |  | 'textarea\_name' => ~~$this->option\_name~~ . '[' . esc\_attr( $name ) . ']', |
  |  | 159 | 'textarea\_name' => esc\_attr( $this->option\_name ) . '[' . esc\_attr( $name ) . ']', |
  | 160 | 160 | 'textarea\_rows' => '8', |
  | 161 | 161 | 'teeny'         => true, |
* ## [wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L11 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | namespace Wplmi\Helpers; |
  | 12 | 12 |  |
  | 13 |  | ~~use Wplmi\Helpers\SettingsData;~~ |
  | 14 |  |  |
  | 15 | 13 | defined( 'ABSPATH' ) || exit; |
  | 16 | 14 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L25) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L23) |  |
  | 25 | 23 | \* Get all registered public post types. |
  | 26 | 24 | \* |
  | 27 |  | \* @param bool $public Public type True or False. |
  |  | 25 | \* @param bool $post\_type\_public Public type True or False. |
  | 28 | 26 | \* @return array |
  | 29 | 27 | \*/ |
  | 30 |  | protected function get\_post\_types( ~~$public = true )~~ { |
  | 31 |  | $post\_types = get\_post\_types( [ 'public' => $public ], 'objects' ); |
  |  | 28 | protected function get\_post\_types( bool $post\_type\_public = true ): array { |
  |  | 29 | $post\_types = get\_post\_types( [ 'public' => $post\_type\_public ], 'objects' ); |
  | 32 | 30 | $data = []; |
  | 33 | 31 | foreach ( $post\_types as $post\_type ) { |
  | 34 | 32 | if ( ! is\_object( $post\_type ) ) { |
  | 35 |  | continue; |
  |  | 33 | continue; |
  | 36 | 34 | } |
  | 37 | 35 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L41) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L39) |  |
  | 41 | 39 | $label = $post\_type->name; |
  | 42 | 40 | } |
  | 43 |  |  |
  |  | 41 |  |
  | 44 | 42 | if ( $label == 'Media' || $label == 'media' || $post\_type->name == 'elementor\_library' ) { |
  | 45 | 43 | continue; // skip media |
  | 46 | 44 | } |
  | 47 |  |  |
  |  | 45 |  |
  | 48 | 46 | $data[ $post\_type->name ] = $label; |
  | 49 | 47 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L57) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L55) |  |
  | 57 | 55 | \* @param string     $format Date Format. |
  | 58 | 56 | \* @param object|int $post |
  | 59 |  | \* |
  |  | 57 | \* |
  | 60 | 58 | \* @return string |
  | 61 | 59 | \*/ |
  | 62 | 60 | protected function get\_modified\_date( $format = '', $post = null ) { |
  | 63 | 61 | $post = get\_post( $post ); |
  | 64 |  |  |
  |  | 62 |  |
  | 65 | 63 | if ( ! $post ) { |
  | 66 | 64 | $the\_time = false; |
  | 67 | 65 | } else { |
  | 68 | 66 | $\_format = ! empty( $format ) ? $format : get\_option( 'date\_format' ); |
  | 69 |  |  |
  |  | 67 |  |
  | 70 | 68 | $the\_time = get\_post\_modified\_time( $\_format, false, $post, true ); |
  | 71 | 69 | } |
  | 72 |  |  |
  |  | 70 |  |
  | 73 | 71 | return $the\_time; |
  | 74 | 72 | } |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L77) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L75) |  |
  | 77 | 75 | \* Insert the plugins settings in proper place. |
  | 78 | 76 | \* |
  | 79 |  | \* @param ~~array   $array~~     Default setting fields. |
  | 80 |  | \* @param integer $position  Insertion position. |
  | 81 |  | \* @param ~~array~~  $insert    Field. |
  |  | 77 | \* @param array $fields    Default setting fields. |
  |  | 78 | \* @param integer $position  Insertion position. |
  |  | 79 | \* @param array $insert    Field. |
  | 82 | 80 | \* @return array |
  | 83 | 81 | \*/ |
  | 84 |  | protected function insert\_settings( $array, $position, $insert ) { |
  | 85 |  | $array = array\_merge( array\_slice( $array, 0, $position ), $insert, array\_slice( $array, $position ) ); |
  | 86 |  |  |
  | 87 |  | return $array; |
  |  | 82 | protected function insert\_settings( array $fields, int $position, array $insert ): array { |
  |  | 83 | return array\_merge( array\_slice( $fields, 0, $position ), $insert, array\_slice( $fields, $position ) ); |
  | 88 | 84 | } |
  | 89 | 85 |  |
  | 90 | 86 | /\*\* |
  | 91 | 87 | \* Check plugin settings if enabled |
  | 92 |  | \* |
  | 93 |  | \* @param ~~string~~  $name  Settings field name. |
  | 94 |  | \* |
  |  | 88 | \* |
  |  | 89 | \* @param string $name  Settings field name. |
  |  | 90 | \* |
  | 95 | 91 | \* @return bool |
  | 96 | 92 | \*/ |
  | 97 |  | protected function is\_enabled( ~~$name )~~ { |
  |  | 93 | protected function is\_enabled( string $name ): bool { |
  | 98 | 94 | $data = $this->get\_data( 'lmt\_' . $name ); |
  | 99 |  | if ( $data == 1 ) { |
  | 100 |  | return true; |
  | 101 |  | } |
  | 102 |  |  |
  | 103 |  | return false; |
  |  | 95 |  |
  |  | 96 | return $data == 1; |
  | 104 | 97 | } |
  | 105 | 98 |  |
  | 106 | 99 | /\*\* |
  | 107 | 100 | \* Check plugin settings has a particular value |
  | 108 |  | \* |
  | 109 |  | \* @param ~~string~~  $name   Settings field name. |
  |  | 101 | \* |
  |  | 102 | \* @param string $name   Settings field name. |
  | 110 | 103 | \* @param  string  $value  Settings field value. |
  | 111 |  | \* |
  |  | 104 | \* |
  | 112 | 105 | \* @return bool |
  | 113 | 106 | \*/ |
  | 114 |  | protected function is\_equal( ~~$name, $value )~~ { |
  |  | 107 | protected function is\_equal( string $name, $value ): bool { |
  | 115 | 108 | $data = $this->get\_data( 'lmt\_' . $name ); |
  | 116 | 109 | if ( $data && $data == $value ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L122) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L115) |  |
  | 122 | 115 |  |
  | 123 | 116 | /\*\* |
  | 124 |  | ~~\* Check plugin settings has in a array~~ |
  | 125 |  | ~~\*~~ |
  | 126 |  | ~~\* @param  string  $name     Settings field name.~~ |
  | 127 |  | ~~\* @param  array   $value    Settings field values.~~ |
  | 128 |  | ~~\* @param  bool    $default  Default value.~~ |
  | 129 |  | ~~\*~~ |
  | 130 |  | ~~\* @return bool~~ |
  | 131 |  | ~~\*/~~ |
  | 132 |  | ~~protected function in\_array( $name, array $values, $default = false ) {~~ |
  | 133 |  | ~~$data = $this->get\_data( 'lmt\_' . $name, $default );~~ |
  | 134 |  |  |
  | 135 |  | ~~return in\_array( $name, $data, true );~~ |
  | 136 |  | ~~}~~ |
  | 137 |  |  |
  | 138 |  | ~~/\*\*~~ |
  | 139 | 117 | \* Check current user roles. |
  | 140 |  | \* |
  |  | 118 | \* |
  |  | 119 | \* @return array |
  | 141 | 120 | \* @since  1.8.0 |
  | 142 |  | ~~\* @return bool~~ |
  | 143 | 121 | \*/ |
  | 144 | 122 | protected function get\_users( $args = [] ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L155) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L133) |  |
  | 155 | 133 |  |
  | 156 | 134 | /\*\* |
  | 157 |  | ~~\* Date Time string to seconds and also from array~~ |
  | 158 |  | ~~\*~~ |
  | 159 |  | ~~\* @since 1.8.0~~ |
  | 160 |  | ~~\* @return string~~ |
  | 161 |  | ~~\*/~~ |
  | 162 |  | ~~protected function str\_to\_second( $input ) {~~ |
  | 163 |  | ~~$times = explode( ' ', preg\_replace( '!\s+!', ' ', str\_replace( [ ',', '-', '\_' ], ' ', $input ) ) );~~ |
  | 164 |  | ~~$total\_time = 0;~~ |
  | 165 |  | ~~foreach ( $times as $time ) {~~ |
  | 166 |  | ~~$total\_time += $this->convert\_str\_to\_second( $time );~~ |
  | 167 |  | ~~}~~ |
  | 168 |  |  |
  | 169 |  | ~~return $total\_time;~~ |
  | 170 |  | ~~}~~ |
  | 171 |  |  |
  | 172 |  | ~~/\*\*~~ |
  | 173 |  | ~~\* Convert Date Time string to seconds~~ |
  | 174 |  | ~~\*~~ |
  | 175 |  | ~~\* @since 1.3.0~~ |
  | 176 |  | ~~\* @return string~~ |
  | 177 |  | ~~\*/~~ |
  | 178 |  | ~~protected function convert\_str\_to\_second( $input ) {~~ |
  | 179 |  | ~~$res = preg\_replace( "/[^a-z]/i", '', strtolower( $input ) );~~ |
  | 180 |  | ~~if ( ! in\_array( $res, [ 'y', 'm', 'd', 'w', 'h', 'i' ] ) ) {~~ |
  | 181 |  | ~~return $input \* MINUTE\_IN\_SECONDS;~~ |
  | 182 |  | ~~}~~ |
  | 183 |  |  |
  | 184 |  | ~~$input = preg\_replace( "/[^0-9]/", '', $input );~~ |
  | 185 |  | ~~switch ( $res ) {~~ |
  | 186 |  | ~~case 'y':~~ |
  | 187 |  | ~~$output = $input \* YEAR\_IN\_SECONDS;~~ |
  | 188 |  | ~~break;~~ |
  | 189 |  | ~~case 'm':~~ |
  | 190 |  | ~~$output = $input \* MONTH\_IN\_SECONDS;~~ |
  | 191 |  | ~~break;~~ |
  | 192 |  | ~~case 'd':~~ |
  | 193 |  | ~~$output = $input \* DAY\_IN\_SECONDS;~~ |
  | 194 |  | ~~break;~~ |
  | 195 |  | ~~case 'w':~~ |
  | 196 |  | ~~$output = $input \* WEEK\_IN\_SECONDS;~~ |
  | 197 |  | ~~break;~~ |
  | 198 |  | ~~case 'h':~~ |
  | 199 |  | ~~$output = $input \* HOUR\_IN\_SECONDS;~~ |
  | 200 |  | ~~break;~~ |
  | 201 |  | ~~case 'i':~~ |
  | 202 |  | ~~$output = $input \* MINUTE\_IN\_SECONDS;~~ |
  | 203 |  | ~~break;~~ |
  | 204 |  | ~~default:~~ |
  | 205 |  | ~~$output = MINUTE\_IN\_SECONDS;~~ |
  | 206 |  | ~~}~~ |
  | 207 |  |  |
  | 208 |  | ~~return $output;~~ |
  | 209 |  | ~~}~~ |
  | 210 |  |  |
  | 211 |  | ~~/\*\*~~ |
  | 212 | 135 | \* Determines whether the current screen is an edit post screen. |
  | 213 | 136 | \* |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L215) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L138) |  |
  | 215 | 138 | \* @return bool Whether or not the current screen is editing an existing post. |
  | 216 | 139 | \*/ |
  | 217 |  | protected function is\_edit\_post\_screen() { |
  |  | 140 | protected function is\_edit\_post\_screen(): bool { |
  | 218 | 141 | if ( ! \is\_admin() ) { |
  | 219 | 142 | return false; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L226) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L149) |  |
  | 226 | 149 |  |
  | 227 | 150 | /\*\* |
  | 228 |  | \* Determines whether the current screen is a~~n~~ new post screen. |
  | 229 |  | \* |
  | 230 |  | \* @since 1.8.0 |
  | 231 |  | \* @return bool Whether ~~or not the current screen is editing an~~ new post. |
  | 232 |  | \*/ |
  | 233 |  | protected function is\_new\_post\_screen() { |
  |  | 151 | \* Determines whether the current screen is a new post screen. |
  |  | 152 | \* |
  |  | 153 | \* @since 1.8.0 |
  |  | 154 | \* @return bool Whether the current screen is editing a new post. |
  |  | 155 | \*/ |
  |  | 156 | protected function is\_new\_post\_screen(): bool { |
  | 234 | 157 | if ( ! \is\_admin() ) { |
  | 235 | 158 | return false; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L247) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L170) |  |
  | 247 | 170 | \* @return bool Whether we are currently editing a post with Classic editor. |
  | 248 | 171 | \*/ |
  | 249 |  | protected function is\_classic\_editor() { |
  |  | 172 | protected function is\_classic\_editor(): bool { |
  | 250 | 173 | if ( ! $this->is\_edit\_post\_screen() && ! $this->is\_new\_post\_screen() ) { |
  | 251 | 174 | return false; |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L266) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L189) |  |
  | 266 | 189 | \* @return bool Whether we are currently editing a post with Block editor. |
  | 267 | 190 | \*/ |
  | 268 |  | protected function is\_block\_editor() { |
  |  | 191 | protected function is\_block\_editor(): bool { |
  | 269 | 192 | $screen = \get\_current\_screen(); |
  | 270 | 193 | if ( \method\_exists( $screen, 'is\_block\_editor' ) && $screen->is\_block\_editor() ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=2930921#L283) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/HelperFunctions.php?rev=3137253#L206) |  |
  | 283 | 206 | \* @return bool Whether or not the post can be copied to a new draft. |
  | 284 | 207 | \*/ |
  | 285 |  | protected function post\_type\_has\_admin\_bar( $post\_type ) { |
  |  | 208 | protected function post\_type\_has\_admin\_bar( $post\_type ): bool { |
  | 286 | 209 | $post\_type\_object = \get\_post\_type\_object( $post\_type ); |
  | 287 | 210 |  |
* ## [wp-last-modified-info/trunk/inc/Helpers/SettingsData.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Helpers/SettingsData.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=2930921#L73 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=3137253#L73 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 73 | 73 | \* retreive plugin data. |
  | 74 | 74 | \* |
  | 75 |  | \* @param string $key         Option key. |
  | 76 |  | \* @param mixed  $~~value~~    Default value |
  |  | 75 | \* @param string $key             Option key. |
  |  | 76 | \* @param mixed  $default\_value   Default value |
  | 77 | 77 | \* |
  | 78 | 78 | \* @return mixed |
  | 79 | 79 | \*/ |
  | 80 |  | protected function get\_data( $key, $default = false ) { |
  |  | 80 | protected function get\_data( $key, $default\_value = false ) { |
  | 81 | 81 | $settings = get\_option( 'lmt\_plugin\_global\_settings' ); |
  | 82 | 82 |  |
  | 83 |  | return ( ~~isset( $settings[ $key ] ) && ! empty( $settings[ $key ] ) ) ? $settings[ $key ] : $default~~; |
  |  | 83 | return ( ! empty( $settings[ $key ] )) ? $settings[ $key ] : $default\_value; |
  | 84 | 84 | } |
  | 85 | 85 |  |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=2930921#L92) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=3137253#L92) |  |
  | 92 | 92 | \* @return mixed |
  | 93 | 93 | \*/ |
  | 94 |  | protected function build\_meta( $post\_id, $meta\_key, $default = false, $unserialize = false, $single = true ) { |
  |  | 94 | protected function build\_meta( $post\_id, $meta\_key, $default\_value = false, $unserialize = false, $single = true ) { |
  | 95 | 95 | $meta = $this->get\_meta( $post\_id, $meta\_key, $single ); |
  | 96 | 96 | if ( $unserialize ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=2930921#L98) | […](/browser/wp-last-modified-info/trunk/inc/Helpers/SettingsData.php?rev=3137253#L98) |  |
  | 98 | 98 | } |
  | 99 | 99 |  |
  | 100 |  | return ( ! empty( $meta ) ) ? $meta : $default; |
  |  | 100 | return ( ! empty( $meta ) ) ? $meta : $default\_value; |
  | 101 | 101 | } |
  | 102 | 102 | } |
* ## [wp-last-modified-info/trunk/inc/Loader.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Loader.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Loader.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=2930921#L18 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=3137253#L18 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 18 | 18 | /\*\* |
  | 19 | 19 | \* Store all the classes inside an array |
  | 20 |  | \* |
  |  | 20 | \* |
  | 21 | 21 | \* @return array Full list of classes |
  | 22 | 22 | \*/ |
  | 23 |  | public static function get\_services() { |
  | 24 |  | ~~$services =~~ [ |
  |  | 23 | public static function get\_services(): array { |
  |  | 24 | return [ |
  | 25 | 25 | Base\Enqueue::class, |
  | 26 | 26 | Base\MiscActions::class, |
  | […](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=2930921#L48) | […](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=3137253#L48) |  |
  | 48 | 48 | Pages\Dashboard::class, |
  | 49 | 49 | ]; |
  | 50 |  |  |
  | 51 |  | ~~return $services;~~ |
  | 52 | 50 | } |
  | 53 | 51 |  |
  | 54 | 52 | /\*\* |
  | 55 |  | \* Loop through the classes, initialize them, |
  |  | 53 | \* Loop through the classes, initialize them, |
  | 56 | 54 | \* and call the register() method if it exists |
  | 57 | 55 | \*/ |
  | […](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=2930921#L59) | […](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=3137253#L57) |  |
  | 59 | 57 | foreach ( self::get\_services() as $class ) { |
  | 60 | 58 | $service = self::instantiate( $class ); |
  |  | 59 |  |
  | 61 | 60 | if ( method\_exists( $service, 'register' ) ) { |
  | 62 | 61 | $service->register(); |
  | […](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=2930921#L67) | […](/browser/wp-last-modified-info/trunk/inc/Loader.php?rev=3137253#L66) |  |
  | 67 | 66 | /\*\* |
  | 68 | 67 | \* Initialize the class |
  | 69 |  | \* |
  | 70 |  | \* @param ~~class $class~~   class from the services array |
  | 71 |  | \* @return class instance  new instance of the class |
  |  | 68 | \* |
  |  | 69 | \* @param string $wplmi\_class  class from the services array |
  |  | 70 | \* @return class instance      new instance of the class |
  | 72 | 71 | \*/ |
  | 73 |  | private static function instantiate( $class ) { |
  | 74 |  | $service = new $class(); |
  | 75 |  |  |
  | 76 |  | return $service; |
  |  | 72 | private static function instantiate( string $wplmi\_class ) { |
  |  | 73 | return new $wplmi\_class(); |
  | 77 | 74 | } |
  | 78 | 75 | } |
* ## [wp-last-modified-info/trunk/inc/Pages/Dashboard.php](/changeset/3137253/wp-last-modified-info/trunk/inc/Pages/Dashboard.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/inc/Pages/Dashboard.php")

  | [r3033702](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L1 "Show revision 3033702 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php |
  |  | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Dashboard actions. |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L24) | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3137253#L24) |  |
  | 24 | 24 | class Dashboard |
  | 25 | 25 | { |
  | 26 |  | use HelperFunctions, Hooker; |
  |  | 26 | use HelperFunctions; |
  |  | 27 | use Hooker; |
  | 27 | 28 |  |
  | 28 | 29 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L84) | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3137253#L85) |  |
  | 84 | 85 | $this->sub\_pages = [ |
  | 85 | 86 | [ |
  | 86 |  | 'parent\_slug' => 'options-general.php', |
  | 87 |  | 'page\_title'  => \_\_( 'WP Last Modified Info', 'wp-last-modified-info' ), |
  | 88 |  | 'menu\_title'  => \_\_( 'WP Last Modified Info', 'wp-last-modified-info' ), |
  | 89 |  | 'capability'  => 'manage\_options', |
  | 90 |  | 'menu\_slug'   => 'wp-last-modified-info', |
  |  | 87 | 'parent\_slug' => 'options-general.php', |
  |  | 88 | 'page\_title'  => \_\_( 'WP Last Modified Info', 'wp-last-modified-info' ), |
  |  | 89 | 'menu\_title'  => \_\_( 'WP Last Modified Info', 'wp-last-modified-info' ), |
  |  | 90 | 'capability'  => 'manage\_options', |
  |  | 91 | 'menu\_slug'   => 'wp-last-modified-info', |
  | 91 | 92 | 'callback'    => [ $this->callbacks, 'adminDashboard' ], |
  | 92 | 93 | ], |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L102) | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3137253#L103) |  |
  | 102 | 103 | 'option\_group' => 'wplmi\_plugin\_settings\_fields', |
  | 103 | 104 | 'option\_name'  => 'lmt\_plugin\_global\_settings', |
  | 104 |  | 'callback'     => [ |
  |  | 105 | 'callback'     => [ |
  | 105 | 106 | 'sanitize\_callback' => [ $this, 'sanitizeOutput' ], |
  | 106 | 107 | ], |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L115) | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3137253#L116) |  |
  | 115 | 116 | \*/ |
  | 116 | 117 | public function setSections() { |
  | 117 |  | $sections = [ |
  |  | 118 | $sections = [ |
  | 118 | 119 | 'post'         => \_\_( 'Post Options', 'wp-last-modified-info' ), |
  | 119 | 120 | 'template\_tag' => \_\_( 'Template Tags', 'wp-last-modified-info' ), |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L122) | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3137253#L123) |  |
  | 122 | 123 | 'misc'         => \_\_( 'Miscellaneous Options', 'wp-last-modified-info' ), |
  | 123 | 124 | ]; |
  | 124 |  |  |
  |  | 125 |  |
  | 125 | 126 | $args = []; |
  | 126 | 127 | foreach ( $sections as $section => $title ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L222) | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3137253#L223) |  |
  | 222 | 223 | \* @return  array  $output  The sanitized input. |
  | 223 | 224 | \*/ |
  | 224 |  | public function sanitizeOutput( $input ) { |
  |  | 225 | public function sanitizeOutput( $input ) { |
  | 225 | 226 | $output = []; |
  | 226 | 227 | $fields = [ 'lmt\_last\_modified\_info\_template', 'lmt\_last\_modified\_info\_template\_tt', 'lmt\_email\_subject', 'lmt\_email\_message' ]; |
  | 227 |  |  |
  |  | 228 |  |
  | 228 | 229 | foreach ( $input as $key => $value ) { |
  | 229 | 230 | if ( in\_array( $key, $fields ) ) { |
  | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3033702#L233) | […](/browser/wp-last-modified-info/trunk/inc/Pages/Dashboard.php?rev=3137253#L234) |  |
  | 233 | 234 | } |
  | 234 | 235 | } |
  | 235 |  |  |
  |  | 236 |  |
  | 236 | 237 | return $this->do\_filter( 'validate\_input', $output, $input ); |
  | 237 | 238 | } |
* ## [wp-last-modified-info/trunk/readme.txt](/changeset/3137253/wp-last-modified-info/trunk/readme.txt "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/readme.txt")

  | [r3052359](/browser/wp-last-modified-info/trunk/readme.txt?rev=3052359#L1 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/readme.txt?rev=3137253#L1 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === WP Last Modified Info === |
  | 2 | 2 | Contributors: infosatech |
  | 3 |  | Tags: last modified, timestamp, modified time, post modified, sort by modified~~, time, date~~ |
  |  | 3 | Tags: last modified, timestamp, modified time, post modified, sort by modified |
  | 4 | 4 | Requires at least: 4.7 |
  | 5 |  | Tested up to: 6.~~5~~ |
  | 6 |  | Stable tag: 1.9.~~0~~ |
  |  | 5 | Tested up to: 6.6 |
  |  | 6 | Stable tag: 1.9.1 |
  | 7 | 7 | Requires PHP: 7.0 |
  | 8 | 8 | Donate link: https://www.paypal.me/iamsayan/ |
  | […](/browser/wp-last-modified-info/trunk/readme.txt?rev=3052359#L165) | […](/browser/wp-last-modified-info/trunk/readme.txt?rev=3137253#L165) |  |
  | 165 | 165 | If you like WP Last Modified Info, please take a moment to [give a 5-star rating](https://wordpress.org/support/plugin/wp-last-modified-info/reviews/?rate=5#new-post). It helps to keep development and support going strong. Thank you! |
  | 166 | 166 |  |
  |  | 167 | = 1.9.1 = |
  |  | 168 | Release Date: August 9, 2024 |
  |  | 169 |  |
  |  | 170 | \* Added changes according to WPCS. |
  |  | 171 | \* Tested with WordPress v6.6. |
  |  | 172 |  |
  | 167 | 173 | = 1.9.0 = |
  | 168 | 174 | Release Date: March 17, 2024 |
* ## [wp-last-modified-info/trunk/templates/admin.php](/changeset/3137253/wp-last-modified-info/trunk/templates/admin.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/templates/admin.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L11 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3137253#L11 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 |  |
  | 12 | 12 | <div id="wplmi-nav-container" class="wplmi-admin-toolbar"> |
  | 13 |  | <h2>WP Last Modified Info<span class="title-count"><?~~php echo~~ esc\_html( $this->version ); ?></span></h2> |
  | 14 |  |  |
  |  | 13 | <h2>WP Last Modified Info<span class="title-count"><?= esc\_html( $this->version ); ?></span></h2> |
  |  | 14 |  |
  | 15 | 15 | <a href="#post" class="wplmi-tab is-active" id="wplmi-tab-post"><?php esc\_html\_e( 'Posts', 'wp-last-modified-info' ); ?></a> |
  | 16 | 16 | <a href="#template" class="wplmi-tab" id="wplmi-tab-template"><?php esc\_html\_e( 'Template Tag', 'wp-last-modified-info' ); ?></a> |
  | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L142) | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3137253#L142) |  |
  | 142 | 142 | </li> |
  | 143 | 143 | <li> |
  | 144 |  | <?php printf( |
  |  | 144 | <?php printf( |
  | 145 | 145 | /\* translators: %s: code html tag \*/ |
  | 146 | 146 | esc\_html\_\_( 'Do I need to add %s tag?', 'wp-last-modified-info' ), '<code>&lt;style&gt; &lt;/style&gt;</code>' ); ?> |
  | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L149) | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3137253#L149) |  |
  | 149 | 149 | <li> |
  | 150 | 150 | <?php esc\_html\_e( 'How to set custom date/time format?', 'wp-last-modified-info' ); ?> |
  | 151 |  | <p><?php printf( |
  |  | 151 | <p><?php printf( |
  | 152 | 152 | /\* translators: %s: html tags \*/ |
  | 153 | 153 | esc\_html\_\_( 'Go to %1$sWordPress Date/Time Syntax%2$s page and read instructions about Date/Time Syntax.', 'wp-last-modified-info' ), '<a href="https://wordpress.org/support/article/formatting-date-and-time/" target="\_blank">', '</a>' ); ?></p> |
  | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L164) | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3137253#L164) |  |
  | 164 | 164 | </li> |
  | 165 | 165 | <li><?php esc\_html\_e( 'How to use shortcodes?', 'wp-last-modified-info' ); ?> |
  | 166 |  | <p><?php printf( |
  |  | 166 | <p><?php printf( |
  | 167 | 167 | /\* translators: %s: shortcodes \*/ |
  | 168 | 168 | esc\_html\_\_( 'You can insert the last modified info by simply using the shortcode. Shortcode for posts/pages/custom post types is %1$s. To enter the shortcode directly into templates using PHP, use %2$s for any post types. You can use %3$s to display global site modified info on website frontend.', 'wp-last-modified-info' ), '<code>[lmt-post-modified-info]</code>', '<code>echo do\_shortcode( &#39;[lmt-post-modified-info]&#39; );</code>', '<code>[lmt-site-modified-info]</code>' ); ?></p> |
  | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3052359#L204) | […](/browser/wp-last-modified-info/trunk/templates/admin.php?rev=3137253#L204) |  |
  | 204 | 204 | </div> |
  | 205 | 205 | <span class="coffee-heading"><?php esc\_html\_e( 'Buy me a coffee!', 'wp-last-modified-info' ); ?></span> |
  | 206 |  | <p style="text-align: justify;"><?php printf( |
  |  | 206 | <p style="text-align: justify;"><?php printf( |
  | 207 | 207 | /\* translators: %s: plugin name \*/ |
  | 208 | 208 | esc\_html\_\_( 'Thank you for using %s. If you found the plugin useful buy me a coffee! Your donation will motivate and make me happy for all the efforts. You can donate via PayPal.', 'wp-last-modified-info' ), '<strong>WP Last Modified Info v' . esc\_html( $this->version ) . '</strong>' ); ?></strong> |
* ## [wp-last-modified-info/trunk/uninstall.php](/changeset/3137253/wp-last-modified-info/trunk/uninstall.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/uninstall.php")

  | [r2930921](/browser/wp-last-modified-info/trunk/uninstall.php?rev=2930921#L33 "Show revision 2930921 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/uninstall.php?rev=3137253#L33 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 33 | 33 | } else { |
  | 34 | 34 | global $wpdb; |
  | 35 |  |  |
  |  | 35 |  |
  | 36 | 36 | $blog\_ids = $wpdb->get\_col( "SELECT blog\_id FROM $wpdb->blogs" ); |
  | 37 | 37 | $original\_blog\_id = get\_current\_blog\_id(); |
  | 38 |  | foreach ( $blog\_ids as $blog\_id ) { |
  | 39 |  | switch\_to\_blog( $blog\_id ); |
  |  | 38 | foreach ( $blog\_ids as $wp\_blog\_id ) { |
  |  | 39 | switch\_to\_blog( $wp\_blog\_id ); |
  | 40 | 40 | $options = get\_option( $option\_name ); |
  | 41 | 41 | if ( isset( $options['lmt\_del\_plugin\_data\_cb'] ) && $options['lmt\_del\_plugin\_data\_cb'] == 1 ) { |
* ## [wp-last-modified-info/trunk/vendor/composer/installed.php](/changeset/3137253/wp-last-modified-info/trunk/vendor/composer/installed.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/vendor/composer/installed.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/vendor/composer/installed.php?rev=3052359#L4 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/vendor/composer/installed.php?rev=3137253#L4 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | 'pretty\_version' => 'dev-master', |
  | 5 | 5 | 'version' => 'dev-master', |
  | 6 |  | 'reference' => '~~a96bfe39997587b1f9b8bce640592056862701a3~~', |
  |  | 6 | 'reference' => '4101109995a08c6c2539990de6b88a792703df27', |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/wp-last-modified-info/trunk/vendor/composer/installed.php?rev=3052359#L23) | […](/browser/wp-last-modified-info/trunk/vendor/composer/installed.php?rev=3137253#L23) |  |
  | 23 | 23 | 'pretty\_version' => 'dev-master', |
  | 24 | 24 | 'version' => 'dev-master', |
  | 25 |  | 'reference' => '~~a96bfe39997587b1f9b8bce640592056862701a3~~', |
  |  | 25 | 'reference' => '4101109995a08c6c2539990de6b88a792703df27', |
  | 26 | 26 | 'type' => 'wordpress-plugin', |
  | 27 | 27 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
* ## [wp-last-modified-info/trunk/wp-last-modified-info.php](/changeset/3137253/wp-last-modified-info/trunk/wp-last-modified-info.php "Show the changeset 3137253 restricted to wp-last-modified-info/trunk/wp-last-modified-info.php")

  | [r3052359](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L4 "Show revision 3052359 of this file in browser") | [r3137253](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253#L4 "Show revision 3137253 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/wp-last-modified-info/ |
  | 5 | 5 | \* Description: Ultimate Last Modified Plugin for WordPress with Gutenberg Block Integration. It is possible to use shortcodes to display last modified info anywhere on a WordPress site running 4.7 and beyond. |
  | 6 |  | \* Version: 1.9.~~0~~ |
  |  | 6 | \* Version: 1.9.1 |
  | 7 | 7 | \* Author: Sayan Datta |
  | 8 | 8 | \* Author URI: https://www.sayandatta.co.in |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L10) | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253#L10) |  |
  | 10 | 10 | \* Text Domain: wp-last-modified-info |
  | 11 | 11 | \* Domain Path: /languages |
  | 12 |  | \* |
  |  | 12 | \* |
  | 13 | 13 | \* WP Last Modified Info is free software: you can redistribute it and/or modify |
  | 14 | 14 | \* it under the terms of the GNU General Public License as published by |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L23) | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253#L23) |  |
  | 23 | 23 | \* You should have received a copy of the GNU General Public License |
  | 24 | 24 | \* along with WP Last Modified Info. If not, see <http://www.gnu.org/licenses/>. |
  | 25 |  | \* |
  |  | 25 | \* |
  | 26 | 26 | \* @category Core |
  | 27 | 27 | \* @package  WP Last Modified Info |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L29) | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253#L29) |  |
  | 29 | 29 | \* @license  http://www.gnu.org/licenses/ GNU General Public License |
  | 30 | 30 | \* @link     https://wordpress.org/plugins/wp-last-modified-info/ |
  | 31 |  | \* |
  |  | 31 | \* |
  | 32 | 32 | \*/ |
  | 33 | 33 |  |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L47) | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253#L47) |  |
  | 47 | 47 | \* @var string |
  | 48 | 48 | \*/ |
  | 49 |  | public $version = '1.9.~~0~~'; |
  |  | 49 | public $version = '1.9.1'; |
  | 50 | 50 |  |
  | 51 | 51 | /\*\* |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L162) | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253#L162) |  |
  | 162 | 162 | <div class="notice wplmi-notice notice-error"> |
  | 163 | 163 | <p> |
  | 164 |  | <?~~php echo~~ join( '<br>', $this->messages ); // phpcs:ignore ?> |
  |  | 164 | <?= join( '<br>', $this->messages ); // phpcs:ignore ?> |
  | 165 | 165 | </p> |
  | 166 | 166 | </div> |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L183) | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253#L183) |  |
  | 183 | 183 | \*/ |
  | 184 | 184 | private function includes() { |
  | 185 |  | include ~~dirname( \_\_FILE\_\_ )~~ . '/vendor/autoload.php'; |
  |  | 185 | include \_\_DIR\_\_ . '/vendor/autoload.php'; |
  | 186 | 186 | } |
  | 187 | 187 |  |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L191) | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253#L191) |  |
  | 191 | 191 | private function instantiate() { |
  | 192 | 192 | // Activation hook. |
  | 193 |  | register\_activation\_hook( WPLMI\_FILE, |
  |  | 193 | register\_activation\_hook( WPLMI\_FILE, |
  | 194 | 194 | function () { |
  | 195 | 195 | Wplmi\Base\Activate::activate(); |
  | 196 |  | } |
  |  | 196 | } |
  | 197 | 197 | ); |
  | 198 | 198 |  |
  | 199 | 199 | // Deactivation hook. |
  | 200 |  | register\_deactivation\_hook( WPLMI\_FILE, |
  |  | 200 | register\_deactivation\_hook( WPLMI\_FILE, |
  | 201 | 201 | function () { |
  | 202 | 202 | Wplmi\Base\Deactivate::deactivate(); |
  | 203 |  | } |
  |  | 203 | } |
  | 204 | 204 | ); |
  | 205 | 205 |  |
  | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3052359#L214) | […](/browser/wp-last-modified-info/trunk/wp-last-modified-info.php?rev=3137253#L214) |  |
  | 214 | 214 | \* @return WPLMI |
  | 215 | 215 | \*/ |
  | 216 |  | function wplmi() { |
  |  | 216 | function wplmi() { // phpcs:ignore Universal.Files.SeparateFunctionsFromOO.Mixed |
  | 217 | 217 | return WPLMI::get(); |
  | 218 | 218 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3137253)
* [Zip Archive](?format=zip&new=3137253)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

