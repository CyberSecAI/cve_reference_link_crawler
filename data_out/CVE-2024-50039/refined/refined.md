```
{
  "CVE-2024-50039": {
    "description": "The Linux kernel is vulnerable to a null pointer dereference in the 'sfq_dequeue' function within 'net/sched/sch_sfq.c'. This occurs due to incorrect handling of the TCA_STAB attribute for non-root qdiscs, specifically when a TBF (Token Bucket Filter) qdisc is combined with an SFQ (Stochastic Fairness Queueing) qdisc. The vulnerability leads to a kernel crash when attempting to dequeue packets from the SFQ qdisc if the stab is set on it.",
    "root_cause": "The vulnerability is caused by an attempt to use the TCA_STAB attribute on a non-root qdisc (SFQ in this case). The qdisc code assumes that packet lengths are invariant between enqueue and dequeue operations, which is not guaranteed when a stab is set on non-root qdiscs. This leads to a null pointer dereference when the SFQ attempts to access the stab data.",
    "weaknesses": [
      "Incorrect handling of TCA_STAB attribute on non-root qdiscs.",
      "Assumption of invariant packet length between enqueue and dequeue in qdiscs.",
       "Lack of per-qdisc storage for stab data."
    ],
    "impact": "The primary impact of this vulnerability is a kernel crash, leading to a denial of service on the affected system. The crash occurs when the SFQ dequeue function attempts to dereference a null pointer related to stab data which causes a page fault.",
    "attack_vectors": [
      "Setting the TCA_STAB attribute on a non-root qdisc using traffic control (tc) commands or a similar mechanism.",
      "Specifically, using a TBF (Token Bucket Filter) qdisc in combination with an SFQ (Stochastic Fairness Queueing) qdisc, with a stab set on the SFQ."
    ],
    "required_capabilities": "An attacker needs the capability to configure traffic control (tc) settings, which typically requires root or CAP_NET_ADMIN privileges. An attacker must be able to set the stab attribute on a non-root qdisc. This attack vector was discovered by syzbot"
  }
}
```