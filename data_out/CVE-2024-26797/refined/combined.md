=== Content from git.kernel.org_8b5baf86_20250110_180752.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=50a6302cf881f67f1410461a68fe9eabd00ff31d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=50a6302cf881f67f1410461a68fe9eabd00ff31d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=50a6302cf881f67f1410461a68fe9eabd00ff31d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=50a6302cf881f67f1410461a68fe9eabd00ff31d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Srinivasan Shanmugam <srinivasan.shanmugam@amd.com> | 2024-02-20 09:14:25 +0530 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-03-06 14:53:53 +0000 |
| commit | [50a6302cf881f67f1410461a68fe9eabd00ff31d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=50a6302cf881f67f1410461a68fe9eabd00ff31d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=50a6302cf881f67f1410461a68fe9eabd00ff31d)) | |
| tree | [a0efdb94a1c21e8191858fa5b152be61d5cbebe6](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=50a6302cf881f67f1410461a68fe9eabd00ff31d) | |
| parent | [fe02316e4933befc621fa125efb8f8b4d04cceec](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fe02316e4933befc621fa125efb8f8b4d04cceec) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=50a6302cf881f67f1410461a68fe9eabd00ff31d&id2=fe02316e4933befc621fa125efb8f8b4d04cceec)) | |
| download | [linux-50a6302cf881f67f1410461a68fe9eabd00ff31d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-50a6302cf881f67f1410461a68fe9eabd00ff31d.tar.gz) | |

drm/amd/display: Prevent potential buffer overflow in map\_hw\_resources[ Upstream commit 0f8ca019544a252d1afb468ce840c6dcbac73af4 ]
Adds a check in the map\_hw\_resources function to prevent a potential
buffer overflow. The function was accessing arrays using an index that
could potentially be greater than the size of the arrays, leading to a
buffer overflow.
Adds a check to ensure that the index is within the bounds of the
arrays. If the index is out of bounds, an error message is printed and
break it will continue execution with just ignoring extra data early to
prevent the buffer overflow.
Reported by smatch:
drivers/gpu/drm/amd/amdgpu/../display/dc/dml2/dml2\_wrapper.c:79 map\_hw\_resources() error: buffer overflow 'dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.disp\_cfg\_to\_stream\_id' 6 <= 7
drivers/gpu/drm/amd/amdgpu/../display/dc/dml2/dml2\_wrapper.c:81 map\_hw\_resources() error: buffer overflow 'dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.disp\_cfg\_to\_plane\_id' 6 <= 7
Fixes: 7966f319c66d ("drm/amd/display: Introduce DML2")
Cc: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>
Cc: Roman Li <roman.li@amd.com>
Cc: Qingqing Zhuo <Qingqing.Zhuo@amd.com>
Cc: Aurabindo Pillai <aurabindo.pillai@amd.com>
Cc: Tom Chung <chiahsuan.chung@amd.com>
Signed-off-by: Srinivasan Shanmugam <srinivasan.shanmugam@amd.com>
Suggested-by: Roman Li <roman.li@amd.com>
Reviewed-by: Roman Li <roman.li@amd.com>
Reviewed-by: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=50a6302cf881f67f1410461a68fe9eabd00ff31d)

| -rw-r--r-- | [drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/amd/display/dc/dml2/dml2_wrapper.c?id=50a6302cf881f67f1410461a68fe9eabd00ff31d) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.c b/drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.cindex 8f231418870f2a..c62b61ac45d27e 100644--- a/[drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/display/dc/dml2/dml2_wrapper.c?id=fe02316e4933befc621fa125efb8f8b4d04cceec)+++ b/[drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/display/dc/dml2/dml2_wrapper.c?id=50a6302cf881f67f1410461a68fe9eabd00ff31d)@@ -76,6 +76,11 @@ static void map\_hw\_resources(struct dml2\_context \*dml2, in\_out\_display\_cfg->hw.DLGRefClkFreqMHz = 50; } for (j = 0; j < mode\_support\_info->DPPPerSurface[i]; j++) {+ if (i >= \_\_DML2\_WRAPPER\_MAX\_STREAMS\_PLANES\_\_) {+ dml\_print("DML::%s: Index out of bounds: i=%d, \_\_DML2\_WRAPPER\_MAX\_STREAMS\_PLANES\_\_=%d\n",+ \_\_func\_\_, i, \_\_DML2\_WRAPPER\_MAX\_STREAMS\_PLANES\_\_);+ break;+ } dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.dml\_pipe\_idx\_to\_stream\_id[num\_pipes] = dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.disp\_cfg\_to\_stream\_id[i]; dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.dml\_pipe\_idx\_to\_stream\_id\_valid[num\_pipes] = true; dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.dml\_pipe\_idx\_to\_plane\_id[num\_pipes] = dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.disp\_cfg\_to\_plane\_id[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 18:06:30 +0000



=== Content from git.kernel.org_8229aa06_20250110_180752.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0f8ca019544a252d1afb468ce840c6dcbac73af4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0f8ca019544a252d1afb468ce840c6dcbac73af4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0f8ca019544a252d1afb468ce840c6dcbac73af4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f8ca019544a252d1afb468ce840c6dcbac73af4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Srinivasan Shanmugam <srinivasan.shanmugam@amd.com> | 2024-02-20 09:14:25 +0530 |
| --- | --- | --- |
| committer | Alex Deucher <alexander.deucher@amd.com> | 2024-02-27 12:20:42 -0500 |
| commit | [0f8ca019544a252d1afb468ce840c6dcbac73af4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0f8ca019544a252d1afb468ce840c6dcbac73af4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0f8ca019544a252d1afb468ce840c6dcbac73af4)) | |
| tree | [d769de94fa920d295cc7b0f265edee8e27e69f8f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0f8ca019544a252d1afb468ce840c6dcbac73af4) | |
| parent | [d206a76d7d2726f3b096037f2079ce0bd3ba329b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d206a76d7d2726f3b096037f2079ce0bd3ba329b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f8ca019544a252d1afb468ce840c6dcbac73af4&id2=d206a76d7d2726f3b096037f2079ce0bd3ba329b)) | |
| download | [linux-0f8ca019544a252d1afb468ce840c6dcbac73af4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0f8ca019544a252d1afb468ce840c6dcbac73af4.tar.gz) | |

drm/amd/display: Prevent potential buffer overflow in map\_hw\_resourcesAdds a check in the map\_hw\_resources function to prevent a potential
buffer overflow. The function was accessing arrays using an index that
could potentially be greater than the size of the arrays, leading to a
buffer overflow.
Adds a check to ensure that the index is within the bounds of the
arrays. If the index is out of bounds, an error message is printed and
break it will continue execution with just ignoring extra data early to
prevent the buffer overflow.
Reported by smatch:
drivers/gpu/drm/amd/amdgpu/../display/dc/dml2/dml2\_wrapper.c:79 map\_hw\_resources() error: buffer overflow 'dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.disp\_cfg\_to\_stream\_id' 6 <= 7
drivers/gpu/drm/amd/amdgpu/../display/dc/dml2/dml2\_wrapper.c:81 map\_hw\_resources() error: buffer overflow 'dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.disp\_cfg\_to\_plane\_id' 6 <= 7
Fixes: 7966f319c66d ("drm/amd/display: Introduce DML2")
Cc: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>
Cc: Roman Li <roman.li@amd.com>
Cc: Qingqing Zhuo <Qingqing.Zhuo@amd.com>
Cc: Aurabindo Pillai <aurabindo.pillai@amd.com>
Cc: Tom Chung <chiahsuan.chung@amd.com>
Signed-off-by: Srinivasan Shanmugam <srinivasan.shanmugam@amd.com>
Suggested-by: Roman Li <roman.li@amd.com>
Reviewed-by: Roman Li <roman.li@amd.com>
Reviewed-by: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f8ca019544a252d1afb468ce840c6dcbac73af4)

| -rw-r--r-- | [drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/amd/display/dc/dml2/dml2_wrapper.c?id=0f8ca019544a252d1afb468ce840c6dcbac73af4) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.c b/drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.cindex 26307e599614c6..2a58a7687bdb57 100644--- a/[drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/display/dc/dml2/dml2_wrapper.c?id=d206a76d7d2726f3b096037f2079ce0bd3ba329b)+++ b/[drivers/gpu/drm/amd/display/dc/dml2/dml2\_wrapper.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/display/dc/dml2/dml2_wrapper.c?id=0f8ca019544a252d1afb468ce840c6dcbac73af4)@@ -76,6 +76,11 @@ static void map\_hw\_resources(struct dml2\_context \*dml2, in\_out\_display\_cfg->hw.DLGRefClkFreqMHz = 50; } for (j = 0; j < mode\_support\_info->DPPPerSurface[i]; j++) {+ if (i >= \_\_DML2\_WRAPPER\_MAX\_STREAMS\_PLANES\_\_) {+ dml\_print("DML::%s: Index out of bounds: i=%d, \_\_DML2\_WRAPPER\_MAX\_STREAMS\_PLANES\_\_=%d\n",+ \_\_func\_\_, i, \_\_DML2\_WRAPPER\_MAX\_STREAMS\_PLANES\_\_);+ break;+ } dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.dml\_pipe\_idx\_to\_stream\_id[num\_pipes] = dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.disp\_cfg\_to\_stream\_id[i]; dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.dml\_pipe\_idx\_to\_stream\_id\_valid[num\_pipes] = true; dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.dml\_pipe\_idx\_to\_plane\_id[num\_pipes] = dml2->v20.scratch.dml\_to\_dc\_pipe\_mapping.disp\_cfg\_to\_plane\_id[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 18:06:29 +0000


