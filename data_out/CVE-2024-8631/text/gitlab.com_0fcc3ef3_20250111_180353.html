

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Guest user with "Admin group member" permission can edit custom role and gain other custom permissions

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2478469](https://hackerone.com/reports/2478469)** by `chotebabume` on 2024-04-25, assigned to [@greg](/greg "Greg Myers"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

> NOTE! Thanks for submitting a report! Please note that initial triage is handled by HackerOne staff. They are identified with a `HackerOne triage` badge and will escalate to the GitLab team any. Please replace *all* the (parenthesized) sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!

##### Summary

(Summarize the bug encountered concisely)

Hi team ,

Gitlab recently add that group owner can assign multiple feature permission on single custom role see here -

As Group Owner I created A custom role with all additional permission -

[bandicam\_2024-04-25\_10-53-28-598.mp4](https://user-content.gitlab-static.net/9cfe838418f7381c37de945f3e0e0595dfb5c31c/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34373662303137312d313565622d343265362d396366382d3534336265323236313965372f62616e646963616d5f323032342d30342d32355f31302d35332d32382d3539382e6d7034 "Download 'bandicam_2024-04-25_10-53-28-598.mp4'")

As Owner also create a custom role for add group member as level "guest role" on his group so if owner assign this add group member custom to a user then that user only was able to add member on victim group as " guest user role "

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/f5d811794f838927302542c9ed8109fdcf710244/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36356631656638312d623231642d343332652d383435362d6632356639326336663265612f696d6167652e706e67)

But I found there was a misconfiguration first group owner only created custom role with single permission "add group member" and assign to a user later group decided to increase permission on that custom role so he increase all permission on that custom role .

then there should be error in member tab for users to once update his user's role because these permission directly applies on first single custom role user

so exploiting this misconfiguration attacker first add his second account as "guest" role on victim user group later he change his second account role to custom role which was created from owner later if owner add that custom role with all multiple feature permission then attacker can make it privilege escalation on victim user group .

##### Steps to reproduce

(Step-by-step guide to reproduce the issue, including:)

(1. As Owner create a group

(2. As Owner navigate >settings >roles\_and\_permissions

(4. create custom role "add group member" base role "guest"

(5. now add userB on group and assign custom role "add group member"

(6. so that custom role userB should able to add group member's with guest role on victim user group

(7. now as custom role userB add his second account as guest role on victim user group

(8. now UserB change his second account user role to victim user custom role user

(9. later if owner add multiple permission to that custom role > that permission directly applies to old user with single permission custom role

here video poc -

[bandicam\_2024-04-25\_11-47-07-176.mp4](https://user-content.gitlab-static.net/2d6dcb479a2b17aab27f7094c3425a42f32b2829/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62386564613934652d386665392d343238622d626134622d3362643439396461393331302f62616e646963616d5f323032342d30342d32355f31312d34372d30372d3137362e6d7034 "Download 'bandicam_2024-04-25_11-47-07-176.mp4'")

#### Impact

new additional permission should be applied to when owner add new user with that custom role and update user role not directly give access to old user with single permissions.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [bandicam\_2024-04-25\_10-53-28-598.mp4](https://h1.sec.gitlab.net/a/476b0171-15eb-42e6-9cf8-543be22619e7/bandicam_2024-04-25_10-53-28-598.mp4)
* [image.png](https://h1.sec.gitlab.net/a/65f1ef81-b21d-432e-8456-f25f92c6f2ea/image.png)
* [bandicam\_2024-04-25\_11-47-07-176.mp4](https://h1.sec.gitlab.net/a/b8eda94e-8fe9-428b-ba4b-3bd499da9310/bandicam_2024-04-25_11-47-07-176.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

