

[Log in](/login.jsp?os_destination=%2Fbrowse%2FSET-226)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![SOS JIRA](/s/33pjjy/820009/z4gwdi/_/jira-logo-scaled.png)](https://change.sos-berlin.com/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/browse/SET "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FSET-226)

![Uploaded image for project: 'SET - Setups'](https://change.sos-berlin.com/secure/projectavatar?pid=10490&avatarId=10011)

1. [SET - Setups](/browse/SET)
2. [SET-226](/browse/SET-226)

# Update security header for Content-Security-Policy (vulnerability CVE-2023-37272)

[Log In](/login.jsp?os_destination=%2Fbrowse%2FSET-226 "Log In")Export

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=10353&avatarType=issuetype "Fix") Fix
* **Status:**
  Released
  ([View Workflow](/browse/SET-226?workflowName=Standard+Workflow&stepId=11 "Standard Workflow: SET-226"))
* **Priority:**
  ![](/images/icons/priorities/major.svg "High - Top priority issue for development.") High
* **Resolution:**
  Fixed
* **Affects Version/s:**
  1.13
* **Fix Version/s:**
  [1.13.19](/issues/?jql=project+%3D+%22SET%22+AND+fixVersion+%3D+1.13.19 "1.13.19 LTS Maintenance Release 1.13.19")
* **Labels:**
  None

* **CVE-ID:**
  CVE-2023-37272, GHSA-qr44-gm3x-7hfc

#### Description

**Vulnerability**

* Users specify file names when uploading files holding user-generated documentation for JOC Cockpit. Specifically crafted file names allow an XSS attack to inject code that is executed with the browser.
* Risk Mitigation: Risk of the vulnerability is considered high for branch 1.13 of JobScheduler (JS1). The vulnerability does not affect branch 2.x of JobScheduler (JS7) for releases after 2.1.0.

**Remediation**

* To prevent the vulnerability users can apply the following change to their JOC Cockpit installation:
  + The security header value for Content-Security-Policy configured with JETTY\_HOME/etc/jetty-rewrite.xml includes:
    ```

          <Call name="addRule">
            <Arg>
              <New class="org.eclipse.jetty.rewrite.handler.HeaderRegexRule">
                <Set name="regex">^((?!/joc/api/).)*$</Set>
                <Set name="name">Content-Security-Policy</Set>
                <Set name="value">script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'</Set>
              </New>
            </Arg>
          </Call>

    ```

* + The security header value for Content-Security-Policy should include:
    ```

    <Call name="addRule">
            <Arg>
              <New class="org.eclipse.jetty.rewrite.handler.HeaderRegexRule">
                <Set name="regex">^((?!/joc/api/).)*$</Set>
                <Set name="name">Content-Security-Policy</Set>
                <Set name="value">script-src 'self' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; frame-src 'self'; frame-ancestors 'self'</Set>
              </New>
            </Arg>
          </Call>

    ```

* + JOC Cockpit has to be restarted to apply the change.
  + The change is applicable to JOC Cockpit release 1.13.11 throughout 1.13.18.
  + The new header prevents the execution of inline JavaScript. Until 1.13.18 inline JavaScript is used in a few places which will no longer work after the change is applied. These are
    - Upload button during import to the *Documentation* view.

      As an alternative the drag/drop functionality works. So an upload is possible!
    - Drag/drop functionality to configure a Job Chain or a Job Stream.

      The forms can be used for configuration instead of drag/drop.

      Configuring a Job Chain or a Job Stream is possible!

* The Content-Security-Policy header as implemented with [~~SET-204~~](https://change.sos-berlin.com/browse/SET-204 "Update security header for Content-Security-Policy") is made available starting from LTS maintenance release 1.13.19 of JobScheduler.
* Users without access to LTS maintenance releases can apply the above change to the JOC Cockpit configuration of earlier releases such as 1.13.11 (last public maintenance release) or later.

#### Attachments

#### Activity

#### People

Assignee:

![oh](https://change.sos-berlin.com/secure/useravatar?size=small&avatarId=10154)
Oliver Haufe

Reporter:

![ap](https://change.sos-berlin.com/secure/useravatar?size=small&avatarId=10172)
Andreas Püschel

Approver:

![Kanika Agrawal](https://change.sos-berlin.com/secure/useravatar?avatarId=10172)
 Kanika Agrawal

Votes:
0
Vote for this issue

Watchers:
4
Start watching this issue

#### Dates

Created:

05 July 2023 08:24

Updated:

11 July 2023 19:39

Resolved:

10 July 2023 15:38

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for Job Scheduler. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

