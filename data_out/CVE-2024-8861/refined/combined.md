=== Content from plugins.trac.wordpress.org_ad448283_20250111_195919.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3157510)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3157509 "Changeset 3157509")
* [Next Changeset](/changeset/3157511 "Changeset 3157511") →

---

# Changeset 3157510

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/25/2024 11:53:40 AM
([4 months](/timeline?from=2024-09-25T11%3A53%3A40Z&precision=second "See timeline at 09/25/2024 11:53:40 AM") ago)

Author:
metagauss
Message:

Release 5.9.3.3

Location:
[profilegrid-user-profiles-groups-and-communities/trunk](/browser/profilegrid-user-profiles-groups-and-communities/trunk?rev=3157510)
Files:

9 edited

* [admin/class-profile-magic-admin.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php?rev=3157510 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [admin/partials/pm-users-listing-setting.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/partials/pm-users-listing-setting.php?rev=3157510 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [includes/class-profile-magic-chat-system.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3157510 "Show entry in browser")
  (modified)
  ([7 diffs](#file2 "Show differences"))
* [includes/class-profile-magic-request.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-request.php?rev=3157510 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [includes/class-profile-magic.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php?rev=3157510 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [profile-magic.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/profile-magic.php?rev=3157510 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))
* [public/class-profile-magic-notifications.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-notifications.php?rev=3157510 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))
* [public/class-profile-magic-public.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php?rev=3157510 "Show entry in browser")
  (modified)
  ([4 diffs](#file7 "Show differences"))
* [readme.txt](/browser/profilegrid-user-profiles-groups-and-communities/trunk/readme.txt?rev=3157510 "Show entry in browser")
  (modified)
  ([3 diffs](#file8 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php "Show the changeset 3157510 restricted to profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php")

  | [r3141390](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php?rev=3141390#L2063 "Show revision 3141390 of this file in browser") | [r3157510](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php?rev=3157510#L2063 "Show revision 3157510 of this file in browser") |  |
  | --- | --- | --- |
  | 2063 | 2063 | } |
  | 2064 | 2064 |  |
  | 2065 |  | ~~public function pm\_allowed\_html\_tags( $allowed, $context ) {~~ |
  | 2066 |  | ~~if ( 'post' === $context ) {~~ |
  | 2067 |  | ~~$allowed['a']['onclick']   = true;~~ |
  | 2068 |  | ~~$allowed['svg']['onclick'] = true;~~ |
  | 2069 |  | ~~$allowed['div']['onclick'] = true;~~ |
  | 2070 |  | ~~$allowed['div']['id']      = true;~~ |
  | 2071 |  | ~~$allowed['div']['class']   = true;~~ |
  | 2072 |  | ~~$allowed['svg']['fill']    = true;~~ |
  | 2073 |  | ~~$allowed['svg']['heigth']  = true;~~ |
  | 2074 |  | ~~$allowed['svg']['width']   = true;~~ |
  | 2075 |  | ~~$allowed['svg']['viewBox'] = true;~~ |
  | 2076 |  | ~~$allowed['svg']['xmlns']   = true;~~ |
  | 2077 |  | ~~$allowed['path']['fill']   = true;~~ |
  | 2078 |  | ~~$allowed['path']['d']      = true;~~ |
  | 2079 |  |  |
  | 2080 |  | ~~}~~ |
  | 2081 |  |  |
  | 2082 |  | ~~return $allowed;~~ |
  | 2083 |  | ~~}~~ |
  | 2084 |  |  |
  | 2085 | 2065 | public function pm\_get\_groups\_details() { |
  | 2086 | 2066 | if ( ! isset( $\_POST['nonce'] ) || ! wp\_verify\_nonce( sanitize\_key( $\_POST['nonce'] ), 'ajax-nonce' ) ) { |
* ## [profilegrid-user-profiles-groups-and-communities/trunk/admin/partials/pm-users-listing-setting.php](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/admin/partials/pm-users-listing-setting.php "Show the changeset 3157510 restricted to profilegrid-user-profiles-groups-and-communities/trunk/admin/partials/pm-users-listing-setting.php")

  | [r3000107](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/partials/pm-users-listing-setting.php?rev=3000107#L42 "Show revision 3000107 of this file in browser") | [r3157510](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/partials/pm-users-listing-setting.php?rev=3157510#L42 "Show revision 3157510 of this file in browser") |  |
  | --- | --- | --- |
  | 42 | 42 |  |
  | 43 | 43 | <div class="uimagic"> |
  | 44 |  | <form name="pm\_users\_l~~si~~ting\_settings" id="pm\_user\_settings" method="post"> |
  |  | 44 | <form name="pm\_users\_listing\_settings" id="pm\_user\_settings" method="post"> |
  | 45 | 45 | <!-----Dialogue Box Starts-----> |
  | 46 | 46 | <div class="content"> |
  | 47 | 47 | <div class="uimheader"> |
  | 48 |  | <?php esc\_html\_e( 'All Users Lis~~it~~ng', 'profilegrid-user-profiles-groups-and-communities' ); ?> |
  |  | 48 | <?php esc\_html\_e( 'All Users Listing', 'profilegrid-user-profiles-groups-and-communities' ); ?> |
  | 49 | 49 | </div> |
  | 50 | 50 |  |
* ## [profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php "Show the changeset 3157510 restricted to profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php")

  | [r3048832](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3048832#L47 "Show revision 3048832 of this file in browser") | [r3157510](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3157510#L47 "Show revision 3157510 of this file in browser") |  |
  | --- | --- | --- |
  | 47 | 47 | $uid         = get\_current\_user\_id(); |
  | 48 | 48 | $messages    = $dbhandler->get\_all\_result( $identifier, $column = '\*', $where, 'results', 0, false, 'timestamp', true, $additional ); |
  | 49 |  |  |
  | 50 |  | foreach ( $messages as $message ) { |
  | 51 |  | $tid[] = $message->t\_id; |
  | 52 |  | } |
  |  | 49 | if(!empty($messages)) |
  |  | 50 | { |
  |  | 51 | foreach ( $messages as $message ) { |
  |  | 52 | $tid[] = $message->t\_id; |
  |  | 53 | } |
  |  | 54 | } |
  | 53 | 55 | $thred\_id\_array = array\_unique( $tid ); |
  | 54 | 56 |  |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3048832#L464) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3157510#L466) |  |
  | 464 | 466 | $pmrequests  = new PM\_request(); |
  | 465 | 467 | $current\_user = wp\_get\_current\_user(); |
  |  | 468 | $allowed\_html = $pmrequests->pg\_allowed\_html\_wp\_kses(); |
  | 466 | 469 | $return       = $this->pm\_messenger\_show\_threads( '' ); |
  | 467 | 470 | ?> |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3048832#L484) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3157510#L487) |  |
  | 484 | 487 | </div> |
  | 485 | 488 | <ul class="dbfl" id="threads\_ul"> |
  | 486 |  | <?php echo wp\_kses~~\_post( $return~~ ); ?> |
  |  | 489 | <?php echo wp\_kses( $return,$allowed\_html ); ?> |
  | 487 | 490 | </ul> |
  | 488 | 491 | </div> |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3048832#L504) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3157510#L507) |  |
  | 504 | 507 | $pmrequests   = new PM\_request(); |
  | 505 | 508 | $current\_user = wp\_get\_current\_user(); |
  |  | 509 | $allowed\_html = $pmrequests->pg\_allowed\_html\_wp\_kses(); |
  | 506 | 510 | $return       = $this->pm\_messenger\_show\_threads( $tid ); |
  | 507 | 511 |  |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3048832#L537) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3157510#L541) |  |
  | 537 | 541 |  |
  | 538 | 542 | <?php |
  | 539 |  | echo wp\_kses~~\_post( $return~~ ); |
  |  | 543 | echo wp\_kses( $return,$allowed\_html ); |
  | 540 | 544 | ?> |
  | 541 | 545 | </div> |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3048832#L654) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3157510#L658) |  |
  | 654 | 658 | public function pg\_show\_thread\_message\_panel\_old( $rid ) { |
  | 655 | 659 | $pmrequests   = new PM\_request(); |
  |  | 660 | $allowed\_html = $pmrequests->pg\_allowed\_html\_wp\_kses(); |
  | 656 | 661 | $current\_user = wp\_get\_current\_user(); |
  | 657 | 662 | $uid          = $current\_user->ID; |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3048832#L711) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-chat-system.php?rev=3157510#L716) |  |
  | 711 | 716 |  |
  | 712 | 717 | <div id="message\_display\_area" class="pm-difl pm\_full\_width\_profile"  style="min-height:200px;max-height:200px;max-width: 550px;overflow-y:auto;"> |
  | 713 |  | <?php echo wp\_kses~~\_post($return~~); ?> |
  |  | 718 | <?php echo wp\_kses($return,$allowed\_html); ?> |
  | 714 | 719 | <?php $path = plugins\_url( '../public/partials/images/typing\_image.gif', \_\_FILE\_\_ ); ?> |
  | 715 | 720 | </div> |
* ## [profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-request.php](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-request.php "Show the changeset 3157510 restricted to profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-request.php")

  | [r3137949](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-request.php?rev=3137949#L5909 "Show revision 3137949 of this file in browser") | [r3157510](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic-request.php?rev=3157510#L5909 "Show revision 3157510 of this file in browser") |  |
  | --- | --- | --- |
  | 5909 | 5909 | { |
  | 5910 | 5910 | $allowed\_html = array( |
  | 5911 |  | 'div' => array( |
  | 5912 |  | 'class' => array(), |
  | 5913 |  | 'id' => array(), |
  | 5914 |  | ), |
  | 5915 |  | 'svg' => array( |
  | 5916 |  | 'xmlns' => array(), |
  | 5917 |  | 'height' => array(), |
  | 5918 |  | 'viewBox' => array(), |
  | 5919 |  | 'width' => array(), |
  | 5920 |  | 'fill' => array(), |
  | 5921 |  | ), |
  | 5922 |  | 'path' => array( |
  | 5923 |  | 'd' => array(), |
  | 5924 |  | 'fill' => array(), |
  | 5925 |  | ), |
  | 5926 |  | 'img' => array( |
  | 5927 |  | 'width' => array(), |
  | 5928 |  | 'height' => array(), |
  | 5929 |  | 'src' => array(), |
  | 5930 |  | 'class' => array(), |
  | 5931 |  | 'alt' => array(), |
  | 5932 |  | 'size' => array(), |
  | 5933 |  | 'default' => array(), |
  | 5934 |  | 'force\_default' => array(), |
  | 5935 |  | 'rating' => array(), |
  | 5936 |  | 'scheme' => array(), |
  | 5937 |  | 'processed\_args' => array(), |
  | 5938 |  | 'extra\_attr' => array(), |
  | 5939 |  | 'force\_display' => array(), |
  | 5940 |  | 'loading' => array(), |
  | 5941 |  | 'fetchpriority' => array(), |
  | 5942 |  | 'decoding' => array(), |
  | 5943 |  | 'found\_avatar' => array(), |
  | 5944 |  | 'url' => array(), |
  | 5945 |  | 'srcset' => array(), |
  | 5946 |  | 'sizes' => array(), |
  | 5947 |  | ), |
  | 5948 |  | 'ul' => array(), |
  | 5949 |  | 'li' => array( |
  | 5950 |  | 'onclick' => array(), |
  | 5951 |  | ), |
  | 5952 |  | ); |
  |  | 5911 |  |
  |  | 5912 | 'table' => array( |
  |  | 5913 | 'class' => array(), |
  |  | 5914 | 'border' => array(), |
  |  | 5915 | 'cellspacing' => array(), |
  |  | 5916 | 'cellpadding' => array(), |
  |  | 5917 | 'width' => array(), |
  |  | 5918 | 'style' => array(), |
  |  | 5919 | ), |
  |  | 5920 | 'tbody' => array(), |
  |  | 5921 | 'tr' => array( |
  |  | 5922 | 'valign' => array(), |
  |  | 5923 | ), |
  |  | 5924 | 'th' => array( |
  |  | 5925 | 'scope' => array(), |
  |  | 5926 | 'class' => array(), |
  |  | 5927 | ), |
  |  | 5928 | 'td' => array( |
  |  | 5929 | 'class' => array(), |
  |  | 5930 | 'colspan' => array(), |
  |  | 5931 | 'style' => array(), |
  |  | 5932 | 'align' => array(), |
  |  | 5933 | 'valign' => array(), |
  |  | 5934 | ), |
  |  | 5935 | 'label' => array( |
  |  | 5936 | 'for' => array(), |
  |  | 5937 | ), |
  |  | 5938 | 'span' => array( |
  |  | 5939 | 'class' => array(), |
  |  | 5940 | ), |
  |  | 5941 | 'input' => array( |
  |  | 5942 | 'type' => array(), |
  |  | 5943 | 'name' => array(), |
  |  | 5944 | 'id' => array(), |
  |  | 5945 | 'class' => array(), |
  |  | 5946 | 'value' => array(), |
  |  | 5947 | 'required' => array(), |
  |  | 5948 | ), |
  |  | 5949 | 'textarea' => array( |
  |  | 5950 | 'class' => array(), |
  |  | 5951 | 'rows' => array(), |
  |  | 5952 | 'cols' => array(), |
  |  | 5953 | 'name' => array(), |
  |  | 5954 | 'id' => array(), |
  |  | 5955 | 'style' => array(), |
  |  | 5956 | 'aria-hidden' => array(), |
  |  | 5957 | 'data-\*' => true, // Allowing data attributes |
  |  | 5958 | ), |
  |  | 5959 | 'a' => array( |
  |  | 5960 | 'href' => array(), |
  |  | 5961 | 'target' => array(), |
  |  | 5962 | 'class' => array(), |
  |  | 5963 | 'id' => array(), |
  |  | 5964 | 'onclick'=>array(), |
  |  | 5965 | 'data-\*' => true, // Allowing data attributes |
  |  | 5966 | ), |
  |  | 5967 | 'h1' => array( |
  |  | 5968 | 'style' => array(), |
  |  | 5969 | ), |
  |  | 5970 | 'div' => array( |
  |  | 5971 | 'id' => array(), |
  |  | 5972 | 'title'=>array(), |
  |  | 5973 | 'class' => array(), |
  |  | 5974 | 'style' => array(), |
  |  | 5975 | 'aria-hidden' => array(), |
  |  | 5976 | 'onclick'=>array(), |
  |  | 5977 | 'data-\*' => true, // Allowing data attributes |
  |  | 5978 | ), |
  |  | 5979 | 'button' => array( |
  |  | 5980 | 'type' => array(), |
  |  | 5981 | 'id' => array(), |
  |  | 5982 | 'class' => array(), |
  |  | 5983 | 'aria-label' => array(), |
  |  | 5984 | 'aria-pressed' => array(), |
  |  | 5985 | 'data-\*' => true, // Allowing data attributes |
  |  | 5986 | ), |
  |  | 5987 | 'strong' => array(), |
  |  | 5988 | 'em' => array(), |
  |  | 5989 | 'i' => array( |
  |  | 5990 | 'class' => array(), |
  |  | 5991 | ), |
  |  | 5992 | 'p' => array( |
  |  | 5993 | 'class' => array(), |
  |  | 5994 | ), |
  |  | 5995 | 'img' => array( |
  |  | 5996 | 'src' => array(), |
  |  | 5997 | 'alt' => array(), |
  |  | 5998 | 'width' => array(), |
  |  | 5999 | 'height' => array(), |
  |  | 6000 | 'style' => array(), |
  |  | 6001 | ), |
  |  | 6002 | 'svg' => array( |
  |  | 6003 | 'xmlns' => array(), |
  |  | 6004 | 'height' => array(), |
  |  | 6005 | 'viewBox' => array(), |
  |  | 6006 | 'width' => array(), |
  |  | 6007 | 'fill' => array(), |
  |  | 6008 | ), |
  |  | 6009 | 'path' => array( |
  |  | 6010 | 'd' => array(), |
  |  | 6011 | 'fill' => array(), |
  |  | 6012 | ), |
  |  | 6013 | 'img' => array( |
  |  | 6014 | 'width' => array(), |
  |  | 6015 | 'height' => array(), |
  |  | 6016 | 'src' => array(), |
  |  | 6017 | 'class' => array(), |
  |  | 6018 | 'alt' => array(), |
  |  | 6019 | 'size' => array(), |
  |  | 6020 | 'default' => array(), |
  |  | 6021 | 'force\_default' => array(), |
  |  | 6022 | 'rating' => array(), |
  |  | 6023 | 'scheme' => array(), |
  |  | 6024 | 'processed\_args' => array(), |
  |  | 6025 | 'extra\_attr' => array(), |
  |  | 6026 | 'force\_display' => array(), |
  |  | 6027 | 'loading' => array(), |
  |  | 6028 | 'fetchpriority' => array(), |
  |  | 6029 | 'decoding' => array(), |
  |  | 6030 | 'found\_avatar' => array(), |
  |  | 6031 | 'url' => array(), |
  |  | 6032 | 'srcset' => array(), |
  |  | 6033 | 'sizes' => array(), |
  |  | 6034 | ), |
  |  | 6035 | 'ul' => array(), |
  |  | 6036 | 'li' => array( |
  |  | 6037 | 'onclick' => array(), |
  |  | 6038 | ), |
  |  | 6039 | ); |
  | 5953 | 6040 | return $allowed\_html; |
  | 5954 | 6041 | } |
* ## [profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php "Show the changeset 3157510 restricted to profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php")

  | [r3076409](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php?rev=3076409#L266 "Show revision 3076409 of this file in browser") | [r3157510](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php?rev=3157510#L266 "Show revision 3157510 of this file in browser") |  |
  | --- | --- | --- |
  | 266 | 266 | $this->loader->add\_action( 'wp\_ajax\_pm\_wizard\_update\_group\_icon', $plugin\_admin, 'pm\_wizard\_update\_group\_icon' ); |
  | 267 | 267 | $this->loader->add\_action( 'wp\_ajax\_pm\_submit\_group\_wizard\_form', $plugin\_admin, 'pm\_submit\_group\_wizard\_form' ); |
  | 268 |  | ~~$this->loader->add\_filter( 'wp\_kses\_allowed\_html', $plugin\_admin, 'pm\_allowed\_html\_tags', 10, 2 );~~ |
  | 269 | 268 | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_groups\_details', $plugin\_admin, 'pm\_get\_groups\_details' ); |
  | 270 | 269 | $this->loader->add\_action('pg\_customization\_extension\_html', $plugin\_admin, 'pg\_customization\_extension\_html'); |
* ## [profilegrid-user-profiles-groups-and-communities/trunk/profile-magic.php](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/profile-magic.php "Show the changeset 3157510 restricted to profilegrid-user-profiles-groups-and-communities/trunk/profile-magic.php")

  | [r3150036](/browser/profilegrid-user-profiles-groups-and-communities/trunk/profile-magic.php?rev=3150036#L9 "Show revision 3150036 of this file in browser") | [r3157510](/browser/profilegrid-user-profiles-groups-and-communities/trunk/profile-magic.php?rev=3157510#L9 "Show revision 3157510 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | \* Plugin URI:        http://profilegrid.co |
  | 10 | 10 | \* Description:       ProfileGrid adds user groups and user profiles functionality to your site. |
  | 11 |  | \* Version:           5.9.3.~~2~~ |
  |  | 11 | \* Version:           5.9.3.3 |
  | 12 | 12 | \* Author:            ProfileGrid User Profiles |
  | 13 | 13 | \* Author URI:        https://profilegrid.co |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/profile-magic.php?rev=3150036#L29) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/profile-magic.php?rev=3157510#L29) |  |
  | 29 | 29 |  |
  | 30 | 30 | define('PROGRID\_DB\_VERSION',4.4); |
  | 31 |  | define('PROGRID\_PLUGIN\_VERSION','5.9.3.~~2~~'); |
  |  | 31 | define('PROGRID\_PLUGIN\_VERSION','5.9.3.3'); |
  | 32 | 32 | define('PROGRID\_MULTI\_GROUP\_VERSION', 3.0); |
  | 33 | 33 |  |
* ## [profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-notifications.php](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-notifications.php "Show the changeset 3157510 restricted to profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-notifications.php")

  | [r3150036](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-notifications.php?rev=3150036#L171 "Show revision 3150036 of this file in browser") | [r3157510](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-notifications.php?rev=3157510#L171 "Show revision 3157510 of this file in browser") |  |
  | --- | --- | --- |
  | 171 | 171 |  |
  | 172 | 172 | $dbhandler   = new PM\_DBhandler(); |
  |  | 173 | $pmrequests   = new PM\_request(); |
  | 173 | 174 | $current\_uid = get\_current\_user\_id(); |
  | 174 | 175 | $loadnum     = isset( $loadnum ) ? absint( $loadnum ) : 1; |
  | 175 | 176 | $limit       = 15; |
  | 176 | 177 | $offset      = ( $loadnum - 1 ) \* $limit; |
  | 177 |  |  |
  |  | 178 |  |
  |  | 179 | $allowed\_html = $pmrequests->pg\_allowed\_html\_wp\_kses(); |
  | 178 | 180 | $where   = 1; |
  | 179 | 181 | $exclude = $this->exclude\_deactivate\_extension\_notification(); |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-notifications.php?rev=3150036#L243) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-notifications.php?rev=3157510#L245) |  |
  | 243 | 245 | } |
  | 244 | 246 | if ( $data['pm\_notify'][ $id ] != '' ) { |
  | 245 |  | echo wp\_kses~~\_post($data['pm\_notify'][ $id ]~~); |
  |  | 247 | echo wp\_kses($data['pm\_notify'][ $id ],$allowed\_html); |
  | 246 | 248 | } |
  | 247 | 249 | if ( $status == 1 ) { |
* ## [profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php "Show the changeset 3157510 restricted to profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php")

  | [r3150036](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php?rev=3150036#L1422 "Show revision 3150036 of this file in browser") | [r3157510](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php?rev=3157510#L1422 "Show revision 3157510 of this file in browser") |  |
  | --- | --- | --- |
  | 1422 | 1422 | $dbhandler    = new PM\_DBhandler(); |
  | 1423 | 1423 | $pmrequests = new PM\_request(); |
  | 1424 |  |  |
  |  | 1424 | $allowed\_html = $pmrequests->pg\_allowed\_html\_wp\_kses(); |
  | 1425 | 1425 | $pagenum    = filter\_input( INPUT\_POST, 'pagenum' ); |
  | 1426 | 1426 | $sortby     = filter\_input( INPUT\_POST, 'member\_sort\_by' ); |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php?rev=3150036#L1549) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php?rev=3157510#L1549) |  |
  | 1549 | 1549 |  |
  | 1550 | 1550 | if ( isset( $pagination ) ) { |
  | 1551 |  | $return .= '<div class="pm\_clear"></div>' . ~~wp\_kses\_post($pagination)~~; |
  | 1552 |  | } |
  | 1553 |  |  |
  | 1554 |  | echo wp\_kses~~\_post( $return~~ ); |
  |  | 1551 | $return .= '<div class="pm\_clear"></div>' . $pagination; |
  |  | 1552 | } |
  |  | 1553 |  |
  |  | 1554 | echo wp\_kses( $return,$allowed\_html ); |
  | 1555 | 1555 | die; |
  | 1556 | 1556 | } |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php?rev=3150036#L4088) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php?rev=3157510#L4088) |  |
  | 4088 | 4088 |  |
  | 4089 | 4089 | public function pg\_show\_all\_threads() { |
  | 4090 |  | $tid        = filter\_input( INPUT\_POST, 'tid' ); |
  |  | 4090 | $tid        = filter\_input( INPUT\_POST, 'tid' ); |
  | 4091 | 4091 | $pmmessenger = new ProfileMagic\_Chat(); |
  |  | 4092 | $pmrequests = new PM\_request(); |
  |  | 4093 | $allowed\_html = $pmrequests->pg\_allowed\_html\_wp\_kses(); |
  | 4092 | 4094 | $return      = $pmmessenger->pm\_messenger\_show\_threads( $tid ); |
  | 4093 |  | echo wp\_kses~~\_post( $return~~ ); |
  |  | 4095 | echo wp\_kses( $return,$allowed\_html ); |
  | 4094 | 4096 | die; |
  | 4095 | 4097 | } |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php?rev=3150036#L4098) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/public/class-profile-magic-public.php?rev=3157510#L4100) |  |
  | 4098 | 4100 | $search      = filter\_input( INPUT\_POST, 'search' ); |
  | 4099 | 4101 | $pmmessenger = new ProfileMagic\_Chat(); |
  |  | 4102 | $pmrequests = new PM\_request(); |
  |  | 4103 | $allowed\_html = $pmrequests->pg\_allowed\_html\_wp\_kses(); |
  | 4100 | 4104 | $return      = $pmmessenger->pm\_messenger\_search\_threads( $search ); |
  | 4101 |  | echo wp\_kses~~\_post( $return~~ ); |
  |  | 4105 | echo wp\_kses( $return,$allowed\_html ); |
  | 4102 | 4106 | die; |
  | 4103 | 4107 | } |
* ## [profilegrid-user-profiles-groups-and-communities/trunk/readme.txt](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/readme.txt "Show the changeset 3157510 restricted to profilegrid-user-profiles-groups-and-communities/trunk/readme.txt")

  | [r3150036](/browser/profilegrid-user-profiles-groups-and-communities/trunk/readme.txt?rev=3150036#L6 "Show revision 3150036 of this file in browser") | [r3157510](/browser/profilegrid-user-profiles-groups-and-communities/trunk/readme.txt?rev=3157510#L6 "Show revision 3157510 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Tested up to: 6.6 |
  | 7 | 7 | Requires PHP: 7.4 |
  | 8 |  | Stable tag: 5.9.3.~~2~~ |
  |  | 8 | Stable tag: 5.9.3.3 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/readme.txt?rev=3150036#L674) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/readme.txt?rev=3157510#L674) |  |
  | 674 | 674 | == Changelog == |
  | 675 | 675 |  |
  |  | 676 | = 5.9.3.3: September 25, 2024 = |
  |  | 677 | \* Added: Security fixes. |
  |  | 678 |  |
  | 676 | 679 | = 5.9.3.2: September 11, 2024 = |
  | 677 | 680 | \* New Feature: Added the option to assign Group-Specific Profile Templates, allowing admins to customize profile layouts for different user groups. |
  | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/readme.txt?rev=3150036#L1392) | […](/browser/profilegrid-user-profiles-groups-and-communities/trunk/readme.txt?rev=3157510#L1395) |  |
  | 1392 | 1395 |  |
  | 1393 | 1396 | == Upgrade Notice == |
  |  | 1397 |  |
  |  | 1398 | = 5.9.3.3: September 25, 2024 = |
  |  | 1399 | \* Added: Security fixes. |
  | 1394 | 1400 |  |
  | 1395 | 1401 | = 5.9.3.2: September 11, 2024 = |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3157510)
* [Zip Archive](?format=zip&new=3157510)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_4bbb52d2_20250111_195920.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

ProfileGrid – User Profiles, Groups and Communities

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fprofilegrid-user-profiles-groups-and-communities&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fprofilegrid-user-profiles-groups-and-communities&locale=en_US)

Search plugins

![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/banner-772x250.jpg?rev=2818177)
![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/icon.svg?rev=2547387)
# ProfileGrid – User Profiles, Groups and Communities

By [ProfileGrid User Profiles](https://profilegrid.co)

[Download](https://downloads.wordpress.org/plugin/profilegrid-user-profiles-groups-and-communities.5.9.4.1.zip)

* [Details](https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/#description)
* [Reviews](https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/#reviews)
* [Installation](https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/#installation)
* [Development](https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/#developers)

[Support](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/)

## Description

#### WordPress User Profiles & Membership Plugin

Create WordPress user profiles, groups, communities, paid memberships, directories, WooCommerce profiles, bbPress profiles, content restriction, sign-up pages, blog submissions, notifications, social activity and private messaging, beautiful threaded interface and a lot more!

> The #1 custom user profile plugin that brings together user data from all your plugins, which use custom posts or shortcodes.
>
> The #1 Free WordPress Community Plugin with inbuilt private messaging & friends system
>
> The #1 Free WooCommerce User Profile Plugin
>
> The #1 Free bbPress User Profile plugin
>
> For any issues, bugs, feature requests and general help, contact our awesome support team!

[ProfileGrid](https://profilegrid.co/) is a power-packed user profile, member, community and directory plugin. While ProfileGrid is fundamentally a user profile builder, it also offers User Groups. Groups are equivalent to Profile types where you can have different profile structures for different group of users. Advantages of Group based system is apparent from the very beginning:

* You can have multiple User Profile types.
* Each Group can have its own set of fields.
* Each Group can have its own Group Manager or Moderator.
* Group Manager can have special privacy level for group members.
* Each group can have its own registration workflow.
* You can offer visitors option to sign up or request membership for Group of their choice.
* Groups can have membership limits.
* Groups can be mapped to a specific WordPress Roles.
* Filter user profiles based on groups on directories page.
* Groups can be Open (public) or Closed (private)
* Closed Groups require membership approval from Group Manager or site Admin
* Users can join multiple Groups

And so much more!

If you do not need multiple Groups, there’s nothing stopping you to use the default Group as single profile type, membership or as user directories system. It’s a unique WordPress profile plugin that’s flexible and modular. A lot of stuff can be turned on or off by single click.

ProfileGrid is pretty both on the frontend and the dashboard area. We understand you spend a lot of time inside the dashboard, therefore, we made sure the admin facing interface is clean and organized. You will absolutely love it when you first log into ProfileGrid. And it looks even better once profiles start to fill in!

With release of version 4.1.0 we have added a bunch of new shortcodes which offer amazing amount of flexibility with displaying different types of user groups and user profiles data inside your WordPress theme and widgets. Brand new content enclosure shortcodes allow you to take control of content restrictions and membership access to granular level. Using new dynamic content shortcodes you can create personalized content for your users.

#### WORDPRESS COMMUNITY PLUGIN & COMMUNITY BUILDER FEATURES

What makes ProfileGrid a perfect WordPress community plugin? Here are a few reasons to start with:

* Ability to create public and private groups.
* Adding group specific modules like discussions, photos, events etc.
* Appointing group managers for community moderation.
* Community based privacy levels for content.
* Ability for users to join multiple groups.
* Allowing users to create their own groups from frontend.

And the list does not stops here! There are many other features tucked inside ProfileGrid making it a robust WordPress community plugin for all types of community based websites.

#### WORDPRESS MEMBERSHIP PLUGIN FEATURES

ProfileGrid’s WordPress membership plugin features include:

* Paid membership groups with native checkout process.
* Separate Group membership registration forms.
* Content restrictions based on membership levels.
* Member exclusive group area.
* Member limits in groups.
* Member discounts for WooCommerce products (via extension).

These, combined with many other similar features, make ProfileGrid the ideal WordPress membership plugin.

#### Dashboard areas include:

* Group Manager to create, edit and manage groups, and set membership rules.
* Custom Fields Manager to manager Profile Sections and Fields.
* User Profiles area to view, search and filters User profiles and members.
* Requests to manage and moderate membership requests for closed groups.
* Email Template manager to create and edit email notifications for users.
* User Blogs to manage user submitted blog posts.
* Global Settings to fine tune your ProfileGrid installation.
* Shortcodes page to help you understand how shortcodes work.

Frontend offers a slew of shortcodes to present custom user profile related areas to the visitors. These are:

* Groups page showing a grid of Groups for users to browse and sign up for them.
* Group page showing Group’s details and all its members.
* Profile page showing single custom User Profile with blogs and conversations.
* Single and Multipage sign up forms. Latter splitting Sections into pages.
* All Users page displays all members without grouping them, with global search.
* Login and Password Recovery pages.

[Find complete list of shortcodes here](https://profilegrid.co/wordpress-user-profiles-shortcodes-list/).

#### Group Attributes

* Group Name
* Group Type – Open/ Closed
* Group Description
* Group Badge/ Icon/ Logo
* Option to Hide Group Card
* Membership Limit
* Associate WordPress User Role
* Group Manager (Selectable from Group Members)
* Label for Group Manager
* Membership Type – Free/ Paid
* Membership Price
* Redirection after group registration
* Custom message after group registration
* Custom Email notifications for members
* Email on joining Group
* Email on joining request being denied
* Email on account activation
* Email on account deactivation
* Email on password change
* Email on account deletion
* Email on publishing new post
* Email when Group Manager resets password
* Turn on Emails for Group Managers
* Email on new membership request
* Email on being assigned Group Manager

Groups provide basic setup of using ProfileGrid as a WordPress Community Plugin.

#### WordPress User Profiles Attributes

* User Profile page user avatar photo
* User Profile page Cover Photo
* Parent Group picture appears on user page
* User Profile page Sections
* Custom User Profiles (Custom Fields for user profiles)

#### Custom Field Attributes

* Field Label (as it appears on registration form and user page)
* Field Description
* Field Type
* Placeholder Text
* CSS Class
* Maximum Length/ Rows/ Columns etc.
* Field Label Icon or picture
* Parent Group
* Parent Section
* Display on Sign Up form
* Required/ Not Required
* Fields visibility on Profile Page
* Fields visibility on Group Page

#### Email Template Attributes

* Template Name
* Subject
* Body with Mail Merge fields.

#### Content Restriction

* Restrict content to logged in users
* Restrict content to users of specific group
* Restrict content to friends
* Make contend private

#### Multi Author Blogging

* Multi Author Blogs that integrate with frontend user profile
* Users can write and submit blog entries from a frontend user page
* Users can upload picture as featured image field
* Option to choose between WordPress blogs and ProfileGrid blogs
* Admins can moderate and approve Multi Author blog posts
* Define initial status of Multi Author blog posts on blog submission

#### Private Messaging System

ProfileGrid features an inbuilt [private messaging system](https://profilegrid.co/how-enable-private-messaging-between-wordpress-users/) that works in realtime – a rare WordPress profile plugin that offers advanced messaging capabilities as part of the core. Once you install and visit custom user profile page, you will see Messaging among other profile tabs. Following features boost ProfileGrid user case as a Community Plugin:

* A system that works in realtime using WordPress Heartbeat API
* See live status of members you are chatting with
* Supports emoji
* Users can message anyone from their user profile page by clicking a button or typing username
* Users receive live notifications and unread count when messaging tab is not active
* Notifications also appear in left bar which shows active messaging threads

#### Friends System

ProfileGrid also comes with an inbuilt Friends system that allows users to other members as friends – once again a rare WordPress profile plugin that offers Friends system in core. Friends tab automatically appear on custom user profile page once it is activated in ProfileGrid Global Settings. The features include:

* Users can add other members as ‘Friends’
* User can send Friend requests
* Users can accept or decline Friend request
* All friends appear on user profile page inside ‘Friends’ tab
* Users can remove friends from Friends tab.
* Admin can set rule for resending, once declined friend requests
* Friend request appear in Notification tab and add to unread count
* Users can accept or decline friend request from user notification box
* On accepting friend request friend’s user profile url appear inside user notification box

#### Global Settings

Global Settings page includes all plugin-wide settings. It is divided into following subsections:

#### General Settings

* Template Selection
* Theme selection Light/ Dark
* Redirection for Authors
* Enable Gravatar
* Allow or Disallow WordPress login page access to visitors
* Allow or Disallow WordPress login page access to visitors
* Hide WordPress toolbar
* Set limit for password reset tries
* Multiple Attachments
* Map default WP Registration page
* Redirection after user login
* Redirect After logout
* Map All Groups page
* Map User Registration page
* Map Single Group page
* Define Sign Up form Style
* Map Profile page
* Map Login page
* Map Password Recovery and Password Reset pages

#### Profile Templates

A selection of readymade profile page layouts to chose from! Each layout is unique and adopts color scheme of your active theme for a clean native look.

#### Security Settings

* Toggle reCAPTCHA
* reCAPTCHA language
* Site Key
* Secret Key
* Request method
* Auto Logout after inactivity
* Whitelist IPs
* Blacklist IPs

#### Email Notifications (Global)

* Send notifications to site admin
* Manually define admin email notification recipients
* User Account review notification
* Account Deletion email notification
* Turn on SMTP configuration
* SMTP Host, Encryption, Port, Authentication, Username, Password
* Test SMTP Connection

#### User Accounts

* Turn on automatic approvals
* Send User Activation Link in email
* Display User Password change option
* Show User Privacy options
* Allow User Profile deletion
* Account deletion warning text
* Allow User Email change
* Allow Users to hide their profiles
* Default Profile Image, default user avatar
* Default Cover Image

#### Email Notifications

* Toggle Admin notifications
* Define additional notification recipients
* Toggle SMTP with credential fields

#### Tools

* Import Users.
* Importing parameters and field mapping.
* Export Users.
* Exporting parameters.

#### User Blogs

* Turn User Blog Post Submission On/ Off.
* Fetch Posts from WordPress Posts/ In-built System/ Both
* Default Post state after user submission
* Allow Feature Image
* Allow tags
* Use rich text editor
* Privacy settings
* Notify Users
* Notify Admin

#### Private Messaging

* Toggle Messaging On/ Off

#### Friends System

* Toggle Friend System On/ Off
* All resending friend requests
* Period after which resending request is allowed

#### Uploads

* Profile Image Maximum File Size (in bytes)
* Cover Image Maximum File Size (in bytes)
* Image Quality
* Profile image minimum width
* Cover image minimum width

#### Uploads

* Profile Image Maximum File Size (in bytes)
* Cover Image Maximum File Size (in bytes)
* Image Quality
* Profile image minimum width
* Cover image minimum width

#### SEO

* User Profile Page Title
* User Profile Description (HTML Meta)

#### Payments

* Payment Processor – Paypal (Free) & Stripe (Extension).
* Toggle test mode.
* PayPal Email.
* Currency selection.
* PayPal page style.
* Currency symbol position.

As you can see, ProfileGrid core is pretty powerful in its own right and many will find it useful standalone. For those who need extra, there are plenty of extensions available. Present set of extensions include:

#### Free Custom User Profile Slugs

Define how your frontend user profile URL will appear to site visitors and search engines. Take control of your frontend user profile url permalink and add dynamic slugs.

[Custom User Profile Slugs](https://profilegrid.co/extensions/user-profile-custom-slugs/)

#### Group Photos

Allow your users to create and share Photo Albums within their Groups. Albums can be public or restricted to group members. Users can browse and enlarge photos, and post comments.

[Group Photos](https://profilegrid.co/extensions/group-photos/)

#### Free User Display Name

Take complete control of your users’ display names. Mix and match patterns and add predefined suffixes and prefixes. There’s both a global and a group based option, allowing display names in different groups stand out!

[User Display Name](https://profilegrid.co/extensions/user-display-name/)

#### Custom Group Properties

Create and add custom data fields to user groups! Now your user groups can have more detailed information and personality just like your user profile pages. These fields appear on single group page.

[Custom Group Properties](https://profilegrid.co/extensions/custom-group-fields/)

#### Free bbPress Integration – ENHANCE BBPRESS USER PROFILES

Integrate ProfileGrid user profile properties and sign up system with the immensely popular bbPress community forums plugin.

* bbPress User Profiles with Community Activity
* bbPress Custom User Profiles Fields.
* Edit bbPress User Profiles

[Free bbPress Integration](https://profilegrid.co/extensions/bbpress-integration/https%3A//profilegrid.co/extensions/bbpress-integration/)

#### User Geolocation Maps

Publish interactive maps on your website showcasing locations of all registered users or members from a specific group using simple shortcodes. Features location markers with user info popovers.

[User Geolocation Maps](https://profilegrid.co/extensions/geolocation/)

#### Frontend Group Creator

Give your registered users power to create their own user membership Groups. These Groups behave and work just like regular ProfileGrid membership groups.

[Frontend Group Creator](https://profilegrid.co/extensions/frontend-group-creator/)

#### MailChimp Integration

Allow users to subscribe to your MailChimp lists. Comes with custom field mapping support and option for users to manage subscriptions right from their user profile area.

[MailChimp Integration](https://profilegrid.co/extensions/mailchimp-integration/)

#### Free WooCommerce Integration – ENHANCE WOOCOMMERCE USER PROFILES

[Combine the power of ProfileGrid’s user membership groups with WooCommerce](https://profilegrid.co/woocommerce-user-profiles-purchases-reviews-social-activity/) to create enhanced WooCommerce user profiles with option to display purchases, reviews, manage addresses and more. This can be used instead of default WooCommerce user profile page for more engaging user experience.

* WooCommerce Profile Builder.
* WooCommerce User Profile with Payments, Reviews & Social Activity.
* WooCommerce Custom User Profiles Fields.
* Edit WooCommerce Customer Profiles.

#### Social Login

Allow users to connect and login using their social networking accounts. Users can manage connected accounts from their profile settings.

[Social Login](https://profilegrid.co/extensions/social-login/)

#### Custom User Profile Tabs

Display user specific, or custom content, from other plugins as additional tabs on user profiles. You can add as many custom tabs you like. Examples of practical uses include, events, meetings, forms, listings, directories etc.

[Custom User Profile Tabs](https://profilegrid.co/extensions/custom-user-profile-tabs-content/)

#### myCred Integration

Reward your website users with custom ranks and badges, on reaching predefined goals, using powerful and free myCred points system. Ranks and Badges will also be displayed on their user profiles.

[myCred Integration](https://profilegrid.co/extensions/mycred-integration/)

#### User Photos

Allow users to create …

## Screenshots

* [![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-1.png?rev=2520305)](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-1.png?rev=2520305)

  User Profile Page
* [![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-2.png?rev=2520305)](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-2.png?rev=2520305)

  All Groups Page (with option to sign up for a Group).
* [![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-3.png?rev=2520305)](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-3.png?rev=2520305)

  Messaging System
* [![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-4.png?rev=2520305)](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-4.png?rev=2520305)

  Messaging System – 2
* [![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-5.png?rev=2520305)](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-5.png?rev=2520305)

  User Blogs
* [![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-6.png?rev=2520305)](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-6.png?rev=2520305)

  Another User Profile Page
* [![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-7.png?rev=2520305)](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-7.png?rev=2520305)

  User can change profile image or user avatar and cover photo easily.
* [![](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-8.png?rev=2520305)](https://ps.w.org/profilegrid-user-profiles-groups-and-communities/assets/screenshot-8.png?rev=2520305)

  Profile Editing page – notice that sections are spread into accordion bars making editing large profiles easy.

## Blocks

This plugin provides 39 blocks.

* Sign-Up Form
* Current User Profile
* All Groups
* All Users
* Login Form
* Group Page
* User Blogs
* Blog Submission
* Password Recovery Form
* Blog Area
* Group Description
* User First Name
* Messaging
* Group Member Count
* User Last Name
* Notifications
* Group Manager Count
* User Email ID
* Friends
* Group Managers
* User Profile Image
* Group Managers List
* User Cover Image
* Settings
* Group Member Cards
* User Default Group
* Account
* Group Manager Cards
* User Groups
* Change Password
* User Group Badges
* Unread Notification Count
* Privacy
* Unread Message Count
* Delete Account
* About
* Group Cards
* Groups
* Group Name

## Installation

1. Download the plugin
2. Go to your Dashboard and locate Plugins tab. Click on Upload Plugin and specify the path of downloaded plugin in the text box.
3. Click on Activate Plugin

## FAQ

### Is there a limit to the number of users I can register?

No, there is no limit. Although you can limit the number of users for each group you create.

### How can I add custom fields to a group?

Click “Fields” button on a group card to go to fields manager for that particular group. Here you can add, edit and sort the fields here.

### Can I rearrange fields in my forms?

Yes, you can change field order of custom fields by drag and drop method in dashboard.

## Reviews

![](https://secure.gravatar.com/avatar/5a1bc57d9c33e489ce19e70b507343f5e01d8d1193e0062c517fd59733849220?s=60&d=retro&r=g)
### [Only Membership Plugin Worth to Get!!!](https://wordpress.org/support/topic/only-membership-plugin-worth-to-get/)

[DianaN](https://profiles.wordpress.org/desertdianagmailcom/ "Posts by DianaN")
January 9, 2025

Start off, I have tried many membership plugins if they had a free version or trial. All were very frustrating hard to configure or too many errors. Until, from reading post from Divi Elegant Themes my theme of choice, I saw ProfileGrid listed. Downloaded and right off the bat, I was so impressed. User friendly many features in the free version to get started with. There were 2 issues that support help me with, which were my fault but they were gracious, kind and didn’t stop with offering any assistance I needed. Plus there are many free addons like RegistrationMagic you can install. Or like me, I like everything so I bought the unlimited lifetime license. Such a deal!!!
Thank you to the team at Metagauss for taking ProfileGrid to a new level and fixed everything wrong with the competition. I am truly grateful.

![](https://secure.gravatar.com/avatar/b3b4cbfbbd0e39eaac8129769f0ec0878fbb0ddaf45a0fc913ea612dbafd0655?s=60&d=retro&r=g)
### [spolek-spona.cz](https://wordpress.org/support/topic/spolek-spona-cz/)

[klodak](https://profiles.wordpress.org/klodak/ "Posts by klodak")
January 6, 2025

Moc hezký plugin

![](https://secure.gravatar.com/avatar/3535f86377d6af2d2c8e4617314540d03dc60b319fb6c29f8813c84922f08b78?s=60&d=retro&r=g)
### [Can’t find a way to use this with BetterDocs](https://wordpress.org/support/topic/cant-find-a-way-to-use-this-with-betterdocs/)

[In Touch Consulting](https://profiles.wordpress.org/intercommsa/ "Posts by In Touch Consulting")
October 15, 2024
1 reply

I changed this review after finding additional functionality.ORIGINALI bought the pro version, primarily to manage user access to different areas of a Support Knowledgebase. But 99% of my site is BetterDocs and I can’t find a way to include ProfileGrid’s access control on these pages? It looks like it only works with default posts and pages, and it’s own blog? I had hoped to use this with LifterLMS, but if it doesn’t work with custom content types, it isn’t very useful.
REVISEDThere is a shortcode to show and hide content. Although this is more work than an automatic solution, it’s more flexible. I set “log in to see more content” for Guests, and set the remaining content to display for the group. The benefit of this method is that I can put tempting teasers with SEO to show to Google. I like the shortcodes, as they are easy to manage and work with everything. I discovered that it caused a display problem with images and galleries, so they might not work with all content types.
If you are using BetterDocs specifically, it has an internal knowledgebase what has access control for entire sections.

![](https://secure.gravatar.com/avatar/25199fa77130c00b1279c0ce57d741bd06e282224a14c431393e8cc77c68dde5?s=60&d=retro&r=g)
### [Not Recommended](https://wordpress.org/support/topic/outstanding-support-202/)

[Sean Callanan](https://profiles.wordpress.org/jcallanan/ "Posts by Sean Callanan")
October 4, 2024

I HAVE NEVER EVER HAD TO WORK WITH ANY OF THESE METAGAUSS PRODUCTS AND NOT FIND SOME PROBLEM THAT IS CLEARLY INDICATIVE OF LACK OF ATTENTION. I COULD NOT RECOMMEND THIS STUFF ANY LESS. THEY ARE SO BAD THAT JUST BY USING THEM, MY CLIENTS ARE QUESTIONING MY JUDGEMENT.

![](https://secure.gravatar.com/avatar/83106ad77e225d19ca036d10961cb1fec9ea73345426d80152c90527d894cd39?s=60&d=retro&r=g)
### [Exceptional Support and a Fantastic Plugin!](https://wordpress.org/support/topic/exceptional-support-and-a-fantastic-plugin/)

[discrockers](https://profiles.wordpress.org/discrockers/ "Posts by discrockers")
September 30, 2024
1 reply

I have been incredibly impressed with the ProfileGrid plugin! The functionality is fantastic, and it has made building my website so much easier. I’m especially thrilled with the Geolocation feature, which has added a valuable layer of usability to my platform, helping users easily connect with therapy dog teams across Germany.
The support team has been nothing short of exceptional. They were quick to respond and went above and beyond to assist me with my project. It’s rare to find such a dedicated and responsive support system, and it makes all the difference.
Overall, I highly recommend ProfileGrid for anyone looking for a powerful and reliable solution for creating user profiles and communities. This plugin truly delivers!

![](https://secure.gravatar.com/avatar/baae189562efa9cf1a7a444fc3028a11ace600d803244022404face7bab59210?s=60&d=retro&r=g)
### [Вроде хороший?](https://wordpress.org/support/topic/disgusting-14/)

[Stanislav](https://profiles.wordpress.org/pigus/ "Posts by Stanislav")
September 26, 2024
1 reply

Вроде хороший плагин, как раз то, что я искал для сайта!

[Read all 218 reviews](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/reviews/)
## Contributors & Developers

“ProfileGrid – User Profiles, Groups and Communities” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/417e1af73753f6e4f19b5c2c843e5a9f0d084401db5ee93b0961d0e463c2d2d9?s=32&d=mm&r=g) [profilegrid](https://profiles.wordpress.org/profilegrid/)
* ![](https://secure.gravatar.com/avatar/7009744da2f2179968557e60c6557a0170996ebfccac09121e03db589c208e2e?s=32&d=mm&r=g) [Metagauss](https://profiles.wordpress.org/metagauss/)

“ProfileGrid – User Profiles, Groups and Communities” has been translated into 14 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/profilegrid-user-profiles-groups-and-communities/contributors) for their contributions.

[Translate “ProfileGrid – User Profiles, Groups and Communities” into your language.](https://translate.wordpress.org/projects/wp-plugins/profilegrid-user-profiles-groups-and-communities)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/profilegrid-user-profiles-groups-and-communities/), check out the [SVN repository](https://plugins.svn.wordpress.org/profilegrid-user-profiles-groups-and-communities/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/profilegrid-user-profiles-groups-and-communities/) by [RSS](https://plugins.trac.wordpress.org/log/profilegrid-user-profiles-groups-and-communities/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 5.9.4.1: January 2, 2025

* Minor UI Fixes.

#### 5.9.4.0: December 19, 2024

* Minor UI Fixes.
* New Extension: ProfileGrid Turnstile Antispam Security, is now available!
* New Extension: ProfileGrid Profile Visitors, is now available!

#### 5.9.3.9: December 12, 2024

* Fixed: Minor UI fixes.

#### 5.9.3.8: November 29, 2024

* Fixed: Minor UI fixes.

#### 5.9.3.7: November 14, 2024

* Added: Security fixes.

#### 5.9.3.6: November 06, 2024

* Fixed: An issue with Message notifications.

#### 5.9.3.5: October 22, 2024

* Fixed: Minor UI fixes.

#### 5.9.3.4: September 28, 2024

* Fixed: Minor UI fixes.

#### 5.9.3.3: September 25, 2024

* Added: Security fixes.

#### 5.9.3.2: September 11, 2024

* New Feature: Added the option to assign Group-Specific Profile Templates, allowing admins to customize profile layouts for different user groups.
* Fixed: Resolved notification issue for deleted blog posts and wall posts.
* Fixed: Improved compatibility of Login/Logout Menu integration with the Avada theme.

#### 5.9.3.1: August 24, 2024

* Added: Security fixes.

#### 5.9.3: August 20, 2024

* Fixed: Minor UI fixes.
* Corrected few typos.

#### 5.9.2: July 30, 2024

* Added: Profile link to User Profile Image on the group page.

#### 5.9.1: July 17, 2024

* Fixed: Minor UI fixes.
* Fixed: An issue with Stripe return URL.
* Fixed: EventPrime Integration issue.

#### 5.9.0: July 3, 2024

* Fixed: Minor UI issues.
* Added: Security fixes.
* Fixed: Updated Map API in User Geolocation Maps extension.

#### 5.8.9: June 18, 2024

* Minor Improvements and Bug Fixes.

#### 5.8.8: June 5, 2024

* Fixed: Minor UI fixes.
* Added: Security Updates.

#### 5.8.7: May 31, 2024

* Added: Security Updates.

#### 5.8.6: May 13, 2024

* Minor Improvements and Bug Fixes.

#### 5.8.5: April 24, 2024

* Fixed: Activation Issue.

#### 5.8.4: April 13, 2024

* Added: Security Updates.

#### 5.8.3: April 11, 2024

* Added: Security Updates.

#### 5.8.2: April 2, 2024

* Improved: Group card shortcode.

#### 5.8.1: March 21, 2024

* Fixed: URL Field issue.
* Fixed: File Field issue.
* Fixed: ProfileGrid and RegistrationMagic Integration issue.
* Fixed: Hero Banner extension issue.
* Multiple bug fixes and improvements.

#### 5.8.0: March 11, 2024

* Added: Security Updates.

#### 5.7.9: March 7, 2024

* Added: Security Updates.
* Multiple bug fixes and improvements.

#### 5.7.8: February 18, 2024

* Fixed: Group Icon issue.

#### 5.7.7: February 15, 2024

* Added: Security Updates.
* Fixed: Deprecate notices with extensions.
* Multiple bug fixes and improvements.

#### 5.7.6: February 12, 2024

* Fixed: An issue where user is unable to click checkbox.

#### 5.7.5: January 23, 2024

* Minor Improvements and Bug Fixes.

#### 5.7.4: January 18, 2024

* Fixed: Minor UI fixes.

#### 5.7.3: January 09, 2024

* Fixed: Multiple Usability Issues.
* Fixed: Translation issues.
* Fixed: Minor UI fixes.

#### 5.7.2: December 27, 2023

* Added: Security Update for SQL Injection.
* Added: Security Update for CSRF Vulnerability.
* Fixed: WooCommerce Integration Issue.
* Fixed: Minor Extension Integration Issue for Group Slugs.

#### 5.7.1: December 14, 2023

* Added: Security Updates
* New: Identification for Group Managers on tiles.
* Fixed: An issue with the secondary Group manager authorization.
* Fixed: Issue with functionality related to searching members.
* Fixed: Minor text updates for Reset Password email.
* Multiple bug fixes and improvements.

#### 5.7.0: December 5, 2023

* Fixed: An issue with custom product tab.
* Added: Option to change date format.
* New: User requests page design.
* Fixed: An issue with social connect system.
* Fixed: An issue with widgets.
* Multiple bug fixes and improvements.

#### 5.6.9

* Usability fixes.

#### 5.6.8

* Design Improvements
* Minor Design Issue Fixes

#### 5.6.7

* Usability fixes.
* Security patch.
* Design improvements.

#### 5.6.6

* Usability fixes.

#### 5.6.5

* PHP 8.2 Compatibility Updates
* Third-party Integration Fixes
* Minor Improvements and Bug Fixes

#### 5.6.4

* Multiple Bug Fixes

#### 5.6.3

* Usability Fixes.
* Integration Fixes.

#### 5.6.2

* Usability fixes.

#### 5.6.1

* Usability fixes.
* Minor improvements.

#### 5.6.0

* Design Improvements.
* Minor Issue Fixes.
* Usability Improvements.

#### 5.5.9

* Multiple Issue Fixes and Usability Improvements.

#### 5.5.8

* Multiple Issue Fixes and Usability Improvements.
* Translation Fixes and Improvements.

#### 5.5.7

* Design Improvements.
* Minor Issue Fixes.

#### 5.5.6

* Usability improvements.

#### 5.5.5

* Multiple Issue Fixes and Usability Improvements.
* WordPress 6.3 Compatibility Changes.

#### 5.5.4

* Translation Fixes and Improvements.
* Design and Usability Improvements.

#### 5.5.3

* Security updates.

#### 5.5.2

* Security updates.

#### 5.5.1

* Security updates.

#### 5.5.0

* Design and Usability Improvements.

#### 5.4.9

* Usability improvements.

#### 5.4.8

* Fixed: An issue with user URL field.
* Usability improvements.

#### 5.4.7

* Fixed: An issue with members count.
* Usability improvements.

#### 5.4.6

* Fixed: An issue with Custom User Profile Tabs extension.
* Fixed: An issue with Online Users extension.
* Usability improvements.

#### 5.4.5

* Fixed: Issue with Group Page Rendering

#### 5.4.4

* Fixed: An issue with Stripe repayment process.
* Fixed: An issue with PayPal repayment process.
* Fixed: An issue with Login “Failed Security Checks”.
* New: Added an Option to Show/Hide “Account Details” Tab.
* Usability improvements.

#### 5.4.3

* Usability improvements.
* New: Extension added – WooCommerce Customized Product Restrictions.
* New: Extension added – Customized Group Slugs.

#### 5.4.2

* Fixed: An issue with Frontend Group Managers.

#### 5.4.1

* Multiple bug fixes.

#### 5.4.0

* Usability improvements.
* Fixed: An issue with cover photo and profile photo upload.
* Fixed: An issue with RegistrationMagic integration.

#### 5.3.3

* Usability improvements.
* Minor defect fixes.

#### 5.3.2

* Usability improvements.

#### 5.3.1

* Security updates.

#### 5.3.0

* Usability improvements.
* Minor defect fixes.

#### 5.2.9

* Usability improvements.

#### 5.2.8

* Usability improvements.
* Minor defect fixes.

#### 5.2.5

* New: Added new option to remove selected field from filters on group page.

#### 5.2.4

* Fixed: An issue with Private Profile.

#### 5.2.3

* Update Stripe API.
* Fixed: An issue with PayPal.
* Fixed: An issue with Messaging feature.
* Usability improvements.

#### 5.2.2

* Usability improvements with User Blogs.
* New: Added new shortcode to display user profile.
* Fixed: Delete fields issue with Custom Group Properties Extension.
* Fixed: PHP 8.0 notice with Elementor Integration Extension.

#### 5.2.1

* Usability improvements.

#### 5.2.0

* Fixed: An issue with MailPoet extension.

#### 5.1.9

* Usability improvements.
* Minor defect fixes.

#### 5.1.8

* Security updates.

#### 5.1.7

* Security updates.

#### 5.1.6

* Usability improvements.

#### 5.1.5

* Compatibility update for WordPress 6.1.
* Stripe usability improvements and bug fixes.

#### 5.1.4

* Usability improvements.

#### 5.1.3

* Performance updates.

#### 5.1.2

* WooCommerce integration workflow improvements.

#### 5.1.1

* Security updates.

#### 5.1.0

* Usability improvements.

#### 5.0.9

* Usability improvements.

#### 5.0.8

* Fixed: An issue with Group Wall extension.
* Fixed: An issue with WooCommerce Members Discount extension.

#### 5.0.7

* Usability improvements.

#### 5.0.6

* Fixed: An issue with redirection after the user logs out.
* Fixed: An issue with user import system.

#### 5.0.5

* Fixed: An issue where existing membership charges for a group cannot be removed.

#### 5.0.4

* UI Fixes and improvements.
* Security updates.

#### 5.0.3

* UI improvements and fixes.

#### 5.0.2

* Fixed: An issue with Create New Group.

#### 5.0.1

* Fixed: An issue with Group Options where paid membership price option was not visible.

#### 5.0.0

* New: Improved All Groups page with new UI.
* New Improved Group Options page with new UI. Options are now organized into separate tabs for easier editing.
* Multiple UI and workflow tweaks.

#### 4.9.8

* Minor CSS fixes.

#### 4.9.7

* Minor jQuery fixes.
* Minor CSS fixes.

#### 4.9.6

* Fixed: An issue with profile notifications.
* Fixed: A jQuery error in WordPress dashboard (console error).
* Fixed: A warning message during fresh installation on single Group Page.

#### 4.9.5

* Added: Auto-scroll to top when there is validation error while submitting registration form.

#### 4.9.4

* Updated: Deprecated Google+ field in profile fields since the service is no longer available.

#### 4.9.3

* Usability improvements.

#### 4.9.2

* Fixed: An issue with profile image in comments section when BuddyPress is installed and active.

#### 4.9.1

* Fixed: An issue with cover image and profile image uploading process.

#### 4.9.0

* New: Gutenberg Block – User Directory.
* Updated: Visual improvements to user directory page.
* New: Option to choose user card size on user directory page.
* New: Option to control login form override (RegistrationMagic login form).

#### 4.8.9

* Minor UI changes.

#### 4.8.8

* UI Fixes.

#### 4.8.7

* Updated: Extension titles.

#### 4.8.6

* Revamped user search experience will new features! Options moved to separate area in Global Settings.
* New: Elementor Extension with native Elementor widgets for ProfileGrid.

#### 4.8.5

* Fixed: An issue where using multiple file upload profile field was returning error.
* Fixed: An issue with edit and delete feature in messaging.

#### 4.8.4

* Fixed: HTML parsing issues in User Blogs comments section.
* Fixed: An issue which resulted in 502 error in some cases.

#### 4.8.3

* UI Changes.

#### 4.8.2

* Fixed: An HTML parsing issue with password reset email.

#### 4.8.1

* Fixed: An issue where Content Restriction Options did not displayed properly with classic editor.
* Fixed: Cover image error on frontend.

#### 4.8.0

* Fixed: An issue with reset password feature.
* Fixed: Notices on widgets.
* Fixed: Notification close issue on user profiles.

#### 4.7.9

* Fixed: Dismissible admin notice UI.
* Added: We have made accessing group forms easier, by introducing new admin submenu ‘Forms’.

#### 4.7.8

* Fixed: An issue where filtering user blog posts by tags returned 0 results in the admin area.

#### 4.7.7

* Security fixes.

#### 4.7.6

* Security fixes.

#### 4.7.5

* Security fixes.

#### 4.7.4

* Fixed: An issue where readonly field value would disappear on editing profile.

#### 4.7.3

* New: Gutenberg blocks for User Blogs and Blog Submissions are now available.

#### 4.7.2

* Fixed: An issue with last release on plugin activation.

#### 4.7.1

* Added: Installation message.
* Added: Option to download extensions currently in beta.

#### 4.7.0

* Minor UI changes. Global Settings is now better organized.

#### 4.6.9

* New: Gutenberg block for All Groups view.
* New: Gutenberg block for Single Group view.
* Fixed: Notices in Multi-Group Manager Extension.
* Fixed: An issue with Instagram tab, in Social Login extension.
* Fixed: ProfileGrid Widgets Privacy extension CSS related issued.
* Updated: Elementor Content Restrictions extension.
* Updated: Elementor User Login extension.

#### 4.6.8

* Fixed: An issue with content restriction settings.
* Fixed: An issue with Gutenberg block settings.

#### 4.6.7

* New: Gutenberg Block for publishing signup forms.
* New: Gutenberg Block for publishing login forms.
* New: Elementor User Login Extension.
* Fixed: PHP notice.

#### 4.6.6

* Fixed: An issue with password recovery page.

#### 4.6.5

* Fixed: An issue with URL profile field.

#### 4.6.4

* Fixed: UI issue impacting tabs layout on member pages on some websites.
* Fixed: JS issue while adding or removing friends on frontend.

#### 4.6.3

* Fixed: Member cards shortcode now inherits default sorting.
* Added: Member cards shortcode now accept additional parameters of sort by, with different available values.

#### 4.6.2

* Fixed: Layout issues in private messaging view on mobile portrait orientation.

#### 4.6.1

* Added: Option to select all users on Members page in admin area.
* New: Elementor Content Restriction Extension!

#### 4.6.0

* Minor UI Fixes.

#### 4.5.9

* Fixed: An issue where irrelevant profile fields appeared in user filters on group page.
* Updated: ProfileGrid Member Profile Reviews.
* Updated: Profilegrid Custom Profile Tabs.
* Updated: ProfileGrid User Display Name.
* Updated: Profilegrid Menu Restrictions.

#### 4.5.8

* Improved: CSS to work with dark themes.
* New: Zapier extension supporting external automation!

#### 4.5.7

* Fixed: An issue with blog publishing shortcode filtered by username.
* Improved: Extension installation workflow for WooCommerce and bbPress.

#### 4.5.6

* Minor UI Fixes.
* New Extension: ProfileGrid Widgets Privacy, is now available!

#### 4.5.5

* Fixed: Privacy options moved to right sidebar since they were covering large part of block editor view.
* Added: 9 new hooks.

#### 4.5.4

* Fixed: And error which was displayed in some scenarios.

#### 4.5.3

* Fixed: An error which appeared during some scenarios on admin page Member page.
* Fixed: An issue with blog notifications inside User Profiles on frontend.
* Fixed: An issue with comments layout on User Blogs on frontend.
* Fixed: An issue with cover image on Astra theme on frontend.
* Fixed: An issue where user status was incorrectly displayed in admin area Members page.

#### 4.5.2

* Fixed: An issue with profile and cover images in multisite environment.

#### 4.5.1

* Fixed: An issue with user import feature.

#### 4.5.0

* Fixed: An issue with forgot password link.
* Improved: Mobile responsiveness with messaging module.
* Fixed: An issue with Custom Tabs extension while using Elementor.

#### 4.4.9

* Fixed: Minor issues with messaging module.

#### 4.4.8

* Fixed: An issue with private messaging while using Display Name Extension.
* Fixed: An issue with WooCommerce review author names.

#### 4.4.7

* Improved: Private Messaging System.
* Changed: Admin Menu Order.
* Fixed: An issue with WooCommerce Members Discount extension.

#### 4.4.6

* Added: 65 strings for translation.
* New: URL profile field with anchor text.

#### 4.4.5

* New: User Meta option inside Profile Fields to attach field values to WordPress user\_meta.
* Added: Profile Completeness Extension.
* Updated: User Photos Extension, with option to add more media types.

#### 4.4.4

* New: Read-only profile field.

#### 4.4.3

* New: Read-only profile field.
* New: Custom URL profile field.
* Fixed: Minor issues with SEO settings.
* New: Extension added – Featured Group.
* New: Extension added – Users Carousel Widget.

#### 4.4.2

* New: Customizable friend request email notification.
* Fixed: View link issue in message notification in notification tab.

#### 4.4.1

* Improved: Profile editing workflow.

#### 4.4.0

* Added: New hook on user request.
* Fixed: An issue with translation of gender field.
* Fixed: An issue with gender field database saving.
* Fixed: An issue with SMTP mails.
* Fixed: A scenario which returned error on search.

#### 4.3.9

* Resolved some potential CSS conflicts.

#### 4.3.8

* Security issue fix.

#### 4.3.7

* Added: New option for default sorting of groups on frontend.
* Added: New option for default sorting of users on frontend (group and directory pages).
* Added: New option to define number of groups per page on frontend.
* Added: New option to define number of users per page on frontend (group and directory pages).
* Improved: JS and CSS performance handling for extensions.
* New: Free Extensions – Groups Carousel Widget.
* New: Extension: Member Profile Reviews.

#### 4.3.6

* Fixed fields manager section issues with Chinese language.
* Added new settings to combine JS and CSS for improved site performance.

#### 4.3.5

* Fixed recreation of shortcode pages upon activation.
* Fixed a bug with gender radio box.

#### 4.3.4

* New: Admin option to define custom post slugs for user blogs.
* New: Admin option to define custom post slugs for Group Wall Extension.
* Fixed: Year selection limitation in dashboard edit user.
* New: Admin option in Geolocation Extension to retrieve coordinates using more secure CURL method.
* New: Recent Signups Extension.

#### 4.3.3

* Fixed: An issue where WooCommerce session was prematurely terminated.
* Added: New translatable strings.
* Added: Two new extensions!

#### 4.3.2

* UI Improvements and fixes.
* Added new extension – Online Users Widget.

#### 4.3.1

* Fixed: Date Picker year issue.

#### 4.3.0

* New: dashboard area theme to complement revamped ProfileGrid website.
* Improved: Group Card user timestamps now follow default WordPress date and time formats.
* Improved: Code optimization.

#### 4.2.3

* Fixed: An issue related to members tab visibility on the group page.

#### 4.2.2

* Improved: Global Settings page now has a new cleaner look. Icons have been redone and layout is more productivity focussed. Extension settings have been separated from Core settings.
* Fixed: Some people faced problems with image cropping system for profile image uploads. This has been fixed.
* Added: Registration link now appears on log in page, improving user experience.

#### 4.2.1

* Bug fixes.
* Added new extension – ProfileGrid WooCommerce Members Discount!
* Added new extension – ProfileGrid WooCommerce Product Custom Tabs!

#### 4.2.0

* Major new feature added: Now you can selectively turn on or off individual profile elements to get that perfect combination you want! Just go to Dashboard –> ProfileGrid –> Global Settings –> Element Visibility.
* New feature added: Decided which Groups you wish to show on All Groups page.

#### 4.1.9

* Added Register form link to Login box.

#### 4.1.8

* Searching messages now excludes private profiles or profiles with ‘Hide my profile’ enabled.
* Fixed more (+) groups link on profile page.
* Fixed a console error on profile page.
* Fixed an issue with User Photos extension.
* Fixed an issue with Geolocation extension.
* Updated version number for WooCommerce Subscriptions extension.

#### 4.1.7

* workflow improvements.

#### 4.1.6

* New extension added! – ProfileGrid Hero Banner
* New extension added! – ProfileGrid WooCommerce Subscription Integration.
* Profile images are now linked to profiles.
* Fixed an issue with user import process.

#### 4.1.5

* New extension added! – ProfileGrid Demo Content
* New extension added! – ProfileGrid WooCommerce Product Integration.
* Added option to edit default membership termination email template.
* GMT Date issue fixes in Group Photos Extension.
* Minor fixes in ProfileGrid Custom Tab Extension.

#### 4.1.4

* Updated counties list.
* Compatibility update for latest Instagram APIs.

#### 4.1.3

* Minor bug fixes.
* Accessibility changes to shortcodes page.

#### 4.1.2

* First name and last name fields are now marked required in edit profile view.
* Terms and Conditions checkbox no longer appears in edit profile view.
* Frontend Group Creator: By default, users are automatically made member of groups they create on front-end. Admin can change this to make them group manager on creation of group from global settings.
* Advance WooCommerce integration: WooCommerce subscriptions now appear in user profile tabs.

#### 4.1.1

* Improved shortcodes page.
* Fixed: a bug in Group Managers shortcode.

#### 4.1.0

* Added: Brand new set of feature and content shortcodes!
* Granular content restriction through new shortcodes.
* Dynamic content shortcodes for personalized content.
* Added: New feature for Geolocation extension. – Now you can show only logged in users on the map.
* Added: New feature for Geolocation extension. – Now you can restrict location details to Group Managers.

#### 4.0.6

* Minor CSS Fixes.

#### 4.0.5

* New extension added! – ProfileGrid Menu Restrictions.
* New extension added! – ProfileGrid User Photos.
* Fixed a minor issue with Group Manager assignment.

#### 4.0.4

* Fixed an issue related to section.

#### 4.0.3

* Added New Profile Field for NickName.
* Fixed an issue related to Admin Only option in the field.
* Fix compatibility issues with PHP 7.4.
* Extension updated – ProfileGrid Group Photos.

#### 4.0.2

* Fixed reset password link issue within Multisite environment.
* Fixed an issue where multiple emails were being sent to notify users about unread messages.
* New extension added! – User Profile Status
* Extension updated with new reordering feature – Login Logout Menu.

#### 4.0.1

* Fixed extensions related errors.

#### 4.0.0

* Messaging system code revamped.
* Fixed an issue with recently introduced rich text profile field.

## Meta

* Version **5.9.4.1**
* Last updated **1 week ago**
* Active installations **7,000+**
* WordPress version **3.5 or higher**
* Tested up to **6.7.1**
* PHP version **7.4 or higher**
* Languages
  See all 15

  Close

  [Chinese (China)](https://cn.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Czech](https://cs.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Dutch](https://nl.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [English (US)](https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [German](https://de.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Indonesian](https://id.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Polish](https://pl.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Portuguese (Brazil)](https://br.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Romanian](https://ro.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Slovak](https://sk.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Spanish (Argentina)](https://es-ar.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Spanish (Colombia)](https://es-co.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Spanish (Spain)](https://es.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), [Spanish (Venezuela)](https://ve.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/), and [Turkish](https://tr.wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/profilegrid-user-profiles-groups-and-communities)
* Tags [community](https://wordpress.org/plugins/tags/community/)[membership](https://wordpress.org/plugins/tags/membership/)[profile](https://wordpress.org/plugins/tags/profile/)[profile widget](https://wordpress.org/plugins/tags/profile-widget/)[user profile](https://wordpress.org/plugins/tags/user-profile/)
* [Advanced View](https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/advanced/)

## Ratings

4.6 out of 5 stars.

* [185 5-star reviews
  5 stars

  185](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/reviews/?filter=5)
* [11 4-star reviews
  4 stars

  11](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/reviews/?filter=4)
* [5 3-star reviews
  3 stars

  5](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/reviews/?filter=3)
* [4 2-star reviews
  2 stars

  4](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/reviews/?filter=2)
* [13 1-star reviews
  1 star

  13](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/417e1af73753f6e4f19b5c2c843e5a9f0d084401db5ee93b0961d0e463c2d2d9?s=32&d=mm&r=g) [profilegrid](https://profiles.wordpress.org/profilegrid/)
* ![](https://secure.gravatar.com/avatar/7009744da2f2179968557e60c6557a0170996ebfccac09121e03db589c208e2e?s=32&d=mm&r=g) [Metagauss](https://profiles.wordpress.org/metagauss/)
## Support

Issues resolved in last two months:

11 out of 11

[View support forum](https://wordpress.org/support/plugin/profilegrid-user-profiles-groups-and-communities/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](http://profilegrid.co)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_3fd31e18_20250111_195921.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# ProfileGrid – User Profiles, Groups and Communities <= 5.9.3.2 - Authenticated (Contributor+) Stored Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   ProfileGrid – User Profiles, Groups and Communities <= 5.9.3.2 - Authenticated (Contributor+) Stored Cross-Site Scripting

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-8861](https://www.cve.org/CVERecord?id=CVE-2024-8861) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | September 25, 2024 |
| Last Updated | September 26, 2024 |
| Researcher | [Francesco Carlucci](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/francesco-carlucci) |

### Description

The ProfileGrid – User Profiles, Groups and Communities plugin for WordPress is vulnerable to Stored Cross-Site Scripting in all versions up to, and including, 5.9.3.2 due to incorrect use of the wp\_kses\_allowed\_html function, which allows the 'onclick' attribute for certain HTML elements without sufficient restriction or context validation. This makes it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php#L268)
* [wordpress.org](https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php#L2065)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3157510/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fprofilegrid-user-profiles-groups-and-communities%2Fprofilegrid-user-profiles-groups-and-communities-5932-authenticated-contributor-stored-cross-site-scripting&t=ProfileGrid%20%E2%80%93%20User%20Profiles%2C%20Groups%20and%20Communities%20%3C%3D%205.9.3.2%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fprofilegrid-user-profiles-groups-and-communities%2Fprofilegrid-user-profiles-groups-and-communities-5932-authenticated-contributor-stored-cross-site-scripting&text=ProfileGrid%20%E2%80%93%20User%20Profiles%2C%20Groups%20and%20Communities%20%3C%3D%205.9.3.2%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fprofilegrid-user-profiles-groups-and-communities%2Fprofilegrid-user-profiles-groups-and-communities-5932-authenticated-contributor-stored-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for ProfileGrid – User Profiles, Groups and Communities

#### [ProfileGrid – User Profiles, Groups and Communities](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/profilegrid-user-profiles-groups-and-communities)

| Software Type | Plugin |
| --- | --- |
| Software Slug | profilegrid-user-profiles-groups-and-communities [(view on wordpress.org)](https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities) |
| Patched? | Yes |
| Remediation | Update to version 5.9.3.3, or a newer patched version |
| Affected Version | * <= 5.9.3.2 |
| Patched Version | * 5.9.3.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_2c6a6044_20250111_195917.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fprofilegrid-user-profiles-groups-and-communities%2Ftrunk%2Fincludes%2Fclass-profile-magic.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php?rev=3076409 "Revision 3076409")
* Next Revision →
* [Blame](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php)

---

# [source:](/browser?order=name "Go to repository root") [profilegrid-user-profiles-groups-and-communities](/browser/profilegrid-user-profiles-groups-and-communities?order=name "View profilegrid-user-profiles-groups-and-communities")/[trunk](/browser/profilegrid-user-profiles-groups-and-communities/trunk?order=name "View trunk")/[includes](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes?order=name "View includes")/[class-profile-magic.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php?order=name "View class-profile-magic.php")

View diff against:

View revision:

| [Last change](/changeset/3157510/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php "View differences") on this file was [3157510](/changeset/3157510/ "View changeset 3157510"), checked in by metagauss, [4 months ago](/timeline?from=2024-09-25T11%3A53%3A40Z&precision=second "See timeline at 09/25/2024 11:53:40 AM") |
| --- |
| Release 5.9.3.3 |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 35.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* The file that defines the core plugin class |
| [5](#L5) | \* |
| [6](#L6) | \* A class definition that includes attributes and functions used across both the |
| [7](#L7) | \* public-facing side of the site and the admin area. |
| [8](#L8) | \* |
| [9](#L9) | \* @link       https://profilegrid.co |
| [10](#L10) | \* @since      1.0.0 |
| [11](#L11) | \* |
| [12](#L12) | \* @package    Profile\_Magic |
| [13](#L13) | \* @subpackage Profile\_Magic/includes |
| [14](#L14) | \*/ |
| [15](#L15) |  |
| [16](#L16) | /\*\* |
| [17](#L17) | \* The core plugin class. |
| [18](#L18) | \* |
| [19](#L19) | \* This is used to define internationalization, admin-specific hooks, and |
| [20](#L20) | \* public-facing site hooks. |
| [21](#L21) | \* |
| [22](#L22) | \* Also maintains the unique identifier of this plugin as well as the current |
| [23](#L23) | \* version of the plugin. |
| [24](#L24) | \* |
| [25](#L25) | \* @since      1.0.0 |
| [26](#L26) | \* @package    Profile\_Magic |
| [27](#L27) | \* @subpackage Profile\_Magic/includes |
| [28](#L28) | \* @author     ProfileGrid <support@profilegrid.co> |
| [29](#L29) | \*/ |
| [30](#L30) | class Profile\_Magic { |
| [31](#L31) |  |
| [32](#L32) | /\*\* |
| [33](#L33) | \* The loader that's responsible for maintaining and registering all hooks that power |
| [34](#L34) | \* the plugin. |
| [35](#L35) | \* |
| [36](#L36) | \* @since    1.0.0 |
| [37](#L37) | \* @access   protected |
| [38](#L38) | \* @var      Profile\_Magic\_Loader    $loader    Maintains and registers all hooks for the plugin. |
| [39](#L39) | \*/ |
| [40](#L40) | protected $loader; |
| [41](#L41) |  |
| [42](#L42) | /\*\* |
| [43](#L43) | \* The unique identifier of this plugin. |
| [44](#L44) | \* |
| [45](#L45) | \* @since    1.0.0 |
| [46](#L46) | \* @access   protected |
| [47](#L47) | \* @var      string    $profile\_magic    The string used to uniquely identify this plugin. |
| [48](#L48) | \*/ |
| [49](#L49) | protected $profile\_magic; |
| [50](#L50) |  |
| [51](#L51) | /\*\* |
| [52](#L52) | \* The current version of the plugin. |
| [53](#L53) | \* |
| [54](#L54) | \* @since    1.0.0 |
| [55](#L55) | \* @access   protected |
| [56](#L56) | \* @var      string    $version    The current version of the plugin. |
| [57](#L57) | \*/ |
| [58](#L58) | protected $version; |
| [59](#L59) |  |
| [60](#L60) | /\*\* |
| [61](#L61) | \* Define the core functionality of the plugin. |
| [62](#L62) | \* |
| [63](#L63) | \* Set the plugin name and the plugin version that can be used throughout the plugin. |
| [64](#L64) | \* Load the dependencies, define the locale, and set the hooks for the admin area and |
| [65](#L65) | \* the public-facing side of the site. |
| [66](#L66) | \* |
| [67](#L67) | \* @since    1.0.0 |
| [68](#L68) | \*/ |
| [69](#L69) | public function \_\_construct() { |
| [70](#L70) |  |
| [71](#L71) | $this->profile\_magic = 'profilegrid-user-profiles-groups-and-communities'; |
| [72](#L72) | $this->version       = PROGRID\_PLUGIN\_VERSION; |
| [73](#L73) | $this->load\_dependencies(); |
| [74](#L74) | $this->set\_locale(); |
| [75](#L75) | $this->define\_global\_hooks(); |
| [76](#L76) | $this->define\_admin\_hooks(); |
| [77](#L77) | $this->define\_public\_hooks(); |
| [78](#L78) | $this->define\_access\_hooks(); |
| [79](#L79) | $this->define\_notification\_hooks(); |
| [80](#L80) | $this->define\_smtp\_connection(); |
| [81](#L81) | $this->define\_gutenberg\_block\_hooks(); |
| [82](#L82) | ob\_start(); |
| [83](#L83) |  |
| [84](#L84) | } |
| [85](#L85) |  |
| [86](#L86) | /\*\* |
| [87](#L87) | \* Load the required dependencies for this plugin. |
| [88](#L88) | \* |
| [89](#L89) | \* Include the following files that make up the plugin: |
| [90](#L90) | \* |
| [91](#L91) | \* - Profile\_Magic\_Loader. Orchestrates the hooks of the plugin. |
| [92](#L92) | \* - Profile\_Magic\_i18n. Defines internationalization functionality. |
| [93](#L93) | \* - Profile\_Magic\_Admin. Defines all hooks for the admin area. |
| [94](#L94) | \* - Profile\_Magic\_Public. Defines all hooks for the public side of the site. |
| [95](#L95) | \* |
| [96](#L96) | \* Create an instance of the loader which will be used to register the hooks |
| [97](#L97) | \* with WordPress. |
| [98](#L98) | \* |
| [99](#L99) | \* @since    1.0.0 |
| [100](#L100) | \* @access   private |
| [101](#L101) | \*/ |
| [102](#L102) | private function load\_dependencies() { |
| [103](#L103) |  |
| [104](#L104) | /\*\* |
| [105](#L105) | \* The class responsible for orchestrating the actions and filters of the |
| [106](#L106) | \* core plugin. |
| [107](#L107) | \*/ |
| [108](#L108) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-activator.php'; |
| [109](#L109) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-deactivator.php'; |
| [110](#L110) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-loader.php'; |
| [111](#L111) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-extensions.php'; |
| [112](#L112) | /\*\* |
| [113](#L113) | \* The class responsible for defining internationalization functionality |
| [114](#L114) | \* of the plugin. |
| [115](#L115) | \*/ |
| [116](#L116) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-i18n.php'; |
| [117](#L117) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-functions.php'; |
| [118](#L118) |  |
| [119](#L119) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-dbhandler.php'; |
| [120](#L120) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-request.php'; |
| [121](#L121) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-sanitized.php'; |
| [122](#L122) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-custom-fields.php'; |
| [123](#L123) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-smtp.php'; |
| [124](#L124) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-html-generator.php'; |
| [125](#L125) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-email.php'; |
| [126](#L126) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'admin/class-profile-magic-access-options.php'; |
| [127](#L127) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-paypal-integration.php'; |
| [128](#L128) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-paypal-functions.php'; |
| [129](#L129) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-export-import.php'; |
| [130](#L130) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-messenger.php'; |
| [131](#L131) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-chat-system.php'; |
| [132](#L132) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-friends-helper.php'; |
| [133](#L133) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-friends-integration.php'; |
| [134](#L134) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'includes/class-profile-magic-license.php'; |
| [135](#L135) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'public/class-profile-magic-notifications.php'; |
| [136](#L136) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'widgets/profilegrid-groups-widgets.php'; |
| [137](#L137) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'widgets/profilegrid-user-blogs-widgets.php'; |
| [138](#L138) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'widgets/profilegrid-user-login-widgets.php'; |
| [139](#L139) | /\*\* |
| [140](#L140) | \* The class responsible for defining all actions that occur in the admin area. |
| [141](#L141) | \*/ |
| [142](#L142) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'admin/class-profile-magic-admin.php'; |
| [143](#L143) |  |
| [144](#L144) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'blocks/class-profile-magic-block.php'; |
| [145](#L145) |  |
| [146](#L146) | /\*\* |
| [147](#L147) | \* The class responsible for defining all actions that occur in the public-facing |
| [148](#L148) | \* side of the site. |
| [149](#L149) | \*/ |
| [150](#L150) | require\_once plugin\_dir\_path( dirname( \_\_FILE\_\_ ) ) . 'public/class-profile-magic-public.php'; |
| [151](#L151) |  |
| [152](#L152) | $this->loader = new Profile\_Magic\_Loader(); |
| [153](#L153) |  |
| [154](#L154) | } |
| [155](#L155) |  |
| [156](#L156) | /\*\* |
| [157](#L157) | \* Define the locale for this plugin for internationalization. |
| [158](#L158) | \* |
| [159](#L159) | \* Uses the Profile\_Magic\_i18n class in order to set the domain and to register the hook |
| [160](#L160) | \* with WordPress. |
| [161](#L161) | \* |
| [162](#L162) | \* @since    1.0.0 |
| [163](#L163) | \* @access   private |
| [164](#L164) | \*/ |
| [165](#L165) | private function set\_locale() { |
| [166](#L166) |  |
| [167](#L167) | $plugin\_i18n = new Profile\_Magic\_i18n(); |
| [168](#L168) |  |
| [169](#L169) | $this->loader->add\_action( 'plugins\_loaded', $plugin\_i18n, 'load\_plugin\_textdomain' ); |
| [170](#L170) |  |
| [171](#L171) | } |
| [172](#L172) |  |
| [173](#L173) | private function define\_global\_hooks() { |
| [174](#L174) |  |
| [175](#L175) | $this->loader->add\_filter( 'plugins\_loaded', $this, 'pg\_on\_plugins\_loaded' ); |
| [176](#L176) | } |
| [177](#L177) | /\*\* |
| [178](#L178) | \* Register all of the hooks related to the admin area functionality |
| [179](#L179) | \* of the plugin. |
| [180](#L180) | \* |
| [181](#L181) | \* @since    1.0.0 |
| [182](#L182) | \* @access   private |
| [183](#L183) | \*/ |
| [184](#L184) | private function define\_smtp\_connection() { |
| [185](#L185) | $dbhandler = new PM\_DBhandler(); |
| [186](#L186) | $plugin\_smtp        = new Profile\_Magic\_SMTP( $this->get\_profile\_magic(), $this->get\_version() ); |
| [187](#L187) | if ( $dbhandler->get\_global\_option\_value( 'pm\_enable\_smtp', 0 ) == 1 ) { |
| [188](#L188) | $this->loader->add\_action( 'phpmailer\_init', $plugin\_smtp, 'pm\_smtp\_connection' ); |
| [189](#L189) | } |
| [190](#L190) |  |
| [191](#L191) | } |
| [192](#L192) |  |
| [193](#L193) | private function define\_gutenberg\_block\_hooks() { |
| [194](#L194) | $plugin\_block = new Profile\_Magic\_Block( $this->get\_profile\_magic(), $this->get\_version() ); |
| [195](#L195) | $this->loader->add\_action( 'init', $plugin\_block, 'profilegrid\_block\_register' ); |
| [196](#L196) | $this->loader->add\_action( 'rest\_api\_init', $plugin\_block, 'pm\_register\_rest\_route' ); |
| [197](#L197) | $this->loader->add\_action('block\_categories\_all',  $plugin\_block, 'profilegrid\_add\_block\_categories'); |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) | private function define\_admin\_hooks() { |
| [201](#L201) |  |
| [202](#L202) | $plugin\_admin = new Profile\_Magic\_Admin( $this->get\_profile\_magic(), $this->get\_version() ); |
| [203](#L203) | $this->loader->add\_action( 'admin\_init', $plugin\_admin, 'pg\_activation\_redirect' ); |
| [204](#L204) |  |
| [205](#L205) | $this->loader->add\_action( 'admin\_enqueue\_scripts', $plugin\_admin, 'enqueue\_styles' ); |
| [206](#L206) | $this->loader->add\_action( 'admin\_enqueue\_scripts', $plugin\_admin, 'enqueue\_scripts' ); |
| [207](#L207) | $this->loader->add\_action( 'admin\_menu', $plugin\_admin, 'profile\_magic\_admin\_menu' ); |
| [208](#L208) | $this->loader->add\_action( 'admin\_menu', $plugin\_admin, 'profile\_magic\_admin\_menu\_for\_extensions', 500000 ); |
| [209](#L209) | $this->loader->add\_action( 'wp\_ajax\_pm\_set\_field\_order', $plugin\_admin, 'profile\_magic\_set\_field\_order' ); |
| [210](#L210) | $this->loader->add\_action( 'wp\_ajax\_pm\_set\_group\_order', $plugin\_admin, 'profile\_magic\_set\_group\_order' ); |
| [211](#L211) | $this->loader->add\_action( 'wp\_ajax\_pm\_set\_group\_items', $plugin\_admin, 'profile\_magic\_set\_group\_items' ); |
| [212](#L212) | $this->loader->add\_action( 'wp\_ajax\_pm\_set\_section\_order', $plugin\_admin, 'profile\_magic\_set\_section\_order' ); |
| [213](#L213) | $this->loader->add\_action( 'wp\_ajax\_pm\_test\_smtp', $plugin\_admin, 'profile\_magic\_check\_smtp\_connection' ); |
| [214](#L214) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_rm\_helptext', $plugin\_admin, 'pm\_get\_rm\_helptext' ); |
| [215](#L215) | $this->loader->add\_action( 'wp\_ajax\_pm\_section\_dropdown', $plugin\_admin, 'profile\_magic\_section\_dropdown' ); |
| [216](#L216) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_activate\_user\_by\_email', $plugin\_admin, 'profile\_magic\_activate\_user\_by\_email' ); |
| [217](#L217) | $this->loader->add\_action( 'wp\_ajax\_pm\_activate\_user\_by\_email', $plugin\_admin, 'profile\_magic\_activate\_user\_by\_email' ); |
| [218](#L218) |  |
| [219](#L219) | $this->loader->add\_action( 'show\_user\_profile', $plugin\_admin, 'profile\_magic\_show\_user\_fields' ); |
| [220](#L220) | $this->loader->add\_action( 'edit\_user\_profile', $plugin\_admin, 'profile\_magic\_show\_user\_fields' ); |
| [221](#L221) | $this->loader->add\_action( 'personal\_options\_update', $plugin\_admin, 'profile\_magic\_update\_user\_fields' ); |
| [222](#L222) | $this->loader->add\_action( 'edit\_user\_profile\_update', $plugin\_admin, 'profile\_magic\_update\_user\_fields' ); |
| [223](#L223) |  |
| [224](#L224) | $this->loader->add\_action( 'user\_new\_form', $plugin\_admin, 'profile\_magic\_show\_user\_fields' ); |
| [225](#L225) | $this->loader->add\_action( 'user\_register', $plugin\_admin, 'profile\_magic\_update\_user\_fields' ); |
| [226](#L226) | $this->loader->add\_action( 'wpmu\_new\_user', $plugin\_admin, 'profile\_magic\_update\_user\_fields' ); |
| [227](#L227) | $this->loader->add\_action( 'wpmu\_new\_blog', $plugin\_admin, 'activate\_sitewide\_plugins' ); |
| [228](#L228) | // paypal integration for dashboard options |
| [229](#L229) | $this->loader->add\_action( 'profile\_magic\_setting\_option', $plugin\_admin, 'pm\_profile\_magic\_add\_option\_setting\_page' ); |
| [230](#L230) | $this->loader->add\_action( 'profile\_magic\_group\_membership\_option', $plugin\_admin, 'pm\_profile\_magic\_add\_group\_option', 10, 2 ); |
| [231](#L231) | $this->loader->add\_action( 'profile\_magic\_premium\_group\_option', $plugin\_admin, 'pm\_profile\_magic\_premium\_group\_option', 10, 2 ); |
| [232](#L232) |  |
| [233](#L233) | $this->loader->add\_action( 'wp\_ajax\_pm\_load\_export\_fields\_dropdown', $plugin\_admin, 'pm\_load\_export\_fields\_dropdown' ); |
| [234](#L234) | $this->loader->add\_action( 'wp\_ajax\_pm\_upload\_csv', $plugin\_admin, 'pm\_upload\_csv' ); |
| [235](#L235) | $this->loader->add\_filter( 'upload\_mimes', $plugin\_admin, 'profile\_grid\_myme\_types' ); |
| [236](#L236) | $this->loader->add\_action( 'wp\_ajax\_pg\_post\_feedback', $plugin\_admin, 'pg\_post\_feedback' ); |
| [237](#L237) | $this->loader->add\_action( 'profilegrid\_shortcode\_desc', $plugin\_admin, 'pg\_geolocation\_short\_code' ); |
| [238](#L238) | $this->loader->add\_action( 'profilegrid\_shortcode\_desc', $plugin\_admin, 'pg\_frontend\_group\_short\_code' ); |
| [239](#L239) | $this->loader->add\_action( 'profilegrid\_shortcode\_desc', $plugin\_admin, 'pg\_groupwall\_short\_code' ); |
| [240](#L240) | $this->loader->add\_action( 'wp\_ajax\_pm\_upload\_json', $plugin\_admin, 'pm\_upload\_json' ); |
| [241](#L241) | $this->loader->add\_action( 'wp\_ajax\_pm\_dismissible\_notice', $plugin\_admin, 'pm\_dismissible\_notice\_ajax' ); |
| [242](#L242) | $this->loader->add\_action( 'admin\_notices', $plugin\_admin, 'pm\_dismissible\_woocommerce\_notice' ); |
| [243](#L243) | $this->loader->add\_action( 'wp\_ajax\_pm\_check\_associate\_tmpl', $plugin\_admin, 'pm\_check\_associate\_email\_tmpl' ); |
| [244](#L244) | $this->loader->add\_action( 'admin\_notices', $plugin\_admin, 'pm\_dismissible\_custom\_profile\_tab\_notice' ); |
| [245](#L245) | $this->loader->add\_action( 'widgets\_init', $plugin\_admin, 'pm\_groups\_widget' ); |
| [246](#L246) | $this->loader->add\_action( 'init', $plugin\_admin, 'pm\_group\_option\_update' ); |
| [247](#L247) | $this->loader->add\_action( 'pg\_groupleader\_assign\_remove', $plugin\_admin, 'pg\_groupleader\_assign\_remove\_fun', 10, 5 ); |
| [248](#L248) | $this->loader->add\_action( 'admin\_notices', $plugin\_admin, 'pm\_dismissible\_bbpress\_notice' ); |
| [249](#L249) | $this->loader->add\_action( 'rm\_form\_type\_changed', $plugin\_admin, 'rm\_form\_type\_changed\_fun', 10, 3 ); |
| [250](#L250) | $this->loader->add\_action( 'rm\_form\_deleted', $plugin\_admin, 'rm\_form\_deleted\_fun', 10, 1 ); |
| [251](#L251) | $this->loader->add\_action( 'admin\_notices', $plugin\_admin, 'pm\_dismissible\_rm\_form\_type\_changed' ); |
| [252](#L252) | $this->loader->add\_action( 'rm\_user\_deactivated', $plugin\_admin, 'rm\_user\_deactivated', 10, 1 ); |
| [253](#L253) | $this->loader->add\_action( 'widgets\_init', $plugin\_admin, 'profilegrid\_user\_blogs\_widgets' ); |
| [254](#L254) | $this->loader->add\_action( 'widgets\_init', $plugin\_admin, 'profilegrid\_user\_login\_widgets' ); |
| [255](#L255) | $this->loader->add\_action( 'admin\_init', $plugin\_admin, 'individual\_user\_group\_add\_meta\_box' ); |
| [256](#L256) | $this->loader->add\_action( 'wp\_ajax\_pg\_create\_group\_page', $plugin\_admin, 'pg\_create\_group\_page' ); |
| [257](#L257) | $this->loader->add\_action( 'user\_edit\_form\_tag', $plugin\_admin, 'pg\_action\_user\_edit\_form\_tag', 10, 0 ); |
| [258](#L258) | $this->loader->add\_action( 'wp\_ajax\_pm\_remove\_attachment\_dashboard', $plugin\_admin, 'pm\_remove\_file\_attachment' ); |
| [259](#L259) |  |
| [260](#L260) | $this->loader->add\_action( 'profile\_magic\_available\_extensions', $plugin\_admin, 'profile\_magic\_premium\_setting\_option', 1000 ); |
| [261](#L261) | $this->loader->add\_filter( 'register\_post\_type\_args', $plugin\_admin, 'pm\_change\_users\_blog\_post\_types\_slug', 10, 2 ); |
| [262](#L262) | $this->loader->add\_action( 'admin\_init', $plugin\_admin, 'pm\_custom\_permalink\_option' ); |
| [263](#L263) | $this->loader->add\_action( 'admin\_init', $plugin\_admin, 'pm\_save\_custom\_permalink\_option' ); |
| [264](#L264) | $this->loader->add\_action( 'wp\_ajax\_pg\_fetch\_offers', $plugin\_admin, 'pg\_fetch\_offers' ); |
| [265](#L265) |  |
| [266](#L266) | $this->loader->add\_action( 'wp\_ajax\_pm\_wizard\_update\_group\_icon', $plugin\_admin, 'pm\_wizard\_update\_group\_icon' ); |
| [267](#L267) | $this->loader->add\_action( 'wp\_ajax\_pm\_submit\_group\_wizard\_form', $plugin\_admin, 'pm\_submit\_group\_wizard\_form' ); |
| [268](#L268) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_groups\_details', $plugin\_admin, 'pm\_get\_groups\_details' ); |
| [269](#L269) | $this->loader->add\_action('pg\_customization\_extension\_html', $plugin\_admin, 'pg\_customization\_extension\_html'); |
| [270](#L270) | $this->loader->add\_action( 'wp\_ajax\_pg\_activate\_license', $plugin\_admin, 'profilegrid\_activate\_license' ); |
| [271](#L271) | $this->loader->add\_action( 'wp\_ajax\_pg\_deactivate\_license', $plugin\_admin, 'profilegrid\_deactivate\_license' ); |
| [272](#L272) |  |
| [273](#L273) | } |
| [274](#L274) |  |
| [275](#L275) | private function define\_access\_hooks() { |
| [276](#L276) | $plugin\_access = new Profile\_Magic\_access\_options( $this->get\_profile\_magic(), $this->get\_version() ); |
| [277](#L277) | $this->loader->add\_action( 'add\_meta\_boxes', $plugin\_access, 'profile\_magic\_access\_meta\_box' ); |
| [278](#L278) | $this->loader->add\_action( 'save\_post', $plugin\_access, 'profile\_magic\_save\_access\_meta' ); |
| [279](#L279) | $this->loader->add\_filter( 'the\_content', $plugin\_access, 'profile\_magic\_check\_content\_access' ); |
| [280](#L280) | $this->loader->add\_filter( 'the\_excerpt', $plugin\_access, 'profile\_magic\_get\_the\_excerpt\_filter\_admin\_note' ); |
| [281](#L281) | } |
| [282](#L282) |  |
| [283](#L283) | private function define\_notification\_hooks() { |
| [284](#L284) | $dbhandler           = new PM\_DBhandler(); |
| [285](#L285) | $plugin\_notification = new Profile\_Magic\_Notification( $this->get\_profile\_magic(), $this->get\_version() ); |
| [286](#L286) | $this->loader->add\_action( 'comment\_post', $plugin\_notification, 'pm\_add\_comment\_notification', 10, 2 ); |
| [287](#L287) | if ( $dbhandler->get\_global\_option\_value( 'pm\_enable\_live\_notification', '1' ) == '1' ) { |
| [288](#L288) | $this->loader->add\_filter( 'heartbeat\_received', $plugin\_notification, 'pm\_notification\_heartbeat\_received', 10, 2 ); // for login user response |
| [289](#L289) | } |
| [290](#L290) | $this->loader->add\_action( 'added\_post\_meta', $plugin\_notification, 'pm\_blog\_post\_published', 10, 4 ); |
| [291](#L291) | $this->loader->add\_action( 'transition\_post\_status', $plugin\_notification, 'pg\_blog\_post\_change\_status', 10, 3 ); |
| [292](#L292) |  |
| [293](#L293) | $this->loader->add\_action( 'added\_post\_meta', $plugin\_notification, 'pg\_wallpost\_published\_notification', 10, 2 ); |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | /\*\* |
| [297](#L297) | \* Register all of the hooks related to the public-facing functionality |
| [298](#L298) | \* of the plugin. |
| [299](#L299) | \* |
| [300](#L300) | \* @since    1.0.0 |
| [301](#L301) | \* @access   private |
| [302](#L302) | \*/ |
| [303](#L303) | private function define\_public\_hooks() { |
| [304](#L304) | $plugin\_public = new Profile\_Magic\_Public( $this->get\_profile\_magic(), $this->get\_version() ); |
| [305](#L305) | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'enqueue\_styles' ); |
| [306](#L306) | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'enqueue\_scripts' ); |
| [307](#L307) | $this->loader->add\_action( 'init', $plugin\_public, 'register\_shortcodes' ); |
| [308](#L308) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_captcha\_verification', $plugin\_public, 'profile\_magic\_captcha\_verification' ); |
| [309](#L309) | $this->loader->add\_action( 'wp\_login', $plugin\_public, 'profile\_magic\_check\_login\_status', 10, 2 ); |
| [310](#L310) | $this->loader->add\_action( 'wp\_logout', $plugin\_public, 'profile\_magic\_update\_logout\_status', 999999999999999 ); |
| [311](#L311) | $this->loader->add\_action( 'login\_form\_lostpassword', $plugin\_public, 'profile\_magic\_do\_password\_lost' ); |
| [312](#L312) | $this->loader->add\_action( 'login\_form\_lostpassword', $plugin\_public, 'profile\_magic\_lost\_password\_form' ); |
| [313](#L313) | $this->loader->add\_action( 'password\_reset', $plugin\_public, 'profile\_magic\_send\_email\_after\_password\_reset', 10, 2 ); |
| [314](#L314) | $this->loader->add\_action( 'login\_form\_rp', $plugin\_public, 'profile\_magic\_do\_password\_reset' ); |
| [315](#L315) | $this->loader->add\_action( 'login\_form\_resetpass', $plugin\_public, 'profile\_magic\_do\_password\_reset' ); |
| [316](#L316) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_check\_user\_exist', $plugin\_public, 'profile\_magic\_check\_user\_exist' ); |
| [317](#L317) | $this->loader->add\_action( 'wp\_ajax\_pm\_check\_user\_exist', $plugin\_public, 'profile\_magic\_check\_user\_exist' ); |
| [318](#L318) |  |
| [319](#L319) | $this->loader->add\_action( 'login\_form\_rp', $plugin\_public, 'profile\_magic\_redirect\_to\_password\_reset' ); |
| [320](#L320) | $this->loader->add\_action( 'login\_form\_resetpass', $plugin\_public, 'profile\_magic\_redirect\_to\_password\_reset' ); |
| [321](#L321) | $this->loader->add\_filter( 'login\_message', $plugin\_public, 'profile\_magic\_login\_notice' ); |
| [322](#L322) | $this->loader->add\_filter( 'register\_url', $plugin\_public, 'profile\_magic\_default\_registration\_url' ); |
| [323](#L323) | $this->loader->add\_filter( 'login\_redirect', $plugin\_public, 'profile\_magic\_redirect\_after\_login', 10, 3 ); |
| [324](#L324) | $this->loader->add\_filter( 'get\_avatar', $plugin\_public, 'profile\_magic\_get\_avatar', 100000000, 6 ); |
| [325](#L325) | $this->loader->add\_filter( 'bp\_core\_fetch\_avatar', $plugin\_public, 'profile\_magic\_bp\_core\_fetch\_avatar', 99999, 2 ); |
| [326](#L326) | $this->loader->add\_filter( 'bp\_core\_fetch\_avatar\_url', $plugin\_public, 'profile\_magic\_bp\_core\_fetch\_avatar\_url', 9999, 2 ); |
| [327](#L327) |  |
| [328](#L328) | $this->loader->add\_filter( 'retrieve\_password\_message', $plugin\_public, 'profile\_magice\_retrieve\_password\_message', 10, 4 ); |
| [329](#L329) | $this->loader->add\_action( 'wp\_ajax\_pm\_update\_profile\_image', $plugin\_public, 'pm\_update\_user\_profile\_image' ); |
| [330](#L330) | $this->loader->add\_action( 'wp\_ajax\_pm\_change\_frontend\_user\_pass', $plugin\_public, 'pm\_change\_frontend\_user\_pass' ); |
| [331](#L331) | $this->loader->add\_action( 'profile\_magic\_registration\_process', $plugin\_public, 'pm\_submit\_user\_registration', 1, 7 ); |
| [332](#L332) | $this->loader->add\_action( 'profile\_magic\_show\_captcha', $plugin\_public, 'profile\_magic\_recapcha\_field', 1, 1 ); |
| [333](#L333) | $this->loader->add\_action( 'profile\_magic\_registration\_process', $plugin\_public, 'pm\_submit\_user\_registration\_paypal', 10, 7 ); |
| [334](#L334) | $this->loader->add\_action( 'profile\_magic\_before\_registration\_form', $plugin\_public, 'pm\_payment\_process', 10, 4 ); |
| [335](#L335) | $this->loader->add\_action( 'wp\_ajax\_pm\_upload\_image', $plugin\_public, 'pm\_upload\_image' ); |
| [336](#L336) | $this->loader->add\_action( 'wp\_ajax\_pm\_upload\_cover\_image', $plugin\_public, 'pm\_upload\_cover\_image' ); |
| [337](#L337) | $this->loader->add\_action( 'wp\_ajax\_pm\_send\_change\_pass\_email', $plugin\_public, 'pm\_send\_change\_pass\_email' ); |
| [338](#L338) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_send\_change\_pass\_email', $plugin\_public, 'pm\_send\_change\_pass\_email' ); |
| [339](#L339) | $this->loader->add\_action( 'wp\_ajax\_pm\_advance\_user\_search', $plugin\_public, 'pm\_advance\_user\_search' ); |
| [340](#L340) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_advance\_user\_search', $plugin\_public, 'pm\_advance\_user\_search' ); |
| [341](#L341) | $this->loader->add\_action( 'wp\_ajax\_pm\_advance\_search\_get\_search\_fields\_by\_gid', $plugin\_public, 'pm\_advance\_search\_get\_search\_fields\_by\_gid' ); |
| [342](#L342) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_advance\_search\_get\_search\_fields\_by\_gid', $plugin\_public, 'pm\_advance\_search\_get\_search\_fields\_by\_gid' ); |
| [343](#L343) |  |
| [344](#L344) | $this->loader->add\_action( 'wp\_ajax\_pm\_messenger\_send\_new\_message', $plugin\_public, 'pm\_messenger\_send\_new\_message' ); |
| [345](#L345) | $this->loader->add\_action( 'wp\_ajax\_pm\_messenger\_show\_threads', $plugin\_public, 'pm\_messenger\_show\_threads' ); |
| [346](#L346) | $this->loader->add\_action( 'wp\_ajax\_pm\_messenger\_show\_messages', $plugin\_public, 'pm\_messenger\_show\_messages' ); |
| [347](#L347) | $this->loader->add\_action( 'wp\_ajax\_pm\_messenger\_show\_thread\_user', $plugin\_public, 'pm\_messenger\_show\_thread\_user' ); |
| [348](#L348) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_messenger\_notification', $plugin\_public, 'pm\_get\_messenger\_notification' ); |
| [349](#L349) | $this->loader->add\_action( 'wp\_ajax\_pm\_autocomplete\_user\_search', $plugin\_public, 'pm\_autocomplete\_user\_search' ); |
| [350](#L350) | $this->loader->add\_action( 'wp\_ajax\_pm\_messenger\_delete\_threads', $plugin\_public, 'pm\_messenger\_delete\_threads' ); |
| [351](#L351) | $this->loader->add\_action( 'wp\_ajax\_pm\_messenger\_notification\_extra\_data', $plugin\_public, 'pm\_messenger\_notification\_extra\_data' ); |
| [352](#L352) | $this->loader->add\_action( 'init', $plugin\_public, 'pg\_create\_post\_type' ); |
| [353](#L353) | $this->loader->add\_action( 'wp\_ajax\_pm\_load\_pg\_blogs', $plugin\_public, 'pm\_load\_pg\_blogs' ); |
| [354](#L354) | $this->loader->add\_action( 'wp\_ajax\_pm\_load\_user\_blogs\_shortcode\_posts', $plugin\_public, 'pm\_load\_user\_blogs\_shortcode\_posts' ); |
| [355](#L355) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_load\_user\_blogs\_shortcode\_posts', $plugin\_public, 'pm\_load\_user\_blogs\_shortcode\_posts' ); |
| [356](#L356) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_load\_pg\_blogs', $plugin\_public, 'pm\_load\_pg\_blogs' ); |
| [357](#L357) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_rid\_by\_uname', $plugin\_public, 'pm\_get\_rid\_by\_uname' ); |
| [358](#L358) | $this->loader->add\_action( 'wp\_ajax\_pm\_activate\_new\_thread', $plugin\_public, 'pm\_activate\_new\_thread' ); |
| [359](#L359) | $this->loader->add\_action( 'wp\_ajax\_pm\_activate\_last\_thread', $plugin\_public, 'pm\_activate\_last\_thread' ); |
| [360](#L360) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_active\_thread\_header', $plugin\_public, 'pm\_get\_active\_thread\_header' ); |
| [361](#L361) | $this->loader->add\_action( 'wp\_ajax\_pm\_messages\_mark\_as\_read', $plugin\_public, 'pm\_messages\_mark\_as\_read' ); |
| [362](#L362) | $this->loader->add\_action( 'wp\_ajax\_pm\_messages\_mark\_as\_unread', $plugin\_public, 'pm\_messages\_mark\_as\_unread' ); |
| [363](#L363) | $this->loader->add\_action( 'wp\_ajax\_pg\_show\_all\_threads', $plugin\_public, 'pg\_show\_all\_threads' ); |
| [364](#L364) | $this->loader->add\_action( 'wp\_ajax\_pg\_search\_threads', $plugin\_public, 'pg\_search\_threads' ); |
| [365](#L365) | $this->loader->add\_action( 'wp\_ajax\_pg\_show\_msg\_panel', $plugin\_public, 'pg\_show\_msg\_panel' ); |
| [366](#L366) | $this->loader->add\_action( 'wp\_ajax\_pg\_delete\_msg', $plugin\_public, 'pg\_delete\_msg' ); |
| [367](#L367) | $this->loader->add\_action( 'wp\_ajax\_pm\_messenger\_delete\_threads\_popup', $plugin\_public, 'pg\_msg\_delete\_thread\_popup\_html' ); |
| [368](#L368) |  |
| [369](#L369) | $this->loader->add\_action( 'profile\_magic\_profile\_tab', $plugin\_public, 'pm\_right\_side\_options', 10, 2 ); |
| [370](#L370) |  |
| [371](#L371) | $this->loader->add\_action( 'wp\_ajax\_pm\_fetch\_my\_friends', $plugin\_public, 'pm\_fetch\_my\_friends' ); |
| [372](#L372) | $this->loader->add\_action( 'wp\_ajax\_pm\_fetch\_my\_suggestion', $plugin\_public, 'pm\_fetch\_my\_suggestion' ); |
| [373](#L373) | $this->loader->add\_action( 'wp\_ajax\_pm\_add\_friend\_request', $plugin\_public, 'pm\_add\_friend\_request' ); |
| [374](#L374) | $this->loader->add\_action( 'wp\_ajax\_pm\_confirm\_friend\_request', $plugin\_public, 'pm\_confirm\_friend\_request' ); |
| [375](#L375) | $this->loader->add\_action( 'wp\_ajax\_pm\_unfriend\_friend', $plugin\_public, 'pm\_unfriend\_friend' ); |
| [376](#L376) | $this->loader->add\_action( 'wp\_ajax\_pm\_block\_friend', $plugin\_public, 'pm\_block\_friend' ); |
| [377](#L377) | $this->loader->add\_action( 'wp\_ajax\_pm\_reject\_friend\_request', $plugin\_public, 'pm\_reject\_friend\_request' ); |
| [378](#L378) | $this->loader->add\_action( 'wp\_ajax\_pm\_remove\_friend\_suggestion', $plugin\_public, 'pm\_remove\_friend\_suggestion' ); |
| [379](#L379) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_friends\_notification', $plugin\_public, 'pm\_get\_friends\_notification' ); |
| [380](#L380) | $this->loader->add\_action( 'wp\_ajax\_pm\_delete\_notification', $plugin\_public, 'pm\_delete\_notification' ); |
| [381](#L381) | $this->loader->add\_action( 'wp\_ajax\_pm\_load\_more\_notification', $plugin\_public, 'pm\_load\_more\_notification' ); |
| [382](#L382) | $this->loader->add\_action( 'wp\_ajax\_pm\_read\_all\_notification', $plugin\_public, 'pm\_read\_all\_notification' ); |
| [383](#L383) | $this->loader->add\_action( 'wp\_ajax\_pm\_fetch\_friend\_list\_counter', $plugin\_public, 'pm\_fetch\_friend\_list\_counter' ); |
| [384](#L384) | $this->loader->add\_action( 'wp\_ajax\_pm\_refresh\_notification', $plugin\_public, 'pm\_refresh\_notification' ); |
| [385](#L385) | $this->loader->add\_action( 'profile\_magic\_custom\_fields\_html', $plugin\_public, 'profile\_magic\_custom\_payment\_fields', 10, 1 ); |
| [386](#L386) | $this->loader->add\_filter( 'profile\_magic\_check\_payment\_config', $plugin\_public, 'profile\_magic\_check\_paypal\_config', 10, 1 ); |
| [387](#L387) | $this->loader->add\_filter( 'author\_link', $plugin\_public, 'profile\_magic\_author\_link', 999999999999, 2 ); |
| [388](#L388) | $this->loader->add\_action( 'init', $plugin\_public, 'profile\_magic\_allow\_backend\_screen\_for\_guest' ); |
| [389](#L389) | $this->loader->add\_action( 'wp\_ajax\_pm\_auto\_logout\_user', $plugin\_public, 'pm\_auto\_logout\_user' ); |
| [390](#L390) | $this->loader->add\_action( 'wp\_footer', $plugin\_public, 'profile\_magic\_auto\_logout\_prompt\_html' ); |
| [391](#L391) | $this->loader->add\_filter( 'pg\_whitelisted\_wpadmin\_access', $plugin\_public, 'pg\_whitelisted\_wpadmin\_access', 10, 1 ); |
| [392](#L392) | $this->loader->add\_action( 'pg\_blocked\_user\_ip', $plugin\_public, 'pm\_blocked\_ips', 10, 1 ); |
| [393](#L393) | $this->loader->add\_filter( 'authenticate', $plugin\_public, 'pm\_check\_ip\_during\_login', 10, 3 ); |
| [394](#L394) | $this->loader->add\_action( 'pg\_blocked\_user\_email', $plugin\_public, 'pg\_blocked\_emails' ); |
| [395](#L395) | $this->loader->add\_filter( 'pm\_frontend\_server\_validation', $plugin\_public, 'pm\_check\_blocked\_email\_during\_registration', 10, 2 ); |
| [396](#L396) | $this->loader->add\_filter( 'pm\_frontend\_server\_validation', $plugin\_public, 'pm\_check\_blocked\_word\_during\_registration', 10, 2 ); |
| [397](#L397) | $this->loader->add\_action( 'delete\_user', $plugin\_public, 'pm\_account\_deletion\_notification' ); |
| [398](#L398) | $this->loader->add\_action( 'wpmu\_delete\_user', $plugin\_public, 'pm\_account\_deletion\_notification' ); |
| [399](#L399) | $this->loader->add\_filter( 'wp\_title', $plugin\_public, 'pg\_user\_profile\_pagetitle', 1000000, 2 ); |
| [400](#L400) | $this->loader->add\_filter( 'pre\_get\_document\_title', $plugin\_public, 'pg\_user\_profile\_pagetitle', 1000000, 2 ); |
| [401](#L401) | $this->loader->add\_action( 'wp\_head', $plugin\_public, 'pg\_user\_profile\_metadesc', 99999999 ); |
| [402](#L402) | $this->loader->add\_filter( 'registration\_errors', $plugin\_public, 'pg\_blocked\_emails\_wp\_registration', 10, 3 ); |
| [403](#L403) |  |
| [404](#L404) | $this->loader->add\_filter( 'get\_comment\_author', $plugin\_public, 'pm\_get\_comment\_author', 9999999, 2 ); |
| [405](#L405) | $this->loader->add\_filter( 'comment\_author', $plugin\_public, 'pm\_comment\_author', 99999999, 2 ); |
| [406](#L406) | $this->loader->add\_action( 'publish\_profilegrid\_blogs', $plugin\_public, 'pg\_post\_published\_notification', 10, 2 ); |
| [407](#L407) | $this->loader->add\_action( 'init', $plugin\_public, 'pg\_set\_toolbar', 100 ); |
| [408](#L408) | $this->loader->add\_filter( 'get\_comment\_author\_link', $plugin\_public, 'pg\_comment\_link\_to\_profile', 999999999, 3 ); |
| [409](#L409) | $this->loader->add\_action( 'wp\_ajax\_pm\_remove\_attachment', $plugin\_public, 'pm\_remove\_file\_attachment' ); |
| [410](#L410) |  |
| [411](#L411) | $this->loader->add\_action( 'wp\_ajax\_pm\_edit\_group\_popup\_html', $plugin\_public, 'pm\_edit\_group\_popup\_html' ); |
| [412](#L412) | $this->loader->add\_action( 'wp\_ajax\_pm\_save\_post\_status', $plugin\_public, 'pm\_save\_post\_status' ); |
| [413](#L413) | $this->loader->add\_action( 'wp\_ajax\_pm\_save\_post\_content\_access\_level', $plugin\_public, 'pm\_save\_post\_content\_access\_level' ); |
| [414](#L414) | $this->loader->add\_action( 'wp\_ajax\_pm\_save\_edit\_blog\_post', $plugin\_public, 'pm\_save\_edit\_blog\_post' ); |
| [415](#L415) | $this->loader->add\_action( 'wp\_ajax\_pm\_save\_admin\_note\_content', $plugin\_public, 'pm\_save\_admin\_note\_content' ); |
| [416](#L416) | $this->loader->add\_action( 'wp\_ajax\_pm\_send\_message\_to\_author', $plugin\_public, 'pm\_send\_message\_to\_author' ); |
| [417](#L417) | $this->loader->add\_action( 'wp\_ajax\_pm\_delete\_admin\_note', $plugin\_public, 'pm\_delete\_admin\_note' ); |
| [418](#L418) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_all\_user\_blogs\_from\_group', $plugin\_public, 'pm\_get\_all\_user\_blogs\_from\_group' ); |
| [419](#L419) | $this->loader->add\_action( 'wp\_ajax\_pm\_invite\_user', $plugin\_public, 'pm\_invite\_user' ); |
| [420](#L420) | $this->loader->add\_action( 'wp\_ajax\_pm\_remove\_user\_from\_group', $plugin\_public, 'pm\_remove\_user\_from\_group' ); |
| [421](#L421) | $this->loader->add\_action( 'wp\_ajax\_pm\_activate\_user\_in\_group', $plugin\_public, 'pm\_activate\_user\_in\_group' ); |
| [422](#L422) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_all\_users\_from\_group', $plugin\_public, 'pm\_get\_all\_users\_from\_group' ); |
| [423](#L423) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_get\_all\_users\_from\_group', $plugin\_public, 'pm\_get\_all\_users\_from\_group' ); |
| [424](#L424) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_all\_groups', $plugin\_public, 'pm\_get\_all\_groups' ); |
| [425](#L425) | $this->loader->add\_action( 'wp\_ajax\_nopriv\_pm\_get\_all\_groups', $plugin\_public, 'pm\_get\_all\_groups' ); |
| [426](#L426) | $this->loader->add\_action( 'wp\_ajax\_pm\_deactivate\_user\_from\_group', $plugin\_public, 'pm\_deactivate\_user\_from\_group' ); |
| [427](#L427) | $this->loader->add\_action( 'wp\_ajax\_pm\_generate\_auto\_password', $plugin\_public, 'pm\_generate\_auto\_password' ); |
| [428](#L428) | $this->loader->add\_action( 'wp\_ajax\_pm\_reset\_user\_password', $plugin\_public, 'pm\_reset\_user\_password' ); |
| [429](#L429) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_pending\_post\_from\_group', $plugin\_public, 'pm\_get\_pending\_post\_from\_group' ); |
| [430](#L430) |  |
| [431](#L431) | $this->loader->add\_action( 'wp\_ajax\_pm\_remove\_user\_group', $plugin\_public, 'pm\_remove\_user\_group' ); |
| [432](#L432) | $this->loader->add\_action( 'profile\_magic\_join\_paid\_group\_process', $plugin\_public, 'pm\_join\_paid\_group\_payment', 10, 3 ); |
| [433](#L433) | $this->loader->add\_action( 'wp\_ajax\_pm\_decline\_join\_group\_request', $plugin\_public, 'pm\_decline\_join\_group\_request', 10, 2 ); |
| [434](#L434) | $this->loader->add\_action( 'wp\_ajax\_pm\_approve\_join\_group\_request', $plugin\_public, 'pm\_approve\_join\_group\_request', 10, 2 ); |
| [435](#L435) | $this->loader->add\_action( 'wp\_ajax\_pm\_get\_all\_requests\_from\_group', $plugin\_public, 'pm\_get\_all\_requests\_from\_group', 10, 4 ); |
| [436](#L436) | $this->loader->add\_action( 'init', $plugin\_public, 'user\_online\_status' ); |
| [437](#L437) | $this->loader->add\_action( 'clean\_user\_online\_status', $plugin\_public, 'clean\_user\_online\_status' ); |
| [438](#L438) | $this->loader->add\_action( 'clear\_auth\_cookie', $plugin\_public, 'profile\_magic\_set\_logged\_out\_status', 10, 1 ); |
| [439](#L439) |  |
| [440](#L440) | $this->loader->add\_action( 'rm\_submission\_completed', $plugin\_public, 'profile\_magic\_rm\_form\_submission', 10, 3 ); |
| [441](#L441) | $this->loader->add\_action( 'rm\_payment\_completed', $plugin\_public, 'profile\_magic\_rm\_form\_submission\_payment\_completed', 10, 3 ); |
| [442](#L442) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab', $plugin\_public, 'pg\_rm\_registration\_tab', 10, 2 ); |
| [443](#L443) | $this->loader->add\_action( 'rm\_payment\_completed', $plugin\_public, 'profile\_magic\_rm\_form\_submission\_payment\_completed', 10, 3 ); |
| [444](#L444) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab', $plugin\_public, 'pg\_rm\_registration\_tab', 10, 2 ); |
| [445](#L445) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab\_content', $plugin\_public, 'pg\_rm\_registration\_tab\_content', 10, 2 ); |
| [446](#L446) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab', $plugin\_public, 'pg\_rm\_payment\_tab', 10, 2 ); |
| [447](#L447) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab\_content', $plugin\_public, 'pg\_rm\_payment\_tab\_content', 10, 2 ); |
| [448](#L448) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab', $plugin\_public, 'pg\_rm\_inbox\_tab', 10, 2 ); |
| [449](#L449) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab\_content', $plugin\_public, 'pg\_rm\_inbox\_tab\_content', 10, 2 ); |
| [450](#L450) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab', $plugin\_public, 'pg\_rm\_orders\_tab', 10, 2 ); |
| [451](#L451) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab\_content', $plugin\_public, 'pg\_rm\_orders\_tab\_content', 10, 2 ); |
| [452](#L452) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab', $plugin\_public, 'pg\_rm\_downloads\_tab', 10, 2 ); |
| [453](#L453) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab\_content', $plugin\_public, 'pg\_rm\_downloads\_tab\_content', 10, 2 ); |
| [454](#L454) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab', $plugin\_public, 'pg\_rm\_addresses\_tab', 10, 2 ); |
| [455](#L455) | $this->loader->add\_action( 'profile\_magic\_profile\_settings\_tab\_content', $plugin\_public, 'pg\_rm\_addresses\_tab\_content', 10, 2 ); |
| [456](#L456) | $this->loader->add\_filter( 'lostpassword\_url', $plugin\_public, 'pg\_forget\_password\_page', 10000000000000000, 2 ); |
| [457](#L457) | $this->loader->add\_action( 'pm\_send\_message\_notification', $plugin\_public, 'pm\_send\_message\_notification', 10, 2 ); |
| [458](#L458) | $this->loader->add\_filter( 'profile\_magic\_get\_frontend\_url', $plugin\_public, 'pg\_get\_group\_page\_link', 10, 3 ); |
| [459](#L459) | $this->loader->add\_filter( 'rm\_profile\_image', $plugin\_public, 'pgrm\_profile\_image\_url', 10, 2 ); |
| [460](#L460) | $this->loader->add\_action( 'pg\_user\_leave\_group', $plugin\_public, 'pg\_send\_notification\_on\_leave\_group', 10, 2 ); |
| [461](#L461) | $this->loader->add\_action( 'profile\_magic\_profile\_tabs', $plugin\_public, 'profile\_magic\_profile\_tabs', 10, 3 ); |
| [462](#L462) | $this->loader->add\_action( 'profile\_magic\_profile\_tab\_content\_pg-about', $plugin\_public, 'pm\_profile\_about\_tab\_content', 10, 5 ); |
| [463](#L463) | $this->loader->add\_action( 'profile\_magic\_profile\_tab\_content\_pg-groups', $plugin\_public, 'pm\_profile\_groups\_tab\_content', 10, 5 ); |
| [464](#L464) | $this->loader->add\_action( 'profile\_magic\_profile\_tab\_content\_pg-blog', $plugin\_public, 'pm\_profile\_blog\_tab\_content', 10, 5 ); |
| [465](#L465) | $this->loader->add\_action( 'profile\_magic\_profile\_tab\_content\_pg-messages', $plugin\_public, 'pm\_profile\_messages\_tab\_content', 10, 5 ); |
| [466](#L466) | $this->loader->add\_action( 'profile\_magic\_profile\_tab\_content\_pg-notifications', $plugin\_public, 'pm\_profile\_notification\_tab\_content', 10, 5 ); |
| [467](#L467) | $this->loader->add\_action( 'profile\_magic\_profile\_tab\_content\_pg-friends', $plugin\_public, 'pm\_profile\_friends\_tab\_content', 10, 5 ); |
| [468](#L468) | $this->loader->add\_action( 'profile\_magic\_profile\_tab\_content\_pg-settings', $plugin\_public, 'pm\_profile\_settings\_tab\_content', 10, 5 ); |
| [469](#L469) | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'pg\_merge\_all\_scripts\_header', 99999999999 ); |
| [470](#L470) | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'pg\_merge\_all\_scripts\_footer', 99999999999999 ); |
| [471](#L471) | $this->loader->add\_action( 'wp\_enqueue\_scripts', $plugin\_public, 'pg\_merge\_all\_css\_footer', 9999999999999999 ); |
| [472](#L472) | $this->loader->add\_filter('pm\_get\_all\_groups\_data\_additional', $plugin\_public, 'pg\_filter\_hide\_groups\_on\_group\_card',99999,1); |
| [473](#L473) | $this->loader->add\_filter('body\_class', $plugin\_public,'add\_theme\_class\_to\_body',999999,1); |
| [474](#L474) | $this->loader->add\_filter('comment\_form\_defaults',$plugin\_public, 'pm\_change\_comment\_form\_edit\_profile\_link',99999,1); |
| [475](#L475) |  |
| [476](#L476) | } |
| [477](#L477) |  |
| [478](#L478) | /\*\* |
| [479](#L479) | \* Run the loader to execute all of the hooks with WordPress. |
| [480](#L480) | \* |
| [481](#L481) | \* @since    1.0.0 |
| [482](#L482) | \*/ |
| [483](#L483) | public function run() { |
| [484](#L484) | $this->loader->run(); |
| [485](#L485) | } |
| [486](#L486) |  |
| [487](#L487) | /\*\* |
| [488](#L488) | \* The name of the plugin used to uniquely identify it within the context of |
| [489](#L489) | \* WordPress and to define internationalization functionality. |
| [490](#L490) | \* |
| [491](#L491) | \* @since     1.0.0 |
| [492](#L492) | \* @return    string    The name of the plugin. |
| [493](#L493) | \*/ |
| [494](#L494) | public function get\_profile\_magic() { |
| [495](#L495) | return $this->profile\_magic; |
| [496](#L496) | } |
| [497](#L497) |  |
| [498](#L498) | /\*\* |
| [499](#L499) | \* The reference to the class that orchestrates the hooks with the plugin. |
| [500](#L500) | \* |
| [501](#L501) | \* @since     1.0.0 |
| [502](#L502) | \* @return    Profile\_Magic\_Loader    Orchestrates the hooks of the plugin. |
| [503](#L503) | \*/ |
| [504](#L504) | public function get\_loader() { |
| [505](#L505) | return $this->loader; |
| [506](#L506) | } |
| [507](#L507) |  |
| [508](#L508) | /\*\* |
| [509](#L509) | \* Retrieve the version number of the plugin. |
| [510](#L510) | \* |
| [511](#L511) | \* @since     1.0.0 |
| [512](#L512) | \* @return    string    The version number of the plugin. |
| [513](#L513) | \*/ |
| [514](#L514) | public function get\_version() { |
| [515](#L515) | return $this->version; |
| [516](#L516) | } |
| [517](#L517) |  |
| [518](#L518) | public function pg\_on\_plugins\_loaded() { |
| [519](#L519) | add\_option( 'progrid\_db\_version', PROGRID\_DB\_VERSION ); |
| [520](#L520) | $existing\_pg\_db\_version = floatval( get\_option( 'progrid\_db\_version', '1.0' ) ); |
| [521](#L521) | if ( $existing\_pg\_db\_version < PROGRID\_DB\_VERSION ) { |
| [522](#L522) | $pm\_activator = new Profile\_Magic\_Activator(); |
| [523](#L523) | $pm\_activator->upgrade\_db(); |
| [524](#L524) | } |
| [525](#L525) | } |
| [526](#L526) |  |
| [527](#L527) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php?format=txt)
* [Original Format](/export/3220813/profilegrid-user-profiles-groups-and-communities/trunk/includes/class-profile-magic.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_840900ca_20250111_195913.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fprofilegrid-user-profiles-groups-and-communities%2Ftrunk%2Fadmin%2Fclass-profile-magic-admin.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php?rev=3173611 "Revision 3173611")
* Next Revision →
* [Blame](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php)

---

# [source:](/browser?order=name "Go to repository root") [profilegrid-user-profiles-groups-and-communities](/browser/profilegrid-user-profiles-groups-and-communities?order=name "View profilegrid-user-profiles-groups-and-communities")/[trunk](/browser/profilegrid-user-profiles-groups-and-communities/trunk?order=name "View trunk")/[admin](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin?order=name "View admin")/[class-profile-magic-admin.php](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php?order=name "View class-profile-magic-admin.php")

View diff against:

View revision:

| [Last change](/changeset/3190069/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php "View differences") on this file was [3190069](/changeset/3190069/ "View changeset 3190069"), checked in by metagauss, [8 weeks ago](/timeline?from=2024-11-16T08%3A33%3A20Z&precision=second "See timeline at 11/16/2024 08:33:20 AM") |
| --- |
| Release 5.9.3.7 |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 111.8 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* The admin-specific functionality of the plugin. |
| [4](#L4) | \* |
| [5](#L5) | \* @link       https://profilegrid.co |
| [6](#L6) | \* @since      1.0.0 |
| [7](#L7) | \* |
| [8](#L8) | \* @package    Profile\_Magic |
| [9](#L9) | \* @subpackage Profile\_Magic/admin |
| [10](#L10) | \*/ |
| [11](#L11) |  |
| [12](#L12) | /\*\* |
| [13](#L13) | \* The admin-specific functionality of the plugin. |
| [14](#L14) | \* |
| [15](#L15) | \* Defines the plugin name, version, and two examples hooks for how to |
| [16](#L16) | \* enqueue the admin-specific stylesheet and JavaScript. |
| [17](#L17) | \* |
| [18](#L18) | \* @package    Profile\_Magic |
| [19](#L19) | \* @subpackage Profile\_Magic/admin |
| [20](#L20) | \* @author     ProfileGrid <support@profilegrid.co> |
| [21](#L21) | \*/ |
| [22](#L22) |  |
| [23](#L23) | class Profile\_Magic\_Admin { |
| [24](#L24) |  |
| [25](#L25) | /\*\* |
| [26](#L26) | \* The ID of this plugin. |
| [27](#L27) | \* |
| [28](#L28) | \* @since    1.0.0 |
| [29](#L29) | \* @access   private |
| [30](#L30) | \* @var      string    $profile\_magic    The ID of this plugin. |
| [31](#L31) | \*/ |
| [32](#L32) | private $profile\_magic; |
| [33](#L33) |  |
| [34](#L34) | /\*\* |
| [35](#L35) | \* The version of this plugin. |
| [36](#L36) | \* |
| [37](#L37) | \* @since    1.0.0 |
| [38](#L38) | \* @access   private |
| [39](#L39) | \* @var      string    $version    The current version of this plugin. |
| [40](#L40) | \*/ |
| [41](#L41) | private $version; |
| [42](#L42) |  |
| [43](#L43) | /\*\* |
| [44](#L44) | \* Initialize the class and set its properties. |
| [45](#L45) | \* |
| [46](#L46) | \* @since    1.0.0 |
| [47](#L47) | \* @param      string $profile\_magic       The name of this plugin. |
| [48](#L48) | \* @param      string $version    The version of this plugin. |
| [49](#L49) | \*/ |
| [50](#L50) | private $pm\_theme\_path; |
| [51](#L51) | private $pm\_theme\_path\_in\_wptheme; |
| [52](#L52) | public function \_\_construct( $profile\_magic, $version ) { |
| [53](#L53) |  |
| [54](#L54) | $this->profile\_magic                    = $profile\_magic; |
| [55](#L55) | $this->version                          = $version; |
| [56](#L56) | $this->pm\_theme\_path                    = plugin\_dir\_path( \_\_FILE\_\_ ) . '../public/partials/themes/'; |
| [57](#L57) | $theme\_path                     = get\_stylesheet\_directory(); |
| [58](#L58) | $override\_template              = $theme\_path . '/profilegrid-user-profiles-groups-and-communities/themes/'; |
| [59](#L59) | $this->pm\_theme\_path\_in\_wptheme = $override\_template; |
| [60](#L60) |  |
| [61](#L61) | } |
| [62](#L62) |  |
| [63](#L63) | /\*\* |
| [64](#L64) | \* Register the stylesheets for the admin area. |
| [65](#L65) | \* |
| [66](#L66) | \* @since    1.0.0 |
| [67](#L67) | \*/ |
| [68](#L68) | public function pg\_activation\_redirect() { |
| [69](#L69) | if (get\_option('pg\_redirect\_to\_group\_page', false)) { |
| [70](#L70) | delete\_option('pg\_redirect\_to\_group\_page'); |
| [71](#L71) | exit(wp\_redirect(admin\_url( 'admin.php?page=pm\_manage\_groups' ))); |
| [72](#L72) | } |
| [73](#L73) | } |
| [74](#L74) |  |
| [75](#L75) | public function activate\_sitewide\_plugins( $blog\_id ) { |
| [76](#L76) | // Switch to new website |
| [77](#L77) | $dbhandler = new PM\_DBhandler(); |
| [78](#L78) | switch\_to\_blog( $blog\_id ); |
| [79](#L79) | // Activate |
| [80](#L80) | foreach ( array\_keys( get\_site\_option( 'active\_sitewide\_plugins' ) ) as $plugin ) { |
| [81](#L81) | do\_action( 'activate\_' . $plugin, false ); |
| [82](#L82) | do\_action( 'activate' . '\_plugin', $plugin, false ); |
| [83](#L83) | } |
| [84](#L84) | // Restore current website |
| [85](#L85) | restore\_current\_blog(); |
| [86](#L86) | } |
| [87](#L87) |  |
| [88](#L88) | public function enqueue\_styles() { |
| [89](#L89) | /\*\* |
| [90](#L90) | \* This function is provided for demonstration purposes only. |
| [91](#L91) | \* |
| [92](#L92) | \* An instance of this class should be passed to the run() function |
| [93](#L93) | \* defined in Profile\_Magic\_Loader as all of the hooks are defined |
| [94](#L94) | \* in that particular class. |
| [95](#L95) | \* |
| [96](#L96) | \* The Profile\_Magic\_Loader will then create the relationship |
| [97](#L97) | \* between the defined hooks and the functions defined in this |
| [98](#L98) | \* class. |
| [99](#L99) | \*/ |
| [100](#L100) | if ( is\_user\_logged\_in() ) : |
| [101](#L101) | global $wp\_scripts; |
| [102](#L102) | // tell WordPress to load jQuery UI tabs |
| [103](#L103) | wp\_enqueue\_script( 'jquery-ui-tabs' ); |
| [104](#L104) | // get registered script object for jquery-ui |
| [105](#L105) | wp\_enqueue\_style( 'wp-color-picker' ); |
| [106](#L106) | $screen = get\_current\_screen(); |
| [107](#L107) | if ( isset( $screen ) && 'admin\_page\_pm\_profile\_fields' !== $screen->base && 'admin\_page\_pm\_profile\_view' !== $screen->base ) { |
| [108](#L108) | wp\_enqueue\_style( 'jquery-ui-smoothness', plugin\_dir\_url( \_\_FILE\_\_ ) . 'css/smoothness-jquery-ui.min.css', array(), $this->version, 'all' ); |
| [109](#L109) |  |
| [110](#L110) | } |
| [111](#L111) | wp\_enqueue\_style( $this->profile\_magic, plugin\_dir\_url( \_\_FILE\_\_ ) . 'css/profile-magic-admin.css', array(), $this->version, 'all' ); |
| [112](#L112) | wp\_register\_style( 'profilegrid-daterangepicker', plugin\_dir\_url( \_\_FILE\_\_ ) . 'css/daterangepicker.css', array(), $this->version, 'all' ); |
| [113](#L113) | wp\_enqueue\_style( 'pm-font-awesome', plugin\_dir\_url( \_\_FILE\_\_ ) . 'css/font-awesome.css', array(), $this->version, 'all' ); |
| [114](#L114) | wp\_enqueue\_style( 'thickbox' ); |
| [115](#L115) | wp\_register\_style( 'pm\_googleFonts', 'https://fonts.googleapis.com/css?family=Titillium+Web:400,600', array(), $this->version, 'all' ); |
| [116](#L116) | wp\_enqueue\_style( 'pm\_googleFonts' ); |
| [117](#L117) | wp\_register\_style( 'pm\_material\_icon', 'https://fonts.googleapis.com/icon?family=Material+Icons', array(), $this->version, 'all' ); |
| [118](#L118) | wp\_enqueue\_style( 'pm\_material\_icon' ); |
| [119](#L119) | // endif; |
| [120](#L120) | endif; |
| [121](#L121) | } |
| [122](#L122) |  |
| [123](#L123) | /\*\* |
| [124](#L124) | \* Register the JavaScript for the admin area. |
| [125](#L125) | \* |
| [126](#L126) | \* @since    1.0.0 |
| [127](#L127) | \*/ |
| [128](#L128) | public function enqueue\_scripts() { |
| [129](#L129) | $pmrequests = new PM\_request(); |
| [130](#L130) | /\*\* |
| [131](#L131) | \* This function is provided for demonstration purposes only. |
| [132](#L132) | \* |
| [133](#L133) | \* An instance of this class should be passed to the run() function |
| [134](#L134) | \* defined in Profile\_Magic\_Loader as all of the hooks are defined |
| [135](#L135) | \* in that particular class. |
| [136](#L136) | \* |
| [137](#L137) | \* The Profile\_Magic\_Loader will then create the relationship |
| [138](#L138) | \* between the defined hooks and the functions defined in this |
| [139](#L139) | \* class. |
| [140](#L140) | \*/ |
| [141](#L141) | if ( is\_user\_logged\_in() ) : |
| [142](#L142) | $dbhandler = new PM\_DBhandler(); |
| [143](#L143) | wp\_enqueue\_script( 'jquery' ); |
| [144](#L144) | wp\_enqueue\_script( 'jquery-ui-core' ); |
| [145](#L145) | wp\_enqueue\_script( 'jquery-ui-tabs' ); |
| [146](#L146) | wp\_enqueue\_Script( 'jquery-ui-sortable' ); |
| [147](#L147) | wp\_enqueue\_script( 'jquery-ui-autocomplete' ); |
| [148](#L148) | wp\_enqueue\_script( 'thickbox' ); |
| [149](#L149) | wp\_enqueue\_script( 'jquery-ui-dialog' ); |
| [150](#L150) | wp\_enqueue\_script( 'media-upload' ); |
| [151](#L151) | wp\_enqueue\_script( 'jquery-form' ); |
| [152](#L152) | wp\_enqueue\_script( 'jquery-ui-datepicker' ); |
| [153](#L153) |  |
| [154](#L154) | wp\_enqueue\_media(); |
| [155](#L155) | wp\_enqueue\_script( $this->profile\_magic, plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/profile-magic-admin.js', array( 'jquery' ), $this->version, false ); |
| [156](#L156) | wp\_enqueue\_script( 'profile-magic-admin-footer', plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/profile-magic-admin-footer.js', array( 'jquery', 'wp-color-picker' ), $this->version, true ); |
| [157](#L157) | wp\_register\_script( 'profilegrid-moment', plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/profilegrid-moment.js', array( 'jquery' ), $this->version, false ); |
| [158](#L158) | wp\_register\_script( 'profilegrid-daterangepicker', plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/daterangepicker.min.js', array( 'jquery' ), $this->version, false ); |
| [159](#L159) |  |
| [160](#L160) | wp\_enqueue\_script( 'profile-magic-license', plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/profile-magic-license.js', array( 'jquery',), $this->version, true ); |
| [161](#L161) | wp\_localize\_script( |
| [162](#L162) | 'profile-magic-license', |
| [163](#L163) | 'pg\_admin\_license\_settings', |
| [164](#L164) | array( |
| [165](#L165) | 'ajax\_url' => admin\_url( 'admin-ajax.php' ), |
| [166](#L166) | 'nonce'    => wp\_create\_nonce( 'pg-license-nonce' ), |
| [167](#L167) | ) |
| [168](#L168) | ); |
| [169](#L169) |  |
| [170](#L170) | wp\_localize\_script( |
| [171](#L171) | $this->profile\_magic, |
| [172](#L172) | 'pm\_ajax\_object', |
| [173](#L173) | array( |
| [174](#L174) | 'ajax\_url' => admin\_url( 'admin-ajax.php' ), |
| [175](#L175) | 'nonce'    => wp\_create\_nonce( 'ajax-nonce' ), |
| [176](#L176) | ) |
| [177](#L177) | ); |
| [178](#L178) | $error                              = array(); |
| [179](#L179) | $error['valid\_email']               = \_\_( 'Please enter a valid e-mail address.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [180](#L180) | $error['valid\_number']              = \_\_( 'Please enter a valid number.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [181](#L181) | $error['valid\_date']                = $pmrequests->pg\_wp\_date\_format\_error(); |
| [182](#L182) | $error['required\_field']            = \_\_( 'This is a required field.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [183](#L183) | $error['file\_type']                 = \_\_( 'This file type is not allowed.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [184](#L184) | $error['short\_password']            = \_\_( 'Your password should be at least 7 characters long.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [185](#L185) | $error['pass\_not\_match']            = \_\_( 'Password and confirm password do not match.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [186](#L186) | $error['user\_exist']                = \_\_( 'Sorry, username already exist.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [187](#L187) | $error['email\_exist']               = \_\_( 'Sorry, email already exist.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [188](#L188) | $error['valid\_facebook\_url']        = \_\_( 'Please enter a valid facebook url.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [189](#L189) | $error['valid\_twitter\_url']         = \_\_( 'Please enter a valid twitter url.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [190](#L190) | $error['valid\_google\_url']          = \_\_( 'Please enter a valid google+ url.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [191](#L191) | $error['valid\_linked\_in\_url']       = \_\_( 'Please enter a valid linkedin url.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [192](#L192) | $error['valid\_youtube\_url']         = \_\_( 'Please enter a valid youtube url.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [193](#L193) | $error['valid\_mixcloud\_url']        = \_\_( 'Please enter a valid Mixcloud url.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [194](#L194) | $error['valid\_soundcloud\_url']      = \_\_( 'Please enter a valid SoundCloud url.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [195](#L195) | $error['valid\_instagram\_url']       = \_\_( 'Please enter a valid instagram url.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [196](#L196) | $error['atleast\_one\_field']         = \_\_( 'Select at least one field.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [197](#L197) | $error['seprator\_not\_empty']        = \_\_( 'Seperator field can not be empty.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [198](#L198) | $error['choose\_image']              = \_\_( 'Choose Image', 'profilegrid-user-profiles-groups-and-communities' ); |
| [199](#L199) | $error['valid\_image']               = \_\_( 'This is not a valid image', 'profilegrid-user-profiles-groups-and-communities' ); |
| [200](#L200) | $error['valid\_group\_name']          = \_\_( 'Please enter a valid group name.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [201](#L201) | $error['group\_manager\_first']       = \_\_( 'You must define a Group Manager first, before making a Group closed.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [202](#L202) | $error['delete']                    = \_\_( 'Delete', 'profilegrid-user-profiles-groups-and-communities' ); |
| [203](#L203) | $error['success']                   = \_\_( 'Success', 'profilegrid-user-profiles-groups-and-communities' ); |
| [204](#L204) | $error['failure']                   = \_\_( 'Failure', 'profilegrid-user-profiles-groups-and-communities' ); |
| [205](#L205) | $error['select\_group']              = \_\_( 'please select a group', 'profilegrid-user-profiles-groups-and-communities' ); |
| [206](#L206) | $error['no\_user\_search']            = \_\_( 'Sorry, no user with this username in this group.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [207](#L207) | $error['select\_field\_completeness'] = \_\_( 'Select a Multiple Fields.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [208](#L208) | $error['completeness\_no\_fields']    = \_\_( 'Sorry, there are no fields like this here.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [209](#L209) |  |
| [210](#L210) | $error['change\_group']   = \_\_( 'You are changing the group of this user. All data associated with profile fields of old group will be hidden and the user will have to edit and fill profile fields associated with the new group. Do you wish to continue?', 'profilegrid-user-profiles-groups-and-communities' ); |
| [211](#L211) | $error['allow\_file\_ext'] = $dbhandler->get\_global\_option\_value( 'pm\_allow\_file\_types', 'jpg|jpeg|png|gif' ); |
| [212](#L212) | wp\_localize\_script( $this->profile\_magic, 'pm\_error\_object', $error ); |
| [213](#L213) | wp\_localize\_script( |
| [214](#L214) | $this->profile\_magic, |
| [215](#L215) | 'pm\_fields\_object', |
| [216](#L216) | array( |
| [217](#L217) | 'dateformat' => $pmrequests->pg\_wp\_date\_format\_php\_to\_js() |
| [218](#L218) | ) |
| [219](#L219) | ); |
| [220](#L220) | $upload\_requirements                                   = array(); |
| [221](#L221) | $upload\_requirements['pg\_profile\_image\_max\_file\_size'] = $dbhandler->get\_global\_option\_value( 'pg\_profile\_image\_max\_file\_size', '' ); |
| [222](#L222) | $upload\_requirements['pg\_cover\_image\_max\_file\_size']   = $dbhandler->get\_global\_option\_value( 'pg\_cover\_image\_max\_file\_size', '' ); |
| [223](#L223) | $upload\_requirements['pg\_profile\_photo\_minimum\_width'] = $dbhandler->get\_global\_option\_value( 'pg\_profile\_photo\_minimum\_width', 'DEFAULT' ); |
| [224](#L224) | $upload\_requirements['pg\_cover\_photo\_minimum\_width']   = $dbhandler->get\_global\_option\_value( 'pg\_cover\_photo\_minimum\_width', '800' ); |
| [225](#L225) | $upload\_requirements['pg\_image\_quality']               = $dbhandler->get\_global\_option\_value( 'pg\_image\_quality', '90' ); |
| [226](#L226) | if ( ! isset( $upload\_requirements['pg\_cover\_photo\_minimum\_width'] ) || empty( $upload\_requirements['pg\_cover\_photo\_minimum\_width'] ) ) { |
| [227](#L227) | $upload\_requirements['pg\_cover\_photo\_minimum\_width'] = '800'; |
| [228](#L228) | } |
| [229](#L229) | $upload\_requirements['error\_max\_profile\_filesize'] = sprintf( \_\_( 'Image size exceeds the maximum limit. Maximum allowed image size is %1$d byte.', 'profilegrid-user-profiles-groups-and-communities' ), $upload\_requirements['pg\_profile\_image\_max\_file\_size'] ); |
| [230](#L230) | $upload\_requirements['error\_min\_profile\_width']    = sprintf( \_\_( 'Image dimensions are too small. Minimum size is %1$d by %2$d pixels.', 'profilegrid-user-profiles-groups-and-communities' ), $upload\_requirements['pg\_profile\_photo\_minimum\_width'], $upload\_requirements['pg\_profile\_photo\_minimum\_width'] ); |
| [231](#L231) | $upload\_requirements['error\_min\_cover\_width']      = sprintf( \_\_( 'Image dimensions are too small. Minimum size is %1$d by %2$d pixels.', 'profilegrid-user-profiles-groups-and-communities' ), $upload\_requirements['pg\_cover\_photo\_minimum\_width'],300 ); |
| [232](#L232) | wp\_localize\_script( $this->profile\_magic, 'pm\_upload\_object', $upload\_requirements ); |
| [233](#L233) | // endif; |
| [234](#L234) | endif; |
| [235](#L235) |  |
| [236](#L236) | } |
| [237](#L237) |  |
| [238](#L238) | public function profile\_magic\_admin\_menu\_for\_extensions() { |
| [239](#L239) | add\_submenu\_page( 'pm\_manage\_groups', 'Extensions', 'Extensions', 'manage\_options', 'pm\_extensions', array( $this, 'pm\_extensions' ) ); |
| [240](#L240) | } |
| [241](#L241) |  |
| [242](#L242) | public function profile\_magic\_admin\_menu() { |
| [243](#L243) | add\_menu\_page( \_\_( 'ProfileGrid', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'ProfileGrid', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_manage\_groups', array( $this, 'pm\_manage\_groups' ), 'dashicons-groups', 26 ); |
| [244](#L244) | add\_submenu\_page( 'pm\_manage\_groups', \_\_( 'Groups', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Groups', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_manage\_groups', array( $this, 'pm\_manage\_groups' ) ); |
| [245](#L245) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'New Group', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'New Group', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_add\_group', array( $this, 'pm\_add\_group' ) ); |
| [246](#L246) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Profile Fields', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Profile Fields', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_profile\_fields', array( $this, 'pm\_profile\_fields' ) ); |
| [247](#L247) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'New Field', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'New Field', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_add\_field', array( $this, 'pm\_add\_field' ) ); |
| [248](#L248) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'New Section', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'New Section', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_add\_section', array( $this, 'pm\_add\_section' ) ); |
| [249](#L249) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Profile Templates', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Profile Templates', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_theme\_settings', array( $this, 'pm\_theme\_settings' ) ); |
| [250](#L250) | add\_submenu\_page( 'pm\_manage\_groups', \_\_( 'Members', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Members', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_user\_manager', array( $this, 'pm\_user\_manager' ) ); |
| [251](#L251) | add\_submenu\_page( 'pm\_manage\_groups', \_\_( 'Requests', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Requests', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_requests\_manager', array( $this, 'pm\_requests\_manager' ) ); |
| [252](#L252) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Profile View', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Profile View', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_profile\_view', array( $this, 'pm\_profile\_view' ) ); |
| [253](#L253) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Edit User', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Edit User', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_user\_edit', array( $this, 'pm\_user\_edit' ) ); |
| [254](#L254) | add\_submenu\_page( 'pm\_manage\_groups', \_\_( 'Email Templates', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Email Templates', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_email\_templates', array( $this, 'pm\_email\_templates' ) ); |
| [255](#L255) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Add Email Template', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Add Email Template', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_add\_email\_template', array( $this, 'pm\_add\_email\_template' ) ); |
| [256](#L256) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Email Preview', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Email Preview', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_email\_preview', array( $this, 'pm\_email\_preview' ) ); |
| [257](#L257) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Analytics', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Analytics', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_analytics', array( $this, 'pm\_analytics' ) ); |
| [258](#L258) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Membership', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Membership', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_membership', array( $this, 'pm\_membership' ) ); |
| [259](#L259) | add\_submenu\_page( 'pm\_manage\_groups', \_\_( 'Shortcodes', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Shortcodes', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_shortcodes', array( $this, 'pm\_shortcodes' ) ); |
| [260](#L260) | add\_submenu\_page( 'pm\_manage\_groups', \_\_( 'Global Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Global Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_settings', array( $this, 'pm\_settings' ) ); |
| [261](#L261) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'General Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'General Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_general\_settings', array( $this, 'pm\_general\_settings' ) ); |
| [262](#L262) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Anti Spam Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Anti Spam Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_security\_settings', array( $this, 'pm\_security\_settings' ) ); |
| [263](#L263) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'User Accounts Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'User Accounts Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_user\_settings', array( $this, 'pm\_user\_settings' ) ); |
| [264](#L264) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Email Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Email Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_email\_settings', array( $this, 'pm\_email\_settings' ) ); |
| [265](#L265) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Third Party Integrations', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Third Party Integrations', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_third\_party\_settings', array( $this, 'pm\_third\_party\_settings' ) ); |
| [266](#L266) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Payments Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Payments Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_payment\_settings', array( $this, 'pm\_payment\_settings' ) ); |
| [267](#L267) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Tools', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Tools', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_tools', array( $this, 'pm\_tools' ) ); |
| [268](#L268) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Export Users', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Export Users', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_export\_users', array( $this, 'pm\_export\_users' ) ); |
| [269](#L269) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Import Users', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Import Users', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_import\_users', array( $this, 'pm\_import\_users' ) ); |
| [270](#L270) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Blog Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Blog Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_blog\_settings', array( $this, 'pm\_blog\_settings' ) ); |
| [271](#L271) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Message Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Message Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_message\_settings', array( $this, 'pm\_message\_settings' ) ); |
| [272](#L272) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Friends Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Friends Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_friend\_settings', array( $this, 'pm\_friend\_settings' ) ); |
| [273](#L273) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Upload Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Upload Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_upload\_settings', array( $this, 'pm\_upload\_settings' ) ); |
| [274](#L274) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'SEO Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'SEO Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_seo\_settings', array( $this, 'pm\_seo\_settings' ) ); |
| [275](#L275) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Export Options', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Export Options', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_export\_options', array( $this, 'pm\_export\_options' ) ); |
| [276](#L276) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Import Options', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Import Options', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_import\_options', array( $this, 'pm\_import\_options' ) ); |
| [277](#L277) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Content Restrictions', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Content Restrictions', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_content\_restrictions', array( $this, 'pm\_content\_restrictions' ) ); |
| [278](#L278) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Woocommerce Extension', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Woocommerce Extension', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_woocommerce\_extension', array( $this, 'pm\_woocommerce\_extension' ) ); |
| [279](#L279) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Advanced Woocommerce Extension', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Advanced Woocommerce Extension', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_woocommerce\_advanced\_extension', array( $this, 'pm\_woocommerce\_advanced\_extension' ) ); |
| [280](#L280) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'RegistrationMagic Integrations', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'RegistrationMagic Integrations', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_rm\_integration', array( $this, 'pm\_rm\_integration' ) ); |
| [281](#L281) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Profile Notifications', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Profile Notifications', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_profile\_notification\_settings', array( $this, 'pm\_profile\_notification\_settings' ) ); |
| [282](#L282) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Woocommerce Wishlist Extension', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Woocommerce Wishlist Extension', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_woocommerce\_wishlist\_extension', array( $this, 'pm\_woocommerce\_wishlist\_extension' ) ); |
| [283](#L283) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Profile Tabs Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Profile Tabs Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_profile\_tabs\_settings', array( $this, 'pm\_profile\_tabs\_settings' ) ); |
| [284](#L284) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Private Profile Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Private Profile Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_private\_profile\_settings', array( $this, 'pm\_private\_profile\_settings' ) ); |
| [285](#L285) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Elements Visibility Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Elements Visibility Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_elements\_visibility\_settings', array( $this, 'pm\_elements\_visibility\_settings' ) ); |
| [286](#L286) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Performance Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Performance Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_performance\_options', array( $this, 'pm\_performance\_options' ) ); |
| [287](#L287) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'Activation Wizard', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'Activation Wizard', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_activation\_wizard', array( $this, 'pm\_activation\_wizard' ) ); |
| [288](#L288) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'All Users Listing Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'All Users Listing Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_users\_listing\_settings', array( $this, 'pm\_users\_listing\_settings' ) ); |
| [289](#L289) | add\_submenu\_page( 'pm\_manage\_groups\_hide', \_\_( 'License Settings', 'profilegrid-user-profiles-groups-and-communities' ), \_\_( 'License Settings', 'profilegrid-user-profiles-groups-and-communities' ), 'manage\_options', 'pm\_license\_settings', array( $this, 'pm\_license\_settings' ) ); |
| [290](#L290) |  |
| [291](#L291) |  |
| [292](#L292) | } |
| [293](#L293) |  |
| [294](#L294) | public function pm\_license\_settings() |
| [295](#L295) | { |
| [296](#L296) | include 'partials/pg-license.php'; |
| [297](#L297) | } |
| [298](#L298) |  |
| [299](#L299) | public function pm\_offers() { |
| [300](#L300) | include 'partials/pg-offers.php'; |
| [301](#L301) | } |
| [302](#L302) |  |
| [303](#L303) | public function pm\_activation\_wizard() { |
| [304](#L304) |  |
| [305](#L305) | include 'partials/pg-activation-wizard.php'; |
| [306](#L306) |  |
| [307](#L307) | } |
| [308](#L308) |  |
| [309](#L309) | public function pg\_fetch\_offers() { |
| [310](#L310) | $url          = 'https://profilegrid.co/pg-offers.json'; |
| [311](#L311) | $html = wp\_remote\_get( $url ); |
| [312](#L312) | $json          = json\_decode( $html['body'] ); |
| [313](#L313) | if ( ! empty( $json ) ) { |
| [314](#L314) | foreach ( $json as $offer ) { |
| [315](#L315) | ?> |
| [316](#L316) | <div class="pg-offer"> |
| [317](#L317) | <div class="pg-offer-wrap"> |
| [318](#L318) | <?php if ( isset( $offer->title ) ) : ?> |
| [319](#L319) | <span class="pg-offer-title"><strong><?php echo wp\_kses\_post( $offer->title ); ?></strong></span> |
| [320](#L320) | <?php endif; ?> |
| [321](#L321) | <?php if ( isset( $offer->offer ) ) : ?> |
| [322](#L322) | <span class="pg-offer-desc"><?php echo wp\_kses\_post( $offer->offer ); ?></span> |
| [323](#L323) | <?php endif; ?> |
| [324](#L324) | <?php if ( isset( $offer->code ) ) : ?> |
| [325](#L325) | <span class="pg-offer-code"><strong><?php echo wp\_kses\_post( $offer->code ); ?></strong></span> |
| [326](#L326) | <?php endif; ?> |
| [327](#L327) | </div> |
| [328](#L328) | <?php if ( isset( $offer->link ) ) : ?> |
| [329](#L329) | <div class="pg-buy-btn"><a href="<?php echo esc\_url( $offer->link ); ?>"> |
| [330](#L330) | <?php |
| [331](#L331) | if ( isset( $offer->link\_title ) && ! empty( $offer->link\_title ) ) { |
| [332](#L332) | echo wp\_kses\_post( $offer->link\_title ); |
| [333](#L333) |  |
| [334](#L334) | } else { |
| [335](#L335) | esc\_html\_e( 'Buy Now', 'profilegrid-user-profiles-groups-and-communities' ); |
| [336](#L336) |  |
| [337](#L337) | } |
| [338](#L338) | ?> |
| [339](#L339) | </a> |
| [340](#L340) | </div> |
| [341](#L341) | <?php endif; ?> |
| [342](#L342) | </div> |
| [343](#L343) | <?php |
| [344](#L344) | } |
| [345](#L345) | } else { |
| [346](#L346) | ?> |
| [347](#L347) | <div class="pg-no-offer"><?php esc\_html\_e( 'Sorry, no offers available right now.', 'profilegrid-user-profiles-groups-and-communities' ); ?></div> |
| [348](#L348) | <?php |
| [349](#L349) | } |
| [350](#L350) |  |
| [351](#L351) | die; |
| [352](#L352) | } |
| [353](#L353) |  |
| [354](#L354) | public function pm\_performance\_options() { |
| [355](#L355) | include 'partials/performance-setting.php'; |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | public function pm\_users\_listing\_settings() { |
| [359](#L359) | include 'partials/pm-users-listing-setting.php'; |
| [360](#L360) | } |
| [361](#L361) |  |
| [362](#L362) | public function pm\_elements\_visibility\_settings() { |
| [363](#L363) | include 'partials/elements-visibility-setting.php'; |
| [364](#L364) | } |
| [365](#L365) |  |
| [366](#L366) | public function pm\_profile\_tabs\_settings() { |
| [367](#L367) | include 'partials/profile-tab-setting.php'; |
| [368](#L368) | } |
| [369](#L369) |  |
| [370](#L370) | public function pm\_premium\_options() { |
| [371](#L371) | include 'partials/premium-features.php'; |
| [372](#L372) | } |
| [373](#L373) |  |
| [374](#L374) | public function pm\_premium\_options\_profile\_labels() { |
| [375](#L375) | include 'partials/premium-features-profile-labels.php'; |
| [376](#L376) | } |
| [377](#L377) |  |
| [378](#L378) | public function pm\_premium\_options\_custom\_tabs() { |
| [379](#L379) | include 'partials/premium-features-custom-tabs.php'; |
| [380](#L380) | } |
| [381](#L381) |  |
| [382](#L382) | public function pm\_premium\_options\_custom\_product\_tabs() { |
| [383](#L383) | include 'partials/premium-features-custom-product-tabs.php'; |
| [384](#L384) | } |
| [385](#L385) |  |
| [386](#L386) | public function pm\_premium\_options\_mailchimp() { |
| [387](#L387) | include 'partials/premium-features-mailchimp.php'; |
| [388](#L388) | } |
| [389](#L389) |  |
| [390](#L390) | public function pm\_premium\_options\_mailpoet() { |
| [391](#L391) | include 'partials/premium-features-mailpoet.php'; |
| [392](#L392) | } |
| [393](#L393) |  |
| [394](#L394) | public function pm\_private\_profile\_settings() { |
| [395](#L395) | include 'partials/private-profile-setting.php'; |
| [396](#L396) | } |
| [397](#L397) |  |
| [398](#L398) | public function pm\_theme\_settings() { |
| [399](#L399) | include 'partials/theme-setting.php'; |
| [400](#L400) | } |
| [401](#L401) |  |
| [402](#L402) | public function pm\_woocommerce\_wishlist\_extension() { |
| [403](#L403) | include 'partials/woocommerce-wishlist-extension.php'; |
| [404](#L404) | } |
| [405](#L405) |  |
| [406](#L406) |  |
| [407](#L407) | public function pm\_requests\_manager() { |
| [408](#L408) | include 'partials/pm-membership-requests.php'; |
| [409](#L409) | $this->pg\_get\_footer\_banner(); |
| [410](#L410) | } |
| [411](#L411) |  |
| [412](#L412) | public function pm\_message\_settings() { |
| [413](#L413) | include 'partials/message-settings.php'; |
| [414](#L414) | } |
| [415](#L415) |  |
| [416](#L416) | public function pm\_profile\_notification\_settings() { |
| [417](#L417) | include 'partials/profile-notification-settings.php'; |
| [418](#L418) | } |
| [419](#L419) |  |
| [420](#L420) |  |
| [421](#L421) | public function pm\_rm\_integration() { |
| [422](#L422) | if ( class\_exists( 'Profile\_Magic' ) && class\_exists( 'Registration\_Magic' ) ) { |
| [423](#L423) | include 'partials/rmagic\_settings.php'; |
| [424](#L424) | } else { |
| [425](#L425) | include 'partials/rmagic\_banner\_settings.php'; |
| [426](#L426) | } |
| [427](#L427) | } |
| [428](#L428) |  |
| [429](#L429) | public function pm\_woocommerce\_extension() { |
| [430](#L430) | include 'partials/woocommerce-extension.php'; |
| [431](#L431) | } |
| [432](#L432) |  |
| [433](#L433) | public function pm\_woocommerce\_advanced\_extension() { |
| [434](#L434) | include 'partials/woocommerce-advanced-extension.php'; |
| [435](#L435) | } |
| [436](#L436) |  |
| [437](#L437) | public function pm\_content\_restrictions() { |
| [438](#L438) | include 'partials/content-restrictions.php'; |
| [439](#L439) | } |
| [440](#L440) |  |
| [441](#L441) | public function pm\_import\_options() { |
| [442](#L442) | include 'partials/import-options.php'; |
| [443](#L443) | } |
| [444](#L444) |  |
| [445](#L445) | public function pm\_export\_options() { |
| [446](#L446) | include 'partials/export-options.php'; |
| [447](#L447) | } |
| [448](#L448) |  |
| [449](#L449) | public function pm\_seo\_settings() { |
| [450](#L450) | include 'partials/seo-settings.php'; |
| [451](#L451) | } |
| [452](#L452) |  |
| [453](#L453) | public function pm\_upload\_settings() { |
| [454](#L454) | include 'partials/upload-settings.php'; |
| [455](#L455) | } |
| [456](#L456) |  |
| [457](#L457) | public function pm\_extensions() { |
| [458](#L458) | include 'partials/pm\_extensions\_new.php'; |
| [459](#L459) | } |
| [460](#L460) |  |
| [461](#L461) | public function pm\_friend\_settings() { |
| [462](#L462) | include 'partials/friends-settings.php'; |
| [463](#L463) | } |
| [464](#L464) |  |
| [465](#L465) | public function pm\_tools() { |
| [466](#L466) | include 'partials/pm-tools.php'; |
| [467](#L467) | } |
| [468](#L468) |  |
| [469](#L469) | public function pm\_payment\_settings() { |
| [470](#L470) | include 'partials/payment-settings.php'; |
| [471](#L471) | } |
| [472](#L472) |  |
| [473](#L473) | public function pm\_blog\_settings() { |
| [474](#L474) | include 'partials/blog-settings.php'; |
| [475](#L475) | } |
| [476](#L476) |  |
| [477](#L477) | public function pm\_export\_users() { |
| [478](#L478) | include 'partials/pm-export-users.php'; |
| [479](#L479) | } |
| [480](#L480) |  |
| [481](#L481) | public function pm\_import\_users() { |
| [482](#L482) | include 'partials/pm-import-users.php'; |
| [483](#L483) | } |
| [484](#L484) |  |
| [485](#L485) | public function pm\_profile\_magic\_add\_group\_option( $gid, $group\_options ) { |
| [486](#L486) | include 'partials/profile-magic-group-option.php'; |
| [487](#L487) | } |
| [488](#L488) |  |
| [489](#L489) | public function pm\_profile\_magic\_premium\_group\_option( $gid, $group\_options ) { |
| [490](#L490) | include 'partials/premium-group-options.php'; |
| [491](#L491) | } |
| [492](#L492) |  |
| [493](#L493) | public function pm\_profile\_magic\_add\_option\_setting\_page() { |
| [494](#L494) | include 'partials/profile-magic-paypal-admin-display.php'; |
| [495](#L495) | } |
| [496](#L496) |  |
| [497](#L497) | public function pm\_add\_email\_template() { |
| [498](#L498) | include 'partials/email-template.php'; |
| [499](#L499) | $this->pg\_get\_footer\_banner(); |
| [500](#L500) | } |
| [501](#L501) |  |
| [502](#L502) | public function pm\_shortcodes() { |
| [503](#L503) | include 'partials/shortcode.php'; |
| [504](#L504) | $this->pg\_get\_footer\_banner(); |
| [505](#L505) | } |
| [506](#L506) | public function pm\_email\_templates() { |
| [507](#L507) | include 'partials/email-templates-list.php'; |
| [508](#L508) | $this->pg\_get\_footer\_banner(); |
| [509](#L509) | } |
| [510](#L510) |  |
| [511](#L511) | public function pm\_email\_preview() { |
| [512](#L512) | include 'partials/email-preview.php'; |
| [513](#L513) | } |
| [514](#L514) |  |
| [515](#L515) | public function pm\_template\_preview\_button() { |
| [516](#L516) | echo '<a href="admin.php?page=pm\_email\_preview&TB\_iframe=false&width=600&height=550inlineId=wpbody" class="thickbox" onClick="return preview()">Preview</a>'; |
| [517](#L517) |  |
| [518](#L518) | } |
| [519](#L519) |  |
| [520](#L520) | public function pm\_manage\_groups() { |
| [521](#L521) | include 'partials/manage-groups.php'; |
| [522](#L522) | } |
| [523](#L523) |  |
| [524](#L524) | public function pm\_add\_group() { |
| [525](#L525) | include 'partials/add-group-tabview.php'; |
| [526](#L526) | } |
| [527](#L527) |  |
| [528](#L528) | public function pm\_add\_field() { |
| [529](#L529) | include 'partials/add-field.php'; |
| [530](#L530) | } |
| [531](#L531) |  |
| [532](#L532) | public function pm\_add\_section() { |
| [533](#L533) | include 'partials/add-section.php'; |
| [534](#L534) | } |
| [535](#L535) |  |
| [536](#L536) | public function pm\_profile\_fields() { |
| [537](#L537) | include 'partials/manage-fields.php'; |
| [538](#L538) | } |
| [539](#L539) |  |
| [540](#L540) | public function pm\_user\_manager() { |
| [541](#L541) | include 'partials/user-manager.php'; |
| [542](#L542) | $this->pg\_get\_footer\_banner(); |
| [543](#L543) | } |
| [544](#L544) |  |
| [545](#L545) | public function pm\_profile\_view() { |
| [546](#L546) | include 'partials/user-profile.php'; |
| [547](#L547) | } |
| [548](#L548) |  |
| [549](#L549) | public function pm\_third\_party\_settings() { |
| [550](#L550) | include 'partials/thirdparty-settings.php'; |
| [551](#L551) | } |
| [552](#L552) |  |
| [553](#L553) | public function pm\_email\_settings() { |
| [554](#L554) | include 'partials/email-settings.php'; |
| [555](#L555) | } |
| [556](#L556) |  |
| [557](#L557) | public function pm\_user\_settings() { |
| [558](#L558) | include 'partials/user-settings.php'; |
| [559](#L559) | } |
| [560](#L560) |  |
| [561](#L561) | public function pm\_general\_settings() { |
| [562](#L562) | include 'partials/general-settings.php'; |
| [563](#L563) |  |
| [564](#L564) | } |
| [565](#L565) |  |
| [566](#L566) | public function pm\_security\_settings() { |
| [567](#L567) | include 'partials/security-settings.php'; |
| [568](#L568) | } |
| [569](#L569) |  |
| [570](#L570) | public function pm\_settings() { |
| [571](#L571) | include 'partials/global-settings.php'; |
| [572](#L572) | $this->pg\_get\_footer\_banner(); |
| [573](#L573) | } |
| [574](#L574) |  |
| [575](#L575) |  |
| [576](#L576) |  |
| [577](#L577) |  |
| [578](#L578) | public function profile\_magic\_set\_field\_order() { |
| [579](#L579) | include 'partials/set-fields-order.php'; |
| [580](#L580) | die; |
| [581](#L581) | } |
| [582](#L582) |  |
| [583](#L583) | public function profile\_magic\_set\_group\_order() { |
| [584](#L584) | include 'partials/set-groups-order.php'; |
| [585](#L585) | die; |
| [586](#L586) | } |
| [587](#L587) |  |
| [588](#L588) | public function profile\_magic\_set\_group\_items() { |
| [589](#L589) | include 'partials/set-groups-order.php'; |
| [590](#L590) | die; |
| [591](#L591) | } |
| [592](#L592) |  |
| [593](#L593) | public function profile\_magic\_set\_section\_order() { |
| [594](#L594) | $dbhandler = new PM\_DBhandler(); |
| [595](#L595) | $textdomain         = $this->profile\_magic; |
| [596](#L596) | $path               = plugin\_dir\_url( \_\_FILE\_\_ ); |
| [597](#L597) | $identifier         = 'SECTION'; |
| [598](#L598) | $list\_order         = filter\_input( INPUT\_POST, 'list\_order' ); |
| [599](#L599) | if ( isset( $list\_order ) ) { |
| [600](#L600) | $list = explode( ',', $list\_order ); |
| [601](#L601) | $i    = 1; |
| [602](#L602) | foreach ( $list as $id ) { |
| [603](#L603) | $dbhandler->update\_row( $identifier, 'id', $id, array( 'ordering' => $i ), array( '%d' ), '%d' ); |
| [604](#L604) |  |
| [605](#L605) | $i++; |
| [606](#L606) | } |
| [607](#L607) | } |
| [608](#L608) | die; |
| [609](#L609) | } |
| [610](#L610) |  |
| [611](#L611) | public function profile\_magic\_section\_dropdown() { |
| [612](#L612) | $gid       = filter\_input( INPUT\_POST, 'gid' ); |
| [613](#L613) | $dbhandler = new PM\_DBhandler(); |
| [614](#L614) | $sections  = $dbhandler->get\_all\_result( 'SECTION', array( 'id', 'section\_name' ), array( 'gid' => $gid ) ); |
| [615](#L615) | foreach ( $sections as $section ) { |
| [616](#L616) | ?> |
| [617](#L617) | <option value="<?php echo esc\_attr( $section->id ); ?>" |
| [618](#L618) | <?php |
| [619](#L619) | if ( ! empty( $row ) ) { |
| [620](#L620) | selected( $row->associate\_section, $section->id );} |
| [621](#L621) | ?> |
| [622](#L622) | ><?php echo esc\_html( $section->section\_name ); ?></option> |
| [623](#L623) | <?php |
| [624](#L624) | } |
| [625](#L625) | die; |
| [626](#L626) | } |
| [627](#L627) |  |
| [628](#L628) |  |
| [629](#L629) | public function profile\_magic\_check\_smtp\_connection() { |
| [630](#L630) |  |
| [631](#L631) | if ( ! isset( $\_POST['nonce'] ) || ! wp\_verify\_nonce( sanitize\_key( $\_POST['nonce'] ), 'ajax-nonce' ) ) { |
| [632](#L632) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [633](#L633) | } |
| [634](#L634) |  |
| [635](#L635) | if ( current\_user\_can( 'manage\_options' ) ) |
| [636](#L636) | { |
| [637](#L637) | $dbhandler  = new PM\_DBhandler(); |
| [638](#L638) | $pmrequests = new PM\_request(); |
| [639](#L639) | $identifier     = 'SETTINGS'; |
| [640](#L640) | $exclude        = array( '\_wpnonce', '\_wp\_http\_referer', 'submit\_settings' ); |
| [641](#L641) | $post           = $pmrequests->sanitize\_request( $\_POST, $identifier, $exclude ); |
| [642](#L642) | if ( $post != false ) |
| [643](#L643) | { |
| [644](#L644) | if ( isset( $post['pm\_smtp\_password'] ) && $post['pm\_smtp\_password'] != '' ) { |
| [645](#L645) | $post['pm\_smtp\_password'] = $post['pm\_smtp\_password']; |
| [646](#L646) | } else { |
| [647](#L647) | unset( $post['pm\_smtp\_password'] ); |
| [648](#L648) | } |
| [649](#L649) | foreach ( $post as $key => $value ) { |
| [650](#L650) | $dbhandler->update\_global\_option\_value( $key, $value ); |
| [651](#L651) | } |
| [652](#L652) | } |
| [653](#L653) | $dbhandler->update\_global\_option\_value( 'pm\_enable\_smtp', 1 ); |
| [654](#L654) | $to = $dbhandler->get\_global\_option\_value( 'pm\_smtp\_test\_email\_address' ); |
| [655](#L655) | $from\_email\_address = $pmrequests->profile\_magic\_get\_from\_email(); |
| [656](#L656) | $headers            = "MIME-Version: 1.0\r\n"; |
| [657](#L657) | $headers           .= "Content-type:text/html;charset=UTF-8\r\n"; |
| [658](#L658) | $headers           .= 'From:' . $from\_email\_address . "\r\n"; |
| [659](#L659) | echo esc\_html( wp\_mail( $to, 'Test SMTP Connection', 'Test', $headers ) ); |
| [660](#L660) | } |
| [661](#L661) | die; |
| [662](#L662) |  |
| [663](#L663) | } |
| [664](#L664) |  |
| [665](#L665) |  |
| [666](#L666) |  |
| [667](#L667) | public function pm\_fields\_list\_for\_email() { |
| [668](#L668) | $dbhandler = new PM\_DBhandler(); |
| [669](#L669) | $exclude   = "and field\_type not in('file','user\_avatar','heading','paragraph','confirm\_pass','user\_pass','divider','spacing','birth\_date','user\_email')"; |
| [670](#L670) | $groups    = $dbhandler->get\_all\_result( 'GROUPS' ); |
| [671](#L671) | echo '<select name="pm\_field\_list" class="pm\_field\_list" onchange="pm\_insert\_field\_in\_email(this.value)">'; |
| [672](#L672) | echo '<option>' . esc\_html\_\_( 'Select A Field', 'profilegrid-user-profiles-groups-and-communities' ) . '</option>'; |
| [673](#L673) | echo '<optgroup label="' . esc\_attr\_\_( 'Common Fields', 'profilegrid-user-profiles-groups-and-communities' ) . '" >'; |
| [674](#L674) | echo '<option value="{{user\_login}}">' . esc\_html\_\_( 'User Name', 'profilegrid-user-profiles-groups-and-communities' ) . '</option>'; |
| [675](#L675) | echo '<option value="{{user\_pass}}">' . esc\_html\_\_( 'User Password', 'profilegrid-user-profiles-groups-and-communities' ) . '</option>'; |
| [676](#L676) | echo '<option value="{{display\_name}}">' . esc\_html\_\_( 'Display Name', 'profilegrid-user-profiles-groups-and-communities' ) . '</option>'; |
| [677](#L677) | echo '<option value="{{user\_email}}">' . esc\_html\_\_( 'Email', 'profilegrid-user-profiles-groups-and-communities' ) . '</option>'; |
| [678](#L678) | echo '</optgroup>'; |
| [679](#L679) | if ( isset( $groups ) ) : |
| [680](#L680) | foreach ( $groups as $group ) { |
| [681](#L681) | $fields = $dbhandler->get\_all\_result( 'FIELDS', '\*', array( 'associate\_group' => $group->id ), 'results', 0, false, 'ordering', false, $exclude ); |
| [682](#L682) | if ( isset( $fields ) ) : |
| [683](#L683) | echo '<optgroup label="' . esc\_attr( $group->group\_name ) . '" >'; |
| [684](#L684) |  |
| [685](#L685) | foreach ( $fields as $field ) { |
| [686](#L686) | echo '<option value="{{' . esc\_attr( $field->field\_key ) . '}}">' . esc\_html( $field->field\_name ) . '</option>'; |
| [687](#L687) | } |
| [688](#L688) |  |
| [689](#L689) |  |
| [690](#L690) | echo '</optgroup>'; |
| [691](#L691) | endif; |
| [692](#L692) | } |
| [693](#L693) | echo '<optgroup label="' . esc\_html\_\_( 'Other Fields', 'profilegrid-user-profiles-groups-and-communities' ) . '" >'; |
| [694](#L694) | echo '<option value="{{post\_name}}">' . esc\_html\_\_( 'Post Name', 'profilegrid-user-profiles-groups-and-communities' ) . '</option>'; |
| [695](#L695) | echo '<option value="{{edit\_post\_link}}">' . esc\_html\_\_( 'Review Post Link', 'profilegrid-user-profiles-groups-and-communities' ) . '</option>'; |
| [696](#L696) | echo '<option value="{{post\_link}}">' . esc\_html\_\_( 'Post Link', 'profilegrid-user-profiles-groups-and-communities' ) . '</option>'; |
| [697](#L697) | echo '<option value="{{group\_name}}">' . esc\_html\_\_( 'User Group Name', 'profilegrid-user-profiles-groups-and-communities' ) . '</option>'; |
| [698](#L698) | echo '</optgroup>'; |
| [699](#L699) | echo '</select>'; |
| [700](#L700) | endif; |
| [701](#L701) |  |
| [702](#L702) | } |
| [703](#L703) |  |
| [704](#L704) | public function profile\_magic\_show\_user\_fields( $user ) { |
| [705](#L705) | $dbhandler                       = new PM\_DBhandler(); |
| [706](#L706) | $pg\_profile\_image\_max\_file\_size = $dbhandler->get\_global\_option\_value( 'pg\_profile\_image\_max\_file\_size', '' ); |
| [707](#L707) | $pg\_cover\_image\_max\_file\_size   = $dbhandler->get\_global\_option\_value( 'pg\_cover\_image\_max\_file\_size', '' ); |
| [708](#L708) | $pg\_profile\_photo\_minimum\_width = $dbhandler->get\_global\_option\_value( 'pg\_profile\_photo\_minimum\_width', 'DEFAULT' ); |
| [709](#L709) | $pg\_cover\_photo\_minimum\_width   = $dbhandler->get\_global\_option\_value( 'pg\_cover\_photo\_minimum\_width', 'DEFAULT' ); |
| [710](#L710) |  |
| [711](#L711) | if ( $pg\_profile\_photo\_minimum\_width == 'DEFAULT' ) { |
| [712](#L712) | $pg\_profile\_photo\_minimum\_width = 150; |
| [713](#L713) | } |
| [714](#L714) | if ( $pg\_cover\_photo\_minimum\_width == 'DEFAULT' ) { |
| [715](#L715) | $pg\_cover\_photo\_minimum\_width = 800; |
| [716](#L716) | } |
| [717](#L717) | if ( $pg\_profile\_image\_max\_file\_size == '' ) { |
| [718](#L718) | $message = sprintf( \_\_( 'File Restrictions: Please make sure your image size fits within %1$d by %2$d pixels.', 'profilegrid-user-profiles-groups-and-communities' ), $pg\_profile\_photo\_minimum\_width, $pg\_profile\_photo\_minimum\_width ); |
| [719](#L719) | } else { |
| [720](#L720) | $message = sprintf( \_\_( 'File Restrictions: Please make sure your image size fits within %1$d by %2$d pixels and does not exceeds total size of %3$d bytes.', 'profilegrid-user-profiles-groups-and-communities' ), $pg\_profile\_photo\_minimum\_width, $pg\_profile\_photo\_minimum\_width, $pg\_profile\_image\_max\_file\_size ); |
| [721](#L721) | } |
| [722](#L722) |  |
| [723](#L723) | if ( $pg\_cover\_image\_max\_file\_size == '' ) { |
| [724](#L724) | $message2 = sprintf( \_\_( 'File Restrictions: Please make sure your image size fits within %1$d by %2$d pixels.', 'profilegrid-user-profiles-groups-and-communities' ), $pg\_cover\_photo\_minimum\_width, 300 ); |
| [725](#L725) | } else { |
| [726](#L726) | $message2 = sprintf( \_\_( 'File Restrictions: Please make sure your image size fits within %1$d by %2$d pixels and does not exceeds total size of %3$d bytes.', 'profilegrid-user-profiles-groups-and-communities' ), $pg\_cover\_photo\_minimum\_width, 300, $pg\_cover\_image\_max\_file\_size ); |
| [727](#L727) | } |
| [728](#L728) |  |
| [729](#L729) | $pm\_customfields = new PM\_Custom\_Fields(); |
| [730](#L730) | $pmrequests      = new PM\_request(); |
| [731](#L731) | if ( is\_object( $user ) ) { |
| [732](#L732) | $uid = $user->ID; |
| [733](#L733) | $gids            = $pmrequests->profile\_magic\_get\_user\_field\_value( $user->ID, 'pm\_group' ); |
| [734](#L734) | $gid = $pmrequests->pg\_filter\_users\_group\_ids( $gids ); |
| [735](#L735) | } else { |
| [736](#L736) | $gid             = array(); |
| [737](#L737) | $uid = 0; |
| [738](#L738) | } |
| [739](#L739) |  |
| [740](#L740) | if ( ! empty( $gid ) ) : |
| [741](#L741) | if ( current\_user\_can( 'manage\_options' ) ) { |
| [742](#L742) | $exclude = 'associate\_group in(' . implode( ',', $gid ) . ") and field\_type not in('first\_name','last\_name','user\_name','user\_email','user\_url','user\_pass','confirm\_pass','description','user\_avatar','heading','paragraph')"; |
| [743](#L743) | } else { |
| [744](#L744) | $exclude = 'associate\_group in(' . implode( ',', $gid ) . ") and field\_type not in('first\_name','last\_name','user\_name','user\_email','user\_url','user\_pass','confirm\_pass','description','user\_avatar','heading','paragraph','read\_only')"; |
| [745](#L745) | } |
| [746](#L746) |  |
| [747](#L747) | $fields = $dbhandler->get\_all\_result( 'FIELDS', '\*', 1, 'results', 0, false, 'ordering', false, $exclude ); |
| [748](#L748) | endif; |
| [749](#L749) | $col = $dbhandler->get\_global\_option\_value( 'pm\_reg\_form\_cols', 1 ); |
| [750](#L750) |  |
| [751](#L751) | $profile\_pic                = ( is\_object( $user ) ) ? get\_user\_meta( $uid, 'pm\_user\_avatar', true ) : false; |
| [752](#L752) | $groups                     = $dbhandler->get\_all\_result( 'GROUPS', array( 'id', 'group\_name' ) ); |
| [753](#L753) | $pm\_profile\_privacy = $pmrequests->profile\_magic\_get\_user\_field\_value( $uid, 'pm\_profile\_privacy' ); |
| [754](#L754) | $pm\_hide\_my\_profile = $pmrequests->profile\_magic\_get\_user\_field\_value( $uid, 'pm\_hide\_my\_profile' ); |
| [755](#L755) | if ( empty( $pm\_hide\_my\_profile ) ) { |
| [756](#L756) | $pm\_hide\_my\_profile = '0'; |
| [757](#L757) | } |
| [758](#L758) | $cover\_image = $pmrequests->profile\_magic\_get\_user\_field\_value( $uid, 'pm\_cover\_image' ); |
| [759](#L759) | ?> |
| [760](#L760) | <table class="form-table"> |
| [761](#L761) | <tbody> |
| [762](#L762) | <tr> |
| [763](#L763) |  |
| [764](#L764) | <th class="pm-field-lable"> |
| [765](#L765) | <label for="pm\_field\_37"><?php esc\_html\_e( 'Profile Picture', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [766](#L766) | </th> |
| [767](#L767) | <td class="pm-field-input"> |
| [768](#L768) | <input id="pm\_user\_avatar" type="hidden" name="pm\_user\_avatar" class="icon\_id" value="<?php |
| [769](#L769) | if ( isset( $profile\_pic ) ) { |
| [770](#L770) | echo esc\_attr( $profile\_pic );} |
| [771](#L771) | ?>" /> |
| [772](#L772) | <input id="field\_icon\_button" name="field\_icon\_button" class="button group\_icon\_button" type="button" value="<?php esc\_attr\_e( 'Upload Image', 'profilegrid-user-profiles-groups-and-communities' ); ?>" /> |
| [773](#L773) | <span class="pg\_profile\_image\_container" style=" |
| [774](#L774) | <?php |
| [775](#L775) | if ( ! is\_object( $user ) || $profile\_pic == false ) { |
| [776](#L776) | echo 'display: none;';} |
| [777](#L777) | ?> |
| [778](#L778) | "> |
| [779](#L779) | <?php |
| [780](#L780) | echo get\_avatar( |
| [781](#L781) | $user->user\_email, |
| [782](#L782) | 100, |
| [783](#L783) | '', |
| [784](#L784) | false, |
| [785](#L785) | array( |
| [786](#L786) | 'class'         => 'pm-user user-profile-image', |
| [787](#L787) | 'id'            => 'pg\_upload\_image\_preview', |
| [788](#L788) | 'force\_display' => true, |
| [789](#L789) | ) |
| [790](#L790) | ); |
| [791](#L791) | ?> |
| [792](#L792) | <input type="button" name="pg\_remove\_image" id="pg\_remove\_image" class="button" value="<?php esc\_attr\_e( 'Remove', 'profilegrid-user-profiles-groups-and-communities' ); ?>" onclick="pg\_remove\_profile\_image()"/> |
| [793](#L793) | </span> |
| [794](#L794) | <p class="description"><?php echo wp\_kses\_post( $message ); ?></p> |
| [795](#L795) | <div class="errortext" style="display:none;"></div> |
| [796](#L796) | </td> |
| [797](#L797) | </tr> |
| [798](#L798) |  |
| [799](#L799) | <tr> |
| [800](#L800) |  |
| [801](#L801) | <th class="pm-field-lable"> |
| [802](#L802) | <label for="pm\_field\_37"><?php esc\_html\_e( 'Cover Image', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [803](#L803) | </th> |
| [804](#L804) | <td class="pm-field-input"> |
| [805](#L805) | <input id="pm\_cover\_image" type="hidden" name="pm\_cover\_image" class="cover\_icon\_id" value="<?php |
| [806](#L806) | if ( isset( $cover\_image ) ) { |
| [807](#L807) | echo esc\_attr( $cover\_image );} |
| [808](#L808) | ?>" /> |
| [809](#L809) | <input id="cover\_image\_button" name="cover\_image\_button" class="button cover\_image\_button" type="button" value="<?php esc\_attr\_e( 'Upload Image', 'profilegrid-user-profiles-groups-and-communities' ); ?>" /> |
| [810](#L810) | <span class="pg\_cover\_image\_container" style=" |
| [811](#L811) | <?php |
| [812](#L812) | if ( ! is\_object( $user ) || $cover\_image == false ) { |
| [813](#L813) | echo 'display: none;';} |
| [814](#L814) | ?> |
| [815](#L815) | "> |
| [816](#L816) | <?php |
| [817](#L817) | $src = wp\_get\_attachment\_image\_src( $cover\_image, array( 100, 100 ) ); |
| [818](#L818) |  |
| [819](#L819) | ?> |
| [820](#L820) | <img src=" |
| [821](#L821) | <?php |
| [822](#L822) | if ( isset( $src['0'] ) ) { |
| [823](#L823) | echo esc\_url( $src['0'] );} |
| [824](#L824) | ?> |
| [825](#L825) | " width="100" height="100" class="pm-user" id="pg\_upload\_cover\_image\_preview" /> |
| [826](#L826) | <input type="button" name="pg\_remove\_cover\_image" id="pg\_remove\_cover\_image" class="button" value="<?php esc\_attr\_e( 'Remove', 'profilegrid-user-profiles-groups-and-communities' ); ?>" onclick="pm\_remove\_cover\_image()"/> |
| [827](#L827) | </span> |
| [828](#L828) | <p class="description"><?php echo wp\_kses\_post( $message2 ); ?></p> |
| [829](#L829) | <div class="errortext" style="display:none;"></div> |
| [830](#L830) | </td> |
| [831](#L831) | </tr> |
| [832](#L832) | <?php |
| [833](#L833) | $pm\_show\_privacy\_settings = $dbhandler->get\_global\_option\_value( 'pm\_show\_privacy\_settings', '' ); |
| [834](#L834) | if ( $pm\_show\_privacy\_settings == 1 ) { |
| [835](#L835) | ?> |
| [836](#L836) | <tr> |
| [837](#L837) | <th class="pm-field-lable"> |
| [838](#L838) | <label for="pm\_profile\_privacy"><?php esc\_html\_e( 'Profile Privacy', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [839](#L839) | </th> |
| [840](#L840) | <td class="pm-field-input"> |
| [841](#L841) | <select name="pm\_profile\_privacy" id="pm\_profile\_privacy"> |
| [842](#L842) | <option value="1" <?php selected( $pm\_profile\_privacy, '1' ); ?>><?php esc\_html\_e( 'Everyone', 'profilegrid-user-profiles-groups-and-communities' ); ?></option> |
| [843](#L843) | <option value="2" <?php selected( $pm\_profile\_privacy, '2' ); ?>><?php esc\_html\_e( 'Friends', 'profilegrid-user-profiles-groups-and-communities' ); ?></option> |
| [844](#L844) | <option value="3" <?php selected( $pm\_profile\_privacy, '3' ); ?>><?php esc\_html\_e( 'Group Members', 'profilegrid-user-profiles-groups-and-communities' ); ?></option> |
| [845](#L845) | <option value="4" <?php selected( $pm\_profile\_privacy, '4' ); ?>><?php esc\_html\_e( 'Friends &amp; Group Members', 'profilegrid-user-profiles-groups-and-communities' ); ?></option> |
| [846](#L846) | <option value="5" <?php selected( $pm\_profile\_privacy, '5' ); ?>><?php esc\_html\_e( 'Only Me', 'profilegrid-user-profiles-groups-and-communities' ); ?></option> |
| [847](#L847) | </select> |
| [848](#L848) | </td> |
| [849](#L849) | </tr> |
| [850](#L850) | <?php } ?> |
| [851](#L851) |  |
| [852](#L852) | <?php |
| [853](#L853) | $allowhiddenusers = $dbhandler->get\_global\_option\_value( 'pm\_allow\_user\_to\_hide\_their\_profile', '' ); |
| [854](#L854) | if ( $allowhiddenusers == 1 ) { |
| [855](#L855) | ?> |
| [856](#L856) | <tr> |
| [857](#L857) | <th class="pm-field-lable"> |
| [858](#L858) | <label for="pm\_hide\_my\_profile"><?php esc\_html\_e( 'Hide My Profile From Groups, Directories and Search Results', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [859](#L859) | </th> |
| [860](#L860) | <td class="pm-field-input"> |
| [861](#L861) | <div class="pmradio"> |
| [862](#L862) | <div class="pm-radio-option"> |
| [863](#L863) | <input type="radio" class="pg-hide-privacy-profile" name="pm\_hide\_my\_profile" value="0" <?php checked( $pm\_hide\_my\_profile, '0' ); ?>> |
| [864](#L864) | <label class="pg-hide-my-profile"><?php esc\_html\_e( 'No', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [865](#L865) | </div> |
| [866](#L866) | <div class="pm-radio-option"> |
| [867](#L867) | <input type="radio" class="pg-hide-privacy-profile" name="pm\_hide\_my\_profile" value="1" <?php checked( $pm\_hide\_my\_profile, '1' ); ?> > |
| [868](#L868) | <label class="pg-hide-my-profile"><?php esc\_html\_e( 'Yes', 'profilegrid-user-profiles-groups-and-communities' ); ?> </label> |
| [869](#L869) | </div> |
| [870](#L870) |  |
| [871](#L871) | </div> |
| [872](#L872) | </td> |
| [873](#L873) | </tr> |
| [874](#L874) |  |
| [875](#L875) | <?php } ?> |
| [876](#L876) |  |
| [877](#L877) | </tbody> |
| [878](#L878) | </table> |
| [879](#L879) | <?php if ( current\_user\_can( 'manage\_options' ) ) : ?> |
| [880](#L880) | <table class="form-table"> |
| [881](#L881) | <tr> |
| [882](#L882) |  |
| [883](#L883) | <th class="pm-field-lable"> |
| [884](#L884) | <label for="pm\_field\_37"><?php esc\_html\_e( 'User Group(s)', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [885](#L885) | </th> |
| [886](#L886) | <td class="pm-field-input"> |
| [887](#L887) | <select multiple name="pm\_group[]" id="pm\_group"> |
| [888](#L888) | <?php |
| [889](#L889) | foreach ( $groups as $group ) { |
| [890](#L890) | ?> |
| [891](#L891) | <option value="<?php echo esc\_attr( $group->id ); ?>" |
| [892](#L892) | <?php |
| [893](#L893) | if ( ! empty( $gid ) ) { |
| [894](#L894) | if ( in\_array( $group->id, $gid ) ) { |
| [895](#L895) | echo 'selected';} |
| [896](#L896) | } |
| [897](#L897) | ?> |
| [898](#L898) | ><?php echo esc\_html( $group->group\_name ); ?></option> |
| [899](#L899) | <?php } ?> |
| [900](#L900) | </select> |
| [901](#L901) | <p class="description"><?php esc\_html\_e( 'Press ctrl or ⌘ (in Mac) while clicking to assign multiple ProfileGrid Groups', 'profilegrid-user-profiles-groups-and-communities' ); ?></p> |
| [902](#L902) | <div class="errortext" style="display:none;"></div> |
| [903](#L903) | </td> |
| [904](#L904) | </tr> |
| [905](#L905) | </table> |
| [906](#L906) |  |
| [907](#L907) | <?php |
| [908](#L908) | endif; |
| [909](#L909) | if ( isset( $fields ) && ! empty( $fields ) ) : |
| [910](#L910) | if ( $lastRec = count( $fields ) && ! empty( $gid ) ) { |
| [911](#L911) | echo '<div class="pm\_dashboard\_custom\_fields">'; |
| [912](#L912) | $i = 0; |
| [913](#L913) | foreach ( $fields as $field ) { |
| [914](#L914) | $value = $pmrequests->profile\_magic\_get\_user\_field\_value( $user->ID, $field->field\_key ); |
| [915](#L915) | $pm\_customfields->pm\_get\_custom\_form\_fields( $field, $value, $this->profile\_magic ); |
| [916](#L916) | $i++; |
| [917](#L917) | } |
| [918](#L918) | echo '</div>'; |
| [919](#L919) | } |
| [920](#L920) | endif; |
| [921](#L921) | if ( is\_object( $user ) ) { |
| [922](#L922) | echo '<input type="hidden" id="pg\_user\_id" name="pg\_user\_id" value="' . esc\_attr( $user->ID ) . '" />'; |
| [923](#L923) | } |
| [924](#L924) | wp\_nonce\_field( 'pg\_user\_profile', 'pg\_user\_profile\_nonce' ); |
| [925](#L925) | echo '<div class="all\_errors" style="display:none;"></div>'; |
| [926](#L926) |  |
| [927](#L927) | } |
| [928](#L928) |  |
| [929](#L929) | public function profile\_magic\_update\_user\_fields( $user\_id ) { |
| [930](#L930) | $pm\_sanitizer = new PM\_sanitizer(); |
| [931](#L931) | $nonce        = filter\_input( INPUT\_POST, 'pg\_user\_profile\_nonce' ); |
| [932](#L932) | if ( isset( $nonce ) && wp\_verify\_nonce( $nonce, 'pg\_user\_profile' ) ) { |
| [933](#L933) |  |
| [934](#L934) | $post      = $pm\_sanitizer->sanitize( $\_POST ); |
| [935](#L935) | $dbhandler = new PM\_DBhandler(); |
| [936](#L936) | $pmrequests            = new PM\_request(); |
| [937](#L937) | $pm\_emails             = new PM\_Emails(); |
| [938](#L938) | $notification          = new Profile\_Magic\_Notification(); |
| [939](#L939) | $current\_user          = wp\_get\_current\_user(); |
| [940](#L940) | if ( ! current\_user\_can( 'edit\_user', $user\_id ) ) { |
| [941](#L941) | return false; |
| [942](#L942) | } |
| [943](#L943) | if ( ! isset( $post['reg\_form\_submit'] ) ) { |
| [944](#L944) | if ( isset( $post['pm\_user\_avatar'] ) ) { |
| [945](#L945) | $pm\_user\_avatar = $post['pm\_user\_avatar']; |
| [946](#L946) | } else { |
| [947](#L947) | $pm\_user\_avatar = ''; |
| [948](#L948) | } |
| [949](#L949) | $is\_update\_profile\_image = update\_user\_meta( $user\_id, 'pm\_user\_avatar', $pm\_user\_avatar ); |
| [950](#L950) | if ( $is\_update\_profile\_image ) { |
| [951](#L951) | if ( $pm\_user\_avatar == '' ) { |
| [952](#L952) | do\_action( 'pm\_remove\_profile\_image', $user\_id ); |
| [953](#L953) | } else { |
| [954](#L954) | do\_action( 'pm\_update\_profile\_image', $user\_id ); |
| [955](#L955) | } |
| [956](#L956) | } |
| [957](#L957) | if ( isset( $post['pm\_cover\_image'] ) ) { |
| [958](#L958) | $pm\_cover\_image = $post['pm\_cover\_image']; |
| [959](#L959) | } else { |
| [960](#L960) | $pm\_cover\_image = ''; |
| [961](#L961) | } |
| [962](#L962) | $is\_update\_cover\_image = update\_user\_meta( $user\_id, 'pm\_cover\_image', $pm\_cover\_image ); |
| [963](#L963) |  |
| [964](#L964) | if ( $is\_update\_cover\_image ) { |
| [965](#L965) | if ( $pm\_cover\_image == '' ) { |
| [966](#L966) | do\_action( 'pm\_remove\_cover\_image', $user\_id ); |
| [967](#L967) | } else { |
| [968](#L968) | do\_action( 'pm\_update\_cover\_image', $user\_id ); |
| [969](#L969) | } |
| [970](#L970) | } |
| [971](#L971) |  |
| [972](#L972) | $allowhiddenusers = $dbhandler->get\_global\_option\_value( 'pm\_allow\_user\_to\_hide\_their\_profile', '' ); |
| [973](#L973) | if ( $allowhiddenusers == 1 ) { |
| [974](#L974) | update\_user\_meta( $user\_id, 'pm\_hide\_my\_profile', $post['pm\_hide\_my\_profile'] ); |
| [975](#L975) | } |
| [976](#L976) |  |
| [977](#L977) | $pm\_show\_privacy\_settings = $dbhandler->get\_global\_option\_value( 'pm\_show\_privacy\_settings', '' ); |
| [978](#L978) | if ( $pm\_show\_privacy\_settings == 1 ) { |
| [979](#L979) | update\_user\_meta( $user\_id, 'pm\_profile\_privacy', $post['pm\_profile\_privacy'] ); |
| [980](#L980) | } |
| [981](#L981) | $gids = $pmrequests->profile\_magic\_get\_user\_field\_value( $user\_id, 'pm\_group' ); |
| [982](#L982) | $gid  = $pmrequests->pg\_filter\_users\_group\_ids( $gids ); |
| [983](#L983) | if ( ! empty( $gid ) ) { |
| [984](#L984) | $exclude = 'associate\_group in(' . implode( ',', $gid ) . ") and field\_type not in('first\_name','last\_name','user\_name','user\_email','user\_url','user\_pass','confirm\_pass','description','user\_avatar','heading','paragraph')"; |
| [985](#L985) | $fields  = $dbhandler->get\_all\_result( 'FIELDS', '\*', 1, 'results', 0, false, 'ordering', false, $exclude ); |
| [986](#L986) | } else { |
| [987](#L987) | $fields = array(); |
| [988](#L988) | } |
| [989](#L989) | $pmrequests->pm\_update\_user\_custom\_fields\_data( $\_POST, $\_FILES, $\_SERVER, $gid, $fields, $user\_id ); |
| [990](#L990) | if ( isset( $post['pm\_group'] ) ) { |
| [991](#L991) | $pm\_group = $post['pm\_group']; |
| [992](#L992) | } |
| [993](#L993) | if ( ! isset( $pm\_group ) ) { |
| [994](#L994) | $pm\_group = array(); |
| [995](#L995) | } |
| [996](#L996) |  |
| [997](#L997) | add\_user\_meta( $user\_id, 'rm\_user\_status', 0, true ); |
| [998](#L998) |  |
| [999](#L999) | if ( current\_user\_can( 'manage\_options' ) ) { |
| [1000](#L1000) |  |
| [1001](#L1001) | $new\_groups = array\_diff( $pm\_group, $gid ); |
| [1002](#L1002) | $old\_groups = array\_diff( $gid, $pm\_group ); |
| [1003](#L1003) |  |
| [1004](#L1004) | if(!empty($new\_groups)) |
| [1005](#L1005) | { |
| [1006](#L1006) | foreach ( $new\_groups as $nl\_gid ) { |
| [1007](#L1007) | $is\_group\_limit = $dbhandler->get\_value('GROUPS','is\_group\_limit',$nl\_gid); |
| [1008](#L1008) | if($is\_group\_limit==1) |
| [1009](#L1009) | { |
| [1010](#L1010) | $meta\_query\_array = $pmrequests->pm\_get\_user\_meta\_query(array('gid'=>$nl\_gid)); |
| [1011](#L1011) | $user\_query = $dbhandler->pm\_get\_all\_users\_ajax('',$meta\_query\_array); |
| [1012](#L1012) | $total\_users\_in\_group = $user\_query->get\_total(); |
| [1013](#L1013) | $limit = $dbhandler->get\_value('GROUPS','group\_limit',$nl\_gid); |
| [1014](#L1014) |  |
| [1015](#L1015) | if($limit <= $total\_users\_in\_group) |
| [1016](#L1016) | { |
| [1017](#L1017) | $id = array\_search($nl\_gid, $pm\_group); |
| [1018](#L1018) | unset($pm\_group[$id]); |
| [1019](#L1019) | } |
| [1020](#L1020) | } |
| [1021](#L1021) |  |
| [1022](#L1022) | } |
| [1023](#L1023) | } |
| [1024](#L1024) |  |
| [1025](#L1025) | update\_user\_meta( $user\_id, 'pm\_group', $pm\_group ); |
| [1026](#L1026) | foreach ( $old\_groups as $o\_id ) { |
| [1027](#L1027) | $notification->pm\_removed\_old\_group\_notification( $user\_id, $o\_id ); |
| [1028](#L1028) | if ( $current\_user->ID != $user\_id ) { |
| [1029](#L1029) | $pm\_emails->pm\_send\_group\_based\_notification( $o\_id, $user\_id, 'on\_membership\_terminate' ); |
| [1030](#L1030) | } |
| [1031](#L1031) | } |
| [1032](#L1032) |  |
| [1033](#L1033) | foreach ( $new\_groups as $n\_gid ) { |
| [1034](#L1034) | $notification->pm\_joined\_new\_group\_notification( $user\_id, $n\_gid ); |
| [1035](#L1035) | do\_action( 'profile\_magic\_join\_group\_additional\_process', $n\_gid, $user\_id ); |
| [1036](#L1036) | } |
| [1037](#L1037) | } |
| [1038](#L1038) | } |
| [1039](#L1039) | } |
| [1040](#L1040) | elseif ( ! isset( $post['reg\_form\_submit'] ) ) |
| [1041](#L1041) | { |
| [1042](#L1042) | update\_user\_meta( $user\_id, 'rm\_user\_status', '0' ); |
| [1043](#L1043) | } |
| [1044](#L1044) | } |
| [1045](#L1045) |  |
| [1046](#L1046) | public function profile\_magic\_activate\_user\_by\_email() { |
| [1047](#L1047) | $pmemails           = new PM\_Emails(); |
| [1048](#L1048) | $req                = filter\_input( INPUT\_GET, 'user', FILTER\_SANITIZE\_STRING ); |
| [1049](#L1049) | $pmrequests         = new PM\_request(); |
| [1050](#L1050) | $req\_deco           = $pmrequests->pm\_encrypt\_decrypt\_pass( 'decrypt', $req ); |
| [1051](#L1051) | $user\_data          = json\_decode( $req\_deco ); |
| [1052](#L1052) | $redirect\_url       = $pmrequests->profile\_magic\_get\_frontend\_url( 'pm\_user\_login\_page', site\_url( '/wp-login.php' ) ); |
| [1053](#L1053) | $nonce\_name = 'user\_activation\_link\_' . $user\_data->user\_id; |
| [1054](#L1054) | $nonce      = filter\_input( INPUT\_GET, '\_wpnonce' ); |
| [1055](#L1055) |  |
| [1056](#L1056) | if ( wp\_verify\_nonce( $nonce, $nonce\_name ) && $user\_data->activation\_code === get\_user\_meta( $user\_data->user\_id, 'pm\_activation\_code', true ) ) { |
| [1057](#L1057) | $gids          = get\_user\_meta( $user\_data->user\_id, 'pm\_group', true ); |
| [1058](#L1058) | $gid           = $pmrequests->pg\_filter\_users\_group\_ids( $gids ); |
| [1059](#L1059) | $primary\_group = $pmrequests->pg\_get\_primary\_group\_id( $gid ); |
| [1060](#L1060) | if ( ! empty( $gid ) ) { |
| [1061](#L1061) | $pmemails->pm\_send\_group\_based\_notification( $primary\_group, $user\_data->user\_id, 'on\_user\_activate' ); |
| [1062](#L1062) | } |
| [1063](#L1063) | update\_user\_meta( $user\_data->user\_id, 'rm\_user\_status', 0 ); |
| [1064](#L1064) | if ( ! delete\_user\_meta( $user\_data->user\_id, 'pm\_activation\_code' ) ) { |
| [1065](#L1065) | $redirect\_url = add\_query\_arg( 'errors', 'ajx\_failed\_del', $redirect\_url ); |
| [1066](#L1066) | } else { |
| [1067](#L1067) | $message      = \_\_( 'You have successfully activated the user.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [1068](#L1068) | $redirect\_url = add\_query\_arg( 'activated', 'success', $redirect\_url ); |
| [1069](#L1069) | } |
| [1070](#L1070) | } else { |
| [1071](#L1071) | $message      = \_\_( 'Failed to update user information. Can not activate user', 'profilegrid-user-profiles-groups-and-communities' ); |
| [1072](#L1072) | $redirect\_url = add\_query\_arg( 'errors', 'invalid\_code', $redirect\_url ); |
| [1073](#L1073) | } |
| [1074](#L1074) | wp\_safe\_redirect( esc\_url\_raw( $redirect\_url ) ); |
| [1075](#L1075) | exit; |
| [1076](#L1076) | die; |
| [1077](#L1077) | } |
| [1078](#L1078) |  |
| [1079](#L1079) | public function pm\_load\_export\_fields\_dropdown() { |
| [1080](#L1080) | include 'partials/export-fields.php'; |
| [1081](#L1081) | die; |
| [1082](#L1082) | } |
| [1083](#L1083) |  |
| [1084](#L1084) | public function pm\_upload\_csv() { |
| [1085](#L1085) |  |
| [1086](#L1086) | if ( current\_user\_can( 'manage\_options' ) ) { |
| [1087](#L1087) | include 'partials/pm-import-ajax.php'; |
| [1088](#L1088) | } |
| [1089](#L1089) | die; |
| [1090](#L1090) | } |
| [1091](#L1091) |  |
| [1092](#L1092) | public function pg\_custom\_upload\_mimes( $mimes = array() ) { |
| [1093](#L1093) | $mimes['json'] = 'text/plain'; |
| [1094](#L1094) | return $mimes; |
| [1095](#L1095) | } |
| [1096](#L1096) | public function pm\_upload\_json() { |
| [1097](#L1097) | $retrieved\_nonce = filter\_input( INPUT\_POST, '\_wpnonce' ); |
| [1098](#L1098) | if ( ! wp\_verify\_nonce( $retrieved\_nonce, 'pm\_import\_options' ) ) { |
| [1099](#L1099) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [1100](#L1100) | } |
| [1101](#L1101) |  |
| [1102](#L1102) | $dbhandler      = new PM\_DBhandler(); |
| [1103](#L1103) | $pmrequests     = new PM\_request(); |
| [1104](#L1104) | $current\_user   = wp\_get\_current\_user(); |
| [1105](#L1105) | $pmexportimport = new PM\_Export\_Import(); |
| [1106](#L1106) | $post           = isset( $\_POST ) ? $\_POST : array(); |
| [1107](#L1107) |  |
| [1108](#L1108) | $allowed\_ext = 'json'; |
| [1109](#L1109) | if ( isset( $\_FILES['uploadjson'] ) && ! empty( $\_FILES['uploadjson'] ) ) { |
| [1110](#L1110) | $filefield = $\_FILES['uploadjson']; |
| [1111](#L1111) | $attachment\_id     = $pmrequests->make\_upload\_and\_get\_attached\_id( $filefield, $allowed\_ext ); |
| [1112](#L1112) | if ( ! is\_numeric( $attachment\_id ) ) { |
| [1113](#L1113) | add\_filter( 'upload\_mimes', array( $this, 'pg\_custom\_upload\_mimes' ) ); |
| [1114](#L1114) | $attachment\_id = $pmrequests->make\_upload\_and\_get\_attached\_id( $filefield, $allowed\_ext ); |
| [1115](#L1115) | } |
| [1116](#L1116) | if ( is\_numeric( $attachment\_id ) ) { |
| [1117](#L1117) | $filepath                    = wp\_get\_attachment\_url( $attachment\_id ); |
| [1118](#L1118) | $content                     = wp\_remote\_get( $filepath ); |
| [1119](#L1119) | $filecontent = $content['body']; |
| [1120](#L1120) | $options\_data                = json\_decode( $filecontent ); |
| [1121](#L1121) | foreach ( $options\_data as $data ) { |
| [1122](#L1122) | if ( is\_object( $data ) ) { |
| [1123](#L1123) | $dbhandler->update\_global\_option\_value( $data->option\_name, $data->option\_value ); |
| [1124](#L1124) | } elseif ( is\_array( $data ) ) { |
| [1125](#L1125) | $dbhandler->update\_global\_option\_value( $data[0], $data[1] ); |
| [1126](#L1126) | } |
| [1127](#L1127) | } |
| [1128](#L1128) | echo '<div class="uimrow">' . esc\_html\_\_( 'Your configuration file was successfully imported and included settings have been applied.', 'profilegrid-user-profiles-groups-and-communities' ) . '</div>'; |
| [1129](#L1129) |  |
| [1130](#L1130) | } else { |
| [1131](#L1131) | echo '<div class="uimrow" style="color:red;">' . esc\_html( $attachment\_id ) . '</div>'; |
| [1132](#L1132) | } |
| [1133](#L1133) | } else { |
| [1134](#L1134) | echo '<div class="uimrow" style="color:red;">' . esc\_html\_\_( 'Select a JSON file earlier exported from ProfileGrid.', 'profilegrid-user-profiles-groups-and-communities' ) . '</div>'; |
| [1135](#L1135) | } |
| [1136](#L1136) |  |
| [1137](#L1137) | die; |
| [1138](#L1138) | } |
| [1139](#L1139) |  |
| [1140](#L1140) | public function profile\_grid\_myme\_types( $mime\_types ) { |
| [1141](#L1141) | $mime\_types['csv']  = 'text/csv'; |
| [1142](#L1142) | $mime\_types['json'] = 'application/json'; |
| [1143](#L1143) | return $mime\_types; |
| [1144](#L1144) | } |
| [1145](#L1145) |  |
| [1146](#L1146) | public function profile\_magic\_show\_feedback\_form() { |
| [1147](#L1147) | $currentScreen = get\_current\_screen(); |
| [1148](#L1148) | if ( $currentScreen->id == 'plugins' ) { |
| [1149](#L1149) | $path = plugin\_dir\_url( \_\_FILE\_\_ ); |
| [1150](#L1150) | ?> |
| [1151](#L1151) | <div class="pmagic uimagic"> |
| [1152](#L1152) | <div id="pg-deactivate-feedback-dialog-wrapper" class="pg-modal-view" style="display: none"> |
| [1153](#L1153) | <div class="pg-modal-overlay" style="display: none"></div> |
| [1154](#L1154) |  |
| [1155](#L1155) | <div class="pg-modal-wrap pg-deactivate-feedback"> |
| [1156](#L1156) | <div class="pg-modal-titlebar"> |
| [1157](#L1157) | <div class="pg-modal-title"><?php esc\_html\_e( 'ProfileGrid Feedback', 'profilegrid-user-profiles-groups-and-communities' ); ?> </div> |
| [1158](#L1158) | <div class="pg-modal-close">&times;</div> |
| [1159](#L1159) | </div> |
| [1160](#L1160) |  |
| [1161](#L1161) | <form id="pg-deactivate-feedback-dialog-form" method="post"> |
| [1162](#L1162) | <input type="hidden" name="action" value="pg\_deactivate\_feedback" /> |
| [1163](#L1163) | <div class="pg-modal-container"> |
| [1164](#L1164) | <div class="uimrow"> |
| [1165](#L1165) | <div id="pg-deactivate-feedback-dialog-form-caption"><?php esc\_html\_e( 'If you have a moment, please share why you are deactivating ProfileGrid:', 'profilegrid-user-profiles-groups-and-communities' ); ?></div> |
| [1166](#L1166) | <div id="pg-deactivate-feedback-dialog-form-body"> |
| [1167](#L1167) | <div class="pg-deactivate-feedback-dialog-input-wrapper"> |
| [1168](#L1168) | <input id="pg-deactivate-feedback-feature\_not\_available" class="pg-deactivate-feedback-dialog-input" type="radio" name="pg\_feedback\_key" value="feature\_not\_available"> |
| [1169](#L1169) | <label for="pg-deactivate-feedback-feature\_not\_available" class="pg-deactivate-feedback-dialog-label"><span class="pg-feedback-emoji">&#x1f61e;</span><?php esc\_html\_e( "Doesn't have the feature I need", 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [1170](#L1170) | <div class="pginput" id="pg\_reason\_feature\_not\_available" style="display:none"><input class="pg-feedback-text" type="text" name="pg\_reason\_feature\_not\_available" placeholder="<?php esc\_attr\_e( 'Please let us know the missing feature...', 'profilegrid-user-profiles-groups-and-communities' ); ?>"></div> |
| [1171](#L1171) | </div> |
| [1172](#L1172) | <div class="pg-deactivate-feedback-dialog-input-wrapper"> |
| [1173](#L1173) | <input id="pg-deactivate-feedback-feature\_not\_working" class="pg-deactivate-feedback-dialog-input" type="radio" name="pg\_feedback\_key" value="feature\_not\_working" > |
| [1174](#L1174) | <label for="pg-deactivate-feedback-feature\_not\_working" class="pg-deactivate-feedback-dialog-label"><span class="pg-feedback-emoji">&#x1f615;</span><?php esc\_html\_e( "One of the features didn't worked", 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [1175](#L1175) | <div class="pginput" id="pg\_reason\_feature\_not\_working" style="display:none"><input class="pg-feedback-text" type="text" name="pg\_reason\_feature\_not\_working" placeholder="<?php esc\_attr\_e( "Please let us know the feature, like 'emails notifications'", 'profilegrid-user-profiles-groups-and-communities' ); ?>"></div> |
| [1176](#L1176) | </div> |
| [1177](#L1177) | <div class="pg-deactivate-feedback-dialog-input-wrapper"> |
| [1178](#L1178) | <input id="pg-deactivate-feedback-found\_a\_better\_plugin" class="pg-deactivate-feedback-dialog-input" type="radio" name="pg\_feedback\_key" value="found\_a\_better\_plugin" > |
| [1179](#L1179) | <label for="pg-deactivate-feedback-found\_a\_better\_plugin" class="pg-deactivate-feedback-dialog-label"><span class="pg-feedback-emoji">&#x1f60a;</span><?php esc\_html\_e( 'Moved to a different plugin', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [1180](#L1180) | <div class="pginput" id="pg\_reason\_found\_a\_better\_plugin" style="display:none"><input class="pg-feedback-text" type="text" name="pg\_reason\_found\_a\_better\_plugin" placeholder="<?php esc\_attr\_e( "Could you please share the plugin's name", 'profilegrid-user-profiles-groups-and-communities' ); ?>"></div> |
| [1181](#L1181) | </div> |
| [1182](#L1182) | <div class="pg-deactivate-feedback-dialog-input-wrapper"> |
| [1183](#L1183) | <input id="pg-deactivate-feedback-plugin\_broke\_site" class="pg-deactivate-feedback-dialog-input" type="radio" name="pg\_feedback\_key" value="plugin\_broke\_site"> |
| [1184](#L1184) | <label for="pg-deactivate-feedback-plugin\_broke\_site" class="pg-deactivate-feedback-dialog-label"><span class="pg-feedback-emoji">&#x1f621;</span><?php esc\_html\_e( 'The plugin broke my site', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [1185](#L1185) | </div> |
| [1186](#L1186) | <div class="pg-deactivate-feedback-dialog-input-wrapper"> |
| [1187](#L1187) | <input id="pg-deactivate-feedback-plugin\_stopped\_working" class="pg-deactivate-feedback-dialog-input" type="radio" name="pg\_feedback\_key" value="plugin\_stopped\_working"> |
| [1188](#L1188) | <label for="pg-deactivate-feedback-plugin\_stopped\_working" class="pg-deactivate-feedback-dialog-label"><span class="pg-feedback-emoji">&#x1f620;</span><?php esc\_html\_e( 'The plugin suddenly stopped working', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [1189](#L1189) | </div> |
| [1190](#L1190) | <div class="pg-deactivate-feedback-dialog-input-wrapper"> |
| [1191](#L1191) | <input id="pg-deactivate-feedback-temporary\_deactivation" class="pg-deactivate-feedback-dialog-input" type="radio" name="pg\_feedback\_key" value="temporary\_deactivation"> |
| [1192](#L1192) | <label for="pg-deactivate-feedback-temporary\_deactivation" class="pg-deactivate-feedback-dialog-label"><span class="pg-feedback-emoji">&#x1f60a;</span><?php esc\_html\_e( "It's a temporary deactivation", 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [1193](#L1193) | </div> |
| [1194](#L1194) |  |
| [1195](#L1195) | <div class="pg-deactivate-feedback-dialog-input-wrapper"> |
| [1196](#L1196) | <input id="pg-deactivate-feedback-other" class="pg-deactivate-feedback-dialog-input" type="radio" name="pg\_feedback\_key" value="other"> |
| [1197](#L1197) | <label for="pg-deactivate-feedback-other" class="pg-deactivate-feedback-dialog-label"><span class="pg-feedback-emoji">&#x1f610;</span><?php esc\_html\_e( 'Other', 'profilegrid-user-profiles-groups-and-communities' ); ?></label> |
| [1198](#L1198) | <div class="pginput" id="pg\_reason\_other"  style="display:none"><input class="pg-feedback-text" type="text" name="pg\_reason\_other" placeholder="<?php esc\_attr\_e( 'Please share the reason', 'profilegrid-user-profiles-groups-and-communities' ); ?>"></div> |
| [1199](#L1199) | </div> |
| [1200](#L1200) | </div> |
| [1201](#L1201) |  |
| [1202](#L1202) | </div> |
| [1203](#L1203) | </div> |
| [1204](#L1204) |  |
| [1205](#L1205) | <div class="pg-ajax-loader" style="display:none"> |
| [1206](#L1206) | <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i> |
| [1207](#L1207) | <span class=""><?php esc\_html\_e( 'Loading...', 'profilegrid-user-profiles-groups-and-communities' ); ?></span> |
| [1208](#L1208) | </div> |
| [1209](#L1209) |  |
| [1210](#L1210) | <div class="pg-modal-footer uimrow"> |
| [1211](#L1211) | <input type="button" id="pg-feedback-btn" value="<?php esc\_attr\_e( 'Submit & Deactivate', 'profilegrid-user-profiles-groups-and-communities' ); ?>"/> |
| [1212](#L1212) | <input type="button" id="pg-feedback-cancel-btn" value="<?php esc\_attr\_e( 'Cancel', 'profilegrid-user-profiles-groups-and-communities' ); ?>"/> |
| [1213](#L1213) | </div> |
| [1214](#L1214) | <?php wp\_nonce\_field( 'pm\_feedback\_form' ); ?> |
| [1215](#L1215) |  |
| [1216](#L1216) | </form> |
| [1217](#L1217) | </div> |
| [1218](#L1218) |  |
| [1219](#L1219) |  |
| [1220](#L1220) | </div> |
| [1221](#L1221) | </div> |
| [1222](#L1222) | <?php |
| [1223](#L1223) | } |
| [1224](#L1224) | } |
| [1225](#L1225) |  |
| [1226](#L1226) | public function pg\_post\_feedback() { |
| [1227](#L1227) | $retrieved\_nonce      = filter\_input( INPUT\_POST, '\_wpnonce' ); |
| [1228](#L1228) | $msg      = filter\_input( INPUT\_POST, 'msg' ); |
| [1229](#L1229) | $feedback = filter\_input( INPUT\_POST, 'feedback' ); |
| [1230](#L1230) | if ( ! wp\_verify\_nonce( $retrieved\_nonce, 'pm\_feedback\_form' ) ) { |
| [1231](#L1231) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [1232](#L1232) | } |
| [1233](#L1233) |  |
| [1234](#L1234) | if ( isset( $msg ) ) { |
| [1235](#L1235) | $msg = sanitize\_text\_field( $msg ); |
| [1236](#L1236) | } else { |
| [1237](#L1237) | $msg = ''; |
| [1238](#L1238) | } |
| [1239](#L1239) | if ( isset( $feedback ) ) { |
| [1240](#L1240) | $feedback = sanitize\_text\_field( $feedback ); |
| [1241](#L1241) | } else { |
| [1242](#L1242) | $feedback = ''; |
| [1243](#L1243) | } |
| [1244](#L1244) | $message            = ''; |
| [1245](#L1245) | $pmrequests         = new PM\_request(); |
| [1246](#L1246) | $from\_email\_address = $pmrequests->profile\_magic\_get\_from\_email(); |
| [1247](#L1247) | switch ( $feedback ) { |
| [1248](#L1248) | case 'feature\_not\_available': |
| [1249](#L1249) | $body = 'Feature not available: '; |
| [1250](#L1250) | break; |
| [1251](#L1251) | case 'feature\_not\_working': |
| [1252](#L1252) | $body = 'Feature not working: '; |
| [1253](#L1253) | break; |
| [1254](#L1254) | case 'found\_a\_better\_plugin': |
| [1255](#L1255) | $body = 'Found a better plugin: '; |
| [1256](#L1256) | break; |
| [1257](#L1257) | case 'plugin\_broke\_site': |
| [1258](#L1258) | $body = 'Plugin broke my site.'; |
| [1259](#L1259) | break; |
| [1260](#L1260) | case 'plugin\_stopped\_working': |
| [1261](#L1261) | $body = 'Plugin stopped working'; |
| [1262](#L1262) | break; |
| [1263](#L1263) | case 'temporary\_deactivation': |
| [1264](#L1264) | $body = "It's a temporary deactivation"; |
| [1265](#L1265) | break; |
| [1266](#L1266) | case 'upgrade': |
| [1267](#L1267) | $body = 'Upgrading to premium '; |
| [1268](#L1268) | break; |
| [1269](#L1269) | case 'other': |
| [1270](#L1270) | $body = 'Other: '; |
| [1271](#L1271) | break; |
| [1272](#L1272) | default: |
| [1273](#L1273) | return; |
| [1274](#L1274) | } |
| [1275](#L1275) | if ( ! empty( $feedback ) ) { |
| [1276](#L1276) | $message .= $body . "\n\r"; |
| [1277](#L1277) | if ( ! empty( $msg ) ) { |
| [1278](#L1278) | $message .= $msg . "\n\r"; |
| [1279](#L1279) | } |
| [1280](#L1280) | $message .= "\n\r ProfileGrid Version - " . PROGRID\_PLUGIN\_VERSION; |
| [1281](#L1281) | $headers  = "MIME-Version: 1.0\r\n"; |
| [1282](#L1282) | $headers .= "Content-type:text/html;charset=UTF-8\r\n"; |
| [1283](#L1283) | $headers .= 'From:' . $from\_email\_address . "\r\n"; |
| [1284](#L1284) | wp\_mail( 'feedback@profilegrid.co', 'PG Feedback', $message, $headers ); |
| [1285](#L1285) | die; |
| [1286](#L1286) | } |
| [1287](#L1287) | } |
| [1288](#L1288) |  |
| [1289](#L1289) | public function pg\_frontend\_group\_short\_code() { |
| [1290](#L1290) | $pg\_function = new Profile\_Magic\_Basic\_Functions( $this->profile\_magic, $this->version ); |
| [1291](#L1291) | $link        = $pg\_function->pg\_get\_extension\_shortcode( 'FRONTEND\_GROUP' ); |
| [1292](#L1292) | $path        = plugin\_dir\_url( \_\_FILE\_\_ ); |
| [1293](#L1293) | $html        = ' |
| [1294](#L1294) | <div class="pg-scsubblock"> |
| [1295](#L1295) | <div class="pg-scblock pg-sctitle">' . \_\_( 'Group Creation Form', 'profilegrid-user-profiles-groups-and-communities' ) . '</div> |
| [1296](#L1296) | <div class="pg-scblock"><span class="pg-code">' . $link . '</span></div> |
| [1297](#L1297) | <div class="pg-scblock"><img class="pg-scimg" src="' . $path . 'partials/images/sc-12.png"></div> |
| [1298](#L1298) | <div class="pg-scblock pg-scdesc">' . \_\_( 'Allow registered users to create new Groups on front end. These Groups behave and work just like regular ProfileGrid groups.', 'profilegrid-user-profiles-groups-and-communities' ) . '</div> |
| [1299](#L1299) | </div>'; |
| [1300](#L1300) | $html        = apply\_filters( 'pg\_filter\_frontend\_group\_shortcode', $html ); |
| [1301](#L1301) | echo wp\_kses\_post( $html ); |
| [1302](#L1302) | } |
| [1303](#L1303) |  |
| [1304](#L1304) | public function pg\_geolocation\_short\_code() { |
| [1305](#L1305) | $pg\_function = new Profile\_Magic\_Basic\_Functions( $this->profile\_magic, $this->version ); |
| [1306](#L1306) | $link        = $pg\_function->pg\_get\_extension\_shortcode( 'GEOLOCATION' ); |
| [1307](#L1307) | $path        = plugin\_dir\_url( \_\_FILE\_\_ ); |
| [1308](#L1308) | $html        = ' |
| [1309](#L1309) | <div class="pg-scsubblock"> |
| [1310](#L1310) | <div class="pg-scblock pg-sctitle">' . \_\_( 'Generate User Map', 'profilegrid-user-profiles-groups-and-communities' ) . '</div> |
| [1311](#L1311) | <div class="pg-scblock"><span class="pg-code">' . $link . '</span></div> |
| [1312](#L1312) | <div class="pg-scblock"><img class="pg-scimg" src="' . $path . 'partials/images/sc-11.png"></div> |
| [1313](#L1313) | <div class="pg-scblock pg-scdesc">' . \_\_( 'Generate maps showing locations of all users or specific groups using simple shortcodes. Get location data from registration form.', 'profilegrid-user-profiles-groups-and-communities' ) . '</div> |
| [1314](#L1314) | </div>'; |
| [1315](#L1315) | $html        = apply\_filters( 'pg\_filter\_geolocation\_shortcode', $html ); |
| [1316](#L1316) | echo wp\_kses\_post( $html ); |
| [1317](#L1317) | } |
| [1318](#L1318) |  |
| [1319](#L1319) | public function pg\_groupwall\_short\_code() { |
| [1320](#L1320) | $pg\_function = new Profile\_Magic\_Basic\_Functions( $this->profile\_magic, $this->version ); |
| [1321](#L1321) | $link         = $pg\_function->pg\_get\_extension\_shortcode( 'GROUPWALL' ); |
| [1322](#L1322) | $path         = plugin\_dir\_url( \_\_FILE\_\_ ); |
| [1323](#L1323) | $html         = ' |
| [1324](#L1324) | <div class="pg-scsubblock"> |
| [1325](#L1325) | <div class="pg-scblock pg-sctitle">' . \_\_( 'Wall Post Submission Form', 'profilegrid-user-profiles-groups-and-communities' ) . '</div> |
| [1326](#L1326) | <div class="pg-scblock"><span class="pg-code">' . $link . '</span></div> |
| [1327](#L1327) | <div class="pg-scblock"><img class="pg-scimg" src="' . $path . 'partials/images/sc-13.jpg"></div> |
| [1328](#L1328) | <div class="pg-scblock pg-scdesc">' . \_\_( 'Allows group members to write and submit posts to their group wall. Users can also upload and attach images to their wall posts.', 'profilegrid-user-profiles-groups-and-communities' ) . '</div> |
| [1329](#L1329) | </div>'; |
| [1330](#L1330) | $html         = apply\_filters( 'pg\_filter\_groupwall\_shortcode', $html ); |
| [1331](#L1331) | echo wp\_kses\_post( $html ); |
| [1332](#L1332) | } |
| [1333](#L1333) |  |
| [1334](#L1334) | public function pg\_get\_footer\_banner() { |
| [1335](#L1335) | $pmrequests         = new PM\_request(); |
| [1336](#L1336) | $dbhandler    = new PM\_DBhandler(); |
| [1337](#L1337) | $notice\_name = $dbhandler->get\_global\_option\_value( 'pg\_dismissible\_customization\_banner', '0' ); |
| [1338](#L1338) | $activate\_extensions = $pmrequests->pg\_get\_activate\_extensions(); |
| [1339](#L1339) | if ( ! empty( $activate\_extensions['paid'] ) ) { |
| [1340](#L1340) |  |
| [1341](#L1341) | if($notice\_name==0) |
| [1342](#L1342) | { |
| [1343](#L1343) | $path         = plugin\_dir\_url( \_\_FILE\_\_ ); |
| [1344](#L1344) | ?> |
| [1345](#L1345) | <div class="pmagic" id="pg\_customization\_footer\_banner"> |
| [1346](#L1346) | <div class="pg-customize-banner-row pg-box-row"> |
| [1347](#L1347) | <div class="pg-box-col-12"> |
| [1348](#L1348) | <div class="pg-customize-banner-wrap pg-d-flex pg-justify-content-between pg-box-center pg-p-3 pg-box-w-100 pg-white-bg"> |
| [1349](#L1349) | <div class="pg-position-absolute pg-banner-close-icon pg-cursor pg-dismissible" id="pg\_dismissible\_customization\_banner">&#x2715</div> |
| [1350](#L1350) | <div class="pg-customize-banner-logo"><img width="128" src="<?php echo esc\_url($path . 'partials/images/svg/pg-logo.png'); ?>"></div> |
| [1351](#L1351) | <div class="pg-banner-pitch-content-wrap pg-lh-normal"> |
| [1352](#L1352) | <div class="pg-banner-pitch-head pg-fs-2 pg-fw-bold"> |
| [1353](#L1353) | <?php esc\_html\_e('Customize ProfileGrid', 'profilegrid-user-profiles-groups-and-communities'); ?> |
| [1354](#L1354) | </div> |
| [1355](#L1355) | <div class="pg-banner-pitch-content pg-fs-5 pg-text-muted"> |
| [1356](#L1356) | <?php esc\_html\_e('Have our team build the exact feature that you need.', 'profilegrid-user-profiles-groups-and-communities'); ?> |
| [1357](#L1357) | </div> |
| [1358](#L1358) | </div> |
| [1359](#L1359) |  |
| [1360](#L1360) | <div class="pg-banner-btn-wrap"> |
| [1361](#L1361) | <a target="\_blank" href="https://profilegrid.co/help-support/customizations/" class=""><button class="button button-primary pg-customize-banner-btn"><?php esc\_html\_e('Get Help Now', 'profilegrid-user-profiles-groups-and-communities'); ?></button></a> |
| [1362](#L1362) | </div> |
| [1363](#L1363) |  |
| [1364](#L1364) |  |
| [1365](#L1365) | </div> |
| [1366](#L1366) | </div> |
| [1367](#L1367) | </div> |
| [1368](#L1368) | </div> |
| [1369](#L1369) | <?php |
| [1370](#L1370) | } |
| [1371](#L1371) | } |
| [1372](#L1372) | else |
| [1373](#L1373) | { |
| [1374](#L1374) | $path = plugin\_dir\_url( \_\_FILE\_\_ ) . 'partials/images/extension\_banner.png'; |
| [1375](#L1375) |  |
| [1376](#L1376) | ?> |
| [1377](#L1377) | <div class="pg-footer-banner"><a href="admin.php?page=pm\_extensions"><img src="<?php echo esc\_url( $path ); ?>" /></a></div> |
| [1378](#L1378) | <?php |
| [1379](#L1379) | } |
| [1380](#L1380) |  |
| [1381](#L1381) |  |
| [1382](#L1382) | } |
| [1383](#L1383) |  |
| [1384](#L1384) | public function pm\_dismissible\_notice() { |
| [1385](#L1385) | $dbhandler    = new PM\_DBhandler(); |
| [1386](#L1386) | $pmrequests  = new PM\_request(); |
| [1387](#L1387) | $notice\_name = $dbhandler->get\_global\_option\_value( 'pg\_dismissible\_plugin', '0' ); |
| [1388](#L1388) | $is\_pg\_page  = $pmrequests->is\_pg\_dashboard\_page(); |
| [1389](#L1389) | if ( $notice\_name == '1' ) { |
| [1390](#L1390) | return;} |
| [1391](#L1391) | if ( $is\_pg\_page == false ) { |
| [1392](#L1392) | return;} |
| [1393](#L1393) | ?> |
| [1394](#L1394) | <div class="notice notice-info is-dismissible pg-dismissible" id="pg\_dismissible\_plugin"> |
| [1395](#L1395) | <p><?php esc\_html\_e( "If you are testing multiple user profile plugins for WordPress, there's a chance that one or more of them can override ProfileGrid's functionality. If something is not working as expected, please try turning them off. A very common example is profile image upload feature not working.", 'profilegrid-user-profiles-groups-and-communities' ); ?></p> |
| [1396](#L1396) | </div> |
| [1397](#L1397) | <?php |
| [1398](#L1398) | } |
| [1399](#L1399) |  |
| [1400](#L1400) | public function pm\_dismissible\_woo\_bundle\_notice() { |
| [1401](#L1401) | $dbhandler   = new PM\_DBhandler(); |
| [1402](#L1402) | $pmrequests  = new PM\_request(); |
| [1403](#L1403) | $notice\_name = $dbhandler->get\_global\_option\_value( 'pg\_woo\_bundle\_dismissible\_plugin', '0' ); |
| [1404](#L1404) | $is\_pg\_page  = $pmrequests->is\_pg\_dashboard\_page(); |
| [1405](#L1405) | if ( $notice\_name == '1' ) { |
| [1406](#L1406) | return;} |
| [1407](#L1407) | if ( $is\_pg\_page == false ) { |
| [1408](#L1408) | return;} |
| [1409](#L1409) | $activate\_extensions = $pmrequests->pg\_get\_activate\_extensions(); |
| [1410](#L1410) | if ( ! empty( $activate\_extensions['paid'] ) ) { |
| [1411](#L1411) | return;} |
| [1412](#L1412) | if ( class\_exists( 'Profile\_Magic' ) && class\_exists( 'WooCommerce' ) && class\_exists( 'Profilegrid\_Woocommerce' ) ) { |
| [1413](#L1413) |  |
| [1414](#L1414) | ?> |
| [1415](#L1415) | <div class="notice notice-success is-dismissible pg-dismissible" id="pg\_woo\_bundle\_dismissible\_plugin"> |
| [1416](#L1416) | <p><?php esc\_html\_e( 'Do you want even more comprehensive WooCommerce integration with your user profiles and user groups? Upgrade to WooCommerce Premium Bundle for ProfileGrid.', 'profilegrid-user-profiles-groups-and-communities' ); ?> <a href="https://profilegrid.co/extensions/woocommerce-membership-extensions/?utm\_source=pg\_plugin&utm\_medium=wp\_notice&utm\_campaign=woo\_bundle\_promo"><?php esc\_html\_e( 'Learn more', 'profilegrid-user-profiles-groups-and-communities' ); ?></a></p> |
| [1417](#L1417) | </div> |
| [1418](#L1418) | <?php |
| [1419](#L1419) | } |
| [1420](#L1420) | } |
| [1421](#L1421) |  |
| [1422](#L1422) | public function pm\_dismissible\_notice\_ajax() { |
| [1423](#L1423) | $pm\_sanitizer = new PM\_sanitizer(); |
| [1424](#L1424) |  |
| [1425](#L1425) | $nonce = filter\_input( INPUT\_POST, 'nonce' ); |
| [1426](#L1426) | if ( ! isset( $nonce ) || ! wp\_verify\_nonce( $nonce, 'ajax-nonce' ) ) { |
| [1427](#L1427) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [1428](#L1428) | } |
| [1429](#L1429) | if ( current\_user\_can( 'manage\_options' ) ) |
| [1430](#L1430) | { |
| [1431](#L1431) | $post = $pm\_sanitizer->sanitize( $\_POST ); |
| [1432](#L1432) | $dbhandler    = new PM\_DBhandler(); |
| [1433](#L1433) | if ( isset( $post['notice\_name'] ) ) { |
| [1434](#L1434) | $notice\_name = $post['notice\_name']; |
| [1435](#L1435) | $dbhandler->update\_global\_option\_value( $notice\_name, '1' ); |
| [1436](#L1436) |  |
| [1437](#L1437) | } |
| [1438](#L1438) | $default = array(); |
| [1439](#L1439) | if ( isset( $post['rm\_form\_id'] ) ) { |
| [1440](#L1440) | $rmformid  = $post['rm\_form\_id']; |
| [1441](#L1441) | $get\_value = maybe\_unserialize( get\_option( 'pg\_rm\_change\_form\_type', $default ) ); |
| [1442](#L1442) | if ( isset( $get\_value[ $rmformid ] ) ) { |
| [1443](#L1443) | unset( $get\_value[ $rmformid ] ); |
| [1444](#L1444) | $dbhandler->update\_global\_option\_value( 'pg\_rm\_change\_form\_type', $get\_value ); |
| [1445](#L1445) |  |
| [1446](#L1446) | } |
| [1447](#L1447) | delete\_option( 'pg\_rm\_change\_form\_type\_' . $rmformid ); |
| [1448](#L1448) | delete\_option( 'pg\_rm\_change\_form\_type\_group\_name\_' . $rmformid ); |
| [1449](#L1449) | } |
| [1450](#L1450) | } |
| [1451](#L1451) | die; |
| [1452](#L1452) | } |
| [1453](#L1453) |  |
| [1454](#L1454) | public function pm\_dismissible\_woocommerce\_notice() { |
| [1455](#L1455) | $dbhandler    = new PM\_DBhandler(); |
| [1456](#L1456) | $pmrequests  = new PM\_request(); |
| [1457](#L1457) | $url         = 'https://profilegrid.co/extensions/woocommerce-integration/?utm\_source=plugin&utm\_medium=wp\_notice'; |
| [1458](#L1458) | $notice\_name = $dbhandler->get\_global\_option\_value( 'pg\_woocommerce\_ext\_notice', '0' ); |
| [1459](#L1459) | $is\_pg\_page  = $pmrequests->is\_pg\_dashboard\_page(); |
| [1460](#L1460) | if ( $notice\_name == '1' ) { |
| [1461](#L1461) | return;} |
| [1462](#L1462) | if ( class\_exists( 'Profile\_Magic' ) && class\_exists( 'WooCommerce' ) && ! class\_exists( 'Profilegrid\_Woocommerce' ) ) { |
| [1463](#L1463) | ?> |
| [1464](#L1464) | <div class="notice notice-info is-dismissible pg-dismissible" id="pg\_woocommerce\_ext\_notice"> |
| [1465](#L1465) | <p><?php echo sprintf( wp\_kses\_post( "If you wish to integrate WooCommerce data with ProfileGrid user profiles, please download WooCommerce extension from <a target='\_blank' href='%s'>here.</a>", 'profilegrid-user-profiles-groups-and-communities' ), esc\_url( $url ) ); ?></p> |
| [1466](#L1466) | </div> |
| [1467](#L1467) | <?php |
| [1468](#L1468) | } |
| [1469](#L1469) | } |
| [1470](#L1470) |  |
| [1471](#L1471) | public function pm\_dismissible\_custom\_profile\_tab\_notice() { |
| [1472](#L1472) | $dbhandler    = new PM\_DBhandler(); |
| [1473](#L1473) | $pmrequests  = new PM\_request(); |
| [1474](#L1474) | $url         = 'https://profilegrid.co/extensions/custom-user-profile-tabs-content/'; |
| [1475](#L1475) | $notice\_name = $dbhandler->get\_global\_option\_value( 'pg\_custom\_tab\_ext\_notice', '0' ); |
| [1476](#L1476) | $is\_pg\_page  = $pmrequests->is\_pg\_dashboard\_page(); |
| [1477](#L1477) | if ( $notice\_name == '1' ) { |
| [1478](#L1478) | return;} |
| [1479](#L1479) | if ( $is\_pg\_page == false ) { |
| [1480](#L1480) | return;} |
| [1481](#L1481) |  |
| [1482](#L1482) | if ( class\_exists( 'Profile\_Magic' ) && class\_exists( 'WooCommerce' ) && class\_exists( 'Profilegrid\_Woocommerce' ) && ! class\_exists( 'Profilegrid\_User\_Content' ) ) { |
| [1483](#L1483) | ?> |
| [1484](#L1484) | <div class="notice notice-info is-dismissible pg-dismissible" id="pg\_custom\_tab\_ext\_notice"> |
| [1485](#L1485) | <p><?php echo sprintf( wp\_kses\_post( "Do you wish to display information from WooCommerce extensions and other WordPress plugins inside frontend user profiles? Try our Custom User Profile Tabs extension, which can turn user profiles into powerful hubs with all user specific information in one place! <a target='\_blank' href='%s'>Get it here.</a>", 'profilegrid-user-profiles-groups-and-communities' ), esc\_url( $url ) ); ?></p> |
| [1486](#L1486) | </div> |
| [1487](#L1487) | <?php |
| [1488](#L1488) | } |
| [1489](#L1489) | } |
| [1490](#L1490) |  |
| [1491](#L1491) | public function pm\_dismissible\_bbpress\_notice() { |
| [1492](#L1492) | $dbhandler    = new PM\_DBhandler(); |
| [1493](#L1493) | $pmrequests  = new PM\_request(); |
| [1494](#L1494) | $url         = 'https://profilegrid.co/extensions/custom-user-profile-tabs-content/'; |
| [1495](#L1495) | $notice\_name = $dbhandler->get\_global\_option\_value( 'pg\_bbpress\_ext\_notice', '0' ); |
| [1496](#L1496) | $is\_pg\_page  = $pmrequests->is\_pg\_dashboard\_page(); |
| [1497](#L1497) | if ( $notice\_name == '1' ) { |
| [1498](#L1498) | return;} |
| [1499](#L1499) |  |
| [1500](#L1500) | if ( class\_exists( 'Profile\_Magic' ) && is\_plugin\_active( 'bbpress/bbpress.php' ) && class\_exists( 'Profilegrid\_Bbpress' ) && ! class\_exists( 'Profilegrid\_User\_Content' ) ) { |
| [1501](#L1501) | ?> |
| [1502](#L1502) | <div class="notice notice-info is-dismissible pg-dismissible" id="pg\_bbpress\_ext\_notice"> |
| [1503](#L1503) | <p><?php echo sprintf( wp\_kses\_post( "Do you wish to display information from bbPress extensions and other WordPress plugins inside frontend user profiles? Try our Custom User Profile Tabs extension, which can turn user profiles into powerful hubs with all user specific information in one place! <a target='\_blank' href='%s'>Get it here.</a>", 'profilegrid-user-profiles-groups-and-communities' ), esc\_url( $url ) ); ?></p> |
| [1504](#L1504) | </div> |
| [1505](#L1505) | <?php |
| [1506](#L1506) | } |
| [1507](#L1507) | } |
| [1508](#L1508) |  |
| [1509](#L1509) |  |
| [1510](#L1510) |  |
| [1511](#L1511) | public function pm\_check\_associate\_email\_tmpl() { |
| [1512](#L1512) | $pm\_sanitizer = new PM\_sanitizer(); |
| [1513](#L1513) |  |
| [1514](#L1514) | $nonce = filter\_input( INPUT\_POST, 'nonce' ); |
| [1515](#L1515) | if ( ! isset( $nonce ) || ! wp\_verify\_nonce( $nonce, 'ajax-nonce' ) ) { |
| [1516](#L1516) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [1517](#L1517) | } |
| [1518](#L1518) | $post = $pm\_sanitizer->sanitize( $\_POST ); |
| [1519](#L1519) | $pmrequests   = new PM\_request(); |
| [1520](#L1520) | if ( isset( $post['searchIDs'] ) ) { |
| [1521](#L1521) | $selected = $post['searchIDs']; |
| [1522](#L1522) | if ( isset( $selected['ID'] ) ) { |
| [1523](#L1523) | unset( $selected['ID'] ); |
| [1524](#L1524) | } |
| [1525](#L1525) | if ( isset( $selected['filter'] ) ) { |
| [1526](#L1526) | unset( $selected['filter'] ); |
| [1527](#L1527) | } |
| [1528](#L1528) | } |
| [1529](#L1529) |  |
| [1530](#L1530) | $count\_selected = count( $selected ); |
| [1531](#L1531) | $msg            = ''; |
| [1532](#L1532) | foreach ( $selected as $tid ) { |
| [1533](#L1533) | $exist\_tmpl = $pmrequests->pg\_check\_email\_template\_if\_used\_in\_any\_group( $tid ); |
| [1534](#L1534) | if ( $exist\_tmpl != false ) { |
| [1535](#L1535) | if ( $count\_selected > 1 ) { |
| [1536](#L1536) | $msg = \_\_( 'One or more email templates you are trying to delete are being used for notifications by a group. Please disassociate them before attempting to delete.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [1537](#L1537) | } else { |
| [1538](#L1538) | $msg = \_\_( 'The Email Template you are trying to delete is being used for notifications by 1 or more user groups. Disassociate the template from all associated groups before deleting.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [1539](#L1539) | } |
| [1540](#L1540) | } |
| [1541](#L1541) | } |
| [1542](#L1542) | echo esc\_html( $msg ); |
| [1543](#L1543) | die; |
| [1544](#L1544) | } |
| [1545](#L1545) |  |
| [1546](#L1546) | public function pm\_groups\_widget() { |
| [1547](#L1547) | register\_widget( 'Profilegrid\_Groups\_Menu' ); |
| [1548](#L1548) | } |
| [1549](#L1549) |  |
| [1550](#L1550) | public function pm\_merge\_quniue\_value($a,$b) |
| [1551](#L1551) | { |
| [1552](#L1552) | $mergedArray = array\_merge($a, $b); |
| [1553](#L1553) | // Remove duplicates while preserving the order |
| [1554](#L1554) | $uniqueArray = array\_unique($mergedArray); |
| [1555](#L1555) | // If you want the final array to have consecutive integer keys starting from 0, you can use array\_values |
| [1556](#L1556) | $finalArray = array\_values($uniqueArray); |
| [1557](#L1557) | return $finalArray; |
| [1558](#L1558) |  |
| [1559](#L1559) | } |
| [1560](#L1560) | public function pm\_group\_option\_update() { |
| [1561](#L1561) | $dbhandler = new PM\_DBhandler(); |
| [1562](#L1562) | $pmrequest = new PM\_request(); |
| [1563](#L1563) |  |
| [1564](#L1564) | $pg\_main\_groups = $dbhandler->get\_all\_result( 'GROUPS', array( 'id' ), $where = 1, $result\_type = 'results', $offset = 0, $limit = false, $sort\_by = null, $descending = false, $additional = '', $output = 'ARRAY\_A', $distinct = false ); |
| [1565](#L1565) | if ( ! empty( $pg\_main\_groups ) ) { |
| [1566](#L1566) | $pg\_groups  = $pmrequest->pm\_to\_array( $pg\_main\_groups ); |
| [1567](#L1567) | $group\_menu = get\_option( 'pg\_group\_menu' ); |
| [1568](#L1568) | if ( ! empty( $group\_menu ) && is\_array($group\_menu)) { |
| [1569](#L1569) | $pg\_group\_menu = $this->pm\_merge\_quniue\_value($group\_menu, $pg\_groups); |
| [1570](#L1570) | update\_option( 'pg\_group\_menu', $pg\_group\_menu ); |
| [1571](#L1571) | } else { |
| [1572](#L1572) | if ( isset( $pg\_groups ) ) : |
| [1573](#L1573) | $tmp = $group\_menu; |
| [1574](#L1574) | if ( isset( $group\_menu ) && is\_array( $group\_menu ) && ! empty( $group\_menu ) ) { |
| [1575](#L1575) | sort( $group\_menu ); |
| [1576](#L1576) | } |
| [1577](#L1577) | if ( isset( $pg\_groups ) && is\_array( $pg\_groups ) && ! empty( $pg\_groups ) ) { |
| [1578](#L1578) | sort( $pg\_groups ); |
| [1579](#L1579) | } |
| [1580](#L1580) | endif; |
| [1581](#L1581) | if ( $group\_menu == $pg\_groups ) : |
| [1582](#L1582) | update\_option( 'pg\_group\_menu', $tmp ); |
| [1583](#L1583) | else : |
| [1584](#L1584) | update\_option( 'pg\_group\_menu', $pg\_groups ); |
| [1585](#L1585) | update\_option( 'pg\_group\_list', $pg\_groups ); |
| [1586](#L1586) | endif; |
| [1587](#L1587) | } |
| [1588](#L1588) | $group\_list = get\_option( 'pg\_group\_list' ); |
| [1589](#L1589) | if ( ! $group\_list ) { |
| [1590](#L1590) | update\_option( 'pg\_group\_list', $pg\_groups ); |
| [1591](#L1591) | } |
| [1592](#L1592) | $pg\_group\_icon = get\_option( 'pg\_group\_icon' ); |
| [1593](#L1593) | if ( ! $pg\_group\_icon ) { |
| [1594](#L1594) | update\_option( 'pg\_group\_icon', 'yes' ); |
| [1595](#L1595) | } |
| [1596](#L1596) | } |
| [1597](#L1597) | } |
| [1598](#L1598) |  |
| [1599](#L1599) | public function pg\_groupleader\_assign\_remove\_fun( $gid, $prev\_is\_leader, $prev\_group\_leaders, $new\_is\_leader, $new\_group\_leaders ) { |
| [1600](#L1600) | $pmemails              = new PM\_Emails(); |
| [1601](#L1601) | $is\_remove         = false; |
| [1602](#L1602) | $is\_assign         = false; |
| [1603](#L1603) | $new\_group\_leaders = maybe\_unserialize( $new\_group\_leaders ); |
| [1604](#L1604) |  |
| [1605](#L1605) | if ( $prev\_is\_leader != '' && $prev\_is\_leader == 1 && $new\_is\_leader == 0 ) { |
| [1606](#L1606) | if ( ! empty( $prev\_group\_leaders ) ) { |
| [1607](#L1607) | foreach ( $prev\_group\_leaders as $old\_admin ) { |
| [1608](#L1608) | $user\_data = get\_user\_by( 'ID', $old\_admin ); |
| [1609](#L1609) | $pmemails->pm\_send\_group\_based\_notification( $gid, $user\_data->ID, 'on\_admin\_removal' ); |
| [1610](#L1610) | do\_action( 'pm\_unassign\_group\_manager\_privilege', $gid, $user\_data->ID ); |
| [1611](#L1611) | } |
| [1612](#L1612) | } |
| [1613](#L1613) | } else { |
| [1614](#L1614) | if ( empty( $prev\_group\_leaders ) ) { |
| [1615](#L1615) | $prev\_group\_leaders = array(); |
| [1616](#L1616) | } |
| [1617](#L1617) | if ( empty( $new\_group\_leaders ) ) { |
| [1618](#L1618) | $new\_group\_leaders = array(); |
| [1619](#L1619) | } |
| [1620](#L1620) | $admins\_removed = array\_diff( $prev\_group\_leaders, $new\_group\_leaders ); |
| [1621](#L1621) | $admins\_added   = array\_diff( $new\_group\_leaders, $prev\_group\_leaders ); |
| [1622](#L1622) |  |
| [1623](#L1623) | if ( ! empty( $admins\_added ) ) { |
| [1624](#L1624) | foreach ( $admins\_added as $new\_admin ) { |
| [1625](#L1625) | $user\_data = get\_user\_by( 'ID', $new\_admin ); |
| [1626](#L1626) | $pmemails->pm\_send\_group\_based\_notification( $gid, $user\_data->ID, 'on\_admin\_assignment' ); |
| [1627](#L1627) | do\_action( 'pm\_assign\_group\_manager\_privilege', $gid, $user\_data->ID ); |
| [1628](#L1628) | } |
| [1629](#L1629) | } |
| [1630](#L1630) | if ( ! empty( $admins\_removed ) ) { |
| [1631](#L1631) | foreach ( $admins\_removed as $old\_admin ) { |
| [1632](#L1632) | $user\_data = get\_user\_by( 'ID', $old\_admin ); |
| [1633](#L1633) | $pmemails->pm\_send\_group\_based\_notification( $gid, $user\_data->ID, 'on\_admin\_removal' ); |
| [1634](#L1634) | do\_action( 'pm\_unassign\_group\_manager\_privilege', $gid, $user\_data->ID ); |
| [1635](#L1635) | } |
| [1636](#L1636) | } |
| [1637](#L1637) | } |
| [1638](#L1638) | return; |
| [1639](#L1639) | } |
| [1640](#L1640) |  |
| [1641](#L1641) | public function rm\_form\_type\_changed\_fun( $form\_id, $form\_type, $previous\_form\_type ) { |
| [1642](#L1642) | $pmrequest   = new PM\_request(); |
| [1643](#L1643) | $dbhandler    = new PM\_DBhandler(); |
| [1644](#L1644) | $is\_associate = $pmrequest->pm\_check\_rm\_form\_associate\_with\_groups( $form\_id ); |
| [1645](#L1645) | if ( ! empty( $is\_associate ) && $form\_type != '1' && $previous\_form\_type == '1' ) { |
| [1646](#L1646) | $group\_name = array(); |
| [1647](#L1647) | foreach ( $is\_associate as $group ) { |
| [1648](#L1648) | $group\_name[]                = $dbhandler->get\_value( 'GROUPS', 'group\_name', $group ); |
| [1649](#L1649) | $group\_options               = maybe\_unserialize( $dbhandler->get\_value( 'GROUPS', 'group\_options', $group ) ); |
| [1650](#L1650) | $group\_options['pg\_rm\_form'] = '0'; |
| [1651](#L1651) |  |
| [1652](#L1652) | $dbhandler->update\_row( 'GROUPS', 'id', $group, array( 'group\_options' => maybe\_serialize( $group\_options ) ), array( '%s' ), '%d' ); |
| [1653](#L1653) | } |
| [1654](#L1654) | if ( ! empty( $group\_name ) ) { |
| [1655](#L1655) | $name = implode( ',', $group\_name ); |
| [1656](#L1656) | } else { |
| [1657](#L1657) | $name = ''; |
| [1658](#L1658) | } |
| [1659](#L1659) |  |
| [1660](#L1660) | $default     = array(); |
| [1661](#L1661) | $get\_value   = maybe\_unserialize( get\_option( 'pg\_rm\_change\_form\_type', $default ) ); |
| [1662](#L1662) | $get\_value[] = $form\_id; |
| [1663](#L1663) | update\_option( 'pg\_rm\_change\_form\_type', $get\_value ); |
| [1664](#L1664) | update\_option( 'pg\_rm\_change\_form\_type\_' . $form\_id, $form\_id ); |
| [1665](#L1665) | update\_option( 'pg\_rm\_change\_form\_type\_group\_name\_' . $form\_id, $name ); |
| [1666](#L1666) | } |
| [1667](#L1667) | } |
| [1668](#L1668) |  |
| [1669](#L1669) | public function pm\_dismissible\_rm\_form\_type\_changed() { |
| [1670](#L1670) | $pmrequest = new PM\_request(); |
| [1671](#L1671) | $dbhandler  = new PM\_DBhandler(); |
| [1672](#L1672) | $default    = array(); |
| [1673](#L1673) | $get\_value  = maybe\_unserialize( get\_option( 'pg\_rm\_change\_form\_type', $default ) ); |
| [1674](#L1674) |  |
| [1675](#L1675) | if ( ! empty( $get\_value ) && is\_array( $get\_value ) ) { |
| [1676](#L1676) | foreach ( $get\_value as $form\_id ) { |
| [1677](#L1677) | $get\_form\_option = get\_option( "pg\_rm\_change\_form\_type\_$form\_id", '' ); |
| [1678](#L1678) | if ( $get\_form\_option != '' ) { |
| [1679](#L1679) | $name = get\_option( "pg\_rm\_change\_form\_type\_group\_name\_$form\_id", '' ); |
| [1680](#L1680) | ?> |
| [1681](#L1681) | <div class="notice notice-info is-dismissible pgrm-dismissible" id="pg\_rm\_change\_form\_type\_<?php echo esc\_attr( $form\_id ); ?>" data-rmid="<?php echo esc\_attr( $form\_id ); ?>"> |
| [1682](#L1682) | <p><?php echo sprintf( wp\_kses\_post( '%s registration form has been reverted to default ProfileGrid form since the associated RegistrationMagic form was deleted or its type was changed.', 'profilegrid-user-profiles-groups-and-communities' ), esc\_html( $name ) ); ?></p> |
| [1683](#L1683) | </div> |
| [1684](#L1684) | <?php |
| [1685](#L1685) | } |
| [1686](#L1686) | } |
| [1687](#L1687) | } |
| [1688](#L1688) | } |
| [1689](#L1689) |  |
| [1690](#L1690) | public function rm\_user\_deactivated( $uid ) { |
| [1691](#L1691) | $pmrequests    = new PM\_request(); |
| [1692](#L1692) | $pmemails      = new PM\_Emails(); |
| [1693](#L1693) | $ugids         = get\_user\_meta( $uid, 'pm\_group', true ); |
| [1694](#L1694) | $ugid          = $pmrequests->pg\_filter\_users\_group\_ids( $ugids ); |
| [1695](#L1695) | $primary\_group = $pmrequests->pg\_get\_primary\_group\_id( $ugid ); |
| [1696](#L1696) | $pmemails->pm\_send\_group\_based\_notification( $primary\_group, $uid, 'on\_user\_deactivate' ); |
| [1697](#L1697) | } |
| [1698](#L1698) |  |
| [1699](#L1699) |  |
| [1700](#L1700) | public function rm\_form\_deleted\_fun( $form\_id ) { |
| [1701](#L1701) | $this->rm\_form\_type\_changed\_fun( $form\_id, '2', '1' ); |
| [1702](#L1702) | } |
| [1703](#L1703) |  |
| [1704](#L1704) | public function pm\_get\_rm\_helptext() { |
| [1705](#L1705) | $pm\_sanitizer = new PM\_sanitizer(); |
| [1706](#L1706) | $nonce        = filter\_input( INPUT\_POST, 'nonce' ); |
| [1707](#L1707) | if ( ! isset( $nonce ) || ! wp\_verify\_nonce( $nonce, 'ajax-nonce' ) ) { |
| [1708](#L1708) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [1709](#L1709) | } |
| [1710](#L1710) | $post = $pm\_sanitizer->sanitize( $\_POST ); |
| [1711](#L1711) | $dbhandler    = new PM\_DBhandler(); |
| [1712](#L1712) | if ( isset( $post['id'] ) ) { |
| [1713](#L1713) | $form\_id = $post['id']; |
| [1714](#L1714) | } else { |
| [1715](#L1715) | $form\_id = '0'; |
| [1716](#L1716) | } |
| [1717](#L1717) | if ( $form\_id == '0' ) { |
| [1718](#L1718) | echo "'Default' sets up the group registration form using this group's profile fields"; |
| [1719](#L1719) | } else { |
| [1720](#L1720) | $form\_name = $dbhandler->get\_value( 'FORMS', 'form\_name', $form\_id ); |
| [1721](#L1721) | echo "This sets up the RegistrationMagic form <a target='\_blank' href='admin.php?page=rm\_form\_sett\_manage&rm\_form\_id=" . esc\_attr( $form\_id ) . "'>" . esc\_html( $form\_name ) . "</a> as this group's registration form"; |
| [1722](#L1722) | } |
| [1723](#L1723) | die; |
| [1724](#L1724) | } |
| [1725](#L1725) | public function profilegrid\_user\_blogs\_widgets() { |
| [1726](#L1726) | register\_widget( 'Profilegrid\_User\_Blogs' ); |
| [1727](#L1727) | } |
| [1728](#L1728) |  |
| [1729](#L1729) | public function profilegrid\_user\_login\_widgets() { |
| [1730](#L1730) | register\_widget( 'Profilegrid\_User\_login' ); |
| [1731](#L1731) | } |
| [1732](#L1732) | // register our meta box for our links |
| [1733](#L1733) | public function individual\_user\_group\_add\_meta\_box() { |
| [1734](#L1734) | add\_meta\_box( |
| [1735](#L1735) | 'group\_pages\_menu\_metabox', |
| [1736](#L1736) | \_\_( 'Individual User Group', 'individual-user-group-to-menu' ), |
| [1737](#L1737) | array( $this, 'individual\_user\_group\_display\_meta\_box' ), |
| [1738](#L1738) | 'nav-menus', |
| [1739](#L1739) | 'side', |
| [1740](#L1740) | 'low' |
| [1741](#L1741) | ); |
| [1742](#L1742) | add\_meta\_box( |
| [1743](#L1743) | 'user\_profile\_pages\_menu\_metabox', |
| [1744](#L1744) | \_\_( 'Individual User Profile', 'individual-user-profile-to-menu' ), |
| [1745](#L1745) | array( $this, 'individual\_user\_profile\_display\_meta\_box' ), |
| [1746](#L1746) | 'nav-menus', |
| [1747](#L1747) | 'side', |
| [1748](#L1748) | 'low' |
| [1749](#L1749) | ); |
| [1750](#L1750) |  |
| [1751](#L1751) | } |
| [1752](#L1752) |  |
| [1753](#L1753) | public function individual\_user\_group\_display\_meta\_box() { |
| [1754](#L1754) | $dbhandler  = new PM\_DBhandler(); |
| [1755](#L1755) | $pmrequests = new PM\_request(); |
| [1756](#L1756) | $groups     = $dbhandler->get\_all\_result( 'GROUPS' ); |
| [1757](#L1757) |  |
| [1758](#L1758) | ?> |
| [1759](#L1759) |  |
| [1760](#L1760) | <div id="posttype-group-pages" class="posttypediv"> |
| [1761](#L1761) | <div id="tabs-panel-group-pages" class="tabs-panel tabs-panel-active"> |
| [1762](#L1762) |  |
| [1763](#L1763) | <ul id="group-pages" class="categorychecklist form-no-clear"> |
| [1764](#L1764) | <!--Custom --> |
| [1765](#L1765) | <?php |
| [1766](#L1766) | // loop through all registered content types that have 'has-group' enabled |
| [1767](#L1767) |  |
| [1768](#L1768) | if ( ! empty( $groups ) ) { |
| [1769](#L1769) | $counter = -1; |
| [1770](#L1770) | foreach ( $groups as $group ) { |
| [1771](#L1771) | $group\_name      = $group->group\_name; |
| [1772](#L1772) | $group\_page\_link = $pmrequests->profile\_magic\_get\_frontend\_url( 'pm\_group\_page', '', $group->id ); |
| [1773](#L1773) | //$group\_page\_link = add\_query\_arg( 'gid', $group->id, $group\_page\_link ); |
| [1774](#L1774) | ?> |
| [1775](#L1775) | <li> |
| [1776](#L1776) | <label class="menu-item-title"> |
| [1777](#L1777) | <input type="checkbox" class="menu-item-checkbox" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-object-id]" value="-1"/><?php echo esc\_html( $group\_name ); ?> |
| [1778](#L1778) | </label> |
| [1779](#L1779) | <input type="hidden" class="menu-item-type" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-type]" value="custom"/> |
| [1780](#L1780) | <input type="hidden" class="menu-item-title" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-title]" value="<?php echo esc\_attr( $group\_name ); ?>"/> |
| [1781](#L1781) | <input type="hidden" class="menu-item-url" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-url]" value="<?php echo esc\_url( $group\_page\_link ); ?>"/> |
| [1782](#L1782) | <input type="hidden" class="menu-item-classes" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-classes]"/> |
| [1783](#L1783) | </li> |
| [1784](#L1784) | <?php |
| [1785](#L1785) | $counter--; |
| [1786](#L1786) | } |
| [1787](#L1787) | } |
| [1788](#L1788) | ?> |
| [1789](#L1789) |  |
| [1790](#L1790) | </ul> |
| [1791](#L1791) | </div> |
| [1792](#L1792) | <p class="button-controls"> |
| [1793](#L1793) | <span class="list-controls"> |
| [1794](#L1794) | <a href="<?php echo esc\_url( admin\_url( 'nav-menus.php?page-tab=all&selectall=1#posttype-group-pages' ) ); ?>" class="select-all"> <?php esc\_html\_e( 'Select All', 'group-pages-to-menu' ); ?></a> |
| [1795](#L1795) | </span> |
| [1796](#L1796) | <span class="add-to-menu"> |
| [1797](#L1797) | <input type="submit" class="button-secondary submit-add-to-menu right" value="<?php esc\_attr\_e( 'Add to Menu', 'group-pages-to-menu' ); ?>" name="add-post-type-menu-item" id="submit-posttype-group-pages"> |
| [1798](#L1798) | <span class="spinner"></span> |
| [1799](#L1799) | </span> |
| [1800](#L1800) | </p> |
| [1801](#L1801) | </div> |
| [1802](#L1802) | <?php |
| [1803](#L1803) | } |
| [1804](#L1804) |  |
| [1805](#L1805) | public function individual\_user\_profile\_display\_meta\_box() { |
| [1806](#L1806) | $dbhandler  = new PM\_DBhandler(); |
| [1807](#L1807) | $pmrequests = new PM\_request(); |
| [1808](#L1808) | $meta\_query = $pmrequests->pm\_get\_user\_meta\_query( array() ); |
| [1809](#L1809) | $user\_query = $dbhandler->pm\_get\_all\_users\_ajax( '', $meta\_query ); |
| [1810](#L1810) |  |
| [1811](#L1811) | $users = $user\_query->get\_results(); |
| [1812](#L1812) |  |
| [1813](#L1813) | ?> |
| [1814](#L1814) |  |
| [1815](#L1815) | <div id="posttype-user-pages" class="posttypediv"> |
| [1816](#L1816) | <div id="tabs-panel-user-pages" class="tabs-panel tabs-panel-active"> |
| [1817](#L1817) |  |
| [1818](#L1818) | <ul id="user-pages" class="categorychecklist form-no-clear"> |
| [1819](#L1819) | <!--Custom --> |
| [1820](#L1820) | <?php |
| [1821](#L1821) | // loop through all registered content types that have 'has-group' enabled |
| [1822](#L1822) |  |
| [1823](#L1823) | if ( ! empty( $users ) ) { |
| [1824](#L1824) | $counter = -1; |
| [1825](#L1825) | foreach ( $users as $user ) { |
| [1826](#L1826) | $group\_name                          = $user->display\_name; |
| [1827](#L1827) | $uid                                 = $user->ID; |
| [1828](#L1828) | $profile\_url = $pmrequests->pm\_get\_user\_profile\_url( $uid ); |
| [1829](#L1829) | ?> |
| [1830](#L1830) | <li> |
| [1831](#L1831) | <label class="menu-item-title"> |
| [1832](#L1832) | <input type="checkbox" class="menu-item-checkbox" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-object-id]" value="-1"/><?php echo esc\_html( $group\_name ); ?> |
| [1833](#L1833) | </label> |
| [1834](#L1834) | <input type="hidden" class="menu-item-type" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-type]" value="custom"/> |
| [1835](#L1835) | <input type="hidden" class="menu-item-title" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-title]" value="<?php echo esc\_attr( $group\_name ); ?>"/> |
| [1836](#L1836) | <input type="hidden" class="menu-item-url" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-url]" value="<?php echo esc\_url( $profile\_url ); ?>"/> |
| [1837](#L1837) | <input type="hidden" class="menu-item-classes" name="menu-item[<?php echo esc\_attr( $counter ); ?>][menu-item-classes]"/> |
| [1838](#L1838) | </li> |
| [1839](#L1839) | <?php |
| [1840](#L1840) | $counter--; |
| [1841](#L1841) | } |
| [1842](#L1842) | } |
| [1843](#L1843) | ?> |
| [1844](#L1844) |  |
| [1845](#L1845) | </ul> |
| [1846](#L1846) | </div> |
| [1847](#L1847) | <p class="button-controls"> |
| [1848](#L1848) | <span class="list-controls"> |
| [1849](#L1849) | <a href="<?php echo esc\_url( admin\_url( 'nav-menus.php?page-tab=all&selectall=1#posttype-user-pages' ) ); ?>" class="select-all"> <?php esc\_html\_e( 'Select All', 'user-pages-to-menu' ); ?></a> |
| [1850](#L1850) | </span> |
| [1851](#L1851) | <span class="add-to-menu"> |
| [1852](#L1852) | <input type="submit" class="button-secondary submit-add-to-menu right" value="<?php esc\_attr\_e( 'Add to Menu', 'user-pages-to-menu' ); ?>" name="add-post-type-menu-item" id="submit-posttype-user-pages"> |
| [1853](#L1853) | <span class="spinner"></span> |
| [1854](#L1854) | </span> |
| [1855](#L1855) | </p> |
| [1856](#L1856) | </div> |
| [1857](#L1857) | <?php |
| [1858](#L1858) | } |
| [1859](#L1859) |  |
| [1860](#L1860) | public function pg\_create\_group\_page() { |
| [1861](#L1861) | if ( ! isset( $\_POST['nonce'] ) || ! wp\_verify\_nonce( sanitize\_key( $\_POST['nonce'] ), 'ajax-nonce' ) ) { |
| [1862](#L1862) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [1863](#L1863) | } |
| [1864](#L1864) |  |
| [1865](#L1865) | if ( current\_user\_can( 'manage\_options' ) ) |
| [1866](#L1866) | { |
| [1867](#L1867) | $dbhandler  = new PM\_DBhandler(); |
| [1868](#L1868) | $gid        = filter\_input( INPUT\_POST, 'gid' ); |
| [1869](#L1869) | $identifier = 'GROUPS'; |
| [1870](#L1870) | $row        = $dbhandler->get\_row( $identifier, $gid ); |
| [1871](#L1871) | if ( $row->group\_options != '' ) { |
| [1872](#L1872) | $group\_options = maybe\_unserialize( $row->group\_options ); |
| [1873](#L1873) | } |
| [1874](#L1874) |  |
| [1875](#L1875) | $group\_name = 'User Group - ' . $dbhandler->get\_value( 'GROUPS', 'group\_name', $gid ); |
| [1876](#L1876) | $arg = array( |
| [1877](#L1877) | 'post\_type'    => 'page', |
| [1878](#L1878) | 'post\_title'   => $group\_name, |
| [1879](#L1879) | 'post\_status'  => 'publish', |
| [1880](#L1880) | 'post\_content' => '[profilegrid\_register gid="' . $gid . '"]', |
| [1881](#L1881) | ); |
| [1882](#L1882) |  |
| [1883](#L1883) | $arg = apply\_filters( 'pm\_group\_registration\_form', $arg, $gid, $group\_name, $group\_options ); |
| [1884](#L1884) |  |
| [1885](#L1885) | $id         = wp\_insert\_post( $arg ); |
| [1886](#L1886) |  |
| [1887](#L1887) | $group\_options['group\_page'] = $id; |
| [1888](#L1888) | $options                     = maybe\_serialize( $group\_options ); |
| [1889](#L1889) | $data                        = array( 'group\_options' => $options ); |
| [1890](#L1890) | $args                        = array( '%s' ); |
| [1891](#L1891) | $dbhandler->update\_row( $identifier, 'id', $gid, $data, $args, '%d' ); |
| [1892](#L1892) |  |
| [1893](#L1893) | echo esc\_html( $id ); |
| [1894](#L1894) | } |
| [1895](#L1895) | die; |
| [1896](#L1896) | } |
| [1897](#L1897) |  |
| [1898](#L1898) | public function pg\_action\_user\_edit\_form\_tag() { |
| [1899](#L1899) | echo ' enctype="multipart/form-data"'; |
| [1900](#L1900) | } |
| [1901](#L1901) |  |
| [1902](#L1902) | public function pm\_remove\_file\_attachment() { |
| [1903](#L1903) | // Verify the nonce for security |
| [1904](#L1904) | if ( ! isset( $\_POST['nonce'] ) || ! wp\_verify\_nonce( sanitize\_key( $\_POST['nonce'] ), 'ajax-nonce' ) ) { |
| [1905](#L1905) | echo esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ); |
| [1906](#L1906) | die; |
| [1907](#L1907) | } |
| [1908](#L1908) | // Get the inputs securely |
| [1909](#L1909) | $key    = sanitize\_text\_field( filter\_input( INPUT\_POST, 'key', FILTER\_SANITIZE\_STRING ) ); |
| [1910](#L1910) | $value  = sanitize\_text\_field( filter\_input( INPUT\_POST, 'value', FILTER\_SANITIZE\_STRING ) ); |
| [1911](#L1911) | $userid = absint( filter\_input( INPUT\_POST, 'uid', FILTER\_SANITIZE\_NUMBER\_INT ) ); |
| [1912](#L1912) |  |
| [1913](#L1913) | $current\_user\_id = get\_current\_user\_id(); |
| [1914](#L1914) |  |
| [1915](#L1915) | if($current\_user\_id===$userid || current\_user\_can('manage\_option')) |
| [1916](#L1916) | { |
| [1917](#L1917) | $user\_attachments = get\_user\_meta( $userid, $key, true ); |
| [1918](#L1918) | if ( $user\_attachments != '' ) { |
| [1919](#L1919) | $old\_attachments = explode( ',', $user\_attachments ); |
| [1920](#L1920) | $index           = array\_search( $value, $old\_attachments, true ); |
| [1921](#L1921) | unset( $old\_attachments[ $index ] ); |
| [1922](#L1922) | } |
| [1923](#L1923) | if ( empty( $old\_attachments ) ) { |
| [1924](#L1924) | $val = delete\_user\_meta( $userid, $key ); |
| [1925](#L1925) | } else { |
| [1926](#L1926) | $ids = implode( ',', $old\_attachments ); |
| [1927](#L1927) | $val = update\_user\_meta( $userid, $key, $ids ); |
| [1928](#L1928) |  |
| [1929](#L1929) | } |
| [1930](#L1930) | echo esc\_html( $val ); |
| [1931](#L1931) | } |
| [1932](#L1932) | die; |
| [1933](#L1933) | } |
| [1934](#L1934) |  |
| [1935](#L1935) | public function profile\_magic\_premium\_setting\_option() { |
| [1936](#L1936) | include 'partials/premium\_setting\_option.php'; |
| [1937](#L1937) | } |
| [1938](#L1938) |  |
| [1939](#L1939) | public function pm\_change\_users\_blog\_post\_types\_slug( $args, $post\_type ) { |
| [1940](#L1940) | $dbhandler      = new PM\_DBhandler(); |
| [1941](#L1941) | $newslug         = $dbhandler->get\_global\_option\_value( 'pm\_blog\_base', 'profilegrid\_blogs' ); |
| [1942](#L1942) | $group\_wall\_base = $dbhandler->get\_global\_option\_value( 'pm\_group\_wall\_base', 'pg\_groupwalls' ); |
| [1943](#L1943) | /\*item post type slug\*/ |
| [1944](#L1944) | if ( 'profilegrid\_blogs' === $post\_type && $newslug != 'profilegrid\_blogs' ) { |
| [1945](#L1945) | $args['rewrite']['slug'] = $newslug; |
| [1946](#L1946) | } |
| [1947](#L1947) |  |
| [1948](#L1948) | if ( class\_exists( 'Profilegrid\_Group\_Wall' ) && 'pg\_groupwalls' === $post\_type && $group\_wall\_base != 'pg\_groupwalls' ) { |
| [1949](#L1949) | $args['rewrite']['slug'] = $group\_wall\_base; |
| [1950](#L1950) | } |
| [1951](#L1951) | return $args; |
| [1952](#L1952) | } |
| [1953](#L1953) |  |
| [1954](#L1954) | public function pm\_save\_custom\_permalink\_option() { |
| [1955](#L1955) | if ( ! is\_admin() ) { |
| [1956](#L1956) | return; |
| [1957](#L1957) | } |
| [1958](#L1958) | $nonce = filter\_input( INPUT\_POST, 'pg-permalinks-nonce' ); |
| [1959](#L1959) | if ( !isset( $nonce ) || !wp\_verify\_nonce( $nonce, 'pg-permalinks' ) ) { |
| [1960](#L1960) | return; |
| [1961](#L1961) | } |
| [1962](#L1962) | $pm\_sanitizer = new PM\_sanitizer(); |
| [1963](#L1963) | $post         = $pm\_sanitizer->sanitize( $\_POST ); |
| [1964](#L1964) | if ( isset( $post['permalink\_structure'], $post['pm\_blog\_base'] ) ) { |
| [1965](#L1965) | $dbhandler = new PM\_DBhandler(); |
| [1966](#L1966) | $dbhandler->update\_global\_option\_value( 'pm\_blog\_base', $post['pm\_blog\_base'] ); |
| [1967](#L1967) |  |
| [1968](#L1968) | if ( isset( $post['pm\_group\_wall\_base'] ) ) { |
| [1969](#L1969) | $dbhandler->update\_global\_option\_value( 'pm\_group\_wall\_base', $post['pm\_group\_wall\_base'] ); |
| [1970](#L1970) | } |
| [1971](#L1971) | } |
| [1972](#L1972) | } |
| [1973](#L1973) |  |
| [1974](#L1974) | public function pm\_custom\_permalink\_option() { |
| [1975](#L1975) | /\* Create settings section \*/ |
| [1976](#L1976) |  |
| [1977](#L1977) | add\_settings\_section( |
| [1978](#L1978) | 'profilegrid\_permalink\_section', // ID |
| [1979](#L1979) | 'ProfileGrid User Blogs System Settings ', // Section title |
| [1980](#L1980) | array( $this, 'pg\_permalink\_html' ), // Callback for your function |
| [1981](#L1981) | 'permalink' // Location (Settings > Permalinks) |
| [1982](#L1982) | ); |
| [1983](#L1983) |  |
| [1984](#L1984) | /\* Create settings field \*/ |
| [1985](#L1985) | add\_settings\_field( |
| [1986](#L1986) | 'pm\_blog\_base',       // Field ID |
| [1987](#L1987) | 'User Blogs Base',       // Field title |
| [1988](#L1988) | array( $this, 'pm\_blog\_base\_callback' ), // Field callback function |
| [1989](#L1989) | 'permalink',                    // Settings page slug |
| [1990](#L1990) | 'profilegrid\_permalink\_section'               // Section ID |
| [1991](#L1991) | ); |
| [1992](#L1992) |  |
| [1993](#L1993) | if ( class\_exists( 'Profilegrid\_Group\_Wall' ) ) { |
| [1994](#L1994) | /\* Create settings field \*/ |
| [1995](#L1995) | add\_settings\_field( |
| [1996](#L1996) | 'pm\_group\_wall\_base',       // Field ID |
| [1997](#L1997) | 'Group Wall Base',       // Field title |
| [1998](#L1998) | array( $this, 'pm\_group\_wall\_base\_callback' ), // Field callback function |
| [1999](#L1999) | 'permalink',                    // Settings page slug |
| [2000](#L2000) | 'profilegrid\_permalink\_section'               // Section ID |
| [2001](#L2001) | ); |
| [2002](#L2002) | } |
| [2003](#L2003) |  |
| [2004](#L2004) | } |
| [2005](#L2005) |  |
| [2006](#L2006) | public function pg\_permalink\_html() { |
| [2007](#L2007) | echo esc\_html\_\_( 'You can define the slugs for posts created through ProfileGrid’s native user blogs system and Group Wall extension.', 'profilegrid-user-profiles-groups-and-communities' ); |
| [2008](#L2008) | } |
| [2009](#L2009) |  |
| [2010](#L2010) |  |
| [2011](#L2011) |  |
| [2012](#L2012) | /\* Settings Field Callback \*/ |
| [2013](#L2013) | public function pm\_blog\_base\_callback() { |
| [2014](#L2014) |  |
| [2015](#L2015) | $dbhandler     = new PM\_DBhandler(); |
| [2016](#L2016) | $blog\_base = $dbhandler->get\_global\_option\_value( 'pm\_blog\_base', 'profilegrid\_blogs' ); |
| [2017](#L2017) | ?> |
| [2018](#L2018) | <label for="pm\_blog\_base"> |
| [2019](#L2019) | <input name="pm\_blog\_base" id="pm\_blog\_base" type="text" value="<?php echo esc\_attr( $blog\_base ); ?>" class="regular-text code" autocomplete="off"> |
| [2020](#L2020) | </label> |
| [2021](#L2021) | <?php |
| [2022](#L2022) | wp\_nonce\_field( 'pg-permalinks', 'pg-permalinks-nonce' ); |
| [2023](#L2023) | } |
| [2024](#L2024) |  |
| [2025](#L2025) | /\* Settings Field Callback \*/ |
| [2026](#L2026) | public function pm\_group\_wall\_base\_callback() { |
| [2027](#L2027) | $dbhandler       = new PM\_DBhandler(); |
| [2028](#L2028) | $group\_wall\_base = $dbhandler->get\_global\_option\_value( 'pm\_group\_wall\_base', 'pg\_groupwalls' ); |
| [2029](#L2029) | ?> |
| [2030](#L2030) | <label for="pm\_group\_wall\_base"> |
| [2031](#L2031) | <input name="pm\_group\_wall\_base" id="pm\_group\_wall\_base" type="text" value="<?php echo esc\_attr( $group\_wall\_base ); ?>" class="regular-text code" autocomplete="off"> |
| [2032](#L2032) | </label> |
| [2033](#L2033) | <?php |
| [2034](#L2034) | } |
| [2035](#L2035) |  |
| [2036](#L2036) | public function pm\_wizard\_update\_group\_icon() |
| [2037](#L2037) | { |
| [2038](#L2038) | if ( ! isset( $\_POST['nonce'] ) || ! wp\_verify\_nonce( sanitize\_key( $\_POST['nonce'] ), 'ajax-nonce' ) ) { |
| [2039](#L2039) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [2040](#L2040) | } |
| [2041](#L2041) |  |
| [2042](#L2042) | if ( current\_user\_can( 'manage\_options' ) ) |
| [2043](#L2043) | { |
| [2044](#L2044) | $dbhandler = new PM\_DBhandler(); |
| [2045](#L2045) | $gid        = filter\_input( INPUT\_POST, 'gid' ); |
| [2046](#L2046) | $group\_icon = filter\_input( INPUT\_POST, 'group\_icon' ); |
| [2047](#L2047) | $data       = array( 'group\_icon' => $group\_icon ); |
| [2048](#L2048) | $dbhandler->update\_row( 'GROUPS', 'id', $gid, $data ); |
| [2049](#L2049) | } |
| [2050](#L2050) | die; |
| [2051](#L2051) | } |
| [2052](#L2052) |  |
| [2053](#L2053) | public function pm\_submit\_group\_wizard\_form() { |
| [2054](#L2054) | $dbhandler      = new PM\_DBhandler(); |
| [2055](#L2055) | $pm\_activator    = new Profile\_Magic\_Activator(); |
| [2056](#L2056) | $pmrequests      = new PM\_request(); |
| [2057](#L2057) | $identifier      = 'GROUPS'; |
| [2058](#L2058) | $retrieved\_nonce = filter\_input( INPUT\_POST, '\_wpnonce' ); |
| [2059](#L2059) | if ( ! wp\_verify\_nonce( $retrieved\_nonce, 'pm\_group\_wizard\_form' ) ) { |
| [2060](#L2060) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [2061](#L2061) | } |
| [2062](#L2062) | $groupid = filter\_input( INPUT\_POST, 'group\_id' ); |
| [2063](#L2063) | $exclude = array( '\_wpnonce', '\_wp\_http\_referer', 'submit\_group', 'group\_id', 'pg-switch-two', 'action' ); |
| [2064](#L2064) |  |
| [2065](#L2065) | $post = $pmrequests->sanitize\_request( $\_POST, $identifier, $exclude ); |
| [2066](#L2066) |  |
| [2067](#L2067) | if ( $post != false ) { |
| [2068](#L2068) | foreach ( $post as $key => $value ) { |
| [2069](#L2069) | $data[ $key ] = $value; |
| [2070](#L2070) | $arg[]        = $pm\_activator->get\_db\_table\_field\_type( $identifier, $key ); |
| [2071](#L2071) | } |
| [2072](#L2072) | } |
| [2073](#L2073) |  |
| [2074](#L2074) | $gid = $groupid; |
| [2075](#L2075) | $dbhandler->update\_row( $identifier, 'id', $groupid, $data, $arg, '%d' ); |
| [2076](#L2076) | die; |
| [2077](#L2077) | } |
| [2078](#L2078) |  |
| [2079](#L2079) | public function pm\_get\_groups\_details() { |
| [2080](#L2080) | if ( ! isset( $\_POST['nonce'] ) || ! wp\_verify\_nonce( sanitize\_key( $\_POST['nonce'] ), 'ajax-nonce' ) ) { |
| [2081](#L2081) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [2082](#L2082) | } |
| [2083](#L2083) |  |
| [2084](#L2084) | $dbhandler   = new PM\_DBhandler(); |
| [2085](#L2085) | $identifier     = 'GROUPS'; |
| [2086](#L2086) | $pmrequests = new PM\_request(); |
| [2087](#L2087) | $pm\_sanitizer   = new PM\_sanitizer(); |
| [2088](#L2088) | $path       = plugin\_dir\_url( \_\_FILE\_\_ ); |
| [2089](#L2089) |  |
| [2090](#L2090) |  |
| [2091](#L2091) | $post = $pm\_sanitizer->sanitize( $\_POST ); |
| [2092](#L2092) | if ( isset( $post['gids'] ) && ! empty( $post['gids'] ) ) { |
| [2093](#L2093) | foreach ( $post['gids'] as $gid ) { |
| [2094](#L2094) | $row              = $dbhandler->get\_row( $identifier, $gid ); |
| [2095](#L2095) | $meta\_query\_array = $pmrequests->pm\_get\_user\_meta\_query( array( 'gid' => $row->id ) ); |
| [2096](#L2096) | $user\_query       = $dbhandler->pm\_get\_all\_users\_ajax( '', $meta\_query\_array, '', 0, 6, 'DESC', 'ID' ); |
| [2097](#L2097) | $total\_users      = $user\_query->get\_total(); |
| [2098](#L2098) | echo '<div class="pg-box-row pg-box-center pg-card-mb-16">'; |
| [2099](#L2099) | echo '<input type="hidden" name="selected[]" value="' . esc\_attr( $row->id ) . '" />'; |
| [2100](#L2100) | echo '<div class="pg-group-row-icon pg-box-col-2">'; |
| [2101](#L2101) |  |
| [2102](#L2102) | if ( ! empty( $row ) && $row->group\_icon != 0 ) { |
| [2103](#L2103) | echo wp\_get\_attachment\_link( $row->group\_icon, array( 50, 50 ), false, true, false ); |
| [2104](#L2104) | } else { |
| [2105](#L2105) | ?> |
| [2106](#L2106) | <img src="<?php echo esc\_url( $path . 'partials/images/pg-icon.png' ); ?>" /> |
| [2107](#L2107) | <?php |
| [2108](#L2108) | } |
| [2109](#L2109) | echo '</div>'; |
| [2110](#L2110) | echo '<div class="pg-group-row-meta pg-box-col-10">'; |
| [2111](#L2111) | echo '<div class="pg-group-card-title">' . esc\_html( $row->group\_name ) . '</div>'; |
| [2112](#L2112) | echo '<div class="pg-group-card-subtitle">' . esc\_html( $total\_users ) . ' ' . esc\_html\_\_( 'members', 'profilegrid-user-profiles-groups-and-communities' ) . '</div>'; |
| [2113](#L2113) | echo '</div>'; |
| [2114](#L2114) | echo '</div>'; |
| [2115](#L2115) | } |
| [2116](#L2116) | } |
| [2117](#L2117) | die; |
| [2118](#L2118) | } |
| [2119](#L2119) |  |
| [2120](#L2120) | public function pg\_customization\_extension\_html() |
| [2121](#L2121) | { |
| [2122](#L2122) | $path  =  plugin\_dir\_url( \_\_FILE\_\_ ); |
| [2123](#L2123) | ?> |
| [2124](#L2124) | <div class="pg-box-col-4 pg-card-mb-16 pg-ext-card "> |
| [2125](#L2125) | <div class="pg-box-border pg-box-p-18 pg-box-white-bg pg-box-h-100"> |
| [2126](#L2126) | <div class="pg-box-row pg-box-h-100"> |
| [2127](#L2127) | <div class="pg-box-col-8"> |
| [2128](#L2128) | <div class="pg-ext-box-title"><?php echo esc\_html\_\_('Build a custom extension', 'profilegrid-user-profiles-groups-and-communities'); ?></div> |
| [2129](#L2129) | <div class="pg-ext-installation-status"><span class="pg-ext-not-installed">Request a Quote</span></div> |
| [2130](#L2130) | <div class="pg-ext-box-description"> |
| [2131](#L2131) | <p class="pg-col-desc"><?php echo esc\_html\_\_('Have our team build a custom extension for you to meet your specific needs.', 'profilegrid-user-profiles-groups-and-communities'); ?></p> |
| [2132](#L2132) | <p class="authors" style="display:none"> <cite><?php esc\_html\_e('By', 'profilegrid-user-profiles-groups-and-communities'); ?> <a target="\_blank" href="https://profilegrid.co/extensions/"><?php esc\_html\_e('ProfileGrid', 'profilegrid-user-profiles-groups-and-communities'); ?></a></cite></p> |
| [2133](#L2133) | </div> |
| [2134](#L2134) | <div class="pg-ext-box-button"> |
| [2135](#L2135) | <a class="pg-install-now-btn pg-more-info" target="\_blank" href="https://profilegrid.co/help-support/customizations/"> <?php esc\_html\_e('Get Help Now', 'profilegrid-user-profiles-groups-and-communities'); ?></a> |
| [2136](#L2136) | </div> |
| [2137](#L2137) | </div> |
| [2138](#L2138) | <div class="pg-box-col-4 pg-d-flex pg-d-flex-v-center pg-flex-direction-col"> |
| [2139](#L2139) | <div class="pg-ext-box-icon"> <img src="<?php echo esc\_url($path); ?>partials/images/pg-customization-icon.png" class="pg-ext-icon" alt=""></div> |
| [2140](#L2140) | </div> |
| [2141](#L2141) | </div> |
| [2142](#L2142) | </div> |
| [2143](#L2143) | </div> |
| [2144](#L2144) | <?php |
| [2145](#L2145) | } |
| [2146](#L2146) |  |
| [2147](#L2147) | public function profilegrid\_activate\_license() |
| [2148](#L2148) | { |
| [2149](#L2149) | $retrieved\_nonce = filter\_input( INPUT\_POST, 'nonce' ); |
| [2150](#L2150) | if ( !wp\_verify\_nonce( $retrieved\_nonce, 'pg-license-nonce' ) ) { |
| [2151](#L2151) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [2152](#L2152) | } |
| [2153](#L2153) | $dbhandler   = new PM\_DBhandler(); |
| [2154](#L2154) | $pg\_license\_activate = sanitize\_text\_field(filter\_input( INPUT\_POST, 'pg\_license\_activate' )); |
| [2155](#L2155) | $license\_key = sanitize\_text\_field(filter\_input( INPUT\_POST, 'pg\_license' )); |
| [2156](#L2156) | $item\_id = sanitize\_text\_field(filter\_input( INPUT\_POST, 'pg\_item\_id' )); |
| [2157](#L2157) | $item\_key = sanitize\_text\_field(filter\_input( INPUT\_POST, 'pg\_item\_key' )); |
| [2158](#L2158) | $dbhandler->update\_global\_option\_value( $item\_key.'\_license\_key', $license\_key ); |
| [2159](#L2159) | $dbhandler->update\_global\_option\_value( $item\_key.'\_license\_id', $item\_id ); |
| [2160](#L2160) |  |
| [2161](#L2161) |  |
| [2162](#L2162) | $response = array(); |
| [2163](#L2163) | if( isset( $pg\_license\_activate ) && ! empty( $pg\_license\_activate ) ){ |
| [2164](#L2164) | $license = new Profile\_Magic\_License(); |
| [2165](#L2165) | $response = $license->pg\_activate\_license($license\_key,$item\_id,$item\_key); |
| [2166](#L2166) | wp\_send\_json\_success( $response ); |
| [2167](#L2167) | } |
| [2168](#L2168) | else |
| [2169](#L2169) | { |
| [2170](#L2170) | wp\_send\_json\_error( array( 'message' => esc\_html\_\_( 'Security check failed. Please refresh the page and try again later.', 'profilegrid-user-profiles-groups-and-communities' ) ) ); |
| [2171](#L2171) | } |
| [2172](#L2172) |  |
| [2173](#L2173) | } |
| [2174](#L2174) |  |
| [2175](#L2175) | public function profilegrid\_deactivate\_license(){ |
| [2176](#L2176) |  |
| [2177](#L2177) | $retrieved\_nonce = filter\_input( INPUT\_POST, 'nonce' ); |
| [2178](#L2178) | if ( !wp\_verify\_nonce( $retrieved\_nonce, 'pg-license-nonce' ) ) { |
| [2179](#L2179) | die( esc\_html\_\_( 'Failed security check', 'profilegrid-user-profiles-groups-and-communities' ) ); |
| [2180](#L2180) | } |
| [2181](#L2181) | $dbhandler   = new PM\_DBhandler(); |
| [2182](#L2182) | $pg\_license\_deactivate = sanitize\_text\_field(filter\_input( INPUT\_POST, 'pg\_license\_deactivate' )); |
| [2183](#L2183) | $license\_key = sanitize\_text\_field(filter\_input( INPUT\_POST, 'pg\_license' )); |
| [2184](#L2184) | $item\_id = sanitize\_text\_field(filter\_input( INPUT\_POST, 'pg\_item\_id' )); |
| [2185](#L2185) | $item\_key = sanitize\_text\_field(filter\_input( INPUT\_POST, 'pg\_item\_key' )); |
| [2186](#L2186) | $dbhandler->update\_global\_option\_value( $item\_key.'\_license\_key', $license\_key ); |
| [2187](#L2187) | $dbhandler->update\_global\_option\_value( $item\_key.'\_license\_id', $item\_id ); |
| [2188](#L2188) | $response = array(); |
| [2189](#L2189) | if( isset( $pg\_license\_deactivate ) && ! empty( $pg\_license\_deactivate ) ){ |
| [2190](#L2190) | $license = new Profile\_Magic\_License(); |
| [2191](#L2191) | $response = $license->pg\_deactivate\_license($license\_key,$item\_id,$item\_key); |
| [2192](#L2192) | wp\_send\_json\_success( $response ); |
| [2193](#L2193) | } |
| [2194](#L2194) | else |
| [2195](#L2195) | { |
| [2196](#L2196) | wp\_send\_json\_error( array( 'message' => esc\_html\_\_( 'Security check failed. Please refresh the page and try again later.', 'profilegrid-user-profiles-groups-and-communities' ) ) ); |
| [2197](#L2197) | } |
| [2198](#L2198) |  |
| [2199](#L2199) | } |
| [2200](#L2200) |  |
| [2201](#L2201) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php?format=txt)
* [Original Format](/export/3220813/profilegrid-user-profiles-groups-and-communities/trunk/admin/class-profile-magic-admin.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


