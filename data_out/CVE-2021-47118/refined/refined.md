```
{
  "vulnerability": {
    "root_cause": "The `cad_pid` variable, which stores the PID of the init task, was not properly initialized with a reference count. During boot, it was directly assigned the init task's struct pid using `task_pid(current)` which doesn't increment the reference count. Later, when the `cad_pid` is changed via a sysctl, the old `cad_pid`'s refcount is decremented, which can lead to the init task's pid struct being freed prematurely.",
    "weaknesses": [
      "Use-after-free vulnerability due to incorrect reference counting of the init task's PID.",
      "Improper initialization of a resource (PID struct) leading to premature deallocation."
    ],
    "impact": "A use-after-free vulnerability, potentially leading to a kernel crash. The vulnerability can be triggered during signal delivery.",
    "attack_vectors": "The vulnerability is triggered by changing the `cad_pid` via a sysctl which calls `proc_do_cad_pid()` to modify the variable.",
     "required_attacker_capabilities": "An attacker needs the capability to write to the `/proc/sys/kernel/cad_pid` sysctl, which usually requires root or elevated privileges. The attacker also needs to trigger the use-after-free condition by forcing the system to perform operations that use the dangling pid reference. In this case, delivering signals is mentioned as a possible trigger."
  },
  "patches": [
    {
      "commit_id": "0711f0d7050b9e07c44bc159bbc64ac0a1022c7f",
      "description": "Fixes the issue by getting a reference to the init task's struct pid when assigning it to `cad_pid`. This is done by changing `cad_pid = task_pid(current);` to `cad_pid = get_pid(task_pid(current));`",
        "file_changes": [
        {
          "file_path": "init/main.c",
          "insertions": 1,
          "deletions": 1
        }
      ]
    },
        {
      "commit_id": "4dbd8808a591b49b717862e6e0081bcf14a87788",
      "description": "Fixes the issue by getting a reference to the init task's struct pid when assigning it to `cad_pid`. This is done by changing `cad_pid = task_pid(current);` to `cad_pid = get_pid(task_pid(current));`",
            "file_changes": [
        {
          "file_path": "init/main.c",
          "insertions": 1,
          "deletions": 1
        }
      ]
    },
    {
      "commit_id": "764c2e892d1fe895392aff62fb353fdce43bb529",
      "description": "Fixes the issue by getting a reference to the init task's struct pid when assigning it to `cad_pid`. This is done by changing `cad_pid = task_pid(current);` to `cad_pid = get_pid(task_pid(current));`",
            "file_changes": [
        {
          "file_path": "init/main.c",
          "insertions": 1,
          "deletions": 1
        }
      ]
    },
      {
      "commit_id": "f86c80515a8a3703e0ca2e56deb50fc2879c5ea4",
      "description": "Fixes the issue by getting a reference to the init task's struct pid when assigning it to `cad_pid`. This is done by changing `cad_pid = task_pid(current);` to `cad_pid = get_pid(task_pid(current));`",
            "file_changes": [
        {
          "file_path": "init/main.c",
          "insertions": 1,
          "deletions": 1
        }
      ]
    },
        {
      "commit_id": "7178be006d495ffb741c329012da289b62dddfe6",
      "description": "Fixes the issue by getting a reference to the init task's struct pid when assigning it to `cad_pid`. This is done by changing `cad_pid = task_pid(current);` to `cad_pid = get_pid(task_pid(current));`",
            "file_changes": [
        {
          "file_path": "init/main.c",
          "insertions": 1,
          "deletions": 1
        }
      ]
    },
          {
      "commit_id": "2cd6eedfa6344f5ef5c3dac3aee57a39b5b46dff",
      "description": "Fixes the issue by getting a reference to the init task's struct pid when assigning it to `cad_pid`. This is done by changing `cad_pid = task_pid(current);` to `cad_pid = get_pid(task_pid(current));`",
            "file_changes": [
        {
          "file_path": "init/main.c",
          "insertions": 1,
          "deletions": 1
        }
      ]
    },
    {
      "commit_id": "b8ff869f20152fbe66b6c2e2715d26a2f9897cca",
      "description": "Fixes the issue by getting a reference to the init task's struct pid when assigning it to `cad_pid`. This is done by changing `cad_pid = task_pid(current);` to `cad_pid = get_pid(task_pid(current));`",
            "file_changes": [
        {
          "file_path": "init/main.c",
          "insertions": 1,
          "deletions": 1
        }
      ]
    },
        {
      "commit_id": "d106f05432e60f9f62d456ef017687f5c73cb414",
      "description": "Fixes the issue by getting a reference to the init task's struct pid when assigning it to `cad_pid`. This is done by changing `cad_pid = task_pid(current);` to `cad_pid = get_pid(task_pid(current));`",
            "file_changes": [
        {
          "file_path": "init/main.c",
          "insertions": 1,
          "deletions": 1
        }
      ]
    }
  ]
}
```