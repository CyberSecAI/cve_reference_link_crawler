
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>
Issue 42051: [security] Avoid plistlib XML vulnerabilities by rejecting entity directives - Python tracker

</title>
<link rel="shortcut icon" href="@@file/favicon.ico" />
<link rel="stylesheet" type="text/css" href="@@file/main.css" />
<link rel="stylesheet" type="text/css" href="@@file/style.css" />
<link rel="search" type="application/opensearchdescription+xml" href="@@file/osd.xml" title="Python bug tracker search" />
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script nonce="86bc91f03a1423337f2ebadcefe288ed5006ce26abac47e0673af2c99f2d99ff" type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        return false;
    }
    submitted = true;
    return true;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('https://bugs.python.org/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
    HelpWin.focus ()
}
</script>


<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.js"></script>
<script type="text/javascript" src="@@file/issue.item.js"></script>
<link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/smoothness/jquery-ui.css" />


</head>
<body>
  <!--  Logo  -->
  <h1 id="logoheader">
    <a accesskey="1" href="." id="logolink">
       <img src="@@file/python-logo.gif" alt="homepage" border="0" id="logo" /></a>
  </h1>

<div id="utility-menu">
<!-- Search Box -->
<div id="searchbox">
    <form name="searchform" method="get" action="issue" id="searchform">
      <div id="search">
       <input type="hidden" name="@columns"
              value="id,github,activity,title,creator,assignee,status,type" />
       <input type="hidden" name="@sort" value="-activity" />
       <input type="hidden" name="@filter" value="status" />
       <input type="hidden" name="@action" value="searchid" />
       <input type="hidden" name="ignore" value="file:content" />
       <input class="input-text" id="search-text"
              name="@search_text" size="10" />
       <input type="submit" id="submit" value="search" name="submit" class="input-button" />
       <input type="radio" name="status"
              id="status_notresolved" value="-1,1,3" />
       <label for="status_notresolved">open</label>
       <input type="radio" name="status" checked="checked"
              id="status_all" value="-1,1,2,3" />
       <label for="status_all">all</label>
      </div>
     </form>
</div>
</div>


<div id="left-hand-navigation">
<!--  Main Menu NEED LEVEL TWO HEADER AND FOOTER -->
<div id="menu">
  <ul class="level-one">
    <li><a href="https://www.python.org/" title="Go to the Python homepage">Python Home</a></li>
    <li><a href="https://www.python.org/about/" title="About The Python Language">About</a></li>
    <li><a href="https://www.python.org/blogs/" title="">News</a></li>
    <li><a href="https://www.python.org/doc/" title="">Documentation</a></li>
    <li><a href="https://www.python.org/downloads/" title="">Downloads</a></li>
    <li><a href="https://www.python.org/community/" title="">Community</a></li>
    <li><a href="https://www.python.org/psf/" title="Python Software Foundation">Foundation</a></li>
    <li><a href="https://devguide.python.org/" title="Python Developer's Guide">Developer's Guide</a></li>
    <li class="selected"><a href="." class="selected" title="Python Issue Tracker">Issue Tracker</a>
      <ul class="level-two">
        <li>
          <strong>Issues</strong>
          <ul class="level-three">
            
            <li><a href="issue?@template=search&amp;status=1">Search</a></li>
            <li><a href="issue?@action=random">Random Issue</a></li>
            <li>
              <form method="post" action="issue42051">
                <input type="submit" class="form-small"
                       value="Show issue:" />
                <input class="form-small" size="4" type="text" name="@number" />
                <input type="hidden" name="@type" value="issue" />
                <input type="hidden" name="@action" value="show" />
              </form>
            </li>
          </ul>
        </li>


        <li>
          <strong>Summaries</strong>
          <ul class="level-three">
            

            

            

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cgithub%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Issues%20with%20patch&amp;@startwith=0&amp;@group=priority&amp;keywords=2&amp;@action=search&amp;@filter=&amp;@pagesize=50">Issues with patch</a>
            </li>

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cgithub%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Easy%20issues&amp;@startwith=0&amp;@group=priority&amp;keywords=6&amp;@action=search&amp;@filter=&amp;@pagesize=50">Easy issues</a>
            </li>

            <li>
              <a href="issue?@template=stats">Stats</a>
            </li>

          </ul>
        </li>


        <li>
          <strong>User</strong>
          <form method="post" action="issue42051">
          <ul class="level-three">
            <li>
                Login<br />
                <input size="10" name="openid_identifier" style="" /><br />
                <input size="10" type="password" name="__login_password" /><br />
                <input type="hidden" name="@action" value="Login" />
                <input type="checkbox" name="remember" id="remember" />
                <label for="remember">Remember me?</label><br />
                <input class="form-small" type="submit"
                       value="Login" /><br />
                <input type="hidden" name="__came_from"
                       value="https://bugs.python.org/issue42051?">
                
                <input type="hidden" name="@sort" value=""/>
<input type="hidden" name="@group" value=""/>
<input type="hidden" name="@pagesize" value="50"/>
<input type="hidden" name="@startwith" value="0"/>
            </li>
            <li>
                
            </li>
            <li><a href="user?@template=forgotten">Lost&nbsp;your&nbsp;login?</a></li>
          </ul>
          </form>
        </li>

        

        

        <li>
          <strong>Administration</strong>
          <ul class="level-three">
            
            <li>
                <a href="user?@sort=username">User List</a></li>
            <li>
                <a href="user?iscommitter=1&amp;@action=search&amp;@sort=username&amp;@pagesize=300">Committer List</a></li>
            
            
            
          </ul>
        </li>

        <li>
          <strong>Help</strong>
          <ul class="level-three">
            <li><a href="http://docs.python.org/devguide/triaging.html">
                Tracker Documentation</a></li>
            <li><a href="http://wiki.python.org/moin/TrackerDevelopment">
                Tracker Development</a></li>
            <li><a href="https://github.com/python/psf-infra-meta/issues">
                Report Tracker Problem</a></li>
          </ul>
        </li>

      </ul>
    </li>
  </ul>
</div> <!-- menu -->
</div> <!-- left-hand-navigation -->

<div id="content-body">
<div id="body-main">
<div id="content">
<div id="breadcrumb">
 
 
 Issue42051
 
</div>
<div id="migration-notice">
    <div id="migration-images">
        <img width="32" src="@@file/python-logo-small.png" />
        âžœ
        <a href="https://github.com/python/cpython/issues"><img width="32" src="@@file/gh-icon.png" /></a>
    </div>
    <p>This issue tracker <b>has been migrated to <a href="https://github.com/python/cpython/issues">GitHub</a></b>,
    and is currently <b>read-only</b>.<br />
    For more information, <a title="GitHub FAQs" href="https://devguide.python.org/gh-faq/">
    see the GitHub FAQs in the Python's Developer Guide.</a></p>
</div>
 
 





<div>

<form method="post" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue42051">

<div id="gh-issue-link">
    <a href="https://github.com/python/cpython/issues/86217">
        <img width="32" src="@@file/gh-icon.png" />
        <p>
            <span>This issue has been migrated to GitHub:</span>
            https://github.com/python/cpython/issues/86217
        </p>
    </a>
</div>

<fieldset><legend>classification</legend>
<table class="form">
<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#title" target="_blank">Title</a>:</th>
 
 <td colspan="3">
  <span>[security] Avoid plistlib XML vulnerabilities by rejecting entity directives</span>
  <input type="hidden" name="title"
         value="[security] Avoid plistlib XML vulnerabilities by rejecting entity directives">
 </td>
</tr>

<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#type" target="_blank">Type</a>:</th>
 <td>security</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#stage" target="_blank">Stage</a>:</th>
 <td>resolved</td>
</tr>

<tr>
 <th><a href="http://docs.python.org/devguide/triaging.html#components" target="_blank">Components</a>:</th>
 <td>Library (Lib)</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#versions" target="_blank">Versions</a>:</th>
 <td>Python 3.10, Python 3.9, Python 3.8, Python 3.7, Python 3.6</td>
</tr>
</table>
</fieldset>

<fieldset><legend>process</legend>
<table class="form">
<tr>
  <th><a href="http://docs.python.org/devguide/triaging.html#status" target="_blank">Status</a>:</th>
  <td>closed</td>
  <th><a href="http://docs.python.org/devguide/triaging.html#resolution" target="_blank">Resolution</a>:</th>
  <td>fixed</td>
</tr>

<tr>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#dependencies"
       target="_blank">Dependencies</a>:
 </th>
 <td>
  
  
 </td>
 <th><a href="http://docs.python.org/devguide/triaging.html#superseder" target="_blank">Superseder</a>:</th>
 <td>
  
 
 </td>
 </tr>
 <tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#assigned-to"
      target="_blank">Assigned To</a>:
 </th>
 
 <td>
  
 </td>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#nosy-list"
      target="_blank">Nosy List</a><!--
        <span tal:condition="context/nosy_count" tal:replace="python: ' (%d)' % context.nosy_count" /> -->:
 </th>
 <td>
     christian.heimes, miss-islington, ned.deily, ronaldoussoren, serhiy.storchaka, vstinner
     
 </td>
</tr>
<tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#priority"
      target="_blank">Priority</a>:
 </th>
 <td>normal</td>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#keywords"
       target="_blank">Keywords</a>:
 </th>
 <td>patch, security_issue</td>


</tr>









</table>
</fieldset>

</form>

<p>Created on <strong>2020-10-16 08:32</strong> by <strong>vstinner</strong>, last changed <strong>2022-04-11 14:59</strong> by <strong>admin</strong>. This issue is now <strong style="color:#00F; background-color:inherit;">closed</strong>.</p>



<table class="files">
 <tr><th class="header" colspan="4">Pull Requests</th></tr>
 <tr>
  <th>URL</th>
  <th>Status</th>
  <th>Linked</th>
  <th>Edit</th>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/22760" title="bpo-42051: Reject XML entity declarations in plist files">PR 22760</a></td>
  <td>merged</td>
  <td>
   <span>ronaldoussoren</span>,
   <span>2020-10-19 09:22</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/22771" title="[3.9] bpo-42051: Reject XML entity declarations in plist files (GH-22760)">PR 22771</a></td>
  <td>merged</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-10-19 18:14</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/22772" title="[3.8] bpo-42051: Reject XML entity declarations in plist files (GH-22760)">PR 22772</a></td>
  <td>merged</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-10-19 18:14</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/22801" title="[3.7] bpo-42051: Reject XML entity declarations in plist files (#22760)">PR 22801</a></td>
  <td>merged</td>
  <td>
   <span>ned.deily</span>,
   <span>2020-10-20 01:57</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/22804" title="[3.6] bpo-42051: Reject XML entity declarations in plist files (GH-22760) (GH-22801)">PR 22804</a></td>
  <td>merged</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-10-20 04:19</span>
  </td>
  <td>
    
  </td>
 </tr>
</table>





<table class="messages">
 <tr><th colspan="4" class="header">Messages (13)</th></tr>
 
  <tr>
    <th>
     <a href="#msg378707" id="msg378707">msg378707</a> - <a
    href="msg378707">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-16 08:32</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>The XML documentation starts with a red warning:

"Warning: The XML modules are not secure against erroneous or maliciously constructed data. If you need to parse untrusted or unauthenticated data see the XML vulnerabilities and The defusedxml Package sections. "
<a href="https://docs.python.org/dev/library/xml.html">https://docs.python.org/dev/library/xml.html</a>

I suggest to add the same warning to the plistlib library which uses the XML parser internally to handle XML files.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg378711" id="msg378711">msg378711</a> - <a
    href="msg378711">(view)</a></th>
   <th>Author: Ronald Oussoren (ronaldoussoren) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-16 11:47</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Is there something we could do in plistlib to avoid those problems? 

Plist XML files are not arbitrary XML. In particular disabling entity definitions would avoid the problems mentioned as plist files should not contain those. That said, a quick glance at the xml.etree module doesn't seem to have a documented way to disable entities.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg378861" id="msg378861">msg378861</a> - <a
    href="msg378861">(view)</a></th>
   <th>Author: Serhiy Storchaka (serhiy.storchaka) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-18 13:37</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Seems that we can not control entity definitions and expansions. We only can limit the number of expanded entities per element (the size of self.data).

What is the reasonable default limit (taking into account that every &amp;lt; and &amp;<a class="closed" title="[closed] Add math.tau" href="issue12345">#12345</a>; is a separate entity)? How to name the limit parameter if we make it configurable? What type of exceptions should be raised?</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg378863" id="msg378863">msg378863</a> - <a
    href="msg378863">(view)</a></th>
   <th>Author: Ronald Oussoren (ronaldoussoren) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-18 14:24</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>One option is to copy what defusedxml does to forbid a number of unsafe operations, see <a href="https://github.com/tiran/defusedxml/blob/eb38a2d710b67df48614cb5098ddb8472289ce6d/defusedxml/ElementTree.py#L68">https://github.com/tiran/defusedxml/blob/eb38a2d710b67df48614cb5098ddb8472289ce6d/defusedxml/ElementTree.py#L68</a>

Defusedxml uses an XMLParser subclass that optionally disables some features (such as entity definitions), for plistlib those features can be disabled unconditionally. 

I haven't thought much about the exceptions to use, probably a similar exception as is used for invalid plist files. 

Another thing I haven't really thought about: would such a change be 3.10 only or is this something we could backport?  

The following plist file currently works with plistlib, but does not work with plutil(1) on macOS 10.15 (parse error in the DTD definition).  That indicates that entity definitions aren't supposed to be used in plist files and it would be safe to disable this feature in plistlib.

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "<a href="http://www.apple.com/DTDs/PropertyList-1.0.dtd">http://www.apple.com/DTDs/PropertyList-1.0.dtd</a>" [
   &lt;!ENTITY entity "replacement text"&gt;
  ]&gt;
&lt;plist version="1.0"&gt;
  &lt;dict&gt;
    &lt;key&gt;A&lt;/key&gt;
    &lt;string&gt;&amp;entity;&lt;/string&gt;
  &lt;/dict&gt;
&lt;/plist&gt;</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg378868" id="msg378868">msg378868</a> - <a
    href="msg378868">(view)</a></th>
   <th>Author: Serhiy Storchaka (serhiy.storchaka) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-18 14:40</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Oh, I missed that there is a handler for EntityDecl. Well, then we can fix this issue in few lines of code.

I think it should be backported. We can add private flag (global or class variable) to enable entity declarations, but do not support them in 3.10.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg378932" id="msg378932">msg378932</a> - <a
    href="msg378932">(view)</a></th>
   <th>Author: Ronald Oussoren (ronaldoussoren) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-19 08:34</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>I'm working on a PR.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg378935" id="msg378935">msg378935</a> - <a
    href="msg378935">(view)</a></th>
   <th>Author: Ronald Oussoren (ronaldoussoren) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-19 09:26</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>The PR is fairly simple: Just reject files with entity declarations as invalid files. Adding an option to accept entity declarations should not be necessary as Apple tools won't accept these declarations.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg378975" id="msg378975">msg378975</a> - <a
    href="msg378975">(view)</a></th>
   <th>Author: Ronald Oussoren (ronaldoussoren) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-19 18:13</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/05ee790f4d1cd8725a90b54268fc1dfe5b4d1fa2">05ee790f4d1cd8725a90b54268fc1dfe5b4d1fa2</a> by Ronald Oussoren in branch 'master':
<a class="closed" title="[closed] [security] Avoid plistlib XML vulnerabilities by rejecting entity directives" href="issue42051">bpo-42051</a>: Reject XML entity declarations in plist files (<a class="closed" title="[closed] re.sub does only first 16 replacements if re.S is used" href="issue22760">#22760</a>)
<a href="https://github.com/python/cpython/commit/05ee790f4d1cd8725a90b54268fc1dfe5b4d1fa2">https://github.com/python/cpython/commit/05ee790f4d1cd8725a90b54268fc1dfe5b4d1fa2</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg379079" id="msg379079">msg379079</a> - <a
    href="msg379079">(view)</a></th>
   <th>Author: miss-islington (miss-islington)</th>
   <th>Date: 2020-10-20 02:34</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/479553c7c11306a09ce34edb6ef208133b7b95fe">479553c7c11306a09ce34edb6ef208133b7b95fe</a> by Miss Skeleton (bot) in branch '3.9':
<a class="closed" title="[closed] [security] Avoid plistlib XML vulnerabilities by rejecting entity directives" href="issue42051">bpo-42051</a>: Reject XML entity declarations in plist files (<a href="https://github.com/python/cpython/pull/22760" class="closed" title="GitHub PR 22760: [merged] bpo-42051: Reject XML entity declarations in plist files">GH-22760</a>)
<a href="https://github.com/python/cpython/commit/479553c7c11306a09ce34edb6ef208133b7b95fe">https://github.com/python/cpython/commit/479553c7c11306a09ce34edb6ef208133b7b95fe</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg379080" id="msg379080">msg379080</a> - <a
    href="msg379080">(view)</a></th>
   <th>Author: miss-islington (miss-islington)</th>
   <th>Date: 2020-10-20 02:35</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/65894cac0835cb8f469f649e20aa1be8bf89f5ae">65894cac0835cb8f469f649e20aa1be8bf89f5ae</a> by Miss Skeleton (bot) in branch '3.8':
<a class="closed" title="[closed] [security] Avoid plistlib XML vulnerabilities by rejecting entity directives" href="issue42051">bpo-42051</a>: Reject XML entity declarations in plist files (<a href="https://github.com/python/cpython/pull/22760" class="closed" title="GitHub PR 22760: [merged] bpo-42051: Reject XML entity declarations in plist files">GH-22760</a>)
<a href="https://github.com/python/cpython/commit/65894cac0835cb8f469f649e20aa1be8bf89f5ae">https://github.com/python/cpython/commit/65894cac0835cb8f469f649e20aa1be8bf89f5ae</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg379081" id="msg379081">msg379081</a> - <a
    href="msg379081">(view)</a></th>
   <th>Author: Ned Deily (ned.deily) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-20 02:36</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/e512bc799e3864fe3b1351757261762d63471efc">e512bc799e3864fe3b1351757261762d63471efc</a> by Ned Deily in branch '3.7':
<a class="closed" title="[closed] [security] Avoid plistlib XML vulnerabilities by rejecting entity directives" href="issue42051">bpo-42051</a>: Reject XML entity declarations in plist files (<a class="closed" title="[closed] re.sub does only first 16 replacements if re.S is used" href="issue22760">#22760</a>) (<a href="https://github.com/python/cpython/pull/22801" class="closed" title="GitHub PR 22801: [merged] [3.7] bpo-42051: Reject XML entity declarations in plist files (#22760)">GH-22801</a>)
<a href="https://github.com/python/cpython/commit/e512bc799e3864fe3b1351757261762d63471efc">https://github.com/python/cpython/commit/e512bc799e3864fe3b1351757261762d63471efc</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg379084" id="msg379084">msg379084</a> - <a
    href="msg379084">(view)</a></th>
   <th>Author: Ned Deily (ned.deily) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-20 04:38</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/a158fb9c5138db94adf24fbc5690467cda811163">a158fb9c5138db94adf24fbc5690467cda811163</a> by Miss Skeleton (bot) in branch '3.6':
<a class="closed" title="[closed] [security] Avoid plistlib XML vulnerabilities by rejecting entity directives" href="issue42051">bpo-42051</a>: Reject XML entity declarations in plist files (<a href="https://github.com/python/cpython/pull/22760" class="closed" title="GitHub PR 22760: [merged] bpo-42051: Reject XML entity declarations in plist files">GH-22760</a>) (<a href="https://github.com/python/cpython/pull/22801" class="closed" title="GitHub PR 22801: [merged] [3.7] bpo-42051: Reject XML entity declarations in plist files (#22760)">GH-22801</a>) (<a href="https://github.com/python/cpython/pull/22804" class="closed" title="GitHub PR 22804: [merged] [3.6] bpo-42051: Reject XML entity declarations in plist files (GH-22760) (GH-22801)">GH-22804</a>)
<a href="https://github.com/python/cpython/commit/a158fb9c5138db94adf24fbc5690467cda811163">https://github.com/python/cpython/commit/a158fb9c5138db94adf24fbc5690467cda811163</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg379715" id="msg379715">msg379715</a> - <a
    href="msg379715">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-10-27 02:31</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Thanks Ronald Oussoren for the fix. It's better to fix a vulnerability (denial of service in this case) rather than documenting it :-)</pre>
   </td>
  </tr>
 
</table>

<table class="history table table-condensed table-striped"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2022-04-11&nbsp;14:59:36</td><td>admin</td><td>set</td><td>github: 86217</td></tr>
<tr><td>2020-10-27&nbsp;02:31:34</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg379715">msg379715</a></td></tr>
<tr><td>2020-10-20&nbsp;04:44:06</td><td>ned.deily</td><td>set</td><td>status: open -> closed<br />versions:
  + Python 3.6, Python 3.7<br />title: plistlib inherits XML vulnerabilities: we should document them -> [security] Avoid plistlib XML vulnerabilities by rejecting entity directives<br />keywords:
  + <a rel="nofollow" href="keyword15">security_issue</a><br />resolution: fixed<br />stage: patch review -> resolved</td></tr>
<tr><td>2020-10-20&nbsp;04:38:37</td><td>ned.deily</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg379084">msg379084</a></td></tr>
<tr><td>2020-10-20&nbsp;04:19:17</td><td>miss-islington</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request21761">pull_request21761</a></td></tr>
<tr><td>2020-10-20&nbsp;02:36:34</td><td>ned.deily</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg379081">msg379081</a></td></tr>
<tr><td>2020-10-20&nbsp;02:35:27</td><td>miss-islington</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg379080">msg379080</a></td></tr>
<tr><td>2020-10-20&nbsp;02:34:46</td><td>miss-islington</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg379079">msg379079</a></td></tr>
<tr><td>2020-10-20&nbsp;01:57:37</td><td>ned.deily</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user5248">ned.deily</a><br />pull_requests:
  + <a rel="nofollow" href="pull_request21758">pull_request21758</a><br /></td></tr>
<tr><td>2020-10-19&nbsp;18:14:11</td><td>miss-islington</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request21734">pull_request21734</a></td></tr>
<tr><td>2020-10-19&nbsp;18:14:03</td><td>miss-islington</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user27838">miss-islington</a><br />pull_requests:
  + <a rel="nofollow" href="pull_request21733">pull_request21733</a><br /></td></tr>
<tr><td>2020-10-19&nbsp;18:13:56</td><td>ronaldoussoren</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg378975">msg378975</a></td></tr>
<tr><td>2020-10-19&nbsp;09:26:00</td><td>ronaldoussoren</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg378935">msg378935</a></td></tr>
<tr><td>2020-10-19&nbsp;09:22:42</td><td>ronaldoussoren</td><td>set</td><td>keywords:
  + <a rel="nofollow" href="keyword2">patch</a><br />stage: patch review<br />pull_requests:
  + <a rel="nofollow" href="pull_request21725">pull_request21725</a></td></tr>
<tr><td>2020-10-19&nbsp;08:34:01</td><td>ronaldoussoren</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg378932">msg378932</a></td></tr>
<tr><td>2020-10-18&nbsp;14:40:31</td><td>serhiy.storchaka</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg378868">msg378868</a></td></tr>
<tr><td>2020-10-18&nbsp;14:24:00</td><td>ronaldoussoren</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg378863">msg378863</a></td></tr>
<tr><td>2020-10-18&nbsp;13:37:17</td><td>serhiy.storchaka</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user3108">christian.heimes</a><br />messages:
  + <a rel="nofollow" href="msg378861">msg378861</a><br /></td></tr>
<tr><td>2020-10-16&nbsp;11:47:36</td><td>ronaldoussoren</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user925">ronaldoussoren</a><br />messages:
  + <a rel="nofollow" href="msg378711">msg378711</a><br /></td></tr>
<tr><td>2020-10-16&nbsp;08:32:51</td><td>vstinner</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user15623">serhiy.storchaka</a><br /></td></tr>
<tr><td>2020-10-16&nbsp;08:32:10</td><td>vstinner</td><td>create</td><td></td></tr>
</table>

</div>


</div> <!-- content-body -->
<div id="footer">
<div id="credits">
  Supported by <a href="https://python.org/psf-landing/" title="The Python Software Foundation">The Python Software Foundation</a>,
  <br>
  Powered by <a href="http://roundup.sourceforge.net" title="Powered by the Roundup Issue Tracker">Roundup</a>
</div> <!-- credits -->
Copyright &copy; 1990-2022, <a href="http://python.org/psf">Python Software Foundation</a><br />
<a href="http://python.org/about/legal">Legal Statements</a>
</div> <!-- footer -->
</div> <!-- body-main -->
</div> <!-- content -->



</body>
</html>

