=== Content from source.android.com_732ad1a8_20250111_103305.html ===


[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/vda41147226ae308b24384f785d31d739107d2716272d99cd11c490ff3892954d/androidsource/images/lockup.svg)](/)

`/`

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어

[Android Code Search](https://cs.android.com/android/platform/superproject/main)
Sign in

* [Documentation](https://source.android.com/docs)

[What's New?](https://source.android.com/docs/whatsnew)

[Getting Started](https://source.android.com/docs/setup)

[Security](https://source.android.com/docs/security)

[Core Topics](https://source.android.com/docs/core)

[Compatibility](https://source.android.com/docs/compatibility)

[Android Devices](https://source.android.com/docs/devices)

[Automotive](https://source.android.com/docs/automotive)

[Reference](https://source.android.com/reference)

[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/vda41147226ae308b24384f785d31d739107d2716272d99cd11c490ff3892954d/androidsource/images/lockup.svg)](/)

* [Docs](/docs)
  + More
  + [What's New?](/docs/whatsnew)
  + [Getting Started](/docs/setup)
  + [Security](/docs/security)
  + [Core Topics](/docs/core)
  + [Compatibility](/docs/compatibility)
  + [Android Devices](/docs/devices)
  + [Automotive](/docs/automotive)
  + [Reference](/reference)
* [Android Code Search](https://cs.android.com/android/platform/superproject/main)

* [Overview](/docs/security)
* Security overview
  + [Secure an Android device](/docs/security/overview)
  + [Kernel security](/docs/security/overview/kernel-security)
  + [App security](/docs/security/overview/app-security)
  + [Implement security](/docs/security/overview/implement)
  + [Updates and resources](/docs/security/overview/updates-resources)
  + [ASPIRE](/docs/security/overview/aspire)
  + [Reports](/docs/security/overview/reports)
  + [Enhancements](/docs/security/enhancements)
  + [Acknowledgements](/docs/security/overview/acknowledgements)
* Android Security Bulletins
  + [Bulletins home](/docs/security/bulletin)
  + [Overview](/docs/security/bulletin/asb-overview)
  + 2025 bulletins
    - [January](/docs/security/bulletin/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/2024-12-01)
    - [November](/docs/security/bulletin/2024-11-01)
    - [October](/docs/security/bulletin/2024-10-01)
    - [September](/docs/security/bulletin/2024-09-01)
    - [August](/docs/security/bulletin/2024-08-01)
    - [July](/docs/security/bulletin/2024-07-01)
    - [June](/docs/security/bulletin/2024-06-01)
    - [May](/docs/security/bulletin/2024-05-01)
    - [April](/docs/security/bulletin/2024-04-01)
    - [March](/docs/security/bulletin/2024-03-01)
    - [February](/docs/security/bulletin/2024-02-01)
    - [January](/docs/security/bulletin/2024-01-01)
    - [Android 15](/docs/security/bulletin/android-15)
  + 2023 bulletins
    - [December](/docs/security/bulletin/2023-12-01)
    - [November](/docs/security/bulletin/2023-11-01)
    - [October](/docs/security/bulletin/2023-10-01)
    - [September](/docs/security/bulletin/2023-09-01)
    - [August](/docs/security/bulletin/2023-08-01)
    - [July](/docs/security/bulletin/2023-07-01)
    - [June](/docs/security/bulletin/2023-06-01)
    - [May](/docs/security/bulletin/2023-05-01)
    - [April](/docs/security/bulletin/2023-04-01)
    - [March](/docs/security/bulletin/2023-03-01)
    - [February](/docs/security/bulletin/2023-02-01)
    - [January](/docs/security/bulletin/2023-01-01)
    - [Android 14](/docs/security/bulletin/android-14)
  + 2022 bulletins
    - [December](/docs/security/bulletin/2022-12-01)
    - [November](/docs/security/bulletin/2022-11-01)
    - [October](/docs/security/bulletin/2022-10-01)
    - [September](/docs/security/bulletin/2022-09-01)
    - [August](/docs/security/bulletin/2022-08-01)
    - [July](/docs/security/bulletin/2022-07-01)
    - [June](/docs/security/bulletin/2022-06-01)
    - [May](/docs/security/bulletin/2022-05-01)
    - [April](/docs/security/bulletin/2022-04-01)
    - [March](/docs/security/bulletin/2022-03-01)
    - [Android 12L](/docs/security/bulletin/android-12l)
    - [February](/docs/security/bulletin/2022-02-01)
    - [January](/docs/security/bulletin/2022-01-01)
    - [Android 13](/docs/security/bulletin/android-13)
    - [Index](/docs/security/bulletin/2022)
  + 2021 bulletins
    - [December](/docs/security/bulletin/2021-12-01)
    - [November](/docs/security/bulletin/2021-11-01)
    - [October](/docs/security/bulletin/2021-10-01)
    - [September](/docs/security/bulletin/2021-09-01)
    - [August](/docs/security/bulletin/2021-08-01)
    - [July](/docs/security/bulletin/2021-07-01)
    - [June](/docs/security/bulletin/2021-06-01)
    - [May](/docs/security/bulletin/2021-05-01)
    - [April](/docs/security/bulletin/2021-04-01)
    - [March](/docs/security/bulletin/2021-03-01)
    - [February](/docs/security/bulletin/2021-02-01)
    - [January](/docs/security/bulletin/2021-01-01)
    - [Android 12](/docs/security/bulletin/android-12)
    - [Index](/docs/security/bulletin/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/2020-12-01)
    - [November](/docs/security/bulletin/2020-11-01)
    - [October](/docs/security/bulletin/2020-10-01)
    - [September](/docs/security/bulletin/2020-09-01)
    - [August](/docs/security/bulletin/2020-08-01)
    - [July](/docs/security/bulletin/2020-07-01)
    - [June](/docs/security/bulletin/2020-06-01)
    - [May](/docs/security/bulletin/2020-05-01)
    - [April](/docs/security/bulletin/2020-04-01)
    - [March](/docs/security/bulletin/2020-03-01)
    - [February](/docs/security/bulletin/2020-02-01)
    - [January](/docs/security/bulletin/2020-01-01)
    - [Android 11](/docs/security/bulletin/android-11)
    - [Index](/docs/security/bulletin/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/2019-12-01)
    - [November](/docs/security/bulletin/2019-11-01)
    - [October](/docs/security/bulletin/2019-10-01)
    - [September](/docs/security/bulletin/2019-09-01)
    - [August](/docs/security/bulletin/2019-08-01)
    - [July](/docs/security/bulletin/2019-07-01)
    - [June](/docs/security/bulletin/2019-06-01)
    - [May](/docs/security/bulletin/2019-05-01)
    - [April](/docs/security/bulletin/2019-04-01)
    - [March](/docs/security/bulletin/2019-03-01)
    - [February](/docs/security/bulletin/2019-02-01)
    - [January](/docs/security/bulletin/2019-01-01)
    - [Android 10](/docs/security/bulletin/android-10)
    - [Index](/docs/security/bulletin/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/2018-12-01)
    - [November](/docs/security/bulletin/2018-11-01)
    - [October](/docs/security/bulletin/2018-10-01)
    - [September](/docs/security/bulletin/2018-09-01)
    - [August](/docs/security/bulletin/2018-08-01)
    - [July](/docs/security/bulletin/2018-07-01)
    - [June](/docs/security/bulletin/2018-06-01)
    - [May](/docs/security/bulletin/2018-05-01)
    - [April](/docs/security/bulletin/2018-04-01)
    - [March](/docs/security/bulletin/2018-03-01)
    - [February](/docs/security/bulletin/2018-02-01)
    - [January](/docs/security/bulletin/2018-01-01)
    - [Index](/docs/security/bulletin/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/2017-12-01)
    - [November](/docs/security/bulletin/2017-11-01)
    - [October](/docs/security/bulletin/2017-10-01)
    - [September](/docs/security/bulletin/2017-09-01)
    - [August](/docs/security/bulletin/2017-08-01)
    - [July](/docs/security/bulletin/2017-07-01)
    - [June](/docs/security/bulletin/2017-06-01)
    - [May](/docs/security/bulletin/2017-05-01)
    - [April](/docs/security/bulletin/2017-04-01)
    - [March](/docs/security/bulletin/2017-03-01)
    - [February](/docs/security/bulletin/2017-02-01)
    - [January](/docs/security/bulletin/2017-01-01)
    - [Index](/docs/security/bulletin/2017)
  + 2016 bulletins
    - [December](/docs/security/bulletin/2016-12-01)
    - [November](/docs/security/bulletin/2016-11-01)
    - [October](/docs/security/bulletin/2016-10-01)
    - [September](/docs/security/bulletin/2016-09-01)
    - [August](/docs/security/bulletin/2016-08-01)
    - [July](/docs/security/bulletin/2016-07-01)
    - [June](/docs/security/bulletin/2016-06-01)
    - [May](/docs/security/bulletin/2016-05-01)
    - [April](/docs/security/bulletin/2016-04-02)
    - [March](/docs/security/bulletin/2016-03-01)
    - [February](/docs/security/bulletin/2016-02-01)
    - [January](/docs/security/bulletin/2016-01-01)
    - [Index](/docs/security/bulletin/2016)
  + 2015 bulletins
    - [December](/docs/security/bulletin/2015-12-01)
    - [November](/docs/security/bulletin/2015-11-01)
    - [October](/docs/security/bulletin/2015-10-01)
    - [September](/docs/security/bulletin/2015-09-01)
    - [August](/docs/security/bulletin/2015-08-01)
    - [Index](/docs/security/bulletin/2015)
  + Pixel/Nexus bulletins
  + [Overview](/docs/security/bulletin/pixel)
  + 2025 bulletins
    - [January](/docs/security/bulletin/pixel/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel/2024-12-01)
    - [November](/docs/security/bulletin/pixel/2024-11-01)
    - [October](/docs/security/bulletin/pixel/2024-10-01)
    - [September](/docs/security/bulletin/pixel/2024-09-01)
    - [August](/docs/security/bulletin/pixel/2024-08-01)
    - [July](/docs/security/bulletin/pixel/2024-07-01)
    - [June](/docs/security/bulletin/pixel/2024-06-01)
    - [May](/docs/security/bulletin/pixel/2024-05-01)
    - [April](/docs/security/bulletin/pixel/2024-04-01)
    - [March](/docs/security/bulletin/pixel/2024-03-01)
    - [February](/docs/security/bulletin/pixel/2024-02-01)
    - [January](/docs/security/bulletin/pixel/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel/2023-12-01)
    - [November](/docs/security/bulletin/pixel/2023-11-01)
    - [October](/docs/security/bulletin/pixel/2023-10-01)
    - [September](/docs/security/bulletin/pixel/2023-09-01)
    - [August](/docs/security/bulletin/pixel/2023-08-01)
    - [July](/docs/security/bulletin/pixel/2023-07-01)
    - [June](/docs/security/bulletin/pixel/2023-06-01)
    - [May](/docs/security/bulletin/pixel/2023-05-01)
    - [April](/docs/security/bulletin/pixel/2023-04-01)
    - [March](/docs/security/bulletin/pixel/2023-03-01)
    - [February](/docs/security/bulletin/pixel/2023-02-01)
    - [January](/docs/security/bulletin/pixel/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/pixel/2022-12-01)
    - [November](/docs/security/bulletin/pixel/2022-11-01)
    - [October](/docs/security/bulletin/pixel/2022-10-01)
    - [September](/docs/security/bulletin/pixel/2022-09-01)
    - [August](/docs/security/bulletin/pixel/2022-08-01)
    - [July](/docs/security/bulletin/pixel/2022-07-01)
    - [June](/docs/security/bulletin/pixel/2022-06-01)
    - [May](/docs/security/bulletin/pixel/2022-05-01)
    - [April](/docs/security/bulletin/pixel/2022-04-01)
    - [March](/docs/security/bulletin/pixel/2022-03-01)
    - [February](/docs/security/bulletin/pixel/2022-02-01)
    - [January](/docs/security/bulletin/pixel/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/pixel/2021-12-01)
    - [November](/docs/security/bulletin/pixel/2021-11-01)
    - [October](/docs/security/bulletin/pixel/2021-10-01)
    - [September](/docs/security/bulletin/pixel/2021-09-01)
    - [August](/docs/security/bulletin/pixel/2021-08-01)
    - [July](/docs/security/bulletin/pixel/2021-07-01)
    - [June](/docs/security/bulletin/pixel/2021-06-01)
    - [May](/docs/security/bulletin/pixel/2021-05-01)
    - [April](/docs/security/bulletin/pixel/2021-04-01)
    - [March](/docs/security/bulletin/pixel/2021-03-01)
    - [February](/docs/security/bulletin/pixel/2021-02-01)
    - [January](/docs/security/bulletin/pixel/2021-01-01)
    - [Index](/docs/security/bulletin/pixel/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/pixel/2020-12-01)
    - [November](/docs/security/bulletin/pixel/2020-11-01)
    - [October](/docs/security/bulletin/pixel/2020-10-01)
    - [September](/docs/security/bulletin/pixel/2020-09-01)
    - [August](/docs/security/bulletin/pixel/2020-08-01)
    - [July](/docs/security/bulletin/pixel/2020-07-01)
    - [June](/docs/security/bulletin/pixel/2020-06-01)
    - [May](/docs/security/bulletin/pixel/2020-05-01)
    - [April](/docs/security/bulletin/pixel/2020-04-01)
    - [March](/docs/security/bulletin/pixel/2020-03-01)
    - [February](/docs/security/bulletin/pixel/2020-02-01)
    - [January](/docs/security/bulletin/pixel/2020-01-01)
    - [Index](/docs/security/bulletin/pixel/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/pixel/2019-12-01)
    - [November](/docs/security/bulletin/pixel/2019-11-01)
    - [October](/docs/security/bulletin/pixel/2019-10-01)
    - [September](/docs/security/bulletin/pixel/2019-09-01)
    - [August](/docs/security/bulletin/pixel/2019-08-01)
    - [July](/docs/security/bulletin/pixel/2019-07-01)
    - [June](/docs/security/bulletin/pixel/2019-06-01)
    - [May](/docs/security/bulletin/pixel/2019-05-01)
    - [April](/docs/security/bulletin/pixel/2019-04-01)
    - [March](/docs/security/bulletin/pixel/2019-03-01)
    - [February](/docs/security/bulletin/pixel/2019-02-01)
    - [January](/docs/security/bulletin/pixel/2019-01-01)
    - [Index](/docs/security/bulletin/pixel/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/pixel/2018-12-01)
    - [November](/docs/security/bulletin/pixel/2018-11-01)
    - [October](/docs/security/bulletin/pixel/2018-10-01)
    - [September](/docs/security/bulletin/pixel/2018-09-01)
    - [August](/docs/security/bulletin/pixel/2018-08-01)
    - [July](/docs/security/bulletin/pixel/2018-07-01)
    - [June](/docs/security/bulletin/pixel/2018-06-01)
    - [May](/docs/security/bulletin/pixel/2018-05-01)
    - [April](/docs/security/bulletin/pixel/2018-04-01)
    - [March](/docs/security/bulletin/pixel/2018-03-01)
    - [February](/docs/security/bulletin/pixel/2018-02-01)
    - [January](/docs/security/bulletin/pixel/2018-01-01)
    - [Index](/docs/security/bulletin/pixel/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/pixel/2017-12-01)
    - [November](/docs/security/bulletin/pixel/2017-11-01)
    - [October](/docs/security/bulletin/pixel/2017-10-01)
    - [Index](/docs/security/bulletin/pixel/2017)
  + Android Automotive
  + [Overview](/docs/security/bulletin/aaos)
  + 2025 bulletins
    - [January](/docs/security/bulletin/aaos/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/aaos/2024-12-01)
    - [November](/docs/security/bulletin/aaos/2024-11-01)
    - [October](/docs/security/bulletin/aaos/2024-10-01)
    - [September](/docs/security/bulletin/aaos/2024-09-01)
    - [August](/docs/security/bulletin/aaos/2024-08-01)
    - [July](/docs/security/bulletin/aaos/2024-07-01)
    - [June](/docs/security/bulletin/aaos/2024-06-01)
    - [May](/docs/security/bulletin/aaos/2024-05-01)
    - [April](/docs/security/bulletin/aaos/2024-04-01)
    - [March](/docs/security/bulletin/aaos/2024-03-01)
    - [February](/docs/security/bulletin/aaos/2024-02-01)
    - [January](/docs/security/bulletin/aaos/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/aaos/2023-12-01)
    - [November](/docs/security/bulletin/aaos/2023-11-01)
    - [October](/docs/security/bulletin/aaos/2023-10-01)
    - [September](/docs/security/bulletin/aaos/2023-09-01)
    - [August](/docs/security/bulletin/aaos/2023-08-01)
    - [July](/docs/security/bulletin/aaos/2023-07-01)
    - [June](/docs/security/bulletin/aaos/2023-06-01)
    - [May](/docs/security/bulletin/aaos/2023-05-01)
    - [April](/docs/security/bulletin/aaos/2023-04-01)
    - [March](/docs/security/bulletin/aaos/2023-03-01)
    - [February](/docs/security/bulletin/aaos/2023-02-01)
    - [January](/docs/security/bulletin/aaos/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/aaos/2022-12-01)
    - [November](/docs/security/bulletin/aaos/2022-11-01)
    - [October](/docs/security/bulletin/aaos/2022-10-01)
    - [September](/docs/security/bulletin/aaos/2022-09-01)
    - [August](/docs/security/bulletin/aaos/2022-08-01)
    - [July](/docs/security/bulletin/aaos/2022-07-01)
    - [June](/docs/security/bulletin/aaos/2022-06-01)
    - [May](/docs/security/bulletin/aaos/2022-05-01)
    - [April](/docs/security/bulletin/aaos/2022-04-01)
    - [March](/docs/security/bulletin/aaos/2022-03-01)
    - [February](/docs/security/bulletin/aaos/2022-02-01)
    - [January](/docs/security/bulletin/aaos/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/aaos/2021-12-01)
    - [November](/docs/security/bulletin/aaos/2021-11-01)
    - [October](/docs/security/bulletin/aaos/2021-10-01)
    - [September](/docs/security/bulletin/aaos/2021-09-01)
    - [August](/docs/security/bulletin/aaos/2021-08-01)
    - [July](/docs/security/bulletin/aaos/2021-07-01)
    - [June](/docs/security/bulletin/aaos/2021-06-01)
    - [May](/docs/security/bulletin/aaos/2021-05-01)
    - [April](/docs/security/bulletin/aaos/2021-04-01)
    - [March](/docs/security/bulletin/aaos/2021-03-01)
    - [February](/docs/security/bulletin/aaos/2021-02-01)
    - [January](/docs/security/bulletin/aaos/2021-01-01)
  + Chromecast
  + [Overview](/docs/security/bulletin/chromecast)
  + 2024 bulletins
    - [December](/docs/security/bulletin/chromecast/2024-12-01)
    - [September](/docs/security/bulletin/chromecast/2024-09-01)
    - [July](/docs/security/bulletin/chromecast/2024-07-01)
    - [March](/docs/security/bulletin/chromecast/2024-03-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/chromecast/2023-12-01)
    - [September](/docs/security/bulletin/chromecast/2023-07-01)
    - [June](/docs/security/bulletin/chromecast/2023-06-01)
    - [April](/docs/security/bulletin/chromecast/2023-04-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/chromecast/2022-12-01)
    - [October](/docs/security/bulletin/chromecast/2022-10-01)
    - [July](/docs/security/bulletin/chromecast/2022-07-01)
  + Wear
  + [Overview](/docs/security/bulletin/wear)
  + 2025 bulletins
    - [January](/docs/security/bulletin/wear/2025/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/wear/2024/2024-12-01)
    - [November](/docs/security/bulletin/wear/2024/2024-11-01)
    - [October](/docs/security/bulletin/wear/2024/2024-10-01)
    - [September](/docs/security/bulletin/wear/2024/2024-09-01)
    - [August](/docs/security/bulletin/wear/2024/2024-08-01)
    - [July](/docs/security/bulletin/wear/2024/2024-07-01)
    - [June](/docs/security/bulletin/wear/2024/2024-06-01)
    - [May](/docs/security/bulletin/wear/2024/2024-05-01)
    - [April](/docs/security/bulletin/wear/2024/2024-04-01)
    - [March](/docs/security/bulletin/wear/2024/2024-03-01)
    - [February](/docs/security/bulletin/wear/2024/2024-02-01)
    - [January](/docs/security/bulletin/wear/2024/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/wear/2023/2023-12-01)
    - [November](/docs/security/bulletin/wear/2023/2023-11-01)
    - [October](/docs/security/bulletin/wear/2023/2023-10-01)
    - [September](/docs/security/bulletin/wear/2023/2023-09-01)
    - [August](/docs/security/bulletin/wear/2023/2023-08-01)
  + Pixel Watch
  + [Overview](/docs/security/bulletin/pixel-watch)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2024-12-01)
    - [August](/docs/security/bulletin/pixel-watch/2024-08-01)
    - [July](/docs/security/bulletin/pixel-watch/2024-07-01)
    - [June](/docs/security/bulletin/pixel-watch/2024-06-01)
    - [May](/docs/security/bulletin/pixel-watch/2024-05-01)
    - [April](/docs/security/bulletin/pixel-watch/2024-04-01)
    - [March](/docs/security/bulletin/pixel-watch/2024-03-01)
    - [February](/docs/security/bulletin/pixel-watch/2024-02-01)
    - [January](/docs/security/bulletin/pixel-watch/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2023/2023-12-01)
    - [September](/docs/security/bulletin/pixel-watch/2023/2023-09-01)
    - [June](/docs/security/bulletin/pixel-watch/2023/2023-06-01)
  + Advisories
  + [Overview](/docs/security/bulletin/advisory)
  + [March 2016](/docs/security/bulletin/advisory/2016-03-18)
* Features
  + [Overview](/docs/security/features)
  + [Application Sandbox](/docs/security/app-sandbox)
  + [OMAPI vendor stable interface](/docs/security/features/open-mobile-api)
  + App signing
    - [Overview](/docs/security/features/apksigning)
    - [APK signature scheme v2](/docs/security/features/apksigning/v2)
    - [APK signature scheme v3](/docs/security/features/apksigning/v3)
    - [APK signature scheme v3.1](/docs/security/features/apksigning/v3-1)
    - [APK signature scheme v4](/docs/security/features/apksigning/v4)
  + Authentication
    - [Overview](/docs/security/features/authentication)
    - [Gatekeeper](/docs/security/features/authentication/gatekeeper)
    - Biometrics
      * [Overview](/docs/security/features/biometric)
      * [Measure biometric security](/docs/security/features/biometric/measure)
      * [Fingerprint HIDL](/docs/security/features/authentication/fingerprint-hal)
      * [Face authentication HIDL](/docs/security/features/biometric/face-authentication)
    - Protected confirmation
      * [Overview](/docs/security/features/protected-confirmation)
      * [Implementation](/docs/security/features/protected-confirmation/implementation)
      * [Design guidelines](/docs/security/features/protected-confirmation/design)
      * [Accessibility](/docs/security/features/protected-confirmation/accessibility)
  + DICE
    - [Overview](/docs/security/features/dice)
    - [Applications of DICE](/docs/security/features/dice/applications-of-dice)
  + Encryption
    - [Overview](/docs/security/features/encryption)
    - [File-based encryption](/docs/security/features/encryption/file-based)
    - [Full-disk encryption](/docs/security/features/encryption/full-disk)
    - [Metadata encryption](/docs/security/features/encryption/metadata)
    - [Enable Adiantum](/docs/security/features/encryption/adiantum)
    - [Hardware-wrapped keys](/docs/security/features/encryption/hw-wrapped-keys)
  + Keystore
    - [Overview](/docs/security/features/keystore)
    - [Features](/docs/security/features/keystore/features)
    - [Key and ID attestation](/docs/security/features/keystore/attestation)
    - [Version binding](/docs/security/features/keystore/version-binding)
    - [Authorization tags](/docs/security/features/keystore/tags)
    - [Functions](/docs/security/features/keystore/implementer-ref)
  + Identity credential
    - [Overview](/docs/security/features/identity-credentials)
  + SELinux
    - [Overview](/docs/security/features/selinux)
    - [Concepts](/docs/security/features/selinux/concepts)
    - [Implementation](/docs/security/features/selinux/implement)
    - [Customization](/docs/security/features/selinux/customize)
    - [Build sepolicy](/docs/security/features/selinux/build)
    - [Compatibility](/docs/security/features/selinux/compatibility)
    - [Validation](/docs/security/features/selinux/validate)
    - [Write policy](/docs/security/features/selinux/device-policy)
    - [Vendor init](/docs/security/features/selinux/vendor-init)
  + Trusty TEE
    - [Overview](/docs/security/features/trusty)
    - [Download and build](/docs/security/features/trusty/download-and-build)
    - [Trusty API reference](/docs/security/features/trusty/trusty-ref)
  + Verified Boot
    - [Overview](/docs/security/features/verifiedboot)
    - [Device state](/docs/security/features/verifiedboot/device-state)
    - [Verify Boot](/docs/security/features/verifiedboot/verified-boot)
    - [Boot flow](/docs/security/features/verifiedboot/boot-flow)
    - [Implement dm-verity](/docs/security/features/verifiedboot/dm-verity)
    - [Verify system\_other partition](/docs/security/features/verifiedboot/verify-system-other-partition)
    - [Reference implementation](/docs/security/features/verifiedboot/avb)
  + Safety Center
    - [Overview](/docs/security/safety-center/overview)
    - [Customize Safety Center](/docs/security/safety-center/customize)
    - [Customize Safety Center UI](/docs/security/safety-center/customize-ui)
    - [Interact with Safety Center](/docs/security/safety-center/interact)
    - [Testing and validation](/docs/security/safety-center/test-requirements)
  + Cellular security
    - [Overview](/docs/security/features/cellular-security/overview)
    - [Disable 2G](/docs/security/features/cellular-security/disable-2g)
  + [Private space](/docs/security/features/private-space)
* Testing
  + [Overview](/docs/security/test/fuzz-sanitize)
  + [Memory safety](/docs/security/test/memory-safety)
  + Arm Memory Tagging Extension
  + [Overview](/docs/security/test/memory-safety/arm-mte)
  + [Bootloader support](/docs/security/test/memory-safety/bootloader-support)
  + [Understand MTE reports](/docs/security/test/memory-safety/mte-reports)
  + [MTE configuration](/docs/security/test/memory-safety/mte-configuration)
  + Sanitizers
  + [Overview](/docs/security/test/sanitizers)
  + [AddressSanitizer](/docs/security/test/asan)
  + [Kernel AddressSanitizer](/docs/security/test/kasan)
  + [Hardware-assisted AddressSanitizer](/docs/security/test/hwasan)
  + [Understand HWASan reports](/docs/security/test/memory-safety/hwasan-reports)
  + [UndefinedBehaviorSanitizer](/docs/security/test/ubsan)
  + Other topics
  + [Control flow integrity](/docs/security/test/cfi)
  + [Kernel control flow integrity](/docs/security/test/kcfi)
  + [Execute-only memory](/docs/security/test/execute-only-memory)
  + [Fuzz with libFuzzer](/docs/security/test/libfuzzer)
  + [GWP-ASan and KFENCE](/docs/security/test/memory-safety/gwp-asan-kfence)
  + [Security Test Suite development kit](/docs/security/test/sts-sdk)
  + [Scudo](/docs/security/test/scudo)
  + [ShadowCallStack](/docs/security/test/shadow-call-stack)
  + [Tagged pointers](/docs/security/test/tagged-pointers)
  + [Zero initialized memory](/docs/security/test/memory-safety/zero-initialized-memory)
* Best practices
  + [Overview](/docs/security/best-practices)
  + [Operational security](/docs/security/best-practices/ops)
  + [System security](/docs/security/best-practices/system)
  + [App security](/docs/security/best-practices/app)
  + [Network security](/docs/security/best-practices/network)
  + [Hardware security](/docs/security/best-practices/hardware)
  + [Privacy security](/docs/security/best-practices/privacy)

* What's new?
* [Release notes](/docs/whatsnew/release-notes)
* [Latest security bulletins](/docs/whatsnew/latest-security-bulletins)
* [Latest Compatibility Definition Document (CDD)](/docs/whatsnew/latest-cdd)
* [Site updates](/docs/whatsnew/site-updates)
* Getting Started
* [About](/docs/setup/about)
* [Start](/docs/setup/start)
* [Download](/docs/setup/download)
* [Build](/docs/setup/build)
* [Test](/docs/setup/test)
* [Create](/docs/setup/create/coding-tasks)
* [Contribute](/docs/setup/contribute)
* [Community](/docs/setup/community/cofc)
* [Tools, build, and related reference](/docs/setup/reference)
* Security
* [Overview](/docs/security/overview)
* [Bulletins](/docs/security/bulletin)
* [Features](/docs/security/features)
* [Testing](/docs/security/test/fuzz-sanitize)
* [Best Practices](/docs/security/best-practices)
* Core Topics
* [Architecture](/docs/core/architecture)
* [Audio](/docs/core/audio)
* [Camera](/docs/core/camera)
* [Connectivity](/docs/core/connect)
* [Data](/docs/core/data)
* [Display](/docs/core/display)
* [Fonts](/docs/core/fonts/custom-font-fallback)
* [Graphics](/docs/core/graphics)
* [Interaction](/docs/core/interaction)
* [Media](/docs/core/media)
* [Performance](/docs/core/perf)
* [Permissions](/docs/core/permissions)
* [Power](/docs/core/power)
* [Runtime](/docs/core/runtime)
* [Settings](/docs/core/settings)
* [Storage](/docs/core/storage)
* [Tests](/docs/core/tests)
* [Updates](/docs/core/ota)
* [Virtualization](/docs/core/virtualization)
* Compatibility
* [Compatibility Definition Document (CDD)](/docs/compatibility/cdd)
* [Compatibility Test Suite (CTS)](/docs/compatibility/cts)
* Android Devices
* [Cuttlefish](/docs/devices/cuttlefish)
* [Enterprise](/docs/devices/admin)
* [TV](/docs/devices/tv)
* Automotive
* [Get Started](/docs/automotive/start/what_automotive)
* [Guidelines for Development](/docs/automotive/guidelines)
* [Development Tools](/docs/automotive/dev-tools)
* [Testing Tools and Infrastructure](/docs/automotive/tools)
* [Release Details](/docs/automotive/start/releases)
* Reference
* [HIDL](/reference/hidl)
* [HAL](/reference/hal)
* [Trade Federation](/reference/tradefed/classes)
* [Security Test Suite](/reference/sts/classes)

* [AOSP](https://source.android.com/)
* [Security](https://source.android.com/docs/security)

# Android Security Bulletin—March 2024

Stay organized with collections

Save and categorize content based on your preferences.

*Published March 4, 2024 | Updated July 29, 2024*

The Android Security Bulletin contains details of security vulnerabilities
affecting Android devices. Security patch levels of
2024-03-05 or later address all of these issues.
To learn how to check a device's security patch level, see
[Check and update your Android version](https://support.google.com/pixelphone/answer/4457705).

Android partners are notified of all issues at least a month before
publication.
Source code patches for these issues have been released to the Android Open
Source Project (AOSP) repository and linked from this bulletin. This bulletin
also includes links to patches outside of AOSP.

The most severe of these issues is a critical security vulnerability in the
System component that could lead to remote code execution with no additional
execution privileges needed.
The [severity assessment](https://source.android.com/security/overview/updates-resources.html#severity) is based on the effect that
exploiting the vulnerability would possibly have on an affected device,
assuming the platform and service mitigations are turned off for development
purposes or if successfully bypassed.

Refer to the [Android and Google Play Protect
mitigations](#mitigations) section for details on the
[Android security platform
protections](/security/enhancements)
and Google Play Protect, which improve the security of the Android platform.

## Android and Google service mitigations

This is a summary of the mitigations provided by the
[Android security platform](/security/enhancements)
and service protections such as
[Google Play Protect](https://developers.google.com/android/play-protect). These capabilities reduce the
likelihood that security vulnerabilities could be successfully exploited on Android.

* Exploitation for many issues on Android is made more difficult by
  enhancements in newer versions of the Android platform. We encourage all
  users
  to update to the latest version of Android where possible.
* The Android security team actively monitors for abuse through
  [Google Play
  Protect](https://developers.google.com/android/play-protect) and warns users about
  [Potentially
  Harmful Applications](/static/security/reports/Google_Android_Security_PHA_classifications.pdf). Google Play Protect is enabled by default on
  devices
  with [Google
  Mobile
  Services](http://www.android.com/gms), and is especially important for users who install apps from
  outside of Google Play.

## 2024-03-01 security patch level vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2024-03-01 patch level.
Vulnerabilities are grouped under the component they affect.
Issues are described in the tables below and include CVE ID, associated
references, [type of vulnerability](#type),
[severity](/security/overview/updates-resources#severity),
and updated AOSP versions (where applicable).
When available, we link the public change that addressed the issue to the
bug ID, like the AOSP change list.
When multiple changes relate to a single bug, additional references are
linked to numbers following the bug ID.
Devices with Android 10 and later may receive security updates as well as
[Google
Play
system updates](https://support.google.com/android/answer/7680439).

### Framework

The most severe vulnerability in this section could lead to local escalation
of privilege with no additional execution privileges needed.

| CVE | References | Type | Severity | Updated AOSP versions |
| --- | --- | --- | --- | --- |
| CVE-2024-0046 | [A-299441833](https://android.googlesource.com/platform/frameworks/base/%2B/d68cab5ac1aa294ec4d0419bc0803a5577e4e43c) | EoP | High | 12, 12L, 13, 14 |
| CVE-2024-0048 | [A-316893159](https://android.googlesource.com/platform/frameworks/base/%2B/2c236cde5505ee0e88cf1e3d073e2f1a53f0eede) | EoP | High | 12, 12L, 13, 14 |
| CVE-2024-0049 | [A-273936274](https://android.googlesource.com/platform/frameworks/av/%2B/462689f06fd5e72ac63cd87b43ee52554ddf953e) | EoP | High | 12, 12L, 13, 14 |
| CVE-2024-0050 | [A-273935108](https://android.googlesource.com/platform/frameworks/av/%2B/8f3bc8be16480367bac36effa25706133a0dc22d) | EoP | High | 12, 12L, 13, 14 |
| CVE-2024-0051 | [A-276442130](https://android.googlesource.com/platform/frameworks/av/%2B/a52c14a5b49f26efafa581dea653b4179d66909e) | EoP | High | 12, 12L, 13, 14 |
| CVE-2024-0053 | [A-281525042](https://android.googlesource.com/platform/frameworks/base/%2B/74b03835a7fac15e854d08159922418c99e27e77) | ID | High | 12, 12L, 13, 14 |
| CVE-2024-0047 | [A-311687929](https://android.googlesource.com/platform/frameworks/base/%2B/3cd8a2c783fc736627b38f639fe4e239abcf6af1) [[2](https://android.googlesource.com/platform/frameworks/base/%2B/bd5cc7f03256b328438b9bc3791c6b811a2f1f17)] [[3](https://android.googlesource.com/platform/frameworks/base/%2B/f516739398746fef7e0cf1437d9a40e2ad3c10bb)] | DoS | High | 14 |

### System

The most severe vulnerability in this section could lead to remote code
execution with no additional execution privileges needed.

| CVE | References | Type | Severity | Updated AOSP versions |
| --- | --- | --- | --- | --- |
| CVE-2024-0039 | [A-295887535](https://android.googlesource.com/platform/packages/modules/Bluetooth/%2B/17044ccf3a2858633cad8f87926e752edfe0d8d8) [[2](https://android.googlesource.com/platform/packages/modules/Bluetooth/%2B/f0f35273101518d1f3a660b151804e90d0249af3)] [[3](https://android.googlesource.com/platform/packages/modules/Bluetooth/%2B/015c618a0461def93138173a53daaf27ca0630c9)] | RCE | Critical | 12, 12L, 13, 14 |
| CVE-2024-23717 | [A-318374503](https://android.googlesource.com/platform/packages/modules/Bluetooth/%2B/c5c528beb6e1cfed3ec93a3a264084df32ce83c2) | EoP | Critical | 12, 12L, 13, 14 |
| CVE-2023-40081 | [A-284297452](https://android.googlesource.com/platform/frameworks/base/%2B/6fab80f141163de4d0008f7cd081cfc4917c3c68) | ID | High | 12, 12L, 13, 14 |
| CVE-2024-0045 | [A-300903400](https://android.googlesource.com/platform/packages/modules/Bluetooth/%2B/7d0f696f450241d8ba7a168ba14fa7b75032f0c9) | ID | High | 12, 12L, 13, 14 |
| CVE-2024-0052 | [A-303871379](https://android.googlesource.com/platform/packages/modules/HealthFitness/%2B/178f4824574fdf33ed4ac584d092240d1c771b04) | ID | High | 14 |

### Google Play system updates

There are no security issues addressed in Google Play system updates
(Project Mainline) this month.

## 2024-03-05 security patch level vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2024-03-05 patch level.
Vulnerabilities are grouped under the component they affect.
Issues are described in the tables below and include CVE ID, associated
references, [type of vulnerability](#type),
[severity](/security/overview/updates-resources#severity),
and updated AOSP versions (where applicable).
When available, we link the public change that addressed the issue to the
bug ID, like the AOSP change list.
When multiple changes relate to a single bug, additional references are
linked to numbers following the bug ID.

### AMLogic

These vulnerabilities affect AMLogic components and further details are
available directly from AMLogic.
The severity assessment of these issues is provided directly by AMLogic.

| CVE | References | Severity | Subcomponent |
| --- | --- | --- | --- |
| CVE-2023-48424 | A-315373062 [\*](#asterisk) | High | Bootloader |
| CVE-2023-48425 | A-319132171 [\*](#asterisk) | High | Bootloader |

### Arm components

These vulnerabilities affect Arm components and further details are available
directly from Arm.
The severity assessment of these issues is provided directly by Arm.

| CVE | References | Severity | Subcomponent |
| --- | --- | --- | --- |
| CVE-2023-6143 | A-316197619 [\*](#asterisk) | High | Mali |
| CVE-2023-6241 | A-316206835 [\*](#asterisk) | High | Mali |

### MediaTek components

These vulnerabilities affect MediaTek components and further details are
available directly from MediaTek.
The severity assessment of these issues is provided directly by MediaTek.

| CVE | References | Severity | Subcomponent |
| --- | --- | --- | --- |
| CVE-2024-20005 | A-318303317  M-ALPS08355599 [\*](#asterisk) | High | da |
| CVE-2024-20022 | A-318302377  M-ALPS08528255 [\*](#asterisk) | High | lk |
| CVE-2024-20023 | A-318302378  M-ALPS08541638 [\*](#asterisk) | High | flashc |
| CVE-2024-20024 | A-318316114  M-ALPS08541635 [\*](#asterisk) | High | flashc |
| CVE-2024-20025 | A-318316115  M-ALPS08541686 [\*](#asterisk) | High | da |
| CVE-2024-20027 | A-318316117  M-ALPS08541632 [\*](#asterisk) | High | da |
| CVE-2024-20028 | A-318310276  M-ALPS08541632 [\*](#asterisk) | High | da |
| CVE-2024-20020 | A-318302372  M-ALPS08522504 [\*](#asterisk) | High | OPTEE |
| CVE-2024-20026 | A-318310274  M-ALPS08541632 [\*](#asterisk) | High | da |

### Qualcomm components

These vulnerabilities affect Qualcomm components and are described in further
detail in the appropriate Qualcomm security bulletin or security alert.
The severity assessment of these issues is provided directly by Qualcomm.

| CVE | References | Severity | Subcomponent |
| --- | --- | --- | --- |
| CVE-2023-43546 | A-314790498  [QC-CR#3602482](https://git.codelinaro.org/clo/la/kernel/msm-5.15/-/commit/9b2dc03af9003b96d23fc1a8f458c4873fc0c5a3) | High | Security |
| CVE-2023-43547 | A-314791076  [QC-CR#3602462](https://git.codelinaro.org/clo/la/kernel/msm-5.15/-/commit/8b0c9674da2669e5e04e2a021b862ed3c92a8b06) [[2](https://git.codelinaro.org/clo/la/kernel/msm-5.4/-/commit/6b2e2a5ee09c1ac74c9b61726570941ee7e18dec)] | High | Security |
| CVE-2023-43550 | A-314791623  [QC-CR#3595842](https://git.codelinaro.org/clo/la/kernel/msm-5.10/-/commit/9abb15f5c8e1d80c3be0ac7188bf4871087942f2) | High | Kernel |
| CVE-2023-43552 | A-314791054  [QC-CR#3583521](https://git.codelinaro.org/clo/la/platform/vendor/qcom-opensource/wlan/qca-wifi-host-cmn/-/commit/3a3e16bb07755d9f7aed206bf3b8af54e8a636de) | High | WLAN |
| CVE-2023-43553 | A-314791341  [QC-CR#3580821](https://git.codelinaro.org/clo/la/platform/vendor/qcom-opensource/wlan/qca-wifi-host-cmn/-/commit/846c1e28b4019b94ee4fd2b401bb053c30beb7c5) | High | WLAN |

### Qualcomm closed-source components

These vulnerabilities affect Qualcomm closed-source components and are
described in further detail in the appropriate Qualcomm security bulletin or
security alert.
The severity assessment of these issues is provided directly by Qualcomm.

| CVE | References | Severity | Subcomponent |
| --- | --- | --- | --- |
| CVE-2023-28578 | A-285902353 [\*](#asterisk) | Critical | Closed-source component |
| CVE-2023-33042 | A-295039320 [\*](#asterisk) | High | Closed-source component |
| CVE-2023-33066 | A-303101493 [\*](#asterisk) | High | Closed-source component |
| CVE-2023-33105 | A-314790953 [\*](#asterisk) | High | Closed-source component |
| CVE-2023-43539 | A-314791241 [\*](#asterisk) | High | Closed-source component |
| CVE-2023-43548 | A-314790932 [\*](#asterisk) | High | Closed-source component |
| CVE-2023-43549 | A-314791266 [\*](#asterisk) | High | Closed-source component |

## Common questions and answers

This section answers common questions that may occur after reading this
bulletin.

**1. How do I determine if my device is updated to address these
issues?**

To learn how to check a device's security patch level, see
[Check and update your Android version](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices).

* Security patch levels of 2024-03-01 or later address
  all issues associated with the 2024-03-01 security patch
  level.
* Security patch levels of 2024-03-05 or later address
  all issues associated with the 2024-03-05 security patch
  level and all previous patch levels.

Device manufacturers that include these updates should set the patch string
level to:

* [ro.build.version.security\_patch]:[2024-03-01]
* [ro.build.version.security\_patch]:[2024-03-05]

For some devices on Android 10 or later, the Google Play system update
will have a date string that matches the 2024-03-01
security patch level.
Please see [this article](https://support.google.com/android/answer/7680439?hl=en) for more details on how to
install security updates.

**2. Why does this bulletin have two security patch levels?**

This bulletin has two security patch levels so that Android partners have
the
flexibility to fix a subset of vulnerabilities that are similar across all
Android devices more quickly. Android partners are encouraged to fix all
issues
in this bulletin and use the latest security patch level.

* Devices that use the 2024-03-01 security patch level
  must include all issues associated with that security patch level, as well
  as
  fixes for all issues reported in previous security bulletins.
* Devices that use the security patch level of 2024-03-05
  or newer must include all applicable patches in this (and previous) security
  bulletins.

Partners are encouraged to bundle the fixes for all issues they are
addressing in a single update.

**3. What do the entries in the *Type* column mean?**

Entries in the *Type* column of the vulnerability details table
reference the classification of the security vulnerability.

| Abbreviation | Definition |
| --- | --- |
| RCE | Remote code execution |
| EoP | Elevation of privilege |
| ID | Information disclosure |
| DoS | Denial of service |
| N/A | Classification not available |

**4. What do the entries in the *References* column mean?**

Entries under the *References* column of the vulnerability details
table may contain a prefix identifying the organization to which the
reference
value belongs.

| Prefix | Reference |
| --- | --- |
| A- | Android bug ID |
| QC- | Qualcomm reference number |
| M- | MediaTek reference number |
| N- | NVIDIA reference number |
| B- | Broadcom reference number |
| U- | UNISOC reference number |

**5. What does an \* next to the Android bug ID in the *References*
column mean?**

Issues that are not publicly available have an \* next to the corresponding
reference ID. The update for that issue is generally contained in the latest
binary drivers for Pixel devices available from the
[Google
Developer site](https://developers.google.com/android/drivers).

**6. Why are security vulnerabilities split between this bulletin and
device / partner security bulletins, such as the
Pixel bulletin?**

Security vulnerabilities that are documented in this security bulletin are
required to declare the latest security patch level on Android
devices. Additional security vulnerabilities that are documented in the
device / partner security bulletins are not required for
declaring a security patch level. Android device and chipset manufacturers
may also publish security vulnerability details specific to their products,
such as
[Google](https://source.android.com/security/bulletin/pixel),
[Huawei](https://consumer.huawei.com/en/support/bulletin/),
[LGE](https://lgsecurity.lge.com/security_updates_mobile.html),
[Motorola](https://motorola-global-portal.custhelp.com/app/software-security-page/g_id/6806),
[Nokia](https://www.nokia.com/phones/en_int/security-updates),
or
[Samsung](https://security.samsungmobile.com/securityUpdate.smsb).

## Versions

| Version | Date | Notes |
| --- | --- | --- |
| 1.0 | March 4, 2024 | Bulletin Published. |
| 1.1 | July 29, 2024 | Updated CVE tables. |

Content and code samples on this page are subject to the licenses described in the [Content License](/license). Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.

Last updated 2024-08-26 UTC.

[[["Easy to understand","easyToUnderstand","thumb-up"],["Solved my problem","solvedMyProblem","thumb-up"],["Other","otherUp","thumb-up"]],[["Missing the information I need","missingTheInformationINeed","thumb-down"],["Too complicated / too many steps","tooComplicatedTooManySteps","thumb-down"],["Out of date","outOfDate","thumb-down"],["Samples / code issue","samplesCodeIssue","thumb-down"],["Other","otherDown","thumb-down"]],["Last updated 2024-08-26 UTC."],[],[]]

* ### Build

  + [Android repository](//android.googlesource.com)
  + [Requirements](/source/requirements)
  + [Downloading](/source/downloading)
  + [Preview binaries](//developers.google.com/android/blobs-preview/)
  + [Factory images](//developers.google.com/android/images/)
  + [Driver binaries](//developers.google.com/android/drivers/)
* ### Connect

  + [@Android on Twitter](//twitter.com/Android/)
  + [@AndroidDev on Twitter](//twitter.com/AndroidDev/)
  + [Android Blog](//blog.google/products/android/)
  + [Google Security Blog](//security.googleblog.com)
  + [Platform on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-platform/)
  + [Building on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-building/)
  + [Porting on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-porting/)
* ### Get help

  + [Android Help Center](//support.google.com/android/)
  + [Pixel Help Center](//support.google.com/pixelphone/)
  + [www.android.com](//www.android.com)
  + [Google Mobile Services](//www.android.com/gms/)
  + [Stack Overflow](//stackoverflow.com/questions/tagged/android-source/)
  + [Issue Tracker](//issuetracker.google.com/issues?q=status:open%20componentid:190923)

* [About Android](/source/)
* [Community](/source/community)
* [Legal](/legal)
* [License](/license)
* [Privacy](//policies.google.com/privacy)
* [Site feedback](//issuetracker.google.com/issues/new?component=191476)
* Manage cookies

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어



=== Content from android.googlesource.com_1da02404_20250111_103302.html ===

Commit Information:
------------------
Author: Alex Buynytskyy  1698963348 -0700
Date: Android Build Coastguard Worker  1704948367 +0000
Bug ID: Bug: 308989388 Bug: 307532206
Commit Message:
--------------
Validate package names passed to the installer.Bug: 308989388Bug: 307532206Test: atest android.content.pm.cts.PackageManagerTest(cherry picked from commit 1f445474cd1b902b2e7292a0d24e58f020fd51e7)(cherry picked from https://googleplex-android-review.googlesource.com/q/commit:a7e48c8d7e00962d335b0076266a5df98d41a21c)Merged-In: I840c9c9af5752b3901d4719a13e7908faa43ab04Change-Id: I840c9c9af5752b3901d4719a13e7908faa43ab04


=== Content from rtx.meta.security_842acaa4_20250111_103303.html ===

[![]( "Meta Red Team X")
Meta Red Team X](/)

[BUGS](/bugs.html)[ABOUT](/about.html)[HOME](/)

Light

Dark

# Bypassing the "run-as" debuggability check on Android via newline injection

##

 Mar 04, 2024
 Tom Hebb, Red Team X
 About 11 mins

An attacker with ADB access to an Android device can trick the “run-as” tool into believing any app is debuggable. By doing so, they can read and write private data and invoke system APIs as if they were most apps on the system—including many privileged apps, but not ones that run as the `system` user. Furthermore, they can achieve persistent code execution as Google Mobile Services (GMS) or as apps that use its SDKs by altering executable code that GMS caches in its data directory.

Google assigned the issue [CVE-2024-0044](https://www.cve.org/CVERecord?id=CVE-2024-0044) and fixed it in the [March 2024 Android Security Bulletin](https://source.android.com/docs/security/bulletin/2024-03-01), which becomes public today. Most device manufacturers received an advance copy of the Bulletin a month ago and have already prepared updates that include its fixes.

## Vulnerability details

On Android 12 and 13[1](#fn:14-not-affected), a newly-installed app’s “installer package name” is not sanitized when set via `pm install`’s `-i` flag. Neither [`pm`](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Aframeworks/base/services/core/java/com/android/server/pm/PackageManagerShellCommand.java;l=3062) nor the underlying [PackageInstallerService](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Aframeworks/base/services/core/java/com/android/server/pm/PackageInstallerService.java;l=643-653) check that it doesn’t contain special characters, let alone that it references an installed package.

Although special characters in the installer package name are harmlessly escaped when written to `/data/system/packages.xml`, they are [not escaped](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Aframeworks/base/services/core/java/com/android/server/pm/Settings.java;l=2805) when written to `/data/system/packages.list`, which replicates certain package metadata in a simple newline- and space-delimited format. By providing a name with newlines and spaces, an attacker with ADB shell access can inject an arbitrary number of fake fields and entries[2](#fn:entry-order) into `packages.list`.

One user[3](#fn:other-users) of `packages.list` is [run-as](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/core/run-as/run-as.cpp), which lets the ADB shell run code in the context of a given app. run-as is designed to reject non-[debuggable](https://developer.android.com/privacy-and-security/risks/android-debuggable) apps, but it queries the app’s debuggability—along with its UID, SELinux context, and data directory—from `packages.list`. By injecting a fake entry that preserves the latter but alters the former, the attacker can bypass the debuggability check and become nearly any app on the system.

We say “nearly” because run-as does have some extra defense-in-depth checks, the most notable of which is that it won’t assume non-app UIDs (including the `system` user, reserved for the most highly-privileged apps) even if `packages.list` says it should. It also doesn’t assume the same SELinux context as the real app, since it only considers [`seapp_contexts`](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/seapp_contexts;l=177-178) with `fromRunAs=true`: this makes no difference for unprivileged apps, since [runas\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/runas_app.te) is strictly more privileged than [untrusted\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/untrusted_app_all.te), but it does prevent the attacker from taking actions gated to [priv\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/priv_app.te) or [platform\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/platform_app.te)—even as an app that normally could.

The issue is compounded by a separate logic bug in run-as that lets it target privapps. Typically, that would be forbidden by the checks in [`check_data_path()`](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/core/run-as/run-as.cpp;l=98-143), which try to ensure that

1. every parent of the app’s data directory is owned by `system`, and
2. the data directory itself is owned by the app’s UID.

Since run-as [isn’t allowed](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/public/runas.te) to `stat()` privapp\_data\_file, check #2 should fail for a privapp either with a UID mismatch (if the fake app has the wrong data directory) or with a permission denial (if it has the right one). However, the [`check_directory()`](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/core/run-as/run-as.cpp;l=73-96) helper that performs each check includes a special case for the path `/data/user/0`. Although intended only to allow that path to be a symlink, the special case inadvertently also skips UID validation. So by setting the fake app’s data path to `/data/user/0`, the attacker can satisfy run-as’s internal security checks. And once in runas\_app, they can read and write privapp\_data\_file because Android somewhat perplexingly [allows](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/app.te;l=254-256) any app to do that.

On Android devices with Google Mobile Services (GMS), the attacker can gain persistence within GMS (escalating to [gmscore\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/gmscore_app.te) in the process) by rewriting the cached ODEX/VDEX files in `/data/user_de/0/com.google.android.gms/app_chimera/m/*/oat/`, which contain unsigned executable code that GMS loads. Some of that code is also loaded into apps that use Google APIs, allowing persistence there too. This isn’t a bug per se, but it does highlight the importance of [enforcing W|X](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/priv_app.te;l=17-26) in privapp data directories.

## Exploitation

A basic exploit takes just 4 lines:

```
# Pretty ugly way to get the package's UID, but I couldn't find a simpler one.
UID=$(pm list packages -U | sed -n "s/^package:$1 uid://p")

# This is the line we inject...
PAYLOAD="@null
victim $UID 1 /data/user/0 default:targetSdkVersion=28 none 0 0 1 @null"

# ...and this is how we inject it.
pm install -i "$PAYLOAD" any-app.apk

```

Since “installer package name” is the last field in a packages.list entry, all we have to do is provide a legitimate-looking value followed by a newline and any forged entry we want. For this PoC, we gave the forged entry a package name of “victim”, meaning `run-as victim` will switch to the UID and SELinux context described by that line. We set the UID dynamically based on the real package we intend to exploit, and all the other fields are set to fixed or dummy values:

* The third field, `1` indicates the package is debuggable.
* The fourth, `/data/user/0`, is the data path needed to become privapps as described in the writeup.
* The fifth field is used to derive the SELinux domain and is set to a generic value that will work for any app targeting API >= 28.
* The other fields don’t matter to run-as.

## Attack scenarios

A local attacker with ADB shell access to an Android 12 or 13 device with Developer Mode enabled can exploit the vulnerability to run code in the context of any non-`system`-UID app. From there, the attacker can do anything the app can, like access its private data files or read the credentials it’s stored in AccountManager. This violates the security guarantees of the [Application Sandbox](https://source.android.com/docs/security/app-sandbox), which is supposed to safeguard an app’s data from even the owner of the device.

Non-`system` privapps are vulnerable, but for those the attacker does not gain any SELinux permissions beyond what run-as grants for a normal unprivileged app. That means no access to Binder APIs [marked](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/public/service.te) only as `system_api_service`, for example.

## Response

We reported this vulnerability privately to Google on October 24, 2023. Google acknowledged our report immediately, and the Android Security Team rated it as High severity the following week. On December 19th, Google informed us they’d developed a fix and planned to release it with the March Android Security Bulletin, which they acknowledged was past Meta’s default 90-day disclosure period. We offered to move our disclosure to match theirs, as is [our policy](https://about.meta.com/security/vulnerability-disclosure-policy) when a vendor demonstrates a good-faith effort to promptly address an issue.

As planned, this post, [our accompanying disclosure](https://github.com/metaredteam/external-disclosures/security/advisories/GHSA-m7fh-f3w4-r6v2), and the [March ASB](https://source.android.com/docs/security/bulletin/2024-03-01) were all released today.

## Issue list

For ease of reference, here’s a numbered list of the technical flaws we identified in this report:

1. [Bug] It’s possible to inject newlines and spaces into `packages.list` on Android 12 and 13.
2. [Bug] run-as accepts `/data/user/0` as a data directory for any app.
3. [Weakness] run-as trusts the data path from `packages.list` when `userId == 0`, even though it has enough information to construct that path itself (as demonstrated by the [userId != 0 case](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/core/run-as/run-as.cpp;l=203-209)).
4. [Weakness] untrusted\_app is granted broad SELinux permissions on privapp\_data\_file, even though (as far as we’re aware) there’s no legitimate need for write access.
5. [Weakness] Android stores AOT-compiled ODEX/VDEX files alongside the APK they’re for, even when that APK is in an app-writable data directory. It does not apply an alternate SELinux label, such as the already-extant [app\_exec\_data\_file](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/app_neverallows.te;l=52-56), to prevent apps from altering them.

## Appendix: disclosure timeline

* July 23rd, 2022: We notice the `packages.list` injection vulnerability as part of unrelated Android research and build a basic run-as PoC, but other planned work prevents us from investigating further.
* May 5th, 2023: We return to the issue and discover the exploit can be tweaked to work for privapps too. We begin looking for interesting data files among privileged apps.
* June 5th, 2023: We demonstrate persistent code execution in GMS and in apps that use Google SDKs by modifying cached code GMS’s data directory.
* October 24, 2023: We report our findings to Google, who passes them to the Android Security Team.
* November 3rd, 2023: Google notifies us that they’ve rated the issue High Severity.
* December 12th, 2023: We ask Google why they settled on High severity, as that contravenes their [published rubric](https://source.android.com/docs/security/overview/updates-resources#severity) which says that exploits requiring Developer Mode are Low severity at most. Google responds that attacks “against the device or an app on the device”, as opposed to “against the device user themselves”, are not subject to that restriction.
* December 19th, 2023: Google says they’ve developed a fix for the injection vulnerability but won’t be able to release it until the March 4th, 2024 Android Security bulletin. They ask for an extension of our tentative 90-day disclosure date, which we agree to.
* December 22nd, 2023: We meet briefly with members of the Google VRP and Android Security teams to discuss details of the disclosure plan. Google tells us that the report qualifies for a $7,000 bounty.
* January 16th, 2024: Google officially offers us the bounty, which we ask them on January 26th to donate to charity. (Google, like Meta, doubles bounties paid to charity.)
* February 6th, 2024: We ask Google to confirm the CVE ID of CVE-2024-0044, which we learned from the March ASB partner preview, as they had not yet told us. They confirm it.
* March 4th, 2024: This post, [our disclosure](https://github.com/metaredteam/external-disclosures/security/advisories/GHSA-m7fh-f3w4-r6v2), and the [March ASB](https://source.android.com/docs/security/bulletin/2024-03-01) all go live.

## Footnotes

1. In Android 14, `PackageInstallerService` ensures the installer package name references an installed package, so the issue is no longer exploitable. However, the check is still fairly high in the call stack and the [change that added it](https://cs.android.com/android/_/android/platform/frameworks/base/%2B/f052ba7eb8fba18cf93326a5c77a5ffd6ce85266) seems to have fixed this issue inadvertently rather than intentionally, so we still recommend additional defense in depth. [↩](#fnref:14-not-affected)
2. Entries in `packages.list` are deterministically ordered by Java’s `String.hashCode()`, so it’s possible to craft a package that appears at the very top whose injected entries a parser will always see before real entries with the same package name. The name `com.hashed.first.WHGCXIP` is one of many that hashes to the lowest possible value and `com.hashed.last.JJEJTOC` is likewise for the highest. Since `run-as` doesn’t care about package name, we didn’t have to use this trick in our PoC. [↩](#fnref:entry-order)
3. `packages.list` has other clients, like [simpleperf\_app\_runner](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/extras/simpleperf/simpleperf_app_runner/simpleperf_app_runner.cpp;l=85), but `run-as` is the one for which this issue causes by far the greatest security threat. [↩](#fnref:other-users)

[Missing signs: how several brands forgot...](/exploitation/2024/01/30/Android-vendors-APEX-test-keys.html "Missing signs: how several brands forgot to secure a key piece of Android")[Becoming any Android app via Zygote...](/exploitation/2024/06/03/Android-Zygote-injection.html "Becoming any Android app via Zygote command injection")
Related Articles

* [Sandboxing ImageIO media parsing in macOS
  TOP
  NEW](/mitigation/2023/09/11/Sandboxing-ImageIO-in-macOS.html "Sandboxing ImageIO media parsing in macOS")
* [Becoming any Android app via Zygote command injection
  TOP
  NEW](/exploitation/2024/06/03/Android-Zygote-injection.html "Becoming any Android app via Zygote command injection")
* [Missing signs: how several brands forgot to secure a key piece of...
  TOP
  NEW](/exploitation/2024/01/30/Android-vendors-APEX-test-keys.html "Missing signs: how several brands forgot to secure a key piece of Android")
* [The many meanings of "system app" in modern Android
  TOP
  NEW](/reference/2024/07/03/Android-system-apps.html "The many meanings of \"system app\" in modern Android")

TOC

© 2022-2024 Meta Red Team X
Powered by [Jekyll](https://jekyllrb.com/ "Jekyll is a simple, blog-aware, static site
      generator.") & [Yat Theme](https://github.com/jeffreytse/jekyll-theme-yat "Yat, yet
      another theme.").
Subscribe [via RSS](/feed.xml)



=== Content from github.com_d4200a77_20250111_103303.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmetaredteam%2Fexternal-disclosures%2Fsecurity%2Fadvisories%2FGHSA-m7fh-f3w4-r6v2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmetaredteam%2Fexternal-disclosures%2Fsecurity%2Fadvisories%2FGHSA-m7fh-f3w4-r6v2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=metaredteam%2Fexternal-disclosures)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[metaredteam](/metaredteam)
/
**[external-disclosures](/metaredteam/external-disclosures)**
Public

* [Notifications](/login?return_to=%2Fmetaredteam%2Fexternal-disclosures) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fmetaredteam%2Fexternal-disclosures)
* [Star
   26](/login?return_to=%2Fmetaredteam%2Fexternal-disclosures)

* [Code](/metaredteam/external-disclosures)
* [Pull requests
  0](/metaredteam/external-disclosures/pulls)
* [Security](/metaredteam/external-disclosures/security)
* [Insights](/metaredteam/external-disclosures/pulse)

Additional navigation options

* [Code](/metaredteam/external-disclosures)
* [Pull requests](/metaredteam/external-disclosures/pulls)
* [Security](/metaredteam/external-disclosures/security)
* [Insights](/metaredteam/external-disclosures/pulse)

# Android packages.list newline injection allows run-as as any app from ADB

High

[vladionescu](/vladionescu)
published
GHSA-m7fh-f3w4-r6v2
Mar 4, 2024

## Package

No package listed

## Affected versions

12, 13

## Patched versions

None

## Description

**For more detailed analysis of this issue, see [Red Team X's blog post about it](https://rtx.meta.security/exploitation/2024/03/04/Android-run-as-forgery.html).**

An attacker with ADB access to an Android device can trick the "run-as" tool into believing any app is debuggable. By doing so, they can read and write private data and invoke system APIs as if they were most apps on the system—including many privileged apps, but not ones that run as the `system` user. Furthermore, they can achieve persistent code execution as Google Mobile Services (GMS) or as apps that use its SDKs by altering executable code that GMS caches in its data directory.

Google assigned the issue CVE-2024-0044 and fixed it in the [March 2024 Android Security Bulletin](https://source.android.com/docs/security/bulletin/2024-03-01), which becomes public today. Most device manufacturers received an advance copy of the Bulletin a month ago and have already prepared updates that include its fixes.

# Vulnerability details

On Android 12 and 13[1](#user-content-fn-14-not-affected-42c63b9635a38271d10d0a53c30a47d6), a newly-installed app's "installer package name" is not sanitized when set via `pm install`'s `-i` flag. Neither [`pm`](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Aframeworks/base/services/core/java/com/android/server/pm/PackageManagerShellCommand.java;l=3062) nor the underlying [PackageInstallerService](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Aframeworks/base/services/core/java/com/android/server/pm/PackageInstallerService.java;l=643-653) check that it doesn't contain special characters, let alone that it references an installed package.

Although special characters in the installer package name are harmlessly escaped when written to `/data/system/packages.xml`, they are [not escaped](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Aframeworks/base/services/core/java/com/android/server/pm/Settings.java;l=2805) when written to `/data/system/packages.list`, which replicates certain package metadata in a simple newline- and space-delimited format. By providing a name with newlines and spaces, an attacker with ADB shell access can inject an arbitrary number of fake fields and entries[2](#user-content-fn-entry-order-42c63b9635a38271d10d0a53c30a47d6) into `packages.list`.

One user[3](#user-content-fn-other-users-42c63b9635a38271d10d0a53c30a47d6) of `packages.list` is [run-as](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/core/run-as/run-as.cpp), which lets the ADB shell run code in the context of a given app. run-as is designed to reject non-[debuggable](https://developer.android.com/privacy-and-security/risks/android-debuggable) apps, but it queries the app's debuggability—along with its UID, SELinux context, and data directory—from `packages.list`. By injecting a fake entry that preserves the latter but alters the former, the attacker can bypass the debuggability check and become nearly any app on the system.

We say "nearly" because run-as does have some extra defense-in-depth checks, the most notable of which is that it won't assume non-app UIDs (including the `system` user, reserved for the most highly-privileged apps) even if `packages.list` says it should. It also doesn't assume the same SELinux context as the real app, since it only considers [`seapp_contexts`](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/seapp_contexts;l=177-178) with `fromRunAs=true`: this makes no difference for unprivileged apps, since [runas\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/runas_app.te) is strictly more privileged than [untrusted\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/untrusted_app_all.te), but it does prevent the attacker from taking actions gated to [priv\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/priv_app.te) or [platform\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/platform_app.te)—even as an app that normally could.

The issue is compounded by a separate logic bug in run-as that lets it target privapps. Typically, that would be forbidden by the checks in [`check_data_path()`](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/core/run-as/run-as.cpp;l=98-143), which try to ensure that

1. every parent of the app's data directory is owned by `system`, and
2. the data directory itself is owned by the app's UID.

Since run-as [isn't allowed](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/public/runas.te) to `stat()` privapp\_data\_file, check #2 should fail for a privapp either with a UID mismatch (if the fake app has the wrong data directory) or with a permission denial (if it has the right one). However, the [`check_directory()`](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/core/run-as/run-as.cpp;l=73-96) helper that performs each check includes a special case for the path `/data/user/0`. Although intended only to allow that path to be a symlink, the special case inadvertently also skips UID validation. So by setting the fake app's data path to `/data/user/0`, the attacker can satisfy run-as's internal security checks. And once in runas\_app, they can read and write privapp\_data\_file because Android somewhat perplexingly [allows](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/app.te;l=254-256) any app to do that.

On Android devices with Google Mobile Services (GMS), the attacker can gain persistence within GMS (escalating to [gmscore\_app](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/gmscore_app.te) in the process) by rewriting the cached ODEX/VDEX files in `/data/user_de/0/com.google.android.gms/app_chimera/m/*/oat/`, which contain unsigned executable code that GMS loads. Some of that code is also loaded into apps that use Google APIs, allowing persistence there too. This isn't a bug per se, but it does highlight the importance of [enforcing W|X](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/priv_app.te;l=17-26) in privapp data directories.

# Attack scenarios

A local attacker with ADB shell access to an Android 12 or 13 device with Developer Mode enabled can exploit the vulnerability to run code in the context of any non-`system`-UID app. From there, the attacker can do anything the app can, like access its private data files or read the credentials it's stored in AccountManager. This violates the security guarantees of the [Application Sandbox](https://source.android.com/docs/security/app-sandbox), which is supposed to safeguard an app's data from even the owner of the device.

Non-`system` privapps are vulnerable, but for those the attacker does not gain any SELinux permissions beyond what run-as grants for a normal unprivileged app. That means no access to Binder APIs [marked](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/public/service.te) only as `system_api_service`, for example.

# Issue list

For ease of reference, here's a numbered list of the technical flaws this advisory encompasses:

1. [Bug] It's possible to inject newlines and spaces into `packages.list` on Android 12 and 13.
2. [Bug] run-as accepts `/data/user/0` as a data directory for any app.
3. [Weakness] run-as trusts the data path from `packages.list` when `userId == 0`, even though it has enough information to construct that path itself (as demonstrated by the [userId != 0 case](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/core/run-as/run-as.cpp;l=203-209)).
4. [Weakness] untrusted\_app is granted broad SELinux permissions on privapp\_data\_file, even though (as far as we're aware) there's no legitimate need for write access.
5. [Weakness] Android stores AOT-compiled ODEX/VDEX files alongside the APK they're for, even when that APK is in an app-writable data directory. It does not apply an alternate SELinux label, such as the already-extant [app\_exec\_data\_file](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/sepolicy/private/app_neverallows.te;l=52-56), to prevent apps from altering them.

## Footnotes

1. In Android 14, `PackageInstallerService` ensures the installer package name references an installed package, so the issue is no longer exploitable. However, the check is still fairly high in the call stack and the [change that added it](https://cs.android.com/android/_/android/platform/frameworks/base/%2B/f052ba7eb8fba18cf93326a5c77a5ffd6ce85266) seems to have fixed this issue inadvertently rather than intentionally, so we still recommend additional defense in depth. [↩](#user-content-fnref-14-not-affected-42c63b9635a38271d10d0a53c30a47d6)
2. Entries in `packages.list` are deterministically ordered by Java's `String.hashCode()`, so it's possible to craft a package that appears at the very top whose injected entries a parser will always see before real entries with the same package name. The name `com.hashed.first.WHGCXIP` is one of many that hashes to the lowest possible value and `com.hashed.last.JJEJTOC` is likewise for the highest. Since `run-as` doesn't care about package name, we didn't have to use this trick in our PoC. [↩](#user-content-fnref-entry-order-42c63b9635a38271d10d0a53c30a47d6)
3. `packages.list` has other clients, like [simpleperf\_app\_runner](https://cs.android.com/android/platform/superproject/%2B/android-13.0.0_r74%3Asystem/extras/simpleperf/simpleperf_app_runner/simpleperf_app_runner.cpp;l=85), but `run-as` is the one for which this issue causes by far the greatest security threat. [↩](#user-content-fnref-other-users-42c63b9635a38271d10d0a53c30a47d6)

### Severity

High

### CVE ID

CVE-2024-0044

### Weaknesses

[CWE-74](/advisories?query=cwe%3A74)

### Credits

* [![@tchebb](https://avatars.githubusercontent.com/u/1082640?s=40&v=4)](/tchebb)
  [tchebb](/tchebb)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


