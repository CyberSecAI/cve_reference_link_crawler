Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2021-26089

**Root Cause of Vulnerability:**

*   **FortiClient for MacOS:** Improper symlink following during the installation/uninstallation process.
*   **FortiClient Network Access Control (Windows):** The service loads an OpenSSL configuration file from an unsecured location.

**Weaknesses/Vulnerabilities Present:**

*   **Improper Symlink Following (CWE-61):** On MacOS, the installer/uninstaller improperly handles symbolic links, allowing a local user to redirect file writes to arbitrary locations.
*   **Uncontrolled Search Path Element:** On Windows, the Network Access Control service loads an OpenSSL configuration file from an insecure location, enabling an attacker to substitute a malicious configuration file.

**Impact of Exploitation:**

*   **MacOS:** A local, unprivileged user can overwrite privileged shell scripts executed during installation, leading to privilege escalation and execution of arbitrary code as root.
*   **Windows:** A local attacker can escalate privileges to execute arbitrary code in the context of SYSTEM by providing a malicious OpenSSL configuration file.

**Attack Vectors:**

*   **MacOS:** The attacker must have local access to the system and the ability to create symbolic links.
*   **Windows:** The attacker must have local access to the system and the ability to write to the insecure location where the OpenSSL configuration file is loaded from.

**Required Attacker Capabilities/Position:**

*   **MacOS:** The attacker needs local access and a low-privileged account. The attacker also needs to be able to create a malicious symlink.
*   **Windows:** The attacker needs to have local access and the ability to execute low-privileged code on the target system.

**Additional Information:**

*   The MacOS vulnerability is described as a privilege escalation due to the ability to overwrite privileged shell scripts.
*   The Windows vulnerability is described as being exploitable via a malicious OpenSSL configuration file.
*   The ZDI advisory indicates the Windows vulnerability is within the Network Access Control service.
*   The MacOS vulnerability was reported by Csaba Fitzl and Trend Micro Zero Day Initiative
*   The Windows vulnerability was reported by brsn.
*   Fortinet has released patches to address the vulnerabilities in both MacOS and Windows.