- **Root cause of vulnerability**: The `log` function uses `vsnprintf` with a format string controlled by the attacker.
- **Weaknesses/vulnerabilities present**: Format string injection vulnerability. The `log` function takes a user-controlled string from the `default_key_id` parameter, which is used as the format string argument to the `vsnprintf` function.
- **Impact of exploitation**: Memory corruption, information disclosure, and denial of service. Specifically, an attacker can leak stack memory and potentially write arbitrary memory using format string specifiers. However, output from format string injections stemming from misuse of the `log` function will only be available to a physically present attacker who has partially disassembled the device and connected to the UART console.
- **Attack vectors**: An authenticated HTTP request to the `/action/wirelessConnect` endpoint.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the device's web interface after enabling it and changing the admin password. The attacker also needs physical access to the device's UART console to observe the output of the format string injection.

The content provides more detail than the official CVE description by providing the vulnerable code snippets, explanation of the vulnerability, and exploitation example.