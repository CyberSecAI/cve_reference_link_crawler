The provided content relates to CVE-2015-10040.

**Root cause of vulnerability:** The `calcgrade.sh` script was vulnerable to ANSI escape sequence injection. By crafting a malicious grade file, an attacker could inject escape sequences that would alter the display of grades in the terminal, potentially showing incorrect or misleading information to the grader.

**Weaknesses/vulnerabilities present:**
- The script did not properly sanitize or validate the contents of the grade file before displaying it. This allowed for the injection of ANSI escape sequences that could alter the terminal output.
- Specifically, the `getGrade` and `getOutOf` functions were vulnerable to the injection, leading to the incorrect output.

**Impact of exploitation:**
- An attacker could modify the displayed grade information for any assignment, potentially misrepresenting their scores to the grader.
- The attacker could manipulate the terminal output, including changing text colors, positioning the cursor, or even clearing parts of the screen. In the provided example, the attacker changed red text to black, and also displayed an incorrect score of 437%.

**Attack vectors:**
- The attacker creates a specially crafted grade file containing ANSI escape sequences.
- This file is then processed by the `calcgrade.sh` script, which does not sanitize the input.
- The script outputs the grades to the terminal using `head`, `cut`, `sed`, and `awk`, which process the injected escape codes and alter the display.

**Required attacker capabilities/position:**
- The attacker must be able to create or modify the grade files that are used by the `calcgrade.sh` script.
- The attacker needs to know the format of grade files and how they are used by the script to inject ANSI escape codes effectively.
- The attacker requires write access to the files containing the grades, or some other method of injecting malicious data into the files read by `calcgrade.sh`