```
{
  "CVE_data_meta": {
    "ID": "CVE-2021-47418",
    "ASSIGNER": "cve@mitre.org"
  },
  "description": {
    "description_data": [
      {
        "lang": "en",
        "value": "There is a NULL pointer dereference vulnerability in the Linux kernel's net_sched component. When using 'tc qd replace' to replace a qdisc (e.g., 'tbf') with a qdisc that does not have a change() operation (e.g., 'pfifo_fast'), a NULL pointer dereference occurs in fifo_set_limit()."
      }
    ]
  },
  "impact": {
    "cvss": {
      "version": "3.1",
      "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
      "attackVector": "LOCAL",
      "attackComplexity": "LOW",
      "privilegesRequired": "HIGH",
      "userInteraction": "NONE",
      "scope": "UNCHANGED",
      "confidentialityImpact": "NONE",
      "integrityImpact": "NONE",
      "availabilityImpact": "HIGH",
      "baseScore": 4.4,
      "baseSeverity": "MEDIUM"
    }
  },
    "problemtype": {
      "problemtype_data": [
        {
          "description": [
            {
              "lang": "en",
              "value": "CWE-476"
            }
          ]
        }
      ]
    },
  "affects": {
    "vendor": {
      "vendor_data": [
        {
          "vendor_name": "Linux",
          "product": {
            "product_data": [
              {
                "product_name": "Linux Kernel",
                  "version": {
                    "version_data": [
                      {
                        "version_value": "Affected versions include but are not limited to v5.15-rc3"
                      }
                    ]
                  }
              }
            ]
          }
        }
      ]
    }
  },
  "references": {
    "reference_data": [
      {
        "url": "https://lore.kernel.org/r/20210930212239.3430364-1-eric.dumazet@gmail.com",
        "name": "https://lore.kernel.org/r/20210930212239.3430364-1-eric.dumazet@gmail.com",
        "refsource": "MISC"
      }
    ]
  },
  "exploit": [
    {
      "lang": "en",
      "value": "The vulnerability can be triggered by using the following sequence of commands:\n\nunshare -n\ntc qd add dev lo root handle 1:0 tbf limit 200000 burst 70000 rate 100Mbit\ntc qd replace dev lo parent 1:0 pfifo_fast\ntc qd change dev lo root handle 1:0 tbf limit 300000 burst 70000 rate 100Mbit"
    }
  ],
  "technical_details": {
    "vulnerability": [
      {
        "lang": "en",
        "value": "Root cause: The `fifo_set_limit()` function in `net/sched/sch_fifo.c` attempts to access the `change` operation of a qdisc without first verifying that the `change` operation exists. This occurs when a qdisc is replaced with another that lacks this functionality.\n\nWeakness: The vulnerability is a NULL pointer dereference caused by not checking the qdisc's operation before accessing it. The lack of a `change` function in the replaced qdisc is the root of the problem.\n\nImpact: A local, privileged attacker can cause a denial of service by crashing the kernel via a NULL pointer dereference in `fifo_set_limit()`.\n\nAttack vectors: The attack requires local access and the ability to execute 'tc' commands to configure network traffic control. This means that the attacker must have root privileges.\n\nRequired attacker capabilities: The attacker must have root privileges to execute the necessary 'tc' commands to setup and configure the traffic control queues that lead to the vulnerability. The attacker must also be able to create a new network namespace using `unshare -n`. The attacker must be able to execute these commands in a sequence that replaces the traffic control qdisc."
      }
    ],
    "remediation": [
      {
        "lang": "en",
        "value": "The vulnerability is fixed by adding a check to verify that the qdisc has a 'change' operation before attempting to use it within the `fifo_set_limit()` function. The patch adds the following lines:\n\n```c\n if (!q->ops->change)\n  return 0;\n```"
      }
    ]
  }
}
```