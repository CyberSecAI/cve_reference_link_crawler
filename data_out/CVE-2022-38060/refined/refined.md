- **Root cause of vulnerability:** A misconfiguration in `/etc/sudoers` within OpenStack Kolla containers allows users to modify environment variables, specifically the `PATH` variable, when executing commands via `sudo`. This is due to the `Defaults: %kolla setenv` line, which enables the manipulation of environment variables without a `secure_path` to enforce a trusted `PATH`.
- **Weaknesses/vulnerabilities present:**
    - Improper privilege management due to the `setenv` option in `/etc/sudoers`.
    - Lack of `secure_path` enforcement allowing PATH variable manipulation.
    - Vulnerable scripts (`kolla_copy_cacerts` and `kolla_set_configs`) that rely on the manipulated `PATH` or accept dangerous input through environment variables.
- **Impact of exploitation:**
    - Privilege escalation to root within the container.
    - In cases where privileged containers are used, this can lead to root access on the container host itself.
    - Arbitrary command execution as root.
    - Ability to create and run setuid binaries leading to persistent privilege escalation.
- **Attack vectors:**
    - Local access to the container is required.
    - Exploitation involves modifying the `PATH` environment variable before executing specific Kolla scripts with `sudo -E` to call malicious programs.
    - Alternatively, an attacker can craft a JSON object via an environment variable to copy a setuid binary with `kolla_set_configs`, then execute the binary.
- **Required attacker capabilities/position:**
    - Attacker needs to have access to an account within a vulnerable OpenStack Kolla container that is part of the `kolla` group.
    - No specific network position required, local access to the container is sufficient.