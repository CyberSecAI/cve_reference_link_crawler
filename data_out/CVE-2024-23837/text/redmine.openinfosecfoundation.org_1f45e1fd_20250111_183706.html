

⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #6444

closed

### http1: quadratic complexity from infinite folded headers

Added by [Philippe Antoine](/users/1820) [about 1 year](/projects/suricata/activity?from=2023-11-07 "11/07/2023 05:20 PM") ago.
Updated [9 months](/projects/suricata/activity?from=2024-04-04 "04/04/2024 07:41 AM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[8.0.0-beta1](/versions/163 "04/01/2025")
Affected Versions:Label:CVE:[2024-23837](https://nvd.nist.gov/vuln/detail/CVE-2024-23837)Git IDs:

20ac301d801cdf01b3f021cca08a22a87f477c4a

Severity:CRITICALDisclosure Date:01/24/2024

---

**Description**

Found by oss-fuzz with quadfuzz
<https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=63600&q=label%3AProj-suricata>

POC to reproduce is
```

GET / HTTP/1.1
Host: localhost
Header: a
 b
 b
 b
 b

```

never stopping

---

**Files**

| [lol.pcap](/attachments/2872) (1.11 MB) [lol.pcap](/attachments/download/2872/lol.pcap "Download") | reproducer | Philippe Antoine, 11/08/2023 08:55 AM |  |
| --- | --- | --- | --- |

---

**Subtasks**
[2](/issues?parent_id=~6444&set_filter=true&status_id=%2A) (0 open — [2 closed](/issues?parent_id=~6444&set_filter=true&status_id=c))

|  | [Security #6528](/issues/6528): http1: quadratic complexity from infinite folded headers (6.0.x backport) | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |
|  | [Security #6533](/issues/6533): http1: quadratic complexity from infinite folded headers (7.0.x backport) | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |

* [History](/issues/6444?tab=history)
* [Notes](/issues/6444?tab=notes)
* [Property changes](/issues/6444?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Philippe Antoine](/users/1820) [about 1 year](/projects/suricata/activity?from=2023-11-08 "11/08/2023 08:51 AM") ago

* **Status** changed from *New* to *In Review*

Gitlab

ActionsCopy link
[#2](#note-2)
#### Updated by [Philippe Antoine](/users/1820) [about 1 year](/projects/suricata/activity?from=2023-11-08 "11/08/2023 08:55 AM") ago

* **File** [lol.pcap](/attachments/2872) [lol.pcap](/attachments/download/2872/lol.pcap "Download") added

ActionsCopy link
[#3](#note-3)
#### Updated by [Victor Julien](/users/4) [about 1 year](/projects/suricata/activity?from=2023-11-14 "11/14/2023 12:24 PM") ago

Affects 6.0.x as well, right?

ActionsCopy link
[#4](#note-4)
#### Updated by [Philippe Antoine](/users/1820) [about 1 year](/projects/suricata/activity?from=2023-11-14 "11/14/2023 04:02 PM") ago

indeed, but the proposed fix is just in libhtp

ActionsCopy link
[#5](#note-5)
#### Updated by [Victor Julien](/users/4) [about 1 year](/projects/suricata/activity?from=2023-11-17 "11/17/2023 10:08 AM") ago

* **Label** *Needs backport to 6.0, Needs backport to 7.0* added

ActionsCopy link
[#6](#note-6)
#### Updated by [Victor Julien](/users/4) [about 1 year](/projects/suricata/activity?from=2023-11-17 "11/17/2023 10:11 AM") ago

* **Target version** changed from *7.0.3* to *8.0.0-beta1*

ActionsCopy link
[#7](#note-7)
#### Updated by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2023-11-17 "11/17/2023 12:17 PM") ago

* **Subtask** *#6528* added

ActionsCopy link
[#8](#note-8)
#### Updated by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2023-11-17 "11/17/2023 12:17 PM") ago

* **Label** deleted (~~*Needs backport to 6.0*~~)

ActionsCopy link
[#9](#note-9)
#### Updated by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2023-11-17 "11/17/2023 12:17 PM") ago

* **Subtask** *#6533* added

ActionsCopy link
[#10](#note-10)
#### Updated by [OISF Ticketbot](/users/7712) [about 1 year](/projects/suricata/activity?from=2023-11-17 "11/17/2023 12:17 PM") ago

* **Label** deleted (~~*Needs backport to 7.0*~~)

ActionsCopy link
[#11](#note-11)
#### Updated by [Philippe Antoine](/users/1820) [about 1 year](/projects/suricata/activity?from=2024-01-04 "01/04/2024 03:15 PM") ago

* **Disclosure Date** set to *01/24/2024*

ActionsCopy link
[#12](#note-12)
#### Updated by [Victor Julien](/users/4) [about 1 year](/projects/suricata/activity?from=2024-01-04 "01/04/2024 03:39 PM") ago

* **Severity** changed from *MODERATE* to *CRITICAL*

Client only, easy to create attack traffic. So CRITICAL.

ActionsCopy link
[#13](#note-13)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 08:54 AM") ago

* **Status** changed from *In Review* to *Resolved*

ActionsCopy link
[#14](#note-14)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-08 "02/08/2024 09:39 AM") ago

* **CVE** set to *2024-23837*

Issue is in libhtp and is fixed in libhtp 0.5.46.

ActionsCopy link
[#15](#note-15)
#### Updated by [Philippe Antoine](/users/1820) [11 months](/projects/suricata/activity?from=2024-02-12 "02/12/2024 10:49 AM") ago

* **Status** changed from *Resolved* to *Closed*
* **Git IDs** updated ([diff](/journals/32550/diff?detail_id=33234 "View differences"))

ActionsCopy link
[#16](#note-16)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 10:32 AM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#17](#note-17)
#### Updated by [Victor Julien](/users/4) [11 months](/projects/suricata/activity?from=2024-02-26 "02/26/2024 01:53 PM") ago

<https://github.com/OISF/libhtp/security/advisories/GHSA-f9wf-rrjj-qx8m>

ActionsCopy link
[#18](#note-18)
#### Updated by [Philippe Antoine](/users/1820) [9 months](/projects/suricata/activity?from=2024-04-04 "04/04/2024 07:41 AM") ago

This did not affect libhtp-rs as it parses headers differently, avoiding the need to realloc for folded headers

Actions
Copy link

Also available in: [Atom](/issues/6444.atom)
[PDF](/issues/6444.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...

