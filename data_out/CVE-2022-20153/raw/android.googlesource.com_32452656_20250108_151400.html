
            Commit Information:
            ------------------
            Author: Pavel Begunkov <asml.silence@gmail.com> 1618102000 +0100
            Date: Lee Jones <joneslee@google.com> 1648052216 +0000
            Bug ID: Bug: 222091980

            Commit Message:
            --------------
            UPSTREAM: io_uring: return back safer resurrectcommit f70865db5ff35f5ed0c7e9ef63e7cca3d4947f04 upstream.Revert of revert of "io_uring: wait potential ->release() on resurrect",which adds a helper for resurrect not racing completion reinit, as wasremoved because of a strange bug with no clear root or link to thepatch.Was improved, instead of rcu_synchronize(), just wait_for_completion()because we're at 0 refs and it will happen very shortly. Specificallyuse non-interruptible version to ignore all pending signals that mayhave ended prior interruptible wait.This reverts commit cb5e1b81304e089ee3ca948db4d29f71902eb575.Bug: 222091980Signed-off-by: Pavel Begunkov <asml.silence@gmail.com>Link: https://lore.kernel.org/r/7a080c20f686d026efade810b116b72f88abaff9.1618101759.git.asml.silence@gmail.comSigned-off-by: Jens Axboe <axboe@kernel.dk>Cc: Lee Jones <lee.jones@linaro.org>Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>Signed-off-by: Lee Jones <lee.jones@linaro.org>Change-Id: If9b7b96b7cdc777640b1b5aa20d148bdad54954a
            