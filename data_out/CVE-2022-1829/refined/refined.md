- **Root cause of vulnerability:** The WordPress plugin "Inline Google Maps" lacks CSRF (Cross-Site Request Forgery) protection when updating its settings. Additionally, the plugin does not properly sanitize or escape user inputs when saving them.
- **Weaknesses/vulnerabilities present:**
    - CSRF vulnerability: The absence of CSRF checks allows an attacker to make a logged-in admin change the plugin settings without their consent.
    - Stored XSS vulnerability: The lack of sanitization and escaping of user inputs leads to a stored Cross-Site Scripting (XSS) vulnerability, allowing an attacker to inject malicious JavaScript code that is executed when an admin views the plugin settings page.
- **Impact of exploitation:** An attacker can inject arbitrary JavaScript code into the plugin settings via CSRF. This code can be used to perform various malicious actions, such as redirecting users, stealing cookies, or other attacks.
- **Attack vectors:**
    - CSRF: An attacker could create a malicious website or email that includes a crafted form that automatically submits the request to the vulnerable pluginâ€™s settings page, changing the settings on behalf of the logged-in user.
    - XSS: The injected JavaScript is stored in the database and executed when the admin views the plugin settings page
- **Required attacker capabilities/position:** The attacker needs to trick a logged-in administrator into visiting a malicious page or opening a malicious email that triggers the CSRF attack.

The provided content includes a proof of concept demonstrating the vulnerability and CVSS score.