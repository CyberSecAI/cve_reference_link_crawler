### Summary
The provided content describes a stored cross-site scripting (XSS) vulnerability in the EAN for WooCommerce plugin for WordPress, specifically in versions 4.9.2 and earlier. This vulnerability is due to insufficient sanitization and escaping of user-supplied attributes within the `alg_wc_ean_product_meta` shortcode.

### Root cause of vulnerability
The vulnerability stems from the lack of proper input sanitization and output escaping when handling user-supplied attributes within the `alg_wc_ean_product_meta` shortcode. This allows malicious code to be injected via shortcode attributes.

### Weaknesses/vulnerabilities present
- **Stored Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS, where malicious scripts are stored in the database and executed when a user views a page containing the injected code.
- **Insufficient Input Sanitization:** The plugin does not properly sanitize user-supplied attributes before processing them.
- **Insufficient Output Escaping:** The plugin does not escape user-supplied attributes before outputting them into the HTML, which allows malicious script execution.

### Impact of exploitation
- **Arbitrary Script Execution:** Attackers can inject malicious JavaScript or other client-side scripts.
- **Compromise User Accounts:** These scripts can be used to perform actions on behalf of the user, such as stealing cookies or session tokens, redirecting to malicious pages, or altering the content of the webpage, leading to a loss of confidentiality and integrity.
- **Website Defacement:** Attackers may deface a site or inject malicious content.

### Attack vectors
- **Shortcode Injection:** The primary attack vector is the injection of a malicious script via the attributes of the `alg_wc_ean_product_meta` shortcode.
- **Plugin Vulnerability:** The vulnerability resides within the EAN for WooCommerce plugin.

### Required attacker capabilities/position
- **Authentication:** The attacker needs to be an authenticated user with at least contributor-level permissions.
- **Content Modification:** The attacker needs the ability to create or edit content (like posts or pages) where they can insert the malicious shortcode.

### Additional notes

- The vulnerability was fixed in version 4.9.3 of the plugin by applying `wp_kses_post()` to sanitize the shortcode output. Additionally the `get_post_meta()` call was replaced with `$product->get_meta()` to ensure that only product meta is retrieved.
- The provided content includes links to the plugin's Trac page showing the code changes made to address the vulnerability.