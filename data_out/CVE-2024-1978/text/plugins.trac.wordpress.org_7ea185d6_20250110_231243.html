

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3036987%2540friends%26old%3D3036987%2540friends)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3032905/friends "Changeset 3032905 for friends")
* [Next Change](/changeset/3036988/friends "Changeset 3036988 for friends") →

---

# Changeset [3036987](/changeset/3036987 "Show full changeset") for [friends](/browser/friends?rev=3036987 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
02/16/2024 09:12:53 PM
([11 months](/timeline?from=2024-02-16T21%3A12%3A53Z&precision=second "See timeline at 02/16/2024 09:12:53 PM") ago)

Author:
akirk
Message:

Friends 2.8.6

Location:
[friends/trunk](/browser/friends/trunk?rev=3036987)
Files:

5 edited

* [README.md](/browser/friends/trunk/README.md?rev=3036987 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [friends.php](/browser/friends/trunk/friends.php?rev=3036987 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [includes/class-admin.php](/browser/friends/trunk/includes/class-admin.php?rev=3036987 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [includes/class-feed.php](/browser/friends/trunk/includes/class-feed.php?rev=3036987 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [includes/class-user.php](/browser/friends/trunk/includes/class-user.php?rev=3036987 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [friends/trunk/README.md](/changeset/3036987/friends/trunk/README.md "Show the changeset 3036987 restricted to friends/trunk/README.md")

  | [r3032904](/browser/friends/trunk/README.md?rev=3032904#L6 "Show revision 3032904 of this file in browser") | [r3036987](/browser/friends/trunk/README.md?rev=3036987#L6 "Show revision 3036987 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | - Tested up to: 6.4 |
  | 7 | 7 | - License: [GPLv2 or later](http://www.gnu.org/licenses/gpl-2.0.html) |
  | 8 |  | - Stable tag: 2.8.~~5~~ |
  |  | 8 | - Stable tag: 2.8.6 |
  | 9 | 9 |  |
  | 10 | 10 | Your own WordPress at the center of your online activity. Follow friends and other websites and establish friendship relationships between blogs. |
  | […](/browser/friends/trunk/README.md?rev=3032904#L94) | […](/browser/friends/trunk/README.md?rev=3036987#L94) |  |
  | 94 | 94 |  |
  | 95 | 95 | ## Changelog |
  |  | 96 |  |
  |  | 97 | ### 2.8.6 |
  |  | 98 | - Improve friend URL validation before trying to discover feeds ([#290]) |
  | 96 | 99 |  |
  | 97 | 100 | ### 2.8.5 |
  | […](/browser/friends/trunk/README.md?rev=3032904#L301) | […](/browser/friends/trunk/README.md?rev=3036987#L304) |  |
  | 301 | 304 |  |
  | 302 | 305 | [Send to E-Reader plugin]: https://github.com/akirk/friends-send-to-e-reader |
  |  | 306 | [#290]: https://github.com/akirk/friends/pull/290 |
  | 303 | 307 | [#287]: https://github.com/akirk/friends/pull/287 |
  | 304 | 308 | [#286]: https://github.com/akirk/friends/pull/286 |
* ## [friends/trunk/friends.php](/changeset/3036987/friends/trunk/friends.php "Show the changeset 3036987 restricted to friends/trunk/friends.php")

  | [r3032904](/browser/friends/trunk/friends.php?rev=3032904#L4 "Show revision 3032904 of this file in browser") | [r3036987](/browser/friends/trunk/friends.php?rev=3036987#L4 "Show revision 3036987 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin author: Alex Kirk |
  | 5 | 5 | \* Plugin URI: https://github.com/akirk/friends |
  | 6 |  | \* Version: 2.8.~~5~~ |
  |  | 6 | \* Version: 2.8.6 |
  | 7 | 7 | \* Requires PHP: 5.6 |
  | 8 | 8 |  |
  | […](/browser/friends/trunk/friends.php?rev=3032904#L26) | […](/browser/friends/trunk/friends.php?rev=3036987#L26) |  |
  | 26 | 26 | define( 'FRIENDS\_PLUGIN\_BASENAME', plugin\_basename( \_\_FILE\_\_ ) ); |
  | 27 | 27 | define( 'FRIENDS\_PLUGIN\_FILE', plugin\_dir\_path( \_\_FILE\_\_ ) . '/' . basename( \_\_FILE\_\_ ) ); |
  | 28 |  | define( 'FRIENDS\_VERSION', '2.8.~~5~~' ); |
  |  | 28 | define( 'FRIENDS\_VERSION', '2.8.6' ); |
  | 29 | 29 |  |
  | 30 | 30 | require\_once \_\_DIR\_\_ . '/libs/Mf2/Parser.php'; |
* ## [friends/trunk/includes/class-admin.php](/changeset/3036987/friends/trunk/includes/class-admin.php "Show the changeset 3036987 restricted to friends/trunk/includes/class-admin.php")

  | [r3032904](/browser/friends/trunk/includes/class-admin.php?rev=3032904#L1257 "Show revision 3032904 of this file in browser") | [r3036987](/browser/friends/trunk/includes/class-admin.php?rev=3036987#L1257 "Show revision 3036987 of this file in browser") |  |
  | --- | --- | --- |
  | 1257 | 1257 | $friend = User::get\_user\_by\_id( $user\_id ); |
  | 1258 | 1258 |  |
  | 1259 |  | ~~$image = file\_get\_contents( $\_POST['avatar'] );~~ |
  | 1260 |  |  |
  | 1261 | 1259 | // Use WordPress functions to check the image dimensions. |
  | 1262 | 1260 | $size = \wp\_getimagesize( $\_POST['avatar'] ); |
  | […](/browser/friends/trunk/includes/class-admin.php?rev=3032904#L1866) | […](/browser/friends/trunk/includes/class-admin.php?rev=3036987#L1864) |  |
  | 1866 | 1864 | if ( home\_url() === trailingslashit( $friend\_url ) ) { |
  | 1867 | 1865 | return new \WP\_Error( 'friend-yourself', \_\_( 'It seems like you sent a friend request to yourself.', 'friends' ) ); |
  |  | 1866 | } |
  |  | 1867 |  |
  |  | 1868 | if ( ! Friends::check\_url( $friend\_url ) ) { |
  |  | 1869 | return new \WP\_Error( 'invalid-url', \_\_( 'You entered an invalid URL.', 'friends' ) ); |
  | 1868 | 1870 | } |
  | 1869 | 1871 |  |
* ## [friends/trunk/includes/class-feed.php](/changeset/3036987/friends/trunk/includes/class-feed.php "Show the changeset 3036987 restricted to friends/trunk/includes/class-feed.php")

  | [r2970469](/browser/friends/trunk/includes/class-feed.php?rev=2970469#L797 "Show revision 2970469 of this file in browser") | [r3036987](/browser/friends/trunk/includes/class-feed.php?rev=3036987#L797 "Show revision 3036987 of this file in browser") |  |
  | --- | --- | --- |
  | 797 | 797 | \*/ |
  | 798 | 798 | public function discover\_available\_feeds( $url ) { |
  |  | 799 | if ( ! Friends::check\_url( $url ) ) { |
  |  | 800 | return array(); |
  |  | 801 | } |
  | 799 | 802 | $available\_feeds = array(); |
  | 800 | 803 | $content = null; |
* ## [friends/trunk/includes/class-user.php](/changeset/3036987/friends/trunk/includes/class-user.php "Show the changeset 3036987 restricted to friends/trunk/includes/class-user.php")

  | [r3032904](/browser/friends/trunk/includes/class-user.php?rev=3032904#L497 "Show revision 3032904 of this file in browser") | [r3036987](/browser/friends/trunk/includes/class-user.php?rev=3036987#L497 "Show revision 3036987 of this file in browser") |  |
  | --- | --- | --- |
  | 497 | 497 | public function modify\_query\_by\_author( \WP\_Query $query ) { |
  | 498 | 498 | $query->set( 'author', $this->ID ); |
  |  | 499 | if ( ! user\_can( $this->ID, 'friends\_plugin' ) || user\_can( $this->ID, 'administrator' ) ) { |
  |  | 500 | // If the user doesn't belong to the friends plugin, only show their local posts so that subcriptions don't spill in. |
  |  | 501 | $query->set( 'post\_type', 'post' ); |
  |  | 502 | } |
  | 499 | 503 | return $query; |
  | 500 | 504 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3036987)
* [Zip Archive](?format=zip&new=3036987)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

