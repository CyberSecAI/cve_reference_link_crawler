- **Root cause of vulnerability**: The SQL Expressions feature in Grafana allows users to evaluate `duckdb` queries that contain user-provided input. These queries are not properly sanitized before being passed to `duckdb`.
- **Weaknesses/vulnerabilities present**: Command injection and local file inclusion.
- **Impact of exploitation**: An attacker can execute arbitrary commands and include local files, potentially leading to data exfiltration or system compromise.
- **Attack vectors**: The vulnerability can be exploited through the SQL Expressions feature by injecting malicious code into the user-provided input within the `duckdb` queries.
- **Required attacker capabilities/position**: Any user with VIEWER or higher permissions can exploit this vulnerability. The `duckdb` binary must also be present in Grafanaâ€™s $PATH for the attack to work, which is not the default configuration.