Based on the provided content, here's the breakdown of CVE-2022-45636:

**Root Cause:**

*   The vulnerability stems from an insecure authorization scheme in the HTTP API used by the DBD+ mobile application, which manages Megafeis smart locks. The API relies solely on a request signing key for authorization, without properly validating user session tokens or performing authorization checks based on these tokens.

**Weaknesses/Vulnerabilities Present:**

*   **Insecure Authorization Scheme:** The API does not verify if a user is authorized to make a request, relying solely on a "SecSignDest" header for request validation.
*   **Forgable Signing Key:** The "SecSignDest" header is generated using a predictable algorithm, combining fixed strings, a timestamp, truncated request body data, and the API endpoint, all hashed with MD5. This enables attackers to forge signing keys.
*   **Lack of Session Token Validation for Authorization**: Session tokens are sent, but are not used to determine if the user is authorized to make the requested action.

**Impact of Exploitation:**

*   **Arbitrary API Requests:** Attackers can forge request signing keys and perform any API request by the user.
*   **Lock Enumeration:** Attackers can enumerate Megafeis smart locks within Bluetooth range by using the lock's MAC address.
*   **Lock Ownership Transfer:** Attackers can transfer ownership of a lock to their account.
*   **Unauthorized Lock Unlocking:** Attackers can unlock any Megafeis smart lock if they have the MAC address and a forged request.

**Attack Vectors:**

*   **Network:** Exploitation occurs through the HTTP API used by the DBD+ application.
*   **Bluetooth:** The attacker needs to be within Bluetooth range to obtain the target lock's MAC address.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs a valid DBD+ account.
*   **Bluetooth Range:** The attacker needs to be within Bluetooth range of the target smart lock to discover the MAC address.
*   **Technical Skills:** The attacker needs to be able to forge the signing key by reverse engineering the application and sending crafted HTTP requests.

**Additional Details:**

*   The signing key ("SecSignDest" header) is generated by concatenating the string "OKLOK", the request timestamp, truncated request body data, and the API endpoint, then hashing the result with MD5.
*   The vulnerability affects Megafeis branded locks including models FB50S, GS60FB, GS40S, and GQ10FB.
*   A proof-of-concept (PoC) script has been developed to demonstrate the vulnerability, allowing an attacker to take over a lock using its MAC address.
* The vulnerability was discovered in the DBD+ Mobile Companion Application for IOS & Android - IOS: Version 1.4.3, Android: 1.4.4
*   The vendor has not responded to notifications, nor has a fix been released.