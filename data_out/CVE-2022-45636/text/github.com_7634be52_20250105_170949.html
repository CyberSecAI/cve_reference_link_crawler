
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWithSecureLabs%2Fmegafeis-palm%2Ftree%2Fmain%2FCVE-2022-45636)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWithSecureLabs%2Fmegafeis-palm%2Ftree%2Fmain%2FCVE-2022-45636)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=WithSecureLabs%2Fmegafeis-palm)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[WithSecureLabs](/WithSecureLabs)
/
**[megafeis-palm](/WithSecureLabs/megafeis-palm)**
Public

* [Notifications](/login?return_to=%2FWithSecureLabs%2Fmegafeis-palm) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FWithSecureLabs%2Fmegafeis-palm)
* [Star
   1](/login?return_to=%2FWithSecureLabs%2Fmegafeis-palm)

* [Code](/WithSecureLabs/megafeis-palm)
* [Issues
  0](/WithSecureLabs/megafeis-palm/issues)
* [Pull requests
  0](/WithSecureLabs/megafeis-palm/pulls)
* [Actions](/WithSecureLabs/megafeis-palm/actions)
* [Projects
  0](/WithSecureLabs/megafeis-palm/projects)
* [Security](/WithSecureLabs/megafeis-palm/security)
* [Insights](/WithSecureLabs/megafeis-palm/pulse)

Additional navigation options

* [Code](/WithSecureLabs/megafeis-palm)
* [Issues](/WithSecureLabs/megafeis-palm/issues)
* [Pull requests](/WithSecureLabs/megafeis-palm/pulls)
* [Actions](/WithSecureLabs/megafeis-palm/actions)
* [Projects](/WithSecureLabs/megafeis-palm/projects)
* [Security](/WithSecureLabs/megafeis-palm/security)
* [Insights](/WithSecureLabs/megafeis-palm/pulse)

## Files

 main
## Breadcrumbs

1. [megafeis-palm](/WithSecureLabs/megafeis-palm/tree/main)
/
# CVE-2022-45636

/
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/WithSecureLabs/megafeis-palm/commits/main/CVE-2022-45636) main
## Breadcrumbs

1. [megafeis-palm](/WithSecureLabs/megafeis-palm/tree/main)
/
# CVE-2022-45636

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/WithSecureLabs/megafeis-palm/tree/main) | | |
| [CVE-2022-45636\_PoC.py](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45636/CVE-2022-45636_PoC.py "CVE-2022-45636_PoC.py") | | [CVE-2022-45636\_PoC.py](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45636/CVE-2022-45636_PoC.py "CVE-2022-45636_PoC.py") |  |  |
| [README.md](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45636/README.md "README.md") | | [README.md](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45636/README.md "README.md") |  |  |
| [requirements.txt](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45636/requirements.txt "requirements.txt") | | [requirements.txt](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45636/requirements.txt "requirements.txt") |  |  |
| View all files | | |

## [README.md](#readme)

# CVE-2022-45636: Insecure Authorization Scheme for API Requests in DBD+ Mobile Companion Application for Megafeis Smart Locks

## The Issue

While analyzing the back-end HTTP requests made by the mobile app to the central lock-management API, I noticed that the server was validating requests solely with the value of a custom HTTP header called `SecSignDest`. The included `connect.sid` cookie and the `token` header, although being verified for authentication, were not being checked to confirm that the user the token or cookie belonged to, was actually authorized to perform the action being requested.

Furthermore, decompiling the android application and reverse engineering the generation of the `SecSignDest` HTTP header led to the discovery that its value was simply an MD5 hash derived from a fingerprint string, a custom date string, a portion of the HTTP request data, and the API endpoint to which the data was being sent. This meant that anyone who could create these signing keys, could forge requests to the API, and since there were no authorization checks in place, perform arbitrary actions on other users' accounts.

Additionally, all the data needed to construct the signing key for the `SecSignDest` HTTP header was readily available in the application source code (for the fixed portions) and the HTTP request being sent (for the dynamic portions).

To demonstrate an attacker's ability to perform arbitrary actions on other users' accounts and locks, I have developed a PoC which disconnects a MEGAFEIS smart lock from its legitimate owner, transfers it to the account of a malicious 3rd party, and offers the option to return it to the original account after the lock has been opened. This is achieved solely with the bluetooth MAC address (bd\_addr) of the smart lock (which is trivial to discover) and the credentials to a malicious account which can be created easily.

## Proof-of-Concept

### Pre-Requisites

* Target lock's bluetooth MAC address (bd\_addr)
* Installed DBD+ application
* Valid DBD+ account
* CVE-2022-45636\_PoC.py - `git clone https://github.com/WithSecureLabs/megafeis-palm.git`
* Script dependencies - `pip3 install -r requirements.txt`

### Usage

```
python3 CVE-2022-45636_PoC.py <bd_addr> <attacker_email/phone>

```

Example: `python3 CVE-2022-45636_PoC.py 7F:06:07:03:0E:CF test@test.com`

### Demo

#### Step 1: Find a MEGAFEIS Smart Lock

To find a target lock, open the DBD+ app and tap the "Add" button. Once a lock advertising its model number is found, record its bluetooth MAC address as it will be needed later on.

[![DBD+ App Main Screen](/WithSecureLabs/megafeis-palm/raw/main/screenshots/dbd_app_main_screen.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/dbd_app_main_screen.png)[![DBD+ App Discovery Screen](/WithSecureLabs/megafeis-palm/raw/main/screenshots/dbd_app_discovery_screen.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/dbd_app_discovery_screen.png)

#### Step 2: Perform Lock Takeover

By this stage, you should have installed and created an account on the DBD+ application. Once you have both the lock's MAC address and your account ready, run the script with the correct arguments.

The attack scenario below shows a MEGAFEIS lock bound to a legitimate user's account (dayihed329@chimpad.com). Also shown is an attacker account (diyoveh601@5k2u.com) ready to steal it.

[![DBD+ App Attacker Screen](/WithSecureLabs/megafeis-palm/raw/main/screenshots/dbd_app_attacker_account.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/dbd_app_attacker_account.png)[![DBD+ App Victim Screen](/WithSecureLabs/megafeis-palm/raw/main/screenshots/victim_app_lock_screen.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/victim_app_lock_screen.png)

Once the script is downloaded and the dependencies installed, execute it as shown below.

[![Lock Takeover PoC Execution](/WithSecureLabs/megafeis-palm/raw/main/screenshots/poc1_execution.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/poc1_execution.png)

Once the lock takeover is complete, you should be able to log in to the attacker account and unlock the smart lock. You may also return it to the original owner to avoid suspicion once you have accomplished your objective (for which I bear no responsibility).

[![Attacker Takeover](/WithSecureLabs/megafeis-palm/raw/main/screenshots/attacker_takeover.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/attacker_takeover.png)[![Victim Loss](/WithSecureLabs/megafeis-palm/raw/main/screenshots/victim_loss.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/victim_loss.png)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

