=== Content from www.mozilla.org_b4b9e225_20250111_091133.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-08

## Security Vulnerabilities fixed in Firefox for iOS 123

Announced
February 19, 2024
Impact
moderate
Products
Firefox for iOS
Fixed in

* Firefox for iOS 123

#### [#CVE-2024-26283: Address bar spoofing using Firefox custom open URL scheme](#CVE-2024-26283)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

An attacker could have executed unauthorized scripts on top origin sites using a JavaScript URI when opening an external URL with a custom Firefox scheme.

##### References

* [Bug 1850158](https://bugzilla.mozilla.org/show_bug.cgi?id=1850158)

#### [#CVE-2024-26282: UXSS through a canonical element](#CVE-2024-26282)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

Using an AMP url with a canonical element, an attacker could have executed JavaScript from an opened bookmarked page.

##### References

* [Bug 1863788](https://bugzilla.mozilla.org/show_bug.cgi?id=1863788)

#### [#CVE-2024-26281: QR code scanner allowed executing a JavaScript URI](#CVE-2024-26281)

Reporter
James Lee
Impact
moderate
##### Description

Upon scanning a JavaScript URI with the QR code scanner, an attacker could have executed unauthorized scripts on the current top origin sites in the URL bar.

##### References

* [Bug 1868005](https://bugzilla.mozilla.org/show_bug.cgi?id=1868005)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_79f07dfa_20250111_091132.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1868005)
* [XML](/show_bug.cgi?ctype=xml&id=1868005)

Closed
[Bug 1868005](/show_bug.cgi?id=1868005)
(CVE-2024-26281)

Opened 1 year ago
Closed 1 year ago

# iOS Firefox QR Code Scanner allows to run firefox URI with javascript URI for related exploit

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

iOS Firefox QR Code Scanner allows to run firefox URI with javascript URI for related exploit

## Categories

### (Firefox for iOS :: General, defect)

[Product:](/describecomponents.cgi?product=Firefox%20for%20iOS)

Firefox for iOS
▾

Firefox for iOS
Firefox for iOS is the Firefox mobile experience developed for the iOS platform.
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20iOS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20iOS)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20iOS&component=General#General)

General
▾

Firefox for iOS :: General
For bugs that don't fit into other components.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20iOS&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| fxios | [123](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=123) | --- |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | 123 |  |

## People

### (Reporter: proof131072, Assigned: lmarceau)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/7fb2b1922d97306f98551a6d1db2768a?d=mm&size=40)  [lmarceau](/user_profile?user_id=694570)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/302893eb3990c528336f2ee08964bfa5?d=mm&size=40)  [proof131072](/user_profile?user_id=619332)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2024-26283](/show_bug.cgi?id=1850158 "VERIFIED FIXED - Address bar spoofing using firefox://open-url in Firefox iOS")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning")

Dependency [tree](/showdependencytree.cgi?id=1868005&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1868005)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2024-26283](/show_bug.cgi?id=1850158 "VERIFIED FIXED - Address bar spoofing using firefox://open-url in Firefox iOS"), [1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning"), [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

[github.com/mozilla-mobile/firefox-ios...](https://github.com/mozilla-mobile/firefox-ios/pull/17832 "https://github.com/mozilla-mobile/firefox-ios/pull/17832")

[mozilla-hub.atlassian.net/browse/FXIO...](https://mozilla-hub.atlassian.net/browse/FXIOS-7993 "https://mozilla-hub.atlassian.net/browse/FXIOS-7993")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-26281

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c25 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [QRCode\_Firefox\_URI.png](/attachment.cgi?id=9366704)  [1 year ago](#c0)  [James Lee](/user_profile?user_id=619332)   691 bytes, image/png |  | [Details](/attachment.cgi?id=9366704&action=edit) |
| --- | --- | --- |
| [GitHub Pull Request](/attachment.cgi?id=9369701)  [1 year ago](#c10)  [lmarceau](/user_profile?user_id=694570)   56 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=9369701&action=edit) | [Review](/attachment.cgi?id=9369701) |
| [QR code result, no javascript ran](/attachment.cgi?id=9369712)  [1 year ago](#c12)  [lmarceau](/user_profile?user_id=694570)   141.88 KB, image/png |  | [Details](/attachment.cgi?id=9369712&action=edit) |
| [qrcode (4).png](/attachment.cgi?id=9370228)  [1 year ago](#c17)  [James Lee](/user_profile?user_id=619332)   691 bytes, image/png |  | [Details](/attachment.cgi?id=9370228&action=edit) |
| [advisory.txt](/attachment.cgi?id=9381064)  [11 months ago](#c26)  [lmarceau](/user_profile?user_id=694570)   219 bytes, text/plain |  | [Details](/attachment.cgi?id=9381064&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1868005#c0)• 1 year ago |
|  | |

Attached image
[QRCode\_Firefox\_URI.png](attachment.cgi?id=9366704)
— [Details](attachment.cgi?id=9366704&action=edit)

We are able to run javascript URI through QR Code Scanner for iOS Firefox with Firefox URI.

Please scan following QR Code with iOS Firefox to reproduce this issue.

Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a99089_406194)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Firefox for iOS

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1868005#c1)• 1 year ago |
|  | |

The qr code contains `firefox://open-url?url=javascript:window.close();alert(1337)`

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1868005#c2)• 1 year ago |
|  | |

We had some similar issues reported years ago in Firefox for iOS, in [bug 1567118](/show_bug.cgi?id=1567118 "RESOLVED FIXED - Improper parsing of QR codes in address bar leads to XSS"), which was supposedly fixed by removing redirects using javascript URLs, in [bug 1588928](/show_bug.cgi?id=1588928 "RESOLVED FIXED - Semi-Universal XSS by redirecting to javascript: links"). I'm not sure if this is a regression or a slightly different attack.

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1868005#c3)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1868005&comment_id=16701171 "1 revision") |
|  | |

The cause for this is the same as [1850158](https://bugzilla.mozilla.org/show_bug.cgi?id=1850158), although symptoms are a bit different. The deep links are using a different code path than if you write down a URL in the URL bar specifically. This code path needs to be protected as well.

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a364184_694570)• 1 year ago |

See Also: → [CVE-2024-26283](/show_bug.cgi?id=1850158 "VERIFIED FIXED - Address bar spoofing using firefox://open-url in Firefox iOS")

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1868005#c4)• 1 year ago |
|  | |

I presumed running javascript URI with firefox URI could be duplicate <https://bugzilla.mozilla.org/show_bug.cgi?id=1863831#c3>

this is about closing window resulting javascript dialog injection on normal mode legitimate site and read mode.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1868005#c5)• 1 year ago |
|  | |

QR Code scanning is used here to abuse that issue, where QR Code scanner should only allow http/https and deny other URIs; especially running something like javascript: URI should be prevented.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1868005#c6)• 1 year ago |
|  | |

(In reply to lmarceau from [comment #3](/show_bug.cgi?id=1868005#c3 "RESOLVED FIXED - iOS Firefox QR Code Scanner allows to run firefox URI with javascript URI for related exploit"))

> The cause for this is the same as [1850158](https://bugzilla.mozilla.org/show_bug.cgi?id=1850158), although symptoms are a bit different. The deep links are using a different code path than if you write down a URL in the URL bar specifically. This code path needs to be protected as well.

Why are we supporting arbitrary QR code schemes? An allow-list of http/https is safe. Any additional scheme needs to be justified. This is basically the same as URLs coming in from the OS or other apps.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1868005#c7)• 1 year ago |
|  | |

I don't have a phone to test and there's no movie (the one time in my life I wanted a movie of a bug POC). If this opens a new tab/window then it's not all that dangerous. If it opens on top of your most recent tab then it's a pretty bad XSS problem.

> The cause for this is the same as [bug 1850158](/show_bug.cgi?id=1850158 "VERIFIED FIXED - Address bar spoofing using firefox://open-url in Firefox iOS")

So that bug will fix this one (a dupe)? or they are different enough that an extra check will be needed?

Depends on: [CVE-2024-26283](/show_bug.cgi?id=1850158 "VERIFIED FIXED - Address bar spoofing using firefox://open-url in Firefox iOS")Flags: needinfo?(lmarceau)Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1868005#c8)• 1 year ago |
|  | |

We can keep this bug open to ensure this use case is fixed as well

Flags: needinfo?(lmarceau)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a1063206_406194)• 1 year ago |

See Also: → [1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a1073480_406194)• 1 year ago |

See Also: → [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a1073510_406194)• 1 year ago |

See Also: → [1870385](/show_bug.cgi?id=1870385 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a1073533_406194)• 1 year ago |

See Also: → [1870386](/show_bug.cgi?id=1870386 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a1073744_406194)• 1 year ago |

See Also: [1870386](/show_bug.cgi?id=1870386 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI") →

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a1073753_406194)• 1 year ago |

See Also: [1870385](/show_bug.cgi?id=1870385 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI") →

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a1412225_1689)• 1 year ago |

Blocks: [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1868005#c9)• 1 year ago |
|  | |

Ok so after investigating, this isn't using the same path as the deeplink as I had thoughts, but rather through a delegate pattern to navigate. There's some scheme checks done on that path already, but I will enforce it so it's only possible to navigate directly to http/https URLs from QR Codes. All other schemes will open a search text instead.

FYI This will be tracked with JIRA ticket <https://mozilla-hub.atlassian.net/browse/FXIOS-7993>

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1868005#c10)• 1 year ago |
|  | |

Attached file
[GitHub Pull Request](attachment.cgi?id=9369701)
— [Details](attachment.cgi?id=9369701&action=edit)

Assignee: nobody → lmarceau

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1868005#c11)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1868005&comment_id=16721298 "1 revision") |
|  | |

I am opening a bugfix for this, but javascript wasn't even running before from that QR code scan. The URL opened is `http://firefox//open-url?url=javascript:window.close();alert(1337)`, which results in an error page being shown as this can't be navigated. The `firefox://open-url?url=javascript:window.close();alert(1337)` is converted to that URL on the `URIFixUp.getURL` function in [here](https://github.com/mozilla-mobile/firefox-ios/blob/379470e960db8ae0193d939d00e3289b370602f7/firefox-ios/Client/Frontend/Browser/QRCodeViewController.swift#L345).

So unless I'm mistaken, I don't see any exploits (see screenshot). But this part of the code still benefit from hardening.

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1868005#c12)• 1 year ago |
|  | |

Attached image
[QR code result, no javascript ran](attachment.cgi?id=9369712)
— [Details](attachment.cgi?id=9369712&action=edit)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1868005#c13)• 1 year ago |
|  | |

To further explain why I don't see this as an exploit. The part to `javascript:window.close();alert(1337)` is never opened as a URL directly, and so we're not trying to open a javascript URL from QR code. Although `firefox://open-url?` is a deeplink scheme when opened from an external app, from our QR code scanner code, this isn't recognized as such. Hence, why when scanning the linked QR code to this Bugzilla, the URL we try to navigate to is `http://firefox//open-url?url=javascript:window.close();alert(1337)`. Firefox QR code doesn't recognize this format and try to navigate to it as `http` which is not a navigable URL, resulting in an error page.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a1511921_1689)• 1 year ago |

No longer blocks: [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1868005#c14)• 1 year ago |
|  | |

re-rating this one sec-other since the javascript doesn't seem to execute when run through the QR code path

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a1512254_1689)• 1 year ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-other](/buglist.cgi?keywords=sec-other&resolution=---)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1868005#c15)• 1 year ago |
|  | |

That's weird, scanning QR Code with firefox URI did work although it was 119 iirc, I'll get back to this and let you know.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1868005#c16)• 1 year ago |
|  | |

I forgot to encode the dot (%2e) so please try to reproduce it with below.

firefox://open-url?url=javascript:window%2eclose();alert(1337)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1868005#c17)• 1 year ago |
|  | |

Attached image
[qrcode (4).png](attachment.cgi?id=9370228)
— [Details](attachment.cgi?id=9370228&action=edit)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1868005#c18)• 1 year ago |
|  | |

<https://pwning.click/RPReplay_Final1703554936.mp4>

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1868005#c19)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1868005&comment_id=16736443 "1 revision") |
|  | |

Ok thank you! I tested with the new provided QR code and with the bugfix PR I linked this will be fixed, there was indeed a problem, I'll make sure our QA will test this flow to confirm the problem is resolved (the fix will be included in release v123, JIRA ticket to follow progress is [FXIOS-7993](https://mozilla-hub.atlassian.net/browse/FXIOS-7993)).

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3392990_694570)• 1 year ago |

Group: mobile-core-security → core-security-release

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3392998_694570)• 1 year ago |

Status: NEW → RESOLVEDClosed: 1 year agoResolution: --- → FIXED

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3393059_694570)• 1 year ago |

See Also: → <https://github.com/mozilla-mobile/firefox-ios/pull/17832>

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3393682_694570)• 1 year ago |

Duplicate of this bug: [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1868005#c21)• 1 year ago |
|  | |

This need to be sec-moderate since the PoC was confirmed.

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3393769_694570)• 1 year ago |

Duplicate of this bug: [1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning")

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1868005#c23)• 1 year ago |
|  | |

:dveditz will be able to determine the security severity rating of this issue, thank you.

Flags: needinfo?(dveditz)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3407600_694570)• 1 year ago |

No longer duplicate of this bug: [1870384](/show_bug.cgi?id=1870384 "RESOLVED DUPLICATE - firefox URI for iOS Firefox allows to load file URI")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3444324_1689)• 1 year ago |

See Also: → <https://mozilla-hub.atlassian.net/browse/FXIOS-7993>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3448122_1689)• 1 year ago |

Blocks: [1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3449488_1689)• 1 year ago |

No longer duplicate of this bug: [1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1868005#c24)• 1 year ago |
|  | |

restoring severity given a working testcase. This is indeed an independent problem from [bug 1850158](/show_bug.cgi?id=1850158 "VERIFIED FIXED - Address bar spoofing using firefox://open-url in Firefox iOS"). Of course if that `firefox:` deep-links fix had gone in first then this specific `javascript:` QR code POC wouldn't have been possible. But then [bug 1870308](/show_bug.cgi?id=1870308 "RESOLVED FIXED - iOS Firefox can open file: URLs through QR Code Scanning") would have pointed to the independent QR code reader bug instead of being a dupe of this one.

Flags: needinfo?(dveditz)Keywords: [sec-other](/buglist.cgi?keywords=sec-other&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1868005#c25)• 1 year ago |
|  | |

Although similar to [bug 1850158](/show_bug.cgi?id=1850158 "VERIFIED FIXED - Address bar spoofing using firefox://open-url in Firefox iOS"), this was the same flaw in a different chunk of code.

Flags: sec-bounty? → sec-bounty+

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a3833387_694570)• 1 year ago |

[tracking-fxios](/buglist.cgi?f1=cf_tracking_fxios&o1=isnotempty):
--- → [123](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=123)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a6424599_578488)• 11 months ago |

Alias: CVE-2024-26281

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1868005#c26)• 11 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9381064)
— [Details](attachment.cgi?id=9381064&action=edit)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a15492329_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1868005#a31561592_1689)• 1 month ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1868005&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [James Lee](/user_profile?user_id=619332)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


