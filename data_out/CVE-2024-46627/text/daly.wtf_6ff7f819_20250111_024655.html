

* [home](https://daly.wtf/)
* [whoami](https://daly.wtf/about/)

Menu

Article
# CVE-2024-46627 - Incorrect access control in BECN DATAGERRY v2.2 allows attackers to > execute arbitrary commands via crafted web requests.

#### [Daly](/author/daly/)

25 Sep 2024 • 2 min read

DATAGERRY v2.2 lacks access control in the REST API for the following endpoints:

- `/rest/users/<id>/settings/` (GET, POST)
- `/rest/users/<id>/settings/<setting>` (DELETE, PUT)

This allows an attacker to read settings, create settings, delete settings, and update settings of any user without authentication.

To reproduce this it's possible to use the docker setup [here](https://datagerry.readthedocs.io/en/latest/admin_guide/setup.html#setup-via-docker-image) (as of 25th Sept 2024):

**GET all settings objects for a user:**

![](https://daly.wtf/content/images/2024/09/Get_Configs.png)

**Get a specific settings object for a user:**

![](https://daly.wtf/content/images/2024/09/get_specific_config.png)

Note: If there are no objects created, it's possible to determine the format reading the documentation here: <https://datagerry.readthedocs.io/en/latest/api/rest/user-management.html#settings>

**Update a specific settings object for a user:**

![](https://daly.wtf/content/images/2024/09/update_existing_config-1.png)

**Create a new settings object for a user:**

![](https://daly.wtf/content/images/2024/09/Create_New_Config.png)

Despite it returning a 500 error, you can confirm this has been added by getting the list of settings objects again:

![](https://daly.wtf/content/images/2024/09/Create_Despite_500.png)

**Delete a settings object for a user:**

![](https://daly.wtf/content/images/2024/09/delete_config.png)

The potential is there to inject script as this is not filtered, as well as read, write, update, and delete objects for any user without any valid access.

The CVE I raised for this can be located [here](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-46627)

Share

[## Multiple Vulnerabilities Discovered in Automatic Systems Software

The below CVEs affect Automatic Systems Maintenance - SlimLane - 29565\_d74ecce0c1081d50546db573a499941b10799fb7.…

09 Oct 2024](/multiple-vulnerabilities-discovered-in-automatic-systems-software/)
[## Tales from the hunt: The Chatbot

During the test of a large scope target, I came across an…

23 Aug 2024](/tales-from-the-hunt-the-chatbot/)

Daly Whyte © 2025

* [Sign up](#/portal/)

Published with [Ghost](https://ghost.org) • Theme [Attila](https://github.com/zutrinken/attila) • System theme

