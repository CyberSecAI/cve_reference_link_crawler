From 235f1d8b400708556732b9dda788c919ebf3bb80 Mon Sep 17 00:00:00 2001
From: John Chilton <jmchilton@gmail.com>
Date: Tue, 30 Jul 2024 11:47:40 -0400
Subject: [PATCH] Do not allow import by uuid.

---
 lib/galaxy/model/store/__init__.py | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

diff --git a/lib/galaxy/model/store/__init__.py b/lib/galaxy/model/store/__init__.py
index 65e3f1182271..55c1eb3e47b0 100644
--- a/lib/galaxy/model/store/__init__.py
+++ b/lib/galaxy/model/store/__init__.py
@@ -450,10 +450,11 @@ def handle_dataset_object_edit(dataset_instance):
                 self._attach_raw_id_if_editing(dataset_instance, dataset_attrs)
 
                 # Older style...
-                if "uuid" in dataset_attrs:
-                    dataset_instance.dataset.uuid = dataset_attrs["uuid"]
-                if "dataset_uuid" in dataset_attrs:
-                    dataset_instance.dataset.uuid = dataset_attrs["dataset_uuid"]
+                if self.import_options.allow_edit:
+                    if "uuid" in dataset_attrs:
+                        dataset_instance.dataset.uuid = dataset_attrs["uuid"]
+                    if "dataset_uuid" in dataset_attrs:
+                        dataset_instance.dataset.uuid = dataset_attrs["dataset_uuid"]
 
                 self._session_add(dataset_instance)
 
