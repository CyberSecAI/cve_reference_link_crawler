<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Frequently Asked Questions | D(HE)at Attack</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Who is vulnerable? In theory, all protocols that use the Diffie-Hellman algorithm for key exchange are affected. In practice, there are differences between the particular cryptographic protocols and their implementations, making one more affected than others.
The proof-of-concept implementation of the attack supports the following protocols,
Transport Layer Security (TLS) OpenVPN Secure Shell (SSH) however, other protocols such as IPsec (IKEv1, IKEv2) must also be affected.
Is my server vulnerable? It depends on your server configuration.">
    <meta name="generator" content="Hugo 0.132.2">
    
    
    
    
      <meta name="robots" content="index, follow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.02014cf0330f494225ff2915ba061ea4b027ddc68e50450a660fe447d8489953.css" >



    
    
    
      

    

    
    
    <meta property="og:url" content="https://dheatattack.gitlab.io/faq/">
  <meta property="og:site_name" content="D(HE)at Attack">
  <meta property="og:title" content="Frequently Asked Questions">
  <meta property="og:description" content="Who is vulnerable? In theory, all protocols that use the Diffie-Hellman algorithm for key exchange are affected. In practice, there are differences between the particular cryptographic protocols and their implementations, making one more affected than others.
The proof-of-concept implementation of the attack supports the following protocols,
Transport Layer Security (TLS) OpenVPN Secure Shell (SSH) however, other protocols such as IPsec (IKEv1, IKEv2) must also be affected.
Is my server vulnerable? It depends on your server configuration.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">

  <meta itemprop="name" content="Frequently Asked Questions">
  <meta itemprop="description" content="Who is vulnerable? In theory, all protocols that use the Diffie-Hellman algorithm for key exchange are affected. In practice, there are differences between the particular cryptographic protocols and their implementations, making one more affected than others.
The proof-of-concept implementation of the attack supports the following protocols,
Transport Layer Security (TLS) OpenVPN Secure Shell (SSH) however, other protocols such as IPsec (IKEv1, IKEv2) must also be affected.
Is my server vulnerable? It depends on your server configuration.">
  <meta itemprop="wordCount" content="762">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Frequently Asked Questions">
  <meta name="twitter:description" content="Who is vulnerable? In theory, all protocols that use the Diffie-Hellman algorithm for key exchange are affected. In practice, there are differences between the particular cryptographic protocols and their implementations, making one more affected than others.
The proof-of-concept implementation of the attack supports the following protocols,
Transport Layer Security (TLS) OpenVPN Secure Shell (SSH) however, other protocols such as IPsec (IKEv1, IKEv2) must also be affected.
Is my server vulnerable? It depends on your server configuration.">

      
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-X0M3S8V4CJ"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-X0M3S8V4CJ');
        }
      </script>
    
  


    
	
   <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
 <script>
           MathJax = {
                       tex: {
                                     displayMath: [['\\[', '\\]'], ['$$', '$$']],  
                                     inlineMath: [['\\(', '\\)']]                  
                                   }
                     };
 </script>



  </head>

  <body class="ma0 avenir bg-near-white production">

    

  <header>
    <div class="bg-near-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        D(HE)at Attack
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/summary/" title="Summary page">
              Summary
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/faq/" title="FAQ page">
              FAQ
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/mitigations/" title="Mitigations page">
              Mitigations
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/dheater/" title="PoC Code page">
              PoC Code
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/details/" title="Details page">
              Details
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/references/" title="References page">
              References
            </a>
          </li>
          
        </ul>
      
      
<div class="ananke-socials">
  
    
    <a href="https://gitlab.com/dheatattack" target="_blank" rel="noopener" class="gitlab ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitLab link" aria-label="follow on GitLab——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="M29.782 199.732L256 493.714 8.074 309.699c-6.856-5.142-9.712-13.996-7.141-21.993l28.849-87.974zm75.405-174.806c-3.142-8.854-15.709-8.854-18.851 0L29.782 199.732h131.961L105.187 24.926zm56.556 174.806L256 493.714l94.257-293.982H161.743zm349.324 87.974l-28.849-87.974L256 493.714l247.926-184.015c6.855-5.142 9.711-13.996 7.141-21.993zm-85.404-262.78c-3.142-8.854-15.709-8.854-18.851 0l-56.555 174.806h131.961L425.663 24.926z"></path></svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>


    <main class="pb7" role="main">
      
  <div class="flex-l mt2 mw8 center">
    <article class="center cf pv5 ph3 ph4-ns mw7">
      <header>
        <h1 class="f1">
          Frequently Asked Questions
        </h1>
      </header>
      <div class="nested-copy-line-height lh-copy f4 nested-links mid-gray">
        <h3 id="who-is-vulnerable">Who is vulnerable?</h3>
<p>In theory, all protocols that use the Diffie-Hellman algorithm for key exchange are affected. In practice, there are
differences between the particular cryptographic protocols and their implementations, making one more affected than
others.</p>
<p>The <a href="/dheater/">proof-of-concept implementation</a> of the attack supports the following protocols,</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer Security</a> (TLS)</li>
<li><a href="https://en.wikipedia.org/wiki/OpenVPN">OpenVPN</a></li>
<li><a href="https://hu.wikipedia.org/wiki/Secure_Shell">Secure Shell</a> (SSH)</li>
</ul>
<p>however, other protocols such as <a href="https://en.wikipedia.org/wiki/IPsec">IPsec</a> (IKEv1, IKEv2) must also be affected.</p>
<h3 id="is-my-server-vulnerable">Is my server vulnerable?</h3>
<p>It depends on your server configuration. If your server offers the Diffie-Hellman key exchange, then you are affected.
However, the effectiveness of a potential attack largely depends on the specifics of the cryptographic protocol, the
library implementation, and the key size used during the key exchange. You can use either some free software
(e.g., <a href="https://cryptolyzer.readthedocs.io/">CryptoLyzer</a>, <a href="https://github.com/nabla-c0d3/sslyze">SSLyze</a>,
<a href="https://github.com/jtesta/ssh-audit">ssh-audit</a>, <a href="https://testssl.sh/">testssl.sh</a>), and some SaaS solutions (e.g.,
<a href="https://scanigma.com/">Scanigma</a>) as well to check whether your server offers Diffie-Hellman key exchange and if so,
under what parameters.</p>
<h3 id="how-practical-is-the-attack">How practical is the attack?</h3>
<p>It depends on hardware capabilities and the server configuration. If your server offers Diffie-Hellman key exchange
with larger key sizes and the cryptographic library you use affected by the &ldquo;long exponent&rdquo; issue only an attacker
need to send extremely low amount of request to cause 100% CPU load on the server. For the exact number of requests
needed to overload a server see the <a href="https://ieeexplore.ieee.org/document/10374117#sec5">attack scenario</a> section of
the full technical paper about the attack. For testing <em>your</em> server you can use the proof-of-concept implementation
<a href="/dheater/">D(HE)ater</a>.</p>
<h3 id="can-i-detect-if-someone-has-exploited-this-against-me">Can I detect if someone has exploited this against me?</h3>
<p>Yes, you can, though it may require some configuration changes. An application server can log instances where a client
connection is interrupted during cryptographic handshakes. While this can happen under normal circumstances, it is also
indicative of suspicious behavior. A high number of log messages about connections being lost during the handshake phase
likely suggests an attack. For more details see <a href="/mitigations/#fail2ban">mitigations</a> page.</p>
<h3 id="should-i-disable-diffie-hellman-in-my-server-configurations">Should I disable Diffie-Hellman in my server configurations?</h3>
<p>Not necessarily. However, you need to check both server configuration and cryptographic library implementation details.
The former is the simpler as the mentioned free software can be used the check whether your server configuration
enables the Diffie-Hellman key exchange or not and if so what key sizes are offered. The latter is harder is as there is
no obvious way to check the performance of the Diffie-Hellman implementation and used exponent sizes in the case of a
cryptographic library. For the details of the most popular libraries of this point of view see the <a href="https://ieeexplore.ieee.org/document/10374117#sec4">analysis</a> section of the full technical paper about the attack.</p>
<h3 id="why-is-the-attack-called-dheat">Why is the attack called &ldquo;D(HE)at&rdquo;?</h3>
<p>The attack is named for its ability to overheat the CPU by making the victim execute the CPU-intensive operation
of [modular exponentiation used in the Diffie-Hellman key exchange within various cryptographic protocols (e.g., TLS,
SSH, IPsec, OpenVPN, etc.).</p>
<h3 id="is-this-vulnerability-serious-enough-to-deserve-a-web-page">Is this vulnerability serious enough to deserve a web page?</h3>
<p>D(HE)at is not an issue with a client, server implementations, or a cryptographic library flaw, so it cannot be fixed
by simply installing a software update. Instead, it exploits the Diffie-Hellman key agreement protocol, meaning that it
may affect many the cryptographic protocols (e.g., TLS, SSH, OpenVPN, IKEv1/IKEv2, &hellip;) use the ephemeral version of
the Diffie-Hellman for exchanging keys.  Therefore, a comprehensive solution to this vulnerability would require
modifying the cryptographic protocols that use DHE key agreement, as well as the client/server or library
implementations.</p>
<h3 id="are-there-implementations-more-vulnerable-than-others">Are there implementations more vulnerable than others?</h3>
<p>Yes, some implementation flaws can seriously affect the effectiveness of the D(HE)at attack.</p>
<h4 id="long-exponent-cve-2022-40735">Long exponent (CVE-2022-40735)</h4>
<p>Implementations may use unnecessarily <a href="https://ieeexplore.ieee.org/document/10374117sec3f">long exponents</a> (
<a href="https://nvd.nist.gov/vuln/detail/CVE-2022-40735">CVE-2022-40735</a>) which makes the modular exponentiation &ndash; the
CPU-intensive operation of the Diffie-Hellman key exchange &ndash; significantly more expensive than it should be.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Library</th>
<th style="text-align:center">Affected Versions</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">OpenSSL (1.x)</td>
<td style="text-align:center">\(\le 1.1.1\)</td>
</tr>
<tr>
<td style="text-align:left">OpenSSL (3.x)</td>
<td style="text-align:center">\(\le 3.0.5\)</td>
</tr>
<tr>
<td style="text-align:left">Mbed TLS</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:left">OpenJDK</td>
<td style="text-align:center">\(\le 17.0.5\)</td>
</tr>
<tr>
<td style="text-align:left">Oracle JDK</td>
<td style="text-align:center">\(\le 17.0.5\)</td>
</tr>
</tbody>
</table>
<h4 id="unnecessary-validation-cve-2024-41996">Unnecessary validation (CVE-2024-41996)</h4>
<p>Implementations may perform public key validation against <a href="https://en.wikipedia.org/wiki/Small_subgroup_confinement_attack">small subgroup confinement attack</a> unnecessarily (<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-41996">CVE-2024-41996</a>), where the validation is as expensive as public key generation using
large exponents.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Library</th>
<th style="text-align:center">Affected Versions</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">OpenSSL (1.x)</td>
<td style="text-align:center">n/a\(^*\)</td>
</tr>
<tr>
<td style="text-align:left">OpenSSL (3.x)</td>
<td style="text-align:center">\(\ge 3.0\)</td>
</tr>
</tbody>
</table>
<p>* no public key validation</p>
<h4 id="large-key-size-by-default">Large key size by default</h4>
<p>The flaws mentioned earlier are coupled with large key sizes enabled by default makes the application uses the library
particularly vulnerable to the D(HE)at attack in the absence of mitigation techniques.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Library</th>
<th style="text-align:center">Key Size</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">OpenSSL (1.x)</td>
<td style="text-align:center">n/a\(^*\)</td>
</tr>
<tr>
<td style="text-align:left">OpenSSL (3.x)</td>
<td style="text-align:center">8192</td>
</tr>
<tr>
<td style="text-align:left">OpenJDK</td>
<td style="text-align:center">8192</td>
</tr>
<tr>
<td style="text-align:left">Oracle JDK</td>
<td style="text-align:center">8192</td>
</tr>
</tbody>
</table>
<p>* no finite field Diffie-Hellman parameter negotiation support</p>
<h3 id="how-can-i-contact-you">How can I contact you?</h3>
<p>You can reach us via Twitter, or LinkedIn:</p>
<ul>
<li>Szilárd Pfeiffer: <a href="https://x.com/pfeifferszilard">Twitter</a> (X),
<a href="https://www.linkedin.com/in/pfeifferszilard/">LinkedIn</a></li>
<li>Norbert Tihanyi: <a href="https://www.linkedin.com/in/norberttihanyi/">LinkedIn</a></li>
</ul>

      </div>
    </article>
  </div>

    </main>
    <footer class="bg-near-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://dheatattack.gitlab.io/" >
    &copy;  Szilárd Pfeiffer, 2024 
  </a>
    <div>
<div class="ananke-socials">
  
    
    <a href="https://gitlab.com/dheatattack" target="_blank" rel="noopener" class="gitlab ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitLab link" aria-label="follow on GitLab——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="M29.782 199.732L256 493.714 8.074 309.699c-6.856-5.142-9.712-13.996-7.141-21.993l28.849-87.974zm75.405-174.806c-3.142-8.854-15.709-8.854-18.851 0L29.782 199.732h131.961L105.187 24.926zm56.556 174.806L256 493.714l94.257-293.982H161.743zm349.324 87.974l-28.849-87.974L256 493.714l247.926-184.015c6.855-5.142 9.711-13.996 7.141-21.993zm-85.404-262.78c-3.142-8.854-15.709-8.854-18.851 0l-56.555 174.806h131.961L425.663 24.926z"></path></svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
