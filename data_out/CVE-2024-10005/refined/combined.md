=== Content from discuss.hashicorp.com_29c28c76_20250110_183322.html ===


[HashiCorp Discuss](/)

# [HCSEC-2024-22 - Consul L7 Intentions Vulnerable To URL Path Bypass](/t/hcsec-2024-22-consul-l7-intentions-vulnerable-to-url-path-bypass/71035)

[Security](/c/security/52)

[security-consul](https://discuss.hashicorp.com/tag/security-consul)

[dduzgun-security](https://discuss.hashicorp.com/u/dduzgun-security)

October 30, 2024, 9:11pm

1

**Bulletin ID:** HCSEC-2024-22

**Affected Products / Versions:**

Consul Community Edition from 1.9.0 up to 1.20.0, fixed in 1.20.1.

Consul Enterprise from 1.9.0 up to 1.20.0, 1.19.2, 1.18.4, 1.15.14, fixed in 1.20.1, 1.19.3, 1.18.5, and 1.15.15.

**Publication Date:** October 30, 2024

**Summary**

A vulnerability was identified in Consul and Consul Enterprise (“Consul”) such that using URL paths in L7 traffic intentions could bypass HTTP request path-based access rules. This vulnerability, identified as CVE-2024-10005, is fixed in Consul Community Edition 1.20.1 and Consul Enterprise 1.20.1, 1.19.3, 1.18.5, and 1.15.15.

**Background**

[Intentions](https://developer.hashicorp.com/consul/docs/connect/intentions) control traffic communication between services at the network layer, also called L4 traffic, or the application layer, also called L7 traffic. For destination services using an HTTP-based protocol, the [L7 traffic intentions](https://developer.hashicorp.com/consul/docs/connect/intentions#l7-traffic-intentions) can enforce access based on application-aware request attributes to control traffic between services based on [service intention configuration](https://developer.hashicorp.com/consul/docs/connect/config-entries/service-intentions).

Paths are part of [HTTP permissions](https://developer.hashicorp.com/consul/docs/connect/config-entries/service-intentions#sources-permissions-http) configurable in the L7 intentions to control traffic based on matching one or more provided values.

**Details**

Consul allows administrators to implement application-aware controls called L7 intentions to configure deny- and allow-list based rules. Due to a lack of path normalization, a vulnerability was identified where URL-encoded paths and/or multiple slashes could be exploited to bypass permissions defined in the intentions.

**Remediation**

Customers using application aware (L7) intentions should evaluate the risk associated with this issue and consider upgrading to Consul 1.20.1, 1.19.3, 1.18.5, 1.15.15, or newer and updating [request normalization configuration](https://developer.hashicorp.com/consul/docs/connect/config-entries/mesh#request-normalization) based on their specific requirements.

All versions of Consul released going forward, including the fix versions noted above, will have basic path normalization enabled by default.

See Consul’s [Security](https://developer.hashicorp.com/consul/docs/connect/security#request-normalization-configured-for-l7-intentions) and [Upgrading](https://developer.hashicorp.com/consul/docs/upgrading) documentation for general guidance on this process.

**Acknowledgement**

This issue was identified by HashiCorp‘s external security assessment partner and Consul engineering teams.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-23 - Consul L7 Intentions Vulnerable To Headers Bypass](https://discuss.hashicorp.com/t/hcsec-2024-23-consul-l7-intentions-vulnerable-to-headers-bypass/71036)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 760 | October 30, 2024 |
| [HCSEC-2021-16 - Consul’s Application-Aware Intentions Deny Action Fails Open When Combined With Default Deny Policy](https://discuss.hashicorp.com/t/hcsec-2021-16-consul-s-application-aware-intentions-deny-action-fails-open-when-combined-with-default-deny-policy/26855)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 8247 | July 15, 2021 |
| [HCSEC-2022-20 - Consul Service Mesh Intention Bypass with Malicious Certificate Signing Request](https://discuss.hashicorp.com/t/hcsec-2022-20-consul-service-mesh-intention-bypass-with-malicious-certificate-signing-request/44628)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7605 | September 21, 2022 |
| [HCSEC-2021-17 - Consul’s Envoy TLS Configuration Did Not Validate Destination Service Subject Alternative Names](https://discuss.hashicorp.com/t/hcsec-2021-17-consul-s-envoy-tls-configuration-did-not-validate-destination-service-subject-alternative-names/26856)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7739 | July 15, 2021 |
| [HCSEC-2021-08 - Consul Enterprise Audit Log Bypass for HTTP Events](https://discuss.hashicorp.com/t/hcsec-2021-08-consul-enterprise-audit-log-bypass-for-http-events/23369)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7569 | April 19, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


