(cid:1721)(cid:6522)

  (cid:1806)(cid:2841)(cid:1721)(cid:1157)(cid:2605)(cid:6535)(cid:6950)(cid:1246)(cid:3962)(cid:6959)(cid:2426)(cid:1380)(cid:5041)(cid:1157)(cid:7054)(cid:3576)(cid:1522)(cid:3118)(cid:4979)(cid:1912)(cid:1891)(cid:3661)(cid:1976)(cid:1381)(cid:3223)(cid:6408)(cid:4913)(cid:1745)(cid:5766)(cid:4457)(cid:1157)(cid:2666)(cid:4108)(cid:1609)(cid:4147)rce(cid:1157)(cid:2605)(cid:6535)(cid:1319)(cid:1246)(cid:1334)(cid:1702)(cid:4913)(cid:4060)(cid:4175)(cid:822)

(cid:6959)(cid:3962)hookdd(cid:4108)(cid:1322)(cid:1157)(cid:6612)(cid:2605)(cid:6535)(cid:1319)(cid:1246)(cid:1275)rce(cid:1157)(cid:6612)(cid:1246)(cid:6776)(cid:4961)(cid:4961)(cid:1157)(cid:3205)(cid:1382)(cid:6959)(cid:3962)(cid:2666)(cid:1885)(cid:4961)rce(cid:1157)(cid:3659)(cid:1912)(cid:2666)(cid:3661)(cid:1275)(cid:1382)(cid:1253)(cid:1662)(cid:1275)(cid:4175)(cid:822)(cid:3676)(cid:3962)(cid:1461)(cid:4768)(cid:4913)
3.9.8(cid:4551)(cid:3676)(cid:1157)(cid:1429)(cid:3598)(cid:1695)(cid:1695)(cid:3653)(cid:3547)(cid:1319)3.9.9(cid:1157)(cid:1255)(cid:6950)(cid:4961)(cid:3400)(cid:6975)(cid:1157)(cid:2842)(cid:4108)(cid:3661)(cid:1509)(cid:2388)(cid:1246)(cid:1253)(cid:1662)(cid:1275)(cid:4457)(cid:1157)(cid:2859)(cid:6598)(cid:7095)(cid:1890)(cid:1382)(cid:1461)(cid:4768)(cid:822)

0x01 zip(cid:5844)(cid:6516)(cid:1844)

com.cym.controller.adminPage.MainController#upload

(cid:1745)(cid:5766)(cid:4018)(cid:6910)(cid:5324)(cid:1812)(cid:1157)(cid:1890)(cid:1382)(cid:4961)(cid:6496)(cid:3241)tmpdir+'/'+(cid:3528)(cid:1391)(cid:1911)(cid:3306)(cid:3379)(cid:1157)(cid:4496)(cid:1912)(cid:1499)(cid:2562)(cid:6960)(cid:1860)(cid:1157)(cid:4108)(cid:3661)(cid:7476)(cid:1707)(cid:1912)(cid:5527)(cid:1157)(cid:1612)(cid:2603)(cid:7476)(cid:1707)(cid:1255)(cid:7476)(cid:1707)(cid:7095)(cid:5766)r(cid:3367)(cid:822)

(cid:1612)(cid:1278)FileUtil.getTmpDir()(cid:1407)(cid:6068)(cid:1872)(cid:5422)(cid:5497)(cid:4913)(cid:1281)(cid:3576)(cid:4947)(cid:2927)(cid:1157)mac(cid:5422)(cid:5497)(cid:1285)

ubuntu(cid:5422)(cid:5497)(cid:4913)(cid:1281)(cid:3576)(cid:4947)(cid:2927)(cid:1285)/tmp(cid:822)

(cid:2642)(cid:2859)(cid:4913)(cid:1721)(cid:5266)(cid:1745)(cid:5766)(cid:4457)

(cid:1721)(cid:5266)(cid:6959)(cid:7166)(cid:3598)(cid:7476)(cid:1707)(cid:1319)zip(cid:1252)(cid:1411)(cid:1157)(cid:1429)(cid:3598)(cid:3183)(cid:1386)(cid:4961)(cid:1912)(cid:5266)(cid:3598)(cid:4108)(cid:3661)(cid:1699)(cid:3545)(cid:4913)(cid:1157)(cid:4951)(cid:3379)(cid:1407)(cid:3241)(cid:1252)(cid:1411)(cid:4913)(cid:3528)(cid:1391)(cid:3505)(cid:1705)(cid:1281)(cid:3576)(cid:4947)(cid:2927)(cid:822)

(cid:2926)(cid:3183)(cid:1386)(cid:6988)(cid:3296)(cid:2437)(cid:4947)(cid:2927)(cid:3576)(cid:1157)(cid:1372)(cid:1407)(cid:6627)(cid:4768)

com.cym.controller.adminPage.WwwController#addOver(cid:6960)(cid:6408)(cid:2386)(cid:4696)

(cid:1890)(cid:1382)(cid:4961)(cid:1705)(cid:1157)(cid:3183)(cid:1386)(cid:5766)(cid:3380)(cid:1707)(cid:6516)(cid:1844)(cid:4947)(cid:2927)(cid:1157)(cid:1382)(cid:1866)(cid:7537)(cid:6493)(cid:6516)(cid:1844)(cid:4913)(cid:3528)(cid:1391)(cid:1157)(cid:3659)(cid:1912)(cid:6627)(cid:4768)zip(cid:6960)(cid:6408)(cid:6516)(cid:1844)(cid:822)

(cid:7054)(cid:1293)(cid:1612)(cid:2603)(cid:2953)(cid:5324)(cid:1812)(cid:1319)(cid:1157)TmpDir()(cid:3183)(cid:1386)(cid:5027)(cid:7026)(cid:1157)(cid:3528)(cid:1391)(cid:1911)(cid:5027)(cid:7026)(cid:1157)(cid:3183)(cid:1386)(cid:1885)(cid:7537)(cid:6493)(cid:1252)(cid:1411)(cid:1246)(cid:1275)ssh(cid:2626)(cid:7212)(cid:1705).ssh(cid:4947)(cid:2927)(cid:1253)(cid:2666)(cid:1890)(cid:1382)(cid:1319)(cid:822)

(cid:2388)(cid:4671)

(cid:1590)(cid:6988)(cid:3296)(cid:6493)(cid:1252)(cid:1411)(cid:4913)zip(cid:3528)(cid:1391)

(cid:1890)(cid:1382)(cid:4961)(cid:1705)(cid:1382)(cid:1866)(cid:1252)(cid:1411)(cid:1705)tmp(cid:4947)(cid:2927)(cid:1157)(cid:6959)(cid:3598)macos(cid:4913)(cid:1157)ubutu(cid:2241)/tmp(cid:1253)

(cid:6988)(cid:3296)(cid:2437)ssh(cid:4947)(cid:2927)(cid:822)

(cid:2642)(cid:2859)(cid:3524)(cid:3357)(cid:1777)(cid:822)

(cid:3659)(cid:1912)(cid:4951)(cid:3379)(cid:6627)(cid:4768)zip(cid:6516)(cid:1844)(cid:1705)ssh(cid:4947)(cid:2927)

(cid:3182)(cid:1745)(cid:6516)(cid:1844)(cid:1705)ssh

(cid:3659)(cid:1912)(cid:1310)(cid:3598)(cid:1461)(cid:4768)(cid:1604)(cid:7212)(cid:4951)(cid:3379)(cid:4909)(cid:2927)

0x02 zip(cid:4947)(cid:2927)(cid:5231)(cid:6780)

(cid:1252)(cid:7566)(cid:7054)(cid:5183)(cid:3548)(cid:4137)(cid:1157)(cid:1612)(cid:2603)(cid:1885)(cid:5766)(cid:3217)(cid:1246)(cid:3962)(cid:1157)(cid:2217)(cid:1285)(cid:2241)zip(cid:6516)(cid:1844)(cid:4913)(cid:3576)(cid:1522)(cid:1407)(cid:2241)(cid:3524)(cid:3357)(cid:2858)(cid:3761)(cid:6595)(cid:1157)(cid:7212)(cid:1786)(cid:2794)(cid:5482)(cid:1910)(cid:4947)(cid:2927)(cid:5231)(cid:6950)(cid:1157)(cid:1407)(cid:3250)(cid:1674)(cid:2897)(cid:2825)(cid:822)

com.cym.controller.adminPage.WwwController#addOver

(cid:6959)(cid:7166)(cid:1890)(cid:1382)(cid:4276)(cid:3881)(cid:2961)(cid:4961)(cid:1705)(cid:1157)(cid:1407)(cid:2241)sql(cid:7166)(cid:7566)(cid:3761)(cid:6595)(cid:1252)(cid:1411)(cid:4947)(cid:2927)(cid:3598)(cid:1928)(cid:2562)(cid:2241)(cid:1157)(cid:2562)(cid:2241)(cid:2666)(cid:3250)(cid:1674)(cid:2897)(cid:2825)(cid:822)

(cid:6959)(cid:7166)(cid:3661)(cid:1271)(cid:5183)(cid:6516)(cid:1644)(cid:1744)(cid:4137)(cid:1157)(cid:5291)(cid:1246)(cid:5183)(cid:2666)(cid:3598)

(cid:1411)(cid:1601)ssh(cid:4913)id(cid:1157)(cid:1461)(cid:1612)(cid:5766)(cid:3979)(cid:2825)(cid:1509)(cid:3503)(cid:4947)(cid:2927)(cid:4913)(cid:3528)(cid:1391)(cid:1622)(cid:2619)

id(cid:1890)(cid:1382)(cid:4951)(cid:3379)f12(cid:6068)(cid:2961)(cid:1157)

(cid:2356)(cid:1601)(cid:1912)(cid:2666)(cid:1890)(cid:1382)(cid:3979)(cid:2825)(cid:5231)

(cid:5291)(cid:1323)(cid:5183)(cid:2666)(cid:4018)(cid:6910)(cid:3641)(cid:1742)

cn.hutool.core.util.ZipUtil#unzip(java.util.zip.ZipFile, java.io.File, long)

zipentry(cid:4108)(cid:3661)(cid:2642)../(cid:6950)(cid:4353)(cid:822)

zip(cid:6516)(cid:1844)(cid:3576)(cid:3598)(cid:4108)(cid:3661)(cid:2642)zip(cid:4947)(cid:2927)(cid:5231)(cid:6780)(cid:6960)(cid:6408)(cid:6950)(cid:4353)(cid:4913)(cid:1157)(cid:3205)(cid:1382)(cid:1890)(cid:1382)(cid:1701)(cid:4768)zip(cid:4947)(cid:2927)(cid:5231)(cid:6780)(cid:3702)(cid:1411)(cid:3528)(cid:1391)(cid:1157)dir(cid:1499)(cid:6564)(cid:3598)(cid:4108)(cid:3661)(cid:1461)(cid:4768)(cid:6950)(cid:4913)(cid:2666)(cid:6408)(cid:822)

(cid:2388)(cid:4671)

(cid:1252)(cid:1411)zip_slip.zip

(cid:2961)(cid:1705)(cid:6816)(cid:2950)

(cid:1252)(cid:1411)(cid:3576)(cid:3604)(cid:5135)(cid:6816)(cid:2950)(cid:7167)(cid:2388)(cid:1157)(cid:6959)(cid:3576)(cid:3183)(cid:1386)dir(cid:1393)(cid:3130)(cid:1631)(cid:1246)(cid:1275)(cid:3676)(cid:2248)(cid:2562)(cid:2241)(cid:4913)(cid:4947)(cid:2927)(cid:1157)(cid:5087)(cid:1499)(cid:3524)(cid:3357)(cid:2858)(cid:4108)(cid:3661)(cid:2666)(cid:6408)(cid:822)

(cid:3659)(cid:1912)(cid:3182)(cid:1745)(cid:1252)(cid:1411)(cid:822)

(cid:3524)(cid:3357)(cid:2858)(cid:7166)(cid:7566)(cid:4913)(cid:4587)(cid:3006)(cid:822)

0x03 runcmd(cid:5488)(cid:6950)(cid:7004)(cid:3182)(cid:1976)(cid:1381)(cid:3223)(cid:6408)

0x03 runcmd(cid:5488)(cid:6950)(cid:7004)(cid:3182)(cid:1976)(cid:1381)(cid:3223)(cid:6408)

com.cym.controller.adminPage.ConfController#runCmd

(cid:1890)(cid:1382)(cid:4961)(cid:1705)(cid:5231)(cid:6960)(cid:3702)(cid:4913)cmd(cid:1590)(cid:6960)(cid:6408)(cid:6950)(cid:4353)(cid:1157)(cid:2241)(cid:6960)(cid:6408)(cid:3306)(cid:3379)(cid:3223)(cid:6408)(cid:822)

com.cym.controller.adminPage.ConfController#isAvailableCmd

(cid:1890)(cid:1382)(cid:1590)(cid:6619)(cid:1872)nginxPath(cid:821)nginxExe(cid:821)nginxDir(cid:1251)(cid:1275)(cid:43466)(cid:1157)(cid:7698)(cid:1590)(cid:1699)(cid:3545)(cid:2241)(cid:1255)(cid:2241)case(cid:7166)(cid:7566)(cid:1157)(cid:1255)(cid:2241)(cid:2666)(cid:6960)(cid:1601)if(cid:1157)(cid:1286)(cid:6493)(cid:2666)(cid:3598)(cid:1699)(cid:3545)
cmd(cid:1982)settingService.get("nginxExe") + " -c " + settingService.get("nginxPath") + dir(cid:3598)(cid:1255)(cid:3598)(cid:3118)(cid:5301)(cid:1157)(cid:1255)(cid:3118)(cid:5301)
(cid:2666)(cid:1255)(cid:3223)(cid:6408)(cid:1157)(cid:3118)(cid:5301)(cid:2666)(cid:3223)(cid:6408)

com.cym.controller.adminPage.ConfController#saveCmd

(cid:5650)(cid:1695)(cid:2437)(cid:6959)(cid:1251)(cid:1275)(cid:43466)(cid:3183)(cid:1386)(cid:1890)(cid:5844)(cid:4775)(cid:3380)(cid:1707)(cid:822)

(cid:2585)(cid:1407)(cid:2642)(cid:1411)(cid:43466)(cid:6960)(cid:6408)(cid:6950)(cid:4353)(cid:1157)(cid:1612)(cid:2603)(cid:4961)(cid:4961)(cid:2953)(cid:2437)(cid:5488)(cid:6950)(cid:822)linux(cid:4768)$(IFS)(cid:1380)(cid:3658)(cid:5230)(cid:3794)(cid:2666)(cid:6408)(cid:1157)win(cid:4768)powershell.exe(calc) (cid:2666)(cid:6408)

(cid:2388)(cid:4671)

(cid:1590)(cid:1509)(cid:3503)(cid:1271)(cid:1275)(cid:43466)

(cid:3182)(cid:1745)(cid:3223)(cid:6408)

(cid:1890)(cid:1382)(cid:3223)(cid:6408)(cid:822)

(cid:4775)(cid:1325)(cid:3661)(cid:6950)(cid:4353)(cid:1157)(cid:3205)(cid:1382)(cid:3183)(cid:1386)(cid:1890)(cid:1382)(cid:3241)reserveshell(cid:1631)(cid:6960)(cid:3528)(cid:1391)(cid:1157)(cid:2241)(cid:4768)bash(cid:3702)(cid:3223)(cid:6408)(cid:2666)(cid:2437)(cid:822)

(cid:1701)(cid:4768)(cid:1721)(cid:7566)(cid:1683)(cid:3721)(cid:2961)(cid:1157)(cid:1252)(cid:1411)(cid:4457)(cid:5844)(cid:1750)(cid:5544)(cid:2562)(cid:1705)tem(cid:4947)(cid:2927)(cid:1157)ubuntu(cid:1285)/tmp(cid:4947)(cid:2927).(cid:822)(cid:2921)(cid:4465)(cid:2892)(cid:6547)(cid:1255)(cid:6493)(cid:4768)macos(cid:6959)(cid:1566)(cid:7015)(cid:4015)(cid:1275)shell(cid:4670)(cid:2361)
(cid:7166)(cid:7566)var/folders/ln/sjz_zm513ng125ngw6c2b_lm0000gn(cid:7095)(cid:1255)(cid:1246)(cid:3791)(cid:822)

(cid:3352)ubuntu(cid:1912)(cid:1157)(cid:3182)(cid:1745)rce

0x04 reload (cid:1380)(cid:5041)(cid:3223)(cid:6408)

com.cym.controller.adminPage.ConfController#reload

(cid:4108)(cid:1355)(cid:1293)(cid:2437)(cid:6612)(cid:4913)(cid:1157)(cid:1602)(cid:1890)(cid:3380)(cid:1157)(cid:4108)(cid:3661)(cid:6950)(cid:4353)(cid:822)(cid:4496)(cid:1912)(cid:3306)(cid:3379)(cid:1157)(cid:6960)(cid:6408)(cid:3223)(cid:6408)(cid:822)

cn.hutool.core.util.RuntimeUtil#exec(java.lang.String...)

(cid:3659)(cid:1912)(cid:1407)(cid:6627)(cid:4768)(cid:1705)(cid:6959)(cid:7166)(cid:1157)(cid:1982)(cid:1252)(cid:7566)(cid:1255)(cid:1910)(cid:1157)(cid:6959)(cid:7166)(cid:3598)(cid:1380)(cid:5041)(cid:3223)(cid:6408)

(cid:2388)(cid:4671)

(cid:4766)(cid:3182)java(cid:3794)(cid:2903)(cid:1380)(cid:5041)(cid:3223)(cid:6408)

(cid:3182)(cid:1745)(cid:6068)(cid:1872)shell

0x05 check (cid:1380)(cid:5041)(cid:3223)(cid:6408)

com.cym.controller.adminPage.ConfController#check

(cid:1910)(cid:4696)(cid:1157)(cid:1602)(cid:1890)(cid:3380)(cid:1157)(cid:1260)(cid:4108)(cid:6950)(cid:4353)

(cid:3659)(cid:1912)(cid:1407)(cid:6771)(cid:1705)execforstr(),(cid:4496)(cid:1912)(cid:7004)(cid:3182)(cid:1380)(cid:5041)(cid:3223)(cid:6408)

(cid:3183)(cid:1386)(cid:1885)(cid:7537)(cid:6493)(cid:2642)nginxExe(cid:6745)(cid:43466)(cid:2666)(cid:6408)(cid:1157)json(cid:1499)(cid:3310)(cid:7957)(cid:6538)(cid:1157)(cid:1612)(cid:1439)(cid:1255)(cid:2356)(cid:1832)(cid:1890)

(cid:2388)(cid:4671)

(cid:4766)(cid:3182)java(cid:1869)(cid:2920)payload

(cid:3182)(cid:1745)rce

