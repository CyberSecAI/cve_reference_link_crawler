Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause:**

- The vulnerability stems from timing differences in the login endpoint when processing valid and invalid usernames. The server takes longer to process a valid username (due to database lookups and other operations) compared to an invalid one, which is rejected more quickly.

**Weaknesses/Vulnerabilities:**

- **Timing-based Username Enumeration:** The primary vulnerability is the ability to enumerate valid usernames by observing the time taken for the server to respond to login requests. This is a type of side-channel attack.

**Impact of Exploitation:**

- **Username Enumeration:** Attackers can identify valid usernames on the system.
- **Further Attacks:** The enumerated usernames can be used for subsequent attacks, such as password brute-forcing and credential stuffing attacks.

**Attack Vectors:**

- **Network-based:** The attack is performed over the network by sending crafted login requests and observing the server's response time.

**Required Attacker Capabilities/Position:**

- **Unauthenticated attacker:** The attacker doesn't need any prior authentication or credentials to exploit this vulnerability.
- **Network access:** The attacker requires network access to the Fides Webserver to send login requests.
- **Ability to measure time differences:** The attacker must be able to accurately measure the time differences in the server responses.

**Technical Details**
- The fix involves creating a temporary user in memory when an invalid username is provided, performing similar operations as with a valid user, and then raising the error, effectively normalizing timing differences between valid and invalid requests.
- Random sleep is added at the end of the request to make the timing differences less noticeable.

**Additional Notes**
- The provided PoC script `exploit-poc.sh` demonstrates the vulnerability by sending login requests with both valid and invalid usernames and calculating the average response time differences.
- The vulnerability is not easily reproducible on a local deployment because of low latency of responses.
- The fix includes creating a temporary user and client detail in memory, thus the `in_memory` flag is added to the `create_client_and_secret` function. The `skip_save` parameter is introduced to the `perform_login` function to avoid persisting the temporary user and client.
- This vulnerability is tracked as CVE-2024-45052 and GHSA-2h46-8gf5-fmxv.