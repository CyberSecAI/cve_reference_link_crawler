

[Discuss the Elastic Stack](/)

# [Elasticsearch 8.11.2, 7.17.16 Security Update (ESA-2023-29)](/t/elasticsearch-8-11-2-7-17-16-security-update-esa-2023-29/349179)

[Announcements](/c/announcements/security-announcements/31)

[Security Announcements](/c/announcements/security-announcements/31)

[Levine](https://discuss.elastic.co/u/Levine)
(Brian Levine)

December 12, 2023, 4:57pm

1

# Elasticsearch Insertion of Sensitive Information into Log File (ESA-2023-29)

An issue was discovered by Elastic whereby Watcher [search input](https://www.elastic.co/guide/en/elasticsearch/reference/current/input-search.html) logged the search query results on DEBUG log level. This could lead to raw contents of documents stored in Elasticsearch to be printed in logs. Elastic has released 8.11.2 and 7.17.16 that resolves this issue by removing this excessive logging.

**Affected Versions**

Elasticsearch versions on or after 7.0.0 and before 7.17.16.

Elasticsearch versions on or after 8.0.0 and before 8.11.2.

**Affected Configurations:**

This issue only affects users that use Watcher and have a Watch defined that uses the [search input](https://www.elastic.co/guide/en/elasticsearch/reference/current/input-search.html) and additionally have set the search inputâ€™s logger to DEBUG or finer, for example using:

`org.elasticsearch.xpack.watcher.input.search`,

`org.elasticsearch.xpack.watcher.input`,

`org.elasticsearch.xpack.watcher`,

or wider, since the loggers are hierarchical.

**Solutions and Mitigations:**

The issue is resolved in version 7.17.16 and 8.11.2

For users that cannot upgrade, if you are using Watcher with search input logger set to DEBUG, the [logging level](https://www.elastic.co/guide/en/elasticsearch/reference/current/logging.html#configuring-logging-levels) can be set to INFO or higher (WARN, ERROR).

### Severity:

CVSSv3: 5.2(Medium) - [AV:A/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N)

CVE ID: CVE-2023-49921

1 Like

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Enterprise Search 8.11.2 / 7.17.16 Security Update (ESA-2023-31)](https://discuss.elastic.co/t/enterprise-search-8-11-2-7-17-16-security-update-esa-2023-31/349181)  [Security Announcements](/c/announcements/security-announcements/31) | 1 | 8020 | December 26, 2023 |
| [Elasticsearch 8.9.2 and 7.17.13 Security Update](https://discuss.elastic.co/t/elasticsearch-8-9-2-and-7-17-13-security-update/342479)  [Security Announcements](/c/announcements/security-announcements/31) | 0 | 12060 | September 6, 2023 |
| [Kibana 8.11.2, 7.17.16 Security Update (ESA-2023-27)](https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182)  [Security Announcements](/c/announcements/security-announcements/31) [docker](https://discuss.elastic.co/tag/docker) | 1 | 10906 | December 12, 2023 |
| [Endpoint v8.10.4 Security Update](https://discuss.elastic.co/t/endpoint-v8-10-4-security-update/345203)  [Security Announcements](/c/announcements/security-announcements/31) | 0 | 9414 | October 17, 2023 |
| [Elasticsearch 8.16.2 / 8.17.0 Security Update](https://discuss.elastic.co/t/elasticsearch-8-16-2-8-17-0-security-update/372091)  [Security Announcements](/c/announcements/security-announcements/31) | 0 | 1753 | December 17, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](https://www.elastic.co/legal/terms-of-use)
* [Privacy Policy](https://www.elastic.co/legal/privacy-policy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

