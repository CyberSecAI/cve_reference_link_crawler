
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10507)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10507)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=FRRouting%2Ffrr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FRRouting](/FRRouting)
/
**[frr](/FRRouting/frr)**
Public

* [Notifications](/login?return_to=%2FFRRouting%2Ffrr) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FFRRouting%2Ffrr)
* [Star
   3.5k](/login?return_to=%2FFRRouting%2Ffrr)

* [Code](/FRRouting/frr)
* [Issues
  352](/FRRouting/frr/issues)
* [Pull requests
  215](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects
  1](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

Additional navigation options

* [Code](/FRRouting/frr)
* [Issues](/FRRouting/frr/issues)
* [Pull requests](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# isisd: overflow bugs in unpack\_tlv\_router\_cap #10507

Closed

[whichbug](/whichbug) opened this issue
Feb 6, 2022
· 21 comments

Closed

# [isisd: overflow bugs in unpack\_tlv\_router\_cap](#top) #10507

[whichbug](/whichbug) opened this issue
Feb 6, 2022
· 21 comments

## Comments

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issue-1125093957) • edited Loading

| [frr/isisd/isis\_tlvs.c](https://github.com/FRRouting/frr/blob/18ed776ca29533f6c49479b1a0dd95d36bb6b5ec/isisd/isis_tlvs.c#L3004-L3114)  Lines 3004 to 3114 in [18ed776](/FRRouting/frr/commit/18ed776ca29533f6c49479b1a0dd95d36bb6b5ec)   |  | subtlv\_len = tlv\_len - ISIS\_ROUTER\_CAP\_SIZE; | | --- | --- | |  | while (subtlv\_len > 2) { | |  | uint8\_t msd\_type; | |  |  | |  | type = stream\_getc(s); | |  | length = stream\_getc(s); | |  | switch (type) { | |  | case ISIS\_SUBTLV\_SID\_LABEL\_RANGE: | |  | /\* Check that SRGB is correctly formated \*/ | |  | if (length < SUBTLV\_RANGE\_LABEL\_SIZE | |  | || length > SUBTLV\_RANGE\_INDEX\_SIZE) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | /\* Only one SRGB is supported. Skip subsequent one \*/ | |  | if (rcap->srgb.range\_size != 0) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | rcap->srgb.flags = stream\_getc(s); | |  | rcap->srgb.range\_size = stream\_get3(s); | |  | /\* Skip Type and get Length of SID Label \*/ | |  | stream\_getc(s); | |  | size = stream\_getc(s); | |  | if (size == ISIS\_SUBTLV\_SID\_LABEL\_SIZE) | |  | rcap->srgb.lower\_bound = stream\_get3(s); | |  | else | |  | rcap->srgb.lower\_bound = stream\_getl(s); | |  |  | |  | /\* SRGB sanity checks. \*/ | |  | if (rcap->srgb.range\_size == 0 | |  | || (rcap->srgb.lower\_bound <= MPLS\_LABEL\_RESERVED\_MAX) | |  | || ((rcap->srgb.lower\_bound + rcap->srgb.range\_size - 1) | |  | > MPLS\_LABEL\_UNRESERVED\_MAX)) { | |  | sbuf\_push(log, indent, "Invalid label range. Reset SRGB\n"); | |  | rcap->srgb.lower\_bound = 0; | |  | rcap->srgb.range\_size = 0; | |  | } | |  | /\* Only one range is supported. Skip subsequent one \*/ | |  | size = length - (size + SUBTLV\_SR\_BLOCK\_SIZE); | |  | if (size > 0) | |  | stream\_forward\_getp(s, length); | |  | break; | |  | case ISIS\_SUBTLV\_ALGORITHM: | |  | /\* Only 2 algorithms are supported: SPF & Strict SPF \*/ | |  | stream\_get(&rcap->algo, s, | |  | length > SR\_ALGORITHM\_COUNT | |  | ? SR\_ALGORITHM\_COUNT | |  | : length); | |  | if (length > SR\_ALGORITHM\_COUNT) | |  | stream\_forward\_getp( | |  | s, length - SR\_ALGORITHM\_COUNT); | |  | break; | |  | case ISIS\_SUBTLV\_SRLB: | |  | /\* Check that SRLB is correctly formated \*/ | |  | if (length < SUBTLV\_RANGE\_LABEL\_SIZE | |  | || length > SUBTLV\_RANGE\_INDEX\_SIZE) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | /\* RFC 8667 section #3.3: Only one SRLB is authorized \*/ | |  | if (rcap->srlb.range\_size != 0) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | /\* Ignore Flags which are not defined \*/ | |  | stream\_getc(s); | |  | rcap->srlb.range\_size = stream\_get3(s); | |  | /\* Skip Type and get Length of SID Label \*/ | |  | stream\_getc(s); | |  | size = stream\_getc(s); | |  | if (size == ISIS\_SUBTLV\_SID\_LABEL\_SIZE) | |  | rcap->srlb.lower\_bound = stream\_get3(s); | |  | else | |  | rcap->srlb.lower\_bound = stream\_getl(s); | |  |  | |  | /\* SRLB sanity checks. \*/ | |  | if (rcap->srlb.range\_size == 0 | |  | || (rcap->srlb.lower\_bound <= MPLS\_LABEL\_RESERVED\_MAX) | |  | || ((rcap->srlb.lower\_bound + rcap->srlb.range\_size - 1) | |  | > MPLS\_LABEL\_UNRESERVED\_MAX)) { | |  | sbuf\_push(log, indent, "Invalid label range. Reset SRLB\n"); | |  | rcap->srlb.lower\_bound = 0; | |  | rcap->srlb.range\_size = 0; | |  | } | |  | /\* Only one range is supported. Skip subsequent one \*/ | |  | size = length - (size + SUBTLV\_SR\_BLOCK\_SIZE); | |  | if (size > 0) | |  | stream\_forward\_getp(s, length); | |  | break; | |  | case ISIS\_SUBTLV\_NODE\_MSD: | |  | /\* Check that MSD is correctly formated \*/ | |  | if (length < MSD\_TLV\_SIZE) { | |  | stream\_forward\_getp(s, length); | |  | continue; | |  | } | |  | msd\_type = stream\_getc(s); | |  | rcap->msd = stream\_getc(s); | |  | /\* Only BMI-MSD type has been defined in RFC 8491 \*/ | |  | if (msd\_type != MSD\_TYPE\_BASE\_MPLS\_IMPOSITION) | |  | rcap->msd = 0; | |  | /\* Only one MSD is standardized. Skip others \*/ | |  | if (length > MSD\_TLV\_SIZE) | |  | stream\_forward\_getp(s, length - MSD\_TLV\_SIZE); | |  | break; | |  | default: | |  | stream\_forward\_getp(s, length); | |  | break; | |  | } | |  | subtlv\_len = subtlv\_len - length - 2; | |  | } |      There are a few issues in the loop above leading to overflow vulnerabilities. The loop condition is `subtlv_len > 2` and `subtlv_len` is updated at the end of the loop (Line 3113: `subtlv_len = subtlv_len - length - 2`).  **The Issue on Loop Condition**: at Line 3113, when we update `subtlv_len`, if `subtlv_len < length + 2`, integer overflow will happen, leading to heap overflows in the next loop iteration. Note that `subtlv_len` and `length` are of `uint8_t`, which makes it easy to overflow, e.g., `subtlv_len=35`, `length=38`... An example output of the address sanitizer can be found below:  ``` 2022/02/05 21:54:53 ISIS: [S48XV-GT1WC][EC 100663311] stream_getc: Attempt to get char out of bounds 2022/02/05 21:54:53 ISIS: [RF6RD-ZCBTC][EC 100663311] &(struct stream): 0x61200000f940, size: 231, getp: 74, endp: 74 ==86437==      #1 0x7fe6ec3a118a in __libc_signal_restore_set /build/glibc-eX1tMB/glibc-2.31/signal/../sysdeps/unix/sysv/linux/internal-signals.h:86:3     #2 0x7fe6ec3a118a in raise /build/glibc-eX1tMB/glibc-2.31/signal/../sysdeps/unix/sysv/linux/raise.c:48:3     #3 0x7fe6ec380858 in abort /build/glibc-eX1tMB/glibc-2.31/stdlib/abort.c:79:7     #4 0x880f5c in _zlog_assert_failed /home/parallels/myfrr/lib/zlog.c:700:2     #5 0x7f2f6f in stream_getc /home/parallels/myfrr/lib/stream.c     #6 0x63c10c in unpack_tlv_router_cap /home/parallels/myfrr/isisd/isis_tlvs.c:3016:10     #7 0x6242a5 in unpack_tlv /home/parallels/myfrr/isisd/isis_tlvs.c:4332:10     #8 0x6242a5 in unpack_tlvs /home/parallels/myfrr/isisd/isis_tlvs.c:4354:8     #9 0x623ce4 in isis_unpack_tlvs /home/parallels/myfrr/isisd/isis_tlvs.c:4385:7     #10 0x5d5b5b in process_lsp /home/parallels/myfrr/isisd/isis_pdu.c:940:6     #11 0x5cf009 in isis_handle_pdu /home/parallels/myfrr/isisd/isis_pdu.c:1781:12  ```  **Other Issues**: at Line 3016, Line 3021, Line 3062, Line 3067, and Line 3098, I think we need to use `break` instead of `continue`. Using `continue` will let us miss the update of the loop condition variable at Line 3113.  Please check if my understanding of the code above is correct. If so, I can make a pull request to fix these issues then. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issuecomment-1030748475)

| **Issues on stream\_forward\_getp**: Also in the loop shown above, at Line 3015, Line 3020, Line 3045, Line 3054, Line 3061, Line 3066, Line 3097, Line 3107, and Line 3110, when we call `stream_forward_getp(s, length)`, there is no check whether `s + length` exceeds the bound of the stream, thus causing assertion failures in `stream_forward_getp`. |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issuecomment-1030749486)

| **Issues on stream\_get**: Also in the loop shown above, at Line 3049, when we call `stream_get`, we do not check if enough data are available in the buffer, which will cause overflows... |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issuecomment-1030751064) • edited Loading

| **Integer overflow bugs**: Also in the loop shown above, at Line 3043 and Line 3090, when we do the operation `size = length - (size + SUBTLV_SR_BLOCK_SIZE)`, integer overflows often happens, when `length < size + SUBTLV_SR_BLOCK_SIZE`. Both `length` and `size` are of uint8\_t, making the overflow happen frequently...  And I think the following code at Lines 3045 and 3092 should be `stream_forward_getp(s, size)` rather than `stream_forward_getp(s, length)`. Please check... |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 6, 2022](#issuecomment-1030751762) • edited Loading

| **Heap overflows**: Also in the loop shown above, at Line 3031 and Line 3078, the operation `stream_getl(s)` is valid only when `length = 10` but `length` may be `9`... |
| --- |

All reactions

Sorry, something went wrong.

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Feb 7, 2022](#issuecomment-1031573152)

| Hi! Are you fuzzing or auditing manually? |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 7, 2022](#issuecomment-1031589945)

| Hi! Are you fuzzing or auditing manually?  Hi, I am using FRR in one of our projects and trying to test its reliability. You can regard it as a kind of testing.  I carefully went through every problem I found and reported the issue only when I thought it is really a problem. I also tried to propose fixes as I also want to make contributions to FRR's community. |
| --- |

All reactions

Sorry, something went wrong.

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Feb 7, 2022](#issuecomment-1031654819)

| Yes, your reports are good quality and appreciated. I'm just curious what techniques you're using to find the issues. Are you part of a group? Others seem to be reporting the same type of issues recently. |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 7, 2022](#issuecomment-1031723672)

| Please check PR [#9850](https://github.com/FRRouting/frr/pull/9850). I believe most of the reported issues are solved there. Or even all of them. The PR is finished and the code is approved, but unfortunately it breaks some of our tests so it was not merged. I believe the tests could be wrong and should be fixed so it would be great if you look into that. |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 7, 2022](#issuecomment-1031757046)

| Update: [#9850](https://github.com/FRRouting/frr/pull/9850) has conflicts with current master, so I pushed a rebased version in [#10517](https://github.com/FRRouting/frr/pull/10517). Let's see whether it passes the tests. |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 7, 2022](#issuecomment-1031769717)

| Update: [#9850](https://github.com/FRRouting/frr/pull/9850) has conflicts with current master, so I pushed a rebased version in [#10517](https://github.com/FRRouting/frr/pull/10517). Let's see whether it passes the tests.  Thanks very much. That patch is helpful for me. |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 8, 2022](#issuecomment-1032622613)

| [#10517](https://github.com/FRRouting/frr/pull/10517) is now merged, could you please check if it fixes all reported issues? |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 8, 2022](#issuecomment-1032785144)

| [#10517](https://github.com/FRRouting/frr/pull/10517) is now merged, could you please check if it fixes all reported issues?  Yes, I think all are fixed. This issue can be closed. Thanks for your great efforts! |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=80&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)

Copy link

Contributor

### **[idryzhov](/idryzhov)** commented [Feb 8, 2022](#issuecomment-1032807144)

| Thanks for reporting! |
| --- |

All reactions

Sorry, something went wrong.

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=40&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)
[idryzhov](/idryzhov)
closed this as [completed](/FRRouting/frr/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 8, 2022](#event-6028145024)

[![@00xc](https://avatars.githubusercontent.com/u/48725664?s=80&u=8fd4aab32c746d120f56a49a3c29b8b492d06bae&v=4)](/00xc)

Copy link

### **[00xc](/00xc)** commented [Feb 25, 2022](#issuecomment-1051023668)

| This was assigned [CVE-2022-26125](https://github.com/advisories/GHSA-9hg8-8wq3-mhhg "CVE-2022-26125"). |
| --- |

All reactions

Sorry, something went wrong.

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Mar 25, 2022](#issuecomment-1079095009)

| Yeah, so...this is an assertion failure unless I'm reading the issue wrong. We push a stream buffer until a point where automatic bounds checks kick in and terminate the program to *prevent* a buffer overflow. Yet this is labeled as a buffer overflow and assigned a CVE score of 7.8.  [@00xc](https://github.com/00xc) [@whichbug](https://github.com/whichbug) can one of you guys clarify the situation here? |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Mar 25, 2022](#issuecomment-1079197150)

| Yeah, so...this is an assertion failure unless I'm reading the issue wrong. We push a stream buffer until a point where automatic bounds checks kick in and terminate the program to *prevent* a buffer overflow. Yet this is labeled as a buffer overflow and assigned a CVE score of 7.8.  [@00xc](https://github.com/00xc) [@whichbug](https://github.com/whichbug) can one of you guys clarify the situation here?  I guess the problem is that the assertion failures are caused by potential overflows. The CVE score could be reduced. |
| --- |

All reactions

Sorry, something went wrong.

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Mar 28, 2022](#issuecomment-1080985102)

| There are no potential overflows. The potential for overflow is eliminated by the assert. That's the whole point of the assert, that's why we put it there.  Since it sounds like you agree with my assessment, can you work with the CVE people to fix the CVE you filed? Frankly I don't even think this deserves a CVE but if you are set on filing them, please make sure you accurately report the problem.  So that you have some insight into what happens when the CVE process is used, we now have people from Debian emailing us regarding the high-severity CVEs you've filed for these issues. So now that I've found that this one isn't accurate, now I have to go through and cross check each of your reports against the CVEs you've filed to make sure they're actually accurate.  On that topic, usually when you file CVEs against projects, it's expected that you work with the people who run the project to agree on a characterization of what is going to be filed and when it's going to be disclosed. Unless we missed some communication from you, you haven't done that, which is inconsiderate to us. We're volunteers, not a major company selling a product. We aren't going to sue you to prevent you from filing CVEs. We have an established process for reporting security vulnerabilities that's in the project README. Your research is appreciated but please, follow common practices, spend the time to reach out and work with us regarding reporting and disclosure. |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Mar 28, 2022

[isisd: misusing strdup leads to stack overflow
#10505](/FRRouting/frr/issues/10505)

Closed

[Miss a check on length in Babel
#10487](/FRRouting/frr/issues/10487)

Closed

[Incorrect checks on length in babeld
#10502](/FRRouting/frr/issues/10502)

Closed

[babeld: bugs in parse\_hello\_subtlv, parse\_ihu\_subtlv, and parse\_update\_subtlv
#10503](/FRRouting/frr/issues/10503)

Closed

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Mar 28, 2022](#issuecomment-1081000685)

| [@00xc](https://github.com/00xc) [@whichbug](https://github.com/whichbug) By the way, if you guys are really interested in helping us with project security, we have a big list of issues just like this one found via our own security processes (such as Coverity, LLVM scan-build, ClusterFuzz, etc) that we need help fixing. Let me know if you're interested in contributing and I'll get you connected with our services so we can get some patches rolling. |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Mar 28, 2022](#issuecomment-1081037476)

| [@00xc](https://github.com/00xc) [@whichbug](https://github.com/whichbug) By the way, if you guys are really interested in helping us with project security, we have a big list of issues just like this one found via our own security processes (such as Coverity, LLVM scan-build, ClusterFuzz, etc) that we need help fixing. Let me know if you're interested in contributing and I'll get you connected with our services so we can get some patches rolling.  Thanks for your information. It looks good to me if I can contribute. You see I always tried to fix these reported bugs. |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Mar 28, 2022](#issuecomment-1081233408)

| Since it sounds like you agree with my assessment, can you work with the CVE people to fix the CVE you filed?  I have sent a request to update. I think it will be updated soon. |
| --- |

All reactions

Sorry, something went wrong.

[![@00xc](https://avatars.githubusercontent.com/u/48725664?s=80&u=8fd4aab32c746d120f56a49a3c29b8b492d06bae&v=4)](/00xc)

Copy link

### **[00xc](/00xc)** commented [Mar 29, 2022](#issuecomment-1081736549)

| On that topic, usually when you file CVEs against projects, it's expected that you work with the people who run the project to agree on a characterization of what is going to be filed and when it's going to be disclosed.  I don't think this was directed to me, but to be clear, I did not request the CVE, I just tried to make everyone aware. For what is worth, I updated [our downstream CVSS score](https://www.suse.com/es-es/security/cve/CVE-2022-26125.html) for this issue accordingly. Hopefully MITRE will do the same soon.  Frankly I don't even think this deserves a CVE  Not that my personal opinion matters much here, but a remotely reachable assertion (i.e. remote DoS) seems severe enough, although I might be missing something. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10507)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=52&v=4)](/idryzhov) [![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=52&v=4)](/qlyoung) [![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=52&v=4)](/whichbug) [![@00xc](https://avatars.githubusercontent.com/u/48725664?s=52&v=4)](/00xc)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

