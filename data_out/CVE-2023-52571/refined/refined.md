The provided content relates to CVE-2023-52571.

**Root cause of vulnerability:**
The root cause of the vulnerability is a missing `of_node_put()` call on all error paths during the `rk817_charger_probe` function and during driver removal which results in a refcount leak.

**Weaknesses/vulnerabilities present:**
The vulnerability is a reference count leak. The device tree node's reference count is not decremented on all error paths in the probe function, nor on driver removal, leading to a resource leak.

**Impact of exploitation:**
The impact of this vulnerability is a resource leak. Specifically, the reference count of the device tree node is leaked on every probe error, and on driver removal. This could eventually lead to system instability.

**Attack vectors:**
The attack vector is through normal system operation, specifically the probing and removal of the `rk817_charger` driver. Repeated probing and removal (or repeated error during the probe) will cause the leak.

**Required attacker capabilities/position:**
An attacker would need the ability to trigger the `rk817_charger` driver probe and removal or cause it to repeatedly fail. No specific privileges or user position is required beyond the ability to load and unload kernel modules or trigger device probing.

**Additional details:**
The fix is to ensure the `of_node_put` function is called on all error paths, and also upon driver removal, which is done using devm\_add\_action\_or\_reset.