This document provides a detailed description of multiple command injection vulnerabilities in various pages of WAVLINK AC1200 routers. Here's a breakdown of the identified vulnerabilities:

**General Root Cause:**

*   The primary root cause across all vulnerabilities is the **lack of input sanitization** in the `adm.cgi`, `firewall.cgi`, `login.cgi`, `nas.cgi`, `qos.cgi` and `wireless.cgi` binaries. Specifically, user-supplied parameters are not properly validated or filtered, allowing an attacker to inject OS commands.

**Vulnerabilities/Weaknesses:**

1.  **`/wizard_router_mesh.shtml` (adm.cgi):**
    *   Vulnerable parameters: `web_pskValue`, `wl_Method`, `wlan_ssid`, `EncrypType`, `rwan_ip`, `rwan_mask`, `rwan_gateway`, `ppp_username`, `ppp_passwd`, and `ppp_setver`.
    *   Weakness: Lack of sanitization on parameters when setting "Router Mode."
2.  **`/ledonoff.shtml` (adm.cgi):**
    *   Vulnerable parameter: `led_switch`.
    *   Weakness: Lack of sanitization when switching LED.
3.  **`/wan.shtml` (adm.cgi):**
    *  Vulnerable parameters: `ppp_username`, `ppp_passwd`, `rwan_gateway`, `rwan_mask`, and `rwan_ip`.
    *   Weakness: Lack of sanitization when setting "WAN".
4.  **`/wizard_rep.shtml` (adm.cgi):**
    *  Vulnerable parameters: `wlan_signal`, `web_pskValue`, `sel_EncrypTyp`, `sel_Automode`, `wlan_bssid`, `wlan_ssid`, and `wlan_channel`.
    *   Weakness: Lack of sanitization when setting "Repeater Mode."
5.  **`/ledonoff.shtml` (api.cgi):**
    *   Vulnerable parameter: hidden parameter `ufconf`.
    *  Weakness: Hidden parameter not sanitized and present in the cgi binary.
6.  **`/cli_black_list.shtml` (firewall.cgi - Adding):**
    *   Vulnerable parameter: `add_mac`.
    *   Weakness: Lack of sanitization when adding WIFI blacklist.
7.  **`/cli_black_list.shtml` (firewall.cgi - Deleting):**
    *   Vulnerable parameters: `del_mac` and `flag`.
    *  Weakness: Lack of sanitization when deleting WIFI blacklist.
8.  **`/man_security.shtml` (firewall.cgi):**
    *   Vulnerable parameters: `remoteManagementEnabled`, `blockPortScanEnabled`, `pingFrmWANFilterEnabled`, and `blockSynFloodEnabled`.
    *   Weakness: Lack of sanitization when setting system firewall.
9.  **`/login.shtml` (login.cgi):**
    *   Vulnerable parameter: `key`.
    *   Weakness: Lack of sanitization when logging in.
10. **`/nas_disk.shtml` (nas.cgi):**
    *   Vulnerable parameters: `User1Passwd` and `User1`.
    *   Weakness: Lack of sanitization when clicking the button on the page.
11. **`/qos.shtml` (qos.cgi - hidden parameters):**
    *   Vulnerable parameters: `cli_list` and `cli_num`.
    *  Weakness: Hidden parameters are not sanitized.
12. **`/qos.shtml` (qos.cgi):**
    *   Vulnerable parameters: `qos_bandwith` and `qos_dat`.
    *  Weakness: Lack of sanitization on the qos parameters when clicking the button.
13. **`/wifi_multi_ssid.shtml` (wireless.cgi):**
    *   Vulnerable parameters: `hiddenSSID32g` and `SSID2G2`.
    *   Weakness: Lack of sanitization when setting WIFI SSID to extend.
14. **`/wifi_mesh.shtml` (wireless.cgi - hidden parameters):**
    *   Vulnerable parameters: `mac_5g` and `Newname`.
    *   Weakness: Hidden parameters are not sanitized
15. **`/wifi_mesh.shtml` (wireless.cgi - adding):**
    *  Vulnerable parameter: `macAddr`.
    *  Weakness: Lack of sanitization when adding an extender.
16. **`/wifi_mesh.shtml` (wireless.cgi - deleting):**
     *  Vulnerable parameters: `delete_list`, `delete_al_mac`, `b_delete_list` and `b_delete_al_mac`.
     *  Weakness: Lack of sanitization when clicking the button on this page

**Impact of Exploitation:**

*   **Arbitrary Command Execution:** An attacker can inject operating system commands into the vulnerable parameters. This allows them to execute arbitrary code on the router, potentially gaining full control of the device.
*   **Complete Router Compromise:** Successful exploitation can lead to:
    *   Malware installation.
    *   Data theft.
    *   Network manipulation.
    *   Botnet participation.
    *   Denial of service

**Attack Vectors:**

*   **Web Interface:** The vulnerabilities are exploited through the router's web interface, specifically by sending crafted HTTP POST requests to the vulnerable CGI binaries.
*   **Parameter Injection:** Attackers inject commands by inserting malicious payloads into the vulnerable parameters.

**Required Attacker Capabilities/Position:**

*   **Network Access:** An attacker needs network access to the router's web interface. This could be from:
    *   A user on the local network.
    *   An attacker with remote access (if remote management is enabled).
*   **Authentication:** Most of the vulnerabilities require the attacker to be authenticated to the router's web interface, except for the login.cgi vulnerability.
*   **Knowledge of vulnerable pages and parameters:** The attacker needs to know which pages and parameters are vulnerable to craft the injection payload.

**Summary**

This document describes multiple command injection vulnerabilities present in various pages and CGI binaries of WAVLINK AC1200 routers. The root cause is a lack of input sanitization, allowing attackers to inject arbitrary operating system commands through various parameters. The impact of successful exploitation is complete router compromise, potentially leading to a wide range of malicious activities. Attackers need network access and, in most cases, authentication to exploit these vulnerabilities.