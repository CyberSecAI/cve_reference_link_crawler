=== Content from git.kernel.org_49456d65_20250110_232630.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Herbert Xu <herbert@gondor.apana.org.au> | 2024-02-01 13:49:09 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-02-23 09:25:11 +0100 |
| commit | [9c82920359b7c1eddaf72069bcfe0ffddf088cd0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0)) | |
| tree | [825502d583c0d7638d4718ead8fb552239c572d9](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0) | |
| parent | [88aa493f393d2ee38ac140e1f6ac1881346e85d4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=88aa493f393d2ee38ac140e1f6ac1881346e85d4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0&id2=88aa493f393d2ee38ac140e1f6ac1881346e85d4)) | |
| download | [linux-9c82920359b7c1eddaf72069bcfe0ffddf088cd0.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-9c82920359b7c1eddaf72069bcfe0ffddf088cd0.tar.gz) | |

crypto: algif\_hash - Remove bogus SGL free on zero-length error pathcommit 24c890dd712f6345e382256cae8c97abb0406b70 upstream.
When a zero-length message is hashed by algif\_hash, and an error
is triggered, it tries to free an SG list that was never allocated
in the first place. Fix this by not freeing the SG list on the
zero-length error path.
Reported-by: Shigeru Yoshida <syoshida@redhat.com>
Reported-by: xingwei lee <xrivendell7@gmail.com>
Fixes: b6d972f68983 ("crypto: af\_alg/hash: Fix recvmsg() after sendmsg(MSG\_MORE)")
Cc: <stable@vger.kernel.org>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Reported-by: syzbot+3266db0c26d1fbbe3abb@syzkaller.appspotmail.com
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0)

| -rw-r--r-- | [crypto/algif\_hash.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/crypto/algif_hash.c?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 2 deletions

| diff --git a/crypto/algif\_hash.c b/crypto/algif\_hash.cindex 82c44d4899b967..e24c829d7a0154 100644--- a/[crypto/algif\_hash.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/crypto/algif_hash.c?id=88aa493f393d2ee38ac140e1f6ac1881346e85d4)+++ b/[crypto/algif\_hash.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/crypto/algif_hash.c?id=9c82920359b7c1eddaf72069bcfe0ffddf088cd0)@@ -91,13 +91,13 @@ static int hash\_sendmsg(struct socket \*sock, struct msghdr \*msg, if (!(msg->msg\_flags & MSG\_MORE)) { err = hash\_alloc\_result(sk, ctx); if (err)- goto unlock\_free;+ goto unlock\_free\_result; ahash\_request\_set\_crypt(&ctx->req, NULL, ctx->result, 0); err = crypto\_wait\_req(crypto\_ahash\_final(&ctx->req), &ctx->wait); if (err)- goto unlock\_free;+ goto unlock\_free\_result; } goto done\_more; }@@ -170,6 +170,7 @@ unlock:  unlock\_free: af\_alg\_free\_sg(&ctx->sgl);+unlock\_free\_result: hash\_free\_result(sk, ctx); ctx->more = false; goto unlock; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:25:07 +0000



=== Content from git.kernel.org_b9825135_20250110_232629.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Herbert Xu <herbert@gondor.apana.org.au> | 2024-02-01 13:49:09 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-02-23 09:51:51 +0100 |
| commit | [775f3c1882a493168e08fdb8cde0865c8f3a8a29](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29)) | |
| tree | [991b3eef147116c68edc26caf2443fc5a640ad37](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29) | |
| parent | [b5909f197f3b26aebedca7d8ac7b688fd993a266](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b5909f197f3b26aebedca7d8ac7b688fd993a266) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29&id2=b5909f197f3b26aebedca7d8ac7b688fd993a266)) | |
| download | [linux-775f3c1882a493168e08fdb8cde0865c8f3a8a29.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-775f3c1882a493168e08fdb8cde0865c8f3a8a29.tar.gz) | |

crypto: algif\_hash - Remove bogus SGL free on zero-length error pathcommit 24c890dd712f6345e382256cae8c97abb0406b70 upstream.
When a zero-length message is hashed by algif\_hash, and an error
is triggered, it tries to free an SG list that was never allocated
in the first place. Fix this by not freeing the SG list on the
zero-length error path.
Reported-by: Shigeru Yoshida <syoshida@redhat.com>
Reported-by: xingwei lee <xrivendell7@gmail.com>
Fixes: b6d972f68983 ("crypto: af\_alg/hash: Fix recvmsg() after sendmsg(MSG\_MORE)")
Cc: <stable@vger.kernel.org>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Reported-by: syzbot+3266db0c26d1fbbe3abb@syzkaller.appspotmail.com
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29)

| -rw-r--r-- | [crypto/algif\_hash.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/crypto/algif_hash.c?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 2 deletions

| diff --git a/crypto/algif\_hash.c b/crypto/algif\_hash.cindex 82c44d4899b967..e24c829d7a0154 100644--- a/[crypto/algif\_hash.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/crypto/algif_hash.c?id=b5909f197f3b26aebedca7d8ac7b688fd993a266)+++ b/[crypto/algif\_hash.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/crypto/algif_hash.c?id=775f3c1882a493168e08fdb8cde0865c8f3a8a29)@@ -91,13 +91,13 @@ static int hash\_sendmsg(struct socket \*sock, struct msghdr \*msg, if (!(msg->msg\_flags & MSG\_MORE)) { err = hash\_alloc\_result(sk, ctx); if (err)- goto unlock\_free;+ goto unlock\_free\_result; ahash\_request\_set\_crypt(&ctx->req, NULL, ctx->result, 0); err = crypto\_wait\_req(crypto\_ahash\_final(&ctx->req), &ctx->wait); if (err)- goto unlock\_free;+ goto unlock\_free\_result; } goto done\_more; }@@ -170,6 +170,7 @@ unlock:  unlock\_free: af\_alg\_free\_sg(&ctx->sgl);+unlock\_free\_result: hash\_free\_result(sk, ctx); ctx->more = false; goto unlock; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:25:07 +0000



=== Content from git.kernel.org_5e69d006_20250110_232629.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=24c890dd712f6345e382256cae8c97abb0406b70)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=24c890dd712f6345e382256cae8c97abb0406b70)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=24c890dd712f6345e382256cae8c97abb0406b70)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=24c890dd712f6345e382256cae8c97abb0406b70)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Herbert Xu <herbert@gondor.apana.org.au> | 2024-02-01 13:49:09 +0800 |
| --- | --- | --- |
| committer | Herbert Xu <herbert@gondor.apana.org.au> | 2024-02-02 18:08:12 +0800 |
| commit | [24c890dd712f6345e382256cae8c97abb0406b70](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=24c890dd712f6345e382256cae8c97abb0406b70) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=24c890dd712f6345e382256cae8c97abb0406b70)) | |
| tree | [ab8ac0b6ed69da9841c3cc585c2192de5fcb02dd](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=24c890dd712f6345e382256cae8c97abb0406b70) | |
| parent | [69fba378edcaffba7bc7d299fdee02e377069d30](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=69fba378edcaffba7bc7d299fdee02e377069d30) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=24c890dd712f6345e382256cae8c97abb0406b70&id2=69fba378edcaffba7bc7d299fdee02e377069d30)) | |
| download | [linux-24c890dd712f6345e382256cae8c97abb0406b70.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-24c890dd712f6345e382256cae8c97abb0406b70.tar.gz) | |

crypto: algif\_hash - Remove bogus SGL free on zero-length error pathWhen a zero-length message is hashed by algif\_hash, and an error
is triggered, it tries to free an SG list that was never allocated
in the first place. Fix this by not freeing the SG list on the
zero-length error path.
Reported-by: Shigeru Yoshida <syoshida@redhat.com>
Reported-by: xingwei lee <xrivendell7@gmail.com>
Fixes: b6d972f68983 ("crypto: af\_alg/hash: Fix recvmsg() after sendmsg(MSG\_MORE)")
Cc: <stable@vger.kernel.org>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Reported-by: syzbot+3266db0c26d1fbbe3abb@syzkaller.appspotmail.com
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=24c890dd712f6345e382256cae8c97abb0406b70)

| -rw-r--r-- | [crypto/algif\_hash.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/crypto/algif_hash.c?id=24c890dd712f6345e382256cae8c97abb0406b70) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 2 deletions

| diff --git a/crypto/algif\_hash.c b/crypto/algif\_hash.cindex 82c44d4899b967..e24c829d7a0154 100644--- a/[crypto/algif\_hash.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/crypto/algif_hash.c?id=69fba378edcaffba7bc7d299fdee02e377069d30)+++ b/[crypto/algif\_hash.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/crypto/algif_hash.c?id=24c890dd712f6345e382256cae8c97abb0406b70)@@ -91,13 +91,13 @@ static int hash\_sendmsg(struct socket \*sock, struct msghdr \*msg, if (!(msg->msg\_flags & MSG\_MORE)) { err = hash\_alloc\_result(sk, ctx); if (err)- goto unlock\_free;+ goto unlock\_free\_result; ahash\_request\_set\_crypt(&ctx->req, NULL, ctx->result, 0); err = crypto\_wait\_req(crypto\_ahash\_final(&ctx->req), &ctx->wait); if (err)- goto unlock\_free;+ goto unlock\_free\_result; } goto done\_more; }@@ -170,6 +170,7 @@ unlock:  unlock\_free: af\_alg\_free\_sg(&ctx->sgl);+unlock\_free\_result: hash\_free\_result(sk, ctx); ctx->more = false; goto unlock; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:25:06 +0000


