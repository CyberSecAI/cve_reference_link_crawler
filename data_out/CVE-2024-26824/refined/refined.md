The provided content describes a vulnerability and its fix in the Linux kernel's crypto subsystem, specifically within the `algif_hash.c` file. This commit addresses a double-free or use-after-free condition when handling zero-length messages with the AF_ALG hash interface.

**Root cause of vulnerability:**

- The vulnerability occurs when a zero-length message is hashed using the `algif_hash` interface. In the error path, the code attempts to free a scatter-gather list (SGL) using `af_alg_free_sg(&ctx->sgl)`. However, this SGL is never allocated when the message length is zero, leading to a double-free or use-after-free when an error is triggered in this code path.

**Weaknesses/vulnerabilities present:**

- Double free / use-after-free: Attempting to free memory that was never allocated.

**Impact of exploitation:**

- The vulnerability could lead to a kernel crash or other undefined behavior due to the double free. It could potentially be exploited to achieve denial of service (DoS) or, with further exploitation, lead to arbitrary code execution in the kernel.

**Attack vectors:**

- An attacker could trigger this vulnerability by using the AF_ALG interface to hash a zero-length message, ensuring that the error path is executed, for example by sending the data through the socket and then closing the socket.

**Required attacker capabilities/position:**

- The attacker needs to have the capability to interact with the AF_ALG interface, typically via a user-space program. They can trigger the zero-length message hashing scenario by controlling the data passed through the interface, specifically sending a zero-length message for hashing.

**More detail than CVE:**

The provided commit log and diff offer more specific details than a standard CVE description might, by:
- Pinpointing the affected code section: `crypto/algif_hash.c`
- Explaining the scenario: zero-length messages triggering an incorrect SGL free.
- Providing the exact code changes to fix it: redirecting the error handling to avoid the free if no SGL was allocated.