Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
The vulnerability is a memory leak in the EROFS (Enhanced Read-Only File System) when using LZMA compression with global compressed deduplication enabled. The issue stems from the fact that temporary pages allocated during decompression were not being released properly.

**Weaknesses/Vulnerabilities:**
- **Memory Leak:** Short-lived temporary pages allocated during LZMA decompression with global deduplication are not freed.
- **Improper Resource Management:** The code fails to release the allocated memory after its use, leading to a gradual increase in memory consumption.

**Impact of Exploitation:**
- **Denial of Service (DoS):** The memory leak can lead to an out-of-memory (OOM) condition, which can cause the system to become unstable or crash. This is a form of denial-of-service because the system becomes unavailable. The issue is described as "slowly cause unexpected OOMs hours later"

**Attack Vectors:**
- The vulnerability is triggered when using EROFS with LZMA compression and global compressed deduplication (`-Ededupe` option)
- An attacker needs to mount a specially crafted EROFS image with LZMA compression and global compressed deduplication.
- The vulnerability is triggered during the decompression process when the deduplication feature is used.

**Required Attacker Capabilities/Position:**
- An attacker would need to be able to mount a crafted EROFS image.
- No special privileges are explicitly mentioned, but the ability to mount a filesystem would likely require some level of access.

**Technical Details:**

The fix involves setting the `Z_EROFS_SHORTLIVED_PAGE` flag on the allocated pages. This allows the kernel to properly handle these temporary pages and release them when they are no longer needed. Specifically, the fix adds these lines:

```c
+       set_page_private(rq->out[no],
+                           Z_EROFS_SHORTLIVED_PAGE);
```

The code change is in `fs/erofs/decompressor_lzma.c`, within the decompression function. The code allocates memory with `erofs_allocpage` when `rq->fillgaps` is true, and the output buffer `rq->out[no]` is empty indicating a deduplicated block. The `set_page_private` ensures the page is properly marked for release.

**Additional Notes:**

- The vulnerability only affects LZMA compression, while LZ4 and DEFLATE compression do not have this issue.
- The issue was introduced by commit `5c2a64252c5d ("erofs: introduce partial-referenced pclusters")`.
- The fix is described as preventing "short-lived temporary pages [from] not being properly released".