
            Commit Information:
            ------------------
            Author: Ray Essick <essick@google.com> 1636503281 -0800
            Date: Android Build Coastguard Worker <android-build-coastguard-worker@google.com> 1639526482 +0000
            Bug ID: Bug: 204445255

            Commit Message:
            --------------
            Better buffer-overrun preventionfixes end-of-buffer detection. Adds buffer-was-empty detection.Bug: 204445255Test: ran poc from bugChange-Id: I42117ce1455d1cac2bd43f16d67d77ec436b0fe2(cherry picked from commit b51ed962d5186b68f883540e557894e881a8272d)(cherry picked from commit 190e90959f3c34781c5276d50a5ee561c438db09)Merged-In:I42117ce1455d1cac2bd43f16d67d77ec436b0fe2
            