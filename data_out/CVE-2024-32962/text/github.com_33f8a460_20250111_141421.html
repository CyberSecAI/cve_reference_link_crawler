
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fcommit%2Fc2b83f984049edb68ad1d7c6ad0739ec92af11ca)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fcommit%2Fc2b83f984049edb68ad1d7c6ad0739ec92af11ca)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=node-saml%2Fxml-crypto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-saml](/node-saml)
/
**[xml-crypto](/node-saml/xml-crypto)**
Public

* [Notifications](/login?return_to=%2Fnode-saml%2Fxml-crypto) You must be signed in to change notification settings
* [Fork
  173](/login?return_to=%2Fnode-saml%2Fxml-crypto)
* [Star
   201](/login?return_to=%2Fnode-saml%2Fxml-crypto)

* [Code](/node-saml/xml-crypto)
* [Issues
  36](/node-saml/xml-crypto/issues)
* [Pull requests
  13](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects
  0](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

Additional navigation options

* [Code](/node-saml/xml-crypto)
* [Issues](/node-saml/xml-crypto/issues)
* [Pull requests](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

## Commit

[Permalink](/node-saml/xml-crypto/commit/c2b83f984049edb68ad1d7c6ad0739ec92af11ca)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add support for <X509Certificate /> in <KeyInfo />; remove `KeyInfoPr…

[Browse files](/node-saml/xml-crypto/tree/c2b83f984049edb68ad1d7c6ad0739ec92af11ca)
Browse the repository at this point in the history

```
…ovider` ([#301](https://github.com/node-saml/xml-crypto/pull/301))

* Replace `KeyInfoProvider` with plugable methods

Co-authored-by: Ivan <admin@clab.hr>
Co-authored-by: shunkica <ivannovak90@gmail.com>
```

* Loading branch information

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth) [![@shunkica](https://avatars.githubusercontent.com/u/11718584?s=40&v=4)](/shunkica)

3 people

authored
Jun 17, 2023

1 parent
[67b3a78](/node-saml/xml-crypto/commit/67b3a78586c3f740fb01ed963aee025c77fb1702)

commit c2b83f9

 Show file tree

 Hide file tree

Showing
**20 changed files**
with
**436 additions**
and
**323 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .eslintrc.json
  [.eslintrc.json](#diff-6884918dc8291219be508e05e28965b958c734def85324f3b53858ea4702090f)
* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* example

  + example/example.js
    [example.js](#diff-3db04cc3bc54b198c52e841f41a07fec22e7d7ca816d24332c6f61fb0067fa2d)
* index.d.ts
  [index.d.ts](#diff-7aa4473ede4abd9ec099e87fec67fd57afafaf39e05d493ab4533acc38547eb8)
* lib

  + lib/file-key-info.js
    [file-key-info.js](#diff-d7157458e078eb19be41d20e6dbd53d737989a4108e225f67170fd190fa272b5)
  + lib/signed-xml.js
    [signed-xml.js](#diff-58844ae8b1185b1627e00b2245f3fdcc5a8710438289e4555a0970ca8ae89fa6)
  + lib/string-key-info.js
    [string-key-info.js](#diff-f74bcac087c716ee158d1fe1badb38fbddbd34f4b4a3e8d93d5ee31ebf6a3cfd)
  + lib/utils.js
    [utils.js](#diff-5dfe38baf287dcf756a17c2dd63483781b53bf4b669e10efdd01e74bcd8e780a)
* test

  + test/document-test.js
    [document-test.js](#diff-68edde3adfd39e576846068b7f66d87913cff90bbe0dc328e29ec723605bf1ab)
  + test/hmac-tests.js
    [hmac-tests.js](#diff-673b96a3d52ddf7c4f3fcd7205edd9783cbe0a3be987eab084bb5f1281e8c1dd)
  + test/key-info-tests.js
    [key-info-tests.js](#diff-4f48f2e899100dd7422a9aa53bf0018cab990e2d00745efbcdb3353a2360b33f)
  + test/saml-response-test.js
    [saml-response-test.js](#diff-d3de11e0521d1b74c89721099dab82121f6cac238dee91b21d8dc02904608124)
  + test/signature-integration-tests.js
    [signature-integration-tests.js](#diff-964650bba1e67ef3283bffcdca9d618c8151f63b7a4730b8f6c72a396178858e)
  + test/signature-unit-tests.js
    [signature-unit-tests.js](#diff-ae65fa62a2a7137c9c92ec28a3e7fbb25a5fc867429969ac7feabf35bfe051dc)
  + static

    - test/static/client\_bundle.pem
      [client\_bundle.pem](#diff-b594892e0b97d7abb495f4d30e63b474e54e7588a2ecf78ce17f9a0d02a7b9ab)
    - test/static/client\_public.pem
      [client\_public.pem](#diff-814787e0fd1f72e0f716e60c830ad47177e2e43f57cbe81be71d46b212ad2219)
  + test/utils-tests.js
    [utils-tests.js](#diff-d383fed4c5335e484c6bfa5047d378dab8a29369af8a94639d2417bfa2ab4420)
  + validators/XmlCryptoUtilities/XmlCryptoUtilities

    - test/validators/XmlCryptoUtilities/XmlCryptoUtilities/Program.cs
      [Program.cs](#diff-8d9414233d9d8d30717575fcc93f7d0c84a0000e2ab8b22ce113ac8ac68c2a05)
    - test/validators/XmlCryptoUtilities/XmlCryptoUtilities/utilities.cs
      [utilities.cs](#diff-fbdc36617af6aac5c7e59a55280008d8e4c373a16f30041eada7771e467e322e)
  + test/wsfed-metadata-test.js
    [wsfed-metadata-test.js](#diff-792a191f0b71af74ff17cbd3f3ffada786db519f41e697d3435a52fdfbcb12fc)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[.eslintrc.json](#diff-6884918dc8291219be508e05e28965b958c734def85324f3b53858ea4702090f ".eslintrc.json")

Show comments

[View file](/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/.eslintrc.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,7 +6,7 @@ |
|  |  | }, |
|  |  | "root": true, |
|  |  | "parserOptions": { |
|  |  | "ecmaVersion": 6 |
|  |  | "ecmaVersion": 2020 |
|  |  | }, |
|  |  | "extends": ["eslint:recommended", "prettier"], |
|  |  | "rules": { |
| Expand Down | |  |

47 changes: 15 additions & 32 deletions

47
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -68,7 +68,6 @@ \_Signature Algorithm:\_ RSA-SHA1 http://www.w3.org/2000/09/xmldsig#rsa-sha1 |
|  |  | When signing a xml document you can specify the following properties on a `SignedXml` instance to customize the signature process: |
|  |  |  |
|  |  | - `sign.signingKey` - \*\*[required]\*\* a `Buffer` or pem encoded `String` containing your private key |
|  |  | - `sign.keyInfoProvider` - \*\*[optional]\*\* a key info provider instance, see [customizing algorithms](#customizing-algorithms) for an implementation example |
|  |  | - `sign.signatureAlgorithm` - \*\*[optional]\*\* one of the supported [signature algorithms](#signature-algorithms). Ex: `sign.signatureAlgorithm = "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"` |
|  |  | - `sign.canonicalizationAlgorithm` - \*\*[optional]\*\* one of the supported [canonicalization algorithms](#canonicalization-and-transformation-algorithms). Ex: `sign.canonicalizationAlgorithm = "http://www.w3.org/2001/10/xml-exc-c14n#WithComments"` |
|  |  |  |
| Expand Down  Expand Up | | @@ -119,7 +118,9 @@ To generate a `<X509Data></X509Data>` element in the signature you must provide |
|  |  |  |
|  |  | When verifying a xml document you must specify the following properties on a ``SignedXml` instance: |
|  |  |  |
|  |  | - `sign.keyInfoProvider` - \*\*[required]\*\* a key info provider instance containing your certificate, see [customizing algorithms](#customizing-algorithms) for an implementation example |
|  |  | - `sign.signingCert` - \*\*[optional]\*\* your certificate as a string, a string of multiple certs in PEM format, or a Buffer, see [customizing algorithms](#customizing-algorithms) for an implementation example |
|  |  |  |
|  |  | The certificate that will be used to check the signature will first be determined by calling `.getCertFromKeyInfo()`, which function you can customize as you see fit. If that returns `null`, then `.signingCert` is used. If that is `null`, then `.signingKey` is used (for symmetrical signing applications). |
|  |  |  |
|  |  | You can use any dom parser you want in your code (or none, depending on your usage). This sample uses [xmldom](https://github.com/jindw/xmldom) so you should install it first: |
|  |  |  |
| Expand All | | @@ -133,7 +134,6 @@ Example: |
|  |  | var select = require("xml-crypto").xpath, |
|  |  | dom = require("@xmldom/xmldom").DOMParser, |
|  |  | SignedXml = require("xml-crypto").SignedXml, |
|  |  | FileKeyInfo = require("xml-crypto").FileKeyInfo, |
|  |  | fs = require("fs"); |
|  |  |  |
|  |  | var xml = fs.readFileSync("signed.xml").toString(); |
| Expand All | | @@ -144,7 +144,7 @@ var signature = select( |
|  |  | "//\*[local-name(.)='Signature' and namespace-uri(.)='http://www.w3.org/2000/09/xmldsig#']" |
|  |  | )[0]; |
|  |  | var sig = new SignedXml(); |
|  |  | sig.keyInfoProvider = new FileKeyInfo("client\_public.pem"); |
|  |  | sig.signingCert = new FileKeyInfo("client\_public.pem"); |
|  |  | sig.loadSignature(signature); |
|  |  | var res = sig.checkSignature(xml); |
|  |  | if (!res) console.log(sig.validationErrors); |
| Expand Down  Expand Up | | @@ -179,7 +179,7 @@ If you keep failing verification, it is worth trying to guess such a hidden tran |
|  |  | ```javascript |
|  |  | var option = { implicitTransforms: ["http://www.w3.org/TR/2001/REC-xml-c14n-20010315"] }; |
|  |  | var sig = new SignedXml(null, option); |
|  |  | sig.keyInfoProvider = new FileKeyInfo("client\_public.pem"); |
|  |  | sig.signingCert = new FileKeyInfo("client\_public.pem"); |
|  |  | sig.loadSignature(signature); |
|  |  | var res = sig.checkSignature(xml); |
|  |  | ``` |
| Expand Down  Expand Up | | @@ -232,14 +232,6 @@ To verify xml documents: |
|  |  | - `checkSignature(xml)` - validates the given xml document and returns true if the validation was successful, `sig.validationErrors` will have the validation errors if any, where: |
|  |  | - `xml` - a string containing a xml document |
|  |  |  |
|  |  | ### FileKeyInfo |
|  |  |  |
|  |  | A basic key info provider implementation using `fs.readFileSync(file)`, is constructed using `new FileKeyInfo([file])` where: |
|  |  |  |
|  |  | - `file` - a path to a pem encoded certificate |
|  |  |  |
|  |  | See [verifying xml documents](#verifying-xml-documents) for an example usage |
|  |  |  |
|  |  | ## Customizing Algorithms |
|  |  |  |
|  |  | The following sample shows how to sign a message using custom algorithms. |
| Expand All | | @@ -253,24 +245,15 @@ var SignedXml = require("xml-crypto").SignedXml, |
|  |  |  |
|  |  | Now define the extension point you want to implement. You can choose one or more. |
|  |  |  |
|  |  | A key info provider is used to extract and construct the key and the KeyInfo xml section. |
|  |  | Implement it if you want to create a signature with a KeyInfo section, or you want to read your key in a different way then the default file read option. |
|  |  | To determine the inclusion and contents of a `<KeyInfo />` element, the function |
|  |  | `getKeyInfoContent()` is called. There is a default implementation of this. If you wish to change |
|  |  | this implementation, provide your own function assigned to the property `.getKeyInfoContent`. If |
|  |  | there are no attributes and no contents to the `<KeyInfo />` element, it won't be included in the |
|  |  | generated XML. |
|  |  |  |
|  |  | ```javascript |
|  |  | function MyKeyInfo() { |
|  |  | this.getKeyInfo = function (key, prefix) { |
|  |  | prefix = prefix || ""; |
|  |  | prefix = prefix ? prefix + ":" : prefix; |
|  |  | return "<" + prefix + "X509Data></" + prefix + "X509Data>"; |
|  |  | }; |
|  |  | this.getKey = function (keyInfo) { |
|  |  | //you can use the keyInfo parameter to extract the key in any way you want |
|  |  | return fs.readFileSync("key.pem"); |
|  |  | }; |
|  |  | } |
|  |  | ``` |
|  |  | To specify custom attributes on `<KeyInfo />`, add the properties to the `.keyInfoAttributes` property. |
|  |  |  |
|  |  | A custom hash algorithm is used to calculate digests. Implement it if you want a hash other than the default SHA1. |
|  |  | A custom hash algorithm is used to calculate digests. Implement it if you want a hash other than the built-in methods. |
|  |  |  |
|  |  | ```javascript |
|  |  | function MyDigest() { |
| Expand All | | @@ -284,7 +267,7 @@ function MyDigest() { |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | A custom signing algorithm. The default is RSA-SHA1 |
|  |  | A custom signing algorithm. The default is RSA-SHA1. |
|  |  |  |
|  |  | ```javascript |
|  |  | function MySignatureAlgorithm() { |
| Expand Down  Expand Up | | @@ -350,7 +333,7 @@ function signXml(xml, xpath, key, dest) { |
|  |  |  |
|  |  | /\*configure the signature object to use the custom algorithms\*/ |
|  |  | sig.signatureAlgorithm = "http://mySignatureAlgorithm"; |
|  |  | sig.keyInfoProvider = new MyKeyInfo(); |
|  |  | sig.signingCert = fs.readFileSync("my\_public\_cert.pem", "latin1"); |
|  |  | sig.canonicalizationAlgorithm = "http://MyCanonicalization"; |
|  |  | sig.addReference( |
|  |  | "//\*[local-name(.)='x']", |
| Expand All | | @@ -370,7 +353,7 @@ var xml = "<library>" + "<book>" + "<name>Harry Potter</name>" + "</book>"; |
|  |  | signXml(xml, "//\*[local-name(.)='book']", "client.pem", "result.xml"); |
|  |  | ``` |
|  |  |  |
|  |  | You can always look at the actual code as a sample (or drop me a [mail](mailto:yaronn01@gmail.com)). |
|  |  | You can always look at the actual code as a sample. |
|  |  |  |
|  |  | ## Asynchronous signing and verification |
|  |  |  |
| Expand Down | |  |

3 changes: 1 addition & 2 deletions

3
[example/example.js](#diff-3db04cc3bc54b198c52e841f41a07fec22e7d7ca816d24332c6f61fb0067fa2d "example/example.js")

Show comments

[View file](/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/example/example.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,7 +3,6 @@ |
|  |  | const select = require("xml-crypto").xpath; |
|  |  | const dom = require("@xmldom/xmldom").DOMParser; |
|  |  | const SignedXml = require("xml-crypto").SignedXml; |
|  |  | const FileKeyInfo = require("xml-crypto").FileKeyInfo; |
|  |  | const fs = require("fs"); |
|  |  |  |
|  |  | function signXml(xml, xpath, key, dest) { |
| Expand All | | @@ -21,7 +20,7 @@ function validateXml(xml, key) { |
|  |  | doc |
|  |  | )[0]; |
|  |  | const sig = new SignedXml(); |
|  |  | sig.keyInfoProvider = new FileKeyInfo(key); |
|  |  | sig.signingCert = key; |
|  |  | sig.loadSignature(signature.toString()); |
|  |  | const res = sig.checkSignature(xml); |
|  |  | if (!res) { |
| Expand Down | |  |

146 changes: 60 additions & 86 deletions

146
[index.d.ts](#diff-7aa4473ede4abd9ec099e87fec67fd57afafaf39e05d493ab4533acc38547eb8 "index.d.ts")

Show comments

[View file](/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/index.d.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -129,15 +129,25 @@ export interface TransformAlgorithm { |
|  |  | \* - {@link SignedXml#checkSignature} |
|  |  | \* - {@link SignedXml#validationErrors} |
|  |  | \*/ |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @param cert the certificate as a string or array of strings (see https://www.w3.org/TR/2008/REC-xmldsig-core-20080610/#sec-X509Data) |
|  |  | \* @param prefix an optional namespace alias to be used for the generated XML |
|  |  | \*/ |
|  |  | export interface GetKeyInfoContentArgs { |
|  |  | cert: string | string[] | Buffer; |
|  |  | prefix: string; |
|  |  | } |
|  |  |  |
|  |  | export class SignedXml { |
|  |  | // To add a new transformation algorithm create a new class that implements the {@link TransformationAlgorithm} interface, and register it here. More info: {@link https://github.com/node-saml/xml-crypto#customizing-algorithms|Customizing Algorithms} |
|  |  | static CanonicalizationAlgorithms: { |
|  |  | CanonicalizationAlgorithms: { |
|  |  | [uri in TransformAlgorithmType]: new () => TransformAlgorithm; |
|  |  | }; |
|  |  | // To add a new hash algorithm create a new class that implements the {@link HashAlgorithm} interface, and register it here. More info: {@link https://github.com/node-saml/xml-crypto#customizing-algorithms|Customizing Algorithms} |
|  |  | static HashAlgorithms: { [uri in HashAlgorithmType]: new () => HashAlgorithm }; |
|  |  | HashAlgorithms: { [uri in HashAlgorithmType]: new () => HashAlgorithm }; |
|  |  | // To add a new signature algorithm create a new class that implements the {@link SignatureAlgorithm} interface, and register it here. More info: {@link https://github.com/node-saml/xml-crypto#customizing-algorithms|Customizing Algorithms} |
|  |  | static SignatureAlgorithms: { [uri in SignatureAlgorithmType]: new () => SignatureAlgorithm }; |
|  |  | SignatureAlgorithms: { [uri in SignatureAlgorithmType]: new () => SignatureAlgorithm }; |
|  |  | // Rules used to convert an XML document into its canonical form. |
|  |  | canonicalizationAlgorithm: TransformAlgorithmType; |
|  |  | // It specifies a list of namespace prefixes that should be considered "inclusive" during the canonicalization process. |
| Expand All | | @@ -149,7 +159,7 @@ export class SignedXml { |
|  |  | // One of the supported signature algorithms. See {@link SignatureAlgorithmType} |
|  |  | signatureAlgorithm: SignatureAlgorithmType; |
|  |  | // A {@link Buffer} or pem encoded {@link String} containing your private key |
|  |  | signingKey: Buffer | string; |
|  |  | privateKey: Buffer | string; |
|  |  | // Contains validation errors (if any) after {@link checkSignature} method is called |
|  |  | validationErrors: string[]; |
|  |  |  |
| Expand Down  Expand Up | | @@ -278,115 +288,79 @@ export class SignedXml { |
|  |  | \* @returns The signed XML. |
|  |  | \*/ |
|  |  | getSignedXml(): string; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* KeyInfoProvider interface represents the structure for managing keys |
|  |  | \* and KeyInfo section in XML data when dealing with XML digital signatures. |
|  |  | \*/ |
|  |  | export interface KeyInfoProvider { |
|  |  | /\*\* |
|  |  | \* Method to return the key based on the contents of the specified KeyInfo. |
|  |  | \* Builds the contents of a KeyInfo element as an XML string. |
|  |  | \* |
|  |  | \* @param keyInfo - An optional array of XML Nodes. |
|  |  | \* @return A string or Buffer representing the key. |
|  |  | \*/ |
|  |  | getKey(keyInfo?: Node[]): string | Buffer; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Method to return an XML string representing the contents of a KeyInfo element. |
|  |  | \* For example, if the value of the prefix argument is 'foo', then |
|  |  | \* the resultant XML string will be "<foo:X509Data></foo:X509Data>" |
|  |  | \* |
|  |  | \* @param key - An optional string representing the key. |
|  |  | \* @param prefix - An optional string representing the namespace alias. |
|  |  | \* @return An XML string representation of the contents of a KeyInfo element. |
|  |  | \* @return an XML string representation of the contents of a KeyInfo element, or `null` if no `KeyInfo` element should be included |
|  |  | \*/ |
|  |  | getKeyInfo(key?: string, prefix?: string): string; |
|  |  | getKeyInfoContent(args: GetKeyInfoContentArgs): string | null; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* An optional dictionary of attributes which will be added to the KeyInfo element. |
|  |  | \* Returns the value of the signing certificate based on the contents of the |
|  |  | \* specified KeyInfo. |
|  |  | \* |
|  |  | \* @param keyInfo an array with exactly one KeyInfo element (see https://www.w3.org/TR/2008/REC-xmldsig-core-20080610/#sec-X509Data) |
|  |  | \* @return the signing certificate as a string in PEM format |
|  |  | \*/ |
|  |  | attrs?: { [key: string]: string }; |
|  |  | getCertFromKeyInfo(keyInfo: string): string | null; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The FileKeyInfo class loads the certificate from the file provided in the constructor. |
|  |  | \*/ |
|  |  | export class FileKeyInfo implements KeyInfoProvider { |
|  |  | export interface Utils { |
|  |  | /\*\* |
|  |  | \* The path to the file from which the certificate is to be read. |
|  |  | \* @param pem The PEM-encoded base64 certificate to strip headers from |
|  |  | \*/ |
|  |  | file: string; |
|  |  | static pemToDer(pem: string): string; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Initializes a new instance of the FileKeyInfo class. |
|  |  | \* |
|  |  | \* @param file - An optional string representing the file path of the certificate. |
|  |  | \* @param der The DER-encoded base64 certificate to add PEM headers too |
|  |  | \* @param pemLabel The label of the header and footer to add |
|  |  | \*/ |
|  |  | constructor(file?: string); |
|  |  | static derToPem( |
|  |  | der: string, |
|  |  | pemLabel: ["CERTIFICATE" | "PRIVATE KEY" | "RSA PUBLIC KEY"] |
|  |  | ): string; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Return the loaded certificate. The certificate is read from the file specified in the constructor. |
|  |  | \* The keyInfo parameter is ignored. (not implemented) |
|  |  | \* -----BEGIN [LABEL]----- |
|  |  | \* base64([DATA]) |
|  |  | \* -----END [LABEL]----- |
|  |  | \* |
|  |  | \* @param keyInfo - (not used) An optional array of XML Elements. |
|  |  | \* @return A Buffer representing the certificate. |
|  |  | \*/ |
|  |  | getKey(keyInfo?: Node[]): Buffer; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Builds the contents of a KeyInfo element as an XML string. |
|  |  | \* Above is shown what PEM file looks like. As can be seen, base64 data |
|  |  | \* can be in single line or multiple lines. |
|  |  | \* |
|  |  | \* Currently, this returns exactly one empty X509Data element |
|  |  | \* (e.g. "<X509Data></X509Data>"). The resultant X509Data element will be |
|  |  | \* prefaced with a namespace alias if a value for the prefix argument |
|  |  | \* is provided. In example, if the value of the prefix argument is 'foo', then |
|  |  | \* the resultant XML string will be "<foo:X509Data></foo:X509Data>" |
|  |  | \* This function normalizes PEM presentation to; |
|  |  | \*  - contain PEM header and footer as they are given |
|  |  | \*  - normalize line endings to '\n' |
|  |  | \*  - normalize line length to maximum of 64 characters |
|  |  | \*  - ensure that 'preeb' has line ending '\n' |
|  |  | \* |
|  |  | \* @param key (not used) the signing/private key as a string |
|  |  | \* @param prefix an optional namespace alias to be used for the generated XML |
|  |  | \* @return an XML string representation of the contents of a KeyInfo element |
|  |  | \*/ |
|  |  | getKeyInfo(key?: string, prefix?: string): string; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The StringKeyInfo class loads the certificate from the string provided in the constructor. |
|  |  | \*/ |
|  |  | export class StringKeyInfo implements KeyInfoProvider { |
|  |  | /\*\* |
|  |  | \* The certificate in string form. |
|  |  | \*/ |
|  |  | key: string; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Initializes a new instance of the StringKeyInfo class. |
|  |  | \* @param key - An optional string representing the certificate. |
|  |  | \*/ |
|  |  | constructor(key?: string); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns the certificate loaded in the constructor. |
|  |  | \* The keyInfo parameter is ignored. (not implemented) |
|  |  | \* With couple of notes: |
|  |  | \* - 'eol' is normalized to '\n' |
|  |  | \* |
|  |  | \* @param keyInfo (not used) an array with exactly one KeyInfo element |
|  |  | \* @return the signing certificate as a string |
|  |  | \* @param pem The PEM string to normalize to RFC7468 'stricttextualmsg' definition |
|  |  | \*/ |
|  |  | getKey(keyInfo?: Node[]): string; |
|  |  | static normalizePem(pem: string): string; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Builds the contents of a KeyInfo element as an XML string. |
|  |  | \* PEM format has wide range of usages, but this library |
|  |  | \* is enforcing RFC7468 which focuses on PKIX, PKCS and CMS. |
|  |  | \* |
|  |  | \* Currently, this returns exactly one empty X509Data element |
|  |  | \* (e.g. "<X509Data></X509Data>"). The resultant X509Data element will be |
|  |  | \* prefaced with a namespace alias if a value for the prefix argument |
|  |  | \* is provided. In example, if the value of the prefix argument is 'foo', then |
|  |  | \* the resultant XML string will be "<foo:X509Data></foo:X509Data>" |
|  |  | \* https://www.rfc-editor.org/rfc/rfc7468 |
|  |  | \* |
|  |  | \* PEM\_FORMAT\_REGEX is validating given PEM file against RFC7468 'stricttextualmsg' definition. |
|  |  | \* |
|  |  | \* @param key (not used) the signing/private key as a string |
|  |  | \* @param prefix an optional namespace alias to be used for the generated XML |
|  |  | \* @return an XML string representation of the contents of a KeyInfo element |
|  |  | \* With few exceptions; |
|  |  | \* - 'posteb' MAY have 'eol', but it is not mandatory. |
|  |  | \* - 'preeb' and 'posteb' lines are limited to 64 characters, but |
|  |  | \* should not cause any issues in context of PKIX, PKCS and CMS. |
|  |  | \*/ |
|  |  | getKeyInfo(key?: string, prefix?: string): string; |
|  |  | PEM\_FORMAT\_REGEX: RegExp; |
|  |  | EXTRACT\_X509\_CERTS: RegExp; |
|  |  | BASE64\_REGEX: RegExp; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

17 changes: 0 additions & 17 deletions

17
[lib/file-key-info.js](#diff-d7157458e078eb19be41d20e6dbd53d737989a4108e225f67170fd190fa272b5 "lib/file-key-info.js")

Show comments

[View file](/node-saml/xml-crypto/blob/67b3a78586c3f740fb01ed963aee025c77fb1702/lib/file-key-info.js)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c2b83f9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fcommit%2Fc2b83f984049edb68ad1d7c6ad0739ec92af11ca) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

