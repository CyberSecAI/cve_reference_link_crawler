```
{
  "vulnerability": {
    "CVE": "CVE-2024-32962",
    "details": "The vulnerability in xml-crypto versions 4.0.0 to less than 6.0.0 stems from the library's default behavior of trusting any certificate provided within the `<KeyInfo>` element of a digitally signed XML document. The library prefers using certificates extracted from the `<KeyInfo>` over any pre-configured certificates, thus, an attacker can forge a signature by resigning an XML document using a malicious private key, then including the corresponding certificate in the `<KeyInfo>` element. This bypasses the default validation checks.\n\nThe vulnerability arises from changes introduced in version 4.0.0, which provided a default method to extract certificates from signed XML documents and prioritize it for signature verification, even when a specific certificate was configured for verification.\n\nThe fix involves disabling the implicit usage of this default certificate extraction method in version 6.0.0.  \n\nWorkarounds include checking certificates extracted from `<KeyInfo>` against a list of trusted certificates, or setting the library's certificate extraction method to `() => undefined` to force the use of a configured `publicCert` or `privateKey`.\n",
    "affected_versions": ">=4.0.0, <6.0.0",
    "fixed_versions": "6.0.0",
    "root_cause": "The root cause is the library's default behavior of trusting certificates provided in the `<KeyInfo>` element and prioritizing them over configured certificates.",
    "weaknesses": [
      "CWE-347"
    ],
    "impact": "An attacker can use an untrusted certificate to pass a malicious XML payload through an improperly configured installation of `xml-crypto`. This could lead to the disclosure of sensitive information or the modification of data.",
    "attack_vectors": "The attack vector is network-based. An attacker can modify an XML document, replace the existing signature with a signature generated by a malicious private key, and include that key's certificate in the `<KeyInfo>` element.",
    "attacker_capabilities": "The attacker needs the ability to create a digital signature with a private key of their choosing and modify the XML document.",
     "cvss_score": "10.0",
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N"
  }
}
```