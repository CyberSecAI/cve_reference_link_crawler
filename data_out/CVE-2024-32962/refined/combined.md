=== Content from github.com_e6b5a9b6_20250111_141426.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fsecurity%2Fadvisories%2FGHSA-2xp3-57p7-qf4v)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fsecurity%2Fadvisories%2FGHSA-2xp3-57p7-qf4v)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=node-saml%2Fxml-crypto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-saml](/node-saml)
/
**[xml-crypto](/node-saml/xml-crypto)**
Public

* [Notifications](/login?return_to=%2Fnode-saml%2Fxml-crypto) You must be signed in to change notification settings
* [Fork
  173](/login?return_to=%2Fnode-saml%2Fxml-crypto)
* [Star
   201](/login?return_to=%2Fnode-saml%2Fxml-crypto)

* [Code](/node-saml/xml-crypto)
* [Issues
  36](/node-saml/xml-crypto/issues)
* [Pull requests
  13](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects
  0](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

Additional navigation options

* [Code](/node-saml/xml-crypto)
* [Issues](/node-saml/xml-crypto/issues)
* [Pull requests](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

# XML signature verification bypass due improper verification of signature / signature spoofing

Critical

[cjbarth](/cjbarth)
published
GHSA-2xp3-57p7-qf4v
May 1, 2024

## Package

npm

xml-crypto
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

>=4.0.0, <6.0.0

## Patched versions

6.0.0

## Description

### Summary

Default configuration does not check authorization of the signer, it only checks the validity of the signature per section 3.2.2 of <https://www.w3.org/TR/2008/REC-xmldsig-core-20080610/#sec-CoreValidation>. As such, without additional validation steps, the default configuration allows a malicious actor to re-sign an XML document, place the certificate in a `<KeyInfo />` element, and pass `xml-crypto` default validation checks.

### Details

Affected `xml-crypto` versions between versions `>= 4.0.0` and `< 6.0.0`.

`xml-crypto` trusts by default any certificate provided via digitally signed XML document's `<KeyInfo />`.

`xml-crypto` prefers to use any certificate provided via digitally signed XML document's `<KeyInfo />` even if library was configured to use specific certificate (`publicCert`) for signature verification purposes.

Attacker can spoof signature verification by modifying XML document and replacing existing signature with signature generated with malicious private key (created by attacker) and by attaching that private key's certificate to `<KeyInfo />` element.

Vulnerability is combination of changes introduced to `4.0.0` at

* [#301](https://github.com/node-saml/xml-crypto/pull/301)
* [c2b83f9](https://github.com/node-saml/xml-crypto/commit/c2b83f984049edb68ad1d7c6ad0739ec92af11ca)

Changes at PR provided default method to extract certificate from signed XML document.

* [xml-crypto/lib/signed-xml.js](https://github.com/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/lib/signed-xml.js#L405-L414)

  Lines 405 to 414
  in
  [c2b83f9](/node-saml/xml-crypto/commit/c2b83f984049edb68ad1d7c6ad0739ec92af11ca)

  |  | SignedXml.getCertFromKeyInfo = function (keyInfo) { |
  | --- | --- |
  |  | if (keyInfo != null && keyInfo.length > 0) { |
  |  | const certs = xpath.select(".//\*[local-name(.)='X509Certificate']", keyInfo[0]); |
  |  | if (certs.length > 0) { |
  |  | return utils.derToPem(certs[0].textContent.trim(), "CERTIFICATE"); |
  |  | } |
  |  | } |
  |  |  |
  |  | return null; |
  |  | }; |
* [xml-crypto/lib/signed-xml.js](https://github.com/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/lib/signed-xml.js#L334)

  Line 334
  in
  [c2b83f9](/node-saml/xml-crypto/commit/c2b83f984049edb68ad1d7c6ad0739ec92af11ca)

  |  | this.getCertFromKeyInfo = SignedXml.getCertFromKeyInfo; |
  | --- | --- |

and changes at PR prefer output of that method to be used as certificate for signature verification even in the case when library is configured to use specific/pre-configured `signingCert`

* [xml-crypto/lib/signed-xml.js](https://github.com/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/lib/signed-xml.js#L507)

  Line 507
  in
  [c2b83f9](/node-saml/xml-crypto/commit/c2b83f984049edb68ad1d7c6ad0739ec92af11ca)

  |  | this.getCertFromKeyInfo(this.keyInfo) || this.signingCert || this.signingKey, |
  | --- | --- |

Name of the `signingCert` was changed later (but prior to `4.0.0` release) to `publicCert`:

* [78329fb](https://github.com/node-saml/xml-crypto/commit/78329fbae34c9b25ba25882604e960f506d7c0e7)
* [xml-crypto/lib/signed-xml.js](https://github.com/node-saml/xml-crypto/blob/78329fbae34c9b25ba25882604e960f506d7c0e7/lib/signed-xml.js#L507)

  Line 507
  in
  [78329fb](/node-saml/xml-crypto/commit/78329fbae34c9b25ba25882604e960f506d7c0e7)

  |  | this.getCertFromKeyInfo(this.keyInfo) || this.publicCert || this.privateKey, |
  | --- | --- |

Issue was fixed to `6.0.0` by disabling implicit usage of default `getCertFromKeyInfo` implementation:

* [#445](https://github.com/node-saml/xml-crypto/pull/445)
* [2120172](https://github.com/node-saml/xml-crypto/commit/21201723d2ca9bc11288f62cf72552b7d659b000)

Possible workarounds for versions 4.x and 5.x:

* Check the certificate extracted via `getCertFromKeyInfo` against trusted certificates before accepting the results of the validation.
* Set `xml-crypto`'s `getCertFromKeyInfo` to `() => undefined` forcing `xml-crypto` to use an explicitly configured `publicCert` or `privateKey` for signature verification.

### PoC

[#399](https://github.com/node-saml/xml-crypto/discussions/399)

### Impact

An untrusted certificate can be used to pass a malicious XML payload through an improperly configured installation of `xml-crypto`.

### Severity

Critical

10.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N

### CVE ID

CVE-2024-32962

### Weaknesses

[CWE-347](/advisories?query=cwe%3A347)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_57137912_20250111_141420.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fcommit%2F21201723d2ca9bc11288f62cf72552b7d659b000)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fcommit%2F21201723d2ca9bc11288f62cf72552b7d659b000)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=node-saml%2Fxml-crypto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-saml](/node-saml)
/
**[xml-crypto](/node-saml/xml-crypto)**
Public

* [Notifications](/login?return_to=%2Fnode-saml%2Fxml-crypto) You must be signed in to change notification settings
* [Fork
  173](/login?return_to=%2Fnode-saml%2Fxml-crypto)
* [Star
   201](/login?return_to=%2Fnode-saml%2Fxml-crypto)

* [Code](/node-saml/xml-crypto)
* [Issues
  36](/node-saml/xml-crypto/issues)
* [Pull requests
  13](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects
  0](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

Additional navigation options

* [Code](/node-saml/xml-crypto)
* [Issues](/node-saml/xml-crypto/issues)
* [Pull requests](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

## Commit

[Permalink](/node-saml/xml-crypto/commit/21201723d2ca9bc11288f62cf72552b7d659b000)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Set `getCertFromKeyInfo` to `noop` ([#445](https://github.com/node-saml/xml-crypto/pull/445))

[Browse files](/node-saml/xml-crypto/tree/21201723d2ca9bc11288f62cf72552b7d659b000)
Browse the repository at this point in the history

```
`getKeyInfoContent` was incorrectly set to `noop` instead of `getCertFromKeyInfo`
```

* Loading branch information

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth)

[cjbarth](/node-saml/xml-crypto/commits?author=cjbarth "View all commits by cjbarth")
authored
Jan 26, 2024

1 parent
[f8cbbb7](/node-saml/xml-crypto/commit/f8cbbb76b593fd356e8b132cac166565ea9160e5)

commit 2120172

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**5 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/signed-xml.ts
    [signed-xml.ts](#diff-2864de8d56a8e5bfbf91cae4cb23ff20f546b4f5038c37cd995917a3fc38edef)
* test

  + test/document-tests.spec.ts
    [document-tests.spec.ts](#diff-df8e498323256d1617b89bcfbdbd87ecb4715628bcaf0c64a34b56d25dfb8cee)
  + test/key-info-tests.spec.ts
    [key-info-tests.spec.ts](#diff-bd2d5388aba1c6ec31201f15f3ac3da119883d3273e6cd2e583ced6da41c3d74)
  + test/signature-unit-tests.spec.ts
    [signature-unit-tests.spec.ts](#diff-f44f0fc7538111ca622cf1677e3ef4431222d68a780ed49a3c41ddf91cf9eef1)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[src/signed-xml.ts](#diff-2864de8d56a8e5bfbf91cae4cb23ff20f546b4f5038c37cd995917a3fc38edef "src/signed-xml.ts")

Show comments

[View file](/node-saml/xml-crypto/blob/21201723d2ca9bc11288f62cf72552b7d659b000/src/signed-xml.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -149,8 +149,8 @@ export class SignedXml { |
|  |  | } |
|  |  | this.implicitTransforms = implicitTransforms ?? this.implicitTransforms; |
|  |  | this.keyInfoAttributes = keyInfoAttributes ?? this.keyInfoAttributes; |
|  |  | this.getKeyInfoContent = getKeyInfoContent ?? SignedXml.noop; |
|  |  | this.getCertFromKeyInfo = getCertFromKeyInfo ?? this.getCertFromKeyInfo; |
|  |  | this.getKeyInfoContent = getKeyInfoContent ?? this.getKeyInfoContent; |
|  |  | this.getCertFromKeyInfo = getCertFromKeyInfo ?? SignedXml.noop; |
|  |  | this.CanonicalizationAlgorithms; |
|  |  | this.HashAlgorithms; |
|  |  | this.SignatureAlgorithms; |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[test/document-tests.spec.ts](#diff-df8e498323256d1617b89bcfbdbd87ecb4715628bcaf0c64a34b56d25dfb8cee "test/document-tests.spec.ts")

Show comments

[View file](/node-saml/xml-crypto/blob/21201723d2ca9bc11288f62cf72552b7d659b000/test/document-tests.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -47,6 +47,7 @@ describe("Validated node references tests", function () { |
|  |  | const xml = fs.readFileSync("./test/static/valid\_saml.xml", "utf-8"); |
|  |  | const doc = new xmldom.DOMParser().parseFromString(xml); |
|  |  | const sig = new SignedXml(); |
|  |  | sig.getCertFromKeyInfo = SignedXml.getCertFromKeyInfo; |
|  |  | sig.loadSignature(sig.findSignatures(doc)[0]); |
|  |  | const validSignature = sig.checkSignature(xml); |
|  |  | expect(validSignature).to.be.true; |
| Expand All | | @@ -73,6 +74,7 @@ describe("Validated node references tests", function () { |
|  |  | const xml = fs.readFileSync("./test/static/valid\_saml.xml", "utf-8"); |
|  |  | const doc = new xmldom.DOMParser().parseFromString(xml); |
|  |  | const sig = new SignedXml(); |
|  |  | sig.getCertFromKeyInfo = SignedXml.getCertFromKeyInfo; |
|  |  | sig.loadSignature(sig.findSignatures(doc)[0]); |
|  |  | const validSignature = sig.checkSignature(xml); |
|  |  | expect(validSignature).to.be.true; |
| Expand All | | @@ -86,6 +88,7 @@ describe("Validated node references tests", function () { |
|  |  | const xml = fs.readFileSync("./test/static/valid\_saml.xml", "utf-8"); |
|  |  | const doc = new xmldom.DOMParser().parseFromString(xml); |
|  |  | const sig = new SignedXml(); |
|  |  | sig.getCertFromKeyInfo = SignedXml.getCertFromKeyInfo; |
|  |  | sig.loadSignature(sig.findSignatures(doc)[0]); |
|  |  | const validSignature = sig.checkSignature(xml); |
|  |  | expect(validSignature).to.be.true; |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[test/key-info-tests.spec.ts](#diff-bd2d5388aba1c6ec31201f15f3ac3da119883d3273e6cd2e583ced6da41c3d74 "test/key-info-tests.spec.ts")

Show comments

[View file](/node-saml/xml-crypto/blob/21201723d2ca9bc11288f62cf72552b7d659b000/test/key-info-tests.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,7 +13,6 @@ describe("KeyInfo tests", function () { |
|  |  | sig.publicCert = fs.readFileSync("./test/static/client\_public.pem"); |
|  |  | sig.canonicalizationAlgorithm = "http://www.w3.org/2001/10/xml-exc-c14n#"; |
|  |  | sig.signatureAlgorithm = "http://www.w3.org/2000/09/xmldsig#rsa-sha1"; |
|  |  | sig.getKeyInfoContent = SignedXml.getKeyInfoContent; |
|  |  | sig.computeSignature(xml); |
|  |  | const signedXml = sig.getSignedXml(); |
|  |  | const doc = new xmldom.DOMParser().parseFromString(signedXml); |
| Expand Down | |  |

2 changes: 0 additions & 2 deletions

2
[test/signature-unit-tests.spec.ts](#diff-f44f0fc7538111ca622cf1677e3ef4431222d68a780ed49a3c41ddf91cf9eef1 "test/signature-unit-tests.spec.ts")

Show comments

[View file](/node-saml/xml-crypto/blob/21201723d2ca9bc11288f62cf72552b7d659b000/test/signature-unit-tests.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -534,7 +534,6 @@ describe("Signature unit tests", function () { |
|  |  | sig.signatureAlgorithm = "http://dummySignatureAlgorithm"; |
|  |  | sig.canonicalizationAlgorithm = "http://DummyCanonicalization"; |
|  |  | sig.privateKey = ""; |
|  |  | sig.getKeyInfoContent = SignedXml.getKeyInfoContent; |
|  |  |  |
|  |  | sig.addReference({ |
|  |  | xpath: "//\*[local-name(.)='x']", |
| Expand Down  Expand Up | | @@ -1237,7 +1236,6 @@ describe("Signature unit tests", function () { |
|  |  | sig.publicCert = pemBuffer; |
|  |  | sig.canonicalizationAlgorithm = "http://www.w3.org/2001/10/xml-exc-c14n#"; |
|  |  | sig.signatureAlgorithm = "http://www.w3.org/2000/09/xmldsig#rsa-sha1"; |
|  |  | sig.getKeyInfoContent = SignedXml.getKeyInfoContent; |
|  |  | sig.computeSignature(xml); |
|  |  | const signedXml = sig.getSignedXml(); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2120172`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fcommit%2F21201723d2ca9bc11288f62cf72552b7d659b000) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d92c0522_20250111_141426.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fpull%2F445)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fpull%2F445)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=node-saml%2Fxml-crypto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-saml](/node-saml)
/
**[xml-crypto](/node-saml/xml-crypto)**
Public

* [Notifications](/login?return_to=%2Fnode-saml%2Fxml-crypto) You must be signed in to change notification settings
* [Fork
  173](/login?return_to=%2Fnode-saml%2Fxml-crypto)
* [Star
   201](/login?return_to=%2Fnode-saml%2Fxml-crypto)

* [Code](/node-saml/xml-crypto)
* [Issues
  36](/node-saml/xml-crypto/issues)
* [Pull requests
  13](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects
  0](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

Additional navigation options

* [Code](/node-saml/xml-crypto)
* [Issues](/node-saml/xml-crypto/issues)
* [Pull requests](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fnode-saml%2Fxml-crypto%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fnode-saml%2Fxml-crypto%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Set `getCertFromKeyInfo` to `noop` #445

 Merged

[cjbarth](/cjbarth)
merged 2 commits into
[node-saml:master](/node-saml/xml-crypto/tree/master "node-saml/xml-crypto:master")
from
[cjbarth:keyinfo](/cjbarth/xml-crypto/tree/keyinfo "cjbarth/xml-crypto:keyinfo")

Jan 26, 2024

 Merged

# [Set `getCertFromKeyInfo` to `noop`](#top) #445

[cjbarth](/cjbarth)
merged 2 commits into
[node-saml:master](/node-saml/xml-crypto/tree/master "node-saml/xml-crypto:master")
from
[cjbarth:keyinfo](/cjbarth/xml-crypto/tree/keyinfo "cjbarth/xml-crypto:keyinfo")

Jan 26, 2024

[Conversation
9](/node-saml/xml-crypto/pull/445)
[Commits
2](/node-saml/xml-crypto/pull/445/commits)
[Checks
9](/node-saml/xml-crypto/pull/445/checks)
[Files changed](/node-saml/xml-crypto/pull/445/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![cjbarth](https://avatars.githubusercontent.com/u/3049726?s=60&v=4)](/cjbarth)

Copy link

Contributor

### @cjbarth **[cjbarth](/cjbarth)** commented [Jan 24, 2024](#issue-2098823068) • edited Loading

`getKeyInfoContent` was incorrectly set to `noop` instead of `getCertFromKeyInfo`

Sorry, something went wrong.

All reactions

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth)

`[Set getCertFromKeyInfo to noop](/node-saml/xml-crypto/pull/445/commits/497604e9b40a8f8d0371f97857c17fb9278dc1d0 "Set `getCertFromKeyInfo` to `noop`

`getKeyInfoContent` was incorectly set to `noop` instead of `getCertFromKeyInfo`")`
 …

`[497604e](/node-saml/xml-crypto/pull/445/commits/497604e9b40a8f8d0371f97857c17fb9278dc1d0)`

```
`getKeyInfoContent` was incorectly set to `noop` instead of `getCertFromKeyInfo`
```

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
added
the
[breaking-change](/node-saml/xml-crypto/labels/breaking-change)
label
[Jan 24, 2024](#event-11587908208)

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)
[![Codecov](https://avatars.githubusercontent.com/in/254?s=40&u=c392dd7c2afc51fe2347d4296afa8494ac05772e&v=4)](https://github.com/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Jan 24, 2024](#issuecomment-1908672239) • edited Loading

| [Codecov](https://app.codecov.io/gh/node-saml/xml-crypto/pull/445?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml) Report All modified and coverable lines are covered by tests ✅  Comparison is base [(`f8cbbb7`)](https://app.codecov.io/gh/node-saml/xml-crypto/commit/f8cbbb76b593fd356e8b132cac166565ea9160e5?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml) 73.17% compared to head [(`b12d68e`)](https://app.codecov.io/gh/node-saml/xml-crypto/pull/445?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml) 73.05%. Additional details and impacted files ``` @@            Coverage Diff             @@ ##           master     #445      +/-   ## ========================================== - Coverage   73.17%   73.05%   -0.12%      ==========================================   Files           9        9                 Lines         902      902                 Branches      239      239               ========================================== - Hits          660      659       -1        Misses        143      143               - Partials       99      100       +1      ```   [☔ View full report in Codecov by Sentry](https://app.codecov.io/gh/node-saml/xml-crypto/pull/445?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml). 📢 Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml). |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jan 24, 2024](#issuecomment-1908674762)

| This PR addresses the concerns correctly pointed out by [@srd90](https://github.com/srd90) [here](https://github.com/node-saml/node-saml/pull/341#issuecomment-1904714894).  Since it is fixing a mistake, and it seems few, if any are using it, should this be a semver-minor change or a semver-major change [@LoneRifle](https://github.com/LoneRifle) ? |
| --- |

All reactions

Sorry, something went wrong.

[![LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=60&v=4)](/LoneRifle)

**[LoneRifle](/LoneRifle)**
previously approved these changes
[Jan 25, 2024](#pullrequestreview-1842701186)

 [View reviewed changes](/node-saml/xml-crypto/pull/445/files/497604e9b40a8f8d0371f97857c17fb9278dc1d0)

Copy link

Collaborator

### @LoneRifle **[LoneRifle](/LoneRifle)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

lgtm, thanks for the catch [@srd90](https://github.com/srd90) !

Sorry, something went wrong.

All reactions

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jan 25, 2024](#issuecomment-1910479590)

| [@LoneRifle](https://github.com/LoneRifle) , do you think I should release this as a semver-minor or semver-major release? |
| --- |

All reactions

Sorry, something went wrong.

[![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=80&u=aaed659f3a4c32cf2034f1da1af91bd76f5ddd2a&v=4)](/LoneRifle)

Copy link

Collaborator

### **[LoneRifle](/LoneRifle)** commented [Jan 25, 2024](#issuecomment-1910630216)

| Inclination is towards a major release, given that it's likely a breaking change. At the same time, you could consider deprecating v5 so that users are encouraged to skip it |
| --- |

All reactions

Sorry, something went wrong.

[![@srd90](https://avatars.githubusercontent.com/u/60575312?s=80&v=4)](/srd90)

Copy link

### **[srd90](/srd90)** commented [Jan 25, 2024](#issuecomment-1910696900)

| Shouldn't you consider deprecating also v4 due to the fact that it has same default functionality that was now replaced with noop.  Thing that was about to happen at [node-saml/node-saml#341](https://github.com/node-saml/node-saml/pull/341) is a proof that people are quite likely going to disable signature verification accidentally during migration from earlier versions to v4 or v5 (more info from [#399](https://github.com/node-saml/xml-crypto/discussions/399) for those who land this PR later) and its going to be undetected if they don't have tests to cover e.g. the case at PR mentioned earlier. |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jan 25, 2024](#issuecomment-1910706830)

| Honestly, I think we de-facto deprecate anything other than the current semver-major release. I suppose I can actively deprecate these on NPM though. I have no interest in trying to support anything other the HEAD or the latest release. If someone wants something on an older version, they can make the correct PR, but that is on them.  [@LoneRifle](https://github.com/LoneRifle) what has been your tradition here? |
| --- |

All reactions

Sorry, something went wrong.

[![@srd90](https://avatars.githubusercontent.com/u/60575312?s=80&v=4)](/srd90)

Copy link

### **[srd90](/srd90)** commented [Jan 25, 2024](#issuecomment-1910725348)

| Just one more comment: Maybe CVE for v4 and v5 so that those who have already migrated to those versions would possible become more aware of unsecure default implementation which overrides explicitly set certificate. |
| --- |

All reactions

Sorry, something went wrong.

[![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=80&u=aaed659f3a4c32cf2034f1da1af91bd76f5ddd2a&v=4)](/LoneRifle)

Copy link

Collaborator

### **[LoneRifle](/LoneRifle)** commented [Jan 26, 2024](#issuecomment-1911225827)

| [@cjbarth](https://github.com/cjbarth) - I've usually just left versions alone, but only because I previously saw no significant security issues. I'm happy to defer to you to set the norm going forward |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth)

`[lint](/node-saml/xml-crypto/pull/445/commits/b12d68e45cdefc81547b7c7228b7ad42eca9bb61 "lint")`

`[b12d68e](/node-saml/xml-crypto/pull/445/commits/b12d68e45cdefc81547b7c7228b7ad42eca9bb61)`

 [![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
dismissed
[LoneRifle](/LoneRifle)’s [stale review](#pullrequestreview-1842701186)
via
`[b12d68e](/node-saml/xml-crypto/commit/b12d68e45cdefc81547b7c7228b7ad42eca9bb61)`
[January 26, 2024 18:04](#event-11611730902)

 Hide details
View details

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
merged commit [`2120172`](/node-saml/xml-crypto/commit/21201723d2ca9bc11288f62cf72552b7d659b000)
into
node-saml:master

[Jan 26, 2024](https://github.com/node-saml/xml-crypto/pull/445#event-11611808475)
8 of 9 checks passed

 [![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
deleted the
keyinfo

branch
[January 26, 2024 18:11](#event-11611809085)

[dozgunyal](/dozgunyal)
added a commit
to dozgunyal/xml-crypto
that referenced
this pull request
[May 6, 2024](#ref-commit-fff3d2f)
[![@dozgunyal](https://avatars.githubusercontent.com/u/9601135?s=40&u=160c46f8c84b44365723cc1220e814608d6a2cfa&v=4)](/dozgunyal)

`[Update README.md to reflect getKeyInfoContent changes](/dozgunyal/xml-crypto/commit/fff3d2fc41e37c0df84a65001a0dc5e8cdaff10e "Update README.md to reflect getKeyInfoContent changes

Changes in https://github.com/node-saml/xml-crypto/pull/445 was not reflected in the documentation. This PR fixes it.")`
…

`[fff3d2f](/dozgunyal/xml-crypto/commit/fff3d2fc41e37c0df84a65001a0dc5e8cdaff10e)`

```
Changes in [node-saml#445](https://github.com/node-saml/xml-crypto/pull/445) was not reflected in the documentation. This PR fixes it.
```

[![@dozgunyal](https://avatars.githubusercontent.com/u/9601135?s=40&u=160c46f8c84b44365723cc1220e814608d6a2cfa&v=4)](/dozgunyal)
[dozgunyal](/dozgunyal)
mentioned this pull request
[May 6, 2024](#ref-pullrequest-2281817850)

[Update README.md to reflect getKeyInfoContent changes
#470](/node-saml/xml-crypto/pull/470)
 Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fpull%2F445)

Reviewers

[![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=40&v=4)](/LoneRifle) [LoneRifle](/LoneRifle)

LoneRifle left review comments

Assignees

No one assigned

Labels

[breaking-change](/node-saml/xml-crypto/labels/breaking-change)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=52&v=4)](/cjbarth) [![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=52&v=4)](/LoneRifle) [![@srd90](https://avatars.githubusercontent.com/u/60575312?s=52&v=4)](/srd90)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_33f8a460_20250111_141421.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fcommit%2Fc2b83f984049edb68ad1d7c6ad0739ec92af11ca)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fcommit%2Fc2b83f984049edb68ad1d7c6ad0739ec92af11ca)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=node-saml%2Fxml-crypto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-saml](/node-saml)
/
**[xml-crypto](/node-saml/xml-crypto)**
Public

* [Notifications](/login?return_to=%2Fnode-saml%2Fxml-crypto) You must be signed in to change notification settings
* [Fork
  173](/login?return_to=%2Fnode-saml%2Fxml-crypto)
* [Star
   201](/login?return_to=%2Fnode-saml%2Fxml-crypto)

* [Code](/node-saml/xml-crypto)
* [Issues
  36](/node-saml/xml-crypto/issues)
* [Pull requests
  13](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects
  0](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

Additional navigation options

* [Code](/node-saml/xml-crypto)
* [Issues](/node-saml/xml-crypto/issues)
* [Pull requests](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

## Commit

[Permalink](/node-saml/xml-crypto/commit/c2b83f984049edb68ad1d7c6ad0739ec92af11ca)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add support for <X509Certificate /> in <KeyInfo />; remove `KeyInfoPr…

[Browse files](/node-saml/xml-crypto/tree/c2b83f984049edb68ad1d7c6ad0739ec92af11ca)
Browse the repository at this point in the history

```
…ovider` ([#301](https://github.com/node-saml/xml-crypto/pull/301))

* Replace `KeyInfoProvider` with plugable methods

Co-authored-by: Ivan <admin@clab.hr>
Co-authored-by: shunkica <ivannovak90@gmail.com>
```

* Loading branch information

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth) [![@shunkica](https://avatars.githubusercontent.com/u/11718584?s=40&v=4)](/shunkica)

3 people

authored
Jun 17, 2023

1 parent
[67b3a78](/node-saml/xml-crypto/commit/67b3a78586c3f740fb01ed963aee025c77fb1702)

commit c2b83f9

 Show file tree

 Hide file tree

Showing
**20 changed files**
with
**436 additions**
and
**323 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .eslintrc.json
  [.eslintrc.json](#diff-6884918dc8291219be508e05e28965b958c734def85324f3b53858ea4702090f)
* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* example

  + example/example.js
    [example.js](#diff-3db04cc3bc54b198c52e841f41a07fec22e7d7ca816d24332c6f61fb0067fa2d)
* index.d.ts
  [index.d.ts](#diff-7aa4473ede4abd9ec099e87fec67fd57afafaf39e05d493ab4533acc38547eb8)
* lib

  + lib/file-key-info.js
    [file-key-info.js](#diff-d7157458e078eb19be41d20e6dbd53d737989a4108e225f67170fd190fa272b5)
  + lib/signed-xml.js
    [signed-xml.js](#diff-58844ae8b1185b1627e00b2245f3fdcc5a8710438289e4555a0970ca8ae89fa6)
  + lib/string-key-info.js
    [string-key-info.js](#diff-f74bcac087c716ee158d1fe1badb38fbddbd34f4b4a3e8d93d5ee31ebf6a3cfd)
  + lib/utils.js
    [utils.js](#diff-5dfe38baf287dcf756a17c2dd63483781b53bf4b669e10efdd01e74bcd8e780a)
* test

  + test/document-test.js
    [document-test.js](#diff-68edde3adfd39e576846068b7f66d87913cff90bbe0dc328e29ec723605bf1ab)
  + test/hmac-tests.js
    [hmac-tests.js](#diff-673b96a3d52ddf7c4f3fcd7205edd9783cbe0a3be987eab084bb5f1281e8c1dd)
  + test/key-info-tests.js
    [key-info-tests.js](#diff-4f48f2e899100dd7422a9aa53bf0018cab990e2d00745efbcdb3353a2360b33f)
  + test/saml-response-test.js
    [saml-response-test.js](#diff-d3de11e0521d1b74c89721099dab82121f6cac238dee91b21d8dc02904608124)
  + test/signature-integration-tests.js
    [signature-integration-tests.js](#diff-964650bba1e67ef3283bffcdca9d618c8151f63b7a4730b8f6c72a396178858e)
  + test/signature-unit-tests.js
    [signature-unit-tests.js](#diff-ae65fa62a2a7137c9c92ec28a3e7fbb25a5fc867429969ac7feabf35bfe051dc)
  + static

    - test/static/client\_bundle.pem
      [client\_bundle.pem](#diff-b594892e0b97d7abb495f4d30e63b474e54e7588a2ecf78ce17f9a0d02a7b9ab)
    - test/static/client\_public.pem
      [client\_public.pem](#diff-814787e0fd1f72e0f716e60c830ad47177e2e43f57cbe81be71d46b212ad2219)
  + test/utils-tests.js
    [utils-tests.js](#diff-d383fed4c5335e484c6bfa5047d378dab8a29369af8a94639d2417bfa2ab4420)
  + validators/XmlCryptoUtilities/XmlCryptoUtilities

    - test/validators/XmlCryptoUtilities/XmlCryptoUtilities/Program.cs
      [Program.cs](#diff-8d9414233d9d8d30717575fcc93f7d0c84a0000e2ab8b22ce113ac8ac68c2a05)
    - test/validators/XmlCryptoUtilities/XmlCryptoUtilities/utilities.cs
      [utilities.cs](#diff-fbdc36617af6aac5c7e59a55280008d8e4c373a16f30041eada7771e467e322e)
  + test/wsfed-metadata-test.js
    [wsfed-metadata-test.js](#diff-792a191f0b71af74ff17cbd3f3ffada786db519f41e697d3435a52fdfbcb12fc)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[.eslintrc.json](#diff-6884918dc8291219be508e05e28965b958c734def85324f3b53858ea4702090f ".eslintrc.json")

Show comments

[View file](/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/.eslintrc.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,7 +6,7 @@ |
|  |  | }, |
|  |  | "root": true, |
|  |  | "parserOptions": { |
|  |  | "ecmaVersion": 6 |
|  |  | "ecmaVersion": 2020 |
|  |  | }, |
|  |  | "extends": ["eslint:recommended", "prettier"], |
|  |  | "rules": { |
| Expand Down | |  |

47 changes: 15 additions & 32 deletions

47
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -68,7 +68,6 @@ \_Signature Algorithm:\_ RSA-SHA1 http://www.w3.org/2000/09/xmldsig#rsa-sha1 |
|  |  | When signing a xml document you can specify the following properties on a `SignedXml` instance to customize the signature process: |
|  |  |  |
|  |  | - `sign.signingKey` - \*\*[required]\*\* a `Buffer` or pem encoded `String` containing your private key |
|  |  | - `sign.keyInfoProvider` - \*\*[optional]\*\* a key info provider instance, see [customizing algorithms](#customizing-algorithms) for an implementation example |
|  |  | - `sign.signatureAlgorithm` - \*\*[optional]\*\* one of the supported [signature algorithms](#signature-algorithms). Ex: `sign.signatureAlgorithm = "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"` |
|  |  | - `sign.canonicalizationAlgorithm` - \*\*[optional]\*\* one of the supported [canonicalization algorithms](#canonicalization-and-transformation-algorithms). Ex: `sign.canonicalizationAlgorithm = "http://www.w3.org/2001/10/xml-exc-c14n#WithComments"` |
|  |  |  |
| Expand Down  Expand Up | | @@ -119,7 +118,9 @@ To generate a `<X509Data></X509Data>` element in the signature you must provide |
|  |  |  |
|  |  | When verifying a xml document you must specify the following properties on a ``SignedXml` instance: |
|  |  |  |
|  |  | - `sign.keyInfoProvider` - \*\*[required]\*\* a key info provider instance containing your certificate, see [customizing algorithms](#customizing-algorithms) for an implementation example |
|  |  | - `sign.signingCert` - \*\*[optional]\*\* your certificate as a string, a string of multiple certs in PEM format, or a Buffer, see [customizing algorithms](#customizing-algorithms) for an implementation example |
|  |  |  |
|  |  | The certificate that will be used to check the signature will first be determined by calling `.getCertFromKeyInfo()`, which function you can customize as you see fit. If that returns `null`, then `.signingCert` is used. If that is `null`, then `.signingKey` is used (for symmetrical signing applications). |
|  |  |  |
|  |  | You can use any dom parser you want in your code (or none, depending on your usage). This sample uses [xmldom](https://github.com/jindw/xmldom) so you should install it first: |
|  |  |  |
| Expand All | | @@ -133,7 +134,6 @@ Example: |
|  |  | var select = require("xml-crypto").xpath, |
|  |  | dom = require("@xmldom/xmldom").DOMParser, |
|  |  | SignedXml = require("xml-crypto").SignedXml, |
|  |  | FileKeyInfo = require("xml-crypto").FileKeyInfo, |
|  |  | fs = require("fs"); |
|  |  |  |
|  |  | var xml = fs.readFileSync("signed.xml").toString(); |
| Expand All | | @@ -144,7 +144,7 @@ var signature = select( |
|  |  | "//\*[local-name(.)='Signature' and namespace-uri(.)='http://www.w3.org/2000/09/xmldsig#']" |
|  |  | )[0]; |
|  |  | var sig = new SignedXml(); |
|  |  | sig.keyInfoProvider = new FileKeyInfo("client\_public.pem"); |
|  |  | sig.signingCert = new FileKeyInfo("client\_public.pem"); |
|  |  | sig.loadSignature(signature); |
|  |  | var res = sig.checkSignature(xml); |
|  |  | if (!res) console.log(sig.validationErrors); |
| Expand Down  Expand Up | | @@ -179,7 +179,7 @@ If you keep failing verification, it is worth trying to guess such a hidden tran |
|  |  | ```javascript |
|  |  | var option = { implicitTransforms: ["http://www.w3.org/TR/2001/REC-xml-c14n-20010315"] }; |
|  |  | var sig = new SignedXml(null, option); |
|  |  | sig.keyInfoProvider = new FileKeyInfo("client\_public.pem"); |
|  |  | sig.signingCert = new FileKeyInfo("client\_public.pem"); |
|  |  | sig.loadSignature(signature); |
|  |  | var res = sig.checkSignature(xml); |
|  |  | ``` |
| Expand Down  Expand Up | | @@ -232,14 +232,6 @@ To verify xml documents: |
|  |  | - `checkSignature(xml)` - validates the given xml document and returns true if the validation was successful, `sig.validationErrors` will have the validation errors if any, where: |
|  |  | - `xml` - a string containing a xml document |
|  |  |  |
|  |  | ### FileKeyInfo |
|  |  |  |
|  |  | A basic key info provider implementation using `fs.readFileSync(file)`, is constructed using `new FileKeyInfo([file])` where: |
|  |  |  |
|  |  | - `file` - a path to a pem encoded certificate |
|  |  |  |
|  |  | See [verifying xml documents](#verifying-xml-documents) for an example usage |
|  |  |  |
|  |  | ## Customizing Algorithms |
|  |  |  |
|  |  | The following sample shows how to sign a message using custom algorithms. |
| Expand All | | @@ -253,24 +245,15 @@ var SignedXml = require("xml-crypto").SignedXml, |
|  |  |  |
|  |  | Now define the extension point you want to implement. You can choose one or more. |
|  |  |  |
|  |  | A key info provider is used to extract and construct the key and the KeyInfo xml section. |
|  |  | Implement it if you want to create a signature with a KeyInfo section, or you want to read your key in a different way then the default file read option. |
|  |  | To determine the inclusion and contents of a `<KeyInfo />` element, the function |
|  |  | `getKeyInfoContent()` is called. There is a default implementation of this. If you wish to change |
|  |  | this implementation, provide your own function assigned to the property `.getKeyInfoContent`. If |
|  |  | there are no attributes and no contents to the `<KeyInfo />` element, it won't be included in the |
|  |  | generated XML. |
|  |  |  |
|  |  | ```javascript |
|  |  | function MyKeyInfo() { |
|  |  | this.getKeyInfo = function (key, prefix) { |
|  |  | prefix = prefix || ""; |
|  |  | prefix = prefix ? prefix + ":" : prefix; |
|  |  | return "<" + prefix + "X509Data></" + prefix + "X509Data>"; |
|  |  | }; |
|  |  | this.getKey = function (keyInfo) { |
|  |  | //you can use the keyInfo parameter to extract the key in any way you want |
|  |  | return fs.readFileSync("key.pem"); |
|  |  | }; |
|  |  | } |
|  |  | ``` |
|  |  | To specify custom attributes on `<KeyInfo />`, add the properties to the `.keyInfoAttributes` property. |
|  |  |  |
|  |  | A custom hash algorithm is used to calculate digests. Implement it if you want a hash other than the default SHA1. |
|  |  | A custom hash algorithm is used to calculate digests. Implement it if you want a hash other than the built-in methods. |
|  |  |  |
|  |  | ```javascript |
|  |  | function MyDigest() { |
| Expand All | | @@ -284,7 +267,7 @@ function MyDigest() { |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | A custom signing algorithm. The default is RSA-SHA1 |
|  |  | A custom signing algorithm. The default is RSA-SHA1. |
|  |  |  |
|  |  | ```javascript |
|  |  | function MySignatureAlgorithm() { |
| Expand Down  Expand Up | | @@ -350,7 +333,7 @@ function signXml(xml, xpath, key, dest) { |
|  |  |  |
|  |  | /\*configure the signature object to use the custom algorithms\*/ |
|  |  | sig.signatureAlgorithm = "http://mySignatureAlgorithm"; |
|  |  | sig.keyInfoProvider = new MyKeyInfo(); |
|  |  | sig.signingCert = fs.readFileSync("my\_public\_cert.pem", "latin1"); |
|  |  | sig.canonicalizationAlgorithm = "http://MyCanonicalization"; |
|  |  | sig.addReference( |
|  |  | "//\*[local-name(.)='x']", |
| Expand All | | @@ -370,7 +353,7 @@ var xml = "<library>" + "<book>" + "<name>Harry Potter</name>" + "</book>"; |
|  |  | signXml(xml, "//\*[local-name(.)='book']", "client.pem", "result.xml"); |
|  |  | ``` |
|  |  |  |
|  |  | You can always look at the actual code as a sample (or drop me a [mail](mailto:yaronn01@gmail.com)). |
|  |  | You can always look at the actual code as a sample. |
|  |  |  |
|  |  | ## Asynchronous signing and verification |
|  |  |  |
| Expand Down | |  |

3 changes: 1 addition & 2 deletions

3
[example/example.js](#diff-3db04cc3bc54b198c52e841f41a07fec22e7d7ca816d24332c6f61fb0067fa2d "example/example.js")

Show comments

[View file](/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/example/example.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,7 +3,6 @@ |
|  |  | const select = require("xml-crypto").xpath; |
|  |  | const dom = require("@xmldom/xmldom").DOMParser; |
|  |  | const SignedXml = require("xml-crypto").SignedXml; |
|  |  | const FileKeyInfo = require("xml-crypto").FileKeyInfo; |
|  |  | const fs = require("fs"); |
|  |  |  |
|  |  | function signXml(xml, xpath, key, dest) { |
| Expand All | | @@ -21,7 +20,7 @@ function validateXml(xml, key) { |
|  |  | doc |
|  |  | )[0]; |
|  |  | const sig = new SignedXml(); |
|  |  | sig.keyInfoProvider = new FileKeyInfo(key); |
|  |  | sig.signingCert = key; |
|  |  | sig.loadSignature(signature.toString()); |
|  |  | const res = sig.checkSignature(xml); |
|  |  | if (!res) { |
| Expand Down | |  |

146 changes: 60 additions & 86 deletions

146
[index.d.ts](#diff-7aa4473ede4abd9ec099e87fec67fd57afafaf39e05d493ab4533acc38547eb8 "index.d.ts")

Show comments

[View file](/node-saml/xml-crypto/blob/c2b83f984049edb68ad1d7c6ad0739ec92af11ca/index.d.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -129,15 +129,25 @@ export interface TransformAlgorithm { |
|  |  | \* - {@link SignedXml#checkSignature} |
|  |  | \* - {@link SignedXml#validationErrors} |
|  |  | \*/ |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @param cert the certificate as a string or array of strings (see https://www.w3.org/TR/2008/REC-xmldsig-core-20080610/#sec-X509Data) |
|  |  | \* @param prefix an optional namespace alias to be used for the generated XML |
|  |  | \*/ |
|  |  | export interface GetKeyInfoContentArgs { |
|  |  | cert: string | string[] | Buffer; |
|  |  | prefix: string; |
|  |  | } |
|  |  |  |
|  |  | export class SignedXml { |
|  |  | // To add a new transformation algorithm create a new class that implements the {@link TransformationAlgorithm} interface, and register it here. More info: {@link https://github.com/node-saml/xml-crypto#customizing-algorithms|Customizing Algorithms} |
|  |  | static CanonicalizationAlgorithms: { |
|  |  | CanonicalizationAlgorithms: { |
|  |  | [uri in TransformAlgorithmType]: new () => TransformAlgorithm; |
|  |  | }; |
|  |  | // To add a new hash algorithm create a new class that implements the {@link HashAlgorithm} interface, and register it here. More info: {@link https://github.com/node-saml/xml-crypto#customizing-algorithms|Customizing Algorithms} |
|  |  | static HashAlgorithms: { [uri in HashAlgorithmType]: new () => HashAlgorithm }; |
|  |  | HashAlgorithms: { [uri in HashAlgorithmType]: new () => HashAlgorithm }; |
|  |  | // To add a new signature algorithm create a new class that implements the {@link SignatureAlgorithm} interface, and register it here. More info: {@link https://github.com/node-saml/xml-crypto#customizing-algorithms|Customizing Algorithms} |
|  |  | static SignatureAlgorithms: { [uri in SignatureAlgorithmType]: new () => SignatureAlgorithm }; |
|  |  | SignatureAlgorithms: { [uri in SignatureAlgorithmType]: new () => SignatureAlgorithm }; |
|  |  | // Rules used to convert an XML document into its canonical form. |
|  |  | canonicalizationAlgorithm: TransformAlgorithmType; |
|  |  | // It specifies a list of namespace prefixes that should be considered "inclusive" during the canonicalization process. |
| Expand All | | @@ -149,7 +159,7 @@ export class SignedXml { |
|  |  | // One of the supported signature algorithms. See {@link SignatureAlgorithmType} |
|  |  | signatureAlgorithm: SignatureAlgorithmType; |
|  |  | // A {@link Buffer} or pem encoded {@link String} containing your private key |
|  |  | signingKey: Buffer | string; |
|  |  | privateKey: Buffer | string; |
|  |  | // Contains validation errors (if any) after {@link checkSignature} method is called |
|  |  | validationErrors: string[]; |
|  |  |  |
| Expand Down  Expand Up | | @@ -278,115 +288,79 @@ export class SignedXml { |
|  |  | \* @returns The signed XML. |
|  |  | \*/ |
|  |  | getSignedXml(): string; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* KeyInfoProvider interface represents the structure for managing keys |
|  |  | \* and KeyInfo section in XML data when dealing with XML digital signatures. |
|  |  | \*/ |
|  |  | export interface KeyInfoProvider { |
|  |  | /\*\* |
|  |  | \* Method to return the key based on the contents of the specified KeyInfo. |
|  |  | \* Builds the contents of a KeyInfo element as an XML string. |
|  |  | \* |
|  |  | \* @param keyInfo - An optional array of XML Nodes. |
|  |  | \* @return A string or Buffer representing the key. |
|  |  | \*/ |
|  |  | getKey(keyInfo?: Node[]): string | Buffer; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Method to return an XML string representing the contents of a KeyInfo element. |
|  |  | \* For example, if the value of the prefix argument is 'foo', then |
|  |  | \* the resultant XML string will be "<foo:X509Data></foo:X509Data>" |
|  |  | \* |
|  |  | \* @param key - An optional string representing the key. |
|  |  | \* @param prefix - An optional string representing the namespace alias. |
|  |  | \* @return An XML string representation of the contents of a KeyInfo element. |
|  |  | \* @return an XML string representation of the contents of a KeyInfo element, or `null` if no `KeyInfo` element should be included |
|  |  | \*/ |
|  |  | getKeyInfo(key?: string, prefix?: string): string; |
|  |  | getKeyInfoContent(args: GetKeyInfoContentArgs): string | null; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* An optional dictionary of attributes which will be added to the KeyInfo element. |
|  |  | \* Returns the value of the signing certificate based on the contents of the |
|  |  | \* specified KeyInfo. |
|  |  | \* |
|  |  | \* @param keyInfo an array with exactly one KeyInfo element (see https://www.w3.org/TR/2008/REC-xmldsig-core-20080610/#sec-X509Data) |
|  |  | \* @return the signing certificate as a string in PEM format |
|  |  | \*/ |
|  |  | attrs?: { [key: string]: string }; |
|  |  | getCertFromKeyInfo(keyInfo: string): string | null; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The FileKeyInfo class loads the certificate from the file provided in the constructor. |
|  |  | \*/ |
|  |  | export class FileKeyInfo implements KeyInfoProvider { |
|  |  | export interface Utils { |
|  |  | /\*\* |
|  |  | \* The path to the file from which the certificate is to be read. |
|  |  | \* @param pem The PEM-encoded base64 certificate to strip headers from |
|  |  | \*/ |
|  |  | file: string; |
|  |  | static pemToDer(pem: string): string; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Initializes a new instance of the FileKeyInfo class. |
|  |  | \* |
|  |  | \* @param file - An optional string representing the file path of the certificate. |
|  |  | \* @param der The DER-encoded base64 certificate to add PEM headers too |
|  |  | \* @param pemLabel The label of the header and footer to add |
|  |  | \*/ |
|  |  | constructor(file?: string); |
|  |  | static derToPem( |
|  |  | der: string, |
|  |  | pemLabel: ["CERTIFICATE" | "PRIVATE KEY" | "RSA PUBLIC KEY"] |
|  |  | ): string; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Return the loaded certificate. The certificate is read from the file specified in the constructor. |
|  |  | \* The keyInfo parameter is ignored. (not implemented) |
|  |  | \* -----BEGIN [LABEL]----- |
|  |  | \* base64([DATA]) |
|  |  | \* -----END [LABEL]----- |
|  |  | \* |
|  |  | \* @param keyInfo - (not used) An optional array of XML Elements. |
|  |  | \* @return A Buffer representing the certificate. |
|  |  | \*/ |
|  |  | getKey(keyInfo?: Node[]): Buffer; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Builds the contents of a KeyInfo element as an XML string. |
|  |  | \* Above is shown what PEM file looks like. As can be seen, base64 data |
|  |  | \* can be in single line or multiple lines. |
|  |  | \* |
|  |  | \* Currently, this returns exactly one empty X509Data element |
|  |  | \* (e.g. "<X509Data></X509Data>"). The resultant X509Data element will be |
|  |  | \* prefaced with a namespace alias if a value for the prefix argument |
|  |  | \* is provided. In example, if the value of the prefix argument is 'foo', then |
|  |  | \* the resultant XML string will be "<foo:X509Data></foo:X509Data>" |
|  |  | \* This function normalizes PEM presentation to; |
|  |  | \*  - contain PEM header and footer as they are given |
|  |  | \*  - normalize line endings to '\n' |
|  |  | \*  - normalize line length to maximum of 64 characters |
|  |  | \*  - ensure that 'preeb' has line ending '\n' |
|  |  | \* |
|  |  | \* @param key (not used) the signing/private key as a string |
|  |  | \* @param prefix an optional namespace alias to be used for the generated XML |
|  |  | \* @return an XML string representation of the contents of a KeyInfo element |
|  |  | \*/ |
|  |  | getKeyInfo(key?: string, prefix?: string): string; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The StringKeyInfo class loads the certificate from the string provided in the constructor. |
|  |  | \*/ |
|  |  | export class StringKeyInfo implements KeyInfoProvider { |
|  |  | /\*\* |
|  |  | \* The certificate in string form. |
|  |  | \*/ |
|  |  | key: string; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Initializes a new instance of the StringKeyInfo class. |
|  |  | \* @param key - An optional string representing the certificate. |
|  |  | \*/ |
|  |  | constructor(key?: string); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns the certificate loaded in the constructor. |
|  |  | \* The keyInfo parameter is ignored. (not implemented) |
|  |  | \* With couple of notes: |
|  |  | \* - 'eol' is normalized to '\n' |
|  |  | \* |
|  |  | \* @param keyInfo (not used) an array with exactly one KeyInfo element |
|  |  | \* @return the signing certificate as a string |
|  |  | \* @param pem The PEM string to normalize to RFC7468 'stricttextualmsg' definition |
|  |  | \*/ |
|  |  | getKey(keyInfo?: Node[]): string; |
|  |  | static normalizePem(pem: string): string; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Builds the contents of a KeyInfo element as an XML string. |
|  |  | \* PEM format has wide range of usages, but this library |
|  |  | \* is enforcing RFC7468 which focuses on PKIX, PKCS and CMS. |
|  |  | \* |
|  |  | \* Currently, this returns exactly one empty X509Data element |
|  |  | \* (e.g. "<X509Data></X509Data>"). The resultant X509Data element will be |
|  |  | \* prefaced with a namespace alias if a value for the prefix argument |
|  |  | \* is provided. In example, if the value of the prefix argument is 'foo', then |
|  |  | \* the resultant XML string will be "<foo:X509Data></foo:X509Data>" |
|  |  | \* https://www.rfc-editor.org/rfc/rfc7468 |
|  |  | \* |
|  |  | \* PEM\_FORMAT\_REGEX is validating given PEM file against RFC7468 'stricttextualmsg' definition. |
|  |  | \* |
|  |  | \* @param key (not used) the signing/private key as a string |
|  |  | \* @param prefix an optional namespace alias to be used for the generated XML |
|  |  | \* @return an XML string representation of the contents of a KeyInfo element |
|  |  | \* With few exceptions; |
|  |  | \* - 'posteb' MAY have 'eol', but it is not mandatory. |
|  |  | \* - 'preeb' and 'posteb' lines are limited to 64 characters, but |
|  |  | \* should not cause any issues in context of PKIX, PKCS and CMS. |
|  |  | \*/ |
|  |  | getKeyInfo(key?: string, prefix?: string): string; |
|  |  | PEM\_FORMAT\_REGEX: RegExp; |
|  |  | EXTRACT\_X509\_CERTS: RegExp; |
|  |  | BASE64\_REGEX: RegExp; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

17 changes: 0 additions & 17 deletions

17
[lib/file-key-info.js](#diff-d7157458e078eb19be41d20e6dbd53d737989a4108e225f67170fd190fa272b5 "lib/file-key-info.js")

Show comments

[View file](/node-saml/xml-crypto/blob/67b3a78586c3f740fb01ed963aee025c77fb1702/lib/file-key-info.js)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c2b83f9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fcommit%2Fc2b83f984049edb68ad1d7c6ad0739ec92af11ca) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.w3.org_b4b5262e_20250111_141427.html ===

[![W3C](https://www.w3.org/Icons/w3c_home)](https://www.w3.org/)
# XML Signature Syntax and Processing (Second Edition)

## W3C Recommendation 10 June 2008

This version:
[http://www.w3.org/TR/2008/REC-xmldsig-core-20080610/](https://www.w3.org/TR/2008/REC-xmldsig-core-20080610/)
Latest version:
[http://www.w3.org/TR/xmldsig-core/](https://www.w3.org/TR/xmldsig-core/)
Previous version:
[http://www.w3.org/TR/2008/PER-xmldsig-core-20080326/](https://www.w3.org/TR/2008/PER-xmldsig-core-20080326/)
Editors
Donald Eastlake <d3e3e3@gmail.com>

Joseph Reagle <reagle@mit.edu>

David Solo <dsolo@alum.mit.edu>

Frederick Hirsch <frederick.hirsch@nokia.com> (2nd
edition)

Thomas Roessler <tlr@w3.org> (2nd edition)
Authors
Mark Bartel <mbartel@adobe.com>
John Boyer <boyerj@ca.ibm.com>

Barb Fox <bfox@Exchange.Microsoft.com>
Brian LaMacchia <bal@microsoft.com>
Ed Simon <edsimon@xmlsec.com>
Contributors
See [Acknowledgements](#sec-Acknowledgements)

Please refer to the [**errata**](https://www.w3.org/2008/06/xmldsigcore-errata.html) for this document, which may include some normative corrections.

This document is also available in these non-normative
formats: [XHTML with
color-coded revision indicators against the previous recommendation version.](review.html)

See also [**translations**](https://www.w3.org/2003/03/Translations/byTechnology?technology=xmldsig-core-80).

[Copyright](https://www.w3.org/Consortium/Legal/ipr-notice#Copyright) © 2008 [The Internet Society](http://www.ietf.org/)
& [W3C](https://www.w3.org/)® ([MIT](http://www.csail.mit.edu/),
[ERCIM](http://www.inria.fr/),
[Keio](http://www.keio.ac.jp/)), All
Rights Reserved. W3C [liability](https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer), [trademark](https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks) and [document use](https://www.w3.org/Consortium/Legal/copyright-documents) rules apply.

---

## Abstract

This document specifies XML digital signature processing rules
and syntax. XML Signatures provide [integrity](#def-Integrity), [message authentication](#def-AuthenticationMessage), and/or [signer
authentication](#def-AuthenticationSigner) services for data of any type, whether located
within the XML that includes the signature or elsewhere.

## Status of this document

*This section describes the status of this document at the
time of its publication. Other documents may supersede this
document. A list of current W3C publications and the latest
revision of this technical report can be found in the [W3C technical reports
index](https://www.w3.org/TR/) at http://www.w3.org/TR/.*

The [original
version](https://www.w3.org/TR/2002/REC-xmldsig-core-20020212/) of this specification was produced by the IETF/W3C [XML Signature Working Group](https://www.w3.org/Signature/) which believes
the specification is sufficient for the creation of independent interoperable implementations;
the [Interoperability Report](https://www.w3.org/Signature/2001/04/05-xmldsig-interop.html) shows at least 10 implementations with at least two
interoperable implementations over every feature.

This Second Edition was produced by the W3C [XML Security
Specifications Maintenance Working Group](https://www.w3.org/2007/xmlsec/), part of the W3C
Security Activity ([Activity Statement](https://www.w3.org/Security/)).

This Second Edition of XML Signature Syntax and
Processing adds Canonical XML 1.1 as a required
canonicalization algorithm and recommends its use for inclusive
canonicalization. This version of Canonical XML enables use of
`xml:id` and `xml:base` Recommendations
with XML Signature and also enables other possible future
attributes in the XML namespace. Additional minor changes,
including the incorporation of known errata, are documented in
[Changes in XML Signature Syntax and Processing
(Second Edition)](explain.html "Changes in XML Signature Syntax and Processing (Second Edition)").

The Working Group conducted an interoperability test as part
of its activity. The [Test Cases for C14N 1.1 and XMLDSig Interoperability](https://www.w3.org/TR/2008/NOTE-xmldsig2ed-tests-20080610/ "Test Cases for C14N 1.1 and XMLDSig Interoperability") [[TESTCASES](#ref-TESTCASES)] are available as a companion Working Group Note. The [Implementation Report for XML Signature, Second
Edition](https://www.w3.org/2007/xmlsec/interop/xmldsig/report.html "Implementation Report for XML Signature, Second Edition") is also publicly available.

Please send comments about this document to public-xmlsec-comments@w3.org (with [public archive](http://lists.w3.org/Archives/Public/public-xmlsec-comments/)).

This document has been reviewed by W3C Members, by software
developers, and by other W3C groups and interested parties, and
is endorsed by the Director as a W3C Recommendation. It is a
stable document and may be used as reference material or cited
from another document. W3C's role in making the Recommendation
is to draw attention to the specification and to promote its
widespread deployment. This enhances the functionality and
interoperability of the Web.

This document is governed by the [24 January 2002 CPP](https://www.w3.org/TR/2002/NOTE-patent-practice-20020124) as amended by the [W3C
Patent Policy Transition Procedure](https://www.w3.org/2004/02/05-pp-transition). W3C maintains a [public list of any patent disclosures](https://www.w3.org/2004/01/pp-impl/40279/status) made in
connection with the deliverables of the group; that page also
includes instructions for disclosing a patent. An individual
who has actual knowledge of a patent which the individual
believes contains [Essential Claim(s)](https://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential) must disclose the
information in accordance with [section 6 of the W3C Patent Policy](https://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure). Patent
disclosures relevant to this specification may be found on the
[IETF Page
of Intellectual Property Rights Notices](http://www.ietf.org/ipr.html), in conformance
with IETF policy.

The English version of this specification is the only
normative version.

## Table of Contents

1. [Introduction](#sec-Introduction)
   1. [Editorial
      Conventions](#sec-Editorial)
   2. [Design
      Philosophy](#sec-Design)
   3. [Versions,
      Namespaces and Identifiers](#sec-Versions)
   4. [Acknowledgements](#sec-Acknowledgements)
2. [Signature Overview and
   Examples](#sec-Overview)
   1. [Simple Example
      (`Signature`, `SignedInfo`,
      `Method`s, and `Reference`s)](#sec-o-Simple)
      1. [More on
         `Reference`](#sec-o-Reference)
   2. [Extended Example (`Object` and
      `SignatureProperty`)](#sec-o-SignatureProperty)
   3. [Extended Example
      (`Object` and `Manifest`)](#sec-o-Manifest)
3. [Processing Rules](#sec-Processing)
   1. [Signature
      Generation](#sec-CoreGeneration)
   2. [Signature
      Validation](#sec-CoreValidation)
4. [Core Signature
   Syntax](#sec-CoreSyntax)
   1. [The
      `Signature` element](#sec-Signature)
   2. [The
      `SignatureValue` Element](#sec-SignatureValue)
   3. [The
      `SignedInfo` Element](#sec-SignedInfo)
      1. [The `CanonicalizationMethod`
         Element](#sec-CanonicalizationMethod)
      2. [The
         `SignatureMethod` Element](#sec-SignatureMethod)
      3. [The
         `Reference` Element](#sec-Reference)
         1. [The
            `URI` Attribute](#sec-URI)
         2. [The Reference Processing Model](#sec-ReferenceProcessingModel)
         3. [Same-Document URI-References](#sec-Same-Document)
         4. [The
            `Transforms` Element](#sec-Transforms)
         5. [The
            `DigestMethod` Element](#sec-DigestMethod)
         6. [The
            `DigestValue` Element](#sec-DigestValue)
   4. [The
      `KeyInfo` Element](#sec-KeyInfo)
      1. [The
         `KeyName` Element](#sec-KeyName)
      2. [The
         `KeyValue` Element](#sec-KeyValue)
         1. [The
            `DSAKeyValue` Element](#sec-DSAKeyValue)
         2. [The
            `RSAKeyValue` Element](#sec-RSAKeyValue)
      3. [The
         `RetrievalMethod` Element](#sec-RetrievalMethod)
      4. [The
         `X509Data` Element](#sec-X509Data)
         1. [Distinguished Name Encoding Rules](#dname-encrules)
      5. [The
         `PGPData` Element](#sec-PGPData)
      6. [The
         `SPKIData` Element](#sec-SPKIData)
      7. [The
         `MgmtData` Element](#sec-MgmtData)
   5. [The
      `Object` Element](#sec-Object)
5. [Additional
   Signature Syntax](#sec-AdditionalSyntax)
   1. [The
      `Manifest` Element](#sec-Manifest)
   2. [The
      `SignatureProperties` Element](#sec-SignatureProperties)
   3. [Processing
      Instructions](#sec-PI)
   4. [Comments in dsig
      Elements](#sec-comments)
6. [Algorithms](#sec-Algorithms)
   1. [Algorithm Identifiers
      and Implementation Requirements](#sec-AlgID)
   2. [Message
      Digests](#sec-MessageDigests)
   3. [Message Authentication
      Codes](#sec-MACs)
   4. [Signature
      Algorithms](#sec-SignatureAlg)
   5. [Canonicalization
      Algorithms](#sec-c14nAlg)
      1. [Canonical XML
         1.0](#sec-Canonical)
      2. [Canonical
         XML 1.1](#sec-Canonical11)
   6. [Transform
      Algorithms](#sec-TransformAlg)
      1. [Canonicalization](#sec-Canonicalization)
      2. [Base64](#sec-Base-64)
      3. [XPath
         Filtering](#sec-XPath)
      4. [Enveloped Signature Transform](#sec-EnvelopedSignature)
      5. [XSLT
         Transform](#sec-XSLT)
7. [XML
   Canonicalization and Syntax Constraint Considerations](#sec-XML-Canonicalization)
   1. [XML 1.0, Syntax
      Constraints, and Canonicalization](#sec-XML-1)
   2. [DOM/SAX Processing
      and Canonicalization](#sec-DOM-SAX)
   3. [Namespace
      Context and Portable Signatures](#sec-NamespaceContext)
8. [Security
   Considerations](#sec-Security)
   1. [Transforms](#sec-Security-Transofrms)
      1. [Only What is
         Signed is Secure](#sec-Secure)
      2. [Only What is
         "Seen" Should be Signed](#sec-Seen)
      3. ["See" What is
         Signed](#sec-See)
   2. [Check the Security
      Model](#sec-Check)
   3. [Algorithms, Key
      Lengths, Etc.](#sec-KeyLength)
9. [Schema, DTD, Data Model,
   and Valid Examples](#sec-Schema)
10. [Definitions](#sec-Definitions)
11. [References](#sec-References)
12. [Authors'
    Address](#sec-Authors)

---

## 1.0 Introduction

This document specifies XML syntax and processing rules for
creating and representing digital signatures. XML Signatures can
be applied to any [digital content (data object)](#def-DataObject), including XML. An
XML Signature may be applied to the content of one or more
resources. [Enveloped](#def-SignatureEnveloped) or [enveloping](#def-SignatureEnveloping) signatures are over
data within the same XML document as the signature; [detached](#def-SignatureDetached) signatures are over data external to the
signature element. More specifically, this specification defines
an XML signature element type and an [XML
signature application](#def-SignatureApplication); conformance requirements for each are
specified by way of schema definitions and prose respectively.
This specification also includes other useful types that identify
methods for referencing collections of resources, algorithms, and
keying and management information.

The XML Signature is a method of associating a key with
referenced data (octets); it does not normatively specify how
keys are associated with persons or institutions, nor the meaning
of the data being referenced and signed. Consequently, while this
specification is an important component of secure XML
applications, it itself is not sufficient to address all
application security/trust concerns, particularly with respect to
using signed XML (or other data formats) as a basis of
human-to-human communication and agreement. Such an application
must specify additional key, algorithm, processing and rendering
requirements. For further information, please see [Security Considerations](#sec-Security) (section
8).

### 1.1 Editorial and Conformance Conventions

For readability, brevity, and historic reasons this document
uses the term "signature" to generally refer to digital
authentication values of all types. Obviously, the term is also
strictly used to refer to authentication values that are based on
public keys and that provide signer authentication. When
specifically discussing authentication values based on symmetric
secret key codes we use the terms authenticators or
authentication codes. (See [Check the Security Model](#sec-Check), section 8.3.)

This specification provides an XML Schema [[XML-schema](#ref-XML-schema)] and DTD [[XML](#ref-XML)]. The schema definition is
normative.

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in this specification are to be interpreted as
described in [RFC2119](http://www.ietf.org/rfc/rfc2119.txt) [[KEYWORDS](#ref-KEYWORDS)]:

> "they MUST only be used where it is actually required for
> interoperation or to limit behavior which has potential for
> causing harm (e.g., limiting retransmissions)"

Consequently, we use these capitalized key words to
unambiguously specify requirements over protocol and application
features and behavior that affect the interoperability and
security of implementations. These key words are not used
(capitalized) to describe XML grammar; schema definitions
unambiguously describe such requirements and we wish to reserve
the prominence of these terms for the natural language
descriptions of protocols and features. For instance, an XML
attribute might be described as being "optional." Compliance with
the Namespaces in XML specification [[XML-ns](#ref-XML-ns)] is described as "REQUIRED."

### 1.2 Design Philosophy

The design philosophy and requirements of this specification
are addressed in the XML-Signature Requirements document
[[XML-Signature-RD](#ref-XML-Signature-RD)].

### 1.3 Versions, Namespaces and Identifiers

No provision is made for an explicit version number in this
syntax. If a future version is needed, it will use a different
namespace. The XML namespace [[XML-ns](#ref-XML-ns)] URI that MUST be used by implementations of
this (dated) specification is:

```

   xmlns="http://www.w3.org/2000/09/xmldsig#"

```

This namespace is also used as the prefix for algorithm
identifiers used by this specification. While applications MUST
support XML and XML namespaces, the use of [internal entities](https://www.w3.org/TR/REC-xml#sec-internal-ent) [[XML](#ref-XML)] or our "dsig" XML [namespace prefix](https://www.w3.org/TR/1999/REC-xml-names-19990114/#dt-prefix) and defaulting/scoping
conventions are OPTIONAL; we use these facilities to provide
compact and readable examples.

This specification uses Uniform Resource Identifiers
[[URI](#ref-URI)] to identify resources,
algorithms, and semantics. The URI in the namespace declaration
above is also used as a prefix for URIs under the control of this
specification. For resources not under the control of this
specification, we use the designated Uniform Resource Names
[[URN](#ref-URN)] or Uniform Resource
Locators [[URL](#ref-URL)] defined by its
normative external specification. If an external specification
has not allocated itself a Uniform Resource Identifier we
allocate an identifier under our own namespace. For instance:

`SignatureProperties` is identified and defined
by this specification's namespace
http://www.w3.org/2000/09/xmldsig#SignatureProperties
XSLT is identified and
defined by an external URI
http://www.w3.org/TR/1999/REC-xslt-19991116
SHA1 is identified via this specification's namespace and
defined via a normative reference
http://www.w3.org/2000/09/xmldsig#sha1
FIPS PUB 180-2. *Secure Hash Standard.* U.S.
Department of Commerce/National Institute of Standards and
Technology.

Finally, in order to provide for terse namespace declarations
we sometimes use [XML
internal entities](https://www.w3.org/TR/REC-xml#sec-internal-ent) [[XML](#ref-XML)]
within URIs. For instance:

```

   <?xml version='1.0'?>
   <!DOCTYPE Signature SYSTEM
     "xmldsig-core-schema.dtd" [ <!ENTITY dsig
     "http://www.w3.org/2000/09/xmldsig#"> ]>
   <Signature xmlns="&dsig;" Id="MyFirstSignature">
     <SignedInfo>
     ...

```
### 1.4 Acknowledgements

The contributions of the following Working Group members to
this specification are gratefully acknowledged:

* Mark Bartel, Adobe, was Accelio (Author)
* John Boyer, IBM (Author)
* Mariano P. Consens, University of Waterloo
* John Cowan, Reuters Health
* Donald Eastlake 3rd, Motorola  (Chair,
  Author/Editor)
* Barb Fox, Microsoft (Author)
* Christian Geuer-Pollmann, University Siegen
* Tom Gindin, IBM
* Phillip Hallam-Baker, VeriSign Inc
* Richard Himes, US Courts
* Merlin Hughes, Baltimore
* Gregor Karlinger, IAIK TU Graz
* Brian LaMacchia, Microsoft (Author)
* Peter Lipp, IAIK TU Graz
* Joseph Reagle, NYU, was W3C (Chair, Author/Editor)
* Ed Simon, XMLsec (Author)
* David Solo, Citigroup (Author/Editor)
* Petteri Stenius, Capslock
* Raghavan Srinivas, Sun
* Kent Tamura, IBM
* Winchel Todd Vincent III, GSU
* Carl Wallace, Corsec Security, Inc.
* Greg Whitehead, Signio Inc.

As are the Last Call comments from the following:

* Dan Connolly, W3C
* Paul Biron, Kaiser Permanente, on behalf of the [XML Schema
  WG](https://www.w3.org/XML/Schema.html).
* Martin J. Duerst, W3C; and Masahiro Sekiguchi, Fujitsu; on
  behalf of the [Internationalization WG/IG](https://www.w3.org/International/).
* Jonathan Marsh, Microsoft, on behalf of the [Extensible
  Stylesheet Language WG](https://www.w3.org/Style/XSL/).

The following members of the XML Security Specification
Maintenance Working Group contributed to the second edition:

* Juan Carlos Cruellas, Universitat Politècnica de
  Catalunya
* Pratik Datta, Oracle Corporation
* Phillip Hallam-Baker, VeriSign, Inc.
* Frederick Hirsch, Nokia, (Chair, Editor)
* Konrad Lanz, A-SIT
* Hal Lockhart, BEA Systems, Inc.
* Robert Miller, MITRE Corporation
* Sean Mullan, Sun Microsystems, Inc.
* Bruce Rich, IBM Corporation
* Thomas Roessler, W3C/ERCIM, (Staff contact, Editor)
* Ed Simon, W3C Invited Expert
* Greg Whitehead, HP

## 2.0 Signature Overview and Examples

This section provides an overview and examples of XML digital
signature syntax. The specific processing is given in [Processing Rules](https://www.w3.org/TR/2000/WD-xmldsig-core-20000104/#sec-Processing) (section 3). The formal syntax
is found in [Core Signature
Syntax](#sec-CoreSyntax) (section 4) and [Additional Signature Syntax](#sec-AdditionalSyntax) (section 5).

In this section, an informal representation and examples
are used to describe the structure of the XML signature syntax.
This representation and examples may omit attributes, details and
potential features that are fully explained later.

XML Signatures are applied to arbitrary [digital content
(data objects)](#def-DataObject) via an indirection. Data objects are digested,
the resulting value is placed in an element (with other
information) and that element is then digested and
cryptographically signed. XML digital signatures are represented
by the `Signature` element which has the following
structure (where "?" denotes zero or one occurrence; "+" denotes
one or more occurrences; and "\*" denotes zero or more
occurrences):

```

  <Signature ID?>
     <SignedInfo>
       <CanonicalizationMethod/>
       <SignatureMethod/>
       (<Reference URI? >
         (<Transforms>)?
         <DigestMethod>
         <DigestValue>
       </Reference>)+
     </SignedInfo>
     <SignatureValue>
    (<KeyInfo>)?
    (<Object ID?>)*
   </Signature>

```

Signatures are related to [data objects](#def-DataObject) via URIs [[URI](#ref-URI)]. Within an XML document,
signatures are related to local data objects via fragment
identifiers. Such local data can be included within an [enveloping](#def-SignatureEnveloping) signature or can enclose an [enveloped](#def-SignatureEnveloped) signature. [Detached signatures](#def-SignatureDetached) are over
external network resources or local data objects that reside
within the same XML document as sibling elements; in this case,
the signature is neither enveloping (signature is parent) nor
enveloped (signature is child). Since a `Signature`
element (and its `Id` attribute value/name) may
co-exist or be combined with other elements (and their IDs)
within a single XML document, care should be taken in choosing
names such that there are no subsequent collisions that violate
the [ID
uniqueness validity constraint](https://www.w3.org/TR/REC-xml#id) [[XML](#ref-XML)].

### 2.1 Simple Example (`Signature`, `SignedInfo`, `Methods`, and `Reference`)s

The following example is a detached signature of the content
of the HTML4 in XML specification.

```

   [s01] <Signature Id="MyFirstSignature" xmlns="http://www.w3.org/2000/09/xmldsig#">
   [s02]   <SignedInfo>
   [s03]   <CanonicalizationMethod Algorithm="http://www.w3.org/2006/12/xml-c14n11"/>
   [s04]   <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1"/>
   [s05]   <Reference URI="http://www.w3.org/TR/2000/REC-xhtml1-20000126/">
   [s06]     <Transforms>
   [s07]       <Transform Algorithm="http://www.w3.org/2006/12/xml-c14n11"/>
   [s08]     </Transforms>
   [s09]     <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
   [s10]     <DigestValue>dGhpcyBpcyBub3QgYSBzaWduYXR1cmUK.../DigestValue>
   [s11]   </Reference>
   [s12] </SignedInfo>
   [s13]   <SignatureValue>...</SignatureValue>
   [s14]   <KeyInfo>
   [s15a]    <KeyValue>
   [s15b]      <DSAKeyValue>
   [s15c]        <P>...</P><Q>...</Q><G>...</G><Y>...</Y>
   [s15d]      </DSAKeyValue>
   [s15e]    </KeyValue>
   [s16]   </KeyInfo>
   [s17] </Signature>

```

`[s02-12]` The required `SignedInfo`
element is the information that is actually signed. [Core
validation](#def-ValidationCore) of `SignedInfo` consists of two
mandatory processes: [validation of the signature](#def-ValidationSignature) over
`SignedInfo` and [validation of each
`Reference`](#def-ValidationReference) digest within `SignedInfo`.
Note that the algorithms used in calculating the
`SignatureValue` are also included in the signed
information while the `SignatureValue` element is
outside `SignedInfo`.

`[s03]` The `CanonicalizationMethod` is
the algorithm that is used to canonicalize the
`SignedInfo` element before it is digested as part of
the signature operation. Note that this example, and all examples
in this specification, are not in canonical form.

`[s04]` The `SignatureMethod` is the
algorithm that is used to convert the canonicalized
`SignedInfo` into the `SignatureValue`. It
is a combination of a digest algorithm and a key dependent
algorithm and possibly other algorithms such as padding, for
example RSA-SHA1. The algorithm names are signed to resist
attacks based on substituting a weaker algorithm. To promote
application interoperability we specify a set of signature
algorithms that MUST be implemented, though their use is at the
discretion of the signature creator. We specify additional
algorithms as RECOMMENDED or OPTIONAL for implementation; the
design also permits arbitrary user specified algorithms.

`[s05-11]` Each `Reference` element
includes the digest method and resulting digest value calculated
over the identified data object. It also may include
transformations that produced the input to the digest operation.
A data object is signed by computing its digest value and a
signature over that value. The signature is later checked via
[reference](#def-ValidationReference) and [signature validation](#def-ValidationSignature).

`[s14-16]` `KeyInfo` indicates the key
to be used to validate the signature. Possible forms for
identification include certificates, key names, and key agreement
algorithms and information -- we define only a few.
`KeyInfo` is optional for two reasons. First, the
signer may not wish to reveal key information to all document
processing parties. Second, the information may be known within
the application's context and need not be represented explicitly.
Since `KeyInfo` is outside of `SignedInfo`,
if the signer wishes to bind the keying information to the
signature, a `Reference` can easily identify and
include the `KeyInfo` as part of the signature.

### 2.1.1 More on `Reference`

```

   [s05]   <Reference URI="http://www.w3.org/TR/2000/REC-xhtml1-20000126/">
   [s06]     <Transforms>
   [s07]       <Transform Algorithm="http://www.w3.org/2006/12/xml-c14n11"/>
   [s08]     </Transforms>
   [s09]     <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
   [s10]     <DigestValue>dGhpcyBpcyBub3QgYSBzaWduYXR1cmUK...</DigestValue>
   [s11]   </Reference>

```

`[s05]` The optional `URI` attribute of
`Reference` identifies the data object to be signed.
This attribute may be omitted on at most one
`Reference` in a `Signature`. (This
limitation is imposed in order to ensure that references and
objects may be matched unambiguously.)

`[s05-08]` This identification, along with the
transforms, is a description provided by the signer on how they
obtained the signed data object in the form it was digested (i.e.
the digested content). The verifier may obtain the digested
content in another method so long as the digest verifies. In
particular, the verifier may obtain the content from a different
location such as a local store than that specified in the
`URI`.

`[s06-08] Transforms` is an optional ordered list
of processing steps that were applied to the resource's content
before it was digested. Transforms can include operations such as
canonicalization, encoding/decoding (including
compression/inflation), XSLT, XPath, XML schema validation, or
XInclude. XPath transforms permit the signer to derive an XML
document that omits portions of the source document. Consequently
those excluded portions can change without affecting signature
validity. For example, if the resource being signed encloses the
signature itself, such a transform must be used to exclude the
signature value from its own computation. If no
`Transforms` element is present, the resource's
content is digested directly. While the Working Group has
specified mandatory (and optional) canonicalization and decoding
algorithms, user specified transforms are permitted.

`[s09-10] DigestMethod` is the algorithm applied to
the data after `Transforms` is applied (if specified)
to yield the `DigestValue`. The signing of the
`DigestValue` is what binds a resources content to the
signer's key.

### 2.2 Extended Example (`Object` and `SignatureProperty`)

This specification does not address mechanisms for making
statements or assertions. Instead, this document defines what it
means for something to be signed by an XML Signature ([integrity](#def-Integrity),
[message authentication](#def-AuthenticationMessage), and/or [signer
authentication](#def-AuthenticationSigner)). Applications that wish to represent other
semantics must rely upon other technologies, such as [[XML](#ref-XML), [RDF](#ref-RDF)]. For instance, an application might use a
`foo:assuredby` attribute within its own markup to
reference a `Signature` element. Consequently, it's
the application that must understand and know how to make trust
decisions given the validity of the signature and the meaning of
`assuredby` syntax. We also define a
`SignatureProperties` element type for the inclusion
of assertions about the signature itself (e.g., signature
semantics, the time of signing or the serial number of hardware
used in cryptographic processes). Such assertions may be signed
by including a `Reference` for the
`SignatureProperties` in `SignedInfo`.
While the signing application should be very careful about what
it signs (it should understand what is in the
`SignatureProperty`) a receiving application has no
obligation to understand that semantic (though its parent trust
engine may wish to). Any content about the signature generation
may be located within the `SignatureProperty` element.
The mandatory `Target` attribute references the
`Signature` element to which the property applies.

Consider the preceding example with an additional reference to
a local `Object` that includes a
`SignatureProperty` element. (Such a signature would
not only be [detached](#def-SignatureDetached) `[p02]` but [enveloping](#def-SignatureEnveloping) `[p03]`.)

```

   [   ]  <Signature Id="MySecondSignature" ...>
   [p01]  <SignedInfo>
   [   ]   ...
   [p02]   <Reference URI="http://www.w3.org/TR/xml-stylesheet/">
   [   ]   ...
   [p03]   <Reference URI="#AMadeUpTimeStamp"
   [p04]         Type="http://www.w3.org/2000/09/xmldsig#SignatureProperties">
   [p05]    <Transforms>
   [p06]      <Transform Algorithm="http://www.w3.org/2006/12/xml-c14n11"/>
   [p07]    </Transforms>
   [p08]    <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
   [p09]    <DigestValue>dGhpcyBpcyBub3QgYSBzaWduYXR1cmUK...</DigestValue>
   [p10]   </Reference>
   [p11]  </SignedInfo>
   [p12]  ...
   [p13]  <Object>
   [p14]   <SignatureProperties>
   [p15]     <SignatureProperty Id="AMadeUpTimeStamp" Target="#MySecondSignature">
   [p16]        <timestamp xmlns="http://www.ietf.org/rfcXXXX.txt">
   [p17]          <date>19990914</date>
   [p18]          <time>14:34:34:34</time>
   [p19]        </timestamp>
   [p20]     </SignatureProperty>
   [p21]   </SignatureProperties>
   [p22]  </Object>
   [p23]</Signature>

```

`[p04]` The optional `Type` attribute of
`Reference` provides information about the resource
identified by the `URI`. In particular, it can
indicate that it is an `Object`,
`SignatureProperty`, or `Manifest` element.
This can be used by applications to initiate special processing
of some `Reference` elements. References to an XML
data element within an `Object` element SHOULD
identify the actual element pointed to. Where the element content
is not XML (perhaps it is binary or encoded data) the reference
should identify the `Object` and the
`Reference` `Type`, if given, SHOULD
indicate `Object`. Note that `Type` is
advisory and no action based on it or checking of its correctness
is required by core behavior.

`[p13]` `Object` is an optional element
for including data objects within the signature element or
elsewhere. The `Object` can be optionally typed and/or
encoded.

`[p14-21]` Signature properties, such as time of
signing, can be optionally signed by identifying them from within
a `Reference`. (These properties are traditionally
called signature "attributes" although that term has no
relationship to the XML term "attribute".)

### 2.3 Extended Example (`Object` and `Manifest`)

The `Manifest` element is provided to meet
additional requirements not directly addressed by the mandatory
parts of this specification. Two requirements and the way the
`Manifest` satisfies them follow.

First, applications frequently need to efficiently sign
multiple data objects even where the signature operation itself
is an expensive public key signature. This requirement can be met
by including multiple `Reference` elements within
`SignedInfo` since the inclusion of each digest
secures the data digested. However, some applications may not
want the [core validation](#def-ValidationCore) behavior associated with this approach
because it requires every `Reference` within
`SignedInfo` to undergo [reference validation](#def-ValidationReference) -- the `DigestValue`
elements are checked. These applications may wish to reserve
reference validation decision logic to themselves. For example,
an application might receive a [signature valid](#def-ValidationSignature)
`SignedInfo` element that includes three
`Reference` elements. If a single
`Reference` fails (the identified data object when
digested does not yield the specified `DigestValue`)
the signature would fail [core validation](#def-ValidationCore). However, the
application may wish to treat the signature over the two valid
`Reference` elements as valid or take different
actions depending on which fails.  To accomplish this,
`SignedInfo` would reference a `Manifest`
element that contains one or more `Reference` elements
(with the same structure as those in `SignedInfo`).
Then, reference validation of the `Manifest` is under
application control.

Second, consider an application where many signatures (using
different keys) are applied to a large number of documents. An
inefficient solution is to have a separate signature (per key)
repeatedly applied to a large `SignedInfo` element
(with many `Reference`s); this is wasteful and
redundant. A more efficient solution is to include many
references in a single `Manifest` that is then
referenced from multiple `Signature` elements.

The example below includes a `Reference` that signs
a `Manifest` found within the `Object`
element.

```

   [   ] ...
   [m01]   <Reference URI="#MyFirstManifest"
   [m02]     Type="http://www.w3.org/2000/09/xmldsig#Manifest">
   [m03]     <Transforms>
   [m04]       <Transform Algorithm="http://www.w3.org/2006/12/xml-c14n11"/>
   [m05]     </Transforms>
   [m06]     <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
   [m07]     <DigestValue>dGhpcyBpcyBub3QgYSBzaWduYXR1cmUK...=</DigestValue>
   [m08]   </Reference>
   [   ] ...
   [m09] <Object>
   [m10]   <Manifest Id="MyFirstManifest">
   [m11]     <Reference>
   [m12]     ...
   [m13]     </Reference>
   [m14]     <Reference>
   [m15]     ...
   [m16]     </Reference>
   [m17]   </Manifest>
   [m18] </Object>

```
## 3.0 Processing Rules

The sections below describe the operations to be performed as
part of signature generation and validation.

### 3.1 Core Generation

The REQUIRED steps include the generation of
`Reference` elements and the
`SignatureValue` over `SignedInfo`.

#### 3.1.1 Reference Generation

For each data object being signed:

1. Apply the `Transforms`, as determined by the
   application, to the data object.
2. Calculate the digest value over the resulting data
   object.
3. Create a `Reference` element, including the
   (optional) identification of the data object, any (optional)
   transform elements, the digest algorithm and the
   `DigestValue`. (Note, it is the canonical form of
   these references that are signed in 3.1.2 and validated in
   3.2.1 .)

The [Reference Processing Model](#sec-ReferenceProcessingModel) (section 4.3.3.2) requires
use of Canonical XML 1.0 [[XML-C14N](#ref-XML-C14N)] as default processing behavior when a
transformation is expecting an octet-stream, but the data object
resulting from URI dereferencing or from the previous
transformation in the list of `Transform` elements is
a node-set. We RECOMMEND that, when generating signatures,
signature applications do not rely on this default behavior, but
explicitly identify the transformation that is applied to perform
this mapping. In cases in which inclusive canonicalization is
desired, we RECOMMEND that Canonical XML 1.1 [[XML-C14N11](#ref-XML-C14N11)] be used.
#### 3.1.2 Signature Generation

1. Create `SignedInfo` element with
   `SignatureMethod`,
   `CanonicalizationMethod` and
   `Reference`(s).
2. Canonicalize and then calculate the
   `SignatureValue` over `SignedInfo` based
   on algorithms specified in `SignedInfo`.
3. Construct the `Signature` element that includes
   `SignedInfo`, `Object`(s) (if desired,
   encoding may be different than that used for signing),
   `KeyInfo` (if required), and
   `SignatureValue`.

   Note, if the `Signature` includes same-document
   references, [[XML](#ref-XML)] or
   [[XML-schema](#ref-XML-schema)]
   validation of the document might introduce changes that break
   the signature. Consequently, applications should be careful
   to consistently process the document or refrain from using
   external contributions (e.g., defaults and entities).

### 3.2 Core Validation

The REQUIRED steps of [core validation](#def-ValidationCore) include (1) [reference validation](#def-ValidationReference), the verification of the digest
contained in each `Reference` in
`SignedInfo`, and (2) the cryptographic [signature validation](#def-ValidationSignature) of the signature calculated over
`SignedInfo`.

Note, there may be valid signatures that some signature
applications are unable to validate. Reasons for this include
failure to implement optional parts of this specification,
inability or unwillingness to execute specified algorithms, or
inability or unwillingness to dereference specified URIs (some
URI schemes may cause undesirable side effects), etc.

Comparison of values in reference and signature validation are
over the numeric (e.g., integer) or decoded octet sequence of the
value. Different implementations may produce different encoded
digest and signature values when processing the same resources
because of variances in their encoding, such as accidental white
space. But if one uses numeric or octet comparison (choose one)
on both the stated and computed values these problems are
eliminated.

#### 3.2.1 Reference Validation

1. Canonicalize the `SignedInfo` element based on
   the `CanonicalizationMethod` in
   `SignedInfo`.
2. For each `Reference` in `SignedInfo`:
   1. Obtain the data object to be digested. (For example,
      the signature application may dereference the
      `URI` and execute `Transforms`
      provided by the signer in the `Reference`
      element, or it may obtain the content through other means
      such as a local cache.)
   2. Digest the resulting data object using the
      `DigestMethod` specified in its
      `Reference` specification.
   3. Compare the generated digest value against
      `DigestValue` in the `SignedInfo`
      `Reference`; if there is any mismatch,
      validation fails.

Note, `SignedInfo` is canonicalized in step 1. The
application must ensure that the CanonicalizationMethod has no
dangerous side affects, such as rewriting URIs, (see
`[CanonicalizationMethod](#sec-CanonicalizationMethod-NOTE)` (section 4.3)) and that
it [Sees What is Signed](#sec-See), which
is the canonical form.

#### 3.2.2 Signature Validation

1. Obtain the keying information from `[KeyInfo](#sec-KeyInfo)` or from an
   external source.
2. Obtain the canonical form of the
   `SignatureMethod` using the
   `CanonicalizationMethod` and use the result
   (and previously obtained `KeyInfo`) to confirm the
   `SignatureValue` over the `SignedInfo`
   element.

Note, `[KeyInfo](#sec-KeyInfo)` (or some transformed version thereof)
may be signed via a `Reference` element.
Transformation and validation of this reference (3.2.1) is
orthogonal to Signature Validation which uses the
`KeyInfo` as parsed.

Additionally, the `SignatureMethod` URI may have
been altered by the canonicalization of `SignedInfo`
(e.g., absolutization of relative URIs) and it is the canonical
form that MUST be used. However, the required canonicalization
[[XML-C14N](#ref-XML-C14N)] of this
specification does not change URIs.

## 4.0 Core Signature Syntax

The general structure of an XML signature is described in
[Signature Overview](#sec-Overview)
(section 2). This section provides detailed syntax of the core
signature features. Features described in this section are
mandatory to implement unless otherwise indicated. The syntax is
defined via DTDs and [[XML-Schema](#ref-XML-schema)] with the following XML preamble,
declaration, and internal entity.

```

   Schema Definition:

   <?xml version="1.0" encoding="utf-8"?>
   <!DOCTYPE schema
     PUBLIC "-//W3C//DTD XMLSchema 200102//EN" "http://www.w3.org/2001/XMLSchema.dtd"
    [
      <!ATTLIST schema
        xmlns:ds CDATA #FIXED "http://www.w3.org/2000/09/xmldsig#">
      <!ENTITY dsig 'http://www.w3.org/2000/09/xmldsig#'>
      <!ENTITY % p ''>
      <!ENTITY % s ''>
     ]>

   <schema xmlns="http://www.w3.org/2001/XMLSchema"
           xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
           targetNamespace="http://www.w3.org/2000/09/xmldsig#"
           version="0.1" elementFormDefault="qualified">

```
```

   DTD:

   <!--

   The following entity declarations enable external/flexible content in
   the Signature content model.

   #PCDATA emulates schema:string; when combined with element types it
   emulates schema mixed="true".

   %foo.ANY permits the user to include their own element types from
   other namespaces, for example:
     <!ENTITY % KeyValue.ANY '| ecds:ECDSAKeyValue'>
     ...
     <!ELEMENT ecds:ECDSAKeyValue (#PCDATA)  >

   -->

   <!ENTITY % Object.ANY ''>
   <!ENTITY % Method.ANY ''>
   <!ENTITY % Transform.ANY ''>
   <!ENTITY % SignatureProperty.ANY ''>
   <!ENTITY % KeyInfo.ANY ''>
   <!ENTITY % KeyValue.ANY ''>
   <!ENTITY % PGPData.ANY ''>
   <!ENTITY % X509Data.ANY ''>
   <!ENTITY % SPKIData.ANY ''>

```
#### 4.0.1 The ds:CryptoBinary Simple Type

This specification defines the `ds:CryptoBinary`
simple type for representing arbitrary-length integers (e.g.
"bignums") in XML as octet strings. The integer value is first
converted to a "big endian" bitstring. The bitstring is then
padded with leading zero bits so that the total number of bits ==
0 mod 8 (so that there are an integral number of octets). If the
bitstring contains entire leading octets that are zero, these are
removed (so the high-order octet is always non-zero). This octet
string is then base64 [[MIME](#ref-MIME)]
encoded. (The conversion from integer to octet string is
equivalent to IEEE 1363's I2OSP [[1363](#ref-1363)] with minimal length).

This type is used by "bignum" values such as
`RSAKeyValue` and `DSAKeyValue`. If a value
can be of type `base64Binary` or
`ds:CryptoBinary` they are defined as [`base64Binary`](https://www.w3.org/TR/xmlschema-2/#base64Binary). For example, if the
signature algorithm is RSA or DSA then
`SignatureValue` represents a bignum and could be
`ds:CryptoBinary`. However, if HMAC-SHA1 is the
signature algorithm then `SignatureValue` could have
leading zero octets that must be preserved. Thus
`SignatureValue` is generically defined as of type
`base64Binary`.

```

   Schema Definition:

   <simpleType name="CryptoBinary">
     <restriction base="base64Binary">
     </restriction>
   </simpleType>

```
### 4.1 The `Signature` element

The `Signature` element is the root element of an
XML Signature. Implementation MUST generate [laxly schema valid](https://www.w3.org/TR/2000/WD-xmlschema-1-20000407/#cvc-elt-lax) [[XML-schema](#ref-XML-schema)] `Signature` elements as
specified by the following schema:

```

   Schema Definition:

   <element name="Signature" type="ds:SignatureType"/>
   <complexType name="SignatureType">
     <sequence>
       <element ref="ds:SignedInfo"/>
       <element ref="ds:SignatureValue"/>
       <element ref="ds:KeyInfo" minOccurs="0"/>
       <element ref="ds:Object" minOccurs="0" maxOccurs="unbounded"/>
     </sequence>
     <attribute name="Id" type="ID" use="optional"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT Signature (SignedInfo, SignatureValue, KeyInfo?, Object*)  >
   <!ATTLIST Signature
    xmlns   CDATA   #FIXED 'http://www.w3.org/2000/09/xmldsig#'
    Id      ID  #IMPLIED >

```
### 4.2 The `SignatureValue` Element

The `SignatureValue` element contains the actual
value of the digital signature; it is always encoded using base64
[[MIME](#ref-MIME)]. While we identify
two `SignatureMethod` algorithms, one mandatory and
one optional to implement, user specified algorithms may be used
as well.

```

   Schema Definition:

   <element name="SignatureValue" type="ds:SignatureValueType"/>
   <complexType name="SignatureValueType">
     <simpleContent>
       <extension base="base64Binary">
         <attribute name="Id" type="ID" use="optional"/>
       </extension>
     </simpleContent>
   </complexType>

```
```

   DTD:

   <!ELEMENT SignatureValue (#PCDATA) >
   <!ATTLIST SignatureValue
             Id  ID      #IMPLIED>

```
### 4.3 The `SignedInfo` Element

The structure of `SignedInfo` includes the
canonicalization algorithm, a signature algorithm, and one or
more references. The `SignedInfo` element may contain
an optional ID attribute that will allow it to be referenced by
other signatures and objects.

`SignedInfo` does not include explicit signature or
digest properties (such as calculation time, cryptographic device
serial number, etc.). If an application needs to associate
properties with the signature or digest, it may include such
information in a `SignatureProperties` element within
an `Object` element.

```

   Schema Definition:

   <element name="SignedInfo" type="ds:SignedInfoType"/>
   <complexType name="SignedInfoType">
     <sequence>
       <element ref="ds:CanonicalizationMethod"/>
       <element ref="ds:SignatureMethod"/>
       <element ref="ds:Reference" maxOccurs="unbounded"/>
     </sequence>
     <attribute name="Id" type="ID" use="optional"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT SignedInfo (CanonicalizationMethod,
    SignatureMethod,  Reference+)  >
   <!ATTLIST SignedInfo
    Id   ID      #IMPLIED

```
#### 4.3.1 The `CanonicalizationMethod` Element

`CanonicalizationMethod` is a required element that
specifies the canonicalization algorithm applied to the
`SignedInfo` element prior to performing signature
calculations. This element uses the general structure for
algorithms described in [Algorithm Identifiers and Implementation Requirements](#sec-AlgID)
(section 6.1). Implementations MUST support the REQUIRED [canonicalization algorithms](#sec-c14nAlg).

Alternatives to the REQUIRED [canonicalization algorithms](#sec-c14nAlg) (section 6.5), such as
[Canonical XML with
Comments](#sec-Canonical) (section 6.5.1) or a minimal canonicalization (such
as CRLF and charset normalization), may be explicitly specified
but are NOT REQUIRED. Consequently, their use may not
interoperate with other applications that do not support the
specified algorithm (see [XML Canonicalization and Syntax Constraint
Considerations](#sec-XML-Canonicalization), section 7). Security issues may also arise in
the treatment of entity processing and comments if non-XML aware
canonicalization algorithms are not properly constrained (see
section 8.2: [Only What is "Seen"
Should be Signed](#sec-Seen)).

The way in which the `SignedInfo` element is
presented to the canonicalization method is dependent on that
method. The following applies to algorithms which process XML as
nodes or characters:

* XML based canonicalization implementations MUST be provided
  with a [[XPath](#ref-XPath)] node-set
  originally formed from the document containing the
  `SignedInfo` and currently indicating the
  `SignedInfo`, its descendants, and the attribute and
  namespace nodes of `SignedInfo` and its descendant
  elements.
* Text based canonicalization algorithms (such as CRLF and
  charset normalization) should be provided with the UTF-8 octets
  that represent the well-formed SignedInfo element, from the
  first character to the last character of the XML
  representation, inclusive. This includes the entire text of the
  start and end tags of the SignedInfo element as well as all
  descendant [markup and character data](https://www.w3.org/TR/1998/REC-xml-19980210#syntax) (i.e., the [text](https://www.w3.org/TR/1998/REC-xml-19980210#dt-text)) between those tags. Use of text based
  canonicalization of SignedInfo is NOT RECOMMENDED.

We recommend applications that implement a text-based instead
of XML-based canonicalization -- such as resource constrained
apps -- generate canonicalized XML as their output serialization
so as to mitigate interoperability and security concerns. For
instance, such an implementation SHOULD (at least) generate
[standalone](https://www.w3.org/TR/REC-xml#sec-rmd) XML instances [[XML](#ref-XML)].

NOTE: The
signature application must exercise great care in accepting and
executing an arbitrary `CanonicalizationMethod`. For
example, the canonicalization method could rewrite the URIs of
the `Reference`s being validated. Or, the method could
massively transform `SignedInfo` so that validation
would always succeed (i.e., converting it to a trivial signature
with a known key over trivial data). Since
`CanonicalizationMethod` is inside
`SignedInfo`, in the resulting canonical form it could
erase itself from `SignedInfo` or modify the
`SignedInfo` element so that it appears that a
different canonicalization function was used! Thus a
`Signature` which appears to authenticate the desired
data with the desired key, `DigestMethod`, and
`SignatureMethod`, can be meaningless if a capricious
`CanonicalizationMethod` is used.

```

   Schema Definition:

   <element name="CanonicalizationMethod" type="ds:CanonicalizationMethodType"/>
   <complexType name="CanonicalizationMethodType" mixed="true">
     <sequence>
       <any namespace="##any" minOccurs="0" maxOccurs="unbounded"/>
       <!-- (0,unbounded) elements from (1,1) namespace -->
     </sequence>
     <attribute name="Algorithm" type="anyURI" use="required"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT CanonicalizationMethod (#PCDATA %Method.ANY;)* >
   <!ATTLIST CanonicalizationMethod
    Algorithm CDATA #REQUIRED >

```
#### 4.3.2 The `SignatureMethod` Element

`SignatureMethod` is a required element that
specifies the algorithm used for signature generation and
validation. This algorithm identifies all cryptographic functions
involved in the signature operation (e.g. hashing, public key
algorithms, MACs, padding, etc.). This element uses the general
structure here for algorithms described in section 6.1: [Algorithm Identifiers and
Implementation Requirements](#sec-AlgID). While there is a single
identifier, that identifier may specify a format containing
multiple distinct signature values.

```

   Schema Definition:

   <element name="SignatureMethod" type="ds:SignatureMethodType"/>
   <complexType name="SignatureMethodType" mixed="true">
     <sequence>
       <element name="HMACOutputLength" minOccurs="0" type="ds:HMACOutputLengthType"/>
       <any namespace="##other" minOccurs="0" maxOccurs="unbounded"/>
       <!-- (0,unbounded) elements from (1,1) external namespace -->
      </sequence>
    <attribute name="Algorithm" type="anyURI" use="required"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT SignatureMethod (#PCDATA|HMACOutputLength %Method.ANY;)* >
   <!ATTLIST SignatureMethod
    Algorithm CDATA #REQUIRED >

```
#### 4.3.3 The `Reference` Element

`Reference` is an element that may occur one or
more times. It specifies a digest algorithm and digest value, and
optionally an identifier of the object being signed, the type of
the object, and/or a list of transforms to be applied prior to
digesting. The identification (URI) and transforms describe how
the digested content (i.e., the input to the digest method) was
created. The `Type` attribute facilitates the
processing of referenced data. For example, while this
specification makes no requirements over external data, an
application may wish to signal that the referent is a
`Manifest`. An optional ID attribute permits a
`Reference` to be referenced from elsewhere.

```

   Schema Definition:

   <element name="Reference" type="ds:ReferenceType"/>
   <complexType name="ReferenceType">
     <sequence>
       <element ref="ds:Transforms" minOccurs="0"/>
       <element ref="ds:DigestMethod"/>
       <element ref="ds:DigestValue"/>
     </sequence>
     <attribute name="Id" type="ID" use="optional"/>
     <attribute name="URI" type="anyURI" use="optional"/>
     <attribute name="Type" type="anyURI" use="optional"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT Reference (Transforms?, DigestMethod, DigestValue)  >
   <!ATTLIST Reference
    Id  ID  #IMPLIED
    URI CDATA   #IMPLIED
    Type    CDATA   #IMPLIED>

```
#### 4.3.3.1 The `URI` Attribute

The `URI` attribute identifies a data object using
a URI-Reference [[URI](#ref-URI)].

The mapping from this attribute's value to a URI reference
MUST be performed as specified in section 3.2.17 of [[XMLSCHEMA Datatypes, 2nd
Edition](#ref-XML-schema)]. Additionally: Some existing implementations are
known to verify the value of the URI attribute against the
grammar in [[URI](#ref-URI)]. It is
therefore safest to perform any necessary escaping while
generating the URI attribute.

We RECOMMEND XML signature applications be able to dereference
URIs in the HTTP scheme. Dereferencing a URI in the HTTP scheme
MUST comply with the [Status Code Definitions](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.4) of [[HTTP](#ref-HTTP)] (e.g., 302, 305 and 307 redirects are
followed to obtain the entity-body of a 200 status code
response). Applications should also be cognizant of the fact that
protocol parameter and state information, (such as HTTP cookies,
HTML device profiles or content negotiation), may affect the
content yielded by dereferencing a URI.

If a resource is identified by more than one URI, the most
specific should be used (e.g.
http://www.w3.org/2000/06/interop-pressrelease.html.en instead of
http://www.w3.org/2000/06/interop-pressrelease). (See the
[Reference
Validation](#sec-CoreValidation) (section 3.2.1) for a further information on
reference processing.)

If the `URI` attribute is omitted altogether, the
receiving application is expected to know the identity of the
object. For example, a lightweight data protocol might omit this
attribute given the identity of the object is part of the
application context. This attribute may be omitted from at most
one `Reference` in any particular
`SignedInfo`, or `Manifest`.

The optional Type attribute contains information about the
type of object being signed after all `ds:Reference`
transforms have been applied. This is represented as a URI. For
example:

`Type=["http://www.w3.org/2000/09/xmldsig#Object"](https://www.w3.org/2000/09/xmldsig#Object)

Type=["http://www.w3.org/2000/09/xmldsig#Manifest"](https://www.w3.org/2000/09/xmldsig#Manifest)`

The Type attribute applies to the item being pointed at, not
its contents. For example, a reference that results in the
digesting of an `Object` element containing a
`SignatureProperties` element is still of type
`#Object`. The type attribute is advisory. No
validation of the type information is required by this
specification.

#### 4.3.3.2 The Reference Processing Model

Note: XPath is RECOMMENDED. Signature applications
need not conform to [[XPath](#ref-XPath)]
specification in order to conform to this specification. However,
the XPath data model, definitions (e.g., [node-sets](https://www.w3.org/TR/xpath#node-sets)) and syntax is used within this document in
order to describe functionality for those that want to process
XML-as-XML (instead of octets) as part of signature generation.
For those that want to use these features, a conformant [[XPath](#ref-XPath)] implementation is one way to
implement these features, but it is not required. Such
applications could use a sufficiently functional replacement to a
node-set and implement only those XPath expression behaviors
REQUIRED by this specification. However, for simplicity we
generally will use XPath terminology without including this
qualification on every point. Requirements over "XPath node-sets"
can include a node-set functional equivalent. Requirements over
XPath processing can include application behaviors that are
equivalent to the corresponding XPath behavior.

The data-type of the result of URI dereferencing or subsequent
Transforms is either an octet stream or an XPath node-set.

The `Transforms` specified in this document are
defined with respect to the input they require. The following is
the default signature application behavior:

* If the data object is an octet stream and the next
  transform requires a node-set, the signature application MUST
  attempt to parse the octets yielding the required node-set via
  [[XML](#ref-XML)] well-formed
  processing.
* If the data object is a node-set and the next transform
  requires octets, the signature application MUST attempt to
  convert the node-set to an octet stream using Canonical XML
  [[XML-C14N](#ref-XML-C14N)].

Users may specify alternative transforms that override these
defaults in transitions between transforms that expect different
inputs. The final octet stream contains the data octets being
secured. The digest algorithm specified by
`DigestMethod` is then applied to these data octets,
resulting in the `DigestValue`.

**Note:** The [Reference Generation Model](#sec-ReferenceGeneration) (section 3.1.1)
includes further restrictions on the reliance upon defined
default transformations when applications generate
signatures.

In this specification, a 'same-document' reference is defined
as a URI-Reference that consists of a hash sign ('#') followed by
a fragment or alternatively consists of an empty URI [[URI](#ref-URI)].

Unless the URI-Reference is such a 'same-document' reference ,
the result of dereferencing the URI-Reference MUST be an octet
stream. In particular, an XML document identified by URI is not
parsed by the signature application unless the URI is a
same-document reference or unless a transform that requires XML
parsing is applied. (See [Transforms](#sec-Transforms) (section 4.3.3.1).)

When a fragment is preceded by an absolute or relative URI in
the URI-Reference, the meaning of the fragment is defined by the
resource's MIME type. Even for XML documents, URI dereferencing
(including the fragment processing) might be done for the
signature application by a proxy. Therefore, reference validation
might fail if fragment processing is not performed in a standard
way (as defined in the following section for same-document
references). Consequently, we RECOMMEND in this case that the
`URI`  attribute not include fragment identifiers
and that such processing be specified as an additional [XPath Transform](#sec-XPath).

When a fragment is not preceded by a URI in the URI-Reference,
XML Signature applications MUST support the null URI and
shortname XPointer [[XPointer-Framework](#ref-XPointer-Framework)]. We RECOMMEND support for the
same-document XPointers '`#xpointer(/)`' and
'`#xpointer(id('ID'))`' if the application also
intends to support any [canonicalization](#sec-Canonical) that preserves comments. (Otherwise
`URI="#foo"` will automatically remove comments before
the canonicalization can even be invoked due to the processing
defined in [Same-Document URI-References](#sec-Same-Document) (section 4.3.3.3).) All
other support for XPointers is OPTIONAL, especially all support
for shortname and other XPointers in external resources since the
application may not have control over how the fragment is
generated (leading to interoperability problems and validation
failures).

'`#xpointer(/)`' MUST be interpreted to identify
the root node [[XPath](#ref-XPath)] of
the document that contains the `URI` attribute.

'`#xpointer(id('ID'))`' MUST be
interpreted to identify the element node identified by
'`#element(ID)`' [[XPointer-Element](#ref-XPointer-Element)] when
evaluated with respect to the document that contains the
`URI` attribute.

The original edition of this specification [[XMLDSIG-2002](#ref-XMLDSIG-2002)] referenced the
XPointer Candidate Recommendation [[XPTR-2001](#ref-XPTR-2001)] and some implementations support it
optionally. That Candidate Recommendation has been superseded by
the [[XPointer-Framework](#ref-XPointer-Framework)], [[XPointer-xmlns](#ref-XPointer-xmlns)] and [[XPointer-Element](#ref-XPointer-Element)]
Recommendations, and -- at the time of this edition -- the
[[XPointer-xpointer](#ref-XPointer-xpointer)] Working Draft. Therefore, the use
of the `xpointer()` scheme [[XPointer-xpointer](#ref-XPointer-xpointer)]
beyond the usage discussed in this section is discouraged.

The following examples demonstrate what the URI attribute
identifies and how it is dereferenced:

`URI="http://example.com/bar.xml"`
Identifies the octets that represent the external resource
'http://example.com/bar.xml', that is probably an XML document
given its file extension.
`URI="http://example.com/bar.xml#chapter1"`
Identifies the element with ID attribute value 'chapter1'
of the external XML resource 'http://example.com/bar.xml',
provided as an octet stream. Again, for the sake of
interoperability, the element identified as 'chapter1' should
be obtained using an XPath transform rather than a URI fragment
(shortname XPointer resolution in external resources is not
REQUIRED in this specification).
`URI=""`
Identifies the node-set (minus any comment nodes) of the
XML resource containing the signature
`URI="#chapter1"`
Identifies a node-set containing the element with ID
attribute value 'chapter1' of the XML resource containing the
signature. XML Signature (and its applications) modify this
node-set to include the element plus all descendants including
namespaces and attributes -- but not comments.
#### 4.3.3.3 Same-Document URI-References

Dereferencing a same-document reference MUST result in an
XPath node-set suitable for use by Canonical XML [[XML-C14N](#ref-XML-C14N)]. Specifically,
dereferencing a null URI (`URI=""`) MUST result in an
XPath node-set that includes every non-comment node of the XML
document containing the `URI` attribute. In a fragment
URI, the characters after the number sign ('#') character conform
to the XPointer syntax [[XPointer-Framework](#ref-XPointer-Framework)]. When processing an XPointer, the
application MUST behave as if the XPointer was evaluated with
respect to the XML document containing the `URI`
attribute . The application MUST behave as if the result of
XPointer processing [[XPointer-Framework](#ref-XPointer-Framework)] were a node-set derived from the
resultant subresource as follows:

1. include XPath nodes having full or partial content within
   the subresource
2. replace the root node with its children (if it is in the
   node-set)
3. replace any element node **E** with
   **E** plus all descendants of **E**
   (text, comment, PI, element) and all namespace and attribute
   nodes of **E** and its descendant elements.
4. if the URI has no fragment identifier or the fragment
   identifier is a shortname XPointer, then delete all comment
   nodes

The second to last replacement is necessary because XPointer
typically indicates a subtree of an XML document's parse tree
using just the element node at the root of the subtree, whereas
Canonical XML treats a node-set as a set of nodes in which
absence of descendant nodes results in absence of their
representative text from the canonical form.

The last step is performed for null URIs and shortname
XPointers . It is necessary because when [[XML-C14N](#ref-XML-C14N)] or [[XML-C14N11](#ref-XML-C14N11)] is passed a node-set, it processes the
node-set as is: with or without comments. Only when it is called
with an octet stream does it invoke its own XPath expressions
(default or without comments). Therefore to retain the default
behavior of stripping comments when passed a node-set, they are
removed in the last step if the URI is not a scheme-based
XPointer. To retain comments while selecting an element by an
identifier *ID*, use the following scheme-based XPointer:
`URI='#xpointer(id('ID'))'`. To retain
comments while selecting the entire document, use the following
scheme-based XPointer: `URI='#xpointer(/)'`.

The interpretation of these XPointers is defined in [The Reference
Processing Model](#sec-ReferenceProcessingModel) (section 4.3.3.2).

#### 4.3.3.4 The `Transforms` Element

The optional `Transforms` element contains an
ordered list of `Transform` elements; these describe
how the signer obtained the data object that was digested. The
output of each `Transform` serves as input to the next
`Transform`. The input to the first
`Transform` is the result of dereferencing the
`URI` attribute of the `Reference` element.
The output from the last `Transform` is the input for
the `DigestMethod` algorithm. When transforms are
applied the signer is not signing the native (original) document
but the resulting (transformed) document. (See [Only What is Signed is Secure](#sec-Secure)
(section 8.1).)

Each `Transform` consists of an
`Algorithm` attribute and content parameters, if any,
appropriate for the given algorithm. The `Algorithm`
attribute value specifies the name of the algorithm to be
performed, and the `Transform` content provides
additional data to govern the algorithm's processing of the
transform input. (See [Algorithm
Identifiers and Implementation Requirements](#sec-AlgID) (section 6).)

As described in [The Reference Processing Model](#sec-ReferenceProcessingModel) (section
4.3.3.2), some transforms take an XPath node-set as input, while
others require an octet stream. If the actual input matches the
input needs of the transform, then the transform operates on the
unaltered input. If the transform input requirement differs from
the format of the actual input, then the input must be
converted.

Some `Transform`s may require explicit MIME type,
charset (IANA registered "character set"), or other such
information concerning the data they are receiving from an
earlier `Transform` or the source data, although no
`Transform` algorithm specified in this document needs
such explicit information. Such data characteristics are provided
as parameters to the `Transform` algorithm and should
be described in the specification for the algorithm.

Examples of transforms include but are not limited to base64
decoding [[MIME](#ref-MIME)],
canonicalization [[XML-C14N](#ref-XML-C14N)], XPath filtering [[XPath](#ref-XPath)], and XSLT [[XSLT](#ref-XSLT)]. The generic definition of the
`Transform` element also allows application-specific
transform algorithms. For example, the transform could be a
decompression routine given by a Java class appearing as a base64
encoded parameter to a Java `Transform` algorithm.
However, applications should refrain from using
application-specific transforms if they wish their signatures to
be verifiable outside of their application domain. [Transform Algorithms](#sec-TransformAlg)
(section 6.6) defines the list of standard transformations.

```

   Schema Definition:

   <element name="Transforms" type="ds:TransformsType"/>
   <complexType name="TransformsType">
     <sequence>
       <element ref="ds:Transform" maxOccurs="unbounded"/>
     </sequence>
   </complexType>

   <element name="Transform" type="ds:TransformType"/>
   <complexType name="TransformType" mixed="true">
     <choice minOccurs="0" maxOccurs="unbounded">
       <any namespace="##other" processContents="lax"/>
       <!-- (1,1) elements from (0,unbounded) namespaces -->
       <element name="XPath" type="string"/>
     </choice>
     <attribute name="Algorithm" type="anyURI" use="required"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT Transforms (Transform+)>

   <!ELEMENT Transform (#PCDATA|XPath %Transform.ANY;)* >
   <!ATTLIST Transform
    Algorithm    CDATA    #REQUIRED >

   <!ELEMENT XPath (#PCDATA) >

```
#### 4.3.3.5 The `DigestMethod` Element

`DigestMethod` is a required element that
identifies the digest algorithm to be applied to the signed
object. This element uses the general structure here for
algorithms specified in [Algorithm Identifiers and Implementation Requirements](#sec-AlgID)
(section 6.1).

If the result of the URI dereference and application of
Transforms is an XPath node-set (or sufficiently functional
replacement implemented by the application) then it must be
converted as described in [the Reference Processing Model](#sec-ReferenceProcessingModel) (section
4.3.3.2). If the result of URI dereference and application of
transforms is an octet stream, then no conversion occurs
(comments might be present if the Canonical XML with Comments was
specified in the Transforms). The digest algorithm is applied to
the data octets of the resulting octet stream.

```

   Schema Definition:

   <element name="DigestMethod" type="ds:DigestMethodType"/>
   <complexType name="DigestMethodType" mixed="true">
     <sequence>
       <any namespace="##other" processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
     </sequence>
     <attribute name="Algorithm" type="anyURI" use="required"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT DigestMethod (#PCDATA %Method.ANY;)* >
   <!ATTLIST DigestMethod
    Algorithm       CDATA   #REQUIRED >

```
#### 4.3.3.6 The `DigestValue` Element

DigestValue is an element that contains the encoded value of
the digest. The digest is always encoded using base64 [[MIME](#ref-MIME)].

```

   Schema Definition:

   <element name="DigestValue" type="ds:DigestValueType"/>
   <simpleType name="DigestValueType">
     <restriction base="base64Binary"/>
   </simpleType>

```
```

   DTD:

   <!ELEMENT DigestValue  (#PCDATA)  >
   <!-- base64 encoded digest value -->

```
### 4.4 The `KeyInfo` Element

`KeyInfo` is an optional element that enables the
recipient(s) to obtain the key needed to validate the
signature.  `KeyInfo` may contain keys, names,
certificates and other public key management information, such as
in-band key distribution or key agreement data. This
specification defines a few simple types but applications may
extend those types or all together replace them with their own
key identification and exchange semantics using the XML namespace
facility. [[XML-ns](#ref-XML-ns)]
However, questions of trust of such key information (e.g., its
authenticity or  strength) are out of scope of this
specification and left to the application.

If `KeyInfo` is omitted, the recipient is expected
to be able to identify the key based on application context.
Multiple declarations within `KeyInfo` refer to the
same key. While applications may define and use any mechanism
they choose through inclusion of elements from a different
namespace, compliant versions MUST implement [`KeyValue`](#sec-KeyValue) (section
4.4.2) and SHOULD implement `[RetrievalMethod](#sec-RetrievalMethod)` (section 4.4.3).

The schema/DTD specifications of many of
`KeyInfo`'s children (e.g., `PGPData`,
`SPKIData`, `X509Data`) permit their
content to be extended/complemented with elements from another
namespace. This may be done only if it is safe to ignore these
extension elements while claiming support for the types defined
in this specification. Otherwise, external elements, including
*alternative* structures to those defined by this
specification, MUST be a child of `KeyInfo`. For
example, should a complete XML-PGP standard be defined, its root
element MUST be a child of `KeyInfo`. (Of course, new
structures from external namespaces can incorporate elements from
the `&dsig;` namespace via features of the type
definition language. For instance, they can create a DTD that
mixes their own and dsig qualified elements, or a schema that
permits, includes, imports, or derives new types based on
`&dsig;` elements.)

The following list summarizes the `KeyInfo` types
that are allocated an identifier in the `&dsig;`
namespace; these can be used within the
`RetrievalMethod` `Type` attribute to
describe a remote `KeyInfo` structure.

* [http://www.w3.org/2000/09/xmldsig#DSAKeyValue](https://www.w3.org/2000/09/xmldsig#DSAKeyValue)
* [http://www.w3.org/2000/09/xmldsig#RSAKeyValue](https://www.w3.org/2000/09/xmldsig#RSAKeyValue)
* [http://www.w3.org/2000/09/xmldsig#X509Data](https://www.w3.org/2000/09/xmldsig#X509Data)
* [http://www.w3.org/2000/09/xmldsig#PGPData](https://www.w3.org/2000/09/xmldsig#PGPData)
* [http://www.w3.org/2000/09/xmldsig#SPKIData](https://www.w3.org/2000/09/xmldsig#SPKIData)
* [http://www.w3.org/2000/09/xmldsig#MgmtData](https://www.w3.org/2000/09/xmldsig#MgmtData)

In addition to the types above for which we define an XML
structure, we specify one additional type to indicate a binary
(ASN.1 DER) X.509 Certificate.

* [http://www.w3.org/2000/09/xmldsig#rawX509Certificate](https://www.w3.org/2000/09/xmldsig#rawX509Certificate)

```

   Schema Definition:

   <element name="KeyInfo" type="ds:KeyInfoType"/>
   <complexType name="KeyInfoType" mixed="true">
     <choice maxOccurs="unbounded">
       <element ref="ds:KeyName"/>
       <element ref="ds:KeyValue"/>
       <element ref="ds:RetrievalMethod"/>
       <element ref="ds:X509Data"/>
       <element ref="ds:PGPData"/>
       <element ref="ds:SPKIData"/>
       <element ref="ds:MgmtData"/>
       <any processContents="lax" namespace="##other"/>
       <!-- (1,1) elements from (0,unbounded) namespaces -->
     </choice>
     <attribute name="Id" type="ID" use="optional"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT KeyInfo (#PCDATA|KeyName|KeyValue|RetrievalMethod|
               X509Data|PGPData|SPKIData|MgmtData %KeyInfo.ANY;)* >
   <!ATTLIST KeyInfo
    Id  ID   #IMPLIED >

```
#### 4.4.1 The `KeyName` Element

The `KeyName` element contains a string value (in
which white space is significant) which may be used by the signer
to communicate a key identifier to the recipient. Typically,
`KeyName` contains an identifier related to the key
pair used to sign the message, but it may contain other
protocol-related information that indirectly identifies a key
pair. (Common uses of `KeyName` include simple string
names for keys, a key index, a distinguished name (DN), an email
address, etc.)

```

   Schema Definition:

   <element name="KeyName" type="string"/>

```
```

   DTD:

   <!ELEMENT KeyName (#PCDATA) >

```
#### 4.4.2 The `KeyValue` Element

The `KeyValue` element contains a single public key
that may be useful in validating the signature. Structured
formats for defining DSA (REQUIRED) and RSA (RECOMMENDED) public
keys are defined in [Signature Algorithms](#sec-SignatureAlg) (section 6.4). The
`KeyValue` element may include externally defined
public keys values represented as PCDATA or element types from an
external namespace.

```

   Schema Definition:

   <element name="KeyValue" type="ds:KeyValueType"/>
   <complexType name="KeyValueType" mixed="true">
    <choice>
      <element ref="ds:DSAKeyValue"/>
      <element ref="ds:RSAKeyValue"/>
      <any namespace="##other" processContents="lax"/>
    </choice>
   </complexType>

```
```

   DTD:

   <!ELEMENT KeyValue (#PCDATA|DSAKeyValue|RSAKeyValue %KeyValue.ANY;)* >

```
#### 4.4.2.1 The `DSAKeyValue` Element

Identifier
`Type="[http://www.w3.org/2000/09/xmldsig#DSAKeyValue](https://www.w3.org/2000/09/xmldsig#DSAKeyValue)"` (this can be used within a `RetrievalMethod`
or `Reference` element to identify the referent's
type)

DSA keys and the DSA signature algorithm are specified in
[DSS]. DSA public key values can have the following fields:

`P`
a prime modulus meeting the [DSS] requirements
`Q`
an integer in the range 2\*\*159 < Q < 2\*\*160 which is
a prime divisor of P-1
`G`
an integer with certain properties with respect to P and
Q
`Y`
G\*\*X mod P (where X is part of the private key and not made
public)
`J`
(P - 1) / Q
`seed`
a DSA prime generation seed
`pgenCounter`
a DSA prime generation counter

Parameter J is available for inclusion solely for efficiency
as it is calculatable from P and Q. Parameters seed and
pgenCounter are used in the DSA prime number generation algorithm
specified in [DSS]. As such, they are optional but must either
both be present or both be absent. This prime generation
algorithm is designed to provide assurance that a weak prime is
not being used and it yields a P and Q value. Parameters P, Q,
and G can be public and common to a group of users. They might be
known from application context. As such, they are optional but P
and Q must either both appear or both be absent. If all of
`P`, `Q`, `seed`, and
`pgenCounter` are present, implementations are not
required to check if they are consistent and are free to use
either `P` and `Q` or `seed` and
`pgenCounter`. All parameters are encoded as base64
[[MIME](#ref-MIME)] values.

Arbitrary-length integers (e.g. "bignums" such as RSA moduli)
are represented in XML as octet strings as defined by the
[`ds:CryptoBinary` type](#sec-CryptoBinary).

```

   Schema Definition:

   <element name="DSAKeyValue" type="ds:DSAKeyValueType"/>
   <complexType name="DSAKeyValueType">
     <sequence>
       <sequence minOccurs="0">
         <element name="P" type="ds:CryptoBinary"/>
         <element name="Q" type="ds:CryptoBinary"/>
       </sequence>
       <element name="G" type="ds:CryptoBinary" minOccurs="0"/>
       <element name="Y" type="ds:CryptoBinary"/>
       <element name="J" type="ds:CryptoBinary" minOccurs="0"/>
       <sequence minOccurs="0">
         <element name="Seed" type="ds:CryptoBinary"/>
         <element name="PgenCounter" type="ds:CryptoBinary"/>
       </sequence>
     </sequence>
   </complexType>

```
```

   DTD Definition:

   <!ELEMENT DSAKeyValue ((P, Q)?, G?, Y, J?, (Seed, PgenCounter)?) >
   <!ELEMENT P (#PCDATA) >
   <!ELEMENT Q (#PCDATA) >
   <!ELEMENT G (#PCDATA) >
   <!ELEMENT Y (#PCDATA) >
   <!ELEMENT J (#PCDATA) >
   <!ELEMENT Seed (#PCDATA) >
   <!ELEMENT PgenCounter (#PCDATA) >

```
#### 4.4.2.2 The `RSAKeyValue` Element

Identifier
`Type="[http://www.w3.org/2000/09/xmldsig#RSAKeyValue](https://www.w3.org/2000/09/xmldsig#RSAKeyValue)"` (this can be used within a `RetrievalMethod`
or `Reference` element to identify the referent's
type)

RSA key values have two fields: Modulus and Exponent.

```

   <RSAKeyValue>
     <Modulus>xA7SEU+e0yQH5rm9kbCDN9o3aPIo7HbP7tX6WOocLZAtNfyxSZDU16ksL6W
      jubafOqNEpcwR3RdFsT7bCqnXPBe5ELh5u4VEy19MzxkXRgrMvavzyBpVRgBUwUlV
      5foK5hhmbktQhyNdy/6LpQRhDUDsTvK+g9Ucj47es9AQJ3U=
     </Modulus>
     <Exponent>AQAB</Exponent>
   </RSAKeyValue>

```

Arbitrary-length integers (e.g. "bignums" such as RSA moduli)
are represented in XML as octet strings as defined by the
[`ds:CryptoBinary` type](#sec-CryptoBinary).

```

   Schema Definition:

   <element name="RSAKeyValue" type="ds:RSAKeyValueType"/>
   <complexType name="RSAKeyValueType">
     <sequence>
       <element name="Modulus" type="ds:CryptoBinary"/>
       <element name="Exponent" type="ds:CryptoBinary"/>
     </sequence>
   </complexType>

```
```

   DTD Definition:

   <!ELEMENT RSAKeyValue (Modulus, Exponent) >
   <!ELEMENT Modulus (#PCDATA) >
   <!ELEMENT Exponent (#PCDATA) >

```
#### 4.4.3 The `RetrievalMethod` Element

A `RetrievalMethod` element within
`KeyInfo` is used to convey a reference to
`KeyInfo` information that is stored at another
location. For example, several signatures in a document might use
a key verified by an X.509v3 certificate chain appearing once in
the document or remotely outside the document; each signature's
`KeyInfo` can reference this chain using a single
`RetrievalMethod` element instead of including the
entire chain with a sequence of `X509Certificate`
elements.

`RetrievalMethod` uses the same syntax and
dereferencing behavior as [`Reference`'s URI](#sec-URI) (section 4.3.3.1) and
[The
Reference Processing Model](#sec-ReferenceProcessingModel) (section 4.3.3.2) except that
there is no `DigestMethod` or `DigestValue`
child elements and presence of the URI is mandatory.

`Type` is an optional identifier for the type of
data retrieved after all transforms have been applied. The result
of dereferencing a `RetrievalMethod` `[Reference](#sec-URI)` for all [`KeyInfo` types defined by
this specification](#sec-KeyInfo) (section 4.4) with a corresponding XML
structure is an XML element or document with that element as the
root. The `rawX509Certificate` `KeyInfo`
(for which there is no XML structure) returns a binary X509
certificate.

```

   Schema Definition

   <element name="RetrievalMethod" type="ds:RetrievalMethodType"/>
   <complexType name="RetrievalMethodType">
     <sequence>
       <element ref="ds:Transforms" minOccurs="0"/>
     </sequence>
     <attribute name="URI" type="anyURI"/>
     <attribute name="Type" type="anyURI" use="optional"/>
   </complexType>

```
```

   DTD

   <!ELEMENT RetrievalMethod (Transforms?) >
   <!ATTLIST RetrievalMethod
      URI   CDATA #REQUIRED
      Type  CDATA #IMPLIED >

```

**Note:** The schema for the `URI`
attribute of RetrievalMethod erroneously omitted the attribute:
`use="required"`

The DTD is correct. However, this error only results in a more
lax schema which permits all valid RetrievalMethod elements.
Because the existing schema is embedded in many applications,
which may include the schema in their signatures, the schema has
not been corrected to be more restrictive.

#### 4.4.4 The `X509Data` Element

Identifier
`Type="[http://www.w3.org/2000/09/xmldsig#X509Data](https://www.w3.org/2000/09/xmldsig#SPKIData)`
"

(this can be used within a `RetrievalMethod` or
`Reference` element to identify the referent's
type)

An `X509Data` element within `KeyInfo`
contains one or more identifiers of keys or X509 certificates (or
certificates' identifiers or a revocation list). The content of
`X509Data` is:

1. At least one element, from the following set of element
   types; any of these may appear together or more than once iff
   (if and only if) each instance describes or is related to the
   same certificate:
2. * The `X509IssuerSerial` element, which
     contains an X.509 issuer distinguished name/serial number
     pair. The distinguished name SHOULD be represented as a
     string that complies with section 3 of RFC4514 [[LDAP-DN](#ref-LDAP-DN)], to be generated
     according to the [Distinguished Name Encoding Rules](#dname-encrules) section
     below,
   * The `X509SubjectName` element, which
     contains an X.509 subject distinguished name that SHOULD be
     represented as a string that complies with section 3 of
     RFC4514 [[LDAP-DN](#ref-LDAP-DN)],
     to be generated according to the [Distinguished Name Encoding Rules](#dname-encrules) section
     below,
   * The `X509SKI` element, which contains the
     base64 encoded plain (i.e. non-DER-encoded) value of a X509
     V.3 SubjectKeyIdentifier extension.
   * The `X509Certificate` element, which
     contains a base64-encoded [[X509v3](#ref-X509v3)] certificate, and
   * Elements from an external namespace which
     accompanies/complements any of the elements above.
   * The `X509CRL` element, which contains a
     base64-encoded certificate revocation list (CRL) [[X509v3](#ref-X509v3)].

Any `X509IssuerSerial`, `X509SKI`, and
`X509SubjectName` elements that appear MUST refer to
the certificate or certificates containing the validation key.
All such elements that refer to a particular individual
certificate MUST be grouped inside a single `X509Data`
element and if the certificate to which they refer appears, it
MUST also be in that `X509Data` element.

Any `X509IssuerSerial`, `X509SKI`, and
`X509SubjectName` elements that relate to the same key
but different certificates MUST be grouped within a single
`KeyInfo` but MAY occur in multiple
`X509Data` elements.

All certificates appearing in an `X509Data` element
MUST relate to the validation key by either containing it or
being part of a certification chain that terminates in a
certificate containing the validation key.

No ordering is implied by the above constraints. The comments
in the following instance demonstrate these constraints:

```

   <KeyInfo>
     <X509Data> <!-- two pointers to certificate-A -->
       <X509IssuerSerial>
         <X509IssuerName>CN=TAMURA Kent, OU=TRL, O=IBM,
           L=Yamato-shi, ST=Kanagawa, C=JP</X509IssuerName>
         <X509SerialNumber>12345678</X509SerialNumber>
       </X509IssuerSerial>
       <X509SKI>31d97bd7</X509SKI>
     </X509Data>
     <X509Data><!-- single pointer to certificate-B -->
       <X509SubjectName>Subject of Certificate B</X509SubjectName>
     </X509Data>
     <X509Data> <!-- certificate chain -->
       <!--Signer cert, issuer CN=arbolCA,OU=FVT,O=IBM,C=US, serial 4-->
       <X509Certificate>MIICXTCCA..</X509Certificate>
       <!-- Intermediate cert subject CN=arbolCA,OU=FVT,O=IBM,C=US
            issuer CN=tootiseCA,OU=FVT,O=Bridgepoint,C=US -->
       <X509Certificate>MIICPzCCA...</X509Certificate>
       <!-- Root cert subject CN=tootiseCA,OU=FVT,O=Bridgepoint,C=US -->
       <X509Certificate>MIICSTCCA...</X509Certificate>
     </X509Data>
   </KeyInfo>

```

Note, there is no direct provision for a PKCS#7 encoded "bag"
of certificates or CRLs. However, a set of certificates and CRLs
can occur within an `X509Data` element and multiple
`X509Data` elements can occur in a
`KeyInfo`. Whenever multiple certificates occur in an
`X509Data` element, at least one such certificate must
contain the public key which verifies the signature.

#### 4.4.4.1 Distinguished Name Encoding Rules

To encode a distinguished name
(`X509IssuerSerial`,`X509SubjectName`, and
`KeyName` if appropriate), the encoding rules in
section 2 of RFC 4514 [[LDAP-DN](#ref-LDAP-DN)] SHOULD be applied, except that the character
escaping rules in section 2.4 of RFC 4514 [[LDAP-DN](#ref-LDAP-DN)] MAY be augmented as follows:

* Escape all occurrences of ASCII control characters (Unicode
  range \x00 - \x1f) by replacing them with "\" followed by a two
  digit hex number showing its Unicode number.
* Escape any trailing space characters (Unicode \x20) by
  replacing them with "\20", instead of using the escape sequence
  "\ ".

Since a XML document logically consists of characters, not
octets, the resulting Unicode string is finally encoded according
to the character encoding used for producing the physical
representation of the XML document.

```

   Schema Definition

   <element name="X509Data" type="ds:X509DataType"/>
   <complexType name="X509DataType">
     <sequence maxOccurs="unbounded">
       <choice>
         <element name="X509IssuerSerial" type="ds:X509IssuerSerialType"/>
         <element name="X509SKI" type="base64Binary"/>
         <element name="X509SubjectName" type="string"/>
         <element name="X509Certificate" type="base64Binary"/>
         <element name="X509CRL" type="base64Binary"/>
         <any namespace="##other" processContents="lax"/>
       </choice>
     </sequence>
   </complexType>

   <complexType name="X509IssuerSerialType">
     <sequence>
       <element name="X509IssuerName" type="string"/>
       <element name="X509SerialNumber" type="integer"/>
     </sequence>
   </complexType>

```
```

   DTD

   <!ELEMENT X509Data ((X509IssuerSerial | X509SKI | X509SubjectName |
                        X509Certificate | X509CRL)+ %X509.ANY;)>
   <!ELEMENT X509IssuerSerial (X509IssuerName, X509SerialNumber) >
   <!ELEMENT X509IssuerName (#PCDATA) >
   <!ELEMENT X509SubjectName (#PCDATA) >
   <!ELEMENT X509SerialNumber (#PCDATA) >
   <!ELEMENT X509SKI (#PCDATA) >
   <!ELEMENT X509Certificate (#PCDATA) >
   <!ELEMENT X509CRL (#PCDATA) >

   <!-- Note, this DTD and schema permit X509Data to be empty; this is
   precluded by the text in [KeyInfo Element](#sec-KeyInfo) (section 4.4) which states
   that at least one element from the dsig namespace should be present
   in the PGP, SPKI, and X509 structures. This is easily expressed for
   the other key types, but not for X509Data because of its rich
   structure. -->

```
#### 4.4.5 The `PGPData` Element

Identifier
`Type="[http://www.w3.org/2000/09/xmldsig#PGPData](https://www.w3.org/2000/09/xmldsig#PGPData)`
"

(this can be used within a `RetrievalMethod` or
`Reference` element to identify the referent's
type)

The `PGPData` element within `KeyInfo`
is used to convey information related to PGP public key pairs and
signatures on such keys. The `PGPKeyID`'s value is a
base64Binary sequence containing a standard PGP public key
identifier as defined in [[PGP](#ref-PGP), section 11.2]. The `PGPKeyPacket`
contains a base64-encoded Key Material Packet as defined in
[[PGP](#ref-PGP), section 5.5]. These
children element types can be complemented/extended by siblings
from an external namespace within `PGPData`, or
`PGPData` can be replaced all together with an
alternative PGP XML structure as a child of `KeyInfo`.
`PGPData` must contain one `PGPKeyID`
and/or one `PGPKeyPacket` and 0 or more elements from
an external namespace.

```

   Schema Definition:

   <element name="PGPData" type="ds:PGPDataType"/>
   <complexType name="PGPDataType">
     <choice>
       <sequence>
         <element name="PGPKeyID" type="base64Binary"/>
         <element name="PGPKeyPacket" type="base64Binary" minOccurs="0"/>
         <any namespace="##other" processContents="lax" minOccurs="0"
          maxOccurs="unbounded"/>
       </sequence>
       <sequence>
         <element name="PGPKeyPacket" type="base64Binary"/>
         <any namespace="##other" processContents="lax" minOccurs="0"
          maxOccurs="unbounded"/>
       </sequence>
     </choice>
   </complexType>

```
```

   DTD:

 <!ELEMENT PGPData ((PGPKeyID, PGPKeyPacket?) | (PGPKeyPacket) %PGPData.ANY;) >
   <!ELEMENT PGPKeyPacket  (#PCDATA)  >
   <!ELEMENT PGPKeyID  (#PCDATA)  >

```
#### 4.4.6 The `SPKIData` Element

Identifier
`Type="[http://www.w3.org/2000/09/xmldsig#SPKIData](https://www.w3.org/2000/09/xmldsig#SPKIData)`
"

(this can be used within a `RetrievalMethod` or
`Reference` element to identify the referent's
type)

The `SPKIData` element within `KeyInfo`
is used to convey information related to SPKI public key pairs,
certificates and other SPKI data. `SPKISexp` is the
base64 encoding of a SPKI canonical S-expression.
`SPKIData` must have at least one
`SPKISexp`; `SPKISexp` can be
complemented/extended by siblings from an external namespace
within `SPKIData`, or `SPKIData` can be
entirely replaced with an alternative SPKI XML structure as a
child of `KeyInfo`.

```

   Schema Definition:

   <element name="SPKIData" type="ds:SPKIDataType"/>
   <complexType name="SPKIDataType">
     <sequence maxOccurs="unbounded">
       <element name="SPKISexp" type="base64Binary"/>
       <any namespace="##other" processContents="lax" minOccurs="0"/>
     </sequence>
   </complexType>

```
```

   DTD:

 <!ELEMENT SPKIData (SPKISexp %SPKIData.ANY;)  >
   <!ELEMENT SPKISexp  (#PCDATA)  >

```
#### 4.4.7 The `MgmtData` Element

Identifier
`Type="[http://www.w3.org/2000/09/xmldsig#MgmtData](https://www.w3.org/2000/09/xmldsig#MgmtData)`
"

(this can be used within a `RetrievalMethod` or
`Reference` element to identify the referent's
type)

The `MgmtData` element within `KeyInfo`
is a string value used to convey in-band key distribution or
agreement data. For example, DH key exchange, RSA key encryption,
etc. Use of this element is NOT RECOMMENDED. It provides a
syntactic hook where in-band key distribution or agreement data
can be placed. However, superior interoperable child elements of
`KeyInfo` for the transmission of encrypted keys and
for key agreement are being specified by the W3C XML Encryption
Working Group and they should be used instead of
`MgmtData`.

```

   Schema Definition:

   <element name="MgmtData" type="string"/>

```
```

   DTD:

   <!ELEMENT MgmtData (#PCDATA)>

```
### 4.5 The `Object` Element

Identifier
`Type=["http://www.w3.org/2000/09/xmldsig#Object"](https://www.w3.org/2000/09/xmldsig#Object)` (this can be used within a
`Reference` element to identify the referent's
type)

`Object` is an optional element that may occur one
or more times. When present, this element may contain any data.
The `Object` element may include optional MIME type,
ID, and encoding attributes.

The `Object`'s `Encoding` attributed may
be used to provide a URI that identifies the method by which the
object is encoded (e.g., a binary file).

The `MimeType` attribute is an optional attribute
which describes the data within the `Object`
(independent of its encoding). This is a string with values
defined by [[MIME](#ref-MIME)]. For
example, if the `Object` contains base64 encoded
[PNG](https://www.w3.org/Graphics/PNG/),
the `Encoding` may be specified as
'http://www.w3.org/2000/09/xmldsig#base64' and the
`MimeType` as 'image/png'. This attribute is purely
advisory; no validation of the `MimeType` information
is required by this specification. Applications which require
normative type and encoding information for signature validation
should specify `[Transforms](#sec-Transforms)` with well defined resulting types
and/or encodings.

The `Object`'s `Id` is commonly
referenced from a `Reference` in
`SignedInfo`, or `Manifest`. This element
is typically used for [enveloping signatures](#def-SignatureEnveloping) where the
object being signed is to be included in the signature element.
The digest is calculated over the entire `Object`
element including start and end tags.

Note, if the application wishes to exclude the
`<Object>` tags from the digest calculation the
`Reference` must identify the actual data object (easy
for XML documents) or a transform must be used to remove the
`Object` tags (likely where the data object is
non-XML). Exclusion of the object tags may be desired for cases
where one wants the signature to remain valid if the data object
is moved from inside a signature to outside the signature (or
vice versa), or where the content of the `Object` is
an encoding of an original binary document and it is desired to
extract and decode so as to sign the original bitwise
representation.

```

   Schema Definition:

   <element name="Object" type="ds:ObjectType"/>
   <complexType name="ObjectType" mixed="true">
     <sequence minOccurs="0" maxOccurs="unbounded">
       <any namespace="##any" processContents="lax"/>
     </sequence>
     <attribute name="Id" type="ID" use="optional"/>
     <attribute name="MimeType" type="string" use="optional"/>
     <attribute name="Encoding" type="anyURI" use="optional"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT Object (#PCDATA|Signature|SignatureProperties|Manifest %Object.ANY;)* >
   <!ATTLIST Object
    Id  ID  #IMPLIED
    MimeType    CDATA   #IMPLIED
    Encoding    CDATA   #IMPLIED >

```
## 5.0 Additional Signature Syntax

This section describes the optional to implement
`Manifest` and `SignatureProperties`
elements and describes the handling of XML processing
instructions and comments. With respect to the elements
`Manifest` and `SignatureProperties` this
section specifies syntax and little behavior -- it is left to the
application. These elements can appear anywhere the parent's
content model permits; the `Signature` content model
only permits them within `Object`.

### 5.1 The `Manifest` Element

Identifier
`Type=["http://www.w3.org/2000/09/xmldsig#Manifest"](https://www.w3.org/2000/09/xmldsig#Manifest)` (this can be used within a `Reference`
element to identify the referent's type)

The `Manifest` element provides a list of
`Reference`s. The difference from the list in
`SignedInfo` is that it is application defined which,
if any, of the digests are actually checked against the objects
referenced and what to do if the object is inaccessible or the
digest compare fails. If a `Manifest` is pointed to
from `SignedInfo`, the digest over the
`Manifest` itself will be checked by the core
signature validation behavior. The digests within such a
`Manifest` are checked at the application's
discretion. If a `Manifest` is referenced from another
`Manifest`, even the overall digest of this two level
deep `Manifest` might not be checked.

```

   Schema Definition:

   <element name="Manifest" type="ds:ManifestType"/>
   <complexType name="ManifestType">
     <sequence>
       <element ref="ds:Reference" maxOccurs="unbounded"/>
     </sequence>
     <attribute name="Id" type="ID" use="optional"/>
   </complexType>

```
```

   DTD:

   <!ELEMENT Manifest (Reference+)  >
   <!ATTLIST Manifest
             Id ID  #IMPLIED >

```
### 5.2 The `SignatureProperties` Element

Identifier
`Type="[http://www.w3.org/2000/09/xmldsig#SignatureProperties](https://www.w3.org/2000/09/xmldsig#SignatureProperties)"` (this can be used within a `Reference`
element to identify the referent's type)

Additional information items concerning the generation of the
signature(s) can be placed in a `SignatureProperty`
element (i.e., date/time stamp or the serial number of
cryptographic hardware used in signature generation).

```

   Schema Definition:

   <element name="SignatureProperties" type="ds:SignaturePropertiesType"/>
   <complexType name="SignaturePropertiesType">
     <sequence>
       <element ref="ds:SignatureProperty" maxOccurs="unbounded"/>
     </sequence>
     <attribute name="Id" type="ID" use="optional"/>
   </complexType>

      <element name="SignatureProperty" type="ds:SignaturePropertyType"/>
      <complexType name="SignaturePropertyType" mixed="true">
        <choice maxOccurs="unbounded">
          <any namespace="##other" processContents="lax"/>
          <!-- (1,1) elements from (1,unbounded) namespaces -->
        </choice>
        <attribute name="Target" type="anyURI" use="required"/>
        <attribute name="Id" type="ID" use="optional"/>
      </complexType>

```
```

   DTD:

   <!ELEMENT SignatureProperties (SignatureProperty+)  >
   <!ATTLIST SignatureProperties
             Id ID   #IMPLIED  >

   <!ELEMENT SignatureProperty (#PCDATA %SignatureProperty.ANY;)* >
   <!ATTLIST SignatureProperty
    Target  CDATA    #REQUIRED
    Id  ID   #IMPLIED  >

```
### 5.3 Processing Instructions in Signature Elements

No XML processing instructions (PIs) are used by this
specification.

Note that PIs placed inside `SignedInfo` by an
application will be signed unless the
`CanonicalizationMethod` algorithm discards them.
(This is true for any signed XML content.) All of the
`CanonicalizationMethod`s identified within this
specification retain PIs. When a PI is part of content that is
signed (e.g., within `SignedInfo` or referenced XML
documents) any change to the PI will obviously result in a
signature failure.

### 5.4 Comments in Signature Elements

XML comments are not used by this specification.

Note that unless `CanonicalizationMethod` removes
comments within `SignedInfo` or any other referenced
XML (which [[XML-C14N](#ref-XML-C14N)]
does), they will be signed. Consequently, if they are retained, a
change to the comment will cause a signature failure. Similarly,
the XML signature over any XML data will be sensitive to comment
changes unless a comment-ignoring canonicalization/transform
method, such as the Canonical XML [[XML-C14N](#ref-XML-C14N)], is specified.

## 6.0 Algorithms

This section identifies algorithms used with the XML digital
signature specification. Entries contain the identifier to be
used in `Signature` elements, a reference to the
formal specification, and definitions, where applicable, for the
representation of keys and the results of cryptographic
operations.

### 6.1 Algorithm Identifiers and Implementation Requirements

Algorithms are identified by URIs that appear as an attribute
to the element that identifies the algorithms' role
(`DigestMethod`, `Transform`,
`SignatureMethod`, or
`CanonicalizationMethod`). All algorithms used herein
take parameters but in many cases the parameters are implicit.
For example, a `SignatureMethod` is implicitly given
two parameters: the keying info and the output of
`CanonicalizationMethod`. Explicit additional
parameters to an algorithm appear as content elements within the
algorithm role element. Such parameter elements have a
descriptive element name, which is frequently algorithm specific,
and MUST be in the XML Signature namespace or an algorithm
specific namespace.

This specification defines a set of algorithms, their URIs,
and requirements for implementation. Requirements are specified
over implementation, not over requirements for signature use.
Furthermore, the mechanism is extensible; alternative algorithms
may be used by signature applications.

Digest

1. Required SHA1

   [http://www.w3.org/2000/09/xmldsig#sha1](https://www.w3.org/2000/09/xmldsig#sha1)

Encoding

1. Required base64

   [http://www.w3.org/2000/09/xmldsig#base64](https://www.w3.org/2000/09/xmldsig#base64)

MAC

1. Required HMAC-SHA1

   [http://www.w3.org/2000/09/xmldsig#hmac-sha1](https://www.w3.org/2000/09/xmldsig#hmac-sha1)

Signature

1. Required DSAwithSHA1 (DSS)

   [http://www.w3.org/2000/09/xmldsig#dsa-sha1](https://www.w3.org/2000/09/xmldsig#dsa-sha1)
2. Recommended RSAwithSHA1

   [http://www.w3.org/2000/09/xmldsig#rsa-sha1](https://www.w3.org/2000/09/xmldsig#rsa-sha1)

Canonicalization

1. Required Canonical XML 1.0(omits comments)

   [http://www.w3.org/TR/2001/REC-xml-c14n-20010315](https://www.w3.org/TR/2001/REC-xml-c14n-20010315)
2. Recommended Canonical XML 1.0with Comments

   [http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments](https://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments)
3. Required Canonical XML 1.1 (omits comments)

   [http://www.w3.org/2006/12/xml-c14n11](https://www.w3.org/2006/12/xml-c14n11)
4. Recommended Canonical XML 1.1 with Comments

   [http://www.w3.org/2006/12/xml-c14n11#WithComments](https://www.w3.org/2006/12/xml-c14n11#WithComments)

Transform

1. Optional XSLT

   [http://www.w3.org/TR/1999/REC-xslt-19991116](https://www.w3.org/TR/1999/REC-xslt-19991116)
2. Recommended XPath

   [http://www.w3.org/TR/1999/REC-xpath-19991116](https://www.w3.org/TR/1999/REC-xpath-19991116)
3. Required Enveloped Signature\*

   [http://www.w3.org/2000/09/xmldsig#enveloped-signature](https://www.w3.org/2000/09/xmldsig#enveloped-signature)

\* The Enveloped Signature transform removes the
`Signature` element from the calculation of the
signature when the signature is within the content that it is
being signed. This MAY be implemented via the RECOMMENDED XPath
specification specified in 6.6.4: [Enveloped Signature
Transform](#sec-EnvelopedSignature); it MUST have the same effect as that specified by
the [XPath Transform](#sec-XPath).

### 6.2 Message Digests

Only one digest algorithm is defined herein. However, it is
expected that one or more additional strong digest algorithms
will be developed in connection with the US Advanced Encryption
Standard effort. Use of [MD5](http://www.ietf.org/rfc/rfc1321.txt)
[[MD5](#ref-MD5)] is NOT RECOMMENDED
because recent advances in cryptanalysis have cast doubt on its
strength.

#### 6.2.1 SHA-1

Identifier:
[http://www.w3.org/2000/09/xmldsig#sha1](https://www.w3.org/2000/09/xmldsig#sha1)

The [SHA-1](http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf) algorithm [[SHA-1](#ref-SHA-1)] takes no explicit parameters. An example of an
SHA-1 DigestAlg element is:

```

<DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>

```

A SHA-1 digest is a 160-bit string. The content of the
DigestValue element shall be the base64 encoding of this bit
string viewed as a 20-octet octet stream. For example, the
DigestValue element for the message digest:

```

   A9993E36 4706816A BA3E2571 7850C26C 9CD0D89D

```

from Appendix A of the SHA-1 standard would be:

```

   <DigestValue>qZk+NkcGgWq6PiVxeFDCbJzQ2J0=</DigestValue>

```
### 6.3 Message Authentication Codes

MAC algorithms take two implicit parameters, their keying
material determined from `KeyInfo` and the octet
stream output by `CanonicalizationMethod`. MACs and
signature algorithms are syntactically identical but a MAC
implies a shared secret key.

#### 6.3.1 HMAC

Identifier:
[http://www.w3.org/2000/09/xmldsig#hmac-sha1](https://www.w3.org/2000/09/xmldsig#hmac-sha1)

The [HMAC](http://www.ietf.org/rfc/rfc2104.txt) algorithm (RFC2104 [[HMAC](#ref-HMAC)]) takes the truncation length in bits as a
parameter; if the parameter is not specified then all the bits of
the hash are output. An example of an HMAC
`SignatureMethod` element:

```

   <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#hmac-sha1">
      <HMACOutputLength>128</HMACOutputLength>
   </SignatureMethod>

```

The output of the HMAC algorithm is ultimately the output
(possibly truncated) of the chosen digest algorithm. This value
shall be base64 encoded in the same straightforward fashion as
the output of the digest algorithms. Example: the SignatureValue
element for the HMAC-SHA1 digest

```

   9294727A 3638BB1C 13F48EF8 158BFC9D

```

from the test vectors in [[HMAC](#ref-HMAC)] would be

```

   <SignatureValue>kpRyejY4uxwT9I74FYv8nQ==</SignatureValue>

```
```

   Schema Definition:

   <simpleType name="HMACOutputLengthType">
     <restriction base="integer"/>
   </simpleType>

```
```

   DTD:

   <!ELEMENT HMACOutputLength (#PCDATA)>

```
### 6.4 Signature Algorithms

Signature algorithms take two implicit parameters, their
keying material determined from `KeyInfo` and the
octet stream output by `CanonicalizationMethod`.
Signature and MAC algorithms are syntactically identical but a
signature implies public key cryptography.

#### 6.4.1 DSA

Identifier:
[http://www.w3.org/2000/09/xmldsig#dsa-sha1](https://www.w3.org/2000/09/xmldsig#dsa-sha1)

The DSA algorithm [[DSS](#ref-DSS)]
takes no explicit parameters. An example of a DSA
`SignatureMethod` element is:

```

   <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1"/>

```

The output of the DSA algorithm consists of a pair of integers
usually referred by the pair (r, s). The signature value consists
of the base64 encoding of the concatenation of two octet-streams
that respectively result from the octet-encoding of the values r
and s in that order. Integer to octet-stream conversion must be
done according to the I2OSP operation defined in the [RFC 2437](http://www.ietf.org/rfc/rfc2437.txt)
[[PKCS1](#ref-PKCS1)] specification with
a `l` parameter equal to 20. For example, the
SignatureValue element for a DSA signature (`r`,
`s`) with values specified in hexadecimal:

```

   r = 8BAC1AB6 6410435C B7181F95 B16AB97C 92B341C0
   s = 41E2345F 1F56DF24 58F426D1 55B4BA2D B6DCD8C8

```

from the example in Appendix 5 of the DSS standard would
be

```

   <SignatureValue>
   i6watmQQQ1y3GB+VsWq5fJKzQcBB4jRfH1bfJFj0JtFVtLotttzYyA==</SignatureValue>

```
#### 6.4.2 PKCS1 (RSA-SHA1)

Identifier:
[http://www.w3.org/2000/09/xmldsig#rsa-sha1](https://www.w3.org/2000/09/xmldsig#rsa-sha1)

The expression "RSA algorithm" as used in this specification
refers to the RSASSA-PKCS1-v1\_5 algorithm described in [RFC 2437](http://www.ietf.org/rfc/rfc2437.txt)
[[PKCS1](#ref-PKCS1)]. The RSA algorithm
takes no explicit parameters. An example of an RSA
SignatureMethod element is:

```

   <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>

```

The `SignatureValue` content for an RSA signature
is the base64 [[MIME](#ref-MIME)]
encoding of the octet string computed as per [RFC 2437](http://www.ietf.org/rfc/rfc2437.txt)
[[PKCS1](#ref-PKCS1), section 8.1.1:
Signature generation for the RSASSA-PKCS1-v1\_5 signature scheme].
As specified in the EMSA-PKCS1-V1\_5-ENCODE function [RFC 2437](http://www.ietf.org/rfc/rfc2437.txt)
[[PKCS1](#ref-PKCS1), section 9.2.1], the
value input to the signature function MUST contain a pre-pended
algorithm object identifier for the hash function, but the
availability of an ASN.1 parser and recognition of OIDs is not
required of a signature verifier. The PKCS#1 v1.5 representation
appears as:

```

   CRYPT (PAD (ASN.1 (OID, DIGEST (data))))

```

Note that the padded ASN.1 will be of the following form:

```

   01 | FF* | 00 | prefix | hash

```

where "|" is concatenation, "01", "FF", and "00" are fixed
octets of the corresponding hexadecimal value, "hash" is the SHA1
digest of the data, and "prefix" is the ASN.1 BER SHA1 algorithm
designator prefix required in PKCS1 [RFC 2437], that is,

```

   hex 30 21 30 09 06 05 2B 0E 03 02 1A 05 00 04 14

```

This prefix is included to make it easier to use standard
cryptographic libraries. The FF octet MUST be repeated the
maximum number of times such that the value of the quantity being
CRYPTed is one octet shorter than the RSA modulus.

The resulting base64 [[MIME](#ref-MIME)] string is the value of the child text node of
the SignatureValue element, e.g.

```

<SignatureValue>
IWijxQjUrcXBYoCei4QxjWo9Kg8D3p9tlWoT4t0/gyTE96639In0FZFY2/rvP+/bMJ01EArmKZsR5VW3rwoPxw=
</SignatureValue>

```
### 6.5 Canonicalization Algorithms

If canonicalization is performed over octets, the
canonicalization algorithms take two implicit parameters: the
content and its charset. The charset is derived according to the
rules of the transport protocols and media types (e.g, RFC2376
[[XML-MT](#ref-XML-MT)] defines the media
types for XML). This information is necessary to correctly sign
and verify documents and often requires careful server side
configuration.

Various canonicalization algorithms require conversion to
[[UTF-8](#ref-UTF-8)].The algorithms
below understand at least [[UTF-8](#ref-UTF-8)] and [[UTF-16](#ref-UTF-16)] as input encodings. We RECOMMEND that
externally specified algorithms do the same. Knowledge of other
encodings is OPTIONAL.

Various canonicalization algorithms transcode from a
non-Unicode encoding to Unicode. The output of these algorithms
will be in NFC [[NFC](#ref-NFC), [NFC-Corrigendum](#ref-NFC-Corrigendum)]. This is
because the XML processor used to prepare the XPath data model
input is required (by the Data Model) to use Normalization Form C
when converting an XML document to the UCS character domain from
any encoding that is not UCS-based.

We RECOMMEND that externally specified canonicalization
algorithms do the same. (Note, there can be ambiguities in
converting existing charsets to Unicode, for an example see the
XML Japanese Profile [[XML-Japanese](#ref-XML-Japanese)] Note.)

This specification REQUIRES implementation of both Canonical
XML 1.0 [[XML-C14N](#ref-XML-C14N)] and
Canonical XML 1.1 [[XML-C14N11](#ref-XML-C14N11)]. We RECOMMEND that applications that
generate signatures choose Canonical XML 1.1 [[XML-C14N11](#ref-XML-C14N11)] when inclusive
canonicalization is desired.

**Note**: Canonical XML 1.0 [[XML-C14N](#ref-XML-C14N)] and Canonical XML 1.1 [[XML-C14N11](#ref-XML-C14N11)] specify a standard
serialization of XML that, when applied to a subdocument,
includes the subdocument's ancestor context including all of the
namespace declarations and some attributes in the 'xml:'
namespace. However, some applications require a method which, to
the extent practical, excludes unused ancestor context from a
canonicalized subdocument. The Exclusive XML Canonicalization
Recommendation [[XML-exc-C14N](#ref-XML-exc-C14N)] may be used to address requirements
resulting from scenarios where a subdocument is moved between
contexts.

#### 6.5.1 Canonical XML 1.0

Identifier for REQUIRED Canonical XML 1.0 (omits
comments):
[http://www.w3.org/TR/2001/REC-xml-c14n-20010315](https://www.w3.org/TR/2001/REC-xml-c14n-20010315)

Identifier for Canonical XML 1.0 with Comments:
[http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments](https://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments)

An example of an XML canonicalization element is:

```

   <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>

```

The normative specification of Canonical XML1.0 is [[XML-C14N](#ref-XML-C14N)]. The algorithm is
capable of taking as input either an octet stream or an XPath
node-set (or sufficiently functional alternative). The algorithm
produces an octet stream as output. Canonical XML is easily
parameterized (via an additional URI) to omit or retain
comments.

#### 6.5.2 Canonical XML 1.1

Identifier for REQUIRED Canonical XML 1.1 (omits
comments):
[http://www.w3.org/2006/12/xml-c14n11](https://www.w3.org/2006/12/xml-c14n11)
Identifier for Canonical XML 1.1 with Comments:
[http://www.w3.org/2006/12/xml-c14n11#WithComments](https://www.w3.org/2006/12/xml-c14n11#WithComments)

The normative specification of Canonical XML 1.1 is [[XML-C14N11](#ref-XML-C14N11)]. The algorithm is
capable of taking as input either an octet stream or an XPath
node-set (or sufficiently functional alternative). The algorithm
produces an octet stream as output. Canonical XML 1.1 is easily
parameterized (via an additional URI) to omit or retain
comments.

### 6.6 `Transform` Algorithms

A `Transform` algorithm has a single implicit
parameter: an octet stream from the `Reference` or the
output of an earlier `Transform`.

Application developers are strongly encouraged to support all
transforms listed in this section as RECOMMENDED unless the
application environment has resource constraints that would make
such support impractical. Compliance with this recommendation
will maximize application interoperability and libraries should
be available to enable support of these transforms in
applications without extensive development.

#### 6.6.1 Canonicalization

Any canonicalization algorithm that can be used for
`CanonicalizationMethod` (such as those in
[Canonicalization
Algorithms](#sec-c14nAlg) (section 6.5)) can be used as a
`Transform`.

#### 6.6.2 Base64

Identifiers:
[http://www.w3.org/2000/09/xmldsig#base64](https://www.w3.org/2000/09/xmldsig#base64)

The normative specification for base64 decoding transforms is
[[MIME](#ref-MIME)]. The base64
`Transform` element has no content. The input is
decoded by the algorithms. This transform is useful if an
application needs to sign the raw data associated with the
encoded content of an element.

This transform requires an octet stream for input. If an XPath
node-set (or sufficiently functional alternative) is given as
input, then it is converted to an octet stream by performing
operations logically equivalent to 1) applying an XPath transform
with expression `self::text()`, then 2) taking the
string-value of the node-set. Thus, if an XML element is
identified by a shortname XPointer in the `Reference`
URI, and its content consists solely of base64 encoded character
data, then this transform automatically strips away the start and
end tags of the identified element and any of its descendant
elements as well as any descendant comments and processing
instructions. The output of this transform is an octet
stream.

#### 6.6.3 XPath Filtering

Identifier:
[http://www.w3.org/TR/1999/REC-xpath-19991116](https://www.w3.org/TR/1999/REC-xpath-19991116)

The normative specification for XPath expression evaluation is
[[XPath](#ref-XPath)]. The XPath
expression to be evaluated appears as the character content of a
transform parameter child element named `XPath`.

The input required by this transform is an XPath node-set.
Note that if the actual input is an XPath node-set resulting from
a null URI or shortname XPointer dereference, then comment nodes
will have been omitted. If the actual input is an octet stream,
then the application MUST convert the octet stream to an XPath
node-set suitable for use by Canonical XML with Comments. (A
subsequent application of the REQUIRED Canonical XML algorithm
would strip away these comments.) In other words, the input
node-set should be equivalent to the one that would be created by
the following process:

1. Initialize an XPath evaluation context by setting the
   initial node equal to the input XML document's root node, and
   set the context position and size to 1.
2. Evaluate the XPath expression `(//. | //@* |
   //namespace::*)`

The evaluation of this expression includes all of the
document's nodes (including comments) in the node-set
representing the octet stream.

The transform output is also an XPath node-set. The XPath
expression appearing in the `XPath` parameter is
evaluated once for each node in the input node-set. The result is
converted to a boolean. If the boolean is true, then the node is
included in the output node-set. If the boolean is false, then
the node is omitted from the output node-set.

**Note:** Even if the input node-set has had
comments removed, the comment nodes still exist in the underlying
parse tree and can separate text nodes. For example, the markup
`<e>Hello, <!-- comment
-->world!</e>` contains two text nodes. Therefore,
the expression `self::text()[string()="Hello,
world!"]` would fail. Should this problem arise in the
application, it can be solved by either canonicalizing the
document before the XPath transform to physically remove the
comments or by matching the node based on the parent element's
string value (e.g. by using the expression
`self::text()[string(parent::e)="Hello,
world!"]`).

The primary purpose of this transform is to ensure that only
specifically defined changes to the input XML document are
permitted after the signature is affixed. This is done by
omitting precisely those nodes that are allowed to change once
the signature is affixed, and including all other input nodes in
the output. It is the responsibility of the XPath expression
author to include all nodes whose change could affect the
interpretation of the transform output in the application
context.

Note that the XML-Signature XPath Filter 2.0 Recommendation
[[XPath-Filter-2](#ref-XPath-Filter-2)]
may be used for this purpose. This recommendation defines an
XPath transform that permits the easy specification of subtree
selection and omission that can be efficiently implemented.

An important scenario would be a document requiring two
enveloped signatures. Each signature must omit itself from its
own digest calculations, but it is also necessary to exclude the
second signature element from the digest calculations of the
first signature so that adding the second signature does not
break the first signature.

The XPath transform establishes the following evaluation
context for each node of the input node-set:

* A **context node** equal to a node of the
  input node-set.
* A **context position**, initialized to 1.
* A **context size**, initialized to 1.
* A **library of functions** equal to the
  function set defined in [[XPath]](#ref-XPath) plus a function named **[here](#function-here)**.
* A set of variable bindings. No means for initializing these
  is defined. Thus, the set of variable bindings used when
  evaluating the XPath expression is empty, and use of a variable
  reference in the XPath expression results in an error.
* The set of namespace declarations in scope for the XPath
  expression.

As a result of the context node setting, the XPath expressions
appearing in this transform will be quite similar to those used
in used in [[XSLT](#ref-XSLT)], except
that the size and position are always 1 to reflect the fact that
the transform is automatically visiting every node (in XSLT, one
recursively calls the command `apply-templates` to
visit the nodes of the input tree).

**The function `here()` is defined as
follows:**

**Function:** *node-set*
**here**()

The **[here](#function-here)** function returns a node-set containing
the attribute or processing instruction node or the parent
element of the text node that directly bears the XPath
expression.  This expression results in an error if the
containing XPath expression does not appear in the same XML
document against which the XPath expression is being
evaluated.

As an example, consider creating an enveloped signature (a
`Signature` element that is a descendant of an element
being signed). Although the signed content should not be changed
after signing, the elements within the `Signature`
element are changing (e.g. the digest value must be put inside
the `DigestValue` and the `SignatureValue`
must be subsequently calculated). One way to prevent these
changes from invalidating the digest value in
`DigestValue` is to add an XPath
`Transform` that omits all `Signature`
elements and their descendants. For example,

```

   <Document>
   ...
   <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
     <SignedInfo>
      ...
       <Reference URI="">
         <Transforms>
           <Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
             <XPath xmlns:dsig="&dsig;">
             not(ancestor-or-self::dsig:Signature)
             </XPath>
           </Transform>
         </Transforms>
         <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
         <DigestValue></DigestValue>
       </Reference>
     </SignedInfo>
     <SignatureValue></SignatureValue>
    </Signature>
    ...
   </Document>

```

Due to the null `Reference` URI in this example,
the XPath transform input node-set contains all nodes in the
entire parse tree starting at the root node (except the comment
nodes). For each node in this node-set, the node is included in
the output node-set except if the node or one of its ancestors
has a tag of `Signature` that is in the namespace
given by the replacement text for the entity
`&dsig;`.

A more elegant solution uses the **[here](#function-here)** function to omit
only the `Signature` containing the XPath Transform,
thus allowing enveloped signatures to sign other signatures. In
the example above, use the `XPath` element:

```

   <XPath xmlns:dsig="&dsig;">
   count(ancestor-or-self::dsig:Signature |
   here()/ancestor::dsig:Signature[1]) >
   count(ancestor-or-self::dsig:Signature)</XPath>

```

Since the XPath equality operator converts node sets to string
values before comparison, we must instead use the XPath union
operator (|). For each node of the document, the predicate
expression is true if and only if the node-set containing the
node and its `Signature` element ancestors does not
include the enveloped `Signature` element containing
the XPath expression (the union does not produce a larger set if
the enveloped `Signature` element is in the node-set
given by `ancestor-or-self::Signature`).

#### 6.6.4 Enveloped Signature Transform

Identifier:
[http://www.w3.org/2000/09/xmldsig#enveloped-signature](https://www.w3.org/2000/09/xmldsig#enveloped-signature)

An enveloped signature transform ***T***
removes the whole `Signature` element containing
***T*** from the digest calculation of the
`Reference` element containing
***T***. The entire string of characters used
by an XML processor to match the `Signature` with the
XML production `element` is removed. The output of the
transform is equivalent to the output that would result from
replacing ***T*** with an XPath transform
containing the following `XPath` parameter
element:

```

   <XPath xmlns:dsig="&dsig;">
   count(ancestor-or-self::dsig:Signature |
   here()/ancestor::dsig:Signature[1]) >
   count(ancestor-or-self::dsig:Signature)</XPath>

```

The input and output requirements of this transform are
identical to those of the XPath transform, but may only be
applied to a node-set from its parent XML document. Note that it
is not necessary to use an XPath expression evaluator to create
this transform. However, this transform MUST produce output in
exactly the same manner as the XPath transform parameterized by
the XPath expression above.

#### 6.6.5 XSLT Transform

Identifier:
[http://www.w3.org/TR/1999/REC-xslt-19991116](https://www.w3.org/TR/1999/REC-xslt-19991116)

The normative specification for XSL Transformations is
[[XSLT](#ref-XSLT)]. Specification of a
namespace-qualified stylesheet element, which MUST be the sole
child of the `Transform` element, indicates that the
specified style sheet should be used. Whether this instantiates
in-line processing of local XSLT declarations within the resource
is determined by the XSLT processing model; the ordered
application of multiple stylesheet may require multiple
`Transforms`. No special provision is made for the
identification of a remote stylesheet at a given URI because it
can be communicated via an [`xsl:include`](https://www.w3.org/TR/1999/REC-xslt-19991116#section-Combining-Stylesheets) or [`xsl:import`](https://www.w3.org/TR/1999/REC-xslt-19991116#section-Combining-Stylesheets) within the
`stylesheet` child of the `Transform`.

This transform requires an octet stream as input. If the
actual input is an XPath node-set, then the signature application
should attempt to convert it to octets (apply [Canonical XML](#sec-Canonical)]) as described in
[the
Reference Processing Model](#sec-ReferenceProcessingModel) (section 4.3.3.2).

The output of this transform is an octet stream. The
processing rules for the XSL style sheet or transform element are
stated in the XSLT specification [[XSLT](#ref-XSLT)]. We RECOMMEND that XSLT transform authors use an
output method of `xml` for XML and HTML. As XSLT
implementations do not produce consistent serializations of their
output, we further RECOMMEND inserting a transform after the XSLT
transform to canonicalize the output. These steps will help to
ensure interoperability of the resulting signatures among
applications that support the XSLT transform. Note that if the
output is actually HTML, then the result of these steps is
logically equivalent [[XHTML](#ref-XHTML)].

## 7.0 XML Canonicalization and Syntax Constraint Considerations

Digital signatures only work if the verification calculations
are performed on exactly the same bits as the signing
calculations. If the surface representation of the signed data
can change between signing and verification, then some way to
standardize the changeable aspect must be used before signing and
verification. For example, even for simple ASCII text there are
at least three widely used line ending sequences. If it is
possible for signed text to be modified from one line ending
convention to another between the time of signing and signature
verification, then the line endings need to be canonicalized to a
standard form before signing and verification or the signatures
will break.

XML is subject to surface representation changes and to
processing which discards some surface information. For this
reason, XML digital signatures have a provision for indicating
canonicalization methods in the signature so that a verifier can
use the same canonicalization as the signer.

Throughout this specification we distinguish between the
canonicalization of a `Signature` element and other
signed XML data objects. It is possible for an isolated XML
document to be treated as if it were binary data so that no
changes can occur. In that case, the digest of the document will
not change and it need not be canonicalized if it is signed and
verified as such. However, XML that is read and processed using
standard XML parsing and processing techniques is frequently
changed such that some of its surface representation information
is lost or modified. In particular, this will occur in many cases
for the `Signature` and enclosed
`SignedInfo` elements since they, and possibly an
encompassing XML document, will be processed as XML.

Similarly, these considerations apply to
`Manifest`, `Object`, and
`SignatureProperties` elements if those elements have
been digested, their `DigestValue` is to be checked,
and they are being processed as XML.

The kinds of changes in XML that may need to be canonicalized
can be divided into four categories. There are those related to
the basic [[XML](#ref-XML)], as described
in 7.1 below. There are those related to [[DOM](#ref-DOM)], [[SAX](#ref-SAX)],
or similar processing as described in 7.2 below. Third, there is
the possibility of coded character set conversion, such as
between UTF-8 and UTF-16, both of which all  [[XML](#ref-XML)] compliant processors are
required to support, which is described in the paragraph
immediately below. And, fourth, there are changes that related to
namespace declaration and XML namespace attribute context as
described in 7.3 below.

Any canonicalization algorithm should yield output in a
specific fixed coded character set. All canonicalization [algorithms](#sec-c14nAlg) identified in this
document use UTF-8 (without a byte order mark (BOM)) and do not
provide character normalization. We RECOMMEND that signature
applications create XML content (`Signature` elements
and their descendents/content) in Normalization Form C [[NFC](#ref-NFC), [NFC-Corrigendum](#ref-NFC-Corrigendum)] and check that any XML being
consumed is in that form as well; (if not, signatures may
consequently fail to validate). Additionally, none of these
algorithms provide data type normalization. Applications that
normalize data types in varying formats (e.g., (true, false) or
(1,0)) may not be able to validate each other's signatures.

### 7.1 XML 1.0, Syntax Constraints, and Canonicalization

XML 1.0 [[XML](#ref-XML)] defines an
interface where a conformant application reading XML is given
certain information from that XML and not other information. In
particular,

1. line endings are normalized to the single character #xA by
   dropping #xD characters if they are immediately followed by a
   #xA and replacing them with #xA in all other cases,
2. missing attributes declared to have default values are
   provided to the application as if present with the default
   value,
3. character references are replaced with the corresponding
   character,
4. entity references are replaced with the corresponding
   declared entity,
5. attribute values are normalized by
   1. replacing character and entity references as
      above,
   2. replacing occurrences of #x9, #xA, and #xD with #x20
      (space) except that the sequence #xD#xA is replaced by a
      single space, and
   3. if the attribute is not declared to be CDATA, stripping
      all leading and trailing spaces and replacing all interior
      runs of spaces with a single space.

Note that items (2), (4), and (5.3) depend on the presence of
a schema, DTD or similar declarations. The `Signature`
element type is [laxly schema valid](https://www.w3.org/TR/2000/WD-xmlschema-1-20000407/#cvc-elt-lax) [[XML-schema](#ref-XML-schema)], consequently external XML or even
XML within the same document as the signature may be (only)
well-formed or from another namespace (where permitted by the
signature schema); the noted items may not be present. Thus, a
signature with such content will only be verifiable by other
signature applications if the following syntax constraints are
observed when generating any signed material including the
`SignedInfo` element:

1. attributes having default values be explicitly
   present,
2. all entity references (except "amp", "lt", "gt", "apos",
   "quot", and other character entities not representable in the
   encoding chosen) be expanded,
3. attribute value white space be normalized

### 7.2 DOM/SAX Processing and Canonicalization

In addition to the canonicalization and syntax constraints
discussed above, many XML applications use the Document Object
Model [[DOM](#ref-DOM)] or the Simple API
for XML  [[SAX](#ref-SAX)]. DOM maps
XML into a tree structure of nodes and typically assumes it will
be used on an entire document with subsequent processing being
done on this tree. SAX converts XML into a series of events such
as a start tag, content, etc. In either case, many surface
characteristics such as the ordering of attributes and
insignificant white space within start/end tags is lost. In
addition, namespace declarations are mapped over the nodes to
which they apply, losing the namespace prefixes in the source
text and, in most cases, losing where namespace declarations
appeared in the original instance.

If an XML Signature is to be produced or verified on a system
using the DOM or SAX processing, a canonical method is needed to
serialize the relevant part of a DOM tree or sequence of SAX
events. XML canonicalization specifications, such as [[XML-C14N](#ref-XML-C14N)], are based only on
information which is preserved by DOM and SAX. For an XML
Signature to be verifiable by an implementation using DOM or SAX,
not only must the [XML 1.0
syntax constraints given in the previous section](#sec-XML-1) be followed
but an appropriate XML canonicalization MUST be specified so that
the verifier can re-serialize DOM/SAX mediated input into the
same octet stream that was signed.

### 7.3 Namespace Context and Portable Signatures

In [[XPath](#ref-XPath)] and
consequently the Canonical XML data model an element has
namespace nodes that correspond to those declarations within the
element and its ancestors:

> "**Note:** An element
> ***E*** has namespace nodes that represent
> its namespace declarations *as well as* any namespace
> declarations made by its ancestors that have not been
> overridden in ***E***'s declarations, the
> default namespace if it is non-empty, and the declaration of
> the prefix `xml`." [[XML-C14N](#ref-XML-C14N)]

When serializing a `Signature` element or signed
XML data that's the child of other elements using these data
models, that `Signature` element and its children, may
contain namespace declarations from its ancestor context. In
addition, the Canonical XML and Canonical XML with Comments
algorithms import all xml namespace attributes (such as
`xml:lang`) from the nearest ancestor in which they
are declared to the apex node of canonicalized XML unless they
are already declared at that node. This may frustrate the intent
of the signer to create a signature in one context which remains
valid in another. For example, given a signature which is a child
of `B` and a grandchild of `A`:

```

   <A xmlns:n1="&foo;">
     <B xmlns:n2="&bar;">
       <Signature xmlns="&dsig;">   ...
         <Reference URI="#signme"/> ...
       </Signature>
       <C ID="signme" xmlns="&baz;"/>
     </B>
   </A>

```

when either the element `B` or the signed element
`C` is moved into a [[SOAP](#ref-SOAP)] envelope for transport:

```

   <SOAP:Envelope xmlns:SOAP="http://schemas.xmlsoap.org/soap/envelope/">
     ...
     <SOAP:Body>
       <B xmlns:n2="&bar;">
         <Signature xmlns="&dsig;">
           ...
         </Signature>
         <C ID="signme" xmlns="&baz;"/>
       </B>
     </SOAP:Body>
   </SOAP:Envelope>

```

The canonical form of the signature in this context will
contain new namespace declarations from the
`SOAP:Envelope` context, invalidating the signature.
Also, the canonical form will lack namespace declarations it may
have originally had from element `A`'s context, also
invalidating the signature. To avoid these problems, the
application may:

1. Rely upon the enveloping application to properly divorce
   its body (the signature payload) from the context (the
   envelope) before the signature is validated. Or,
2. Use a canonicalization method that "repels/excludes"
   instead of "attracts" ancestor context. [[XML-C14N](#ref-XML-C14N)] purposefully
   attracts such context.

## 8.0 Security Considerations

The XML Signature specification provides a very flexible
digital signature mechanism. Implementors must give consideration
to their application threat models and to the following
factors.

### 8.1 Transforms

A requirement of this specification is to permit signatures to
"apply to a part or totality of a XML document." (See
[[XML-Signature-RD](#ref-XML-Signature-RD), section 3.1.3].) The
`Transforms` mechanism meets this requirement by
permitting one to sign data derived from processing the content
of the identified resource. For instance, applications that wish
to sign a form, but permit users to enter limited field data
without invalidating a previous signature on the form might use
[[XPath](#ref-XPath)] to exclude those
portions the user needs to change. `Transforms` may be
arbitrarily specified and may include encoding transforms,
canonicalization instructions or even XSLT transformations. Three
cautions are raised with respect to this feature in the following
sections.

Note, [core validation](#def-ValidationCore) behavior does not confirm that the
signed data was obtained by applying each step of the indicated
transforms. (Though it does check that the digest of the
resulting content matches that specified in the signature.)
For example, some applications may be satisfied with verifying an
XML signature over a cached copy of already transformed data.
Other applications might require that content be freshly
dereferenced and transformed.

#### 8.1.1 **Only What is Signed is Secure**

First, obviously, signatures over a transformed document do
not secure any information discarded by transforms: only what is
signed is secure.

Note that the use of Canonical  XML [[XML-C14N](#ref-XML-C14N)] ensures that all
internal entities and XML namespaces are expanded within the
content being signed. All entities are replaced with their
definitions and the canonical form explicitly represents the
namespace that an element would otherwise inherit. Applications
that do not canonicalize XML content (especially the
`SignedInfo` element) SHOULD NOT use internal entities
and SHOULD represent the namespace explicitly within the content
being signed since they can not rely upon canonicalization to do
this for them. Also, users concerned with the integrity of the
element type definitions associated with the XML instance being
signed may wish to sign those definitions as well (i.e., the
schema, DTD, or natural language description associated with the
namespace/identifier).

Second, an envelope containing signed information is not
secured by the signature. For instance, when an encrypted
envelope contains a signature, the signature does not protect the
authenticity or integrity of unsigned envelope headers nor its
ciphertext form, it only secures the plaintext actually
signed.

#### 8.1.2 Only What is "Seen" Should be Signed

Additionally, the signature secures any information introduced
by the transform: only what is "seen" (that which is represented
to the user via visual, auditory or other media) should be
signed. If signing is intended to convey the judgment or consent
of a user (an automated mechanism or person), then it is normally
necessary to secure as exactly as practical the information that
was presented to that user. Note that this can be accomplished by
literally signing what was presented, such as the screen images
shown a user. However, this may result in data which is difficult
for subsequent software to manipulate. Instead, one can sign the
data along with whatever filters, style sheets, client profile or
other information that affects its presentation.

#### 8.1.3 "See" What is Signed

Just as a user should only sign what he or she "sees," persons
and automated mechanism that trust the validity of a transformed
document on the basis of a valid signature should operate over
the data that was transformed (including canonicalization) and
signed, not the original pre-transformed data. This
recommendation applies to transforms specified within the
signature as well as those included as part of the document
itself. For instance, if an XML document includes an [embedded style sheet](https://www.w3.org/TR/xslt#section-Creating-Processing-Instructions) [[XSLT](#ref-XSLT)] it is the transformed document that should be
represented to the user and signed. To meet this recommendation
where a document references an external style sheet, the content
of that external resource should also be signed as via a
signature `Reference` otherwise the content of that
external content might change which alters the resulting document
without invalidating the signature.

Some applications might operate over the original or
intermediary data but should be extremely careful about potential
weaknesses introduced between the original and transformed data.
This is a trust decision about the character and meaning of the
transforms that an application needs to make with caution.
Consider a canonicalization algorithm that normalizes character
case (lower to upper) or character composition ('e and accent' to
'accented-e'). An adversary could introduce changes that are
normalized and consequently inconsequential to signature validity
but material to a DOM processor. For instance, by changing the
case of a character one might influence the result of an XPath
selection. A serious risk is introduced if that change is
normalized for signature validation but the processor operates
over the original data and returns a different result than
intended.

As a result:

* All documents operated upon and generated by signature
  applications MUST be in [[NFC](#ref-NFC), [NFC-Corrigendum](#ref-NFC-Corrigendum)] (otherwise intermediate processors
  might unintentionally break the signature)
* Encoding normalizations SHOULD NOT be done as part of a
  signature transform, or (to state it another way) if
  normalization does occur, the application SHOULD always "see"
  (operate over) the normalized form.

### 8.2 Check the Security Model

This specification uses public key signatures and keyed hash
authentication codes. These have substantially different security
models. Furthermore, it permits user specified algorithms which
may have other models.

With public key signatures, any number of parties can hold the
public key and verify signatures while only the parties with the
private key can create signatures. The number of holders of the
private key should be minimized and preferably be one. Confidence
by verifiers in the public key they are using and its binding to
the entity or capabilities represented by the corresponding
private key is an important issue, usually addressed by
certificate or online authority systems.

Keyed hash authentication codes, based on secret keys, are
typically much more efficient in terms of the computational
effort required but have the characteristic that all verifiers
need to have possession of the same key as the signer. Thus any
verifier can forge signatures.

This specification permits user provided signature algorithms
and keying information designators. Such user provided algorithms
may have different security models. For example, methods
involving biometrics usually depend on a physical characteristic
of the authorized user that can not be changed the way public or
secret keys can be and may have other security model
differences.

### 8.3 Algorithms, Key Lengths, Certificates, Etc.

The strength of a particular signature depends on all links in
the security chain. This includes the signature and digest
algorithms used, the strength of the key generation [[RANDOM](#ref-RANDOM)] and the size of the key,
the security of key and certificate authentication and
distribution mechanisms, certificate chain validation policy,
protection of cryptographic processing from hostile observation
and tampering, etc.

Care must be exercised by applications in executing the
various algorithms that may be specified in an XML signature and
in the processing of any "executable content" that might be
provided to such algorithms as parameters, such as XSLT
transforms. The algorithms specified in this document will
usually be implemented via a trusted library but even there
perverse parameters might cause unacceptable processing or memory
demand. Even more care may be warranted with application defined
algorithms.

The security of an overall system will also depend on the
security and integrity of its operating procedures, its
personnel, and on the administrative enforcement of those
procedures. All the factors listed in this section are important
to the overall security of a system; however, most are beyond the
scope of this specification.

## 9.0 Schema, DTD, Data Model, and Valid Examples

XML Signature Schema Instance
<xmldsig-core-schema.xsd>
Valid XML schema instance based on the 20001024 Schema/DTD
[[XML-Schema](#ref-XML-schema)].
XML Signature DTD
<xmldsig-core-schema.dtd>
RDF Data Model
<xmldsig-datamodel-20000112.gif>
XML Signature Object Example
<signature-example.xml>
A cryptographical fabricated XML example that includes
foreign content and validates under the schema, it also uses
`schemaLocation` to aid automated schema fetching
and validation.
RSA XML Signature Example
<signature-example-rsa.xml>
An XML Signature example with generated cryptographic
values by Merlin Hughes and validated by Gregor Karlinger.
DSA XML Signature Example
<signature-example-dsa.xml>
Similar to above but uses DSA.
## 10.0 Definitions

Authentication Code
(Protected Checksum)
A value generated from the application of a shared key to a
message via a cryptographic algorithm such that it has the
properties of [message authentication](#def-AuthenticationMessage) (and
[integrity](#def-Integrity)) but not [signer authentication](#def-AuthenticationSigner). Equivalent to *protected
checksum*, "A checksum that is computed for a data object
by means that protect against active attacks that would attempt
to change the checksum to make it match changes made to the
data object."  [[SEC](#ref-SEC)]
Authentication,
Message
The property, given an [authentication code](#def-AuthenticationCode)/[protected checksum](#def-ProtectedChecksum), that tampering with both the
data and checksum, so as to introduce changes while seemingly
preserving [integrity](#def-Integrity), are still detected. "A signature should
identify what is signed, making it impracticable to falsify or
alter either the signed matter or the signature without
detection." [[Digital Signature Guidelines](http://www.abanet.org/scitech/ec/isc/dsgfree.html), [ABA](#ref-ABA)].
Authentication,
Signer
The property that the identity of the signer is as claimed.
"A signature should indicate who signed a document, message or
record, and should be difficult for another person to produce
without authorization." [[Digital Signature Guidelines](http://www.abanet.org/scitech/ec/isc/dsgfree.html), [ABA](#ref-ABA)] Note, signer authentication is an
application decision (e.g., does the signing key actually
correspond to a specific identity) that is supported by, but
out of scope, of this specification.
Checksum
"A value that (a) is computed by a function that is
dependent on the contents of a data object and (b) is stored or
transmitted together with the object, for the purpose of
detecting changes in the data."  [[SEC](#ref-SEC)]
Core
The syntax and processing defined by this specification,
including [core validation](#def-ValidationCore). We use this term to distinguish
other markup, processing, and applications semantics from our
own.
Data Object (Content/Document)
The actual binary/octet data being operated on
(transformed, digested, or signed) by an application --
frequently an [HTTP entity](https://www.w3.org/Protocols/rfc2616/rfc2616-sec7.html#sec7) [[HTTP](#ref-HTTP)]. Note that the proper noun `Object`
designates a specific XML element. Occasionally we refer to a
data object as a *document* or as a *[resource](#def-Resource)'s
content*. The term *element content* is used to
describe the data between XML start and end tags [[XML](#ref-XML)]. The term *XML
document* is used to describe data objects which conform to
the XML specification [[XML](#ref-XML)].
Integrity
"The property that data has not been changed, destroyed, or
lost in an unauthorized or accidental manner." [[SEC](#ref-SEC)] A simple [checksum](#def-Checksum) can
provide integrity from incidental changes in the data; [message authentication](#def-AuthenticationMessage) is similar but also protects
against an active attack to alter the data whereby a change in
the checksum is introduced so as to match the change in the
data.
Object
An XML Signature element wherein arbitrary (non-[core](#def-Core)) data may be
placed. An `Object` element is merely one type of
digital data (or document) that can be signed via a
`Reference`.
Resource
"A resource can be anything that has identity. Familiar
examples include an electronic document, an image, a service
(e.g., 'today's weather report for Los Angeles'), and a
collection of other resources.... The resource is the
conceptual mapping to an entity or set of entities, not
necessarily the entity which corresponds to that mapping at any
particular instance in time. Thus, a resource can remain
constant even when its content---the entities to which it
currently corresponds---changes over time, provided that the
conceptual mapping is not changed in the process." [[URI](#ref-URI)] In order to avoid a collision
of the term *entity* within the URI and XML
specifications, we use the term *data object*,
*content* or *document* to refer to the actual
bits/octets being operated upon.
Signature
Formally speaking, a value generated from the application
of a private key to a message via a cryptographic algorithm
such that it has the properties of [integrity](#def-Integrity), [message authentication](#def-AuthenticationMessage) and/or [signer authentication](#def-AuthenticationSigner). (However, we sometimes use
the term signature generically such that it encompasses
[Authentication Code](#def-AuthenticationCode) values as well, but we are
careful to make the distinction when the property of [signer authentication](#def-AuthenticationSigner) is relevant to the
exposition.) A signature may be (non-exclusively) described as
[detached](#def-SignatureDetached), [enveloping](#def-SignatureEnveloping), or [enveloped](#def-SignatureEnveloped).
Signature,
Application
An application that implements the MANDATORY
(REQUIRED/MUST) portions of this specification; these
conformance requirements are over application behavior, the
structure of the `Signature` element type and its
children (including `SignatureValue`) and the
specified algorithms.
Signature, Detached
The signature is over content external to the
`Signature` element, and can be identified via a
`URI` or transform. Consequently, the signature is
"detached" from the content it signs. This definition typically
applies to separate data objects, but it also includes the
instance where the `Signature` and data object
reside within the same XML document but are sibling
elements.
Signature,
Enveloping
The signature is over content found within an
`Object` element of the signature itself. The
`Object` (or its content) is identified via a
`Reference` (via a `URI` fragment
identifier or transform).
Signature,
Enveloped
The signature is over the XML content that contains the
signature as an element. The content provides the root XML
document element. Obviously, enveloped signatures must take
care not to include their own value in the calculation of the
`SignatureValue`.
Transform
The processing of a data from its source to its derived
form. Typical transforms include XML Canonicalization, XPath,
and XSLT.
Validation, Core
The core processing requirements of this specification
requiring [signature validation](#def-ValidationSignature) and
`SignedInfo` [reference validation](#def-ValidationReference).
Validation,
Reference
The hash value of the identified and transformed content,
specified by `Reference`, matches its specified
`DigestValue`.
Validation,
Signature
The `SignatureValue` matches the result of
processing `SignedInfo` with
`CanonicalizationMethod` and
`SignatureMethod` as specified in [Core Validation](#sec-CoreValidation) (section
3.2).
Validation,
Trust/Application
The application determines that the semantics associated
with a signature are valid. For example, an application may
validate the time stamps or the integrity of the signer key --
though this behavior is external to this [core](#def-ValidationCore)
specification.
## 11.0 References

ABA
[Digital Signature Guidelines.](http://www.abanet.org/scitech/ec/isc/dsgfree.html)

<http://www.abanet.org/scitech/ec/isc/dsgfree.html>
DOM
[Document Object Model (DOM) Level 1 Specification.](https://www.w3.org/TR/1998/REC-DOM-Level-1-19981001/)
W3C Recommendation. V. Apparao, S. Byrne, M. Champion, S.
Isaacs, I. Jacobs, A. Le Hors, G. Nicol, J. Robie, R. Sutor, C.
Wilson, L. Wood. October 1998.

[http://www.w3.org/TR/1998/REC-DOM-Level-1-19981001/](https://www.w3.org/TR/1998/REC-DOM-Level-1-19981001/)
DSS
[FIPS PUB 186-2](http://csrc.nist.gov/publications/fips/fips186-2/fips186-2-change1.pdf). *Digital Signature Standard
(DSS).* U.S. Department of Commerce/National Institute of
Standards and Technology.

<http://csrc.nist.gov/publications/fips/fips186-2/fips186-2-change1.pdf>
HMAC
[RFC 2104](http://www.ietf.org/rfc/rfc2104.txt). *HMAC: Keyed-Hashing for Message
Authentication.* H. Krawczyk, M. Bellare, R. Canetti.
February 1997.

<http://www.ietf.org/rfc/rfc2104.txt>
HTTP
[RFC 2616](https://www.w3.org/Protocols/rfc2616/rfc2616.html). *Hypertext Transfer Protocol --
HTTP/1.1*. J. Gettys, J. Mogul, H. Frystyk, L. Masinter, P.
Leach, T. Berners-Lee. June 1999.

<http://www.ietf.org/rfc/rfc2616.txt>
KEYWORDS
[RFC 2119.](http://www.ietf.org/rfc/rfc2119.txt) *Key words for use in RFCs to Indicate
Requirement Levels.* S. Bradner. March 1997.

<http://www.ietf.org/rfc/rfc2119.txt>
LDAP-DN
[RFC4514](http://www.ietf.org/rfc/rfc4514.txt) . *Lightweight Directory Access Protocol
: String Representation of Distinguished Names.* K.
Zeilenga, Ed. June 2006.

<http://www.ietf.org/rfc/rfc4514.txt>
MD5
[RFC 1321](http://www.ietf.org/rfc/rfc1321.txt). *The MD5 Message-Digest Algorithm.*
R. Rivest. April 1992.

<http://www.ietf.org/rfc/rfc1321.txt>
MIME
[RFC 2045](http://www.ietf.org/rfc/rfc2045.txt). *Multipurpose Internet Mail Extensions
(MIME) Part One: Format of Internet Message Bodies*. N.
Freed & N. Borenstein. November 1996.

<http://www.ietf.org/rfc/rfc2045.txt>
NFC
*TR15, Unicode Normalization Forms.* M. Davis, M.
Dürst. Revision 18: November 1999. <http://www.unicode.org/unicode/reports/tr15/tr15-18.html>.
NFC-Corrigendum
*Normalization Corrigendum*. The Unicode Consortium.
<http://www.unicode.org/unicode/uni2errata/Normalization_Corrigendum.html>.
PGP
[RFC 2440](http://www.ietf.org/rfc/rfc2440.txt). *OpenPGP Message Format.* J.
Callas, L. Donnerhacke, H. Finney, R. Thayer. November
1998.

<http://www.ietf.org/rfc/rfc2440.txt>
RANDOM
[RFC 1750](http://www.ietf.org/rfc/rfc1750.txt). *Randomness Recommendations for
Security.* D. Eastlake, S. Crocker, J. Schiller. December
1994.

<http://www.ietf.org/rfc/rfc1750.txt>
RDF
[Resource Description Framework (RDF) Schema
Specification 1.0.](https://www.w3.org/TR/2000/CR-rdf-schema-20000327/) W3C Candidate Recommendation. D.
Brickley, R.V. Guha. March 2000.

[http://www.w3.org/TR/2000/CR-rdf-schema-20000327/](https://www.w3.org/TR/2000/CR-rdf-schema-20000327/)
[Resource Description Framework (RDF) Model and Syntax
Specification](https://www.w3.org/TR/1999/REC-rdf-syntax-19990222/). W3C Recommendation. O. Lassila, R. Swick.
February 1999.

[http://www.w3.org/TR/1999/REC-rdf-syntax-19990222/](https://www.w3.org/TR/1999/REC-rdf-syntax-19990222/)
1363
IEEE 1363: Standard Specifications for Public Key
Cryptography. August 2000.
PKCS1
[RFC 2437](http://www.ietf.org/rfc/rfc2437.txt). *PKCS #1: RSA Cryptography
Specifications Version 2.0.* B. Kaliski, J. Staddon.
October 1998.

<http://www.ietf.org/rfc/rfc2437.txt>
SAX
[SAX: The Simple API for XML](http://www.megginson.com/downloads/SAX/). D. Megginson, et al.
May 1998.

<http://www.megginson.com/downloads/SAX/>
SEC
[RFC 2828](http://www.ietf.org/rfc/rfc2828.txt). *Internet Security Glossary.* R.
Shirey. May 2000.

<http://www.faqs.org/rfcs/rfc2828.html>
SHA-1
[FIPS PUB 180-2](http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf). *Secure Hash Standard.*
U.S. Department of Commerce/National Institute of Standards and
Technology.

<http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf>
SOAP
[Simple Object Access Protocol (SOAP) Version
1.1](https://www.w3.org/TR/2000/NOTE-SOAP-20000508/). W3C Note. D. Box, D. Ehnebuske, G. Kakivaya, A.
Layman, N. Mendelsohn, H. Frystyk Nielsen, S. Thatte, D. Winer.
May 2001.
[http://www.w3.org/TR/2000/NOTE-SOAP-20000508/](https://www.w3.org/TR/2000/NOTE-SOAP-20000508/)
TESTCASES
[Test Cases for C14N 1.1
and XMLDSig Interoperability](https://www.w3.org/TR/2008/NOTE-xmldsig2ed-tests-20080610/). W3C Working Group Note. J.C. Cruellas, K. Lanz, S. Mullan.
June 2008.
[http://www.w3.org/TR/2008/NOTE-xmldsig2ed-tests-20080610/](https://www.w3.org/TR/2008/NOTE-xmldsig2ed-tests-20080610/)
UTF-16
[RFC 2781](http://www.ietf.org/rfc/rfc2781.txt). *UTF-16, an encoding of ISO 10646.*
P. Hoffman , F. Yergeau. February 2000.

<http://www.ietf.org/rfc/rfc2781.txt>
UTF-8
[RFC 2279](http://www.ietf.org/rfc/rfc2279.txt). *UTF-8, a transformation format of ISO
10646*. F. Yergeau. January 1998.

<http://www.ietf.org/rfc/rfc2279.txt>
URI
[RFC 3986](http://www.ietf.org/rfc/rfc3986.txt). *Uniform Resource Identifiers (URI):
Generic Syntax.* T. Berners-Lee, R. Fielding, L. Masinter.
January 2005.

<http://www.ietf.org/rfc/rfc3986.txt>
URL
[RFC 1738.](http://www.ietf.org/rfc/rfc1738.txt) *Uniform Resource Locators (URL).*
T. Berners-Lee, L. Masinter, and M. McCahill. December
1994.
<http://www.ietf.org/rfc/rfc1738.txt>
URN
[RFC 2141](http://www.ietf.org/rfc/rfc2141.txt). *URN Syntax.* R. Moats. May
1997.

<http://www.ietf.org/rfc/rfc2141.txt>
[RFC 2611](http://www.ietf.org/rfc/rfc2611.txt). *URN Namespace Definition
Mechanisms.* L. Daigle, D. van Gulik, R. Iannella, P.
Falstrom. June 1999.

<http://www.ietf.org/rfc/rfc2611.txt>
X509v3
ITU-T Recommendation X.509 version 3 (1997). "Information
Technology - Open Systems Interconnection - The Directory
Authentication Framework"  ISO/IEC 9594-8:1997.
XHTML
1.0
[XHTML(tm) 1.0: The Extensible Hypertext Markup
Language](https://www.w3.org/TR/2000/REC-xhtml1-20000126/). W3C Recommendation. S. Pemberton, D. Raggett, et
al. January 2000.

[http://www.w3.org/TR/2000/REC-xhtml1-20000126/](https://www.w3.org/TR/2000/REC-xhtml1-20000126/)
XLink
[XML Linking Language.](https://www.w3.org/TR/2001/REC-xlink-20010627/) W3C Recommendation. S.
DeRose, E. Maler, D. Orchard. June 2001.
[http://www.w3.org/TR/2001/REC-xlink-20010627/](https://www.w3.org/TR/2001/REC-xlink-20010627/)
XML
[Extensible Markup Language (XML) 1.0 (Fourth
Edition).](https://www.w3.org/TR/2006/REC-xml-20060816/) W3C Recommendation T. Bray, E. Maler, J. Paoli,
C. M. Sperberg-McQueen, F.Yergeau. 16 August 2006, edited in
place 29 September 2006.
[http://www.w3.org/TR/2006/REC-xml-20060816/](https://www.w3.org/TR/2006/REC-xml-20060816/)
XML-C14N
[Canonical XML.](https://www.w3.org/TR/2001/REC-xml-c14n-20010315) W3C Recommendation. J. Boyer.
March 2001.
[http://www.w3.org/TR/2001/REC-xml-c14n-20010315](https://www.w3.org/TR/2001/REC-xml-c14n-20010315)

<http://www.ietf.org/rfc/rfc3076.txt>
XML-C14N11
[Canonical XML 1.1.](https://www.w3.org/TR/2008/REC-xml-c14n11-20080502/) W3C Recommendation. J. Boyer, G.
Marcy. 2 May 2008.

[http://www.w3.org/TR/2008/REC-xml-c14n11-20080502/](https://www.w3.org/TR/2008/REC-xml-c14n11-20080502/)
XML-exc-C14N
[Exclusive XML Canonicalization Version 1.0](https://www.w3.org/TR/2002/REC-xml-exc-c14n-20020718/) W3C
Recommendation. J. Boyer, D. Eastlake 3rd., J. Reagle. July
2002.

[http://www.w3.org/TR/2002/REC-xml-exc-c14n-20020718/](https://www.w3.org/TR/2002/REC-xml-exc-c14n-20020718/)
XML-Japanese
[XML Japanese Profile](https://www.w3.org/TR/2000/NOTE-japanese-xml-20000414/). W3C Note. M. Murata April 2000
[http://www.w3.org/TR/2000/NOTE-japanese-xml-20000414/](https://www.w3.org/TR/2000/NOTE-japanese-xml-20000414/)
XML-MT
[RFC 2376](http://www.ietf.org/rfc/rfc2376.txt) . *XML Media Types*. E. Whitehead,
M. Murata. July 1998.

<http://www.ietf.org/rfc/rfc2376.txt>
XML-ns
[Namespaces in XML 1.0 (Second Edition)](https://www.w3.org/TR/2006/REC-xml-names-20060816/). W3C
Recommendation. T. Bray, D. Hollander, A. Layman, R. Tobin. 16
August 2006.
[http://www.w3.org/TR/2006/REC-xml-names-20060816/](https://www.w3.org/TR/2006/REC-xml-names-20060816/)
XML-schema
[XML Schema Part 1: Structures](https://www.w3.org/TR/2004/REC-xmlschema-1-20041028/). W3C Recommendation.
H. Thompson,D. Beech, M. Maloney, N. Mendelsohn. October
2004.
[http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/](https://www.w3.org/TR/2004/REC-xmlschema-1-20041028/)

[XML Schema Part 2: Datatypes](https://www.w3.org/TR/2001/REC-xmlschema-2-20010502/) W3C
Recommendation. P. Biron, A. Malhotra. May 2001.
[http://www.w3.org/TR/2001/REC-xmlschema-2-20010502/](https://www.w3.org/TR/2001/REC-xmlschema-2-20010502/)
XML-Signature-RD
[RFC 2807](http://www.ietf.org/rfc/rfc2807.txt). [XML
Signature Requirements.](https://www.w3.org/TR/xmldsig-requirements) W3C Working Draft. J. Reagle, April
2000.

[http://www.w3.org/TR/1999/WD-xmldsig-requirements-19991014](https://www.w3.org/TR/1999/WD-xmldsig-requirements-19991014.html)

<http://www.ietf.org/rfc/rfc2807.txt>
[http://www.w3.org/TR/2002/REC-xmldsig-core-20020212//](https://www.w3.org/TR/2002/REC-xmldsig-core-20020212/)
XMLDSIG-2002
[XML-Signature Syntax and Processing](https://www.w3.org/TR/2002/REC-xmldsig-core-20020212/). D. Eastlake, J.
Reagle, and D. Solo. W3C Recommendation, February 2002.
[http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/](https://www.w3.org/TR/2002/REC-xmldsig-core-20020212/)
XPath
[XML Path Language (XPath) Version 1.0](https://www.w3.org/TR/1999/REC-xpath-19991116). W3C
Recommendation. J. Clark, S. DeRose. October 1999.

[http://www.w3.org/TR/1999/REC-xpath-19991116](https://www.w3.org/TR/1999/REC-xpath-19991116)
XPath Filter-2
[XML-Signature XPath Filter 2.0](https://www.w3.org/TR/xmldsig-filter2/). W3C Recommendation.
J. Boyer, M. Hughes, J. Reagle. November 2002.

[http://www.w3.org/TR/2002/REC-xmldsig-filter2-20021108/](https://www.w3.org/TR/2002/REC-xmldsig-filter2-20021108/)
XPTR-2001
[XML Pointer Language (XPointer)](https://www.w3.org/TR/2001/CR-xptr-20010911/). W3C Candidate
Recommendation. S. DeRose, R. Daniel, E. Maler. January
2001.
[http://www.w3.org/TR/2001/CR-xptr-20010911/](https://www.w3.org/TR/2001/CR-xptr-20010911/)
XPointer-Element
[XPointer element() Scheme](https://www.w3.org/TR/2003/REC-xptr-element-20030325/). W3C Recommendation. P.
Grosso, E. Maler, J. Marsh, N. Walsh. March 2003.
[http://www.w3.org/TR/2003/REC-xptr-element-20030325/](https://www.w3.org/TR/2003/REC-xptr-element-20030325/)
XPointer-Framework
[XPointer Framework](https://www.w3.org/TR/2003/REC-xptr-framework-20030325/). W3C Recommendation. P. Grosso,
E. Maler, J. Marsh, N. Walsh. March 2003.
[http://www.w3.org/TR/2003/REC-xptr-framework-20030325/](https://www.w3.org/TR/2003/REC-xptr-framework-20030325/)
XPointer-xpointer
[XPointer xpointer() Scheme](https://www.w3.org/TR/2002/WD-xptr-xpointer-20021219/). W3C Working Draft. S.
DeRose, E. Maler, R. Daniel. December 2002.
[http://www.w3.org/TR/2002/WD-xptr-xpointer-20021219/](https://www.w3.org/TR/2002/WD-xptr-xpointer-20021219/)
XPointer-xmlns
[XPointer xmlns() Scheme](https://www.w3.org/TR/2003/REC-xptr-xmlns-20030325/). W3C Working Recommendation.
S. DeRose, R. Daniel, E. Maler, J. Marsh. March 2003.
[http://www.w3.org/TR/2003/REC-xptr-xmlns-20030325/](https://www.w3.org/TR/2003/REC-xptr-xmlns-20030325/)
[http://www.w3.org/TR/2001/REC-xsl-20011015/](https://www.w3.org/TR/2001/REC-xsl-20011015/)
XSLT
[XSL Transforms (XSLT) Version 1.0](https://www.w3.org/TR/1999/REC-xslt-19991116.html). W3C
Recommendation. J. Clark. November 1999.
[http://www.w3.org/TR/1999/REC-xslt-19991116.html](https://www.w3.org/TR/1999/REC-xslt-19991116.html)
## 12. Authors' Address

Donald E. Eastlake 3rd

Motorola Laboratories

111 Locke Drive

Marlborough, MA 01752 USA

Phone: +1-508-786-7554

Email: d3e3e3@gmail.com

Joseph M. Reagle Jr.

Department of Media, Culture, and Communication

New York University

Email: reagle@mit.edu

David Solo

Citigroup

909 Third Ave, 16th Floor

NY, NY 10043 USA

Phone +1-212-559-2900

Email: dsolo@alum.mit.edu



=== Content from security.netapp.com_0fc978e2_20250111_141427.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-32962 Node.js Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240705-0003)

## CVE-2024-32962 Node.js Vulnerability in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240705-0003 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240705-0003 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240705-0003 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240705-0003 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240705-0003
**Version:**
2.0

**Last updated:**
08/01/2024

**Status:**
Final.

**CVEs:** CVE-2024-32962

Overview
#### Summary

Multiple NetApp products incorporate Node.js. Node.js package xml-crypto versions 4.0.0 prior to 6.0.0 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information or addition or modification of data.

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information or addition or modification of data.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-32962](https://nvd.nist.gov/vuln/detail/CVE-2024-32962) | 10.0 (CRITICAL) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://github.com/node-saml/xml-crypto/security/advisories/GHSA-2xp3-57p7-qf4v>

Affected Products
#### Affected Products

None.

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 10
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

For questions, contact NetApp at:

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240705-0003>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240705 | Initial Public Release |
| 2.0 | 20240801 | Brocade SAN Navigator (SANnav) moved to Products Not Affected, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from github.com_a3abbbf3_20250111_141424.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fpull%2F301)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fpull%2F301)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=node-saml%2Fxml-crypto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-saml](/node-saml)
/
**[xml-crypto](/node-saml/xml-crypto)**
Public

* [Notifications](/login?return_to=%2Fnode-saml%2Fxml-crypto) You must be signed in to change notification settings
* [Fork
  173](/login?return_to=%2Fnode-saml%2Fxml-crypto)
* [Star
   201](/login?return_to=%2Fnode-saml%2Fxml-crypto)

* [Code](/node-saml/xml-crypto)
* [Issues
  36](/node-saml/xml-crypto/issues)
* [Pull requests
  13](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects
  0](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

Additional navigation options

* [Code](/node-saml/xml-crypto)
* [Issues](/node-saml/xml-crypto/issues)
* [Pull requests](/node-saml/xml-crypto/pulls)
* [Discussions](/node-saml/xml-crypto/discussions)
* [Actions](/node-saml/xml-crypto/actions)
* [Projects](/node-saml/xml-crypto/projects)
* [Wiki](/node-saml/xml-crypto/wiki)
* [Security](/node-saml/xml-crypto/security)
* [Insights](/node-saml/xml-crypto/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fnode-saml%2Fxml-crypto%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fnode-saml%2Fxml-crypto%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add support for <X509Certificate /> in <KeyInfo />; remove `KeyInfoProvider` #301

 Merged

[cjbarth](/cjbarth)
merged 27 commits into
[node-saml:master](/node-saml/xml-crypto/tree/master "node-saml/xml-crypto:master")
from
[cjbarth:key-info](/cjbarth/xml-crypto/tree/key-info "cjbarth/xml-crypto:key-info")

Jun 17, 2023

 Merged

# [Add support for <X509Certificate /> in <KeyInfo />; remove `KeyInfoProvider`](#top) #301

[cjbarth](/cjbarth)
merged 27 commits into
[node-saml:master](/node-saml/xml-crypto/tree/master "node-saml/xml-crypto:master")
from
[cjbarth:key-info](/cjbarth/xml-crypto/tree/key-info "cjbarth/xml-crypto:key-info")

Jun 17, 2023

[Conversation
85](/node-saml/xml-crypto/pull/301)
[Commits
27](/node-saml/xml-crypto/pull/301/commits)
[Checks
0](/node-saml/xml-crypto/pull/301/checks)
[Files changed](/node-saml/xml-crypto/pull/301/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![cjbarth](https://avatars.githubusercontent.com/u/3049726?s=60&v=4)](/cjbarth)

Copy link

Contributor

### @cjbarth **[cjbarth](/cjbarth)** commented [Jun 8, 2023](#issue-1748589931) • edited Loading

This [PR](https://github.com/node-saml/node-saml/pull/36) makes reference to how our handling of certificates in `<KeyInfo />` is incorrect. The documentation for this is [here](https://www.w3.org/TR/2008/REC-xmldsig-core-20080610/#sec-X509Data).

Further information about this can be found in [this](https://github.com/node-saml/xml-crypto/pull/295#discussion_r1220100389) comment thread.

Sorry, something went wrong.

All reactions

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 8, 2023](#issuecomment-1583321856)

| [@shunkica](https://github.com/shunkica), [@LoneRifle](https://github.com/LoneRifle), [@markstos](https://github.com/markstos), [@ganesha289](https://github.com/ganesha289), I've made changes to `KeyInfo` handling and cleaned a lot of things up. I renamed things, so this too is a breaking change, but I think it makes things much clearer. Please let me know what you think and feel free to review the code. |
| --- |

All reactions

Sorry, something went wrong.

 [![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
requested review from
[djaqua](/djaqua),
[markstos](/markstos) and
[LoneRifle](/LoneRifle)
[June 8, 2023 20:47](#event-9476800546)

[![LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=60&v=4)](/LoneRifle)

**[LoneRifle](/LoneRifle)**
requested changes
[Jun 9, 2023](#pullrequestreview-1471055408)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files)

Copy link

Collaborator

### @LoneRifle **[LoneRifle](/LoneRifle)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

lgtm otherwise

Sorry, something went wrong.

All reactions

[lib/key-info.js](/node-saml/xml-crypto/pull/301/files#diff-488667dc0b5df270fff2c3734fd2f6873fb1722888f8d2097a74fa6b22736e94)
Outdated

Show resolved

Hide resolved

[lib/key-info.js](/node-saml/xml-crypto/pull/301/files#diff-488667dc0b5df270fff2c3734fd2f6873fb1722888f8d2097a74fa6b22736e94)
Outdated

Show resolved

Hide resolved

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
reviewed
[Jun 9, 2023](#pullrequestreview-1471252503)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files)

[index.d.ts](/node-saml/xml-crypto/pull/301/files#diff-7aa4473ede4abd9ec099e87fec67fd57afafaf39e05d493ab4533acc38547eb8)
Outdated

Show resolved

Hide resolved

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
suggested changes
[Jun 9, 2023](#pullrequestreview-1471261482)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files)

[lib/file-key-info.js](/node-saml/xml-crypto/pull/301/files#diff-d7157458e078eb19be41d20e6dbd53d737989a4108e225f67170fd190fa272b5)
Outdated

Show resolved

Hide resolved

[lib/key-info.js](/node-saml/xml-crypto/pull/301/files#diff-488667dc0b5df270fff2c3734fd2f6873fb1722888f8d2097a74fa6b22736e94)
Outdated

Show resolved

Hide resolved

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
reviewed
[Jun 9, 2023](#pullrequestreview-1471334378)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files)

[lib/key-info.js](/node-saml/xml-crypto/pull/301/files#diff-488667dc0b5df270fff2c3734fd2f6873fb1722888f8d2097a74fa6b22736e94)
Outdated

Show resolved

Hide resolved

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
suggested changes
[Jun 9, 2023](#pullrequestreview-1471375165)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files)

[lib/signed-xml.js](/node-saml/xml-crypto/pull/301/files#diff-58844ae8b1185b1627e00b2245f3fdcc5a8710438289e4555a0970ca8ae89fa6)
Outdated

Show resolved

Hide resolved

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
reviewed
[Jun 9, 2023](#pullrequestreview-1471386999)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files)

[index.d.ts](/node-saml/xml-crypto/pull/301/files#diff-7aa4473ede4abd9ec099e87fec67fd57afafaf39e05d493ab4533acc38547eb8)
Outdated

Show resolved

Hide resolved

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Jun 9, 2023](#issuecomment-1584704149) • edited Loading

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://app.codecov.io/gh/node-saml/xml-crypto/pull/301?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml) Report Merging [#301](https://app.codecov.io/gh/node-saml/xml-crypto/pull/301?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml) ([599ca5a](https://github.com/node-saml/xml-crypto/commit/599ca5a24a69c4710d0ba125ffd278f466e7aef4)) into [master](https://app.codecov.io/gh/node-saml/xml-crypto/commit/67b3a78586c3f740fb01ed963aee025c77fb1702?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml) ([67b3a78](https://github.com/node-saml/xml-crypto/commit/67b3a78586c3f740fb01ed963aee025c77fb1702)) will **increase** coverage by `1.70%`. The diff coverage is `98.41%`.  ❗ Current head [599ca5a](https://github.com/node-saml/xml-crypto/commit/599ca5a24a69c4710d0ba125ffd278f466e7aef4) differs from pull request most recent head [aa2f62f](https://github.com/node-saml/xml-crypto/commit/aa2f62f23bac9c8622fee6958b2b1af000088a0b). Consider uploading reports for the commit [aa2f62f](https://github.com/node-saml/xml-crypto/commit/aa2f62f23bac9c8622fee6958b2b1af000088a0b) to get more accurate results  ``` @@            Coverage Diff             @@ ##           master     #301      +/-   ## ========================================== + Coverage   81.04%   82.74%   +1.70%      ==========================================   Files           7        5       -2        Lines         865      875      +10      ========================================== + Hits          701      724      +23      + Misses        164      151      -13      ```  | [Impacted Files](https://app.codecov.io/gh/node-saml/xml-crypto/pull/301?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml) | Coverage Δ |  | | --- | --- | --- | | [lib/signed-xml.js](https://app.codecov.io/gh/node-saml/xml-crypto/pull/301?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml#diff-bGliL3NpZ25lZC14bWwuanM=) | `83.36% <97.77%> (+2.09%)` | ⬆️ | | [lib/utils.js](https://app.codecov.io/gh/node-saml/xml-crypto/pull/301?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml#diff-bGliL3V0aWxzLmpz) | `97.91% <100.00%> (+1.25%)` | ⬆️ |   📣 We’re building smart automated test selection to slash your CI/CD build times. [Learn more](https://about.codecov.io/iterative-testing/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=node-saml) |

All reactions

Sorry, something went wrong.

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
suggested changes
[Jun 9, 2023](#pullrequestreview-1472875516)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files)

[lib/file-key-info.js](/node-saml/xml-crypto/pull/301/files#diff-d7157458e078eb19be41d20e6dbd53d737989a4108e225f67170fd190fa272b5)
Outdated

Show resolved

Hide resolved

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
reviewed
[Jun 9, 2023](#pullrequestreview-1472896594)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files)

[lib/file-key-info.js](/node-saml/xml-crypto/pull/301/files#diff-d7157458e078eb19be41d20e6dbd53d737989a4108e225f67170fd190fa272b5)
Outdated

Show resolved

Hide resolved

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
mentioned this pull request
[Jun 10, 2023](#ref-pullrequest-1743622778)

[Typings
#295](/node-saml/xml-crypto/pull/295)
 Merged

[![@djaqua](https://avatars.githubusercontent.com/u/7017731?s=80&u=0304f25279c8e8eb45c1f73c42dd56b63937b6f6&v=4)](/djaqua)

Copy link

Contributor

### **[djaqua](/djaqua)** commented [Jun 10, 2023](#issuecomment-1585827692)

| [@cjbarth](https://github.com/cjbarth) [@LoneRifle](https://github.com/LoneRifle) [@shunkica](https://github.com/shunkica)  Okay, again, sorry for the late response here, took me a minute to catch up with what's going on.  Here's my high level thoughts (without writing a novel like I did for that other conversation):   1. I love the `getKeyInfoContent` function 2. I think it offering X509Certificate functionality out of the box is a **great** idea 3. I think it binding KeyInfo to the X509Certificate is a road we should not go down   I know you guys have lives and that the last thing any developer wants is another meeting, but I think it would be really really beneficial if we have a discussion about this project and figure out how to tactfully cross some bridges.  If you guys don't want a meeting, I'll have to write a novel to explain why I think we should not bind KeyInfo to X509Certificate  But I'm not a complainer; I wouldn't drag my feet on this if I didn't have a reasonable solution. The gist of my solution is that we could and should knock off the two suggestions that I wrote in my novel yesterday before proceeding with anything X509Certificate:   1. Deprecate SignedXml.signingKey in favor of using SignedXml.privateKey and SignedXml.publicKey 2. Implement a Facade like [lukaszmakuch](https://github.com/lukaszmakuch) suggested in [this discussion](#240)   So then we could move onto X509Certificate by replacing KeyInfoProvider altogether. The totally bodacious paradigm would be to have something called `X509CertificateKeyInfoBuilder` with the function `getKeyInfoContent` implemented as you have it. |
| --- |

 👍
1
 LoneRifle reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=80&u=aaed659f3a4c32cf2034f1da1af91bd76f5ddd2a&v=4)](/LoneRifle)

Copy link

Collaborator

### **[LoneRifle](/LoneRifle)** commented [Jun 11, 2023](#issuecomment-1586006322)

| I'll have to write a novel to explain why I think we should not bind KeyInfo to X509Certificate  [@djaqua](https://github.com/djaqua) might actually be helpful, so we can read async and come to any proposed meeting with working knowledge. It also documents in some manner a critical decision we are about to make with this package. |
| --- |

 👍
1
 djaqua reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=80&u=aaed659f3a4c32cf2034f1da1af91bd76f5ddd2a&v=4)](/LoneRifle)

Copy link

Collaborator

### **[LoneRifle](/LoneRifle)** commented [Jun 11, 2023](#issuecomment-1586009642)

| I think it is very clear that we have issues to address with respect to the design of this package (specifically around KeyInfo generation) before we can consider implementing support for X509 certificates.  [@cjbarth](https://github.com/cjbarth) - I would like to suggest that maybe we close this PR for now, and overhaul KeyInfoProvider/SignedXml. Once that is in place, we might be in a better position to add X509 support.  wdyt? |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 11, 2023](#issuecomment-1586220876)

| 1. Deprecate SignedXml.signingKey in favor of using SignedXml.privateKey and SignedXml.publicKey  This seems reasonable. I've pushed up a change to make this `privateKey` and `publicCert` instead of `signingKey` and `signingCert`, respectively. |
| --- |

 👍
1
 djaqua reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 11, 2023](#issuecomment-1586221810)

| I would like to suggest that maybe we close this PR for now, and overhaul KeyInfoProvider/SignedXml. Once that is in place, we might be in a better position to add X509 support.  I'd rather see if we can find some middle ground with this PR. I haven't seen any concrete proposals that we can action on yet. This is the closest thing we have to something that works. The HMAC thing is the biggest outlier, and I haven't seen consensus that we want to drop support for that. |
| --- |

 👀
1
 djaqua reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 11, 2023](#issuecomment-1586226258)

| I think the next step is to make it so this class can't be instantiated and adjust the tests to match that. Feel free to push up a commit to this branch that does that. Once we do that, the concept of `FileKeyInfo` will be meaningless and can be removed. Users will be responsible for reading their own files. We already have helper methods to convert between PEM and DER, so that can help users.  I suggest starting with something like this and going from there:  ``` class KeyInfo {   constructor() {     throw Error("This class is static; you may not instantiate it.");   } ... ```  If we leave it as a class, then it still allows people to `extends` it should they need to which allows a 'plugable' feel to this part of the library. |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 11, 2023](#issuecomment-1586239472)

| The other option that was presented here, which I'm starting to like the more that I think about it, is to put most of the new stuff in `KeyInfo` into a utility class and then add two properties to `SignXml`: `getKeyInfoContent` and `getCertFromKeyInfo`. We can provide defaults for these properties, but still allow others to override them. They they can decide what they want their own cert to do when validating. Thoughts? |
| --- |

 👍
1
 djaqua reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 11, 2023](#issuecomment-1586377222)

| I can revert this last commit if you all don't like the direction, but I think this really simplifies things. I have a few tests to review after this bulk refactor; I'm not sure why they are failing. Let me know what you think of this direction. |
| --- |

All reactions

Sorry, something went wrong.

[![@djaqua](https://avatars.githubusercontent.com/u/7017731?s=80&u=0304f25279c8e8eb45c1f73c42dd56b63937b6f6&v=4)](/djaqua)

Copy link

Contributor

### **[djaqua](/djaqua)** commented [Jun 12, 2023](#issuecomment-1586494419)

| [@cjbarth](https://github.com/cjbarth) & [@LoneRifle](https://github.com/LoneRifle)  The more I thought about it, the more I realized that I don't really need to write a novel to explain, so let me attempt to do so concisely:  X509 is one of potentially many paradigms that XML digital signatures can work with. Another one right off the top of my head is the `SecurityTokenReference` element (a child of `KeyInfo`) in conjunction with a `BinarySecurityToken` from the WS-Security specs.  I would not default to using X509 because the default behavior of the current implementation is to skip building a KeyInfo element altogether (`SignedXml.prototype.getKeyInfo`). If we default to building an X509 thingamajig, that could purposelessly screw up clients who may have written tests to validate their XML against their own schemas. I do understand that this is an inherently breaking change so their stuff is going to break anyways, but we should give clients the option to skip building a KeyInfo element since its not strictly required by the schema.  As a reasonable best-of-all-worlds solution, I would like to propose the following (and see the big NOTE below):   * define a KeyInfoStrategy class that does nothing by default, and default to using this when a client doesn't specify otherwise * define an X509KeyInfoStrategy class that builds the X509 stuff; make clients manually choose this   My main hesitation to get onboard with these high quality changes (they really are -- I'm not here to knock the code or the idea at all) is that, learning from our experience with `KeyInfoProvider`, we would do well to be very annoyingly thoughtful about the consequences of our decisions around the complexity-inducing `KeyInfo` element. Some things to be annoyingly thoughtful about:   * method signatures (i.e. function parameter lists) -- these should be implementation-agnostic * method parameter and return types -- all strings? all xpath objects (e.g. Node, Element, etc)? combinations thereof? * method names -- I love `getCertFromKeyInfo` but I would prefer `createKeyInfoContent` to `getKeyInfoContent` (see the NOTE below)   That's pretty much my thoughts, here. I'm neither a dictator nor in charge of this project, so if there is disagreement about these concerns, lets continue the discussion 😃  NOTE I am very strongly opinionated about naming conventions. I welcome discussions and I'm open to alternative suggestions, so if anyone else feels strongly about such things, lets have the discussions 😄 , otherwise, if it's all the same to y'all, lets just do it my way 😈 😆 |
| --- |

All reactions

Sorry, something went wrong.

[![@djaqua](https://avatars.githubusercontent.com/u/7017731?s=80&u=0304f25279c8e8eb45c1f73c42dd56b63937b6f6&v=4)](/djaqua)

Copy link

Contributor

### **[djaqua](/djaqua)** commented [Jun 12, 2023](#issuecomment-1586494976)

| And yes I am aware that I said "concisely" and proceeded to write a novel anyway 😅 |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 12, 2023](#issuecomment-1587142086)

| I've fixed the tests and taken your naming suggestion [@djaqua](https://github.com/djaqua).  I'd like to hear more about what you have to say about method signatures. I'm inclined to pass an object with properties to those functions, thereby allowing a custom implementation to work with other values as needed. As the need arises, we can easily, and without breaking, add more properties to the object we send for use-cases we don't see yet. |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 12, 2023](#issuecomment-1587159210)

| [@djaqua](https://github.com/djaqua) , have a look at that latest commit and let me know if that will address your concerns. |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 13, 2023](#issuecomment-1589861546)

| I am very strongly opinionated about naming conventions. I welcome discussions and I'm open to alternative suggestions, so if anyone else feels strongly about such things, lets have the discussions 😄 , otherwise, if it's all the same to y'all, lets just do it my way 😈 😆  I was thinking more about this, and it would be nice to have a convention. I did some googling and came across [this](https://github.com/kettanaito/naming-cheatsheet), which seems like a well-liked (12.7k stars) opinion. [@djaqua](https://github.com/djaqua) , do you have a different reference you use? If not, I propose to avoid bike-shedding and use this. |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 14, 2023](#issuecomment-1591546850)

| [@djaqua](https://github.com/djaqua) [@LoneRifle](https://github.com/LoneRifle) [@shunkica](https://github.com/shunkica) , I really appreciate your feedback on this. I think I'm ready to land this PR if it doesn't have any objections from you all. I'd really appreciate it if someone could take a look at this, perhaps after it lands, and make sure the documentation, along with a little note about the changes, is updated. It would also be good to include a documentation note about the naming convention that seems worth following [here](https://github.com/kettanaito/naming-cheatsheet). If [@markstos](https://github.com/markstos) agrees, I'd actually like to roll that out to `node-saml` and `passport-saml` as well so that there can be consistency in the organization.  There are a few other things that I'd like to get done in this major release before cutting it, like upgrading the code to not use `var` and clear up other linting warnings. I'd really like to get a major release out so that we can include it in the next `node-saml` and `passport-saml` major releases which are starting to get over-due; we try to release them about the time that NodeJS does their major release/deprecation. |
| --- |

All reactions

Sorry, something went wrong.

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
reviewed
[Jun 14, 2023](#pullrequestreview-1480071831)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files)

[README.md](/node-saml/xml-crypto/pull/301/files#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
Outdated

Show resolved

Hide resolved

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth)

`[Replace KeyInfoProvider with plugable methods](/node-saml/xml-crypto/pull/301/commits/280075beff08263a10cd5e42eb7354f2dcc175ef "Replace `KeyInfoProvider` with plugable methods")`

`[280075b](/node-saml/xml-crypto/pull/301/commits/280075beff08263a10cd5e42eb7354f2dcc175ef)`

20 hidden items

Load more…

 Ivan
added 8 commits
[June 15, 2023 10:01](#commits-pushed-3cb410f)

`[fix broken tests](/node-saml/xml-crypto/pull/301/commits/3cb410f7825a63143ed6898f4c9825826061c1f3 "fix broken tests")`

`[3cb410f](/node-saml/xml-crypto/pull/301/commits/3cb410f7825a63143ed6898f4c9825826061c1f3)`

`[fix bug](/node-saml/xml-crypto/pull/301/commits/40f1e8f6ac50d13163ae76b399d2e79a4ffd7157 "fix bug")`

`[40f1e8f](/node-saml/xml-crypto/pull/301/commits/40f1e8f6ac50d13163ae76b399d2e79a4ffd7157)`

`[fix bug](/node-saml/xml-crypto/pull/301/commits/530f34e11d94db5c5620bdac6dece38c86638932 "fix bug")`

`[530f34e](/node-saml/xml-crypto/pull/301/commits/530f34e11d94db5c5620bdac6dece38c86638932)`

`[add test (failing) to make sure private keys are not added to the Key…](/node-saml/xml-crypto/pull/301/commits/0a5cff58be8c7d821953c4639aa26a6b3cbfc1b0 "add test (failing) to make sure private keys are not added to the KeyInfo")`
 …

`[0a5cff5](/node-saml/xml-crypto/pull/301/commits/0a5cff58be8c7d821953c4639aa26a6b3cbfc1b0)`

```
…Info
```

`[add pem file which containts both public and private key](/node-saml/xml-crypto/pull/301/commits/04a4915fae4414cce5e76dee7afc5a927d748c3f "add pem file which containts both public and private key")`

`[04a4915](/node-saml/xml-crypto/pull/301/commits/04a4915fae4414cce5e76dee7afc5a927d748c3f)`

`[revert var to const change (eslint did it)](/node-saml/xml-crypto/pull/301/commits/2acd2eeb587d7cc813cb9263a9b068fa6af57764 "revert var to const change (eslint did it)")`

`[2acd2ee](/node-saml/xml-crypto/pull/301/commits/2acd2eeb587d7cc813cb9263a9b068fa6af57764)`

`[make SignatureAlgorithms, HashAlgorithms and CanonicalizationAlgorith…](/node-saml/xml-crypto/pull/301/commits/eaceb0816255c8aab09022f851f14f2487772e78 "make SignatureAlgorithms, HashAlgorithms and CanonicalizationAlgorithms instance members of SignedXml")`
 …

`[eaceb08](/node-saml/xml-crypto/pull/301/commits/eaceb0816255c8aab09022f851f14f2487772e78)`

```
…ms instance members of SignedXml
```

`[only put actual x509 certificates in the X509Certificate element](/node-saml/xml-crypto/pull/301/commits/833645460e7f81e9cb316754fd1054a26a542175 "only put actual x509 certificates in the X509Certificate element")`

`[8336454](/node-saml/xml-crypto/pull/301/commits/833645460e7f81e9cb316754fd1054a26a542175)`

[![@shunkica](https://avatars.githubusercontent.com/u/11718584?s=80&u=aec5c4c24e156a86d66b002133b5ea568916c8a9&v=4)](/shunkica)

Copy link

Contributor

### **[shunkica](/shunkica)** commented [Jun 15, 2023](#issuecomment-1592699766)

| I have created a [pull request](https://github.com/cjbarth/xml-crypto/pull/1)  addressing some bugs and issues that were discussed. |
| --- |

All reactions

Sorry, something went wrong.

 Ivan
and others
added 6 commits
[June 15, 2023 11:53](#commits-pushed-1669c68)

`[improve test](/node-saml/xml-crypto/pull/301/commits/1669c681e760cb5ae46a73f42d65072e8cda6413 "improve test")`

`[1669c68](/node-saml/xml-crypto/pull/301/commits/1669c681e760cb5ae46a73f42d65072e8cda6413)`

`[test with two public certificates](/node-saml/xml-crypto/pull/301/commits/c6a29f40643fe87c04b0845b20e3439cb0bb3299 "test with two public certificates")`

`[c6a29f4](/node-saml/xml-crypto/pull/301/commits/c6a29f40643fe87c04b0845b20e3439cb0bb3299)`

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth)

`[Merge remote-tracking branch 'upstream/master' into key-info](/node-saml/xml-crypto/pull/301/commits/be08a46786eb21e904482d4cc4aac5b9fed06392 "Merge remote-tracking branch 'upstream/master' into key-info")`

`[be08a46](/node-saml/xml-crypto/pull/301/commits/be08a46786eb21e904482d4cc4aac5b9fed06392)`

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth)

`[Merge branch 'master' into key-info](/node-saml/xml-crypto/pull/301/commits/32b237a0d88c238f5d1c9994b8409e839939007b "Merge branch 'master' into key-info")`

`[32b237a](/node-saml/xml-crypto/pull/301/commits/32b237a0d88c238f5d1c9994b8409e839939007b)`

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth)

`[Merge pull request](/node-saml/xml-crypto/pull/301/commits/23403204943707cc82094903debfa37bb4bc03a4 "Merge pull request #1 from shunkica/key-info

Fix broken tests and only put certificates in the X509Certificate element") [#1](https://github.com/cjbarth/xml-crypto/pull/1) [from shunkica/key-info](/node-saml/xml-crypto/pull/301/commits/23403204943707cc82094903debfa37bb4bc03a4 "Merge pull request #1 from shunkica/key-info

Fix broken tests and only put certificates in the X509Certificate element")`
 …

`[2340320](/node-saml/xml-crypto/pull/301/commits/23403204943707cc82094903debfa37bb4bc03a4)`

```
Fix broken tests and only put certificates in the X509Certificate element
```

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth)

`[Merge remote-tracking branch 'origin/key-info' into key-info](/node-saml/xml-crypto/pull/301/commits/f87d4b8e62968d23137f8b0589dff49a60c56b88 "Merge remote-tracking branch 'origin/key-info' into key-info")`

`[f87d4b8](/node-saml/xml-crypto/pull/301/commits/f87d4b8e62968d23137f8b0589dff49a60c56b88)`

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
reviewed
[Jun 15, 2023](#pullrequestreview-1482351804)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files/abcf25e4896601432b287219f2d9bceb23c222c3)

[index.d.ts](/node-saml/xml-crypto/pull/301/files/abcf25e4896601432b287219f2d9bceb23c222c3#diff-7aa4473ede4abd9ec099e87fec67fd57afafaf39e05d493ab4533acc38547eb8)
Outdated

Show resolved

Hide resolved

 [cjbarth](/cjbarth)
and others
added 2 commits
[June 15, 2023 17:46](#commits-pushed-599ca5a)

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth) [![@shunkica](https://avatars.githubusercontent.com/u/11718584?s=40&v=4)](/shunkica)

`[Update index.d.ts](/node-saml/xml-crypto/pull/301/commits/599ca5a24a69c4710d0ba125ffd278f466e7aef4 "Update index.d.ts

Co-authored-by: shunkica <ivannovak90@gmail.com>")`
 …

`[599ca5a](/node-saml/xml-crypto/pull/301/commits/599ca5a24a69c4710d0ba125ffd278f466e7aef4)`

```
Co-authored-by: shunkica <ivannovak90@gmail.com>
```

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&v=4)](/cjbarth)

`[remove static](/node-saml/xml-crypto/pull/301/commits/aa2f62f23bac9c8622fee6958b2b1af000088a0b "remove static")`

`[aa2f62f](/node-saml/xml-crypto/pull/301/commits/aa2f62f23bac9c8622fee6958b2b1af000088a0b)`

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=80&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

Copy link

Contributor

Author

### **[cjbarth](/cjbarth)** commented [Jun 15, 2023](#issuecomment-1593764204)

| Thanks to much work by [@shunkica](https://github.com/shunkica) , I think we are ready to merge. Are there any final comments [@LoneRifle](https://github.com/LoneRifle) or [@djaqua](https://github.com/djaqua) ? I'll leave this open all weekend to give you a chance to look and then we'll merge it late on Monday.  I really appreciate all of your comments. I feel that we have something here that really cleans up the interface a lot, but which doesn't over-engineer this for use-cases that are unidentified. |
| --- |

All reactions

Sorry, something went wrong.

[![shunkica](https://avatars.githubusercontent.com/u/11718584?s=60&v=4)](/shunkica)

**[shunkica](/shunkica)**
reviewed
[Jun 15, 2023](#pullrequestreview-1482470769)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files/599ca5a24a69c4710d0ba125ffd278f466e7aef4)

[index.d.ts](/node-saml/xml-crypto/pull/301/files/599ca5a24a69c4710d0ba125ffd278f466e7aef4#diff-7aa4473ede4abd9ec099e87fec67fd57afafaf39e05d493ab4533acc38547eb8)

Show resolved

Hide resolved

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
changed the title
~~Add support for <X509Certificate /> in <KeyInfo />~~
Add support for <X509Certificate /> in <KeyInfo />; remove `KeyInfoProvider`
[Jun 16, 2023](#event-9551070632)

 [![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=40&u=aaed659f3a4c32cf2034f1da1af91bd76f5ddd2a&v=4)](/LoneRifle)
[LoneRifle](/LoneRifle)
self-requested a review
[June 17, 2023 01:21](#event-9557337619)

[![LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=60&v=4)](/LoneRifle)

**[LoneRifle](/LoneRifle)**
approved these changes
[Jun 17, 2023](#pullrequestreview-1484630168)

 [View reviewed changes](/node-saml/xml-crypto/pull/301/files/aa2f62f23bac9c8622fee6958b2b1af000088a0b)

Copy link

Collaborator

### @LoneRifle **[LoneRifle](/LoneRifle)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Let's get this one through for now, we'll figure out further changes along the way

Sorry, something went wrong.

All reactions

[![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=80&u=aaed659f3a4c32cf2034f1da1af91bd76f5ddd2a&v=4)](/LoneRifle)

Copy link

Collaborator

### **[LoneRifle](/LoneRifle)** commented [Jun 17, 2023](#issuecomment-1595588264)

| [@cjbarth](https://github.com/cjbarth) - feel free to merge! |
| --- |

All reactions

Sorry, something went wrong.

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
added
[semver-major](/node-saml/xml-crypto/labels/semver-major)
[breaking-change](/node-saml/xml-crypto/labels/breaking-change)
labels
[Jun 17, 2023](#event-9558346746)

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
merged commit [`c2b83f9`](/node-saml/xml-crypto/commit/c2b83f984049edb68ad1d7c6ad0739ec92af11ca)
into
node-saml:master

[Jun 17, 2023](https://github.com/node-saml/xml-crypto/pull/301#event-9558348362)

 [![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)
[cjbarth](/cjbarth)
deleted the
key-info

branch
[June 17, 2023 09:49](#event-9558348461)

[![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=40&u=aaed659f3a4c32cf2034f1da1af91bd76f5ddd2a&v=4)](/LoneRifle)
[LoneRifle](/LoneRifle)
mentioned this pull request
[Jun 18, 2023](#ref-issue-254023676)

[Include <X509Certificate>
#140](/node-saml/xml-crypto/issues/140)

Closed

[![@darioackermann](https://avatars.githubusercontent.com/u/35274810?s=40&v=4)](/darioackermann)
[darioackermann](/darioackermann)
mentioned this pull request
[Jul 24, 2023](#ref-pullrequest-1818934746)

[Bump xml-crypto from 3.2.0 to 4.0.1
darioackermann/saml2-js#9](/darioackermann/saml2-js/pull/9)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-saml%2Fxml-crypto%2Fpull%2F301)

Reviewers

[![@shunkica](https://avatars.githubusercontent.com/u/11718584?s=40&v=4)](/shunkica) [shunkica](/shunkica)

shunkica requested changes

[![@bawolff](https://avatars.githubusercontent.com/u/6529932?s=40&v=4)](/bawolff) [bawolff](/bawolff)

bawolff left review comments

[![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=40&v=4)](/LoneRifle) [LoneRifle](/LoneRifle)

LoneRifle approved these changes

[![@djaqua](https://avatars.githubusercontent.com/u/7017731?s=40&v=4)](/djaqua) [djaqua](/djaqua)

 Awaiting requested review from djaqua

[![@markstos](https://avatars.githubusercontent.com/u/25829?s=40&v=4)](/markstos) [markstos](/markstos)

 Awaiting requested review from markstos

Assignees

No one assigned

Labels

[breaking-change](/node-saml/xml-crypto/labels/breaking-change)
[semver-major](/node-saml/xml-crypto/labels/semver-major)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=52&v=4)](/cjbarth) [![@djaqua](https://avatars.githubusercontent.com/u/7017731?s=52&v=4)](/djaqua) [![@LoneRifle](https://avatars.githubusercontent.com/u/10572368?s=52&v=4)](/LoneRifle) [![@shunkica](https://avatars.githubusercontent.com/u/11718584?s=52&v=4)](/shunkica) [![@bawolff](https://avatars.githubusercontent.com/u/6529932?s=52&v=4)](/bawolff)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


