### Summary
The provided content details a Reflected Cross-Site Scripting (XSS) vulnerability in the "XT Ajax Add To Cart for WooCommerce" WordPress plugin, specifically in versions 1.1.2 and earlier. The vulnerability is due to the improper use of the `add_query_arg` function without proper escaping on the URL, which allows attackers to inject malicious web scripts.

### Root cause of vulnerability
The vulnerability stems from the plugin's usage of `add_query_arg` without proper output sanitization, which leads to the generation of a URL that can be manipulated to include malicious JavaScript code.

### Weaknesses/vulnerabilities
- **Reflected Cross-Site Scripting (XSS):** The primary vulnerability is the ability to inject and execute arbitrary JavaScript code within the context of a user's browser.

### Impact of exploitation
Successful exploitation of this vulnerability could allow an attacker to:
- **Execute malicious scripts:** An attacker can execute arbitrary JavaScript code in the victim's browser.
- **Session hijacking:** The attacker might be able to steal session cookies, leading to unauthorized access to a user's account.
- **Data theft:** Malicious scripts could be used to steal sensitive information from the user or the website.
- **Website defacement:** Attackers could alter the website's appearance or functionality.
- **Malware distribution:** The attacker could redirect users to malicious websites or force them to download malware.
- **Phishing:** The attacker can create fake login forms to harvest user credentials.

### Attack vectors
- **Malicious URL:** Attackers can craft a malicious URL that, when clicked by a user, will execute the injected JavaScript code within their browser.
- **Social Engineering:** The attacker needs to trick a user to click the malicious URL.

### Required attacker capabilities/position
- **No authentication required:** The vulnerability can be exploited by unauthenticated attackers.
- **Social Engineering:**  The attacker must be able to induce a user to click a crafted URL.

### Additional details
- The vulnerability was found by researcher [vgo0](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/dale-mavers).
- The vulnerability was fixed in version 1.1.3 of the plugin, which includes a fix that sanitizes the URL with `esc_url` before using the add_query_arg function.
- The vulnerable code is located in the `class-system-status.php` file.

**Specific Code Change:**
The fix involves using `esc_url` when generating the URLs in the system status page:
```diff
--- a/xt-woo-ajax-add-to-cart/tags/1.1.2/xt-framework/includes/class-system-status.php
+++ b/xt-woo-ajax-add-to-cart/tags/1.1.3/xt-framework/includes/class-system-status.php
@@ -783,7 +783,7 @@
  <h3>
  <?php echo esc_html__( 'System Info', 'xt-framework' ); ?>
  <span class="action-link">
- <a href="<?php echo add_query_arg( array( 'xtfw-refresh-sysinfo' => 'true' ) ) ?>" title="<?php esc_attr_e( 'Refresh System Info', 'xt-framework'); ?>">
+ <a href="<?php echo esc_url( add_query_arg( array( 'xtfw-refresh-sysinfo' => 'true' ) ) ) ?>" title="<?php esc_attr_e( 'Refresh System Info', 'xt-framework'); ?>">
  <span class="dashicons dashicons-image-rotate"></span>
  </a>
  </span>
@@ -906,7 +906,7 @@
  <br>
  <p>
 -    <a href="<?php echo add_query_arg( array( 'xtfw-phpinfo' => 'true' ) ) ?>"><?php esc_html_e( 'Show Full PHP Info', 'xt-framework' ) ?></a>
 +    <a href="<?php echo esc_url( add_query_arg( array( 'xtfw-phpinfo' => 'true' ) ) ) ?>"><?php esc_html_e( 'Show Full PHP Info', 'xt-framework' ) ?></a>
  </p>
  <?php else : ?>
  <p>
- <a href="<?php echo add_query_arg( array( 'xtfw-phpinfo' => 'false' ) ) ?>"><?php esc_html_e( 'Back to System Status', 'xt-framework' ) ?></a>
+ <a href="<?php echo esc_url( add_query_arg( array( 'xtfw-phpinfo' => 'false' ) ) ) ?>"><?php esc_html_e( 'Back to System Status', 'xt-framework' ) ?></a>
  </p>
  <?php
```