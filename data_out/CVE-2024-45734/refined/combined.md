=== Content from advisory.splunk.com_d2fe1a9c_20250111_055208.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Low Privilege User can View Images on the Host Machine by using the PDF Export feature in Splunk Classic Dashboard

**Advisory ID:** SVD-2024-1004

**CVE ID:** [CVE-2024-45734](https://www.cve.org/CVERecord?id=CVE-2024-45734)

**Published:** 2024-10-14

**Last Update:** 2024-10-14

**CVSSv3.1 Score:** 4.3, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**CWE:** [CWE-284](https://cwe.mitre.org/data/definitions/284.html)

**Bug ID:** VULN-16371

## Description

In Splunk Enterprise versions below 9.2.3, and 9.1.6, a low-privileged user that does not hold the “admin” or “power” Splunk roles could view images on the machine that runs Splunk Enterprise by using the PDF export feature in Splunk classic dashboards. The images on the machine could be exposed by exporting the dashboard as a PDF, using the local image path in the img tag in the source extensible markup language (XML) code for the Splunk classic dashboard.

## Solution

Upgrade Splunk Enterprise to versions 9.3.1, 9.2.3, 9.1.6 or higher.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 9.3 | pdfgen | Not affected | 9.3.0 |
| Splunk Enterprise | 9.2 | pdfgen | 9.2.0 to 9.2.2 | 9.2.3 |
| Splunk Enterprise | 9.1 | pdfgen | 9.1.0 to 9.1.5 | 9.1.6 |

## Mitigations and Workarounds

The vulnerability affects instances with [Splunk Web](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents) turned on. You could turn Splunk Web off as a possible workaround. See [Disable unnecessary Splunk Enterprise components](https://docs.splunk.com/Documentation/Splunk/latest/Security/DisableunnecessarySplunkcomponents) and the [web.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Webconf) configuration specification file for more information on turning Splunk Web off.

## Detections

* [Splunk image file disclosure via PDF Export in Classic Dashboard](https://research.splunk.com/application/7464e2dc-98a5-4af9-87a1-fa6d5a256fa6/)

## Severity

Splunk rates this vulnerability as 4.3, Medium, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N.
If the machine where Splunk Enterprise is installed does not contain directories with images in them, then there should be no impact and the severity would be Informational.

If the Splunk Enterprise instance does not run Splunk Web, then there should be no impact and the severity would be informational.

## Acknowledgments

Anton (therceman)

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)

=== Content from research.splunk.com_814ed65d_20250111_055209.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk Image File Disclosure via PDF Export in Classic Dashboard

Updated Date: 2024-10-17
ID: 7464e2dc-98a5-4af9-87a1-fa6d5a256fa6
Author: Rod Soto
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

In Splunk Enterprise versions 9.3.0, 9.2.3, and 9.1.6, a low-privileged user that does not hold the âadminâ or âpowerâ Splunk roles could view images on the host machine using the PDF export feature in Splunk classic dashboards.

### Search

```
 1```Search for any PDFs that have been generated```
 2index=_internal sourcetype=splunk_pdfgen "Generated pdf"
 3```Extract a potential Dashboard Filename```
 4
 5| rex field=filename "(?<title>.*)-[0-9]{4}-[0-9]{1,2}-[0-9]{1,2}.pdf"
 6```Join this with all dashboards. Potentially vulnerable dashbaords MUST be classic (version 1.1) AND contain at least one <img...> tag```
 7
 8| join type=inner title
 9    [
10| rest /servicesNS/-/-/data/ui/views
11
12| search eai:data="*<img*" version="1.1"]
13
14| stats count min(_time) as earliestTime max(_time) as latestTime by author eai:acl.app label title eai:data
15
16| `security_content_ctime(earliestTime)`
17
18| `security_content_ctime(latestTime)`
19
20| `splunk_image_file_disclosure_via_pdf_export_in_classic_dashboard_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [security\_content\_ctime](https://github.com/splunk/security_content/blob/develop/macros/security_content_ctime.yml) | `convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)` |
| splunk\_image\_file\_disclosure\_via\_pdf\_export\_in\_classic\_dashboard\_filter | `search *` |

`splunk_image_file_disclosure_via_pdf_export_in_classic_dashboard_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1087](https://attack.mitre.org/techniques/T1087/) | Account Discovery | Discovery |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_AE

Cis18Value.CIS\_10

Aquatic Panda
FIN13

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

Need to access to REST API.

### Known False Positives

This is a hunting search and operator must identify indicators of local host image source such as UNC paths ('C:'', '//'') in order to identify potential exploitation of this vulnerability.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Potential disclosure of local system source images in dashbaord $label$ by $author$ | 8 | 10 | 80 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/advisories/SVD-2024-1004>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | `N/A` | `N/A` |
| Integration | â Passing | N/A | `N/A` | `N/A` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_image_file_disclosure_via_pdf_export_in_classic_dashboard.yml) |
Version: **2**

[Detection: Splunk Identified SSL TLS Certificates](https://research.splunk.com/network/620fbb89-86fd-4e2e-925f-738374277586/ "Detection: Splunk Identified SSL TLS Certificates")

[Detection: Splunk Improperly Formatted Parameter Crashes splunkd](https://research.splunk.com/application/08978eca-caff-44c1-84dc-53f17def4e14/ "Detection: Splunk Improperly Formatted Parameter Crashes splunkd")

Â© 2005 - 2024 Splunk LLC All rights reserved.


