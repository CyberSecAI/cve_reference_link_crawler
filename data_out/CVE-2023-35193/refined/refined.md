- **Root cause of vulnerability**: The `api.cgi` endpoint's `xml_submit_x509_overwrite_mvpn_self` function in Peplink Surf SOHO HW1 v6.3.5 constructs OS commands using unchecked, attacker-controlled `cert` and `key` parameters.
- **Weaknesses/vulnerabilities present**: OS Command Injection (CWE-78). The `cert` and `key` parameters are not properly sanitized before being used in a system call, allowing an attacker to inject arbitrary commands.
- **Impact of exploitation**: Successful exploitation allows an attacker to execute arbitrary commands with root privileges on the affected device.
- **Attack vectors**: An attacker can send a specially crafted HTTP POST request to the `/cgi-bin/MANGA/api.cgi` endpoint, specifically targeting the `cmd.mvpn.x509.write` function, and include malicious input in the `cert` and/or `key` parameters.
- **Required attacker capabilities/position**: The attacker needs to be authenticated as a user with write privileges on the device.