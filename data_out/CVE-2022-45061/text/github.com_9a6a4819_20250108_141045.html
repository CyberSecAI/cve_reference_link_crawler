
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fissues%2F98433)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fissues%2F98433)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.6k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.7k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpython%2Fcpython%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpython%2Fcpython%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Slow IDNA decoding with large strings [CVE-2022-45061] #98433

Closed

[guidovranken](/guidovranken) opened this issue
Oct 19, 2022
· 4 comments

Closed

# [Slow IDNA decoding with large strings [CVE-2022-45061]](#top) #98433

[guidovranken](/guidovranken) opened this issue
Oct 19, 2022
· 4 comments

Labels
[3.7 (EOL)](/python/cpython/labels/3.7%20%28EOL%29)
end of life
[3.8 (EOL)](/python/cpython/labels/3.8%20%28EOL%29)
end of life
[3.9](/python/cpython/labels/3.9)
only security fixes
[3.10](/python/cpython/labels/3.10)
only security fixes
[3.11](/python/cpython/labels/3.11)
only security fixes
[3.12](/python/cpython/labels/3.12)
bugs and security fixes
[type-bug](/python/cpython/labels/type-bug)
An unexpected behavior, bug, or error
[type-security](/python/cpython/labels/type-security)
A security issue

## Comments

[![@guidovranken](https://avatars.githubusercontent.com/u/6846644?s=80&u=793163cde3e2d0e5b555347824f8c01236f3c22f&v=4)](/guidovranken)

Copy link

### **[guidovranken](/guidovranken)** commented [Oct 19, 2022](#issue-1414357245) • edited by bedevere-bot Loading

| Bug report Originally reported to the security address on September 9.  ``` ('xn--016c'+'a'*5000).encode('utf-8').decode('idna') ```  The execution time is not linear in relation to the input string size, which can cause slowness with large inputs:  10 chars = 0.016 seconds 100 chars = 0.047 seconds 1000 chars = 2.883 seconds 2500 chars = 17.724 seconds 5000 chars = 1 min 10 seconds  Comment by [@tiran](https://github.com/tiran):  According to spec <https://unicode.org/reports/tr46/> an IDNA label must not be longer than 63 characters. Python's idna module enforces the restriction, but too late.  This may be abused in some cases, for example by passing a crafted host name to `asyncio create_connection`:  ``` import asyncio  async def main():     loop = asyncio.get_running_loop()      await loop.create_connection(         lambda: [], ('xn--016c'+'a'*5000).encode('utf-8'), 443     )  asyncio.run(main()) ``` Your environment  * CPython versions tested on: CPython repository 'main' branch checkout, version 3.8.12, version 2.7.18 * Operating system and architecture: Ubuntu Linux x64  * PR: [gh-98433: Fix quadratic time idna decoding. #99092](https://github.com/python/cpython/pull/99092)  * PR: [[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) #99222](https://github.com/python/cpython/pull/99222)  * PR: [[3.10] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) #99229](https://github.com/python/cpython/pull/99229)  * PR: [[3.9] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) #99230](https://github.com/python/cpython/pull/99230)  * PR: [[3.8] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) #99231](https://github.com/python/cpython/pull/99231)  * PR: [[3.7] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) #99232](https://github.com/python/cpython/pull/99232) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@guidovranken](https://avatars.githubusercontent.com/u/6846644?s=40&u=793163cde3e2d0e5b555347824f8c01236f3c22f&v=4)](/guidovranken)
[guidovranken](/guidovranken)
added
the
[type-bug](/python/cpython/labels/type-bug)
An unexpected behavior, bug, or error
label
[Oct 19, 2022](#event-7618056762)

[![@pochmann](https://avatars.githubusercontent.com/u/609905?s=40&v=4)](/pochmann)
[pochmann](/pochmann)
mentioned this issue
[Nov 4, 2022](#ref-issue-1435389660)

[Exponential IDNA codec decoding potential denial of service
#99083](/python/cpython/issues/99083)

Closed

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)
[gpshead](/gpshead)
added
[type-security](/python/cpython/labels/type-security)
A security issue
[3.11](/python/cpython/labels/3.11)
only security fixes
[3.10](/python/cpython/labels/3.10)
only security fixes
[3.9](/python/cpython/labels/3.9)
only security fixes
[3.8 (EOL)](/python/cpython/labels/3.8%20%28EOL%29)
end of life
[3.12](/python/cpython/labels/3.12)
bugs and security fixes
labels
[Nov 4, 2022](#event-7737929274)

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=80&v=4)](/gpshead)

Copy link

Member

### **[gpshead](/gpshead)** commented [Nov 4, 2022](#issuecomment-1303038453)

| This is probably in `ToUnicode` and `ToASCII` of <https://github.com/python/cpython/blob/main/Lib/encodings/idna.py> and/or in <https://github.com/python/cpython/blob/main/Lib/encodings/punycode.py> itself, where we could presumably just do an up front length check and reject inputs that are obviously too long to possibly decode into a label length that DNS standards will accept.  If there are libraries that allow an attacker controlled hostname without a reasonable length check on it to get into a connect or similar call that tries idna decoding, that'd make this remotely exploitable. Based solely on code inspection, the `urllib.request.HTTPRedirectHandler` class is *probably* vulnerable to this - <https://github.com/python/cpython/blob/main/Lib/urllib/request.py#L652> - the location or uri headers it consumes on a HTTP 302 redirect reponse to construct the new URL are not obviously limited, nor is the host that ultimately winds it way down into the socket module. (I didn't test this, I was just reading code) A test case would be to point urllib at a malicious server that sends a 2000 byte idna hostname in a 302 redirect header... |
| --- |

All reactions

Sorry, something went wrong.

[![@vstinner](https://avatars.githubusercontent.com/u/194129?s=80&u=cf52678f5f02f96d9c5bc1b5079d4e6c2e441af4&v=4)](/vstinner)

Copy link

Member

### **[vstinner](/vstinner)** commented [Nov 4, 2022](#issuecomment-1303154169)

| The issue [#99083](https://github.com/python/cpython/issues/99083) was marked as a duplicate of this issue. |
| --- |

All reactions

Sorry, something went wrong.

[gpshead](/gpshead)
added a commit
to gpshead/cpython
that referenced
this issue
[Nov 4, 2022](#ref-commit-365a6cb)
[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[pythongh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding.](/gpshead/cpython/commit/365a6cb2e43b51a2a0fa80b8b21f489f3a397532 "gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

An early length check would still be a good idea given that DNS IDNA
label names cannot be more than 63 ASCII characters.")`
…

`[365a6cb](/gpshead/cpython/commit/365a6cb2e43b51a2a0fa80b8b21f489f3a397532)`

```
There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

An early length check would still be a good idea given that DNS IDNA
label names cannot be more than 63 ASCII characters.
```

[![@bedevere-bot](https://avatars.githubusercontent.com/u/28579281?s=40&v=4)](/bedevere-bot)
[bedevere-bot](/bedevere-bot)
mentioned this issue
[Nov 4, 2022](#ref-pullrequest-1435844889)

[gh-98433: Fix quadratic time idna decoding.
#99092](/python/cpython/pull/99092)
 Merged

2 tasks

[gpshead](/gpshead)
added a commit
that referenced
this issue
[Nov 8, 2022](#ref-commit-d315722)
[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[gh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/python/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d "gh-98433: Fix quadratic time idna decoding. (#99092)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

This also adds an early length check in IDNA decoding to outright reject
huge inputs early on given the ultimate result is defined to be 63 or fewer
characters.")[#99092](https://github.com/python/cpython/pull/99092)[)](/python/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d "gh-98433: Fix quadratic time idna decoding. (#99092)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

This also adds an early length check in IDNA decoding to outright reject
huge inputs early on given the ultimate result is defined to be 63 or fewer
characters.")`
…

`[d315722](/python/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d)`

```
There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

This also adds an early length check in IDNA decoding to outright reject
huge inputs early on given the ultimate result is defined to be 63 or fewer
characters.
```

[miss-islington](/miss-islington)
pushed a commit
to miss-islington/cpython
that referenced
this issue
[Nov 8, 2022](#ref-commit-3a692f2)
[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&v=4)](/miss-islington)

`[pythongh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/miss-islington/cpython/commit/3a692f2234d2ddb65db33d2516fff357a139c724 "gh-98433: Fix quadratic time idna decoding. (GH-99092)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

This also adds an early length check in IDNA decoding to outright reject
huge inputs early on given the ultimate result is defined to be 63 or fewer
characters.
(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

Co-authored-by: Gregory P. Smith <greg@krypto.org>")[pythonGH-99092](https://github.com/python/cpython/pull/99092)[)](/miss-islington/cpython/commit/3a692f2234d2ddb65db33d2516fff357a139c724 "gh-98433: Fix quadratic time idna decoding. (GH-99092)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

This also adds an early length check in IDNA decoding to outright reject
huge inputs early on given the ultimate result is defined to be 63 or fewer
characters.
(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[3a692f2](/miss-islington/cpython/commit/3a692f2234d2ddb65db33d2516fff357a139c724)`

```
There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

This also adds an early length check in IDNA decoding to outright reject
huge inputs early on given the ultimate result is defined to be 63 or fewer
characters.
(cherry picked from commit [d315722](https://github.com/miss-islington/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d))

Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@bedevere-bot](https://avatars.githubusercontent.com/u/28579281?s=40&v=4)](/bedevere-bot)
[bedevere-bot](/bedevere-bot)
mentioned this issue
[Nov 8, 2022](#ref-pullrequest-1439243663)

[[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092)
#99222](/python/cpython/pull/99222)
 Merged

[gpshead](/gpshead)
added a commit
that referenced
this issue
[Nov 8, 2022](#ref-commit-a6f6c3a)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.11]](/python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15 "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (#99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15 "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (#99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

Co-authored-by: Gregory P. Smith <greg@krypto.org>")[GH-99092](https://github.com/python/cpython/pull/99092)[) (](/python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15 "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (#99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

Co-authored-by: Gregory P. Smith <greg@krypto.org>")[#99222](https://github.com/python/cpython/pull/99222)[)](/python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15 "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (#99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[a6f6c3a](/python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)`

```
There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [d315722](https://github.com/python/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d))

Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

This was referenced Nov 8, 2022

[[3.10] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)
#99229](/python/cpython/pull/99229)
 Merged

[[3.9] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)
#99230](/python/cpython/pull/99230)
 Merged

[miss-islington](/miss-islington)
added a commit
to miss-islington/cpython
that referenced
this issue
[Nov 8, 2022](#ref-commit-da895b6)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.11]](/miss-islington/cpython/commit/da895b639cdbee774cd4b235a055b04299de3487 "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [pythongh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/miss-islington/cpython/commit/da895b639cdbee774cd4b235a055b04299de3487 "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[pythonGH-99092](https://github.com/python/cpython/pull/99092)`
…

`[da895b6](/miss-islington/cpython/commit/da895b639cdbee774cd4b235a055b04299de3487)`

```
) ([pythonGH-99222](https://github.com/python/cpython/pull/99222))

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [d315722](https://github.com/miss-islington/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d))

(cherry picked from commit [a6f6c3a](https://github.com/miss-islington/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

This was referenced Nov 8, 2022

[[3.8] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)
#99231](/python/cpython/pull/99231)
 Merged

[[3.7] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)
#99232](/python/cpython/pull/99232)
 Merged

[miss-islington](/miss-islington)
added a commit
to miss-islington/cpython
that referenced
this issue
[Nov 8, 2022](#ref-commit-b8f8994)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.11]](/miss-islington/cpython/commit/b8f89940de09a51fdbd8fe4705d3d1d7f1bb0c6a "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [pythongh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/miss-islington/cpython/commit/b8f89940de09a51fdbd8fe4705d3d1d7f1bb0c6a "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[pythonGH-99092](https://github.com/python/cpython/pull/99092)`
…

`[b8f8994](/miss-islington/cpython/commit/b8f89940de09a51fdbd8fe4705d3d1d7f1bb0c6a)`

```
) ([pythonGH-99222](https://github.com/python/cpython/pull/99222))

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [d315722](https://github.com/miss-islington/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d))

(cherry picked from commit [a6f6c3a](https://github.com/miss-islington/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[miss-islington](/miss-islington)
added a commit
to miss-islington/cpython
that referenced
this issue
[Nov 8, 2022](#ref-commit-fa792dd)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.11]](/miss-islington/cpython/commit/fa792ddee55dc02c6392842c8194a464339f6f1b "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [pythongh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/miss-islington/cpython/commit/fa792ddee55dc02c6392842c8194a464339f6f1b "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[pythonGH-99092](https://github.com/python/cpython/pull/99092)`
…

`[fa792dd](/miss-islington/cpython/commit/fa792ddee55dc02c6392842c8194a464339f6f1b)`

```
) ([pythonGH-99222](https://github.com/python/cpython/pull/99222))

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [d315722](https://github.com/miss-islington/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d))

(cherry picked from commit [a6f6c3a](https://github.com/miss-islington/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)
[gpshead](/gpshead)
added
the
[3.7 (EOL)](/python/cpython/labels/3.7%20%28EOL%29)
end of life
label
[Nov 8, 2022](#event-7758349986)

[ned-deily](/ned-deily)
pushed a commit
that referenced
this issue
[Nov 8, 2022](#ref-commit-b0b590b)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.7]](/python/cpython/commit/b0b590be9597fd5919228d251812dd54145f70a7 "[3.7] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99232)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/python/cpython/commit/b0b590be9597fd5919228d251812dd54145f70a7 "[3.7] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99232)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[GH-99092](https://github.com/python/cpython/pull/99092)[) (](/python/cpython/commit/b0b590be9597fd5919228d251812dd54145f70a7 "[3.7] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99232)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[GH-99232](https://github.com/python/cpython/pull/99232)[)](/python/cpython/commit/b0b590be9597fd5919228d251812dd54145f70a7 "[3.7] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99232)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[b0b590b](/python/cpython/commit/b0b590be9597fd5919228d251812dd54145f70a7)`

```
There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[miss-islington](/miss-islington)
added a commit
that referenced
this issue
[Nov 8, 2022](#ref-commit-9bb8e18)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.11]](/python/cpython/commit/9bb8e18ca46fe66fa6802602f8a7228a24dd785f "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/python/cpython/commit/9bb8e18ca46fe66fa6802602f8a7228a24dd785f "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[GH-99092](https://github.com/python/cpython/pull/99092)[) (](/python/cpython/commit/9bb8e18ca46fe66fa6802602f8a7228a24dd785f "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[GH-99222](https://github.com/python/cpython/pull/99222)[)](/python/cpython/commit/9bb8e18ca46fe66fa6802602f8a7228a24dd785f "[3.11] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[9bb8e18](/python/cpython/commit/9bb8e18ca46fe66fa6802602f8a7228a24dd785f)`

```
There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [d315722](https://github.com/python/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d))

(cherry picked from commit [a6f6c3a](https://github.com/python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=80&v=4)](/gpshead)

Copy link

Member

### **[gpshead](/gpshead)** commented [Nov 9, 2022](#issuecomment-1308281823)

| PRs are either merged or will be merged before the next release (marked as release-blockers) so I'm closing this.  A CVE id has been assigned [CVE-2022-45061](https://www.cve.org/CVERecord?id=CVE-2022-45061) for tracking purposes. |
| --- |

All reactions

Sorry, something went wrong.

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)
[gpshead](/gpshead)
closed this as [completed](/python/cpython/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Nov 9, 2022](#event-7769904082)

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)
[gpshead](/gpshead)
changed the title
~~Slow IDNA decoding with large strings~~
Slow IDNA decoding with large strings [CVE-2022-45061]
[Nov 9, 2022](#event-7769905219)

[![@vstinner](https://avatars.githubusercontent.com/u/194129?s=80&u=cf52678f5f02f96d9c5bc1b5079d4e6c2e441af4&v=4)](/vstinner)

Copy link

Member

### **[vstinner](/vstinner)** commented [Nov 9, 2022](#issuecomment-1308565199)

| I created <https://python-security.readthedocs.io/vuln/slow-idna-large-strings.html> to track this vulnerability. The fix is not merged into 3.8 and 3.9 branches yet. |
| --- |

All reactions

Sorry, something went wrong.

[ambv](/ambv)
pushed a commit
that referenced
this issue
[Nov 10, 2022](#ref-commit-82ca283)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.8]](/python/cpython/commit/82ca2839c9ec6bf9a9400e791a52411824df67f3 "[3.8] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) (GH-99231)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)
(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/python/cpython/commit/82ca2839c9ec6bf9a9400e791a52411824df67f3 "[3.8] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) (GH-99231)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)
(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[GH-99092](https://github.com/python/cpython/pull/99092)[) (](/python/cpython/commit/82ca2839c9ec6bf9a9400e791a52411824df67f3 "[3.8] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) (GH-99231)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)
(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[GH-99222](https://github.com/python/cpython/pull/99222)[)…](/python/cpython/commit/82ca2839c9ec6bf9a9400e791a52411824df67f3 "[3.8] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) (GH-99231)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)
(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[82ca283](/python/cpython/commit/82ca2839c9ec6bf9a9400e791a52411824df67f3)`

```
… ([GH-99231](https://github.com/python/cpython/pull/99231))

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [d315722](https://github.com/python/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d))
(cherry picked from commit [a6f6c3a](https://github.com/python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[ambv](/ambv)
pushed a commit
that referenced
this issue
[Nov 10, 2022](#ref-commit-c09dba5)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.9]](/python/cpython/commit/c09dba57cfbbf74273ce44b1f48f71b46806605c "[3.9] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) (#99230)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)
(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-98433](https://github.com/python/cpython/issues/98433)[: Fix quadratic time idna decoding. (](/python/cpython/commit/c09dba57cfbbf74273ce44b1f48f71b46806605c "[3.9] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) (#99230)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)
(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[GH-99092](https://github.com/python/cpython/pull/99092)[) (](/python/cpython/commit/c09dba57cfbbf74273ce44b1f48f71b46806605c "[3.9] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) (#99230)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)
(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[GH-99222](https://github.com/python/cpython/pull/99222)[)…](/python/cpython/commit/c09dba57cfbbf74273ce44b1f48f71b46806605c "[3.9] gh-98433: Fix quadratic time idna decoding. (GH-99092) (GH-99222) (#99230)

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit d315722564927c7202dd6e111dc79eaf14240b0d)
(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[c09dba5](/python/cpython/commit/c09dba57cfbbf74273ce44b1f48f71b46806605c)`

```
… ([#99230](https://github.com/python/cpython/pull/99230))

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [d315722](https://github.com/python/cpython/commit/d315722564927c7202dd6e111dc79eaf14240b0d))
(cherry picked from commit [a6f6c3a](https://github.com/python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[halstead](/halstead)
pushed a commit
to openembedded/openembedded-core
that referenced
this issue
[Nov 23, 2022](#ref-commit-4498ca9)
[![@OmkarPatil11](https://avatars.githubusercontent.com/u/108276667?s=40&v=4)](/OmkarPatil11) [![@rpurdie](https://avatars.githubusercontent.com/u/1184070?s=40&v=4)](/rpurdie)

`[python3: Fix](/openembedded/openembedded-core/commit/4498ca9a299bd5d9a7173ec67daf17cb66b6d286 "python3: Fix CVE-2022-45061

Fix CVE-2022-45061, referenced as
https://github.com/python/cpython/issues/98433
patch taken from
https://github.com/python/cpython/pull/99231/commits/064ec20bf7a181ba5fa961aaa12973812aa6ca5d

Signed-off-by: Omkar <omkarpatil10.93@gmail.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")`
…

`[4498ca9](/openembedded/openembedded-core/commit/4498ca9a299bd5d9a7173ec67daf17cb66b6d286)`

```
Fix [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061"), referenced as
[python/cpython#98433](https://github.com/python/cpython/issues/98433)
patch taken from
[python/cpython@064ec20](https://github.com/python/cpython/commit/064ec20bf7a181ba5fa961aaa12973812aa6ca5d)

Signed-off-by: Omkar <omkarpatil10.93@gmail.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
```

[![@hbeberman](https://avatars.githubusercontent.com/u/33466007?s=40&v=4)](/hbeberman)
[hbeberman](/hbeberman)
mentioned this issue
[Dec 7, 2022](#ref-pullrequest-1480701961)

[Patch python3 for CVE-2022-45061
microsoft/azurelinux#4379](/microsoft/azurelinux/pull/4379)
 Merged

12 tasks

[rpurdie](/rpurdie)
pushed a commit
to yoctoproject/poky
that referenced
this issue
[Dec 7, 2022](#ref-commit-124e5c8)
[![@OmkarPatil11](https://avatars.githubusercontent.com/u/108276667?s=40&v=4)](/OmkarPatil11) [![@rpurdie](https://avatars.githubusercontent.com/u/1184070?s=40&v=4)](/rpurdie)

`[python3: Fix](/yoctoproject/poky/commit/124e5c83914ea141f93c28f054d9b53babf1c6ea "python3: Fix CVE-2022-45061

Fix CVE-2022-45061, referenced as
https://github.com/python/cpython/issues/98433
patch taken from
https://github.com/python/cpython/pull/99231/commits/064ec20bf7a181ba5fa961aaa12973812aa6ca5d

(From OE-Core rev: 4498ca9a299bd5d9a7173ec67daf17cb66b6d286)

Signed-off-by: Omkar <omkarpatil10.93@gmail.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")`
…

`[124e5c8](/yoctoproject/poky/commit/124e5c83914ea141f93c28f054d9b53babf1c6ea)`

```
Fix [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061"), referenced as
[python/cpython#98433](https://github.com/python/cpython/issues/98433)
patch taken from
[python/cpython@064ec20](https://github.com/python/cpython/commit/064ec20bf7a181ba5fa961aaa12973812aa6ca5d)

(From OE-Core rev: 4498ca9a299bd5d9a7173ec67daf17cb66b6d286)

Signed-off-by: Omkar <omkarpatil10.93@gmail.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>
```

[jpuhlman](/jpuhlman)
pushed a commit
to MontaVista-OpenSourceTechnology/poky
that referenced
this issue
[Dec 8, 2022](#ref-commit-9d22ba6)
[![@OmkarPatil11](https://avatars.githubusercontent.com/u/108276667?s=40&v=4)](/OmkarPatil11) [![@jpuhlman](https://avatars.githubusercontent.com/u/786636?s=40&v=4)](/jpuhlman)

`[python3: Fix](/MontaVista-OpenSourceTechnology/poky/commit/9d22ba67ae2bbfa54b900f6bffc0237c9f9bb0f1 "python3: Fix CVE-2022-45061

Source: poky
MR: 123948, 123690
Type: Security Fix
Disposition: Merged from poky
ChangeID: 124e5c83914ea141f93c28f054d9b53babf1c6ea
Description:

Fix CVE-2022-45061, referenced as
https://github.com/python/cpython/issues/98433
patch taken from
https://github.com/python/cpython/pull/99231/commits/064ec20bf7a181ba5fa961aaa12973812aa6ca5d

(From OE-Core rev: 4498ca9a299bd5d9a7173ec67daf17cb66b6d286)

Signed-off-by: Omkar <omkarpatil10.93@gmail.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>
Signed-off-by: Jeremy A. Puhlman <jpuhlman@mvista.com>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")`
…

`[9d22ba6](/MontaVista-OpenSourceTechnology/poky/commit/9d22ba67ae2bbfa54b900f6bffc0237c9f9bb0f1)`

```
Source: poky
MR: 123948, 123690
Type: Security Fix
Disposition: Merged from poky
ChangeID: 124e5c83914ea141f93c28f054d9b53babf1c6ea
Description:

Fix [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061"), referenced as
[python/cpython#98433](https://github.com/python/cpython/issues/98433)
patch taken from
[python/cpython@064ec20](https://github.com/python/cpython/commit/064ec20bf7a181ba5fa961aaa12973812aa6ca5d)

(From OE-Core rev: 4498ca9a299bd5d9a7173ec67daf17cb66b6d286)

Signed-off-by: Omkar <omkarpatil10.93@gmail.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>
Signed-off-by: Jeremy A. Puhlman <jpuhlman@mvista.com>
```

[![@MingcongBai](https://avatars.githubusercontent.com/u/5006263?s=40&v=4)](/MingcongBai)
[MingcongBai](/MingcongBai)
mentioned this issue
[Dec 13, 2022](#ref-issue-1493719031)

[python-3: update to 3.10.9
AOSC-Dev/aosc-os-abbs#4337](/AOSC-Dev/aosc-os-abbs/issues/4337)

Closed

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Dec 19, 2022](#ref-commit-e7ecd65)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394:](/stratakis/cpython/commit/e7ecd65c1712ad917d01c9c4193bc313d65f7d45 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/stratakis/cpython/commit/e7ecd65c1712ad917d01c9c4193bc313d65f7d45 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[e7ecd65](/stratakis/cpython/commit/e7ecd65c1712ad917d01c9c4193bc313d65f7d45)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)
[stratakis](/stratakis)
mentioned this issue
[Dec 19, 2022](#ref-pullrequest-1503182867)

[00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder
fedora-python/cpython#52](/fedora-python/cpython/pull/52)
 Merged

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Dec 19, 2022](#ref-commit-5456608)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394-](/stratakis/cpython/commit/5456608609d104974d3a8a12ca9d88589ca6dbc6 "00394-cve-2022-45061-cpu-denial-of-service-via-inefficient-idna-decoder.patch

00394 #
gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

Backported from python3.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[cve-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[-cpu-denial-of-service-via-inefficient-idna-decod…](/stratakis/cpython/commit/5456608609d104974d3a8a12ca9d88589ca6dbc6 "00394-cve-2022-45061-cpu-denial-of-service-via-inefficient-idna-decoder.patch

00394 #
gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

Backported from python3.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[5456608](/stratakis/cpython/commit/5456608609d104974d3a8a12ca9d88589ca6dbc6)`

```
…er.patch

00394 #
[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

Backported from python3.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)
[stratakis](/stratakis)
mentioned this issue
[Dec 19, 2022](#ref-pullrequest-1503418705)

[00394-cve-2022-45061-cpu-denial-of-service-via-inefficient-idna-decoder.patch
fedora-python/cpython#53](/fedora-python/cpython/pull/53)
 Merged

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Dec 21, 2022](#ref-commit-b9dd9c2)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394-](/stratakis/cpython/commit/b9dd9c22f933be92c959ca095e07b40432e6a165 "00394-cve-2022-45061-cpu-denial-of-service-via-inefficient-idna-decoder.patch

00394 #
gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

Backported from python3.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[cve-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[-cpu-denial-of-service-via-inefficient-idna-decod…](/stratakis/cpython/commit/b9dd9c22f933be92c959ca095e07b40432e6a165 "00394-cve-2022-45061-cpu-denial-of-service-via-inefficient-idna-decoder.patch

00394 #
gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

Backported from python3.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[b9dd9c2](/stratakis/cpython/commit/b9dd9c22f933be92c959ca095e07b40432e6a165)`

```
…er.patch

00394 #
[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

Backported from python3.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[hroncok](/hroncok)
pushed a commit
to fedora-python/cpython
that referenced
this issue
[Oct 6, 2023](#ref-commit-80ca2b4)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@hroncok](https://avatars.githubusercontent.com/u/2401856?s=40&v=4)](/hroncok)

`[00394-](/fedora-python/cpython/commit/80ca2b4cea138d39c2c05541dde9e90dfb09efcb "00394-cve-2022-45061-cpu-denial-of-service-via-inefficient-idna-decoder.patch

00394 #
gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

Backported from python3.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")[cve-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[-cpu-denial-of-service-via-inefficient-idna-decod…](/fedora-python/cpython/commit/80ca2b4cea138d39c2c05541dde9e90dfb09efcb "00394-cve-2022-45061-cpu-denial-of-service-via-inefficient-idna-decoder.patch

00394 #
gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

Backported from python3.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[80ca2b4](/fedora-python/cpython/commit/80ca2b4cea138d39c2c05541dde9e90dfb09efcb)`

```
…er.patch

00394 #
[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

Backported from python3.

(cherry picked from commit [a6f6c3a](https://github.com/fedora-python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Mar 11, 2024](#ref-commit-3870c6e)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394:](/stratakis/cpython/commit/3870c6e7a19deaeca07ff08e70bf70185f5bd508 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/stratakis/cpython/commit/3870c6e7a19deaeca07ff08e70bf70185f5bd508 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[3870c6e](/stratakis/cpython/commit/3870c6e7a19deaeca07ff08e70bf70185f5bd508)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Mar 11, 2024](#ref-commit-128a35f)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394:](/stratakis/cpython/commit/128a35f7ae4b6d8d66daab9414095b44d04557cd "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/stratakis/cpython/commit/128a35f7ae4b6d8d66daab9414095b44d04557cd "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[128a35f](/stratakis/cpython/commit/128a35f7ae4b6d8d66daab9414095b44d04557cd)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Mar 20, 2024](#ref-commit-306084d)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394:](/stratakis/cpython/commit/306084d82b55c903c49ca60429cc2f6c099457ea "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/stratakis/cpython/commit/306084d82b55c903c49ca60429cc2f6c099457ea "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[306084d](/stratakis/cpython/commit/306084d82b55c903c49ca60429cc2f6c099457ea)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Mar 20, 2024](#ref-commit-ed6fffa)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394:](/stratakis/cpython/commit/ed6fffa50cfc0121b117ef7b203b1e5fd247d48e "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/stratakis/cpython/commit/ed6fffa50cfc0121b117ef7b203b1e5fd247d48e "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[ed6fffa](/stratakis/cpython/commit/ed6fffa50cfc0121b117ef7b203b1e5fd247d48e)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Mar 20, 2024](#ref-commit-a5a4006)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394:](/stratakis/cpython/commit/a5a40067a0939922a852b642641daec8a9a358b0 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/stratakis/cpython/commit/a5a40067a0939922a852b642641daec8a9a358b0 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[a5a4006](/stratakis/cpython/commit/a5a40067a0939922a852b642641daec8a9a358b0)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Mar 20, 2024](#ref-commit-04d6752)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394:](/stratakis/cpython/commit/04d675278a23f46cd4bb6d2f02111e50757fef91 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/stratakis/cpython/commit/04d675278a23f46cd4bb6d2f02111e50757fef91 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[04d6752](/stratakis/cpython/commit/04d675278a23f46cd4bb6d2f02111e50757fef91)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[stratakis](/stratakis)
pushed a commit
to stratakis/cpython
that referenced
this issue
[Mar 25, 2024](#ref-commit-4224f92)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@stratakis](https://avatars.githubusercontent.com/u/14812606?s=40&v=4)](/stratakis)

`[00394:](/stratakis/cpython/commit/4224f92132115cfde4a1cabd075c646cc91af436 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/stratakis/cpython/commit/4224f92132115cfde4a1cabd075c646cc91af436 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[4224f92](/stratakis/cpython/commit/4224f92132115cfde4a1cabd075c646cc91af436)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/stratakis/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[hroncok](/hroncok)
pushed a commit
to fedora-python/cpython
that referenced
this issue
[Mar 26, 2024](#ref-commit-546806d)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@hroncok](https://avatars.githubusercontent.com/u/2401856?s=40&v=4)](/hroncok)

`[00394:](/fedora-python/cpython/commit/546806d4853fabaaa4157a7a301d24851c226ad0 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/fedora-python/cpython/commit/546806d4853fabaaa4157a7a301d24851c226ad0 "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[546806d](/fedora-python/cpython/commit/546806d4853fabaaa4157a7a301d24851c226ad0)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/fedora-python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[mcepl](/mcepl)
pushed a commit
to openSUSE-Python/cpython
that referenced
this issue
[Apr 2, 2024](#ref-commit-224d94e)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@mcepl](https://avatars.githubusercontent.com/u/198999?s=40&v=4)](/mcepl)

`[00394:](/openSUSE-Python/cpython/commit/224d94e383df3976ffae5164d228c9ae9175caad "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [CVE-2022-45061](https://github.com/advisories/GHSA-2mp6-9mjc-p6jg "CVE-2022-45061")[: CPU denial of service via inefficient IDNA dec…](/openSUSE-Python/cpython/commit/224d94e383df3976ffae5164d228c9ae9175caad "00394: CVE-2022-45061: CPU denial of service via inefficient IDNA decoder

gh-98433: Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15)

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
…

`[224d94e](/openSUSE-Python/cpython/commit/224d94e383df3976ffae5164d228c9ae9175caad)`

```
…oder

[pythongh-98433](https://github.com/python/cpython/issues/98433): Fix quadratic time idna decoding.

There was an unnecessary quadratic loop in idna decoding. This restores
the behavior to linear.

(cherry picked from commit [a6f6c3a](https://github.com/openSUSE-Python/cpython/commit/a6f6c3a3d6f2b580f2d87885c9b8a9350ad7bf15))

Co-authored-by: Miss Islington (bot) <31488909+miss-islington@users.noreply.github.com>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@guidovranken](https://avatars.githubusercontent.com/u/6846644?s=40&u=793163cde3e2d0e5b555347824f8c01236f3c22f&v=4)](/guidovranken)
[guidovranken](/guidovranken)
mentioned this issue
[Jul 17, 2024](#ref-issue-2413455159)

[deleted
#121906](/python/cpython/issues/121906)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fissues%2F98433)

Assignees

No one assigned

Labels

[3.7 (EOL)](/python/cpython/labels/3.7%20%28EOL%29)
end of life
[3.8 (EOL)](/python/cpython/labels/3.8%20%28EOL%29)
end of life
[3.9](/python/cpython/labels/3.9)
only security fixes
[3.10](/python/cpython/labels/3.10)
only security fixes
[3.11](/python/cpython/labels/3.11)
only security fixes
[3.12](/python/cpython/labels/3.12)
bugs and security fixes
[type-bug](/python/cpython/labels/type-bug)
An unexpected behavior, bug, or error
[type-security](/python/cpython/labels/type-security)
A security issue

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=52&v=4)](/gpshead) [![@vstinner](https://avatars.githubusercontent.com/u/194129?s=52&v=4)](/vstinner) [![@guidovranken](https://avatars.githubusercontent.com/u/6846644?s=52&v=4)](/guidovranken)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

