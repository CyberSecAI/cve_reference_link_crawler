Based on the provided content, here's the breakdown of the vulnerability:

**Root cause of vulnerability:**
- The vulnerability stems from the use of `${}` in MyBatis mapper XML to pass the `params.dataScope` parameter directly into the SQL query. This allows for SQL injection because the parameter is not properly sanitized or parameterized.

**Weaknesses/vulnerabilities present:**
- SQL Injection: The application is vulnerable to SQL injection due to the use of string interpolation (`${}`) in the MyBatis mapper instead of using parameterized queries. This allows an attacker to inject malicious SQL code.

**Impact of exploitation:**
-  An attacker can execute arbitrary SQL queries, potentially leading to:
    - Data exfiltration: Accessing and stealing sensitive data from the database.
    - Data modification: Modifying or deleting data within the database.
    - Privilege escalation: Potentially gaining higher privileges within the database.
    - Denial of Service: Making the database unavailable.

**Attack vectors:**
- The attack vector is through the HTTP request parameters, specifically by manipulating the `params["dataScope"]` parameter within the `MyUser` object passed to the `/api/user` endpoint.

**Required attacker capabilities/position:**
- The attacker needs the ability to send HTTP requests to the `/api/user` endpoint with a crafted `params["dataScope"]` parameter.
-  The provided POC indicates that cookies might be required to perform the attack.
- The attacker does not appear to need any special privileges beyond the ability to send requests to the affected endpoint.

**Technical details:**

- The vulnerability is located in the `my-springsecurity-plus` application.
- The vulnerable code is within `mybatis-mappers/UserMapper.xml`, specifically line 22 where `${}` is used with the `dataScope` parameter.
- The data flow of the parameter leading to the vulnerability is as follows:
    1.  `UserController.java` receives request with MyUser object.
    2. `UserServiceImpl.java` calls `getFuzzyUserByPage` method.
    3. `UserDao.java` calls the `getFuzzyUserByPage` method.
    4. `UserMapper.xml` is using the unsanitized input in a query
- A proof-of-concept (POC) is provided demonstrating how to exploit this vulnerability using sqlmap.

```
http://localhost:8088/api/user?offset=1&limit=1&params%5B%22dataScope%22%5D=1
```
```
python3 sqlmap.py -r 1.txt --dbs -v 3
```

This issue is flagged by "Chaitin Security Research Lab", indicating that it is indeed a security vulnerability.
The issue is also linked to CVE-2024-40539 in one of the comments, suggesting that this issue might have been assigned that CVE ID as well.