=== Content from jira.mongodb.org_74dcb94e_20250110_111429.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FSERVER-59071)[Skip to main content](#main)[Skip to sidebar](#sidebar)[![MongoDB Jira](/s/ub562g/9160001/fy41z4/_/jira-logo-scaled.png)](https://jira.mongodb.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")
* [eazyBI](/plugins/servlet/eazybi)

* Give feedback to Atlassian
* [Help](/secure/ViewKeyboardShortcuts%21default.jspa "Help")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FSERVER-59071)
  + [Acknowledged notifications](/plugins/servlet/wittified/profile/notifications)

![Uploaded image for project: 'Core Server'](https://jira.mongodb.org/secure/projectavatar?pid=10000&avatarId=13900)

1. [Core Server](/browse/SERVER)
2. [SERVER-59071](/browse/SERVER-59071)

## Using $sample can trigger invariant when connecting directly to shards

Schedule Issue[Undo Transition](/secure/UndoTransition%21default.jspa?id=1839996)ClosedExportnullXMLWordPrintableJSON
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Major - P3](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.") Major - P3
* **Fix Version/s:**
  [5.0.3](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+5.0.3 "5.0.3 "), [5.1.0-rc0](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+5.1.0-rc0 "5.1.0-rc0 ")
* **Affects Version/s:**
  5.0.2
* **Component/s:**
  None
* **Labels:**
  None

* **Backwards Compatibility:**
  Fully Compatible
* **Operating System:**
  ALL
* **Backport Requested:**
  v5.0
* **Sprint:**
  QE 2021-08-09, QE 2021-08-23
* **Case:**

  (copied to CRM)
* **Linked BF Score:**
  176

### Description

**CVE-2021-32037**

**Title**

User may trigger invariant when allowed to send commands directly to shards

**CVE ID**

CVE-2021-32037

**Description**

An authorized user may trigger an invariant which may result in denial of service or server exit if a relevant aggregation request is sent to a shard. Usually, the requests are sent via mongos and special privileges are required in order to know the address of the shards and to log in to the shards of an auth enabled environment.

**CVSS score**

This issue's CVSS:3.1 severity is scored at 6.5 using the following scoring metrics:

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H

**Affected versions**

MongoDB Server v5.0.0-v5.0.2

**CWE**

CWE-617: Reachable Assertion

**Underlying operating systems affected**

ALL

**How the issue was reported**:

Externally

**External Reference link (server ticket)**

[~~SERVER-59071~~](https://jira.mongodb.org/browse/SERVER-59071 "Using $sample can trigger invariant when connecting directly to shards")

### Attachments

### Attachments

* Options
  + - [Sort By Name](/browse/SERVER-59071?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
    - [Sort By Date](/browse/SERVER-59071?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
    - [Ascending](/browse/SERVER-59071?attachmentOrder=asc#attachmentmodule "Ascending")
    - [Descending](/browse/SERVER-59071?attachmentOrder=desc#attachmentmodule "Descending")
    - [Thumbnails](/browse/SERVER-59071?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
    - [List](/browse/SERVER-59071?attachmentViewMode=list#attachmentmodule "List")
    - [Download All](/secure/attachmentzip/1839996.zip "Download all attachments as a ZIP file")

1. [test.js](/secure/attachment/328275/test.js "test.js - Latest Aug 03 2021 06:57:15 PM UTC - Randolph Tan")0.5 kBAug 03 2021 06:57:15 PM UTC
### Activity

### People

Assignee:
![eric.cox@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Eric Cox (Inactive)

Reporter:
![randolph@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Randolph Tan

Participants:

[Aju Raju](/secure/IssueNavigator.jspa?reset=true&customfield_10051=aju.raju%40bnymellon.com "Find all issues Aju Raju participated in"), [Eric Cox](/secure/IssueNavigator.jspa?reset=true&customfield_10051=eric.cox%40mongodb.com "Find all issues Eric Cox participated in"), [Githook User](/secure/IssueNavigator.jspa?reset=true&customfield_10051=xgen-internal-githook "Find all issues Githook User participated in"), [Kaloian Manassiev](/secure/IssueNavigator.jspa?reset=true&customfield_10051=kaloian.manassiev%40mongodb.com "Find all issues Kaloian Manassiev participated in"), [Randolph Tan](/secure/IssueNavigator.jspa?reset=true&customfield_10051=randolph%40mongodb.com "Find all issues Randolph Tan participated in")

Votes:
1
Vote for this issue

Watchers:
20
Start watching this issue

### Dates

Created:

Aug 03 2021 06:38:54 PM UTC

Updated:

Oct 29 2023 09:49:58 PM UTC

Resolved:

Aug 11 2021 06:36:40 PM UTC

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for MongoDB. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


