The content is related to CVE-2024-44975.

**Root cause of vulnerability:**
The vulnerability is caused by incorrect rebuilding of scheduling domains in the cgroup/cpuset subsystem. Specifically, when updating the effective CPU mask of a cpuset, the code does not properly validate if the new mask has CPUs available for the parent/cs that has tasks. This can lead to a situation where a cpuset's effective mask is set to a state with no available CPUs, triggering a page fault during a subsequent rebuild of scheduling domains.

**Weaknesses/vulnerabilities present:**
- Improper validation of the new effective CPU mask during `update_parent_effective_cpumask` when called with `partcmd_update`.
- Lack of a check to ensure there are available CPUs in the `newmask` for parent/cs having tasks during cpuset updates.

**Impact of exploitation:**
- Kernel panic due to a page fault.
- Denial of service.

**Attack vectors:**
- The vulnerability can be triggered by writing to cpuset files in the cgroup filesystem.
- Specifically, creating a new cgroup, adding it to the cgroup.subtree_control, setting a partition and then taking away all cpus from the root.

**Required attacker capabilities/position:**
- The attacker needs to have the ability to write to the cgroup filesystem (e.g., by having write access to the cpuset files within the cgroup hierarchy).
- The attacker needs to be able to create and modify cgroups.