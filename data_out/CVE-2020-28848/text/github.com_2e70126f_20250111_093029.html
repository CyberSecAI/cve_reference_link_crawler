
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FChurchCRM%2FCRM%2Fissues%2F5465)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FChurchCRM%2FCRM%2Fissues%2F5465)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ChurchCRM%2FCRM)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ChurchCRM](/ChurchCRM)
/
**[CRM](/ChurchCRM/CRM)**
Public

* [Notifications](/login?return_to=%2FChurchCRM%2FCRM) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2FChurchCRM%2FCRM)
* [Star
   655](/login?return_to=%2FChurchCRM%2FCRM)

* [Code](/ChurchCRM/CRM)
* [Issues
  9](/ChurchCRM/CRM/issues)
* [Pull requests
  1](/ChurchCRM/CRM/pulls)
* [Discussions](/ChurchCRM/CRM/discussions)
* [Actions](/ChurchCRM/CRM/actions)
* [Projects
  2](/ChurchCRM/CRM/projects)
* [Wiki](/ChurchCRM/CRM/wiki)
* [Security](/ChurchCRM/CRM/security)
* [Insights](/ChurchCRM/CRM/pulse)

Additional navigation options

* [Code](/ChurchCRM/CRM)
* [Issues](/ChurchCRM/CRM/issues)
* [Pull requests](/ChurchCRM/CRM/pulls)
* [Discussions](/ChurchCRM/CRM/discussions)
* [Actions](/ChurchCRM/CRM/actions)
* [Projects](/ChurchCRM/CRM/projects)
* [Wiki](/ChurchCRM/CRM/wiki)
* [Security](/ChurchCRM/CRM/security)
* [Insights](/ChurchCRM/CRM/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FChurchCRM%2FCRM%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FChurchCRM%2FCRM%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CSV Injection Vulnerability #5465

Closed

[muffyhub](/muffyhub) opened this issue
Oct 24, 2020
· 7 comments

Closed

# [CSV Injection Vulnerability](#top) #5465

[muffyhub](/muffyhub) opened this issue
Oct 24, 2020
· 7 comments

Labels
[bug](/ChurchCRM/CRM/labels/bug)
[Security](/ChurchCRM/CRM/labels/Security)
[Stale](/ChurchCRM/CRM/labels/Stale)

## Comments

[![@muffyhub](https://avatars.githubusercontent.com/u/20786373?s=80&v=4)](/muffyhub)

Copy link

### **[muffyhub](/muffyhub)** commented [Oct 24, 2020](#issue-728661432) • edited Loading

| **Vulnerability Name:** CSV Injection/ Formula Injection **Severity:** High **Description:** CSV Injection (aka Excel Macro Injection or Formula Injection) exists in List Event Types feature in ChurchCRM v4.2.0 via Name field that is mistreated while exporting to a CSV file. **Impact:** Arbitrary formulas can be injected into CSV files which can lead to remote code execution at the client or data leakage via maliciously injected hyper-links. **Version Affected:** 4.2.0 **Payload Used:** =10+20+cmd|' /C calc'!A0 **Vulnerable URL:** master/EventNames.php **Vulnerable Parameters:** Name **Steps to Reproduce:**   1. Login to the application, goto 'Events' module and then "List Event Types" 2. Edit any event and inject the payload =10+20+cmd|' /C calc'!A0 in the 'Name' field 3. Now goto 'List Event types' module and click CSV to download the CSV file 4. Open the CSV file, allow all popups and our payload is executed (calculator is opened).    [2020-10-24 10_28_13-](https://user-images.githubusercontent.com/20786373/97068288-e8a7c280-15e3-11eb-85ef-4713488f5de5.png)    [2020-10-24 10_28_50-ChurchCRM Edit Event Types (4) csv - Excel](https://user-images.githubusercontent.com/20786373/97068304-f0fffd80-15e3-11eb-9dc5-579c475231a4.png)   **Note:** Incase the payload does not execute, then enable 'External Content' and 'Macro' settings in Excel. Goto Excel > File > Options > Trust Center > Trust Center Settings > Macro/External Content. **References:** <https://nvd.nist.gov/vuln/detail/CVE-2019-12134> <http://cwe.mitre.org/data/definitions/1236.html> |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@DawoudIO](https://avatars.githubusercontent.com/u/554959?s=40&u=2757c681c3c50e3fe31cf7b903d896b5d240358f&v=4)](/DawoudIO)
[DawoudIO](/DawoudIO)
added
[Security](/ChurchCRM/CRM/labels/Security)
[bug](/ChurchCRM/CRM/labels/bug)
labels
[Oct 24, 2020](#event-3916906573)

[![@DawoudIO](https://avatars.githubusercontent.com/u/554959?s=80&u=2757c681c3c50e3fe31cf7b903d896b5d240358f&v=4)](/DawoudIO)

Copy link

Contributor

### **[DawoudIO](/DawoudIO)** commented [Oct 24, 2020](#issuecomment-715977633) • edited Loading

| Just to confirm, this is not an issue with our CSV import but if a row had bad data the exported CVS has an issue. We use <https://datatables.net/> if you have a chance, maybe you can help see if they have fixed that. |
| --- |

All reactions

Sorry, something went wrong.

[![@muffyhub](https://avatars.githubusercontent.com/u/20786373?s=80&v=4)](/muffyhub)

Copy link

Author

### **[muffyhub](/muffyhub)** commented [Oct 25, 2020](#issuecomment-716146856)

| [@DawoudIO](https://github.com/DawoudIO) I think the problem lies in the export feature. It would be nice to have an option in download csv to escape strings that begin with "+","-","@", or "=" by prepending "\t". For any cell that begins with one of the formula triggering characters =, -, +, or @, you should directly prefix it with a tab character. |
| --- |

All reactions

Sorry, something went wrong.

[![@MrClever](https://avatars.githubusercontent.com/u/6720584?s=80&v=4)](/MrClever)

Copy link

Collaborator

### **[MrClever](/MrClever)** commented [Oct 27, 2020](#issuecomment-716939194)

| I'm not seeing how this is a particularly useful bug report. Anyone can create a CSV file with any arbitrary text in it using **any text editor** or text generation tool. How using ChurchCRM to generate a CSV with questionable content is a "bug" leaves me perplexed. For example, this logic implies the bash `echo` command has this same *"bug"* too:  ``` echo -e "Header 1, Header 2, Header 3\n1,=10+20+cmd|' /C calc'!A0,Foo bar\n2,Hello world,Text text" > test.csv ```  If there was a method to use unauthenticated access to ChurchCRM that allowed insertion of arbitrary data values AND generate a CSV AND somehow send that somewhere then *maybe* I'd consider this a flaw in ChurchCRM. Maybe I'm missing something? |
| --- |

All reactions

Sorry, something went wrong.

[![@muffyhub](https://avatars.githubusercontent.com/u/20786373?s=80&v=4)](/muffyhub)

Copy link

Author

### **[muffyhub](/muffyhub)** commented [Oct 29, 2020](#issuecomment-718701632) • edited Loading

| I understand that this vulnerability would be much impactful if any unauthenticated user would be able to inject the payload resulting into code execution on the internal user's system. However this could also be impactful, if any internal user of the application enters the payload which results into impacting all the other user of the application. Here the payload is entered on ChurchCRM application leaving the application at fault to generate a file which can execute malicious commands on the user's system. A user may embed Dynamic Data Exchange (DDE) formulas to perform code execution, download a backdoor, open a malicious website etc. The legitimate user may download the file because of following reasons:   1. The user trusts the site that the content is coming from. 2. The user assumes that it is only a csv file and that it won't contain functions or macro's and won't care about any warnings from Excel about potential malicious functionality in the file.   [https://owasp.org/www-community/attacks/CSV\_Injection#:~:text=CSV%20Injection%2C%20also%20known%20as,the%20software%20as%20a%20formula.](url) [https://payatu.com/csv-injection-basic-to-exploit](url) |
| --- |

All reactions

Sorry, something went wrong.

[![@MrClever](https://avatars.githubusercontent.com/u/6720584?s=80&v=4)](/MrClever)

Copy link

Collaborator

### **[MrClever](/MrClever)** commented [Nov 16, 2020](#issuecomment-727713921)

| Feel free to create a PR. |
| --- |

All reactions

Sorry, something went wrong.

[![@MrClever](https://avatars.githubusercontent.com/u/6720584?s=40&v=4)](/MrClever)
[MrClever](/MrClever)
added
[Security](/ChurchCRM/CRM/labels/Security)
and removed
[Security](/ChurchCRM/CRM/labels/Security)
labels
[Nov 16, 2020](#event-3998283256)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)
[![GitHub Actions](https://avatars.githubusercontent.com/in/15368?s=40&u=167a342ed94d2a713daf64a8b476ead2cebe1852&v=4)](https://github.com/apps/github-actions)

Copy link

Contributor

### **[github-actions](/apps/github-actions) bot** commented [Dec 24, 2023](#issuecomment-1868414210)

| This issue is stale because it has been open 30 days with no activity. Remove stale label or comment or this will be closed in 5 days. |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[Stale](/ChurchCRM/CRM/labels/Stale)
label
[Dec 24, 2023](#event-11331784198)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)
[![GitHub Actions](https://avatars.githubusercontent.com/in/15368?s=40&u=167a342ed94d2a713daf64a8b476ead2cebe1852&v=4)](https://github.com/apps/github-actions)

Copy link

Contributor

### **[github-actions](/apps/github-actions) bot** commented [Jan 8, 2024](#issuecomment-1880297519)

| This issue was closed because it has been stalled for 15 days with no activity. |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
closed this as [not planned](/ChurchCRM/CRM/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3A%22not+planned%22)
Won't fix, can't repro, duplicate, stale
[Jan 8, 2024](#event-11412637147)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FChurchCRM%2FCRM%2Fissues%2F5465)

Assignees

No one assigned

Labels

[bug](/ChurchCRM/CRM/labels/bug)
[Security](/ChurchCRM/CRM/labels/Security)
[Stale](/ChurchCRM/CRM/labels/Stale)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@DawoudIO](https://avatars.githubusercontent.com/u/554959?s=52&v=4)](/DawoudIO) [![@MrClever](https://avatars.githubusercontent.com/u/6720584?s=52&v=4)](/MrClever) [![@muffyhub](https://avatars.githubusercontent.com/u/20786373?s=52&v=4)](/muffyhub)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

