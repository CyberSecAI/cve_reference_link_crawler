The content is related to CVE-2024-33382.

**Root cause of vulnerability:**
The root cause is incorrect error handling in the gmm state machine of the AMF (Access and Mobility Management Function) in Open5GS when processing Nudm_UECM_Registration responses from the UDM (Unified Data Management). Specifically, if a UE sends multiple registration requests in quick succession, the AMF might release the previous UE context before receiving the UDM response for the first registration attempt. When this response eventually arrives, the AMF is in the `gmm_state_authentication` state, but there is no handler for this scenario. This leads to a crash due to an invalid service name.

**Weaknesses/vulnerabilities present:**
- Improper state handling in the GMM state machine.
- Lack of handling for out-of-order or delayed responses from the UDM while in the `gmm_state_authentication` state.
- Race condition due to concurrent registration requests from the same UE.

**Impact of exploitation:**
- Crash of the AMF, which can disrupt network services for connected UEs.
- Denial of service by repeatedly sending registration requests from the same UE or using a malicious UE.

**Attack vectors:**
- Sending multiple registration requests from the same UE rapidly.
- Sending a registration request from a malicious UE at a specific time to trigger the race condition.

**Required attacker capabilities/position:**
- Ability to send registration requests, either from a legitimate or malicious UE.
- Access to the network, for example by operating a gNB.
- Ability to send InitialUEMessage (registration request) to the AMF.
- For specific timing attacks, some knowledge of the network timing is required.