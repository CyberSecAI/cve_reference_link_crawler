

search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#915563

## Microsoft Exchange vulnerable to server-side request forgery and remote code execution.

#### Vulnerability Note VU#915563

Original Release Date: 2022-10-03 | Last Revised: 2022-11-10

---

### Overview

Microsoft Exchange Server 2019, Exchange Server 2016 and Exchange Server 2013 are vulnerable to a server-side request forgery (SSRF) attack and remote code execution. An authenticated attacker can use the combination of these two vulnerabilities to elevate privileges and execute arbitrary code on the target Exchange server.

### Description

Microsoft Exchange Server's  [Autodiscover service](https://learn.microsoft.com/en-us/exchange/architecture/client-access/autodiscover?view=exchserver-2019) is a web service widely available to any Microsoft Exchange Web Services (EWS) client. Since Microsoft Exchange version 2016, the Autodiscover service has become an integral part of the Microsoft Exchange system, and it is no longer independently provided by a Client Access server. The Autodiscover service and a number of other privileged mailbox services are hosted on the default Internet Information Services server running on the Mailbox server.

Cybersecurity company GTSC [observed an abuse of the Autodiscover service in August of 2022](https://www.gteltsc.vn/blog/warning-new-attack-campaign-utilized-a-new-0day-rce-vulnerability-on-microsoft-exchange-server-12715.html) using a crafted URL SSRF attack, similar to the earlier [ProxyShell](https://techcommunity.microsoft.com/t5/exchange-team-blog/proxyshell-vulnerabilities-and-your-exchange-server/ba-p/2684705) vulnerability reported in August 2021. The observed attack appears to have implemented [CVE-2022-41040](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41040) to gain privileged access and [CVE-2022-41082](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41082) to perform remote code execution via PowerShell. Microsoft Security Research Center has [acknowledged the vulnerability and provided guidance for mitigation](https://msrc-blog.microsoft.com/2022/09/29/customer-guidance-for-reported-zero-day-vulnerabilities-in-microsoft-exchange-server/). The guidance highlights that Microsoft Exchange Online customers will be provided with detection and mitigation defenses automatically from Microsoft's managed Infrastructure, informing them of any attempts to exploit these vulnerabilities.

### Impact

An authenticated remote attacker can perform SSRF attacks to escalate privileges and execute arbtirary PowerShell code on vulnerable Microsoft Exchange servers. As the attack is targeted against Microsoft Exchange Mailbox server, the attacker can potentially gain access to other resources via lateral movement into Exchange and Active Directory environments.

### Solution

#### Workaround guidance

Microsoft has provided guidance in their [recent blog post](https://msrc-blog.microsoft.com/2022/09/29/customer-guidance-for-reported-zero-day-vulnerabilities-in-microsoft-exchange-server/) to address the issue. Note that Microsoft has updated their guidance for the Option 3 Step 6 with the URL filter to be *.\*autodiscover\.json.\*Powershell.\** (excluding the *@* symbol) instead of the earlier *.\*autodiscover\.json.\*\@.\*Powershell.\**. The recommended block pattern is a regular expression suggested by [Jang](https://twitter.com/testanull) to prevent known variants of the #ProxyNotShell attacks. Microsoft further updated their advisory on October 8th suggesting **Condition Input** should be changed from {URL} to {UrlDecode:{REQUEST\_URI}} to ensure all encoded variations are evaluated before being blocked.

#### Apply update when available

As of October 3, 2022, there is no patch available to mitigate this issue. It is recommended that Microsoft Exchange administrators stay on alert for any advisory or patch released by Microsoft. Note the latest security updates from Microsoft on [October 11th](https://techcommunity.microsoft.com/t5/exchange-team-blog/released-october-2022-exchange-server-security-updates/ba-p/3646263) **do not** address the vulnerabilities highlighted here. Even with the workaround in place, many on-premise Microsoft Exchange instances remain at risk until Microsoft provides a patch and the patch has been applied.

On November 8th 2022, Microsoft has provided fixes as part of their Patch Tuesday rollout, see updated Microsoft's guidance at [CVE-2022-41082](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41082) and [CVE-2022-41040](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41040).

#### Third-party web application protection

Exchange Administrators who use third-party Web Application Firewall (WAF) products can implement the recommended URL filters and blocks as part of their WAF policy.

#### Other mitigations

Exchange Administrators can limit the outgoing connection from the Exchange Mailbox server using specific allowed list on an outgoing proxy to limit suspicious web requests.

This document was written by Vijay Sarvepalli.

### Vendor Information

915563
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [Microsoft](#Microsoft) Unknown

Notified:  2022-10-03
Updated: 2022-10-03

| **CVE-2022-41040** | Unknown |
| --- | --- |
| **CVE-2022-41082** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Microsoft Vulnerability Research](#Microsoft%20Vulnerability%20Research) Unknown

Notified:  2022-10-03
Updated: 2022-10-04

| **CVE-2022-41040** | Unknown |
| --- | --- |
| **CVE-2022-41082** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### References

* <https://msrc-blog.microsoft.com/2022/09/29/customer-guidance-for-reported-zero-day-vulnerabilities-in-microsoft-exchange-server/>
* <https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41040>
* <https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41082>
* <https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/>
* <https://doublepulsar.com/proxynotshell-the-story-of-the-claimed-zero-day-in-microsoft-exchange-5c63d963a9e9>
* <https://rw.md/2022/11/09/ProxyNotRelay.html>

### Other Information

| **CVE IDs:** | [CVE-2022-41040](http://web.nvd.nist.gov/vuln/detail/CVE-2022-41040)  [CVE-2022-41082](http://web.nvd.nist.gov/vuln/detail/CVE-2022-41082) |
| --- | --- |
| **API URL:** | [VINCE JSON](/vuls/api/915563/) | [CSAF](/vuls/api/915563/csaf/) |
| **Date Public:** | 2022-10-03 |
| **Date First Published:** | 2022-10-03 |
| **Date Last Updated:** | 2022-11-10 01:59 UTC |
| **Document Revision:** | 9 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800

