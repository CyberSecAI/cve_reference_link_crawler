The provided content is related to CVE-2021-21428.

**Root cause of vulnerability:**
The vulnerability stems from a race condition in the way the `openapi-generator-online` creates temporary directories. It uses `File.createTempFile` to create a temporary file, then deletes the file and creates a directory with the same name.

**Weaknesses/vulnerabilities present:**
- **Race Condition:** A time-of-check to time-of-use (TOCTOU) race condition exists between the deletion of the temporary file and the creation of the temporary directory.
- **Insecure Temporary File Creation:** Using `File.createTempFile` followed by a delete and mkdir introduces a race condition.
- **Insecure Permissions:** The created temporary directory is accessible by all users on the system due to the use of the system's shared temporary directory.

**Impact of exploitation:**
- **Local Privilege Escalation:** A local attacker can exploit the race condition to create a directory with the same name as the intended temporary directory before the `openapi-generator-online` can.
- **Code Injection:** Because the generator writes generated code to this directory, an attacker can write malicious code to this directory.
- **Arbitrary Code Execution:** When the generated code is executed, the attacker's injected code can run with the privileges of the user executing it.

**Attack vectors:**
- **Local Access:** The attacker must have local access to the system where the vulnerable software is running and have the ability to observe the creation of temporary files.

**Required attacker capabilities/position:**
- The attacker needs to be a local user on the same system as the `openapi-generator-online` process.
- The attacker needs to be able to monitor the creation of the temporary files.
- The attacker needs to have the ability to create directories.

The vulnerability is addressed by switching from `File.createTempFile` to `Files.createTempFile` in the patch.