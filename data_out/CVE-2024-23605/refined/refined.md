- **Root cause of vulnerability**: Integer overflow during the calculation of memory allocation size for key-value pairs in a GGUF file. The `ctx->header.n_kv` (number of key-value pairs) is multiplied by `sizeof(struct gguf_kv)` (size of a key-value pair structure) which can result in an integer overflow.
- **Weaknesses/vulnerabilities present**: Heap-based buffer overflow due to insufficient memory allocation. The multiplication of `ctx->header.n_kv` with `sizeof(struct gguf_kv)` overflows, leading to the allocation of a smaller memory chunk than required. This subsequently results in an out-of-bounds write when populating `kv->key` via the `gguf_fread_str` function.
- **Impact of exploitation**: Code execution via heap buffer overflow. An attacker can achieve code execution by providing a specially crafted `.gguf` file.
- **Attack vectors**: An attacker provides a malicious `.gguf` file to the vulnerable application.
- **Required attacker capabilities/position**: The attacker needs the ability to supply a malicious `.gguf` file to the vulnerable application, which is processing the file.