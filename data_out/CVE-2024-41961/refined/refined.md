The provided content relates to CVE-2024-41961.

**Root cause of vulnerability:**
The vulnerability stems from a code injection flaw in the live search functionality of the Elektra web application. Specifically, the application uses `eval` to execute code derived from user-provided search terms.

**Weaknesses/vulnerabilities present:**
- Code Injection: The application takes user-provided input (search terms) and, without proper sanitization, incorporates it into Ruby code that's executed via `eval`.
- Use of `eval`: The use of `eval` allows an attacker to execute arbitrary Ruby code within the application context.

**Impact of exploitation:**
Successful exploitation allows an attacker to execute arbitrary code on the server, potentially leading to:
- Data breaches: Gaining access to sensitive data.
- System compromise: Complete control of the server.
- Denial of service: Crashing or disrupting the application.

**Attack vectors:**
- Network: An attacker can exploit the vulnerability over a network connection.

**Required attacker capabilities/position:**
- Authenticated user: The attacker needs to be an authenticated user of the Elektra web application.
- Crafting malicious input: The attacker needs to craft a search term containing malicious Ruby code.

**Additional details:**
- The vulnerability was identified with the help of CodeQL's "Code injection" query.
- The vulnerability has been fixed in commit `8bce00be93b95a6512ff68fe86bf9554e486bc02`.
- The fix involves removing the use of `Marshal.load` and sanitizing user inputs.
- The vulnerable code was located in `app/controllers/concerns/api_lookup.rb`. The fix involved modifying how the `:term` parameter was handled before it was passed to `service.public_send`.
- The vulnerability is rated as "Critical" with a CVSS score of 9.6.
- The attack complexity is low.
- No user interaction is required for exploitation.
- The scope is changed meaning the impact extends beyond the vulnerable component.
- The impact is high for confidentiality and availability, but none for integrity.