=== Content from zoneminder.com_26ca8e17_20250111_195749.html ===

Toggle navigation

[ZoneMinder](/)

* [Home](/)
* [Features](/features/)
* [Services](https://cloud.zoneminder.com/services.html)
* [Blog](https://cloud.zoneminder.com/article/list.html)
* [Downloads](https://cloud.zoneminder.com/downloads.html)
* [Contact](/contact/)
* [Donate](/donate/)

* [Documentation](http://zoneminder.readthedocs.org/en/latest/)
* [Wiki](https://wiki.zoneminder.com)
* [Forums](https://forums.zoneminder.com)

A full-featured, open source, state-of-the-art video surveillance software system.

Monitor your home, office, or wherever you want. Using off the shelf hardware with any camera, you can design a system as large or as small as you need.

[Download Now](/downloads/)

## What people are using ZoneMinder for

![Home Security](/images/SVGs/Home_Security.svg)

Home Security

![Theft Prevention](/images/SVGs/Theft_Prevention.svg)

Theft Prevention

![Industrial and Commercial Security](/images/SVGs/Industrial_and_Commercial_Security.svg)

Industrial and Commercial Security

![Household use](/images/SVGs/Nanny_Cams.svg)

Household use

## Why ZoneMinder is so awesome

* It's free and open source.
* You are in control of your data.
* Works with a huge list of cameras.
* Most scalable NVR/DVR system available.

* Easy to install - from package or source.
* APIs allow for third-party integration.
* [zmNinja](https://zmninja.zoneminder.com) - Awesome mobile and desktop app.
* Amazing 3rd party integrations - ALPR, Object/Person Detection, Event Blending and more

Check us out on:

* [![Facebook](/images/SVGs/facebook.svg)](https://www.facebook.com/zoneminder)
* [![Github](/images/SVGs/Github.svg)](https://github.com/ZoneMinder/ZoneMinder/)
* [![Slack](/images/Slack_Mark_Web.png)](https://join.slack.com/t/zoneminder-chat/shared_invite/enQtNTU0NDkxMDM5NDQwLTdhZmQ5Y2M2NWQyN2JkYTBiN2ZkMzIzZGQ0MDliMTRmM2FjZWRlYzUwYTQ2MjMwMTVjMzQ1NjYxOTdmMjE2MTE)
* [![Twitter](/images/SVGs/twitter.svg)](https://twitter.com/zoneminder)
* [![Reddit](/images/SVGs/Reddit.svg)](https://www.reddit.com/r/zoneminder)
* [![Instagram](/images/SVGs/Instagram.svg)](https://www.instagram.com/zoneminder)
* [![Youtube](/images/SVGs/youtube-red-circle.svg)](https://www.youtube.com/channel/UCDKfmvDdcPBrB6rO2aj5Wlg)
* [![Discord](/images/SVGs/discord.svg)](https://discord.gg/tHYyP9k66q)
* [![Mastodon](/images/SVGs/mastodon-icon.svg)](https://fosstodon.org/%40zoneminder)



=== Content from medium.com_7463cba0_20250111_195750.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F0686f5bcd370&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40dk50u1%2Frce-remote-code-execution-in-zoneminder-up-to-1-36-33-0686f5bcd370&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40dk50u1%2Frce-remote-code-execution-in-zoneminder-up-to-1-36-33-0686f5bcd370&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# RCE (Remote Code Execution)in Zoneminder up to 1.36.33

[![dk50u1](https://miro.medium.com/v2/resize:fill:88:88/1*s_YgXIkyPbwbVD9pbxRYaQ.jpeg)](/%40dk50u1?source=post_page---byline--0686f5bcd370--------------------------------)

[dk50u1](/%40dk50u1?source=post_page---byline--0686f5bcd370--------------------------------)

Â·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb483dfeb9072&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40dk50u1%2Frce-remote-code-execution-in-zoneminder-up-to-1-36-33-0686f5bcd370&user=dk50u1&userId=b483dfeb9072&source=post_page-b483dfeb9072--byline--0686f5bcd370---------------------post_header-----------)

6 min readÂ·Sep 22, 2024

--

Listen

Share

# CVE-2023-31493

# What is Zoneminder

ZoneMinder is a free, open source Closed-circuit television software application developed for Linux which supports IP, USB and Analog cameras. Itâ€™s a very powerful tool and itâ€™s one of the most used, probably the most used video surveillance tool on linux.

# Vulnerability Description:

RCE (Remote Code Execution) exists in ZoneMinder through 1.36.33 as an attacker can create a new *.php* log file in language folder, poison this log with a crafted payload and consecutively log in with a user who has that log file as language file, allowing execution of any commands on the remote system.

# Affected Assets:

Logging function.

# Introduction:

Already in the past I have occupied the analysis of this tool finding a Session Fixation ([https://medium.com/@dk50u1/session-fixation-in-zoneminder-up-to-v1-36-12-3c850b1fbbf3](/%40dk50u1/session-fixation-in-zoneminder-up-to-v1-36-12-3c850b1fbbf3)) and a Stored XSS ([https://medium.com/@dk50u1/stored-xss-in-zoneminder-up-to-v1-36-12-f26b4bb68c31](/%40dk50u1/stored-xss-in-zoneminder-up-to-v1-36-12-f26b4bb68c31)), but this time I decided to analyze it looking for something more impactful and after a few days of work I was able to pull out the following Remote Code Execution.

# Details & proof of concept:

To start exploiting this vulnerability, a user must go in the app settings , more specifically in *LOG\_DEBUG\_FILE* field under *Options -> Logging*, and change the path to write logs in /*usr/share/zoneminder/www/lang/rce.php* and then enable *LOG\_DEBUG* so that the log file will be created.

![]()

Options to be set to get started

**Explanation:** In fact, */usr/share/zoneminder/www/lang* is the path where the language files used by Zoneminder are stored and *rce.php* will be the log file that i will use like language. This is because, in analyzing the application and its errors, I noticed that when i tried to enter an incorrect language, the application responded with a specific error that made it clear that it was trying to look for that specific language in some *.php* file within the languages path.

![]()

Modified request with a non existing language

![]()

App is trying to find non esisting language php file

If you go to analyze the code corresponding to this function, you can see how the application attempts to search for the .php file corresponding to the selected language.

![]()

Piece of code triggered

So to bypass the check i have just to create any file with *.php* extension in the lang folder.

After wandering around the application, I came across in the *LOG\_DEBUG\_FILE* field, where there are no restrictions on the file you want to create, as to the path, name, or extension. So when I tried to create a *.php* file in the language path folder, it worked!

![]()

Log file created

**So Iâ€™m able to create a php file in language folder and my brain was like:**

![]()

Now that the log file has been created in the place of my choice, I have to make sure that log file will be poisoned somehow with some payload! And so I started combing through the application looking for some place where I could have inject some payload and I chose the users settings as it allowed to inject fairly long payloads in *Home View* and also it allows me to choose the language option which is the focus of this vulnerability.

So the next step is to go into the user settings of any user on the platform under *Options -> Users* and enter as the value of *Home View*, a payload in php that executes a command such as for example:

> **<?php $output = shell\_exec(â€˜idâ€™); echo â€œ<pre>$output</pre>â€; ?>**

and then set as the language of that user, the log file that was created earlier, which is *rce.php*.

**Please note:** The user to be changed can be one of your choice but donâ€™t do this with the admin otherwise at his next login the language will no longer load and you will no longer have the admin user available.

The application clearly doesnâ€™t have within its code our *rce.php* file as a language and thatâ€™s why it wonâ€™t make you choose it from the drop-down menu, but with any tool that acts as a proxy, in my case Burp, just intercept the request when you click on *Save* and change the language you set just before to *rce* (without the *.php* extension). In my case I chose the language *en\_us*, which was subsequently intercepted and changed to *rce*, so that the previously created file *rce.php* will be loaded as the userâ€™s language.

![]()

Request modified with my log file as language

With no backend control about a white list of language, the application now will respond no more with an error, but with a 302 Found because now the language file chosen is in the lang folder! And now the application will write everything that has been and will be done, in the *rce.php* file, including the payload just set in the *Home View* field with the command to be executed.

![]()

302 Found after language modification

I then went to verify that inside the log file the paylaod had been written correctly or with some type of encoding and it was there perfectly as i wrote it!

![]()

Log file is logging what i want

**Now my brain was like:**

![]()

At this point it was necessary for this file to be called up in some way, and the easiest way of course is to log in with the user to whom the previous parameters were changed because the application will attempt at login to load the log file *rce.php* as the language and will execute the payload. In my example, the user was named *asdasd* (Sorry, not much imagination ðŸ˜…).

![]()

Login with edited user

After logging in with that user, finally instead of the userâ€™s home you will be presented with the log file in which the application wrote and in addition you will find the output of the php payload that was injected earlier and so you are now able to execute any command on the remote machine leading to a Remote Code Execution!

![]()

Finally the payload execution

Request and response with command output, together:

![]()

Request and response together

**And finally my brain was like:**

![]()
# CVSS Score:

AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H â€” 9.1

Thatâ€™s all Folks.

[Cybersecurity](/tag/cybersecurity?source=post_page-----0686f5bcd370--------------------------------)[Remote Code Execution](/tag/remote-code-execution?source=post_page-----0686f5bcd370--------------------------------)[Zoneminder](/tag/zoneminder?source=post_page-----0686f5bcd370--------------------------------)[Cve](/tag/cve?source=post_page-----0686f5bcd370--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----0686f5bcd370--------------------------------)

--

--

[![dk50u1](https://miro.medium.com/v2/resize:fill:96:96/1*s_YgXIkyPbwbVD9pbxRYaQ.jpeg)](/%40dk50u1?source=post_page---post_author_info--0686f5bcd370--------------------------------)[![dk50u1](https://miro.medium.com/v2/resize:fill:128:128/1*s_YgXIkyPbwbVD9pbxRYaQ.jpeg)](/%40dk50u1?source=post_page---post_author_info--0686f5bcd370--------------------------------)Follow[## Written by dk50u1](/%40dk50u1?source=post_page---post_author_info--0686f5bcd370--------------------------------)[10 Followers](/%40dk50u1/followers?source=post_page---post_author_info--0686f5bcd370--------------------------------)Â·[13 Following](/%40dk50u1/following?source=post_page---post_author_info--0686f5bcd370--------------------------------)

Ethical Hacker / Researcher

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----0686f5bcd370--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----0686f5bcd370--------------------------------)[About](/about?autoplay=1&source=post_page-----0686f5bcd370--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----0686f5bcd370--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----0686f5bcd370--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----0686f5bcd370--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----0686f5bcd370--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----0686f5bcd370--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----0686f5bcd370--------------------------------)[Teams](/business?source=post_page-----0686f5bcd370--------------------------------)


