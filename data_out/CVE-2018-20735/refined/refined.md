```
{
  "CVE-2018-20735": {
    "root_cause": "The BMC Patrol Agent software uses the LogonUserA API to authenticate users, which only verifies credentials against the local system, not the remote system where commands are executed. This allows a user to authenticate successfully against the local Patrol Agent service and then execute commands on a remote system running the Patrol Agent as SYSTEM.",
    "weaknesses": [
      "Improper authentication and authorization",
      "Incorrect use of LogonUserA API",
      "Lack of proper ACLs by default on Patrol Agent client interface"
    ],
    "impact": "Privilege escalation to SYSTEM on the target host or Domain Admin if the Patrol Agent is running on a Domain Controller.",
    "attack_vectors": "The attack vector is network-based, requiring access to the BMC Patrol Agent's port (default 3181) and valid user credentials on the target system where the Patrol Agent is installed.",
    "required_capabilities": [
      "Network access to the target system running BMC Patrol Agent on port 3181.",
      "Valid local or domain user credentials on the target system."
    ],
    "additional_details": "The provided Metasploit module leverages a remote command execution feature of the BMC Patrol Agent software. It can be used to escalate privileges on Windows and Linux hosts. The Windows version uses powershell to inject shellcode, and may require multiple tries.  The vulnerability stems from the Patrol Agent authenticating a user locally and then using the SYSTEM context to execute commands on remote hosts which it should not do. The software runs as SYSTEM but only verifies that the password of the provided user is correct. This allows for escalating privileges from a normal domain user to domain admin on a domain controller since SYSTEM on a domain controller is DA. A configuration change can be made to enforce an ACL for which users can connect to the client interface, but this is not enabled by default."
  }
}
```