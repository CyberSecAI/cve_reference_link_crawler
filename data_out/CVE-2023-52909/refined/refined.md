```
{
  "vulnerability": {
    "root_cause": "A race condition and a potential resource leak were identified in the handling of cached open files within the nfsd4_open codepath. Specifically, a newly created nfsd_file could have its PENDING bit cleared while the nf was hashed, but the nf_file pointer was still zeroed, leading to potential NULL pointer dereferences. Additionally, there was no guarantee a new nfsd_file would be created if one was already in the hash, causing the old nf_file to be overwritten and leaked.",
    "weaknesses": [
      "Race condition",
      "Resource leak",
      "Potential NULL pointer dereference"
    ],
    "impact": "The race condition can lead to kernel oops due to NULL pointer dereferences. The resource leak can lead to memory exhaustion over time. ",
    "attack_vectors": "The vulnerability is triggered during the handling of NFSv4 open requests when an open file is cached.",
    "required_capabilities": "An attacker would need to trigger specific NFSv4 open operations that use the file caching mechanism in nfsd. No special privileges are required besides being able to send NFS requests to a vulnerable server."
  },
  "remediation": "The vulnerability is fixed by introducing `nfsd_file_acquire_opened` variant which handles the open file caching correctly, eliminating the race condition and resource leak."
}
```