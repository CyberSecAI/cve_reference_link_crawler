
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvoila-dashboards%2Fvoila%2Fcommit%2F28faacc9b03b160fd8fa920ad045f4ec0667ab67)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvoila-dashboards%2Fvoila%2Fcommit%2F28faacc9b03b160fd8fa920ad045f4ec0667ab67)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=voila-dashboards%2Fvoila)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[voila-dashboards](/voila-dashboards)
/
**[voila](/voila-dashboards/voila)**
Public

* [Notifications](/login?return_to=%2Fvoila-dashboards%2Fvoila) You must be signed in to change notification settings
* [Fork
  506](/login?return_to=%2Fvoila-dashboards%2Fvoila)
* [Star
   5.5k](/login?return_to=%2Fvoila-dashboards%2Fvoila)

* [Code](/voila-dashboards/voila)
* [Issues
  300](/voila-dashboards/voila/issues)
* [Pull requests
  18](/voila-dashboards/voila/pulls)
* [Discussions](/voila-dashboards/voila/discussions)
* [Actions](/voila-dashboards/voila/actions)
* [Projects
  0](/voila-dashboards/voila/projects)
* [Security](/voila-dashboards/voila/security)
* [Insights](/voila-dashboards/voila/pulse)

Additional navigation options

* [Code](/voila-dashboards/voila)
* [Issues](/voila-dashboards/voila/issues)
* [Pull requests](/voila-dashboards/voila/pulls)
* [Discussions](/voila-dashboards/voila/discussions)
* [Actions](/voila-dashboards/voila/actions)
* [Projects](/voila-dashboards/voila/projects)
* [Security](/voila-dashboards/voila/security)
* [Insights](/voila-dashboards/voila/pulse)

## Commit

[Permalink](/voila-dashboards/voila/commit/28faacc9b03b160fd8fa920ad045f4ec0667ab67)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

refactor: reuse voila to be a server extension + tree view + autoreload

[Browse files](/voila-dashboards/voila/tree/28faacc9b03b160fd8fa920ad045f4ec0667ab67)
Browse the repository at this point in the history

```
The voila handler can be used both in the standalone version, as well as
jupyter server extension. The three handler which is based on the notebook
code shows a list of directories and notebooks.
For development purposes the watchdog handler will send a reload message
over the websocket when either the javascript, templates, or the notebook
file is modified, or when the server autoreloads due to code changes.
(Use with `voila --autoreload=True`)
```

* Loading branch information

[![@maartenbreddels](https://avatars.githubusercontent.com/u/1765949?s=40&v=4)](/maartenbreddels)

[maartenbreddels](/voila-dashboards/voila/commits?author=maartenbreddels "View all commits by maartenbreddels")
committed
Sep 6, 2018

1 parent
[e32a1e2](/voila-dashboards/voila/commit/e32a1e286ec3df26df9452385013147c36a59d71)

commit 28faacc

 Show file tree

 Hide file tree

Showing
**9 changed files**
with
**435 additions**
and
**66 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* voila

  + voila/app.py
    [app.py](#diff-09663db2b5963feec1159dd0d146feb6ae3f4883156ece414bbfdaef1417bfa7)
  + voila/handler.py
    [handler.py](#diff-7bc454003168bbff49060f6b1bef6e8d149654b85c18edbf5ca75f1720fdeeff)
  + voila/paths.py
    [paths.py](#diff-82b6d42a5f2677c71fdd29a303d9fb1a3641b086ffd45b4ca8e8bde1bda217db)
  + voila/server\_extension.py
    [server\_extension.py](#diff-577c58409480d56153393adfc7e49ffa86a1f89e57a2e17289936252c109d978)
  + static

    - voila/static/main.js
      [main.js](#diff-ed826992802f33cc630e1177ad55e2c5bd48c1e375d0378910a0f380ac57204b)
  + templates

    - voila/templates/page.html
      [page.html](#diff-979c81ac1886779155b9d1f1f6e98866102709e24baf0c5b6f4c5e3448473ff9)
    - voila/templates/tree.html
      [tree.html](#diff-0cf2b2469d7a20210550b1137bec48f967900e58d4f988a64b5f26c5e47398e1)
  + voila/treehandler.py
    [treehandler.py](#diff-8acd5cd199765b7e752597a4bfae2c0b202070517096f6c8cb1c6cc0e31b4a99)
  + voila/watchdog.py
    [watchdog.py](#diff-b75b4ff0b2bef5999af5c0fbaa95fff0768d00d07b50ac2155af7d138b1ae322)

## There are no files selected for viewing

118 changes: 53 additions & 65 deletions

118
[voila/app.py](#diff-09663db2b5963feec1159dd0d146feb6ae3f4883156ece414bbfdaef1417bfa7 "voila/app.py")

Show comments

[View file](/voila-dashboards/voila/blob/28faacc9b03b160fd8fa920ad045f4ec0667ab67/voila/app.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,57 +7,25 @@ |
|  |  | import tempfile |
|  |  | import json |
|  |  | import logging |
|  |  | import gettext |
|  |  |  |
|  |  | import jinja2 |
|  |  |  |
|  |  | import tornado.ioloop |
|  |  | import tornado.web |
|  |  |  |
|  |  | from pathlib import Path |
|  |  |  |
|  |  | from traitlets.config.application import Application |
|  |  | from traitlets import Unicode, Integer, Bool, default |
|  |  |  |
|  |  | from jupyter\_server.utils import url\_path\_join, url\_escape |
|  |  | from jupyter\_server.base.handlers import JupyterHandler |
|  |  | from jupyter\_server.services.kernels.kernelmanager import MappingKernelManager |
|  |  | from jupyter\_server.services.kernels.handlers import KernelHandler, MainKernelHandler, ZMQChannelsHandler |
|  |  |  |
|  |  | from jupyter\_client.jsonutil import date\_default |
|  |  |  |
|  |  | import nbformat |
|  |  | from nbconvert.preprocessors.execute import executenb |
|  |  | from nbconvert import HTMLExporter |
|  |  |  |
|  |  | ROOT = Path(os.path.dirname(\_\_file\_\_)) |
|  |  | DEFAULT\_STATIC\_ROOT = ROOT / 'static' |
|  |  | TEMPLATE\_ROOT = ROOT / 'templates' |
|  |  |  |
|  |  | class VoilaHandler(JupyterHandler): |
|  |  |  |
|  |  | def initialize(self, notebook=None, strip\_sources=False): |
|  |  | self.notebook = notebook |
|  |  | self.strip\_sources = strip\_sources |
|  |  |  |
|  |  | @tornado.web.authenticated |
|  |  | @tornado.gen.coroutine |
|  |  | def get(self): |
|  |  | from jupyter\_server.services.kernels.handlers import KernelHandler, ZMQChannelsHandler |
|  |  | from jupyter\_server.base.handlers import path\_regex |
|  |  | from jupyter\_server.services.contents.largefilemanager import LargeFileManager |
|  |  |  |
|  |  | # Ignore requested kernel name and make use of the one specified in the notebook. |
|  |  | kernel\_name = self.notebook.metadata.get('kernelspec', {}).get('name', self.kernel\_manager.default\_kernel\_name) |
|  |  |  |
|  |  | # Launch kernel and execute notebook. |
|  |  | kernel\_id = yield tornado.gen.maybe\_future(self.kernel\_manager.start\_kernel(kernel\_name=kernel\_name)) |
|  |  | km = self.kernel\_manager.get\_kernel(kernel\_id) |
|  |  | result = executenb(self.notebook, km=km) |
|  |  |  |
|  |  | # render notebook to html |
|  |  | resources = dict(kernel\_id=kernel\_id) |
|  |  | html, resources = HTMLExporter(template\_file=str(TEMPLATE\_ROOT / 'voila.tpl'), exclude\_input=self.strip\_sources, |
|  |  | exclude\_output\_prompt=self.strip\_sources, exclude\_input\_prompt=self.strip\_sources |
|  |  | ).from\_notebook\_node(result, resources=resources) |
|  |  |  |
|  |  | # Compose reply |
|  |  | self.set\_header('Content-Type', 'text/html') |
|  |  | self.write(html) |
|  |  | from .paths import ROOT, STATIC\_ROOT, TEMPLATE\_ROOT |
|  |  | from .handler import VoilaHandler |
|  |  | from .treehandler import VoilaTreeHandler |
|  |  | from .watchdog import WatchDogHandler |
|  |  |  |
|  |  | \_kernel\_id\_regex = r"(?P<kernel\_id>\w+-\w+-\w+-\w+-\w+)" |
|  |  |  |
| Expand All | | @@ -73,7 +41,7 @@ class Voila(Application): |
|  |  | ) |
|  |  | option\_description = Unicode( |
|  |  | """ |
|  |  | notebook\_filename: |
|  |  | notebook\_path: |
|  |  | File name of the Jupyter notebook to display. |
|  |  | """ |
|  |  | ) |
| Expand All | | @@ -84,15 +52,21 @@ class Voila(Application): |
|  |  | config=True, |
|  |  | help='Port of the voila server. Default 8866.' |
|  |  | ) |
|  |  | autoreload = Bool( |
|  |  | False, |
|  |  | config=True, |
|  |  | help='Will autoreload to server and the page when a template, js file or Python code changes' |
|  |  | ) |
|  |  | static\_root = Unicode( |
|  |  | str(DEFAULT\_STATIC\_ROOT), |
|  |  | str(STATIC\_ROOT), |
|  |  | config=True, |
|  |  | help='Directory holding static assets (HTML, JS and CSS files).' |
|  |  | ) |
|  |  | aliases = { |
|  |  | 'port': 'Voila.port', |
|  |  | 'static': 'Voila.static\_root', |
|  |  | 'strip\_sources': 'Voila.strip\_sources' |
|  |  | 'strip\_sources': 'Voila.strip\_sources', |
|  |  | 'autoreload': 'Voila.autoreload' |
|  |  | } |
|  |  | connection\_dir\_root = Unicode( |
|  |  | config=True, |
| Expand All | | @@ -116,14 +90,7 @@ def \_default\_log\_level(self): |
|  |  |  |
|  |  | def parse\_command\_line(self, argv=None): |
|  |  | super(Voila, self).parse\_command\_line(argv) |
|  |  | try: |
|  |  | notebook\_filename = self.extra\_args[0] |
|  |  | except IndexError: |
|  |  | self.log.critical('Bad command line parameters.') |
|  |  | self.log.critical('Missing NOTEBOOK\_FILENAME parameter.') |
|  |  | self.log.critical('Run `voila --help` for help on command line parameters.') |
|  |  | exit(1) |
|  |  | self.notebook\_filename = notebook\_filename |
|  |  | self.notebook\_path = self.extra\_args[0] if len(self.extra\_args) == 1 else None |
|  |  |  |
|  |  | def start(self): |
|  |  | connection\_dir = tempfile.mkdtemp( |
| Expand All | | @@ -143,21 +110,11 @@ def start(self): |
|  |  | ] |
|  |  | ) |
|  |  |  |
|  |  | notebook = nbformat.read(self.notebook\_filename, as\_version=4) |
|  |  |  |
|  |  | handlers = [ |
|  |  | ( |
|  |  | r'/', |
|  |  | VoilaHandler, |
|  |  | { |
|  |  | 'notebook': notebook, |
|  |  | 'strip\_sources': self.strip\_sources |
|  |  | } |
|  |  | ), |
|  |  | (r'/api/kernels/%s' % \_kernel\_id\_regex, KernelHandler), |
|  |  | (r'/api/kernels/%s/channels' % \_kernel\_id\_regex, ZMQChannelsHandler), |
|  |  | ( |
|  |  | r"/static/(.\*)", |
|  |  | r"/voila/static/(.\*)", |
|  |  | tornado.web.StaticFileHandler, |
|  |  | { |
|  |  | 'path': self.static\_root, |
| Expand All | | @@ -166,10 +123,41 @@ def start(self): |
|  |  | ) |
|  |  | ] |
|  |  |  |
|  |  | if self.notebook\_path: |
|  |  | handlers.append(( |
|  |  | r'/', |
|  |  | VoilaHandler, |
|  |  | { |
|  |  | 'notebook\_path': self.notebook\_path, |
|  |  | 'strip\_sources': self.strip\_sources |
|  |  | } |
|  |  | )) |
|  |  | else: |
|  |  | handlers.extend([ |
|  |  | ('/', VoilaTreeHandler), |
|  |  | ('/voila/tree' + path\_regex, VoilaTreeHandler), |
|  |  | ('/voila/render' + path\_regex, VoilaHandler, {'strip\_sources': self.strip\_sources}), |
|  |  | ]) |
|  |  | if self.autoreload: |
|  |  | handlers.append(('/voila/watchdog' + path\_regex, WatchDogHandler)) |
|  |  |  |
|  |  | jenv\_opt = {"autoescape": True} # we might want extra options via cmd line like notebook server |
|  |  | env = jinja2.Environment(loader=jinja2.FileSystemLoader(str(TEMPLATE\_ROOT)), extensions=['jinja2.ext.i18n'], \*\*jenv\_opt) |
|  |  | nbui = gettext.translation('nbui', localedir=str(ROOT / 'i18n'), fallback=True) |
|  |  | env.install\_gettext\_translations(nbui, newstyle=False) |
|  |  |  |
|  |  | contents\_manager = LargeFileManager() # TODO: make this configurable like notebook |
|  |  |  |
|  |  |  |
|  |  | app = tornado.web.Application( |
|  |  | handlers, |
|  |  | kernel\_manager=kernel\_manager, |
|  |  | allow\_remote\_access=True |
|  |  | allow\_remote\_access=True, |
|  |  | autoreload=self.autoreload, |
|  |  | voila\_jinja2\_env=env, |
|  |  | static\_path='/', |
|  |  | server\_root\_dir='/', |
|  |  | contents\_manager=contents\_manager |
|  |  | ) |
|  |  |  |
|  |  | app.listen(self.port) |
| Expand Down | |  |

45 changes: 45 additions & 0 deletions

45
[voila/handler.py](#diff-7bc454003168bbff49060f6b1bef6e8d149654b85c18edbf5ca75f1720fdeeff "voila/handler.py")

Show comments

[View file](/voila-dashboards/voila/blob/28faacc9b03b160fd8fa920ad045f4ec0667ab67/voila/handler.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,45 @@ |
|  |  | import tornado.web |
|  |  |  |
|  |  | from jupyter\_server.base.handlers import JupyterHandler |
|  |  |  |
|  |  | import nbformat |
|  |  | from nbconvert.preprocessors.execute import executenb |
|  |  | from nbconvert import HTMLExporter |
|  |  |  |
|  |  | from .paths import TEMPLATE\_ROOT |
|  |  |  |
|  |  |  |
|  |  | class VoilaHandler(JupyterHandler): |
|  |  | def initialize(self, notebook\_path=None, strip\_sources=True): |
|  |  | self.notebook\_path = notebook\_path |
|  |  | self.strip\_sources = strip\_sources |
|  |  |  |
|  |  | @tornado.web.authenticated |
|  |  | @tornado.gen.coroutine |
|  |  | def get(self, path=None): |
|  |  | if path: |
|  |  | path = path.strip('/') # remove leading / |
|  |  | path += '.ipynb' # when used as a jupyter server extension, we don't use the extension |
|  |  | # if the handler got a notebook\_path argument, always serve that |
|  |  | notebook\_path = self.notebook\_path or path |
|  |  |  |
|  |  | notebook = nbformat.read(notebook\_path, as\_version=4) |
|  |  |  |
|  |  | # Ignore requested kernel name and make use of the one specified in the notebook. |
|  |  | kernel\_name = notebook.metadata.get('kernelspec', {}).get('name', self.kernel\_manager.default\_kernel\_name) |
|  |  |  |
|  |  | # Launch kernel and execute notebook. |
|  |  | kernel\_id = yield tornado.gen.maybe\_future(self.kernel\_manager.start\_kernel(kernel\_name=kernel\_name)) |
|  |  | km = self.kernel\_manager.get\_kernel(kernel\_id) |
|  |  | result = executenb(notebook, km=km) |
|  |  |  |
|  |  | # render notebook to html |
|  |  | resources = dict(kernel\_id=kernel\_id) |
|  |  | html, resources = HTMLExporter(template\_file=str(TEMPLATE\_ROOT / 'voila.tpl'), exclude\_input=self.strip\_sources, |
|  |  | exclude\_output\_prompt=self.strip\_sources, exclude\_input\_prompt=self.strip\_sources |
|  |  | ).from\_notebook\_node(result, resources=resources) |
|  |  |  |
|  |  | # Compose reply |
|  |  | self.set\_header('Content-Type', 'text/html') |
|  |  | self.write(html) |
|  |  |  |

7 changes: 7 additions & 0 deletions

7
[voila/paths.py](#diff-82b6d42a5f2677c71fdd29a303d9fb1a3641b086ffd45b4ca8e8bde1bda217db "voila/paths.py")

Show comments

[View file](/voila-dashboards/voila/blob/28faacc9b03b160fd8fa920ad045f4ec0667ab67/voila/paths.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,7 @@ |
|  |  | import os |
|  |  | from pathlib import Path |
|  |  |  |
|  |  | ROOT = Path(os.path.dirname(\_\_file\_\_)) |
|  |  | STATIC\_ROOT = ROOT / 'static' |
|  |  | TEMPLATE\_ROOT = ROOT / 'templates' |
|  |  |  |

37 changes: 37 additions & 0 deletions

37
[voila/server\_extension.py](#diff-577c58409480d56153393adfc7e49ffa86a1f89e57a2e17289936252c109d978 "voila/server_extension.py")

Show comments

[View file](/voila-dashboards/voila/blob/28faacc9b03b160fd8fa920ad045f4ec0667ab67/voila/server_extension.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,37 @@ |
|  |  | import os |
|  |  | import gettext |
|  |  | from pathlib import Path |
|  |  |  |
|  |  | from jinja2 import Environment, FileSystemLoader |
|  |  |  |
|  |  | import tornado.web |
|  |  |  |
|  |  | from jupyter\_server.utils import url\_path\_join |
|  |  | from jupyter\_server.base.handlers import path\_regex |
|  |  |  |
|  |  | from .paths import ROOT, TEMPLATE\_ROOT, STATIC\_ROOT |
|  |  | from .handler import VoilaHandler |
|  |  | from .treehandler import VoilaTreeHandler |
|  |  | from .watchdog import WatchDogHandler |
|  |  |  |
|  |  |  |
|  |  | def load\_jupyter\_server\_extension(server\_app): |
|  |  | web\_app = server\_app.web\_app |
|  |  |  |
|  |  | jenv\_opt = {"autoescape": True} |
|  |  | env = Environment(loader=FileSystemLoader(str(TEMPLATE\_ROOT)), extensions=['jinja2.ext.i18n'], \*\*jenv\_opt) |
|  |  | web\_app.settings['voila\_jinja2\_env'] = env |
|  |  |  |
|  |  | nbui = gettext.translation('nbui', localedir=str(ROOT / 'i18n'), fallback=True) |
|  |  | env.install\_gettext\_translations(nbui, newstyle=False) |
|  |  |  |
|  |  | host\_pattern = '.\*$' |
|  |  | web\_app.add\_handlers(host\_pattern, [ |
|  |  | (url\_path\_join(web\_app.settings['base\_url'], '/voila/render' + path\_regex), VoilaHandler), |
|  |  | (url\_path\_join(web\_app.settings['base\_url'], '/voila/watchdog' + path\_regex), WatchDogHandler), |
|  |  | (url\_path\_join(web\_app.settings['base\_url'], '/voila'), VoilaTreeHandler), |
|  |  | (url\_path\_join(web\_app.settings['base\_url'], '/voila/tree' + path\_regex), VoilaTreeHandler), |
|  |  | (url\_path\_join(web\_app.settings['base\_url'], '/voila/static/(.\*)'), tornado.web.StaticFileHandler, |
|  |  | {'path': str(STATIC\_ROOT)}) |
|  |  |  |
|  |  | ]) |

17 changes: 16 additions & 1 deletion

17
[voila/static/main.js](#diff-ed826992802f33cc630e1177ad55e2c5bd48c1e375d0378910a0f380ac57204b "voila/static/main.js")

Show comments

[View file](/voila-dashboards/voila/blob/28faacc9b03b160fd8fa920ad045f4ec0667ab67/voila/static/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,7 +9,7 @@ Array.prototype.forEach.call(scripts, (script) => { |
|  |  | }) |
|  |  |  |
|  |  | requirejs.config({ |
|  |  | baseUrl: 'static/dist' |
|  |  | baseUrl: '/voila/static/dist' |
|  |  | }) |
|  |  |  |
|  |  | require(['libwidgets'], function(lib) { |
| Expand All | | @@ -25,6 +25,21 @@ require(['libwidgets'], function(lib) { |
|  |  |  |
|  |  | var widgetApp = new lib.WidgetApplication(BASEURL, WSURL, lib.requireLoader, kernel\_id); |
|  |  |  |
|  |  | var path = window.location.pathname.substr(14); |
|  |  | var wsWatchdog = new WebSocket(WSURL + '/voila/watchdog/' + path); |
|  |  | wsWatchdog.onmessage = (evt) => { |
|  |  | var msg = JSON.parse(evt.data) |
|  |  | console.log('msg', msg) |
|  |  | if(msg.type == 'reload') { |
|  |  | var timeout = 0; |
|  |  | if(msg.delay == 'long') |
|  |  | timeout = 1000; |
|  |  | setTimeout(() => { |
|  |  | location.href = location.href; |
|  |  | }, timeout) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | window.addEventListener("beforeunload", function (e) { |
|  |  | widgetApp.cleanWidgets(); |
|  |  | }); |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `28faacc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvoila-dashboards%2Fvoila%2Fcommit%2F28faacc9b03b160fd8fa920ad045f4ec0667ab67) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

