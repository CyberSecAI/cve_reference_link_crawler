=== Content from github.com_79cba0d7_20250110_134303.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvufind-org%2Fvufind%2Fcommit%2F345d00f7d7f1c581f46742effdac70e803b3847b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvufind-org%2Fvufind%2Fcommit%2F345d00f7d7f1c581f46742effdac70e803b3847b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=vufind-org%2Fvufind)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vufind-org](/vufind-org)
/
**[vufind](/vufind-org/vufind)**
Public

* [Notifications](/login?return_to=%2Fvufind-org%2Fvufind) You must be signed in to change notification settings
* [Fork
  359](/login?return_to=%2Fvufind-org%2Fvufind)
* [Star
   274](/login?return_to=%2Fvufind-org%2Fvufind)

* [Code](/vufind-org/vufind)
* [Pull requests
  42](/vufind-org/vufind/pulls)
* [Discussions](/vufind-org/vufind/discussions)
* [Actions](/vufind-org/vufind/actions)
* [Projects
  3](/vufind-org/vufind/projects)
* [Security](/vufind-org/vufind/security)
* [Insights](/vufind-org/vufind/pulse)

Additional navigation options

* [Code](/vufind-org/vufind)
* [Pull requests](/vufind-org/vufind/pulls)
* [Discussions](/vufind-org/vufind/discussions)
* [Actions](/vufind-org/vufind/actions)
* [Projects](/vufind-org/vufind/projects)
* [Security](/vufind-org/vufind/security)
* [Insights](/vufind-org/vufind/pulse)

## Commit

[Permalink](/vufind-org/vufind/commit/345d00f7d7f1c581f46742effdac70e803b3847b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Restrict hostnames for cover proxy. ([#3385](https://github.com/vufind-org/vufind/pull/3385))

[Browse files](/vufind-org/vufind/tree/345d00f7d7f1c581f46742effdac70e803b3847b)
Browse the repository at this point in the history

* Loading branch information

[![@demiankatz](https://avatars.githubusercontent.com/u/309069?s=40&v=4)](/demiankatz)

[demiankatz](/vufind-org/vufind/commits?author=demiankatz "View all commits by demiankatz")
committed
Feb 6, 2024

1 parent
[f9ab536](/vufind-org/vufind/commit/f9ab536df921d3f66644efc9f86bb72c51f5cdf9)

commit 345d00f

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**44 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* config/vufind

  + config/vufind/config.ini
    [config.ini](#diff-6080d160d4553b3e0984e66aa8fd1bc0f740448f7a8e92804b21f9efb53b6232)
* module/VuFind/src/VuFind/Controller

  + module/VuFind/src/VuFind/Controller/CoverController.php
    [CoverController.php](#diff-99eba217e1e0421eeae25f3eb0363ee54c7c49a153da96ffcfa1b52a5b293571)
  + module/VuFind/src/VuFind/Controller/CoverControllerFactory.php
    [CoverControllerFactory.php](#diff-9eb19119ed46f217aa15af2a593c9bf6ce687f55bb19556bb18f61c83fd20f1f)

## There are no files selected for viewing

7 changes: 7 additions & 0 deletions

7
[config/vufind/config.ini](#diff-6080d160d4553b3e0984e66aa8fd1bc0f740448f7a8e92804b21f9efb53b6232 "config/vufind/config.ini")

Show comments

[View file](/vufind-org/vufind/blob/345d00f7d7f1c581f46742effdac70e803b3847b/config/vufind/config.ini)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1023,6 +1023,13 @@ coverimagesCache = true |
|  |  | ; BrowZine DOI icons: |
|  |  | coverproxyCache[] = "/assets\.thirdiron\.com/" |
|  |  |  |
|  |  | ; This setting controls which hosts are allowed to provide cover images through |
|  |  | ; the built-in cover proxy. Images from hostnames that do not match the regular |
|  |  | ; expressions below will not be proxied. Be sure to define regular expressions |
|  |  | ; using an end of string ($) marker to prevent abuse. |
|  |  | coverproxyAllowedHosts[] = "/assets\.thirdiron\.com$/" |
|  |  | coverproxyAllowedHosts[] = "/\.summon\.serialssolutions\.com$/" |
|  |  |  |
|  |  | ; This setting controls how cover image URLs are loaded. They could be loaded as |
|  |  | ; part of main request, or asynchronously. Asynchronous loading is disabled by |
|  |  | ; default; to enable it, just uncomment the line below. |
| Expand Down | |  |

35 changes: 33 additions & 2 deletions

35
[module/VuFind/src/VuFind/Controller/CoverController.php](#diff-99eba217e1e0421eeae25f3eb0363ee54c7c49a153da96ffcfa1b52a5b293571 "module/VuFind/src/VuFind/Controller/CoverController.php")

Show comments

[View file](/vufind-org/vufind/blob/345d00f7d7f1c581f46742effdac70e803b3847b/module/VuFind/src/VuFind/Controller/CoverController.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -65,21 +65,31 @@ class CoverController extends \Laminas\Mvc\Controller\AbstractActionController |
|  |  | \*/ |
|  |  | protected $sessionSettings = null; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Configuration settings ([Content] section of config.ini) |
|  |  | \* |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $config; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Constructor |
|  |  | \* |
|  |  | \* @param Loader $loader Cover loader |
|  |  | \* @param CachingProxy $proxy Proxy loader |
|  |  | \* @param SessionSettings $ss Session settings |
|  |  | \* @param array $config Configuration settings |
|  |  | \*/ |
|  |  | public function \_\_construct( |
|  |  | Loader $loader, |
|  |  | CachingProxy $proxy, |
|  |  | SessionSettings $ss |
|  |  | SessionSettings $ss, |
|  |  | array $config = [] |
|  |  | ) { |
|  |  | $this->loader = $loader; |
|  |  | $this->proxy = $proxy; |
|  |  | $this->sessionSettings = $ss; |
|  |  | $this->config = $config; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -115,6 +125,27 @@ protected function getImageParams() |
|  |  | ]; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Is the provided URL included on the configured allow list? |
|  |  | \* |
|  |  | \* @param string $url URL to check |
|  |  | \* |
|  |  | \* @return bool |
|  |  | \*/ |
|  |  | protected function proxyAllowedForUrl(string $url): bool |
|  |  | { |
|  |  | $host = parse\_url($url, PHP\_URL\_HOST); |
|  |  | if (!$host) { |
|  |  | return false; |
|  |  | } |
|  |  | foreach ((array)($this->config['coverproxyAllowedHosts'] ?? []) as $regEx) { |
|  |  | if (preg\_match($regEx, $host)) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Send image data for display in the view |
|  |  | \* |
| Expand All | | @@ -126,7 +157,7 @@ public function showAction() |
|  |  |  |
|  |  | // Special case: proxy a full URL: |
|  |  | $url = $this->params()->fromQuery('proxy'); |
|  |  | if (!empty($url)) { |
|  |  | if (!empty($url) && $this->proxyAllowedForUrl($url)) { |
|  |  | try { |
|  |  | $image = $this->proxy->fetch($url); |
|  |  | $contentType = $image?->getHeaders()?->get('content-type')?->getFieldValue() ?? ''; |
| Expand Down | |  |

5 changes: 4 additions & 1 deletion

5
[module/VuFind/src/VuFind/Controller/CoverControllerFactory.php](#diff-9eb19119ed46f217aa15af2a593c9bf6ce687f55bb19556bb18f61c83fd20f1f "module/VuFind/src/VuFind/Controller/CoverControllerFactory.php")

Show comments

[View file](/vufind-org/vufind/blob/345d00f7d7f1c581f46742effdac70e803b3847b/module/VuFind/src/VuFind/Controller/CoverControllerFactory.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -68,10 +68,13 @@ public function \_\_invoke( |
|  |  | if (!empty($options)) { |
|  |  | throw new \Exception('Unexpected options sent to factory.'); |
|  |  | } |
|  |  | $config = $container->get(\VuFind\Config\PluginManager::class)->get('config'); |
|  |  | $configArray = $config?->Content?->toArray() ?? []; |
|  |  | return new $requestedName( |
|  |  | $container->get(\VuFind\Cover\Loader::class), |
|  |  | $container->get(\VuFind\Cover\CachingProxy::class), |
|  |  | $container->get(\VuFind\Session\Settings::class) |
|  |  | $container->get(\VuFind\Session\Settings::class), |
|  |  | $configArray |
|  |  | ); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `345d00f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvufind-org%2Fvufind%2Fcommit%2F345d00f7d7f1c581f46742effdac70e803b3847b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c6c4dff2_20250110_134303.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvufind-org%2Fvufind%2Fcommit%2F51f2ddac0dc1047e6fd3b27e6d984b19e1601d00)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvufind-org%2Fvufind%2Fcommit%2F51f2ddac0dc1047e6fd3b27e6d984b19e1601d00)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=vufind-org%2Fvufind)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vufind-org](/vufind-org)
/
**[vufind](/vufind-org/vufind)**
Public

* [Notifications](/login?return_to=%2Fvufind-org%2Fvufind) You must be signed in to change notification settings
* [Fork
  359](/login?return_to=%2Fvufind-org%2Fvufind)
* [Star
   274](/login?return_to=%2Fvufind-org%2Fvufind)

* [Code](/vufind-org/vufind)
* [Pull requests
  42](/vufind-org/vufind/pulls)
* [Discussions](/vufind-org/vufind/discussions)
* [Actions](/vufind-org/vufind/actions)
* [Projects
  3](/vufind-org/vufind/projects)
* [Security](/vufind-org/vufind/security)
* [Insights](/vufind-org/vufind/pulse)

Additional navigation options

* [Code](/vufind-org/vufind)
* [Pull requests](/vufind-org/vufind/pulls)
* [Discussions](/vufind-org/vufind/discussions)
* [Actions](/vufind-org/vufind/actions)
* [Projects](/vufind-org/vufind/projects)
* [Security](/vufind-org/vufind/security)
* [Insights](/vufind-org/vufind/pulse)

## Commit

[Permalink](/vufind-org/vufind/commit/51f2ddac0dc1047e6fd3b27e6d984b19e1601d00)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Make cover proxy legal content types configurable. ([#3388](https://github.com/vufind-org/vufind/pull/3388))

[Browse files](/vufind-org/vufind/tree/51f2ddac0dc1047e6fd3b27e6d984b19e1601d00)
Browse the repository at this point in the history

* Loading branch information

[![@demiankatz](https://avatars.githubusercontent.com/u/309069?s=40&v=4)](/demiankatz)

[demiankatz](/vufind-org/vufind/commits?author=demiankatz "View all commits by demiankatz")
authored
Feb 6, 2024

1 parent
[345d00f](/vufind-org/vufind/commit/345d00f7d7f1c581f46742effdac70e803b3847b)

commit 51f2dda

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**24 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* config/vufind

  + config/vufind/config.ini
    [config.ini](#diff-6080d160d4553b3e0984e66aa8fd1bc0f740448f7a8e92804b21f9efb53b6232)
* module/VuFind/src/VuFind/Controller

  + module/VuFind/src/VuFind/Controller/CoverController.php
    [CoverController.php](#diff-99eba217e1e0421eeae25f3eb0363ee54c7c49a153da96ffcfa1b52a5b293571)

## There are no files selected for viewing

7 changes: 7 additions & 0 deletions

7
[config/vufind/config.ini](#diff-6080d160d4553b3e0984e66aa8fd1bc0f740448f7a8e92804b21f9efb53b6232 "config/vufind/config.ini")

Show comments

[View file](/vufind-org/vufind/blob/51f2ddac0dc1047e6fd3b27e6d984b19e1601d00/config/vufind/config.ini)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1030,6 +1030,13 @@ coverproxyCache[] = "/assets\.thirdiron\.com/" |
|  |  | coverproxyAllowedHosts[] = "/assets\.thirdiron\.com$/" |
|  |  | coverproxyAllowedHosts[] = "/\.summon\.serialssolutions\.com$/" |
|  |  |  |
|  |  | ; This setting controls the content types allowed through the cover proxy. |
|  |  | ; Note that proxying SVG files is not recommended because of their potential for |
|  |  | ; abuse in cross-site scripting attacks. |
|  |  | coverproxyAllowedTypes[] = "image/gif" |
|  |  | coverproxyAllowedTypes[] = "image/jpeg" |
|  |  | coverproxyAllowedTypes[] = "image/png" |
|  |  |  |
|  |  | ; This setting controls how cover image URLs are loaded. They could be loaded as |
|  |  | ; part of main request, or asynchronously. Asynchronous loading is disabled by |
|  |  | ; default; to enable it, just uncomment the line below. |
| Expand Down | |  |

18 changes: 17 additions & 1 deletion

18
[module/VuFind/src/VuFind/Controller/CoverController.php](#diff-99eba217e1e0421eeae25f3eb0363ee54c7c49a153da96ffcfa1b52a5b293571 "module/VuFind/src/VuFind/Controller/CoverController.php")

Show comments

[View file](/vufind-org/vufind/blob/51f2ddac0dc1047e6fd3b27e6d984b19e1601d00/module/VuFind/src/VuFind/Controller/CoverController.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,6 +33,8 @@ |
|  |  | use VuFind\Cover\Loader; |
|  |  | use VuFind\Session\Settings as SessionSettings; |
|  |  |  |
|  |  | use function in\_array; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Generates covers for book entries |
|  |  | \* |
| Expand Down  Expand Up | | @@ -146,6 +148,20 @@ protected function proxyAllowedForUrl(string $url): bool |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Is the content type allowed by the cover proxy? |
|  |  | \* |
|  |  | \* @param string $contentType Type to check |
|  |  | \* |
|  |  | \* @return bool |
|  |  | \*/ |
|  |  | protected function isValidProxyImageContentType(string $contentType): bool |
|  |  | { |
|  |  | $validTypes = $this->config['coverproxyAllowedTypes'] |
|  |  | ?? ['image/gif', 'image/jpeg', 'image/png']; |
|  |  | return in\_array(strtolower($contentType), array\_map('strtolower', $validTypes)); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Send image data for display in the view |
|  |  | \* |
| Expand All | | @@ -161,7 +177,7 @@ public function showAction() |
|  |  | try { |
|  |  | $image = $this->proxy->fetch($url); |
|  |  | $contentType = $image?->getHeaders()?->get('content-type')?->getFieldValue() ?? ''; |
|  |  | if (str\_starts\_with(strtolower($contentType), 'image/')) { |
|  |  | if ($this->isValidProxyImageContentType($contentType)) { |
|  |  | return $this->displayImage( |
|  |  | $contentType, |
|  |  | $image->getContent() |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `51f2dda`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvufind-org%2Fvufind%2Fcommit%2F51f2ddac0dc1047e6fd3b27e6d984b19e1601d00) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from vufind.org_ea073257_20250110_134304.html ===

[![](https://vufind.org/vufind/assets/images/vf-beta.png)](/vufind/)

[About](/vufind/about.html)
[Features](/vufind/features.html)
[Downloads](/vufind/downloads.html)
[Getting Started](/wiki/installation)
[Documentation](/wiki)
[Events](/vufind/schedule.html)
[Support](/vufind/support.html)
[GitHub](https://github.com/vufind-org/vufind)

Love VuFind®? Consider becoming a [financial supporter](https://vufind.org/donate). Your support helps build a better VuFind®!

* [skip to content](#dokuwiki__content)

# [VuFind Documentation](/wiki/start " [h]")

### Site Tools

Search
ToolsShow pagesourceOld revisionsBacklinksRecent ChangesMedia ManagerSitemapLog In>

* [Recent Changes](/wiki/security%3Acve-2024-25737?do=recent "Recent Changes [r]")
* [Media Manager](/wiki/security%3Acve-2024-25737?do=media&ns=security "Media Manager")
* [Sitemap](/wiki/security%3Acve-2024-25737?do=index "Sitemap [x]")

You are here: [start](/wiki/start "start") » [security](/wiki/security "security") » [cve-2024-25737](/wiki/security%3Acve-2024-25737 "security:cve-2024-25737")
Trace:

---

**Warning:** This page has not been updated in over over a year and may be outdated or deprecated.

security:cve-2024-25737

### Table of Contents

* [Security: CVE-2024-25737](#securitycve-2024-25737)
  + [Overview](#overview)
  + [Mitigation](#mitigation)
    - [Mitigation without Upgrade, Option 1](#mitigation_without_upgrade_option_1)
    - [Mitigation without Upgrade, Option 2](#mitigation_without_upgrade_option_2)
  + [Acknowledgements](#acknowledgements)

# Security: CVE-2024-25737

## Overview

A Server-Side Request Forgery (SSRF) vulnerability in the /Cover/Show route (showAction in CoverController.php) in VuFind® 2.0 through 9.1 before 9.1.1 allows remote attackers to access internal HTTP servers and perform Cross-Site Scripting (XSS) attacks by proxying arbitrary URLs via the proxy GET parameter.

## Mitigation

Users are strongly encouraged to upgrade to release 9.1.1 immediately and ensure appropriate coverproxyAllowedHosts and coverproxyAllowedTypes settings in config.ini.

If upgrade is not possible, alternate mitigation options exist:

### Mitigation without Upgrade, Option 1

If you are running a release issued in the past five years, the fix has been backported to the associated release branch in GitHub. You can download replacement CoverController.php and CoverControllerFactory.php files that can replace the existing files in your installation. For example, for release 6.0, you can download [https://github.com/vufind-org/vufind/blob/release-6.0/module/VuFind/src/VuFind/Controller/CoverControllerFactory.php](https://github.com/vufind-org/vufind/blob/release-6.0/module/VuFind/src/VuFind/Controller/CoverControllerFactory.php "https://github.com/vufind-org/vufind/blob/release-6.0/module/VuFind/src/VuFind/Controller/CoverControllerFactory.php") and [https://github.com/vufind-org/vufind/blob/release-6.0/module/VuFind/src/VuFind/Controller/CoverController.php](https://github.com/vufind-org/vufind/blob/release-6.0/module/VuFind/src/VuFind/Controller/CoverController.php "https://github.com/vufind-org/vufind/blob/release-6.0/module/VuFind/src/VuFind/Controller/CoverController.php"). For newer versions, just replace “6.0” in each URL with the appropriate major and minor version numbers for the desired release.

![:!:](/wiki/lib/images/smileys/exclaim.svg) IMPORTANT NOTE: this patched code is not compatible with PHP versions <8.0 (usage of null-safe-operator) and does require adjustments (or application of the second Mitigation Option below) if you are running an older version that is out of security support.

### Mitigation without Upgrade, Option 2

If you are running a VuFind® release more than five years old, you will have to make a manual correction to the code. The easiest solution is to simply delete the cover proxy feature from the CoverController. Unless you are using VuFind®’s Summon integration, you do not need this code at all. Here is an example of the lines to delete when using VuFind® 4.1: [https://github.com/vufind-org/vufind/blob/release-4.1/module/VuFind/src/VuFind/Controller/CoverController.php#L143-L155](https://github.com/vufind-org/vufind/blob/release-4.1/module/VuFind/src/VuFind/Controller/CoverController.php#L143-L155 "https://github.com/vufind-org/vufind/blob/release-4.1/module/VuFind/src/VuFind/Controller/CoverController.php#L143-L155") – it should not be too difficult to find the equivalent code in other versions.

## Acknowledgements

Thanks to [rob (@b7c on GitHub)](https://github.com/b7c "https://github.com/b7c") for identifying and responsibly reporting this vulnerability.

security/cve-2024-25737.txt · Last modified: 2024/06/06 11:36 by demiankatz

---

### Page Tools

* [Show pagesource](/wiki/security%3Acve-2024-25737?do=edit "Show pagesource [v]")
* [Old revisions](/wiki/security%3Acve-2024-25737?do=revisions "Old revisions [o]")
* [Backlinks](/wiki/security%3Acve-2024-25737?do=backlink "Backlinks")
* [Back to top](#dokuwiki__top "Back to top [t]")

![](/wiki/lib/exe/taskrunner.php?id=security%3Acve-2024-25737&1736516584)

Show pagesource Old revisions
Media Manager Admin Log In Sitemap [Back to top](#dokuwiki__top)

Except where otherwise noted, content on this wiki is licensed under the following license: [CC Attribution-Noncommercial-Share Alike 4.0 International](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)
[![CC Attribution-Noncommercial-Share Alike 4.0 International](/wiki/lib/images/license/button/cc-by-nc-sa.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)
[![Driven by DokuWiki](/wiki/lib/tpl/vufind_wiki/images/button-dw.png)](https://dokuwiki.org/ "Driven by DokuWiki")


