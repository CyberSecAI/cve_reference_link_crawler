- **Root cause of vulnerability**: A heap-based buffer overflow vulnerability exists in the uC-HTTP server's handling of the `Host` header field. The server copies the host header value into a heap buffer, and if the length of the host value is exactly equal to the configured maximum size, a null byte is written one byte beyond the allocated buffer. This overwrite corrupts heap metadata, leading to arbitrary memory allocation and potential code execution.
- **Weaknesses/vulnerabilities present**:
    - Heap-based buffer overflow: The vulnerability occurs due to insufficient bounds checking when copying the host header value, resulting in a one-byte overwrite.
    - Heap metadata corruption: The overflow corrupts the next free pointer stored within the heap block, which is exploited to achieve arbitrary memory allocation.
    - Arbitrary memory allocation: By corrupting heap metadata, an attacker can gain control over memory allocation, enabling them to allocate memory at a specific, attacker-controlled address.
- **Impact of exploitation**: An attacker can gain arbitrary code execution. By controlling memory allocation, attackers can potentially overwrite function pointers, stack data, or other critical parts of the program memory space.
- **Attack vectors**: The vulnerability can be triggered by sending a specially crafted HTTP request with a Host header value that is exactly the maximum length allowed.
- **Required attacker capabilities/position**: An attacker needs to be able to send network packets to a vulnerable service and craft an HTTP request with a specific Host header.