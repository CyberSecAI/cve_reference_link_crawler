

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Srinivasan Shanmugam <srinivasan.shanmugam@amd.com> | 2024-05-27 20:15:21 +0530 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-14 15:34:14 +0200 |
| commit | [16a8a2a839d19c4cf7253642b493ffb8eee1d857](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857)) | |
| tree | [7c21b050c3cd9cb4d2ecfd1713ad5571062d1e7d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857) | |
| parent | [69a441473fec2fc2aa2cf56122d6c42c4266a239](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=69a441473fec2fc2aa2cf56122d6c42c4266a239) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857&id2=69a441473fec2fc2aa2cf56122d6c42c4266a239)) | |
| download | [linux-16a8a2a839d19c4cf7253642b493ffb8eee1d857.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-16a8a2a839d19c4cf7253642b493ffb8eee1d857.tar.gz) | |

drm/amd/display: Add null checks for 'stream' and 'plane' before dereferencing[ Upstream commit 15c2990e0f0108b9c3752d7072a97d45d4283aea ]
This commit adds null checks for the 'stream' and 'plane' variables in
the dcn30\_apply\_idle\_power\_optimizations function. These variables were
previously assumed to be null at line 922, but they were used later in
the code without checking if they were null. This could potentially lead
to a null pointer dereference, which would cause a crash.
The null checks ensure that 'stream' and 'plane' are not null before
they are used, preventing potential crashes.
Fixes the below static smatch checker:
drivers/gpu/drm/amd/amdgpu/../display/dc/hwss/dcn30/dcn30\_hwseq.c:938 dcn30\_apply\_idle\_power\_optimizations() error: we previously assumed 'stream' could be null (see line 922)
drivers/gpu/drm/amd/amdgpu/../display/dc/hwss/dcn30/dcn30\_hwseq.c:940 dcn30\_apply\_idle\_power\_optimizations() error: we previously assumed 'plane' could be null (see line 922)
Cc: Tom Chung <chiahsuan.chung@amd.com>
Cc: Nicholas Kazlauskas <nicholas.kazlauskas@amd.com>
Cc: Bhawanpreet Lakha <Bhawanpreet.Lakha@amd.com>
Cc: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>
Cc: Roman Li <roman.li@amd.com>
Cc: Hersen Wu <hersenxs.wu@amd.com>
Cc: Alex Hung <alex.hung@amd.com>
Cc: Aurabindo Pillai <aurabindo.pillai@amd.com>
Cc: Harry Wentland <harry.wentland@amd.com>
Signed-off-by: Srinivasan Shanmugam <srinivasan.shanmugam@amd.com>
Reviewed-by: Aurabindo Pillai <aurabindo.pillai@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857)

| -rw-r--r-- | [drivers/gpu/drm/amd/display/dc/hwss/dcn30/dcn30\_hwseq.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/amd/display/dc/hwss/dcn30/dcn30_hwseq.c?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/gpu/drm/amd/display/dc/hwss/dcn30/dcn30\_hwseq.c b/drivers/gpu/drm/amd/display/dc/hwss/dcn30/dcn30\_hwseq.cindex ed9141a67db374..5b09d95cc5b8fc 100644--- a/[drivers/gpu/drm/amd/display/dc/hwss/dcn30/dcn30\_hwseq.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/display/dc/hwss/dcn30/dcn30_hwseq.c?id=69a441473fec2fc2aa2cf56122d6c42c4266a239)+++ b/[drivers/gpu/drm/amd/display/dc/hwss/dcn30/dcn30\_hwseq.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/display/dc/hwss/dcn30/dcn30_hwseq.c?id=16a8a2a839d19c4cf7253642b493ffb8eee1d857)@@ -919,6 +919,9 @@ bool dcn30\_apply\_idle\_power\_optimizations(struct dc \*dc, bool enable) stream = dc->current\_state->streams[0]; plane = (stream ? dc->current\_state->stream\_status[0].plane\_states[0] : NULL); + if (!stream || !plane)+ return false;+ if (stream && plane) { cursor\_cache\_enable = stream->cursor\_position.enable && plane->address.grph.cursor\_cache\_addr.quad\_part; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:03:48 +0000

