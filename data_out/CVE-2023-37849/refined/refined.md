The provided content relates to CVE-2023-37849.

**Root cause of vulnerability:**
The vulnerability stems from the Panda Dome VPN installer loading DLL files from the same directory as the installer executable. If a malicious DLL is placed there, it will be loaded with administrator privileges. Specifically, the `TextShaping.dll` is loaded from the same directory as `PANDAVPN.exe` with admin privileges. If the DLL is not present in the installer directory, it will be loaded from `C:\Windows\SysWOW64`.

**Weaknesses/vulnerabilities present:**
- DLL hijacking vulnerability. The application loads a DLL from an insecure location, allowing an attacker to substitute a legitimate DLL with a malicious one.
- The installer executes with administrator privileges, which elevates the privileges of the hijacked DLL.

**Impact of exploitation:**
Successful exploitation allows a local attacker to gain SYSTEM privileges. The provided proof-of-concept (PoC) code demonstrates how a malicious DLL can be used to create a new process with SYSTEM privileges using the winlogon.exe token.

**Attack vectors:**
- Local attacker can place a malicious `TextShaping.dll` in the same directory as the `PANDAVPN.exe` installer.
- When the installer is run, the malicious DLL will be loaded with administrator privileges.

**Required attacker capabilities/position:**
- The attacker must have local access to the system.
- The attacker must be able to write files to the same directory where the Panda Security VPN installer file is located.
- The attacker needs to be able to run the installer.