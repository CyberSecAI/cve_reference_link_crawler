
<!DOCTYPE html>
<html lang="en">
  <head><script src="//archive.org/includes/athena.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app212.us.archive.org';v.server_ms=640;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/_static/js/bundle-playback.js?v=HxkREWBo" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=txqj7nKC" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="/_static/js/ruffle/ruffle.js"></script>
<script type="text/javascript">
    __wm.init("https://web.archive.org/web");
  __wm.wombat("https://klikki.fi/adv/mainwp.html","20191101060009","https://web.archive.org/","web","/_static/",
	      "1572588009");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=S1zqJCYt" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=3PDvdIFv" />
<!-- End Wayback Rewrite JS Include -->

    <meta charset="utf-8">
    <title>Klikki Oy - MainWP admin panel unauthenticated stored XSS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="Klikki Oy">
    <meta name="google-site-verification" content="QjBaN3uJ_eY0uY6LHeX4rYHTFQu30MPJloCkBazAGa4"/>
    <meta property="og:title" content="MainWP admin panel unauthenticated stored XSS"/>
    <meta property="fb:admins" content="716820741"/>
    
    <link href="/web/20191101060009cs_/https://klikki.fi/css2/cyborg.css" rel="stylesheet">
    <link href="/web/20191101060009cs_/https://klikki.fi/css/css.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 62px;
        padding-bottom: 40px;
      }
      pre, code {
	background-color: #ccc !important;
      }
    </style>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->

    <link rel="icon" href="/web/20191101060009im_/https://klikki.fi/img/favicon.png" sizes="16x16"/>

    
<link rel="alternate" hreflang="en" href="/web/20191101060009/https://klikki.fi/adv/mainwp.html"/>
<link rel="alternate" hreflang="fi" href="/web/20191101060009/https://klikki.fi/adv/mainwp-fi.html"/>

    <link rel="canonical" href="https://web.archive.org/web/20191101060009/https://klikki.fi/adv/mainwp.html"/><meta property="og:url" content="https://web.archive.org/web/20191101060009/http://klikki.fi/adv/mainwp.html"/>
    
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//web.archive.org/web/20191101060009/https://connect.facebook.net/en_US/sdk.js#xfbml=1&appId=134841561880&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

  </head>

  <body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20191101060009/https%3A//klikki.fi/adv/mainwp.html"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="https://klikki.fi/adv/mainwp.html" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20191101060009" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
                <div class="s" id="wm-nav-captures" style="flex:1;">
                    <a class="t" href="/web/20191101060009*/https://klikki.fi/adv/mainwp.html" title="See a list of every capture for this URL">3 captures</a>
          <div class="r" title="Timespan for captures of this URL">01 Nov 2019 - 14 Mar 2024</div>
          </div>
        <div class="k">
          <a href="" id="wm-graph-anchor">
            <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
              <canvas id="wm-sparkline-canvas" width="750" height="27" border="0"></canvas>
            </div>
          </a>
        </div>
      </div>
    </div>
    <div class="n">
      <table>
        <tbody>
          <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
          <tr class="m">
            <td class="b" nowrap="nowrap">Oct</td>
            <td class="c" id="displayMonthEl" title="You are here: 06:00:09 Nov 01, 2019">NOV</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20210507211926/https://klikki.fi/adv/mainwp.html" title="07 May 2021"><strong>May</strong></a></td>
          </tr>
          <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
          <tr class="d">
            <td class="b" nowrap="nowrap"><img src="/_static/images/toolbar/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0" /></td>
            <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 06:00:09 Nov 01, 2019">01</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20210507211926/https://klikki.fi/adv/mainwp.html" title="21:19:26 May 07, 2021"><img src="/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
          </tr>
          <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
          <tr class="y">
            <td class="b" nowrap="nowrap">2018</td>
            <td class="c" id="displayYearEl" title="You are here: 06:00:09 Nov 01, 2019">2019</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20210507211926/https://klikki.fi/adv/mainwp.html" title="07 May 2021"><strong>2021</strong></a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
                <span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#" title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        </span>
                <a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
        <a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20191101060009/http://web.archive.org/screenshot/https://klikki.fi/adv/mainwp.html"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
        <a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20191101060009/https://klikki.fi/adv/mainwp.html" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
        <a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20191101060009/https://klikki.fi/adv/mainwp.html" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
        <a id="wm-expand" class="wm-btn wm-closed" href="#expand"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
        <div id="wm-capinfo-notice" source="api"></div>
                <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/webwidecrawl);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/webwidecrawl" target="_new"><span class="wm-title">Internet Archive</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  The Internet Archive discovers and captures web pages through many different web crawls.

At any given time several distinct crawls are running, some for months, and some every day or longer.

View the web archive through the <a href="http://archive.org/web/web.php">Wayback Machine</a>.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/liveweb)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/liveweb" target="_new"><span class="wm-title">Live Web Proxy Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Content crawled via the <a href="http://archive.org/web/web.php">Wayback Machine</a> Live Proxy mostly by the Save Page Now feature on web.archive.org.
<br><br>
Liveweb proxy is a component of Internet Archiveâs wayback machine project. The liveweb proxy captures the content of a web page in real time, archives it into a ARC or WARC file and returns the ARC/WARC record back to the wayback machine to process. The recorded ARC/WARC file becomes part of the wayback machine in due course of time.
<br>
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20191101060009/https://klikki.fi/adv/mainwp.html</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(750,27,25,2,"web","https://klikki.fi/adv/mainwp.html","20191101060009",1996,"/_static/",["/_static/css/banner-styles.css?v=S1zqJCYt","/_static/css/iconochive.css?v=3PDvdIFv"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 

<div id="fb-root"></div>

    <nav class="navbar navbar-inverse navbar-fixed-top">
    <a class="navbar-brand" href="/web/20191101060009/https://klikki.fi/">Klikki</a>
    <ul class="nav navbar-nav">
	<li class="dropdown">

	<a class="collapsed dropdown-toggle" id="dd1" data-toggle="dropdown" aria-expanded="true">
	contact
	<span class="caret"></span>
	</a>
	<ul class="dropdown-menu" role="menu" aria-labelledby="dd1">
	<li role="presentation"><a role="menuitem" data-toggle="modal" data-target="#modal-email">email</a></li>
	<li role="presentation"><a role="menuitem" data-toggle="modal" data-target="#modal-social">social media</a></li>
	</ul>

	</li>
	<li class="dropdown">
	<a class="collapsed dropdown-toggle" id="dd2" data-toggle="dropdown" aria-expanded="true">
	language
	<span class="caret"></span>
	</a>
	<ul class="dropdown-menu" role="menu" aria-labelledby="dd2">
	<li role="presentation"><a role="menuitem" class="disabled">&check; English</a></li>
	<li role="presentation"><a href="/web/20191101060009/https://klikki.fi/adv/mainwp-fi.html">Suomi</a></li>
        </ul>

	</li>
    </ul>

    </nav>




<div class="modal fade" id="modal-email" role="dialog">
<div class="modal-dialog">
<div class="modal-content">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h4 class="modal-title">Klikki Oy | Contact us</h4>
  </div>
  <div class="modal-body">
    <b>CEO, JyvÃ¤skylÃ¤:</b> <i class="icon-user"></i> Jouko PynnÃ¶nen<br>
        -email: <a href="https://web.archive.org/web/20191101060009/mailto:jouko@iki.fi">jouko@iki.fi</a><br>
        -PGP: <a target="_blank" href="/web/20191101060009/https://klikki.fi/pgp.asc">key</a><br><br>
    <b>Helsinki: </b>Mikko PynnÃ¶nen <br><br>
    <b>Advertising:</b> <a href="https://web.archive.org/web/20191101060009/mailto:ads@klikki.fi">ads@klikki.fi</a><br>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn btn-primary" data-dismiss="modal">Ok</a>
  </div>
</div></div></div>



<div class="modal fade" id="modal-social">
<div class="modal-dialog">
<div class="modal-content">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">Klikki Oy | Social media</h4>
  </div>
  <div class="modal-body">
<h3>Google+</h3>
<a href="//web.archive.org/web/20191101060009/https://plus.google.com/u/0/100087371180887679395?prsrc=3" rel="publisher" target="_top" style="text-decoration:none;">
<img src="//web.archive.org/web/20191101060009im_/https://ssl.gstatic.com/images/icons/gplus-16.png" alt="Google+" style="border:0;width:16px;height:16px;"/>
</a>
<hr>
<h3>Facebook</h3>
<div class="fb-like-box" data-href="https://www.facebook.com/KlikkiOy" data-colorscheme="dark" data-show-faces="false" data-header="false" data-stream="false" data-show-border="false"></div>
<hr>
<h3>Twitter</h3>
<a target="_blank" href="https://web.archive.org/web/20191101060009/https://twitter.com/klikkioy" class="twitter-follow-button" data-show-count="false" data-lang="en" data-size="large">Follow @klikkioy</a>
<br>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<hr>
<h3>HackerOne</h3>
<a target="_blank" href="https://web.archive.org/web/20191101060009/https://hackerone.com/jouko">jouko</a>

  </div>
  <div class="modal-footer">
    <a href="#" class="btn btn-primary" data-dismiss="modal">Ok</a>
  </div>
</div></div></div>




<!-- klikki-responsive -->
<div style="margin-top: 0.5em; margin-bottom: 0.5em;">
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7177932004870090" data-ad-slot="9747061391" data-ad-format="auto"></ins>
</div>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<div class="container" style="margin-top: 1em">


<div style="position:absolute; top: 50px; left:20px;">
<a href="/web/20191101060009/https://klikki.fi/index.html">Home</a> | <a href="index.html">Advisories</a>
</div>
</div>
<div class="container">



<h2>MainWP &lt; 3.1.3 admin panel unauthenticated stored XSS</h2>
April 29, 2016<br><br>

<p>
<a href="https://web.archive.org/web/20191101060009/https://mainwp.com/" target="_blank">MainWP</a> is a WordPress remote administration plugin. Missing authorization checks on a
setup panel allowed unauthenticated attackers to modify some of the MainWP settings.
At least one of these settings could be used to inject arbitrary JavaScript in the WordPress
Dashboard. Under default configuration this leads to server-side code execution.


<h3>Details</h3>
<p>
After installing MainWP the plugin presents a quick setup panel which asks the administrator
to select and enter some configuration options. When requested in a certain way, the quick setup
page doesn't require login and anyone can alter the settings.

<p>Proof of concept: first, a <i>nonce</i> can be retrieved with the following UNIX command:
<pre>
curl 'http://WEBSITE/wp-admin/admin-post.php?page=mainwp-setup&step;=installation' | grep _wpnonce
</pre>
<p>
The settings can then be modified. The following command exploits a secondary stored XSS to inject some
JavaScript:
<pre>
curl -F 'mwp_setup_purchase_username=aaa" onmouseover=alert(/xss/);//' -F mwp_setup_purchase_passwd=bbb -F save_step=1 'http://WEBSITE/wp-admin/admin-post.php?page=mainwp-setup&step;=purchase_extension&amp;_wpnonce=NONCE_FROM_PREVIOUS_COMMAND'
</pre>
<p>
The script is stored in the WordPress options database. When any administrator next views
the MainWP Extensions setting panel, the script will be executed, showing an alert box.
<p>
As with other WordPress XSS's, the impact of this bug is normally server-side code execution because
the script can e.g. use AJAX requests to access the theme and plugin editors.

<h3>Vendor response</h3>
<p>
MainWP was notified on April 18. The latest MainWP update addresses this vulnerability. A bug bounty of $50 was awarded.

<h3>Credits</h3>
<p>
The vulnerability was discovered and researched by Jouko Pynn&ouml;nen of <a href="https://web.archive.org/web/20191101060009/https://klikki.fi/">Klikki</a> Oy, Finland.

<p>

</div>


<link rel="stylesheet" href="//web.archive.org/web/20191101060009cs_/https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
<!-- script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script -->
<script src="//web.archive.org/web/20191101060009js_/https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<div class="container">


</div><!-- /container -->

      <hr/>

      <footer>
	<div style="float:left;margin-left:4em;position:relative;">
	<g:plusone href="https://klikki.fi/" data-href="https://klikki.fi"></g:plusone>
	<div style="position:absolute;top:0px;left:100px;" class="fb-like" data-href="https://klikki.fi/adv/mainwp.html" data-layout="standard" data-colorscheme="dark" data-action="like" data-show-faces="false" data-share="true"></div>
	</div>
	<center><a href="https://web.archive.org/web/20191101060009/https://klikki.fi/index.html">&copy;Klikki</a></center>
      </footer>

<script type="text/javascript" src="//web.archive.org/web/20191101060009js_/https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="/web/20191101060009js_/https://klikki.fi/js2/bootstrap.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//web.archive.org/web/20191101060009/https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1532850-8', 'auto');
  ga('send', 'pageview');

</script>
<script>
var input$=document.createElement('script');
input$.src='//web.archive.org/web/20191101060009/https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js';
input$.setAttribute('defer','1');
input$.setAttribute('async','1');
setTimeout(function(){
	var head=document.head;
	if (!head) {
		head=document.getElementsByTagName('head')[0];
		document.body.style.visibility='';	// wanha IE
	}
	head.appendChild(input$);
},3000);
</script>

<script src="https://web.archive.org/web/20191101060009js_/https://apis.google.com/js/platform.js" async defer></script>
</body></html>



<!--
     FILE ARCHIVED ON 06:00:09 Nov 01, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 14:04:04 Jan 11, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.791
  exclusion.robots: 0.035
  exclusion.robots.policy: 0.02
  esindex: 0.015
  cdx.remote: 58.984
  LoadShardBlock: 432.885 (3)
  PetaboxLoader3.datanode: 216.539 (4)
  PetaboxLoader3.resolve: 253.274 (3)
  load_resource: 116.383
-->