Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT357760)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T357760
# CVE-2024-34506: Denial of service vector via GET request to Special:MovePage on pages with thousands of subpagesClosed, Resolved[Public](/policy/explain/PHID-TASK-bszxszs7gdyewp43lly3/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/357760/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/357760/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-bszxszs7gdyewp43lly3/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-bszxszs7gdyewp43lly3/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-bszxszs7gdyewp43lly3/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-bszxszs7gdyewp43lly3/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-bszxszs7gdyewp43lly3/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-bszxszs7gdyewp43lly3/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-bszxszs7gdyewp43lly3/)
* [Protect as security issue](/wmf/escalate-task/357760/)
* [Award Token](/token/give/PHID-TASK-bszxszs7gdyewp43lly3/)
* [Flag For Later](/flag/edit/PHID-TASK-bszxszs7gdyewp43lly3/)

Assigned To

|  | [Dreamy\_Jazz](/p/Dreamy_Jazz/) |
| --- | --- |

Authored By

|  | [Dreamy\_Jazz](/p/Dreamy_Jazz/) |
| --- | --- |
| Feb 16 2024, 10:22 AM2024-02-16 10:22:34 (UTC+0) |

Tags

* [Security-Team](/tag/security-team/) [(Our Part Is Done)](/project/board/1179/)
* [Security](/tag/security/)
* [Vuln-DoS](/tag/vuln-dos/) [(Tracked)](/project/board/1446/)
* [MediaWiki-Page-rename](/tag/mediawiki-page-rename/) [(Backlog)](/project/board/4727/)
* [Patch-For-Review](/tag/patch-for-review/)
* [SecTeam-Processed](/tag/secteam-processed/) [(Completed)](/project/board/5180/)
* [MW-1.39-notes](/tag/mw-1.39-notes/)
* [MW-1.40-notes](/tag/mw-1.40-notes/)
* [MW-1.41-notes](/tag/mw-1.41-notes/) [(Backlog)](/project/board/6384/)
* [MW-1.42-notes (1.42.0-wmf.26; 2024-04-09)](/project/view/7084/)
Referenced Files

|  | [F43444543: T357760-v2-REL1\_39.patch](/F43444543) |
| --- | --- |
| Mar 26 2024, 3:24 PM2024-03-26 15:24:20 (UTC+0) |

|  | [F43444539: T357760-v2-REL1\_40.patch](/F43444539) |
| --- | --- |
| Mar 26 2024, 3:24 PM2024-03-26 15:24:20 (UTC+0) |

|  | [F43444161: T357760-v2.patch](/F43444161) |
| --- | --- |
| Mar 26 2024, 3:15 PM2024-03-26 15:15:19 (UTC+0) |

|  | [F41970839: T357760.patch](/F41970839) |
| --- | --- |
| Feb 18 2024, 11:28 PM2024-02-18 23:28:46 (UTC+0) |

|  | Unknown Object (File) |
| --- | --- |
| Feb 18 2024, 11:27 PM2024-02-18 23:27:35 (UTC+0) |

|  | Unknown Object (File) |
| --- | --- |
| Feb 18 2024, 10:56 PM2024-02-18 22:56:16 (UTC+0) |

|  | [F41930037: image.png](/F41930037) |
| --- | --- |
| Feb 16 2024, 3:00 PM2024-02-16 15:00:20 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [DannyS712](/p/DannyS712/) |
| --- | --- |

|  | [Dreamy\_Jazz](/p/Dreamy_Jazz/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [mmartorana](/p/mmartorana/) |
| --- | --- |

|  | [Mstyles](/p/Mstyles/) |
| --- | --- |

|  | [Reedy](/p/Reedy/) |
| --- | --- |

|  | [sbassett](/p/sbassett/) |
| --- | --- |

# Description

If a user with the necessary rights to move the page opens Special:MovePage for a page with tens of thousands of subpages, then the page will exceed the maximum request time.

###### Steps to re-produce

1. Log into an account with the move right
2. Find a page with around tens of thousands of subpages which is unprotected or you have the rights to move
3. Open Special:MovePage for this page

**What happened:** The request times out

**What should have happened:** The page should refuse to display the subpages above a certain threshold to avoid having the request timeout and/or prevent moving the page.

###### Extra details

The example that I found which prompted me to file this ticket is opening up the move page for [https://en.wikipedia.org/wiki/Wikipedia:Sockpuppet\_investigations](https://en.wikipedia.org/wiki/Wikipedia%3ASockpuppet_investigations). I had accidentally opened the page at first and wondered why the request took so long (the first request did not timeout but took ages to run). I opened the move page while on mwdebug2001 and then while I was not on a debug server to get the relevant logstash logs. Both of these requests timed out:

* mwdebug2001: [a4c69e43-ae45-4541-adbd-be840b13f718](https://logstash.wikimedia.org/goto/9ac1d9288f1a7fc6051932db08c19b84)
* Not on a debug server: [9b8e7e41-7954-472b-b41f-3d886e7c1e29](https://logstash.wikimedia.org/goto/5d9be2ee956b2f93778fe4c69329d9ea)

Based on the logs from the mwdebug2001 request it looks like the cause of the timeout is LinkCache as all logstash logs are to do with this class from 09:46:33.961 to 09:47:31.645 (when the timeout occurs). The logs that appear in the debug request say that 960 DB lookups occur because the LinkCache does not have the page cached. The last log before the timeout is [this one](https://logstash.wikimedia.org/app/discover#/doc/logstash-*/logstash-mediawiki-1-7.0.0-1-2024.02.16?id=sXtPsY0BXQUFBRtCjSPE) which suggests that the LinkCache was nowhere near the end of the list of pages to process.

While the example I found has move protection such that only administrators can load the page, it does not make it unlikely that there are other pages with enough subpages to cause a timeout but do not have move protection. Furthermore, as this is done through a GET request to open a form there is no on-wiki logs that would flag that someone abusing this (instead monitoring logstash would find this).

# Details

Risk Rating Low Author Affiliation WMF Technology Dept

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [Use i18n strings for truncated subpage message in SpecialMovePage](https://gerrit.wikimedia.org/r/c/1016026) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_39](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_39) | +15 -12 |
|  | [Use i18n strings for truncated subpage message in SpecialMovePage](https://gerrit.wikimedia.org/r/c/1016011) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/master) | +94 -12 |
|  | [Use i18n strings for truncated subpage message in SpecialMovePage](https://gerrit.wikimedia.org/r/c/1015685) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_40](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_40) | +94 -12 |
|  | [Use i18n strings for truncated subpage message in SpecialMovePage](https://gerrit.wikimedia.org/r/c/1015684) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_41](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_41) | +94 -12 |
|  | [SECURITY: Limit subpages displayed on Special:MovePage form](https://gerrit.wikimedia.org/r/c/1015423) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/master) | +27 -3 |
|  | [SECURITY: Limit subpages displayed on Special:MovePage form](https://gerrit.wikimedia.org/r/c/1015415) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_40](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_40) | +27 -3 |
|  | [SECURITY: Limit subpages displayed on Special:MovePage form](https://gerrit.wikimedia.org/r/c/1015419) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_41](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_41) | +27 -3 |
|  | [SECURITY: Limit subpages displayed on Special:MovePage form](https://gerrit.wikimedia.org/r/c/1015410) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_39](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_39) | +27 -3 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T357760)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | [Reedy](/p/Reedy/) | T353894 [Release MediaWiki 1.39.7/1.40.3/1.41.1](/T353894) |
|  |  | Resolved |  | [Reedy](/p/Reedy/) | T353895 [Tracking bug for MediaWiki 1.39.7/1.40.3/1.41.1](/T353895) |
|  |  | Resolved | Security | [Dreamy\_Jazz](/p/Dreamy_Jazz/) | T357760 [CVE-2024-34506: Denial of service vector via GET request to Special:MovePage on pages with thousands of subpages](/T357760) |

Mentioned Here [rMWa99ec1b4fa59: Title: Use TitleArrayFromResult instead of TitleArray](/rMWa99ec1b4fa598f37f939328e6c1d6367391e3545)
[T359114: Slow and failed deployments](/T359114)
### Event Timeline

[Dreamy\_Jazz](/p/Dreamy_Jazz/) created this task.[Feb 16 2024, 10:22 AM2024-02-16 10:22:34 (UTC+0)](#9549837)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/5785475/)[Feb 16 2024, 10:22 AM2024-02-16 10:22:36 (UTC+0)](#9549848)[Dreamy\_Jazz](/p/Dreamy_Jazz/) renamed this task from Denial of service vector via Special:Move to Denial of service vector via Special:Move on pages with thousands of subpages.[Feb 16 2024, 10:22 AM2024-02-16 10:22:52 (UTC+0)](#9549849)[Dreamy\_Jazz](/p/Dreamy_Jazz/) renamed this task from Denial of service vector via Special:Move on pages with thousands of subpages to Denial of service vector via GET request to Special:Move on pages with thousands of subpages.[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-yaowbgjkemxf5ij/)[Dreamy\_Jazz](/p/Dreamy_Jazz/) added projects: [Vuln-DoS](/tag/vuln-dos/), [MediaWiki-Special-pages](/tag/mediawiki-special-pages/).[Feb 16 2024, 10:25 AM2024-02-16 10:25:07 (UTC+0)](#9549855)[Dreamy\_Jazz](/p/Dreamy_Jazz/) edited projects, added [MediaWiki-Page-rename](/tag/mediawiki-page-rename/); removed [MediaWiki-Special-pages](/tag/mediawiki-special-pages/).[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-cqycrpple6fnzad/)[Feb 16 2024, 10:29 AM2024-02-16 10:29:05 (UTC+0)](#9549861)[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-urmdgop6lb4sit7/)

[DannyS712](/p/DannyS712/) subscribed.[Feb 16 2024, 2:54 PM2024-02-16 14:54:33 (UTC+0)](#9550746)Comment Actions

Doesn't this require the rights to move subpages though, i.e. generally only exploitable by advanced users?

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.Edited · [Feb 16 2024, 3:00 PM2024-02-16 15:00:20 (UTC+0)](#9550784)Comment Actions
> In [T357760#9550746](/T357760#9550746), [@DannyS712](/p/DannyS712/) wrote:
>
> Doesn't this require the rights to move subpages though, i.e. generally only exploitable by advanced users?

No, because that right is only checked when the user submits the form. For example, if I grant the move right to all users (using \*) I can still load the form while logged out for a page which has subpages:

[![image.png (786×1 px, 47 KB)](https://phab.wmfusercontent.org/file/data/p4ls6cvjrqxs6l2msib3/PHID-FILE-srngl3lcrijb3nm7j6vw/preview-image.png)](https://phab.wmfusercontent.org/file/data/q4nefsxh2lexknb4tfmn/PHID-FILE-4h7hq3ufiukw6bhabmxk/image.png)

The DoS vector isn't moving the pages and instead is the thousands of queries used to create the list of subpages shown underneath the Subpages section.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-hgll655ynjsrgxe/)[Feb 16 2024, 3:00 PM2024-02-16 15:00:50 (UTC+0)](#9550785)[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-6252hy3efvupavv/)[Feb 16 2024, 3:05 PM2024-02-16 15:05:29 (UTC+0)](#9550799)[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Feb 16 2024, 3:20 PM2024-02-16 15:20:48 (UTC+0)](#9550833)Comment Actions

A quick fix for this is to provide a $limit to Title::getSubpages in SpecialMovePage::showSubpages as the code currently provides no limit. Limiting this to the maximum number of subpages that can be moved should be fine, as if there are any more subpages this would mean that the form would not allow moving subpages anyway.

If a user wants to find the full list they could use Special:PrefixIndex which allows paging.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) renamed this task from Denial of service vector via GET request to Special:Move on pages with thousands of subpages to Denial of service vector via GET request to Special:MovePage on pages with thousands of subpages.[Feb 18 2024, 8:48 PM2024-02-18 20:48:54 (UTC+0)](#9553842)[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-eth5sg2qxo7dy5r/)[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-3twqjh5voiwcikh/)[Feb 18 2024, 10:31 PM2024-02-18 22:31:06 (UTC+0)](#9553872)[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-yuacw56ccla73mz/)[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Feb 18 2024, 10:56 PM2024-02-18 22:56:16 (UTC+0)](#9553888)This comment was removed by [Dreamy\_Jazz](/p/Dreamy_Jazz/).[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.Edited · [Feb 18 2024, 11:27 PM2024-02-18 23:27:35 (UTC+0)](#9553901)Comment Actions

Proposed patch:

T357760.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/k6qyipxahxdb6y5rexzg/PHID-FILE-exdnpb5koqufi7jy6imm/T357760.patch)

*Note*: Due to <https://wikitech.wikimedia.org/wiki/How_to_deploy_code#Guidelines_for_creating_patches>, this patch has a hardcoded message which is used when the list of subpages is truncated.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) attached a referenced file: [F41970839: T357760.patch](/F41970839). [(Show Details)](/transactions/detail/PHID-XACT-TASK-quhzkq5r7fqwcum/)[Feb 18 2024, 11:28 PM2024-02-18 23:28:57 (UTC+0)](#9553903)[mmartorana](/p/mmartorana/) changed the task status from Open to In Progress.[Feb 26 2024, 1:14 PM2024-02-26 13:14:44 (UTC+0)](#9576188)[mmartorana](/p/mmartorana/) triaged this task as Low priority.[mmartorana](/p/mmartorana/) changed Risk Rating from N/A to Low.[mmartorana](/p/mmartorana/) moved this task from [Incoming](/project/board/1179/) to [Security Patch To Deploy](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Feb 28 2024, 5:51 PM2024-02-28 17:51:18 (UTC+0)](#9584799)[mmartorana](/p/mmartorana/) subscribed.Comment Actions

From a security perspective, there doesn't seem to be any concern with this patch.

[sbassett](/p/sbassett/) subscribed.[Feb 28 2024, 6:15 PM2024-02-28 18:15:43 (UTC+0)](#9584913)Comment Actions
> In [T357760#9584799](/T357760#9584799), [@mmartorana](/p/mmartorana/) wrote:
>
> From a security perspective, there doesn't seem to be any concern with this patch.

Ok, I suppose we could try to get this deployed by [next Monday's security deployment window](https://wikitech.wikimedia.org/wiki/Deployments#deploycal-item-20240304T2200) (2024-03-04) at the latest.

[Mstyles](/p/Mstyles/) subscribed.[Mar 4 2024, 10:47 PM2024-03-04 22:47:53 (UTC+0)](#9598683)Comment Actions
> In [T357760#9553901](/T357760#9553901), [@Dreamy\_Jazz](/p/Dreamy_Jazz/) wrote:
>
> Proposed patch:
>
> T357760.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/k6qyipxahxdb6y5rexzg/PHID-FILE-exdnpb5koqufi7jy6imm/T357760.patch)
>
> *Note*: Due to <https://wikitech.wikimedia.org/wiki/How_to_deploy_code#Guidelines_for_creating_patches>, this patch has a hardcoded message which is used when the list of subpages is truncated.

[Deployed](https://sal.toolforge.org/log/CmmmC44BhuQtenzvjddS)

[Mstyles](/p/Mstyles/) moved this task from [Security Patch To Deploy](/project/board/1179/) to [Watching](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Mar 4 2024, 10:48 PM2024-03-04 22:48:10 (UTC+0)](#9598684)[Mstyles](/p/Mstyles/) added a parent task: [T353895: Tracking bug for MediaWiki 1.39.7/1.40.3/1.41.1](/T353895).[Mar 4 2024, 10:51 PM2024-03-04 22:51:39 (UTC+0)](#9598708)[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Mar 4 2024, 11:08 PM2024-03-04 23:08:09 (UTC+0)](#9598730)Comment Actions
> In [T357760#9598683](/T357760#9598683), [@Mstyles](/p/Mstyles/) wrote:
>
> [Deployed](https://sal.toolforge.org/log/CmmmC44BhuQtenzvjddS)

Thanks. I've been able to verify that this patch works as expected and prevents the request timeout.

There is one bug I didn't find when testing. The hard-coded message is switched around (so the message for the talk pages is above the non-talk pages and vice. versa.). That isn't a major problem IMO and could be fixed once this is uploaded to gerrit.

[Mstyles](/p/Mstyles/) added a comment.[Mar 5 2024, 6:50 AM2024-03-05 06:50:07 (UTC+0)](#9599310)Comment Actions

[@Dreamy\_Jazz](/p/Dreamy_Jazz/) I'm glad that the patch works. I think adding the hard-coded message once this uploaded is fine. There was an issue with deployment which I wanted to note here: <https://phabricator.wikimedia.org/T276237#9598800>

[sbassett](/p/sbassett/) added a comment.[Mar 5 2024, 3:44 PM2024-03-05 15:44:24 (UTC+0)](#9601559)Comment Actions
> In [T357760#9599310](/T357760#9599310), [@Mstyles](/p/Mstyles/) wrote:
>
> [@Dreamy\_Jazz](/p/Dreamy_Jazz/) I'm glad that the patch works. I think adding the hard-coded message once this uploaded is fine. There was an issue with deployment which I wanted to note here: <https://phabricator.wikimedia.org/T276237#9598800>

This week's train will probably just "fix" this issue, but we should keep an eye on [T359114](/T359114) to see when it gets resolved.

[Reedy](/p/Reedy/) subscribed.[Mar 26 2024, 2:52 PM2024-03-26 14:52:02 (UTC+0)](#9661851)Comment Actions
> In [T357760#9598730](/T357760#9598730), [@Dreamy\_Jazz](/p/Dreamy_Jazz/) wrote:
> > In [T357760#9598683](/T357760#9598683), [@Mstyles](/p/Mstyles/) wrote:
> >
> > [Deployed](https://sal.toolforge.org/log/CmmmC44BhuQtenzvjddS)
>
> Thanks. I've been able to verify that this patch works as expected and prevents the request timeout.
>
> There is one bug I didn't find when testing. The hard-coded message is switched around (so the message for the talk pages is above the non-talk pages and vice. versa.). That isn't a major problem IMO and could be fixed once this is uploaded to gerrit.

Noting that when patches are uploaded to gerrit, that is after they've been released in tarballs.

[Reedy](/p/Reedy/) renamed this task from Denial of service vector via GET request to Special:MovePage on pages with thousands of subpages to CVE-2024-: Denial of service vector via GET request to Special:MovePage on pages with thousands of subpages.[Mar 26 2024, 2:53 PM2024-03-26 14:53:20 (UTC+0)](#9661854)[Reedy](/p/Reedy/) added a subscriber: [gerritbot](/p/gerritbot/).[Mar 26 2024, 3:12 PM2024-03-26 15:12:49 (UTC+0)](#9661930)

[Reedy](/p/Reedy/) added a comment.[Mar 26 2024, 3:15 PM2024-03-26 15:15:19 (UTC+0)](#9661953)Comment Actions
```
diff --git a/includes/specials/SpecialMovePage.php b/includes/specials/SpecialMovePage.php
index d35999b190c..eed3e74a1d7 100644
--- a/includes/specials/SpecialMovePage.php
+++ b/includes/specials/SpecialMovePage.php
@@ -1030,7 +1030,7 @@ class SpecialMovePage extends UnlistedSpecialPage {
                        //  having the i18n rebuilt for all deployments due to this security patch.
                        $out->addWikiTextAsInterface(
                                "The first $maximumMovedPages {{PLURAL:$maximumMovedPages|subpage|subpages}} " .
-                               ( $noSubpageMsg ? 'for the corresponding talk page' : 'for this page' ) . ' are shown below.'
+                               ( $noSubpageMsg ? 'for this page' : 'for the corresponding talk page' ) . ' are shown below.'
                        );
                } else {
                        $out->addWikiMsg( $wikiMsg, $this->getLanguage()->formatNum( $pagecount ) );
```

T357760-v2.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/i2mf5vrzypuhqsjuo7ta/PHID-FILE-6jidlhooz6et2wufnz34/T357760-v2.patch)

[Reedy](/p/Reedy/) added a comment.[Mar 26 2024, 3:24 PM2024-03-26 15:24:20 (UTC+0)](#9661968)Comment Actions

Patch applies cleanly to [MW-1.41-release](/tag/mw-1.41-release/) and master.

[rMWa99ec1b4fa59: Title: Use TitleArrayFromResult instead of TitleArray](/rMWa99ec1b4fa598f37f939328e6c1d6367391e3545) seems to cause the conflicts on [MW-1.40-release](/tag/mw-1.40-release/)

T357760-v2-REL1\_40.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/rdag4kxacpyzqxdsw6li/PHID-FILE-kfjk3eymuqybcjr25ckx/T357760-v2-REL1_40.patch)

And applying that patch with -3 works for [MW-1.39-release](/tag/mw-1.39-release/) (file rename)

T357760-v2-REL1\_39.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/4xnqnmks4kxbwonbbiws/PHID-FILE-ph5kyxmof74uzd77aoua/T357760-v2-REL1_39.patch)

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Mar 27 2024, 5:44 PM2024-03-27 17:44:45 (UTC+0)](#9666505)Comment Actions
> In [T357760#9661953](/T357760#9661953), [@Reedy](/p/Reedy/) wrote:
> ```
> diff --git a/includes/specials/SpecialMovePage.php b/includes/specials/SpecialMovePage.php
> index d35999b190c..eed3e74a1d7 100644
> --- a/includes/specials/SpecialMovePage.php
> +++ b/includes/specials/SpecialMovePage.php
> @@ -1030,7 +1030,7 @@ class SpecialMovePage extends UnlistedSpecialPage {
>                         //  having the i18n rebuilt for all deployments due to this security patch.
>                         $out->addWikiTextAsInterface(
>                                 "The first $maximumMovedPages {{PLURAL:$maximumMovedPages|subpage|subpages}} " .
> -                               ( $noSubpageMsg ? 'for the corresponding talk page' : 'for this page' ) . ' are shown below.'
> +                               ( $noSubpageMsg ? 'for this page' : 'for the corresponding talk page' ) . ' are shown below.'
>                         );
>                 } else {
>                         $out->addWikiMsg( $wikiMsg, $this->getLanguage()->formatNum( $pagecount ) );
> ```
>
> T357760-v2.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/i2mf5vrzypuhqsjuo7ta/PHID-FILE-6jidlhooz6et2wufnz34/T357760-v2.patch)

+2

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Mar 27 2024, 5:46 PM2024-03-27 17:46:39 (UTC+0)](#9666512)Comment Actions
> In [T357760#9661968](/T357760#9661968), [@Reedy](/p/Reedy/) wrote:
>
> Patch applies cleanly to [MW-1.41-release](/tag/mw-1.41-release/) and master.
>
> [rMWa99ec1b4fa59: Title: Use TitleArrayFromResult instead of TitleArray](/rMWa99ec1b4fa598f37f939328e6c1d6367391e3545) seems to cause the conflicts on [MW-1.40-release](/tag/mw-1.40-release/)
>
> T357760-v2-REL1\_40.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/rdag4kxacpyzqxdsw6li/PHID-FILE-kfjk3eymuqybcjr25ckx/T357760-v2-REL1_40.patch)
>
> And applying that patch with -3 works for [MW-1.39-release](/tag/mw-1.39-release/) (file rename)
>
> T357760-v2-REL1\_39.patch4 KB[Download](https://phab.wmfusercontent.org/file/download/4xnqnmks4kxbwonbbiws/PHID-FILE-ph5kyxmof74uzd77aoua/T357760-v2-REL1_39.patch)

+2

[gerritbot](/p/gerritbot/) added a comment.[Mar 28 2024, 10:44 PM2024-03-28 22:44:11 (UTC+0)](#9671697)Comment Actions

Change #1015410 had a related patch set uploaded (by Reedy; author: Dreamy Jazz):

[mediawiki/core@REL1\_39] SECURITY: Limit subpages displayed on Special:MovePage form

<https://gerrit.wikimedia.org/r/1015410>

[gerritbot](/p/gerritbot/) added a comment.[Mar 28 2024, 10:44 PM2024-03-28 22:44:37 (UTC+0)](#9671699)Comment Actions

Change #1015415 had a related patch set uploaded (by Reedy; author: Dreamy Jazz):

[mediawiki/core@REL1\_40] SECURITY: Limit subpages displayed on Special:MovePage form

<https://gerrit.wikimedia.org/r/1015415>

[gerritbot](/p/gerritbot/) added a comment.[Mar 28 2024, 10:45 PM2024-03-28 22:45:09 (UTC+0)](#9671701)Comment Actions

Change #1015419 had a related patch set uploaded (by Reedy; author: Dreamy Jazz):

[mediawiki/core@REL1\_41] SECURITY: Limit subpages displayed on Special:MovePage form

<https://gerrit.wikimedia.org/r/1015419>

[gerritbot](/p/gerritbot/) added a comment.[Mar 28 2024, 10:51 PM2024-03-28 22:51:44 (UTC+0)](#9671717)Comment Actions

Change #1015423 had a related patch set uploaded (by Reedy; author: Dreamy Jazz):

[mediawiki/core@master] SECURITY: Limit subpages displayed on Special:MovePage form

<https://gerrit.wikimedia.org/r/1015423>

[gerritbot](/p/gerritbot/) added a comment.[Mar 28 2024, 10:57 PM2024-03-28 22:57:41 (UTC+0)](#9671743)Comment Actions

Change #1015410 **merged** by jenkins-bot:

[mediawiki/core@REL1\_39] SECURITY: Limit subpages displayed on Special:MovePage form

<https://gerrit.wikimedia.org/r/1015410>

[gerritbot](/p/gerritbot/) added a comment.[Mar 28 2024, 10:58 PM2024-03-28 22:58:06 (UTC+0)](#9671744)Comment Actions

Change #1015419 **merged** by jenkins-bot:

[mediawiki/core@REL1\_41] SECURITY: Limit subpages displayed on Special:MovePage form

<https://gerrit.wikimedia.org/r/1015419>

[gerritbot](/p/gerritbot/) added a comment.[Mar 28 2024, 10:59 PM2024-03-28 22:59:48 (UTC+0)](#9671751)Comment Actions

Change #1015415 **merged** by jenkins-bot:

[mediawiki/core@REL1\_40] SECURITY: Limit subpages displayed on Special:MovePage form

<https://gerrit.wikimedia.org/r/1015415>

[Reedy](/p/Reedy/) added a comment.[Mar 28 2024, 11:04 PM2024-03-28 23:04:01 (UTC+0)](#9671830)Comment Actions

[@Dreamy\_Jazz](/p/Dreamy_Jazz/) The patches should be landing in master pretty soon. Would you mind making the followup to move the hardcoded en strings into proper i18n messages please?

No massive rush though!

[gerritbot](/p/gerritbot/) added a comment.[Mar 28 2024, 11:20 PM2024-03-28 23:20:35 (UTC+0)](#9671856)Comment Actions

Change #1015423 **merged** by jenkins-bot:

[mediawiki/core@master] SECURITY: Limit subpages displayed on Special:MovePage form

<https://gerrit.wikimedia.org/r/1015423>

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Apr 1 2024, 7:54 PM2024-04-01 19:54:51 (UTC+0)](#9677594)Comment Actions

Can this be made public now?

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Apr 1 2024, 7:55 PM2024-04-01 19:55:07 (UTC+0)](#9677596)Comment Actions
> In [T357760#9671830](/T357760#9671830), [@Reedy](/p/Reedy/) wrote:
>
> [@Dreamy\_Jazz](/p/Dreamy_Jazz/) The patches should be landing in master pretty soon. Would you mind making the followup to move the hardcoded en strings into proper i18n messages please?
>
> No massive rush though!

Sure. I'll do that now.

[Reedy](/p/Reedy/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-liopjgktmpdcddg/)" to "Public (No Login Required)".[Apr 1 2024, 9:10 PM2024-04-01 21:10:39 (UTC+0)](#9677777)[Reedy](/p/Reedy/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-gb5yvxcbemhxfkn/)" to "All Users".[gerritbot](/p/gerritbot/) added a comment.[Apr 1 2024, 9:56 PM2024-04-01 21:56:05 (UTC+0)](#9677897)Comment Actions

Change #1016011 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/core@master] Use i18n strings for truncated subpage message

<https://gerrit.wikimedia.org/r/1016011>

[gerritbot](/p/gerritbot/) added a comment.[Apr 1 2024, 10:09 PM2024-04-01 22:09:54 (UTC+0)](#9677925)Comment Actions

Change #1015684 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/core@REL1\_41] Use i18n strings for truncated subpage message

<https://gerrit.wikimedia.org/r/1015684>

[gerritbot](/p/gerritbot/) added a comment.[Apr 1 2024, 10:10 PM2024-04-01 22:10:13 (UTC+0)](#9677926)Comment Actions

Change #1015685 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/core@REL1\_40] Use i18n strings for truncated subpage message

<https://gerrit.wikimedia.org/r/1015685>

[gerritbot](/p/gerritbot/) added a comment.[Apr 1 2024, 10:10 PM2024-04-01 22:10:31 (UTC+0)](#9677928)Comment Actions

Change #1016026 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/core@REL1\_39] Use i18n strings for truncated subpage message

<https://gerrit.wikimedia.org/r/1016026>

[sbassett](/p/sbassett/) moved this task from [Watching](/project/board/1179/) to [Our Part Is Done](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Apr 2 2024, 4:42 PM2024-04-02 16:42:00 (UTC+0)](#9681362)[sbassett](/p/sbassett/) added a project: [SecTeam-Processed](/tag/secteam-processed/).[gerritbot](/p/gerritbot/) added a comment.[Apr 6 2024, 2:18 AM2024-04-06 02:18:36 (UTC+0)](#9694624)Comment Actions

Change #1015684 **merged** by jenkins-bot:

[mediawiki/core@REL1\_41] Use i18n strings for truncated subpage message in SpecialMovePage

<https://gerrit.wikimedia.org/r/1015684>

[gerritbot](/p/gerritbot/) added a comment.[Apr 6 2024, 2:18 AM2024-04-06 02:18:57 (UTC+0)](#9694625)Comment Actions

Change #1015685 **merged** by jenkins-bot:

[mediawiki/core@REL1\_40] Use i18n strings for truncated subpage message in SpecialMovePage

<https://gerrit.wikimedia.org/r/1015685>

[gerritbot](/p/gerritbot/) added a comment.[Apr 6 2024, 2:25 AM2024-04-06 02:25:16 (UTC+0)](#9694626)Comment Actions

Change #1016011 **merged** by jenkins-bot:

[mediawiki/core@master] Use i18n strings for truncated subpage message in SpecialMovePage

<https://gerrit.wikimedia.org/r/1016011>

[gerritbot](/p/gerritbot/) added a comment.[Apr 6 2024, 2:56 AM2024-04-06 02:56:29 (UTC+0)](#9694639)Comment Actions

Change #1016026 **merged** by jenkins-bot:

[mediawiki/core@REL1\_39] Use i18n strings for truncated subpage message in SpecialMovePage

<https://gerrit.wikimedia.org/r/1016026>

[Reedy](/p/Reedy/) closed this task as Resolved.[Apr 6 2024, 3:00 AM2024-04-06 03:00:10 (UTC+0)](#9694642)[Reedy](/p/Reedy/) assigned this task to [Dreamy\_Jazz](/p/Dreamy_Jazz/).[ReleaseTaggerBot](/p/ReleaseTaggerBot/) added projects: [MW-1.39-notes](/tag/mw-1.39-notes/), [MW-1.40-notes](/tag/mw-1.40-notes/), [MW-1.41-notes](/tag/mw-1.41-notes/), [MW-1.42-notes (1.42.0-wmf.26; 2024-04-09)](/project/view/7084/).[Apr 6 2024, 3:00 AM2024-04-06 03:00:35 (UTC+0)](#9694645)[MoritzMuehlenhoff](/p/MoritzMuehlenhoff/) renamed this task from CVE-2024-: Denial of service vector via GET request to Special:MovePage on pages with thousands of subpages to CVE-2024-34506: Denial of service vector via GET request to Special:MovePage on pages with thousands of subpages.[May 6 2024, 10:22 AM2024-05-06 10:22:51 (UTC+0)](#9773952)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)