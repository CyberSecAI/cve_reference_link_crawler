<!DOCTYPE html>
<html lang="en" class="desktop-view not-mobile-device text-size-normal anon">
  <head>
    <meta charset="utf-8">
    <title>CVE-2024-38365 public disclosure (btcd `FindAndDelete` bug) - Implementation - Delving Bitcoin</title>
    <meta name="description" content="This work is a collaboration between Niklas Gögge (Brink) and Antoine Poinsot (Wizardsardine). 
Btcd prior to version 0.24.2 does not correctly implement the consensus rules for legacy signature verification. The incompa&amp;hellip;">
    <meta name="discourse_theme_id" content="1">
    <meta name="discourse_current_homepage" content="categories">

    <meta name="generator" content="Discourse 3.4.0.beta4-dev - https://github.com/discourse/discourse version fa0ad0306c06250f8af5f842d86b86f609fe02ea">
<link rel="icon" type="image/png" href="https://delvingbitcoin.org/uploads/default/optimized/1X/863d31b22a9d4d4072777bffb9b9ded86a1638bc_2_32x32.svg">
<link rel="apple-touch-icon" type="image/png" href="https://delvingbitcoin.org/uploads/default/optimized/1X/863d31b22a9d4d4072777bffb9b9ded86a1638bc_2_180x180.svg">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#111111">

<meta name="color-scheme" content="light dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://delvingbitcoin.org/t/cve-2024-38365-public-disclosure-btcd-findanddelete-bug/1184" />

<link rel="search" type="application/opensearchdescription+xml" href="https://delvingbitcoin.org/opensearch.xml" title="Delving Bitcoin Search">

    

      <meta name="fragment" content="!">


    

    <link rel="preload" href="/assets/start-discourse-9f921142b762fb91207051d0a28e571b9455bab74e7d0e03726024c286cff8d5.js" as="script" nonce="kae8eP7buWZz8DbYU3vj6Unku">
    <link rel="preload" href="/assets/browser-update-5faeb6403cf1359d9e201f096cc21a2cb3290010f06dac44d3d9c52210a05aac.js" as="script" nonce="kae8eP7buWZz8DbYU3vj6Unku">

    <script defer src="/assets/browser-detect-06b8e45041d4587c0c6b454b2c35e1584b6ab99cf1792f325e4ff851f4db507d.js" data-discourse-entrypoint="browser-detect" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>


    <script defer src="/assets/vendor.6f1929e16c84d825f1e134b0a5a6bf6d-ed21b08557694a2386531fb8b5bd479da7fe4ec9cffd9278c49f382c5e7bc3a4.js" data-discourse-entrypoint="vendor" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

    <script defer src="/assets/chunk.e041561a9d039e7f4e60.d41d8cd9.js" data-discourse-entrypoint="discourse" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

<script defer src="/assets/chunk.88a555527eb3ac351da0.d41d8cd9.js" data-discourse-entrypoint="discourse" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/automation_admin-fce8c2847d735a9bb8ea4f907d496b19afc01636f27d0fee838ac6112b875d8f.js" data-discourse-entrypoint="plugins/automation_admin" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/checklist-f56c22844d8be39217397d68624ee48a0261664604905e36d0b7c8517e35dca6.js" data-discourse-entrypoint="plugins/checklist" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-cakeday-d2610bd0fa593a1dd8bed4a9f9e822184d4ba58de38f4b69eccc37e3f1a1adea.js" data-discourse-entrypoint="plugins/discourse-cakeday" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-data-explorer-92a25a362744f229fe8617a0c7e1fc444dae480c932ef7d526b8944efce0623d.js" data-discourse-entrypoint="plugins/discourse-data-explorer" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-details-a19980264e3a6feb20b7e320b03ab0e7a3457105d99b863cd2f62eda09f15507.js" data-discourse-entrypoint="plugins/discourse-details" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-graphviz-f4a7d4462b162311b1deec252ace6f207ba70962685c5bbb134debb637dbb06d.js" data-discourse-entrypoint="plugins/discourse-graphviz" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-lazy-videos-9aedaec9b360053ab6f08fc1906a26d134f2c3c18220cd09a96549a2067584fb.js" data-discourse-entrypoint="plugins/discourse-lazy-videos" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-local-dates-e622ba3973e1136408d885aa43a8dbf02095f2f9d0165a4954b2ab1b50b5300e.js" data-discourse-entrypoint="plugins/discourse-local-dates" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-math-df874ca59d6c08aacb498b0c9009f3c060dba4a2bc831cfe5aeadc15bb716094.js" data-discourse-entrypoint="plugins/discourse-math" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-presence-4936ee7cf92a3f490144a4c6818f17eb70f147b34a3cb5043c3427652d4575de.js" data-discourse-entrypoint="plugins/discourse-presence" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-reactions-18ac1908f625493ae89e548463758da63175b3640a128a12cd6d182e07cdde67.js" data-discourse-entrypoint="plugins/discourse-reactions" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/discourse-user-notes-230cfd547a827b242b58a79cbb748efb04ef03adb34ec7510346bde14849a62d.js" data-discourse-entrypoint="plugins/discourse-user-notes" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/docker_manager_admin-d2b95af1064c079cd42baecb60f158994e169de221f8ed692209a18324b36f15.js" data-discourse-entrypoint="plugins/docker_manager_admin" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/footnote-b30502d9bd28251a1683c8d09ed164bc6650c5c67c4375e6a42adf95b3ee8110.js" data-discourse-entrypoint="plugins/footnote" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/footnote_extra-295b457b90cb18fedfdb544868c494c71842a27c0781d3042fa4fd26589204fa.js" data-discourse-entrypoint="plugins/footnote_extra" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/poll-cec3e8a864e604e592a725de1ab8bc404e82a876e662e467ac9d886ea35af75b.js" data-discourse-entrypoint="plugins/poll" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/assets/plugins/spoiler-alert-f248215b3244c267d8dff2d32901afb6d1dd07988eff90c2b4fc794234956de7.js" data-discourse-entrypoint="plugins/spoiler-alert" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>


    <script defer src="/assets/locales/en-93fa733c120b866d4a3ec0a8d751fd30616a38348e701f1eb65831ddb1348e74.js" data-discourse-entrypoint="locales/en" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

    <script defer src="/extra-locales/mf?v=50fc7aac4b913b2fb6284a3ad8efa92b"  nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/extra-locales/overrides?v=c12940a328b4a59c9464e5d5e1faee65"  nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>




      <script defer src="/theme-javascripts/a0b487c51874d6a0fe22e50d923f471fd91687b8.js?__ws=delvingbitcoin.org" data-theme-id="2" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

<script defer src="/theme-javascripts/d1942e3e5aa4a1e9de06e1185d582057e9c399d1.js?__ws=delvingbitcoin.org" data-theme-id="3" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

<script defer src="/theme-javascripts/36f5fb0ca17db9aff4f0610dca8d35b05dcc7c09.js?__ws=delvingbitcoin.org" data-theme-id="5" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

<script defer src="/theme-javascripts/808b720fc589c6edabee43d32588ac4c24a3f717.js?__ws=delvingbitcoin.org" data-theme-id="6" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      <script defer src="/theme-javascripts/46a39651330809c3dc05c944556bd9ad22b119f5.js?__ws=delvingbitcoin.org" data-theme-id="2" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

<script defer src="/theme-javascripts/4f58d45db2979184711dd20e15059f9594ea8a0c.js?__ws=delvingbitcoin.org" data-theme-id="3" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

<script defer src="/theme-javascripts/8112d5d890e67f40e3fdd593a6ee896da6256064.js?__ws=delvingbitcoin.org" data-theme-id="5" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

<script defer src="/theme-javascripts/984827834c4416c2607be2de74e5dadcdd77c4d3.js?__ws=delvingbitcoin.org" data-theme-id="6" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      

    
    
    <link id="manifest-link" rel="manifest" href=/manifest.webmanifest crossorigin="use-credentials">


        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;CVE-2024-38365 public disclosure (btcd `FindAndDelete` bug)&#39;" href="https://delvingbitcoin.org/t/cve-2024-38365-public-disclosure-btcd-findanddelete-bug/1184.rss" />
    <meta property="og:site_name" content="Delving Bitcoin" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="og:image" content="https://delvingbitcoin.org/uploads/default/original/1X/863d31b22a9d4d4072777bffb9b9ded86a1638bc.svg" />
<meta property="og:url" content="https://delvingbitcoin.org/t/cve-2024-38365-public-disclosure-btcd-findanddelete-bug/1184" />
<meta name="twitter:url" content="https://delvingbitcoin.org/t/cve-2024-38365-public-disclosure-btcd-findanddelete-bug/1184" />
<meta property="og:title" content="CVE-2024-38365 public disclosure (btcd `FindAndDelete` bug)" />
<meta name="twitter:title" content="CVE-2024-38365 public disclosure (btcd `FindAndDelete` bug)" />
<meta property="og:description" content="This work is a collaboration between Niklas Gögge (Brink) and Antoine Poinsot (Wizardsardine).  Btcd prior to version 0.24.2 does not correctly implement the consensus rules for legacy signature verification. The incompatible behavior can be triggered by a standard transaction, making it possible for anyone to fork off vulnerable btcd nodes at virtually no cost.  Details When verifying a signature for a transaction input, the script interpreter of a Bitcoin node re-constructs the signed message ..." />
<meta name="twitter:description" content="This work is a collaboration between Niklas Gögge (Brink) and Antoine Poinsot (Wizardsardine).  Btcd prior to version 0.24.2 does not correctly implement the consensus rules for legacy signature verification. The incompatible behavior can be triggered by a standard transaction, making it possible for anyone to fork off vulnerable btcd nodes at virtually no cost.  Details When verifying a signature for a transaction input, the script interpreter of a Bitcoin node re-constructs the signed message ..." />
<meta property="og:article:section" content="Implementation" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="announcement" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="3 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="2 ❤" />
<meta property="article:published_time" content="2024-10-10T09:02:17+00:00" />
<meta property="og:ignore_canonical" content="true" />



    

    <meta id="data-discourse-setup" data-base-url="https://delvingbitcoin.org" data-base-uri="" data-environment="production" data-letter-avatar-version="5_f40856482fe1e45ac8f1605885140a2d" data-service-worker-url="service-worker.js" data-default-locale="en" data-asset-version="97e17210df620a92ea5250996959db7b" data-disable-custom-css="false" data-highlight-js-path="/highlight-js/delvingbitcoin.org/9797975efac87d28baa695ae13ca72ccaf5120f5.js" data-svg-sprite-path="/svg-sprite/delvingbitcoin.org/svg-1-b8cfcf8d6bdea13a68e6970ef7d2e2aab60e77b5.js" data-enable-js-error-reporting="true" data-color-scheme-is-dark="false" data-user-color-scheme-id="7" data-user-dark-scheme-id="1">

    <meta name="discourse/config/environment" content="%7B%22modulePrefix%22%3A%22discourse%22%2C%22environment%22%3A%22production%22%2C%22rootURL%22%3A%22%22%2C%22locationType%22%3A%22history%22%2C%22historySupportMiddleware%22%3Afalse%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%2C%22String%22%3Afalse%7D%2C%22_APPLICATION_TEMPLATE_WRAPPER%22%3Afalse%2C%22_DEFAULT_ASYNC_OBSERVERS%22%3Atrue%2C%22_JQUERY_INTEGRATION%22%3Atrue%7D%2C%22APP%22%3A%7B%22name%22%3A%22discourse%22%2C%22version%22%3A%223.4.0.beta4-dev%20fa0ad0306c06250f8af5f842d86b86f609fe02ea%22%2C%22exportApplicationGlobal%22%3Atrue%7D%7D" />
  </head>

  <body class="">
      <section id="d-splash">
  <template class="splash-svg-template">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      version="1.1"
    >
      <style>
        :root {
          --animation-state: paused;
        }

        /* user picked a theme where the "regular" scheme is dark */
        /* user picked a theme a light scheme and also enabled a dark scheme */

        /* deal with light scheme first */
        @media (prefers-color-scheme: light) {
          :root {
            --primary: #222222;
            --secondary: #ffffff;
            --tertiary: #0088cc;
            --highlight: #ffff4d;
            --success: #009900;
          }
        }

        /* then deal with dark scheme */
        @media (prefers-color-scheme: dark) {
          :root {
            --primary: #dddddd;
            --secondary: #222222;
            --tertiary: #0f82af;
            --highlight: #a87137;
            --success: #1ca551;
          }
        }

        /* these styles need to live here because the SVG has a different scope */
        .dots {
          animation-name: loader;
          animation-timing-function: ease-in-out;
          animation-duration: 3s;
          animation-iteration-count: infinite;
          animation-play-state: var(--animation-state);
          stroke: #fff;
          stroke-width: 0.5px;
          transform-origin: center;
          opacity: 0;
          r: max(1vw, 11px);
          cy: 50%;
          filter: saturate(2) opacity(0.85);
          fill: var(--tertiary);
        }

        .dots:nth-child(2) {
          animation-delay: 0.15s;
        }

        .dots:nth-child(3) {
          animation-delay: 0.3s;
        }

        .dots:nth-child(4) {
          animation-delay: 0.45s;
        }

        .dots:nth-child(5) {
          animation-delay: 0.6s;
        }

        @keyframes loader {
          0% {
            opacity: 0;
            transform: scale(1);
          }
          45% {
            opacity: 1;
            transform: scale(0.7);
          }
          65% {
            opacity: 1;
            transform: scale(0.7);
          }
          100% {
            opacity: 0;
            transform: scale(1);
          }
        }
      </style>

      <g class="container">
        <circle class="dots" cx="30vw" />
        <circle class="dots" cx="40vw" />
        <circle class="dots" cx="50vw" />
        <circle class="dots" cx="60vw" />
        <circle class="dots" cx="70vw" />
      </g>
    </svg>
  </template>

  <style>
    html {
      overflow-y: hidden !important;
    }

    /* user picked a theme where the "regular" scheme is dark */
    /* user picked a theme a light scheme and also enabled a dark scheme */

    /* deal with light scheme first */
    @media (prefers-color-scheme: light) {
      html {
        background-color: #ffffff;
      }

      #d-splash .preloader-text-wrapper {
        color: #222222;
      }
    }

    /* then deal with dark scheme */
    @media (prefers-color-scheme: dark) {
      html {
        background-color: #222222;
      }

      #d-splash .preloader-text-wrapper {
        color: #dddddd;
      }
    }

    #d-splash {
      display: grid;
      place-items: center;
      backface-visibility: hidden;
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      z-index: 1001;
      --animation-state: paused;
    }

    #d-splash .preloader-image {
      max-width: 100%;
      height: 100vh;
    }

    #d-splash .preloader-text-wrapper {
      font-family: sans-serif;
      position: absolute;
      opacity: 0;
      animation: fade-in 0.5s ease-in-out;
      animation-delay: 1s;
      animation-fill-mode: forwards;
      animation-play-state: var(--animation-state);
      margin-bottom: -4em;
    }

    #d-splash .preloader-text:after {
      animation: loading-text 3s infinite;
      content: "";
      position: absolute;
      margin: 0 0.1em;
      left: 100%;
    }

    .rtl #d-splash .preloader-text:after {
      left: 0;
      right: 100%;
    }

    @keyframes fade-in {
      0% {
        opacity: 0;
      }
      100% {
        opacity: 1;
      }
    }

    @keyframes loading-text {
      0% {
        content: "";
      }
      25% {
        content: ".";
      }
      50% {
        content: "..";
      }
      75% {
        content: "...";
      }
    }
  </style>

  <img
    class="preloader-image"
    src="data:image/svg;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
    alt="Delving Bitcoin"
  />

  <div class="preloader-text-wrapper">
    <div class="preloader-text">Loading</div>
  </div>

  <noscript>
    <style>
      html {
        overflow-y: revert !important;
      }

      #d-splash {
        display: none;
      }
    </style>
  </noscript>

  <script nonce="kae8eP7buWZz8DbYU3vj6Unku">
    const DELAY_TARGET=2e3,POLLING_INTERVAL=50,splashSvgTemplate=document.querySelector(".splash-svg-template"),splashTemplateClone=splashSvgTemplate.content.cloneNode(!0),svgElement=splashTemplateClone.querySelector("svg"),svgString=(new XMLSerializer).serializeToString(svgElement),encodedSvg=btoa(svgString),splashWrapper=document.querySelector("#d-splash"),splashImage=splashWrapper&&splashWrapper.querySelector(".preloader-image")
if(splashImage){splashImage.src=`data:image/svg+xml;base64,${encodedSvg}`
const e=(performance.timing.connectStart||0)+2e3
let s,a
const r=()=>{splashWrapper&&splashWrapper.style.setProperty("--animation-state","running"),svgElement&&svgElement.style.setProperty("--animation-state","running")
const e=(new XMLSerializer).serializeToString(svgElement),s=btoa(e)
splashImage.src=`data:image/svg+xml;base64,${s}`,performance.mark("discourse-splash-visible"),t()},t=()=>{clearInterval(s),s=null}
s=setInterval((()=>{a&&t(),Date.now()>e&&r()}),50),document.addEventListener("discourse-ready",(()=>{a=!0,splashWrapper&&splashWrapper.remove(),performance.mark("discourse-splash-removed")}),{once:!0})}

  </script>
</section>


    <discourse-assets>
      <discourse-assets-stylesheets>
        <link href="/stylesheets/color_definitions_light_7_1_58abbd6024f8d5f8a01854a682a62ff0b196d230.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" class="light-scheme"/><link href="/stylesheets/color_definitions_dark_1_1_79508f99b748993197747bc205084b04f2736993.css?__ws=delvingbitcoin.org" media="(prefers-color-scheme: dark)" rel="stylesheet" class="dark-scheme"/>

  <link href="/stylesheets/desktop_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="/stylesheets/automation_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="automation"  />
  <link href="/stylesheets/checklist_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="/stylesheets/discourse-cakeday_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
  <link href="/stylesheets/discourse-data-explorer_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-data-explorer"  />
  <link href="/stylesheets/discourse-details_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="/stylesheets/discourse-graphviz_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-graphviz"  />
  <link href="/stylesheets/discourse-lazy-videos_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="/stylesheets/discourse-local-dates_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="/stylesheets/discourse-math_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-math"  />
  <link href="/stylesheets/discourse-narrative-bot_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="/stylesheets/discourse-presence_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="/stylesheets/discourse-reactions_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-reactions"  />
  <link href="/stylesheets/discourse-user-notes_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-user-notes"  />
  <link href="/stylesheets/docker_manager_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="/stylesheets/footnote_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="footnote"  />
  <link href="/stylesheets/poll_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="poll"  />
  <link href="/stylesheets/spoiler-alert_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="spoiler-alert"  />
  <link href="/stylesheets/discourse-reactions_desktop_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="discourse-reactions_desktop"  />
  <link href="/stylesheets/poll_desktop_e3dbc574d63a12eeb23e0e5b70ddcd732bc7ca64.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="/stylesheets/desktop_theme_3_673888c74d852fe2b82a507c1f554fc4249e0806.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="discotoc"/>
<link href="/stylesheets/desktop_theme_6_679e8e22237e6d8e992468079eb828e7d43f337a.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="6" data-theme-name="discourse plotly"/>
<link href="/stylesheets/desktop_theme_2_1cfee51ec0ba6a1debb22f9fa75e7afcba128dfa.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="discourse-mermaid-theme-component"/>
<link href="/stylesheets/desktop_theme_1_9c42d5a946191fb7561c7ae72a357abfb1ec429f.css?__ws=delvingbitcoin.org" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="1" data-theme-name="default"/>

      </discourse-assets-stylesheets>
      <discourse-assets-json>
        <div class="hidden" id="data-preloaded" data-preloaded="{&quot;site&quot;:&quot;{\&quot;default_archetype\&quot;:\&quot;regular\&quot;,\&quot;notification_types\&quot;:{\&quot;mentioned\&quot;:1,\&quot;replied\&quot;:2,\&quot;quoted\&quot;:3,\&quot;edited\&quot;:4,\&quot;liked\&quot;:5,\&quot;private_message\&quot;:6,\&quot;invited_to_private_message\&quot;:7,\&quot;invitee_accepted\&quot;:8,\&quot;posted\&quot;:9,\&quot;moved_post\&quot;:10,\&quot;linked\&quot;:11,\&quot;granted_badge\&quot;:12,\&quot;invited_to_topic\&quot;:13,\&quot;custom\&quot;:14,\&quot;group_mentioned\&quot;:15,\&quot;group_message_summary\&quot;:16,\&quot;watching_first_post\&quot;:17,\&quot;topic_reminder\&quot;:18,\&quot;liked_consolidated\&quot;:19,\&quot;post_approved\&quot;:20,\&quot;code_review_commit_approved\&quot;:21,\&quot;membership_request_accepted\&quot;:22,\&quot;membership_request_consolidated\&quot;:23,\&quot;bookmark_reminder\&quot;:24,\&quot;reaction\&quot;:25,\&quot;votes_released\&quot;:26,\&quot;event_reminder\&quot;:27,\&quot;event_invitation\&quot;:28,\&quot;chat_mention\&quot;:29,\&quot;chat_message\&quot;:30,\&quot;chat_invitation\&quot;:31,\&quot;chat_group_mention\&quot;:32,\&quot;chat_quoted\&quot;:33,\&quot;assigned\&quot;:34,\&quot;question_answer_user_commented\&quot;:35,\&quot;watching_category_or_tag\&quot;:36,\&quot;new_features\&quot;:37,\&quot;admin_problems\&quot;:38,\&quot;linked_consolidated\&quot;:39,\&quot;chat_watched_thread\&quot;:40,\&quot;following\&quot;:800,\&quot;following_created_topic\&quot;:801,\&quot;following_replied\&quot;:802,\&quot;circles_activity\&quot;:900},\&quot;post_types\&quot;:{\&quot;regular\&quot;:1,\&quot;moderator_action\&quot;:2,\&quot;small_action\&quot;:3,\&quot;whisper\&quot;:4},\&quot;user_tips\&quot;:{\&quot;first_notification\&quot;:1,\&quot;topic_timeline\&quot;:2,\&quot;post_menu\&quot;:3,\&quot;topic_notification_levels\&quot;:4,\&quot;suggested_topics\&quot;:5},\&quot;trust_levels\&quot;:{\&quot;newuser\&quot;:0,\&quot;basic\&quot;:1,\&quot;member\&quot;:2,\&quot;regular\&quot;:3,\&quot;leader\&quot;:4},\&quot;groups\&quot;:[{\&quot;id\&quot;:44,\&quot;name\&quot;:\&quot;wg-silent-payments\&quot;,\&quot;flair_url\&quot;:\&quot;volume-xmark\&quot;,\&quot;flair_bg_color\&quot;:\&quot;\&quot;,\&quot;flair_color\&quot;:\&quot;\&quot;}],\&quot;filters\&quot;:[\&quot;latest\&quot;,\&quot;unread\&quot;,\&quot;new\&quot;,\&quot;unseen\&quot;,\&quot;top\&quot;,\&quot;read\&quot;,\&quot;posted\&quot;,\&quot;bookmarks\&quot;,\&quot;hot\&quot;],\&quot;periods\&quot;:[\&quot;all\&quot;,\&quot;yearly\&quot;,\&quot;quarterly\&quot;,\&quot;monthly\&quot;,\&quot;weekly\&quot;,\&quot;daily\&quot;],\&quot;top_menu_items\&quot;:[\&quot;latest\&quot;,\&quot;unread\&quot;,\&quot;new\&quot;,\&quot;unseen\&quot;,\&quot;top\&quot;,\&quot;read\&quot;,\&quot;posted\&quot;,\&quot;bookmarks\&quot;,\&quot;hot\&quot;,\&quot;categories\&quot;],\&quot;anonymous_top_menu_items\&quot;:[\&quot;latest\&quot;,\&quot;top\&quot;,\&quot;categories\&quot;,\&quot;hot\&quot;,\&quot;categories\&quot;,\&quot;top\&quot;],\&quot;uncategorized_category_id\&quot;:1,\&quot;user_field_max_length\&quot;:2048,\&quot;post_action_types\&quot;:[{\&quot;id\&quot;:6,\&quot;name\&quot;:\&quot;Send @%{username} a message\&quot;,\&quot;name_key\&quot;:\&quot;notify_user\&quot;,\&quot;description\&quot;:\&quot;I want to talk to this person directly and personally about their post.\&quot;,\&quot;short_description\&quot;:\&quot;I want to talk to this person directly and personally about their post.\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:0,\&quot;require_message\&quot;:true,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:true,\&quot;auto_action_type\&quot;:false},{\&quot;id\&quot;:3,\&quot;name\&quot;:\&quot;Off-Topic\&quot;,\&quot;name_key\&quot;:\&quot;off_topic\&quot;,\&quot;description\&quot;:\&quot;This post is not relevant to the current discussion as defined by the title and first post, and should probably be moved elsewhere.\&quot;,\&quot;short_description\&quot;:\&quot;Not relevant to the discussion\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:1,\&quot;require_message\&quot;:false,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:true,\&quot;auto_action_type\&quot;:true},{\&quot;id\&quot;:4,\&quot;name\&quot;:\&quot;Not constructive\&quot;,\&quot;name_key\&quot;:\&quot;inappropriate\&quot;,\&quot;description\&quot;:\&quot;This post contains non-constructive content, for example it may be repetitive, trolling, argumentative, or include content that a reasonable person would consider offensive, abusive, or a violation of \\u003ca href=\\\&quot;/guidelines\\\&quot;\\u003eour community guidelines\\u003c/a\\u003e.\&quot;,\&quot;short_description\&quot;:\&quot;A violation of \\u003ca href=\\\&quot;/guidelines\\\&quot;\\u003eour community guidelines\\u003c/a\\u003e\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Topic\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:2,\&quot;require_message\&quot;:false,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:true,\&quot;auto_action_type\&quot;:true},{\&quot;id\&quot;:8,\&quot;name\&quot;:\&quot;Spam\&quot;,\&quot;name_key\&quot;:\&quot;spam\&quot;,\&quot;description\&quot;:\&quot;This post is an advertisement, or vandalism. It is not useful or relevant to the current topic.\&quot;,\&quot;short_description\&quot;:\&quot;This is an advertisement or vandalism\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Topic\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:3,\&quot;require_message\&quot;:false,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:true,\&quot;auto_action_type\&quot;:true},{\&quot;id\&quot;:10,\&quot;name\&quot;:\&quot;Illegal\&quot;,\&quot;name_key\&quot;:\&quot;illegal\&quot;,\&quot;description\&quot;:\&quot;This post requires staff attention because I believe it contains content that is illegal.  This includes deceptively encouraging the use of patent-encumbered techniques.\&quot;,\&quot;short_description\&quot;:\&quot;This is illegal\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Topic\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:4,\&quot;require_message\&quot;:true,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:false,\&quot;auto_action_type\&quot;:false},{\&quot;id\&quot;:7,\&quot;name\&quot;:\&quot;Something Else\&quot;,\&quot;name_key\&quot;:\&quot;notify_moderators\&quot;,\&quot;description\&quot;:\&quot;This post requires staff attention for another reason not listed above.\&quot;,\&quot;short_description\&quot;:\&quot;Requires staff attention for another reason\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Topic\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:5,\&quot;require_message\&quot;:true,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:true,\&quot;auto_action_type\&quot;:false},{\&quot;id\&quot;:2,\&quot;name\&quot;:\&quot;Like\&quot;,\&quot;name_key\&quot;:\&quot;like\&quot;,\&quot;description\&quot;:\&quot;Like this post\&quot;,\&quot;short_description\&quot;:\&quot;Like this post\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;],\&quot;position\&quot;:7,\&quot;require_message\&quot;:false,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:false,\&quot;is_used\&quot;:true,\&quot;auto_action_type\&quot;:false}],\&quot;topic_flag_types\&quot;:[{\&quot;id\&quot;:4,\&quot;name\&quot;:\&quot;Not constructive\&quot;,\&quot;name_key\&quot;:\&quot;inappropriate\&quot;,\&quot;description\&quot;:\&quot;This topic contains non-constructive content, for example it may be repetitive, trolling, argumentative, or include content that a reasonable person would consider offensive, abusive, or a violation of \\u003ca href=\\\&quot;/guidelines\\\&quot;\\u003eour community guidelines\\u003c/a\\u003e.\&quot;,\&quot;short_description\&quot;:\&quot;A violation of \\u003ca href=\\\&quot;/guidelines\\\&quot;\\u003eour community guidelines\\u003c/a\\u003e\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Topic\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:2,\&quot;require_message\&quot;:false,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:true,\&quot;auto_action_type\&quot;:true},{\&quot;id\&quot;:8,\&quot;name\&quot;:\&quot;Spam\&quot;,\&quot;name_key\&quot;:\&quot;spam\&quot;,\&quot;description\&quot;:\&quot;This topic is an advertisement. It is not useful or relevant to this site, but promotional in nature.\&quot;,\&quot;short_description\&quot;:\&quot;This is an advertisement\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Topic\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:3,\&quot;require_message\&quot;:false,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:true,\&quot;auto_action_type\&quot;:true},{\&quot;id\&quot;:10,\&quot;name\&quot;:\&quot;Illegal\&quot;,\&quot;name_key\&quot;:\&quot;illegal\&quot;,\&quot;description\&quot;:\&quot;This topic requires staff attention because I believe it contains content that is illegal. This includes deceptively encouraging the use of patent-encumbered techniques.\&quot;,\&quot;short_description\&quot;:\&quot;This is illegal\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Topic\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:4,\&quot;require_message\&quot;:true,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:false,\&quot;auto_action_type\&quot;:false},{\&quot;id\&quot;:7,\&quot;name\&quot;:\&quot;Something Else\&quot;,\&quot;name_key\&quot;:\&quot;notify_moderators\&quot;,\&quot;description\&quot;:\&quot;\&quot;,\&quot;short_description\&quot;:\&quot;Requires staff attention for another reason\&quot;,\&quot;applies_to\&quot;:[\&quot;Post\&quot;,\&quot;Topic\&quot;,\&quot;Chat::Message\&quot;],\&quot;position\&quot;:5,\&quot;require_message\&quot;:true,\&quot;enabled\&quot;:true,\&quot;is_flag\&quot;:true,\&quot;is_used\&quot;:true,\&quot;auto_action_type\&quot;:false}],\&quot;can_create_tag\&quot;:false,\&quot;can_tag_topics\&quot;:false,\&quot;can_tag_pms\&quot;:false,\&quot;tags_filter_regexp\&quot;:\&quot;[/\\\\?#\\\\[\\\\]@!\\\\$\\u0026&#39;\\\\(\\\\)\\\\*\\\\+,;=\\\\.%\\\\\\\\`^\\\\s|\\\\{\\\\}\\\&quot;\\u003c\\u003e]+\&quot;,\&quot;top_tags\&quot;:[\&quot;lightning\&quot;,\&quot;softfork\&quot;,\&quot;mempool\&quot;,\&quot;taproot\&quot;,\&quot;announcement\&quot;,\&quot;wg-cluster-mempool\&quot;,\&quot;bitcoin-core\&quot;,\&quot;inquisition\&quot;,\&quot;miniscript\&quot;,\&quot;musig2\&quot;,\&quot;wallet\&quot;,\&quot;cryptography\&quot;,\&quot;braidpool\&quot;,\&quot;coinselection\&quot;,\&quot;factory\&quot;,\&quot;fee-estimation\&quot;,\&quot;lang:rust\&quot;,\&quot;address\&quot;,\&quot;cashu\&quot;,\&quot;ecash\&quot;,\&quot;fuzz\&quot;,\&quot;libbitcoin\&quot;,\&quot;mining\&quot;,\&quot;mining-pools\&quot;,\&quot;pinning\&quot;,\&quot;proof-of-burn\&quot;,\&quot;psbt\&quot;,\&quot;routing\&quot;,\&quot;signet\&quot;,\&quot;stratum-v2\&quot;],\&quot;navigation_menu_site_top_tags\&quot;:[{\&quot;name\&quot;:\&quot;lightning\&quot;,\&quot;description\&quot;:null,\&quot;pm_only\&quot;:false},{\&quot;name\&quot;:\&quot;softfork\&quot;,\&quot;description\&quot;:null,\&quot;pm_only\&quot;:false},{\&quot;name\&quot;:\&quot;mempool\&quot;,\&quot;description\&quot;:null,\&quot;pm_only\&quot;:false},{\&quot;name\&quot;:\&quot;taproot\&quot;,\&quot;description\&quot;:null,\&quot;pm_only\&quot;:false},{\&quot;name\&quot;:\&quot;announcement\&quot;,\&quot;description\&quot;:null,\&quot;pm_only\&quot;:false}],\&quot;topic_featured_link_allowed_category_ids\&quot;:[6,9,10,1,2,11,12,3,4,8,7,5],\&quot;user_themes\&quot;:[{\&quot;theme_id\&quot;:1,\&quot;name\&quot;:\&quot;Default\&quot;,\&quot;default\&quot;:true,\&quot;color_scheme_id\&quot;:7}],\&quot;user_color_schemes\&quot;:[{\&quot;id\&quot;:1,\&quot;name\&quot;:\&quot;Dark\&quot;,\&quot;is_dark\&quot;:true},{\&quot;id\&quot;:4,\&quot;name\&quot;:\&quot;Dracula\&quot;,\&quot;is_dark\&quot;:true},{\&quot;id\&quot;:7,\&quot;name\&quot;:\&quot;Light\&quot;,\&quot;is_dark\&quot;:false},{\&quot;id\&quot;:6,\&quot;name\&quot;:\&quot;Solarized Dark\&quot;,\&quot;is_dark\&quot;:true},{\&quot;id\&quot;:5,\&quot;name\&quot;:\&quot;Solarized Light\&quot;,\&quot;is_dark\&quot;:false},{\&quot;id\&quot;:3,\&quot;name\&quot;:\&quot;WCAG Dark\&quot;,\&quot;is_dark\&quot;:true},{\&quot;id\&quot;:2,\&quot;name\&quot;:\&quot;WCAG Light\&quot;,\&quot;is_dark\&quot;:false}],\&quot;default_dark_color_scheme\&quot;:{\&quot;id\&quot;:1,\&quot;name\&quot;:\&quot;Dark\&quot;,\&quot;is_base\&quot;:null,\&quot;base_scheme_id\&quot;:\&quot;Dark\&quot;,\&quot;theme_id\&quot;:null,\&quot;theme_name\&quot;:null,\&quot;user_selectable\&quot;:true,\&quot;colors\&quot;:[{\&quot;name\&quot;:\&quot;primary\&quot;,\&quot;hex\&quot;:\&quot;dddddd\&quot;,\&quot;default_hex\&quot;:\&quot;dddddd\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;secondary\&quot;,\&quot;hex\&quot;:\&quot;222222\&quot;,\&quot;default_hex\&quot;:\&quot;222222\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;tertiary\&quot;,\&quot;hex\&quot;:\&quot;0f82af\&quot;,\&quot;default_hex\&quot;:\&quot;099dd7\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;quaternary\&quot;,\&quot;hex\&quot;:\&quot;c14924\&quot;,\&quot;default_hex\&quot;:\&quot;c14924\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;header_background\&quot;,\&quot;hex\&quot;:\&quot;111111\&quot;,\&quot;default_hex\&quot;:\&quot;111111\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;header_primary\&quot;,\&quot;hex\&quot;:\&quot;dddddd\&quot;,\&quot;default_hex\&quot;:\&quot;dddddd\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;highlight\&quot;,\&quot;hex\&quot;:\&quot;a87137\&quot;,\&quot;default_hex\&quot;:\&quot;a87137\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;danger\&quot;,\&quot;hex\&quot;:\&quot;e45735\&quot;,\&quot;default_hex\&quot;:\&quot;e45735\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;success\&quot;,\&quot;hex\&quot;:\&quot;1ca551\&quot;,\&quot;default_hex\&quot;:\&quot;1ca551\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;love\&quot;,\&quot;hex\&quot;:\&quot;fa6c8d\&quot;,\&quot;default_hex\&quot;:\&quot;fa6c8d\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;hover\&quot;,\&quot;hex\&quot;:\&quot;313131\&quot;,\&quot;default_hex\&quot;:\&quot;313131\&quot;,\&quot;is_advanced\&quot;:false},{\&quot;name\&quot;:\&quot;selected\&quot;,\&quot;hex\&quot;:\&quot;2c2c2c\&quot;,\&quot;default_hex\&quot;:\&quot;052e3d\&quot;,\&quot;is_advanced\&quot;:false}]},\&quot;censored_regexp\&quot;:[],\&quot;custom_emoji_translation\&quot;:{},\&quot;watched_words_replace\&quot;:null,\&quot;watched_words_link\&quot;:null,\&quot;categories\&quot;:[{\&quot;id\&quot;:8,\&quot;name\&quot;:\&quot;Implementation\&quot;,\&quot;color\&quot;:\&quot;F7941D\&quot;,\&quot;text_color\&quot;:\&quot;FFFFFF\&quot;,\&quot;slug\&quot;:\&quot;implementation\&quot;,\&quot;topic_count\&quot;:86,\&quot;post_count\&quot;:650,\&quot;position\&quot;:0,\&quot;description\&quot;:\&quot;For discussion of (practical) implementation techniques, either for particular Bitcoin software, or that may be relevant to many implementations.\&quot;,\&quot;description_text\&quot;:\&quot;For discussion of (practical) implementation techniques, either for particular Bitcoin software, or that may be relevant to many implementations.\&quot;,\&quot;description_excerpt\&quot;:\&quot;For discussion of (practical) implementation techniques, either for particular Bitcoin software, or that may be relevant to many implementations.\&quot;,\&quot;topic_url\&quot;:\&quot;/t/about-the-implementation-category/16\&quot;,\&quot;read_restricted\&quot;:false,\&quot;permission\&quot;:null,\&quot;notification_level\&quot;:1,\&quot;topic_template\&quot;:null,\&quot;has_children\&quot;:true,\&quot;subcategory_count\&quot;:null,\&quot;sort_order\&quot;:null,\&quot;sort_ascending\&quot;:null,\&quot;show_subcategory_list\&quot;:false,\&quot;num_featured_topics\&quot;:3,\&quot;default_view\&quot;:null,\&quot;subcategory_list_style\&quot;:\&quot;rows_with_featured_topics\&quot;,\&quot;default_top_period\&quot;:\&quot;all\&quot;,\&quot;default_list_filter\&quot;:\&quot;all\&quot;,\&quot;minimum_required_tags\&quot;:0,\&quot;navigate_to_first_post_after_read\&quot;:false,\&quot;custom_fields\&quot;:{\&quot;has_chat_enabled\&quot;:null},\&quot;allowed_tags\&quot;:[],\&quot;allowed_tag_groups\&quot;:[],\&quot;allow_global_tags\&quot;:false,\&quot;read_only_banner\&quot;:null,\&quot;form_template_ids\&quot;:[],\&quot;uploaded_logo\&quot;:null,\&quot;uploaded_logo_dark\&quot;:null,\&quot;uploaded_background\&quot;:null,\&quot;uploaded_background_dark\&quot;:null,\&quot;required_tag_groups\&quot;:[],\&quot;can_edit\&quot;:false},{\&quot;id\&quot;:7,\&quot;name\&quot;:\&quot;Protocol Design\&quot;,\&quot;color\&quot;:\&quot;0088CC\&quot;,\&quot;text_color\&quot;:\&quot;FFFFFF\&quot;,\&quot;slug\&quot;:\&quot;protocol-design\&quot;,\&quot;topic_count\&quot;:128,\&quot;post_count\&quot;:1174,\&quot;position\&quot;:1,\&quot;description\&quot;:\&quot;Bitcoin-related protocol proposals, or analysis or discussion thereof. For example, new P2P messages, new wallet techniques, methods for coinjoins or payment channels, etc.\&quot;,\&quot;description_text\&quot;:\&quot;Bitcoin-related protocol proposals, or analysis or discussion thereof. For example, new P2P messages, new wallet techniques, methods for coinjoins or payment channels, etc.\&quot;,\&quot;description_excerpt\&quot;:\&quot;Bitcoin-related protocol proposals, or analysis or discussion thereof. For example, new P2P messages, new wallet techniques, methods for coinjoins or payment channels, etc.\&quot;,\&quot;topic_url\&quot;:\&quot;/t/about-the-protocol-design-category/15\&quot;,\&quot;read_restricted\&quot;:false,\&quot;permission\&quot;:null,\&quot;notification_level\&quot;:1,\&quot;topic_template\&quot;:null,\&quot;has_children\&quot;:false,\&quot;subcategory_count\&quot;:null,\&quot;sort_order\&quot;:null,\&quot;sort_ascending\&quot;:null,\&quot;show_subcategory_list\&quot;:false,\&quot;num_featured_topics\&quot;:3,\&quot;default_view\&quot;:null,\&quot;subcategory_list_style\&quot;:\&quot;rows_with_featured_topics\&quot;,\&quot;default_top_period\&quot;:\&quot;all\&quot;,\&quot;default_list_filter\&quot;:\&quot;all\&quot;,\&quot;minimum_required_tags\&quot;:0,\&quot;navigate_to_first_post_after_read\&quot;:false,\&quot;custom_fields\&quot;:{\&quot;has_chat_enabled\&quot;:null},\&quot;allowed_tags\&quot;:[],\&quot;allowed_tag_groups\&quot;:[],\&quot;allow_global_tags\&quot;:false,\&quot;read_only_banner\&quot;:null,\&quot;form_template_ids\&quot;:[],\&quot;uploaded_logo\&quot;:null,\&quot;uploaded_logo_dark\&quot;:null,\&quot;uploaded_background\&quot;:null,\&quot;uploaded_background_dark\&quot;:null,\&quot;required_tag_groups\&quot;:[],\&quot;can_edit\&quot;:false},{\&quot;id\&quot;:6,\&quot;name\&quot;:\&quot;Economics\&quot;,\&quot;color\&quot;:\&quot;9EB83B\&quot;,\&quot;text_color\&quot;:\&quot;FFFFFF\&quot;,\&quot;slug\&quot;:\&quot;economics\&quot;,\&quot;topic_count\&quot;:2,\&quot;post_count\&quot;:9,\&quot;position\&quot;:2,\&quot;description\&quot;:\&quot;Discussions about the game theory of Bitcoin, or Bitcoin’s potential impact on macroeconomics, or other Bitcoin economic topics. Maths is welcome, politics not so much.\&quot;,\&quot;description_text\&quot;:\&quot;Discussions about the game theory of Bitcoin, or Bitcoin’s potential impact on macroeconomics, or other Bitcoin economic topics. Maths is welcome, politics not so much.\&quot;,\&quot;description_excerpt\&quot;:\&quot;Discussions about the game theory of Bitcoin, or Bitcoin’s potential impact on macroeconomics, or other Bitcoin economic topics. Maths is welcome, politics not so much.\&quot;,\&quot;topic_url\&quot;:\&quot;/t/about-the-economics-category/14\&quot;,\&quot;read_restricted\&quot;:false,\&quot;permission\&quot;:null,\&quot;notification_level\&quot;:1,\&quot;topic_template\&quot;:null,\&quot;has_children\&quot;:false,\&quot;subcategory_count\&quot;:null,\&quot;sort_order\&quot;:null,\&quot;sort_ascending\&quot;:null,\&quot;show_subcategory_list\&quot;:false,\&quot;num_featured_topics\&quot;:3,\&quot;default_view\&quot;:null,\&quot;subcategory_list_style\&quot;:\&quot;rows_with_featured_topics\&quot;,\&quot;default_top_period\&quot;:\&quot;all\&quot;,\&quot;default_list_filter\&quot;:\&quot;all\&quot;,\&quot;minimum_required_tags\&quot;:0,\&quot;navigate_to_first_post_after_read\&quot;:false,\&quot;custom_fields\&quot;:{\&quot;has_chat_enabled\&quot;:null},\&quot;allowed_tags\&quot;:[],\&quot;allowed_tag_groups\&quot;:[],\&quot;allow_global_tags\&quot;:false,\&quot;read_only_banner\&quot;:null,\&quot;form_template_ids\&quot;:[],\&quot;uploaded_logo\&quot;:null,\&quot;uploaded_logo_dark\&quot;:null,\&quot;uploaded_background\&quot;:null,\&quot;uploaded_background_dark\&quot;:null,\&quot;required_tag_groups\&quot;:[],\&quot;can_edit\&quot;:false},{\&quot;id\&quot;:5,\&quot;name\&quot;:\&quot;Philosophy\&quot;,\&quot;color\&quot;:\&quot;92278F\&quot;,\&quot;text_color\&quot;:\&quot;FFFFFF\&quot;,\&quot;slug\&quot;:\&quot;philosophy\&quot;,\&quot;topic_count\&quot;:9,\&quot;post_count\&quot;:106,\&quot;position\&quot;:3,\&quot;description\&quot;:\&quot;More philosophical discussion about Bitcoin. Why is decentralisation good? Should you prefer to work with anonymous people? When is it okay to use a custodial wallet?\&quot;,\&quot;description_text\&quot;:\&quot;More philosophical discussion about Bitcoin. Why is decentralisation good? Should you prefer to work with anonymous people? When is it okay to use a custodial wallet?\&quot;,\&quot;description_excerpt\&quot;:\&quot;More philosophical discussion about Bitcoin. Why is decentralisation good? Should you prefer to work with anonymous people? When is it okay to use a custodial wallet?\&quot;,\&quot;topic_url\&quot;:\&quot;/t/about-the-philosophy-category/13\&quot;,\&quot;read_restricted\&quot;:false,\&quot;permission\&quot;:null,\&quot;notification_level\&quot;:1,\&quot;topic_template\&quot;:null,\&quot;has_children\&quot;:false,\&quot;subcategory_count\&quot;:null,\&quot;sort_order\&quot;:null,\&quot;sort_ascending\&quot;:null,\&quot;show_subcategory_list\&quot;:false,\&quot;num_featured_topics\&quot;:3,\&quot;default_view\&quot;:null,\&quot;subcategory_list_style\&quot;:\&quot;rows_with_featured_topics\&quot;,\&quot;default_top_period\&quot;:\&quot;all\&quot;,\&quot;default_list_filter\&quot;:\&quot;all\&quot;,\&quot;minimum_required_tags\&quot;:0,\&quot;navigate_to_first_post_after_read\&quot;:false,\&quot;custom_fields\&quot;:{\&quot;has_chat_enabled\&quot;:null},\&quot;allowed_tags\&quot;:[],\&quot;allowed_tag_groups\&quot;:[],\&quot;allow_global_tags\&quot;:false,\&quot;read_only_banner\&quot;:null,\&quot;form_template_ids\&quot;:[],\&quot;uploaded_logo\&quot;:null,\&quot;uploaded_logo_dark\&quot;:null,\&quot;uploaded_background\&quot;:null,\&quot;uploaded_background_dark\&quot;:null,\&quot;required_tag_groups\&quot;:[],\&quot;can_edit\&quot;:false},{\&quot;id\&quot;:2,\&quot;name\&quot;:\&quot;Meta\&quot;,\&quot;color\&quot;:\&quot;808281\&quot;,\&quot;text_color\&quot;:\&quot;FFFFFF\&quot;,\&quot;slug\&quot;:\&quot;meta\&quot;,\&quot;topic_count\&quot;:19,\&quot;post_count\&quot;:79,\&quot;position\&quot;:4,\&quot;description\&quot;:\&quot;\\u003cp\\u003eDiscussion about this site, its organization, how it works, and how we can improve it.\\u003c/p\\u003e\&quot;,\&quot;description_text\&quot;:\&quot;Discussion about this site, its organization, how it works, and how we can improve it.\&quot;,\&quot;description_excerpt\&quot;:\&quot;Discussion about this site, its organization, how it works, and how we can improve it.\&quot;,\&quot;topic_url\&quot;:\&quot;/t/about-the-meta-category/1\&quot;,\&quot;read_restricted\&quot;:false,\&quot;permission\&quot;:null,\&quot;notification_level\&quot;:1,\&quot;topic_template\&quot;:null,\&quot;has_children\&quot;:false,\&quot;subcategory_count\&quot;:null,\&quot;sort_order\&quot;:null,\&quot;sort_ascending\&quot;:null,\&quot;show_subcategory_list\&quot;:false,\&quot;num_featured_topics\&quot;:3,\&quot;default_view\&quot;:null,\&quot;subcategory_list_style\&quot;:\&quot;rows_with_featured_topics\&quot;,\&quot;default_top_period\&quot;:\&quot;all\&quot;,\&quot;default_list_filter\&quot;:\&quot;all\&quot;,\&quot;minimum_required_tags\&quot;:0,\&quot;navigate_to_first_post_after_read\&quot;:false,\&quot;custom_fields\&quot;:{\&quot;has_chat_enabled\&quot;:null},\&quot;allowed_tags\&quot;:[],\&quot;allowed_tag_groups\&quot;:[],\&quot;allow_global_tags\&quot;:false,\&quot;read_only_banner\&quot;:null,\&quot;form_template_ids\&quot;:[],\&quot;uploaded_logo\&quot;:null,\&quot;uploaded_logo_dark\&quot;:null,\&quot;uploaded_background\&quot;:null,\&quot;uploaded_background_dark\&quot;:null,\&quot;required_tag_groups\&quot;:[],\&quot;can_edit\&quot;:false},{\&quot;id\&quot;:1,\&quot;name\&quot;:\&quot;Uncategorized\&quot;,\&quot;color\&quot;:\&quot;0088CC\&quot;,\&quot;text_color\&quot;:\&quot;FFFFFF\&quot;,\&quot;slug\&quot;:\&quot;uncategorized\&quot;,\&quot;topic_count\&quot;:0,\&quot;post_count\&quot;:0,\&quot;position\&quot;:7,\&quot;description\&quot;:\&quot;Topics that don&#39;t need a category, or don&#39;t fit into any other existing category.\&quot;,\&quot;description_text\&quot;:\&quot;Topics that don&#39;t need a category, or don&#39;t fit into any other existing category.\&quot;,\&quot;description_excerpt\&quot;:\&quot;Topics that don&#39;t need a category, or don&#39;t fit into any other existing category.\&quot;,\&quot;topic_url\&quot;:\&quot;/t/\&quot;,\&quot;read_restricted\&quot;:false,\&quot;permission\&quot;:null,\&quot;notification_level\&quot;:1,\&quot;topic_template\&quot;:null,\&quot;has_children\&quot;:false,\&quot;subcategory_count\&quot;:null,\&quot;sort_order\&quot;:null,\&quot;sort_ascending\&quot;:null,\&quot;show_subcategory_list\&quot;:false,\&quot;num_featured_topics\&quot;:3,\&quot;default_view\&quot;:null,\&quot;subcategory_list_style\&quot;:\&quot;rows_with_featured_topics\&quot;,\&quot;default_top_period\&quot;:\&quot;all\&quot;,\&quot;default_list_filter\&quot;:\&quot;all\&quot;,\&quot;minimum_required_tags\&quot;:0,\&quot;navigate_to_first_post_after_read\&quot;:false,\&quot;custom_fields\&quot;:{\&quot;has_chat_enabled\&quot;:null},\&quot;allowed_tags\&quot;:[],\&quot;allowed_tag_groups\&quot;:[],\&quot;allow_global_tags\&quot;:false,\&quot;read_only_banner\&quot;:null,\&quot;form_template_ids\&quot;:[],\&quot;uploaded_logo\&quot;:null,\&quot;uploaded_logo_dark\&quot;:null,\&quot;uploaded_background\&quot;:null,\&quot;uploaded_background_dark\&quot;:null,\&quot;required_tag_groups\&quot;:[],\&quot;can_edit\&quot;:false},{\&quot;id\&quot;:9,\&quot;name\&quot;:\&quot;wg-cluster-mempool\&quot;,\&quot;color\&quot;:\&quot;0088CC\&quot;,\&quot;text_color\&quot;:\&quot;FFFFFF\&quot;,\&quot;slug\&quot;:\&quot;wg-cluster-mempool\&quot;,\&quot;topic_count\&quot;:0,\&quot;post_count\&quot;:0,\&quot;position\&quot;:8,\&quot;description\&quot;:\&quot;Posts have been moved into the \\u003ca class=\\\&quot;hashtag-cooked\\\&quot; href=\\\&quot;/c/implementation/8\\\&quot; data-type=\\\&quot;category\\\&quot; data-slug=\\\&quot;implementation\\\&quot; data-id=\\\&quot;8\\\&quot;\\u003e\\u003cspan class=\\\&quot;hashtag-icon-placeholder\\\&quot;\\u003e\\u003csvg class=\\\&quot;fa d-icon d-icon-square-full svg-icon svg-node\\\&quot;\\u003e\\u003cuse href=\\\&quot;#square-full\\\&quot;\\u003e\\u003c/use\\u003e\\u003c/svg\\u003e\\u003c/span\\u003e\\u003cspan\\u003eImplementation\\u003c/span\\u003e\\u003c/a\\u003e category under the tag \\u003ca class=\\\&quot;hashtag-cooked\\\&quot; href=\\\&quot;/tag/wg-cluster-mempool\\\&quot; data-type=\\\&quot;tag\\\&quot; data-slug=\\\&quot;wg-cluster-mempool\\\&quot; data-id=\\\&quot;15\\\&quot; data-ref=\\\&quot;wg-cluster-mempool::tag\\\&quot;\\u003e\\u003cspan class=\\\&quot;hashtag-icon-placeholder\\\&quot;\\u003e\\u003csvg class=\\\&quot;fa d-icon d-icon-square-full svg-icon svg-node\\\&quot;\\u003e\\u003cuse href=\\\&quot;#square-full\\\&quot;\\u003e\\u003c/use\\u003e\\u003c/svg\\u003e\\u003c/span\\u003e\\u003cspan\\u003ewg-cluster-mempool\\u003c/span\\u003e\\u003c/a\\u003e\&quot;,\&quot;description_text\&quot;:\&quot;Posts have been moved into the Implementation category under the tag wg-cluster-mempool\&quot;,\&quot;description_excerpt\&quot;:\&quot;Posts have been moved into the \\u003ca class=\\\&quot;hashtag-cooked\\\&quot; href=\\\&quot;/c/implementation/8\\\&quot; data-type=\\\&quot;category\\\&quot; data-slug=\\\&quot;implementation\\\&quot; data-id=\\\&quot;8\\\&quot;\\u003e\\u003cspan class=\\\&quot;hashtag-icon-placeholder\\\&quot;\\u003e\\u003c/span\\u003eImplementation\\u003c/span\\u003e\\u003c/a\\u003e category under the tag \\u003ca class=\\\&quot;hashtag-cooked\\\&quot; href=\\\&quot;/tag/wg-cluster-mempool\\\&quot; data-type=\\\&quot;tag\\\&quot; data-slug=\\\&quot;wg-cluster-mempool\\\&quot; data-id=\\\&quot;15\\\&quot; data-ref=\\\&quot;wg-cluster-mempool::tag\\\&quot;\\u003e\\u003cspan class=\\\&quot;hashtag-icon-placeholder\\\&quot;\\u003e\\u003c/span\\u003ewg-cluster-mempool\\u003c/span\\u003e\\u003c/a\\u003e\&quot;,\&quot;topic_url\&quot;:\&quot;/t/about-the-wg-cluster-mempool-category/155\&quot;,\&quot;read_restricted\&quot;:false,\&quot;permission\&quot;:null,\&quot;parent_category_id\&quot;:8,\&quot;notification_level\&quot;:1,\&quot;topic_template\&quot;:null,\&quot;has_children\&quot;:false,\&quot;subcategory_count\&quot;:null,\&quot;sort_order\&quot;:null,\&quot;sort_ascending\&quot;:null,\&quot;show_subcategory_list\&quot;:false,\&quot;num_featured_topics\&quot;:3,\&quot;default_view\&quot;:null,\&quot;subcategory_list_style\&quot;:\&quot;rows_with_featured_topics\&quot;,\&quot;default_top_period\&quot;:\&quot;all\&quot;,\&quot;default_list_filter\&quot;:\&quot;all\&quot;,\&quot;minimum_required_tags\&quot;:0,\&quot;navigate_to_first_post_after_read\&quot;:false,\&quot;custom_fields\&quot;:{\&quot;has_chat_enabled\&quot;:null},\&quot;allowed_tags\&quot;:[],\&quot;allowed_tag_groups\&quot;:[],\&quot;allow_global_tags\&quot;:false,\&quot;read_only_banner\&quot;:null,\&quot;form_template_ids\&quot;:[],\&quot;uploaded_logo\&quot;:null,\&quot;uploaded_logo_dark\&quot;:null,\&quot;uploaded_background\&quot;:null,\&quot;uploaded_background_dark\&quot;:null,\&quot;required_tag_groups\&quot;:[],\&quot;can_edit\&quot;:false},{\&quot;id\&quot;:10,\&quot;name\&quot;:\&quot;wg-blockrelay\&quot;,\&quot;color\&quot;:\&quot;0088CC\&quot;,\&quot;text_color\&quot;:\&quot;FFFFFF\&quot;,\&quot;slug\&quot;:\&quot;wg-blockrelay\&quot;,\&quot;topic_count\&quot;:3,\&quot;post_count\&quot;:8,\&quot;position\&quot;:9,\&quot;description\&quot;:\&quot;discussion around resource usage on the bitcoin p2p network.\&quot;,\&quot;description_text\&quot;:\&quot;discussion around resource usage on the bitcoin p2p network.\&quot;,\&quot;description_excerpt\&quot;:\&quot;discussion around resource usage on the bitcoin p2p network.\&quot;,\&quot;topic_url\&quot;:\&quot;/t/about-the-wg-blockrelay-category/176\&quot;,\&quot;read_restricted\&quot;:false,\&quot;permission\&quot;:null,\&quot;parent_category_id\&quot;:8,\&quot;notification_level\&quot;:1,\&quot;topic_template\&quot;:null,\&quot;has_children\&quot;:false,\&quot;subcategory_count\&quot;:null,\&quot;sort_order\&quot;:null,\&quot;sort_ascending\&quot;:null,\&quot;show_subcategory_list\&quot;:false,\&quot;num_featured_topics\&quot;:3,\&quot;default_view\&quot;:null,\&quot;subcategory_list_style\&quot;:\&quot;rows_with_featured_topics\&quot;,\&quot;default_top_period\&quot;:\&quot;all\&quot;,\&quot;default_list_filter\&quot;:\&quot;all\&quot;,\&quot;minimum_required_tags\&quot;:0,\&quot;navigate_to_first_post_after_read\&quot;:false,\&quot;custom_fields\&quot;:{\&quot;has_chat_enabled\&quot;:null},\&quot;allowed_tags\&quot;:[],\&quot;allowed_tag_groups\&quot;:[],\&quot;allow_global_tags\&quot;:false,\&quot;read_only_banner\&quot;:null,\&quot;form_template_ids\&quot;:[],\&quot;uploaded_logo\&quot;:null,\&quot;uploaded_logo_dark\&quot;:null,\&quot;uploaded_background\&quot;:null,\&quot;uploaded_background_dark\&quot;:null,\&quot;required_tag_groups\&quot;:[],\&quot;can_edit\&quot;:false},{\&quot;id\&quot;:12,\&quot;name\&quot;:\&quot;wg-silent-payments\&quot;,\&quot;color\&quot;:\&quot;ED207B\&quot;,\&quot;text_color\&quot;:\&quot;FFFFFF\&quot;,\&quot;slug\&quot;:\&quot;wg-silent-payments\&quot;,\&quot;topic_count\&quot;:2,\&quot;post_count\&quot;:44,\&quot;position\&quot;:11,\&quot;description\&quot;:\&quot;Category for discussing BIP352 wallet support, ranging from protocol updates to implementation details.\&quot;,\&quot;description_text\&quot;:\&quot;Category for discussing BIP352 wallet support, ranging from protocol updates to implementation details.\&quot;,\&quot;description_excerpt\&quot;:\&quot;Category for discussing BIP352 wallet support, ranging from protocol updates to implementation details.\&quot;,\&quot;topic_url\&quot;:\&quot;/t/about-the-wg-silent-payments-category/876\&quot;,\&quot;read_restricted\&quot;:false,\&quot;permission\&quot;:null,\&quot;parent_category_id\&quot;:8,\&quot;notification_level\&quot;:1,\&quot;topic_template\&quot;:null,\&quot;has_children\&quot;:false,\&quot;subcategory_count\&quot;:null,\&quot;sort_order\&quot;:null,\&quot;sort_ascending\&quot;:null,\&quot;show_subcategory_list\&quot;:false,\&quot;num_featured_topics\&quot;:3,\&quot;default_view\&quot;:null,\&quot;subcategory_list_style\&quot;:\&quot;rows_with_featured_topics\&quot;,\&quot;default_top_period\&quot;:\&quot;all\&quot;,\&quot;default_list_filter\&quot;:\&quot;all\&quot;,\&quot;minimum_required_tags\&quot;:0,\&quot;navigate_to_first_post_after_read\&quot;:false,\&quot;custom_fields\&quot;:{\&quot;has_chat_enabled\&quot;:null},\&quot;allowed_tags\&quot;:[],\&quot;allowed_tag_groups\&quot;:[],\&quot;allow_global_tags\&quot;:false,\&quot;read_only_banner\&quot;:null,\&quot;form_template_ids\&quot;:[],\&quot;uploaded_logo\&quot;:null,\&quot;uploaded_logo_dark\&quot;:null,\&quot;uploaded_background\&quot;:null,\&quot;uploaded_background_dark\&quot;:null,\&quot;required_tag_groups\&quot;:[],\&quot;can_edit\&quot;:false}],\&quot;markdown_additional_options\&quot;:{\&quot;chat\&quot;:{\&quot;limited_pretty_text_features\&quot;:[\&quot;anchor\&quot;,\&quot;bbcode-block\&quot;,\&quot;bbcode-inline\&quot;,\&quot;code\&quot;,\&quot;category-hashtag\&quot;,\&quot;censored\&quot;,\&quot;chat-transcript\&quot;,\&quot;discourse-local-dates\&quot;,\&quot;emoji\&quot;,\&quot;emojiShortcuts\&quot;,\&quot;inlineEmoji\&quot;,\&quot;html-img\&quot;,\&quot;hashtag-autocomplete\&quot;,\&quot;mentions\&quot;,\&quot;unicodeUsernames\&quot;,\&quot;onebox\&quot;,\&quot;quotes\&quot;,\&quot;spoiler-alert\&quot;,\&quot;table\&quot;,\&quot;text-post-process\&quot;,\&quot;upload-protocol\&quot;,\&quot;watched-words\&quot;,\&quot;chat-html-inline\&quot;],\&quot;limited_pretty_text_markdown_rules\&quot;:[\&quot;autolink\&quot;,\&quot;list\&quot;,\&quot;backticks\&quot;,\&quot;newline\&quot;,\&quot;code\&quot;,\&quot;fence\&quot;,\&quot;image\&quot;,\&quot;table\&quot;,\&quot;linkify\&quot;,\&quot;link\&quot;,\&quot;strikethrough\&quot;,\&quot;blockquote\&quot;,\&quot;emphasis\&quot;,\&quot;replacements\&quot;,\&quot;escape\&quot;],\&quot;hashtag_configurations\&quot;:{\&quot;topic-composer\&quot;:[\&quot;category\&quot;,\&quot;tag\&quot;]}}},\&quot;hashtag_configurations\&quot;:{\&quot;topic-composer\&quot;:[\&quot;category\&quot;,\&quot;tag\&quot;]},\&quot;hashtag_icons\&quot;:{\&quot;category\&quot;:\&quot;folder\&quot;,\&quot;tag\&quot;:\&quot;tag\&quot;},\&quot;anonymous_sidebar_sections\&quot;:[{\&quot;id\&quot;:1,\&quot;title\&quot;:\&quot;Community\&quot;,\&quot;links\&quot;:[{\&quot;id\&quot;:1,\&quot;name\&quot;:\&quot;Topics\&quot;,\&quot;value\&quot;:\&quot;/latest\&quot;,\&quot;icon\&quot;:\&quot;layer-group\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;primary\&quot;},{\&quot;id\&quot;:2,\&quot;name\&quot;:\&quot;My Posts\&quot;,\&quot;value\&quot;:\&quot;/my/activity\&quot;,\&quot;icon\&quot;:\&quot;user\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;primary\&quot;},{\&quot;id\&quot;:3,\&quot;name\&quot;:\&quot;Review\&quot;,\&quot;value\&quot;:\&quot;/review\&quot;,\&quot;icon\&quot;:\&quot;flag\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;primary\&quot;},{\&quot;id\&quot;:4,\&quot;name\&quot;:\&quot;Admin\&quot;,\&quot;value\&quot;:\&quot;/admin\&quot;,\&quot;icon\&quot;:\&quot;wrench\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;primary\&quot;},{\&quot;id\&quot;:12,\&quot;name\&quot;:\&quot;Invite\&quot;,\&quot;value\&quot;:\&quot;/new-invite\&quot;,\&quot;icon\&quot;:\&quot;paper-plane\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;primary\&quot;},{\&quot;id\&quot;:5,\&quot;name\&quot;:\&quot;Users\&quot;,\&quot;value\&quot;:\&quot;/u\&quot;,\&quot;icon\&quot;:\&quot;users\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;secondary\&quot;},{\&quot;id\&quot;:6,\&quot;name\&quot;:\&quot;About\&quot;,\&quot;value\&quot;:\&quot;/about\&quot;,\&quot;icon\&quot;:\&quot;circle-info\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;secondary\&quot;},{\&quot;id\&quot;:7,\&quot;name\&quot;:\&quot;FAQ\&quot;,\&quot;value\&quot;:\&quot;/faq\&quot;,\&quot;icon\&quot;:\&quot;circle-question\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;secondary\&quot;},{\&quot;id\&quot;:8,\&quot;name\&quot;:\&quot;Groups\&quot;,\&quot;value\&quot;:\&quot;/g\&quot;,\&quot;icon\&quot;:\&quot;user-group\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;secondary\&quot;},{\&quot;id\&quot;:9,\&quot;name\&quot;:\&quot;Badges\&quot;,\&quot;value\&quot;:\&quot;/badges\&quot;,\&quot;icon\&quot;:\&quot;certificate\&quot;,\&quot;external\&quot;:false,\&quot;segment\&quot;:\&quot;secondary\&quot;}],\&quot;slug\&quot;:\&quot;community\&quot;,\&quot;public\&quot;:true,\&quot;section_type\&quot;:\&quot;community\&quot;}],\&quot;tos_url\&quot;:\&quot;/tos\&quot;,\&quot;privacy_policy_url\&quot;:\&quot;/privacy\&quot;,\&quot;archetypes\&quot;:[{\&quot;id\&quot;:\&quot;regular\&quot;,\&quot;name\&quot;:\&quot;Regular Topic\&quot;,\&quot;options\&quot;:[]},{\&quot;id\&quot;:\&quot;banner\&quot;,\&quot;name\&quot;:\&quot;Banner Topic\&quot;,\&quot;options\&quot;:[]}],\&quot;user_fields\&quot;:[],\&quot;auth_providers\&quot;:[{\&quot;name\&quot;:\&quot;github\&quot;,\&quot;custom_url\&quot;:null,\&quot;pretty_name_override\&quot;:null,\&quot;title_override\&quot;:null,\&quot;frame_width\&quot;:null,\&quot;frame_height\&quot;:null,\&quot;can_connect\&quot;:true,\&quot;can_revoke\&quot;:true,\&quot;icon\&quot;:\&quot;fab-github\&quot;}]}&quot;,&quot;siteSettings&quot;:&quot;{\&quot;default_locale\&quot;:\&quot;en\&quot;,\&quot;title\&quot;:\&quot;Delving Bitcoin\&quot;,\&quot;short_site_description\&quot;:\&quot;\&quot;,\&quot;exclude_rel_nofollow_domains\&quot;:\&quot;\&quot;,\&quot;logo\&quot;:\&quot;\&quot;,\&quot;logo_small\&quot;:\&quot;/uploads/default/original/1X/863d31b22a9d4d4072777bffb9b9ded86a1638bc.svg\&quot;,\&quot;digest_logo\&quot;:\&quot;\&quot;,\&quot;mobile_logo\&quot;:\&quot;\&quot;,\&quot;logo_dark\&quot;:\&quot;\&quot;,\&quot;logo_small_dark\&quot;:\&quot;\&quot;,\&quot;mobile_logo_dark\&quot;:\&quot;\&quot;,\&quot;large_icon\&quot;:\&quot;\&quot;,\&quot;favicon\&quot;:\&quot;\&quot;,\&quot;apple_touch_icon\&quot;:\&quot;\&quot;,\&quot;display_local_time_in_user_card\&quot;:true,\&quot;allow_user_locale\&quot;:false,\&quot;set_locale_from_accept_language_header\&quot;:false,\&quot;set_locale_from_cookie\&quot;:false,\&quot;support_mixed_text_direction\&quot;:false,\&quot;suggested_topics\&quot;:5,\&quot;ga_universal_tracking_code\&quot;:\&quot;\&quot;,\&quot;ga_universal_domain_name\&quot;:\&quot;auto\&quot;,\&quot;gtm_container_id\&quot;:\&quot;\&quot;,\&quot;top_menu\&quot;:\&quot;categories|latest|new|unread|top\&quot;,\&quot;post_menu\&quot;:\&quot;read|like|copyLink|flag|edit|bookmark|delete|admin|reply\&quot;,\&quot;post_menu_hidden_items\&quot;:\&quot;flag|bookmark|edit|delete|admin\&quot;,\&quot;share_links\&quot;:\&quot;twitter|facebook|email\&quot;,\&quot;allow_username_in_share_links\&quot;:true,\&quot;share_quote_visibility\&quot;:\&quot;all\&quot;,\&quot;share_quote_buttons\&quot;:\&quot;twitter|email\&quot;,\&quot;desktop_category_page_style\&quot;:\&quot;categories_and_latest_topics\&quot;,\&quot;category_colors\&quot;:\&quot;BF1E2E|F1592A|F7941D|9EB83B|3AB54A|12A89D|25AAE2|0E76BD|652D90|92278F|ED207B|8C6238|231F20|808281|B3B5B4|E45735\&quot;,\&quot;max_category_nesting\&quot;:2,\&quot;enable_mobile_theme\&quot;:true,\&quot;enable_direct_s3_uploads\&quot;:false,\&quot;enable_upload_debug_mode\&quot;:false,\&quot;default_dark_mode_color_scheme_id\&quot;:1,\&quot;relative_date_duration\&quot;:30,\&quot;top_page_default_timeframe\&quot;:\&quot;yearly\&quot;,\&quot;fixed_category_positions\&quot;:true,\&quot;fixed_category_positions_on_create\&quot;:false,\&quot;enable_badges\&quot;:true,\&quot;show_badges_in_post_header\&quot;:true,\&quot;enable_badge_sql\&quot;:false,\&quot;max_favorite_badges\&quot;:2,\&quot;push_notifications_prompt\&quot;:true,\&quot;enable_desktop_push_notifications\&quot;:true,\&quot;vapid_public_key_bytes\&quot;:\&quot;4|247|84|181|141|4|98|177|118|122|184|128|215|203|140|55|223|55|53|29|151|190|194|169|233|155|230|55|222|240|62|109|238|39|214|5|198|44|147|174|132|232|239|44|0|108|153|82|112|213|148|115|226|180|205|43|108|137|114|88|188|241|150|142|129\&quot;,\&quot;enable_user_tips\&quot;:true,\&quot;page_loading_indicator\&quot;:\&quot;slider\&quot;,\&quot;show_user_menu_avatars\&quot;:false,\&quot;use_legacy_pageviews\&quot;:false,\&quot;invite_only\&quot;:false,\&quot;login_required\&quot;:false,\&quot;must_approve_users\&quot;:false,\&quot;enable_local_logins\&quot;:true,\&quot;enable_local_logins_via_email\&quot;:true,\&quot;enable_passkeys\&quot;:true,\&quot;allow_new_registrations\&quot;:true,\&quot;enable_signup_cta\&quot;:true,\&quot;facebook_app_id\&quot;:\&quot;\&quot;,\&quot;auth_skip_create_confirm\&quot;:false,\&quot;auth_overrides_email\&quot;:false,\&quot;enable_discourse_connect\&quot;:false,\&quot;discourse_connect_overrides_avatar\&quot;:false,\&quot;hide_email_address_taken\&quot;:true,\&quot;full_page_login\&quot;:false,\&quot;show_signup_form_email_instructions\&quot;:true,\&quot;show_signup_form_username_instructions\&quot;:false,\&quot;show_signup_form_full_name_instructions\&quot;:false,\&quot;show_signup_form_password_instructions\&quot;:false,\&quot;min_username_length\&quot;:3,\&quot;max_username_length\&quot;:20,\&quot;unicode_usernames\&quot;:false,\&quot;min_password_length\&quot;:10,\&quot;min_admin_password_length\&quot;:15,\&quot;email_editable\&quot;:true,\&quot;logout_redirect\&quot;:\&quot;\&quot;,\&quot;full_name_required\&quot;:false,\&quot;enable_names\&quot;:true,\&quot;invite_expiry_days\&quot;:14,\&quot;invites_per_page\&quot;:40,\&quot;delete_user_max_post_age\&quot;:60,\&quot;delete_all_posts_max\&quot;:15,\&quot;prioritize_username_in_ux\&quot;:true,\&quot;enable_user_directory\&quot;:true,\&quot;allow_anonymous_posting\&quot;:false,\&quot;allow_anonymous_likes\&quot;:false,\&quot;anonymous_posting_min_trust_level\&quot;:1,\&quot;allow_users_to_hide_profile\&quot;:true,\&quot;hide_user_profiles_from_public\&quot;:false,\&quot;allow_featured_topic_on_user_profiles\&quot;:true,\&quot;hide_suspension_reasons\&quot;:false,\&quot;ignored_users_count_message_threshold\&quot;:5,\&quot;ignored_users_message_gap_days\&quot;:365,\&quot;user_selected_primary_groups\&quot;:false,\&quot;gravatar_name\&quot;:\&quot;Gravatar\&quot;,\&quot;gravatar_base_url\&quot;:\&quot;www.gravatar.com\&quot;,\&quot;gravatar_login_url\&quot;:\&quot;/emails\&quot;,\&quot;hide_user_activity_tab\&quot;:false,\&quot;enable_user_status\&quot;:false,\&quot;enable_group_directory\&quot;:true,\&quot;enable_category_group_moderation\&quot;:true,\&quot;min_post_length\&quot;:20,\&quot;min_first_post_length\&quot;:20,\&quot;min_personal_message_post_length\&quot;:10,\&quot;max_post_length\&quot;:150000,\&quot;topic_featured_link_enabled\&quot;:true,\&quot;min_topic_views_for_delete_confirm\&quot;:5000,\&quot;min_topic_title_length\&quot;:15,\&quot;max_topic_title_length\&quot;:255,\&quot;enable_filtered_replies_view\&quot;:false,\&quot;min_personal_message_title_length\&quot;:2,\&quot;allow_uncategorized_topics\&quot;:false,\&quot;min_title_similar_length\&quot;:10,\&quot;edit_history_visible_to_public\&quot;:true,\&quot;delete_removed_posts_after\&quot;:24,\&quot;traditional_markdown_linebreaks\&quot;:true,\&quot;enable_markdown_typographer\&quot;:true,\&quot;enable_markdown_linkify\&quot;:true,\&quot;markdown_linkify_tlds\&quot;:\&quot;com|net|org|io|onion|co|tv|ru|cn|us|uk|me|de|fr|fi|gov\&quot;,\&quot;markdown_typographer_quotation_marks\&quot;:\&quot;“|”|‘|’\&quot;,\&quot;suppress_reply_directly_below\&quot;:true,\&quot;suppress_reply_directly_above\&quot;:true,\&quot;max_reply_history\&quot;:1,\&quot;enable_mentions\&quot;:true,\&quot;max_users_notified_per_group_mention\&quot;:100,\&quot;here_mention\&quot;:\&quot;here\&quot;,\&quot;newuser_max_embedded_media\&quot;:1,\&quot;newuser_max_attachments\&quot;:0,\&quot;default_subcategory_on_read_only_category\&quot;:false,\&quot;show_pinned_excerpt_mobile\&quot;:true,\&quot;show_pinned_excerpt_desktop\&quot;:true,\&quot;display_name_on_posts\&quot;:false,\&quot;show_time_gap_days\&quot;:7,\&quot;short_progress_text_threshold\&quot;:10000,\&quot;default_code_lang\&quot;:\&quot;auto\&quot;,\&quot;autohighlight_all_code\&quot;:false,\&quot;highlighted_languages\&quot;:\&quot;bash|c|cpp|csharp|css|diff|go|graphql|ini|java|javascript|json|kotlin|lua|makefile|markdown|objectivec|perl|php|php-template|plaintext|python|python-repl|r|ruby|rust|scss|shell|sql|swift|typescript|xml|yaml|wasm\&quot;,\&quot;show_copy_button_on_codeblocks\&quot;:true,\&quot;enable_emoji\&quot;:true,\&quot;enable_emoji_shortcuts\&quot;:true,\&quot;emoji_set\&quot;:\&quot;twitter\&quot;,\&quot;emoji_autocomplete_min_chars\&quot;:0,\&quot;enable_inline_emoji_translation\&quot;:false,\&quot;emoji_deny_list\&quot;:\&quot;\&quot;,\&quot;code_formatting_style\&quot;:\&quot;code-fences\&quot;,\&quot;allowed_href_schemes\&quot;:\&quot;\&quot;,\&quot;watched_words_regular_expressions\&quot;:false,\&quot;enable_diffhtml_preview\&quot;:false,\&quot;enable_fast_edit\&quot;:true,\&quot;enable_quote_copy\&quot;:true,\&quot;old_post_notice_days\&quot;:14,\&quot;blur_tl0_flagged_posts_media\&quot;:true,\&quot;email_time_window_mins\&quot;:10,\&quot;disable_digest_emails\&quot;:false,\&quot;email_in\&quot;:false,\&quot;enable_imap\&quot;:false,\&quot;enable_smtp\&quot;:false,\&quot;disable_emails\&quot;:\&quot;no\&quot;,\&quot;bounce_score_threshold\&quot;:4,\&quot;enable_secondary_emails\&quot;:true,\&quot;max_image_size_kb\&quot;:5120,\&quot;max_attachment_size_kb\&quot;:5120,\&quot;authorized_extensions\&quot;:\&quot;jpg|jpeg|png|gif|heic|heif|webp|avif\&quot;,\&quot;authorized_extensions_for_staff\&quot;:\&quot;\&quot;,\&quot;max_image_width\&quot;:690,\&quot;max_image_height\&quot;:500,\&quot;prevent_anons_from_downloading_files\&quot;:false,\&quot;secure_uploads\&quot;:false,\&quot;secure_uploads_pm_only\&quot;:false,\&quot;enable_s3_uploads\&quot;:false,\&quot;allow_profile_backgrounds\&quot;:true,\&quot;allow_uploaded_avatars\&quot;:0,\&quot;default_avatars\&quot;:\&quot;\&quot;,\&quot;avatar_sizes\&quot;:\&quot;24|48|72|96|144|288\&quot;,\&quot;external_system_avatars_enabled\&quot;:true,\&quot;external_system_avatars_url\&quot;:\&quot;/letter_avatar_proxy/v4/letter/{first_letter}/{color}/{size}.png\&quot;,\&quot;external_emoji_url\&quot;:\&quot;\&quot;,\&quot;selectable_avatars_mode\&quot;:\&quot;disabled\&quot;,\&quot;selectable_avatars\&quot;:\&quot;\&quot;,\&quot;allow_staff_to_upload_any_file_in_pm\&quot;:true,\&quot;simultaneous_uploads\&quot;:5,\&quot;composer_media_optimization_image_enabled\&quot;:true,\&quot;composer_media_optimization_image_bytes_optimization_threshold\&quot;:524288,\&quot;composer_media_optimization_image_resize_dimensions_threshold\&quot;:1920,\&quot;composer_media_optimization_image_resize_width_target\&quot;:1920,\&quot;composer_media_optimization_image_resize_pre_multiply\&quot;:false,\&quot;composer_media_optimization_image_resize_linear_rgb\&quot;:false,\&quot;composer_media_optimization_image_encode_quality\&quot;:75,\&quot;composer_media_optimization_debug_mode\&quot;:false,\&quot;composer_ios_media_optimisation_image_enabled\&quot;:false,\&quot;video_thumbnails_enabled\&quot;:true,\&quot;min_trust_level_to_allow_profile_background\&quot;:1,\&quot;min_trust_level_to_allow_user_card_background\&quot;:1,\&quot;min_trust_level_to_allow_ignore\&quot;:2,\&quot;tl1_requires_read_posts\&quot;:30,\&quot;tl3_links_no_follow\&quot;:false,\&quot;tl4_delete_posts_and_topics\&quot;:4,\&quot;enforce_second_factor_on_external_auth\&quot;:true,\&quot;enforce_second_factor\&quot;:\&quot;no\&quot;,\&quot;moderators_manage_categories_and_groups\&quot;:true,\&quot;moderators_change_post_ownership\&quot;:false,\&quot;moderators_view_emails\&quot;:false,\&quot;use_admin_ip_allowlist\&quot;:false,\&quot;allowed_iframes\&quot;:\&quot;https://www.google.com/maps/embed?|https://www.openstreetmap.org/export/embed.html?|https://calendar.google.com/calendar/embed?|https://codepen.io/|https://www.instagram.com/|https://delvingbitcoin.org/discobot/certificate.svg\&quot;,\&quot;can_permanently_delete\&quot;:false,\&quot;max_oneboxes_per_post\&quot;:50,\&quot;reviewable_claiming\&quot;:\&quot;disabled\&quot;,\&quot;reviewable_default_topics\&quot;:false,\&quot;reviewable_default_visibility\&quot;:\&quot;low\&quot;,\&quot;reviewable_revision_reasons\&quot;:\&quot;Duplicate|Does not meet posting guidelines\&quot;,\&quot;alert_admins_if_errors_per_minute\&quot;:0,\&quot;alert_admins_if_errors_per_hour\&quot;:0,\&quot;max_prints_per_hour_per_user\&quot;:5,\&quot;invite_link_max_redemptions_limit\&quot;:5000,\&quot;invite_link_max_redemptions_limit_users\&quot;:10,\&quot;max_allowed_secondary_emails\&quot;:10,\&quot;enable_chunked_encoding\&quot;:true,\&quot;long_polling_base_url\&quot;:\&quot;/\&quot;,\&quot;background_polling_interval\&quot;:60000,\&quot;polling_interval\&quot;:3000,\&quot;anon_polling_interval\&quot;:25000,\&quot;flush_timings_secs\&quot;:60,\&quot;verbose_localization\&quot;:false,\&quot;max_new_topics\&quot;:500,\&quot;enable_safe_mode\&quot;:true,\&quot;warn_critical_js_deprecations\&quot;:true,\&quot;warn_critical_js_deprecations_message\&quot;:\&quot;\&quot;,\&quot;custom_flags_limit\&quot;:50,\&quot;navigation_menu\&quot;:\&quot;sidebar\&quot;,\&quot;default_navigation_menu_categories\&quot;:\&quot;\&quot;,\&quot;default_navigation_menu_tags\&quot;:\&quot;\&quot;,\&quot;default_sidebar_switch_panel_position\&quot;:\&quot;bottom\&quot;,\&quot;tos_url\&quot;:\&quot;\&quot;,\&quot;privacy_policy_url\&quot;:\&quot;\&quot;,\&quot;faq_url\&quot;:\&quot;\&quot;,\&quot;display_eu_visitor_stats\&quot;:false,\&quot;enable_backups\&quot;:true,\&quot;backup_location\&quot;:\&quot;local\&quot;,\&quot;maximum_backups\&quot;:12,\&quot;remove_older_backups\&quot;:\&quot;\&quot;,\&quot;include_s3_uploads_in_backups\&quot;:false,\&quot;use_pg_headlines_for_excerpt\&quot;:false,\&quot;min_search_term_length\&quot;:3,\&quot;log_search_queries\&quot;:true,\&quot;search_default_sort_order\&quot;:0,\&quot;version_checks\&quot;:true,\&quot;suppress_uncategorized_badge\&quot;:true,\&quot;header_dropdown_category_count\&quot;:8,\&quot;slug_generation_method\&quot;:\&quot;ascii\&quot;,\&quot;summary_timeline_button\&quot;:false,\&quot;topic_views_heat_low\&quot;:1000,\&quot;topic_views_heat_medium\&quot;:2000,\&quot;topic_views_heat_high\&quot;:3500,\&quot;topic_post_like_heat_low\&quot;:0.6,\&quot;topic_post_like_heat_medium\&quot;:1.0,\&quot;topic_post_like_heat_high\&quot;:2.0,\&quot;history_hours_low\&quot;:12,\&quot;history_hours_medium\&quot;:24,\&quot;history_hours_high\&quot;:48,\&quot;cold_age_days_low\&quot;:14,\&quot;cold_age_days_medium\&quot;:90,\&quot;cold_age_days_high\&quot;:180,\&quot;global_notice\&quot;:\&quot;\&quot;,\&quot;general_category_id\&quot;:-1,\&quot;default_composer_category\&quot;:\&quot;\&quot;,\&quot;view_user_route\&quot;:\&quot;summary\&quot;,\&quot;admin_quick_start_topic_id\&quot;:9,\&quot;bootstrap_mode_min_users\&quot;:50,\&quot;bootstrap_mode_enabled\&quot;:false,\&quot;automatically_unpin_topics\&quot;:true,\&quot;read_time_word_count\&quot;:500,\&quot;topic_page_title_includes_category\&quot;:true,\&quot;enable_powered_by_discourse\&quot;:true,\&quot;penalty_include_post_message\&quot;:false,\&quot;svg_icon_subset\&quot;:\&quot;\&quot;,\&quot;allow_bulk_invite\&quot;:true,\&quot;show_category_definitions_in_topic_lists\&quot;:false,\&quot;use_polymorphic_bookmarks\&quot;:true,\&quot;suggest_weekends_in_date_pickers\&quot;:true,\&quot;show_bottom_topic_map\&quot;:true,\&quot;show_topic_map_in_topics_without_replies\&quot;:true,\&quot;disable_mailing_list_mode\&quot;:false,\&quot;default_topics_automatic_unpin\&quot;:true,\&quot;mute_all_categories_by_default\&quot;:false,\&quot;enable_offline_indicator\&quot;:false,\&quot;tagging_enabled\&quot;:true,\&quot;tag_style\&quot;:\&quot;simple\&quot;,\&quot;max_tags_per_topic\&quot;:5,\&quot;enable_max_tags_per_email_subject\&quot;:false,\&quot;max_tags_per_email_subject\&quot;:5,\&quot;max_tag_length\&quot;:20,\&quot;min_trust_level_to_tag_topics\&quot;:0,\&quot;tag_topic_allowed_groups\&quot;:\&quot;1|2|10\&quot;,\&quot;max_tag_search_results\&quot;:5,\&quot;max_tags_in_filter_list\&quot;:30,\&quot;tags_sort_alphabetically\&quot;:false,\&quot;tags_listed_by_group\&quot;:false,\&quot;suppress_overlapping_tags_in_list\&quot;:false,\&quot;remove_muted_tags_from_latest\&quot;:\&quot;always\&quot;,\&quot;watched_precedence_over_muted\&quot;:false,\&quot;force_lowercase_tags\&quot;:true,\&quot;dashboard_hidden_reports\&quot;:\&quot;\&quot;,\&quot;dashboard_visible_tabs\&quot;:\&quot;moderation|security|reports|features\&quot;,\&quot;dashboard_general_tab_activity_metrics\&quot;:\&quot;page_view_total_reqs|visits|time_to_first_response|likes|flags|user_to_user_private_messages_with_replies\&quot;,\&quot;admin_allow_filter_untranslated_text\&quot;:false,\&quot;experimental_rename_faq_to_guidelines\&quot;:false,\&quot;experimental_hashtag_search_result_limit\&quot;:20,\&quot;experimental_form_templates\&quot;:false,\&quot;experimental_new_new_view_groups\&quot;:\&quot;\&quot;,\&quot;glimmer_topic_list_mode\&quot;:\&quot;disabled\&quot;,\&quot;glimmer_post_menu_mode\&quot;:\&quot;auto\&quot;,\&quot;enable_experimental_lightbox\&quot;:false,\&quot;enable_rich_text_paste\&quot;:true,\&quot;discourse_automation_enabled\&quot;:true,\&quot;chat_enabled\&quot;:false,\&quot;enable_public_channels\&quot;:true,\&quot;chat_threads_enabled\&quot;:false,\&quot;chat_channel_retention_days\&quot;:90,\&quot;chat_max_direct_message_users\&quot;:20,\&quot;chat_dm_retention_days\&quot;:0,\&quot;chat_allow_archiving_channels\&quot;:false,\&quot;default_emoji_reactions\&quot;:\&quot;+1|heart|tada\&quot;,\&quot;chat_minimum_message_length\&quot;:1,\&quot;chat_maximum_message_length\&quot;:6000,\&quot;chat_allow_uploads\&quot;:true,\&quot;max_chat_auto_joined_users\&quot;:10000,\&quot;max_mentions_per_chat_message\&quot;:5,\&quot;chat_separate_sidebar_mode\&quot;:\&quot;never\&quot;,\&quot;chat_editing_grace_period\&quot;:30,\&quot;chat_editing_grace_period_max_diff_low_trust\&quot;:10,\&quot;chat_editing_grace_period_max_diff_high_trust\&quot;:40,\&quot;chat_preferred_index\&quot;:\&quot;channels\&quot;,\&quot;checklist_enabled\&quot;:true,\&quot;cakeday_enabled\&quot;:true,\&quot;cakeday_emoji\&quot;:\&quot;cake\&quot;,\&quot;cakeday_birthday_enabled\&quot;:false,\&quot;cakeday_birthday_emoji\&quot;:\&quot;birthday\&quot;,\&quot;discourse_chart_enabled\&quot;:false,\&quot;data_explorer_enabled\&quot;:true,\&quot;details_enabled\&quot;:true,\&quot;discourse_graphviz_enabled\&quot;:true,\&quot;lazy_videos_enabled\&quot;:true,\&quot;lazy_youtube_enabled\&quot;:true,\&quot;lazy_vimeo_enabled\&quot;:true,\&quot;lazy_tiktok_enabled\&quot;:false,\&quot;discourse_local_dates_email_format\&quot;:\&quot;YYYY-MM-DDTHH:mm:ss[Z]\&quot;,\&quot;discourse_local_dates_enabled\&quot;:true,\&quot;discourse_local_dates_default_formats\&quot;:\&quot;LLL|LTS|LL|LLLL\&quot;,\&quot;discourse_local_dates_default_timezones\&quot;:\&quot;Europe/Paris|America/Los_Angeles\&quot;,\&quot;discourse_math_enabled\&quot;:true,\&quot;discourse_math_provider\&quot;:\&quot;mathjax\&quot;,\&quot;discourse_math_zoom_on_hover\&quot;:false,\&quot;discourse_math_enable_accessibility\&quot;:false,\&quot;discourse_math_enable_asciimath\&quot;:false,\&quot;discourse_narrative_bot_enabled\&quot;:true,\&quot;presence_enabled\&quot;:true,\&quot;presence_max_users_shown\&quot;:5,\&quot;discourse_reactions_enabled\&quot;:true,\&quot;discourse_reactions_like_icon\&quot;:\&quot;thumbs-up\&quot;,\&quot;discourse_reactions_reaction_for_like\&quot;:\&quot;+1\&quot;,\&quot;discourse_reactions_enabled_reactions\&quot;:\&quot;+1|heart|laughing|open_mouth|eyes|thinking|clap|tada|rocket|hugs|yawning_face|-1|sob\&quot;,\&quot;discourse_reactions_desaturated_reaction_panel\&quot;:false,\&quot;user_notes_enabled\&quot;:true,\&quot;enable_markdown_footnotes\&quot;:true,\&quot;display_footnotes_inline\&quot;:false,\&quot;poll_enabled\&quot;:true,\&quot;poll_maximum_options\&quot;:20,\&quot;poll_minimum_trust_level_to_create\&quot;:1,\&quot;poll_groupable_user_fields\&quot;:\&quot;\&quot;,\&quot;poll_export_data_explorer_query_id\&quot;:-16,\&quot;poll_export_ranked_choice_data_explorer_query_id\&quot;:-19,\&quot;poll_default_public\&quot;:true,\&quot;spoiler_enabled\&quot;:true,\&quot;available_locales\&quot;:\&quot;[{\\\&quot;name\\\&quot;:\\\&quot;اللغة العربية\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;ar\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;беларуская мова\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;be\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;български език\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;bg\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;bosanski jezik\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;bs_BA\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;català\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;ca\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;čeština\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;cs\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;dansk\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;da\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Deutsch\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;de\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;ελληνικά\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;el\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;English (US)\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;en\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;English (UK)\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;en_GB\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Español\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;es\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;eesti\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;et\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;فارسی\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;fa_IR\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;suomi\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;fi\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Français\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;fr\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;galego\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;gl\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;עברית\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;he\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;hrvatski jezik\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;hr\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;magyar\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;hu\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Հայերեն\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;hy\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Indonesian\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;id\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Italiano\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;it\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;日本語\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;ja\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;한국어\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;ko\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;lietuvių kalba\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;lt\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;latviešu valoda\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;lv\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Norsk bokmål\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;nb_NO\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Nederlands\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;nl\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;polski\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;pl_PL\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Português\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;pt\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Português (BR)\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;pt_BR\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;limba română\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;ro\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Русский\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;ru\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;slovenčina\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;sk\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;slovenščina\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;sl\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Shqip\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;sq\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;српски језик\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;sr\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;svenska\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;sv\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Kiswahili\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;sw\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;తెలుగు\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;te\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;ไทย\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;th\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;Türkçe\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;tr_TR\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;ئۇيغۇرچە\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;ug\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;українська мова\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;uk\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;اردو\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;ur\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;tiếng Việt\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;vi\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;简体中文\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;zh_CN\\\&quot;},{\\\&quot;name\\\&quot;:\\\&quot;繁體中文\\\&quot;,\\\&quot;value\\\&quot;:\\\&quot;zh_TW\\\&quot;}]\&quot;,\&quot;require_invite_code\&quot;:false,\&quot;site_logo_url\&quot;:\&quot;\&quot;,\&quot;site_logo_small_url\&quot;:\&quot;https://delvingbitcoin.org/uploads/default/original/1X/863d31b22a9d4d4072777bffb9b9ded86a1638bc.svg\&quot;,\&quot;site_mobile_logo_url\&quot;:\&quot;\&quot;,\&quot;site_favicon_url\&quot;:\&quot;https://delvingbitcoin.org/uploads/default/optimized/1X/863d31b22a9d4d4072777bffb9b9ded86a1638bc_2_32x32.svg\&quot;,\&quot;site_logo_dark_url\&quot;:\&quot;\&quot;,\&quot;site_logo_small_dark_url\&quot;:\&quot;\&quot;,\&quot;site_mobile_logo_dark_url\&quot;:\&quot;\&quot;}&quot;,&quot;customHTML&quot;:&quot;{\&quot;top\&quot;:\&quot;\&quot;,\&quot;footer\&quot;:\&quot;\&quot;}&quot;,&quot;banner&quot;:&quot;{}&quot;,&quot;customEmoji&quot;:&quot;[]&quot;,&quot;isReadOnly&quot;:&quot;false&quot;,&quot;isStaffWritesOnly&quot;:&quot;false&quot;,&quot;activatedThemes&quot;:&quot;{\&quot;1\&quot;:\&quot;Default\&quot;,\&quot;2\&quot;:\&quot;discourse-mermaid-theme-component\&quot;,\&quot;3\&quot;:\&quot;DiscoTOC\&quot;,\&quot;5\&quot;:\&quot;Raw Post Button\&quot;,\&quot;6\&quot;:\&quot;Discourse Plotly\&quot;}&quot;,&quot;topic_1184&quot;:&quot;{\&quot;post_stream\&quot;:{\&quot;posts\&quot;:[{\&quot;id\&quot;:3340,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-10T09:02:17.756Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003cp\\u003eThis work is a collaboration between Niklas Gögge (\\u003ca href=\\\&quot;https://brink.dev/\\\&quot;\\u003eBrink\\u003c/a\\u003e) and Antoine Poinsot (\\u003ca href=\\\&quot;https://wizardsardine.com/\\\&quot;\\u003eWizardsardine\\u003c/a\\u003e).\\u003c/p\\u003e\\n\\u003cp\\u003eBtcd prior to version \\u003ca href=\\\&quot;https://github.com/btcsuite/btcd/releases/tag/v0.24.2\\\&quot;\\u003e0.24.2\\u003c/a\\u003e does not correctly implement the consensus rules for legacy signature verification. The incompatible behavior can be triggered by a standard transaction, making it possible for anyone to fork off vulnerable btcd nodes at virtually no cost.\\u003c/p\\u003e\\n\\u003ch1\\u003e\\u003ca name=\\\&quot;p-3340-details-1\\\&quot; class=\\\&quot;anchor\\\&quot; href=\\\&quot;#p-3340-details-1\\\&quot;\\u003e\\u003c/a\\u003eDetails\\u003c/h1\\u003e\\n\\u003cp\\u003eWhen verifying a signature for a transaction input, the script interpreter of a Bitcoin node re-constructs the signed message and checks the signature against it. The original algorithm for re-constructing the message is detailed in \\u003ca href=\\\&quot;https://en.bitcoin.it/wiki/OP_CHECKSIG#How_it_works\\\&quot;\\u003ethis wiki page\\u003c/a\\u003e. Notably, the signed message contains a commitment to the Script being executed. For legacy transaction inputs any occurrence of the signature being verified is first removed from the executed Script committed in the message. This is often referred to as the \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e behavior, named after the function implementing this in Satoshi Nakamoto’s original Bitcoin codebase.\\u003c/p\\u003e\\n\\u003cp\\u003e\\u003ccode\\u003eremoveOpcodeByData\\u003c/code\\u003e is Btcd’s equivalent of Bitcoin Core’s \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e. Prior to version 0.24.2, \\u003ccode\\u003eremoveOpcodeByData\\u003c/code\\u003e would remove any data push from the executed Script that \\u003cem\\u003econtains\\u003c/em\\u003e the signature. Whereas Bitcoin Core’s (and Satoshi’s) \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e only removes exact matches. Using public key recovery it is possible to create a Script which contains a signature check and an extraneous data push which contains the signature itself and additional padding data. This Script can be committed to in a P2SH output which can be spent by a standard transaction which would be considered valid by Bitcoin Core and invalid by vulnerable Btcd nodes.\\u003c/p\\u003e\\n\\u003cp\\u003eThis bug was introduced in commit \\u003ca href=\\\&quot;https://github.com/btcsuite/btcd/commit/76339baf6c9407b073828245e3458f4df35190ae\\\&quot;\\u003e\\u003ccode\\u003e76339baf6c9407b073828245e3458f4df35190ae\\u003c/code\\u003e\\u003c/a\\u003e in 2014, in reaction to a new Bitcoin Core unit test demonstrating the original implementation was consensus-incompatible.\\u003c/p\\u003e\\n\\u003ch1\\u003e\\u003ca name=\\\&quot;p-3340-credits-2\\\&quot; class=\\\&quot;anchor\\\&quot; href=\\\&quot;#p-3340-credits-2\\\&quot;\\u003e\\u003c/a\\u003eCredits\\u003c/h1\\u003e\\n\\u003cp\\u003eThanks to the Btcd maintainers for awarding us a bug bounty.\\u003c/p\\u003e\\n\\u003ch1\\u003e\\u003ca name=\\\&quot;p-3340-timeline-3\\\&quot; class=\\\&quot;anchor\\\&quot; href=\\\&quot;#p-3340-timeline-3\\\&quot;\\u003e\\u003c/a\\u003eTimeline\\u003c/h1\\u003e\\n\\u003cul\\u003e\\n\\u003cli\\u003e2024-03-20 Niklas and Antoine discuss the quirks of Bitcoin Core’s \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e (in relation to Antoine’s research into the \\u003ca href=\\\&quot;https://delvingbitcoin.org/t/great-consensus-cleanup-revival/710\\\&quot;\\u003eworst case block validation time\\u003c/a\\u003e) and decide to take a look at if Btcd got all the quirks right in their reimplementation\\u003c/li\\u003e\\n\\u003cli\\u003e2024-03-22 Niklas and Antoine email a detailed report of the issue to Olaoluwa Osuntokun\\u003c/li\\u003e\\n\\u003cli\\u003e2024-03-26 Olaoluwa acknowledges the issue and creates a discussion group with another Btcd maintainer\\u003c/li\\u003e\\n\\u003cli\\u003e2024-05-07 Antoine reserves \\u003ca href=\\\&quot;https://www.cve.org/CVERecord?id=CVE-2024-36051\\\&quot;\\u003eCVE-2024-36051\\u003c/a\\u003e through Mitre\\u003c/li\\u003e\\n\\u003cli\\u003e2024-06-21 Laolu reserves \\u003ca href=\\\&quot;https://github.com/btcsuite/btcd/security/advisories/GHSA-27vh-h6mc-q6g8\\\&quot;\\u003eCVE-2024-38365\\u003c/a\\u003e through Github\\u003c/li\\u003e\\n\\u003cli\\u003e2024-04-26 A covert fix is included in PR \\u003ca href=\\\&quot;https://github.com/btcsuite/btcd/pull/2178\\\&quot;\\u003e#2178\\u003c/a\\u003e\\u003c/li\\u003e\\n\\u003cli\\u003e2024-05-22 PR \\u003ca href=\\\&quot;https://github.com/btcsuite/btcd/pull/2178\\\&quot;\\u003e#2178\\u003c/a\\u003e is merged\\u003c/li\\u003e\\n\\u003cli\\u003e2024-06-25 Version 0.24.2 is released with the fix\\u003c/li\\u003e\\n\\u003cli\\u003e2024-09-20 Public disclosure\\u003c/li\\u003e\\n\\u003c/ul\\u003e\&quot;,\&quot;post_number\&quot;:1,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-10T09:02:17.756Z\&quot;,\&quot;reply_count\&quot;:1,\&quot;reply_to_post_number\&quot;:null,\&quot;quote_count\&quot;:0,\&quot;incoming_link_count\&quot;:622,\&quot;reads\&quot;:57,\&quot;readers_count\&quot;:56,\&quot;score\&quot;:3086.4,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:\&quot;wg-consensus-cleanup\&quot;,\&quot;flair_url\&quot;:\&quot;/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png\&quot;,\&quot;flair_bg_color\&quot;:\&quot;\&quot;,\&quot;flair_color\&quot;:\&quot;\&quot;,\&quot;flair_group_id\&quot;:43,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:1,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;link_counts\&quot;:[{\&quot;url\&quot;:\&quot;https://github.com/btcsuite/btcd/pull/2178\&quot;,\&quot;internal\&quot;:false,\&quot;reflection\&quot;:false,\&quot;title\&quot;:\&quot;Update standardness rules congruent to Bitcoin Core by ProofOfKeags · Pull Request #2178 · btcsuite/btcd · GitHub\&quot;,\&quot;clicks\&quot;:41},{\&quot;url\&quot;:\&quot;https://github.com/btcsuite/btcd/commit/76339baf6c9407b073828245e3458f4df35190ae\&quot;,\&quot;internal\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:25},{\&quot;url\&quot;:\&quot;https://wizardsardine.com/\&quot;,\&quot;internal\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:11},{\&quot;url\&quot;:\&quot;https://en.bitcoin.it/wiki/OP_CHECKSIG#How_it_works\&quot;,\&quot;internal\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:10},{\&quot;url\&quot;:\&quot;https://www.cve.org/CVERecord?id=CVE-2024-36051\&quot;,\&quot;internal\&quot;:false,\&quot;reflection\&quot;:false,\&quot;title\&quot;:\&quot;CVE Website\&quot;,\&quot;clicks\&quot;:8},{\&quot;url\&quot;:\&quot;https://github.com/btcsuite/btcd/security/advisories/GHSA-27vh-h6mc-q6g8\&quot;,\&quot;internal\&quot;:false,\&quot;reflection\&quot;:false,\&quot;title\&quot;:\&quot;OP_CODESEPARATOR fuzzy match · Advisory · btcsuite/btcd · GitHub\&quot;,\&quot;clicks\&quot;:8},{\&quot;url\&quot;:\&quot;https://delvingbitcoin.org/t/great-consensus-cleanup-revival/710\&quot;,\&quot;internal\&quot;:true,\&quot;reflection\&quot;:false,\&quot;title\&quot;:\&quot;Great Consensus Cleanup Revival\&quot;,\&quot;clicks\&quot;:4},{\&quot;url\&quot;:\&quot;https://github.com/btcsuite/btcd/releases/tag/v0.24.2\&quot;,\&quot;internal\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:4},{\&quot;url\&quot;:\&quot;https://brink.dev/\&quot;,\&quot;internal\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:3},{\&quot;url\&quot;:\&quot;https://delvingbitcoin.org/t/non-disclosure-of-a-consensus-bug-in-btcd/1177/8\&quot;,\&quot;internal\&quot;:true,\&quot;reflection\&quot;:true,\&quot;title\&quot;:\&quot;Non-disclosure of a consensus bug in btcd\&quot;,\&quot;clicks\&quot;:3}],\&quot;read\&quot;:true,\&quot;user_title\&quot;:\&quot;Regular\&quot;,\&quot;title_is_group\&quot;:false,\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:12,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:null,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:0,\&quot;current_user_used_main_reaction\&quot;:false},{\&quot;id\&quot;:3347,\&quot;name\&quot;:\&quot;David A. Harding\&quot;,\&quot;username\&quot;:\&quot;harding\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/harding/{size}/925_2.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-10T23:22:25.205Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003caside class=\\\&quot;quote no-group\\\&quot; data-username=\\\&quot;AntoineP\\\&quot; data-post=\\\&quot;1\\\&quot; data-topic=\\\&quot;1184\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;title\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;quote-controls\\\&quot;\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\&quot;lazy\\\&quot; alt=\\\&quot;\\\&quot; width=\\\&quot;24\\\&quot; height=\\\&quot;24\\\&quot; src=\\\&quot;https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/antoinep/48/483_2.png\\\&quot; class=\\\&quot;avatar\\\&quot;\\u003e AntoineP:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eUsing public key recovery it is possible to create a Script which contains a signature check and an extraneous data push which contains the signature itself and additional padding data.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eWhat is the public key recovery for?\\u003c/p\\u003e\&quot;,\&quot;post_number\&quot;:2,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-10T23:22:25.205Z\&quot;,\&quot;reply_count\&quot;:1,\&quot;reply_to_post_number\&quot;:null,\&quot;quote_count\&quot;:1,\&quot;incoming_link_count\&quot;:0,\&quot;reads\&quot;:40,\&quot;readers_count\&quot;:39,\&quot;score\&quot;:13.0,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;David A. Harding\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:null,\&quot;flair_url\&quot;:null,\&quot;flair_bg_color\&quot;:null,\&quot;flair_color\&quot;:null,\&quot;flair_group_id\&quot;:null,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:1,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;read\&quot;:true,\&quot;user_title\&quot;:null,\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:6,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:null,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:0,\&quot;current_user_used_main_reaction\&quot;:false},{\&quot;id\&quot;:3349,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-11T06:47:49.557Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003cp\\u003eTo have a valid signature in the scriptpubkey.\\u003c/p\\u003e\\n\\u003cp\\u003eTo exploit this you want to have a data push in the scriptpubkey which contains the signature among other dummy data and then execute the signature check. When checking the signature Bitcoin Core’s \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e won’t drop the data push from the signature hash, but btcd will before version 0.24.2.\\u003c/p\\u003e\\n\\u003cp\\u003eTo cause a chain split you not only want the sighash calculation to differ, you want it to lead to a different signature check result. The only way to have a valid signature in the scriptpubkey is to generate the signature first and then to recover a public key from it plus the sighash. By performing a public key recovery using Bitcoin Core’s sighash you’ll get a public key such as the signature check passes on Bitcoin Core but fails on btcd. And vice-versa.\\u003c/p\\u003e\\n\\u003cp\\u003eI have a documented Bitcoin Core unit test as a patch which generates such a transaction, that we sent to Laolu as part of the original report. I’m hesitant to share it publicly though since it would simplify the job of a script kiddy who wants to be annoying. I’ll share the patch with you privately and share it on this thread later.\\u003c/p\\u003e\&quot;,\&quot;post_number\&quot;:3,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-11T06:47:49.557Z\&quot;,\&quot;reply_count\&quot;:0,\&quot;reply_to_post_number\&quot;:2,\&quot;quote_count\&quot;:0,\&quot;incoming_link_count\&quot;:1,\&quot;reads\&quot;:39,\&quot;readers_count\&quot;:38,\&quot;score\&quot;:72.8,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:\&quot;wg-consensus-cleanup\&quot;,\&quot;flair_url\&quot;:\&quot;/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png\&quot;,\&quot;flair_bg_color\&quot;:\&quot;\&quot;,\&quot;flair_color\&quot;:\&quot;\&quot;,\&quot;flair_group_id\&quot;:43,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:1,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;read\&quot;:true,\&quot;user_title\&quot;:\&quot;Regular\&quot;,\&quot;title_is_group\&quot;:false,\&quot;reply_to_user\&quot;:{\&quot;username\&quot;:\&quot;harding\&quot;,\&quot;name\&quot;:\&quot;David A. Harding\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/harding/{size}/925_2.png\&quot;},\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[{\&quot;id\&quot;:2,\&quot;count\&quot;:2}],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:12,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:null,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[{\&quot;id\&quot;:\&quot;+1\&quot;,\&quot;type\&quot;:\&quot;emoji\&quot;,\&quot;count\&quot;:1},{\&quot;id\&quot;:\&quot;heart\&quot;,\&quot;type\&quot;:\&quot;emoji\&quot;,\&quot;count\&quot;:1}],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:2,\&quot;current_user_used_main_reaction\&quot;:false},{\&quot;id\&quot;:3351,\&quot;name\&quot;:\&quot;Antoine Riard\&quot;,\&quot;username\&quot;:\&quot;ariard\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/a/c67d28/{size}.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-11T19:08:26.222Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003cblockquote\\u003e\\n\\u003cp\\u003eand additional padding data.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003caside class=\\\&quot;onebox githubblob\\\&quot; data-onebox-src=\\\&quot;https://github.com/bitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329\\\&quot;\\u003e\\n  \\u003cheader class=\\\&quot;source\\\&quot;\\u003e\\n\\n      \\u003ca href=\\\&quot;https://github.com/bitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329\\\&quot; target=\\\&quot;_blank\\\&quot; rel=\\\&quot;noopener\\\&quot;\\u003egithub.com\\u003c/a\\u003e\\n  \\u003c/header\\u003e\\n\\n  \\u003carticle class=\\\&quot;onebox-body\\\&quot;\\u003e\\n    \\u003ch4\\u003e\\u003ca href=\\\&quot;https://github.com/bitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329\\\&quot; target=\\\&quot;_blank\\\&quot; rel=\\\&quot;noopener\\\&quot;\\u003ebitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329\\u003c/a\\u003e\\u003c/h4\\u003e\\n\\n\\n\\n    \\u003cpre class=\\\&quot;onebox\\\&quot;\\u003e\\u003ccode class=\\\&quot;lang-cpp\\\&quot;\\u003e\\n      \\u003col class=\\\&quot;start lines\\\&quot; start=\\\&quot;319\\\&quot; style=\\\&quot;counter-reset: li-counter 318 ;\\\&quot;\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003estatic bool EvalChecksigPreTapscript(const valtype\\u0026amp; vchSig, const valtype\\u0026amp; vchPubKey, CScript::const_iterator pbegincodehash, CScript::const_iterator pend, unsigned int flags, const BaseSignatureChecker\\u0026amp; checker, SigVersion sigversion, ScriptError* serror, bool\\u0026amp; fSuccess)\\u003c/li\\u003e\\n          \\u003cli\\u003e{\\u003c/li\\u003e\\n          \\u003cli\\u003e    assert(sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0);\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003e    // Subset of script starting at the most recent codeseparator\\u003c/li\\u003e\\n          \\u003cli\\u003e    CScript scriptCode(pbegincodehash, pend);\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003e    // Drop the signature in pre-segwit scripts but not segwit scripts\\u003c/li\\u003e\\n          \\u003cli\\u003e    if (sigversion == SigVersion::BASE) {\\u003c/li\\u003e\\n          \\u003cli class=\\\&quot;selected\\\&quot;\\u003e        int found = FindAndDelete(scriptCode, CScript() \\u0026lt;\\u0026lt; vchSig);\\u003c/li\\u003e\\n          \\u003cli\\u003e        if (found \\u0026gt; 0 \\u0026amp;\\u0026amp; (flags \\u0026amp; SCRIPT_VERIFY_CONST_SCRIPTCODE))\\u003c/li\\u003e\\n          \\u003cli\\u003e            return set_error(serror, SCRIPT_ERR_SIG_FINDANDDELETE);\\u003c/li\\u003e\\n          \\u003cli\\u003e    }\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003e    if (!CheckSignatureEncoding(vchSig, flags, serror) || !CheckPubKeyEncoding(vchPubKey, flags, sigversion, serror)) {\\u003c/li\\u003e\\n          \\u003cli\\u003e        //serror is set\\u003c/li\\u003e\\n          \\u003cli\\u003e        return false;\\u003c/li\\u003e\\n          \\u003cli\\u003e    }\\u003c/li\\u003e\\n          \\u003cli\\u003e    fSuccess = checker.CheckECDSASignature(vchSig, vchPubKey, scriptCode, sigversion);\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n      \\u003c/ol\\u003e\\n    \\u003c/code\\u003e\\u003c/pre\\u003e\\n\\n\\n\\n  \\u003c/article\\u003e\\n\\n  \\u003cdiv class=\\\&quot;onebox-metadata\\\&quot;\\u003e\\n    \\n    \\n  \\u003c/div\\u003e\\n\\n  \\u003cdiv style=\\\&quot;clear: both\\\&quot;\\u003e\\u003c/div\\u003e\\n\\u003c/aside\\u003e\\n\\n\\u003cp\\u003eIn my understanding of the bug, there is feeding of the two consensus-nodes, with the following\\n\\u003ccode\\u003escriptCode\\u003c/code\\u003e, where the ECDSA sig and the \\\&quot;noise dummy data must match the length declared in\\npushed bytes.\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\&quot;lang-auto\\\&quot;\\u003e\\n  1-byte        1-byte       ECDSA sig-bytes   \\\&quot;noise\\\&quot; dummy data-bytes\\n\\nOP_PUSHDATA1 \\u0026lt;bytes pushed\\u0026gt; \\u0026lt;signature\\u0026gt; \\u0026lt;padding data\\u0026gt;\\n\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eOne should note that ECDSA sig length is malleable.\\u003c/p\\u003e\\n\\u003cp\\u003eThe non-upgraded, pre-0.24.2 btcd peers should remove the whole data push containing\\nthe consensus valid signatures, before it’s verified by the script interpreter. While\\nbitcoind peers can accept the valid signatures. I’m unsure that you really need public\\nkey recovery to achieve that chain fork as a trick. I believe one has OP_PICK, OP_ROLL and other stack inspection opcodes available, that can be committed in the \\u003ccode\\u003escriptCode\\u003c/code\\u003e.\\u003c/p\\u003e\&quot;,\&quot;post_number\&quot;:4,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-11T19:13:31.221Z\&quot;,\&quot;reply_count\&quot;:1,\&quot;reply_to_post_number\&quot;:null,\&quot;quote_count\&quot;:0,\&quot;incoming_link_count\&quot;:1,\&quot;reads\&quot;:38,\&quot;readers_count\&quot;:37,\&quot;score\&quot;:17.6,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;Antoine Riard\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:null,\&quot;flair_url\&quot;:null,\&quot;flair_bg_color\&quot;:null,\&quot;flair_color\&quot;:null,\&quot;flair_group_id\&quot;:null,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:2,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;link_counts\&quot;:[{\&quot;url\&quot;:\&quot;https://github.com/bitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329\&quot;,\&quot;internal\&quot;:false,\&quot;reflection\&quot;:false,\&quot;title\&quot;:\&quot;bitcoin/src/script/interpreter.cpp at 48cf3da636089873ba7280e0d5b22eb81811d194 · bitcoin/bitcoin · GitHub\&quot;,\&quot;clicks\&quot;:1}],\&quot;read\&quot;:true,\&quot;user_title\&quot;:null,\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:5,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:\&quot;Github link was replaced with a permanent link\&quot;,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:0,\&quot;current_user_used_main_reaction\&quot;:false},{\&quot;id\&quot;:3354,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-12T09:22:50.011Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003caside class=\\\&quot;quote no-group\\\&quot; data-username=\\\&quot;ariard\\\&quot; data-post=\\\&quot;4\\\&quot; data-topic=\\\&quot;1184\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;title\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;quote-controls\\\&quot;\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\&quot;lazy\\\&quot; alt=\\\&quot;\\\&quot; width=\\\&quot;24\\\&quot; height=\\\&quot;24\\\&quot; src=\\\&quot;https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/a/c67d28/48.png\\\&quot; class=\\\&quot;avatar\\\&quot;\\u003e ariard:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eI’m unsure that you really need public key recovery to achieve that chain fork as a trick. I believe one has OP_PICK, OP_ROLL and other stack inspection opcodes available, that can be committed in the \\u003ccode\\u003escriptCode\\u003c/code\\u003e.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eNo, it’s more fundamental than just which opcode to use. You commit to the signature in the \\u003ccode\\u003escriptCode\\u003c/code\\u003e, which itself needs to commit to the \\u003ccode\\u003escriptCode\\u003c/code\\u003e. Short of new signature modes (like \\u003ccode\\u003eANYPREVOUT\\u003c/code\\u003e) which don’t commit to the \\u003ccode\\u003escriptCode\\u003c/code\\u003e you need to use pubkey recovery.\\u003c/p\\u003e\\n\\u003cp\\u003eCould you describe exactly how you think it’s possible to achieve the same without pubkey recovery?\\u003c/p\\u003e\&quot;,\&quot;post_number\&quot;:5,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-12T09:22:50.011Z\&quot;,\&quot;reply_count\&quot;:1,\&quot;reply_to_post_number\&quot;:4,\&quot;quote_count\&quot;:1,\&quot;incoming_link_count\&quot;:0,\&quot;reads\&quot;:35,\&quot;readers_count\&quot;:34,\&quot;score\&quot;:12.0,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:\&quot;wg-consensus-cleanup\&quot;,\&quot;flair_url\&quot;:\&quot;/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png\&quot;,\&quot;flair_bg_color\&quot;:\&quot;\&quot;,\&quot;flair_color\&quot;:\&quot;\&quot;,\&quot;flair_group_id\&quot;:43,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:1,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;read\&quot;:true,\&quot;user_title\&quot;:\&quot;Regular\&quot;,\&quot;title_is_group\&quot;:false,\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:12,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:null,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:0,\&quot;current_user_used_main_reaction\&quot;:false},{\&quot;id\&quot;:3362,\&quot;name\&quot;:\&quot;Antoine Riard\&quot;,\&quot;username\&quot;:\&quot;ariard\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/a/c67d28/{size}.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-15T03:35:30.434Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003cblockquote\\u003e\\n\\u003cp\\u003eYou commit to the signature in the \\u003ccode\\u003escriptCode\\u003c/code\\u003e , which itself needs to commit to the \\u003ccode\\u003escriptCode\\u003c/code\\u003e .\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003cp\\u003eNo, a signature does not need to commit to the \\u003ccode\\u003escriptCode\\u003c/code\\u003e as one can use \\u003ccode\\u003eOP_CODESEPARATOR\\u003c/code\\u003e to spend pre-segwit script.\\u003c/p\\u003e\\n\\u003cp\\u003eIf you have a data push of the signature, then let the signature on the stack, then you have an \\u003ccode\\u003eOP_CODESEPARATOR\\u003c/code\\u003e, and then you have the \\u003ccode\\u003eOP_CHECKSIG\\u003c/code\\u003e. In that case shouldn’t the \\u003ccode\\u003epbegincodehash\\u003c/code\\u003e making the \\u003ccode\\u003escriptCode\\u003c/code\\u003e be only the \\u003ccode\\u003eOP_CHECKSIG\\u003c/code\\u003e itself, i.e a fixed-point ? The \\u003ccode\\u003eOP_CHECKSIG\\u003c/code\\u003e bitcoin core code is popping up the signature and pubkey from the stack, and \\u003ccode\\u003eOP_CODESEPARATOR\\u003c/code\\u003e is a null-op on the script stack.\\u003c/p\\u003e\&quot;,\&quot;post_number\&quot;:6,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-15T03:35:30.434Z\&quot;,\&quot;reply_count\&quot;:1,\&quot;reply_to_post_number\&quot;:5,\&quot;quote_count\&quot;:0,\&quot;incoming_link_count\&quot;:1,\&quot;reads\&quot;:32,\&quot;readers_count\&quot;:31,\&quot;score\&quot;:16.4,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;Antoine Riard\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:null,\&quot;flair_url\&quot;:null,\&quot;flair_bg_color\&quot;:null,\&quot;flair_color\&quot;:null,\&quot;flair_group_id\&quot;:null,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:1,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;read\&quot;:true,\&quot;user_title\&quot;:null,\&quot;reply_to_user\&quot;:{\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;},\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:5,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:null,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:0,\&quot;current_user_used_main_reaction\&quot;:false},{\&quot;id\&quot;:3364,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-15T08:57:22.931Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003caside class=\\\&quot;quote no-group\\\&quot; data-username=\\\&quot;ariard\\\&quot; data-post=\\\&quot;6\\\&quot; data-topic=\\\&quot;1184\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;title\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;quote-controls\\\&quot;\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\&quot;lazy\\\&quot; alt=\\\&quot;\\\&quot; width=\\\&quot;24\\\&quot; height=\\\&quot;24\\\&quot; src=\\\&quot;https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/a/c67d28/48.png\\\&quot; class=\\\&quot;avatar\\\&quot;\\u003e ariard:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eNo, a signature does not need to commit to the \\u003ccode\\u003escriptCode\\u003c/code\\u003e as one can use \\u003ccode\\u003eOP_CODESEPARATOR\\u003c/code\\u003e to spend pre-segwit script.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eIf you get the signature out of the \\u003ccode\\u003escriptCode\\u003c/code\\u003e by using an \\u003ccode\\u003eOP_CODESEPARATOR\\u003c/code\\u003e, then you won’t be able to exploit the \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e discrepancy since there is no signature to find anymore.\\u003c/p\\u003e\&quot;,\&quot;post_number\&quot;:7,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-15T08:57:22.931Z\&quot;,\&quot;reply_count\&quot;:0,\&quot;reply_to_post_number\&quot;:6,\&quot;quote_count\&quot;:1,\&quot;incoming_link_count\&quot;:0,\&quot;reads\&quot;:31,\&quot;readers_count\&quot;:30,\&quot;score\&quot;:6.2,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:\&quot;wg-consensus-cleanup\&quot;,\&quot;flair_url\&quot;:\&quot;/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png\&quot;,\&quot;flair_bg_color\&quot;:\&quot;\&quot;,\&quot;flair_color\&quot;:\&quot;\&quot;,\&quot;flair_group_id\&quot;:43,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:1,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;read\&quot;:true,\&quot;user_title\&quot;:\&quot;Regular\&quot;,\&quot;title_is_group\&quot;:false,\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:12,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:null,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:0,\&quot;current_user_used_main_reaction\&quot;:false},{\&quot;id\&quot;:3366,\&quot;name\&quot;:\&quot;Antoine Riard\&quot;,\&quot;username\&quot;:\&quot;ariard\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/a/c67d28/{size}.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-15T12:00:07.024Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003cp\\u003eRight, unless you’re using an \\u003ccode\\u003eOP_CODESEPARATOR\\u003c/code\\u003e the signature should commit to the \\u003ccode\\u003escriptCode\\u003c/code\\u003e. Though there is still the possibility that the signature is invalid w.r.t the \\u003ccode\\u003escriptCode\\u003c/code\\u003e and the script execution still valid.\\u003c/p\\u003e\\n\\u003cp\\u003eWhat if you have : \\u0026lt;invalid_sig+noise\\u0026gt; \\u0026lt;invalid_sig\\u0026gt;  \\u0026lt;OP_CHECKSIG\\u0026gt; \\u0026lt;OP_SIZE\\u0026gt; \\u0026lt;length_invalid_sig+noise\\u0026gt; OP_EQUALVERIFY.\\u003c/p\\u003e\\n\\u003cp\\u003eIn my understanding, core’ should only remove 1 instance of \\u0026lt;invalid_sig\\u0026gt;, fails on the CHECKSIG (though \\u003ccode\\u003eNULLFAIL\\u003c/code\\u003e policy only) and then succeed on the OP_SIZE. On the other hand, non-upgraded btcd should remove the 2 instances of \\u0026lt;invalid_sig\\u0026gt; (as invalid_sig+noise contains the invalid_sig) and fails the OP_SIZE + OP_EQUALVERIFY.\\u003c/p\\u003e\&quot;,\&quot;post_number\&quot;:8,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-15T12:00:07.024Z\&quot;,\&quot;reply_count\&quot;:1,\&quot;reply_to_post_number\&quot;:null,\&quot;quote_count\&quot;:0,\&quot;incoming_link_count\&quot;:0,\&quot;reads\&quot;:32,\&quot;readers_count\&quot;:31,\&quot;score\&quot;:11.4,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;Antoine Riard\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:null,\&quot;flair_url\&quot;:null,\&quot;flair_bg_color\&quot;:null,\&quot;flair_color\&quot;:null,\&quot;flair_group_id\&quot;:null,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:1,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;read\&quot;:true,\&quot;user_title\&quot;:null,\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:5,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:null,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:0,\&quot;current_user_used_main_reaction\&quot;:false},{\&quot;id\&quot;:3367,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-15T13:09:04.772Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003caside class=\\\&quot;quote no-group\\\&quot; data-username=\\\&quot;ariard\\\&quot; data-post=\\\&quot;8\\\&quot; data-topic=\\\&quot;1184\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;title\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;quote-controls\\\&quot;\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\&quot;lazy\\\&quot; alt=\\\&quot;\\\&quot; width=\\\&quot;24\\\&quot; height=\\\&quot;24\\\&quot; src=\\\&quot;https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/a/c67d28/48.png\\\&quot; class=\\\&quot;avatar\\\&quot;\\u003e ariard:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eThough there is still the possibility that the signature is invalid w.r.t the \\u003ccode\\u003escriptCode\\u003c/code\\u003e and the script execution still valid.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eSure, but what we want here is a different script execution between btcd and Core. In the context of this disclosure, this was only possible using a discrepancy in the \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e implementation therefore you need a signature to be found in the \\u003ccode\\u003escriptCode\\u003c/code\\u003e. Further, you need the signature to be valid for either btcd or Core, which is only possible if you do public key recovery.\\u003c/p\\u003e\\n\\u003caside class=\\\&quot;quote no-group\\\&quot; data-username=\\\&quot;ariard\\\&quot; data-post=\\\&quot;8\\\&quot; data-topic=\\\&quot;1184\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;title\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;quote-controls\\\&quot;\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\&quot;lazy\\\&quot; alt=\\\&quot;\\\&quot; width=\\\&quot;24\\\&quot; height=\\\&quot;24\\\&quot; src=\\\&quot;https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/a/c67d28/48.png\\\&quot; class=\\\&quot;avatar\\\&quot;\\u003e ariard:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eWhat if you have : \\u0026lt;invalid_sig+noise\\u0026gt; \\u0026lt;invalid_sig\\u0026gt; \\u0026lt;OP_CHECKSIG\\u0026gt; \\u0026lt;OP_SIZE\\u0026gt; \\u0026lt;length_invalid_sig+noise\\u0026gt; OP_EQUALVERIFY.\\u003c/p\\u003e\\n\\u003cp\\u003eIn my understanding, core’ should only remove 1 instance of \\u0026lt;invalid_sig\\u0026gt;, fails on the CHECKSIG (though \\u003ccode\\u003eNULLFAIL\\u003c/code\\u003e policy only) and then succeed on the OP_SIZE. On the other hand, non-upgraded btcd should remove the 2 instances of \\u0026lt;invalid_sig\\u0026gt; (as invalid_sig+noise contains the invalid_sig) and fails the OP_SIZE + OP_EQUALVERIFY.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eI’m not sure what you are trying to get at since your Script is different from what i think you meant:\\u003c/p\\u003e\\n\\u003cul\\u003e\\n\\u003cli\\u003eHere the \\u003ccode\\u003eCHECKSIG\\u003c/code\\u003e would be executed taking \\u003ccode\\u003e\\u0026lt;invalid_sig+noise\\u0026gt;\\u003c/code\\u003e as signature and \\u003ccode\\u003e\\u0026lt;invalid_sig\\u0026gt;\\u003c/code\\u003e as public key, which is always going to push 0 on the stack;\\u003c/li\\u003e\\n\\u003cli\\u003e\\u003ccode\\u003eOP_SIZE\\u003c/code\\u003e would then be executed on the result of the \\u003ccode\\u003eCHECKSIG\\u003c/code\\u003e, which is always 0, and so would always return 0 as well;\\u003c/li\\u003e\\n\\u003cli\\u003eThen \\u003ccode\\u003eOP_EQUALVERIFY\\u003c/code\\u003e would always fail since the length of the invalid sig + noise would never be 0.\\u003c/li\\u003e\\n\\u003c/ul\\u003e\\n\\u003cp\\u003eI assume you mean that running OP_CHECKSIG would drop the \\u003ccode\\u003e\\u0026lt;invalid_sig\\u0026gt;\\u003c/code\\u003e (in Bitcoin Core), or both \\u003ccode\\u003e\\u0026lt;invalid_sig\\u0026gt;\\u003c/code\\u003e and \\u003ccode\\u003e\\u0026lt;invalid_sig + noise\\u0026gt;\\u003c/code\\u003e, from the Script itself and lead to a discrepancy of the execution when asserting the size of the top element left on the stack. Then you are misunderstanding what \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e does. It does not tamper with the Script being executed at all, it only modifies a copy of it for the purpose of committing to it in the sighash. Even if your Script from above correctly implemented what i think you intended it to, it would not cause a different execution between btcd and Bitcoin Core: the executed script is always the same so the size of the top stack element would always be the same for both.\\u003c/p\\u003e\&quot;,\&quot;post_number\&quot;:9,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-15T13:09:04.772Z\&quot;,\&quot;reply_count\&quot;:1,\&quot;reply_to_post_number\&quot;:8,\&quot;quote_count\&quot;:1,\&quot;incoming_link_count\&quot;:0,\&quot;reads\&quot;:34,\&quot;readers_count\&quot;:33,\&quot;score\&quot;:11.8,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:\&quot;wg-consensus-cleanup\&quot;,\&quot;flair_url\&quot;:\&quot;/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png\&quot;,\&quot;flair_bg_color\&quot;:\&quot;\&quot;,\&quot;flair_color\&quot;:\&quot;\&quot;,\&quot;flair_group_id\&quot;:43,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:1,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;read\&quot;:true,\&quot;user_title\&quot;:\&quot;Regular\&quot;,\&quot;title_is_group\&quot;:false,\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:12,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:null,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:0,\&quot;current_user_used_main_reaction\&quot;:false},{\&quot;id\&quot;:3369,\&quot;name\&quot;:\&quot;Antoine Riard\&quot;,\&quot;username\&quot;:\&quot;ariard\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/a/c67d28/{size}.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-10-15T22:32:01.648Z\&quot;,\&quot;cooked\&quot;:\&quot;\\u003caside class=\\\&quot;quote no-group\\\&quot; data-username=\\\&quot;AntoineP\\\&quot; data-post=\\\&quot;9\\\&quot; data-topic=\\\&quot;1184\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;title\\\&quot;\\u003e\\n\\u003cdiv class=\\\&quot;quote-controls\\\&quot;\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\&quot;lazy\\\&quot; alt=\\\&quot;\\\&quot; width=\\\&quot;24\\\&quot; height=\\\&quot;24\\\&quot; src=\\\&quot;https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/antoinep/48/483_2.png\\\&quot; class=\\\&quot;avatar\\\&quot;\\u003e AntoineP:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eThen you are misunderstanding what \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e does. It does not tamper with the Script being executed at all, it only modifies a copy of it for the purpose of committing to it in the sighash.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eThe \\u003ccode\\u003eOP_CHECKSIG\\u003c/code\\u003e (or \\u003ccode\\u003eOP_CHECKMULTISIG\\u003c/code\\u003e) consume stack element so \\u0026lt;invalid_sig\\u0026gt; and pubkey are dropped from the remainder of the Script, as it is executed. Though yes, there might have been a misunderstanding, on how much btcd’s equivalent of \\u003ccode\\u003eFindAndDelete\\u003c/code\\u003e i.e \\u003ccode\\u003eremoveOpcodeByData\\u003c/code\\u003e is really broken. Your initial description wasn’t that clear on that i.e “\\u003cem\\u003ewould remove any data push from the executed Script\\u003c/em\\u003e” which doesn’t say that data push removal was only stopping on currently executed \\u003ccode\\u003eOP_CHECKSIG\\u003c/code\\u003e, and not affecting further data push in the Script. Yes I can understand for the script kiddies.\\u003c/p\\u003e\\n\\u003cp\\u003eMore seriously than rambling on btcd brokeness, which is a wide subject, after re-checking and re-testing a lot of \\u003ccode\\u003eOP_CODESEPARATOR\\u003c/code\\u003e behaviors when used to spend \\u003ccode\\u003eSigVersion::Base\\u003c/code\\u003e in 27.x peers. Some behaviors are interesting, I’ll share it with you privately.\\u003c/p\\u003e\&quot;,\&quot;post_number\&quot;:10,\&quot;post_type\&quot;:1,\&quot;updated_at\&quot;:\&quot;2024-10-15T22:32:01.648Z\&quot;,\&quot;reply_count\&quot;:0,\&quot;reply_to_post_number\&quot;:9,\&quot;quote_count\&quot;:1,\&quot;incoming_link_count\&quot;:11,\&quot;reads\&quot;:33,\&quot;readers_count\&quot;:32,\&quot;score\&quot;:61.6,\&quot;yours\&quot;:false,\&quot;topic_id\&quot;:1184,\&quot;topic_slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;display_username\&quot;:\&quot;Antoine Riard\&quot;,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:null,\&quot;flair_url\&quot;:null,\&quot;flair_bg_color\&quot;:null,\&quot;flair_color\&quot;:null,\&quot;flair_group_id\&quot;:null,\&quot;badges_granted\&quot;:[],\&quot;version\&quot;:1,\&quot;can_edit\&quot;:false,\&quot;can_delete\&quot;:false,\&quot;can_recover\&quot;:false,\&quot;can_see_hidden_post\&quot;:false,\&quot;can_wiki\&quot;:false,\&quot;read\&quot;:true,\&quot;user_title\&quot;:null,\&quot;bookmarked\&quot;:false,\&quot;actions_summary\&quot;:[],\&quot;moderator\&quot;:false,\&quot;admin\&quot;:false,\&quot;staff\&quot;:false,\&quot;user_id\&quot;:5,\&quot;hidden\&quot;:false,\&quot;trust_level\&quot;:3,\&quot;deleted_at\&quot;:null,\&quot;user_deleted\&quot;:false,\&quot;edit_reason\&quot;:null,\&quot;can_view_edit_history\&quot;:true,\&quot;wiki\&quot;:false,\&quot;reactions\&quot;:[],\&quot;current_user_reaction\&quot;:null,\&quot;reaction_users_count\&quot;:0,\&quot;current_user_used_main_reaction\&quot;:false}],\&quot;stream\&quot;:[3340,3347,3349,3351,3354,3362,3364,3366,3367,3369]},\&quot;timeline_lookup\&quot;:[[1,93],[3,92],[5,91],[6,89],[7,88]],\&quot;suggested_topics\&quot;:[{\&quot;id\&quot;:1291,\&quot;title\&quot;:\&quot;Implementing a Bridge Covenant on OP_CAT-Enabled Bitcoin: A Proof of Concept\&quot;,\&quot;fancy_title\&quot;:\&quot;Implementing a Bridge Covenant on OP_CAT-Enabled Bitcoin: A Proof of Concept\&quot;,\&quot;slug\&quot;:\&quot;implementing-a-bridge-covenant-on-op-cat-enabled-bitcoin-a-proof-of-concept\&quot;,\&quot;posts_count\&quot;:1,\&quot;reply_count\&quot;:0,\&quot;highest_post_number\&quot;:1,\&quot;image_url\&quot;:\&quot;https://delvingbitcoin.org/uploads/default/optimized/1X/6237184880cae03e6432132350e41e4410af8e78_2_1024x576.png\&quot;,\&quot;created_at\&quot;:\&quot;2024-11-30T09:29:54.693Z\&quot;,\&quot;last_posted_at\&quot;:\&quot;2024-11-30T09:29:54.742Z\&quot;,\&quot;bumped\&quot;:true,\&quot;bumped_at\&quot;:\&quot;2024-11-30T09:29:54.742Z\&quot;,\&quot;archetype\&quot;:\&quot;regular\&quot;,\&quot;unseen\&quot;:false,\&quot;pinned\&quot;:false,\&quot;unpinned\&quot;:null,\&quot;visible\&quot;:true,\&quot;closed\&quot;:false,\&quot;archived\&quot;:false,\&quot;bookmarked\&quot;:null,\&quot;liked\&quot;:null,\&quot;tags\&quot;:[],\&quot;tags_descriptions\&quot;:{},\&quot;like_count\&quot;:0,\&quot;views\&quot;:181,\&quot;category_id\&quot;:8,\&quot;featured_link\&quot;:null,\&quot;posters\&quot;:[{\&quot;extras\&quot;:\&quot;latest single\&quot;,\&quot;description\&quot;:\&quot;Original Poster, Most Recent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:477,\&quot;username\&quot;:\&quot;sCrypt-ts\&quot;,\&quot;name\&quot;:\&quot;sCrypt\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/scrypt-ts/{size}/746_2.png\&quot;,\&quot;trust_level\&quot;:1}}]},{\&quot;id\&quot;:805,\&quot;title\&quot;:\&quot;Second Look at Weak Blocks\&quot;,\&quot;fancy_title\&quot;:\&quot;Second Look at Weak Blocks\&quot;,\&quot;slug\&quot;:\&quot;second-look-at-weak-blocks\&quot;,\&quot;posts_count\&quot;:22,\&quot;reply_count\&quot;:13,\&quot;highest_post_number\&quot;:22,\&quot;image_url\&quot;:null,\&quot;created_at\&quot;:\&quot;2024-04-16T16:51:26.194Z\&quot;,\&quot;last_posted_at\&quot;:\&quot;2024-06-20T03:18:30.173Z\&quot;,\&quot;bumped\&quot;:true,\&quot;bumped_at\&quot;:\&quot;2024-06-20T03:18:30.173Z\&quot;,\&quot;archetype\&quot;:\&quot;regular\&quot;,\&quot;unseen\&quot;:false,\&quot;pinned\&quot;:false,\&quot;unpinned\&quot;:null,\&quot;visible\&quot;:true,\&quot;closed\&quot;:false,\&quot;archived\&quot;:false,\&quot;bookmarked\&quot;:null,\&quot;liked\&quot;:null,\&quot;tags\&quot;:[],\&quot;tags_descriptions\&quot;:{},\&quot;like_count\&quot;:17,\&quot;views\&quot;:1491,\&quot;category_id\&quot;:8,\&quot;featured_link\&quot;:null,\&quot;posters\&quot;:[{\&quot;extras\&quot;:null,\&quot;description\&quot;:\&quot;Original Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:31,\&quot;username\&quot;:\&quot;instagibbs\&quot;,\&quot;name\&quot;:\&quot;Gregory Sanders\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/instagibbs/{size}/28_2.png\&quot;,\&quot;trust_level\&quot;:3}},{\&quot;extras\&quot;:null,\&quot;description\&quot;:\&quot;Frequent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:12,\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;,\&quot;flair_name\&quot;:\&quot;wg-consensus-cleanup\&quot;,\&quot;flair_url\&quot;:\&quot;/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png\&quot;,\&quot;flair_group_id\&quot;:43,\&quot;trust_level\&quot;:3}},{\&quot;extras\&quot;:null,\&quot;description\&quot;:\&quot;Frequent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:406,\&quot;username\&quot;:\&quot;mcelrath\&quot;,\&quot;name\&quot;:\&quot;Bob McElrath\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/mcelrath/{size}/521_2.png\&quot;,\&quot;trust_level\&quot;:2}},{\&quot;extras\&quot;:null,\&quot;description\&quot;:\&quot;Frequent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:372,\&quot;username\&quot;:\&quot;garlonicon\&quot;,\&quot;name\&quot;:\&quot;Garlo Nicon\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/g/278dde/{size}.png\&quot;,\&quot;trust_level\&quot;:2}},{\&quot;extras\&quot;:\&quot;latest\&quot;,\&quot;description\&quot;:\&quot;Most Recent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:3,\&quot;username\&quot;:\&quot;ajtowns\&quot;,\&quot;name\&quot;:\&quot;Anthony Towns\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/ajtowns/{size}/417_2.png\&quot;,\&quot;admin\&quot;:true,\&quot;moderator\&quot;:true,\&quot;trust_level\&quot;:4}}]},{\&quot;id\&quot;:1239,\&quot;title\&quot;:\&quot;Bitcoin Core 27.2 Released\&quot;,\&quot;fancy_title\&quot;:\&quot;Bitcoin Core 27.2 Released\&quot;,\&quot;slug\&quot;:\&quot;bitcoin-core-27-2-released\&quot;,\&quot;posts_count\&quot;:1,\&quot;reply_count\&quot;:0,\&quot;highest_post_number\&quot;:1,\&quot;image_url\&quot;:null,\&quot;created_at\&quot;:\&quot;2024-11-04T10:50:46.880Z\&quot;,\&quot;last_posted_at\&quot;:\&quot;2024-11-04T10:50:46.936Z\&quot;,\&quot;bumped\&quot;:true,\&quot;bumped_at\&quot;:\&quot;2024-11-04T10:50:46.936Z\&quot;,\&quot;archetype\&quot;:\&quot;regular\&quot;,\&quot;unseen\&quot;:false,\&quot;pinned\&quot;:false,\&quot;unpinned\&quot;:null,\&quot;visible\&quot;:true,\&quot;closed\&quot;:false,\&quot;archived\&quot;:false,\&quot;bookmarked\&quot;:null,\&quot;liked\&quot;:null,\&quot;tags\&quot;:[\&quot;announcement\&quot;,\&quot;bitcoin-core\&quot;],\&quot;tags_descriptions\&quot;:{},\&quot;like_count\&quot;:4,\&quot;views\&quot;:76,\&quot;category_id\&quot;:8,\&quot;featured_link\&quot;:null,\&quot;posters\&quot;:[{\&quot;extras\&quot;:\&quot;latest single\&quot;,\&quot;description\&quot;:\&quot;Original Poster, Most Recent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:188,\&quot;username\&quot;:\&quot;fanquake\&quot;,\&quot;name\&quot;:\&quot;\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/f/ad7895/{size}.png\&quot;,\&quot;trust_level\&quot;:3}}]},{\&quot;id\&quot;:807,\&quot;title\&quot;:\&quot;Bitcoin Core 27.0 released\&quot;,\&quot;fancy_title\&quot;:\&quot;Bitcoin Core 27.0 released\&quot;,\&quot;slug\&quot;:\&quot;bitcoin-core-27-0-released\&quot;,\&quot;posts_count\&quot;:1,\&quot;reply_count\&quot;:0,\&quot;highest_post_number\&quot;:1,\&quot;image_url\&quot;:null,\&quot;created_at\&quot;:\&quot;2024-04-17T09:38:50.150Z\&quot;,\&quot;last_posted_at\&quot;:\&quot;2024-04-17T09:38:50.240Z\&quot;,\&quot;bumped\&quot;:true,\&quot;bumped_at\&quot;:\&quot;2024-04-27T02:03:09.267Z\&quot;,\&quot;archetype\&quot;:\&quot;regular\&quot;,\&quot;unseen\&quot;:false,\&quot;pinned\&quot;:false,\&quot;unpinned\&quot;:null,\&quot;visible\&quot;:true,\&quot;closed\&quot;:false,\&quot;archived\&quot;:false,\&quot;bookmarked\&quot;:null,\&quot;liked\&quot;:null,\&quot;tags\&quot;:[\&quot;announcement\&quot;,\&quot;bitcoin-core\&quot;],\&quot;tags_descriptions\&quot;:{},\&quot;like_count\&quot;:14,\&quot;views\&quot;:423,\&quot;category_id\&quot;:8,\&quot;featured_link\&quot;:null,\&quot;posters\&quot;:[{\&quot;extras\&quot;:\&quot;latest single\&quot;,\&quot;description\&quot;:\&quot;Original Poster, Most Recent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:188,\&quot;username\&quot;:\&quot;fanquake\&quot;,\&quot;name\&quot;:\&quot;\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/f/ad7895/{size}.png\&quot;,\&quot;trust_level\&quot;:3}}]},{\&quot;id\&quot;:1177,\&quot;title\&quot;:\&quot;Non-disclosure of a consensus bug in btcd\&quot;,\&quot;fancy_title\&quot;:\&quot;Non-disclosure of a consensus bug in btcd\&quot;,\&quot;slug\&quot;:\&quot;non-disclosure-of-a-consensus-bug-in-btcd\&quot;,\&quot;posts_count\&quot;:8,\&quot;reply_count\&quot;:3,\&quot;highest_post_number\&quot;:9,\&quot;image_url\&quot;:null,\&quot;created_at\&quot;:\&quot;2024-10-03T14:19:37.709Z\&quot;,\&quot;last_posted_at\&quot;:\&quot;2024-10-23T20:35:37.116Z\&quot;,\&quot;bumped\&quot;:true,\&quot;bumped_at\&quot;:\&quot;2024-10-23T20:35:37.116Z\&quot;,\&quot;archetype\&quot;:\&quot;regular\&quot;,\&quot;unseen\&quot;:false,\&quot;pinned\&quot;:false,\&quot;unpinned\&quot;:null,\&quot;visible\&quot;:true,\&quot;closed\&quot;:false,\&quot;archived\&quot;:false,\&quot;bookmarked\&quot;:null,\&quot;liked\&quot;:null,\&quot;tags\&quot;:[\&quot;announcement\&quot;],\&quot;tags_descriptions\&quot;:{},\&quot;like_count\&quot;:8,\&quot;views\&quot;:895,\&quot;category_id\&quot;:8,\&quot;featured_link\&quot;:null,\&quot;posters\&quot;:[{\&quot;extras\&quot;:null,\&quot;description\&quot;:\&quot;Original Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:12,\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;,\&quot;flair_name\&quot;:\&quot;wg-consensus-cleanup\&quot;,\&quot;flair_url\&quot;:\&quot;/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png\&quot;,\&quot;flair_group_id\&quot;:43,\&quot;trust_level\&quot;:3}},{\&quot;extras\&quot;:null,\&quot;description\&quot;:\&quot;Frequent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:143,\&quot;username\&quot;:\&quot;roasbeef\&quot;,\&quot;name\&quot;:\&quot;\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/roasbeef/{size}/160_2.png\&quot;,\&quot;trust_level\&quot;:2}},{\&quot;extras\&quot;:null,\&quot;description\&quot;:\&quot;Frequent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:5,\&quot;username\&quot;:\&quot;ariard\&quot;,\&quot;name\&quot;:\&quot;Antoine Riard\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/a/c67d28/{size}.png\&quot;,\&quot;trust_level\&quot;:3}},{\&quot;extras\&quot;:null,\&quot;description\&quot;:\&quot;Frequent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:92,\&quot;username\&quot;:\&quot;josibake\&quot;,\&quot;name\&quot;:\&quot;josie\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/josibake/{size}/83_2.png\&quot;,\&quot;trust_level\&quot;:3}},{\&quot;extras\&quot;:\&quot;latest\&quot;,\&quot;description\&quot;:\&quot;Most Recent Poster\&quot;,\&quot;user\&quot;:{\&quot;id\&quot;:340,\&quot;username\&quot;:\&quot;real-or-random\&quot;,\&quot;name\&quot;:\&quot;Tim Ruffing\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/real-or-random/{size}/413_2.png\&quot;,\&quot;trust_level\&quot;:2}}]}],\&quot;tags\&quot;:[\&quot;announcement\&quot;],\&quot;tags_descriptions\&quot;:{},\&quot;id\&quot;:1184,\&quot;title\&quot;:\&quot;CVE-2024-38365 public disclosure (btcd `FindAndDelete` bug)\&quot;,\&quot;fancy_title\&quot;:\&quot;CVE-2024-38365 public disclosure (btcd `FindAndDelete` bug)\&quot;,\&quot;posts_count\&quot;:10,\&quot;created_at\&quot;:\&quot;2024-10-10T09:02:17.716Z\&quot;,\&quot;views\&quot;:756,\&quot;reply_count\&quot;:6,\&quot;like_count\&quot;:2,\&quot;last_posted_at\&quot;:\&quot;2024-10-15T22:32:01.648Z\&quot;,\&quot;visible\&quot;:true,\&quot;closed\&quot;:false,\&quot;archived\&quot;:false,\&quot;has_summary\&quot;:false,\&quot;archetype\&quot;:\&quot;regular\&quot;,\&quot;slug\&quot;:\&quot;cve-2024-38365-public-disclosure-btcd-findanddelete-bug\&quot;,\&quot;category_id\&quot;:8,\&quot;word_count\&quot;:1847,\&quot;deleted_at\&quot;:null,\&quot;user_id\&quot;:12,\&quot;featured_link\&quot;:null,\&quot;pinned_globally\&quot;:false,\&quot;pinned_at\&quot;:null,\&quot;pinned_until\&quot;:null,\&quot;image_url\&quot;:null,\&quot;slow_mode_seconds\&quot;:0,\&quot;draft\&quot;:null,\&quot;draft_key\&quot;:\&quot;topic_1184\&quot;,\&quot;draft_sequence\&quot;:null,\&quot;unpinned\&quot;:null,\&quot;pinned\&quot;:false,\&quot;current_post_number\&quot;:1,\&quot;highest_post_number\&quot;:10,\&quot;deleted_by\&quot;:null,\&quot;actions_summary\&quot;:[{\&quot;id\&quot;:4,\&quot;count\&quot;:0,\&quot;hidden\&quot;:false,\&quot;can_act\&quot;:false},{\&quot;id\&quot;:8,\&quot;count\&quot;:0,\&quot;hidden\&quot;:false,\&quot;can_act\&quot;:false},{\&quot;id\&quot;:10,\&quot;count\&quot;:0,\&quot;hidden\&quot;:false,\&quot;can_act\&quot;:false},{\&quot;id\&quot;:7,\&quot;count\&quot;:0,\&quot;hidden\&quot;:false,\&quot;can_act\&quot;:false}],\&quot;chunk_size\&quot;:20,\&quot;bookmarked\&quot;:false,\&quot;topic_timer\&quot;:null,\&quot;message_bus_last_id\&quot;:0,\&quot;participant_count\&quot;:3,\&quot;show_read_indicator\&quot;:false,\&quot;thumbnails\&quot;:null,\&quot;slow_mode_enabled_until\&quot;:null,\&quot;valid_reactions\&quot;:[\&quot;+1\&quot;,\&quot;heart\&quot;,\&quot;laughing\&quot;,\&quot;open_mouth\&quot;,\&quot;eyes\&quot;,\&quot;thinking\&quot;,\&quot;clap\&quot;,\&quot;tada\&quot;,\&quot;rocket\&quot;,\&quot;hugs\&quot;,\&quot;yawning_face\&quot;,\&quot;-1\&quot;,\&quot;sob\&quot;],\&quot;details\&quot;:{\&quot;can_edit\&quot;:false,\&quot;notification_level\&quot;:1,\&quot;participants\&quot;:[{\&quot;id\&quot;:12,\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;,\&quot;post_count\&quot;:5,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:\&quot;wg-consensus-cleanup\&quot;,\&quot;flair_url\&quot;:\&quot;/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png\&quot;,\&quot;flair_color\&quot;:\&quot;\&quot;,\&quot;flair_bg_color\&quot;:\&quot;\&quot;,\&quot;flair_group_id\&quot;:43,\&quot;trust_level\&quot;:3},{\&quot;id\&quot;:5,\&quot;username\&quot;:\&quot;ariard\&quot;,\&quot;name\&quot;:\&quot;Antoine Riard\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/a/c67d28/{size}.png\&quot;,\&quot;post_count\&quot;:4,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:null,\&quot;flair_url\&quot;:null,\&quot;flair_color\&quot;:null,\&quot;flair_bg_color\&quot;:null,\&quot;flair_group_id\&quot;:null,\&quot;trust_level\&quot;:3},{\&quot;id\&quot;:6,\&quot;username\&quot;:\&quot;harding\&quot;,\&quot;name\&quot;:\&quot;David A. Harding\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/harding/{size}/925_2.png\&quot;,\&quot;post_count\&quot;:1,\&quot;primary_group_name\&quot;:null,\&quot;flair_name\&quot;:null,\&quot;flair_url\&quot;:null,\&quot;flair_color\&quot;:null,\&quot;flair_bg_color\&quot;:null,\&quot;flair_group_id\&quot;:null,\&quot;trust_level\&quot;:3}],\&quot;created_by\&quot;:{\&quot;id\&quot;:12,\&quot;username\&quot;:\&quot;AntoineP\&quot;,\&quot;name\&quot;:\&quot;Antoine Poinsot\&quot;,\&quot;avatar_template\&quot;:\&quot;/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png\&quot;},\&quot;last_poster\&quot;:{\&quot;id\&quot;:5,\&quot;username\&quot;:\&quot;ariard\&quot;,\&quot;name\&quot;:\&quot;Antoine Riard\&quot;,\&quot;avatar_template\&quot;:\&quot;/letter_avatar_proxy/v4/letter/a/c67d28/{size}.png\&quot;},\&quot;links\&quot;:[{\&quot;url\&quot;:\&quot;https://github.com/btcsuite/btcd/pull/2178\&quot;,\&quot;title\&quot;:\&quot;Update standardness rules congruent to Bitcoin Core by ProofOfKeags · Pull Request #2178 · btcsuite/btcd · GitHub\&quot;,\&quot;internal\&quot;:false,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:41,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;github.com\&quot;,\&quot;root_domain\&quot;:\&quot;github.com\&quot;},{\&quot;url\&quot;:\&quot;https://github.com/btcsuite/btcd/commit/76339baf6c9407b073828245e3458f4df35190ae\&quot;,\&quot;title\&quot;:null,\&quot;internal\&quot;:false,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:25,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;github.com\&quot;,\&quot;root_domain\&quot;:\&quot;github.com\&quot;},{\&quot;url\&quot;:\&quot;https://wizardsardine.com/\&quot;,\&quot;title\&quot;:null,\&quot;internal\&quot;:false,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:11,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;wizardsardine.com\&quot;,\&quot;root_domain\&quot;:\&quot;wizardsardine.com\&quot;},{\&quot;url\&quot;:\&quot;https://en.bitcoin.it/wiki/OP_CHECKSIG#How_it_works\&quot;,\&quot;title\&quot;:null,\&quot;internal\&quot;:false,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:10,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;en.bitcoin.it\&quot;,\&quot;root_domain\&quot;:\&quot;bitcoin.it\&quot;},{\&quot;url\&quot;:\&quot;https://www.cve.org/CVERecord?id=CVE-2024-36051\&quot;,\&quot;title\&quot;:\&quot;CVE Website\&quot;,\&quot;internal\&quot;:false,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:8,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;www.cve.org\&quot;,\&quot;root_domain\&quot;:\&quot;cve.org\&quot;},{\&quot;url\&quot;:\&quot;https://github.com/btcsuite/btcd/security/advisories/GHSA-27vh-h6mc-q6g8\&quot;,\&quot;title\&quot;:\&quot;OP_CODESEPARATOR fuzzy match · Advisory · btcsuite/btcd · GitHub\&quot;,\&quot;internal\&quot;:false,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:8,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;github.com\&quot;,\&quot;root_domain\&quot;:\&quot;github.com\&quot;},{\&quot;url\&quot;:\&quot;https://github.com/btcsuite/btcd/releases/tag/v0.24.2\&quot;,\&quot;title\&quot;:null,\&quot;internal\&quot;:false,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:4,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;github.com\&quot;,\&quot;root_domain\&quot;:\&quot;github.com\&quot;},{\&quot;url\&quot;:\&quot;https://delvingbitcoin.org/t/great-consensus-cleanup-revival/710\&quot;,\&quot;title\&quot;:\&quot;Great Consensus Cleanup Revival\&quot;,\&quot;internal\&quot;:true,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:4,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;delvingbitcoin.org\&quot;,\&quot;root_domain\&quot;:\&quot;delvingbitcoin.org\&quot;},{\&quot;url\&quot;:\&quot;https://delvingbitcoin.org/t/non-disclosure-of-a-consensus-bug-in-btcd/1177/8\&quot;,\&quot;title\&quot;:\&quot;Non-disclosure of a consensus bug in btcd\&quot;,\&quot;internal\&quot;:true,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:true,\&quot;clicks\&quot;:3,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;delvingbitcoin.org\&quot;,\&quot;root_domain\&quot;:\&quot;delvingbitcoin.org\&quot;},{\&quot;url\&quot;:\&quot;https://brink.dev/\&quot;,\&quot;title\&quot;:null,\&quot;internal\&quot;:false,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:3,\&quot;user_id\&quot;:12,\&quot;domain\&quot;:\&quot;brink.dev\&quot;,\&quot;root_domain\&quot;:\&quot;brink.dev\&quot;},{\&quot;url\&quot;:\&quot;https://github.com/bitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329\&quot;,\&quot;title\&quot;:\&quot;bitcoin/src/script/interpreter.cpp at 48cf3da636089873ba7280e0d5b22eb81811d194 · bitcoin/bitcoin · GitHub\&quot;,\&quot;internal\&quot;:false,\&quot;attachment\&quot;:false,\&quot;reflection\&quot;:false,\&quot;clicks\&quot;:1,\&quot;user_id\&quot;:5,\&quot;domain\&quot;:\&quot;github.com\&quot;,\&quot;root_domain\&quot;:\&quot;github.com\&quot;}]},\&quot;bookmarks\&quot;:[]}&quot;}"></div>
      </discourse-assets-json>
      <discourse-assets-icons></discourse-assets-icons>
    </discourse-assets>

      

    
    <noscript data-path="/t/cve-2024-38365-public-disclosure-btcd-findanddelete-bug/1184">
      
        <header>
  <a href="/">
    Delving Bitcoin
  </a>
</header>


        <div id="main-outlet" class="wrap" role="main">
          <!-- preload-content: -->
            <div id="topic-title">
    <h1>
      <a href="/t/cve-2024-38365-public-disclosure-btcd-findanddelete-bug/1184">CVE-2024-38365 public disclosure (btcd `FindAndDelete` bug)</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="/c/implementation/8" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F7941D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Implementation</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='https://delvingbitcoin.org/tag/announcement' class='discourse-tag' rel="tag">announcement</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='CVE-2024-38365 public disclosure (btcd `FindAndDelete` bug)'>
      <link itemprop='url' href='https://delvingbitcoin.org/t/cve-2024-38365-public-disclosure-btcd-findanddelete-bug/1184'>
      <meta itemprop='datePublished' content='2024-10-10T09:02:17Z'>
        <meta itemprop='articleSection' content='Implementation'>
      <meta itemprop='keywords' content='announcement'>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='Delving Bitcoin'>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/AntoineP'><span itemprop='name'>AntoineP</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="https://delvingbitcoin.org/t/cve-2024-38365-public-disclosure-btcd-findanddelete-bug/1184">


              <span class="crawler-post-infos">
                  <time  datetime='2024-10-10T09:02:17Z' class='post-time'>
                    October 10, 2024,  9:02am
                  </time>
                  <meta itemprop='dateModified' content='2024-10-10T09:02:17Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This work is a collaboration between Niklas Gögge (<a href="https://brink.dev/">Brink</a>) and Antoine Poinsot (<a href="https://wizardsardine.com/">Wizardsardine</a>).</p>
<p>Btcd prior to version <a href="https://github.com/btcsuite/btcd/releases/tag/v0.24.2">0.24.2</a> does not correctly implement the consensus rules for legacy signature verification. The incompatible behavior can be triggered by a standard transaction, making it possible for anyone to fork off vulnerable btcd nodes at virtually no cost.</p>
<h1><a name="p-3340-details-1" class="anchor" href="#p-3340-details-1"></a>Details</h1>
<p>When verifying a signature for a transaction input, the script interpreter of a Bitcoin node re-constructs the signed message and checks the signature against it. The original algorithm for re-constructing the message is detailed in <a href="https://en.bitcoin.it/wiki/OP_CHECKSIG#How_it_works">this wiki page</a>. Notably, the signed message contains a commitment to the Script being executed. For legacy transaction inputs any occurrence of the signature being verified is first removed from the executed Script committed in the message. This is often referred to as the <code>FindAndDelete</code> behavior, named after the function implementing this in Satoshi Nakamoto’s original Bitcoin codebase.</p>
<p><code>removeOpcodeByData</code> is Btcd’s equivalent of Bitcoin Core’s <code>FindAndDelete</code>. Prior to version 0.24.2, <code>removeOpcodeByData</code> would remove any data push from the executed Script that <em>contains</em> the signature. Whereas Bitcoin Core’s (and Satoshi’s) <code>FindAndDelete</code> only removes exact matches. Using public key recovery it is possible to create a Script which contains a signature check and an extraneous data push which contains the signature itself and additional padding data. This Script can be committed to in a P2SH output which can be spent by a standard transaction which would be considered valid by Bitcoin Core and invalid by vulnerable Btcd nodes.</p>
<p>This bug was introduced in commit <a href="https://github.com/btcsuite/btcd/commit/76339baf6c9407b073828245e3458f4df35190ae"><code>76339baf6c9407b073828245e3458f4df35190ae</code></a> in 2014, in reaction to a new Bitcoin Core unit test demonstrating the original implementation was consensus-incompatible.</p>
<h1><a name="p-3340-credits-2" class="anchor" href="#p-3340-credits-2"></a>Credits</h1>
<p>Thanks to the Btcd maintainers for awarding us a bug bounty.</p>
<h1><a name="p-3340-timeline-3" class="anchor" href="#p-3340-timeline-3"></a>Timeline</h1>
<ul>
<li>2024-03-20 Niklas and Antoine discuss the quirks of Bitcoin Core’s <code>FindAndDelete</code> (in relation to Antoine’s research into the <a href="https://delvingbitcoin.org/t/great-consensus-cleanup-revival/710">worst case block validation time</a>) and decide to take a look at if Btcd got all the quirks right in their reimplementation</li>
<li>2024-03-22 Niklas and Antoine email a detailed report of the issue to Olaoluwa Osuntokun</li>
<li>2024-03-26 Olaoluwa acknowledges the issue and creates a discussion group with another Btcd maintainer</li>
<li>2024-05-07 Antoine reserves <a href="https://www.cve.org/CVERecord?id=CVE-2024-36051">CVE-2024-36051</a> through Mitre</li>
<li>2024-06-21 Laolu reserves <a href="https://github.com/btcsuite/btcd/security/advisories/GHSA-27vh-h6mc-q6g8">CVE-2024-38365</a> through Github</li>
<li>2024-04-26 A covert fix is included in PR <a href="https://github.com/btcsuite/btcd/pull/2178">#2178</a></li>
<li>2024-05-22 PR <a href="https://github.com/btcsuite/btcd/pull/2178">#2178</a> is merged</li>
<li>2024-06-25 Version 0.24.2 is released with the fix</li>
<li>2024-09-20 Public disclosure</li>
</ul>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://delvingbitcoin.org/t/non-disclosure-of-a-consensus-bug-in-btcd/1177/8">Non-disclosure of a consensus bug in btcd</a>
                        <meta itemprop='position' content='10'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/harding'><span itemprop='name'>harding</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-10-10T23:22:25Z' class='post-time'>
                    October 10, 2024, 11:22pm
                  </time>
                  <meta itemprop='dateModified' content='2024-10-10T23:22:25Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="AntoineP" data-post="1" data-topic="1184">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/antoinep/48/483_2.png" class="avatar"> AntoineP:</div>
<blockquote>
<p>Using public key recovery it is possible to create a Script which contains a signature check and an extraneous data push which contains the signature itself and additional padding data.</p>
</blockquote>
</aside>
<p>What is the public key recovery for?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/AntoineP'><span itemprop='name'>AntoineP</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-10-11T06:47:49Z' class='post-time'>
                    October 11, 2024,  6:47am
                  </time>
                  <meta itemprop='dateModified' content='2024-10-11T06:47:49Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>To have a valid signature in the scriptpubkey.</p>
<p>To exploit this you want to have a data push in the scriptpubkey which contains the signature among other dummy data and then execute the signature check. When checking the signature Bitcoin Core’s <code>FindAndDelete</code> won’t drop the data push from the signature hash, but btcd will before version 0.24.2.</p>
<p>To cause a chain split you not only want the sighash calculation to differ, you want it to lead to a different signature check result. The only way to have a valid signature in the scriptpubkey is to generate the signature first and then to recover a public key from it plus the sighash. By performing a public key recovery using Bitcoin Core’s sighash you’ll get a public key such as the signature check passes on Bitcoin Core but fails on btcd. And vice-versa.</p>
<p>I have a documented Bitcoin Core unit test as a patch which generates such a transaction, that we sent to Laolu as part of the original report. I’m hesitant to share it publicly though since it would simplify the job of a script kiddy who wants to be annoying. I’ll share the patch with you privately and share it on this thread later.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/ariard'><span itemprop='name'>ariard</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-10-11T19:08:26Z' class='post-time'>
                    October 11, 2024,  7:08pm
                  </time>
                  <meta itemprop='dateModified' content='2024-10-11T19:13:31Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <blockquote>
<p>and additional padding data.</p>
</blockquote>
<aside class="onebox githubblob" data-onebox-src="https://github.com/bitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329">
  <header class="source">

      <a href="https://github.com/bitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329" target="_blank" rel="noopener">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/bitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329" target="_blank" rel="noopener">bitcoin/bitcoin/blob/48cf3da636089873ba7280e0d5b22eb81811d194/src/script/interpreter.cpp#L329</a></h4>



    <pre class="onebox"><code class="lang-cpp">
      <ol class="start lines" start="319" style="counter-reset: li-counter 318 ;">
          <li></li>
          <li>static bool EvalChecksigPreTapscript(const valtype&amp; vchSig, const valtype&amp; vchPubKey, CScript::const_iterator pbegincodehash, CScript::const_iterator pend, unsigned int flags, const BaseSignatureChecker&amp; checker, SigVersion sigversion, ScriptError* serror, bool&amp; fSuccess)</li>
          <li>{</li>
          <li>    assert(sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0);</li>
          <li></li>
          <li>    // Subset of script starting at the most recent codeseparator</li>
          <li>    CScript scriptCode(pbegincodehash, pend);</li>
          <li></li>
          <li>    // Drop the signature in pre-segwit scripts but not segwit scripts</li>
          <li>    if (sigversion == SigVersion::BASE) {</li>
          <li class="selected">        int found = FindAndDelete(scriptCode, CScript() &lt;&lt; vchSig);</li>
          <li>        if (found &gt; 0 &amp;&amp; (flags &amp; SCRIPT_VERIFY_CONST_SCRIPTCODE))</li>
          <li>            return set_error(serror, SCRIPT_ERR_SIG_FINDANDDELETE);</li>
          <li>    }</li>
          <li></li>
          <li>    if (!CheckSignatureEncoding(vchSig, flags, serror) || !CheckPubKeyEncoding(vchPubKey, flags, sigversion, serror)) {</li>
          <li>        //serror is set</li>
          <li>        return false;</li>
          <li>    }</li>
          <li>    fSuccess = checker.CheckECDSASignature(vchSig, vchPubKey, scriptCode, sigversion);</li>
          <li></li>
      </ol>
    </code></pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>In my understanding of the bug, there is feeding of the two consensus-nodes, with the following
<code>scriptCode</code>, where the ECDSA sig and the "noise dummy data must match the length declared in
pushed bytes.</p>
<pre><code class="lang-auto">
  1-byte        1-byte       ECDSA sig-bytes   "noise" dummy data-bytes

OP_PUSHDATA1 &lt;bytes pushed&gt; &lt;signature&gt; &lt;padding data&gt;

</code></pre>
<p>One should note that ECDSA sig length is malleable.</p>
<p>The non-upgraded, pre-0.24.2 btcd peers should remove the whole data push containing
the consensus valid signatures, before it’s verified by the script interpreter. While
bitcoind peers can accept the valid signatures. I’m unsure that you really need public
key recovery to achieve that chain fork as a trick. I believe one has OP_PICK, OP_ROLL and other stack inspection opcodes available, that can be committed in the <code>scriptCode</code>.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/AntoineP'><span itemprop='name'>AntoineP</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-10-12T09:22:50Z' class='post-time'>
                    October 12, 2024,  9:22am
                  </time>
                  <meta itemprop='dateModified' content='2024-10-12T09:22:50Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="ariard" data-post="4" data-topic="1184">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/a/c67d28/48.png" class="avatar"> ariard:</div>
<blockquote>
<p>I’m unsure that you really need public key recovery to achieve that chain fork as a trick. I believe one has OP_PICK, OP_ROLL and other stack inspection opcodes available, that can be committed in the <code>scriptCode</code>.</p>
</blockquote>
</aside>
<p>No, it’s more fundamental than just which opcode to use. You commit to the signature in the <code>scriptCode</code>, which itself needs to commit to the <code>scriptCode</code>. Short of new signature modes (like <code>ANYPREVOUT</code>) which don’t commit to the <code>scriptCode</code> you need to use pubkey recovery.</p>
<p>Could you describe exactly how you think it’s possible to achieve the same without pubkey recovery?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/ariard'><span itemprop='name'>ariard</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-10-15T03:35:30Z' class='post-time'>
                    October 15, 2024,  3:35am
                  </time>
                  <meta itemprop='dateModified' content='2024-10-15T03:35:30Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <blockquote>
<p>You commit to the signature in the <code>scriptCode</code> , which itself needs to commit to the <code>scriptCode</code> .</p>
</blockquote>
<p>No, a signature does not need to commit to the <code>scriptCode</code> as one can use <code>OP_CODESEPARATOR</code> to spend pre-segwit script.</p>
<p>If you have a data push of the signature, then let the signature on the stack, then you have an <code>OP_CODESEPARATOR</code>, and then you have the <code>OP_CHECKSIG</code>. In that case shouldn’t the <code>pbegincodehash</code> making the <code>scriptCode</code> be only the <code>OP_CHECKSIG</code> itself, i.e a fixed-point ? The <code>OP_CHECKSIG</code> bitcoin core code is popping up the signature and pubkey from the stack, and <code>OP_CODESEPARATOR</code> is a null-op on the script stack.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/AntoineP'><span itemprop='name'>AntoineP</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-10-15T08:57:22Z' class='post-time'>
                    October 15, 2024,  8:57am
                  </time>
                  <meta itemprop='dateModified' content='2024-10-15T08:57:22Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="ariard" data-post="6" data-topic="1184">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/a/c67d28/48.png" class="avatar"> ariard:</div>
<blockquote>
<p>No, a signature does not need to commit to the <code>scriptCode</code> as one can use <code>OP_CODESEPARATOR</code> to spend pre-segwit script.</p>
</blockquote>
</aside>
<p>If you get the signature out of the <code>scriptCode</code> by using an <code>OP_CODESEPARATOR</code>, then you won’t be able to exploit the <code>FindAndDelete</code> discrepancy since there is no signature to find anymore.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/ariard'><span itemprop='name'>ariard</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-10-15T12:00:07Z' class='post-time'>
                    October 15, 2024, 12:00pm
                  </time>
                  <meta itemprop='dateModified' content='2024-10-15T12:00:07Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Right, unless you’re using an <code>OP_CODESEPARATOR</code> the signature should commit to the <code>scriptCode</code>. Though there is still the possibility that the signature is invalid w.r.t the <code>scriptCode</code> and the script execution still valid.</p>
<p>What if you have : &lt;invalid_sig+noise&gt; &lt;invalid_sig&gt;  &lt;OP_CHECKSIG&gt; &lt;OP_SIZE&gt; &lt;length_invalid_sig+noise&gt; OP_EQUALVERIFY.</p>
<p>In my understanding, core’ should only remove 1 instance of &lt;invalid_sig&gt;, fails on the CHECKSIG (though <code>NULLFAIL</code> policy only) and then succeed on the OP_SIZE. On the other hand, non-upgraded btcd should remove the 2 instances of &lt;invalid_sig&gt; (as invalid_sig+noise contains the invalid_sig) and fails the OP_SIZE + OP_EQUALVERIFY.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/AntoineP'><span itemprop='name'>AntoineP</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-10-15T13:09:04Z' class='post-time'>
                    October 15, 2024,  1:09pm
                  </time>
                  <meta itemprop='dateModified' content='2024-10-15T13:09:04Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="ariard" data-post="8" data-topic="1184">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/a/c67d28/48.png" class="avatar"> ariard:</div>
<blockquote>
<p>Though there is still the possibility that the signature is invalid w.r.t the <code>scriptCode</code> and the script execution still valid.</p>
</blockquote>
</aside>
<p>Sure, but what we want here is a different script execution between btcd and Core. In the context of this disclosure, this was only possible using a discrepancy in the <code>FindAndDelete</code> implementation therefore you need a signature to be found in the <code>scriptCode</code>. Further, you need the signature to be valid for either btcd or Core, which is only possible if you do public key recovery.</p>
<aside class="quote no-group" data-username="ariard" data-post="8" data-topic="1184">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/a/c67d28/48.png" class="avatar"> ariard:</div>
<blockquote>
<p>What if you have : &lt;invalid_sig+noise&gt; &lt;invalid_sig&gt; &lt;OP_CHECKSIG&gt; &lt;OP_SIZE&gt; &lt;length_invalid_sig+noise&gt; OP_EQUALVERIFY.</p>
<p>In my understanding, core’ should only remove 1 instance of &lt;invalid_sig&gt;, fails on the CHECKSIG (though <code>NULLFAIL</code> policy only) and then succeed on the OP_SIZE. On the other hand, non-upgraded btcd should remove the 2 instances of &lt;invalid_sig&gt; (as invalid_sig+noise contains the invalid_sig) and fails the OP_SIZE + OP_EQUALVERIFY.</p>
</blockquote>
</aside>
<p>I’m not sure what you are trying to get at since your Script is different from what i think you meant:</p>
<ul>
<li>Here the <code>CHECKSIG</code> would be executed taking <code>&lt;invalid_sig+noise&gt;</code> as signature and <code>&lt;invalid_sig&gt;</code> as public key, which is always going to push 0 on the stack;</li>
<li><code>OP_SIZE</code> would then be executed on the result of the <code>CHECKSIG</code>, which is always 0, and so would always return 0 as well;</li>
<li>Then <code>OP_EQUALVERIFY</code> would always fail since the length of the invalid sig + noise would never be 0.</li>
</ul>
<p>I assume you mean that running OP_CHECKSIG would drop the <code>&lt;invalid_sig&gt;</code> (in Bitcoin Core), or both <code>&lt;invalid_sig&gt;</code> and <code>&lt;invalid_sig + noise&gt;</code>, from the Script itself and lead to a discrepancy of the execution when asserting the size of the top element left on the stack. Then you are misunderstanding what <code>FindAndDelete</code> does. It does not tamper with the Script being executed at all, it only modifies a copy of it for the purpose of committing to it in the sighash. Even if your Script from above correctly implemented what i think you intended it to, it would not cause a different execution between btcd and Bitcoin Core: the executed script is always the same so the size of the top stack element would always be the same for both.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://delvingbitcoin.org/u/ariard'><span itemprop='name'>ariard</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-10-15T22:32:01Z' class='post-time'>
                    October 15, 2024, 10:32pm
                  </time>
                  <meta itemprop='dateModified' content='2024-10-15T22:32:01Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="AntoineP" data-post="9" data-topic="1184">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/antoinep/48/483_2.png" class="avatar"> AntoineP:</div>
<blockquote>
<p>Then you are misunderstanding what <code>FindAndDelete</code> does. It does not tamper with the Script being executed at all, it only modifies a copy of it for the purpose of committing to it in the sighash.</p>
</blockquote>
</aside>
<p>The <code>OP_CHECKSIG</code> (or <code>OP_CHECKMULTISIG</code>) consume stack element so &lt;invalid_sig&gt; and pubkey are dropped from the remainder of the Script, as it is executed. Though yes, there might have been a misunderstanding, on how much btcd’s equivalent of <code>FindAndDelete</code> i.e <code>removeOpcodeByData</code> is really broken. Your initial description wasn’t that clear on that i.e “<em>would remove any data push from the executed Script</em>” which doesn’t say that data push removal was only stopping on currently executed <code>OP_CHECKSIG</code>, and not affecting further data push in the Script. Yes I can understand for the script kiddies.</p>
<p>More seriously than rambling on btcd brokeness, which is a wide subject, after re-checking and re-testing a lot of <code>OP_CODESEPARATOR</code> behaviors when used to spend <code>SigVersion::Base</code> in 27.x peers. Some behaviors are interesting, I’ll share it with you privately.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




          <!-- :preload-content -->
        </div>

        <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    </noscript>

      

      

    <section id='main'>
    </section>

      <form id='hidden-login-form' method="post" action="/login" style="display: none;">
        <input name="username" type="text"     id="signin_username">
        <input name="password" type="password" id="signin_password">
        <input name="redirect" type="hidden">
        <input type="submit" id="signin-button" value="Log In">
      </form>

    <script defer src="/assets/start-discourse-9f921142b762fb91207051d0a28e571b9455bab74e7d0e03726024c286cff8d5.js" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

    

    <script defer src="/assets/browser-update-5faeb6403cf1359d9e201f096cc21a2cb3290010f06dac44d3d9c52210a05aac.js" nonce="kae8eP7buWZz8DbYU3vj6Unku"></script>

      

      

    <script nonce="kae8eP7buWZz8DbYU3vj6Unku">/* Workaround for https://bugs.webkit.org/show_bug.cgi?id=209261 */</script>
  </body>
</html>
