Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-3994

**Root Cause:** The vulnerability stems from insufficient input sanitization and output escaping of user-supplied attributes within the `tutor_instructor_list` shortcode of the Tutor LMS plugin.

**Weaknesses/Vulnerabilities Present:**
*   **Stored Cross-Site Scripting (XSS):**  The plugin fails to properly sanitize and escape user-supplied attributes used within the `tutor_instructor_list` shortcode. This allows the injection of arbitrary web scripts that are then stored in the database and executed whenever a user accesses the page containing the malicious shortcode.

**Impact of Exploitation:**
*   **Arbitrary Script Execution:** Successful exploitation allows attackers to inject and execute arbitrary JavaScript code in the context of the affected website.
*   **Account Takeover/Privilege Escalation:** An attacker can leverage XSS to potentially hijack user sessions, steal cookies, and gain unauthorized access to user accounts.
*   **Malware Distribution:** Attackers could redirect users to malicious sites or inject malicious content into the site.
*   **Website Defacement/Manipulation:** The website's content and appearance can be modified without authorization.

**Attack Vectors:**
*   **Shortcode Injection:** Attackers inject malicious code as shortcode attributes (within the `tutor_instructor_list` shortcode). This could occur by manipulating any area that accepts shortcodes, such as posts, pages, or widgets.

**Required Attacker Capabilities/Position:**
*   **Authenticated User (Contributor or higher):** The attacker needs to have an account on the WordPress site with at least "Contributor" level permissions or higher. This allows them to create or modify content where the malicious shortcode can be placed.

**Additional Notes:**
* The vulnerability is present in Tutor LMS plugin versions up to and including 2.6.2
* Version 2.7.0 addresses this vulnerability by implementing proper escaping.
* The vulnerable code is located in `templates/shortcode/instructor-filter.php`.
* The vulnerability was publicly disclosed on April 24, 2024.
* The patch was applied by changing  `echo ~~esc\_attr( 'data-' . $key . '="' . $value . '" ' )~~;` to `echo 'data-' . esc_attr( $key ) . '="' . esc_attr( $value ) . '" ';` which uses `esc_attr()` to escape the key and value.