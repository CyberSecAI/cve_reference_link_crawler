Based on the provided information, this content is related to CVE-2024-47719.

**Root cause of vulnerability:**
The vulnerability stems from an integer overflow in the `ALIGN()` macro within the `iopt_alloc_iova` function in the `drivers/iommu/iommufd/io_pagetable.c` file. This overflow occurs when userspace supplies a large iova and uptr value, leading to an excessively large target iova alignment.

**Weaknesses/vulnerabilities present:**
- Integer overflow in `ALIGN()` macro calculation.
- Inadequate validation of user-supplied iova and uptr values.
- Potential for memory corruption due to incorrect area range selection during allocation.

**Impact of exploitation:**
- Memory corruption could occur, as the overflow corrupts the selected area range during IOVA allocation.
- The system might become unstable and crash due to memory corruption.
- Denial of service is possible if the memory corruption leads to critical kernel data structures being overwritten.

**Attack vectors:**
- An attacker can exploit the vulnerability by crafting a malicious userspace application that provides specific iova and uptr values when calling the iommufd ioctl.

**Required attacker capabilities/position:**
- An attacker needs the ability to execute code in userspace.
- The attacker needs to have access to the iommufd interface.

**Additional details:**
- The vulnerability was discovered and reported by syzbot.
- The fix involves capping the automatic alignment to the huge page size to prevent overflows.
- The commit message explicitly mentions that "Huge automatic alignments can fragment and chew up the available IOVA space without any reason."
- The fix is included in multiple stable kernel releases.