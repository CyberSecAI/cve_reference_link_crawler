```
{
  "vulnerability": {
    "root_cause": "Insufficient input sanitization and output escaping on user supplied attributes in the EmbedPress PDF widget.",
    "weaknesses": [
      "Cross-Site Scripting (Stored XSS)"
    ],
    "impact": "An authenticated attacker with contributor-level or higher permissions can inject arbitrary web scripts into pages, which will execute when a user accesses the injected page.",
    "attack_vectors": [
      "The attack vector is a stored XSS vulnerability via the plugin's embed widget. An attacker injects malicious code into the plugin's settings.",
      "The malicious code is executed when a user visits the page containing the embedded content."
    ],
    "required_attacker_capabilities": "The attacker needs to be authenticated with contributor-level or above permissions to inject the malicious scripts."
  },
  "fix": {
    "remediation": "Update to version 3.9.11, or a newer patched version.",
        "diffs": [
            "embedpress/tags/3.9.11/EmbedPress/Elementor/Widgets/Embedpress\_Document.php",
            "embedpress/tags/3.9.11/EmbedPress/Elementor/Widgets/Embedpress\_Pdf.php",
            "embedpress/tags/3.9.11/EmbedPress/Ends/Back/Handler.php",
            "embedpress/tags/3.9.11/EmbedPress/Ends/Back/Settings/templates/general.php",
            "embedpress/tags/3.9.11/EmbedPress/Ends/Back/Settings/templates/opensea.php",
            "embedpress/tags/3.9.11/EmbedPress/Includes/Classes/Elementor\_Enhancer.php",
            "embedpress/tags/3.9.11/EmbedPress/Providers/OpenSea.php",
            "embedpress/tags/3.9.11/EmbedPress/Providers/Youtube.php",
            "embedpress/tags/3.9.11/EmbedPress/Shortcode.php",
            "embedpress/tags/3.9.11/Gutenberg/block-backend/block-embedpress.php",
            "embedpress/tags/3.9.11/Gutenberg/block-backend/block-wistia.php",
            "embedpress/tags/3.9.11/Gutenberg/dist/blocks.build.js",
            "embedpress/tags/3.9.11/Gutenberg/dist/blocks.style.build.css",
            "embedpress/tags/3.9.11/Gutenberg/plugin.php",
            "embedpress/tags/3.9.11/embedpress.php",
            "embedpress/tags/3.9.11/includes.php",
            "embedpress/tags/3.9.11/languages/embedpress.pot",
            "embedpress/tags/3.9.11/readme.txt",
            "trunk/EmbedPress/Elementor/Widgets/Embedpress\_Document.php",
            "trunk/EmbedPress/Elementor/Widgets/Embedpress\_Pdf.php",
            "trunk/EmbedPress/Ends/Back/Handler.php",
            "trunk/EmbedPress/Ends/Back/Settings/templates/general.php",
            "trunk/EmbedPress/Ends/Back/Settings/templates/opensea.php",
            "trunk/EmbedPress/Includes/Classes/Elementor\_Enhancer.php",
            "trunk/EmbedPress/Providers/OpenSea.php",
            "trunk/EmbedPress/Providers/Youtube.php",
            "trunk/EmbedPress/Shortcode.php",
            "trunk/Gutenberg/block-backend/block-embedpress.php",
            "trunk/Gutenberg/block-backend/block-wistia.php",
            "trunk/Gutenberg/dist/blocks.build.js",
            "trunk/Gutenberg/dist/blocks.style.build.css",
            "trunk/Gutenberg/plugin.php",
            "trunk/embedpress.php",
            "trunk/includes.php",
            "trunk/languages/embedpress.pot",
            "trunk/readme.txt"
        ]
  },
  "additional_information": {
    "wordfence_database_url": "https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/embedpress/embedpress-embed-pdf-google-docs-vimeo-wistia-embed-youtube-videos-audios-maps-embed-any-documents-in-gutenberg-elementor-3910-authenticated-contributor-stored-cross-site-scripting-via-embedpress-pdf-widget",
    "wordpress_plugin_url": "https://wordpress.org/plugins/embedpress",
    "trac_changeset_url":"https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3045489%40embedpress&new=3045489%40embedpress&sfp_email=&sfph_mail=",
    "trac_file_url":"https://plugins.trac.wordpress.org/browser/embedpress/tags/3.9.10/EmbedPress/Elementor/Widgets/Embedpress_Pdf.php#L688"
  }
}
```