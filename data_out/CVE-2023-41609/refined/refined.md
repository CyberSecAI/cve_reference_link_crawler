- **Root cause of vulnerability:** The `sanitize_url()` function in `/couch/functions.php` does not properly filter URLs, specifically it fails to filter `\\` characters. Although `https:\\www.bing.com` is not a valid URL, browsers correct it to `https://www.bing.com`, leading to an open redirect.
- **Weaknesses/vulnerabilities present:** Open redirect vulnerability due to insufficient input sanitization in the `sanitize_url()` function. The function uses a blacklist approach that fails to remove all malicious characters, especially backslashes.
- **Impact of exploitation:** Attackers can redirect users to malicious websites, potentially leading to phishing, XSS, and other attacks.
- **Attack vectors:** By crafting a URL with a `redirect` parameter containing a double backslash followed by the target malicious URL (e.g., `https:\\www.bing.com`). The victim would be redirected after logging into the system.
- **Required attacker capabilities/position:** The attacker needs to be able to craft a URL with the vulnerable `redirect` parameter. They also need to induce the victim to visit this crafted URL while logged in to the system.