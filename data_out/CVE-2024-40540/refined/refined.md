Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from the use of `${}` in the `mybatis-mappers/DeptMapper.xml` file to directly embed user-controlled input into an SQL query. Specifically, the `params.dataScope` parameter, which is part of a `Map` object within the `MyDept` class, is directly inserted into the SQL query without proper sanitization or parameterization. This allows for SQL injection attacks.

**Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The primary vulnerability is SQL injection due to the unsanitized use of `${}` for parameter substitution within the SQL query.
*   **Lack of Input Sanitization:** The application fails to sanitize or parameterize user-provided input before incorporating it into SQL queries.

**Impact of Exploitation:**

*   **Data Breach:** An attacker can exploit the SQL injection vulnerability to access, modify, or delete sensitive data stored in the database.
*   **Unauthorized Access:** The attacker can potentially gain unauthorized access to the application.
*   **Potential for Privilege Escalation:** By manipulating the database, the attacker may be able to escalate privileges within the application.
*   **Denial of Service:** It is also possible to achieve denial of service by crafting specific SQL queries

**Attack Vectors:**

*   **HTTP Parameter Manipulation:** The attack is launched via HTTP requests by manipulating the `params["dataScope"]` parameter within the request body.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs to have network access to the application in order to send malicious requests.
*   **Understanding of Application Structure:** The attacker must be able to understand that the `params["dataScope"]` parameter is passed into an SQL query.

**Technical Details:**

1.  **Vulnerable Code Location:**
    *   `mybatis-mappers/DeptMapper.xml:22` uses `${}` to inject `params.dataScope` into SQL.
    *   `com/codermy/myspringsecurityplus/admin/dao/DeptDao.java:20` declares the method using the mapper.
    *   `com/codermy/myspringsecurityplus/admin/service/impl/DeptServiceImpl.java:31` calls the vulnerable method.
    *   The controller layer allows the `myDept` parameter to be controlled, which contains the exploitable `params.dataScope`

2.  **Exploitation:**
    *   The attacker sets the value of `params["dataScope"]` to a malicious SQL payload within the HTTP request parameters.
    *   The application processes this data, inserting it directly into a SQL query via `${}`, and executes the attacker-crafted query.
    *   The provided example uses blind boolean injection and `sqlmap` to exploit the vulnerability

3. **Proof of Concept (PoC):**
    *   The provided PoC uses `http://localhost:8088/api/dept?params%5B%22dataScope%22%5D=1` to show how the `dataScope` parameter is passed.
    *   The `sqlmap` command `python3 sqlmap.py -r 1.txt --dbs -v 3` demonstrates how to use `sqlmap` with a captured request to further exploit the vulnerability.

The information in this document provides more detail than the basic CVE description.