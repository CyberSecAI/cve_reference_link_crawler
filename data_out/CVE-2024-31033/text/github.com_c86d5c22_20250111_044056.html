
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjwtk%2Fjjwt%2Fissues%2F930)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjwtk%2Fjjwt%2Fissues%2F930)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=jwtk%2Fjjwt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jwtk](/jwtk)
/
**[jjwt](/jwtk/jjwt)**
Public

* [Notifications](/login?return_to=%2Fjwtk%2Fjjwt) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fjwtk%2Fjjwt)
* [Star
   10.4k](/login?return_to=%2Fjwtk%2Fjjwt)

* [Code](/jwtk/jjwt)
* [Issues
  35](/jwtk/jjwt/issues)
* [Pull requests
  14](/jwtk/jjwt/pulls)
* [Discussions](/jwtk/jjwt/discussions)
* [Actions](/jwtk/jjwt/actions)
* [Projects
  0](/jwtk/jjwt/projects)
* [Wiki](/jwtk/jjwt/wiki)
* [Security](/jwtk/jjwt/security)
* [Insights](/jwtk/jjwt/pulse)

Additional navigation options

* [Code](/jwtk/jjwt)
* [Issues](/jwtk/jjwt/issues)
* [Pull requests](/jwtk/jjwt/pulls)
* [Discussions](/jwtk/jjwt/discussions)
* [Actions](/jwtk/jjwt/actions)
* [Projects](/jwtk/jjwt/projects)
* [Wiki](/jwtk/jjwt/wiki)
* [Security](/jwtk/jjwt/security)
* [Insights](/jwtk/jjwt/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjwtk%2Fjjwt%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjwtk%2Fjjwt%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE reported against 0.11.5 #930

Closed

[jimshowalter](/jimshowalter) opened this issue
Apr 2, 2024
· 7 comments

Closed

# [CVE reported against 0.11.5](#top) #930

[jimshowalter](/jimshowalter) opened this issue
Apr 2, 2024
· 7 comments

## Comments

[![@jimshowalter](https://avatars.githubusercontent.com/u/211780?s=80&u=d482b5eb4a72b86ca76bdff74e05b76c2b684b40&v=4)](/jimshowalter)

Copy link

### **[jimshowalter](/jimshowalter)** commented [Apr 2, 2024](#issue-2220910497) • edited Loading

| OSV dev started reporting this yesterday:  ``` io.jsonwebtoken:jjwt-impl:0.11.5:         GHSA-r65j-6h5f-4f92                 severity: MODERATE                 summary: JJWT improperly generates signing keys                 CVEs:                         https://nvd.nist.gov/vuln/detail/CVE-2024-31033  ```  Any chance of a fix in 0.11.x? We are currently unable to upgrade to 0.12.x due to breaking changes. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@lhazlewood](https://avatars.githubusercontent.com/u/121180?s=80&u=93b1efd7ef6c5d20f541b3a295b487afcaaee5ff&v=4)](/lhazlewood)

Copy link

Contributor

### **[lhazlewood](/lhazlewood)** commented [Apr 2, 2024](#issuecomment-2032699358) • edited Loading

| This is not a security issue, and I disagree with the reporter's assessment.  Why wasn't the JJWT team contacted before creating a CVE? Even if it was a security issue, which this one is not, that's irresponsible reporting, preventing a possible fix being released before public disclosure.  This is an invalid CVE report for a number of reasons:   1. The JJWT version used in the reporter's test code is more than *6 years old*, probably a 0.9.x release, and has been unsupported for many years. The same tests run against later/current JJWT versions fail. 2. The methods reported are already `@Deprecated` and documented accordingly because many people do not understand how to use Base64 in security contexts, presumably the CVE reporter as well. 3. **Base64 text in these contexts *is not* a key. It is an *encoding* of a key.**. If someone generates a random string to use as a key directly, as the reporter did in their report (instead of generating an actual key and then Base64-encoding it), they're fundamentally subverting the security model. It's not a library's fault that the library user a) purposefully breaks their own security model and b) completely ignores both the JavaDoc documentation *and* compiler warnings for the corresponding methods. 4. The preferred/recommended/documented methods accept an actual `Key` object, and have been in JJWT for many versions, long before 0.12. Interestingly, the reporter could create a valid `Key` by Base64-decoding their invalid test string and using the resulting raw bytes to create a `Key` object, and it's still the same problem. If you're purposefully trying to subvert your own key inputs, there's nothing a library can do about it. 5. EVEN if the generated string was malformed, it's Base64-decoded length in bits MUST be large enough for the associated signature algorithm, otherwise an exception is thrown by JJWT (a `WeakKeyException`), meaning the security model defined in the JWA RFC is still maintained. 6. The reporter was manipulating the key on the JWT *creation* side, again meaning the error is with the creation/issuer. As long as the key bit length is valid (and will be enforced per above), the generated JWT still reflects the intended security strength per the JWA RFC specification. It is not possible for the JWT recipient or man-in-the-middle to maliciously manipulate the JWT, retaining the associated algorithm's security properties, and it is still verifiable by any recipient with the same bit-for-bit decoded key.   We even have an entire section in our documentation about [Base64 in security contexts](https://github.com/jwtk/jjwt?tab=readme-ov-file#understanding-base64-in-security-contexts), which also the CVE reporter either ignored or failed to acknowledge.  As such the CVE is invalid and reflection of an invalid test due to lack of understanding of JJWT's API, it's clear documentation on recommended practices and deprecation, and the still validly-maintained security properties of the associated signature algorithm.  It feels very much a scenario of 'let me see if I can come up with a test case that breaks something I think is invalid without understanding how to use the library or read it's documentation or even historical GitHub issues'. A simple communication with the JJWT team or cursory search would have easily identified the invalid test. |
| --- |

 👍
9
 febkosq8, SMadani, isaacirvin, biehl1, gemstone-source, baobiao, SummerBootFramework, Thunderforge, and JelmenGuhlke reacted with thumbs up emoji

All reactions

* 👍
  9 reactions

Sorry, something went wrong.

[![@jimshowalter](https://avatars.githubusercontent.com/u/211780?s=80&u=d482b5eb4a72b86ca76bdff74e05b76c2b684b40&v=4)](/jimshowalter)

Copy link

Author

### **[jimshowalter](/jimshowalter)** commented [Apr 2, 2024](#issuecomment-2032785542)

| There's some way to challenge CVEs, but I don't know what it is. Have seen some CVEs with rebuttals attached.  FWIW, I'm just letting you know about the CVE. Had nothing to do with it. Am not even qualified to evaluate it. |
| --- |

 👍
1
 lhazlewood reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@lhazlewood](https://avatars.githubusercontent.com/u/121180?s=80&u=93b1efd7ef6c5d20f541b3a295b487afcaaee5ff&v=4)](/lhazlewood)

Copy link

Contributor

### **[lhazlewood](/lhazlewood)** commented [Apr 2, 2024](#issuecomment-2032812415) • edited Loading

| [@jimshowalter](https://github.com/jimshowalter) thanks so much, I definitely appreciate it!  I'm assuming you're good to go on your respective projects then? Is there anything I can help answer for you regarding API usages? |
| --- |

All reactions

Sorry, something went wrong.

[![@jimshowalter](https://avatars.githubusercontent.com/u/211780?s=80&u=d482b5eb4a72b86ca76bdff74e05b76c2b684b40&v=4)](/jimshowalter)

Copy link

Author

### **[jimshowalter](/jimshowalter)** commented [Apr 2, 2024](#issuecomment-2032985207)

| Yes, we're fine. We have a way to override.  There's some info here about disputing CVEs: [h2database/h2database#3686](https://github.com/h2database/h2database/issues/3686) |
| --- |

 👍
1
 lhazlewood reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@jimshowalter](https://avatars.githubusercontent.com/u/211780?s=40&u=d482b5eb4a72b86ca76bdff74e05b76c2b684b40&v=4)](/jimshowalter)
[jimshowalter](/jimshowalter)
closed this as [completed](/jwtk/jjwt/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Apr 2, 2024](#event-12331393909)

[![@lhazlewood](https://avatars.githubusercontent.com/u/121180?s=80&u=93b1efd7ef6c5d20f541b3a295b487afcaaee5ff&v=4)](/lhazlewood)

Copy link

Contributor

### **[lhazlewood](/lhazlewood)** commented [Apr 4, 2024](#issuecomment-2036161197)

| [@jimshowalter](https://github.com/jimshowalter) just an update: the CVE reporter has agreed that this was an erroneously created CVE, and they've agreed to mark this CVE to `REJECTED` status (it is currently marked as `DISPUTED`). They've also deleted their test project that was previously located at <https://github.com/2308652512/JJWT_BUG> since it didn't reflect tests with any recently supported JJWT release. The Mitre team responsible for reviews should (to the best of my knowledge) change status to `REJECTED` relatively soon. |
| --- |

 👍
8
 febkosq8, jimshowalter, isaacirvin, SMadani, bmarwell, varszegik, baobiao, and SummerBootFramework reacted with thumbs up emoji

All reactions

* 👍
  8 reactions

Sorry, something went wrong.

[![@bdemers](https://avatars.githubusercontent.com/u/99954?s=40&v=4)](/bdemers)
[bdemers](/bdemers)
mentioned this issue
[Apr 4, 2024](#ref-issue-2225455019)

[CVE-2024-31033 (v0.12.5)
#932](/jwtk/jjwt/issues/932)

Closed

[![@lhazlewood](https://avatars.githubusercontent.com/u/121180?s=40&u=93b1efd7ef6c5d20f541b3a295b487afcaaee5ff&v=4)](/lhazlewood)
[lhazlewood](/lhazlewood)
changed the title
~~CVE reported against 1.11.5~~
CVE reported against 0.11.5
[Apr 4, 2024](#event-12360592542)

[![@cwperks](https://avatars.githubusercontent.com/u/17432265?s=40&v=4)](/cwperks)
[cwperks](/cwperks)
mentioned this issue
[Apr 10, 2024](#ref-issue-2231068077)

[CVE-2024-31033 (High) detected in jjwt-impl-0.12.5.jar - autoclosed
opensearch-project/security#4222](/opensearch-project/security/issues/4222)

Closed

[![@Thunderforge](https://avatars.githubusercontent.com/u/6200170?s=80&u=9ec0d6d5313947fdcfb21b5cc0cca81f54b24d62&v=4)](/Thunderforge)

Copy link

### **[Thunderforge](/Thunderforge)** commented [Jun 18, 2024](#issuecomment-2176477968)

| The Mitre team responsible for reviews should (to the best of my knowledge) change status to `REJECTED` relatively soon.  [@lhazlewood](https://github.com/lhazlewood) How soon is "relatively soon"? Two and a half months later, it's still marked as `DISPUTED`. Our security scanning tools are still marking it as a problem in our apps, and it's a pain to cut through the red tape of convincing corporate that, no, this is not a real issue we need to deal with. |
| --- |

All reactions

Sorry, something went wrong.

[![@lhazlewood](https://avatars.githubusercontent.com/u/121180?s=80&u=93b1efd7ef6c5d20f541b3a295b487afcaaee5ff&v=4)](/lhazlewood)

Copy link

Contributor

### **[lhazlewood](/lhazlewood)** commented [Jun 18, 2024](#issuecomment-2176756312)

| [@Thunderforge](https://github.com/Thunderforge) I'm honestly as surprised as you that Mitre hasn't rejected it yet. I've contacted them two or three times (via the requisite form) to ask them to change the status given that the reporter agreed it was erroneous, but no-one at Mitre has replied to me. I could be wrong, but I *think* their process requires them to get additional confirmation directly from the reporter and they're waiting on that, but I don't think the reporter is communicating with them at all (since it doesn't benefit them in any way). Quite frustrating really.  Maybe someone other than me will have better luck by requesting rejection by filling out their form here:  <https://cveform.mitre.org>  and reflect the following:  [Pasted_Image_6_18_24__11_53 AM](https://private-user-images.githubusercontent.com/121180/340797274-6752f865-12cb-4990-897f-ab1520b70e71.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzA3NTUsIm5iZiI6MTczNjU3MDQ1NSwicGF0aCI6Ii8xMjExODAvMzQwNzk3Mjc0LTY3NTJmODY1LTEyY2ItNDk5MC04OTdmLWFiMTUyMGI3MGU3MS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwNDQwNTVaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1lNzdiZDZmYmQzYTg4MTYxZGI4ODQ3YjI2OGI5YTAyMzRjOWQ5ZDc2YTFhNmRhZThhNDBiYmUzZWM2NmRiY2I2JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.0p1mEgW7pRZAApjBA6MDLgxE-kvEn9P7cx2gkmz0cgk) |
| --- |

All reactions

Sorry, something went wrong.

[![@bdemers](https://avatars.githubusercontent.com/u/99954?s=40&v=4)](/bdemers)
[bdemers](/bdemers)
mentioned this issue
[Jul 23, 2024](#ref-issue-2425428188)

[Issues in upgrading to 0.12.6
#957](/jwtk/jjwt/issues/957)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fjwtk%2Fjjwt%2Fissues%2F930)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@lhazlewood](https://avatars.githubusercontent.com/u/121180?s=52&v=4)](/lhazlewood) [![@jimshowalter](https://avatars.githubusercontent.com/u/211780?s=52&v=4)](/jimshowalter) [![@Thunderforge](https://avatars.githubusercontent.com/u/6200170?s=52&v=4)](/Thunderforge)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

