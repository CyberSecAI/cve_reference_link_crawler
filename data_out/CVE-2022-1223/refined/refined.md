The provided content relates to CVE-2022-1223.

**Root cause of vulnerability:**
The vulnerability stems from incorrect privilege assignments within the phpipam application. Specifically, certain scripts were missing proper checks to ensure that the user had the necessary administrative privileges to access them.

**Weaknesses/vulnerabilities present:**
- **Insufficient Access Control:** The primary weakness is the lack of consistent and correct privilege checks in multiple PHP scripts. This allows users without administrative privileges to potentially access sensitive functions and data.
- **Inconsistent privilege checks**: Some scripts were missing the user session check

**Impact of exploitation:**
- **Unauthorized Access:** An attacker could potentially gain access to administrative functions and data by accessing the vulnerable scripts, leading to a compromise of the system.
- **Data Exposure:** Sensitive information could be exposed to unauthorized users if privilege checks are bypassed.

**Attack vectors:**
- **Direct Request to vulnerable scripts:** An attacker could directly access the vulnerable scripts through a web browser, or through crafted HTTP requests.

**Required attacker capabilities/position:**
- **User Account**: An attacker would require a valid user account on the phpipam system. However, no administrative privileges are required, as the vulnerability involves bypassing those checks.
- **Network Access:** The attacker must have network access to the phpipam application.

**Additional details:**
- The fix involves adding `$Admin->is_admin()` checks in several files, which ensures that only users with administrative privileges can execute the functionality in those files.
- The vulnerability was reported by faisalfs10x@gmail.com.
- The vulnerable files include:
    - `app/admin/import-export/generate-hosts.php`
    - `app/admin/import-export/generate-mysql.php`
    - `app/admin/import-export/generate-xls.php`
    - `app/dashboard/widgets/access_logs.php`
    - `app/dashboard/widgets/error_logs.php`
    - `app/subnets/addresses/export-subnet.php`
    - `app/tools/logs/show-logs.php`
    - `functions/classes/class.Admin.php`
    - `functions/classes/class.Result.php`