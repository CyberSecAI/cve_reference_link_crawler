
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F0xkol%2Frfc6056-device-tracker)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F0xkol%2Frfc6056-device-tracker)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=0xkol%2Frfc6056-device-tracker)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[0xkol](/0xkol)
/
**[rfc6056-device-tracker](/0xkol/rfc6056-device-tracker)**
Public

* [Notifications](/login?return_to=%2F0xkol%2Frfc6056-device-tracker) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2F0xkol%2Frfc6056-device-tracker)
* [Star
   15](/login?return_to=%2F0xkol%2Frfc6056-device-tracker)

An implementation of a device tracking technique based on Algorithm 4 (Double-Hash Port Selection) of RFC 6056.

### License

[MIT license](/0xkol/rfc6056-device-tracker/blob/main/LICENSE.md)

[15
stars](/0xkol/rfc6056-device-tracker/stargazers) [1
fork](/0xkol/rfc6056-device-tracker/forks) [Branches](/0xkol/rfc6056-device-tracker/branches) [Tags](/0xkol/rfc6056-device-tracker/tags) [Activity](/0xkol/rfc6056-device-tracker/activity)
 [Star](/login?return_to=%2F0xkol%2Frfc6056-device-tracker)

 [Notifications](/login?return_to=%2F0xkol%2Frfc6056-device-tracker) You must be signed in to change notification settings

* [Code](/0xkol/rfc6056-device-tracker)
* [Issues
  0](/0xkol/rfc6056-device-tracker/issues)
* [Pull requests
  0](/0xkol/rfc6056-device-tracker/pulls)
* [Actions](/0xkol/rfc6056-device-tracker/actions)
* [Projects
  0](/0xkol/rfc6056-device-tracker/projects)
* [Security](/0xkol/rfc6056-device-tracker/security)
* [Insights](/0xkol/rfc6056-device-tracker/pulse)

Additional navigation options

* [Code](/0xkol/rfc6056-device-tracker)
* [Issues](/0xkol/rfc6056-device-tracker/issues)
* [Pull requests](/0xkol/rfc6056-device-tracker/pulls)
* [Actions](/0xkol/rfc6056-device-tracker/actions)
* [Projects](/0xkol/rfc6056-device-tracker/projects)
* [Security](/0xkol/rfc6056-device-tracker/security)
* [Insights](/0xkol/rfc6056-device-tracker/pulse)

# 0xkol/rfc6056-device-tracker

    main[Branches](/0xkol/rfc6056-device-tracker/branches)[Tags](/0xkol/rfc6056-device-tracker/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[5 Commits](/0xkol/rfc6056-device-tracker/commits/main/) | | |
| [www](/0xkol/rfc6056-device-tracker/tree/main/www "www") | | [www](/0xkol/rfc6056-device-tracker/tree/main/www "www") |  |  |
| [.gitignore](/0xkol/rfc6056-device-tracker/blob/main/.gitignore ".gitignore") | | [.gitignore](/0xkol/rfc6056-device-tracker/blob/main/.gitignore ".gitignore") |  |  |
| [CVE-2022-32296\_tester.py](/0xkol/rfc6056-device-tracker/blob/main/CVE-2022-32296_tester.py "CVE-2022-32296_tester.py") | | [CVE-2022-32296\_tester.py](/0xkol/rfc6056-device-tracker/blob/main/CVE-2022-32296_tester.py "CVE-2022-32296_tester.py") |  |  |
| [LICENSE.md](/0xkol/rfc6056-device-tracker/blob/main/LICENSE.md "LICENSE.md") | | [LICENSE.md](/0xkol/rfc6056-device-tracker/blob/main/LICENSE.md "LICENSE.md") |  |  |
| [README.md](/0xkol/rfc6056-device-tracker/blob/main/README.md "README.md") | | [README.md](/0xkol/rfc6056-device-tracker/blob/main/README.md "README.md") |  |  |
| [go.mod](/0xkol/rfc6056-device-tracker/blob/main/go.mod "go.mod") | | [go.mod](/0xkol/rfc6056-device-tracker/blob/main/go.mod "go.mod") |  |  |
| [go.sum](/0xkol/rfc6056-device-tracker/blob/main/go.sum "go.sum") | | [go.sum](/0xkol/rfc6056-device-tracker/blob/main/go.sum "go.sum") |  |  |
| [tracker.go](/0xkol/rfc6056-device-tracker/blob/main/tracker.go "tracker.go") | | [tracker.go](/0xkol/rfc6056-device-tracker/blob/main/tracker.go "tracker.go") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# RFC 6056 Device Tracker

This repository contains a prototype implementation of a device tracking technique for Linux-based devices by exploiting Algorithm 4 ("Double-Hash Port Selection Algorithm") of [RFC 6056](https://www.rfc-editor.org/rfc/rfc6056.html). This algorithm is used in Linux for selecting TCP source ports starting from kernel version `5.12-rc1`.

The main idea is that we find hash collisions of the `G()` function when used with loopback TCP connections (`127.0.0.0/8` to `127.0.0.0/8`). These collisions are network independent: they rely only on the key used with `G()`, and as such, the set (or a subset) of `G()` collisions can be used as a device ID, for the lifetime of the key (in Linux, until the device is rebooted).

By sampling TCP source ports originated from the victim device and generated in an attacker-perscribed manner, we can detect the loopback collisions *remotely*. This allows us to track devices via the browser. Since we only care about the source port, a full TCP connection need not be established -- it suffices that the attacker will capture a TCP SYN packet originated from the victim device and then reset the connection.

This prototype contains a tracking server written in Go and a tracking client written in HTML+JavaScript. The Linux kernel issue is tracked as [CVE-2022-32296](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32296).

For full details and analysis of the attack, please refer to our paper "Device Tracking via Linux's New TCP Source Port Selection Algorithm" by Moshe Kol, Amit Klein and Yossi Gilad, to be presented on USENIX Security '23. An extended version of the paper is available on [arXiv](https://arxiv.org/pdf/2209.12993.pdf).

## Which Linux kernel versions are affected?

Linux switched from Algorithm 3 of RFC 6056 to Algorithm 4 starting from kernel version `5.12-rc1`, by commit 190cc82489f4 ("tcp: change source port randomizarion [sic] at connect() time").
The issue was [fixed](https://lwn.net/ml/linux-kernel/20220427065233.2075-1-w%401wt.eu/) in versions `5.17.9` (and above) and `5.15.41` (the LTS version that include the vulnerability).

To detect whether your Linux machine is vulnerable, you can use our tester, `CVE-2022-32296_tester.py`, that is available as a Python 3 script. It does not assume root privileges.

## Which browsers can be used for tracking?

We tested our prototype on Google Chrome v96.0.4664.110 and Mozilla Firefox v96.0. Our implementation works best on Chrome. (Please see the paper for details.)

## How long does it take to produce a device ID?

On Chrome, it takes between 5 to 15 seconds, depending on the RTT to the tracking server.

## What are the limitations of this technique?

Our technique relies on sampling TCP source ports originated from the tracked client. Consequently, a NAT device which rewrites TCP source ports causes our attack to fail. Similarly, our technique cannot track clients that connect via forward proxies, which establish a new TCP connection to the tracking server (instead of a direct connection from the client). In particular, Tor clients are not affected.

## How can I protect my system?

It's best that you update your Linux kernel to the patched versions: 5.17.9 (and above) or 5.15.41 (and above) if your system uses the 5.15 LTS branch.

## How can I experiment with this technique?

You can experiment with our prototype with the following steps:

1. Compile the tracker server and run it.

Compile the tracker server with:

```
$ sudo apt update
$ sudo apt install -y golang-go libpcap-dev

# On the project directory
$ go get github.com/google/gopacket
$ go get github.com/google/gopacket/pcap

# Now you can build the tracker
$ go build -o tracker tracker.go

```

Run the tracker server with:

```
sudo ./tracker -iface <capturing-interface>

```

To run the server on your loopback interface, replace `<capturing-interface>` with `lo`.

2. Access the tracker via the browser. (Make sure your OS runs on a vulnerable Linux kernel; You can use our tool `CVE-2022-32296_tester.py` to test that.)

3. Type the tracker IP address on the "Tracker address" field.

4. Hit "Fingerprint me!".

You should see the same fingerprint generated on each run.

## About

An implementation of a device tracking technique based on Algorithm 4 (Double-Hash Port Selection) of RFC 6056.

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/0xkol/rfc6056-device-tracker/activity)
### Stars

[**15**
stars](/0xkol/rfc6056-device-tracker/stargazers)
### Watchers

[**3**
watching](/0xkol/rfc6056-device-tracker/watchers)
### Forks

[**1**
fork](/0xkol/rfc6056-device-tracker/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2F0xkol%2Frfc6056-device-tracker&report=0xkol+%28user%29)

## [Releases](/0xkol/rfc6056-device-tracker/releases)

No releases published

## [Packages 0](/users/0xkol/packages?repo_name=rfc6056-device-tracker)

No packages published

## Languages

* [JavaScript
  58.4%](/0xkol/rfc6056-device-tracker/search?l=javascript)
* [Go
  33.0%](/0xkol/rfc6056-device-tracker/search?l=go)
* [Python
  6.6%](/0xkol/rfc6056-device-tracker/search?l=python)
* [HTML
  2.0%](/0xkol/rfc6056-device-tracker/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

