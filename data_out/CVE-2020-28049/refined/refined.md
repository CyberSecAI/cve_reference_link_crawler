Based on the provided content, here's an analysis of CVE-2020-28049:

**Root cause of vulnerability:**

*   A race condition exists in SDDM when creating the Xauthority file. SDDM passes the `-auth` and `-displayfd` command line arguments to the X server. The X server starts using the display file descriptor (`displayfd`), and SDDM waits for the display number to be received from the X server via `displayfd` before writing the Xauthority file specified by the `-auth` parameter.

**Weaknesses/vulnerabilities present:**

*   **Race Condition:** The time gap between the X server starting and the Xauthority file being written creates a window where no valid Xauthority file exists, while the X server is already running.
*   **Insufficient Access Control:** The X.Org server, when encountering a non-existent, empty, or incomplete Xauthority file, grants any connecting client access to the Xorg display, bypassing intended access restrictions.

**Impact of exploitation:**

*   **Privilege Escalation:** A local, unprivileged attacker can create an unauthorized connection to the X server, gaining access to the display.
*   **Information Leak:** Attackers can monitor or manipulate other user's X server applications, including capturing keyboard input, killing applications, changing window names, and reading/writing the clipboard/primary selection.
*   **Login Screen Capture:** Attackers can capture all input and output, including usernames and passwords, from the login screen.

**Attack vectors:**

*   **Local Access:** The attacker needs to have local access to the system.
*   **Timing:** The attacker must exploit the race condition when the X server is starting up, before the Xauthority file is fully written by SDDM.

**Required attacker capabilities/position:**

*   **Local User:** An unprivileged local user on the system can carry out the attack.
*   **Ability to Connect to X Server:** The attacker needs a way to connect to the X server during the vulnerable window of time (e.g., using a specifically crafted application that connects before the Xauthority is created).

**Additional Details:**

*   The vulnerability is triggered when the X server is started or restarted, and the race condition can be exploited once during boot or when the X server is restarted.
*   The greeter itself runs as the `sddm` user and does not have special privileges and doesn't immediately cause a privilege escalation to root.
*   The vulnerability is specific to SDDM; other display managers like gdm, xdm, lightdm, and lxdm are not affected by default.
*   The X server itself does have a mechanism to check the modification time of the Xauthority file and reload it, but this is not sufficient to prevent the race condition.
*   The fix involves ensuring that the Xauthority file is written before the X server allows connections.

**Summary of fixes:**

*   The fix for this issue involves SDDM ensuring that the Xauthority file is correctly written before the X server is allowed to accept connections.
*   SDDM v0.19.0 includes the fix for this issue
*   Patches have been backported to older versions of sddm in various distributions to mitigate this vulnerability.