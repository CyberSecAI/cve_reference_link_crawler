

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21335)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21335)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-21335](/browse/XWIKI-21335)

# Privilege escalation (PR) from account through UIExtension parameters

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21335 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [15.9-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.9-rc-1 "15.9-rc-1 "), [15.5.4](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.5.4 "15.5.4 "), [14.10.19](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.10.19 "14.10.19 ")
* **Affects Version/s:**
  4.2-milestone-3
* **Component/s:**
  [UI Extension](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22UI+Extension%22 "UI Extension User Interface Extenions module, allow to extend the default UI with components")
* **Labels:**
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attacker\_account](/issues/?jql=labels+%3D+attacker_account "attacker_account")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to reproduce:**

1. As a user without script or admin right, edit your user profile with the object editor.
2. Add a UIExtension object.
3. Set the values as follows:
   1. Extension Point ID: org.xwiki.platform.panels.Applications
   2. Extension ID: platform.panels.myFakeApplication
   3. Extension parameters:
      ```
      label=I got programming right: $services.security.authorization.hasAccess('programming')
      target=Main.WebHome
      targetQueryString=
      icon=icon:bomb
      ```
   4. Extension Scope: "Current User".
4. Save the document and open any document.

[![](https://jira.xwiki.org/secure/thumbnail/41654/_thumb_41654.png)](/secure/attachment/41654/41654_image-2023-09-20-14-58-11-158.png "image-2023-09-20-14-58-11-158.png")

**Expected result:**

No application entry is displayed or the Velocity code isn't executed.

**Actual result:**

A new entry is displayed in the application panel with label "I got programming right: true".

[![](https://jira.xwiki.org/secure/thumbnail/41653/_thumb_41653.png)](/secure/attachment/41653/41653_image-2023-09-20-14-58-45-296.png "image-2023-09-20-14-58-45-296.png")

I also reproduced this issue on XWiki 7.2 but I assume it is older. Here screenshots from 7.2:

[![](https://jira.xwiki.org/secure/thumbnail/41655/_thumb_41655.png)](/secure/attachment/41655/41655_screenshot-1.png "screenshot-1.png")

[![](https://jira.xwiki.org/secure/thumbnail/41651/_thumb_41651.png)](/secure/attachment/41651/41651_image-2023-09-20-15-00-03-535.png "image-2023-09-20-15-00-03-535.png")

The same issue can also be reproduce with other UI extension points like [export formats](https://www.xwiki.org/xwiki/bin/view/Documentation/DevGuide/ExtensionPoint/Export%20Formats/).

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/browse/XWIKI-21335?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/browse/XWIKI-21335?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/browse/XWIKI-21335?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/browse/XWIKI-21335?attachmentOrder=desc#attachmentmodule "Descending")
  + [Thumbnails](/browse/XWIKI-21335?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
  + [List](/browse/XWIKI-21335?attachmentViewMode=list#attachmentmodule "List")
  + [Download All](/secure/attachmentzip/71998.zip "Download all attachments as a ZIP file")

1. [![image-2023-09-20-14-58-11-158.png](https://jira.xwiki.org/secure/thumbnail/41654/_thumb_41654.png)](/secure/attachment/41654/image-2023-09-20-14-58-11-158.png "image-2023-09-20-14-58-11-158.png - Latest 20/Sep/23 14:58 - Michael Hamann")[image-2023-09-20-14-58-11-158.png](/secure/attachment/41654/image-2023-09-20-14-58-11-158.png "image-2023-09-20-14-58-11-158.png - Latest 20/Sep/23 14:58 - Michael Hamann")158 kB20/Sep/23 14:58
2. [![image-2023-09-20-14-58-45-296.png](https://jira.xwiki.org/secure/thumbnail/41653/_thumb_41653.png)](/secure/attachment/41653/image-2023-09-20-14-58-45-296.png "image-2023-09-20-14-58-45-296.png - Latest 20/Sep/23 14:58 - Michael Hamann")[image-2023-09-20-14-58-45-296.png](/secure/attachment/41653/image-2023-09-20-14-58-45-296.png "image-2023-09-20-14-58-45-296.png - Latest 20/Sep/23 14:58 - Michael Hamann")15 kB20/Sep/23 14:58
3. [![image-2023-09-20-14-59-41-772.png](https://jira.xwiki.org/secure/thumbnail/41652/_thumb_41652.png)](/secure/attachment/41652/image-2023-09-20-14-59-41-772.png "image-2023-09-20-14-59-41-772.png - Latest 20/Sep/23 14:59 - Michael Hamann")[image-2023-09-20-14-59-41-772.png](/secure/attachment/41652/image-2023-09-20-14-59-41-772.png "image-2023-09-20-14-59-41-772.png - Latest 20/Sep/23 14:59 - Michael Hamann")15 kB20/Sep/23 14:59
4. [![image-2023-09-20-15-00-03-535.png](https://jira.xwiki.org/secure/thumbnail/41651/_thumb_41651.png)](/secure/attachment/41651/image-2023-09-20-15-00-03-535.png "image-2023-09-20-15-00-03-535.png - Latest 20/Sep/23 15:00 - Michael Hamann")[image-2023-09-20-15-00-03-535.png](/secure/attachment/41651/image-2023-09-20-15-00-03-535.png "image-2023-09-20-15-00-03-535.png - Latest 20/Sep/23 15:00 - Michael Hamann")36 kB20/Sep/23 15:00
5. [![screenshot-1.png](https://jira.xwiki.org/secure/thumbnail/41655/_thumb_41655.png)](/secure/attachment/41655/screenshot-1.png "screenshot-1.png - Latest 20/Sep/23 15:01 - Michael Hamann")[screenshot-1.png](/secure/attachment/41655/screenshot-1.png "screenshot-1.png - Latest 20/Sep/23 15:01 - Michael Hamann")159 kB20/Sep/23 15:01
#### Issue Links

is caused by

![New Feature - A new feature of the product, which has yet to be developed.](/secure/viewavatar?size=xsmall&avatarId=13511&avatarType=issuetype "New Feature - A new feature of the product, which has yet to be developed.")
[XWIKI-649](/browse/XWIKI-649)
Mechanism for inserting custom content in pre-existing code

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Security Advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-c2gg-4gq4-jv5j)

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

20/Sep/23 15:01

Updated:

10/Apr/24 10:35

Resolved:

19/Oct/23 16:56

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

