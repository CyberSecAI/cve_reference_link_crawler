=== Content from git.kernel.org_016ab050_20250110_223738.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2021-11-22 12:47:40 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:19:01 +0100 |
| commit | [69f054d6642c8f6173724ce17e7ee3ff66b8f682](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682)) | |
| tree | [d098ef8efa0b956a598510158faff126525f60ca](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682) | |
| parent | [4355c9f343f90d879cdde497a1d1adc54ff813aa](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4355c9f343f90d879cdde497a1d1adc54ff813aa) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682&id2=4355c9f343f90d879cdde497a1d1adc54ff813aa)) | |
| download | [linux-69f054d6642c8f6173724ce17e7ee3ff66b8f682.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-69f054d6642c8f6173724ce17e7ee3ff66b8f682.tar.gz) | |

mac80211: track only QoS data frames for admission control[ Upstream commit d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a ]
For admission control, obviously all of that only works for
QoS data frames, otherwise we cannot even access the QoS
field in the header.
Syzbot reported (see below) an uninitialized value here due
to a status of a non-QoS nullfunc packet, which isn't even
long enough to contain the QoS header.
Fix this to only do anything for QoS data packets.
Reported-by: syzbot+614e82b88a1a4973e534@syzkaller.appspotmail.com
Fixes: 02219b3abca5 ("mac80211: add WMM admission control support")
Link: [https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0@changeid](https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682)

| -rw-r--r-- | [net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mac80211/mlme.c?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/net/mac80211/mlme.c b/net/mac80211/mlme.cindex cbcb60face2c5e..e5c4a72f8e5712 100644--- a/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=4355c9f343f90d879cdde497a1d1adc54ff813aa)+++ b/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=69f054d6642c8f6173724ce17e7ee3ff66b8f682)@@ -2351,11 +2351,18 @@ static void ieee80211\_sta\_tx\_wmm\_ac\_notify(struct ieee80211\_sub\_if\_data \*sdata, u16 tx\_time) { struct ieee80211\_if\_managed \*ifmgd = &sdata->u.mgd;- u16 tid = ieee80211\_get\_tid(hdr);- int ac = ieee80211\_ac\_from\_tid(tid);- struct ieee80211\_sta\_tx\_tspec \*tx\_tspec = &ifmgd->tx\_tspec[ac];+ u16 tid;+ int ac;+ struct ieee80211\_sta\_tx\_tspec \*tx\_tspec; unsigned long now = jiffies; + if (!ieee80211\_is\_data\_qos(hdr->frame\_control))+ return;++ tid = ieee80211\_get\_tid(hdr);+ ac = ieee80211\_ac\_from\_tid(tid);+ tx\_tspec = &ifmgd->tx\_tspec[ac];+ if (likely(!tx\_tspec->admitted\_time)) return; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 22:36:16 +0000



=== Content from git.kernel.org_1a789c79_20250110_223740.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=eed897a22230e3231a740eddd7d6d95ba476625f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eed897a22230e3231a740eddd7d6d95ba476625f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eed897a22230e3231a740eddd7d6d95ba476625f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eed897a22230e3231a740eddd7d6d95ba476625f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2021-11-22 12:47:40 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:30:52 +0100 |
| commit | [eed897a22230e3231a740eddd7d6d95ba476625f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eed897a22230e3231a740eddd7d6d95ba476625f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=eed897a22230e3231a740eddd7d6d95ba476625f)) | |
| tree | [462e1963e22eb56dd173d06ce0d632eab92f7d3f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eed897a22230e3231a740eddd7d6d95ba476625f) | |
| parent | [24983f750881b57f7476c51a3d07b08e017f425c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=24983f750881b57f7476c51a3d07b08e017f425c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eed897a22230e3231a740eddd7d6d95ba476625f&id2=24983f750881b57f7476c51a3d07b08e017f425c)) | |
| download | [linux-eed897a22230e3231a740eddd7d6d95ba476625f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-eed897a22230e3231a740eddd7d6d95ba476625f.tar.gz) | |

mac80211: track only QoS data frames for admission control[ Upstream commit d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a ]
For admission control, obviously all of that only works for
QoS data frames, otherwise we cannot even access the QoS
field in the header.
Syzbot reported (see below) an uninitialized value here due
to a status of a non-QoS nullfunc packet, which isn't even
long enough to contain the QoS header.
Fix this to only do anything for QoS data packets.
Reported-by: syzbot+614e82b88a1a4973e534@syzkaller.appspotmail.com
Fixes: 02219b3abca5 ("mac80211: add WMM admission control support")
Link: [https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0@changeid](https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eed897a22230e3231a740eddd7d6d95ba476625f)

| -rw-r--r-- | [net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mac80211/mlme.c?id=eed897a22230e3231a740eddd7d6d95ba476625f) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/net/mac80211/mlme.c b/net/mac80211/mlme.cindex 32bc30ec50ec96..7bd42827540ae6 100644--- a/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=24983f750881b57f7476c51a3d07b08e017f425c)+++ b/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=eed897a22230e3231a740eddd7d6d95ba476625f)@@ -2493,11 +2493,18 @@ static void ieee80211\_sta\_tx\_wmm\_ac\_notify(struct ieee80211\_sub\_if\_data \*sdata, u16 tx\_time) { struct ieee80211\_if\_managed \*ifmgd = &sdata->u.mgd;- u16 tid = ieee80211\_get\_tid(hdr);- int ac = ieee80211\_ac\_from\_tid(tid);- struct ieee80211\_sta\_tx\_tspec \*tx\_tspec = &ifmgd->tx\_tspec[ac];+ u16 tid;+ int ac;+ struct ieee80211\_sta\_tx\_tspec \*tx\_tspec; unsigned long now = jiffies; + if (!ieee80211\_is\_data\_qos(hdr->frame\_control))+ return;++ tid = ieee80211\_get\_tid(hdr);+ ac = ieee80211\_ac\_from\_tid(tid);+ tx\_tspec = &ifmgd->tx\_tspec[ac];+ if (likely(!tx\_tspec->admitted\_time)) return; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 22:36:18 +0000



=== Content from git.kernel.org_b9373a42_20250110_223736.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=42d08e97b196479f593499e887a9ab81446a34b9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=42d08e97b196479f593499e887a9ab81446a34b9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=42d08e97b196479f593499e887a9ab81446a34b9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=42d08e97b196479f593499e887a9ab81446a34b9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2021-11-22 12:47:40 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:32:38 +0100 |
| commit | [42d08e97b196479f593499e887a9ab81446a34b9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=42d08e97b196479f593499e887a9ab81446a34b9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=42d08e97b196479f593499e887a9ab81446a34b9)) | |
| tree | [e8e1cf604f3dceb63ca2f3f48e517a36b1269568](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=42d08e97b196479f593499e887a9ab81446a34b9) | |
| parent | [b08767936841fc1737a59a02e667b5b90d8155ee](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b08767936841fc1737a59a02e667b5b90d8155ee) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=42d08e97b196479f593499e887a9ab81446a34b9&id2=b08767936841fc1737a59a02e667b5b90d8155ee)) | |
| download | [linux-42d08e97b196479f593499e887a9ab81446a34b9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-42d08e97b196479f593499e887a9ab81446a34b9.tar.gz) | |

mac80211: track only QoS data frames for admission control[ Upstream commit d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a ]
For admission control, obviously all of that only works for
QoS data frames, otherwise we cannot even access the QoS
field in the header.
Syzbot reported (see below) an uninitialized value here due
to a status of a non-QoS nullfunc packet, which isn't even
long enough to contain the QoS header.
Fix this to only do anything for QoS data packets.
Reported-by: syzbot+614e82b88a1a4973e534@syzkaller.appspotmail.com
Fixes: 02219b3abca5 ("mac80211: add WMM admission control support")
Link: [https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0@changeid](https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=42d08e97b196479f593499e887a9ab81446a34b9)

| -rw-r--r-- | [net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mac80211/mlme.c?id=42d08e97b196479f593499e887a9ab81446a34b9) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/net/mac80211/mlme.c b/net/mac80211/mlme.cindex c0ea3b1aa9e1cd..dd42d83dbe33e3 100644--- a/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=b08767936841fc1737a59a02e667b5b90d8155ee)+++ b/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=42d08e97b196479f593499e887a9ab81446a34b9)@@ -2446,11 +2446,18 @@ static void ieee80211\_sta\_tx\_wmm\_ac\_notify(struct ieee80211\_sub\_if\_data \*sdata, u16 tx\_time) { struct ieee80211\_if\_managed \*ifmgd = &sdata->u.mgd;- u16 tid = ieee80211\_get\_tid(hdr);- int ac = ieee80211\_ac\_from\_tid(tid);- struct ieee80211\_sta\_tx\_tspec \*tx\_tspec = &ifmgd->tx\_tspec[ac];+ u16 tid;+ int ac;+ struct ieee80211\_sta\_tx\_tspec \*tx\_tspec; unsigned long now = jiffies; + if (!ieee80211\_is\_data\_qos(hdr->frame\_control))+ return;++ tid = ieee80211\_get\_tid(hdr);+ ac = ieee80211\_ac\_from\_tid(tid);+ tx\_tspec = &ifmgd->tx\_tspec[ac];+ if (likely(!tx\_tspec->admitted\_time)) return; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 22:36:13 +0000



=== Content from git.kernel.org_5c3494ca_20250110_223737.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=46b9e29db2012a4d2a40a26101862e002ccf387b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=46b9e29db2012a4d2a40a26101862e002ccf387b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=46b9e29db2012a4d2a40a26101862e002ccf387b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=46b9e29db2012a4d2a40a26101862e002ccf387b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2021-11-22 12:47:40 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-12-22 09:29:35 +0100 |
| commit | [46b9e29db2012a4d2a40a26101862e002ccf387b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=46b9e29db2012a4d2a40a26101862e002ccf387b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=46b9e29db2012a4d2a40a26101862e002ccf387b)) | |
| tree | [e0063bcc64361627271c5c203375e437fa4e5099](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=46b9e29db2012a4d2a40a26101862e002ccf387b) | |
| parent | [a6f18191c6c1d531907bbcb838d8959408f2fb53](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a6f18191c6c1d531907bbcb838d8959408f2fb53) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=46b9e29db2012a4d2a40a26101862e002ccf387b&id2=a6f18191c6c1d531907bbcb838d8959408f2fb53)) | |
| download | [linux-46b9e29db2012a4d2a40a26101862e002ccf387b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-46b9e29db2012a4d2a40a26101862e002ccf387b.tar.gz) | |

mac80211: track only QoS data frames for admission control[ Upstream commit d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a ]
For admission control, obviously all of that only works for
QoS data frames, otherwise we cannot even access the QoS
field in the header.
Syzbot reported (see below) an uninitialized value here due
to a status of a non-QoS nullfunc packet, which isn't even
long enough to contain the QoS header.
Fix this to only do anything for QoS data packets.
Reported-by: syzbot+614e82b88a1a4973e534@syzkaller.appspotmail.com
Fixes: 02219b3abca5 ("mac80211: add WMM admission control support")
Link: [https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0@changeid](https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=46b9e29db2012a4d2a40a26101862e002ccf387b)

| -rw-r--r-- | [net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mac80211/mlme.c?id=46b9e29db2012a4d2a40a26101862e002ccf387b) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/net/mac80211/mlme.c b/net/mac80211/mlme.cindex ccaf2389ccc1dc..5c727af01143fb 100644--- a/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=a6f18191c6c1d531907bbcb838d8959408f2fb53)+++ b/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=46b9e29db2012a4d2a40a26101862e002ccf387b)@@ -2418,11 +2418,18 @@ static void ieee80211\_sta\_tx\_wmm\_ac\_notify(struct ieee80211\_sub\_if\_data \*sdata, u16 tx\_time) { struct ieee80211\_if\_managed \*ifmgd = &sdata->u.mgd;- u16 tid = ieee80211\_get\_tid(hdr);- int ac = ieee80211\_ac\_from\_tid(tid);- struct ieee80211\_sta\_tx\_tspec \*tx\_tspec = &ifmgd->tx\_tspec[ac];+ u16 tid;+ int ac;+ struct ieee80211\_sta\_tx\_tspec \*tx\_tspec; unsigned long now = jiffies; + if (!ieee80211\_is\_data\_qos(hdr->frame\_control))+ return;++ tid = ieee80211\_get\_tid(hdr);+ ac = ieee80211\_ac\_from\_tid(tid);+ tx\_tspec = &ifmgd->tx\_tspec[ac];+ if (likely(!tx\_tspec->admitted\_time)) return; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 22:36:14 +0000



=== Content from git.kernel.org_8b6ccd72_20250110_223739.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Johannes Berg <johannes.berg@intel.com> | 2021-11-22 12:47:40 +0100 |
| --- | --- | --- |
| committer | Johannes Berg <johannes.berg@intel.com> | 2021-11-26 11:35:20 +0100 |
| commit | [d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a)) | |
| tree | [eb8cbea2692bad427ad6af964e7e938810a3c1ca](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a) | |
| parent | [48c06708e63e71b4395e4159797366aa03be10ff](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=48c06708e63e71b4395e4159797366aa03be10ff) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a&id2=48c06708e63e71b4395e4159797366aa03be10ff)) | |
| download | [linux-d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a.tar.gz) | |

mac80211: track only QoS data frames for admission controlFor admission control, obviously all of that only works for
QoS data frames, otherwise we cannot even access the QoS
field in the header.
Syzbot reported (see below) an uninitialized value here due
to a status of a non-QoS nullfunc packet, which isn't even
long enough to contain the QoS header.
Fix this to only do anything for QoS data packets.
Reported-by: syzbot+614e82b88a1a4973e534@syzkaller.appspotmail.com
Fixes: 02219b3abca5 ("mac80211: add WMM admission control support")
Link: [https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0@changeid](https://lore.kernel.org/r/20211122124737.dad29e65902a.Ieb04587afacb27c14e0de93ec1bfbefb238cc2a0%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a)

| -rw-r--r-- | [net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mac80211/mlme.c?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/net/mac80211/mlme.c b/net/mac80211/mlme.cindex 54ab0e1ef6ca58..37f7d975f3dac6 100644--- a/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=48c06708e63e71b4395e4159797366aa03be10ff)+++ b/[net/mac80211/mlme.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mac80211/mlme.c?id=d5e568c3a4ec2ddd23e7dc5ad5b0c64e4f22981a)@@ -2452,11 +2452,18 @@ static void ieee80211\_sta\_tx\_wmm\_ac\_notify(struct ieee80211\_sub\_if\_data \*sdata, u16 tx\_time) { struct ieee80211\_if\_managed \*ifmgd = &sdata->u.mgd;- u16 tid = ieee80211\_get\_tid(hdr);- int ac = ieee80211\_ac\_from\_tid(tid);- struct ieee80211\_sta\_tx\_tspec \*tx\_tspec = &ifmgd->tx\_tspec[ac];+ u16 tid;+ int ac;+ struct ieee80211\_sta\_tx\_tspec \*tx\_tspec; unsigned long now = jiffies; + if (!ieee80211\_is\_data\_qos(hdr->frame\_control))+ return;++ tid = ieee80211\_get\_tid(hdr);+ ac = ieee80211\_ac\_from\_tid(tid);+ tx\_tspec = &ifmgd->tx\_tspec[ac];+ if (likely(!tx\_tspec->admitted\_time)) return; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 22:36:16 +0000


