Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from insufficient input sanitization and output escaping of user-supplied attributes within the `wpgmza` shortcode of the WP Go Maps plugin.

**Weaknesses/Vulnerabilities:**

*   **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize shortcode attributes, allowing malicious JavaScript to be injected and stored in the database. This script will then execute when a user views a page containing the vulnerable shortcode.

**Impact of Exploitation:**

*   **Arbitrary Script Execution:** Successful exploitation allows attackers to inject and execute arbitrary web scripts in the context of the affected website.
*   **Potential for Malicious Actions:** This can lead to a range of malicious activities, including:
    *   Stealing user session cookies, potentially leading to account hijacking.
    *   Redirecting users to malicious websites.
    *   Defacing the website.
    *   Other actions that can compromise the security and integrity of the website and its users.

**Attack Vectors:**

*   **Shortcode Injection:** The primary attack vector is through the `wpgmza` shortcode.
*   **Malicious Attributes:** Attackers inject malicious JavaScript within the attributes of the `wpgmza` shortcode. For example, the `classname` attribute of the shortcode was vulnerable.
*   **Plugin's Shortcode Handler:** The plugin's shortcode handler doesn't sanitize or escape these attributes.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs to be an authenticated user with at least "contributor-level" access to the WordPress site. This allows the attacker to create or edit posts/pages and insert the malicious shortcode.

**Additional Notes:**
*   The vulnerability was found by Thanh Nam Tran, and reported via Wordfence.
*   The issue was fixed in version 9.0.37 of the plugin.
*   The provided code snippets show the vulnerable code (`class.shortcodes.php`) and the commit that fixed the issue. Specifically, the commit message mentions "Improved shortcode attribute security by escaping attributes further, based on recent security reports".
*   The vulnerability exists in all versions of the plugin up to and including 9.0.36.
*   The CVSS score is 6.4 (Medium).

This is a detailed description of the vulnerability, going beyond the basic description of the CVE.