

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3152853%2540the-events-calendar%26old%3D3152853%2540the-events-calendar)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3152851/the-events-calendar "Changeset 3152851 for the-events-calendar")
* [Next Change](/changeset/3152918/the-events-calendar "Changeset 3152918 for the-events-calendar") →

---

# Changeset [3152853](/changeset/3152853 "Show full changeset") for [the-events-calendar](/browser/the-events-calendar?rev=3152853 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/16/2024 05:11:29 PM
([4 months](/timeline?from=2024-09-16T17%3A11%3A29Z&precision=second "See timeline at 09/16/2024 05:11:29 PM") ago)

Author:
bordoni
Message:

Apply modifications to 6.6.4.1

Location:
[the-events-calendar/tags/6.6.4.1](/browser/the-events-calendar/tags/6.6.4.1?rev=3152853)
Files:

11 added
11 edited

* [common/src/Tribe/Main.php](/browser/the-events-calendar/tags/6.6.4.1/common/src/Tribe/Main.php?rev=3152853 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [common/src/Tribe/Repository.php](/browser/the-events-calendar/tags/6.6.4.1/common/src/Tribe/Repository.php?rev=3152853 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [common/vendor/composer/installed.php](/browser/the-events-calendar/tags/6.6.4.1/common/vendor/composer/installed.php?rev=3152853 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [lang/the-events-calendar-af.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-af.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-ary.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-ary.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-bs\_BA.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-bs_BA.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-cy.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-cy.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-eo.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-eo.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-es\_ES.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-es_ES.mo?rev=3152853 "Show entry in browser")
  (modified)
  ([previous](/browser/the-events-calendar/tags/6.6.4/lang/the-events-calendar-es_ES.mo?rev=3150170 "Show previous version in browser"))
* [lang/the-events-calendar-fa\_IR.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-fa_IR.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-hy.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-hy.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-id\_ID.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-id_ID.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-is\_IS.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-is_IS.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-lv.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-lv.mo?rev=3152853 "Show entry in browser")
  (added)
* [lang/the-events-calendar-nl\_NL.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-nl_NL.mo?rev=3152853 "Show entry in browser")
  (modified)
  ([previous](/browser/the-events-calendar/tags/6.6.4/lang/the-events-calendar-nl_NL.mo?rev=3150170 "Show previous version in browser"))
* [lang/the-events-calendar-nl\_NL\_formal.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-nl_NL_formal.mo?rev=3152853 "Show entry in browser")
  (modified)
  ([previous](/browser/the-events-calendar/tags/6.6.4/lang/the-events-calendar-nl_NL_formal.mo?rev=3150170 "Show previous version in browser"))
* [lang/the-events-calendar-sr\_RS.mo](/browser/the-events-calendar/tags/6.6.4.1/lang/the-events-calendar-sr_RS.mo?rev=3152853 "Show entry in browser")
  (added)
* [readme.txt](/browser/the-events-calendar/tags/6.6.4.1/readme.txt?rev=3152853 "Show entry in browser")
  (modified)
  ([2 diffs](#file17 "Show differences"))
* [src/Events/Custom\_Tables/V1/WP\_Query/Custom\_Tables\_Query.php](/browser/the-events-calendar/tags/6.6.4.1/src/Events/Custom_Tables/V1/WP_Query/Custom_Tables_Query.php?rev=3152853 "Show entry in browser")
  (modified)
  ([3 diffs](#file18 "Show differences"))
* [src/Tribe/Main.php](/browser/the-events-calendar/tags/6.6.4.1/src/Tribe/Main.php?rev=3152853 "Show entry in browser")
  (modified)
  ([1 diff](#file19 "Show differences"))
* [the-events-calendar.php](/browser/the-events-calendar/tags/6.6.4.1/the-events-calendar.php?rev=3152853 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [vendor/composer/installed.php](/browser/the-events-calendar/tags/6.6.4.1/vendor/composer/installed.php?rev=3152853 "Show entry in browser")
  (modified)
  ([2 diffs](#file21 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [the-events-calendar/tags/6.6.4.1/common/src/Tribe/Main.php](/changeset/3152853/the-events-calendar/tags/6.6.4.1/common/src/Tribe/Main.php "Show the changeset 3152853 restricted to the-events-calendar/tags/6.6.4.1/common/src/Tribe/Main.php")

  | [r3150170](/browser/the-events-calendar/tags/6.6.4/common/src/Tribe/Main.php?rev=3150170#L20 "Show revision 3150170 of this file in browser") | [r3152853](/browser/the-events-calendar/tags/6.6.4.1/common/src/Tribe/Main.php?rev=3152853#L20 "Show revision 3152853 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | const OPTIONNAMENETWORK = 'tribe\_events\_calendar\_network\_options'; |
  | 21 | 21 | const FEED\_URL          = 'https://theeventscalendar.com/feed/'; |
  | 22 |  | const VERSION           = '6.0.3'; |
  |  | 22 | const VERSION           = '6.0.3.1'; |
  | 23 | 23 |  |
  | 24 | 24 | protected $plugin\_context; |
* ## [the-events-calendar/tags/6.6.4.1/common/src/Tribe/Repository.php](/changeset/3152853/the-events-calendar/tags/6.6.4.1/common/src/Tribe/Repository.php "Show the changeset 3152853 restricted to the-events-calendar/tags/6.6.4.1/common/src/Tribe/Repository.php")

  | [r3123338](/browser/the-events-calendar/tags/6.6.0/common/src/Tribe/Repository.php?rev=3123338#L117 "Show revision 3123338 of this file in browser") | [r3152853](/browser/the-events-calendar/tags/6.6.4.1/common/src/Tribe/Repository.php?rev=3152853#L117 "Show revision 3152853 of this file in browser") |  |
  | --- | --- | --- |
  | 117 | 117 | 'meta\_not\_regexp\_or\_like', |
  | 118 | 118 | 'meta\_not\_equals\_regexp\_or\_like', |
  |  | 119 | 'order', |
  | 119 | 120 | 'taxonomy\_exists', |
  | 120 | 121 | 'taxonomy\_not\_exists', |
  | […](/browser/the-events-calendar/tags/6.6.0/common/src/Tribe/Repository.php?rev=3123338#L1990) | […](/browser/the-events-calendar/tags/6.6.4.1/common/src/Tribe/Repository.php?rev=3152853#L1991) |  |
  | 1990 | 1991 | $args = $this->build\_meta\_query( $meta\_key = $value, $meta\_value = $arg\_1, $compare ); |
  | 1991 | 1992 | break; |
  |  | 1993 | case 'order': |
  |  | 1994 | // Only allow ASC and DESC for order. |
  |  | 1995 | $args = [ 'order' => strtoupper( trim( $value ) ) === 'DESC' ? 'DESC' : 'ASC' ]; |
  |  | 1996 | break; |
  | 1992 | 1997 | case 'taxonomy\_exists': |
  | 1993 | 1998 | $args = $this->build\_tax\_query( $taxonomy = $value, $terms = $arg\_1, 'term\_id', 'EXISTS' ); |
* ## [the-events-calendar/tags/6.6.4.1/common/vendor/composer/installed.php](/changeset/3152853/the-events-calendar/tags/6.6.4.1/common/vendor/composer/installed.php "Show the changeset 3152853 restricted to the-events-calendar/tags/6.6.4.1/common/vendor/composer/installed.php")

  | [r3150170](/browser/the-events-calendar/tags/6.6.4/common/vendor/composer/installed.php?rev=3150170#L4 "Show revision 3150170 of this file in browser") | [r3152853](/browser/the-events-calendar/tags/6.6.4.1/common/vendor/composer/installed.php?rev=3152853#L4 "Show revision 3152853 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | 'pretty\_version' => 'dev-master', |
  | 5 | 5 | 'version' => 'dev-master', |
  | 6 |  | 'reference' => '~~1a2cd5517d2bcc81fd1e8b8ee7bf770a5cd4a874~~', |
  |  | 6 | 'reference' => '5663c5eb216cd4a7a8e234fbbefbd443999e3af0', |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/the-events-calendar/tags/6.6.4/common/vendor/composer/installed.php?rev=3150170#L130) | […](/browser/the-events-calendar/tags/6.6.4.1/common/vendor/composer/installed.php?rev=3152853#L130) |  |
  | 130 | 130 | 'pretty\_version' => 'dev-master', |
  | 131 | 131 | 'version' => 'dev-master', |
  | 132 |  | 'reference' => '~~1a2cd5517d2bcc81fd1e8b8ee7bf770a5cd4a874~~', |
  |  | 132 | 'reference' => '5663c5eb216cd4a7a8e234fbbefbd443999e3af0', |
  | 133 | 133 | 'type' => 'wordpress-plugin', |
  | 134 | 134 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
* ## [the-events-calendar/tags/6.6.4.1/readme.txt](/changeset/3152853/the-events-calendar/tags/6.6.4.1/readme.txt "Show the changeset 3152853 restricted to the-events-calendar/tags/6.6.4.1/readme.txt")

  | [r3150170](/browser/the-events-calendar/tags/6.6.4/readme.txt?rev=3150170#L4 "Show revision 3150170 of this file in browser") | [r3152853](/browser/the-events-calendar/tags/6.6.4.1/readme.txt?rev=3152853#L4 "Show revision 3152853 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tags: events, calendar, event, schedule, organizer |
  | 5 | 5 | Donate link: https://evnt.is/29 |
  | 6 |  | Stable tag: 6.6.4 |
  |  | 6 | Stable tag: 6.6.4.1 |
  | 7 | 7 | Requires at least: 6.3 |
  | 8 | 8 | Tested up to: 6.6.1 |
  | […](/browser/the-events-calendar/tags/6.6.4/readme.txt?rev=3150170#L240) | […](/browser/the-events-calendar/tags/6.6.4.1/readme.txt?rev=3152853#L240) |  |
  | 240 | 240 | == Changelog == |
  | 241 | 241 |  |
  |  | 242 | = [6.6.4.1] 2024-09-16 = |
  |  | 243 |  |
  |  | 244 | \* Security - Improve general escaping for ORM queries to prevent legacy Events methods to be used for SQL injections. |
  |  | 245 |  |
  | 242 | 246 | = [6.6.4] 2024-09-11 = |
  | 243 | 247 |  |
* ## [the-events-calendar/tags/6.6.4.1/src/Events/Custom\_Tables/V1/WP\_Query/Custom\_Tables\_Query.php](/changeset/3152853/the-events-calendar/tags/6.6.4.1/src/Events/Custom_Tables/V1/WP_Query/Custom_Tables_Query.php "Show the changeset 3152853 restricted to the-events-calendar/tags/6.6.4.1/src/Events/Custom_Tables/V1/WP_Query/Custom_Tables_Query.php")

  | [r3121574](/browser/the-events-calendar/tags/6.5.2/src/Events/Custom_Tables/V1/WP_Query/Custom_Tables_Query.php?rev=3121574#L363 "Show revision 3121574 of this file in browser") | [r3152853](/browser/the-events-calendar/tags/6.6.4.1/src/Events/Custom_Tables/V1/WP_Query/Custom_Tables_Query.php?rev=3152853#L363 "Show revision 3152853 of this file in browser") |  |
  | --- | --- | --- |
  | 363 | 363 | $occurrences = Occurrences::table\_name( true ); |
  | 364 | 364 | $order = $normalized\_order\_by['ID'] ?? $normalized\_order\_by[ $wpdb->posts . '.ID' ] ?? 'DESC'; |
  |  | 365 |  |
  |  | 366 | $order = $this->sanitize\_order( $order ); |
  | 365 | 367 |  |
  | 366 | 368 | // The second `order` is omitted: it will be added by the following `parse\_order` call. |
  | […](/browser/the-events-calendar/tags/6.5.2/src/Events/Custom_Tables/V1/WP_Query/Custom_Tables_Query.php?rev=3121574#L699) | […](/browser/the-events-calendar/tags/6.6.4.1/src/Events/Custom_Tables/V1/WP_Query/Custom_Tables_Query.php?rev=3152853#L701) |  |
  | 699 | 701 |  |
  | 700 | 702 | // Each `ORDER BY` entry could specify an order (DESC|ASC) or not. |
  | 701 |  | if ( preg\_match( '~~~(?<orderby>.\*?)\s?(?<order>ASC|DESC~~)$~i', $orderby\_frag, $m ) ) { |
  |  | 703 | if ( preg\_match( '~\s\*(?<orderby>[^\s]+]?)\s+(?<order>.+)$~i', $orderby\_frag, $m ) ) { |
  | 702 | 704 | $orderby = trim( $m['orderby'] ); |
  | 703 |  | $order = ~~trim~~( $m['order'] ); |
  |  | 705 | $order = $this->sanitize\_order( $m['order'] ); |
  | 704 | 706 | } else { |
  | 705 | 707 | // Follow the WordPress default and use DESC if no order is specified. |
  | […](/browser/the-events-calendar/tags/6.5.2/src/Events/Custom_Tables/V1/WP_Query/Custom_Tables_Query.php?rev=3121574#L722) | […](/browser/the-events-calendar/tags/6.6.4.1/src/Events/Custom_Tables/V1/WP_Query/Custom_Tables_Query.php?rev=3152853#L724) |  |
  | 722 | 724 | return $redirected\_orderbys; |
  | 723 | 725 | } |
  |  | 726 |  |
  |  | 727 | /\*\* |
  |  | 728 | \* Sanitizes the order direction. |
  |  | 729 | \* |
  |  | 730 | \* @since TBD |
  |  | 731 | \* |
  |  | 732 | \* @param string $order The order direction to sanitize. |
  |  | 733 | \* |
  |  | 734 | \* @return string The sanitized order direction. |
  |  | 735 | \*/ |
  |  | 736 | protected function sanitize\_order( $order ) { |
  |  | 737 | return strtoupper( trim( $order ) ) === 'DESC' ? 'DESC' : 'ASC'; |
  |  | 738 | } |
  | 724 | 739 | } |
* ## [the-events-calendar/tags/6.6.4.1/src/Tribe/Main.php](/changeset/3152853/the-events-calendar/tags/6.6.4.1/src/Tribe/Main.php "Show the changeset 3152853 restricted to the-events-calendar/tags/6.6.4.1/src/Tribe/Main.php")

  | [r3150170](/browser/the-events-calendar/tags/6.6.4/src/Tribe/Main.php?rev=3150170#L40 "Show revision 3150170 of this file in browser") | [r3152853](/browser/the-events-calendar/tags/6.6.4.1/src/Tribe/Main.php?rev=3152853#L40 "Show revision 3152853 of this file in browser") |  |
  | --- | --- | --- |
  | 40 | 40 | const VENUE\_POST\_TYPE     = 'tribe\_venue'; |
  | 41 | 41 | const ORGANIZER\_POST\_TYPE = 'tribe\_organizer'; |
  | 42 |  | const VERSION             = '6.6.4'; |
  |  | 42 | const VERSION             = '6.6.4.1'; |
  | 43 | 43 |  |
  | 44 | 44 | /\*\* |
* ## [the-events-calendar/tags/6.6.4.1/the-events-calendar.php](/changeset/3152853/the-events-calendar/tags/6.6.4.1/the-events-calendar.php "Show the changeset 3152853 restricted to the-events-calendar/tags/6.6.4.1/the-events-calendar.php")

  | [r3150170](/browser/the-events-calendar/tags/6.6.4/the-events-calendar.php?rev=3150170#L3 "Show revision 3150170 of this file in browser") | [r3152853](/browser/the-events-calendar/tags/6.6.4.1/the-events-calendar.php?rev=3152853#L3 "Show revision 3152853 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* Plugin Name: The Events Calendar |
  | 4 | 4 | \* Description: The Events Calendar is a carefully crafted, extensible plugin that lets you easily share your events. Beautiful. Solid. Awesome. |
  | 5 |  | \* Version: 6.6.4 |
  |  | 5 | \* Version: 6.6.4.1 |
  | 6 | 6 | \* Requires at least: 6.3 |
  | 7 | 7 | \* Requires PHP: 7.4 |
* ## [the-events-calendar/tags/6.6.4.1/vendor/composer/installed.php](/changeset/3152853/the-events-calendar/tags/6.6.4.1/vendor/composer/installed.php "Show the changeset 3152853 restricted to the-events-calendar/tags/6.6.4.1/vendor/composer/installed.php")

  | [r3150170](/browser/the-events-calendar/tags/6.6.4/vendor/composer/installed.php?rev=3150170#L4 "Show revision 3150170 of this file in browser") | [r3152853](/browser/the-events-calendar/tags/6.6.4.1/vendor/composer/installed.php?rev=3152853#L4 "Show revision 3152853 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | 'pretty\_version' => 'dev-master', |
  | 5 | 5 | 'version' => 'dev-master', |
  | 6 |  | 'reference' => '~~b09f9799101bf3ebb9684f94eeccb99ac62fac0e~~', |
  |  | 6 | 'reference' => '419965a87d99195ad3fca22738e19dd287051f1c', |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/the-events-calendar/tags/6.6.4/vendor/composer/installed.php?rev=3150170#L14) | […](/browser/the-events-calendar/tags/6.6.4.1/vendor/composer/installed.php?rev=3152853#L14) |  |
  | 14 | 14 | 'pretty\_version' => 'dev-master', |
  | 15 | 15 | 'version' => 'dev-master', |
  | 16 |  | 'reference' => '~~b09f9799101bf3ebb9684f94eeccb99ac62fac0e~~', |
  |  | 16 | 'reference' => '419965a87d99195ad3fca22738e19dd287051f1c', |
  | 17 | 17 | 'type' => 'wordpress-plugin', |
  | 18 | 18 | 'install\_path' => \_\_DIR\_\_ . '/../../', |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3152853)
* [Zip Archive](?format=zip&new=3152853)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

