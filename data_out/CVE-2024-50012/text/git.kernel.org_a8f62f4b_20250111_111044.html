

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c0f02536fffbbec71aced36d52a765f8c4493dc2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c0f02536fffbbec71aced36d52a765f8c4493dc2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c0f02536fffbbec71aced36d52a765f8c4493dc2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c0f02536fffbbec71aced36d52a765f8c4493dc2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Miquel Sabaté Solà <mikisabate@gmail.com> | 2024-09-17 15:42:46 +0200 |
| --- | --- | --- |
| committer | Rafael J. Wysocki <rafael.j.wysocki@intel.com> | 2024-10-01 20:43:44 +0200 |
| commit | [c0f02536fffbbec71aced36d52a765f8c4493dc2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c0f02536fffbbec71aced36d52a765f8c4493dc2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c0f02536fffbbec71aced36d52a765f8c4493dc2)) | |
| tree | [b0096f7280ab03428a790605d09af3cd94b5e4f5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c0f02536fffbbec71aced36d52a765f8c4493dc2) | |
| parent | [8b4865cd904650cbed7f2407e653934c621b8127](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8b4865cd904650cbed7f2407e653934c621b8127) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c0f02536fffbbec71aced36d52a765f8c4493dc2&id2=8b4865cd904650cbed7f2407e653934c621b8127)) | |
| download | [linux-c0f02536fffbbec71aced36d52a765f8c4493dc2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c0f02536fffbbec71aced36d52a765f8c4493dc2.tar.gz) | |

cpufreq: Avoid a bad reference count on CPU nodeIn the parse\_perf\_domain function, if the call to
of\_parse\_phandle\_with\_args returns an error, then the reference to the
CPU device node that was acquired at the start of the function would not
be properly decremented.
Address this by declaring the variable with the \_\_free(device\_node)
cleanup attribute.
Signed-off-by: Miquel Sabaté Solà <mikisabate@gmail.com>
Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
Link: [https://patch.msgid.link/20240917134246.584026-1-mikisabate@gmail.com](https://patch.msgid.link/20240917134246.584026-1-mikisabate%40gmail.com)
Cc: All applicable <stable@vger.kernel.org>
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c0f02536fffbbec71aced36d52a765f8c4493dc2)

| -rw-r--r-- | [include/linux/cpufreq.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/include/linux/cpufreq.h?id=c0f02536fffbbec71aced36d52a765f8c4493dc2) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 5 deletions

| diff --git a/include/linux/cpufreq.h b/include/linux/cpufreq.hindex e0e19d9c13231c..7fe0981a7e4674 100644--- a/[include/linux/cpufreq.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/linux/cpufreq.h?id=8b4865cd904650cbed7f2407e653934c621b8127)+++ b/[include/linux/cpufreq.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/linux/cpufreq.h?id=c0f02536fffbbec71aced36d52a765f8c4493dc2)@@ -1107,10 +1107,9 @@ static inline int parse\_perf\_domain(int cpu, const char \*list\_name, const char \*cell\_name, struct of\_phandle\_args \*args) {- struct device\_node \*cpu\_np; int ret; - cpu\_np = of\_cpu\_device\_node\_get(cpu);+ struct device\_node \*cpu\_np \_\_free(device\_node) = of\_cpu\_device\_node\_get(cpu); if (!cpu\_np) return -ENODEV; @@ -1118,9 +1117,6 @@ static inline int parse\_perf\_domain(int cpu, const char \*list\_name, args); if (ret < 0) return ret;-- of\_node\_put(cpu\_np);- return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 11:09:22 +0000

