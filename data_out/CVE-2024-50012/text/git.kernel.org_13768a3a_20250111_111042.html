

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Miquel Sabaté Solà <mikisabate@gmail.com> | 2024-09-17 15:42:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-10 11:57:58 +0200 |
| commit | [0f41f383b5a61a2bf6429a449ebba7fb08179d81](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81)) | |
| tree | [1d6caee4f3b953c22b38ef88e41e0fdacb420b2a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81) | |
| parent | [ed87190e9d9c80aad220fb6b0b03a84d22e2c95b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ed87190e9d9c80aad220fb6b0b03a84d22e2c95b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81&id2=ed87190e9d9c80aad220fb6b0b03a84d22e2c95b)) | |
| download | [linux-0f41f383b5a61a2bf6429a449ebba7fb08179d81.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0f41f383b5a61a2bf6429a449ebba7fb08179d81.tar.gz) | |

cpufreq: Avoid a bad reference count on CPU nodecommit c0f02536fffbbec71aced36d52a765f8c4493dc2 upstream.
In the parse\_perf\_domain function, if the call to
of\_parse\_phandle\_with\_args returns an error, then the reference to the
CPU device node that was acquired at the start of the function would not
be properly decremented.
Address this by declaring the variable with the \_\_free(device\_node)
cleanup attribute.
Signed-off-by: Miquel Sabaté Solà <mikisabate@gmail.com>
Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
Link: [https://patch.msgid.link/20240917134246.584026-1-mikisabate@gmail.com](https://patch.msgid.link/20240917134246.584026-1-mikisabate%40gmail.com)
Cc: All applicable <stable@vger.kernel.org>
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81)

| -rw-r--r-- | [include/linux/cpufreq.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/include/linux/cpufreq.h?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 5 deletions

| diff --git a/include/linux/cpufreq.h b/include/linux/cpufreq.hindex 3a4cefb25ba61c..9ca4211c063f39 100644--- a/[include/linux/cpufreq.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/linux/cpufreq.h?id=ed87190e9d9c80aad220fb6b0b03a84d22e2c95b)+++ b/[include/linux/cpufreq.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/linux/cpufreq.h?id=0f41f383b5a61a2bf6429a449ebba7fb08179d81)@@ -1124,10 +1124,9 @@ static inline int parse\_perf\_domain(int cpu, const char \*list\_name, const char \*cell\_name, struct of\_phandle\_args \*args) {- struct device\_node \*cpu\_np; int ret; - cpu\_np = of\_cpu\_device\_node\_get(cpu);+ struct device\_node \*cpu\_np \_\_free(device\_node) = of\_cpu\_device\_node\_get(cpu); if (!cpu\_np) return -ENODEV; @@ -1135,9 +1134,6 @@ static inline int parse\_perf\_domain(int cpu, const char \*list\_name, args); if (ret < 0) return ret;-- of\_node\_put(cpu\_np);- return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 11:09:19 +0000

