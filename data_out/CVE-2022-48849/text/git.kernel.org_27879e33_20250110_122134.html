

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=cb29021be49858059138f75d6311a7c35a9379b2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cb29021be49858059138f75d6311a7c35a9379b2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cb29021be49858059138f75d6311a7c35a9379b2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cb29021be49858059138f75d6311a7c35a9379b2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Guchun Chen <guchun.chen@amd.com> | 2022-02-18 13:05:26 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-16 14:26:47 +0100 |
| commit | [cb29021be49858059138f75d6311a7c35a9379b2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cb29021be49858059138f75d6311a7c35a9379b2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=cb29021be49858059138f75d6311a7c35a9379b2)) | |
| tree | [24e589cab86f062ae09cea24b93098217772cc71](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cb29021be49858059138f75d6311a7c35a9379b2) | |
| parent | [5b9d2a069dc8331b1198d0774f0f35a583fd47d7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5b9d2a069dc8331b1198d0774f0f35a583fd47d7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cb29021be49858059138f75d6311a7c35a9379b2&id2=5b9d2a069dc8331b1198d0774f0f35a583fd47d7)) | |
| download | [linux-cb29021be49858059138f75d6311a7c35a9379b2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-cb29021be49858059138f75d6311a7c35a9379b2.tar.gz) | |

drm/amdgpu: bypass tiling flag check in virtual display case (v2)[ Upstream commit e2b993302f40c4eb714ecf896dd9e1c5be7d4cd7 ]
vkms leverages common amdgpu framebuffer creation, and
also as it does not support FB modifier, there is no need
to check tiling flags when initing framebuffer when virtual
display is enabled.
This can fix below calltrace:
amdgpu 0000:00:08.0: GFX9+ requires FB check based on format modifier
WARNING: CPU: 0 PID: 1023 at drivers/gpu/drm/amd/amdgpu/amdgpu\_display.c:1150 amdgpu\_display\_framebuffer\_init+0x8e7/0xb40 [amdgpu]
v2: check adev->enable\_virtual\_display instead as vkms can be
enabled in bare metal as well.
Signed-off-by: Leslie Shi <Yuliang.Shi@amd.com>
Signed-off-by: Guchun Chen <guchun.chen@amd.com>
Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cb29021be49858059138f75d6311a7c35a9379b2)

| -rw-r--r-- | [drivers/gpu/drm/amd/amdgpu/amdgpu\_display.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/amd/amdgpu/amdgpu_display.c?id=cb29021be49858059138f75d6311a7c35a9379b2) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu\_display.c b/drivers/gpu/drm/amd/amdgpu/amdgpu\_display.cindex dc50c05f23fc2d..5c08047adb5941 100644--- a/[drivers/gpu/drm/amd/amdgpu/amdgpu\_display.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/amdgpu/amdgpu_display.c?id=5b9d2a069dc8331b1198d0774f0f35a583fd47d7)+++ b/[drivers/gpu/drm/amd/amdgpu/amdgpu\_display.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/amdgpu/amdgpu_display.c?id=cb29021be49858059138f75d6311a7c35a9379b2)@@ -1145,7 +1145,7 @@ int amdgpu\_display\_framebuffer\_init(struct drm\_device \*dev, if (ret) return ret; - if (!dev->mode\_config.allow\_fb\_modifiers) {+ if (!dev->mode\_config.allow\_fb\_modifiers && !adev->enable\_virtual\_display) { drm\_WARN\_ONCE(dev, adev->family >= AMDGPU\_FAMILY\_AI, "GFX9+ requires FB check based on format modifier\n"); ret = check\_tiling\_flags\_gfx6(rfb); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 12:07:12 +0000

