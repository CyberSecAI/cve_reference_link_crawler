
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-visual-studio-plugin%2Fcommit%2F0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-visual-studio-plugin%2Fcommit%2F0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-visual-studio-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-visual-studio-plugin](/snyk/snyk-visual-studio-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-visual-studio-plugin) You must be signed in to change notification settings
* [Fork
  15](/login?return_to=%2Fsnyk%2Fsnyk-visual-studio-plugin)
* [Star
   31](/login?return_to=%2Fsnyk%2Fsnyk-visual-studio-plugin)

* [Code](/snyk/snyk-visual-studio-plugin)
* [Pull requests
  1](/snyk/snyk-visual-studio-plugin/pulls)
* [Actions](/snyk/snyk-visual-studio-plugin/actions)
* [Security](/snyk/snyk-visual-studio-plugin/security)
* [Insights](/snyk/snyk-visual-studio-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-visual-studio-plugin)
* [Pull requests](/snyk/snyk-visual-studio-plugin/pulls)
* [Actions](/snyk/snyk-visual-studio-plugin/actions)
* [Security](/snyk/snyk-visual-studio-plugin/security)
* [Insights](/snyk/snyk-visual-studio-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-visual-studio-plugin/commit/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

feat: add workspace trust ([#217](https://github.com/snyk/snyk-visual-studio-plugin/pull/217))

[Browse files](/snyk/snyk-visual-studio-plugin/tree/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a)
Browse the repository at this point in the history

* Loading branch information

[![@michelkaporin](https://avatars.githubusercontent.com/u/2239563?s=40&v=4)](/michelkaporin)

[michelkaporin](/snyk/snyk-visual-studio-plugin/commits?author=michelkaporin "View all commits by michelkaporin")
authored
Nov 29, 2022

1 parent
[94d17c0](/snyk/snyk-visual-studio-plugin/commit/94d17c09c9600005a80a7be97e5334f5246929e6)

commit 0b53dbb

 Show file tree

 Hide file tree

Showing
**19 changed files**
with
**638 additions**
and
**38 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* Snyk.VisualStudio.Extension.2022

  + Snyk.VisualStudio.Extension.2022/Snyk.VisualStudio.Extension.2022.csproj
    [Snyk.VisualStudio.Extension.2022.csproj](#diff-ffc9b9d614511c8a19eb20120b39b7dfcb6fc091e2ec16c1fb2377faea08b0a7)
  + Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml
    [TrustDialogWindow.xaml](#diff-18b793983b8f42f42befb63227ae8820482cb9061de7c9df9f72074ccd8bc1ca)
  + Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml.cs
    [TrustDialogWindow.xaml.cs](#diff-3738cc47f9883031e1fcd5c44e18d90d0ae4857fb33ff4ddfdd3b4d76bb237f9)
* Snyk.VisualStudio.Extension.Shared

  + Service

    - Snyk.VisualStudio.Extension.Shared/Service/ISnykServiceProvider.cs
      [ISnykServiceProvider.cs](#diff-b6e129f39aae5d26ee4ade4013688ed51edd81795bed1f3c8d686988c5711ee3)
    - Snyk.VisualStudio.Extension.Shared/Service/IWorkspaceTrustService.cs
      [IWorkspaceTrustService.cs](#diff-f59cff506ea77e46114b705b71aa0b0bdff78897a7b3bec1279554926fcd2c2a)
    - Snyk.VisualStudio.Extension.Shared/Service/SnykService.cs
      [SnykService.cs](#diff-b7478ecbf513e701cef9a917575b4bef777181bc267c68e090d09da38cbad617)
    - Snyk.VisualStudio.Extension.Shared/Service/SnykTasksService.cs
      [SnykTasksService.cs](#diff-3e4d53a2bfed40908a2d6f75dbe28c607702e90b26c1b02dd2f62d709bf5f0cd)
    - Snyk.VisualStudio.Extension.Shared/Service/WorkspaceTrustService.cs
      [WorkspaceTrustService.cs](#diff-467035038cc854db14cda22e6a32c428caf53f767ecf26f1c4eec610c2337811)
  + Settings

    - Snyk.VisualStudio.Extension.Shared/Settings/IUserStorageSettingsService.cs
      [IUserStorageSettingsService.cs](#diff-52b2557b2dfcc0634253c08449e0eb4c64edfd7550e12e6b432cc5f5114d2b87)
    - Snyk.VisualStudio.Extension.Shared/Settings/SnykSettings.cs
      [SnykSettings.cs](#diff-0ab3e121842bd6eb354664dba1f289fb052e73bd31e7f78e3a91ca0c1b7a91fc)
    - Snyk.VisualStudio.Extension.Shared/Settings/SnykUserStorageSettingsService.cs
      [SnykUserStorageSettingsService.cs](#diff-5a298698b83429b28a90433e36399b66d520f674be440e5826452da32c405374)
  + Snyk.VisualStudio.Extension.Shared/Snyk.VisualStudio.Extension.Shared.projitems
    [Snyk.VisualStudio.Extension.Shared.projitems](#diff-dcef30bc2e8c1178d206f612f752b3dda7bbfe5e8e708669feb92c128d8a2431)
  + UI/Toolwindow

    - Snyk.VisualStudio.Extension.Shared/UI/Toolwindow/MessagePanel.xaml
      [MessagePanel.xaml](#diff-f901df802a6bec2172e5e5bb2056000437701af3220dfb76a3abc40535ddde0a)
    - Snyk.VisualStudio.Extension.Shared/UI/Toolwindow/MessagePanel.xaml.cs
      [MessagePanel.xaml.cs](#diff-300e9478192a5981c6cf6bee6769205959e61d7c4395843d4d4b8d9bf0faa5a4)
* Snyk.VisualStudio.Extension.Tests/Service

  + Snyk.VisualStudio.Extension.Tests/Service/WorkspaceTrustServiceTest.cs
    [WorkspaceTrustServiceTest.cs](#diff-c6e78910ae45ee0b4542992181707f82b07db57552413b1e5ca588a140ec79e3)
* Snyk.VisualStudio.Extension

  + Snyk.VisualStudio.Extension/Snyk.VisualStudio.Extension.csproj
    [Snyk.VisualStudio.Extension.csproj](#diff-e8fabb8d10b1c841e010b5895b6729e17921b7dadd1be6be2e58d19158f9c91e)
  + Snyk.VisualStudio.Extension/TrustDialogWindow.xaml
    [TrustDialogWindow.xaml](#diff-8f5b6034ff51084ee78527f0a47666c24c838c3c4028549e48ad43e2488eefe6)
  + Snyk.VisualStudio.Extension/TrustDialogWindow.xaml.cs
    [TrustDialogWindow.xaml.cs](#diff-7b7b5289bc0de14aa19c800efee0a14f13ae8298115f267fc60fd102e466dd2e)

## There are no files selected for viewing

7 changes: 6 additions & 1 deletion

7
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,5 +1,10 @@ |
|  |  | # Snyk Changelog |
|  |  |  |
|  |  | ## [1.1.31] |
|  |  |  |
|  |  | ### Added |
|  |  | - Adds workspace trust mechanism to ensure scans are run on the trusted projects. |
|  |  |  |
|  |  | ## [1.1.30] |
|  |  |  |
|  |  | ### Changed |
| Expand Down  Expand Up | | @@ -48,7 +53,7 @@ |
|  |  |  |
|  |  | ### Added |
|  |  | - Organization description information in settings. |
|  |  |  |
|  |  |  |
|  |  | ### Fixed |
|  |  | - Changing custom endpoint settings leads to authentication errors. |
|  |  |  |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Snyk.VisualStudio.Extension.2022/Snyk.VisualStudio.Extension.2022.csproj](#diff-ffc9b9d614511c8a19eb20120b39b7dfcb6fc091e2ec16c1fb2377faea08b0a7 "Snyk.VisualStudio.Extension.2022/Snyk.VisualStudio.Extension.2022.csproj")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.2022/Snyk.VisualStudio.Extension.2022.csproj)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -49,6 +49,9 @@ |
|  |  | </PropertyGroup> |
|  |  | <ItemGroup> |
|  |  | <Compile Include="Properties\AssemblyInfo.cs" /> |
|  |  | <Compile Include="TrustDialogWindow.xaml.cs"> |
|  |  | <DependentUpon>TrustDialogWindow.xaml</DependentUpon> |
|  |  | </Compile> |
|  |  | </ItemGroup> |
|  |  | <ItemGroup> |
|  |  | <None Include="source.extension.vsixmanifest"> |
| Expand Down  Expand Up | | @@ -120,6 +123,12 @@ |
|  |  | <Name>Snyk.Common</Name> |
|  |  | </ProjectReference> |
|  |  | </ItemGroup> |
|  |  | <ItemGroup> |
|  |  | <Page Include="TrustDialogWindow.xaml"> |
|  |  | <Generator>MSBuild:Compile</Generator> |
|  |  | <SubType>Designer</SubType> |
|  |  | </Page> |
|  |  | </ItemGroup> |
|  |  | <Import Project="..\Snyk.VisualStudio.Extension.Shared\Snyk.VisualStudio.Extension.Shared.projitems" Label="Shared" /> |
|  |  | <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" /> |
|  |  | <Import Project="$(VSToolsPath)\VSSDK\Microsoft.VsSDK.targets" Condition="'$(VSToolsPath)' != ''" /> |
| Expand Down | |  |

59 changes: 59 additions & 0 deletions

59
[Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml](#diff-18b793983b8f42f42befb63227ae8820482cb9061de7c9df9f72074ccd8bc1ca "Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,59 @@ |
|  |  | <ui:DialogWindow x:Class="Snyk.VisualStudio.Extension.TrustDialogWindow" |
|  |  | x:Name="TrustWindow" |
|  |  | xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" |
|  |  | xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" |
|  |  | xmlns:d="http://schemas.microsoft.com/expression/blend/2008" |
|  |  | xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" |
|  |  | xmlns:toolkit="clr-namespace:Community.VisualStudio.Toolkit;assembly=Community.VisualStudio.Toolkit" |
|  |  | xmlns:ui="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.15.0" |
|  |  | mc:Ignorable="d" |
|  |  | WindowStartupLocation="CenterScreen" |
|  |  | IsCloseButtonEnabled="True" |
|  |  | HasHelpButton="False" |
|  |  | MinHeight="290" Height="290" |
|  |  | MinWidth="500" Width="500" |
|  |  | BorderBrush="{x:Static SystemColors.WindowFrameBrush}" BorderThickness="1" |
|  |  | WindowStyle="None" ResizeMode="NoResize" AllowsTransparency="True" |
|  |  | xmlns:catalog="clr-namespace:Microsoft.VisualStudio.Imaging;assembly=Microsoft.VisualStudio.ImageCatalog" |
|  |  | xmlns:imaging="clr-namespace:Microsoft.VisualStudio.Imaging;assembly=Microsoft.VisualStudio.Imaging" |
|  |  | toolkit:Themes.UseVsTheme="True" |
|  |  | Title="Snyk - This folder has not been trusted" |
|  |  | MouseDown="TrustDialogWindow\_OnMouseDown"> |
|  |  | <DockPanel Margin="10"> |
|  |  | <Button DockPanel.Dock="Top" HorizontalAlignment="Right" Click="DoNotTrustButton\_OnClick" MinWidth="1" MinHeight="1" Width="35" Margin="0" Padding="0"> |
|  |  | <imaging:CrispImage Moniker="{x:Static catalog:KnownMonikers.Close}"/> |
|  |  | </Button> |
|  |  | <StackPanel HorizontalAlignment="Right" DockPanel.Dock="Bottom" Orientation="Horizontal"> |
|  |  | <Button x:Name="TrustButton" Margin="5, 5" Content="Trust folder and continue" Click="TrustButton\_OnClick"/> |
|  |  | <Button x:Name="DoNotTrustButton" Margin="5, 5" Content="Don't scan" Click="DoNotTrustButton\_OnClick"/> |
|  |  | </StackPanel> |
|  |  | <Grid> |
|  |  | <Grid.RowDefinitions> |
|  |  | <RowDefinition Height="auto"/> |
|  |  | <RowDefinition Height="auto"/> |
|  |  | </Grid.RowDefinitions> |
|  |  | <Grid Grid.Row="0"> |
|  |  | <Grid.ColumnDefinitions> |
|  |  | <ColumnDefinition Width="\*"/> |
|  |  | <ColumnDefinition Width="5\*"/> |
|  |  | </Grid.ColumnDefinitions> |
|  |  | <imaging:CrispImage Grid.Column="0" Width="50" Moniker="{x:Static catalog:KnownMonikers.StatusSecurityWarning}"/> |
|  |  | <StackPanel VerticalAlignment="Center" Grid.Column="1" Margin="0, 0, 5, 0"> |
|  |  | <TextBlock FontSize="14">This folder has not been trusted:</TextBlock> |
|  |  | <TextBlock FontSize="14" FontWeight="Bold" TextWrapping="Wrap" Text="{Binding ElementName=TrustWindow, Path=FolderPath}"/> |
|  |  | </StackPanel> |
|  |  | </Grid> |
|  |  | <StackPanel Grid.Row="1" Margin="5"> |
|  |  | <TextBlock TextWrapping="Wrap"> |
|  |  | When scanning folder files for vulnerabilities, Snyk may automatically execute code such as invoking the package manager to get dependency information. You should only scan folders you trust. |
|  |  | </TextBlock> |
|  |  | <TextBlock> |
|  |  | <LineBreak/> |
|  |  | <Hyperlink NavigateUri="https://docs.snyk.io/ide-tools/visual-studio-extension/workspace-trust" RequestNavigate="Hyperlink\_OnRequestNavigate"> |
|  |  | More information |
|  |  | </Hyperlink> |
|  |  | </TextBlock> |
|  |  | </StackPanel> |
|  |  | </Grid> |
|  |  | </DockPanel> |
|  |  | </ui:DialogWindow> |

49 changes: 49 additions & 0 deletions

49
[Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml.cs](#diff-3738cc47f9883031e1fcd5c44e18d90d0ae4857fb33ff4ddfdd3b4d76bb237f9 "Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,49 @@ |
|  |  | ﻿ |
|  |  | namespace Snyk.VisualStudio.Extension |
|  |  | { |
|  |  | using System.Diagnostics; |
|  |  | using System.Windows; |
|  |  | using System.Windows.Input; |
|  |  | using System.Windows.Navigation; |
|  |  | using Microsoft.VisualStudio.PlatformUI; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Trusted dialog window for Visual Studio 2022. |
|  |  | /// </summary> |
|  |  | public partial class TrustDialogWindow : DialogWindow |
|  |  | { |
|  |  | public TrustDialogWindow(string folderPath) |
|  |  | { |
|  |  | this.FolderPath = folderPath; |
|  |  | this.InitializeComponent(); |
|  |  | } |
|  |  |  |
|  |  | public string FolderPath { get; } |
|  |  |  |
|  |  | private void DoNotTrustButton\_OnClick(object sender, RoutedEventArgs e) |
|  |  | { |
|  |  | this.DialogResult = false; |
|  |  | this.Close(); |
|  |  | } |
|  |  |  |
|  |  | private void TrustButton\_OnClick(object sender, RoutedEventArgs e) |
|  |  | { |
|  |  | this.DialogResult = true; |
|  |  | this.Close(); |
|  |  | } |
|  |  |  |
|  |  | private void Hyperlink\_OnRequestNavigate(object sender, RequestNavigateEventArgs e) |
|  |  | { |
|  |  | Process.Start(new ProcessStartInfo(e.Uri.AbsoluteUri)); |
|  |  | e.Handled = true; |
|  |  | } |
|  |  |  |
|  |  | private void TrustDialogWindow\_OnMouseDown(object sender, MouseButtonEventArgs e) |
|  |  | { |
|  |  | if (e.ChangedButton == MouseButton.Left) |
|  |  | { |
|  |  | this.DragMove(); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |

2 changes: 2 additions & 0 deletions

2
[Snyk.VisualStudio.Extension.Shared/Service/ISnykServiceProvider.cs](#diff-b6e129f39aae5d26ee4ade4013688ed51edd81795bed1f3c8d686988c5711ee3 "Snyk.VisualStudio.Extension.Shared/Service/ISnykServiceProvider.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/ISnykServiceProvider.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -38,6 +38,8 @@ public interface ISnykServiceProvider |
|  |  | /// </summary> |
|  |  | ISolutionService SolutionService { get; } |
|  |  |  |
|  |  | IWorkspaceTrustService WorkspaceTrustService { get; } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets Tasks service instance. |
|  |  | /// </summary> |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Snyk.VisualStudio.Extension.Shared/Service/IWorkspaceTrustService.cs](#diff-f59cff506ea77e46114b705b71aa0b0bdff78897a7b3bec1279554926fcd2c2a "Snyk.VisualStudio.Extension.Shared/Service/IWorkspaceTrustService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/IWorkspaceTrustService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,9 @@ |
|  |  | ﻿namespace Snyk.VisualStudio.Extension.Shared.Service |
|  |  | { |
|  |  | public interface IWorkspaceTrustService |
|  |  | { |
|  |  | bool IsFolderTrusted(string absoluteFolderPath); |
|  |  |  |
|  |  | void AddFolderToTrusted(string absoluteFolderPath); |
|  |  | } |
|  |  | } |

8 changes: 8 additions & 0 deletions

8
[Snyk.VisualStudio.Extension.Shared/Service/SnykService.cs](#diff-b7478ecbf513e701cef9a917575b4bef777181bc267c68e090d09da38cbad617 "Snyk.VisualStudio.Extension.Shared/Service/SnykService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/SnykService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -52,6 +52,8 @@ public class SnykService : ISnykServiceProvider, ISnykService |
|  |  |  |
|  |  | private ISentryService sentryService; |
|  |  |  |
|  |  | private IWorkspaceTrustService workspaceTrustService; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Initializes a new instance of the <see cref="SnykService"/> class. |
|  |  | /// </summary> |
| Expand All | | @@ -68,6 +70,11 @@ public class SnykService : ISnykServiceProvider, ISnykService |
|  |  | /// </summary> |
|  |  | public ISolutionService SolutionService => SnykSolutionService.Instance; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets solution service. |
|  |  | /// </summary> |
|  |  | public IWorkspaceTrustService WorkspaceTrustService => this.workspaceTrustService; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets Tasks service. |
|  |  | /// </summary> |
| Expand Down  Expand Up | | @@ -241,6 +248,7 @@ public async Task InitializeAsync(CancellationToken cancellationToken) |
|  |  | this.dte = await this.serviceProvider.GetServiceAsync(typeof(DTE)) as DTE2; |
|  |  | await SnykSolutionService.Instance.InitializeAsync(this); |
|  |  | this.tasksService = SnykTasksService.Instance; |
|  |  | this.workspaceTrustService = new WorkspaceTrustService(this.UserStorageSettingsService); |
|  |  |  |
|  |  | NotificationService.Initialize(this); |
|  |  | VsStatusBar.Initialize(this); |
| Expand Down | |  |

46 changes: 45 additions & 1 deletion

46
[Snyk.VisualStudio.Extension.Shared/Service/SnykTasksService.cs](#diff-3e4d53a2bfed40908a2d6f75dbe28c607702e90b26c1b02dd2f62d709bf5f0cd "Snyk.VisualStudio.Extension.Shared/Service/SnykTasksService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/SnykTasksService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,14 +4,17 @@ |
|  |  | using System.Collections.Generic; |
|  |  | using System.Threading; |
|  |  | using System.Threading.Tasks; |
|  |  | using Community.VisualStudio.Toolkit; |
|  |  | using Microsoft.VisualStudio.Shell; |
|  |  | using Microsoft.VisualStudio.Shell.Interop; |
|  |  | using Serilog; |
|  |  | using Snyk.Analytics; |
|  |  | using Snyk.Code.Library.Domain.Analysis; |
|  |  | using Snyk.Common; |
|  |  | using Snyk.VisualStudio.Extension.Shared.CLI; |
|  |  | using Snyk.VisualStudio.Extension.Shared.CLI.Download; |
|  |  | using Snyk.VisualStudio.Extension.Shared.Service.Domain; |
|  |  | using Snyk.VisualStudio.Extension.Shared.UI; |
|  |  | using static Snyk.VisualStudio.Extension.Shared.CLI.Download.SnykCliDownloader; |
|  |  | using Task = System.Threading.Tasks.Task; |
|  |  |  |
| Expand Down  Expand Up | | @@ -198,7 +201,6 @@ public void CancelTasks() |
|  |  | public async Task ScanAsync() |
|  |  | { |
|  |  | Logger.Information("Enter Scan method"); |
|  |  |  |
|  |  | try |
|  |  | { |
|  |  | var selectedFeatures = await this.GetFeaturesSettingsAsync(); |
| Expand All | | @@ -212,6 +214,13 @@ public async Task ScanAsync() |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | var isFolderTrusted = await this.IsFolderTrustedAsync(); |
|  |  | if (!isFolderTrusted) |
|  |  | { |
|  |  | Logger.Information("Workspace folder was not trusted for scanning."); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | this.serviceProvider.AnalyticsService.LogAnalysisIsTriggeredEvent(this.GetSelectedFeatures(selectedFeatures)); |
|  |  |  |
|  |  | var ossScanTask = this.ScanOssAsync(selectedFeatures); |
| Expand All | | @@ -225,6 +234,41 @@ public async Task ScanAsync() |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Checks if opened solution folder is trusted. If not, prompts a user with trust permission. |
|  |  | /// </summary> |
|  |  | /// <returns>Folder is trusted or not.</returns> |
|  |  | public async Task<bool> IsFolderTrustedAsync() |
|  |  | { |
|  |  | var solutionFolderPath = await this.serviceProvider.SolutionService.GetSolutionFolderAsync(); |
|  |  | var isFolderTrusted = this.serviceProvider.WorkspaceTrustService.IsFolderTrusted(solutionFolderPath); |
|  |  |  |
|  |  | if (string.IsNullOrEmpty(solutionFolderPath) || isFolderTrusted) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | var trustDialog = new TrustDialogWindow(solutionFolderPath); |
|  |  | var trusted = trustDialog.ShowModal(); |
|  |  |  |
|  |  | if (trusted != true) |
|  |  | { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | try |
|  |  | { |
|  |  | this.serviceProvider.WorkspaceTrustService.AddFolderToTrusted(solutionFolderPath); |
|  |  | Logger.Information("Workspace folder was trusted: {SolutionFolderPath}", solutionFolderPath); |
|  |  | return true; |
|  |  | } |
|  |  | catch (ArgumentException e) |
|  |  | { |
|  |  | Logger.Error(e, "Failed to add folder to trusted list."); |
|  |  | throw; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Start a CLI download task in background thread. |
|  |  | /// </summary> |
| Expand Down | |  |

89 changes: 89 additions & 0 deletions

89
[Snyk.VisualStudio.Extension.Shared/Service/WorkspaceTrustService.cs](#diff-467035038cc854db14cda22e6a32c428caf53f767ecf26f1c4eec610c2337811 "Snyk.VisualStudio.Extension.Shared/Service/WorkspaceTrustService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/WorkspaceTrustService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,89 @@ |
|  |  | ﻿namespace Snyk.VisualStudio.Extension.Shared.Service |
|  |  | { |
|  |  | using System; |
|  |  | using System.Collections.Generic; |
|  |  | using System.IO; |
|  |  | using System.Linq; |
|  |  | using Serilog; |
|  |  | using Snyk.Common; |
|  |  | using Snyk.VisualStudio.Extension.Shared.Settings; |
|  |  |  |
|  |  | public class WorkspaceTrustService : IWorkspaceTrustService |
|  |  | { |
|  |  | private static readonly ILogger Logger = LogManager.ForContext<WorkspaceTrustService>(); |
|  |  |  |
|  |  | private readonly IUserStorageSettingsService settingsService; |
|  |  |  |
|  |  | public WorkspaceTrustService(IUserStorageSettingsService settingsService) |
|  |  | { |
|  |  | this.settingsService = settingsService; |
|  |  | } |
|  |  |  |
|  |  | public void AddFolderToTrusted(string absoluteFolderPath) |
|  |  | { |
|  |  | if (!Path.IsPathRooted(absoluteFolderPath)) |
|  |  | { |
|  |  | throw new ArgumentException("Trusted folder path provided is not absolute."); |
|  |  | } |
|  |  |  |
|  |  | if (!Directory.Exists(absoluteFolderPath)) |
|  |  | { |
|  |  | throw new ArgumentException("Trusted folder doesn't exist."); |
|  |  | } |
|  |  |  |
|  |  | try |
|  |  | { |
|  |  | var trustedFolders = this.settingsService.TrustedFolders; |
|  |  | trustedFolders.Add(absoluteFolderPath); |
|  |  | this.settingsService.TrustedFolders = trustedFolders; |
|  |  | } |
|  |  | catch (Exception e) |
|  |  | { |
|  |  | Logger.Error(e, "Failed to add a folder to trusted."); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | public bool IsFolderTrusted(string absoluteFolderPath) |
|  |  | { |
|  |  | var trustedFolders = this.settingsService.TrustedFolders; |
|  |  |  |
|  |  | foreach (var trustedFolder in trustedFolders) |
|  |  | { |
|  |  | if (this.IsSubFolderOrEqual(trustedFolder, absoluteFolderPath)) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Verify if subfolder is rooted at parent path. |
|  |  | /// </summary> |
|  |  | /// <param name="parentPath">Parent path to check against.</param> |
|  |  | /// <param name="childPath">Subfolder path to verify.</param> |
|  |  | /// <returns>Returns true if childPath is subfolder of parentPath, or equal to it.</returns> |
|  |  | private bool IsSubFolderOrEqual(string parentPath, string childPath) |
|  |  | { |
|  |  | var parentUri = new Uri(parentPath); |
|  |  | if (new Uri(childPath).Equals(parentUri)) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | var childUri = new DirectoryInfo(childPath).Parent; |
|  |  | while (childUri != null) |
|  |  | { |
|  |  | if (new Uri(childUri.FullName).Equals(parentUri)) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | childUri = childUri.Parent; |
|  |  | } |
|  |  |  |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  | } |

9 changes: 9 additions & 0 deletions

9
[Snyk.VisualStudio.Extension.Shared/Settings/IUserStorageSettingsService.cs](#diff-52b2557b2dfcc0634253c08449e0eb4c64edfd7550e12e6b432cc5f5114d2b87 "Snyk.VisualStudio.Extension.Shared/Settings/IUserStorageSettingsService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Settings/IUserStorageSettingsService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,9 @@ |
|  |  | ﻿namespace Snyk.VisualStudio.Extension.Shared.Settings |
|  |  | { |
|  |  | using System.Collections.Generic; |
|  |  |  |
|  |  | public interface IUserStorageSettingsService |
|  |  | { |
|  |  | ISet<string> TrustedFolders { get; set; } |
|  |  | } |
|  |  | } |

7 changes: 6 additions & 1 deletion

7
[Snyk.VisualStudio.Extension.Shared/Settings/SnykSettings.cs](#diff-0ab3e121842bd6eb354664dba1f289fb052e73bd31e7f78e3a91ca0c1b7a91fc "Snyk.VisualStudio.Extension.Shared/Settings/SnykSettings.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Settings/SnykSettings.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -61,8 +61,13 @@ public SnykSettings() |
|  |  | public bool BinariesAutoUpdateEnabled { get; set; } = true; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets or sets the value of the custom CLI path |
|  |  | /// Gets or sets the value of the custom CLI path. |
|  |  | /// </summary> |
|  |  | public string CustomCliPath { get; set; } = string.Empty; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets or sets an array of workspace trusted folders. |
|  |  | /// </summary> |
|  |  | public ISet<string> TrustedFolders { get; set; } = new HashSet<string>(); |
|  |  | } |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0b53dbb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-visual-studio-plugin%2Fcommit%2F0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

