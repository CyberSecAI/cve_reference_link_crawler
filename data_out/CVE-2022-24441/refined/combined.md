=== Content from github.com_25a0ddcb_20250108_110741.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-eclipse-plugin%2Fcommit%2Fb5a8bce25a359ced75f83a729fc6b2393fc9a495)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-eclipse-plugin%2Fcommit%2Fb5a8bce25a359ced75f83a729fc6b2393fc9a495)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-eclipse-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-eclipse-plugin](/snyk/snyk-eclipse-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-eclipse-plugin) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2Fsnyk%2Fsnyk-eclipse-plugin)
* [Star
   16](/login?return_to=%2Fsnyk%2Fsnyk-eclipse-plugin)

* [Code](/snyk/snyk-eclipse-plugin)
* [Pull requests
  0](/snyk/snyk-eclipse-plugin/pulls)
* [Actions](/snyk/snyk-eclipse-plugin/actions)
* [Security](/snyk/snyk-eclipse-plugin/security)
* [Insights](/snyk/snyk-eclipse-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-eclipse-plugin)
* [Pull requests](/snyk/snyk-eclipse-plugin/pulls)
* [Actions](/snyk/snyk-eclipse-plugin/actions)
* [Security](/snyk/snyk-eclipse-plugin/security)
* [Insights](/snyk/snyk-eclipse-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-eclipse-plugin/commit/b5a8bce25a359ced75f83a729fc6b2393fc9a495)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#106](https://github.com/snyk/snyk-eclipse-plugin/pull/106) from snyk/feat/trust-feature

[Browse files](/snyk/snyk-eclipse-plugin/tree/b5a8bce25a359ced75f83a729fc6b2393fc9a495)
Browse the repository at this point in the history

```
feat: add folder trust
```

* Loading branch information

[![@michelkaporin](https://avatars.githubusercontent.com/u/2239563?s=40&v=4)](/michelkaporin)

[michelkaporin](/snyk/snyk-eclipse-plugin/commits?author=michelkaporin "View all commits by michelkaporin")
authored
Nov 29, 2022

2 parents
[d4bb621](/snyk/snyk-eclipse-plugin/commit/d4bb6211185ba84171ab2184268ca363de0f8fb4)
+
[8f2c301](/snyk/snyk-eclipse-plugin/commit/8f2c301bd5b2384d1b38665f3f27b263d5ee2a07)

commit b5a8bce

 Show file tree

 Hide file tree

Showing
**22 changed files**
with
**518 additions**
and
**163 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* plugin

  + META-INF

    - plugin/META-INF/MANIFEST.MF
      [MANIFEST.MF](#diff-e31b7bf9cd674c0ecf80c3e3360653bbbb181e87571416892aa46be6c849254d)
  + plugin/build.properties
    [build.properties](#diff-e09323301996a8c966ea161b6f47505d4f9ef5ac105eb07352f9859655760188)
  + plugin/io.snyk.eclipse.plugin.eml
    [io.snyk.eclipse.plugin.eml](#diff-45262551f9f7a71458d5e963e5d67a018ab635aadafbe8dff319a8dd843362da)
  + plugin/pom.xml
    [pom.xml](#diff-0b2f1e793aa9ad4aef151dba847084ec8fce8d49fe5ae1925313e2f66f018962)
  + src/main/java/io/snyk

    - eclipse/plugin

      * properties

        + plugin/src/main/java/io/snyk/eclipse/plugin/properties/PreferencesPage.java
          [PreferencesPage.java](#diff-0958348c9ac818c56b91d31ea258e848f7bf0de6be5f6bbb656b9a7507ba1014)
        + preferences

          - plugin/src/main/java/io/snyk/eclipse/plugin/properties/preferences/Preferences.java
            [Preferences.java](#diff-9b6046bc40c6500326ae39d81d5a2c1c1f27bd6bf6f594ded6a805c6c8364fe8)
          - plugin/src/main/java/io/snyk/eclipse/plugin/properties/preferences/SecurePreferenceStore.java
            [SecurePreferenceStore.java](#diff-3a8a8bd8e22e2a295f01ec723617c5594d720e6e9b501e592623801d912fdaa2)
      * runner

        + plugin/src/main/java/io/snyk/eclipse/plugin/runner/SnykCliRunner.java
          [SnykCliRunner.java](#diff-4db9cdef785dea124695685f0b659ce56e162d348987d538f3ef821f20dce395)
        + plugin/src/main/java/io/snyk/eclipse/plugin/runner/UntrustedScanRequestedException.java
          [UntrustedScanRequestedException.java](#diff-b5f1ca1a5373c67bbd72ea9f6d192e7799a2dee280a77e0625154be5ac21ba13)
      * wizards

        + plugin/src/main/java/io/snyk/eclipse/plugin/wizards/SWTWidgetHelper.java
          [SWTWidgetHelper.java](#diff-bad5cdc18ab91d11dd5deef322e48662eb24296d4bc2d2031dc4fc980d4b0224)
        + plugin/src/main/java/io/snyk/eclipse/plugin/wizards/SnykWizard.java
          [SnykWizard.java](#diff-998896989b2413b62fb0c647c77fd35568d731217aec84f4b93691e433034600)
        + plugin/src/main/java/io/snyk/eclipse/plugin/wizards/SnykWizardAuthenticatePage.java
          [SnykWizardAuthenticatePage.java](#diff-cd0f361dff8746de88f987865180ea817eb96d295643d96f58e69127abb23e0a)
    - languageserver

      * plugin/src/main/java/io/snyk/languageserver/LsConfigurationUpdater.java
        [LsConfigurationUpdater.java](#diff-a6ffbe49b6d0ee1db47129e300cdcfff5ffa72aef1467bce420616496ee803e0)
      * download

        + plugin/src/main/java/io/snyk/languageserver/download/LsBinaries.java
          [LsBinaries.java](#diff-fc0ba8e0017a53e4d39356d374b8fe617690208b4c34538bf2400f02f4f8426d)
      * protocolextension

        + plugin/src/main/java/io/snyk/languageserver/protocolextension/SnykExtendedLanguageClient.java
          [SnykExtendedLanguageClient.java](#diff-dc3b50a74bccca485397b19463e5aa247bbca019effc5fe7b7f27cde8752a6f7)
        + messageObjects

          - plugin/src/main/java/io/snyk/languageserver/protocolextension/messageObjects/SnykTrustedFoldersParams.java
            [SnykTrustedFoldersParams.java](#diff-59636c38cdd80cbd21d5a8b4531568b239ff78eb165868fa8bd60be652ea5ed4)
* target-platform

  + target-platform/target-platform.target
    [target-platform.target](#diff-d974eeac8dab38c9fe4d0efe8d32e47eb7090a4a8d2ee9b8ff152a730d7dc17a)
* tests

  + tests/pom.xml
    [pom.xml](#diff-4e04c04a0f54bbc17cf44b992392023397f34126f2b6f00bd7f8c3f66b87d452)
  + src/test/java/io/snyk

    - eclipse/plugin/runner

      * tests/src/test/java/io/snyk/eclipse/plugin/runner/SnykCliRunnerTest.java
        [SnykCliRunnerTest.java](#diff-b7207015c83d36b3f637221cc98bc54669be38faa79af7d8055b8c196609dbb5)
    - languageserver

      * tests/src/test/java/io/snyk/languageserver/SnykLanguageServerTest.java
        [SnykLanguageServerTest.java](#diff-120922336727732c6892d7d9184cf7653d0782a37d34b35263d8adfa43ca7ac7)
      * protocolextension

        + tests/src/test/java/io/snyk/languageserver/protocolextension/SnykExtendedLanguageClientTest.java
          [SnykExtendedLanguageClientTest.java](#diff-fef478a7f566672e95a3cf3766f4f3aa519c7694512379c540616aaaeb8c76f0)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -3,6 +3,10 @@ |
|  |  |  |
|  |  | ## [2.0.0] - Unreleased |
|  |  | ### Changes |
|  |  | - add folder trust feature |
|  |  |  |
|  |  | ## [2.0.0] - v20221115.132308 |
|  |  | ### Changes |
|  |  | - adds configuration wizard for custom endpoints |
|  |  |  |
|  |  | ## [2.0.0] - v20221007.135736 |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[plugin/META-INF/MANIFEST.MF](#diff-e31b7bf9cd674c0ecf80c3e3360653bbbb181e87571416892aa46be6c849254d "plugin/META-INF/MANIFEST.MF")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/plugin/META-INF/MANIFEST.MF)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,7 +10,7 @@ Require-Bundle: org.eclipse.ui, |
|  |  | org.eclipse.core.runtime, |
|  |  | org.eclipse.jdt.core, |
|  |  | org.eclipse.core.resources, |
|  |  | org.eclipse.lsp4e;bundle-version="0.13.9", |
|  |  | org.eclipse.lsp4e;bundle-version="[0.13.9,0.14.0.qualifier]", |
|  |  | org.eclipse.lsp4e.jdt;bundle-version="0.10.1", |
|  |  | org.eclipse.equinox.security, |
|  |  | org.eclipse.equinox.security.ui, |
| Expand All | | @@ -33,5 +33,5 @@ Bundle-ClassPath: ., |
|  |  | target/dependency/httpcore-4.4.15.jar, |
|  |  | target/dependency/jackson-annotations-2.13.4.jar, |
|  |  | target/dependency/jackson-core-2.13.4.jar, |
|  |  | target/dependency/jackson-databind-2.13.4.jar, |
|  |  | target/dependency/jackson-databind-2.13.4.2.jar, |
|  |  | target/dependency/javax.inject-1.jar |

2 changes: 1 addition & 1 deletion

2
[plugin/build.properties](#diff-e09323301996a8c966ea161b6f47505d4f9ef5ac105eb07352f9859655760188 "plugin/build.properties")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/plugin/build.properties)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,7 +14,7 @@ bin.includes = plugin.xml,\ |
|  |  | target/dependency/httpcore-4.4.15.jar,\ |
|  |  | target/dependency/jackson-annotations-2.13.4.jar,\ |
|  |  | target/dependency/jackson-core-2.13.4.jar,\ |
|  |  | target/dependency/jackson-databind-2.13.4.jar,\ |
|  |  | target/dependency/jackson-databind-2.13.4.2.jar,\ |
|  |  | target/dependency/javax.inject-1.jar |
|  |  | src.includes =src/,\ |
|  |  | icons/ |

14 changes: 7 additions & 7 deletions

14
[plugin/io.snyk.eclipse.plugin.eml](#diff-45262551f9f7a71458d5e963e5d67a018ab635aadafbe8dff319a8dd843362da "plugin/io.snyk.eclipse.plugin.eml")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/plugin/io.snyk.eclipse.plugin.eml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,22 +19,22 @@ |
|  |  | <lib name="httpcore-4.4.15.jar" scope="COMPILE"> |
|  |  | <relative-module-cls project-related="jar://$PROJECT\_DIR$/plugin/target/dependency/httpcore-4.4.15.jar!/"/> |
|  |  | </lib> |
|  |  | <lib name="jackson-annotations-2.13.4.jar" scope="COMPILE"> |
|  |  | <lib name="jackson-annotations-2.13.4.2.jar" scope="COMPILE"> |
|  |  | <relative-module-cls project-related="jar://$PROJECT\_DIR$/plugin/target/dependency/jackson-annotations-2.13.4.jar!/"/> |
|  |  | </lib> |
|  |  | <lib name="jackson-core-2.13.4.jar" scope="COMPILE"> |
|  |  | <lib name="jackson-core-2.13.4.2.jar" scope="COMPILE"> |
|  |  | <relative-module-cls project-related="jar://$PROJECT\_DIR$/plugin/target/dependency/jackson-core-2.13.4.jar!/"/> |
|  |  | </lib> |
|  |  | <lib name="jackson-databind-2.13.4.jar" scope="COMPILE"> |
|  |  | <relative-module-cls project-related="jar://$PROJECT\_DIR$/plugin/target/dependency/jackson-databind-2.13.4.jar!/"/> |
|  |  | <lib name="jackson-databind-2.13.4.2.jar" scope="COMPILE"> |
|  |  | <relative-module-cls project-related="jar://$PROJECT\_DIR$/plugin/target/dependency/jackson-databind-2.13.4.2.jar!/"/> |
|  |  | </lib> |
|  |  | <lib name="javax.inject-1.jar" scope="COMPILE"> |
|  |  | <relative-module-cls project-related="jar://$PROJECT\_DIR$/plugin/target/dependency/javax.inject-1.jar!/"/> |
|  |  | </lib> |
|  |  | <levels> |
|  |  | <level name="Maven: com.fasterxml.jackson.core:jackson-annotations:2.13.4" value="project"/> |
|  |  | <level name="Maven: com.fasterxml.jackson.core:jackson-core:2.13.4" value="project"/> |
|  |  | <level name="Maven: com.fasterxml.jackson.core:jackson-databind:2.13.4" value="project"/> |
|  |  | <level name="Maven: com.fasterxml.jackson.core:jackson-annotations:2.13.4.2" value="project"/> |
|  |  | <level name="Maven: com.fasterxml.jackson.core:jackson-core:2.13.4.2" value="project"/> |
|  |  | <level name="Maven: com.fasterxml.jackson.core:jackson-databind:2.13.4.2" value="project"/> |
|  |  | <level name="Maven: org.apache.commons:commons-lang3:3.12.0" value="project"/> |
|  |  | <level name="Maven: org.apache.httpcomponents:httpcore:4.4.15" value="project"/> |
|  |  | <level name="Maven: org.apache.httpcomponents:httpclient:4.5.13" value="project"/> |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[plugin/pom.xml](#diff-0b2f1e793aa9ad4aef151dba847084ec8fce8d49fe5ae1925313e2f66f018962 "plugin/pom.xml")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/plugin/pom.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,7 +29,7 @@ |
|  |  | <dependency> |
|  |  | <groupId>com.fasterxml.jackson.core</groupId> |
|  |  | <artifactId>jackson-databind</artifactId> |
|  |  | <version>2.13.4</version> |
|  |  | <version>2.13.4.2</version> |
|  |  | <type>jar</type> |
|  |  | </dependency> |
|  |  | <dependency> |
| Expand Down | |  |

198 changes: 106 additions & 92 deletions

198
[plugin/src/main/java/io/snyk/eclipse/plugin/properties/PreferencesPage.java](#diff-0958348c9ac818c56b91d31ea258e848f7bf0de6be5f6bbb656b9a7507ba1014 "plugin/src/main/java/io/snyk/eclipse/plugin/properties/PreferencesPage.java")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/plugin/src/main/java/io/snyk/eclipse/plugin/properties/PreferencesPage.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,6 +8,9 @@ |
|  |  | import io.snyk.languageserver.LsRuntimeEnvironment; |
|  |  | import io.snyk.languageserver.download.HttpClientFactory; |
|  |  | import io.snyk.languageserver.download.LsBinaries; |
|  |  |  |
|  |  | import java.io.File; |
|  |  |  |
|  |  | import org.eclipse.core.net.proxy.IProxyData; |
|  |  | import org.eclipse.jface.preference.BooleanFieldEditor; |
|  |  | import org.eclipse.jface.preference.FieldEditor; |
| Expand All | | @@ -19,103 +22,114 @@ |
|  |  | import org.eclipse.ui.IWorkbenchPreferencePage; |
|  |  |  |
|  |  | public class PreferencesPage extends FieldEditorPreferencePage implements IWorkbenchPreferencePage { |
|  |  | private BooleanFieldEditor snykCodeCheckbox; |
|  |  |  |
|  |  | public PreferencesPage() { |
|  |  | super(GRID); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public void init(IWorkbench workbench) { |
|  |  | setPreferenceStore(io.snyk.eclipse.plugin.properties.preferences.Preferences.getInstance().getStore()); |
|  |  | setMessage("Snyk Preferences"); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | protected void createFieldEditors() { |
|  |  | TokenFieldEditor tokenField = new TokenFieldEditor( |
|  |  | io.snyk.eclipse.plugin.properties.preferences.Preferences.getInstance(), |
|  |  | io.snyk.eclipse.plugin.properties.preferences.Preferences.AUTH\_TOKEN\_KEY, "Snyk API Token:", |
|  |  | getFieldEditorParent()); |
|  |  | addField(tokenField); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.PATH\_KEY, "Path:", |
|  |  | getFieldEditorParent())); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ENDPOINT\_KEY, |
|  |  | "Custom Endpoint:", getFieldEditorParent())); |
|  |  | addField(new BooleanFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.INSECURE\_KEY, |
|  |  | "Allow unknown certificate authorities", getFieldEditorParent())); |
|  |  |  |
|  |  | addField(space()); |
|  |  | private BooleanFieldEditor snykCodeCheckbox; |
|  |  |  |
|  |  | public PreferencesPage() { |
|  |  | super(GRID); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public void init(IWorkbench workbench) { |
|  |  | setPreferenceStore(io.snyk.eclipse.plugin.properties.preferences.Preferences.getInstance().getStore()); |
|  |  | setMessage("Snyk Preferences"); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | protected void createFieldEditors() { |
|  |  | TokenFieldEditor tokenField = new TokenFieldEditor( |
|  |  | io.snyk.eclipse.plugin.properties.preferences.Preferences.getInstance(), |
|  |  | io.snyk.eclipse.plugin.properties.preferences.Preferences.AUTH\_TOKEN\_KEY, "Snyk API Token:", |
|  |  | getFieldEditorParent()); |
|  |  | addField(tokenField); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.PATH\_KEY, "Path:", |
|  |  | getFieldEditorParent())); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ENDPOINT\_KEY, |
|  |  | "Custom Endpoint:", getFieldEditorParent())); |
|  |  | addField(new BooleanFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.INSECURE\_KEY, |
|  |  | "Allow unknown certificate authorities", getFieldEditorParent())); |
|  |  |  |
|  |  | addField(space()); |
|  |  | addField(new LabelFieldEditor("The following options involve the Snyk Language Server.", |
|  |  | getFieldEditorParent())); |
|  |  | addField(new LabelFieldEditor( |
|  |  | "Activating Snyk Code will cause upload of source code to Snyk or the given endpoint address.", |
|  |  | getFieldEditorParent())); |
|  |  | addField(space()); |
|  |  | addField(new LabelFieldEditor( |
|  |  | "Activating Snyk Code will cause upload of source code to Snyk or the given endpoint address.", |
|  |  | getFieldEditorParent())); |
|  |  | addField(space()); |
|  |  | addField(new BooleanFieldEditor( |
|  |  | io.snyk.eclipse.plugin.properties.preferences.Preferences.ACTIVATE\_SNYK\_OPEN\_SOURCE, |
|  |  | "Snyk Open Source enabled", getFieldEditorParent())); |
|  |  | snykCodeCheckbox = new BooleanFieldEditor( |
|  |  | io.snyk.eclipse.plugin.properties.preferences.Preferences.ACTIVATE\_SNYK\_CODE, "Snyk Code enable" + "d", |
|  |  | getFieldEditorParent()); |
|  |  |  |
|  |  | addField(snykCodeCheckbox); |
|  |  | addField(new BooleanFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ACTIVATE\_SNYK\_IAC, |
|  |  | "Snyk Infrastructure-as-Code enabled", getFieldEditorParent())); |
|  |  |  |
|  |  | addField(space()); |
|  |  | addField(new LabelFieldEditor("Advanced options:", getFieldEditorParent())); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ORGANIZATION\_KEY, |
|  |  | "Organization:", getFieldEditorParent())); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ADDITIONAL\_PARAMETERS, |
|  |  | "Additional Parameters:", getFieldEditorParent())); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ADDITIONAL\_ENVIRONMENT, |
|  |  | "Additional Environment:", getFieldEditorParent())); |
|  |  |  |
|  |  | addField(space()); |
|  |  | BooleanFieldEditor manageBinaries = new BooleanFieldEditor(Preferences.MANAGE\_BINARIES\_AUTOMATICALLY, |
|  |  | "Update and install Snyk binaries automatically", getFieldEditorParent()); |
|  |  | manageBinaries.setPropertyChangeListener((PropertyChangeEvent propertyChangeEvent) -> { |
|  |  | System.out.println("managed bionaries changed"); |
|  |  | }); |
|  |  | addField(manageBinaries); |
|  |  | addField(new FileFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.LS\_BINARY\_KEY, |
|  |  | "Snyk Language Server:", getFieldEditorParent())); |
|  |  | addField(new FileFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.CLI\_PATH, "Snyk CLI:", |
|  |  | getFieldEditorParent())); |
|  |  |  |
|  |  | addField(space()); |
|  |  |  |
|  |  | addField(new BooleanFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.SEND\_ERROR\_REPORTS, |
|  |  | "Send error reports to Snyk", getFieldEditorParent())); |
|  |  | "Snyk Open Source enabled", getFieldEditorParent())); |
|  |  | snykCodeCheckbox = new BooleanFieldEditor( |
|  |  | io.snyk.eclipse.plugin.properties.preferences.Preferences.ACTIVATE\_SNYK\_CODE, "Snyk Code enable" + "d", |
|  |  | getFieldEditorParent()); |
|  |  |  |
|  |  | addField(snykCodeCheckbox); |
|  |  | addField(new BooleanFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ACTIVATE\_SNYK\_IAC, |
|  |  | "Snyk Infrastructure-as-Code enabled", getFieldEditorParent())); |
|  |  |  |
|  |  | addField(space()); |
|  |  | addField(new LabelFieldEditor("Advanced options:", getFieldEditorParent())); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ORGANIZATION\_KEY, |
|  |  | "Organization:", getFieldEditorParent())); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ADDITIONAL\_PARAMETERS, |
|  |  | "Additional Parameters:", getFieldEditorParent())); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.ADDITIONAL\_ENVIRONMENT, |
|  |  | "Additional Environment:", getFieldEditorParent())); |
|  |  |  |
|  |  | addField(space()); |
|  |  | BooleanFieldEditor manageBinaries = new BooleanFieldEditor(Preferences.MANAGE\_BINARIES\_AUTOMATICALLY, |
|  |  | "Update and install Snyk binaries automatically", getFieldEditorParent()); |
|  |  | manageBinaries.setPropertyChangeListener((PropertyChangeEvent propertyChangeEvent) -> { |
|  |  | System.out.println("managed bionaries changed"); |
|  |  | }); |
|  |  | addField(manageBinaries); |
|  |  | addField(new FileFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.LS\_BINARY\_KEY, |
|  |  | "Snyk Language Server:", getFieldEditorParent())); |
|  |  | addField(new FileFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.CLI\_PATH, "Snyk CLI:", |
|  |  | getFieldEditorParent())); |
|  |  |  |
|  |  | addField(space()); |
|  |  |  |
|  |  | addField(new BooleanFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.SEND\_ERROR\_REPORTS, |
|  |  | "Send error reports to Snyk", getFieldEditorParent())); |
|  |  | addField(new BooleanFieldEditor(Preferences.ENABLE\_TELEMETRY, "Send usage statistics to Snyk", |
|  |  | getFieldEditorParent())); |
|  |  | disableSnykCodeIfOrgDisabled(); |
|  |  | } |
|  |  |  |
|  |  | private FieldEditor space() { |
|  |  | return new LabelFieldEditor("", getFieldEditorParent()); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public boolean performOk() { |
|  |  | boolean superOK = super.performOk(); |
|  |  | var snykView = SnykStartup.getSnykView(); |
|  |  | snykView.disableRunAbortActions(); |
|  |  | snykView.toggleRunActionEnablement(); |
|  |  | disableSnykCodeIfOrgDisabled(); |
|  |  |  |
|  |  | new LsConfigurationUpdater().configurationChanged(); |
|  |  | return superOK; |
|  |  | } |
|  |  |  |
|  |  | private void disableSnykCodeIfOrgDisabled() { |
|  |  | var apiClient = new ApiClient(); |
|  |  | if (snykCodeCheckbox.getBooleanValue() && !apiClient.checkSnykCodeEnablement()) { |
|  |  | String message = "Snyk Code disabled, because it is not enabled for your organization. After you close this preference page, it will stay disabled."; |
|  |  | snykCodeCheckbox.setLabelText(snykCodeCheckbox.getLabelText()+" ("+message+")"); |
|  |  | SnykLogger.logInfo(message); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | addField(space()); |
|  |  |  |
|  |  | addField(new LabelFieldEditor( |
|  |  | "Only trusted paths are scanned by Snyk. The Trusted Folders setting allows to specify, which \n" |
|  |  | + "paths are safe to scan. Every path below a given path is considered safe to scan. \n" |
|  |  | + "Please separate entries with \"" + File.pathSeparator + "\".", |
|  |  | getFieldEditorParent())); |
|  |  | addField(new StringFieldEditor(io.snyk.eclipse.plugin.properties.preferences.Preferences.TRUSTED\_FOLDERS, |
|  |  | "Trusted Folders:", getFieldEditorParent())); |
|  |  |  |
|  |  | disableSnykCodeIfOrgDisabled(); |
|  |  | } |
|  |  |  |
|  |  | private FieldEditor space() { |
|  |  | return new LabelFieldEditor("", getFieldEditorParent()); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public boolean performOk() { |
|  |  | boolean superOK = super.performOk(); |
|  |  | var snykView = SnykStartup.getSnykView(); |
|  |  | snykView.disableRunAbortActions(); |
|  |  | snykView.toggleRunActionEnablement(); |
|  |  | disableSnykCodeIfOrgDisabled(); |
|  |  |  |
|  |  | new LsConfigurationUpdater().configurationChanged(); |
|  |  | return superOK; |
|  |  | } |
|  |  |  |
|  |  | private void disableSnykCodeIfOrgDisabled() { |
|  |  | var apiClient = new ApiClient(); |
|  |  | if (snykCodeCheckbox.getBooleanValue() && !apiClient.checkSnykCodeEnablement()) { |
|  |  | String message = "Snyk Code disabled, because it is not enabled for your organization. After you close this preference page, it will stay disabled."; |
|  |  | snykCodeCheckbox.setLabelText(snykCodeCheckbox.getLabelText() + " (" + message + ")"); |
|  |  | SnykLogger.logInfo(message); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | } |

1 change: 1 addition & 0 deletions

1
[plugin/src/main/java/io/snyk/eclipse/plugin/properties/preferences/Preferences.java](#diff-9b6046bc40c6500326ae39d81d5a2c1c1f27bd6bf6f594ded6a805c6c8364fe8 "plugin/src/main/java/io/snyk/eclipse/plugin/properties/preferences/Preferences.java")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/plugin/src/main/java/io/snyk/eclipse/plugin/properties/preferences/Preferences.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -26,6 +26,7 @@ public static synchronized Preferences getInstance(PreferenceStore store) { |
|  |  | return preferences; |
|  |  | } |
|  |  |  |
|  |  | public static final String TRUSTED\_FOLDERS = "trustedFolders"; |
|  |  | public static final String AUTH\_TOKEN\_KEY = "authtoken"; |
|  |  | public static final String PATH\_KEY = "path"; |
|  |  | public static final String ENDPOINT\_KEY = "endpoint"; |
| Expand Down | |  |

21 changes: 20 additions & 1 deletion

21
[...in/src/main/java/io/snyk/eclipse/plugin/properties/preferences/SecurePreferenceStore.java](#diff-3a8a8bd8e22e2a295f01ec723617c5594d720e6e9b501e592623801d912fdaa2 "plugin/src/main/java/io/snyk/eclipse/plugin/properties/preferences/SecurePreferenceStore.java")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/plugin/src/main/java/io/snyk/eclipse/plugin/properties/preferences/SecurePreferenceStore.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,7 +4,12 @@ |
|  |  | import org.eclipse.equinox.security.storage.ISecurePreferences; |
|  |  | import org.eclipse.equinox.security.storage.SecurePreferencesFactory; |
|  |  | import org.eclipse.equinox.security.storage.StorageException; |
|  |  | import org.eclipse.jface.dialogs.MessageDialog; |
|  |  | import org.eclipse.jface.preference.IPreferenceStore; |
|  |  | import org.eclipse.swt.graphics.Image; |
|  |  | import org.eclipse.swt.widgets.Display; |
|  |  | import org.eclipse.swt.widgets.Shell; |
|  |  | import org.eclipse.ui.PlatformUI; |
|  |  | import org.eclipse.ui.preferences.ScopedPreferenceStore; |
|  |  |  |
|  |  | public class SecurePreferenceStore extends ScopedPreferenceStore implements PreferenceStore { |
| Expand All | | @@ -14,7 +19,21 @@ public class SecurePreferenceStore extends ScopedPreferenceStore implements Pref |
|  |  |  |
|  |  | public SecurePreferenceStore() { |
|  |  | super(InstanceScope.INSTANCE, QUALIFIER); |
|  |  | node = SecurePreferencesFactory.getDefault().node(QUALIFIER); |
|  |  | ISecurePreferences secureStorage = SecurePreferencesFactory.getDefault(); |
|  |  | if (secureStorage == null) { |
|  |  | PlatformUI.getWorkbench().getDisplay().asyncExec(() -> { |
|  |  | Display display = PlatformUI.getWorkbench().getDisplay(); |
|  |  | Shell activeShell = display.getActiveShell(); |
|  |  | String message = "Eclipse was unable to create or access the Secure Storage mechanism. " |
|  |  | + "Please check your Secure Storage in Eclipse preferences under " |
|  |  | + "General -> Security -> Secure Storage. " |
|  |  | + "The Snyk plugin will not be able to work reliably and save preferences " |
|  |  | + "or the authentication token until Secure Storage can be used."; |
|  |  | String title = "Error accessing Eclipse Secure Storage (Snyk)"; |
|  |  | MessageDialog.openError(activeShell, title, message); |
|  |  | }); |
|  |  | } |
|  |  | node = secureStorage.node(QUALIFIER); |
|  |  | } |
|  |  |  |
|  |  | @Override |
| Expand Down | |  |

10 changes: 8 additions & 2 deletions

10
[plugin/src/main/java/io/snyk/eclipse/plugin/runner/SnykCliRunner.java](#diff-4db9cdef785dea124695685f0b659ce56e162d348987d538f3ef821f20dce395 "plugin/src/main/java/io/snyk/eclipse/plugin/runner/SnykCliRunner.java")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/plugin/src/main/java/io/snyk/eclipse/plugin/runner/SnykCliRunner.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,8 +17,6 @@ public class SnykCliRunner { |
|  |  | private static final String TEST\_PARAMS = "test"; |
|  |  | private static final String FILE\_PARAM = "--file="; |
|  |  |  |
|  |  | private static final String INSECURE = "--insecure"; |
|  |  |  |
|  |  | private static final String MONITOR\_PARAM = "monitor"; |
|  |  |  |
|  |  | // private static final String AUTH\_PARAM = "auth"; |
| Expand Down  Expand Up | | @@ -59,12 +57,20 @@ private ProcessResult snykRun(List<String> arguments) { |
|  |  |  |
|  |  | private ProcessResult snykRun(List<String> arguments, Optional<File> navigatePath) { |
|  |  | try { |
|  |  | checkIfTrusted(navigatePath.get()); |
|  |  | ProcessBuilder processBuilder = createProcessBuilderByOS(arguments, Preferences.getInstance().getPath()); |
|  |  | return processRunner.run(processBuilder, navigatePath); |
|  |  | } catch (Exception e) { |
|  |  | return ProcessResult.error(e.getMessage()); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | private void checkIfTrusted(File file) { |
|  |  | var trustedPaths = Preferences.getInstance().getPref(Preferences.TRUSTED\_FOLDERS, ""); |
|  |  | if (!trustedPaths.contains(file.getAbsolutePath())) { |
|  |  | throw new UntrustedScanRequestedException(file.getAbsolutePath() + " is not trusted."); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | private ProcessBuilder createProcessBuilderByOS(List<String> params, Optional<String> path) throws Exception { |
|  |  | ProcessBuilder processbuilder; |
| Expand Down | |  |

27 changes: 27 additions & 0 deletions

27
[plugin/src/main/java/io/snyk/eclipse/plugin/runner/UntrustedScanRequestedException.java](#diff-b5f1ca1a5373c67bbd72ea9f6d192e7799a2dee280a77e0625154be5ac21ba13 "plugin/src/main/java/io/snyk/eclipse/plugin/runner/UntrustedScanRequestedException.java")

Show comments

[View file](/snyk/snyk-eclipse-plugin/blob/b5a8bce25a359ced75f83a729fc6b2393fc9a495/plugin/src/main/java/io/snyk/eclipse/plugin/runner/UntrustedScanRequestedException.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,27 @@ |
|  |  | package io.snyk.eclipse.plugin.runner; |
|  |  |  |
|  |  | public class UntrustedScanRequestedException extends RuntimeException { |
|  |  |  |
|  |  | private static final long serialVersionUID = 4849361078384083852L; |
|  |  |  |
|  |  | public UntrustedScanRequestedException() { |
|  |  | } |
|  |  |  |
|  |  | public UntrustedScanRequestedException(String message) { |
|  |  | super(message); |
|  |  | } |
|  |  |  |
|  |  | public UntrustedScanRequestedException(Throwable cause) { |
|  |  | super(cause); |
|  |  | } |
|  |  |  |
|  |  | public UntrustedScanRequestedException(String message, Throwable cause) { |
|  |  | super(message, cause); |
|  |  | } |
|  |  |  |
|  |  | public UntrustedScanRequestedException(String message, Throwable cause, boolean enableSuppression, |
|  |  | boolean writableStackTrace) { |
|  |  | super(message, cause, enableSuppression, writableStackTrace); |
|  |  | } |
|  |  |  |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b5a8bce`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-eclipse-plugin%2Fcommit%2Fb5a8bce25a359ced75f83a729fc6b2393fc9a495) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1bf22f93_20250108_110745.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-visual-studio-plugin%2Fcommit%2F0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-visual-studio-plugin%2Fcommit%2F0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-visual-studio-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-visual-studio-plugin](/snyk/snyk-visual-studio-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-visual-studio-plugin) You must be signed in to change notification settings
* [Fork
  15](/login?return_to=%2Fsnyk%2Fsnyk-visual-studio-plugin)
* [Star
   31](/login?return_to=%2Fsnyk%2Fsnyk-visual-studio-plugin)

* [Code](/snyk/snyk-visual-studio-plugin)
* [Pull requests
  2](/snyk/snyk-visual-studio-plugin/pulls)
* [Actions](/snyk/snyk-visual-studio-plugin/actions)
* [Security](/snyk/snyk-visual-studio-plugin/security)
* [Insights](/snyk/snyk-visual-studio-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-visual-studio-plugin)
* [Pull requests](/snyk/snyk-visual-studio-plugin/pulls)
* [Actions](/snyk/snyk-visual-studio-plugin/actions)
* [Security](/snyk/snyk-visual-studio-plugin/security)
* [Insights](/snyk/snyk-visual-studio-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-visual-studio-plugin/commit/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

feat: add workspace trust ([#217](https://github.com/snyk/snyk-visual-studio-plugin/pull/217))

[Browse files](/snyk/snyk-visual-studio-plugin/tree/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a)
Browse the repository at this point in the history

* Loading branch information

[![@michelkaporin](https://avatars.githubusercontent.com/u/2239563?s=40&v=4)](/michelkaporin)

[michelkaporin](/snyk/snyk-visual-studio-plugin/commits?author=michelkaporin "View all commits by michelkaporin")
authored
Nov 29, 2022

1 parent
[94d17c0](/snyk/snyk-visual-studio-plugin/commit/94d17c09c9600005a80a7be97e5334f5246929e6)

commit 0b53dbb

 Show file tree

 Hide file tree

Showing
**19 changed files**
with
**638 additions**
and
**38 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* Snyk.VisualStudio.Extension.2022

  + Snyk.VisualStudio.Extension.2022/Snyk.VisualStudio.Extension.2022.csproj
    [Snyk.VisualStudio.Extension.2022.csproj](#diff-ffc9b9d614511c8a19eb20120b39b7dfcb6fc091e2ec16c1fb2377faea08b0a7)
  + Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml
    [TrustDialogWindow.xaml](#diff-18b793983b8f42f42befb63227ae8820482cb9061de7c9df9f72074ccd8bc1ca)
  + Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml.cs
    [TrustDialogWindow.xaml.cs](#diff-3738cc47f9883031e1fcd5c44e18d90d0ae4857fb33ff4ddfdd3b4d76bb237f9)
* Snyk.VisualStudio.Extension.Shared

  + Service

    - Snyk.VisualStudio.Extension.Shared/Service/ISnykServiceProvider.cs
      [ISnykServiceProvider.cs](#diff-b6e129f39aae5d26ee4ade4013688ed51edd81795bed1f3c8d686988c5711ee3)
    - Snyk.VisualStudio.Extension.Shared/Service/IWorkspaceTrustService.cs
      [IWorkspaceTrustService.cs](#diff-f59cff506ea77e46114b705b71aa0b0bdff78897a7b3bec1279554926fcd2c2a)
    - Snyk.VisualStudio.Extension.Shared/Service/SnykService.cs
      [SnykService.cs](#diff-b7478ecbf513e701cef9a917575b4bef777181bc267c68e090d09da38cbad617)
    - Snyk.VisualStudio.Extension.Shared/Service/SnykTasksService.cs
      [SnykTasksService.cs](#diff-3e4d53a2bfed40908a2d6f75dbe28c607702e90b26c1b02dd2f62d709bf5f0cd)
    - Snyk.VisualStudio.Extension.Shared/Service/WorkspaceTrustService.cs
      [WorkspaceTrustService.cs](#diff-467035038cc854db14cda22e6a32c428caf53f767ecf26f1c4eec610c2337811)
  + Settings

    - Snyk.VisualStudio.Extension.Shared/Settings/IUserStorageSettingsService.cs
      [IUserStorageSettingsService.cs](#diff-52b2557b2dfcc0634253c08449e0eb4c64edfd7550e12e6b432cc5f5114d2b87)
    - Snyk.VisualStudio.Extension.Shared/Settings/SnykSettings.cs
      [SnykSettings.cs](#diff-0ab3e121842bd6eb354664dba1f289fb052e73bd31e7f78e3a91ca0c1b7a91fc)
    - Snyk.VisualStudio.Extension.Shared/Settings/SnykUserStorageSettingsService.cs
      [SnykUserStorageSettingsService.cs](#diff-5a298698b83429b28a90433e36399b66d520f674be440e5826452da32c405374)
  + Snyk.VisualStudio.Extension.Shared/Snyk.VisualStudio.Extension.Shared.projitems
    [Snyk.VisualStudio.Extension.Shared.projitems](#diff-dcef30bc2e8c1178d206f612f752b3dda7bbfe5e8e708669feb92c128d8a2431)
  + UI/Toolwindow

    - Snyk.VisualStudio.Extension.Shared/UI/Toolwindow/MessagePanel.xaml
      [MessagePanel.xaml](#diff-f901df802a6bec2172e5e5bb2056000437701af3220dfb76a3abc40535ddde0a)
    - Snyk.VisualStudio.Extension.Shared/UI/Toolwindow/MessagePanel.xaml.cs
      [MessagePanel.xaml.cs](#diff-300e9478192a5981c6cf6bee6769205959e61d7c4395843d4d4b8d9bf0faa5a4)
* Snyk.VisualStudio.Extension.Tests/Service

  + Snyk.VisualStudio.Extension.Tests/Service/WorkspaceTrustServiceTest.cs
    [WorkspaceTrustServiceTest.cs](#diff-c6e78910ae45ee0b4542992181707f82b07db57552413b1e5ca588a140ec79e3)
* Snyk.VisualStudio.Extension

  + Snyk.VisualStudio.Extension/Snyk.VisualStudio.Extension.csproj
    [Snyk.VisualStudio.Extension.csproj](#diff-e8fabb8d10b1c841e010b5895b6729e17921b7dadd1be6be2e58d19158f9c91e)
  + Snyk.VisualStudio.Extension/TrustDialogWindow.xaml
    [TrustDialogWindow.xaml](#diff-8f5b6034ff51084ee78527f0a47666c24c838c3c4028549e48ad43e2488eefe6)
  + Snyk.VisualStudio.Extension/TrustDialogWindow.xaml.cs
    [TrustDialogWindow.xaml.cs](#diff-7b7b5289bc0de14aa19c800efee0a14f13ae8298115f267fc60fd102e466dd2e)

## There are no files selected for viewing

7 changes: 6 additions & 1 deletion

7
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,5 +1,10 @@ |
|  |  | # Snyk Changelog |
|  |  |  |
|  |  | ## [1.1.31] |
|  |  |  |
|  |  | ### Added |
|  |  | - Adds workspace trust mechanism to ensure scans are run on the trusted projects. |
|  |  |  |
|  |  | ## [1.1.30] |
|  |  |  |
|  |  | ### Changed |
| Expand Down  Expand Up | | @@ -48,7 +53,7 @@ |
|  |  |  |
|  |  | ### Added |
|  |  | - Organization description information in settings. |
|  |  |  |
|  |  |  |
|  |  | ### Fixed |
|  |  | - Changing custom endpoint settings leads to authentication errors. |
|  |  |  |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Snyk.VisualStudio.Extension.2022/Snyk.VisualStudio.Extension.2022.csproj](#diff-ffc9b9d614511c8a19eb20120b39b7dfcb6fc091e2ec16c1fb2377faea08b0a7 "Snyk.VisualStudio.Extension.2022/Snyk.VisualStudio.Extension.2022.csproj")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.2022/Snyk.VisualStudio.Extension.2022.csproj)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -49,6 +49,9 @@ |
|  |  | </PropertyGroup> |
|  |  | <ItemGroup> |
|  |  | <Compile Include="Properties\AssemblyInfo.cs" /> |
|  |  | <Compile Include="TrustDialogWindow.xaml.cs"> |
|  |  | <DependentUpon>TrustDialogWindow.xaml</DependentUpon> |
|  |  | </Compile> |
|  |  | </ItemGroup> |
|  |  | <ItemGroup> |
|  |  | <None Include="source.extension.vsixmanifest"> |
| Expand Down  Expand Up | | @@ -120,6 +123,12 @@ |
|  |  | <Name>Snyk.Common</Name> |
|  |  | </ProjectReference> |
|  |  | </ItemGroup> |
|  |  | <ItemGroup> |
|  |  | <Page Include="TrustDialogWindow.xaml"> |
|  |  | <Generator>MSBuild:Compile</Generator> |
|  |  | <SubType>Designer</SubType> |
|  |  | </Page> |
|  |  | </ItemGroup> |
|  |  | <Import Project="..\Snyk.VisualStudio.Extension.Shared\Snyk.VisualStudio.Extension.Shared.projitems" Label="Shared" /> |
|  |  | <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" /> |
|  |  | <Import Project="$(VSToolsPath)\VSSDK\Microsoft.VsSDK.targets" Condition="'$(VSToolsPath)' != ''" /> |
| Expand Down | |  |

59 changes: 59 additions & 0 deletions

59
[Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml](#diff-18b793983b8f42f42befb63227ae8820482cb9061de7c9df9f72074ccd8bc1ca "Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,59 @@ |
|  |  | <ui:DialogWindow x:Class="Snyk.VisualStudio.Extension.TrustDialogWindow" |
|  |  | x:Name="TrustWindow" |
|  |  | xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" |
|  |  | xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" |
|  |  | xmlns:d="http://schemas.microsoft.com/expression/blend/2008" |
|  |  | xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" |
|  |  | xmlns:toolkit="clr-namespace:Community.VisualStudio.Toolkit;assembly=Community.VisualStudio.Toolkit" |
|  |  | xmlns:ui="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.15.0" |
|  |  | mc:Ignorable="d" |
|  |  | WindowStartupLocation="CenterScreen" |
|  |  | IsCloseButtonEnabled="True" |
|  |  | HasHelpButton="False" |
|  |  | MinHeight="290" Height="290" |
|  |  | MinWidth="500" Width="500" |
|  |  | BorderBrush="{x:Static SystemColors.WindowFrameBrush}" BorderThickness="1" |
|  |  | WindowStyle="None" ResizeMode="NoResize" AllowsTransparency="True" |
|  |  | xmlns:catalog="clr-namespace:Microsoft.VisualStudio.Imaging;assembly=Microsoft.VisualStudio.ImageCatalog" |
|  |  | xmlns:imaging="clr-namespace:Microsoft.VisualStudio.Imaging;assembly=Microsoft.VisualStudio.Imaging" |
|  |  | toolkit:Themes.UseVsTheme="True" |
|  |  | Title="Snyk - This folder has not been trusted" |
|  |  | MouseDown="TrustDialogWindow\_OnMouseDown"> |
|  |  | <DockPanel Margin="10"> |
|  |  | <Button DockPanel.Dock="Top" HorizontalAlignment="Right" Click="DoNotTrustButton\_OnClick" MinWidth="1" MinHeight="1" Width="35" Margin="0" Padding="0"> |
|  |  | <imaging:CrispImage Moniker="{x:Static catalog:KnownMonikers.Close}"/> |
|  |  | </Button> |
|  |  | <StackPanel HorizontalAlignment="Right" DockPanel.Dock="Bottom" Orientation="Horizontal"> |
|  |  | <Button x:Name="TrustButton" Margin="5, 5" Content="Trust folder and continue" Click="TrustButton\_OnClick"/> |
|  |  | <Button x:Name="DoNotTrustButton" Margin="5, 5" Content="Don't scan" Click="DoNotTrustButton\_OnClick"/> |
|  |  | </StackPanel> |
|  |  | <Grid> |
|  |  | <Grid.RowDefinitions> |
|  |  | <RowDefinition Height="auto"/> |
|  |  | <RowDefinition Height="auto"/> |
|  |  | </Grid.RowDefinitions> |
|  |  | <Grid Grid.Row="0"> |
|  |  | <Grid.ColumnDefinitions> |
|  |  | <ColumnDefinition Width="\*"/> |
|  |  | <ColumnDefinition Width="5\*"/> |
|  |  | </Grid.ColumnDefinitions> |
|  |  | <imaging:CrispImage Grid.Column="0" Width="50" Moniker="{x:Static catalog:KnownMonikers.StatusSecurityWarning}"/> |
|  |  | <StackPanel VerticalAlignment="Center" Grid.Column="1" Margin="0, 0, 5, 0"> |
|  |  | <TextBlock FontSize="14">This folder has not been trusted:</TextBlock> |
|  |  | <TextBlock FontSize="14" FontWeight="Bold" TextWrapping="Wrap" Text="{Binding ElementName=TrustWindow, Path=FolderPath}"/> |
|  |  | </StackPanel> |
|  |  | </Grid> |
|  |  | <StackPanel Grid.Row="1" Margin="5"> |
|  |  | <TextBlock TextWrapping="Wrap"> |
|  |  | When scanning folder files for vulnerabilities, Snyk may automatically execute code such as invoking the package manager to get dependency information. You should only scan folders you trust. |
|  |  | </TextBlock> |
|  |  | <TextBlock> |
|  |  | <LineBreak/> |
|  |  | <Hyperlink NavigateUri="https://docs.snyk.io/ide-tools/visual-studio-extension/workspace-trust" RequestNavigate="Hyperlink\_OnRequestNavigate"> |
|  |  | More information |
|  |  | </Hyperlink> |
|  |  | </TextBlock> |
|  |  | </StackPanel> |
|  |  | </Grid> |
|  |  | </DockPanel> |
|  |  | </ui:DialogWindow> |

49 changes: 49 additions & 0 deletions

49
[Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml.cs](#diff-3738cc47f9883031e1fcd5c44e18d90d0ae4857fb33ff4ddfdd3b4d76bb237f9 "Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.2022/TrustDialogWindow.xaml.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,49 @@ |
|  |  | ﻿ |
|  |  | namespace Snyk.VisualStudio.Extension |
|  |  | { |
|  |  | using System.Diagnostics; |
|  |  | using System.Windows; |
|  |  | using System.Windows.Input; |
|  |  | using System.Windows.Navigation; |
|  |  | using Microsoft.VisualStudio.PlatformUI; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Trusted dialog window for Visual Studio 2022. |
|  |  | /// </summary> |
|  |  | public partial class TrustDialogWindow : DialogWindow |
|  |  | { |
|  |  | public TrustDialogWindow(string folderPath) |
|  |  | { |
|  |  | this.FolderPath = folderPath; |
|  |  | this.InitializeComponent(); |
|  |  | } |
|  |  |  |
|  |  | public string FolderPath { get; } |
|  |  |  |
|  |  | private void DoNotTrustButton\_OnClick(object sender, RoutedEventArgs e) |
|  |  | { |
|  |  | this.DialogResult = false; |
|  |  | this.Close(); |
|  |  | } |
|  |  |  |
|  |  | private void TrustButton\_OnClick(object sender, RoutedEventArgs e) |
|  |  | { |
|  |  | this.DialogResult = true; |
|  |  | this.Close(); |
|  |  | } |
|  |  |  |
|  |  | private void Hyperlink\_OnRequestNavigate(object sender, RequestNavigateEventArgs e) |
|  |  | { |
|  |  | Process.Start(new ProcessStartInfo(e.Uri.AbsoluteUri)); |
|  |  | e.Handled = true; |
|  |  | } |
|  |  |  |
|  |  | private void TrustDialogWindow\_OnMouseDown(object sender, MouseButtonEventArgs e) |
|  |  | { |
|  |  | if (e.ChangedButton == MouseButton.Left) |
|  |  | { |
|  |  | this.DragMove(); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |

2 changes: 2 additions & 0 deletions

2
[Snyk.VisualStudio.Extension.Shared/Service/ISnykServiceProvider.cs](#diff-b6e129f39aae5d26ee4ade4013688ed51edd81795bed1f3c8d686988c5711ee3 "Snyk.VisualStudio.Extension.Shared/Service/ISnykServiceProvider.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/ISnykServiceProvider.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -38,6 +38,8 @@ public interface ISnykServiceProvider |
|  |  | /// </summary> |
|  |  | ISolutionService SolutionService { get; } |
|  |  |  |
|  |  | IWorkspaceTrustService WorkspaceTrustService { get; } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets Tasks service instance. |
|  |  | /// </summary> |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[Snyk.VisualStudio.Extension.Shared/Service/IWorkspaceTrustService.cs](#diff-f59cff506ea77e46114b705b71aa0b0bdff78897a7b3bec1279554926fcd2c2a "Snyk.VisualStudio.Extension.Shared/Service/IWorkspaceTrustService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/IWorkspaceTrustService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,9 @@ |
|  |  | ﻿namespace Snyk.VisualStudio.Extension.Shared.Service |
|  |  | { |
|  |  | public interface IWorkspaceTrustService |
|  |  | { |
|  |  | bool IsFolderTrusted(string absoluteFolderPath); |
|  |  |  |
|  |  | void AddFolderToTrusted(string absoluteFolderPath); |
|  |  | } |
|  |  | } |

8 changes: 8 additions & 0 deletions

8
[Snyk.VisualStudio.Extension.Shared/Service/SnykService.cs](#diff-b7478ecbf513e701cef9a917575b4bef777181bc267c68e090d09da38cbad617 "Snyk.VisualStudio.Extension.Shared/Service/SnykService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/SnykService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -52,6 +52,8 @@ public class SnykService : ISnykServiceProvider, ISnykService |
|  |  |  |
|  |  | private ISentryService sentryService; |
|  |  |  |
|  |  | private IWorkspaceTrustService workspaceTrustService; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Initializes a new instance of the <see cref="SnykService"/> class. |
|  |  | /// </summary> |
| Expand All | | @@ -68,6 +70,11 @@ public class SnykService : ISnykServiceProvider, ISnykService |
|  |  | /// </summary> |
|  |  | public ISolutionService SolutionService => SnykSolutionService.Instance; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets solution service. |
|  |  | /// </summary> |
|  |  | public IWorkspaceTrustService WorkspaceTrustService => this.workspaceTrustService; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets Tasks service. |
|  |  | /// </summary> |
| Expand Down  Expand Up | | @@ -241,6 +248,7 @@ public async Task InitializeAsync(CancellationToken cancellationToken) |
|  |  | this.dte = await this.serviceProvider.GetServiceAsync(typeof(DTE)) as DTE2; |
|  |  | await SnykSolutionService.Instance.InitializeAsync(this); |
|  |  | this.tasksService = SnykTasksService.Instance; |
|  |  | this.workspaceTrustService = new WorkspaceTrustService(this.UserStorageSettingsService); |
|  |  |  |
|  |  | NotificationService.Initialize(this); |
|  |  | VsStatusBar.Initialize(this); |
| Expand Down | |  |

46 changes: 45 additions & 1 deletion

46
[Snyk.VisualStudio.Extension.Shared/Service/SnykTasksService.cs](#diff-3e4d53a2bfed40908a2d6f75dbe28c607702e90b26c1b02dd2f62d709bf5f0cd "Snyk.VisualStudio.Extension.Shared/Service/SnykTasksService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/SnykTasksService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,14 +4,17 @@ |
|  |  | using System.Collections.Generic; |
|  |  | using System.Threading; |
|  |  | using System.Threading.Tasks; |
|  |  | using Community.VisualStudio.Toolkit; |
|  |  | using Microsoft.VisualStudio.Shell; |
|  |  | using Microsoft.VisualStudio.Shell.Interop; |
|  |  | using Serilog; |
|  |  | using Snyk.Analytics; |
|  |  | using Snyk.Code.Library.Domain.Analysis; |
|  |  | using Snyk.Common; |
|  |  | using Snyk.VisualStudio.Extension.Shared.CLI; |
|  |  | using Snyk.VisualStudio.Extension.Shared.CLI.Download; |
|  |  | using Snyk.VisualStudio.Extension.Shared.Service.Domain; |
|  |  | using Snyk.VisualStudio.Extension.Shared.UI; |
|  |  | using static Snyk.VisualStudio.Extension.Shared.CLI.Download.SnykCliDownloader; |
|  |  | using Task = System.Threading.Tasks.Task; |
|  |  |  |
| Expand Down  Expand Up | | @@ -198,7 +201,6 @@ public void CancelTasks() |
|  |  | public async Task ScanAsync() |
|  |  | { |
|  |  | Logger.Information("Enter Scan method"); |
|  |  |  |
|  |  | try |
|  |  | { |
|  |  | var selectedFeatures = await this.GetFeaturesSettingsAsync(); |
| Expand All | | @@ -212,6 +214,13 @@ public async Task ScanAsync() |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | var isFolderTrusted = await this.IsFolderTrustedAsync(); |
|  |  | if (!isFolderTrusted) |
|  |  | { |
|  |  | Logger.Information("Workspace folder was not trusted for scanning."); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | this.serviceProvider.AnalyticsService.LogAnalysisIsTriggeredEvent(this.GetSelectedFeatures(selectedFeatures)); |
|  |  |  |
|  |  | var ossScanTask = this.ScanOssAsync(selectedFeatures); |
| Expand All | | @@ -225,6 +234,41 @@ public async Task ScanAsync() |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Checks if opened solution folder is trusted. If not, prompts a user with trust permission. |
|  |  | /// </summary> |
|  |  | /// <returns>Folder is trusted or not.</returns> |
|  |  | public async Task<bool> IsFolderTrustedAsync() |
|  |  | { |
|  |  | var solutionFolderPath = await this.serviceProvider.SolutionService.GetSolutionFolderAsync(); |
|  |  | var isFolderTrusted = this.serviceProvider.WorkspaceTrustService.IsFolderTrusted(solutionFolderPath); |
|  |  |  |
|  |  | if (string.IsNullOrEmpty(solutionFolderPath) || isFolderTrusted) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | var trustDialog = new TrustDialogWindow(solutionFolderPath); |
|  |  | var trusted = trustDialog.ShowModal(); |
|  |  |  |
|  |  | if (trusted != true) |
|  |  | { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | try |
|  |  | { |
|  |  | this.serviceProvider.WorkspaceTrustService.AddFolderToTrusted(solutionFolderPath); |
|  |  | Logger.Information("Workspace folder was trusted: {SolutionFolderPath}", solutionFolderPath); |
|  |  | return true; |
|  |  | } |
|  |  | catch (ArgumentException e) |
|  |  | { |
|  |  | Logger.Error(e, "Failed to add folder to trusted list."); |
|  |  | throw; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Start a CLI download task in background thread. |
|  |  | /// </summary> |
| Expand Down | |  |

89 changes: 89 additions & 0 deletions

89
[Snyk.VisualStudio.Extension.Shared/Service/WorkspaceTrustService.cs](#diff-467035038cc854db14cda22e6a32c428caf53f767ecf26f1c4eec610c2337811 "Snyk.VisualStudio.Extension.Shared/Service/WorkspaceTrustService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Service/WorkspaceTrustService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,89 @@ |
|  |  | ﻿namespace Snyk.VisualStudio.Extension.Shared.Service |
|  |  | { |
|  |  | using System; |
|  |  | using System.Collections.Generic; |
|  |  | using System.IO; |
|  |  | using System.Linq; |
|  |  | using Serilog; |
|  |  | using Snyk.Common; |
|  |  | using Snyk.VisualStudio.Extension.Shared.Settings; |
|  |  |  |
|  |  | public class WorkspaceTrustService : IWorkspaceTrustService |
|  |  | { |
|  |  | private static readonly ILogger Logger = LogManager.ForContext<WorkspaceTrustService>(); |
|  |  |  |
|  |  | private readonly IUserStorageSettingsService settingsService; |
|  |  |  |
|  |  | public WorkspaceTrustService(IUserStorageSettingsService settingsService) |
|  |  | { |
|  |  | this.settingsService = settingsService; |
|  |  | } |
|  |  |  |
|  |  | public void AddFolderToTrusted(string absoluteFolderPath) |
|  |  | { |
|  |  | if (!Path.IsPathRooted(absoluteFolderPath)) |
|  |  | { |
|  |  | throw new ArgumentException("Trusted folder path provided is not absolute."); |
|  |  | } |
|  |  |  |
|  |  | if (!Directory.Exists(absoluteFolderPath)) |
|  |  | { |
|  |  | throw new ArgumentException("Trusted folder doesn't exist."); |
|  |  | } |
|  |  |  |
|  |  | try |
|  |  | { |
|  |  | var trustedFolders = this.settingsService.TrustedFolders; |
|  |  | trustedFolders.Add(absoluteFolderPath); |
|  |  | this.settingsService.TrustedFolders = trustedFolders; |
|  |  | } |
|  |  | catch (Exception e) |
|  |  | { |
|  |  | Logger.Error(e, "Failed to add a folder to trusted."); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | public bool IsFolderTrusted(string absoluteFolderPath) |
|  |  | { |
|  |  | var trustedFolders = this.settingsService.TrustedFolders; |
|  |  |  |
|  |  | foreach (var trustedFolder in trustedFolders) |
|  |  | { |
|  |  | if (this.IsSubFolderOrEqual(trustedFolder, absoluteFolderPath)) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Verify if subfolder is rooted at parent path. |
|  |  | /// </summary> |
|  |  | /// <param name="parentPath">Parent path to check against.</param> |
|  |  | /// <param name="childPath">Subfolder path to verify.</param> |
|  |  | /// <returns>Returns true if childPath is subfolder of parentPath, or equal to it.</returns> |
|  |  | private bool IsSubFolderOrEqual(string parentPath, string childPath) |
|  |  | { |
|  |  | var parentUri = new Uri(parentPath); |
|  |  | if (new Uri(childPath).Equals(parentUri)) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | var childUri = new DirectoryInfo(childPath).Parent; |
|  |  | while (childUri != null) |
|  |  | { |
|  |  | if (new Uri(childUri.FullName).Equals(parentUri)) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | childUri = childUri.Parent; |
|  |  | } |
|  |  |  |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  | } |

9 changes: 9 additions & 0 deletions

9
[Snyk.VisualStudio.Extension.Shared/Settings/IUserStorageSettingsService.cs](#diff-52b2557b2dfcc0634253c08449e0eb4c64edfd7550e12e6b432cc5f5114d2b87 "Snyk.VisualStudio.Extension.Shared/Settings/IUserStorageSettingsService.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Settings/IUserStorageSettingsService.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,9 @@ |
|  |  | ﻿namespace Snyk.VisualStudio.Extension.Shared.Settings |
|  |  | { |
|  |  | using System.Collections.Generic; |
|  |  |  |
|  |  | public interface IUserStorageSettingsService |
|  |  | { |
|  |  | ISet<string> TrustedFolders { get; set; } |
|  |  | } |
|  |  | } |

7 changes: 6 additions & 1 deletion

7
[Snyk.VisualStudio.Extension.Shared/Settings/SnykSettings.cs](#diff-0ab3e121842bd6eb354664dba1f289fb052e73bd31e7f78e3a91ca0c1b7a91fc "Snyk.VisualStudio.Extension.Shared/Settings/SnykSettings.cs")

Show comments

[View file](/snyk/snyk-visual-studio-plugin/blob/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a/Snyk.VisualStudio.Extension.Shared/Settings/SnykSettings.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -61,8 +61,13 @@ public SnykSettings() |
|  |  | public bool BinariesAutoUpdateEnabled { get; set; } = true; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets or sets the value of the custom CLI path |
|  |  | /// Gets or sets the value of the custom CLI path. |
|  |  | /// </summary> |
|  |  | public string CustomCliPath { get; set; } = string.Empty; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets or sets an array of workspace trusted folders. |
|  |  | /// </summary> |
|  |  | public ISet<string> TrustedFolders { get; set; } = new HashSet<string>(); |
|  |  | } |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0b53dbb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-visual-studio-plugin%2Fcommit%2F0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.snyk.io_662e1e64_20250108_110747.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. snyk
# Code Injection Affecting [snyk](/package/npm/snyk) package, versions **<1.1064.0**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-SNYK-3111871#cvss)

### Threat Intelligence

EPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.93% (83rd percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Code Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**SNYK-JS-SNYK-3111871**
* published**30 Nov 2022**
* disclosed**29 Sept 2022**
* credit**Ron Masas - Imperva**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 29 Sep 2022

[CVE-2022-24441  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-24441) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-77  (opens in a new tab)](https://cwe.mitre.org/data/definitions/77.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `snyk` to version 1.1064.0 or higher.

## Overview

[snyk](https://www.npmjs.com/package/snyk) is a advanced tool that scans and monitors projects for security vulnerabilities.

Affected versions of this package are vulnerable to Code Injection.
when analyzing a project. An attacker who can convince a user to scan a malicious project can include
commands in a build file such as `build.gradle` or `gradle-wrapper.jar`, which will be executed with the privileges of the application.

This vulnerability may be triggered when running the the CLI tool directly, or when running a scan with one of the IDE plugins that invoke the Snyk CLI.

Successful exploitation of this issue would likely require some level of social engineering - to coerce an untrusted project to be downloaded and analyzed via the Snyk CLI or opened in an IDE where a Snyk IDE plugin is installed and enabled. Additionally, if the IDE has a Trust feature then the target folder must be marked as ‘trusted’ in order to be vulnerable.

**NOTE:** This issue is independent of the one reported in [CVE-2022-40764](https://security.snyk.io/vuln/SNYK-JS-SNYK-3037342), and upgrading to a fixed version for this addresses that issue as well.

The affected IDE plugins and versions are:

* VS Code - Affected: <=1.8.0, Fixed: 1.9.0
* IntelliJ - Affected: <=2.4.47, Fixed: 2.4.48
* Visual Studio - Affected: <=1.1.30, Fixed: 1.1.31
* Eclipse - Affected: <=v20221115, Fixed: v20221130
* Language Server - Affected: <=v20221109, Fixed: v20221130
## References

* [GitHub Commit (snyk-eclipse-plugin)](https://github.com/snyk/snyk-eclipse-plugin/commit/b5a8bce25a359ced75f83a729fc6b2393fc9a495)
* [GitHub Commit (snyk-intellij-plugin)](https://github.com/snyk/snyk-intellij-plugin/commit/56682f4ba6081ce1d95cb980cbfacd3809a826f4)
* [GitHub Commit (snyk-ls)](https://github.com/snyk/snyk-ls/commit/b3229f0142f782871aa72d1a7dcf417546d568ed)
* [GitHub Commit (snyk-visual-studio-plugin)](https://github.com/snyk/snyk-visual-studio-plugin/commit/0b53dbbd4a3153c3ef9aaf797af3b5caad0f731a)
* [GitHub Commit (vscode-extension)](https://github.com/snyk/vscode-extension/commit/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708)
* [Imperva Blog Post](https://www.imperva.com/blog/how-scanning-your-projects-for-security-issues-can-lead-to-remote-code-execution/)
* [Snyk Blog Post](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev/)
### CVSS Scores

version 3.1
### Snyk

5.8 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker is unauthorized prior to attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack.

  **None**
* User Interaction (UI)

  Successful exploitation of this vulnerability requires a user to take some action before the vulnerability can be exploited. For example, a successful exploit may only be possible during the installation of an application by a system administrator.

  **Required**

* Scope (S)

  An exploited vulnerability can affect resources beyond the security scope managed by the security authority of the vulnerable component. In this case, the vulnerable component and the impacted component are different and managed by different security authorities.

  **Changed**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

8.8 high
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_b7fc1e51_20250108_110744.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-ls%2Fcommit%2Fb3229f0142f782871aa72d1a7dcf417546d568ed)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-ls%2Fcommit%2Fb3229f0142f782871aa72d1a7dcf417546d568ed)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-ls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-ls](/snyk/snyk-ls)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-ls) You must be signed in to change notification settings
* [Fork
  8](/login?return_to=%2Fsnyk%2Fsnyk-ls)
* [Star
   49](/login?return_to=%2Fsnyk%2Fsnyk-ls)

* [Code](/snyk/snyk-ls)
* [Pull requests
  4](/snyk/snyk-ls/pulls)
* [Actions](/snyk/snyk-ls/actions)
* [Security](/snyk/snyk-ls/security)
* [Insights](/snyk/snyk-ls/pulse)

Additional navigation options

* [Code](/snyk/snyk-ls)
* [Pull requests](/snyk/snyk-ls/pulls)
* [Actions](/snyk/snyk-ls/actions)
* [Security](/snyk/snyk-ls/security)
* [Insights](/snyk/snyk-ls/pulse)

## Commit

[Permalink](/snyk/snyk-ls/commit/b3229f0142f782871aa72d1a7dcf417546d568ed)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

feat: add trust management mechanism ([#187](https://github.com/snyk/snyk-ls/pull/187))

[Browse files](/snyk/snyk-ls/tree/b3229f0142f782871aa72d1a7dcf417546d568ed)
Browse the repository at this point in the history

* Loading branch information

[![@michelkaporin](https://avatars.githubusercontent.com/u/2239563?s=40&v=4)](/michelkaporin)

[michelkaporin](/snyk/snyk-ls/commits?author=michelkaporin "View all commits by michelkaporin")
authored
Nov 29, 2022

1 parent
[18cbb0c](/snyk/snyk-ls/commit/18cbb0ca8cb4410b845d7aa55a8e7cddde526331)

commit b3229f0

 Show file tree

 Hide file tree

Showing
**22 changed files**
with
**922 additions**
and
**104 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .goreleaser.yaml
  [.goreleaser.yaml](#diff-7326b55c062b0f46fe9e39aace0a25f4515cf206040fb91a6fd2cae839f5e826)
* Makefile
  [Makefile](#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52)
* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* application

  + config

    - application/config/config.go
      [config.go](#diff-d9a33e7e08d7d8fb8292de9d94d5bab14156125922662d7448de0951894ec11d)
    - application/config/config\_test.go
      [config\_test.go](#diff-4b02e59e3895dc3b4b6db6358e4373a26556b0ab142231265f014adaea3de77a)
  + server

    - application/server/configuration.go
      [configuration.go](#diff-eb3fe6fd1956591838595b08979653ec23c0b0c16f5340e9e89a05c30e921607)
    - application/server/configuration\_test.go
      [configuration\_test.go](#diff-e141faafb3f0507956b85e92ac3b584c7c706bd96e7f428c7ef95d0d8b2df564)
    - application/server/execute\_command.go
      [execute\_command.go](#diff-523ba95647cc7cf643285dc5a700fafb1c295bfbdc06065624232a888d1df3ef)
    - application/server/execute\_command\_test.go
      [execute\_command\_test.go](#diff-62dafdad0c9b4059a5d99a1eb3f1fcf677e7720b1cac9f4f87ea711faeec86ab)
    - lsp

      * application/server/lsp/message\_types.go
        [message\_types.go](#diff-9f91de822e2d937c99a7348039b3f4923b3456456f90ca5327b15699757dd7be)
    - application/server/server.go
      [server.go](#diff-1b5a200b7dc3f37ed67632d0c2682eeb53762813f96edb15cb7660e076fa6031)
    - application/server/server\_test.go
      [server\_test.go](#diff-165bad981a0cc202462a2fea7f236eab9ca3a72bd47fe8bae6b3adad801351fb)
    - application/server/trust.go
      [trust.go](#diff-3970defef5894af7dc71029fc6f04b3b220c38a23c0ced9f702194618a09b64a)
    - application/server/trust\_test.go
      [trust\_test.go](#diff-e429a057cdac11e281a6ee8603bf8a5ab6dfaf0daedaec873982c47b28d7d431)
* domain

  + ide/workspace

    - domain/ide/workspace/folder.go
      [folder.go](#diff-92ee5447150d64c4b9a6c8c8e8834577ada9e739d1a0a2842ef5bc79fd014f26)
    - domain/ide/workspace/folder\_test.go
      [folder\_test.go](#diff-bb03ee76aabde8be49355b245229584151a114e49ec791407738dcaeb631acaf)
    - domain/ide/workspace/workspace.go
      [workspace.go](#diff-94caf15aa8dbede6c14076876272de2f4156d51238e7862b553fbf6cca8d9a25)
    - domain/ide/workspace/workspace\_test.go
      [workspace\_test.go](#diff-8b15a4314c4b8fec249174af4d164a17c6e0f8686690a5a03db609fc40cb9afd)
    - domain/ide/workspace/workspace\_trust.go
      [workspace\_trust.go](#diff-4b33739b49e3b8cd9107cd48b1a93b154d197036ee73222aa961a760918bd1fd)
    - domain/ide/workspace/workspace\_trust\_test.go
      [workspace\_trust\_test.go](#diff-ac8e52aa69f3b6fb4fd604078ddeef7df2cfe4814df32258a855a7e2254d9af1)
  + snyk

    - domain/snyk/command.go
      [command.go](#diff-8232d6cb0a45d400541fba85699fcebcdd20400cf799031d4c7d6f66279e1435)
* internal/testutil

  + internal/testutil/test\_setup.go
    [test\_setup.go](#diff-419938158429a6faf32768534f081b50d64ed0bc9823ed5e6b7f94292840b1c3)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[.goreleaser.yaml](#diff-7326b55c062b0f46fe9e39aace0a25f4515cf206040fb91a6fd2cae839f5e826 ".goreleaser.yaml")

Show comments

[View file](/snyk/snyk-ls/blob/b3229f0142f782871aa72d1a7dcf417546d568ed/.goreleaser.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -60,4 +60,4 @@ dist: build |
|  |  | env: |
|  |  | - GO111MODULE=on |
|  |  | - CGO\_ENABLED=0 |
|  |  | - LS\_PROTOCOL\_VERSION=3 |
|  |  | - LS\_PROTOCOL\_VERSION=4 |

2 changes: 1 addition & 1 deletion

2
[Makefile](#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52 "Makefile")

Show comments

[View file](/snyk/snyk-ls/blob/b3229f0142f782871aa72d1a7dcf417546d568ed/Makefile)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -37,7 +37,7 @@ tools: |
|  |  | @echo "==> Installing go-licenses" |
|  |  | @go install github.com/google/go-licenses@latest |
|  |  | ifeq (,$(wildcard ./.bin/golangci-lint\*)) |
|  |  | @curl -sSfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh | sh -s -- -b .bin/ v1.48.0 |
|  |  | @curl -sSfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh | sh -s -- -b .bin/ v1.50.0 |
|  |  | else |
|  |  | @echo "==> golangci-lint is already installed" |
|  |  | endif |
| Expand Down | |  |

40 changes: 37 additions & 3 deletions

40
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/snyk/snyk-ls/blob/b3229f0142f782871aa72d1a7dcf417546d568ed/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -75,6 +75,15 @@ Right now the language server supports the following actions: |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | - Trust Notification |
|  |  | - method: `$/snyk.addTrustedFolders` |
|  |  | - payload: |
|  |  | ```json |
|  |  | { |
|  |  | "trustedFolders": ["/a/path/to/trust"] |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | ## Installation |
|  |  |  |
|  |  | ### Download |
| Expand Down  Expand Up | | @@ -132,12 +141,37 @@ within `initializationOptions?: LSPAny;` we support the following settings: |
|  |  | "organization": "a string", // The name of your organization, e.g. the output of: curl -H "Authorization: token $(snyk config get api)" https://snyk.io/api/cli-config/settings/sast | jq .org |
|  |  | "enableTelemetry": "true", // Whether or not user analytics can be tracked |
|  |  | "manageBinariesAutomatically": "true", // Whether or not CLI/LS binaries will be downloaded & updated automatically |
|  |  | "cliPath": "/a/patch/snyk-cli" // The path where the CLI can be found, or where it should be downloaded to |
|  |  | "token": "secret-token" // The Snyk token, e.g.: snyk config get api |
|  |  | "automaticAuthentication": "true" // Whether or not LS will automatically authenticate on scan start (default: true) |
|  |  | "cliPath": "/a/patch/snyk-cli", // The path where the CLI can be found, or where it should be downloaded to |
|  |  | "token": "secret-token", // The Snyk token, e.g.: snyk config get api |
|  |  | "automaticAuthentication": "true", // Whether or not LS will automatically authenticate on scan start (default: true) |
|  |  | "enableTrustedFoldersFeature": "true", // Whether or not LS will prompt to trust a folder (default: true) |
|  |  | "trustedFolders": ["/a/trusted/path", "/another/trusted/path"], // An array of folder that should be trusted |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | #### Workspace Trust |
|  |  |  |
|  |  | As part of examining the codebase for vulnerabilities, Snyk may automatically execute code on your computer to obtain |
|  |  | additional data for analysis. For example, this includes invoking the package manager (e.g., pip, gradle, maven, yarn, |
|  |  | npm, etc.) |
|  |  | to get dependency information for Snyk Open Source. Invoking these programs on untrusted code that has malicious |
|  |  | configurations may expose your system to malicious code execution and exploits. |
|  |  |  |
|  |  | To safeguard from using the language server on untrusted folders, our language server will ask for folder trust |
|  |  | before running scans against these folders. When in doubt, do not grant trust. |
|  |  |  |
|  |  | The trust feature is enabled by default. When a folder is trusted, all sub-folders are also trusted. After a folder |
|  |  | is trusted, Snyk Language Server notifies the Language Server Client with the custom `$/snyk.addTrustedFolders` |
|  |  | notification, |
|  |  | which contains a list of currently trusted folder paths. Based on this, a client can then implement logic to intercept |
|  |  | this notification and persist the decision and trust in the IDE or Editor storage mechanism. |
|  |  |  |
|  |  | Trust dialogs can be disabled by setting `enableTrustedFoldersFeature` to `false` in the initialization options. This |
|  |  | will disable all trust prompts and checks. |
|  |  |  |
|  |  | An initial set of trusted folders can be provided by setting `trustedFolders` to an array of paths in the |
|  |  | `initializationOptions`. These folders will be trusted on startup and will not prompt the user to trust them. |
|  |  |  |
|  |  | #### Environment variables |
|  |  |  |
|  |  | Snyk LS and Snyk CLI support and need certain environment variables to function: |
| Expand Down | |  |

79 changes: 52 additions & 27 deletions

79
[application/config/config.go](#diff-d9a33e7e08d7d8fb8292de9d94d5bab14156125922662d7448de0951894ec11d "application/config/config.go")

Show comments

[View file](/snyk/snyk-ls/blob/b3229f0142f782871aa72d1a7dcf417546d568ed/application/config/config.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -119,33 +119,35 @@ func (c \*CliSettings) DefaultBinaryInstallPath() string { |
|  |  | } |
|  |  |  |
|  |  | type Config struct { |
|  |  | configLoaded concurrency.AtomicBool |
|  |  | cliSettings \*CliSettings |
|  |  | configFile string |
|  |  | format string |
|  |  | isErrorReportingEnabled concurrency.AtomicBool |
|  |  | isSnykCodeEnabled concurrency.AtomicBool |
|  |  | isSnykOssEnabled concurrency.AtomicBool |
|  |  | isSnykIacEnabled concurrency.AtomicBool |
|  |  | isSnykContainerEnabled concurrency.AtomicBool |
|  |  | isSnykAdvisorEnabled concurrency.AtomicBool |
|  |  | isTelemetryEnabled concurrency.AtomicBool |
|  |  | manageBinariesAutomatically concurrency.AtomicBool |
|  |  | logPath string |
|  |  | organization string |
|  |  | snykCodeAnalysisTimeout time.Duration |
|  |  | snykApiUrl string |
|  |  | snykCodeApiUrl string |
|  |  | token string |
|  |  | deviceId string |
|  |  | clientCapabilities lsp.ClientCapabilities |
|  |  | m sync.Mutex |
|  |  | path string |
|  |  | defaultDirs []string |
|  |  | integrationName string |
|  |  | integrationVersion string |
|  |  | automaticAuthentication bool |
|  |  | tokenChangeChannels []chan string |
|  |  | configLoaded concurrency.AtomicBool |
|  |  | cliSettings \*CliSettings |
|  |  | configFile string |
|  |  | format string |
|  |  | isErrorReportingEnabled concurrency.AtomicBool |
|  |  | isSnykCodeEnabled concurrency.AtomicBool |
|  |  | isSnykOssEnabled concurrency.AtomicBool |
|  |  | isSnykIacEnabled concurrency.AtomicBool |
|  |  | isSnykContainerEnabled concurrency.AtomicBool |
|  |  | isSnykAdvisorEnabled concurrency.AtomicBool |
|  |  | isTelemetryEnabled concurrency.AtomicBool |
|  |  | manageBinariesAutomatically concurrency.AtomicBool |
|  |  | logPath string |
|  |  | organization string |
|  |  | snykCodeAnalysisTimeout time.Duration |
|  |  | snykApiUrl string |
|  |  | snykCodeApiUrl string |
|  |  | token string |
|  |  | deviceId string |
|  |  | clientCapabilities lsp.ClientCapabilities |
|  |  | m sync.Mutex |
|  |  | path string |
|  |  | defaultDirs []string |
|  |  | integrationName string |
|  |  | integrationVersion string |
|  |  | automaticAuthentication bool |
|  |  | tokenChangeChannels []chan string |
|  |  | trustedFolders []string |
|  |  | trustedFoldersFeatureEnabled bool |
|  |  | } |
|  |  |  |
|  |  | func CurrentConfig() \*Config { |
| Expand Down  Expand Up | | @@ -185,6 +187,7 @@ func New() \*Config { |
|  |  | c.snykCodeApiUrl = defaultDeeproxyApiUrl |
|  |  | c.snykCodeAnalysisTimeout = snykCodeAnalysisTimeoutFromEnv() |
|  |  | c.token = "" |
|  |  | c.trustedFoldersFeatureEnabled = true |
|  |  | c.clientSettingsFromEnv() |
|  |  | c.deviceId = c.determineDeviceId() |
|  |  | c.addDefaults() |
| Expand All | | @@ -211,6 +214,16 @@ func (c \*Config) determineDeviceId() string { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func (c \*Config) IsTrustedFolderFeatureEnabled() bool { |
|  |  | return c.trustedFoldersFeatureEnabled |
|  |  | } |
|  |  |  |
|  |  | func (c \*Config) SetTrustedFolderFeatureEnabled(enabled bool) { |
|  |  | c.m.Lock() |
|  |  | defer c.m.Unlock() |
|  |  | c.trustedFoldersFeatureEnabled = enabled |
|  |  | } |
|  |  |  |
|  |  | func (c \*Config) Load() { |
|  |  | files := c.configFiles() |
|  |  | for \_, fileName := range files { |
| Expand Down  Expand Up | | @@ -538,3 +551,15 @@ func (c \*Config) SetIntegrationName(integrationName string) { |
|  |  | func (c \*Config) SetIntegrationVersion(integrationVersion string) { |
|  |  | c.integrationVersion = integrationVersion |
|  |  | } |
|  |  |  |
|  |  | func (c \*Config) TrustedFolders() []string { |
|  |  | c.m.Lock() |
|  |  | defer c.m.Unlock() |
|  |  | return c.trustedFolders |
|  |  | } |
|  |  |  |
|  |  | func (c \*Config) SetTrustedFolders(folderPaths []string) { |
|  |  | c.m.Lock() |
|  |  | defer c.m.Unlock() |
|  |  | c.trustedFolders = folderPaths |
|  |  | } |

1 change: 1 addition & 0 deletions

1
[application/config/config\_test.go](#diff-4b02e59e3895dc3b4b6db6358e4373a26556b0ab142231265f014adaea3de77a "application/config/config_test.go")

Show comments

[View file](/snyk/snyk-ls/blob/b3229f0142f782871aa72d1a7dcf417546d568ed/application/config/config_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -45,6 +45,7 @@ func TestConfigDefaults(t \*testing.T) { |
|  |  | assert.True(t, c.IsSnykIacEnabled(), "Snyk IaC should be enabled by default") |
|  |  | assert.Equal(t, "", c.LogPath(), "Logpath should be empty by default") |
|  |  | assert.Equal(t, "md", c.Format(), "Output format should be md by default") |
|  |  | assert.Empty(t, c.trustedFolders) |
|  |  | } |
|  |  |  |
|  |  | func Test\_TokenChanged\_ChannelsInformed(t \*testing.T) { |
| Expand Down | |  |

21 changes: 18 additions & 3 deletions

21
[application/server/configuration.go](#diff-eb3fe6fd1956591838595b08979653ec23c0b0c16f5340e9e89a05c30e921607 "application/server/configuration.go")

Show comments

[View file](/snyk/snyk-ls/blob/b3229f0142f782871aa72d1a7dcf417546d568ed/application/server/configuration.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,6 +19,7 @@ package server |
|  |  | import ( |
|  |  | "context" |
|  |  | "os" |
|  |  | "reflect" |
|  |  | "strconv" |
|  |  | "strings" |
|  |  |  |
| Expand All | | @@ -37,7 +38,7 @@ func WorkspaceDidChangeConfiguration(srv \*jrpc2.Server) jrpc2.Handler { |
|  |  | defer log.Info().Str("method", "WorkspaceDidChangeConfiguration").Interface("params", params).Msg("DONE") |
|  |  |  |
|  |  | emptySettings := lsp.Settings{} |
|  |  | if params.Settings != emptySettings { |
|  |  | if !reflect.DeepEqual(params.Settings, emptySettings) { |
|  |  | // client used settings push |
|  |  | UpdateSettings(ctx, params.Settings) |
|  |  | return true, nil |
| Expand Down  Expand Up | | @@ -65,7 +66,7 @@ func WorkspaceDidChangeConfiguration(srv \*jrpc2.Server) jrpc2.Handler { |
|  |  | return false, err |
|  |  | } |
|  |  |  |
|  |  | if fetchedSettings[0] != emptySettings { |
|  |  | if !reflect.DeepEqual(fetchedSettings[0], emptySettings) { |
|  |  | UpdateSettings(ctx, fetchedSettings[0]) |
|  |  | return true, nil |
|  |  | } |
| Expand All | | @@ -86,7 +87,7 @@ func UpdateSettings(ctx context.Context, settings lsp.Settings) { |
|  |  |  |
|  |  | func writeSettings(ctx context.Context, settings lsp.Settings, initialize bool) { |
|  |  | emptySettings := lsp.Settings{} |
|  |  | if settings == emptySettings { |
|  |  | if reflect.DeepEqual(settings, emptySettings) { |
|  |  | return |
|  |  | } |
|  |  | updateToken(settings.Token) |
| Expand All | | @@ -98,6 +99,20 @@ func writeSettings(ctx context.Context, settings lsp.Settings, initialize bool) |
|  |  | updateTelemetry(settings) |
|  |  | updateOrganization(settings) |
|  |  | manageBinariesAutomatically(settings) |
|  |  | updateTrustedFolders(settings) |
|  |  | } |
|  |  |  |
|  |  | func updateTrustedFolders(settings lsp.Settings) { |
|  |  | trustedFoldersFeatureEnabled, err := strconv.ParseBool(settings.EnableTrustedFoldersFeature) |
|  |  | if err == nil { |
|  |  | config.CurrentConfig().SetTrustedFolderFeatureEnabled(trustedFoldersFeatureEnabled) |
|  |  | } else { |
|  |  | config.CurrentConfig().SetTrustedFolderFeatureEnabled(true) |
|  |  | } |
|  |  |  |
|  |  | if settings.TrustedFolders != nil { |
|  |  | config.CurrentConfig().SetTrustedFolders(settings.TrustedFolders) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func updateAutoAuthentication(settings lsp.Settings) { |
| Expand Down | |  |

14 changes: 13 additions & 1 deletion

14
[application/server/configuration\_test.go](#diff-e141faafb3f0507956b85e92ac3b584c7c706bd96e7f428c7ef95d0d8b2df564 "application/server/configuration_test.go")

Show comments

[View file](/snyk/snyk-ls/blob/b3229f0142f782871aa72d1a7dcf417546d568ed/application/server/configuration_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -71,7 +71,7 @@ func Test\_WorkspaceDidChangeConfiguration\_Push(t \*testing.T) { |
|  |  | assert.Equal(t, "token", config.CurrentConfig().Token()) |
|  |  | } |
|  |  |  |
|  |  | func callBackMock(ctx context.Context, request \*jrpc2.Request) (interface{}, error) { |
|  |  | func callBackMock(\_ context.Context, request \*jrpc2.Request) (interface{}, error) { |
|  |  | jsonRPCRecorder.Record(\*request) |
|  |  | if request.Method() == "workspace/configuration" { |
|  |  | return []lsp.Settings{sampleSettings}, nil |
| Expand Down  Expand Up | | @@ -151,6 +151,7 @@ func Test\_UpdateSettings(t \*testing.T) { |
|  |  | ManageBinariesAutomatically: "false", |
|  |  | CliPath: "C:\\Users\\CliPath\\snyk-ls.exe", |
|  |  | Token: "a fancy token", |
|  |  | TrustedFolders: []string{"trustedPath1", "trustedPath2"}, |
|  |  | } |
|  |  |  |
|  |  | UpdateSettings(context.Background(), settings) |
| Expand All | | @@ -171,6 +172,8 @@ func Test\_UpdateSettings(t \*testing.T) { |
|  |  | assert.False(t, c.ManageBinariesAutomatically()) |
|  |  | assert.Equal(t, "C:\\Users\\CliPath\\snyk-ls.exe", c.CliSettings().Path()) |
|  |  | assert.Equal(t, "a fancy token", c.Token()) |
|  |  | assert.Contains(t, c.TrustedFolders(), "trustedPath1") |
|  |  | assert.Contains(t, c.TrustedFolders(), "trustedPath2") |
|  |  | }) |
|  |  |  |
|  |  | t.Run("blank organisation is ignored", func(t \*testing.T) { |
| Expand Down  Expand Up | | @@ -209,6 +212,15 @@ func Test\_UpdateSettings(t \*testing.T) { |
|  |  | assert.Empty(t, os.Getenv("b")) |
|  |  | assert.Empty(t, os.Getenv(";")) |
|  |  | }) |
|  |  | t.Run("trusted folders", func(t \*testing.T) { |
|  |  | config.SetCurrentConfig(config.New()) |
|  |  |  |
|  |  | UpdateSettings(context.Background(), lsp.Settings{TrustedFolders: []string{"/a/b", "/b/c"}}) |
|  |  |  |
|  |  | c := config.CurrentConfig() |
|  |  | assert.Contains(t, c.TrustedFolders(), "/a/b") |
|  |  | assert.Contains(t, c.TrustedFolders(), "/b/c") |
|  |  | }) |
|  |  |  |
|  |  | t.Run("manage binaries automatically", func(t \*testing.T) { |
|  |  | t.Run("true", func(t \*testing.T) { |
| Expand Down | |  |

30 changes: 28 additions & 2 deletions

30
[application/server/execute\_command.go](#diff-523ba95647cc7cf643285dc5a700fafb1c295bfbdc06065624232a888d1df3ef "application/server/execute_command.go")

Show comments

[View file](/snyk/snyk-ls/blob/b3229f0142f782871aa72d1a7dcf417546d568ed/application/server/execute_command.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,9 @@ import ( |
|  |  | "github.com/rs/zerolog/log" |
|  |  | sglsp "github.com/sourcegraph/go-lsp" |
|  |  |  |
|  |  | "github.com/snyk/snyk-ls/application/config" |
|  |  | "github.com/snyk/snyk-ls/application/di" |
|  |  | "github.com/snyk/snyk-ls/application/server/lsp" |
|  |  | "github.com/snyk/snyk-ls/domain/ide/command" |
|  |  | "github.com/snyk/snyk-ls/domain/ide/workspace" |
|  |  | "github.com/snyk/snyk-ls/domain/snyk" |
| Expand All | | @@ -49,10 +51,18 @@ func ExecuteCommandHandler(srv \*jrpc2.Server) jrpc2.Handler { |
|  |  | } |
|  |  | navigateToLocation(srv, args) |
|  |  | case snyk.WorkspaceScanCommand: |
|  |  | workspace.Get().ClearIssues(bgCtx) |
|  |  | workspace.Get().ScanWorkspace(bgCtx) |
|  |  | w := workspace.Get() |
|  |  | w.ClearIssues(bgCtx) |
|  |  | w.ScanWorkspace(bgCtx) |
|  |  | handleUntrustedFolders(bgCtx, srv) |
|  |  | case snyk.OpenBrowserCommand: |
|  |  | command.OpenBrowser(params.Arguments[0].(string)) |
|  |  | case snyk.TrustWorkspaceFoldersCommand: |
|  |  | err := TrustWorkspaceFolders() |
|  |  | if err != nil { |
|  |  | log.Err(err).Msgf("Error on %s command", snyk.TrustWorkspaceFoldersCommand) |
|  |  | notification.SendError(err) |
|  |  | } |
|  |  | case snyk.LoginCommand: |
|  |  | authenticator := di.Authenticator() |
|  |  | \_, err := authenticator.Authenticate(context.Background()) |
| Expand All | | @@ -75,3 +85,19 @@ func ExecuteCommandHandler(srv \*jrpc2.Server) jrpc2.Handler { |
|  |  | return nil, nil |
|  |  | }) |
|  |  | } |
|  |  |  |
|  |  | func TrustWorkspaceFolders() error { |
|  |  | if !config.CurrentConfig().IsTrustedFolderFeatureEnabled() { |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | trustedFolderPaths := config.CurrentConfig().TrustedFolders() |
|  |  | \_, untrusted := workspace.Get().GetFolderTrust() |
|  |  | for \_, folder := range untrusted { |
|  |  | trustedFolderPaths = append(trustedFolderPaths, folder.Path()) |
|  |  | } |
|  |  |  |
|  |  | config.CurrentConfig().SetTrustedFolders(trustedFolderPaths) |
|  |  | notification.Send(lsp.SnykTrustedFoldersParams{TrustedFolders: trustedFolderPaths}) |
|  |  | return nil |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b3229f0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-ls%2Fcommit%2Fb3229f0142f782871aa72d1a7dcf417546d568ed) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_862aac68_20250108_110743.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-intellij-plugin%2Fcommit%2F56682f4ba6081ce1d95cb980cbfacd3809a826f4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-intellij-plugin%2Fcommit%2F56682f4ba6081ce1d95cb980cbfacd3809a826f4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-intellij-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-intellij-plugin](/snyk/snyk-intellij-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-intellij-plugin) You must be signed in to change notification settings
* [Fork
  34](/login?return_to=%2Fsnyk%2Fsnyk-intellij-plugin)
* [Star
   59](/login?return_to=%2Fsnyk%2Fsnyk-intellij-plugin)

* [Code](/snyk/snyk-intellij-plugin)
* [Pull requests
  1](/snyk/snyk-intellij-plugin/pulls)
* [Discussions](/snyk/snyk-intellij-plugin/discussions)
* [Actions](/snyk/snyk-intellij-plugin/actions)
* [Security](/snyk/snyk-intellij-plugin/security)
* [Insights](/snyk/snyk-intellij-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-intellij-plugin)
* [Pull requests](/snyk/snyk-intellij-plugin/pulls)
* [Discussions](/snyk/snyk-intellij-plugin/discussions)
* [Actions](/snyk/snyk-intellij-plugin/actions)
* [Security](/snyk/snyk-intellij-plugin/security)
* [Insights](/snyk/snyk-intellij-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-intellij-plugin/commit/56682f4ba6081ce1d95cb980cbfacd3809a826f4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#417](https://github.com/snyk/snyk-intellij-plugin/pull/417) from snyk/feat/trust

[Browse files](/snyk/snyk-intellij-plugin/tree/56682f4ba6081ce1d95cb980cbfacd3809a826f4)
Browse the repository at this point in the history

```
feat: add workspace trust feature
```

* Loading branch information

[![@michelkaporin](https://avatars.githubusercontent.com/u/2239563?s=40&v=4)](/michelkaporin)

[michelkaporin](/snyk/snyk-intellij-plugin/commits?author=michelkaporin "View all commits by michelkaporin")
authored
Nov 29, 2022

2 parents
[c8eb31d](/snyk/snyk-intellij-plugin/commit/c8eb31df896b724666173d6279d581a92f037193)
+
[ab6c0b4](/snyk/snyk-intellij-plugin/commit/ab6c0b4e18ac73538f3bde14d97cfb30a784544f)

commit 56682f4

 Show file tree

 Hide file tree

Showing
**14 changed files**
with
**363 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* build.gradle.kts
  [build.gradle.kts](#diff-c0dfa6bc7a8685217f70a860145fbdf416d449eaff052fa28352c5cec1a98c06)
* src

  + integTest/kotlin

    - io/snyk/plugin

      * services

        + src/integTest/kotlin/io/snyk/plugin/services/SnykTaskQueueServiceTest.kt
          [SnykTaskQueueServiceTest.kt](#diff-2aac80345d23b86bf43c70c945089faa59b5657ec020cf4aeae519f4c1b84531)
      * ui/toolwindow

        + src/integTest/kotlin/io/snyk/plugin/ui/toolwindow/SnykAuthPanelIntegTest.kt
          [SnykAuthPanelIntegTest.kt](#diff-dceff2f0571c70c717205715cd2a4fe13fdc7da18843b9a143e4e1d138773038)
        + src/integTest/kotlin/io/snyk/plugin/ui/toolwindow/SnykToolWindowPanelIntegTest.kt
          [SnykToolWindowPanelIntegTest.kt](#diff-4e3ab4514950bd11354e210920fa3965cc6df09be4cfb727786ea5cfb49ced3b)
    - snyk/trust

      * src/integTest/kotlin/snyk/trust/WorkspaceTrustServiceTest.kt
        [WorkspaceTrustServiceTest.kt](#diff-74dcce786aaf766ed079e9e3a3c4e9c72e296a398f7457fa61d061cfd3a9ef5d)
  + main

    - kotlin

      * io/snyk/plugin

        + services

          - src/main/kotlin/io/snyk/plugin/services/SnykTaskQueueService.kt
            [SnykTaskQueueService.kt](#diff-aeaa58ffd3ca5a9cffaada3d588ccf1625bef6d37a7c1324a3fc5f4f450ff745)
        + ui/toolwindow/panels

          - src/main/kotlin/io/snyk/plugin/ui/toolwindow/panels/SnykAuthPanel.kt
            [SnykAuthPanel.kt](#diff-6f6239c9f461faf34544b054b3ec2a470c77020d10c30b4d28d4aceaa4b5c732)
      * snyk/trust

        + src/main/kotlin/snyk/trust/TrustedProjects.kt
          [TrustedProjects.kt](#diff-0b37e91ea45b08c1f4936846105c99046c152c4e01206ce87c573908e5ecf423)
        + src/main/kotlin/snyk/trust/WorkspaceTrustService.kt
          [WorkspaceTrustService.kt](#diff-d2bd96708f931d201b3c48a5dfe8add025196046f444fdf77e07a98c951ace20)
        + src/main/kotlin/snyk/trust/WorkspaceTrustSettings.kt
          [WorkspaceTrustSettings.kt](#diff-ce734db2a33770841c8c217df8793dbc602fc1aa080481ce42e796d0b947bbaa)
    - resources

      * src/main/resources/SnykBundle.properties
        [SnykBundle.properties](#diff-e8c8f85879235d08462a1039bde15d970e1f88c7c0c24e7950666c8a98db4e71)
  + test/kotlin/snyk

    - src/test/kotlin/snyk/InMemoryFsRule.kt
      [InMemoryFsRule.kt](#diff-b85d7db59e79c134735eb510cdd1ffa3d259d389d0fe175e5bd3d87edbca5e63)
    - trust

      * src/test/kotlin/snyk/trust/WorkspaceTrustServiceTest.kt
        [WorkspaceTrustServiceTest.kt](#diff-a079841e01c121c4635345a4c7eac94149ee872438e92b5e29fafd3c36ecddf7)

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/snyk/snyk-intellij-plugin/blob/56682f4ba6081ce1d95cb980cbfacd3809a826f4/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,5 +1,10 @@ |
|  |  | # Snyk Changelog |
|  |  |  |
|  |  | ## [2.4.48] |
|  |  | ### Added |
|  |  |  |
|  |  | - Project trust feature. |
|  |  |  |
|  |  | ## [2.4.47] |
|  |  |  |
|  |  | ### Fixed |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[build.gradle.kts](#diff-c0dfa6bc7a8685217f70a860145fbdf416d449eaff052fa28352c5cec1a98c06 "build.gradle.kts")

Show comments

[View file](/snyk/snyk-intellij-plugin/blob/56682f4ba6081ce1d95cb980cbfacd3809a826f4/build.gradle.kts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,6 +35,7 @@ dependencies { |
|  |  | exclude(group = "org.slf4j") |
|  |  | } |
|  |  | implementation("ly.iterative.itly:sdk-jvm:1.2.11") |
|  |  | testImplementation("com.google.jimfs:jimfs:1.2") |
|  |  | testImplementation("com.squareup.okhttp3:mockwebserver:4.10.0") |
|  |  | testImplementation("junit:junit:4.13.2") { |
|  |  | exclude(group = "org.hamcrest") |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[src/integTest/kotlin/io/snyk/plugin/services/SnykTaskQueueServiceTest.kt](#diff-2aac80345d23b86bf43c70c945089faa59b5657ec020cf4aeae519f4c1b84531 "src/integTest/kotlin/io/snyk/plugin/services/SnykTaskQueueServiceTest.kt")

Show comments

[View file](/snyk/snyk-intellij-plugin/blob/56682f4ba6081ce1d95cb980cbfacd3809a826f4/src/integTest/kotlin/io/snyk/plugin/services/SnykTaskQueueServiceTest.kt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,6 +36,8 @@ import org.junit.Test |
|  |  | import snyk.container.ContainerResult |
|  |  | import snyk.iac.IacResult |
|  |  | import snyk.oss.OssResult |
|  |  | import snyk.trust.WorkspaceTrustService |
|  |  | import snyk.trust.confirmScanningAndSetWorkspaceTrustedStateIfNeeded |
|  |  | import java.util.concurrent.TimeUnit |
|  |  |  |
|  |  | @Suppress("FunctionName") |
| Expand All | | @@ -51,13 +53,15 @@ class SnykTaskQueueServiceTest : LightPlatformTestCase() { |
|  |  | mockSnykApiServiceSastEnabled() |
|  |  | replaceSnykApiServiceMockInContainer() |
|  |  | mockkStatic("io.snyk.plugin.UtilsKt") |
|  |  | mockkStatic("snyk.trust.TrustedProjectsKt") |
|  |  | downloaderServiceMock = spyk(SnykCliDownloaderService()) |
|  |  | every { downloaderServiceMock.requestLatestReleasesInformation() } returns LatestReleaseInfo( |
|  |  | "http://testUrl", |
|  |  | "testReleaseInfo", |
|  |  | "testTag" |
|  |  | ) |
|  |  | every { getSnykCliDownloaderService() } returns downloaderServiceMock |
|  |  | every { confirmScanningAndSetWorkspaceTrustedStateIfNeeded(any()) } returns true |
|  |  | } |
|  |  |  |
|  |  | private fun mockSnykApiServiceSastEnabled() { |
| Expand Down | |  |

21 changes: 17 additions & 4 deletions

21
[src/integTest/kotlin/io/snyk/plugin/ui/toolwindow/SnykAuthPanelIntegTest.kt](#diff-dceff2f0571c70c717205715cd2a4fe13fdc7da18843b9a143e4e1d138773038 "src/integTest/kotlin/io/snyk/plugin/ui/toolwindow/SnykAuthPanelIntegTest.kt")

Show comments

[View file](/snyk/snyk-intellij-plugin/blob/56682f4ba6081ce1d95cb980cbfacd3809a826f4/src/integTest/kotlin/io/snyk/plugin/ui/toolwindow/SnykAuthPanelIntegTest.kt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,32 +6,40 @@ import com.intellij.testFramework.LightPlatform4TestCase |
|  |  | import com.intellij.testFramework.replaceService |
|  |  | import io.mockk.every |
|  |  | import io.mockk.mockk |
|  |  | import io.mockk.mockkStatic |
|  |  | import io.mockk.unmockkAll |
|  |  | import io.mockk.verify |
|  |  | import io.snyk.plugin.services.SnykAnalyticsService |
|  |  | import io.snyk.plugin.services.SnykCliAuthenticationService |
|  |  | import io.snyk.plugin.ui.toolwindow.panels.SnykAuthPanel |
|  |  | import org.junit.Test |
|  |  | import snyk.trust.WorkspaceTrustService |
|  |  | import snyk.trust.confirmScanningAndSetWorkspaceTrustedStateIfNeeded |
|  |  | import javax.swing.JButton |
|  |  | import javax.swing.JLabel |
|  |  |  |
|  |  | class SnykAuthPanelIntegTest : LightPlatform4TestCase() { |
|  |  |  |
|  |  | private val analyticsService: SnykAnalyticsService = mockk(relaxed = true) |
|  |  | private val cliAuthenticationService = mockk<SnykCliAuthenticationService>(relaxed = true) |
|  |  | private val workspaceTrustServiceMock = mockk<WorkspaceTrustService>(relaxed = true) |
|  |  |  |
|  |  | override fun setUp() { |
|  |  | super.setUp() |
|  |  | unmockkAll() |
|  |  | mockkStatic("snyk.trust.TrustedProjectsKt") |
|  |  | every { confirmScanningAndSetWorkspaceTrustedStateIfNeeded(any()) } returns true |
|  |  | val application = ApplicationManager.getApplication() |
|  |  | application.replaceService(SnykAnalyticsService::class.java, analyticsService, application) |
|  |  | application.replaceService(WorkspaceTrustService::class.java, workspaceTrustServiceMock, application) |
|  |  | project.replaceService(SnykCliAuthenticationService::class.java, cliAuthenticationService, project) |
|  |  | } |
|  |  |  |
|  |  | override fun tearDown() { |
|  |  | unmockkAll() |
|  |  | val application = ApplicationManager.getApplication() |
|  |  | application.replaceService(SnykAnalyticsService::class.java, SnykAnalyticsService(), application) |
|  |  | application.replaceService(WorkspaceTrustService::class.java, workspaceTrustServiceMock, application) |
|  |  | project.replaceService(SnykCliAuthenticationService::class.java, SnykCliAuthenticationService(project), project) |
|  |  | super.tearDown() |
|  |  | } |
| Expand All | | @@ -40,20 +48,25 @@ class SnykAuthPanelIntegTest : LightPlatform4TestCase() { |
|  |  | fun `should display right authenticate button text`() { |
|  |  | val cut = SnykAuthPanel(project) |
|  |  | val authenticateButton = UIComponentFinder.getComponentByCondition(cut, JButton::class) { |
|  |  | it.text == SnykAuthPanel.AUTHENTICATE\_BUTTON\_TEXT |
|  |  | it.text == SnykAuthPanel.TRUST\_AND\_SCAN\_BUTTON\_TEXT |
|  |  | } |
|  |  | assertNotNull(authenticateButton) |
|  |  | assertEquals("Test code now", authenticateButton!!.text) |
|  |  | assertEquals("Trust project and scan", authenticateButton!!.text) |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | fun `should display right description label`() { |
|  |  | val expectedText = """ |
|  |  | |<html><ol> |
|  |  | |<html> |
|  |  | |<ol> |
|  |  | | <li align="left">Authenticate to Snyk.io</li> |
|  |  | | <li align="left">Analyze code for issues and vulnerabilities</li> |
|  |  | | <li align="left">Improve your code and upgrade dependencies</li> |
|  |  | |</ol> |
|  |  | |<br> |
|  |  | |When scanning project files, Snyk may automatically execute code<br>such as invoking the package manager to get dependency information.<br>You should only scan projects you trust. <a href="https://docs.snyk.io/ide-tools/jetbrains-plugins/folder-trust">More info</a> |
|  |  | |<br> |
|  |  | |<br> |
|  |  | |</html> |
|  |  | """.trimMargin() |
|  |  |  |
| Expand All | | @@ -72,7 +85,7 @@ class SnykAuthPanelIntegTest : LightPlatform4TestCase() { |
|  |  |  |
|  |  | val cut = SnykAuthPanel(project) |
|  |  | val authenticateButton = UIComponentFinder.getComponentByCondition(cut, JButton::class) { |
|  |  | it.text == SnykAuthPanel.AUTHENTICATE\_BUTTON\_TEXT |
|  |  | it.text == SnykAuthPanel.TRUST\_AND\_SCAN\_BUTTON\_TEXT |
|  |  | } |
|  |  | assertNotNull(authenticateButton) |
|  |  |  |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[src/integTest/kotlin/io/snyk/plugin/ui/toolwindow/SnykToolWindowPanelIntegTest.kt](#diff-4e3ab4514950bd11354e210920fa3965cc6df09be4cfb727786ea5cfb49ced3b "src/integTest/kotlin/io/snyk/plugin/ui/toolwindow/SnykToolWindowPanelIntegTest.kt")

Show comments

[View file](/snyk/snyk-intellij-plugin/blob/56682f4ba6081ce1d95cb980cbfacd3809a826f4/src/integTest/kotlin/io/snyk/plugin/ui/toolwindow/SnykToolWindowPanelIntegTest.kt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -66,6 +66,7 @@ import snyk.iac.IgnoreButtonActionListener |
|  |  | import snyk.iac.ui.toolwindow.IacFileTreeNode |
|  |  | import snyk.iac.ui.toolwindow.IacIssueTreeNode |
|  |  | import snyk.oss.Vulnerability |
|  |  | import snyk.trust.confirmScanningAndSetWorkspaceTrustedStateIfNeeded |
|  |  | import javax.swing.JButton |
|  |  | import javax.swing.JEditorPane |
|  |  | import javax.swing.JLabel |
| Expand Down  Expand Up | | @@ -94,12 +95,14 @@ class SnykToolWindowPanelIntegTest : HeavyPlatformTestCase() { |
|  |  | super.setUp() |
|  |  | unmockkAll() |
|  |  | resetSettings(project) |
|  |  | mockkStatic("snyk.trust.TrustedProjectsKt") |
|  |  | pluginSettings().token = fakeApiToken // needed to avoid forced Auth panel showing |
|  |  | pluginSettings().pluginFirstRun = false |
|  |  | // ToolWindow need to be reinitialised for every test as Project is recreated for Heavy tests |
|  |  | // also we MUST do it \*before\* any actual test code due to initialisation of SnykScanListener in init{} |
|  |  | toolWindowPanel = project.service() |
|  |  | setupDummyCliFile() |
|  |  | every { confirmScanningAndSetWorkspaceTrustedStateIfNeeded(any()) } returns true |
|  |  | } |
|  |  |  |
|  |  | override fun tearDown() { |
| Expand Down | |  |

59 changes: 59 additions & 0 deletions

59
[src/integTest/kotlin/snyk/trust/WorkspaceTrustServiceTest.kt](#diff-74dcce786aaf766ed079e9e3a3c4e9c72e296a398f7457fa61d061cfd3a9ef5d "src/integTest/kotlin/snyk/trust/WorkspaceTrustServiceTest.kt")

Show comments

[View file](/snyk/snyk-intellij-plugin/blob/56682f4ba6081ce1d95cb980cbfacd3809a826f4/src/integTest/kotlin/snyk/trust/WorkspaceTrustServiceTest.kt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,59 @@ |
|  |  | @file:Suppress("FunctionName") |
|  |  |  |
|  |  | package snyk.trust |
|  |  |  |
|  |  | import com.intellij.openapi.Disposable |
|  |  | import com.intellij.openapi.application.ApplicationManager |
|  |  | import com.intellij.testFramework.fixtures.BasePlatformTestCase |
|  |  | import com.intellij.testFramework.replaceService |
|  |  | import io.mockk.every |
|  |  | import io.mockk.mockk |
|  |  | import io.mockk.unmockkAll |
|  |  | import org.hamcrest.core.IsEqual.equalTo |
|  |  | import org.junit.Assert.assertThat |
|  |  | import org.junit.Before |
|  |  | import org.junit.Test |
|  |  | import java.nio.file.Paths |
|  |  |  |
|  |  | class WorkspaceTrustServiceTest : BasePlatformTestCase() { |
|  |  |  |
|  |  | private val workspaceTrustSettingsMock = mockk<WorkspaceTrustSettings>() |
|  |  | private lateinit var cut: WorkspaceTrustService |
|  |  |  |
|  |  | private class IntegTestDisposable : Disposable { |
|  |  | override fun dispose() {} |
|  |  | } |
|  |  |  |
|  |  | @Before |
|  |  | public override fun setUp() { |
|  |  | super.setUp() |
|  |  | unmockkAll() |
|  |  |  |
|  |  | val application = ApplicationManager.getApplication() |
|  |  | application.replaceService( |
|  |  | WorkspaceTrustSettings::class.java, |
|  |  | workspaceTrustSettingsMock, |
|  |  | IntegTestDisposable() |
|  |  | ) |
|  |  |  |
|  |  | cut = WorkspaceTrustService() |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | fun `test isPathTrusted should return false if no trusted path in settings available`() { |
|  |  | every { workspaceTrustSettingsMock.getTrustedPaths() } returns listOf() |
|  |  |  |
|  |  | val path = Paths.get("/project") |
|  |  |  |
|  |  | assertThat(cut.isPathTrusted(path), equalTo(false)) |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | fun `test isPathTrusted should return true if trusted path in settings available`() { |
|  |  | every { workspaceTrustSettingsMock.getTrustedPaths() } returns listOf("/project") |
|  |  |  |
|  |  | val path = Paths.get("/project") |
|  |  |  |
|  |  | assertThat(cut.isPathTrusted(path), equalTo(true)) |
|  |  | } |
|  |  | } |

6 changes: 6 additions & 0 deletions

6
[src/main/kotlin/io/snyk/plugin/services/SnykTaskQueueService.kt](#diff-aeaa58ffd3ca5a9cffaada3d588ccf1625bef6d37a7c1324a3fc5f4f450ff745 "src/main/kotlin/io/snyk/plugin/services/SnykTaskQueueService.kt")

Show comments

[View file](/snyk/snyk-intellij-plugin/blob/56682f4ba6081ce1d95cb980cbfacd3809a826f4/src/main/kotlin/io/snyk/plugin/services/SnykTaskQueueService.kt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,6 +30,8 @@ import io.snyk.plugin.snykcode.core.RunUtils |
|  |  | import io.snyk.plugin.ui.SnykBalloonNotifications |
|  |  | import org.jetbrains.annotations.TestOnly |
|  |  | import snyk.common.SnykError |
|  |  | import snyk.trust.confirmScanningAndSetWorkspaceTrustedStateIfNeeded |
|  |  | import java.nio.file.Paths |
|  |  |  |
|  |  | @Service |
|  |  | class SnykTaskQueueService(val project: Project) { |
| Expand Down  Expand Up | | @@ -73,6 +75,10 @@ class SnykTaskQueueService(val project: Project) { |
|  |  | fun scan() { |
|  |  | taskQueue.run(object : Task.Backgroundable(project, "Snyk wait for changed files to be saved on disk", true) { |
|  |  | override fun run(indicator: ProgressIndicator) { |
|  |  | project.basePath?.let { |
|  |  | if (!confirmScanningAndSetWorkspaceTrustedStateIfNeeded(Paths.get(it))) return |
|  |  | } |
|  |  |  |
|  |  | ApplicationManager.getApplication().invokeAndWait { |
|  |  | FileDocumentManager.getInstance().saveAllDocuments() |
|  |  | } |
| Expand Down | |  |

22 changes: 19 additions & 3 deletions

22
[src/main/kotlin/io/snyk/plugin/ui/toolwindow/panels/SnykAuthPanel.kt](#diff-6f6239c9f461faf34544b054b3ec2a470c77020d10c30b4d28d4aceaa4b5c732 "src/main/kotlin/io/snyk/plugin/ui/toolwindow/panels/SnykAuthPanel.kt")

Show comments

[View file](/snyk/snyk-intellij-plugin/blob/56682f4ba6081ce1d95cb980cbfacd3809a826f4/src/main/kotlin/io/snyk/plugin/ui/toolwindow/panels/SnykAuthPanel.kt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,7 @@ package io.snyk.plugin.ui.toolwindow.panels |
|  |  |  |
|  |  | import com.intellij.openapi.Disposable |
|  |  | import com.intellij.openapi.application.ApplicationManager |
|  |  | import com.intellij.openapi.components.service |
|  |  | import com.intellij.openapi.project.Project |
|  |  | import com.intellij.uiDesigner.core.GridConstraints.ANCHOR\_EAST |
|  |  | import com.intellij.uiDesigner.core.GridConstraints.ANCHOR\_NORTHWEST |
| Expand All | | @@ -24,12 +25,15 @@ import io.snyk.plugin.ui.baseGridConstraints |
|  |  | import io.snyk.plugin.ui.boldLabel |
|  |  | import io.snyk.plugin.ui.getReadOnlyClickableHtmlJEditorPaneFixedSize |
|  |  | import io.snyk.plugin.ui.getStandardLayout |
|  |  | import snyk.SnykBundle |
|  |  | import snyk.amplitude.api.ExperimentUser |
|  |  | import snyk.analytics.AuthenticateButtonIsClicked |
|  |  | import snyk.analytics.AuthenticateButtonIsClicked.EventSource |
|  |  | import snyk.analytics.AuthenticateButtonIsClicked.Ide |
|  |  | import snyk.analytics.AuthenticateButtonIsClicked.builder |
|  |  | import snyk.trust.WorkspaceTrustService |
|  |  | import java.awt.event.ActionEvent |
|  |  | import java.nio.file.Paths |
|  |  | import javax.swing.AbstractAction |
|  |  | import javax.swing.JButton |
|  |  | import javax.swing.JLabel |
| Expand All | | @@ -39,7 +43,7 @@ class SnykAuthPanel(val project: Project) : JPanel(), Disposable { |
|  |  |  |
|  |  | init { |
|  |  | name = "authPanel" |
|  |  | val authButton = JButton(object : AbstractAction(AUTHENTICATE\_BUTTON\_TEXT) { |
|  |  | val authButton = JButton(object : AbstractAction(TRUST\_AND\_SCAN\_BUTTON\_TEXT) { |
|  |  | override fun actionPerformed(e: ActionEvent?) { |
|  |  | val analytics = getSnykAnalyticsService() |
|  |  | analytics.logAuthenticateButtonIsClicked(authenticateEvent()) |
| Expand All | | @@ -49,6 +53,12 @@ class SnykAuthPanel(val project: Project) : JPanel(), Disposable { |
|  |  | pluginSettings().token = token |
|  |  | SnykCodeParams.instance.sessionToken = token |
|  |  |  |
|  |  | // explicitly add the project to workspace trusted paths, because |
|  |  | // scan can be auto-triggered depending on "settings.pluginFirstRun" value |
|  |  | project.basePath?.let { |
|  |  | service<WorkspaceTrustService>().addTrustedPath(Paths.get(it)) |
|  |  | } |
|  |  |  |
|  |  | val userId = analytics.obtainUserId(token) |
|  |  | if (userId.isNotBlank()) { |
|  |  | analytics.setUserId(userId) |
| Expand Down  Expand Up | | @@ -102,20 +112,26 @@ class SnykAuthPanel(val project: Project) : JPanel(), Disposable { |
|  |  | } |
|  |  |  |
|  |  | private fun descriptionLabelText(): String { |
|  |  | val trustWarningDescription = SnykBundle.message("snyk.panel.auth.trust.warning.text") |
|  |  | return """ |
|  |  | |<html><ol> |
|  |  | |<html> |
|  |  | |<ol> |
|  |  | | <li align="left">Authenticate to Snyk.io</li> |
|  |  | | <li align="left">Analyze code for issues and vulnerabilities</li> |
|  |  | | <li align="left">Improve your code and upgrade dependencies</li> |
|  |  | |</ol> |
|  |  | |<br> |
|  |  | |$trustWarningDescription |
|  |  | |<br> |
|  |  | |<br> |
|  |  | |</html> |
|  |  | """.trimMargin() |
|  |  | } |
|  |  |  |
|  |  | override fun dispose() {} |
|  |  |  |
|  |  | companion object { |
|  |  | const val AUTHENTICATE\_BUTTON\_TEXT = "Test code now" |
|  |  | const val TRUST\_AND\_SCAN\_BUTTON\_TEXT = "Trust project and scan" |
|  |  | val messagePolicyAndTermsHtml = |
|  |  | """ |
|  |  | <br> |
| Expand Down | |  |

73 changes: 73 additions & 0 deletions

73
[src/main/kotlin/snyk/trust/TrustedProjects.kt](#diff-0b37e91ea45b08c1f4936846105c99046c152c4e01206ce87c573908e5ecf423 "src/main/kotlin/snyk/trust/TrustedProjects.kt")

Show comments

[View file](/snyk/snyk-intellij-plugin/blob/56682f4ba6081ce1d95cb980cbfacd3809a826f4/src/main/kotlin/snyk/trust/TrustedProjects.kt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,73 @@ |
|  |  | @file:JvmName("TrustedProjectsKt") |
|  |  | package snyk.trust |
|  |  |  |
|  |  | import com.intellij.openapi.application.invokeAndWaitIfNeeded |
|  |  | import com.intellij.openapi.components.service |
|  |  | import com.intellij.openapi.diagnostic.Logger |
|  |  | import com.intellij.openapi.ui.MessageDialogBuilder |
|  |  | import com.intellij.openapi.ui.Messages |
|  |  | import snyk.SnykBundle |
|  |  | import java.nio.file.Files |
|  |  | import java.nio.file.Path |
|  |  |  |
|  |  | private val LOG = Logger.getInstance("snyk.trust.TrustedProjects") |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Shows the "Trust and Scan Project?" dialog, if the user wasn't asked yet if they trust this project, |
|  |  | \* and sets the project trusted state according to the user choice. |
|  |  | \* |
|  |  | \* @return `false` if the user chose not to scan the project at all; `true` otherwise |
|  |  | \*/ |
|  |  | fun confirmScanningAndSetWorkspaceTrustedStateIfNeeded(projectFileOrDir: Path): Boolean { |
|  |  | val projectDir = if (Files.isDirectory(projectFileOrDir)) projectFileOrDir else projectFileOrDir.parent |
|  |  |  |
|  |  | val trustService = service<WorkspaceTrustService>() |
|  |  | val trustedState = trustService.isPathTrusted(projectDir) |
|  |  | if (!trustedState) { |
|  |  | LOG.info("Asking user to trust the project ${projectDir.fileName}") |
|  |  | return when (confirmScanningUntrustedProject(projectDir)) { |
|  |  | ScanUntrustedProjectChoice.TRUST\_AND\_SCAN -> { |
|  |  | trustService.addTrustedPath(projectDir) |
|  |  | true |
|  |  | } |
|  |  |  |
|  |  | ScanUntrustedProjectChoice.CANCEL -> false |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return true |
|  |  | } |
|  |  |  |
|  |  | private fun confirmScanningUntrustedProject(projectDir: Path): ScanUntrustedProjectChoice { |
|  |  | val fileName = projectDir.fileName ?: projectDir.toString() |
|  |  | val title = SnykBundle.message("snyk.trust.dialog.warning.title", fileName) |
|  |  | val message = SnykBundle.message("snyk.trust.dialog.warning.text") |
|  |  | val trustButton = SnykBundle.message("snyk.trust.dialog.warning.button.trust") |
|  |  | val distrustButton = SnykBundle.message("snyk.trust.dialog.warning.button.distrust") |
|  |  |  |
|  |  | var choice = ScanUntrustedProjectChoice.CANCEL |
|  |  |  |
|  |  | invokeAndWaitIfNeeded { |
|  |  | val result = MessageDialogBuilder |
|  |  | .yesNo(title, message) |
|  |  | .icon(Messages.getWarningIcon()) |
|  |  | .yesText(trustButton) |
|  |  | .noText(distrustButton) |
|  |  | .show() |
|  |  |  |
|  |  | choice = if (result == Messages.YES) { |
|  |  | LOG.info("User trusts the project $fileName for scans") |
|  |  | ScanUntrustedProjectChoice.TRUST\_AND\_SCAN |
|  |  | } else { |
|  |  | LOG.info("User doesn't trust the project $fileName for scans") |
|  |  | ScanUntrustedProjectChoice.CANCEL |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return choice |
|  |  | } |
|  |  |  |
|  |  | enum class ScanUntrustedProjectChoice { |
|  |  | TRUST\_AND\_SCAN, |
|  |  | CANCEL; |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `56682f4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-intellij-plugin%2Fcommit%2F56682f4ba6081ce1d95cb980cbfacd3809a826f4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e6a76c6e_20250108_110747.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fvscode-extension%2Fcommit%2F0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fvscode-extension%2Fcommit%2F0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fvscode-extension)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[vscode-extension](/snyk/vscode-extension)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fvscode-extension) You must be signed in to change notification settings
* [Fork
  31](/login?return_to=%2Fsnyk%2Fvscode-extension)
* [Star
   81](/login?return_to=%2Fsnyk%2Fvscode-extension)

* [Code](/snyk/vscode-extension)
* [Pull requests
  3](/snyk/vscode-extension/pulls)
* [Actions](/snyk/vscode-extension/actions)
* [Security](/snyk/vscode-extension/security)
* [Insights](/snyk/vscode-extension/pulse)

Additional navigation options

* [Code](/snyk/vscode-extension)
* [Pull requests](/snyk/vscode-extension/pulls)
* [Actions](/snyk/vscode-extension/actions)
* [Security](/snyk/vscode-extension/security)
* [Insights](/snyk/vscode-extension/pulse)

## Commit

[Permalink](/snyk/vscode-extension/commit/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

feat: workspace trust ([#306](https://github.com/snyk/vscode-extension/pull/306))

[Browse files](/snyk/vscode-extension/tree/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708)
Browse the repository at this point in the history

* Loading branch information

[![@michelkaporin](https://avatars.githubusercontent.com/u/2239563?s=40&v=4)](/michelkaporin)

[michelkaporin](/snyk/vscode-extension/commits?author=michelkaporin "View all commits by michelkaporin")
authored
Nov 29, 2022

1 parent
[883dcb0](/snyk/vscode-extension/commit/883dcb010333b2ae0ec1920f5062c3cccc7b6aeb)

commit 0db3b42

 Show file tree

 Hide file tree

Showing
**23 changed files**
with
**213 additions**
and
**45 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* src

  + snyk

    - base/modules

      * src/snyk/base/modules/snykLib.ts
        [snykLib.ts](#diff-8dff58377e07f161c2ad48bc4c49ac3a9f4aeb5ef4af6d30c6fcd3a4f4cc992e)
    - cli/services

      * src/snyk/cli/services/cliService.ts
        [cliService.ts](#diff-875b78cc765dc190e9367f09589b7d5aeb03d87b56c3b717af512347fdc52772)
    - common

      * commands

        + src/snyk/common/commands/commandController.ts
          [commandController.ts](#diff-92fd973cc29eb48e137127909b9798497829702864a94516292c9f349fc69734)
      * configuration

        + src/snyk/common/configuration/configuration.ts
          [configuration.ts](#diff-ea516e6da03ef31b513852a7029ea1873e6672eab75b939bc6465f90dc24c69f)
        + src/snyk/common/configuration/trustedFolders.ts
          [trustedFolders.ts](#diff-c49f1bbcce7641a8a7da52baacae8719c560a015c0da80c1886880c47514e60c)
      * constants

        + src/snyk/common/constants/languageServer.ts
          [languageServer.ts](#diff-ff82b1cbc9a1790f1c0d84494ec8c5f767c72b27e4926eb1f84646023590b6f7)
        + src/snyk/common/constants/settings.ts
          [settings.ts](#diff-080edf6254d53f5c4f858a51e91fd5192997f13a1907eff6377dff5cf6bd0fce)
      * languageServer

        + src/snyk/common/languageServer/languageServer.ts
          [languageServer.ts](#diff-3b2a43f4595d28491fa3a90fcf03f78603ecced8084c2aa57fc972717ced9710)
        + src/snyk/common/languageServer/settings.ts
          [settings.ts](#diff-70591a89ac27c67c6d915439041fc8abcbf4449c1c0a2b2924b9d8709c4c47c4)
      * messages

        + src/snyk/common/messages/analysisMessages.ts
          [analysisMessages.ts](#diff-3c1b409bee199e2feef7ab83cd38c432468c29518366bbc2653dd0139ee41daf)
      * views

        + src/snyk/common/views/analysisTreeNodeProvider.ts
          [analysisTreeNodeProvider.ts](#diff-58781db68a9cbfde5a77dcfe39aa43d38d54f437ae9544d526c1e335c420627e)
      * watchers

        + src/snyk/common/watchers/configurationWatcher.ts
          [configurationWatcher.ts](#diff-2c89a60404d07d60c7cfb2fe215cb9e797ebd8891f17b49b8f1f8e07434993e4)
    - snykCode

      * src/snyk/snykCode/codeService.ts
        [codeService.ts](#diff-072b44d619fb23ba8a1dd1cb11dc78ed3ee53e51fddbd713a1b6d8a70654c12b)
      * views

        + src/snyk/snykCode/views/issueTreeProvider.ts
          [issueTreeProvider.ts](#diff-31f7bcacaff0b28bb5edd1938932cf5c6b0044f56c068f5230db9707d8b3129d)
    - snykOss

      * services

        + src/snyk/snykOss/services/ossService.ts
          [ossService.ts](#diff-0d79c1f5e393db4a9e1b14dec13a71f6237bdaef8fc4e6971cd8ff372acb8bfd)
      * views

        + src/snyk/snykOss/views/ossVulnerabilityTreeProvider.ts
          [ossVulnerabilityTreeProvider.ts](#diff-d54de976783948642330d1232b8f298e18a11643e43772e59552b4d861be1a5e)
  + test/unit

    - cli/services

      * src/test/unit/cli/services/cliService.test.ts
        [cliService.test.ts](#diff-ae4898b0bf8f576907bf514cbf3208155f5d70d66f833014e64601bd8c815c69)
    - common

      * configuration

        + src/test/unit/common/configuration/trustedFolders.test.ts
          [trustedFolders.test.ts](#diff-2b95066b8ddebfcb92b20c8bded81c5a20fb9883e09fb3b4dff654a00f792846)
      * languageServer

        + src/test/unit/common/languageServer/languageServer.test.ts
          [languageServer.test.ts](#diff-dabd42c22eb5aec2ac82d2a44197da9adfad285ed79bebb0ba4769bf679b98f3)
        + src/test/unit/common/languageServer/middleware.test.ts
          [middleware.test.ts](#diff-434cd4206e4bc421d90a0b69cc3682e1620e2c4fd10d23605f5f20e804cb52f8)
    - snykOss/services

      * src/test/unit/snykOss/services/ossService.test.ts
        [ossService.test.ts](#diff-cb542ff1e40a11fb36bc3e64bc5da878b6d1a06675fe3f20d7070627ce8883d8)

## There are no files selected for viewing

8 changes: 7 additions & 1 deletion

8
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,6 +1,12 @@ |
|  |  | # Snyk Security - Code and Open Source Dependencies Changelog |
|  |  |  |
|  |  | ## [1.7.8] |
|  |  | ## [1.9.0] |
|  |  |  |
|  |  | ### Added |
|  |  |  |
|  |  | - Added workspace trust feature. |
|  |  |  |
|  |  | ## [1.8.0] |
|  |  |  |
|  |  | ### Added |
|  |  |  |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -175,6 +175,11 @@ |
|  |  | "description": "Severity issues to display.", |
|  |  | "scope": "window" |
|  |  | }, |
|  |  | "snyk.trustedFolders": { |
|  |  | "type": "array", |
|  |  | "default": [], |
|  |  | "description": "Folders to trust for Snyk scans." |
|  |  | }, |
|  |  | "snyk.features.preview": { |
|  |  | "type": "object", |
|  |  | "default": {}, |
| Expand Down  Expand Up | | @@ -271,7 +276,7 @@ |
|  |  | }, |
|  |  | { |
|  |  | "view": "snyk.views.welcome", |
|  |  | "contents": "Welcome to Snyk for Visual Studio Code. 👋\nLet's start by connecting VS Code with Snyk:\n[Connect VS Code with Snyk](command:snyk.initiateLogin 'Connect with Snyk')\n👉 Snyk's mission is to finds bugs, fast. Connect with Snyk to start your first analysis!\nBy connecting your account with Snyk, you agree to the Snyk [Privacy Policy](https://snyk.io/policies/privacy), and the Snyk [Terms of Service](https://snyk.io/policies/terms-of-service).", |
|  |  | "contents": "Welcome to Snyk for Visual Studio Code. 👋\n👉 Connect with Snyk to start your first analysis!\nWhen scanning folder files, Snyk may automatically execute code such as invoking the package manager to get dependency information. You should only scan projects you trust. [More info](https://docs.snyk.io/ide-tools/visual-studio-code-extension/workspace-trust)\n[Trust workspace and connect](command:snyk.initiateLogin 'Connect with Snyk')\nBy connecting your account with Snyk, you agree to the Snyk [Privacy Policy](https://snyk.io/policies/privacy), and the Snyk [Terms of Service](https://snyk.io/policies/terms-of-service).", |
|  |  | "when": "!snyk:error && !snyk:loggedIn" |
|  |  | }, |
|  |  | { |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/snyk/base/modules/snykLib.ts](#diff-8dff58377e07f161c2ad48bc4c49ac3a9f4aeb5ef4af6d30c6fcd3a4f4cc992e "src/snyk/base/modules/snykLib.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/base/modules/snykLib.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -126,14 +126,14 @@ export default class SnykLib extends BaseSnykModule implements ISnykLib { |
|  |  | if (!configuration.getFeaturesConfiguration()?.ossEnabled) return; |
|  |  | if (!this.ossService) throw new Error('OSS service is not initialized.'); |
|  |  |  |
|  |  | // wait until Snyk CLI is downloaded |
|  |  | // wait until Snyk Language Server is downloaded |
|  |  | await firstValueFrom(this.downloadService.downloadReady$); |
|  |  |  |
|  |  | try { |
|  |  | const oldResult = this.ossService.getResult(); |
|  |  | const result = await this.ossService.test(manual, reportTriggeredEvent); |
|  |  |  |
|  |  | if (result instanceof CliError) { |
|  |  | if (result instanceof CliError || !result) { |
|  |  | return; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

31 changes: 25 additions & 6 deletions

31
[src/snyk/cli/services/cliService.ts](#diff-875b78cc765dc190e9367f09589b7d5aeb03d87b56c3b717af512347fdc52772 "src/snyk/cli/services/cliService.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/cli/services/cliService.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,9 +2,11 @@ import { firstValueFrom } from 'rxjs'; |
|  |  | import parseArgsStringToArgv from 'string-argv'; |
|  |  | import { AnalysisStatusProvider } from '../../common/analysis/statusProvider'; |
|  |  | import { IConfiguration } from '../../common/configuration/configuration'; |
|  |  | import { getTrustedFolders } from '../../common/configuration/trustedFolders'; |
|  |  | import { ErrorHandler } from '../../common/error/errorHandler'; |
|  |  | import { ILanguageServer } from '../../common/languageServer/languageServer'; |
|  |  | import { ILog } from '../../common/logger/interfaces'; |
|  |  | import { messages as analysisMessages } from '../../common/messages/analysisMessages'; |
|  |  | import { DownloadService } from '../../common/services/downloadService'; |
|  |  | import { ExtensionContext } from '../../common/vscode/extensionContext'; |
|  |  | import { IVSCodeWorkspace } from '../../common/vscode/workspace'; |
| Expand All | | @@ -23,6 +25,7 @@ export abstract class CliService<CliResult> extends AnalysisStatusProvider { |
|  |  | private cliProcess?: CliProcess; |
|  |  | private \_isLsDownloadSuccessful = true; |
|  |  | private \_isCliReady: boolean; |
|  |  | private \_isAnyWorkspaceFolderTrusted = true; |
|  |  |  |
|  |  | constructor( |
|  |  | protected readonly extensionContext: ExtensionContext, |
| Expand All | | @@ -43,7 +46,11 @@ export abstract class CliService<CliResult> extends AnalysisStatusProvider { |
|  |  | return this.\_isCliReady; |
|  |  | } |
|  |  |  |
|  |  | async test(manualTrigger: boolean, reportTriggeredEvent: boolean): Promise<CliResult | CliError> { |
|  |  | get isAnyWorkspaceFolderTrusted(): boolean { |
|  |  | return this.\_isAnyWorkspaceFolderTrusted; |
|  |  | } |
|  |  |  |
|  |  | async test(manualTrigger: boolean, reportTriggeredEvent: boolean): Promise<CliResult | CliError | void> { |
|  |  | this.ensureDependencies(); |
|  |  |  |
|  |  | const currentCliPath = CliExecutable.getPath(this.extensionContext.extensionPath, this.config.getCliPath()); |
| Expand All | | @@ -66,6 +73,19 @@ export abstract class CliService<CliResult> extends AnalysisStatusProvider { |
|  |  | const cliPath = await firstValueFrom(this.languageServer.cliReady$); |
|  |  | this.\_isCliReady = true; |
|  |  |  |
|  |  | let foldersToTest = this.workspace.getWorkspaceFolders(); |
|  |  | if (foldersToTest.length == 0) { |
|  |  | throw new Error('No workspace was opened.'); |
|  |  | } |
|  |  |  |
|  |  | foldersToTest = getTrustedFolders(this.config, foldersToTest); |
|  |  | if (foldersToTest.length == 0) { |
|  |  | this.handleNoTrustedFolders(); |
|  |  | this.logger.info(`Skipping Open Source scan. ${analysisMessages.noWorkspaceTrustDescription}`); |
|  |  | return; |
|  |  | } |
|  |  | this.\_isAnyWorkspaceFolderTrusted = true; |
|  |  |  |
|  |  | // Start test |
|  |  | this.analysisStarted(); |
|  |  | this.beforeTest(manualTrigger, reportTriggeredEvent); |
| Expand All | | @@ -76,11 +96,6 @@ export abstract class CliService<CliResult> extends AnalysisStatusProvider { |
|  |  | if (!killed) this.logger.error('Failed to kill an already running CLI instance.'); |
|  |  | } |
|  |  |  |
|  |  | const foldersToTest = this.workspace.getWorkspaceFolders(); |
|  |  | if (foldersToTest.length == 0) { |
|  |  | throw new Error('No workspace was opened.'); |
|  |  | } |
|  |  |  |
|  |  | this.cliProcess = new CliProcess(this.logger, this.config, this.workspace); |
|  |  | const args = this.buildArguments(foldersToTest); |
|  |  |  |
| Expand Down  Expand Up | | @@ -130,6 +145,10 @@ export abstract class CliService<CliResult> extends AnalysisStatusProvider { |
|  |  | this.\_isLsDownloadSuccessful = false; |
|  |  | } |
|  |  |  |
|  |  | handleNoTrustedFolders() { |
|  |  | this.\_isAnyWorkspaceFolderTrusted = false; |
|  |  | } |
|  |  |  |
|  |  | private buildArguments(foldersToTest: string[]): string[] { |
|  |  | const args = []; |
|  |  |  |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[src/snyk/common/commands/commandController.ts](#diff-92fd973cc29eb48e137127909b9798497829702864a94516292c9f349fc69734 "src/snyk/common/commands/commandController.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/commands/commandController.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,7 +20,7 @@ import { |
|  |  | VSCODE\_GO\_TO\_SETTINGS\_COMMAND, |
|  |  | } from '../constants/commands'; |
|  |  | import { COMMAND\_DEBOUNCE\_INTERVAL, IDE\_NAME, SNYK\_NAME\_EXTENSION, SNYK\_PUBLISHER } from '../constants/general'; |
|  |  | import { SNYK\_LOGIN\_COMMAND } from '../constants/languageServer'; |
|  |  | import { SNYK\_LOGIN\_COMMAND, SNYK\_TRUST\_WORKSPACE\_FOLDERS\_COMMAND } from '../constants/languageServer'; |
|  |  | import { ErrorHandler } from '../error/errorHandler'; |
|  |  | import { ILog } from '../logger/interfaces'; |
|  |  | import { IOpenerService } from '../services/openerService'; |
| Expand Down  Expand Up | | @@ -55,6 +55,7 @@ export class CommandController { |
|  |  | this.logger.info('Initiating login'); |
|  |  | await this.executeCommand(SNYK\_INITIATE\_LOGIN\_COMMAND, this.authService.initiateLogin.bind(this.authService)); |
|  |  | await this.commands.executeCommand(SNYK\_LOGIN\_COMMAND); |
|  |  | await this.commands.executeCommand(SNYK\_TRUST\_WORKSPACE\_FOLDERS\_COMMAND); |
|  |  | } |
|  |  |  |
|  |  | async setToken(): Promise<void> { |
| Expand Down | |  |

19 changes: 19 additions & 0 deletions

19
[src/snyk/common/configuration/configuration.ts](#diff-ea516e6da03ef31b513852a7029ea1873e6672eab75b939bc6465f90dc24c69f "src/snyk/common/configuration/configuration.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/configuration/configuration.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ import { |
|  |  | FEATURES\_PREVIEW\_SETTING, |
|  |  | OSS\_ENABLED\_SETTING, |
|  |  | SEVERITY\_FILTER\_SETTING, |
|  |  | TRUSTED\_FOLDERS, |
|  |  | YES\_BACKGROUND\_OSS\_NOTIFICATION\_SETTING, |
|  |  | YES\_CRASH\_REPORT\_SETTING, |
|  |  | YES\_TELEMETRY\_SETTING, |
| Expand Down  Expand Up | | @@ -98,6 +99,10 @@ export interface IConfiguration { |
|  |  | getSnykLanguageServerPath(): string | undefined; |
|  |  |  |
|  |  | setShouldReportEvents(b: boolean): Promise<void>; |
|  |  |  |
|  |  | getTrustedFolders(): string[]; |
|  |  |  |
|  |  | setTrustedFolders(trustedFolders: string[]): Promise<void>; |
|  |  | } |
|  |  |  |
|  |  | export class Configuration implements IConfiguration { |
| Expand Down  Expand Up | | @@ -424,6 +429,20 @@ export class Configuration implements IConfiguration { |
|  |  | return this.workspace.getConfiguration<string>(CONFIGURATION\_IDENTIFIER, this.getConfigName(ADVANCED\_CLI\_PATH)); |
|  |  | } |
|  |  |  |
|  |  | getTrustedFolders(): string[] { |
|  |  | return ( |
|  |  | this.workspace.getConfiguration<string[]>(CONFIGURATION\_IDENTIFIER, this.getConfigName(TRUSTED\_FOLDERS)) || [] |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | async setTrustedFolders(trustedFolders: string[]): Promise<void> { |
|  |  | await this.workspace.updateConfiguration( |
|  |  | CONFIGURATION\_IDENTIFIER, |
|  |  | this.getConfigName(TRUSTED\_FOLDERS), |
|  |  | trustedFolders, |
|  |  | true, |
|  |  | ); |
|  |  | } |
|  |  | private getConfigName = (setting: string) => setting.replace(`${CONFIGURATION\_IDENTIFIER}.`, ''); |
|  |  |  |
|  |  | private static isSingleTenant(url: URL): boolean { |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[src/snyk/common/configuration/trustedFolders.ts](#diff-c49f1bbcce7641a8a7da52baacae8719c560a015c0da80c1886880c47514e60c "src/snyk/common/configuration/trustedFolders.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/configuration/trustedFolders.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,7 @@ |
|  |  | import { IConfiguration } from './configuration'; |
|  |  |  |
|  |  | export function getTrustedFolders(config: IConfiguration, workspaceFolders: string[]): string[] { |
|  |  | const trustedFolders = config.getTrustedFolders(); |
|  |  |  |
|  |  | return workspaceFolders.filter(folder => trustedFolders.includes(folder)); |
|  |  | } |

2 changes: 2 additions & 0 deletions

2
[src/snyk/common/constants/languageServer.ts](#diff-ff82b1cbc9a1790f1c0d84494ec8c5f767c72b27e4926eb1f84646023590b6f7 "src/snyk/common/constants/languageServer.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/constants/languageServer.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,7 +10,9 @@ export const DID\_CHANGE\_CONFIGURATION\_METHOD = 'workspace/didChangeConfiguration |
|  |  | // custom methods |
|  |  | export const SNYK\_HAS\_AUTHENTICATED = '$/snyk.hasAuthenticated'; |
|  |  | export const SNYK\_CLI\_PATH = '$/snyk.isAvailableCli'; |
|  |  | export const SNYK\_ADD\_TRUSTED\_FOLDERS = '$/snyk.addTrustedFolders'; |
|  |  |  |
|  |  | // commands |
|  |  | export const SNYK\_LOGIN\_COMMAND = 'snyk.login'; |
|  |  | export const SNYK\_WORKSPACE\_SCAN\_COMMAND = 'snyk.workspace.scan'; |
|  |  | export const SNYK\_TRUST\_WORKSPACE\_FOLDERS\_COMMAND = 'snyk.trustWorkspaceFolders'; |

1 change: 1 addition & 0 deletions

1
[src/snyk/common/constants/settings.ts](#diff-080edf6254d53f5c4f858a51e91fd5192997f13a1907eff6377dff5cf6bd0fce "src/snyk/common/constants/settings.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/constants/settings.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -22,3 +22,4 @@ export const ADVANCED\_CLI\_PATH = `${CONFIGURATION\_IDENTIFIER}.advanced.cliPath`; |
|  |  | export const ADVANCED\_CUSTOM\_LS\_PATH = `${CONFIGURATION\_IDENTIFIER}.advanced.languageServerPath`; |
|  |  |  |
|  |  | export const SEVERITY\_FILTER\_SETTING = `${CONFIGURATION\_IDENTIFIER}.severity`; |
|  |  | export const TRUSTED\_FOLDERS = `${CONFIGURATION\_IDENTIFIER}.trustedFolders`; |

76 changes: 45 additions & 31 deletions

76
[src/snyk/common/languageServer/languageServer.ts](#diff-3b2a43f4595d28491fa3a90fcf03f78603ecced8084c2aa57fc972717ced9710 "src/snyk/common/languageServer/languageServer.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/languageServer/languageServer.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,7 +2,12 @@ import { firstValueFrom, ReplaySubject } from 'rxjs'; |
|  |  | import { IAuthenticationService } from '../../base/services/authenticationService'; |
|  |  | import { CLI\_INTEGRATION\_NAME } from '../../cli/contants/integration'; |
|  |  | import { Configuration, IConfiguration } from '../configuration/configuration'; |
|  |  | import { SNYK\_CLI\_PATH, SNYK\_HAS\_AUTHENTICATED, SNYK\_LANGUAGE\_SERVER\_NAME } from '../constants/languageServer'; |
|  |  | import { |
|  |  | SNYK\_ADD\_TRUSTED\_FOLDERS, |
|  |  | SNYK\_CLI\_PATH, |
|  |  | SNYK\_HAS\_AUTHENTICATED, |
|  |  | SNYK\_LANGUAGE\_SERVER\_NAME, |
|  |  | } from '../constants/languageServer'; |
|  |  | import { CONFIGURATION\_IDENTIFIER } from '../constants/settings'; |
|  |  | import { ErrorHandler } from '../error/errorHandler'; |
|  |  | import { ILog } from '../logger/interfaces'; |
| Expand Down  Expand Up | | @@ -91,39 +96,10 @@ export class LanguageServer implements ILanguageServer { |
|  |  |  |
|  |  | // Create the language client and start the client. |
|  |  | this.client = this.languageClientAdapter.create('Snyk LS', SNYK\_LANGUAGE\_SERVER\_NAME, serverOptions, clientOptions); |
|  |  |  |
|  |  | this.client |
|  |  | .onReady() |
|  |  | .then(() => { |
|  |  | this.client.onNotification(SNYK\_HAS\_AUTHENTICATED, ({ token }: { token: string }) => { |
|  |  | this.authenticationService.updateToken(token).catch((error: Error) => { |
|  |  | ErrorHandler.handle(error, this.logger, error.message); |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | this.client.onNotification(SNYK\_CLI\_PATH, ({ cliPath }: { cliPath: string }) => { |
|  |  | if (!cliPath) { |
|  |  | ErrorHandler.handle( |
|  |  | new Error("CLI path wasn't provided by language server on $/snyk.isAvailableCli notification " + cliPath), |
|  |  | this.logger, |
|  |  | "CLI path wasn't provided by language server on notification", |
|  |  | ); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | const currentCliPath = this.configuration.getCliPath(); |
|  |  | if (currentCliPath != cliPath) { |
|  |  | this.logger.info('Setting Snyk CLI path to: ' + cliPath); |
|  |  | void this.configuration |
|  |  | .setCliPath(cliPath) |
|  |  | .then(() => { |
|  |  | this.cliReady$.next(cliPath); |
|  |  | }) |
|  |  | .catch((error: Error) => { |
|  |  | ErrorHandler.handle(error, this.logger, error.message); |
|  |  | }); |
|  |  | } |
|  |  | }); |
|  |  | this.registerListeners(this.client); |
|  |  | }) |
|  |  | .catch((error: Error) => ErrorHandler.handle(error, this.logger, error.message)); |
|  |  |  |
| Expand All | | @@ -132,6 +108,44 @@ export class LanguageServer implements ILanguageServer { |
|  |  | this.logger.info('Snyk Language Server started'); |
|  |  | } |
|  |  |  |
|  |  | private registerListeners(client: LanguageClient): void { |
|  |  | client.onNotification(SNYK\_HAS\_AUTHENTICATED, ({ token }: { token: string }) => { |
|  |  | this.authenticationService.updateToken(token).catch((error: Error) => { |
|  |  | ErrorHandler.handle(error, this.logger, error.message); |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | client.onNotification(SNYK\_CLI\_PATH, ({ cliPath }: { cliPath: string }) => { |
|  |  | if (!cliPath) { |
|  |  | ErrorHandler.handle( |
|  |  | new Error("CLI path wasn't provided by language server on $/snyk.isAvailableCli notification " + cliPath), |
|  |  | this.logger, |
|  |  | "CLI path wasn't provided by language server on notification", |
|  |  | ); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | const currentCliPath = this.configuration.getCliPath(); |
|  |  | if (currentCliPath != cliPath) { |
|  |  | this.logger.info('Setting Snyk CLI path to: ' + cliPath); |
|  |  | void this.configuration |
|  |  | .setCliPath(cliPath) |
|  |  | .then(() => { |
|  |  | this.cliReady$.next(cliPath); |
|  |  | }) |
|  |  | .catch((error: Error) => { |
|  |  | ErrorHandler.handle(error, this.logger, error.message); |
|  |  | }); |
|  |  | } |
|  |  | }); |
|  |  |  |
|  |  | client.onNotification(SNYK\_ADD\_TRUSTED\_FOLDERS, ({ trustedFolders }: { trustedFolders: string[] }) => { |
|  |  | this.configuration.setTrustedFolders(trustedFolders).catch((error: Error) => { |
|  |  | ErrorHandler.handle(error, this.logger, error.message); |
|  |  | }); |
|  |  | }); |
|  |  | } |
|  |  |  |
|  |  | // Initialization options are not semantically equal to server settings, thus separated here |
|  |  | // https://github.com/microsoft/language-server-protocol/issues/567 |
|  |  | async getInitializationOptions(): Promise<InitializationOptions> { |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[src/snyk/common/languageServer/settings.ts](#diff-70591a89ac27c67c6d915439041fc8abcbf4449c1c0a2b2924b9d8709c4c47c4 "src/snyk/common/languageServer/settings.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/languageServer/settings.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,6 +20,8 @@ export type ServerSettings = { |
|  |  | manageBinariesAutomatically?: string; |
|  |  | cliPath?: string; |
|  |  | token?: string; |
|  |  | enableTrustedFoldersFeature?: string; |
|  |  | trustedFolders?: string[]; |
|  |  | }; |
|  |  |  |
|  |  | export class LanguageServerSettings { |
| Expand All | | @@ -36,6 +38,8 @@ export class LanguageServerSettings { |
|  |  | organization: configuration.organization, |
|  |  | token: await configuration.getToken(), |
|  |  | manageBinariesAutomatically: `${configuration.isAutomaticDependencyManagementEnabled()}`, |
|  |  | enableTrustedFoldersFeature: 'true', |
|  |  | trustedFolders: configuration.getTrustedFolders(), |
|  |  | }; |
|  |  | } |
|  |  | } |

3 changes: 3 additions & 0 deletions

3
[src/snyk/common/messages/analysisMessages.ts](#diff-3c1b409bee199e2feef7ab83cd38c432468c29518366bbc2653dd0139ee41daf "src/snyk/common/messages/analysisMessages.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/messages/analysisMessages.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,9 @@ |
|  |  | export const messages = { |
|  |  | scanFailed: 'Scan failed', |
|  |  | noWorkspaceTrust: 'No workspace folder was granted trust', |
|  |  | clickToProblem: 'Click here to see the problem.', |
|  |  | allSeverityFiltersDisabled: 'Please enable severity filters to see the results.', |
|  |  | duration: (time: string, day: string): string => `Analysis finished at ${time}, ${day}`, |
|  |  | noWorkspaceTrustDescription: |
|  |  | 'None of workspace folders were trusted. If you trust the workspace, you can add it to the list of trusted folders in the extension settings, or when prompted by the extension next time.', |
|  |  | }; |

10 changes: 10 additions & 0 deletions

10
[src/snyk/common/views/analysisTreeNodeProvider.ts](#diff-58781db68a9cbfde5a77dcfe39aa43d38d54f437ae9544d526c1e335c420627e "src/snyk/common/views/analysisTreeNodeProvider.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/views/analysisTreeNodeProvider.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -72,5 +72,15 @@ export abstract class AnalysisTreeNodeProvder extends TreeNodeProvider { |
|  |  | }); |
|  |  | } |
|  |  |  |
|  |  | protected getNoWorkspaceTrustTreeNode(): TreeNode { |
|  |  | return new TreeNode({ |
|  |  | text: messages.noWorkspaceTrust, |
|  |  | command: { |
|  |  | command: SNYK\_SHOW\_OUTPUT\_COMMAND, |
|  |  | title: '', |
|  |  | }, |
|  |  | }); |
|  |  | } |
|  |  |  |
|  |  | protected abstract getFilteredIssues(issues: readonly unknown[]): readonly unknown[]; |
|  |  | } |

2 changes: 2 additions & 0 deletions

2
[src/snyk/common/watchers/configurationWatcher.ts](#diff-2c89a60404d07d60c7cfb2fe215cb9e797ebd8891f17b49b8f1f8e07434993e4 "src/snyk/common/watchers/configurationWatcher.ts")

Show comments

[View file](/snyk/vscode-extension/blob/0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708/src/snyk/common/watchers/configurationWatcher.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,6 +13,7 @@ import { |
|  |  | CODE\_SECURITY\_ENABLED\_SETTING, |
|  |  | OSS\_ENABLED\_SETTING, |
|  |  | SEVERITY\_FILTER\_SETTING, |
|  |  | TRUSTED\_FOLDERS, |
|  |  | YES\_TELEMETRY\_SETTING, |
|  |  | } from '../constants/settings'; |
|  |  | import { ErrorHandler } from '../error/errorHandler'; |
| Expand Down  Expand Up | | @@ -68,6 +69,7 @@ class ConfigurationWatcher implements IWatcher { |
|  |  | SEVERITY\_FILTER\_SETTING, |
|  |  | ADVANCED\_CUSTOM\_ENDPOINT, |
|  |  | ADVANCED\_CUSTOM\_LS\_PATH, |
|  |  | TRUSTED\_FOLDERS, |
|  |  | ].find(config => event.affectsConfiguration(config)); |
|  |  |  |
|  |  | if (change) { |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0db3b42`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fvscode-extension%2Fcommit%2F0db3b4240be0db6a0a5c6d02c0d4231a2c4ba708) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.imperva.com_93335c4e_20250108_110748.html ===


[![Imperva](https://www.imperva.com/blog/wp-content/uploads/2023/12/imperva-a-thales-company-light.svg)](https://www.imperva.com)

[Under DDoS Attack?](/under-ddos-attack/)

1-866-777-9980

Login

LoginCloud Security ConsoleRASP Console
English

EnglishENDeutschDEEspañolESFrançaisFRPortuguêsPT-BR日本語日本語한국어KR中文CNภาษาไทยTH

[Under DDoS Attack?](/under-ddos-attack/)

1-866-777-9980

[Start for Free](/free-trial/)[Contact Us](/contact-us/)[Start for Free](/free-trial/)[Contact Us](/contact-us/)

* [Why Imperva](/products/why-imperva/)
* Products
  Products
  + ![](https://www.imperva.com/blog/wp-content/uploads/2023/02/application-security.svg)
  + ![](https://www.imperva.com/blog/wp-content/uploads/2023/02/data-security.svg)Data Security
  + [Imperva Plans](/products/plans)Application Security[Application Security OverviewIndustry-leading application and API protection](/products/application-security/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/waf.svg)Web Application FirewallInstantly secure applications from the latest threats](/products/web-application-firewall-waf/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/advanced-bot-protection.svg)Advanced Bot ProtectionIdentify and mitigate the most sophisticated bad bot](/products/advanced-bot-protection-management/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/api-security.svg)API SecurityDiscover shadow APIs and the sensitive data they handle](/products/api-security/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2024/11/DDoS.svg)DDoS ProtectionSecure all assets at the edge with guaranteed uptime](/products/ddos-protection-services/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/client-side-protection.svg)Client-Side ProtectionVisibility and control over third-party JavaScript code](/products/client-side-protection-csp/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/runtime-protection.svg)Runtime ProtectionSecure workloads from unknown threats and vulnerabilities](/products/runtime-application-self-protection-rasp/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2024/11/ATO-icon.svg)Account Takeover ProtectionProtect login endpoints and prevent account-based fraud](/products/account-takeover-protection/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2024/11/CDN-icon.svg)Content Delivery NetworkBoost website performance with caching and compression](/products/content-delivery-network-cdn/)
  ##### Imperva named a security leader in the SecureIQlab CyberRisk Report

  [Get featured report](/resources/resource-library/reports/secureiqlab-2024-cloud-waap-cyberrisk-validation-report/)Data Security[Data Security OverviewProtect all data and ensure compliance at any scale](/products/data-security/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/data-security-fabric.svg)Data Security FabricMulticloud, hybrid security platform protecting all data types](/products/data-security-fabric/)
  + Business Capabilities
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_data_security.3b69d8d2-2-1.svg)Data security at scale](/products/data-security/data-security-at-scale/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_multicloud.5be4b003-1.svg)Data security for multicloud](/products/data-security/multicloud-expansion/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/Data-Risk-Analytics_black.svg)Risk analytics & insights](/products/data-security/risk-analytics-insights/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_brief.4af47836.svg)Data compliance at scale](/products/data-security/data-security-compliance-at-scale/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_discover_classify.ca96a429.svg)Data discovery & classification](/products/data-security/data-discovery-classification/)
  + The Imperva Advantage
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_coverage_black.845bc853-1.svg)Broadest coverage](/products/data-security/broadest-coverage/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_protect_data_black.c2346606.svg)Protect any data source](/products/data-security/protect-any-data-source/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_integrate_black.fbdab592-1.svg)Ecosystem integration](/products/data-security/expansive-fabric-ecosystem/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_unify_black.fe30fb89.svg)Unified visibility](/products/data-security/unified-visibility/)
  ##### IDC Spotlight: Effective Multicloud Data Security

  [Get featured report](/resources/resource-library/reports/idc-spotlight-effective-multicloud-data-security-requires-a-unified-approach/)[Imperva Plans](/products/plans)
* Solutions
  Solutions
  + By Use Case
  + By Industry
  + [Imperva Plans](/products/plans)By Use Case
  + Application Security
  + [Secure applications and APIs](/solutions/secure-applications-apis/)
  + [Protect from DDoS attacks](/solutions/prevent-ddos-attacks/)
  + [Stop bad bots](/solutions/stop-bots/)
  + [Comply with PCI DSS 4.0](/solutions/pci-dss-4-0-compliance-services/)
  + [Accelerate application delivery](/solutions/application-delivery/)
  + Data Security
  + [Advance data governance](/solutions/advancing-data-governance/)
  + [Assure data compliance and privacy](/solutions/data-discovery-and-classification/)
  + [Data encryption and cryptographic solutions](https://cpl.thalesgroup.com/encryption/data-security-platform)
  + [Monitor user behavior analytics](/solutions/user-behavior-analytics/)
  + [Data risk visibility and scoring](/solutions/data-risk-visibility/)
  + [Safeguard sensitive data](/solutions/safeguard-sensitive-and-personal-data/)
  + [Securely move data to the cloud](/solutions/secure-cloud-data-migration/)
  ##### A Unifying Approach to Data Protection

  [Start guided tour](/data-security-demo-tours/a-unifying-approach-to-data-protection/)By IndustrySolutions by IndustryDefense-in-depth security for every industry
  + [Government](/solutions/government-cyber-protection/)
  + [Healthcare](/solutions/healthcare-protection/)
  + [Financial Services](/solutions/financial-services-protection/)
  + [Telecom & ISPs](/solutions/protection-for-telecoms-and-isps/)
  + [Retail](/solutions/retail-and-ecommerce-protection/)
  ##### The State of Security within eCommerce 2022

  [Get free report](/resources/resource-library/reports/the-state-of-security-for-ecommerce-2022/)[Imperva Plans](/products/plans)
* Support
  Support
  SupportSupportLooking for technical support or services, please review our various channels below
  + [Technical Support](/support/technical-support)
  + [Services](/support/services/)
  + [Imperva University](/support/imperva-university/)
  + [Community](https://community.imperva.com/home)
  + [Support Portal Login](https://support.imperva.com/)
  + [Documentation](//docs.imperva.com/)
  + [EOL Policy](/support/eol-policy/)
* Partners
  Partners
  + Channel Partners
  + Technology Alliance PartnersChannel PartnersChannel Partners ProgramLooking for an Imperva partner? Find an approved one with the expertise to help you
  + [Channel Partners](/partners/channel-partners/)
  + [Find a Partner](/partners/find-a-partner/)
  + [Partner Portal Login](https://partners.cpl.thalesgroup.com/)
  ##### Imperva reimagines partner program: Imperva Accelerate

  [Learn how](/company/press_releases/new-partner-program/)Technology Alliance PartnersTechnology Alliance PartnersImperva collaborates with the top technology companies
  + [Technology Alliance Partners (TAP)](/partners/technology-alliance-program-tap/)
  + [Become a TAP](/partners/technology-alliance-program-tap-application/)
  + [Find a TAP](/partners/technology-alliance-program-tap/#TAP-finder)
  ##### Protect your Cloudera data with Imperva

  [Learn more](/resources/resource-library/datasheets/protect-your-cloudera-data-with-imperva/)
* Customers
  Customers
  + Application Security Customer Stories
  + Data Security Customer Stories
  + [See all Customer Stories](/resources/customers/)Application Security Customer StoriesApplication Security Customer StoriesLearn how Imperva enables and protects industry leaders
  + [Tower ensures website visibility and uninterrupted business operations](/resources/customers/case-studies/tower/)
  + [Smallpdf protects its customers and ensures availability](/resources/customers/case-studies/smallpdf/)
  ##### Quálitas continues its quality services using Imperva Application Security

  [Learn how](/resources/customers/case-studies/qualitas/)Data Security Customer StoriesData Security Customer StoriesLearn how Imperva enables and protects industry leaders
  + [Banco Popular streamlines operations and lowers operational costs](/resources/customers/case-studies/banco-popular-dominicano/)
  + [Discovery Inc. tackles data compliance in public cloud with Imperva Data Security Fabric](/resources/customers/case-studies/discovery-inc/)
  ##### BSE bolsters data security and compliance

  [Learn more](/resources/customers/case-studies/bse/)[See all Customer Stories](/resources/customers/)
* Resources
  Resources
  + Resources
  + Threat Research
  + Learning AssetsResourcesResourcesGet all the information you need about Imperva products and solutions
  + [Resource Library](/resources/resource-library/)
  + [Blog](/blog/)
  + [Webinars](/resources/resource-library/?type=webinars)
  + [Case Studies](/resources/customers/)
  + [Data Security Demo Tours](/data-security-demo-tours/)
  + [Application Security Demo Tours](/demo-tours/)
  + [Privacy, Compliance & Trust Center](/trust-center/)
  + [Imperva Certifications](https://docs.imperva.com/bundle/articles/page/product-service-certifications.htm)
  ##### Imperva Protects Against Critical Apache OFBiz Vulnerability (CVE-2024-45195)

  [Read more](/blog/imperva-protects-against-critical-apache-ofbiz-vulnerability/)Threat Research[Threat ResearchStay informed on the latest threats and vulnerabilities](/cyber-threat-index/threat-research/)
  + [Threat Research Overview](/cyber-threat-index/threat-research/)
  + [Cyber Threat Index](/cyber-threat-index/)
  + [Cyber Attack Map](/cyber-threat-attack-map/)
  + [Free Tools](/resources/free-cyber-security-testing-tools/)
  + [Network Map](/products/global-network-map/)
  ##### Cyber Threat Index

  [Latest threat analysis](/cyber-threat-index/)Learning AssetsLearning AssetsExpand and share your knowledge
  + [Learning Center](/learn/)
  + [Application Security Guide](/learn/application-security/application-security/)
  + [Data Security Guide](/learn/data-security/data-security/)
  + [Imperva Community](https://community.imperva.com/home)
  + [Documentation Portal](https://docs.imperva.com/)
  ##### Browse the Imperva Learning Center for the latest cybersecurity topics

  [Explore now](/learn/)
* Company
  Company
  CompanyCompanyGet to know us, beyond our products and services
  + [About Us](/company/about/)
  + [Events](/company/events/)
  + [Careers](/company/careers/)
  + [Press & Awards](/company/news/)
  + [Contact Information](/company/locations/)
  ##### Imperva ESG Reports

  [Read more](/environmental-social-governance-esg-reports/)

[Home](/) > [Blog](/blog/) > How Scanning Your Projects for Security Issues Can Lead to Remote Code Execution

# How Scanning Your Projects for Security Issues Can Lead to Remote Code Execution

[Application Security](https://www.imperva.com/blog/?category=application-security)

![How Scanning Your Projects for Security Issues Can Lead to Remote Code Execution](https://www.imperva.com/blog/wp-content/uploads/sites/9/2022/09/Snyk-Command-Injection-Vulnerability-Cover-1-e1664469145118.jpg)

[![]()](https://www.imperva.com/blog/author/rmasas/ "Ron Masas")
[Ron Masas](https://www.imperva.com/blog/author/rmasas/)

Sep 29, 2022  4 min read

***UPDATE:** Snyk has recently addressed **2 additional vulnerabilities** we have reported to them, CVE-2022-24441 and CVE-2022-22984, affecting versions of Snyk CLI before XXX, which leads to arbitrary code execution when scanning untrusted Maven or Gradle projects. Similar to CVE-2022-40764 these vulnerabilities could have been exploited through the Snyk IDE extensions when viewing untrusted projects. Snyk has released new versions of its CLI and IDE extensions to address these vulnerabilities. We want to thank Snyk again for their responsible disclosure practices and for their collaboration in addressing the vulnerabilities we reported. Snyk has also released [a blog post about the vulnerabilities](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev).*

The Imperva Red Team recently discovered and disclosed CVE-2022-40764, a command injection vulnerability affecting Snyk CLI. Snyk is a security company best known for its dependency vulnerability management software.

The disclosed command injection vulnerability affects the Snyk command-line interface tool that helps developers find and fix vulnerabilities. Exploitation of CVE-2022-40764 allows attackers to execute arbitrary commands on the host system where the Snyk CLI is installed. This can be exploited to gain access to sensitive data, modify files, or install malicious software.

We’d like to note Snyk’s responsible response and cooperation on this matter. Snyk released a patch for the vulnerability and recommends that users update to the latest version of Snyk CLI.

In this post, we explain the method we used to discover the vulnerability and different exploit scenarios.

## Monkey Patching

Traditionally, monkey patching is used to alter the behavior of a program at runtime. This technique can be used to add or modify a program functionality without changing the program code.

We used monkey patching to log information about function calls, parameters, and return values in order to locate potential vulnerabilities.

You can view the monkey patching script we used in our Github repository: [monkeyp](https://github.com/imperva/monkeyp).

## Finding the Vulnerability

When using dynamic analysis techniques to hunt for vulnerabilities, supplying the right input is crucial. We started by broadly defining the input range of our target. In Snyk’s case, it was a variety of programming languages and package managers. These projects were easily gathered using the Github API.

We monkey patched the Snyk CLI so it logged sensitive NodeJS operations such as file system access and shell/program execution. We then wrote a script that used our patched Snyk CLI to scan each of the projects we collected.

After a few minutes, we had all the execution logs. We started looking into them when we noticed that the “child\_process.spawn” method was called with what seems to be a “user-supplied” input and the shell option set to true. The “shell” option is a boolean option that, when set to true, runs commands inside of a shell (i.e. uses ‘/bin/sh’ on Unix, and process.env.ComSpec on Windows). Thus, if we could control any part of the input, we would be able to execute arbitrary shell commands.

After further investigation, we landed on the “vendor.json” file, which is used to specify the packages used by go projects. The “ignore” property value seemed to be the one used in the spawn command.

We tried modifying it to write a file to the */tmp* directory like so:

![Snyk Command Injection Vulnerability Image 1]()

However, it did not work. The Snyk CLI output the following error:

![Snyk Command Injection Vulnerability Image 2]()

Judging by the first line, we saw that some of our input was interpreted as a shell command. Looking at monkeyp logs, we could clearly see the issue.

![Snyk Command Injection Vulnerability Image 3]()

The Snyk CLI modifies our “ignore” value. Below, you can see the relevant code from the “snyk-go-parser” package which is responsible for these modifications.

![Snyk Command Injection Vulnerability Image 4]()

The “ignore” value is divided into chunks based on the space character. Then, for each chunk the following logic is performed:

1. If the chunk contains a forward slash, ignore it

2. Replace the last forward slash with an empty string

3. Push the chunk as is to the “ignorePkgs” array

4. Push the chunk again to the “ignorePkgs” array with the “/\*” string appended to it

The “ignorePkgs” array is later converted to a string in the “snyk-go-plugin” package by calling the join method with the separator argument set to a comma, which is later passed to the “child\_process.spawn” method as one of the arguments.

![Snyk Command Injection Vulnerability Image 6]()

Putting this all together, it means we either execute a file or we need to find a way to execute shell commands without using spaces.

When our command was interpreted by bash or zsh, we could use [IFS](https://bash.cyberciti.biz/guide/%24IFS) (Input Field Separator), which is a common WAF bypass technique. IFS is a special shell variable, where each character is treated like a delimiter. If IFS is unset, the default value will be , which was ideal for our objective.

Finally, we had to include at least one forward slash to ensure our input was added to the “ignorePkgs” array.

You can see the final payload below; it simply opens the calculator app on macOS.

![Snyk Command Injection Vulnerability Image 7]()

×
![2024 trends replay]()

Jan 22 Upcoming Webinar
### Unveiling the Cybersecurity Trends for 2025

Register Now

×

## Exploitation

To successfully exploit this vulnerability, a target would have to execute the “snyk test” command on untrusted files. While this is bad, practical exploitation is hard. We decided to go back and look for libraries that use Snyk CLI as a dependency to see if there would be a way to make exploitation more practical.

After going over a few libraries, we found that Snyk built a [VSCode extension](https://marketplace.visualstudio.com/items?itemName=snyk-security.snyk-vulnerability-scanner) that uses the CLI to automatically scan every project opened with VSCode. This is already an improvement as the user would only need to view untrusted files in the VSCode editor to trigger our exploit, which is more likely in our view.

![ezgif 4 e85eae3e81]()

## Closing Thoughts

The Imperva Red Team mission is to make attackers’ jobs harder by finding and responsibly disclosing vulnerabilities in popular services. It was a privilege to contribute to protecting the privacy of Snyk’s user community, as we continuously do for our own Imperva customers.

We hope you found this post informative and we look forward to sharing more technical walkthroughs in the future.

### Try Imperva for Free

Protect your business for 30 days on Imperva.

[Start Now](https://www.imperva.com/free-trial/)

### Try Imperva for Free

Protect your business for 30 days on Imperva.

[Start Now](https://www.imperva.com/free-trial/)
### Suggested Report

[The State of API Security in 2024](https://www.imperva.com/resources/resource-library/reports/the-state-of-api-security-in-2024/) [Read more](https://www.imperva.com/resources/resource-library/reports/the-state-of-api-security-in-2024/)

## Trending

[![holiday shopping 2](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/10/holiday-shopping-2.jpeg)](https://www.imperva.com/blog/seven-tips-to-protect-retail-businesses-this-holiday-season/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
[Seven Cybersecurity Tips to Protect Your Retail Business This Holiday Season](https://www.imperva.com/blog/seven-tips-to-protect-retail-businesses-this-holiday-season/)
[![]()](https://www.imperva.com/blog/author/erez-hassonimperva-com/ "Erez Hasson")
[Erez Hasson](https://www.imperva.com/blog/author/erez-hassonimperva-com/)

Oct 21, 2024  13 min read

[![Screenshot 2024 09 17 at 09.37.34](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/09/Screenshot-2024-09-17-at-09.37.34.png)](https://www.imperva.com/blog/rising-cost-of-vulnerable-apis-and-bot-attacks-a-186b-wake-up-call/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
[The Rising Cost of Vulnerable APIs and Bot Attacks – A $186 Billion Wake-Up Call for Businesses](https://www.imperva.com/blog/rising-cost-of-vulnerable-apis-and-bot-attacks-a-186b-wake-up-call/)
[![]()](https://www.imperva.com/blog/author/erez-hassonimperva-com/ "Erez Hasson")
[Erez Hasson](https://www.imperva.com/blog/author/erez-hassonimperva-com/)

Sep 18, 2024  2 min read

[![shutterstock 1071270287 23](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/09/shutterstock_1071270287-23.jpg.webp)](https://www.imperva.com/blog/imperva-protects-against-critical-apache-ofbiz-vulnerability/)
[Imperva Threat Research](https://www.imperva.com/blog/?category=labs)
...

* [Application Security](https://www.imperva.com/blog/?category=application-security)

[Imperva Protects Against Critical Apache OFBiz Vulnerability (CVE-2024-45195)](https://www.imperva.com/blog/imperva-protects-against-critical-apache-ofbiz-vulnerability/)
[![]()](https://www.imperva.com/blog/author/gabriellastapel/ "Gabi Sharadin")[![]()](https://www.imperva.com/blog/author/mulylevy/ "Muly Levy")
[Gabi Sharadin](https://www.imperva.com/blog/author/gabriellastapel/)[, Muly Levy](https://www.imperva.com/blog/author/mulylevy/)

Sep 11, 2024  1 min read

[![skyscraper in the clouds](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/08/skyscraper-in-the-clouds.jpg.webp)](https://www.imperva.com/blog/imperva-leads-industry-in-secureiqlabs-cloud-waap-comparative/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
[Imperva Security Efficacy and Operational Efficiency Leads the Industry in SecureIQLab's Cloud WAAP Comparative Report](https://www.imperva.com/blog/imperva-leads-industry-in-secureiqlabs-cloud-waap-comparative/)
[![]()](https://www.imperva.com/blog/author/lukerichardson/ "Luke Richardson")[![user copy 6@3x]()](https://www.imperva.com/blog/author/ericguillotin/ "Eric Guillotin")
[Luke Richardson](https://www.imperva.com/blog/author/lukerichardson/)[, Eric Guillotin](https://www.imperva.com/blog/author/ericguillotin/)

Aug 12, 2024  3 min read

[![mobile scans](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/07/shutterstock_1071270287-19.jpg.webp)](https://www.imperva.com/blog/imperva-customers-protected-against-critical-servicenow-vulnerability/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
...

* [Imperva Threat Research](https://www.imperva.com/blog/?category=labs)

[Imperva Customers Protected Against Critical ServiceNow Vulnerability](https://www.imperva.com/blog/imperva-customers-protected-against-critical-servicenow-vulnerability/)
[![]()](https://www.imperva.com/blog/author/gabriellastapel/ "Gabi Sharadin")[![]()](https://www.imperva.com/blog/author/mulylevy/ "Muly Levy")
[Gabi Sharadin](https://www.imperva.com/blog/author/gabriellastapel/)[, Muly Levy](https://www.imperva.com/blog/author/mulylevy/)

Jul 23, 2024  2 min read

[![Imperva DDos Report 2024](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/07/shutterstock_1071270287-16.jpg.webp)](https://www.imperva.com/blog/unveiling-the-2024-imperva-ddos-threat-landscape-report/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
[Unveiling the 2024 Imperva DDoS Threat Landscape Report](https://www.imperva.com/blog/unveiling-the-2024-imperva-ddos-threat-landscape-report/)
[![]()](https://www.imperva.com/blog/author/grainnemckeevera/ "Grainne McKeever")
[Grainne McKeever](https://www.imperva.com/blog/author/grainnemckeevera/)

Jul 16, 2024  2 min read

[![Imperva](https://www.imperva.com/blog/wp-content/themes/impv/img/logo-imperva-a-thales-company.svg)](https://www.imperva.com)

+1 866 926 4678

Partners

* [Imperva Partner Ecosystem](/partners/)
* [Channel Partners](/partners/channel-partners/)
* [Technology Alliances](/partners/technology-alliance-program-tap/)
* [Find a Partner](/partners/find-a-partner/)
* [Partner Portal Login](https://partners.cpl.thalesgroup.com/)

Resources

* [Imperva Blog](/blog/)
* [Resource Library](/resources/resource-library/)
* [Case Studies](/resources/customers/)
* [Learning Center](/learn/)

About Us

* [Why Imperva](/products/why-imperva/)
* [Who We Are](/company/about/)
* [Events](/company/events/)
* [Careers](/company/careers/)
* [Press & Awards](/company/news/)
* [Contact Information](/company/locations/)

Network

* [Network Map](/products/global-network-map/)
* [System Status](https://status.imperva.com/)

Support

* [Emergency DDoS Protection](/under-ddos-attack/)
* [Support Portal](https://support.imperva.com/)
* [Imperva Community](https://community.imperva.com/home)
* [Documentation Portal](https://docs.imperva.com/)
* [API Integration](https://docs.imperva.com/bundle/cloud-application-security/page/api/api.htm)
* [Trust Center](/trust-center/)

Cookie Preferences [Trust Center](/trust-center/) [Modern Slavery Statement](/legal/modern-slavery-statement/) [Privacy](/trust-center/privacy-statement/) [Legal](/legal/website-terms-of-use/)

English

EnglishDeutschEspañolFrançaisPortuguês日本語中文ภาษาไทย

+1 866 926 4678

English

EnglishDeutschEspañolFrançaisPortuguês日本語中文ภาษาไทย

Cookie Preferences [Trust Center](/trust-center/) [Modern Slavery Statement](/legal/modern-slavery-statement/) [Privacy](/trust-center/privacy-statement/) [Legal](/legal/website-terms-of-use/)

Copyright © 2024 Imperva. All rights reserved

×

### KuppingerCole Leadership Compass 2024 for Web Application Firewalls

Learn how Imperva is leading by delivering “comprehensive WAF capabilities”

[Download Now](/resources/resource-library/reports/kuppingercole-leadership-compass-2024-for-web-application-firewalls/)

×

### The Economic Impact of API and Bot Attacks

What is the true cost of API and bot-related attacks to your organization?

[Download Now](/resources/resource-library/reports/the-economic-impact-of-api-and-bot-attacks/)

×

### Future-proofing Data Security

Integrating DSPM, AI, and encryption for comprehensive protection

Download Now

×

### The State of API Security in 2024

Learn about the current API threat landscape and the key security insights for 2024

[Download Now](/resources/resource-library/reports/the-state-of-api-security-in-2024/)

×

### Protect Against Business Logic Abuse

Identify key capabilities to prevent attacks targeting your business logic

[Download Now](/resources/resource-library/white-papers/buyers-guide-essential-capabilities-for-business-logic-protection/)

×

### The State of Security Within eCommerce in 2022

Learn how automated threats and API attacks on retailers are increasing

[Free Report](/resources/resource-library/reports/the-state-of-security-for-ecommerce-2022/)

×
### Prevoty is now part of the Imperva Runtime Protection

* Protection against zero-day attacks
* No tuning, highly-accurate out-of-the-box
* Effective against OWASP top 10 vulnerabilities

[Learn more here](https://www.imperva.com/blog/5-things-to-know-about-imperva-rasp/)

×

Want to see Imperva in action?
Fill out the form and our experts will be in touch shortly to book your personal demo.

## Thank you!

![envelope](/wp-content/uploads/2020/12/shape.svg)

An Imperva security specialist will contact you shortly.

×

![](/wp-content/uploads/2021/03/Group-2554.svg)


