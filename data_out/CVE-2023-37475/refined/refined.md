The content is related to CVE-2023-37475.

**Root cause of vulnerability:**
The `github.com/hamba/avro/v2.Unmarshal()` function uses a part of the input to determine the size when creating a new slice. Specifically, the `readBytes` function (in `reader.go`) reads a length from the input and uses this length to create a byte slice. If the length is sufficiently large, it can lead to an out-of-memory error.

**Weaknesses/vulnerabilities present:**
- Uncontrolled resource consumption due to attacker-controlled size parameter.
- Improper input validation in the `readBytes` function when handling lengths for byte slices.
- Insufficient memory allocation limits when creating byte slices.

**Impact of exploitation:**
- Denial of Service (DoS) due to a `fatal error: runtime: out of memory`, causing the application to crash.

**Attack vectors:**
- Network: An attacker can send specially crafted Avro messages with a large length field.

**Required attacker capabilities/position:**
- The attacker needs to be able to send data to an application using the vulnerable `github.com/hamba/avro/v2.Unmarshal()` function.
- No special privileges or user interaction is needed.

**Additional details:**
- The vulnerability occurs in `reader.go` specifically the `readBytes` function.
- The fix involves introducing a configurable maximum size for byte slices that `Reader` will create, with a default of 1MiB. This limit can be disabled by setting a negative number in config.
- A proof-of-concept (PoC) is provided that demonstrates how to trigger the vulnerability in a Dapr application using the vulnerable avro library.
- The vulnerability has a CVSS score of 7.5 (High), with the following base metrics: AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
- The vulnerability has been assigned CWE-400 (Uncontrolled Resource Consumption)