
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopensearch-project%2Fsecurity%2Fpull%2F1999)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopensearch-project%2Fsecurity%2Fpull%2F1999)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=opensearch-project%2Fsecurity)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[opensearch-project](/opensearch-project)
/
**[security](/opensearch-project/security)**
Public

* [Notifications](/login?return_to=%2Fopensearch-project%2Fsecurity) You must be signed in to change notification settings
* [Fork
  282](/login?return_to=%2Fopensearch-project%2Fsecurity)
* [Star
   202](/login?return_to=%2Fopensearch-project%2Fsecurity)

* [Code](/opensearch-project/security)
* [Issues
  247](/opensearch-project/security/issues)
* [Pull requests
  18](/opensearch-project/security/pulls)
* [Actions](/opensearch-project/security/actions)
* [Projects
  2](/opensearch-project/security/projects)
* [Security](/opensearch-project/security/security)
* [Insights](/opensearch-project/security/pulse)

Additional navigation options

* [Code](/opensearch-project/security)
* [Issues](/opensearch-project/security/issues)
* [Pull requests](/opensearch-project/security/pulls)
* [Actions](/opensearch-project/security/actions)
* [Projects](/opensearch-project/security/projects)
* [Security](/opensearch-project/security/security)
* [Insights](/opensearch-project/security/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopensearch-project%2Fsecurity%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopensearch-project%2Fsecurity%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [CVE-2022-35980] Ensure concrete indexes included during index resolution for DLS/FLS/Masking checks #1999

 Merged

[peternied](/peternied)
merged 2 commits into
[opensearch-project:main](/opensearch-project/security/tree/main "opensearch-project/security:main")
from
[peternied:resolve-indices-changes](/peternied/security/tree/resolve-indices-changes "peternied/security:resolve-indices-changes")

Aug 8, 2022

 Merged

# [[CVE-2022-35980] Ensure concrete indexes included during index resolution for DLS/FLS/Masking checks](#top) #1999

[peternied](/peternied)
merged 2 commits into
[opensearch-project:main](/opensearch-project/security/tree/main "opensearch-project/security:main")
from
[peternied:resolve-indices-changes](/peternied/security/tree/resolve-indices-changes "peternied/security:resolve-indices-changes")

Aug 8, 2022

[Conversation
17](/opensearch-project/security/pull/1999)
[Commits
2](/opensearch-project/security/pull/1999/commits)
[Checks
0](/opensearch-project/security/pull/1999/checks)
[Files changed](/opensearch-project/security/pull/1999/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![peternied](https://avatars.githubusercontent.com/u/2754967?s=60&v=4)](/peternied)

Copy link

Member

### @peternied **[peternied](/peternied)** commented [Aug 5, 2022](#issue-1330409886)

Resolving index patterns into concrete indices had some confusing logic

make it hard to verify its behavior. Updated this code to be easier

to read and added test cases to confirm resolution patterns. Also added

unit tests to ensure line/by line coverage was correct.

### Issues Resolved

### Testing

### Check List

* New functionality includes testing
* ~~New functionality has been documented~~
* Commits are signed per the DCO using --signoff

By submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.

For more information on following Developer Certificate of Origin and signing off your commits, please check [here](https://github.com/opensearch-project/OpenSearch/blob/main/CONTRIBUTING.md#developer-certificate-of-origin).

Sorry, something went wrong.

All reactions

 [![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)
[peternied](/peternied)
requested a review
from a team
[August 5, 2022 21:22](#event-7138855813)

[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)
[peternied](/peternied)
self-assigned this
[Aug 5, 2022](#event-7138855814)

[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&v=4)](/peternied)

`[Update indices resolution to be clearer](/opensearch-project/security/pull/1999/commits/107cd4f45ac2a46316c79790a76bc3f68c23fda6 "Update indices resolution to be clearer

Resolving index patterns into concrete indices had some confusing logic
make it hard to verify its behavior.  Updated this code to be easier
to read and added test cases to confirm resolution patterns.  Also added
unit tests to ensure line/by line coverage was correct.

Signed-off-by: Peter Nied <petern@amazon.com>")`
 …

`[107cd4f](/opensearch-project/security/pull/1999/commits/107cd4f45ac2a46316c79790a76bc3f68c23fda6)`

```
Resolving index patterns into concrete indices had some confusing logic
make it hard to verify its behavior.  Updated this code to be easier
to read and added test cases to confirm resolution patterns.  Also added
unit tests to ensure line/by line coverage was correct.

Signed-off-by: Peter Nied <petern@amazon.com>
```

 [![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)
[peternied](/peternied)
[force-pushed](/opensearch-project/security/compare/6c000d5f2f2689910da752f39fae175dd87bf93c..107cd4f45ac2a46316c79790a76bc3f68c23fda6)
the
resolve-indices-changes

branch
from
[`6c000d5`](/opensearch-project/security/commit/6c000d5f2f2689910da752f39fae175dd87bf93c) to
[`107cd4f`](/opensearch-project/security/commit/107cd4f45ac2a46316c79790a76bc3f68c23fda6)  [Compare](/opensearch-project/security/compare/6c000d5f2f2689910da752f39fae175dd87bf93c..107cd4f45ac2a46316c79790a76bc3f68c23fda6)
[August 5, 2022 21:24](#event-7138870439)

[![cwperks](https://avatars.githubusercontent.com/u/17432265?s=60&v=4)](/cwperks)

**[cwperks](/cwperks)**
reviewed
[Aug 8, 2022](#pullrequestreview-1065202795)

 [View reviewed changes](/opensearch-project/security/pull/1999/files/107cd4f45ac2a46316c79790a76bc3f68c23fda6)

Copy link

Member

### @cwperks **[cwperks](/cwperks)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thank you for the additional tests around the index pattern resolution logic. This is a good addition to making it clearer about how the process works.

Sorry, something went wrong.

All reactions

[src/main/java/org/opensearch/security/securityconf/ConfigModelV7.java](/opensearch-project/security/pull/1999/files/107cd4f45ac2a46316c79790a76bc3f68c23fda6#diff-77e2d2460234b7e8faa37a83d4a2eb672d0f5a4c678a229dc3a9c7e11c8d8b4a)

Show resolved

Hide resolved

[src/test/java/org/opensearch/security/dlic/dlsfls/FlsIndexingTests.java](/opensearch-project/security/pull/1999/files/107cd4f45ac2a46316c79790a76bc3f68c23fda6#diff-e52eeb30a6aacde3fa88e44574ad8a8606c8bbf07362c971781a1cb4f4e4c8f1)

Show resolved

Hide resolved

[src/test/java/org/opensearch/security/securityconf/impl/v7/IndexPatternTests.java](/opensearch-project/security/pull/1999/files/107cd4f45ac2a46316c79790a76bc3f68c23fda6#diff-52957a11e7e5a591f04c1f7612e883d5d4642b783b9727f2b14f970354cdd47d)

Show resolved

Hide resolved

[src/test/java/org/opensearch/security/securityconf/impl/v7/IndexPatternTests.java](/opensearch-project/security/pull/1999/files/107cd4f45ac2a46316c79790a76bc3f68c23fda6#diff-52957a11e7e5a591f04c1f7612e883d5d4642b783b9727f2b14f970354cdd47d)

Show resolved

Hide resolved

[src/test/java/org/opensearch/security/securityconf/impl/v7/IndexPatternTests.java](/opensearch-project/security/pull/1999/files/107cd4f45ac2a46316c79790a76bc3f68c23fda6#diff-52957a11e7e5a591f04c1f7612e883d5d4642b783b9727f2b14f970354cdd47d)

Show resolved

Hide resolved

[src/test/java/org/opensearch/security/dlic/dlsfls/FlsIndexingTests.java](/opensearch-project/security/pull/1999/files/107cd4f45ac2a46316c79790a76bc3f68c23fda6#diff-e52eeb30a6aacde3fa88e44574ad8a8606c8bbf07362c971781a1cb4f4e4c8f1)

Show resolved

Hide resolved

[![cwperks](https://avatars.githubusercontent.com/u/17432265?s=60&v=4)](/cwperks)

**[cwperks](/cwperks)**
previously approved these changes
[Aug 8, 2022](#pullrequestreview-1065553847)

 [View reviewed changes](/opensearch-project/security/pull/1999/files/107cd4f45ac2a46316c79790a76bc3f68c23fda6)

[![cliu123](https://avatars.githubusercontent.com/u/16925774?s=60&v=4)](/cliu123)

**[cliu123](/cliu123)**
previously approved these changes
[Aug 8, 2022](#pullrequestreview-1065590731)

 [View reviewed changes](/opensearch-project/security/pull/1999/files/107cd4f45ac2a46316c79790a76bc3f68c23fda6)

[![@cliu123](https://avatars.githubusercontent.com/u/16925774?s=80&u=625534ca8b5537791d494ade72c8da7d5afd59f1&v=4)](/cliu123)

Copy link

Member

### **[cliu123](/cliu123)** commented [Aug 8, 2022](#issuecomment-1208451983) • edited Loading

| The fix looks good to me! But the CI failed. I'll redo approval when CI passes. |
| --- |

 👍
1
 peternied reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&v=4)](/peternied)

`[Keep existing behavoir when there are no matches found to return the …](/opensearch-project/security/pull/1999/commits/ac1acc8e97f8761acc909f57f8ac7a3c5f51da29 "Keep existing behavoir when there are no matches found to return the unresolved index

Signed-off-by: Peter Nied <petern@amazon.com>")`
 …

`[ac1acc8](/opensearch-project/security/pull/1999/commits/ac1acc8e97f8761acc909f57f8ac7a3c5f51da29)`

```
…unresolved index

Signed-off-by: Peter Nied <petern@amazon.com>
```

 [![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)
[peternied](/peternied)
dismissed stale reviews from [cliu123](/cliu123) and [cwperks](/cwperks)
via
`[ac1acc8](/opensearch-project/security/commit/ac1acc8e97f8761acc909f57f8ac7a3c5f51da29)`
[August 8, 2022 18:33](#event-7149402106)

[![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=80&u=b7ee84d82e25b493051d810390e97b15f716d7ef&v=4)](/codecov-commenter)

Copy link

### **[codecov-commenter](/codecov-commenter)** commented [Aug 8, 2022](#issuecomment-1208496583)

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/opensearch-project/security/pull/1999?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None) Report Merging [#1999](https://codecov.io/gh/opensearch-project/security/pull/1999?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None) ([ac1acc8](https://github.com/opensearch-project/security/commit/ac1acc8e97f8761acc909f57f8ac7a3c5f51da29)) into [main](https://codecov.io/gh/opensearch-project/security/commit/f7b6fe588f0eb44c1767b8b6c00ca0bf3f121606?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None) ([f7b6fe5](https://github.com/opensearch-project/security/commit/f7b6fe588f0eb44c1767b8b6c00ca0bf3f121606)) will **increase** coverage by `0.01%`. The diff coverage is `94.11%`.  ``` @@             Coverage Diff              @@ ##               main    #1999      +/-   ## ============================================ + Coverage     61.03%   61.04%   +0.01%        Complexity     3232     3232               ============================================   Files           256      256                 Lines         18085    18084       -1        Branches       3222     3221       -1      ============================================ + Hits          11038    11040       +2        Misses         5471     5471               + Partials       1576     1573       -3      ```  | [Impacted Files](https://codecov.io/gh/opensearch-project/security/pull/1999?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None) | Coverage Δ |  | | --- | --- | --- | | [...pensearch/security/securityconf/ConfigModelV7.java](https://codecov.io/gh/opensearch-project/security/pull/1999/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None#diff-c3JjL21haW4vamF2YS9vcmcvb3BlbnNlYXJjaC9zZWN1cml0eS9zZWN1cml0eWNvbmYvQ29uZmlnTW9kZWxWNy5qYXZh) | `63.29% <94.11%> (+0.53%)` | ⬆️ | | [...ecurity/ssl/rest/SecuritySSLReloadCertsAction.java](https://codecov.io/gh/opensearch-project/security/pull/1999/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None#diff-c3JjL21haW4vamF2YS9vcmcvb3BlbnNlYXJjaC9zZWN1cml0eS9zc2wvcmVzdC9TZWN1cml0eVNTTFJlbG9hZENlcnRzQWN0aW9uLmphdmE=) | `84.78% <0.00%> (-0.33%)` | ⬇️ |   Help us with your feedback. Take ten seconds to tell us [how you rate us](https://about.codecov.io/nps?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None). Have a feature suggestion? [Share it here.](https://app.codecov.io/gh/feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None) |

All reactions

Sorry, something went wrong.

[![cliu123](https://avatars.githubusercontent.com/u/16925774?s=60&v=4)](/cliu123)

**[cliu123](/cliu123)**
reviewed
[Aug 8, 2022](#pullrequestreview-1065662426)

 [View reviewed changes](/opensearch-project/security/pull/1999/files/ac1acc8e97f8761acc909f57f8ac7a3c5f51da29)

[src/main/java/org/opensearch/security/securityconf/ConfigModelV7.java](/opensearch-project/security/pull/1999/files/ac1acc8e97f8761acc909f57f8ac7a3c5f51da29#diff-77e2d2460234b7e8faa37a83d4a2eb672d0f5a4c678a229dc3a9c7e11c8d8b4a)

Show resolved

Hide resolved

[![cliu123](https://avatars.githubusercontent.com/u/16925774?s=60&v=4)](/cliu123)

**[cliu123](/cliu123)**
approved these changes
[Aug 8, 2022](#pullrequestreview-1065728827)

 [View reviewed changes](/opensearch-project/security/pull/1999/files/ac1acc8e97f8761acc909f57f8ac7a3c5f51da29)

[![cliu123](https://avatars.githubusercontent.com/u/16925774?s=60&v=4)](/cliu123)

**[cliu123](/cliu123)**
reviewed
[Aug 8, 2022](#pullrequestreview-1065735564)

 [View reviewed changes](/opensearch-project/security/pull/1999/files/ac1acc8e97f8761acc909f57f8ac7a3c5f51da29)

[src/main/java/org/opensearch/security/securityconf/ConfigModelV7.java](/opensearch-project/security/pull/1999/files/ac1acc8e97f8761acc909f57f8ac7a3c5f51da29#diff-77e2d2460234b7e8faa37a83d4a2eb672d0f5a4c678a229dc3a9c7e11c8d8b4a)

Show resolved

Hide resolved

[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)
[peternied](/peternied)
merged commit [`42b936e`](/opensearch-project/security/commit/42b936ef140fc143001c83fc03b6402d13ca4677)
into
opensearch-project:main

[Aug 8, 2022](https://github.com/opensearch-project/security/pull/1999#event-7150810474)

[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)
[peternied](/peternied)
added
[backport 2.2](/opensearch-project/security/labels/backport%202.2)
backport to 2.2
[backport 2.x](/opensearch-project/security/labels/backport%202.x)
backport to 2.x branch
labels
[Aug 8, 2022](#event-7150818057)

[opensearch-trigger-bot](/apps/opensearch-trigger-bot) bot
pushed a commit
that referenced
this pull request
[Aug 8, 2022](#ref-commit-5aef661)
[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied) [![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)

`[Update indices resolution to be clearer (](/opensearch-project/security/commit/5aef6612649cfd9b6e1a487153e969ef994ffa56 "Update indices resolution to be clearer (#1999)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)")[#1999](https://github.com/opensearch-project/security/pull/1999)[)](/opensearch-project/security/commit/5aef6612649cfd9b6e1a487153e969ef994ffa56 "Update indices resolution to be clearer (#1999)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)")`
…

`[5aef661](/opensearch-project/security/commit/5aef6612649cfd9b6e1a487153e969ef994ffa56)`

```
(cherry picked from commit [42b936e](https://github.com/opensearch-project/security/commit/42b936ef140fc143001c83fc03b6402d13ca4677))
```

[![@opensearch-trigger-bot](https://avatars.githubusercontent.com/u/80134844?s=40&v=4)](/apps/opensearch-trigger-bot)
[opensearch-trigger-bot](/apps/opensearch-trigger-bot)
bot
mentioned this pull request
[Aug 8, 2022](#ref-pullrequest-1332486679)

[[Backport 2.x] Update indices resolution to be clearer
#2002](/opensearch-project/security/pull/2002)
 Merged

[opensearch-trigger-bot](/apps/opensearch-trigger-bot) bot
pushed a commit
that referenced
this pull request
[Aug 8, 2022](#ref-commit-8a04d18)
[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied) [![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)

`[Update indices resolution to be clearer (](/opensearch-project/security/commit/8a04d18c3b7d68a0c449cb2cbea5de52dc567531 "Update indices resolution to be clearer (#1999)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)")[#1999](https://github.com/opensearch-project/security/pull/1999)[)](/opensearch-project/security/commit/8a04d18c3b7d68a0c449cb2cbea5de52dc567531 "Update indices resolution to be clearer (#1999)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)")`
…

`[8a04d18](/opensearch-project/security/commit/8a04d18c3b7d68a0c449cb2cbea5de52dc567531)`

```
(cherry picked from commit [42b936e](https://github.com/opensearch-project/security/commit/42b936ef140fc143001c83fc03b6402d13ca4677))
```

[![@opensearch-trigger-bot](https://avatars.githubusercontent.com/u/80134844?s=40&v=4)](/apps/opensearch-trigger-bot)
[opensearch-trigger-bot](/apps/opensearch-trigger-bot)
bot
mentioned this pull request
[Aug 8, 2022](#ref-pullrequest-1332488137)

[[Backport 2.2] Update indices resolution to be clearer
#2003](/opensearch-project/security/pull/2003)
 Merged

[peternied](/peternied)
added a commit
that referenced
this pull request
[Aug 9, 2022](#ref-commit-8e9e583)
[![@opensearch-trigger-bot](https://avatars.githubusercontent.com/u/80134844?s=40&v=4)](/apps/opensearch-trigger-bot) [![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)

`[Update indices resolution to be clearer (](/opensearch-project/security/commit/8e9e583adeae552f61df218401971ffc094342d0 "Update indices resolution to be clearer (#1999) (#2003)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)

Co-authored-by: Peter Nied <petern@amazon.com>")[#1999](https://github.com/opensearch-project/security/pull/1999)[) (](/opensearch-project/security/commit/8e9e583adeae552f61df218401971ffc094342d0 "Update indices resolution to be clearer (#1999) (#2003)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)

Co-authored-by: Peter Nied <petern@amazon.com>")[#2003](https://github.com/opensearch-project/security/pull/2003)[)](/opensearch-project/security/commit/8e9e583adeae552f61df218401971ffc094342d0 "Update indices resolution to be clearer (#1999) (#2003)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)

Co-authored-by: Peter Nied <petern@amazon.com>")`
…

`[8e9e583](/opensearch-project/security/commit/8e9e583adeae552f61df218401971ffc094342d0)`

```
(cherry picked from commit [42b936e](https://github.com/opensearch-project/security/commit/42b936ef140fc143001c83fc03b6402d13ca4677))

Co-authored-by: Peter Nied <petern@amazon.com>
```

 [![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)
[peternied](/peternied)
deleted the
resolve-indices-changes

branch
[August 9, 2022 17:27](#event-7157470857)

[bharath-techie](/bharath-techie)
pushed a commit
to bharath-techie/security
that referenced
this pull request
[Aug 12, 2022](#ref-commit-9350a66)
[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied) [![@bharath-techie](https://avatars.githubusercontent.com/u/58062316?s=40&v=4)](/bharath-techie)

`[Update indices resolution to be clearer (](/bharath-techie/security/commit/9350a6660c3373c6fc0277960ec873cfedf1880d "Update indices resolution to be clearer (#1999)")[opensearch-project#1999](https://github.com/opensearch-project/security/pull/1999)[)](/bharath-techie/security/commit/9350a6660c3373c6fc0277960ec873cfedf1880d "Update indices resolution to be clearer (#1999)")`

`[9350a66](/bharath-techie/security/commit/9350a6660c3373c6fc0277960ec873cfedf1880d)`

[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)
[peternied](/peternied)
changed the title
~~Update indices resolution to be clearer~~
[CVE-2022-35980] Ensure concrete indexes included during indices resolution
[Aug 12, 2022](#event-7180296116)

[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)
[peternied](/peternied)
changed the title
~~[CVE-2022-35980] Ensure concrete indexes included during indices resolution~~
[CVE-2022-35980] Ensure concrete indexes included during index resolution for DLS/FLS/Masking checks
[Aug 12, 2022](#event-7180298689)

[peternied](/peternied)
added a commit
that referenced
this pull request
[Aug 12, 2022](#ref-commit-25087b1)
[![@opensearch-trigger-bot](https://avatars.githubusercontent.com/u/80134844?s=40&v=4)](/apps/opensearch-trigger-bot) [![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)

`[Update indices resolution to be clearer (](/opensearch-project/security/commit/25087b14a5d90f6115765e8ff5ce42d6ca547ca8 "Update indices resolution to be clearer (#1999) (#2002)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)

Co-authored-by: Peter Nied <petern@amazon.com>")[#1999](https://github.com/opensearch-project/security/pull/1999)[) (](/opensearch-project/security/commit/25087b14a5d90f6115765e8ff5ce42d6ca547ca8 "Update indices resolution to be clearer (#1999) (#2002)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)

Co-authored-by: Peter Nied <petern@amazon.com>")[#2002](https://github.com/opensearch-project/security/pull/2002)[)](/opensearch-project/security/commit/25087b14a5d90f6115765e8ff5ce42d6ca547ca8 "Update indices resolution to be clearer (#1999) (#2002)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)

Co-authored-by: Peter Nied <petern@amazon.com>")`
…

`[25087b1](/opensearch-project/security/commit/25087b14a5d90f6115765e8ff5ce42d6ca547ca8)`

```
(cherry picked from commit [42b936e](https://github.com/opensearch-project/security/commit/42b936ef140fc143001c83fc03b6402d13ca4677))

Co-authored-by: Peter Nied <petern@amazon.com>
```

[![@rursprung](https://avatars.githubusercontent.com/u/39383228?s=40&v=4)](/rursprung)
[rursprung](/rursprung)
mentioned this pull request
[Aug 18, 2022](#ref-issue-1050831321)

[[BUG] By default user can access all data streams messages
#1498](/opensearch-project/security/issues/1498)

Closed

[peternied](/peternied)
added a commit
that referenced
this pull request
[Nov 9, 2022](#ref-commit-5d62ebe)
[![@cwperks](https://avatars.githubusercontent.com/u/17432265?s=40&u=501a650d8674c7b78d500121160b84a894db59eb&v=4)](/cwperks) [![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)

`[[Backport 1.3] Fix issues with datastream backing indexes (](/opensearch-project/security/commit/5d62ebe6db693d2e037e31aea5c77a64c5ceaba0 "[Backport 1.3] Fix issues with datastream backing indexes (#2247)

* Update indices resolution to be clearer (#1999)
* Resolving backing indices of data streams when resolving for aliases
* Fixing resolution of indices for non-wild card scenarios / exact matches
* Adding tests for DLS/FLS/Field-Masking on Data Streams

Signed-off-by: Craig Perkins <cwperx@amazon.com>
Co-authored-by: Sandesh Kumar <kusandes@amazon.com>
Co-authored-by: Peter Nied <petern@amazon.com>
Co-authored-by: Dave Lago <davelago@amazon.com>
Co-authored-by: Sandesh Kumar <kusandes@amazon.com>")[#2247](https://github.com/opensearch-project/security/pull/2247)[)](/opensearch-project/security/commit/5d62ebe6db693d2e037e31aea5c77a64c5ceaba0 "[Backport 1.3] Fix issues with datastream backing indexes (#2247)

* Update indices resolution to be clearer (#1999)
* Resolving backing indices of data streams when resolving for aliases
* Fixing resolution of indices for non-wild card scenarios / exact matches
* Adding tests for DLS/FLS/Field-Masking on Data Streams

Signed-off-by: Craig Perkins <cwperx@amazon.com>
Co-authored-by: Sandesh Kumar <kusandes@amazon.com>
Co-authored-by: Peter Nied <petern@amazon.com>
Co-authored-by: Dave Lago <davelago@amazon.com>
Co-authored-by: Sandesh Kumar <kusandes@amazon.com>")`
…

`[5d62ebe](/opensearch-project/security/commit/5d62ebe6db693d2e037e31aea5c77a64c5ceaba0)`

```
* Update indices resolution to be clearer ([#1999](https://github.com/opensearch-project/security/pull/1999))
* Resolving backing indices of data streams when resolving for aliases
* Fixing resolution of indices for non-wild card scenarios / exact matches
* Adding tests for DLS/FLS/Field-Masking on Data Streams

Signed-off-by: Craig Perkins <cwperx@amazon.com>
Co-authored-by: Sandesh Kumar <kusandes@amazon.com>
Co-authored-by: Peter Nied <petern@amazon.com>
Co-authored-by: Dave Lago <davelago@amazon.com>
Co-authored-by: Sandesh Kumar <kusandes@amazon.com>
```

[stephen-crawford](/stephen-crawford)
pushed a commit
to stephen-crawford/security
that referenced
this pull request
[Nov 10, 2022](#ref-commit-0ce1e87)
[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied) [![@stephen-crawford](https://avatars.githubusercontent.com/u/65832608?s=40&v=4)](/stephen-crawford)

`[Update indices resolution to be clearer (](/stephen-crawford/security/commit/0ce1e877cda1e1a0800d1f2f1c92f0db11b92e42 "Update indices resolution to be clearer (#1999)

Signed-off-by: Stephen Crawford <steecraw@amazon.com>")[opensearch-project#1999](https://github.com/opensearch-project/security/pull/1999)[)](/stephen-crawford/security/commit/0ce1e877cda1e1a0800d1f2f1c92f0db11b92e42 "Update indices resolution to be clearer (#1999)

Signed-off-by: Stephen Crawford <steecraw@amazon.com>")`
…

`[0ce1e87](/stephen-crawford/security/commit/0ce1e877cda1e1a0800d1f2f1c92f0db11b92e42)`

```
Signed-off-by: Stephen Crawford <steecraw@amazon.com>
```

[wuychn](/wuychn)
pushed a commit
to ochprince/security
that referenced
this pull request
[Mar 16, 2023](#ref-commit-6008a29)
[![@opensearch-trigger-bot](https://avatars.githubusercontent.com/u/80134844?s=40&v=4)](/apps/opensearch-trigger-bot) [![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&u=5f7ef5cbdc96e821cd46764d380211393f7de7a9&v=4)](/peternied)

`[Update indices resolution to be clearer (](/ochprince/security/commit/6008a29f8e6a39265c1dbf6fc6a6b145ae4d1618 "Update indices resolution to be clearer (#1999) (#2002)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)

Co-authored-by: Peter Nied <petern@amazon.com>")[opensearch-project#1999](https://github.com/opensearch-project/security/pull/1999)[) (](/ochprince/security/commit/6008a29f8e6a39265c1dbf6fc6a6b145ae4d1618 "Update indices resolution to be clearer (#1999) (#2002)

(cherry picked from commit 42b936ef140fc143001c83fc03b6402d13ca4677)

Co-authored-by: Peter Nied <petern@amazon.com>")[op…](https://github.com/opensearch-project/security/pull/2002)`
…

`[6008a29](/ochprince/security/commit/6008a29f8e6a39265c1dbf6fc6a6b145ae4d1618)`

```
[…ensearch-project#2002](https://github.com/opensearch-project/security/pull/2002))

(cherry picked from commit [42b936e](https://github.com/ochprince/security/commit/42b936ef140fc143001c83fc03b6402d13ca4677))

Co-authored-by: Peter Nied <petern@amazon.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopensearch-project%2Fsecurity%2Fpull%2F1999)

Reviewers

[![@cliu123](https://avatars.githubusercontent.com/u/16925774?s=40&v=4)](/cliu123) [cliu123](/cliu123)

cliu123 approved these changes

[![@cwperks](https://avatars.githubusercontent.com/u/17432265?s=40&v=4)](/cwperks) [cwperks](/cwperks)

cwperks left review comments

Assignees

[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=40&v=4)](/peternied) [peternied](/peternied)

Labels

[backport 2.x](/opensearch-project/security/labels/backport%202.x)
backport to 2.x branch
[backport 2.2](/opensearch-project/security/labels/backport%202.2)
backport to 2.2

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@peternied](https://avatars.githubusercontent.com/u/2754967?s=52&v=4)](/peternied) [![@cliu123](https://avatars.githubusercontent.com/u/16925774?s=52&v=4)](/cliu123) [![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=52&v=4)](/codecov-commenter) [![@cwperks](https://avatars.githubusercontent.com/u/17432265?s=52&v=4)](/cwperks)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

