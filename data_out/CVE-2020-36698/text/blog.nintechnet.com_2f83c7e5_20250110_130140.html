
[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Multiple vulnerabilities fixed in Security and Malware Scan by CleanTalk plugin.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [July 6, 2020 - 12:45pm [+0700]July 6, 2020 - 12:47pm [+0700]](https://blog.nintechnet.com/multiple-vulnerabilities-fixed-in-security-malware-scan-by-cleantalk-plugin/)

The [Security & Malware Scan by CleanTalk](https://wordpress.org/plugins/security-malware-firewall/) plugin for WordPress (5,000+ active installations) fixed a vulnerability affecting version 2.50 and below that could allow any authenticated user to interact with all its AJAX actions.

### Security Nonce Leak

The plugin registers 40+ AJAX actions in the “security-malware-firewall/inc/spbc-admin.php” script. Most of them do not check the user capability but rely only on a security nonce populated in the `spbc_enqueue_scripts` function:

```
292   function spbc_enqueue_scripts($hook) {
293
294      global $spbc;
295
296      // For ALL admin pages
297      wp_enqueue_style ('spbc_admin_css', SPBC_PATH . '/css/spbc-admin.min.css', array(), SPBC_VERSION, 'all');
298
299      wp_enqueue_script('spbc-common-js', SPBC_PATH . '/js/spbc-common.min.js', array('jquery'), SPBC_VERSION, false);
300      wp_enqueue_script('spbc-admin-js',  SPBC_PATH . '/js/spbc-admin.min.js',  array('jquery'), SPBC_VERSION, false);
301
302      wp_localize_script('jquery', 'spbcSettings', array(
303         'wpms'         => (int)is_multisite(),
304         'is_main_site' => (int)is_main_site(),
305         'tc_enabled'   => $spbc->tc_enabled ? 1 : 0,
306         'img_path'     => SPBC_PATH . '/images',
307         'key_is_ok'    => $spbc->key_is_ok,
308         'ajax_nonce'   => wp_create_nonce("spbc_secret_nonce"),
309         'ajaxurl'      => admin_url('admin-ajax.php'),
310         'debug'        => !empty($debug) ? 1 : 0,
311      ));

```

The function is loaded by the `admin_enqueue_scripts` hook, i.e., each time someone accesses the backend, in the “security-malware-firewall/security-malware-firewall.php” script:

```
292   add_action('admin_enqueue_scripts', 'spbc_enqueue_scripts');

```

The nonce is therefore accessible to any logged-in user, including a subscriber, in the source of the HTML page:

![](https://blog.nintechnet.com/wp-content/uploads/2020/07/security-malware-scan-by-cleantalk-vulnerability_01.png)

An attacker could use it to interact with all AJAX actions, which could lead to multiple vulnerabilities from arbitrary file deletion and download to PHP function injection among other issues:

![](https://blog.nintechnet.com/wp-content/uploads/2020/07/security-malware-scan-by-cleantalk-vulnerability_02.png)

### Timeline

The vulnerability was reported to the authors on June 04th, 2020 and a new version 2.51 was released on June 30, 2020.

### Recommendations

Upgrade immediately if you have version 2.50 or below. If you are using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you are protected against this vulnerability.

Stay informed about the latest vulnerabilities in WordPress plugins and themes: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Multiple%20vulnerabilities%20fixed%20in%20Security%20and%20Malware%20Scan%20by%20CleanTalk%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-vulnerabilities-fixed-in-security-malware-scan-by-cleantalk-plugin%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-vulnerabilities-fixed-in-security-malware-scan-by-cleantalk-plugin%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Multiple%20vulnerabilities%20fixed%20in%20Security%20and%20Malware%20Scan%20by%20CleanTalk%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-vulnerabilities-fixed-in-security-malware-scan-by-cleantalk-plugin%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous WordPress KingComposer Page Builder fixed multiple critical vulnerabilities.](https://blog.nintechnet.com/wordpress-kingcomposer-page-builder-fixed-multiple-critical-vulnerabilities/)[Next Critical vulnerability in Adning Advertising plugin actively exploited in the wild.](https://blog.nintechnet.com/critical-vulnerability-in-adning-advertising-plugin-actively-exploited-in-the-wild/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)

