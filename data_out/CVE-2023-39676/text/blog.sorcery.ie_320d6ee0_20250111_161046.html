
[Skip to main content](#main)
# [Sorcery Blog](/)

[Sorcery Ltd](https://sorcery.ie "Sorcery Ltd")

# XSS in FieldPopupNewsletter Prestashop Module CVE-2023-39676

This blog post details an XSS we found within the FieldPopupNewsletter module, developed by [FieldThemes](https://themeforest.net/user/fieldthemes), for the popular ecommerce platform Prestashop.

The module contains a file called ajax.php with the following code:

```
$ppp = new FieldPopupNewsletter();
echo $ppp->newsletterRegistration($_POST['email']);

```

The newsletterRegistration function, called by the ajax.php file, contains code that lacks proper input validation:

```
public function newsletterRegistration($email) {
    if (empty($email) || !Validate::isEmail($email)) {
        echo $_GET['callback'] . '(' . json_encode(array('<p class="alert alert-danger">' . $this->l('Invalid email address.') . '</p>')) . ')';
        return;
    }

```

The callback GET parameter is printed to the page without sanitization which makes it susceptibvle to XSS. One might think the fact a POST parameter is used might mitigate this vulnerability but closer reading reveals this works when `$_POST['email']` isn’t set.

# Proof of Concept

As a demonstration of the vulnerability, an attacker can craft a malicious URL, like the one shown below, to execute arbitrary JavaScript code on the target user’s browser:

```
http://localhost/modules/fieldpopupnewsletter/ajax.php?callback=%3Cscript%3Ealert(0)%3C/script%3E

```
# Conclusion

XSS vulnerabilities are serious security risks that can lead to unauthorized access, data theft, and other malicious activities. In the case of the FieldPopupNewsletter module, a lack of input validation exposes users to potential attacks.

We strongly advise users of this module to update to the latest patched version, which should address the XSS vulnerability.

# Timeline

| Date | Action |
| --- | --- |
| 10/07/2023 | Issue discovered during a pentest |
| 12/07/2023 | Reported issue to FieldThemes |
| 29/07/2023 | Requested CVE from MITRE |
| 28/08/2023 | Number [CVE-2023-39676](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39676) assigned |
| 31/08/2023 | Patch released |
| 07/09/2023 | Blog post and [nuclei template](https://github.com/projectdiscovery/nuclei-templates/pull/8173) released |

[2023-09-07](/posts/fieldpopupnewsletter_xss/)

<https://blog.sorcery.ie/posts/fieldpopupnewsletter_xss/>
[Sorcery Ltd](https://blog.sorcery.ie/)

* [#Fieldpopupnewsletter](https://blog.sorcery.ie/tags/fieldpopupnewsletter/)
* [#Fieldthemes](https://blog.sorcery.ie/tags/fieldthemes/)
* [#Prestashop](https://blog.sorcery.ie/tags/prestashop/)
* [#Xss](https://blog.sorcery.ie/tags/xss/)
* [#CVE-2023-39676](https://blog.sorcery.ie/tags/cve-2023-39676/)

[SQLi in SimpleImportProduct Prestashop Module CVE-2023-39675](/posts/simpleimportproduct_sqli/)

[SQLi in XIPBlog Prestashop Module CVE-2023-27847](/posts/xipblog_sqli/)

© Sorcery Ltd, 2024

Powered by [Hugo](https://gohugo.io/), theme [Anubis](https://github.com/mitrichius/hugo-theme-anubis).

Dark theme

[Sorcery Ltd](https://blog.sorcery.ie/)

