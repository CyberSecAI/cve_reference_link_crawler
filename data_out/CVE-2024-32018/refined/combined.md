=== Content from seclists.org_4af27886_20250110_184219.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](6)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](8)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](8)

![](/shared/images/nst-icons.svg#search)

# HNS-2024-07 - HN Security Advisory - Multiple vulnerabilities in RIOT OS

---

*From*: Marco Ivaldi <raptor () 0xdeadbeef info>

*Date*: Tue, 7 May 2024 10:57:02 +0200

---

```
Hi,

Please find attached a security advisory that describes multiple
vulnerabilities we discovered in RIOT OS.

* Title: Multiple vulnerabilities in RIOT OS
* OS: RIOT <= 2024.01
* Author: Marco Ivaldi <marco.ivaldi () hnsecurity it>
* Date: 2024-05-07
* CVE ID and severity:
  * CVE-2024-31225 - High
  * CVE-2024-32017 - Critical
  * CVE-2024-32018 - High
  (low-severity vulnerabilities were not assigned a CVE ID)
* Vendor URL: <https://www.riot-os.org/>
* Advisory URLs:
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-2572-7q7c-3965>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-v97j-w9m6-c4h3>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-899m-q6pp-hmp3>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-x3j5-hfrr-5x6q>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-pw2r-pp35-xfmj>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-c4p4-vv7v-3hx8>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-r87w-9vw9-f7cx>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-2hx7-c324-3rxv>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-frp5-4gfp-84j3>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-x27v-gqp4-7jq3>

The advisory is also available at:
<https://github.com/hnsecurity/vulns/blob/main/HNS-2024-07-riot.txt>

For additional information, please refer to our vulnerability writeup:
<https://security.humanativaspa.it/multiple-vulnerabilities-in-riot-os/>

Regards,

--
Marco Ivaldi
<https://0xdeadbeef.info/>
"When cryptography is outlawed, bayl bhgynjf jvyy unir cevinpl."

```

**Attachment:
[HNS-2024-07-riot.txt](att-7/HNS-2024-07-riot.txt)**

*Description:*

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](6)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](8)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](8)

### Current thread:

* **HNS-2024-07 - HN Security Advisory - Multiple vulnerabilities in RIOT OS** *Marco Ivaldi (May 14)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.openwall.com_7d2efbe7_20250110_184219.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAM+3YVrhBBfX_9=q_otAJQi=cP0qcdXsc9qy7s1WNSa=aNGy3A@mail.gmail.com>
Date: Tue, 7 May 2024 10:57:02 +0200
From: Marco Ivaldi <raptor@...eadbeef.info>
To: fulldisclosure@...lists.org, oss-security@...ts.openwall.com,
	submissions@...ketstormsecurity.com
Subject: HNS-2024-07 - HN Security Advisory - Multiple vulnerabilities in RIOT OS

Hi,

Please find attached a security advisory that describes multiple
vulnerabilities we discovered in RIOT OS.

* Title: Multiple vulnerabilities in RIOT OS
* OS: RIOT <= 2024.01
* Author: Marco Ivaldi <marco.ivaldi@...ecurity.it>
* Date: 2024-05-07
* CVE ID and severity:
  * CVE-2024-31225 - High
  * CVE-2024-32017 - Critical
  * CVE-2024-32018 - High
  (low-severity vulnerabilities were not assigned a CVE ID)
* Vendor URL: <https://www.riot-os.org/>
* Advisory URLs:
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-2572-7q7c-3965>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-v97j-w9m6-c4h3>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-899m-q6pp-hmp3>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-x3j5-hfrr-5x6q>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-pw2r-pp35-xfmj>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-c4p4-vv7v-3hx8>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-r87w-9vw9-f7cx>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-2hx7-c324-3rxv>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-frp5-4gfp-84j3>
  * <https://github.com/RIOT-OS/RIOT/security/advisories/GHSA-x27v-gqp4-7jq3>

The advisory is also available at:
<https://github.com/hnsecurity/vulns/blob/main/HNS-2024-07-riot.txt>

For additional information, please refer to our vulnerability writeup:
<https://security.humanativaspa.it/multiple-vulnerabilities-in-riot-os/>

Regards,

--
Marco Ivaldi
<https://0xdeadbeef.info/>
"When cryptography is outlawed, bayl bhgynjf jvyy unir cevinpl."

View attachment "[HNS-2024-07-riot.txt](3/1)" of type "text/plain" (33540 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_7446d938_20250110_184220.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fsecurity%2Fadvisories%2FGHSA-899m-q6pp-hmp3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fsecurity%2Fadvisories%2FGHSA-899m-q6pp-hmp3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=RIOT-OS%2FRIOT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RIOT-OS](/RIOT-OS)
/
**[RIOT](/RIOT-OS/RIOT)**
Public

* [Notifications](/login?return_to=%2FRIOT-OS%2FRIOT) You must be signed in to change notification settings
* [Fork
  2k](/login?return_to=%2FRIOT-OS%2FRIOT)
* [Star
   5.4k](/login?return_to=%2FRIOT-OS%2FRIOT)

* [Code](/RIOT-OS/RIOT)
* [Issues
  382](/RIOT-OS/RIOT/issues)
* [Pull requests
  384](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects
  0](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

Additional navigation options

* [Code](/RIOT-OS/RIOT)
* [Issues](/RIOT-OS/RIOT/issues)
* [Pull requests](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

# Ineffective size check due to assert() and buffer overflow in RIOT /pkg/nimble/scanlist/nimble\_scanlist.c

High

[Teufelchen1](/Teufelchen1)
published
GHSA-899m-q6pp-hmp3
Apr 30, 2024

## Package

RIOT

## Affected versions

<= 2023.10

## Patched versions

None

## Description

### Summary

I spotted an ineffective size check implemented via `assert()` that may lead to a buffer overflow in RIOT source code at:

<https://github.com/RIOT-OS/RIOT/blob/master/pkg/nimble/scanlist/nimble_scanlist.c#L74-L87>

### Details

Most codebases define assertion macros which compile to a no-op on non-debug builds. If assertions are the only line of defense against untrusted input, the software may be exposed to attacks that leverage the lack of proper input checks. In detail, in the `nimble_scanlist_update()` function below, `len` is checked in an assertion and subsequently used in a call to `memcpy()`. If an attacker is able to provide a larger `len` value while assertions are compiled-out, they can write past the end of the fixed-length `e->ad` buffer.

Please refer to the marked lines below:

```
/**
 * @brief   Data structure for holding a single scanlist entry
 */
typedef struct {
    clist_node_t node;              /**< list node */
    ble_addr_t addr;                /**< a node's BLE address */
    uint8_t ad[BLE_ADV_PDU_LEN];    /**< the received raw advertising data */
    uint8_t ad_len;                 /**< length of the advertising data */
    int8_t last_rssi;               /**< last RSSI of a scanned node */
    uint32_t adv_msg_cnt;           /**< number of adv packets by a node */
    uint32_t first_update;          /**< first packet timestamp */
    uint32_t last_update;           /**< last packet timestamp */
    uint8_t type;                   /**< advertising packet type */
    uint8_t phy_pri;                /**< primary PHY used */
    uint8_t phy_sec;                /**< secondary PHY advertised */
} nimble_scanlist_entry_t;

...

void nimble_scanlist_update(uint8_t type, const ble_addr_t *addr,
                            const nimble_scanner_info_t *info,
                            const uint8_t *ad, size_t len)
{
    assert(addr);
    assert(len <= BLE_ADV_PDU_LEN); // VULN: len is checked to be <= BLE_ADV_PDU_LEN only via an assertion

    uint32_t now = (uint32_t)ztimer_now(ZTIMER_USEC);
    nimble_scanlist_entry_t *e = _find(addr);

    if (!e) {
        e = (nimble_scanlist_entry_t *)clist_lpop(&_pool);
        if (!e) {
            /* no space available, dropping newly discovered node */
            return;
        }
        memcpy(&e->addr, addr, sizeof(ble_addr_t));
        if (ad) {
            memcpy(e->ad, ad, len); // VULN: if len is actually larger than BLE_ADV_PDU_LEN there's a potential buffer overflow
        }
        e->ad_len = len;
        e->last_rssi = info->rssi;
        e->first_update = now;
        e->adv_msg_cnt = 1;
        e->type = type;
        e->phy_pri = info->phy_pri;
        e->phy_sec = info->phy_sec;
        clist_rpush(&_list, (clist_node_t *)e);
    }
    else {
        e->adv_msg_cnt++;
    }

    e->last_update = now;
}
```
### Impact

If the unchecked input above is attacker-controlled and crosses a security boundary, the impact of the buffer overflow vulnerability could range from denial of service to arbitrary code execution.

### Severity

High

### CVE ID

CVE-2024-32018

### Weaknesses

[CWE-120](/advisories?query=cwe%3A120)

### Credits

* [![@0xdea](https://avatars.githubusercontent.com/u/30093440?s=40&v=4)](/0xdea)
  [0xdea](/0xdea)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_71194cba_20250110_184220.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fblob%2Fmaster%2Fpkg%2Fnimble%2Fscanlist%2Fnimble_scanlist.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRIOT-OS%2FRIOT%2Fblob%2Fmaster%2Fpkg%2Fnimble%2Fscanlist%2Fnimble_scanlist.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=RIOT-OS%2FRIOT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RIOT-OS](/RIOT-OS)
/
**[RIOT](/RIOT-OS/RIOT)**
Public

* [Notifications](/login?return_to=%2FRIOT-OS%2FRIOT) You must be signed in to change notification settings
* [Fork
  2k](/login?return_to=%2FRIOT-OS%2FRIOT)
* [Star
   5.4k](/login?return_to=%2FRIOT-OS%2FRIOT)

* [Code](/RIOT-OS/RIOT)
* [Issues
  382](/RIOT-OS/RIOT/issues)
* [Pull requests
  384](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects
  0](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

Additional navigation options

* [Code](/RIOT-OS/RIOT)
* [Issues](/RIOT-OS/RIOT/issues)
* [Pull requests](/RIOT-OS/RIOT/pulls)
* [Actions](/RIOT-OS/RIOT/actions)
* [Projects](/RIOT-OS/RIOT/projects)
* [Wiki](/RIOT-OS/RIOT/wiki)
* [Security](/RIOT-OS/RIOT/security)
* [Insights](/RIOT-OS/RIOT/pulse)

## Files

 master
## Breadcrumbs

1. [RIOT](/RIOT-OS/RIOT/tree/master)
2. /[pkg](/RIOT-OS/RIOT/tree/master/pkg)
3. /[nimble](/RIOT-OS/RIOT/tree/master/pkg/nimble)
4. /[scanlist](/RIOT-OS/RIOT/tree/master/pkg/nimble/scanlist)
/
# nimble\_scanlist.c

Copy path Blame  Blame
## Latest commit

## History

[History](/RIOT-OS/RIOT/commits/master/pkg/nimble/scanlist/nimble_scanlist.c)141 lines (122 loc) · 3.34 KB master
## Breadcrumbs

1. [RIOT](/RIOT-OS/RIOT/tree/master)
2. /[pkg](/RIOT-OS/RIOT/tree/master/pkg)
3. /[nimble](/RIOT-OS/RIOT/tree/master/pkg/nimble)
4. /[scanlist](/RIOT-OS/RIOT/tree/master/pkg/nimble/scanlist)
/
# nimble\_scanlist.c

Top
## File metadata and controls

* Code
* Blame

141 lines (122 loc) · 3.34 KB[Raw](https://github.com/RIOT-OS/RIOT/raw/refs/heads/master/pkg/nimble/scanlist/nimble_scanlist.c)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141/\* \* Copyright (C) 2019 Freie Universität Berlin \* \* This file is subject to the terms and conditions of the GNU Lesser \* General Public License v2.1. See the file LICENSE in the top level \* directory for more details. \*/
/\*\* \* @ingroup pkg\_nimble\_scanlist \* @{ \* \* @file \* @brief Implementation of a list for NimBLE scan results \* \* @author Hauke Petersen <hauke.petersen@fu-berlin.de> \* \* @} \*/
#include <assert.h>#include <limits.h>
#include "ztimer.h"#include "net/bluetil/ad.h"
#include "nimble\_scanlist.h"
#define ENABLE\_DEBUG 0#include "debug.h"
static nimble\_scanlist\_entry\_t \_mem[NIMBLE\_SCANLIST\_SIZE];
static clist\_node\_t \_pool;static clist\_node\_t \_list;
static int \_finder(clist\_node\_t \*node, void \*arg){ const ble\_addr\_t \*addr = (const ble\_addr\_t \*)arg; nimble\_scanlist\_entry\_t \*e = (nimble\_scanlist\_entry\_t \*)node; if (ble\_addr\_cmp(&e->addr, addr) == 0) { return 1; } return 0;}
static nimble\_scanlist\_entry\_t \*\_find(const ble\_addr\_t \*addr){ return (nimble\_scanlist\_entry\_t \*)clist\_foreach(&\_list, \_finder, (void \*)addr);}
void nimble\_scanlist\_init(void){ for (unsigned i = 0; i < ARRAY\_SIZE(\_mem); i++) { clist\_rpush(&\_pool, &\_mem[i].node); }}
nimble\_scanlist\_entry\_t \*nimble\_scanlist\_get\_by\_pos(unsigned pos){ nimble\_scanlist\_entry\_t \*e = nimble\_scanlist\_get\_next(NULL); for (unsigned i = 0; (i < pos) && e; i++) { e = nimble\_scanlist\_get\_next(e); } return e;}
void nimble\_scanlist\_update(uint8\_t type, const ble\_addr\_t \*addr, const nimble\_scanner\_info\_t \*info, const uint8\_t \*ad, size\_t len){ assert(addr);
 /\* Ignore bogus advertisements \*/ if (len > BLE\_ADV\_PDU\_LEN) { assert(0); return; }
 uint32\_t now = (uint32\_t)ztimer\_now(ZTIMER\_USEC); nimble\_scanlist\_entry\_t \*e = \_find(addr);
 if (!e) { e = (nimble\_scanlist\_entry\_t \*)clist\_lpop(&\_pool); if (!e) { /\* no space available, dropping newly discovered node \*/ return; } memcpy(&e->addr, addr, sizeof(ble\_addr\_t)); if (ad) { memcpy(e->ad, ad, len); } e->ad\_len = len; e->last\_rssi = info->rssi; e->first\_update = now; e->adv\_msg\_cnt = 1; e->type = type; e->phy\_pri = info->phy\_pri; e->phy\_sec = info->phy\_sec; clist\_rpush(&\_list, (clist\_node\_t \*)e); } else { e->adv\_msg\_cnt++; }
 e->last\_update = now;}
nimble\_scanlist\_entry\_t \*nimble\_scanlist\_get\_next(nimble\_scanlist\_entry\_t \*e){ if (e == NULL) { return (nimble\_scanlist\_entry\_t \*)\_list.next; } else { e = (nimble\_scanlist\_entry\_t \*)e->node.next; if (e == (nimble\_scanlist\_entry\_t \*)\_list.next) { /\* end of list \*/ return NULL; } return e; }}
nimble\_scanlist\_entry\_t \*nimble\_scanlist\_get(unsigned pos){ nimble\_scanlist\_entry\_t \*cur = nimble\_scanlist\_get\_next(NULL); for (unsigned i = 0; i < pos; i++) { cur = nimble\_scanlist\_get\_next(cur); } return cur;}
void nimble\_scanlist\_clear(void){ clist\_node\_t \*node = clist\_lpop(&\_list); while (node) { clist\_rpush(&\_pool, node); node = clist\_lpop(&\_list); }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


