- **Root cause of vulnerability:** The FortiAuthenticator returns an HTML page when CSRF validation fails due to a referrer mismatch. This page displays the faulty referrer without proper sanitization.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS) vulnerability due to lack of proper sanitization of the referrer in the error page.
- **Impact of exploitation:** An attacker can inject malicious scripts into the error page, leading to the execution of unauthorized code or commands within the user's browser session.
- **Attack vectors:** The attack involves manipulating the referrer header such that it contains malicious script. This can occur if the attacker controls the referring website or if they can get a user to click on a crafted link.
- **Required attacker capabilities/position:** The attacker needs to manipulate the referrer sent in the HTTP header to inject malicious script, which then is reflected in the error page when CSRF validation fails.