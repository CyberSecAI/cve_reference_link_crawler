<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 2915 &ndash; SIGSEGV in ACL when message is second in that connection</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="https://bugs.exim.org/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=2915&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=2915">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=2915">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=2915">



    
    <link href="skins/standard/global.css"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css" rel="stylesheet"
        type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css" rel="stylesheet"
        type="text/css" ><link href="skins/standard/global.css" rel="stylesheet"
        type="text/css" ><link href="skins/standard/show_bug.css" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="skins/contrib/Dusk/global.css" rel="stylesheet"
        type="text/css" title="Dusk">

    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js"></script><script type="text/javascript" src="js/yui/connection/connection-min.js"></script><script type="text/javascript" src="js/yui/json/json-min.js"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js"></script><script type="text/javascript" src="js/global.js"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 2915 – SIGSEGV in ACL when message is second in that connection",  
                             "show_bug.cgi?id=2915" );
        document.title = "Bug 2915 – SIGSEGV in ACL when message is second in that connection";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 2915 – SIGSEGV in ACL when message is second in that connection", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js"></script><script type="text/javascript" src="js/field.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="bugs-exim-org bz_bug bz_status_RESOLVED bz_product_Exim bz_component_ACLs bz_bug_2915 yui-skin-sam">



<div id="header">
<div id="banner">
  </div>

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;2915</p>
    </td>

    <td id="subtitle">
      <p class="subheader">SIGSEGV in ACL when message is second in that connection</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2022-09-02 17:11:07 UTC</p>
    </td>
</tr>
</table>

<table id="lang_links_container" cellpadding="0" cellspacing="0"
       class="bz_default_hidden"><tr><td>
</td></tr></table>
<ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>

  <li>
        <span class="separator">| </span>
        <a href="docs/html/bug_page.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=2915&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  
  <form action="show_bug.cgi?id=2915" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_top"
        onsubmit="return check_mini_login_fields( '_top' );"
  >
    <input id="Bugzilla_login_top" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('_top')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_top" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
           onfocus="mini_login_on_focus('_top')"
    >
      <input type="checkbox" id="Bugzilla_remember_top" 
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_top');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_top');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
<li id="forgot_container_top">
  <span class="separator">| </span>
  <a id="forgot_link_top" href="show_bug.cgi?id=2915&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('_top')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form_top"
        class="mini_forgot bz_default_hidden">
    <label for="login_top">Login:</label>
    <input type="text" name="loginname" size="20" id="login_top">
    <input id="forgot_button_top" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1736339948-GK0BYUiXFBlQ8XaLjh9NBueBmo5tNDJ2BUKJMfn4iAo">
    <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
  </form>
</li>
</ul>
</div> 

<div id="bugzilla-body">

<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>
<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2022-09-02 17:11:07">
  <input type="hidden" name="longdesclength" value="20">
  <input type="hidden" name="id" value="2915">
  <input type="hidden" name="token" value="1736339948--Ct848xo1b3WMzC3qdanazzSTQWcTmbrcyNeYoas3Kk">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=2915"><b>Bug&nbsp;2915</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">SIGSEGV in ACL when message is second in that connection</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td>SIGSEGV in ACL when message is second in that connection
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('SIGSEGV in ACL when message is second in that connection', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Exim</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Exim"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >ACLs</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>4.95
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">x86-64
       Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>medium
       bug
      </td>
    </tr>

      <tr>
        <th class="field_label">
          <label for="target_milestone">
            <a href="page.cgi?id=fields.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </th><td>Exim 4.96
  </td>
      </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">Jeremy Harris</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">

    <label for="qa_contact" accesskey="q">

  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>
</label>
</th>
      <td><span class="vcard">
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'jgh146exb\x40wizmail.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
  
  
    <tr>
      <th class="field_label">
        <label for="keywords" accesskey="k">
          <a href="describekeywords.cgi"><u>K</u>eywords</a></label>:
      </th>
      <td class="field_value" colspan="2">
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=2915&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=2915">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2022-08-25 15:32 UTC by <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2022-09-02 17:11 UTC 
      (<a href="show_activity.cgi?id=2915">History</a>)
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>2 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="exim-dev">exim-dev</option>
                <option value="git">git</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr id="a0">
    <th colspan="2" align="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_x-gzip">
        <td valign="top">
            <a href="attachment.cgi?id=1428"
               title="View the content of the attachment">
          <b>debuglog extract</b></a>

          <span class="bz_attach_extra_info">
              (4.12 KB,
                application/x-gzip)

            <br>
            <a href="#attach_1428"
               title="Go to the comment associated with the attachment">2022-08-31 11:15 UTC</a>,

            <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1428&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=1429"
               title="View the content of the attachment">
          <b>rebased patch for 4.95</b></a>

          <span class="bz_attach_extra_info">
              (4.08 KB,
                patch)

            <br>
            <a href="#attach_1429"
               title="Go to the comment associated with the attachment">2022-09-01 16:12 UTC</a>,

            <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=1429&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=1429&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
        </span>
        <a href="attachment.cgi?bugid=2915&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=2915&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-25 15:32:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Tricky to describe this one, so bear with me...

Running the EPEL packaged exim-4.95-1 on CentOS 7.

Very complex ACL in place to extract email addresses from the message body and compare to a list of hashes in a file:

acl_mimeaddresses:
   warn set acl_m_lb_body = 
   warn condition = ${if match{$mime_content_type}{text}}
        mime_regex = \N(?s)([\w.+=-]+&#64;\w[\w-]*\.[\w.-]+\w)\
                       (.+?([\w.+=-]+&#64;\w[\w-]*\.[\w.-]+\w))?\
                       (.+?([\w.+=-]+&#64;\w[\w-]*\.[\w.-]+\w))?\
                       (.+?([\w.+=-]+&#64;\w[\w-]*\.[\w.-]+\w))?\
                       (.+?([\w.+=-]+&#64;\w[\w-]*\.[\w.-]+\w))?\N
        condition = ${if forany{$regex1 :$regex3 :$regex5 :$regex7 :$regex9}\
                               {eq{${acl{acl_emailaddresses}{$item}}}{caught}}}
        log_message = LBORO-LB2: email address in body $acl_m_ea in LB: $acl_m_LBdata \
                From: $header_From:, envelope-from $sender_address, \
                recipients=$recipients, Subject: $header_Subject:
        set acl_m_lb_body = 1
   accept

acl_emailaddresses:
   warn set acl_m_lbdata =
   accept condition = ${if eqi{$acl_arg1}{$sender_address}}
   accept condition = ${if eq{}\
		{${lookup dnsdb{defer_never,mxh=${domain:$acl_arg1}}}}}
          condition = ${if eq{}\
		{${lookup dnsdb{defer_never,a=${domain:$acl_arg1}}}}}

   warn   set acl_m_ea = ${sg{${lc:$acl_arg1}}{\\+.*&#64;}{&#64;}}
          condition    = ${if match{$acl_m_ea}{&#64;g(oogle)?mail.com}}
          set acl_m_ea = ${sg{${local_part:$acl_m_ea}}{\\.}{}}&#64;${domain:$acl_m_ea}

   warn   set acl_m_lbdata = ${lookup{${lc:${sha1:$acl_m_ea}}}lsearch{DPATH/lb-data.txt}}

   warn log_message = LBORO-LB-DEBUG: $acl_arg1/$acl_m_ea/${lc:${sha1:$acl_m_ea}}/$acl_m_lbdata

   accept condition = ${if !eq{}{$acl_m_lbdata}}
          message = caught

   accept

The first then called from the MIME ACL:

## LB check 
    require acl = acl_mimeaddresses

When an email arrives over a TLS connection from the Internet, this runs without issue. But for some hosts (yet to determine commonality) that send the final period, wait for the 'accepted' and then reuse the same connection for another message, the message flow stops at the 'require' clause with a SIGSEGV.

I've coerced Exim to dump core and collected a few (and then un-coerced it!) and that gives a consistent backtrace like this:

(gdb) bt
#0  __strlen_sse2_pminub ()
    at ../sysdeps/x86_64/multiarch/strlen-sse2-pminub.S:38
#1  0x000055b5ccbe03a3 in expand_string_internal (
    string=0x55b5ceb54bb4 &quot;$regex1 :$regex3 :$regex5 :$regex7 :$regex9}{eq{${acl{acl_emailaddresses}{$item}}}{caught}}}&quot;, ket_ends=ket_ends&#64;entry=1,
    left=left&#64;entry=0x7ffea817dec8, skipping=0,
    honour_dollar=honour_dollar&#64;entry=1,
    resetok_p=resetok_p&#64;entry=0x7ffea817e2cc) at expand.c:8113
#2  0x000055b5ccbe91e8 in eval_condition (
    s=0x55b5ceb54bb4 &quot;$regex1 :$regex3 :$regex5 :$regex7 :$regex9}{eq{${acl{acl_emailaddresses}{$item}}}{caught}}}&quot;,
    s&#64;entry=0x55b5ceb54bad &quot;forany{$regex1 :$regex3 :$regex5 :$regex7 :$regex9}{eq{${acl{acl_emailaddresses}{$item}}}{caught}}}&quot;,
    resetok=resetok&#64;entry=0x7ffea817e2cc, yield=yield&#64;entry=0x7ffea817e310)
    at expand.c:3302
#3  0x000055b5ccbe0c09 in expand_string_internal (
    string=0x55b5ceb54ba8 &quot;${if forany{$regex1 :$regex3 :$regex5 :$regex7 :$regex9}{eq{${acl{acl_emailaddresses}{$item}}}{caught}}}&quot;,
    ket_ends=ket_ends&#64;entry=0, left=left&#64;entry=0x0, skipping=skipping&#64;entry=0,
    honour_dollar=honour_dollar&#64;entry=1, resetok_p=resetok_p&#64;entry=0x0)
    at expand.c:4777
#4  0x000055b5ccbdf978 in expand_cstring (string=&lt;optimized out&gt;)
    at expand.c:8260
#5  0x000055b5ccbbecc1 in acl_check_internal (where=&lt;optimized out&gt;,
    addr=&lt;optimized out&gt;, s=&lt;optimized out&gt;, user_msgptr=&lt;optimized out&gt;,
    log_msgptr=&lt;optimized out&gt;) at acl.c:3022
#6  0x000055b5ccbbdadc in acl_check_internal (where=where&#64;entry=3,
    addr=addr&#64;entry=0x0, s=&lt;optimized out&gt;,
    user_msgptr=user_msgptr&#64;entry=0x7ffea817f230, log_msgptr=&lt;optimized out&gt;)
    at acl.c:4427
#7  0x000055b5ccbc0a4f in acl_check (where=where&#64;entry=3,
    recipient=recipient&#64;entry=0x0, s=s&#64;entry=0x55b5ceb48d50 &quot;acl_check_mime&quot;,
    user_msgptr=user_msgptr&#64;entry=0x7ffea817f230,
    log_msgptr=log_msgptr&#64;entry=0x7ffea817f238) at acl.c:4539
#8  0x000055b5ccc58be9 in mime_acl_check (
    acl=acl&#64;entry=0x55b5ceb48d50 &quot;acl_check_mime&quot;, f=f&#64;entry=0x55b5cee18710,
    context=context&#64;entry=0x7ffea817f0f0,
    user_msgptr=user_msgptr&#64;entry=0x7ffea817f230,
    log_msgptr=log_msgptr&#64;entry=0x7ffea817f238) at mime.c:721
#9  0x000055b5ccc58cdf in mime_acl_check (
    acl=acl&#64;entry=0x55b5ceb48d50 &quot;acl_check_mime&quot;, f=f&#64;entry=0x55b5cee18710,
    context=context&#64;entry=0x0, user_msgptr=user_msgptr&#64;entry=0x7ffea817f230,
    log_msgptr=log_msgptr&#64;entry=0x7ffea817f238) at mime.c:744
#10 0x000055b5ccbb01a8 in run_mime_acl (acl=0x55b5ceb48d50 &quot;acl_check_mime&quot;,
    smtp_yield_ptr=0x7ffea817f43c, smtp_reply_ptr=0x7ffea817f458,
    blackholed_by_ptr=0x7ffea817f448) at receive.c:1440
#11 0x000055b5ccc18fba in receive_msg (extract_recip=extract_recip&#64;entry=0)
    at receive.c:3516
#12 0x000055b5ccbc4c7a in handle_smtp_call (accepted=0x7ffea817f750,
    accept_socket=&lt;optimized out&gt;, listen_socket_count=&lt;optimized out&gt;,
    listen_sockets=0x55b5ceb46294) at daemon.c:553
#13 daemon_go () at daemon.c:2594
#14 0x000055b5ccbb7667 in main (argc=3, cargv=0x7ffea81c0148) at exim.c:4947

I have a feeling at this point that the internals of the various expansions are trying to access the memory that was allocated (and freed) by the first message rather than the second. That's probably wrong though, but whatever it is - it shouldn't be doing this!

Happy to provide more info if required.</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-25 15:33:56 UTC
        </span>
      </div>



<pre class="bz_comment_text" >And apologies for the typo in the various 'lbdata/LBdata' areas; they should all be lowercase - I was removing the identity of the lookup.</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jeremy Harris</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-29 09:12:44 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Not repro'd so far, using a 4.95 from git, so I assume there's some
data-dependent ACL processing flow branch involved.  You're probably right
about re-use of a freed item though.  I suspect I'd need more information
(which you have elided) in order to duplicate the flow.

You could try enabling the debug_store option, in case that gives any
more useful info.  You could use the control=debug/kill ACL modifier
to do speculative debug capture.</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jeremy Harris</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 10:35:50 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I suppose that we ought to check that
&quot;the EPEL packaged exim-4.95-1 on CentOS 7&quot;
is not materially different from the Exim Project git 4.95 .

Is the source available?</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 10:42:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Jeremy Harris from <a href="show_bug.cgi?id=2915#c2">comment #2</a>)
<span class="quote">&gt; Not repro'd so far, using a 4.95 from git, so I assume there's some
&gt; data-dependent ACL processing flow branch involved.  You're probably right
&gt; about re-use of a freed item though.  I suspect I'd need more information
&gt; (which you have elided) in order to duplicate the flow.
&gt; 
&gt; You could try enabling the debug_store option, in case that gives any
&gt; more useful info.  You could use the control=debug/kill ACL modifier
&gt; to do speculative debug capture.</span >

Happy to send you a complete core dump and corresponding config (if that helps), but not posting here for obvious reasons.

I did use the control=debug/kill modifier, which dumped a lot of info but once the SIGSEGV happens it simply stops altogether. Will see if I can find a corresponding debuglog and core file.</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jeremy Harris</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 10:56:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The important thing will be the processing sequence leading up to the
segv, so the debug is more useful than the stacktrace.  The nice thing
about speculative debug is that you can discard all the ones that get
past the crash point (eg. at data acl in the second message of the conn)
or will never get there (eg. in quit acl when there was no second message).</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 10:58:27 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Jeremy Harris from <a href="show_bug.cgi?id=2915#c3">comment #3</a>)
<span class="quote">&gt; I suppose that we ought to check that
&gt; &quot;the EPEL packaged exim-4.95-1 on CentOS 7&quot;
&gt; is not materially different from the Exim Project git 4.95 .
&gt; 
&gt; Is the source available?</span >

Currently available at <a href="https://www.lboro.ac.uk/bugdl/exim-4.95-1.el7.src.rpm">https://www.lboro.ac.uk/bugdl/exim-4.95-1.el7.src.rpm</a>

Will be removed later on.</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 11:15:17 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=1428" name="attach_1428" title="debuglog extract">attachment 1428</a> <a href="attachment.cgi?id=1428&amp;action=edit" title="debuglog extract">[details]</a></span>
debuglog extract

See attached (gently redacted, hopefully not so much that it isn't useful).

Two messages received in same connection; first one received OK and queued; second one crashes.

If that trace isn't useful then I can put the triggering config back in with debug_store enabled too.</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jeremy Harris</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 11:53:11 UTC
        </span>
      </div>



<pre class="bz_comment_text" >From that trace it's almost certainly one of the $regexN variables.

I'd expect debug_store to result in a panic- and main-log entry of the
form &quot;live variable '%s' destroyed by reset_store at %s:%d&quot;
- and that filename/line info will be invaluable.
We don't need more debug or cores, with that.</pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 12:46:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Lots, and lots of:

live variable 'regex&lt;n&gt;' destroyed by reset_store at smtp_reset:2162

with sporadic

live variable 'value' destroyed by reset_store at smtp_reset:2162

also. Both are copy/paste from the logs, no changes.</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Git Commit</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 16:27:11 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Git commit: <a href="https://git.exim.org/exim.git/commitdiff/4e9ed49f8f12eb331b29bd5b6dc3693c520fddc2">https://git.exim.org/exim.git/commitdiff/4e9ed49f8f12eb331b29bd5b6dc3693c520fddc2</a>

commit 4e9ed49f8f12eb331b29bd5b6dc3693c520fddc2
Author:     Jeremy Harris &lt;<a href="mailto:jgh146exb&#64;wizmail.org">jgh146exb&#64;wizmail.org</a>&gt;
AuthorDate: Wed Aug 31 15:37:40 2022 +0100
Commit:     Jeremy Harris &lt;<a href="mailto:jgh146exb&#64;wizmail.org">jgh146exb&#64;wizmail.org</a>&gt;
CommitDate: Wed Aug 31 15:57:29 2022 +0100

    fix $regex&lt;n&gt; use-after-free.  <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - SIGSEGV in ACL when message is second in that connection"
   href="show_bug.cgi?id=2915">bug 2915</a>
----
 doc/doc-txt/ChangeLog           |  8 +++++++-
 src/src/exim.c                  |  4 +---
 src/src/expand.c                |  2 +-
 src/src/functions.h             |  1 +
 src/src/globals.c               |  2 +-
 src/src/regex.c                 | 29 ++++++++++++++++++-----------
 src/src/smtp_in.c               |  2 ++
 test/confs/4002                 | 10 ++++++++++
 test/mail/4002.userx            |  7 +++++++
 test/scripts/4000-scanning/4002 |  7 +++++++
 10 files changed, 55 insertions(+), 17 deletions(-)</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 16:36:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Thanks Jeremy - patch applied cleanly to 4.95 source RPM, built fine, installed cleanly. Will run with the breaking config, debug_store etc and report back.</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 17:25:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Early news is: no segfaults, but

live variable 'regex&lt;n&gt;' destroyed by reset_store at smtp_reset:2162

is making an appearance after a single message has been accepted which tickles the regex-matching ACL.

The response to the final '.' is '250 OK id=1oTRIj-...' etc *but* we then have a '421 Unexpected failure, please try later' immediately after. I'm not yet sure where that occurs in the transaction but it does look like it's either in the closing stages of smtp_in.c or receive.c

Will have a dig.</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-08-31 17:27:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Graeme Fowler from <a href="show_bug.cgi?id=2915#c12">comment #12</a>)
<span class="quote">&gt; The response to the final '.' is '250 OK id=1oTRIj-...' etc *but* we then
&gt; have a '421 Unexpected failure, please try later' immediately after. I'm not
&gt; yet sure where that occurs in the transaction but it does look like it's
&gt; either in the closing stages of smtp_in.c or receive.c</span >

I think the likely candidate is line 615 in daemon.c, which follows a debug_print on 'Recipients:' which is the last debug out line prior to the LOG MAIN PANIC DIE moment.</pre>
    </div><div id="c14" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jeremy Harris</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-09-01 13:21:25 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The line number given in the log message is the same as before.
Are you certain the daemon is running with the patched code?</pre>
    </div><div id="c15" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-09-01 13:31:42 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Jeremy Harris from <a href="show_bug.cgi?id=2915#c14">comment #14</a>)
<span class="quote">&gt; The line number given in the log message is the same as before.
&gt; Are you certain the daemon is running with the patched code?</span >

Oh. That's rather silly of me; no it isn't as I need to rebase the patch against the 4.95 build tree that I've got.

Will do that and get back to you. Sorry!

Graeme</pre>
    </div><div id="c16" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-09-01 16:12:18 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=1429&amp;action=diff" name="attach_1429" title="rebased patch for 4.95">attachment 1429</a> <a href="attachment.cgi?id=1429&amp;action=edit" title="rebased patch for 4.95">[details]</a></span>
rebased patch for 4.95

Rebased and slightly amended patch which fixed:

regex.c:100:1: error: conflicting types for 'regex'
 regex(const uschar ** listptr, BOOL cacheable)
 ^
In file included from exim.h:538:0,
                 from regex.c:13:
functions.h:427:16: note: previous declaration of 'regex' was here
 extern int     regex(const uschar **);</pre>
    </div><div id="c17" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-09-01 16:12:53 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Now in and running with debug_store in place and breaking regex back in again.

Will collect some runtime and update later.</pre>
    </div><div id="c18" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Graeme Fowler</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-09-02 13:21:36 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Not a single mention of a live variable being destroyed. Thanks, Jeremy!

Graeme</pre>
    </div><div id="c19" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=2915#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jeremy Harris</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2022-09-02 17:11:07 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I assume that was long enough in test to have expected some,
so closing as fixed.  Thanks for the debug &amp; testing!</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=2915">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=2915">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=2915">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>

<br>
</div>



<div id="footer">
  <div class="intro"></div>




<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>

  <li>
        <span class="separator">| </span>
        <a href="docs/html/bug_page.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=2915&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  
  <form action="show_bug.cgi?id=2915" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_bottom"
        onsubmit="return check_mini_login_fields( '_bottom' );"
  >
    <input id="Bugzilla_login_bottom" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('_bottom')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_bottom" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_bottom" value="password"
           title="Password"
           onfocus="mini_login_on_focus('_bottom')"
    >
      <input type="checkbox" id="Bugzilla_remember_bottom" 
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_bottom">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_bottom');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_bottom');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
<li id="forgot_container_bottom">
  <span class="separator">| </span>
  <a id="forgot_link_bottom" href="show_bug.cgi?id=2915&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('_bottom')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form_bottom"
        class="mini_forgot bz_default_hidden">
    <label for="login_bottom">Login:</label>
    <input type="text" name="loginname" size="20" id="login_bottom">
    <input id="forgot_button_bottom" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_bottom" name="token" value="1736339948-GK0BYUiXFBlQ8XaLjh9NBueBmo5tNDJ2BUKJMfn4iAo">
    <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
  </form>
</li>
</ul>
  </li>

  
    


  
</ul>

  <div class="outro"></div>
</div>


</body>
</html>