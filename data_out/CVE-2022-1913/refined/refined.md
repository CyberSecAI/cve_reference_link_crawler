- **Root cause of vulnerability**: The WordPress plugin "Add Post URL" lacks CSRF (Cross-Site Request Forgery) protection when updating its settings. Additionally, it does not properly sanitize or escape user-supplied input when saving settings.
- **Weaknesses/vulnerabilities present**:
    - CSRF vulnerability: An attacker can induce a logged-in administrator to unknowingly submit a malicious settings update request.
    - Stored Cross-Site Scripting (XSS): Malicious JavaScript can be injected into plugin settings due to the lack of sanitization, and it will be executed when those settings are used to display content.
- **Impact of exploitation**: An attacker can execute arbitrary JavaScript code in the context of the administrator's browser. This can lead to various attacks such as account hijacking, redirection to malicious websites, or defacement.
- **Attack vectors**: The attack is executed via a crafted HTTP POST request. The attacker would typically host this malicious form on a site and trick an authenticated administrator into visiting it. Once the form is submitted while an admin is logged into the vulnerable site, the malicious settings will be applied.
- **Required attacker capabilities/position**: The attacker must trick a logged-in administrator of a vulnerable site into visiting a webpage under the attacker's control which contains the crafted form.