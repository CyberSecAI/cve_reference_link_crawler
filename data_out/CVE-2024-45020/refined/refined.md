Based on the provided information, this content relates to **CVE-2024-45020**.

**Root cause of vulnerability:**
The vulnerability stems from an out-of-bounds memory access within the `stacksafe()` function of the Linux kernel's BPF verifier. This occurs during the comparison of stack slot types between two BPF function states (`old` and `cur`).

**Weaknesses/vulnerabilities present:**
- **Out-of-bounds read:** The code iterates through the `old->allocated_stack`, but it does not properly check if the index `i` is within the bounds of `cur->allocated_stack` before accessing `cur->stack[spi].slot_type`. When `cur->allocated_stack` is smaller than `old->allocated_stack`, the access goes out of bounds, leading to a kernel crash.

**Impact of exploitation:**
- **Kernel crash:** The out-of-bounds read causes a kernel panic, leading to a denial of service (DoS).

**Attack vectors:**
- The vulnerability can be triggered by crafting a malicious BPF program that manipulates stack allocation to cause `cur->allocated_stack` to be smaller than `old->allocated_stack` during the verifier's state comparison within `stacksafe()`.
- It was discovered while using sched-ext, suggesting the vulnerability can be triggered through user-space interaction with the BPF subsystem.

**Required attacker capabilities/position:**
- The attacker needs the ability to load and execute BPF programs. This typically requires root privileges or specific capabilities.
- The attacker needs a certain level of understanding of how the BPF verifier works, as well as specific knowledge about the stack allocation used by sched-ext, in order to craft the exploit.