
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdmdhrumilmistry%2FCVEs%2Ftree%2Fmain%2FCVE-2024-22513)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdmdhrumilmistry%2FCVEs%2Ftree%2Fmain%2FCVE-2024-22513)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=dmdhrumilmistry%2FCVEs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dmdhrumilmistry](/dmdhrumilmistry)
/
**[CVEs](/dmdhrumilmistry/CVEs)**
Public

* [Notifications](/login?return_to=%2Fdmdhrumilmistry%2FCVEs) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fdmdhrumilmistry%2FCVEs)
* [Star
   1](/login?return_to=%2Fdmdhrumilmistry%2FCVEs)

* [Code](/dmdhrumilmistry/CVEs)
* [Issues
  0](/dmdhrumilmistry/CVEs/issues)
* [Pull requests
  0](/dmdhrumilmistry/CVEs/pulls)
* [Actions](/dmdhrumilmistry/CVEs/actions)
* [Projects
  0](/dmdhrumilmistry/CVEs/projects)
* [Security](/dmdhrumilmistry/CVEs/security)
* [Insights](/dmdhrumilmistry/CVEs/pulse)

Additional navigation options

* [Code](/dmdhrumilmistry/CVEs)
* [Issues](/dmdhrumilmistry/CVEs/issues)
* [Pull requests](/dmdhrumilmistry/CVEs/pulls)
* [Actions](/dmdhrumilmistry/CVEs/actions)
* [Projects](/dmdhrumilmistry/CVEs/projects)
* [Security](/dmdhrumilmistry/CVEs/security)
* [Insights](/dmdhrumilmistry/CVEs/pulse)

## Files

 main
## Breadcrumbs

1. [CVEs](/dmdhrumilmistry/CVEs/tree/main)
/
# CVE-2024-22513

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/dmdhrumilmistry/CVEs/commits/main/CVE-2024-22513) main
## Breadcrumbs

1. [CVEs](/dmdhrumilmistry/CVEs/tree/main)
/
# CVE-2024-22513

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/dmdhrumilmistry/CVEs/tree/main) | | |
| [README.md](/dmdhrumilmistry/CVEs/blob/main/CVE-2024-22513/README.md "README.md") | | [README.md](/dmdhrumilmistry/CVEs/blob/main/CVE-2024-22513/README.md "README.md") |  |  |
| View all files | | |

## [README.md](#readme)

# CVE-2024-22513

The version of [djangorestframework-simplejwt](https://github.com/jazzband/djangorestframework-simplejwt) up to 5.3.1 (latest version) may be vulnerable if not used correctly. This potential issue can lead to various security concerns, including Business Object Level Authorization (BOLA), Business Function Level Authorization (BFLA), and Information Disclosure. These concerns primarily arise if developers do not follow the library's documentation and fail to use the provided modules and classes correctly.

## Potential Misuse

If a programmer generates a JWT token for an inactive user using the `AccessToken` class and `for_user` method without the proper user validation provided by the Token Obtain Serializers, a JWT token can be returned and used for authentication across the Django Rest Framework application. However, that token can only be used to access web application resources if the programmer does not use the provided `JWTAuthentication` backend and instead writes their own custom authentication code without checking if the user account has been disabled.

* Start Django shell

```
python manage.py shell
```

* Create an inactive user and generate a token for the user without using the validation code provided by the library

```
from django.contrib.auth.models import User
from rest_framework_simplejwt.tokens import AccessToken

# create inactive user
inactive_user_id = User.objects.create_user('testuser', 'test@example.com', 'testPassw0rd!', is_active=False).id

# django application programmer generates token for the inactive user manually
AccessToken.for_user(User.objects.get(id=inactive_user_id))  # a warning could be raised since the user is inactive

# django application manually verifying user token
AccessToken.for_user(User.objects.get(id=inactive_user_id)).verify()  # a warning could be raised since the user is inactive
```

## Impact

The impact of improper usage varies from application to application and the custom code written.
The general concerns are that if a programmer doesn't use the modules and classes provided by the library to validates a user before generating a token and to authenticate the user using a token, then it could lead to:

* Bypass of Account Deactivation:
  Generating a JWT token for an inactive user without proper checks could allow an attacker to use this token for authentication, bypassing account deactivation.
* Authentication Bypass:
  An attacker could authenticate requests to the Django and Django Rest Framework applications using the token for an inactive user, leading to unauthorized access to protected resources.
* Authorization Issues:
  Without proper validation, an attacker with a token for an inactive user might access functionalities or data they shouldn't, causing Business Object Level Authorization (BOLA) issues.
* Information Disclosure:
  Authenticating as an inactive user could lead to information disclosure if certain resources or endpoints should only be accessible to active users.

## Mitigation

To prevent potential security risks, ensure you use one of the provided Token Obtain Serializers to generate tokens and the provided `JWTAuthentication` to authenticate the user. If you are writing custom serializers and authentication backends, ensure there is a thorough verification process to determine whether the user is active or not. This validation step is essential in preventing unauthorized access and helps mitigate the vulnerability associated with the lack of user inactivity validation in the mentioned functionality. Implementing this check adds an extra layer of security to your application.

```
from django.contrib.auth.models import User
from rest_framework_simplejwt.tokens import AccessToken

user = User.objects.get(id=inactive_user_id)

if user and user.is_active:
    token = AccessToken.for_user(user)
```

## Additional Information

A feature was introduced in a [Pull Request](https://github.com/jazzband/djangorestframework-simplejwt/pull/776) on the Django Rest Framework SimpleJWT GitHub repository, allowing the use of different subclasses of the `Token` class with the `for_user` method. However, this enhancement expands the potential attack surface if not used correctly.

Projects on [GitHub](https://github.com/search?q=%28%22RefreshToken.for_user%28%22+OR+%22AccessToken.for_user%28%22%29+language%3Apython&type=code&p=2) that utilize this functionality without proper user inactivity validation could pose a security risk, leading to unauthorized access if custom serializers and authentication backends are written.

The documentation does not currently provide security warnings about the potential risks associated with the new feature, which could lead developers to inadvertently expose their projects to security vulnerabilities if custom code that doesn't validate the user is written.

* <https://django-rest-framework-simplejwt.readthedocs.io/en/latest/rest_framework_simplejwt.html#module-rest_framework_simplejwt.tokens>
* <https://django-rest-framework-simplejwt.readthedocs.io/en/latest/rest_framework_simplejwt.html#rest_framework_simplejwt.tokens.Token.for_user>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

