

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=afd92d82c9d715fb97565408755acad81573591a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=afd92d82c9d715fb97565408755acad81573591a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=afd92d82c9d715fb97565408755acad81573591a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=afd92d82c9d715fb97565408755acad81573591a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jason Wang <jasowang@redhat.com> | 2021-09-17 16:34:06 +0800 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2021-09-19 12:10:26 +0100 |
| commit | [afd92d82c9d715fb97565408755acad81573591a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=afd92d82c9d715fb97565408755acad81573591a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=afd92d82c9d715fb97565408755acad81573591a)) | |
| tree | [4bce793d193f1e55ec265c6a8379adb65b1ad0a1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=afd92d82c9d715fb97565408755acad81573591a) | |
| parent | [3ede7f84c7c21f93c5eac611d60eba3f2c765e0f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3ede7f84c7c21f93c5eac611d60eba3f2c765e0f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=afd92d82c9d715fb97565408755acad81573591a&id2=3ede7f84c7c21f93c5eac611d60eba3f2c765e0f)) | |
| download | [linux-afd92d82c9d715fb97565408755acad81573591a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-afd92d82c9d715fb97565408755acad81573591a.tar.gz) | |

virtio-net: fix pages leaking when building skb in big modeWe try to use build\_skb() if we had sufficient tailroom. But we forget
to release the unused pages chained via private in big mode which will
leak pages. Fixing this by release the pages after building the skb in
big mode.
Cc: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Fixes: fb32856b16ad ("virtio-net: page\_to\_skb() use build\_skb when there's sufficient tailroom")
Signed-off-by: Jason Wang <jasowang@redhat.com>
Reviewed-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=afd92d82c9d715fb97565408755acad81573591a)

| -rw-r--r-- | [drivers/net/virtio\_net.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/virtio_net.c?id=afd92d82c9d715fb97565408755acad81573591a) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/drivers/net/virtio\_net.c b/drivers/net/virtio\_net.cindex 271d38c1d9f806..79bd2585ec6b2d 100644--- a/[drivers/net/virtio\_net.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/virtio_net.c?id=3ede7f84c7c21f93c5eac611d60eba3f2c765e0f)+++ b/[drivers/net/virtio\_net.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/virtio_net.c?id=afd92d82c9d715fb97565408755acad81573591a)@@ -423,6 +423,10 @@ static struct sk\_buff \*page\_to\_skb(struct virtnet\_info \*vi,  skb\_reserve(skb, p - buf); skb\_put(skb, len);++ page = (struct page \*)page->private;+ if (page)+ give\_pages(rq, page); goto ok; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:31:59 +0000

