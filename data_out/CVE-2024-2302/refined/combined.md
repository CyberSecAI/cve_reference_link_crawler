=== Content from www.wordfence.com_2fea9b84_20250110_183032.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Easy Digital Downloads – Sell Digital Files & Subscriptions (eCommerce Store + Payments Made Easy) <= 3.2.9 - Sensitive Information Exposure

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Easy Digital Downloads – Sell Digital Files & Subscriptions (eCommerce Store + Payments Made Easy) <= 3.2.9 - Sensitive Information Exposure

5.3

**Insertion of Sensitive Information into Log File**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

| CVE | [CVE-2024-2302](https://www.cve.org/CVERecord?id=CVE-2024-2302) |
| --- | --- |
| CVSS | 5.3 (Medium) |
| Publicly Published | April 3, 2024 |
| Last Updated | April 9, 2024 |
| Researcher | [Colin Xu](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/colin-xu) |

### Description

The Easy Digital Downloads – Sell Digital Files & Subscriptions (eCommerce Store + Payments Made Easy) plugin for WordPress is vulnerable to Sensitive Information Exposure in all versions up to, and including, 3.2.9. This makes it possible for unauthenticated attackers to download the debug log via Directory Listing. This file may include PII.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/easy-digital-downloads/trunk/includes/class-edd-logging.php#L621)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3060808%40easy-digital-downloads%2Ftrunk&old=3042139%40easy-digital-downloads%2Ftrunk&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Feasy-digital-downloads%2Feasy-digital-downloads-sell-digital-files-subscriptions-ecommerce-store-payments-made-easy-329-sensitive-information-exposure&t=Easy%20Digital%20Downloads%20%E2%80%93%20Sell%20Digital%20Files%20%26%20Subscriptions%20%28eCommerce%20Store%20%2B%20Payments%20Made%20Easy%29%20%3C%3D%203.2.9%20-%20Sensitive%20Information%20Exposure "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Feasy-digital-downloads%2Feasy-digital-downloads-sell-digital-files-subscriptions-ecommerce-store-payments-made-easy-329-sensitive-information-exposure&text=Easy%20Digital%20Downloads%20%E2%80%93%20Sell%20Digital%20Files%20%26%20Subscriptions%20%28eCommerce%20Store%20%2B%20Payments%20Made%20Easy%29%20%3C%3D%203.2.9%20-%20Sensitive%20Information%20Exposure "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Feasy-digital-downloads%2Feasy-digital-downloads-sell-digital-files-subscriptions-ecommerce-store-payments-made-easy-329-sensitive-information-exposure "LinkedIn")
Email

## Vulnerability Details for Easy Digital Downloads – eCommerce Payments and Subscriptions made easy

#### [Easy Digital Downloads – eCommerce Payments and Subscriptions made easy](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/easy-digital-downloads)

| Software Type | Plugin |
| --- | --- |
| Software Slug | easy-digital-downloads [(view on wordpress.org)](https://wordpress.org/plugins/easy-digital-downloads) |
| Patched? | Yes |
| Remediation | Update to version 3.2.10, or a newer patched version |
| Affected Version | * <= 3.2.9 |
| Patched Version | * 3.2.10 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_32a6f416_20250110_183030.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3060808%2540easy-digital-downloads%252Ftrunk%26old%3D3042139%2540easy-digital-downloads%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3042139/easy-digital-downloads/trunk?old=3060808&old_path=%2Feasy-digital-downloads%2Ftrunk)

---

# Changes in [easy-digital-downloads/trunk](/browser/easy-digital-downloads/trunk?rev=3060808 "Show entry in browser") [[3042139:3060808]](/log/easy-digital-downloads/trunk?rev=3060808&stop_rev=3042139 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[easy-digital-downloads/trunk](/browser/easy-digital-downloads/trunk?rev=3060808)
Files:

10 added
3 deleted
27 edited

* [easy-digital-downloads.php](/browser/easy-digital-downloads/trunk/easy-digital-downloads.php?rev=3060808 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [includes/admin/upgrades/v3/class-data-migrator.php](/browser/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?rev=3060808 "Show entry in browser")
  (modified)
  ([4 diffs](#file1 "Show differences"))
* [includes/admin/upload-functions.php](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=3060808 "Show entry in browser")
  (modified)
  ([5 diffs](#file2 "Show differences"))
* [includes/blocks/includes/orders/orders.php](/browser/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?rev=3060808 "Show entry in browser")
  (modified)
  ([4 diffs](#file3 "Show differences"))
* [includes/blocks/includes/styles.php](/browser/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?rev=3060808 "Show entry in browser")
  (modified)
  ([4 diffs](#file4 "Show differences"))
* [includes/checkout/template.php](/browser/easy-digital-downloads/trunk/includes/checkout/template.php?rev=3060808 "Show entry in browser")
  (modified)
  ([4 diffs](#file5 "Show differences"))
* [includes/class-easy-digital-downloads.php](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3060808 "Show entry in browser")
  (modified)
  ([5 diffs](#file6 "Show differences"))
* [includes/class-edd-db-customer-meta.php](/browser/easy-digital-downloads/trunk/includes/class-edd-db-customer-meta.php?rev=2756001 "Show what was removed (content at revision 3042139)")
  (deleted)
* [includes/class-edd-db-customers.php](/browser/easy-digital-downloads/trunk/includes/class-edd-db-customers.php?rev=2756001 "Show what was removed (content at revision 3042139)")
  (deleted)
* [includes/class-edd-logging.php](/browser/easy-digital-downloads/trunk/includes/class-edd-logging.php?rev=2795412 "Show what was removed (content at revision 3042139)")
  (deleted)
* [includes/database/queries/class-adjustment.php](/browser/easy-digital-downloads/trunk/includes/database/queries/class-adjustment.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [includes/date-functions.php](/browser/easy-digital-downloads/trunk/includes/date-functions.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [includes/deprecated/classes.php](/browser/easy-digital-downloads/trunk/includes/deprecated/classes.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [includes/discount-functions.php](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808 "Show entry in browser")
  (modified)
  ([37 diffs](#file13 "Show differences"))
* [includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808 "Show entry in browser")
  (modified)
  ([11 diffs](#file14 "Show differences"))
* [includes/logs/functions.php](/browser/easy-digital-downloads/trunk/includes/logs/functions.php?rev=3060808 "Show entry in browser")
  (added)
* [includes/orders/functions/actions.php](/browser/easy-digital-downloads/trunk/includes/orders/functions/actions.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file16 "Show differences"))
* [includes/shortcodes.php](/browser/easy-digital-downloads/trunk/includes/shortcodes.php?rev=3060808 "Show entry in browser")
  (modified)
  ([3 diffs](#file17 "Show differences"))
* [includes/upgrades/functions.php](/browser/easy-digital-downloads/trunk/includes/upgrades/functions.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file18 "Show differences"))
* [languages/easy-digital-downloads.pot](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808 "Show entry in browser")
  (modified)
  ([29 diffs](#file19 "Show differences"))
* [readme.txt](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808 "Show entry in browser")
  (modified)
  ([10 diffs](#file20 "Show differences"))
* [src/Core.php](/browser/easy-digital-downloads/trunk/src/Core.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [src/Deprecated](/browser/easy-digital-downloads/trunk/src/Deprecated?rev=3060808 "Show entry in browser")
  (added)
* [src/Deprecated/EmptyClass.php](/browser/easy-digital-downloads/trunk/src/Deprecated/EmptyClass.php?rev=3060808 "Show entry in browser")
  (added)
* [src/Emails/Types/Email.php](/browser/easy-digital-downloads/trunk/src/Emails/Types/Email.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file24 "Show differences"))
* [src/Extensions/Updater.php](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808 "Show entry in browser")
  (modified)
  ([17 diffs](#file25 "Show differences"))
* [src/HTML/Base.php](/browser/easy-digital-downloads/trunk/src/HTML/Base.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file26 "Show differences"))
* [src/HTML/Checkbox.php](/browser/easy-digital-downloads/trunk/src/HTML/Checkbox.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file27 "Show differences"))
* [src/HTML/ProductSelect.php](/browser/easy-digital-downloads/trunk/src/HTML/ProductSelect.php?rev=3060808 "Show entry in browser")
  (modified)
  ([3 diffs](#file28 "Show differences"))
* [src/HTML/Select.php](/browser/easy-digital-downloads/trunk/src/HTML/Select.php?rev=3060808 "Show entry in browser")
  (modified)
  ([4 diffs](#file29 "Show differences"))
* [src/HTML/Textarea.php](/browser/easy-digital-downloads/trunk/src/HTML/Textarea.php?rev=3060808 "Show entry in browser")
  (modified)
  ([1 diff](#file30 "Show differences"))
* [src/Logging.php](/browser/easy-digital-downloads/trunk/src/Logging.php?rev=3060808 "Show entry in browser")
  (added)
* [src/Telemetry/Products.php](/browser/easy-digital-downloads/trunk/src/Telemetry/Products.php?rev=3060808 "Show entry in browser")
  (modified)
  ([2 diffs](#file32 "Show differences"))
* [src/Telemetry/Stats.php](/browser/easy-digital-downloads/trunk/src/Telemetry/Stats.php?rev=3060808 "Show entry in browser")
  (modified)
  ([2 diffs](#file33 "Show differences"))
* [src/Upgrades/Adjustments](/browser/easy-digital-downloads/trunk/src/Upgrades/Adjustments?rev=3060808 "Show entry in browser")
  (added)
* [src/Upgrades/Adjustments/DiscountsStartEnd.php](/browser/easy-digital-downloads/trunk/src/Upgrades/Adjustments/DiscountsStartEnd.php?rev=3060808 "Show entry in browser")
  (added)
* [src/Upgrades/Loader.php](/browser/easy-digital-downloads/trunk/src/Upgrades/Loader.php?rev=3060808 "Show entry in browser")
  (added)
* [src/Utils/Data](/browser/easy-digital-downloads/trunk/src/Utils/Data?rev=3060808 "Show entry in browser")
  (added)
* [src/Utils/Data/Serializer.php](/browser/easy-digital-downloads/trunk/src/Utils/Data/Serializer.php?rev=3060808 "Show entry in browser")
  (added)
* [src/Utils/FileSystem.php](/browser/easy-digital-downloads/trunk/src/Utils/FileSystem.php?rev=3060808 "Show entry in browser")
  (added)

### Legend:

Unmodified
Added
Removed

* ## [easy-digital-downloads/trunk/easy-digital-downloads.php](/changeset/3060808/easy-digital-downloads/trunk/easy-digital-downloads.php?old=3042139&old_path=easy-digital-downloads%2Ftrunk%2Feasy-digital-downloads.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/easy-digital-downloads.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/easy-digital-downloads.php?rev=3042139#L6 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/easy-digital-downloads.php?rev=3060808#L6 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | \* Author: Easy Digital Downloads |
  | 7 | 7 | \* Author URI: https://easydigitaldownloads.com |
  | 8 |  | \* Version: 3.2.~~9~~ |
  |  | 8 | \* Version: 3.2.10 |
  | 9 | 9 | \* Text Domain: easy-digital-downloads |
  | 10 | 10 | \* Domain Path: /languages |
  | […](/browser/easy-digital-downloads/trunk/easy-digital-downloads.php?rev=3042139#L28) | […](/browser/easy-digital-downloads/trunk/easy-digital-downloads.php?rev=3060808#L28) |  |
  | 28 | 28 | \* @category Core |
  | 29 | 29 | \* @author Easy Digital Downloads |
  | 30 |  | \* @version 3.2.~~9~~ |
  |  | 30 | \* @version 3.2.10 |
  | 31 | 31 | \*/ |
  | 32 | 32 |  |
* ## [easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php](/changeset/3060808/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?old=2969966&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fadmin%2Fupgrades%2Fv3%2Fclass-data-migrator.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?rev=2969966#L8 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?rev=3060808#L8 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* @since       3.0 |
  | 9 | 9 | \*/ |
  |  | 10 |  |
  | 10 | 11 | namespace EDD\Admin\Upgrades\v3; |
  | 11 | 12 |  |
  | 12 |  | // Exit if accessed directly |
  | 13 |  | defined( 'ABSPATH' ) || exit; |
  |  | 13 | // Exit if accessed directly. |
  |  | 14 | defined( 'ABSPATH' ) || exit; // @codeCoverageIgnore |
  |  | 15 |  |
  |  | 16 | use EDD\Utils\Data\Serializer; |
  | 14 | 17 |  |
  | 15 | 18 | /\*\* |
  | […](/browser/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?rev=2969966#L430) | […](/browser/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?rev=3060808#L433) |  |
  | 430 | 433 | } |
  | 431 | 434 |  |
  |  | 435 | /\*\* |
  |  | 436 | \* Orders. |
  |  | 437 | \* |
  |  | 438 | \* @since 3.0 |
  |  | 439 | \* @param object $data Data to migrate. |
  |  | 440 | \*/ |
  | 432 | 441 | public static function orders( $data = null ) { |
  | 433 | 442 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?rev=2969966#L437) | […](/browser/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?rev=3060808#L446) |  |
  | 437 | 446 | } |
  | 438 | 447 |  |
  | 439 |  | /\*\* Create a new order \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
  | 440 |  | global $wpdb; |
  | 441 |  |  |
  | 442 |  | // Get's all the post meta for this payment. |
  |  | 448 | // Gets all the post meta for this payment. |
  | 443 | 449 | $meta = get\_post\_custom( $data->ID ); |
  | 444 | 450 |  |
  | 445 |  | $payment\_meta = maybe\_unserialize( $meta['\_edd\_payment\_meta'][0] ); |
  |  | 451 | $payment\_meta = Serializer::maybe\_unserialize( $meta['\_edd\_payment\_meta'][0] ); |
  | 446 | 452 | $user\_info    = isset( $payment\_meta['user\_info'] ) ? maybe\_unserialize( $payment\_meta['user\_info'] ) : array(); |
  | 447 | 453 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?rev=2969966#L1574) | […](/browser/easy-digital-downloads/trunk/includes/admin/upgrades/v3/class-data-migrator.php?rev=3060808#L1580) |  |
  | 1574 | 1580 | \* |
  | 1575 | 1581 | \* @since 3.0.0 |
  | 1576 |  | \* |
  | 1577 |  | \* @param $data |
  | 1578 |  | \* |
  |  | 1582 | \* @param mixed $data The data to fix. |
  | 1579 | 1583 | \* @return mixed |
  | 1580 | 1584 | \*/ |
  | 1581 | 1585 | public static function fix\_possible\_serialization( $data ) { |
  | 1582 |  | if ( ! is\_array( $data ) && is\_string( $data ) ) { |
  | 1583 |  | $data = substr\_replace( $data, 'a', 0, 1 ); |
  | 1584 |  | } |
  | 1585 |  |  |
  | 1586 |  | return $data; |
  |  | 1586 | return Serializer::fix\_possible\_serialization( $data ); |
  | 1587 | 1587 | } |
  | 1588 | 1588 | } |
* ## [easy-digital-downloads/trunk/includes/admin/upload-functions.php](/changeset/3060808/easy-digital-downloads/trunk/includes/admin/upload-functions.php?old=2756001&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fadmin%2Fupload-functions.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/admin/upload-functions.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=2756001#L10 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=3060808#L10 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \*/ |
  | 11 | 11 |  |
  | 12 |  | // Exit if accessed directly |
  | 13 |  | defined( 'ABSPATH' ) || exit; |
  |  | 12 | // Exit if accessed directly. |
  |  | 13 | defined( 'ABSPATH' ) || exit; // @codeCoverageIgnore |
  | 14 | 14 |  |
  | 15 | 15 | /\*\* |
  | […](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=2756001#L23) | […](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=3060808#L23) |  |
  | 23 | 23 | \* |
  | 24 | 24 | \* @since 1.0 |
  | 25 |  | \* @global $pagenow |
  |  | 25 | \* @since 3.2.10 The function hooks into the wp\_handle\_upload\_prefilter action. |
  |  | 26 | \* @param array $file |
  | 26 | 27 | \* @return void |
  | 27 | 28 | \*/ |
  | 28 |  | function edd\_change\_downloads\_upload\_dir() { |
  | 29 |  | global $pagenow; |
  |  | 29 | function edd\_change\_downloads\_upload\_dir( $file = array() ) { |
  |  | 30 | if ( empty( $\_REQUEST['post\_id'] ) ) { |
  |  | 31 | return $file; |
  |  | 32 | } |
  |  | 33 | if ( 'download' === get\_post\_type( $\_REQUEST['post\_id'] ) ) { |
  |  | 34 | delete\_transient( 'edd\_check\_protection\_files' ); |
  |  | 35 | add\_filter( 'upload\_dir', 'edd\_set\_upload\_dir' ); |
  |  | 36 | } |
  | 30 | 37 |  |
  | 31 |  | if ( ! empty( $\_REQUEST['post\_id'] ) && ( 'async-upload.php' == $pagenow || 'media-upload.php' == $pagenow ) ) { |
  | 32 |  | if ( 'download' == get\_post\_type( $\_REQUEST['post\_id'] ) ) { |
  | 33 |  | edd\_create\_protection\_files( true ); |
  | 34 |  | add\_filter( 'upload\_dir', 'edd\_set\_upload\_dir' ); |
  | 35 |  | } |
  | 36 |  | } |
  |  | 38 | return $file; |
  | 37 | 39 | } |
  | 38 |  | add\_action( 'admin\_init', 'edd\_change\_downloads\_upload\_dir', 999 ); |
  | 39 |  |  |
  |  | 40 | add\_filter( 'wp\_handle\_upload\_prefilter', 'edd\_change\_downloads\_upload\_dir', 5 ); |
  | 40 | 41 |  |
  | 41 | 42 | /\*\* |
  | […](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=2756001#L47) | […](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=3060808#L48) |  |
  | 47 | 48 | \* @since 1.1.5 |
  | 48 | 49 | \* |
  | 49 |  | \* @param bool $force |
  | 50 |  | \* @param bool $method |
  |  | 50 | \* @param bool $force  Whether to force the creation of the protection files. |
  |  | 51 | \* @param bool $method The method used to download files. |
  | 51 | 52 | \*/ |
  | 52 | 53 | function edd\_create\_protection\_files( $force = false, $method = false ) { |
  |  | 54 | $file\_system = EDD\Utils\FileSystem::get\_fs(); |
  | 53 | 55 | if ( false === get\_transient( 'edd\_check\_protection\_files' ) || $force ) { |
  | 54 | 56 |  |
  | 55 | 57 | $upload\_path = edd\_get\_upload\_dir(); |
  | 56 | 58 |  |
  | 57 |  | // Top level .htaccess file |
  |  | 59 | // Check if the main upload path is writable. |
  |  | 60 | $upload\_path\_writeable = wp\_is\_writable( $upload\_path ); |
  |  | 61 |  |
  |  | 62 | // Top level .htaccess file. |
  | 58 | 63 | $rules = edd\_get\_htaccess\_rules( $method ); |
  | 59 | 64 | if ( edd\_htaccess\_exists() ) { |
  | 60 |  | $contents = ~~@file\_~~get\_contents( $upload\_path . '/.htaccess' ); |
  |  | 65 | $contents = $file\_system->get\_contents( $upload\_path . '/.htaccess' ); |
  | 61 | 66 | if ( $contents !== $rules || ! $contents ) { |
  | 62 |  | // Update the .htaccess rules if they don't match |
  | 63 |  | ~~@file\_~~put\_contents( $upload\_path . '/.htaccess', $rules ); |
  |  | 67 | // Update the .htaccess rules if they don't match. |
  |  | 68 | $file\_system->put\_contents( $upload\_path . '/.htaccess', $rules ); |
  | 64 | 69 | } |
  | 65 |  | } elseif ( ~~wp\_is\_writable( $upload\_path )~~ ) { |
  | 66 |  | // Create the file if it doesn't exist |
  | 67 |  | ~~@file\_~~put\_contents( $upload\_path . '/.htaccess', $rules ); |
  |  | 70 | } elseif ( $upload\_path\_writeable ) { |
  |  | 71 | // Create the file if it doesn't exist. |
  |  | 72 | $file\_system->put\_contents( $upload\_path . '/.htaccess', $rules ); |
  | 68 | 73 | } |
  | 69 | 74 |  |
  | 70 |  | // Top level blank index.php |
  | 71 |  | if ( ~~! file\_exists( $upload\_path . '/index.php' ) && wp\_is\_writable( $upload\_path~~ ) ) { |
  | 72 |  | ~~@file\_~~put\_contents( $upload\_path . '/index.php', '<?php' . PHP\_EOL . '// Silence is golden.' ); |
  |  | 75 | // Top level blank index.php. |
  |  | 76 | if ( $upload\_path\_writeable && ! file\_exists( $upload\_path . '/index.php' ) ) { |
  |  | 77 | $file\_system->put\_contents( $upload\_path . '/index.php', '<?php' . PHP\_EOL . '// Silence is golden.' ); |
  | 73 | 78 | } |
  | 74 | 79 |  |
  | 75 |  | // Now place index.php files in all sub folders |
  |  | 80 | if ( $upload\_path\_writeable && ! file\_exists( $upload\_path . '/index.html' ) ) { |
  |  | 81 | $file\_system->put\_contents( $upload\_path . '/index.html', '' ); |
  |  | 82 | } |
  |  | 83 |  |
  |  | 84 | // Now place index.php files in all sub folders. |
  | 76 | 85 | $folders = edd\_scan\_folders( $upload\_path ); |
  | 77 | 86 | foreach ( $folders as $folder ) { |
  | 78 |  | // Create index.php, if it doesn't exist |
  | 79 |  | if ( ! file\_exists( $folder . 'index.php' ) && wp\_is\_writable( $folder ) ) { |
  | 80 |  | @file\_put\_contents( $folder . 'index.php', '<?php' . PHP\_EOL . '// Silence is golden.' ); |
  |  | 87 | // Continue if the folder is not writable. |
  |  | 88 | if ( ! wp\_is\_writable( $folder ) ) { |
  |  | 89 | continue; |
  |  | 90 | } |
  |  | 91 |  |
  |  | 92 | // Create index.php, if it doesn't exist. |
  |  | 93 | if ( ! file\_exists( $folder . 'index.php' ) ) { |
  |  | 94 | $file\_system->put\_contents( $folder . 'index.php', '<?php' . PHP\_EOL . '// Silence is golden.' ); |
  |  | 95 | } |
  |  | 96 |  |
  |  | 97 | if ( ! file\_exists( $folder . 'index.html' ) ) { |
  |  | 98 | $file\_system->put\_contents( $folder . 'index.html', '' ); |
  | 81 | 99 | } |
  | 82 | 100 | } |
  | 83 | 101 |  |
  | 84 |  | // Check for the files once per day |
  |  | 102 | // Check for the files once per day. |
  | 85 | 103 | set\_transient( 'edd\_check\_protection\_files', true, DAY\_IN\_SECONDS ); |
  | 86 | 104 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=2756001#L104) | […](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=3060808#L122) |  |
  | 104 | 122 | \* |
  | 105 | 123 | \* @since 1.1.5 |
  |  | 124 | \* @since 3.2.10 Switched to using glob() for better performance and accuracy. |
  | 106 | 125 | \* |
  | 107 |  | \* @param string $path   Path to scan |
  | 108 |  | \* @param array  $return Results of previous recursion |
  |  | 126 | \* @param string $path   Path to scan. |
  |  | 127 | \* @param array  $return Results of previous recursion (Deprecated in 3.2.10). |
  | 109 | 128 | \* |
  | 110 | 129 | \* @return array $return List of files inside directory |
  | 111 | 130 | \*/ |
  | 112 | 131 | function edd\_scan\_folders( $path = '', $return = array() ) { |
  | 113 |  | $path  = ( $path === '' ) ? dirname( \_\_FILE\_\_ ) : $path; |
  | 114 |  | $lists = @scandir( $path ); |
  |  | 132 | $path = ! empty( $path ) ? $path : \_\_DIR\_\_; |
  | 115 | 133 |  |
  | 116 |  | // Bail early if nothing to scan |
  | 117 |  | if ( empty( $lists ) ) { |
  | 118 |  | return $return; |
  | 119 |  | } |
  |  | 134 | // Get the main directories in the root of the directory we're scanning. |
  |  | 135 | $upload\_root\_dirs = glob( $path . '/\*', GLOB\_ONLYDIR | GLOB\_NOSORT | GLOB\_MARK ); |
  | 120 | 136 |  |
  | 121 |  | // Loop through directory items |
  | 122 |  | foreach ( $lists as $f ) { |
  | 123 |  | $dir = $path . DIRECTORY\_SEPARATOR . $f; |
  |  | 137 | // Now get all the recursive directories. |
  |  | 138 | $upload\_sub\_dirs = glob( $path . '/\*/\*\*', GLOB\_ONLYDIR | GLOB\_NOSORT | GLOB\_MARK ); |
  | 124 | 139 |  |
  | 125 |  | // Skip if not a directory |
  | 126 |  | if ( ! is\_dir( $dir ) || ( $f === "." ) || ( $f === ".." ) ) { |
  | 127 |  | continue; |
  | 128 |  | } |
  | 129 |  |  |
  | 130 |  | // Maybe add directory to return array |
  | 131 |  | if ( ! in\_array( $dir, $return, true ) ) { |
  | 132 |  | $return[] = trailingslashit( $dir ); |
  | 133 |  | } |
  | 134 |  |  |
  | 135 |  | // Recursively scan |
  | 136 |  | edd\_scan\_folders( $dir, $return ); |
  | 137 |  | } |
  | 138 |  |  |
  | 139 |  | return $return; |
  |  | 140 | // Merge the two arrays together, and avoid any possible duplicates. |
  |  | 141 | return array\_unique( array\_merge( $upload\_root\_dirs, $upload\_sub\_dirs ) ); |
  | 140 | 142 | } |
  | 141 | 143 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=2756001#L156) | […](/browser/easy-digital-downloads/trunk/includes/admin/upload-functions.php?rev=3060808#L158) |  |
  | 156 | 158 | switch ( $method ) { |
  | 157 | 159 |  |
  | 158 |  | case 'redirect': |
  | 159 |  | // Prevent directory browsing |
  | 160 |  | $rules = ~~"Options -Indexes"~~; |
  |  | 160 | case 'redirect': |
  |  | 161 | // Prevent directory browsing. |
  |  | 162 | $rules = 'Options -Indexes'; |
  | 161 | 163 | break; |
  | 162 | 164 |  |
  | 163 |  | case 'direct': |
  | 164 |  | default: |
  | 165 |  | // Prevent directory browsing and direct access to all files, except images (they must be allowed for featured images / thumbnails) |
  |  | 165 | case 'direct': |
  |  | 166 | default: |
  |  | 167 | // Prevent directory browsing and direct access to all files, except images (they must be allowed for featured images / thumbnails). |
  | 166 | 168 | $allowed\_filetypes = apply\_filters( 'edd\_protected\_directory\_allowed\_filetypes', array( 'jpg', 'jpeg', 'png', 'gif', 'mp3', 'ogg', 'webp' ) ); |
  | 167 |  | $rules = "Options -Indexes\n"; |
  | 168 |  | $rules .= "deny from all\n"; |
  | 169 |  | $rules .= "<FilesMatch '\.(" . implode( '|', $allowed\_filetypes ) . ")$'>\n"; |
  | 170 |  | ~~$rules~~ .= "Order Allow,Deny\n"; |
  | 171 |  | ~~$rules~~ .= "Allow from all\n"; |
  | 172 |  | $rules .= "</FilesMatch>\n"; |
  |  | 169 | $rules             = "Options -Indexes\n"; |
  |  | 170 | $rules            .= "deny from all\n"; |
  |  | 171 | $rules            .= "<FilesMatch '\.(" . implode( '|', $allowed\_filetypes ) . ")$'>\n"; |
  |  | 172 | $rules        .= "Order Allow,Deny\n"; |
  |  | 173 | $rules        .= "Allow from all\n"; |
  |  | 174 | $rules            .= "</FilesMatch>\n"; |
  | 173 | 175 | break; |
  | 174 | 176 | } |
* ## [easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php](/changeset/3060808/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?old=3030247&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fblocks%2Fincludes%2Forders%2Forders.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?rev=3030247#L107 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?rev=3060808#L107 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 107 | 107 | function confirmation( $block\_attributes = array() ) { |
  | 108 | 108 | $session = Functions\get\_purchase\_session(); |
  | 109 |  | if ( empty( $session['purchase\_key'] ) ) { |
  |  | 109 | $order   = false; |
  |  | 110 | if ( ! empty( $session['purchase\_key'] ) ) { |
  |  | 111 | $order = edd\_get\_order\_by( 'payment\_key', $session['purchase\_key'] ); |
  |  | 112 | } |
  |  | 113 | if ( ! $order ) { |
  | 110 | 114 | if ( Helpers\is\_block\_editor() ) { |
  | 111 | 115 | return '<p class="edd-alert edd-alert-info">' . esc\_html( \_\_( 'To view a sample confirmation screen, you need to have at least one order in your store.', 'easy-digital-downloads' ) ) . '</p>'; |
  | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?rev=3030247#L134) | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?rev=3060808#L138) |  |
  | 134 | 138 | <div class="<?php echo esc\_attr( implode( ' ', array\_filter( $classes ) ) ); ?>"> |
  | 135 | 139 | <?php |
  | 136 |  | ~~$order                  = edd\_get\_order\_by( 'payment\_key', $session['purchase\_key'] );~~ |
  | 137 | 140 | $edd\_receipt\_args['id'] = $order->id; |
  | 138 | 141 | include EDD\_BLOCKS\_DIR . 'views/orders/receipt-items.php'; |
  | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?rev=3030247#L169) | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?rev=3060808#L172) |  |
  | 169 | 172 | ); |
  | 170 | 173 | $payment\_key      = Functions\get\_payment\_key(); |
  | 171 |  |  |
  | 172 |  | // No key found. |
  | 173 |  | if ( ! $payment\_key ) { |
  |  | 174 | $order            = edd\_get\_order\_by( 'payment\_key', $payment\_key ); |
  |  | 175 |  |
  |  | 176 | // No order found. |
  |  | 177 | if ( ! $order ) { |
  | 174 | 178 | if ( Helpers\is\_block\_editor() ) { |
  | 175 | 179 | return '<p class="edd-alert edd-alert-info">' . esc\_html( \_\_( 'To view a sample receipt, you need to have at least one order in your store.', 'easy-digital-downloads' ) ) . '</p>'; |
  | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?rev=3030247#L182) | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/orders/orders.php?rev=3060808#L186) |  |
  | 182 | 186 | edd\_print\_errors(); |
  | 183 | 187 |  |
  | 184 |  | ~~$order         = edd\_get\_order\_by( 'payment\_key', $payment\_key );~~ |
  | 185 | 188 | $user\_can\_view = edd\_can\_view\_receipt( $order ); |
  | 186 | 189 | if ( ! $user\_can\_view ) { |
* ## [easy-digital-downloads/trunk/includes/blocks/includes/styles.php](/changeset/3060808/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?old=2964278&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fblocks%2Fincludes%2Fstyles.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/blocks/includes/styles.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?rev=2964278#L8 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?rev=3060808#L8 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* @license   GPL2+ |
  | 9 | 9 | \*/ |
  |  | 10 |  |
  | 10 | 11 | namespace EDD\Blocks\Styles; |
  | 11 | 12 |  |
  | 12 | 13 | // Exit if accessed directly. |
  | 13 |  | defined( 'ABSPATH' ) || exit; |
  |  | 14 | defined( 'ABSPATH' ) || exit; // @codeCoverageIgnore |
  | 14 | 15 |  |
  | 15 | 16 | /\*\* |
  | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?rev=2964278#L86) | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?rev=3060808#L87) |  |
  | 86 | 87 | return $metadata; |
  | 87 | 88 | } |
  | 88 |  | $blocks     = glob( EDD\_BLOCKS\_DIR . 'build/\*\*', GLOB\_ONLYDIR ); |
  | 89 |  | $edd\_blocks = array(); |
  | 90 |  | foreach ( $blocks as $block\_path ) { |
  | 91 |  | $block\_name   = explode( '/', $block\_path ); |
  | 92 |  | $block\_name   = end( $block\_name ); |
  | 93 |  | $edd\_blocks[] = "edd/{$block\_name}"; |
  | 94 |  | } |
  |  | 89 | $edd\_blocks = get\_edd\_blocks(); |
  | 95 | 90 | if ( in\_array( $metadata['name'], $edd\_blocks, true ) ) { |
  | 96 | 91 | unset( $metadata['style'] ); |
  | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?rev=2964278#L140) | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?rev=3060808#L135) |  |
  | 140 | 135 | function enqueue\_base\_styles( $block\_name ) { |
  | 141 | 136 | $block\_name = str\_replace( 'edd/', '', $block\_name ); |
  |  | 137 | $style\_uri  = apply\_filters( |
  |  | 138 | 'edd\_block\_style\_uri', |
  |  | 139 | EDD\_BLOCKS\_URL . "build/{$block\_name}/style-index.css", |
  |  | 140 | $block\_name |
  |  | 141 | ); |
  |  | 142 |  |
  | 142 | 143 | wp\_enqueue\_style( |
  | 143 | 144 | "edd-{$block\_name}-style", |
  | 144 |  | ~~EDD\_BLOCKS\_URL . "build/{$block\_name}/style-index.css"~~, |
  |  | 145 | $style\_uri, |
  | 145 | 146 | array( 'edd-blocks' ), |
  | 146 | 147 | EDD\_VERSION |
  | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?rev=2964278#L162) | […](/browser/easy-digital-downloads/trunk/includes/blocks/includes/styles.php?rev=3060808#L163) |  |
  | 162 | 163 | return function\_exists( 'wp\_is\_block\_theme' ) && wp\_is\_block\_theme(); |
  | 163 | 164 | } |
  |  | 165 |  |
  |  | 166 | /\*\* |
  |  | 167 | \* Get all registered EDD blocks. |
  |  | 168 | \* |
  |  | 169 | \* @since 3.2.10 |
  |  | 170 | \* @return array |
  |  | 171 | \*/ |
  |  | 172 | function get\_edd\_blocks() { |
  |  | 173 | $cached\_blocks = wp\_cache\_get( 'edd-registered-blocks', 'edd-blocks' ); |
  |  | 174 | if ( false !== $cached\_blocks ) { |
  |  | 175 | return $cached\_blocks; |
  |  | 176 | } |
  |  | 177 |  |
  |  | 178 | $blocks     = glob( EDD\_BLOCKS\_DIR . 'build/\*\*', GLOB\_ONLYDIR | GLOB\_NOSORT ); |
  |  | 179 | $edd\_blocks = array(); |
  |  | 180 | foreach ( $blocks as $block\_path ) { |
  |  | 181 | $block\_name = explode( '/', $block\_path ); |
  |  | 182 | $block\_name = end( $block\_name ); |
  |  | 183 | if ( 'pro' === $block\_name ) { |
  |  | 184 | continue; |
  |  | 185 | } |
  |  | 186 | $edd\_blocks[] = "edd/{$block\_name}"; |
  |  | 187 | } |
  |  | 188 |  |
  |  | 189 | $blocks = apply\_filters( 'edd\_registered\_blocks', $edd\_blocks ); |
  |  | 190 | wp\_cache\_set( 'edd-registered-blocks', $blocks, 'edd-blocks', 5 \* MINUTE\_IN\_SECONDS ); |
  |  | 191 |  |
  |  | 192 | return $blocks; |
  |  | 193 | } |
* ## [easy-digital-downloads/trunk/includes/checkout/template.php](/changeset/3060808/easy-digital-downloads/trunk/includes/checkout/template.php?old=2990247&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fcheckout%2Ftemplate.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/checkout/template.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/checkout/template.php?rev=2990247#L835 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/checkout/template.php?rev=3060808#L835 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 835 | 835 | function edd\_privacy\_agreement() { |
  | 836 | 836 |  |
  | 837 |  | $show\_privacy\_policy\_checkbox = edd\_get\_option( 'show\_agree\_to\_privacy\_policy', false ); |
  | 838 |  | $show\_privacy\_policy\_text     = edd\_get\_option( 'show\_privacy\_policy\_on\_checkout', false ); |
  |  | 837 | $show\_privacy\_policy\_checkbox = (bool) edd\_get\_option( 'show\_agree\_to\_privacy\_policy', false ); |
  |  | 838 | $show\_privacy\_policy\_text     = (bool) edd\_get\_option( 'show\_privacy\_policy\_on\_checkout', false ); |
  | 839 | 839 |  |
  | 840 | 840 | /\*\* |
  | […](/browser/easy-digital-downloads/trunk/includes/checkout/template.php?rev=2990247#L852) | […](/browser/easy-digital-downloads/trunk/includes/checkout/template.php?rev=3060808#L852) |  |
  | 852 | 852 | \* Because these two display options work independently, having either setting checked triggers output. |
  | 853 | 853 | \*/ |
  | 854 |  | if ( ~~'1' === $show\_privacy\_policy\_checkbox || '1' ===~~ $show\_privacy\_policy\_text ) { |
  |  | 854 | if ( $show\_privacy\_policy\_checkbox || $show\_privacy\_policy\_text ) { |
  | 855 | 855 |  |
  | 856 | 856 | $agree\_label  = edd\_get\_option( 'privacy\_agree\_label', \_\_( 'Agree to Privacy Policy?', 'easy-digital-downloads' ) ); |
  | […](/browser/easy-digital-downloads/trunk/includes/checkout/template.php?rev=2990247#L865) | […](/browser/easy-digital-downloads/trunk/includes/checkout/template.php?rev=3060808#L865) |  |
  | 865 | 865 | <?php |
  | 866 | 866 | // Show Privacy Policy text if the setting is checked, the WP Privacy Page is set, and content exists. |
  | 867 |  | if ( ~~'1' ===~~ $show\_privacy\_policy\_text && ( $privacy\_page && ! empty( $privacy\_text ) ) ) { |
  |  | 867 | if ( $show\_privacy\_policy\_text && ( $privacy\_page && ! empty( $privacy\_text ) ) ) { |
  | 868 | 868 | ?> |
  | 869 | 869 | <div id="edd-privacy-policy" class="edd-terms" style="display:none;"> |
  | […](/browser/easy-digital-downloads/trunk/includes/checkout/template.php?rev=2990247#L884) | […](/browser/easy-digital-downloads/trunk/includes/checkout/template.php?rev=3060808#L884) |  |
  | 884 | 884 |  |
  | 885 | 885 | // Show Privacy Policy checkbox and label if the setting is checked. |
  | 886 |  | if ( ~~'1' ===~~ $show\_privacy\_policy\_checkbox ) { |
  |  | 886 | if ( $show\_privacy\_policy\_checkbox ) { |
  | 887 | 887 | ?> |
  | 888 | 888 | <div class="edd-privacy-policy-agreement"> |
* ## [easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php](/changeset/3060808/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?old=3042139&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fclass-easy-digital-downloads.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3042139#L147 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3060808#L147 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 147 | 147 |  |
  | 148 | 148 | /\*\* |
  | 149 |  | \* @var EDD~~\_~~Logging |
  |  | 149 | \* @var EDD\Logging |
  | 150 | 150 | \*/ |
  | 151 | 151 | public $debug\_log; |
  | […](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3042139#L224) | […](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3060808#L224) |  |
  | 224 | 224 | self::$instance->fees               = new EDD\_Fees(); |
  | 225 | 225 | self::$instance->api                = new EDD\_API(); |
  | 226 |  | self::$instance->debug\_log          = new EDD~~\_~~Logging(); |
  |  | 226 | self::$instance->debug\_log          = new EDD\Logging(); |
  | 227 | 227 | self::$instance->utils              = new EDD\Utilities(); |
  | 228 | 228 | self::$instance->session            = new EDD\_Session(); |
  | […](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3042139#L371) | […](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3060808#L371) |  |
  | 371 | 371 | // Plugin version. |
  | 372 | 372 | if ( ! defined( 'EDD\_VERSION' ) ) { |
  | 373 |  | define( 'EDD\_VERSION', '3.2.~~9~~' ); |
  |  | 373 | define( 'EDD\_VERSION', '3.2.10' ); |
  | 374 | 374 | } |
  | 375 | 375 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3042139#L612) | […](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3060808#L612) |  |
  | 612 | 612 | require\_once EDD\_PLUGIN\_DIR . 'includes/class-edd-fees.php'; |
  | 613 | 613 | require\_once EDD\_PLUGIN\_DIR . 'includes/class-edd-license-handler.php'; |
  | 614 |  | ~~require\_once EDD\_PLUGIN\_DIR . 'includes/class-edd-logging.php';~~ |
  | 615 | 614 | require\_once EDD\_PLUGIN\_DIR . 'includes/class-edd-session.php'; |
  | 616 | 615 | require\_once EDD\_PLUGIN\_DIR . 'includes/class-edd-stats.php'; |
  | […](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3042139#L680) | […](/browser/easy-digital-downloads/trunk/includes/class-easy-digital-downloads.php?rev=3060808#L679) |  |
  | 680 | 679 | } |
  | 681 | 680 |  |
  | 682 |  | // Logs |
  |  | 681 | // Logs. |
  |  | 682 | require\_once EDD\_PLUGIN\_DIR . 'includes/logs/functions.php'; |
  | 683 | 683 | require\_once EDD\_PLUGIN\_DIR . 'includes/logs/api-request-log/class-api-request-log.php'; |
  | 684 | 684 | require\_once EDD\_PLUGIN\_DIR . 'includes/logs/api-request-log/functions.php'; |
* ## [easy-digital-downloads/trunk/includes/database/queries/class-adjustment.php](/changeset/3060808/easy-digital-downloads/trunk/includes/database/queries/class-adjustment.php?old=2756001&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fdatabase%2Fqueries%2Fclass-adjustment.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/database/queries/class-adjustment.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/database/queries/class-adjustment.php?rev=2756001#L168 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/database/queries/class-adjustment.php?rev=3060808#L168 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 168 | 168 | parent::\_\_construct( $query ); |
  | 169 | 169 | } |
  |  | 170 |  |
  |  | 171 | /\*\* |
  |  | 172 | \* Adds a new adjustment to the database. |
  |  | 173 | \* |
  |  | 174 | \* @param array $data The array of data to insert into the database. |
  |  | 175 | \* @return int|false |
  |  | 176 | \*/ |
  |  | 177 | public function add\_item( $data = array() ) { |
  |  | 178 | return parent::add\_item( $this->update\_empty\_start\_end\_dates( $data ) ); |
  |  | 179 | } |
  |  | 180 |  |
  |  | 181 | /\*\* |
  |  | 182 | \* Updates an adjustment in the database. |
  |  | 183 | \* |
  |  | 184 | \* @param int   $item\_id The ID of the adjustment to update. |
  |  | 185 | \* @param array $data    The array of data to update in the database. |
  |  | 186 | \* @return int|false |
  |  | 187 | \*/ |
  |  | 188 | public function update\_item( $item\_id = 0, $data = array() ) { |
  |  | 189 | return parent::update\_item( $item\_id, $this->update\_empty\_start\_end\_dates( $data ) ); |
  |  | 190 | } |
  |  | 191 |  |
  |  | 192 | /\*\* |
  |  | 193 | \* Updates empty start and end dates. |
  |  | 194 | \* |
  |  | 195 | \* @param array $data The data to filter. |
  |  | 196 | \* @return array |
  |  | 197 | \*/ |
  |  | 198 | private function update\_empty\_start\_end\_dates( $data ) { |
  |  | 199 | if ( empty( $data['start\_date'] ) ) { |
  |  | 200 | $data['start\_date'] = null; |
  |  | 201 | } |
  |  | 202 |  |
  |  | 203 | if ( empty( $data['end\_date'] ) ) { |
  |  | 204 | $data['end\_date'] = null; |
  |  | 205 | } |
  |  | 206 |  |
  |  | 207 | return $data; |
  |  | 208 | } |
  | 170 | 209 | } |
* ## [easy-digital-downloads/trunk/includes/date-functions.php](/changeset/3060808/easy-digital-downloads/trunk/includes/date-functions.php?old=2940530&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fdate-functions.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/date-functions.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/date-functions.php?rev=2940530#L294 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/date-functions.php?rev=3060808#L294 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 294 | 294 | \*/ |
  | 295 | 295 | function edd\_get\_utc\_date\_string( $date\_string = 'now', $format = 'Y-m-d H:i:s' ) { |
  | 296 |  | return EDD()->utils->date( $date\_string, edd\_get\_timezone\_id(), ~~fals~~e )->get\_utc\_from\_local( $format ); |
  | 297 |  | } |
  |  | 296 | return EDD()->utils->date( $date\_string, edd\_get\_timezone\_id(), true )->get\_utc\_from\_local( $format ); |
  |  | 297 | } |
* ## [easy-digital-downloads/trunk/includes/deprecated/classes.php](/changeset/3060808/easy-digital-downloads/trunk/includes/deprecated/classes.php?old=3036940&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fdeprecated%2Fclasses.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/deprecated/classes.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/deprecated/classes.php?rev=3036940#L20 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/deprecated/classes.php?rev=3060808#L20 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | \*/ |
  | 21 | 21 | class\_alias( \EDD\HTML\Elements::class, 'EDD\_HTML\_Elements' ); |
  |  | 22 |  |
  |  | 23 | /\*\* |
  |  | 24 | \* Legacy `EDD\_Logging` class was refactored and moved to the new `EDD\Logging` class. |
  |  | 25 | \* This alias is a safeguard to those developers who use our internal class EDD\_Logging, |
  |  | 26 | \* which we deleted. |
  |  | 27 | \* |
  |  | 28 | \* @since 3.2.10 |
  |  | 29 | \*/ |
  |  | 30 | class\_alias( \EDD\Logging::class, 'EDD\_Logging' ); |
  |  | 31 |  |
  |  | 32 | /\*\* |
  |  | 33 | \* Some legacy classes have been completely deprecated and emptied . |
  |  | 34 | \* This alias is a safeguard to those developers who use our internal classes, |
  |  | 35 | \* which we deleted . |
  |  | 36 | \* |
  |  | 37 | \* @since 3.2.10 |
  |  | 38 | \*/ |
  |  | 39 | class\_alias( \EDD\Deprecated\EmptyClass::class, 'EDD\_DB\_Customers' ); |
  |  | 40 | class\_alias( \EDD\Deprecated\EmptyClass::class, 'EDD\_DB\_Customer\_Meta' ); |
* ## [easy-digital-downloads/trunk/includes/discount-functions.php](/changeset/3060808/easy-digital-downloads/trunk/includes/discount-functions.php?old=2964278&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fdiscount-functions.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/discount-functions.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L10 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L10 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \*/ |
  | 11 | 11 |  |
  | 12 |  | // Exit if accessed directly |
  | 13 |  | defined( 'ABSPATH' ) || exit; |
  |  | 12 | // Exit if accessed directly. |
  |  | 13 | defined( 'ABSPATH' ) || exit; // @codeCoverageIgnore |
  | 14 | 14 |  |
  | 15 | 15 | /\*\* |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L35) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L35) |  |
  | 35 | 35 | unset( $data['product\_reqs'], $data['excluded\_products'], $data['product\_condition'], $data['categories'], $data['term\_condition'] ); |
  | 36 | 36 |  |
  | 37 |  | if ( ~~isset~~( $data['expiration'] ) ) { |
  |  | 37 | if ( ! empty( $data['expiration'] ) ) { |
  | 38 | 38 | $data['end\_date'] = $data['expiration']; |
  | 39 |  | unset( $data['expiration'] ); |
  | 40 |  | } |
  | 41 |  |  |
  | 42 |  | if ( isset( $data['start'] ) ) { |
  |  | 39 | } |
  |  | 40 |  |
  |  | 41 | if ( ! empty( $data['start'] ) ) { |
  | 43 | 42 | $data['start\_date'] = $data['start']; |
  | 44 |  | unset( $data['start'] ); |
  | 45 |  | } |
  |  | 43 | } |
  |  | 44 |  |
  |  | 45 | // Always unset the old keys, even if they were empty. |
  |  | 46 | unset( $data['expiration'], $data['start'] ); |
  | 46 | 47 |  |
  | 47 | 48 | // Setup the discounts query. |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L153) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L154) |  |
  | 153 | 154 | $discounts = new EDD\Compat\Discount\_Query(); |
  | 154 | 155 |  |
  | 155 |  | // Return discount |
  |  | 156 | // Return discount. |
  | 156 | 157 | return $discounts->get\_item( $discount\_id ); |
  | 157 | 158 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L177) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L178) |  |
  | 177 | 178 | \* |
  | 178 | 179 | \* @param \EDD\_Discount $discount     Discount object. |
  | 179 |  | \* @param string        $code Discount code. |
  |  | 180 | \* @param string        $code               Discount code. |
  | 180 | 181 | \*/ |
  | 181 | 182 | return apply\_filters( 'edd\_get\_discount\_by\_code', $discount, $code ); |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L196) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L197) |  |
  | 196 | 197 | $discounts = new EDD\Compat\Discount\_Query(); |
  | 197 | 198 |  |
  | 198 |  | // Return discount |
  |  | 199 | // Return discount. |
  | 199 | 200 | return $discounts->get\_item\_by( $field, $value ); |
  | 200 | 201 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L207) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L208) |  |
  | 207 | 208 | \* @since 3.0 Updated to call edd\_get\_discount() |
  | 208 | 209 | \* |
  | 209 |  | \* @param int $discount\_id Discount ID. |
  |  | 210 | \* @param int    $discount\_id Discount ID. |
  | 210 | 211 | \* @param string $field The field to retrieve the discount with. |
  | 211 | 212 | \* @return mixed object|bool EDD\_Discount object or false if not found. |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L214) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L215) |  |
  | 214 | 215 | $discount = edd\_get\_discount( $discount\_id ); |
  | 215 | 216 |  |
  | 216 |  | // Check that field exists |
  |  | 217 | // Check that field exists. |
  | 217 | 218 | return isset( $discount->{$field} ) |
  | 218 | 219 | ? $discount->{$field} |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L224) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L225) |  |
  | 224 | 225 | \* |
  | 225 | 226 | \* @since 3.0 |
  | 226 |  | \* @param int $discount\_id Discount ID. |
  |  | 227 | \* @param int   $discount\_id Discount ID. |
  | 227 | 228 | \* @param array $data |
  | 228 | 229 | \* @return int |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L230) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L231) |  |
  | 230 | 231 | function edd\_update\_discount( $discount\_id = 0, $data = array() ) { |
  | 231 | 232 |  |
  | 232 |  | // Pre-3.0 pre action |
  |  | 233 | // Pre-3.0 pre action. |
  | 233 | 234 | do\_action( 'edd\_pre\_update\_discount', $data, $discount\_id ); |
  | 234 | 235 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L271) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L272) |  |
  | 271 | 272 |  |
  | 272 | 273 | unset( $data['excluded\_products'] ); |
  | 273 |  | } elseif( isset( $data['excluded\_products'] ) ) { |
  |  | 274 | } elseif ( isset( $data['excluded\_products'] ) ) { |
  | 274 | 275 | edd\_delete\_adjustment\_meta( $discount\_id, 'excluded\_product' ); |
  | 275 | 276 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L301) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L302) |  |
  | 301 | 302 | $retval = $discounts->update\_item( $discount\_id, $data ); |
  | 302 | 303 |  |
  | 303 |  | // Pre-3.0 post action |
  |  | 304 | // Pre-3.0 post action. |
  | 304 | 305 | do\_action( 'edd\_post\_update\_discount', $data, $discount\_id ); |
  | 305 | 306 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L319) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L320) |  |
  | 319 | 320 | // By default we avoid archived discounts. |
  | 320 | 321 | $default\_args = array( |
  | 321 |  | 'number' => 30, |
  |  | 322 | 'number'         => 30, |
  | 322 | 323 | 'status\_\_not\_in' => array( 'archived' ), |
  | 323 | 324 | ); |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L346) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L347) |  |
  | 346 | 347 | $discounts = new EDD\Compat\Discount\_Query(); |
  | 347 | 348 |  |
  | 348 |  | // Return discounts |
  |  | 349 | // Return discounts. |
  | 349 | 350 | return $discounts->query( $r ); |
  | 350 | 351 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L361) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L362) |  |
  | 361 | 362 |  |
  | 362 | 363 | // Parse args. |
  | 363 |  | $r = wp\_parse\_args( $args, array( |
  | 364 |  | 'count' => true, |
  | 365 |  | ) ); |
  |  | 364 | $r = wp\_parse\_args( |
  |  | 365 | $args, |
  |  | 366 | array( |
  |  | 367 | 'count' => true, |
  |  | 368 | ) |
  |  | 369 | ); |
  | 366 | 370 |  |
  | 367 | 371 | // Query for count(s). |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L381) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L385) |  |
  | 381 | 385 | function edd\_get\_discount\_counts( $args = array() ) { |
  | 382 | 386 |  |
  | 383 |  | // Parse arguments |
  | 384 |  | $r = wp\_parse\_args( $args, array( |
  | 385 |  | 'count'   => true, |
  | 386 |  | 'groupby' => 'status' |
  | 387 |  | ) ); |
  |  | 387 | // Parse arguments. |
  |  | 388 | $r = wp\_parse\_args( |
  |  | 389 | $args, |
  |  | 390 | array( |
  |  | 391 | 'count'   => true, |
  |  | 392 | 'groupby' => 'status', |
  |  | 393 | ) |
  |  | 394 | ); |
  | 388 | 395 |  |
  | 389 | 396 | // Query for count. |
  | 390 | 397 | $counts = new EDD\Compat\Discount\_Query( $r ); |
  | 391 | 398 |  |
  | 392 |  | // Format & return |
  |  | 399 | // Format & return. |
  | 393 | 400 | return edd\_format\_counts( $counts, $r['groupby'] ); |
  | 394 | 401 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L403) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L410) |  |
  | 403 | 410 | \*/ |
  | 404 | 411 | function edd\_get\_discount\_notes( $discount\_id = 0 ) { |
  | 405 |  | return edd\_get\_notes( array( |
  | 406 |  | 'object\_id'   => $discount\_id, |
  | 407 |  | 'object\_type' => 'discount', |
  | 408 |  | 'order'       => 'asc' |
  | 409 |  | ) ); |
  |  | 412 | return edd\_get\_notes( |
  |  | 413 | array( |
  |  | 414 | 'object\_id'   => $discount\_id, |
  |  | 415 | 'object\_type' => 'discount', |
  |  | 416 | 'order'       => 'asc', |
  |  | 417 | ) |
  |  | 418 | ); |
  | 410 | 419 | } |
  | 411 | 420 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L428) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L437) |  |
  | 428 | 437 | \*/ |
  | 429 | 438 | $discount\_arguments = array( |
  | 430 |  | 'status\_\_not\_in' => array( 'expired', 'inactive', 'archived' ), |
  |  | 439 | 'number'            => 1, |
  |  | 440 | 'type'              => 'discount', |
  |  | 441 | 'status\_\_not\_in'    => array( 'expired', 'inactive', 'archived' ), |
  | 431 | 442 | 'max\_uses\_\_compare' => array( |
  | 432 |  | 'relation' => 'OR', |
  |  | 443 | 'relation' => 'OR', |
  | 433 | 444 | array( |
  | 434 |  | 'value'   => 'use\_count', |
  | 435 |  | 'compare' => '>', |
  |  | 445 | 'value'   => 'use\_count', |
  |  | 446 | 'compare' => '>', |
  | 436 | 447 | ), |
  | 437 | 448 | array( |
  | 438 |  | 'value'   => 0, |
  | 439 |  | 'compare' => '=', |
  | 440 |  | ) |
  |  | 449 | 'value'   => 0, |
  |  | 450 | 'compare' => '=', |
  |  | 451 | ), |
  | 441 | 452 | ), |
  | 442 |  | 'date\_query'     => array( |
  |  | 453 | 'date\_query'        => array( |
  | 443 | 454 | 'relation' => 'AND', |
  | 444 | 455 | array( |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L465) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L476) |  |
  | 465 | 476 | 'compare' => 'IS NULL', |
  | 466 | 477 | ), |
  | 467 |  | ) |
  |  | 478 | ), |
  | 468 | 479 | ), |
  | 469 | 480 | ); |
  | 470 | 481 |  |
  | 471 |  | // Query for active discounts. |
  | 472 |  | $discounts = edd\_get\_discount\_count( $discount\_arguments ); |
  | 473 |  |  |
  | 474 |  | // Bail if none. |
  | 475 |  | if ( empty( $discounts ) ) { |
  | 476 |  | return false; |
  | 477 |  | } |
  | 478 |  |  |
  | 479 |  | return true; |
  |  | 482 | return ! empty( edd\_get\_adjustments( $discount\_arguments ) ); |
  | 480 | 483 | } |
  | 481 | 484 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L499) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L502) |  |
  | 499 | 502 | edd\_debug\_log( |
  | 500 | 503 | sprintf( |
  |  | 504 | /\* translators: 1: Function name, 2: Version number, 3: Replacement function name \*/ |
  | 501 | 505 | \_\_( '%1$s is deprecated since Easy Digital Downloads version %2$s! Use %3$s instead.', 'easy-digital-downloads' ), |
  | 502 | 506 | \_\_FUNCTION\_\_, |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L507) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L511) |  |
  | 507 | 511 | ); |
  | 508 | 512 |  |
  | 509 |  | ~~// Set default return value to false.~~ |
  | 510 |  | ~~$return = false;~~ |
  | 511 |  |  |
  | 512 | 513 | // Back-compat for start date. |
  | 513 | 514 | if ( isset( $details['start'] ) && strstr( $details['start'], '/' ) ) { |
  | 514 | 515 | $time\_format           = date( 'H:i:s', strtotime( $details['start'] ) ); |
  | 515 | 516 | $date\_format           = date( 'Y-m-d', strtotime( $details['start'] ) ) . ' ' . $time\_format; |
  | 516 |  | $details['start\_date'] = edd\_get\_utc\_equivalent\_date( EDD()->utils->date( $date\_format, edd\_get\_timezone\_id(), false )); |
  | 517 |  | unset( $details['start'] ); |
  |  | 517 | $details['start\_date'] = edd\_get\_utc\_equivalent\_date( EDD()->utils->date( $date\_format, edd\_get\_timezone\_id(), false ) ); |
  | 518 | 518 | } |
  | 519 | 519 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L523) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L523) |  |
  | 523 | 523 | $date\_format         = date( 'Y-m-d', strtotime( $details['expiration'] ) ) . ' ' . ( '00:00:00' !== $time\_format ? $time\_format : '23:59:59' ); |
  | 524 | 524 | $details['end\_date'] = edd\_get\_utc\_equivalent\_date( EDD()->utils->date( $date\_format, edd\_get\_timezone\_id(), false ) ); |
  | 525 |  | unset( $details['expiration'] ); |
  | 526 |  | } |
  |  | 525 | } |
  |  | 526 |  |
  |  | 527 | // Always unset the old keys, even if they were empty. |
  |  | 528 | unset( $details['start'], $details['expiration'] ); |
  | 527 | 529 |  |
  | 528 | 530 | /\*\* |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L552) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L554) |  |
  | 552 | 554 |  |
  | 553 | 555 | if ( null === $discount\_id ) { |
  | 554 |  | $return = (int) edd\_add\_discount( $details ); |
  | 555 |  | } else { |
  | 556 |  | edd\_update\_discount( $discount\_id, $details ); |
  | 557 |  | $return = $discount\_id; |
  | 558 |  | } |
  | 559 |  |  |
  | 560 |  | return $return; |
  |  | 556 | return (int) edd\_add\_discount( $details ); |
  |  | 557 | } |
  |  | 558 |  |
  |  | 559 | edd\_update\_discount( $discount\_id, $details ); |
  |  | 560 | return $discount\_id; |
  | 561 | 561 | } |
  | 562 | 562 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L606) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L606) |  |
  | 606 | 606 | // Try to update status. |
  | 607 | 607 | if ( ! empty( $discount->id ) ) { |
  | 608 |  | $updated = (bool) edd\_update\_discount( $discount->id, array( |
  | 609 |  | 'status' => $new\_status |
  | 610 |  | ) ); |
  |  | 608 | $updated = (bool) edd\_update\_discount( |
  |  | 609 | $discount->id, |
  |  | 610 | array( |
  |  | 611 | 'status' => $new\_status, |
  |  | 612 | ) |
  |  | 613 | ); |
  | 611 | 614 | } |
  | 612 | 615 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L985) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L988) |  |
  | 985 | 988 | \*/ |
  | 986 | 989 | function edd\_is\_discount\_used( $code = null, $user = '', $discount\_id = 0, $set\_error = true ) { |
  | 987 |  | $discount = ~~( null ==~~ $code ) |
  |  | 990 | $discount = is\_null( $code ) |
  | 988 | 991 | ? edd\_get\_discount( $discount\_id ) |
  | 989 | 992 | : edd\_get\_discount\_by\_code( $code ); |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1068) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1071) |  |
  | 1068 | 1071 | $discount = edd\_get\_discount\_by\_code( $code ); |
  | 1069 | 1072 |  |
  | 1070 |  | // Increase if discount exists |
  |  | 1073 | // Increase if discount exists. |
  | 1071 | 1074 | return ! empty( $discount->id ) |
  | 1072 | 1075 | ? (int) $discount->increase\_usage() |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1087) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1090) |  |
  | 1087 | 1090 | $discount = edd\_get\_discount\_by\_code( $code ); |
  | 1088 | 1091 |  |
  | 1089 |  | // Decrease if discount exists |
  |  | 1092 | // Decrease if discount exists. |
  | 1090 | 1093 | return ! empty( $discount->id ) |
  | 1091 | 1094 | ? (int) $discount->decrease\_usage() |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1097) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1100) |  |
  | 1097 | 1100 | \* |
  | 1098 | 1101 | \* @since 1.0 |
  | 1099 |  | \* @param string $type Discount code type |
  |  | 1102 | \* @param string     $type Discount code type |
  | 1100 | 1103 | \* @param string|int $amount Discount code amount |
  | 1101 | 1104 | \* @return string $amount Formatted amount |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1153) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1156) |  |
  | 1153 | 1156 | function edd\_set\_cart\_discount( $code = '' ) { |
  | 1154 | 1157 |  |
  | 1155 |  | // Get all active cart discounts |
  |  | 1158 | // Get all active cart discounts. |
  | 1156 | 1159 | if ( edd\_multiple\_discounts\_allowed() ) { |
  | 1157 | 1160 | $discounts = edd\_get\_cart\_discounts(); |
  | 1158 | 1161 |  |
  | 1159 |  | ~~// Only one discount allowed per purchase, so override any existing~~ |
  |  | 1162 | // Only one discount allowed per purchase, so override any existing. |
  | 1160 | 1163 | } else { |
  | 1161 | 1164 | $discounts = false; |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1163) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1166) |  |
  | 1163 | 1166 |  |
  | 1164 | 1167 | if ( $discounts ) { |
  | 1165 |  | $key = array\_search( strtolower( $code ), array\_map( 'strtolower', $discounts ) ); |
  | 1166 |  |  |
  | 1167 |  | // Can't set the same discount more than once |
  |  | 1168 | $key = array\_search( strtolower( $code ), array\_map( 'strtolower', $discounts ), true ); |
  |  | 1169 |  |
  |  | 1170 | // Can't set the same discount more than once. |
  | 1168 | 1171 | if ( false !== $key ) { |
  | 1169 | 1172 | unset( $discounts[ $key ] ); |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1171) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1174) |  |
  | 1171 | 1174 | $discounts[] = $code; |
  | 1172 | 1175 | } else { |
  | 1173 |  | $discounts = array(); |
  |  | 1176 | $discounts   = array(); |
  | 1174 | 1177 | $discounts[] = $code; |
  | 1175 | 1178 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1195) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1198) |  |
  | 1195 | 1198 | if ( $discounts ) { |
  | 1196 | 1199 | $discounts = array\_map( 'strtoupper', $discounts ); |
  | 1197 |  | $key       = array\_search( strtoupper( $code ), $discounts ); |
  |  | 1200 | $key       = array\_search( strtoupper( $code ), $discounts, true ); |
  | 1198 | 1201 |  |
  | 1199 | 1202 | if ( false !== $key ) { |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1202) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1205) |  |
  | 1202 | 1205 |  |
  | 1203 | 1206 | $discounts = implode( '|', array\_values( $discounts ) ); |
  | 1204 |  | // ~~update the active discounts~~ |
  |  | 1207 | // Update the active discounts. |
  | 1205 | 1208 | EDD()->session->set( 'cart\_discounts', $discounts ); |
  | 1206 | 1209 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1223) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1226) |  |
  | 1223 | 1226 |  |
  | 1224 | 1227 | /\*\* |
  | 1225 |  | \* Retrieve the currently applied discount |
  |  | 1228 | \* Retrieve the currently applied discount. |
  | 1226 | 1229 | \* |
  | 1227 | 1230 | \* @since 1.4.1 |
  | 1228 |  | \* @return array $discounts The active discount codes |
  |  | 1231 | \* @return array $discounts The active discount codes. |
  | 1229 | 1232 | \*/ |
  | 1230 | 1233 | function edd\_get\_cart\_discounts() { |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1259) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1262) |  |
  | 1259 | 1262 | \* |
  | 1260 | 1263 | \* @since 1.9 |
  | 1261 |  | \* @param array $item Cart item array |
  |  | 1264 | \* @param array       $item Cart item array |
  | 1262 | 1265 | \* @param bool|string $discount False to use the cart discounts or a string to check with a discount code |
  | 1263 | 1266 | \* @return float The discounted amount |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1368) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1371) |  |
  | 1368 | 1371 | function edd\_remove\_cart\_discount() { |
  | 1369 | 1372 |  |
  | 1370 |  | // Get ID |
  |  | 1373 | // Get ID. |
  | 1371 | 1374 | $discount\_id = isset( $\_GET['discount\_id'] ) |
  | 1372 | 1375 | ? absint( $\_GET['discount\_id'] ) |
  | 1373 | 1376 | : 0; |
  | 1374 | 1377 |  |
  | 1375 |  | // Get code |
  |  | 1378 | // Get code. |
  | 1376 | 1379 | $discount\_code = isset( $\_GET['discount\_code'] ) |
  | 1377 | 1380 | ? urldecode( $\_GET['discount\_code'] ) |
  | 1378 | 1381 | : ''; |
  | 1379 | 1382 |  |
  | 1380 |  | // Bail if either ID or code are empty |
  |  | 1383 | // Bail if either ID or code are empty. |
  | 1381 | 1384 | if ( empty( $discount\_id ) || empty( $discount\_code ) ) { |
  | 1382 | 1385 | return; |
  | 1383 | 1386 | } |
  | 1384 | 1387 |  |
  | 1385 |  | // Pre-3.0 pre action |
  |  | 1388 | // Pre-3.0 pre action. |
  | 1386 | 1389 | do\_action( 'edd\_pre\_remove\_cart\_discount', $discount\_id ); |
  | 1387 | 1390 |  |
  | 1388 | 1391 | edd\_unset\_cart\_discount( $discount\_code ); |
  | 1389 | 1392 |  |
  | 1390 |  | // Pre-3.0 post action |
  |  | 1393 | // Pre-3.0 post action. |
  | 1391 | 1394 | do\_action( 'edd\_post\_remove\_cart\_discount', $discount\_id ); |
  | 1392 | 1395 |  |
  | 1393 |  | // Redirect |
  |  | 1396 | // Redirect. |
  | 1394 | 1397 | edd\_redirect( edd\_get\_checkout\_uri() ); |
  | 1395 | 1398 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1441) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1444) |  |
  | 1441 | 1444 | function edd\_listen\_for\_cart\_discount() { |
  | 1442 | 1445 |  |
  | 1443 |  | // Bail if in admin |
  |  | 1446 | // Bail if in admin. |
  | 1444 | 1447 | if ( is\_admin() ) { |
  | 1445 | 1448 | return; |
  | 1446 | 1449 | } |
  | 1447 | 1450 |  |
  | 1448 |  | // Array stops the bulk delete of discount codes from storing as a preset\_discount |
  |  | 1451 | // Array stops the bulk delete of discount codes from storing as a preset\_discount. |
  | 1449 | 1452 | if ( empty( $\_REQUEST['discount'] ) || is\_array( $\_REQUEST['discount'] ) ) { |
  | 1450 | 1453 | return; |
  | 1451 | 1454 | } |
  | 1452 | 1455 |  |
  | 1453 |  | $code = preg\_replace('/[^a-zA-Z0-9-\_]+/', '', $\_REQUEST['discount'] ); |
  |  | 1456 | $code = preg\_replace( '/[^a-zA-Z0-9-\_]+/', '', $\_REQUEST['discount'] ); |
  | 1454 | 1457 |  |
  | 1455 | 1458 | EDD()->session->set( 'preset\_discount', $code ); |
  | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=2964278#L1465) | […](/browser/easy-digital-downloads/trunk/includes/discount-functions.php?rev=3060808#L1468) |  |
  | 1465 | 1468 | function edd\_apply\_preset\_discount() { |
  | 1466 | 1469 |  |
  | 1467 |  | // Bail if in admin |
  |  | 1470 | // Bail if in admin. |
  | 1468 | 1471 | if ( is\_admin() ) { |
  | 1469 | 1472 | return; |
* ## [easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php](/changeset/3060808/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?old=2902072&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fgateways%2Fstripe%2Fincludes%2Fclass-edd-stripe-rate-limiting.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L7 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L7 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  |  | 9 | // Exit if accessed directly. |
  |  | 10 | defined( 'ABSPATH' ) || exit; // @codeCoverageIgnore |
  |  | 11 |  |
  |  | 12 | use EDD\Utils\FileSystem; |
  |  | 13 |  |
  | 9 | 14 | /\*\* |
  | 10 | 15 | \* Class EDD\_Stripe\_Rate\_Limiting |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L61) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L66) |  |
  | 61 | 66 | // Catch any recurring errors as they don't run through the main Stripe extension. |
  | 62 | 67 | add\_action( 'edd\_before\_purchase\_form', array( $this, 'listen\_for\_recurring\_card\_errors' ), 0 ); |
  | 63 |  |  |
  | 64 | 68 | } |
  | 65 | 69 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L73) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L77) |  |
  | 73 | 77 | // Hide the purchase button if the visitor has hit the limit of errors. |
  | 74 | 78 | add\_filter( 'edd\_checkout\_button\_purchase', array( $this, 'maybe\_hide\_purchase\_button' ) ); |
  | 75 |  |  |
  | 76 | 79 | } |
  | 77 | 80 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L120) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L123) |  |
  | 120 | 123 | \*/ |
  | 121 | 124 | public function setup\_log\_file() { |
  | 122 |  |  |
  | 123 |  | $upload\_dir     = wp\_upload\_dir(); |
  |  | 125 | $upload\_dir     = edd\_get\_upload\_dir(); |
  | 124 | 126 | $this->filename = wp\_hash( home\_url( '/' ) ) . '-edd-stripe-rate-limiting.log'; |
  | 125 |  | $this->file     = trailingslashit( $upload\_dir['basedir'] ) . $this->filename; |
  | 126 |  |  |
  | 127 |  | if ( ! is\_writeable( $upload\_dir['basedir'] ) ) { |
  |  | 127 | $this->file     = trailingslashit( $upload\_dir ) . $this->filename; |
  |  | 128 | FileSystem::maybe\_move\_file( $this->filename, $this->file ); |
  |  | 129 |  |
  |  | 130 | if ( ! FileSystem::get\_fs()->is\_writable( $upload\_dir ) ) { |
  | 128 | 131 | $this->is\_writable = false; |
  | 129 | 132 | } |
  | 130 |  |  |
  | 131 | 133 | } |
  | 132 | 134 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L235) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L237) |  |
  | 235 | 237 | $current\_count = 1; |
  | 236 | 238 | } else { |
  | 237 |  | ~~$current\_count++~~; |
  |  | 239 | ++$current\_count; |
  | 238 | 240 | } |
  | 239 | 241 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L270) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L272) |  |
  | 270 | 272 |  |
  | 271 | 273 | $this->write\_to\_log( $current\_log ); |
  | 272 |  |  |
  | 273 | 274 | } |
  | 274 | 275 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L327) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L328) |  |
  | 327 | 328 |  |
  | 328 | 329 | return $purchase\_button\_markup; |
  | 329 |  |  |
  | 330 | 330 | } |
  | 331 | 331 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L345) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L345) |  |
  | 345 | 345 | $this->increment\_card\_error\_count(); |
  | 346 | 346 | } |
  | 347 |  |  |
  | 348 | 347 | } |
  | 349 | 348 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L384) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L383) |  |
  | 384 | 383 | $file = json\_encode( array() ); |
  | 385 | 384 |  |
  | 386 |  | if ( ~~@file\_~~exists( $this->file ) ) { |
  | 387 |  |  |
  | 388 |  | if ( ! ~~is\_write~~able( $this->file ) ) { |
  |  | 385 | if ( FileSystem::get\_fs()->exists( $this->file ) ) { |
  |  | 386 |  |
  |  | 387 | if ( ! FileSystem::get\_fs()->is\_writable( $this->file ) ) { |
  | 389 | 388 | $this->is\_writable = false; |
  | 390 | 389 | } |
  | 391 | 390 |  |
  | 392 |  | $file = ~~@file\_~~get\_contents( $this->file ); |
  |  | 391 | $file = FileSystem::get\_fs()->get\_contents( $this->file ); |
  | 393 | 392 | } else { |
  | 394 |  | ~~@file\_put\_contents( $this->file, $file ); // @codingStandardsIgnoreLine~~ |
  | 395 |  | ~~@chmod( $this->file, 0664 ); // @codingStandardsIgnoreLine~~ |
  |  | 393 | FileSystem::get\_fs()->put\_contents( $this->file, $file ); |
  |  | 394 | FileSystem::get\_fs()->chmod( $this->file, 0664 ); |
  | 396 | 395 | } |
  | 397 | 396 |  |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L417) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L416) |  |
  | 417 | 416 |  |
  | 418 | 417 | if ( $this->is\_writable ) { |
  | 419 |  | ~~@file\_put\_contents( $this->file, $content ); // @codingStandardsIgnoreLine~~ |
  |  | 418 | FileSystem::get\_fs()->put\_contents( $this->file, $content ); |
  | 420 | 419 | } |
  | 421 | 420 | } |
  | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=2902072#L433) | […](/browser/easy-digital-downloads/trunk/includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php?rev=3060808#L432) |  |
  | 433 | 432 | ); |
  | 434 | 433 | } |
  | 435 |  |  |
  | 436 | 434 | } |
* ## [easy-digital-downloads/trunk/includes/orders/functions/actions.php](/changeset/3060808/easy-digital-downloads/trunk/includes/orders/functions/actions.php?old=2940530&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Forders%2Ffunctions%2Factions.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/orders/functions/actions.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/orders/functions/actions.php?rev=2940530#L25 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/orders/functions/actions.php?rev=3060808#L25 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 25 | 25 | function edd\_add\_manual\_order( $args = array() ) { |
  | 26 | 26 | // Bail if user cannot manage shop settings or no data was passed. |
  | 27 |  | if ( empty( $args ) || ! current\_user\_can( '~~manage\_shop\_setting~~s' ) ) { |
  |  | 27 | if ( empty( $args ) || ! current\_user\_can( 'edit\_shop\_payments' ) ) { |
  | 28 | 28 | return; |
  | 29 | 29 | } |
* ## [easy-digital-downloads/trunk/includes/shortcodes.php](/changeset/3060808/easy-digital-downloads/trunk/includes/shortcodes.php?old=3008322&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fshortcodes.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/shortcodes.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/shortcodes.php?rev=3008322#L667 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/shortcodes.php?rev=3060808#L667 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 667 | 667 | global $edd\_receipt\_args; |
  | 668 | 668 |  |
  | 669 |  | $edd\_receipt\_args = shortcode\_atts( array( |
  | 670 |  | 'error'          => \_\_( 'Sorry, trouble retrieving order receipt.', 'easy-digital-downloads' ), |
  | 671 |  | 'price'          => true, |
  | 672 |  | 'discount'       => true, |
  | 673 |  | 'products'       => true, |
  | 674 |  | 'date'           => true, |
  | 675 |  | 'notes'          => true, |
  | 676 |  | 'payment\_key'    => false, |
  | 677 |  | 'payment\_method' => true, |
  | 678 |  | 'payment\_id'     => true, |
  | 679 |  | ), $atts, 'edd\_receipt' ); |
  |  | 669 | $edd\_receipt\_args = shortcode\_atts( |
  |  | 670 | array( |
  |  | 671 | 'error'          => \_\_( 'Sorry, trouble retrieving order receipt.', 'easy-digital-downloads' ), |
  |  | 672 | 'price'          => true, |
  |  | 673 | 'discount'       => true, |
  |  | 674 | 'products'       => true, |
  |  | 675 | 'date'           => true, |
  |  | 676 | 'notes'          => true, |
  |  | 677 | 'payment\_key'    => false, |
  |  | 678 | 'payment\_method' => true, |
  |  | 679 | 'payment\_id'     => true, |
  |  | 680 | ), |
  |  | 681 | $atts, |
  |  | 682 | 'edd\_receipt' |
  |  | 683 | ); |
  | 680 | 684 |  |
  | 681 | 685 | $session = edd\_get\_purchase\_session(); |
  | 682 | 686 |  |
  |  | 687 | $payment\_key = false; |
  | 683 | 688 | if ( isset( $\_GET['payment\_key'] ) ) { |
  | 684 | 689 | $payment\_key = urldecode( $\_GET['payment\_key'] ); |
  | […](/browser/easy-digital-downloads/trunk/includes/shortcodes.php?rev=3008322#L691) | […](/browser/easy-digital-downloads/trunk/includes/shortcodes.php?rev=3060808#L696) |  |
  | 691 | 696 | } |
  | 692 | 697 |  |
  | 693 |  | ~~// No key found~~ |
  | 694 |  | if ( ! ~~isset( $payment\_key )~~ ) { |
  |  | 698 | $order = edd\_get\_order\_by( 'payment\_key', $payment\_key ); |
  |  | 699 | if ( ! $order ) { |
  | 695 | 700 | return '<p class="edd-alert edd-alert-error">' . $edd\_receipt\_args['error'] . '</p>'; |
  | 696 | 701 | } |
  | 697 | 702 |  |
  | 698 |  | ~~$order         = edd\_get\_order\_by( 'payment\_key', $payment\_key );~~ |
  | 699 | 703 | $user\_can\_view = edd\_can\_view\_receipt( $order ); |
  | 700 | 704 |  |
  | 701 |  | // Key was provided, but user is logged out. Offer them the ability to login and view the receipt |
  |  | 705 | // Key was provided, but user is logged out. Offer them the ability to login and view the receipt. |
  | 702 | 706 | if ( ! $user\_can\_view && ! empty( $payment\_key ) && ! is\_user\_logged\_in() && ! edd\_is\_guest\_payment( $order ) ) { |
  | 703 | 707 | global $edd\_login\_redirect; |
  | […](/browser/easy-digital-downloads/trunk/includes/shortcodes.php?rev=3008322#L716) | […](/browser/easy-digital-downloads/trunk/includes/shortcodes.php?rev=3060808#L720) |  |
  | 716 | 720 | $user\_can\_view = apply\_filters( 'edd\_user\_can\_view\_receipt', $user\_can\_view, $edd\_receipt\_args ); |
  | 717 | 721 |  |
  | 718 |  | // If this was a guest checkout and the purchase session is empty, output a relevant error message |
  |  | 722 | // If this was a guest checkout and the purchase session is empty, output a relevant error message. |
  | 719 | 723 | if ( empty( $session ) && ! is\_user\_logged\_in() && ! $user\_can\_view ) { |
  | 720 | 724 | return '<p class="edd-alert edd-alert-error">' . apply\_filters( 'edd\_receipt\_guest\_error\_message', \_\_( 'Receipt could not be retrieved, your purchase session has expired.', 'easy-digital-downloads' ) ) . '</p>'; |
* ## [easy-digital-downloads/trunk/includes/upgrades/functions.php](/changeset/3060808/easy-digital-downloads/trunk/includes/upgrades/functions.php?old=2965590&old_path=easy-digital-downloads%2Ftrunk%2Fincludes%2Fupgrades%2Ffunctions.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/includes/upgrades/functions.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/includes/upgrades/functions.php?rev=2965590#L123 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/includes/upgrades/functions.php?rev=3060808#L123 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 123 | 123 | 'update\_file\_download\_log\_data', |
  | 124 | 124 | 'migrate\_order\_actions\_date', // Added in 3.2, migrates the order actions run date to the order table. |
  |  | 125 | 'discounts\_start\_end', |
  | 125 | 126 | ); |
  | 126 | 127 | $edd\_30\_upgrades  = edd\_get\_v30\_upgrades(); |
* ## [easy-digital-downloads/trunk/languages/easy-digital-downloads.pot](/changeset/3060808/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?old=3042139&old_path=easy-digital-downloads%2Ftrunk%2Flanguages%2Feasy-digital-downloads.pot "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/languages/easy-digital-downloads.pot")

  | [r3042139](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L3 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L3 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | msgid "" |
  | 4 | 4 | msgstr "" |
  | 5 |  | "Project-Id-Version: Easy Digital Downloads 3.2.~~9~~\n" |
  |  | 5 | "Project-Id-Version: Easy Digital Downloads 3.2.10\n" |
  | 6 | 6 | "Report-Msgid-Bugs-To: https://wordpress.org/support/plugin/easy-digital-downloads\n" |
  | 7 | 7 | "Last-Translator: FULL NAME <EMAIL@ADDRESS>\n" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L10) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L10) |  |
  | 10 | 10 | "Content-Type: text/plain; charset=UTF-8\n" |
  | 11 | 11 | "Content-Transfer-Encoding: 8bit\n" |
  | 12 |  | "POT-Creation-Date: 2024-0~~2-26T21:12:16~~+00:00\n" |
  |  | 12 | "POT-Creation-Date: 2024-03-28T20:29:21+00:00\n" |
  | 13 | 13 | "PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n" |
  | 14 |  | "X-Generator: WP-CLI 2.~~9~~.0\n" |
  |  | 14 | "X-Generator: WP-CLI 2.10.0\n" |
  | 15 | 15 |  |
  | 16 | 16 | #. Plugin Name of the plugin |
  | 17 | 17 | #. Author of the plugin |
  |  | 18 | #: easy-digital-downloads.php |
  | 18 | 19 | #: includes/blocks/includes/functions.php:27 |
  | 19 | 20 | #: src/Admin/Onboarding/Steps/Tools.php:128 |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L24) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L25) |  |
  | 24 | 25 | #. Plugin URI of the plugin |
  | 25 | 26 | #. Author URI of the plugin |
  |  | 27 | #: easy-digital-downloads.php |
  | 26 | 28 | msgid "https://easydigitaldownloads.com" |
  | 27 | 29 | msgstr "" |
  | 28 | 30 |  |
  | 29 | 31 | #. Description of the plugin |
  |  | 32 | #: easy-digital-downloads.php |
  | 30 | 33 | msgid "The easiest way to sell digital products with WordPress." |
  | 31 | 34 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L5631) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L5634) |  |
  | 5631 | 5634 | #: includes/admin/settings/display-settings.php:44 |
  | 5632 | 5635 | #: includes/reports/reports-functions.php:336 |
  | 5633 |  | #: includes/upgrades/functions.php:14~~7~~ |
  |  | 5636 | #: includes/upgrades/functions.php:148 |
  | 5634 | 5637 | msgid "Discounts" |
  | 5635 | 5638 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L5823) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L5826) |  |
  | 5823 | 5826 | #: includes/users/lost-password.php:264 |
  | 5824 | 5827 | #: src/Emails/Triggers.php:126 |
  | 5825 |  | #: src/Extensions/Updater.php:~~481~~ |
  |  | 5828 | #: src/Extensions/Updater.php:580 |
  | 5826 | 5829 | msgid "Error" |
  | 5827 | 5830 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L5902) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L5905) |  |
  | 5902 | 5905 | #: includes/admin/settings/display-settings.php:41 |
  | 5903 | 5906 | #: includes/orders/functions/types.php:85 |
  | 5904 |  | #: includes/upgrades/functions.php:15~~1~~ |
  |  | 5907 | #: includes/upgrades/functions.php:152 |
  | 5905 | 5908 | msgid "Orders" |
  | 5906 | 5909 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L6564) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L6567) |  |
  | 6564 | 6567 | #: includes/admin/payments/orders.php:148 |
  | 6565 | 6568 | #: includes/admin/tools.php:110 |
  | 6566 |  | #: includes/upgrades/functions.php:16~~7~~ |
  |  | 6569 | #: includes/upgrades/functions.php:168 |
  | 6567 | 6570 | msgid "Logs" |
  | 6568 | 6571 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L6684) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L6687) |  |
  | 6684 | 6687 | #. translators: 1. email address; 2. user who removed email. |
  | 6685 | 6688 | #: includes/admin/customers/customer-actions.php:333 |
  | 6686 |  | #: includes/shortcodes.php:99~~3~~ |
  |  | 6689 | #: includes/shortcodes.php:997 |
  | 6687 | 6690 | msgid "Email address %1$s removed by %2$s" |
  | 6688 | 6691 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L7025) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L7028) |  |
  | 7025 | 7028 |  |
  | 7026 | 7029 | #: includes/admin/customers/customers.php:1104 |
  | 7027 |  | #: includes/upgrades/functions.php:15~~5~~ |
  |  | 7030 | #: includes/upgrades/functions.php:156 |
  | 7028 | 7031 | msgid "Customer Addresses" |
  | 7029 | 7032 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L7808) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L7811) |  |
  | 7808 | 7811 | msgstr "" |
  | 7809 | 7812 |  |
  |  | 7813 | #. translators: %1$s is the remove link, %2$s is the screen reader text. |
  | 7810 | 7814 | #: includes/admin/downloads/metabox.php:589 |
  | 7811 | 7815 | #: includes/admin/downloads/metabox.php:847 |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L8361) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L8365) |  |
  | 8361 | 8365 | #: includes/admin/reporting/class-export-download-history.php:62 |
  | 8362 | 8366 | #: includes/admin/reporting/export/class-batch-export-file-downloads.php:54 |
  | 8363 |  | #: includes/blocks/includes/orders/orders.php:55~~1~~ |
  |  | 8367 | #: includes/blocks/includes/orders/orders.php:554 |
  | 8364 | 8368 | #: includes/emails/email-summary/edd-email-summary-template.php:340 |
  | 8365 | 8369 | msgid "Product" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L9569) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L9573) |  |
  | 9569 | 9573 |  |
  | 9570 | 9574 | #: includes/admin/reporting/export/class-batch-export-downloads.php:52 |
  | 9571 |  | #: includes/blocks/includes/orders/orders.php:57~~6~~ |
  |  | 9575 | #: includes/blocks/includes/orders/orders.php:579 |
  | 9572 | 9576 | #: templates/history-downloads.php:46 |
  | 9573 | 9577 | msgid "Files" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L11143) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L11147) |  |
  | 11143 | 11147 | #: includes/admin/upgrades/upgrade-functions.php:427 |
  | 11144 | 11148 | #: includes/admin/upgrades/upgrade-functions.php:498 |
  | 11145 |  | #: includes/upgrades/functions.php:17~~5~~ |
  |  | 11149 | #: includes/upgrades/functions.php:176 |
  | 11146 | 11150 | msgid "Remove Legacy Data" |
  | 11147 | 11151 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L11192) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L11196) |  |
  | 11192 | 11196 | msgstr "" |
  | 11193 | 11197 |  |
  | 11194 |  | #: includes/admin/upgrades/v3/class-data-migrator.php:40~~5~~ |
  |  | 11198 | #: includes/admin/upgrades/v3/class-data-migrator.php:408 |
  | 11195 | 11199 | #: src/Upgrades/Orders/MigrateAfterActionsDate.php:193 |
  | 11196 | 11200 | msgid "After payment actions processed." |
  | 11197 | 11201 | msgstr "" |
  | 11198 | 11202 |  |
  | 11199 |  | #: includes/admin/upgrades/v3/class-data-migrator.php:13~~56~~ |
  |  | 11203 | #: includes/admin/upgrades/v3/class-data-migrator.php:1362 |
  | 11200 | 11204 | #: src/CLI/Migration/Discounts.php:60 |
  | 11201 | 11205 | msgid "Legacy Discount" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L11299) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L11303) |  |
  | 11299 | 11303 |  |
  | 11300 | 11304 | #: includes/admin/views/tmpl-order-adjustment-discount.php:27 |
  | 11301 |  | #: includes/discount-functions.php:133~~3~~ |
  |  | 11305 | #: includes/discount-functions.php:1336 |
  | 11302 | 11306 | msgid "Remove discount" |
  | 11303 | 11307 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L11309) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L11313) |  |
  | 11309 | 11313 | #: includes/blocks/views/orders/discounts.php:7 |
  | 11310 | 11314 | #: includes/checkout/template.php:753 |
  | 11311 |  | #: includes/discount-functions.php:1~~297~~ |
  |  | 11315 | #: includes/discount-functions.php:1300 |
  | 11312 | 11316 | #: templates/shortcode-receipt.php:87 |
  | 11313 | 11317 | msgid "Discount" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L11804) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L11808) |  |
  | 11804 | 11808 |  |
  | 11805 | 11809 | #: includes/blocks/includes/orders/functions.php:38 |
  | 11806 |  | #: includes/blocks/includes/orders/orders.php:14~~3~~ |
  |  | 11810 | #: includes/blocks/includes/orders/orders.php:146 |
  | 11807 | 11811 | msgid "View Order Details" |
  | 11808 | 11812 | msgstr "" |
  | 11809 | 11813 |  |
  | 11810 |  | #: includes/blocks/includes/orders/orders.php:11~~1~~ |
  |  | 11814 | #: includes/blocks/includes/orders/orders.php:115 |
  | 11811 | 11815 | msgid "To view a sample confirmation screen, you need to have at least one order in your store." |
  | 11812 | 11816 | msgstr "" |
  | 11813 | 11817 |  |
  | 11814 |  | #: includes/blocks/includes/orders/orders.php:11~~4~~ |
  |  | 11818 | #: includes/blocks/includes/orders/orders.php:118 |
  | 11815 | 11819 | msgid "Your purchase session could not be retrieved." |
  | 11816 | 11820 | msgstr "" |
  | 11817 | 11821 |  |
  | 11818 |  | #: includes/blocks/includes/orders/orders.php:16~~5~~ |
  | 11819 |  | #: includes/shortcodes.php:67~~0~~ |
  |  | 11822 | #: includes/blocks/includes/orders/orders.php:168 |
  |  | 11823 | #: includes/shortcodes.php:671 |
  | 11820 | 11824 | msgid "Sorry, trouble retrieving order receipt." |
  | 11821 | 11825 | msgstr "" |
  | 11822 | 11826 |  |
  | 11823 |  | #: includes/blocks/includes/orders/orders.php:17~~5~~ |
  |  | 11827 | #: includes/blocks/includes/orders/orders.php:179 |
  | 11824 | 11828 | msgid "To view a sample receipt, you need to have at least one order in your store." |
  | 11825 | 11829 | msgstr "" |
  | 11826 | 11830 |  |
  | 11827 |  | #: includes/blocks/includes/orders/orders.php:22~~0~~ |
  |  | 11831 | #: includes/blocks/includes/orders/orders.php:223 |
  | 11828 | 11832 | msgid "Sorry, you do not have permission to view this receipt." |
  | 11829 | 11833 | msgstr "" |
  | 11830 | 11834 |  |
  | 11831 |  | #: includes/blocks/includes/orders/orders.php:2~~29~~ |
  |  | 11835 | #: includes/blocks/includes/orders/orders.php:232 |
  | 11832 | 11836 | msgid "Please confirm your email address to access your downloads." |
  | 11833 | 11837 | msgstr "" |
  | 11834 | 11838 |  |
  | 11835 |  | #: includes/blocks/includes/orders/orders.php:2~~39~~ |
  |  | 11839 | #: includes/blocks/includes/orders/orders.php:242 |
  | 11836 | 11840 | msgid "Please log in to view your order." |
  | 11837 | 11841 | msgstr "" |
  | 11838 | 11842 |  |
  | 11839 |  | #: includes/blocks/includes/orders/orders.php:27~~1~~ |
  |  | 11843 | #: includes/blocks/includes/orders/orders.php:274 |
  | 11840 | 11844 | msgid "Please log in to access your downloads." |
  | 11841 | 11845 | msgstr "" |
  | 11842 | 11846 |  |
  | 11843 |  | #: includes/blocks/includes/orders/orders.php:2~~87~~ |
  | 11844 |  | #: includes/blocks/includes/orders/orders.php:~~299~~ |
  |  | 11847 | #: includes/blocks/includes/orders/orders.php:290 |
  |  | 11848 | #: includes/blocks/includes/orders/orders.php:302 |
  | 11845 | 11849 | msgid "Your email address could not be verified." |
  | 11846 | 11850 | msgstr "" |
  | 11847 | 11851 |  |
  | 11848 |  | #: includes/blocks/includes/orders/orders.php:32~~6~~ |
  |  | 11852 | #: includes/blocks/includes/orders/orders.php:329 |
  | 11849 | 11853 | #: includes/blocks/views/orders/receipt-files.php:70 |
  | 11850 | 11854 | #: includes/emails/tags.php:377 |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L12285) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L12289) |  |
  | 12285 | 12289 | msgstr "" |
  | 12286 | 12290 |  |
  |  | 12291 | #. Translators: %s is the name of the download that was added to the cart. |
  | 12287 | 12292 | #: includes/cart/template.php:311 |
  | 12288 | 12293 | msgid "Checkout." |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L13188) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L13193) |  |
  | 13188 | 13193 | #: includes/class-edd-discount.php:1676 |
  | 13189 | 13194 | #: includes/class-edd-discount.php:1707 |
  | 13190 |  | #: includes/discount-functions.php:101~~6~~ |
  |  | 13195 | #: includes/discount-functions.php:1019 |
  | 13191 | 13196 | msgctxt "error for when a discount is invalid based on its configuration" |
  | 13192 | 13197 | msgid "This discount is invalid." |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L13760) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L13765) |  |
  | 13760 | 13765 | msgstr "" |
  | 13761 | 13766 |  |
  | 13762 |  | #: includes/discount-functions.php:501 |
  |  | 13767 | #. translators: 1: Function name, 2: Version number, 3: Replacement function name |
  |  | 13768 | #: includes/discount-functions.php:505 |
  | 13763 | 13769 | msgid "%1$s is deprecated since Easy Digital Downloads version %2$s! Use %3$s instead." |
  | 13764 | 13770 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L13778) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L13784) |  |
  | 13778 | 13784 | #. translators: the plugin name. |
  | 13779 | 13785 | #: includes/EDD\_SL\_Plugin\_Updater.php:224 |
  | 13780 |  | #: src/Extensions/Updater.php:~~244~~ |
  |  | 13786 | #: src/Extensions/Updater.php:338 |
  | 13781 | 13787 | msgid "There is a new version of %1$s available." |
  | 13782 | 13788 | msgstr "" |
  | 13783 | 13789 |  |
  | 13784 | 13790 | #: includes/EDD\_SL\_Plugin\_Updater.php:230 |
  | 13785 |  | #: src/Extensions/Updater.php:~~250~~ |
  |  | 13791 | #: src/Extensions/Updater.php:344 |
  | 13786 | 13792 | msgid "Contact your network administrator to install the update." |
  | 13787 | 13793 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L13789) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L13795) |  |
  | 13789 | 13795 | #. translators: 1. opening anchor tag, do not translate 2. the new plugin version 3. closing anchor tag, do not translate. |
  | 13790 | 13796 | #: includes/EDD\_SL\_Plugin\_Updater.php:235 |
  | 13791 |  | #: src/Extensions/Updater.php:~~255~~ |
  |  | 13797 | #: src/Extensions/Updater.php:349 |
  | 13792 | 13798 | msgid "%1$sView version %2$s details%3$s." |
  | 13793 | 13799 | msgstr "" |
  | 13794 | 13800 |  |
  |  | 13801 | #. translators: 1. opening anchor tag, do not translate 2. the new plugin version 3. closing anchor tag, do not translate 4. opening anchor tag, do not translate 5. closing anchor tag, do not translate. |
  | 13795 | 13802 | #: includes/EDD\_SL\_Plugin\_Updater.php:243 |
  | 13796 |  | #: src/Extensions/Updater.php:~~263~~ |
  |  | 13803 | #: src/Extensions/Updater.php:358 |
  | 13797 | 13804 | msgid "%1$sView version %2$s details%3$s or %4$supdate now%5$s." |
  | 13798 | 13805 | msgstr "" |
  | 13799 | 13806 |  |
  | 13800 | 13807 | #: includes/EDD\_SL\_Plugin\_Updater.php:254 |
  | 13801 |  | #: src/Extensions/Updater.php:~~274~~ |
  |  | 13808 | #: src/Extensions/Updater.php:369 |
  | 13802 | 13809 | msgid "Update now." |
  | 13803 | 13810 | msgstr "" |
  | 13804 | 13811 |  |
  | 13805 | 13812 | #: includes/EDD\_SL\_Plugin\_Updater.php:486 |
  | 13806 |  | #: src/Extensions/Updater.php:~~481~~ |
  |  | 13813 | #: src/Extensions/Updater.php:580 |
  | 13807 | 13814 | msgid "You do not have permission to install plugin updates" |
  | 13808 | 13815 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L15417) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L15424) |  |
  | 15417 | 15424 | msgstr "" |
  | 15418 | 15425 |  |
  | 15419 |  | #: includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php:4~~30~~ |
  |  | 15426 | #: includes/gateways/stripe/includes/class-edd-stripe-rate-limiting.php:429 |
  | 15420 | 15427 | #: includes/gateways/stripe/includes/payment-actions/card-elements-actions.php:42 |
  | 15421 | 15428 | #: includes/gateways/stripe/includes/template-functions.php:24 |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L17026) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L17033) |  |
  | 17026 | 17033 | msgstr "" |
  | 17027 | 17034 |  |
  | 17028 |  | #: includes/shortcodes.php:7~~08~~ |
  |  | 17035 | #: includes/shortcodes.php:712 |
  | 17029 | 17036 | msgid "You must be logged in to view this payment receipt." |
  | 17030 | 17037 | msgstr "" |
  | 17031 | 17038 |  |
  | 17032 |  | #: includes/shortcodes.php:72~~0~~ |
  |  | 17039 | #: includes/shortcodes.php:724 |
  | 17033 | 17040 | msgid "Receipt could not be retrieved, your purchase session has expired." |
  | 17034 | 17041 | msgstr "" |
  | 17035 | 17042 |  |
  | 17036 |  | #: includes/shortcodes.php:80~~4~~ |
  |  | 17043 | #: includes/shortcodes.php:808 |
  | 17037 | 17044 | msgid "Your profile could not be updated. Please contact a site administrator." |
  | 17038 | 17045 | msgstr "" |
  | 17039 | 17046 |  |
  | 17040 |  | #: includes/shortcodes.php:84~~0~~ |
  |  | 17047 | #: includes/shortcodes.php:844 |
  | 17041 | 17048 | msgid "The passwords you entered do not match. Please try again." |
  | 17042 | 17049 | msgstr "" |
  | 17043 | 17050 |  |
  | 17044 |  | #: includes/shortcodes.php:85~~1~~ |
  |  | 17051 | #: includes/shortcodes.php:855 |
  | 17045 | 17052 | msgid "The email you entered is invalid. Please enter a valid email." |
  | 17046 | 17053 | msgstr "" |
  | 17047 | 17054 |  |
  | 17048 |  | #: includes/shortcodes.php:86~~2~~ |
  |  | 17055 | #: includes/shortcodes.php:866 |
  | 17049 | 17056 | #: includes/users/register.php:77 |
  | 17050 | 17057 | msgid "This email address is not available." |
  | 17051 | 17058 | msgstr "" |
  | 17052 | 17059 |  |
  | 17053 |  | #: includes/shortcodes.php:~~997~~ |
  |  | 17060 | #: includes/shortcodes.php:1001 |
  | 17054 | 17061 | msgid "Error removing email address from profile. Please try again later." |
  | 17055 | 17062 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L17128) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L17135) |  |
  | 17128 | 17135 | msgstr "" |
  | 17129 | 17136 |  |
  | 17130 |  | #: includes/upgrades/functions.php:14~~3~~ |
  |  | 17137 | #: includes/upgrades/functions.php:144 |
  | 17131 | 17138 | msgid "Tax Rates" |
  | 17132 | 17139 | msgstr "" |
  | 17133 | 17140 |  |
  | 17134 |  | #: includes/upgrades/functions.php:1~~59~~ |
  |  | 17141 | #: includes/upgrades/functions.php:160 |
  | 17135 | 17142 | msgid "Customer Email Addresses" |
  | 17136 | 17143 | msgstr "" |
  | 17137 | 17144 |  |
  | 17138 |  | #: includes/upgrades/functions.php:16~~3~~ |
  |  | 17145 | #: includes/upgrades/functions.php:164 |
  | 17139 | 17146 | msgid "Customer Notes" |
  | 17140 | 17147 | msgstr "" |
  | 17141 | 17148 |  |
  | 17142 |  | #: includes/upgrades/functions.php:17~~1~~ |
  |  | 17149 | #: includes/upgrades/functions.php:172 |
  | 17143 | 17150 | msgid "Order Notes" |
  | 17144 | 17151 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L17618) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L17625) |  |
  | 17618 | 17625 | msgstr "" |
  | 17619 | 17626 |  |
  |  | 17627 | #. translators: %s is the name of the extension. |
  | 17620 | 17628 | #: src/Admin/Extensions/Legacy.php:45 |
  | 17621 | 17629 | msgid "%s is now part of EDD!" |
  | 17622 | 17630 | msgstr "" |
  | 17623 | 17631 |  |
  |  | 17632 | #. translators: %s is the name of the extension. |
  | 17624 | 17633 | #: src/Admin/Extensions/Legacy.php:50 |
  | 17625 | 17634 | msgid "The functionality of %s has been merged into Easy Digital Downloads. It has been deactivated and you can safely delete the %s plugin." |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L19812) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L19821) |  |
  | 19812 | 19821 |  |
  | 19813 | 19822 | #: src/Downloads/Search.php:96 |
  | 19814 |  | #: src/HTML/ProductSelect.php:25~~2~~ |
  |  | 19823 | #: src/HTML/ProductSelect.php:257 |
  | 19815 | 19824 | msgid "All Price Options" |
  | 19816 | 19825 | msgstr "" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L20174) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L20183) |  |
  | 20174 | 20183 | msgstr "" |
  | 20175 | 20184 |  |
  | 20176 |  | #: src/HTML/Select.php:10~~9~~ |
  |  | 20185 | #: src/HTML/Select.php:107 |
  | 20177 | 20186 | msgctxt "all dropdown items" |
  | 20178 | 20187 | msgid "All" |
  | 20179 | 20188 | msgstr "" |
  | 20180 | 20189 |  |
  | 20181 |  | #: src/HTML/Select.php:1~~10~~ |
  |  | 20190 | #: src/HTML/Select.php:108 |
  | 20182 | 20191 | msgctxt "no dropdown items" |
  | 20183 | 20192 | msgid "None" |
  | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3042139#L20410) | […](/browser/easy-digital-downloads/trunk/languages/easy-digital-downloads.pot?rev=3060808#L20419) |  |
  | 20410 | 20419 | #: src/Telemetry/Tracking.php:299 |
  | 20411 | 20420 | msgid "%1$sHere is what we track.%2$s" |
  |  | 20421 | msgstr "" |
  |  | 20422 |  |
  |  | 20423 | #: src/Upgrades/Adjustments/DiscountsStartEnd.php:197 |
  |  | 20424 | msgid "Discount Updates Complete!" |
  |  | 20425 | msgstr "" |
  |  | 20426 |  |
  |  | 20427 | #: src/Upgrades/Adjustments/DiscountsStartEnd.php:198 |
  |  | 20428 | msgid "Easy Digital Downloads has finished updating your discount codes! Thank you for your patience." |
  |  | 20429 | msgstr "" |
  |  | 20430 |  |
  |  | 20431 | #. translators: %s is the % complete. |
  |  | 20432 | #: src/Upgrades/Adjustments/DiscountsStartEnd.php:226 |
  |  | 20433 | msgid "Updating Discounts ( %d%% )" |
  |  | 20434 | msgstr "" |
  |  | 20435 |  |
  |  | 20436 | #: src/Upgrades/Adjustments/DiscountsStartEnd.php:249 |
  |  | 20437 | msgid "Easy Digital Downloads is performing maintenance in the background on discount codes that may contain invalid start and end dates. This process may take a while to complete depending on the number of discounts you have. We'll let you know when the process is complete." |
  | 20412 | 20438 | msgstr "" |
  | 20413 | 20439 |  |
* ## [easy-digital-downloads/trunk/readme.txt](/changeset/3060808/easy-digital-downloads/trunk/readme.txt?old=3042139&old_path=easy-digital-downloads%2Ftrunk%2Freadme.txt "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/readme.txt")

  | [r3042139](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L7 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L7 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | Tested up to: 6.4 |
  | 8 | 8 | Requires PHP: 7.4 |
  | 9 |  | Stable Tag: 3.2.~~9~~ |
  |  | 9 | Stable Tag: 3.2.10 |
  | 10 | 10 | License: GNU Version 2 or Any Later Version |
  | 11 | 11 |  |
  | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L27) | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L27) |  |
  | 27 | 27 | [youtube https://www.youtube.com/watch?v=kUEdc8sB3uQ] |
  | 28 | 28 |  |
  | 29 |  | = E~~asy~~ checkout form = |
  |  | 29 | = Effortless payments with a checkout form = |
  | 30 | 30 |  |
  | 31 | 31 | With 1-Click connections to the most popular payment processors, you'll be selling within minutes, allowing your customers to checkout with ease with the ability to choose from the most popular payment methods in their region of the world. With Stripe and PayPal, your ecommerce store is ready for global payments. |
  | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L37) | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L37) |  |
  | 37 | 37 |  |
  | 38 | 38 | When you use the included payment processor integrations, you get immediate access to the following: |
  |  | 39 |  |
  | 39 | 40 | \* Credit Card Payments |
  | 40 | 41 | \* Apple Pay |
  | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L49) | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L50) |  |
  | 49 | 50 |  |
  | 50 | 51 | With our included integrations, new payment methods are added when they become available, usually without any updates or changes! |
  |  | 52 |  |
  |  | 53 | = Make decisions with powerful reporting = |
  |  | 54 | Unlock the full potential of your digital store with Easy Digital Downloads — the best WordPress ecommerce solution renowned for its powerful reporting features. Dive deep into the heart of your digital business with tools designed not just to give you insights into what is happening in your business now, but also to help you make decisions that will help you grow your business. |
  |  | 55 |  |
  |  | 56 | With the included date comparison tools, you can compare your sales, revenue, customers, and other data from one period to another, giving you the insights to make informed decisions and accelerate your growth. Some of the data points you get access to include: |
  |  | 57 | \* Customer growth |
  |  | 58 | \* Revenue and Sales |
  |  | 59 | \* Filtering by product |
  |  | 60 | \* Detailed category and tag reports |
  |  | 61 | \* Revenue and Sales by Country |
  |  | 62 | \* Revenue and Sales by Payment Method |
  |  | 63 | \* and more! |
  | 51 | 64 |  |
  | 52 | 65 | = Full Easy Digital Downloads Feature List = |
  | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L104) | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L117) |  |
  | 104 | 117 | 2. Complete the Onboarding Wizard |
  | 105 | 118 | 3. Start selling your first product! |
  | 106 |  | 4. For more detailed setup instructions, vist the official [Documentation](https://easydigitaldownloads.com/docs/quickstart-guide/?utm\_source=docs&utm\_medium=installation\_tab&utm\_content=documentation&utm\_campaign=readme) page. |
  |  | 119 | 4. For more detailed setup instructions, visit the official [Documentation](https://easydigitaldownloads.com/docs/quickstart-guide/?utm\_source=docs&utm\_medium=installation\_tab&utm\_content=documentation&utm\_campaign=readme) page. |
  | 107 | 120 |  |
  | 108 | 121 | == Frequently Asked Questions == |
  | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L126) | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L139) |  |
  | 126 | 139 | = Is an SSL certificate required to sell digital products? = |
  | 127 | 140 |  |
  | 128 |  | ~~Easy Digital Downloads can function without an SSL certificate just fine, making it easy to set up in a testing or development environment.  We still strongly recommend you have an SSL certificate for your live store, both for security and for the peace of mind of your customers~~. [Documentation here](https://easydigitaldownloads.com/docs/do-i-need-an-ssl-certificate/?994-how-to-set-up-ssl?utm\_source=docs&utm\_medium=faq\_tab&utm\_content=documentation&utm\_campaign=readme) |
  |  | 141 | The security of you and your customers' data is very important, so we strongly recommend you have an SSL certificate for your store. [Documentation here](https://easydigitaldownloads.com/docs/do-i-need-an-ssl-certificate/?994-how-to-set-up-ssl?utm\_source=docs&utm\_medium=faq\_tab&utm\_content=documentation&utm\_campaign=readme) |
  | 129 | 142 |  |
  | 130 | 143 | = What themes work with Easy Digital Downloads? = |
  | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L134) | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L147) |  |
  | 134 | 147 | = Is there a sample import file I can use to setup a demo store? = |
  | 135 | 148 |  |
  | 136 |  | Yes! Simply go to Tools > Import and install the WordPress Importer, then ~~navigate to~~ wp-content/plugins/easy-digital-downloads/assets/ and select the sample-products-import.xml file. This will create several sample products and plugin pages for you. |
  |  | 149 | Yes! Simply go to Tools > Import and install the WordPress Importer, then you can use the XML file located at wp-content/plugins/easy-digital-downloads/assets/ and select the sample-products-import.xml file. This will create several sample products and plugin pages for you. |
  | 137 | 150 |  |
  | 138 | 151 | = Can I import all the products from my existing store into EDD? = |
  | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L211) | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L224) |  |
  | 211 | 224 |  |
  | 212 | 225 | == Changelog == |
  |  | 226 | = 3.2.10 = |
  |  | 227 | \* Downloads: Improved performance when creating and managing download directories. |
  |  | 228 | \* Discounts: Start and End dates are properly handling the timezone. |
  |  | 229 | \* Discounts: Improved the accuracy of the check for if a store has active discounts. |
  |  | 230 | \* Discounts: A background upgrade process will be run to ensure all discounts have valid start and end dates. |
  |  | 231 | \* Dev: Debug log is now being managed within EDD's upload directory. |
  |  | 232 | \* Payments: Improved the detection and handling of purchase sessions when displaying the Receipt and Confirmation pages. |
  |  | 233 | \* Performance: Optimized the amount of data stored in the options table related to changelogs. |
  |  | 234 | \* HTML: The Product Dropdown could be forced to include items that were not products. |
  |  | 235 | \* HTML: The Product Dropdown has had its placeholder value improved. |
  |  | 236 | \* HTML: The Product Dropdown could have an unexpected empty option in the list of options. |
  |  | 237 | \* HTML: The Textarea HTML field could add empty content to the value. |
  |  | 238 | \* Checkout: The Privacy Policy checkbox may not always show when expected. |
  |  | 239 | \* Blocks: Improved loading of Easy Digital Download blocks. |
  |  | 240 | \* Blocks: Improved the handling of Easy Digital Download blocks when using a classic theme. |
  |  | 241 | \* Orders: Manually creating orders in the admin could fail to save the order due to a capability check. |
  |  | 242 | \* Migration: Improved the reliability of the EDD 3.0+ migration routine for possibly corrupt serialized data. |
  |  | 243 | \* Migration: Improved PHP 8.0+ compatibility for the EDD 3.0+ migration routine. |
  |  | 244 |  |
  |  | 245 | View the full changelog at [https://easydigitaldownloads.com/changelogs/plugin/easy-digital-downloads/](https://easydigitaldownloads.com/changelogs/plugin/easy-digital-downloads/?utm\_medium=readme&utm\_source=wporg&utm\_campaign=edd-plugin&utm\_term=description) |
  | 213 | 246 |  |
  | 214 | 247 | = 3.2.9 = |
  | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L217) | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L250) |  |
  | 217 | 250 | \* Reports: When using custom dates for reporting, some timezone settings could make the dates show incorrectly. |
  | 218 | 251 | \* Emails: Adjusted when the deprecation notices will be shown for the legacy email hooks. |
  | 219 |  |  |
  | 220 |  | ~~View the full changelog at [https://easydigitaldownloads.com/changelogs/plugin/easy-digital-downloads/](https://easydigitaldownloads.com/changelogs/plugin/easy-digital-downloads/?utm\_medium=readme&utm\_source=wporg&utm\_campaign=edd-plugin&utm\_term=description)~~ |
  | 221 | 252 |  |
  | 222 | 253 | = 3.2.8 = |
  | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3042139#L264) | […](/browser/easy-digital-downloads/trunk/readme.txt?rev=3060808#L295) |  |
  | 264 | 295 | \* Discounts: Ensure store discounts recorded for orders are unique. |
  | 265 | 296 |  |
  |  | 297 | = 3.2.5 = |
  |  | 298 | \* Compatibility: Improved compatibility with servers not configured with mbstring. |
  |  | 299 | \* PayPal: Improved detection of PayPal order session handling and processing. |
  |  | 300 |  |
  |  | 301 | = 3.2.4 = |
  |  | 302 | \* Compatibility: Adds support for PHP 8.2. |
  |  | 303 | \* PayPal: Improve error handling of PayPal API responses. |
  |  | 304 | \* REST API: Download terms now have the featured images in the JSON response. |
  |  | 305 | \* Checkout: Improved the checkout block login and registration handling. |
  |  | 306 | \* Checkout: The legacy shortcode properly handles required fields. |
  |  | 307 | \* Emails: Improved sample data for the purchase confirmation preview. |
  |  | 308 | \* Refunds: Improved refund status handling and validation. |
  |  | 309 | \* Downloads: Bulk editing no longer clears prices. |
  |  | 310 | \* Downloads: Improved the ability to filter the ‘supports buy now’ for a download. |
  |  | 311 | \* Downloads: Reliability of the file download limits was improved. |
  |  | 312 | \* Store: Encourage store owners to set a country to help prepare for upcoming features. |
  |  | 313 | \* Privacy: Enhanced the integration with the WordPress Privacy tools. |
  |  | 314 | \* Reports: Improved chart sizing to prevent overlap and overflow. |
  |  | 315 | \* Dates: Added a polyfill for servers without `mbstring`. |
  |  | 316 | \* Support: Made links to support and documentation more accessible. |
  |  | 317 | \* Taxes: Corrected an issue with subscription updates when taxes are enabled. |
  |  | 318 | \* Registration: Fixed an issue with Recaptcha on the registration form. |
  |  | 319 |  |
  |  | 320 | = 3.2.3 = |
  |  | 321 | \* Blocks: The user registration forms and lost password feature have been updated to allow customization via hooks. |
  |  | 322 | \* Stripe: Refunded payments initiated within the Stripe Dashboard now create a refund order in EDD. |
  |  | 323 | \* Cart: Improved product validation when adding an item to the cart. |
  |  | 324 | \* Emails: Admin payment & order notifications have been updated to allow further customization. |
  |  | 325 | \* Block Editor: Improved compatibility with themes and page builders. |
  |  | 326 | \* Payments: Ensure that tax rates are accurately stored when using legacy payment creation processes. |
  |  | 327 | \* Customers: Improved the performance and accuracy of checking if a user has previously made purchases. |
  |  | 328 |  |
  |  | 329 | = 3.2.2 = |
  |  | 330 | \* PayPal: The IPN Backup for PayPal was fixed to prevent a fatal error. |
  |  | 331 | \* PayPal: Improved the Buy Now with PayPal payments to bypass Checkout only when Buy Now is fully supported. |
  |  | 332 | \* PayPal: Improved the reliability of the PayPal IPN listener. |
  |  | 333 | \* Stripe: Improved the Buy Now with Stripe payments to bypass Checkout only when Buy Now is fully supported by the product. |
  |  | 334 | \* Stripe: The State/Region ensures that it is updated when the Country field is changed. |
  |  | 335 | \* Emails: Further improved the reliability of payment emails and admin payment notifications. |
  |  | 336 | \* Customers: Migrating the customer data from EDD 2.x to EDD 3.x is now more reliable. |
  |  | 337 | \* Customers: Existing guest customers can now use the EDD Registration form to create a user. |
  |  | 338 | \* Customers: Improved the customer email address detection and reliability. |
  |  | 339 | \* Payments: Updated the customer recent payments list to use the correct date format. |
  |  | 340 | \* Blocks: Improved the reliability of checkout when EDD Blocks or Gutenberg are disabled. |
  |  | 341 |  |
  |  | 342 | = 3.2.1 = |
  |  | 343 | \* Stripe: We’ve improved the error handling and informational messaging related to the Stripe Payments integration. |
  |  | 344 | \* PayPal: When new features are added to the PayPal integration, a background process attempts to register new payment endpoints automatically. |
  |  | 345 | \* API: Accessing the file download logs via the EDD API now supports querying by both customer ID and customer email address. |
  |  | 346 |  |
  |  | 347 | = 3.2.0 = |
  |  | 348 | \* Important: This release requires PHP 7.4 or higher and WordPress 5.8 or higher. |
  |  | 349 | \* Important: Amazon Pay has been formally deprecated and is no longer available for new installs. Existing stores using Amazon Pay are encouraged to explore other options. |
  |  | 350 | \* New: PHP 8.1 is now fully supported. |
  |  | 351 | \* New: Discount codes can now be applied to specific price variations. |
  |  | 352 | \* New: A discount code can now be set to include or exclude specific download categories. |
  |  | 353 | \* New: Store owners can now archive discount codes, to make managing their promotions simpler. |
  |  | 354 | \* New: The discount list now has improved visibility for the status and usage of discounts. |
  |  | 355 | \* New: A new ‘Service’ product type was added to the Product Type dropdown, to allow for non-downloadable products. |
  |  | 356 | \* New: Disputed payments in PayPal and Stripe set the order to a new ‘On Hold’ status, and restrict access to downloads. |
  |  | 357 | \* New: When a payment is disputed with PayPal or Stripe, a link to the dispute is added to the view order details in the admin along with order notes. |
  |  | 358 | \* New: The date that the completed order actions were run is now stored as part of the order itself, not as metadata, and will be displayed more clearly on the order details screens. Existing meta will be migrated in the background; notifications will be updated to keep store owners advised of progress. |
  |  | 359 | \* Improvement: Purchase receipts are now sent using deferred actions, to improve the performance of the payment processing. |
  |  | 360 | \* Improvement: The bundle product metabox has been improved for performance on sites with many products. |
  |  | 361 | \* Improvement: The query for non-bundled products has been updated to be more performant, specifically when editing a download product. |
  |  | 362 | \* Improvement: Improved performance of checkout and customer lookups by conditionally running legacy hooks and filters that contained payment objects. |
  |  | 363 | \* Improvement: Site Health and telemetry now check the health of the REST API via a test endpoint. |
  |  | 364 | \* Improvement: The application fee for Stripe payments is removed for pass holders who have access to the Stripe Pro extension even if they do not have Stripe Pro installed. |
  |  | 365 | \* Improvement: Easy Digital Downloads’ block styles have been updated for non block themes to load only when the block is rendered. |
  |  | 366 | \* Improvement: The EDD Products block now allows products to be filtered by author. |
  |  | 367 | \* Fix: Stripe Payment Elements no longer supported a theme of ‘none’, and ‘stripe’ has been defaulted. |
  |  | 368 | \* Fix: Added hardening around viewing the adjustments list table. |
  |  | 369 | \* Fix: To avoid conflicts with other plugins, critical vendor libraries have been moved to the EDD namespace. |
  |  | 370 | \* Fix: Regional support for Stripe now checks the Stripe account country before checking the store country. |
  |  | 371 | \* Fix: PayPal Commerce orders where not always being completed when using the confirmation page. |
  |  | 372 | \* Fix: The Stripe Payment Element now uses the browser’s locale for localization. |
  |  | 373 | \* Fix: Using the Import tool could produce a fatal error. |
  |  | 374 | \* Fix: Discount codes resulting in a 100% discount could restrict the cart from allowing the user to complete the purchase. |
  |  | 375 | \* Fix: Saved carts were not correctly saving for some users. |
  |  | 376 | \* Fix: When saving a cart with Stripe as the active gateway, the message stating the cart was saved was removed prematurely. |
  |  | 377 | \* Fix: Recalculating a customer’s stats was not always being scheduled correctly. |
  |  | 378 | \* Fix: Malformed add to cart URLs could result in a PHP warning being thrown. |
  |  | 379 | \* Fix: Flat discount can result in an incorrect rounding total depending on the cart conditions. |
  |  | 380 | \* Fix: Viewing the order details of a migrated order that had its discount deleted looked incomplete. |
  |  | 381 | \* Fix: It was possible for sites with incompatible MySQL versions to not see the appropriate warnings. |
  |  | 382 | \* Fix: Attempting to activate a pass with an empty license key could appear to be stuck. |
  |  | 383 | \* Fix: The Stripe JavaScript has been improved to be more efficient, remove only error messages, and only run when the Stripe gateway is selected. |
  |  | 384 | \* Fix: Stripe could attempt to update a property that is not supported by the Stripe API. |
  |  | 385 | \* Fix: New PayPal Commerce subscriptions might not be correctly marked as complete. |
  |  | 386 | \* Fix: EDD Blocks placeholder styles could interfere with WordPress Core placeholders. |
  |  | 387 | \* Fix: Additional, not officially supported fee data is now stored as order adjustment metadata. |
  |  | 388 | \* Dev: Many filters and hooks that passed EDD\_Payment objects now have a complimentary hook or filter that uses EDD\Orders\Order objects. |
  |  | 389 | \* Dev: Easy Digital Downloads is no longer registering the edd\_payment and edd\_discount post types. |
  |  | 390 | \* Dev: Easy Digital Downloads – Core now holds the Stripe base code, and Stripe Pro 3.0.0 only contains pro features. |
  |  | 391 | \* Dev: Code for old, unsupported versions of PHP has been removed. |
  |  | 392 | \* Dev: A new edd\_after\_order\_actions hook has been introduced to manage all events which should happen when an order is created. This uses the order object for improved performance and any usage of edd\_after\_payment\_actions should be updated accordingly. |
  |  | 393 | \* i18n: 141 Additions, 199 Removals/Location Changes, 17 Differences (counts are approximate). |
  |  | 394 |  |
  | 266 | 395 | == Upgrade Notice == |
  | 267 | 396 | IMPORTANT: Upgrading from Easy Digital Downloads 2.x to 3.0+ is a major release that includes many improvements and changes. You will be asked to perform database maintenance once installed. Please ensure you make a backup of your site prior to upgrading. Your site should remain functional during this maintenance, but as with all updates, it is best to make a backup of your site prior to updating. |
* ## [easy-digital-downloads/trunk/src/Core.php](/changeset/3060808/easy-digital-downloads/trunk/src/Core.php?old=3036940&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FCore.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/Core.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/Core.php?rev=3036940#L37 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/Core.php?rev=3060808#L37 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 37 | 37 |  |
  | 38 | 38 | // Upgrades. |
  | 39 |  | new Upgrades\~~Orders\MigrateAfterActionsDate~~(), |
  |  | 39 | new Upgrades\Loader(), |
  | 40 | 40 |  |
  | 41 | 41 | // Compatibility. |
* ## [easy-digital-downloads/trunk/src/Emails/Types/Email.php](/changeset/3060808/easy-digital-downloads/trunk/src/Emails/Types/Email.php?old=3042139&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FEmails%2FTypes%2FEmail.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/Emails/Types/Email.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/Emails/Types/Email.php?rev=3042139#L141 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/Emails/Types/Email.php?rev=3060808#L141 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 141 | 141 | \* Magic method to get properties. |
  | 142 | 142 | \* |
  | 143 |  | \* @since ~~<next-version>~~ |
  |  | 143 | \* @since 3.2.10 |
  | 144 | 144 | \* @param string $property The property to get. |
  | 145 | 145 | \* @return mixed |
* ## [easy-digital-downloads/trunk/src/Extensions/Updater.php](/changeset/3060808/easy-digital-downloads/trunk/src/Extensions/Updater.php?old=2969966&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FExtensions%2FUpdater.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/Extensions/Updater.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L6 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L6 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | \* @since 3.1.1.4 |
  | 7 | 7 | \*/ |
  |  | 8 |  |
  | 8 | 9 | namespace EDD\Extensions; |
  | 9 | 10 |  |
  | 10 |  | // Exit if accessed directly |
  | 11 |  | defined( 'ABSPATH' ) || exit; |
  | 12 |  |  |
  |  | 11 | // Exit if accessed directly. |
  |  | 12 | defined( 'ABSPATH' ) || exit; // @codeCoverageIgnore |
  |  | 13 |  |
  |  | 14 | /\*\* |
  |  | 15 | \* Class Updater |
  |  | 16 | \* |
  |  | 17 | \* @package EDD\Extensions |
  |  | 18 | \*/ |
  | 13 | 19 | class Updater { |
  | 14 | 20 |  |
  |  | 21 | /\*\* |
  |  | 22 | \* The API handler. |
  |  | 23 | \* |
  |  | 24 | \* @var \EDD\Licensing\API |
  |  | 25 | \*/ |
  | 15 | 26 | private $api\_handler; |
  | 16 |  | private $api\_url     = ''; |
  | 17 |  | private $api\_data    = array(); |
  |  | 27 |  |
  |  | 28 | /\*\* |
  |  | 29 | \* The API URL. |
  |  | 30 | \* |
  |  | 31 | \* @var string |
  |  | 32 | \*/ |
  |  | 33 | private $api\_url = ''; |
  |  | 34 |  |
  |  | 35 | /\*\* |
  |  | 36 | \* The API data. |
  |  | 37 | \* |
  |  | 38 | \* @var array |
  |  | 39 | \*/ |
  |  | 40 | private $api\_data = array(); |
  |  | 41 |  |
  |  | 42 | /\*\* |
  |  | 43 | \* The plugin file. |
  |  | 44 | \* |
  |  | 45 | \* @var string |
  |  | 46 | \*/ |
  | 18 | 47 | private $plugin\_file = ''; |
  | 19 |  | private $name        = ''; |
  | 20 |  | private $slug        = ''; |
  | 21 |  | private $version     = ''; |
  |  | 48 |  |
  |  | 49 | /\*\* |
  |  | 50 | \* The plugin name. |
  |  | 51 | \* |
  |  | 52 | \* @var string |
  |  | 53 | \*/ |
  |  | 54 | private $name = ''; |
  |  | 55 |  |
  |  | 56 | /\*\* |
  |  | 57 | \* The plugin slug. |
  |  | 58 | \* |
  |  | 59 | \* @var string |
  |  | 60 | \*/ |
  |  | 61 | private $slug = ''; |
  |  | 62 |  |
  |  | 63 | /\*\* |
  |  | 64 | \* The plugin version. |
  |  | 65 | \* |
  |  | 66 | \* @var string |
  |  | 67 | \*/ |
  |  | 68 | private $version = ''; |
  |  | 69 |  |
  |  | 70 | /\*\* |
  |  | 71 | \* Whether to override WP's update check. |
  |  | 72 | \* |
  |  | 73 | \* @var bool |
  |  | 74 | \*/ |
  | 22 | 75 | private $wp\_override = false; |
  | 23 |  | private $beta        = false; |
  |  | 76 |  |
  |  | 77 | /\*\* |
  |  | 78 | \* Whether to use the beta channel. |
  |  | 79 | \* |
  |  | 80 | \* @var bool |
  |  | 81 | \*/ |
  |  | 82 | private $beta = false; |
  |  | 83 |  |
  |  | 84 | /\*\* |
  |  | 85 | \* The failed request cache key. |
  |  | 86 | \* |
  |  | 87 | \* @var string |
  |  | 88 | \*/ |
  | 24 | 89 | private $failed\_request\_cache\_key; |
  | 25 | 90 |  |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L30) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L95) |  |
  | 30 | 95 | \* @uses hook() |
  | 31 | 96 | \* |
  | 32 |  | \* @param string $\_plugin\_file Path to the plugin file. |
  | 33 |  | \* @param array  $\_api\_data    Optional data to send with API calls. |
  |  | 97 | \* @param string $\_plugin\_file Path to the plugin file. |
  |  | 98 | \* @param array  $\_api\_data    Optional data to send with API calls. |
  | 34 | 99 | \*/ |
  | 35 | 100 | public function \_\_construct( $\_plugin\_file, $\_api\_data = null ) { |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L43) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L108) |  |
  | 43 | 108 | $this->plugin\_file              = $\_plugin\_file; |
  | 44 | 109 | $this->name                     = plugin\_basename( $\_plugin\_file ); |
  | 45 |  | $this->slug                     = basename( ~~$\_plugin\_file, '.php'~~ ); |
  |  | 110 | $this->slug                     = basename( dirname( $\_plugin\_file ) ); |
  | 46 | 111 | $this->version                  = $\_api\_data['version']; |
  | 47 | 112 | $this->wp\_override              = isset( $\_api\_data['wp\_override'] ) ? (bool) $\_api\_data['wp\_override'] : false; |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L79) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L144) |  |
  | 79 | 144 | \* @uses api\_request() |
  | 80 | 145 | \* |
  | 81 |  | \* @param array $\_transient\_data Update array build by WordPress. |
  |  | 146 | \* @param array $\_transient\_data Update array build by WordPress. |
  | 82 | 147 | \* @return array Modified update array with custom plugin data. |
  | 83 | 148 | \*/ |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L92) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L157) |  |
  | 92 | 157 | } |
  | 93 | 158 |  |
  | 94 |  | $current = $this->get\_~~repo\_api~~\_data(); |
  |  | 159 | $current = $this->get\_limited\_data(); |
  | 95 | 160 | if ( false !== $current && is\_object( $current ) && isset( $current->new\_version ) ) { |
  | 96 | 161 | if ( version\_compare( $this->version, $current->new\_version, '<' ) ) { |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L140) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L205) |  |
  | 140 | 205 |  |
  | 141 | 206 | /\*\* |
  |  | 207 | \* Gets a limited set of data from the API response. |
  |  | 208 | \* This is used for the update\_plugins transient. |
  |  | 209 | \* |
  |  | 210 | \* @since 3.2.10 |
  |  | 211 | \* @return \stdClass|false |
  |  | 212 | \*/ |
  |  | 213 | private function get\_limited\_data() { |
  |  | 214 | $version\_info = $this->get\_repo\_api\_data(); |
  |  | 215 |  |
  |  | 216 | if ( ! $version\_info ) { |
  |  | 217 | return false; |
  |  | 218 | } |
  |  | 219 |  |
  |  | 220 | $limited\_data               = new \stdClass(); |
  |  | 221 | $limited\_data->slug         = $this->slug; |
  |  | 222 | $limited\_data->plugin       = $this->name; |
  |  | 223 | $limited\_data->url          = $version\_info->url; |
  |  | 224 | $limited\_data->package      = $version\_info->package; |
  |  | 225 | $limited\_data->icons        = $this->convert\_object\_to\_array( $version\_info->icons ); |
  |  | 226 | $limited\_data->banners      = $this->convert\_object\_to\_array( $version\_info->banners ); |
  |  | 227 | $limited\_data->new\_version  = $version\_info->new\_version; |
  |  | 228 | $limited\_data->tested       = $version\_info->tested; |
  |  | 229 | $limited\_data->requires     = $version\_info->requires; |
  |  | 230 | $limited\_data->requires\_php = $version\_info->requires\_php; |
  |  | 231 |  |
  |  | 232 | return $limited\_data; |
  |  | 233 | } |
  |  | 234 |  |
  |  | 235 | /\*\* |
  | 142 | 236 | \* Gets the plugin's tested version. |
  | 143 | 237 | \* |
  | 144 | 238 | \* @since 1.9.2 |
  | 145 |  | \* @param object $version\_info |
  |  | 239 | \* @param object $version\_info The version info. |
  | 146 | 240 | \* @return null|string |
  | 147 | 241 | \*/ |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L174) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L268) |  |
  | 174 | 268 | \* Show the update notification on multisite subsites. |
  | 175 | 269 | \* |
  | 176 |  | \* @param string ~~$file~~ |
  | 177 |  | \* @param array  ~~$plugin~~ |
  |  | 270 | \* @param string $file   The plugin file. |
  |  | 271 | \* @param array  $plugin The plugin data. |
  | 178 | 272 | \*/ |
  | 179 | 273 | public function show\_update\_notification( $file, $plugin ) { |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L261) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L355) |  |
  | 261 | 355 | echo ' '; |
  | 262 | 356 | printf( |
  |  | 357 | /\* translators: 1. opening anchor tag, do not translate 2. the new plugin version 3. closing anchor tag, do not translate 4. opening anchor tag, do not translate 5. closing anchor tag, do not translate. \*/ |
  | 263 | 358 | \_\_( '%1$sView version %2$s details%3$s or %4$supdate now%5$s.', 'easy-digital-downloads' ), |
  | 264 | 359 | '<a target="\_blank" class="thickbox open-plugin-details-modal" href="' . esc\_url( $changelog\_link ) . '">', |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L277) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L372) |  |
  | 277 | 372 | } |
  | 278 | 373 |  |
  | 279 |  | do\_action( "in\_plugin\_update\_message-{$file}", $plugin, $plugin ); |
  |  | 374 | do\_action( "in\_plugin\_update\_message-{$file}", $plugin, $plugin ); // phpcs:ignore WordPress.NamingConventions.ValidHookName.UseUnderscores |
  | 280 | 375 |  |
  | 281 | 376 | echo '</p></div></td></tr>'; |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L299) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L394) |  |
  | 299 | 394 | \* @uses api\_request() |
  | 300 | 395 | \* |
  | 301 |  | \* @param mixed  ~~$\_data~~ |
  | 302 |  | \* @param string ~~$\_action~~ |
  | 303 |  | \* @param object ~~$\_args~~ |
  |  | 396 | \* @param mixed  $\_data   The default data. |
  |  | 397 | \* @param string $\_action The requested action. |
  |  | 398 | \* @param object $\_args   The Plugin API arguments. |
  | 304 | 399 | \* @return object $\_data |
  | 305 | 400 | \*/ |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L324) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L419) |  |
  | 324 | 419 | ); |
  | 325 | 420 |  |
  | 326 |  | // Get the transient where we store the api request for this plugin for 24 hours |
  |  | 421 | // Get the transient where we store the api request for this plugin for 24 hours. |
  | 327 | 422 | $edd\_api\_request\_transient = $this->get\_cached\_version\_info(); |
  | 328 | 423 |  |
  | 329 |  | //If we have no transient-saved value, run the API, set a fresh transient with the API value, and return that value too right now. |
  |  | 424 | // If we have no transient-saved value, run the API, set a fresh transient with the API value, and return that value too right now. |
  | 330 | 425 | if ( empty( $edd\_api\_request\_transient ) ) { |
  | 331 | 426 |  |
  | 332 | 427 | $api\_response = $this->api\_request( 'plugin\_information', $to\_send ); |
  | 333 | 428 |  |
  | 334 |  | // Expires in 3 hours |
  |  | 429 | // Expires in 3 hours. |
  | 335 | 430 | $this->set\_version\_info\_cache( $api\_response ); |
  | 336 | 431 |  |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L366) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L461) |  |
  | 366 | 461 | } |
  | 367 | 462 |  |
  |  | 463 | if ( ! isset( $\_data->version ) && ! empty( $\_data->new\_version ) ) { |
  |  | 464 | $\_data->version = $\_data->new\_version; |
  |  | 465 | } |
  |  | 466 |  |
  | 368 | 467 | return $\_data; |
  | 369 | 468 | } |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L377) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L476) |  |
  | 377 | 476 | \* @since 3.6.5 |
  | 378 | 477 | \* |
  | 379 |  | \* @param stdClass $data |
  |  | 478 | \* @param stdClass $data The data to convert. |
  | 380 | 479 | \* |
  | 381 | 480 | \* @return array |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L400) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L499) |  |
  | 400 | 499 | \* @uses is\_wp\_error() |
  | 401 | 500 | \* |
  | 402 |  | \* @param string $\_action The requested action. |
  | 403 |  | \* @param array  $\_data   Parameters for the API action. |
  |  | 501 | \* @param string $\_action The requested action. |
  |  | 502 | \* @param array  $\_data   Parameters for the API action. |
  | 404 | 503 | \* @return false|object |
  | 405 | 504 | \*/ |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L528) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L627) |  |
  | 528 | 627 | \* Get the version info from the cache, if it exists. |
  | 529 | 628 | \* |
  | 530 |  | \* @param string $cache\_key |
  |  | 629 | \* @param string $cache\_key The cache key. |
  | 531 | 630 | \* @return object |
  | 532 | 631 | \*/ |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L539) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L638) |  |
  | 539 | 638 | $cache = get\_option( $cache\_key ); |
  | 540 | 639 |  |
  | 541 |  | // Cache is expired |
  |  | 640 | // Cache is expired. |
  | 542 | 641 | if ( empty( $cache['timeout'] ) || time() > $cache['timeout'] ) { |
  | 543 | 642 | return false; |
  | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=2969966#L556) | […](/browser/easy-digital-downloads/trunk/src/Extensions/Updater.php?rev=3060808#L655) |  |
  | 556 | 655 | \* Adds the plugin version information to the database. |
  | 557 | 656 | \* |
  | 558 |  | \* @param string~~$value~~ |
  | 559 |  | \* @param string ~~$cache\_key~~ |
  |  | 657 | \* @param string|\stdClass $value     The value to store. |
  |  | 658 | \* @param string           $cache\_key The cache key. |
  | 560 | 659 | \*/ |
  | 561 | 660 | public function set\_version\_info\_cache( $value = '', $cache\_key = '' ) { |
* ## [easy-digital-downloads/trunk/src/HTML/Base.php](/changeset/3060808/easy-digital-downloads/trunk/src/HTML/Base.php?old=3036940&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FHTML%2FBase.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/HTML/Base.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/HTML/Base.php?rev=3036940#L76 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/HTML/Base.php?rev=3060808#L76 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 76 | 76 | $data\_elements[] = 'data-' . esc\_attr( $key ) . '="' . esc\_attr( $value ) . '"'; |
  | 77 | 77 | } |
  |  | 78 | if ( empty( $this->args['data']['placeholder'] ) && ! empty( $this->args['placeholder'] ) ) { |
  |  | 79 | $data\_elements[] = 'data-placeholder="' . esc\_attr( $this->args['placeholder'] ) . '"'; |
  |  | 80 | } |
  | 78 | 81 |  |
  | 79 | 82 | return implode( ' ', $data\_elements ); |
* ## [easy-digital-downloads/trunk/src/HTML/Checkbox.php](/changeset/3060808/easy-digital-downloads/trunk/src/HTML/Checkbox.php?old=3036940&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FHTML%2FCheckbox.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/HTML/Checkbox.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/HTML/Checkbox.php?rev=3036940#L46 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/HTML/Checkbox.php?rev=3060808#L46 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 46 | 46 | <?php |
  | 47 | 47 | } |
  | 48 |  | if ( ! empty( $this->args['value~~]~~'] ) ) { |
  |  | 48 | if ( ! empty( $this->args['value'] ) ) { |
  | 49 | 49 | ?> |
  | 50 |  | value="<?php echo esc\_attr( $this->args['value'] ); ?>" |
  |  | 50 | value="<?php echo esc\_attr( $this->args['value'] ); ?>" |
  | 51 | 51 | <?php |
  | 52 | 52 | } |
* ## [easy-digital-downloads/trunk/src/HTML/ProductSelect.php](/changeset/3060808/easy-digital-downloads/trunk/src/HTML/ProductSelect.php?old=3036940&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FHTML%2FProductSelect.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/HTML/ProductSelect.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/HTML/ProductSelect.php?rev=3036940#L94 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/HTML/ProductSelect.php?rev=3060808#L94 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 94 | 94 | private function get\_options() { |
  | 95 | 95 | $products = $this->get\_products(); |
  | 96 |  | $options  = array( |
  | 97 |  | '' => '', |
  | 98 |  | ); |
  |  | 96 | $options  = array(); |
  | 99 | 97 | if ( $products ) { |
  | 100 | 98 | foreach ( $products as $product ) { |
  | […](/browser/easy-digital-downloads/trunk/src/HTML/ProductSelect.php?rev=3036940#L163) | […](/browser/easy-digital-downloads/trunk/src/HTML/ProductSelect.php?rev=3060808#L161) |  |
  | 163 | 161 | $existing\_ids   = wp\_list\_pluck( $products, 'ID' ); |
  | 164 | 162 | foreach ( $selected\_items as $selected\_item ) { |
  |  | 163 | if ( 'download' !== get\_post\_type( $selected\_item ) ) { |
  |  | 164 | continue; |
  |  | 165 | } |
  | 165 | 166 | if ( ! in\_array( $selected\_item, $existing\_ids, true ) ) { |
  | 166 | 167 |  |
  | […](/browser/easy-digital-downloads/trunk/src/HTML/ProductSelect.php?rev=3036940#L219) | […](/browser/easy-digital-downloads/trunk/src/HTML/ProductSelect.php?rev=3060808#L220) |  |
  | 219 | 220 | \*/ |
  | 220 | 221 | private function get\_missing\_selected\_product( $item ) { |
  |  | 222 | $options     = array(); |
  | 221 | 223 | $parsed\_item = edd\_parse\_product\_dropdown\_value( $item ); |
  | 222 | 224 | $download\_id = (int) $parsed\_item['download\_id']; |
  | 223 | 225 |  |
  | 224 |  | $options = array(); |
  |  | 226 | if ( 'download' !== get\_post\_type( $download\_id ) ) { |
  |  | 227 | return $options; |
  |  | 228 | } |
  |  | 229 |  |
  | 225 | 230 | if ( ! is\_null( $parsed\_item['price\_id'] ) ) { |
  | 226 | 231 | $prices = edd\_get\_variable\_prices( $download\_id ); |
* ## [easy-digital-downloads/trunk/src/HTML/Select.php](/changeset/3060808/easy-digital-downloads/trunk/src/HTML/Select.php?old=3036940&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FHTML%2FSelect.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/HTML/Select.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/HTML/Select.php?rev=3036940#L27 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/HTML/Select.php?rev=3060808#L27 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 27 | 27 | \*/ |
  | 28 | 28 | public function get() { |
  |  | 29 | $this->maybe\_update\_selected(); |
  | 29 | 30 | ob\_start(); |
  | 30 | 31 | ?> |
  | […](/browser/easy-digital-downloads/trunk/src/HTML/Select.php?rev=3036940#L52) | […](/browser/easy-digital-downloads/trunk/src/HTML/Select.php?rev=3060808#L53) |  |
  | 52 | 53 | <?php if ( $this->args['multiple'] ) : ?> |
  | 53 | 54 | multiple |
  | 54 |  | ~~<?php endif; ?>~~ |
  | 55 |  | ~~<?php if ( $this->args['placeholder'] ) : ?>~~ |
  | 56 |  | ~~data-placeholder="<?php echo esc\_attr( $this->args['placeholder'] ); ?>"~~ |
  | 57 | 55 | <?php endif; ?> |
  | 58 | 56 | <?php echo $this->get\_data\_elements(); ?> |
  | […](/browser/easy-digital-downloads/trunk/src/HTML/Select.php?rev=3036940#L145) | […](/browser/easy-digital-downloads/trunk/src/HTML/Select.php?rev=3060808#L143) |  |
  | 145 | 143 | private function is\_selected( $value ) { |
  | 146 | 144 | if ( $this->args['multiple'] ) { |
  | 147 |  | return selected( true, in\_array( ~~$value, (array) $this->args['selected'] ), false ); // phpcs:ignore WordPress.PHP.StrictInArray.MissingTrueStrict~~ |
  |  | 145 | return selected( true, in\_array( (string) $value, $this->args['selected'], true ), false ); |
  | 148 | 146 | } |
  | 149 | 147 | if ( ! empty( $this->args['selected'] ) && ! is\_array( $this->args['selected'] ) ) { |
  | […](/browser/easy-digital-downloads/trunk/src/HTML/Select.php?rev=3036940#L153) | […](/browser/easy-digital-downloads/trunk/src/HTML/Select.php?rev=3060808#L151) |  |
  | 153 | 151 | return false; |
  | 154 | 152 | } |
  |  | 153 |  |
  |  | 154 | /\*\* |
  |  | 155 | \* Updates the selected value. If the select is a multiple select, the selected value will be an array of strings. |
  |  | 156 | \* This is only for comparison purposes. |
  |  | 157 | \* |
  |  | 158 | \* @since 3.2.10 |
  |  | 159 | \* @return void |
  |  | 160 | \*/ |
  |  | 161 | private function maybe\_update\_selected() { |
  |  | 162 | if ( $this->args['multiple'] || is\_array( $this->args['selected'] ) ) { |
  |  | 163 | $this->args['selected'] = array\_map( 'strval', (array) $this->args['selected'] ); |
  |  | 164 | } |
  |  | 165 | } |
  | 155 | 166 | } |
* ## [easy-digital-downloads/trunk/src/HTML/Textarea.php](/changeset/3060808/easy-digital-downloads/trunk/src/HTML/Textarea.php?old=3036940&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FHTML%2FTextarea.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/HTML/Textarea.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/HTML/Textarea.php?rev=3036940#L46 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/HTML/Textarea.php?rev=3060808#L46 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 46 | 46 | disabled |
  | 47 | 47 | <?php endif; ?> |
  | 48 |  | > |
  | 49 |  | <?php echo esc\_textarea( $this->args['value'] ); ?> |
  | 50 |  | </textarea> |
  |  | 48 | ><?php echo esc\_textarea( $this->args['value'] ); ?></textarea> |
  | 51 | 49 |  |
  | 52 | 50 | <?php |
* ## [easy-digital-downloads/trunk/src/Telemetry/Products.php](/changeset/3060808/easy-digital-downloads/trunk/src/Telemetry/Products.php?old=2964278&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FTelemetry%2FProducts.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/Telemetry/Products.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/Telemetry/Products.php?rev=2964278#L8 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/Telemetry/Products.php?rev=3060808#L8 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* @since     3.2.0 |
  | 9 | 9 | \*/ |
  |  | 10 |  |
  | 10 | 11 | namespace EDD\Telemetry; |
  | 11 | 12 |  |
  | 12 | 13 | defined( 'ABSPATH' ) || exit; |
  | 13 | 14 |  |
  |  | 15 | /\*\* |
  |  | 16 | \* Class Products |
  |  | 17 | \* |
  |  | 18 | \* @since 3.2.0 |
  |  | 19 | \*/ |
  | 14 | 20 | class Products { |
  | 15 | 21 |  |
  | […](/browser/easy-digital-downloads/trunk/src/Telemetry/Products.php?rev=2964278#L51) | […](/browser/easy-digital-downloads/trunk/src/Telemetry/Products.php?rev=3060808#L57) |  |
  | 51 | 57 | ); |
  | 52 | 58 |  |
  |  | 59 | foreach ( edd\_get\_download\_types() as $slug => $label ) { |
  |  | 60 | $query = array( |
  |  | 61 | 'key' => '\_edd\_product\_type', |
  |  | 62 | ); |
  |  | 63 |  |
  |  | 64 | if ( empty( $slug ) ) { |
  |  | 65 | $query['compare'] = 'NOT EXISTS'; |
  |  | 66 | } else { |
  |  | 67 | $query['value']   = $slug; |
  |  | 68 | $query['compare'] = '='; |
  |  | 69 | } |
  |  | 70 |  |
  |  | 71 | $slug                             = empty( $slug ) ? 'default' : $slug; |
  |  | 72 | $data[ 'download\_type\_' . $slug ] = $this->get\_product\_count( $query ); |
  |  | 73 | } |
  |  | 74 |  |
  | 53 | 75 | /\*\* |
  | 54 | 76 | \* Filters the product data to send to the telemetry server. |
* ## [easy-digital-downloads/trunk/src/Telemetry/Stats.php](/changeset/3060808/easy-digital-downloads/trunk/src/Telemetry/Stats.php?old=2880035&old_path=easy-digital-downloads%2Ftrunk%2Fsrc%2FTelemetry%2FStats.php "Show the [3042139:3060808] differences restricted to easy-digital-downloads/trunk/src/Telemetry/Stats.php")

  | [r3042139](/browser/easy-digital-downloads/trunk/src/Telemetry/Stats.php?rev=2880035#L30 "Show revision 3042139 of this file in browser") | [r3060808](/browser/easy-digital-downloads/trunk/src/Telemetry/Stats.php?rev=3060808#L30 "Show revision 3060808 of this file in browser") |  |
  | --- | --- | --- |
  | 30 | 30 | 'onboarding\_completed' => get\_option( 'edd\_onboarding\_completed' ), |
  | 31 | 31 | 'products'             => $this->get\_product\_count(), |
  |  | 32 | 'categories'           => $this->get\_category\_count(), |
  |  | 33 | 'tags'                 => $this->get\_tag\_count(), |
  | 32 | 34 | 'pass\_id'              => $this->get\_pass\_id(), |
  | 33 | 35 | ); |
  | […](/browser/easy-digital-downloads/trunk/src/Telemetry/Stats.php?rev=2880035#L124) | […](/browser/easy-digital-downloads/trunk/src/Telemetry/Stats.php?rev=3060808#L126) |  |
  | 124 | 126 | return $results->earnings / $products; |
  | 125 | 127 | } |
  |  | 128 |  |
  |  | 129 | /\*\* |
  |  | 130 | \* Gets the number of product categories on the website. |
  |  | 131 | \* |
  |  | 132 | \* @since 3.2.10 |
  |  | 133 | \* @return int |
  |  | 134 | \*/ |
  |  | 135 | private function get\_category\_count() { |
  |  | 136 | return wp\_count\_terms( 'download\_category' ); |
  |  | 137 | } |
  |  | 138 |  |
  |  | 139 | /\*\* |
  |  | 140 | \* Gets the number of product tags on the website. |
  |  | 141 | \* |
  |  | 142 | \* @since 3.2.10 |
  |  | 143 | \* @return int |
  |  | 144 | \*/ |
  |  | 145 | private function get\_tag\_count() { |
  |  | 146 | return wp\_count\_terms( 'download\_tag' ); |
  |  | 147 | } |
  | 126 | 148 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3060808&old=3042139&new_path=%2Feasy-digital-downloads%2Ftrunk&old_path=%2Feasy-digital-downloads%2Ftrunk)
* [Zip Archive](?format=zip&new=3060808&old=3042139&new_path=%2Feasy-digital-downloads%2Ftrunk&old_path=%2Feasy-digital-downloads%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


