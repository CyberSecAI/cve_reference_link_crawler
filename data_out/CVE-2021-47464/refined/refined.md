The provided content relates to CVE-2021-47464.

**Root cause of vulnerability:**
The vulnerability is caused by a missing null check on the `ctx` variable before accessing the `ctx->sockaddr` member within the `audit_filter_rules()` function in `kernel/auditsc.c`. The code previously assumed that the `ctx` variable would not be null, leading to a potential null pointer dereference.

**Weaknesses/vulnerabilities present:**
- Null pointer dereference. The code attempts to access `ctx->sockaddr` without verifying that `ctx` is a valid pointer, which can lead to a crash if `ctx` is null.

**Impact of exploitation:**
- Kernel crash. If the `ctx` variable is null when the `AUDIT_SADDR_FAM` case is executed, a null pointer dereference will occur, resulting in a kernel crash and potentially denial of service.

**Attack vectors:**
- The specific scenario where the `ctx` variable could become null is not detailed, but it involves the audit filtering mechanism. An attacker would need to trigger a condition that leads to a null `ctx` being passed to the `audit_filter_rules` function, specifically when filtering based on socket address family (`AUDIT_SADDR_FAM`).

**Required attacker capabilities/position:**
- The attacker needs to be able to influence the audit rules or trigger a condition that causes `ctx` to be null when the `audit_filter_rules` function is called with the `AUDIT_SADDR_FAM` filter. This likely requires the ability to configure audit rules or perform specific actions that interact with the network stack in a way that leads to the vulnerable condition.