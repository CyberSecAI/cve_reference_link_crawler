=== Content from plugins.trac.wordpress.org_ca223c2c_20250111_152154.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3099184)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3099183 "Changeset 3099183")
* [Next Changeset](/changeset/3099185 "Changeset 3099185") →

---

# Changeset 3099184

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/07/2024 09:11:55 AM
([7 months](/timeline?from=2024-06-07T09%3A11%3A55Z&precision=second "See timeline at 06/07/2024 09:11:55 AM") ago)

Author:
abdullah17
Message:

release 5.0.10 version

Location:
[cf7-google-sheets-connector/trunk](/browser/cf7-google-sheets-connector/trunk?rev=3099184)
Files:

1 added
7 edited

* [google-sheet-connector.php](/browser/cf7-google-sheets-connector/trunk/google-sheet-connector.php?rev=3099184 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [includes/class-gs-service.php](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?rev=3099184 "Show entry in browser")
  (modified)
  ([3 diffs](#file1 "Show differences"))
* [includes/class-gs-utility.php](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-utility.php?rev=3099184 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [includes/pages/google-sheet-settings.php](/browser/cf7-google-sheets-connector/trunk/includes/pages/google-sheet-settings.php?rev=3099184 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [includes/pages/gs-cf7-logs.php](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php?rev=3099184 "Show entry in browser")
  (modified)
  ([4 diffs](#file4 "Show differences"))
* [includes/pages/gs-conditional-logic.php](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-conditional-logic.php?rev=3099184 "Show entry in browser")
  (added)
* [includes/pages/gs-integrate-demo.php](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-integrate-demo.php?rev=3099184 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [readme.txt](/browser/cf7-google-sheets-connector/trunk/readme.txt?rev=3099184 "Show entry in browser")
  (modified)
  ([2 diffs](#file7 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [cf7-google-sheets-connector/trunk/google-sheet-connector.php](/changeset/3099184/cf7-google-sheets-connector/trunk/google-sheet-connector.php "Show the changeset 3099184 restricted to cf7-google-sheets-connector/trunk/google-sheet-connector.php")

  | [r3067737](/browser/cf7-google-sheets-connector/trunk/google-sheet-connector.php?rev=3067737#L4 "Show revision 3067737 of this file in browser") | [r3099184](/browser/cf7-google-sheets-connector/trunk/google-sheet-connector.php?rev=3099184#L4 "Show revision 3099184 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/cf7-google-sheets-connector/ |
  | 5 | 5 | \* Description: Send your Contact Form 7 data to your Google Sheets spreadsheet. |
  | 6 |  | \* Version: 5.0.~~9~~ |
  |  | 6 | \* Version: 5.0.10 |
  | 7 | 7 | \* Author: GSheetConnector |
  | 8 | 8 | \* Author URI: https://www.gsheetconnector.com/ |
  | […](/browser/cf7-google-sheets-connector/trunk/google-sheet-connector.php?rev=3067737#L16) | […](/browser/cf7-google-sheets-connector/trunk/google-sheet-connector.php?rev=3099184#L16) |  |
  | 16 | 16 |  |
  | 17 | 17 | // Declare some global constants |
  | 18 |  | define('GS\_CONNECTOR\_VERSION', '5.0.~~9~~'); |
  | 19 |  | define('GS\_CONNECTOR\_DB\_VERSION', '5.0.~~9~~'); |
  |  | 18 | define('GS\_CONNECTOR\_VERSION', '5.0.10'); |
  |  | 19 | define('GS\_CONNECTOR\_DB\_VERSION', '5.0.10'); |
  | 20 | 20 | define('GS\_CONNECTOR\_ROOT', dirname(\_\_FILE\_\_)); |
  | 21 | 21 | define('GS\_CONNECTOR\_URL', plugins\_url('/', \_\_FILE\_\_)); |
  | […](/browser/cf7-google-sheets-connector/trunk/google-sheet-connector.php?rev=3067737#L418) | […](/browser/cf7-google-sheets-connector/trunk/google-sheet-connector.php?rev=3099184#L418) |  |
  | 418 | 418 | </div> |
  | 419 | 419 | <!-- display content error logs --> |
  | 420 |  |  |
  | 421 |  |  |
  | 422 |  |  |
  | 423 |  |  |
  | 424 |  |  |
  | 425 |  |  |
  | 426 |  | <div class="system-error-cf7free-logs" style="display:none;"> |
  |  | 420 | <div class="system-error-cf7free-logs" style="display:none;"> |
  | 427 | 421 | <div class="display-cf7free-logs"> |
  | 428 | 422 | <?php |
* ## [cf7-google-sheets-connector/trunk/includes/class-gs-service.php](/changeset/3099184/cf7-google-sheets-connector/trunk/includes/class-gs-service.php "Show the changeset 3099184 restricted to cf7-google-sheets-connector/trunk/includes/class-gs-service.php")

  | [r3067737](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?rev=3067737#L41 "Show revision 3067737 of this file in browser") | [r3099184](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?rev=3099184#L41 "Show revision 3099184 of this file in browser") |  |
  | --- | --- | --- |
  | 41 | 41 | add\_action( 'wpcf7\_mail\_sent', array( $this, 'cf7\_save\_to\_google\_sheets' ) ); |
  | 42 | 42 |  |
  | 43 |  | add\_action( 'admin\_init', array( $this, 'execute\_post\_data\_cg7\_free' ) ); |
  | 44 |  |  |
  | 45 |  |  |
  | 46 |  | //add\_action( 'admin\_notices', array( $this, 'display\_upgrade\_notice' ) ); |
  | 47 |  |  |
  | 48 |  | //add\_action( 'wp\_ajax\_set\_upgrade\_notification\_interval', array( $this, 'set\_upgrade\_notification\_interval' ) ); |
  | 49 |  | //add\_action( 'wp\_ajax\_close\_upgrade\_notification\_interval', array( $this, 'close\_upgrade\_notification\_interval' ) ); |
  | 50 |  | } |
  | 51 |  |  |
  | 52 |  | public function execute\_post\_data\_cg7\_free() { |
  |  | 43 | add\_action( 'admin\_init', array( $this, 'execute\_post\_data\_cf7\_free' ) ); |
  |  | 44 |  |
  |  | 45 | } |
  |  | 46 |  |
  |  | 47 | public function execute\_post\_data\_cf7\_free() { |
  | 53 | 48 | try { |
  |  | 49 | // Check if the current user has the 'manage\_options' capability |
  |  | 50 | if (!current\_user\_can('manage\_options')) { |
  |  | 51 | // If the user doesn't have the required capability, show an error message or redirect |
  |  | 52 | wp\_die(\_\_('You do not have sufficient permissions to access this page.')); |
  |  | 53 | } |
  |  | 54 |  |
  | 54 | 55 | // save debug logs |
  | 55 | 56 | if(isset($\_POST['gs\_cf7free\_debug\_settings'])) { |
  | […](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?rev=3067737#L843) | […](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?rev=3099184#L844) |  |
  | 843 | 844 |  |
  | 844 | 845 | include( GS\_CONNECTOR\_PATH . "includes/pages/gs-custom-mail-tags.php" ); |
  |  | 846 |  |
  |  | 847 | include( GS\_CONNECTOR\_PATH . "includes/pages/gs-conditional-logic.php" ); |
  | 845 | 848 |  |
  | 846 | 849 | include( GS\_CONNECTOR\_PATH . "includes/pages/gs-custom-ordering.php"); |
  | […](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?rev=3067737#L1076) | […](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?rev=3099184#L1079) |  |
  | 1076 | 1079 | } |
  | 1077 | 1080 | } |
  |  | 1081 |  |
  |  | 1082 | function display\_form\_conditional\_logic( $form\_id, $post ){ ?> |
  |  | 1083 | <div class="misc-conditional-row"> |
  |  | 1084 | <div class="misc-options-wrapper"> |
  |  | 1085 |  |
  |  | 1086 | <label for="enable-conditional-logic"> |
  |  | 1087 | <input type="checkbox" name="cf7-gs[enable\_conditional\_logic]" id="enable-conditional-logic" value="1" |
  |  | 1088 | style="display: none;"> |
  |  | 1089 | <label for="enable-conditional-logic" class="button-woo-toggle-cf7" id="conditional-toggle"></label> |
  |  | 1090 | <?php echo \_\_('Conditional Logic', 'gsconnector'); ?> |
  |  | 1091 | </label> |
  |  | 1092 |  |
  |  | 1093 | <span class="tooltip" style="display: inline !important;"> |
  |  | 1094 | <img src="<?php echo GS\_CONNECTOR\_URL; ?>assets/img/help.png" class="help-icon"> |
  |  | 1095 | <span |
  |  | 1096 | class="tooltiptext tooltip-right-msg"><?php echo \_\_("The Enable Conditional Logic option in the field settings allows you to create rules to dynamically display or hide the submission to google sheet based on values.", "gsconnector"); ?> |
  |  | 1097 |  |
  |  | 1098 | </span> |
  |  | 1099 | </span> |
  |  | 1100 | </div> |
  |  | 1101 | <?php |
  |  | 1102 |  |
  |  | 1103 |  |
  |  | 1104 | } |
  | 1078 | 1105 |  |
  | 1079 | 1106 | public function display\_upgrade\_notice() { |
* ## [cf7-google-sheets-connector/trunk/includes/class-gs-utility.php](/changeset/3099184/cf7-google-sheets-connector/trunk/includes/class-gs-utility.php "Show the changeset 3099184 restricted to cf7-google-sheets-connector/trunk/includes/class-gs-utility.php")

  | [r2975233](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-utility.php?rev=2975233#L84 "Show revision 2975233 of this file in browser") | [r3099184](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-utility.php?rev=3099184#L84 "Show revision 3099184 of this file in browser") |  |
  | --- | --- | --- |
  | 84 | 84 | } |
  | 85 | 85 |  |
  | 86 |  | $admin\_notice .= "    <p>" . ~~$message~~ . "</p>\n"; |
  |  | 86 | $admin\_notice .= "    <p>" . \_\_($message, 'gsconnector') . "</p>\n"; |
  | 87 | 87 | $admin\_notice .= "</div>\n"; |
  | 88 | 88 | return $admin\_notice; |
* ## [cf7-google-sheets-connector/trunk/includes/pages/google-sheet-settings.php](/changeset/3099184/cf7-google-sheets-connector/trunk/includes/pages/google-sheet-settings.php "Show the changeset 3099184 restricted to cf7-google-sheets-connector/trunk/includes/pages/google-sheet-settings.php")

  | [r3067737](/browser/cf7-google-sheets-connector/trunk/includes/pages/google-sheet-settings.php?rev=3067737#L39 "Show revision 3067737 of this file in browser") | [r3099184](/browser/cf7-google-sheets-connector/trunk/includes/pages/google-sheet-settings.php?rev=3099184#L39 "Show revision 3099184 of this file in browser") |  |
  | --- | --- | --- |
  | 39 | 39 | <div class="gsheet-logo"> |
  | 40 | 40 | <a href="https://www.gsheetconnector.com/"><i></i></a></div> |
  | 41 |  | <h1 class="gsheet-logo-text"><span>CF7 GSheetConnector</span> <small>Version : <?php echo esc\_html($plugin\_version,'gs~~-gsheet~~connector'); ?> </small></h1> |
  |  | 41 | <h1 class="gsheet-logo-text"><span>CF7 GSheetConnector</span> <small>Version : <?php echo esc\_html($plugin\_version,'gsconnector'); ?> </small></h1> |
  | 42 | 42 | <a href="https://support.gsheetconnector.com/kb" title="gsheet Knowledge Base" target="\_blank" class="button gsheet-help"><i class="dashicons dashicons-editor-help"></i></a> |
  | 43 | 43 | </div> |
* ## [cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php](/changeset/3099184/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php "Show the changeset 3099184 restricted to cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php")

  | [r3067737](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php?rev=3067737#L1 "Show revision 3067737 of this file in browser") | [r3099184](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php?rev=3099184#L1 "Show revision 3099184 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <div id="opener"> |
  | 2 |  |  |
  | 3 |  |  |
  | 4 | 2 | <form d="gs\_cf7db\_setting" method="post"> |
  | 5 | 3 | <div class="wrap gs-form opacity-down"> |
  | […](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php?rev=3067737#L19) | […](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php?rev=3099184#L17) |  |
  | 19 | 17 | </form> |
  | 20 | 18 |  |
  | 21 |  |  |
  | 22 |  |  |
  | 23 |  |  |
  | 24 | 19 | <div class="wrap"  style="opeacity:0.75; margin-top:30px;"> |
  | 25 | 20 | <div id="icon-users" class="icon32"></div> |
  | […](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php?rev=3067737#L43) | […](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php?rev=3099184#L38) |  |
  | 43 | 38 |  |
  | 44 | 39 | </table> |
  | 45 |  | <div class="tablenav bottom"> |
  |  | 40 | <div class="tablenav bottom"> |
  | 46 | 41 |  |
  | 47 |  | <div class="alignleft actions bulkactions"> |
  |  | 42 | <div class="alignleft actions bulkactions"> |
  | 48 | 43 | </div> |
  | 49 |  | <div class="tablenav-pages one-page"><span class="displaying-num">1 item</span> |
  |  | 44 | <div class="tablenav-pages one-page"><span class="displaying-num">1 item</span> |
  | 50 | 45 | <span class="pagination-links"><span class="tablenav-pages-navspan button disabled" aria-hidden="true">«</span> |
  | 51 | 46 | <span class="tablenav-pages-navspan button disabled" aria-hidden="true">‹</span> |
  | […](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php?rev=3067737#L54) | […](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-cf7-logs.php?rev=3099184#L49) |  |
  | 54 | 49 | <span class="tablenav-pages-navspan button disabled" aria-hidden="true">»</span></span></div> |
  | 55 | 50 | <br class="clear"> |
  | 56 |  | </div> |
  | 57 |  | </div> |
  | 58 |  |  |
  | 59 |  |  |
  | 60 |  |  |
  |  | 51 | </div> |
  |  | 52 | </div> |
  | 61 | 53 | </div> |
  | 62 | 54 |  |
* ## [cf7-google-sheets-connector/trunk/includes/pages/gs-integrate-demo.php](/changeset/3099184/cf7-google-sheets-connector/trunk/includes/pages/gs-integrate-demo.php "Show the changeset 3099184 restricted to cf7-google-sheets-connector/trunk/includes/pages/gs-integrate-demo.php")

  | [r2933200](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-integrate-demo.php?rev=2933200#L1 "Show revision 2933200 of this file in browser") | [r3099184](/browser/cf7-google-sheets-connector/trunk/includes/pages/gs-integrate-demo.php?rev=3099184#L1 "Show revision 3099184 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | ~~<!-- <div class="gs-fields gs-second-block">~~ |
  | 2 |  | ~~<h2><span><?php //echo esc\_html( \_\_('Google Sheet Connector Pro Demo'));?></span></h2>~~ |
  | 3 |  | ~~<p>~~ |
  | 4 |  | ~~<label><?php //echo esc\_html( \_\_('URL')); ?></label>~~ |
  | 5 |  | ~~https://cf7demo.gsheetconnector.com/wp-admin/            </p>~~ |
  | 6 |  | ~~<p>~~ |
  | 7 |  | ~~<label><?php //echo esc\_html( \_\_('UserName')); ?></label>~~ |
  | 8 |  | ~~demo-repo-user            </p>~~ |
  | 9 |  | ~~<p>~~ |
  | 10 |  | ~~<label><?php //echo esc\_html( \_\_('Password')); ?></label>~~ |
  | 11 |  | ~~!rJaJ@ixux!EIAwiW0FwKkTe            </p>~~ |
  | 12 |  | ~~<p>~~ |
  | 13 |  | ~~<label><?php //echo esc\_html( \_\_('Sheet URL')); ?></label>~~ |
  | 14 |  | ~~<a href="https://docs.google.com/spreadsheets/d/1ooBdX0cgtk155ww9MmdMTw8kDavIy5J1m76VwSrcTSs/" target="\_blank" rel="noopener">https://docs.google.com/spreadsheets/d/1ooBdX0cgtk155ww9MmdMTw8kDavIy5J1m76VwSrcTSs/ </a>~~ |
  | 15 |  | ~~</p>~~ |
  | 16 |  | ~~</div> -->~~ |
  | 17 |  |  |
  | 18 | 1 |  |
  | 19 | 2 |  |
* ## [cf7-google-sheets-connector/trunk/readme.txt](/changeset/3099184/cf7-google-sheets-connector/trunk/readme.txt "Show the changeset 3099184 restricted to cf7-google-sheets-connector/trunk/readme.txt")

  | [r3073874](/browser/cf7-google-sheets-connector/trunk/readme.txt?rev=3073874#L7 "Show revision 3073874 of this file in browser") | [r3099184](/browser/cf7-google-sheets-connector/trunk/readme.txt?rev=3099184#L7 "Show revision 3099184 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | Requires at least: 3.6 |
  | 8 | 8 | Requires PHP: 7.4 |
  | 9 |  | Stable tag: 5.0.~~9~~ |
  |  | 9 | Stable tag: 5.0.10 |
  | 10 | 10 | License: GPLv2 or later |
  | 11 | 11 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/cf7-google-sheets-connector/trunk/readme.txt?rev=3073874#L106) | […](/browser/cf7-google-sheets-connector/trunk/readme.txt?rev=3099184#L106) |  |
  | 106 | 106 | == Changelog == |
  | 107 | 107 |  |
  |  | 108 | = 5.0.10 = (07-06-2024) |
  |  | 109 | \* Fixed: Vulnerabilities issues. |
  |  | 110 |  |
  | 108 | 111 | = 5.0.9 = (09-04-2024) |
  | 109 | 112 | \* Added: UI changes. |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3099184)
* [Zip Archive](?format=zip&new=3099184)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_5e83e90c_20250111_152152.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fcf7-google-sheets-connector%2Ftrunk%2Fincludes%2Fclass-gs-service.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?rev=3133254 "Revision 3133254")
* Next Revision →
* [Blame](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/cf7-google-sheets-connector/trunk/includes/class-gs-service.php)

---

# [source:](/browser?order=name "Go to repository root") [cf7-google-sheets-connector](/browser/cf7-google-sheets-connector?order=name "View cf7-google-sheets-connector")/[trunk](/browser/cf7-google-sheets-connector/trunk?order=name "View trunk")/[includes](/browser/cf7-google-sheets-connector/trunk/includes?order=name "View includes")/[class-gs-service.php](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?order=name "View class-gs-service.php")

View diff against:

View revision:

| [Last change](/changeset/3209863/cf7-google-sheets-connector/trunk/includes/class-gs-service.php "View differences") on this file was [3209863](/changeset/3209863/ "View changeset 3209863"), checked in by abdullah17, [3 weeks ago](/timeline?from=2024-12-18T12%3A29%3A47Z&precision=second "See timeline at 12/18/2024 12:29:47 PM") |
| --- |
| released 5.0.17 version |
| **File size:** 55.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Service class for Google Sheet Connector |
| [4](#L4) | \* @since 1.0 |
| [5](#L5) | \*/ |
| [6](#L6) | if ( ! defined( 'ABSPATH' ) ) { |
| [7](#L7) | exit; // Exit if accessed directly |
| [8](#L8) | } |
| [9](#L9) |  |
| [10](#L10) | /\*\* |
| [11](#L11) | \* Gs\_Connector\_Service Class |
| [12](#L12) | \* |
| [13](#L13) | \* @since 1.0 |
| [14](#L14) | \*/ |
| [15](#L15) | class Gs\_Connector\_Service { |
| [16](#L16) |  |
| [17](#L17) | private $allowed\_tags = array( 'text', 'email', 'url', 'tel', 'number', 'range', 'date', 'textarea', 'select', 'checkbox', 'radio', 'acceptance', 'quiz', 'file', 'hidden' ); |
| [18](#L18) |  |
| [19](#L19) | private $special\_mail\_tags = array( 'date', 'time', 'serial\_number', 'remote\_ip', 'user\_agent', 'url', 'post\_id', 'post\_name', 'post\_title', 'post\_url', 'post\_author', 'post\_author\_email', 'site\_title', 'site\_description', 'site\_url', 'site\_admin\_email', 'user\_login', 'user\_email', 'user\_display\_name' ); |
| [20](#L20) |  |
| [21](#L21) | protected $gs\_uploads   = array(); |
| [22](#L22) |  |
| [23](#L23) | /\*\* |
| [24](#L24) | \*  Set things up. |
| [25](#L25) | \*  @since 1.0 |
| [26](#L26) | \*/ |
| [27](#L27) | public function \_\_construct() { |
| [28](#L28) | add\_action( 'wp\_ajax\_verify\_gs\_integation', array( $this, 'verify\_gs\_integation' ) ); |
| [29](#L29) | add\_action( 'wp\_ajax\_gs\_clear\_log', array( $this, 'gs\_clear\_logs' ) ); |
| [30](#L30) |  |
| [31](#L31) | add\_action( 'wp\_ajax\_deactivate\_gs\_integation', array( $this, 'deactivate\_gs\_integation' ) ); |
| [32](#L32) |  |
| [33](#L33) | // clear debug logs method using ajax for system status tab |
| [34](#L34) | add\_action('wp\_ajax\_cf7\_clear\_debug\_log', array($this, 'cf7\_clear\_debug\_logs')); |
| [35](#L35) |  |
| [36](#L36) | // Add new tab to contact form 7 editors panel |
| [37](#L37) | add\_filter( 'wpcf7\_editor\_panels', array( $this, 'cf7\_gs\_editor\_panels' ) ); |
| [38](#L38) |  |
| [39](#L39) | add\_action( 'wpcf7\_after\_save', array( $this, 'save\_gs\_settings' ) ); |
| [40](#L40) | add\_action( 'wpcf7\_before\_send\_mail', array( $this, 'save\_uploaded\_files\_local' ) ); |
| [41](#L41) |  |
| [42](#L42) | add\_action( 'wpcf7\_mail\_sent', array( $this, 'cf7\_save\_to\_google\_sheets' ) ); |
| [43](#L43) |  |
| [44](#L44) | // add\_action('wpcf7\_submit', array($this, 'cf7\_save\_to\_google\_sheets')); |
| [45](#L45) |  |
| [46](#L46) | add\_action( 'admin\_init', array( $this, 'execute\_post\_data\_cf7\_free' ) ); |
| [47](#L47) |  |
| [48](#L48) | } |
| [49](#L49) |  |
| [50](#L50) | public function execute\_post\_data\_cf7\_free() { |
| [51](#L51) | try { |
| [52](#L52) |  |
| [53](#L53) | // Check if the current user has the 'manage\_options' capability |
| [54](#L54) | if ( isset($\_GET['page']) && $\_GET['page']  == 'wpcf7-google-sheet-config' && isset($\_GET['tab']) && $\_GET['tab'] == 'system-status' && !current\_user\_can('manage\_options')) { |
| [55](#L55) | // If the user doesn't have the required capability, show an error message or redirect |
| [56](#L56) | wp\_die(\_\_('You do not have sufficient permissions to access this page.')); |
| [57](#L57) |  |
| [58](#L58) | } |
| [59](#L59) |  |
| [60](#L60) | // save debug logs |
| [61](#L61) | if(isset($\_POST['gs\_cf7free\_debug\_settings'])) { |
| [62](#L62) | // Open the wp-config.php file for writing |
| [63](#L63) | $config\_file\_path = ABSPATH . 'wp-config.php'; |
| [64](#L64) | $config\_content = file\_get\_contents($config\_file\_path); |
| [65](#L65) | $admin\_path = admin\_url('admin.php'); |
| [66](#L66) | $admin\_path\_url = $admin\_path . '?page=wpcf7-google-sheet-config&tab=system-status'; |
| [67](#L67) |  |
| [68](#L68) | // save WP\_DEBUG code |
| [69](#L69) | if(isset($\_POST['wpgsc-debug-cf7free'])) { |
| [70](#L70) | // Update the WP\_DEBUG line |
| [71](#L71) | $config\_content = preg\_replace( |
| [72](#L72) | "/define\(\s\*'WP\_DEBUG',\s\*(true|false)\s\*\);/", |
| [73](#L73) | "define( 'WP\_DEBUG', " . 'true' . " );", |
| [74](#L74) | $config\_content |
| [75](#L75) | ); |
| [76](#L76) |  |
| [77](#L77) | // Save the changes back to the wp-config.php file |
| [78](#L78) | file\_put\_contents($config\_file\_path, $config\_content); |
| [79](#L79) | } |
| [80](#L80) | else { |
| [81](#L81) | // Update the WP\_DEBUG line |
| [82](#L82) | $config\_content = preg\_replace( |
| [83](#L83) | "/define\(\s\*'WP\_DEBUG',\s\*(true|false)\s\*\);/", |
| [84](#L84) | "define( 'WP\_DEBUG', " . 'false' . " );", |
| [85](#L85) | $config\_content |
| [86](#L86) | ); |
| [87](#L87) |  |
| [88](#L88) | // Save the changes back to the wp-config.php file |
| [89](#L89) | file\_put\_contents($config\_file\_path, $config\_content); |
| [90](#L90) | } |
| [91](#L91) |  |
| [92](#L92) | // save WP\_DEBUG\_LOG code |
| [93](#L93) | if(isset($\_POST['wpgsc-debug-log-cf7free'])) { |
| [94](#L94) | // Update the WP\_DEBUG line |
| [95](#L95) | $config\_content = preg\_replace( |
| [96](#L96) | "/define\(\s\*'WP\_DEBUG\_LOG',\s\*(true|false)\s\*\);/", |
| [97](#L97) | "define( 'WP\_DEBUG\_LOG', " . 'true' . " );", |
| [98](#L98) | $config\_content |
| [99](#L99) | ); |
| [100](#L100) |  |
| [101](#L101) | // Save the changes back to the wp-config.php file |
| [102](#L102) | file\_put\_contents($config\_file\_path, $config\_content); |
| [103](#L103) | } |
| [104](#L104) | else { |
| [105](#L105) | // Update the WP\_DEBUG line |
| [106](#L106) | $config\_content = preg\_replace( |
| [107](#L107) | "/define\(\s\*'WP\_DEBUG\_LOG',\s\*(true|false)\s\*\);/", |
| [108](#L108) | "define( 'WP\_DEBUG\_LOG', " . 'false' . " );", |
| [109](#L109) | $config\_content |
| [110](#L110) | ); |
| [111](#L111) |  |
| [112](#L112) | // Save the changes back to the wp-config.php file |
| [113](#L113) | file\_put\_contents($config\_file\_path, $config\_content); |
| [114](#L114) | } |
| [115](#L115) |  |
| [116](#L116) | // save SCRIPT\_DEBUG code |
| [117](#L117) | if(isset($\_POST['wpgsc-script-debug-cf7free'])) { |
| [118](#L118) | // Update the WP\_DEBUG line |
| [119](#L119) | $config\_content = preg\_replace( |
| [120](#L120) | "/define\(\s\*'SCRIPT\_DEBUG',\s\*(true|false)\s\*\);/", |
| [121](#L121) | "define( 'SCRIPT\_DEBUG', " . 'true' . " );", |
| [122](#L122) | $config\_content |
| [123](#L123) | ); |
| [124](#L124) |  |
| [125](#L125) | // Save the changes back to the wp-config.php file |
| [126](#L126) | file\_put\_contents($config\_file\_path, $config\_content); |
| [127](#L127) | } |
| [128](#L128) | else { |
| [129](#L129) | // Update the WP\_DEBUG line |
| [130](#L130) | $config\_content = preg\_replace( |
| [131](#L131) | "/define\(\s\*'SCRIPT\_DEBUG',\s\*(true|false)\s\*\);/", |
| [132](#L132) | "define( 'SCRIPT\_DEBUG', " . 'false' . " );", |
| [133](#L133) | $config\_content |
| [134](#L134) | ); |
| [135](#L135) |  |
| [136](#L136) | // Save the changes back to the wp-config.php file |
| [137](#L137) | file\_put\_contents($config\_file\_path, $config\_content); |
| [138](#L138) | } |
| [139](#L139) |  |
| [140](#L140) | // save SAVEQUERIES code |
| [141](#L141) | if(isset($\_POST['wpgsc-savequeries-cf7free'])) { |
| [142](#L142) | // Update the WP\_DEBUG line |
| [143](#L143) | $config\_content = preg\_replace( |
| [144](#L144) | "/define\(\s\*'SAVEQUERIES',\s\*(true|false)\s\*\);/", |
| [145](#L145) | "define( 'SAVEQUERIES', " . 'true' . " );", |
| [146](#L146) | $config\_content |
| [147](#L147) | ); |
| [148](#L148) |  |
| [149](#L149) | // Save the changes back to the wp-config.php file |
| [150](#L150) | file\_put\_contents($config\_file\_path, $config\_content); |
| [151](#L151) | } |
| [152](#L152) | else { |
| [153](#L153) | // Update the WP\_DEBUG line |
| [154](#L154) | $config\_content = preg\_replace( |
| [155](#L155) | "/define\(\s\*'SAVEQUERIES',\s\*(true|false)\s\*\);/", |
| [156](#L156) | "define( 'SAVEQUERIES', " . 'false' . " );", |
| [157](#L157) | $config\_content |
| [158](#L158) | ); |
| [159](#L159) |  |
| [160](#L160) | // Save the changes back to the wp-config.php file |
| [161](#L161) | file\_put\_contents($config\_file\_path, $config\_content); |
| [162](#L162) | } |
| [163](#L163) |  |
| [164](#L164) | header('Location: ' . $admin\_path\_url); |
| [165](#L165) | exit; |
| [166](#L166) | } |
| [167](#L167) | } catch (Exception $e) { |
| [168](#L168) | // Handle exceptions here if needed |
| [169](#L169) | } |
| [170](#L170) | } |
| [171](#L171) |  |
| [172](#L172) |  |
| [173](#L173) |  |
| [174](#L174) | /\*\* |
| [175](#L175) | \* Build System Information String |
| [176](#L176) | \* @global object $wpdb |
| [177](#L177) | \* @return string |
| [178](#L178) | \* @since 5.3 |
| [179](#L179) | \*/ |
| [180](#L180) | public function get\_cf7gs\_system\_info() { |
| [181](#L181) |  |
| [182](#L182) | global $wpdb; |
| [183](#L183) |  |
| [184](#L184) | // Get WordPress version |
| [185](#L185) | $wp\_version = get\_bloginfo('version'); |
| [186](#L186) |  |
| [187](#L187) | // Get theme info |
| [188](#L188) | $theme\_data = wp\_get\_theme(); |
| [189](#L189) | $theme\_name\_version = $theme\_data->get('Name') . ' ' . $theme\_data->get('Version'); |
| [190](#L190) | $parent\_theme = $theme\_data->get('Template'); |
| [191](#L191) |  |
| [192](#L192) | if (!empty($parent\_theme)) { |
| [193](#L193) | $parent\_theme\_data = wp\_get\_theme($parent\_theme); |
| [194](#L194) | $parent\_theme\_name\_version = $parent\_theme\_data->get('Name') . ' ' . $parent\_theme\_data->get('Version'); |
| [195](#L195) | } else { |
| [196](#L196) | $parent\_theme\_name\_version = 'N/A'; |
| [197](#L197) | } |
| [198](#L198) |  |
| [199](#L199) |  |
| [200](#L200) | // Check plugin version and subscription plan |
| [201](#L201) | $plugin\_version = defined('GS\_CONNECTOR\_VERSION') ? GS\_CONNECTOR\_VERSION : 'N/A'; |
| [202](#L202) | $subscription\_plan = 'FREE'; |
| [203](#L203) |  |
| [204](#L204) | // Check Google Account Authentication |
| [205](#L205) | // $api\_token = get\_option('gs\_token'); |
| [206](#L206) | // $google\_sheet = new CF7GSC\_googlesheet\_PRO(); |
| [207](#L207) | // $email\_account = $google\_sheet->gsheet\_print\_google\_account\_email(); |
| [208](#L208) |  |
| [209](#L209) | $api\_token\_auto = get\_option('gs\_token'); |
| [210](#L210) |  |
| [211](#L211) |  |
| [212](#L212) | if (!empty($api\_token\_auto)) { |
| [213](#L213) | // The user is authenticated through the auto method |
| [214](#L214) | $google\_sheet\_auto = new CF7GSC\_googlesheet(); |
| [215](#L215) |  |
| [216](#L216) | $email\_account\_auto = $google\_sheet\_auto->gsheet\_print\_google\_account\_email(); |
| [217](#L217) | $connected\_email = !empty($email\_account\_auto) ? esc\_html($email\_account\_auto) : 'Not Auth'; |
| [218](#L218) | }  else { |
| [219](#L219) | // Neither auto nor manual authentication is available |
| [220](#L220) | $connected\_email = 'Not Auth'; |
| [221](#L221) | } |
| [222](#L222) |  |
| [223](#L223) |  |
| [224](#L224) | // Check Google Permission |
| [225](#L225) | $gs\_verify\_status = get\_option('gs\_verify'); |
| [226](#L226) | $search\_permission = ($gs\_verify\_status === 'valid') ? 'Given' : 'Not Given'; |
| [227](#L227) |  |
| [228](#L228) |  |
| [229](#L229) | // Create the system info HTML |
| [230](#L230) | $system\_info = '<div class="system-statuswc">'; |
| [231](#L231) | $system\_info .= '<h4><button id="show-info-button" class="info-button">GSheetConnector<span class="dashicons dashicons-arrow-down"></span></h4>'; |
| [232](#L232) | $system\_info .= '<div id="info-container" class="info-content" style="display:none;">'; |
| [233](#L233) | $system\_info .= '<h3>GSheetConnector</h3>'; |
| [234](#L234) | $system\_info .= '<table>'; |
| [235](#L235) | $system\_info .= '<tr><td>Plugin Version</td><td>' . esc\_html($plugin\_version) . '</td></tr>'; |
| [236](#L236) | $system\_info .= '<tr><td>Plugin Subscription Plan</td><td>' . esc\_html($subscription\_plan) . '</td></tr>'; |
| [237](#L237) | $system\_info .= '<tr><td>Connected Email Account</td><td>' . $connected\_email . '</td></tr>'; |
| [238](#L238) | $system\_info .= '<tr><td>Google Drive Permission</td><td>' . esc\_html($search\_permission) . '</td></tr>'; |
| [239](#L239) | $system\_info .= '<tr><td>Google Sheet Permission</td><td>' . esc\_html($search\_permission) . '</td></tr>'; |
| [240](#L240) | $system\_info .= '</table>'; |
| [241](#L241) | $system\_info .= '</div>'; |
| [242](#L242) | // Add WordPress info |
| [243](#L243) | // Create a button for WordPress info |
| [244](#L244) | $system\_info .= '<h2 class="inner-title"><button id="show-wordpress-info-button" class="info-button">WordPress Info<span class="dashicons dashicons-arrow-down"></span></h2>'; |
| [245](#L245) | $system\_info .= '<div id="wordpress-info-container" class="info-content" style="display:none;">'; |
| [246](#L246) | $system\_info .= '<h3>WordPress Info</h3>'; |
| [247](#L247) | $system\_info .= '<table>'; |
| [248](#L248) | $system\_info .= '<tr><td>Version</td><td>' . get\_bloginfo('version') . '</td></tr>'; |
| [249](#L249) | $system\_info .= '<tr><td>Site Language</td><td>' . get\_bloginfo('language') . '</td></tr>'; |
| [250](#L250) | $system\_info .= '<tr><td>Debug Mode</td><td>' . (WP\_DEBUG ? 'Enabled' : 'Disabled') . '</td></tr>'; |
| [251](#L251) | $system\_info .= '<tr><td>Home URL</td><td>' . get\_home\_url() . '</td></tr>'; |
| [252](#L252) | $system\_info .= '<tr><td>Site URL</td><td>' . get\_site\_url() . '</td></tr>'; |
| [253](#L253) | $system\_info .= '<tr><td>Permalink structure</td><td>' . get\_option('permalink\_structure') . '</td></tr>'; |
| [254](#L254) | $system\_info .= '<tr><td>Is this site using HTTPS?</td><td>' . (is\_ssl() ? 'Yes' : 'No') . '</td></tr>'; |
| [255](#L255) | $system\_info .= '<tr><td>Is this a multisite?</td><td>' . (is\_multisite() ? 'Yes' : 'No') . '</td></tr>'; |
| [256](#L256) | $system\_info .= '<tr><td>Can anyone register on this site?</td><td>' . (get\_option('users\_can\_register') ? 'Yes' : 'No') . '</td></tr>'; |
| [257](#L257) | $system\_info .= '<tr><td>Is this site discouraging search engines?</td><td>' . (get\_option('blog\_public') ? 'No' : 'Yes') . '</td></tr>'; |
| [258](#L258) | $system\_info .= '<tr><td>Default comment status</td><td>' . get\_option('default\_comment\_status') . '</td></tr>'; |
| [259](#L259) |  |
| [260](#L260) | $server\_ip = $\_SERVER['REMOTE\_ADDR']; |
| [261](#L261) | if ($server\_ip == '127.0.0.1' || $server\_ip == '::1') { |
| [262](#L262) | $environment\_type = 'localhost'; |
| [263](#L263) | } else { |
| [264](#L264) | $environment\_type = 'production'; |
| [265](#L265) | } |
| [266](#L266) | $system\_info .= '<tr><td>Environment type</td><td>' . esc\_html($environment\_type) . '</td></tr>'; |
| [267](#L267) |  |
| [268](#L268) | $user\_count = count\_users(); |
| [269](#L269) | $total\_users = $user\_count['total\_users']; |
| [270](#L270) | $system\_info .= '<tr><td>User Count</td><td>' . esc\_html($total\_users) . '</td></tr>'; |
| [271](#L271) |  |
| [272](#L272) | $system\_info .= '<tr><td>Communication with WordPress.org</td><td>' . (get\_option('blog\_publicize') ? 'Yes' : 'No') . '</td></tr>'; |
| [273](#L273) | $system\_info .= '</table>'; |
| [274](#L274) | $system\_info .= '</div>'; |
| [275](#L275) |  |
| [276](#L276) | // info about active theme |
| [277](#L277) | $active\_theme = wp\_get\_theme(); |
| [278](#L278) |  |
| [279](#L279) | $system\_info .= '<h2 class="inner-title"><button id="show-active-info-button" class="info-button">Active Theme<span class="dashicons dashicons-arrow-down"></span></h2>'; |
| [280](#L280) | $system\_info .= '<div id="active-info-container" class="info-content" style="display:none;">'; |
| [281](#L281) | $system\_info .= '<h3>Active Theme</h3>'; |
| [282](#L282) | $system\_info .= '<table>'; |
| [283](#L283) | $system\_info .= '<tr><td>Name</td><td>' . $active\_theme->get('Name') .'</td></tr>'; |
| [284](#L284) | $system\_info .= '<tr><td>Version</td><td>' . $active\_theme->get('Version') .'</td></tr>'; |
| [285](#L285) | $system\_info .= '<tr><td>Author</td><td>' . $active\_theme->get('Author') .'</td></tr>'; |
| [286](#L286) | $system\_info .= '<tr><td>Author website</td><td>' . $active\_theme->get('AuthorURI') .'</td></tr>'; |
| [287](#L287) | $system\_info .= '<tr><td>Theme directory location</td><td>' . $active\_theme->get\_template\_directory() .'</td></tr>'; |
| [288](#L288) | $system\_info .= '</table>'; |
| [289](#L289) | $system\_info .= '</div>'; |
| [290](#L290) |  |
| [291](#L291) | // Get a list of other plugins you want to check compatibility with |
| [292](#L292) | $other\_plugins = array( |
| [293](#L293) | 'plugin-folder/plugin-file.php', // Replace with the actual plugin slug |
| [294](#L294) | // Add more plugins as needed |
| [295](#L295) | ); |
| [296](#L296) |  |
| [297](#L297) | // Network Active Plugins |
| [298](#L298) | if (is\_multisite()) { |
| [299](#L299) | $network\_active\_plugins = get\_site\_option('active\_sitewide\_plugins', array()); |
| [300](#L300) | if (!empty($network\_active\_plugins)) { |
| [301](#L301) | $system\_info .= '<h2 class="inner-title"><button id="show-netplug-info-button" class="info-button">Network Active plugins<span class="dashicons dashicons-arrow-down"></span></h2>'; |
| [302](#L302) | $system\_info .= '<div id="netplug-info-container" class="info-content" style="display:none;">'; |
| [303](#L303) | $system\_info .= '<h3>Network Active plugins</h3>'; |
| [304](#L304) | $system\_info .= '<table>'; |
| [305](#L305) | foreach ($network\_active\_plugins as $plugin => $plugin\_data) { |
| [306](#L306) | $plugin\_data = get\_plugin\_data(WP\_PLUGIN\_DIR . '/' . $plugin); |
| [307](#L307) | $system\_info .= '<tr><td>' . $plugin\_data['Name'] . '</td><td>' . $plugin\_data['Version'] . '</td></tr>'; |
| [308](#L308) | } |
| [309](#L309) | // Add more network active plugin statuses here... |
| [310](#L310) | $system\_info .= '</table>'; |
| [311](#L311) | $system\_info .= '</div>'; |
| [312](#L312) | } |
| [313](#L313) | } |
| [314](#L314) | // Active plugins |
| [315](#L315) | $system\_info .= '<h2 class="inner-title"><button id="show-acplug-info-button" class="info-button">Active plugins<span class="dashicons dashicons-arrow-down"></span></h2>'; |
| [316](#L316) | $system\_info .= '<div id="acplug-info-container" class="info-content" style="display:none;">'; |
| [317](#L317) | $system\_info .= '<h3>Active plugins</h3>'; |
| [318](#L318) | $system\_info .= '<table>'; |
| [319](#L319) |  |
| [320](#L320) | // Retrieve all active plugins data |
| [321](#L321) | $active\_plugins\_data = array(); |
| [322](#L322) | $active\_plugins = get\_option('active\_plugins', array()); |
| [323](#L323) | foreach ($active\_plugins as $plugin) { |
| [324](#L324) | $plugin\_data = get\_plugin\_data(WP\_PLUGIN\_DIR . '/' . $plugin); |
| [325](#L325) | $active\_plugins\_data[$plugin] = array( |
| [326](#L326) | 'name'    => $plugin\_data['Name'], |
| [327](#L327) | 'version' => $plugin\_data['Version'], |
| [328](#L328) | 'count'   => 0, // Initialize the count to zero |
| [329](#L329) | ); |
| [330](#L330) | } |
| [331](#L331) |  |
| [332](#L332) | // Count the number of active installations for each plugin |
| [333](#L333) | $all\_plugins = get\_plugins(); |
| [334](#L334) | foreach ($all\_plugins as $plugin\_file => $plugin\_data) { |
| [335](#L335) | if (array\_key\_exists($plugin\_file, $active\_plugins\_data)) { |
| [336](#L336) | $active\_plugins\_data[$plugin\_file]['count']++; |
| [337](#L337) | } |
| [338](#L338) | } |
| [339](#L339) |  |
| [340](#L340) | // Sort plugins based on the number of active installations (descending order) |
| [341](#L341) | uasort($active\_plugins\_data, function ($a, $b) { |
| [342](#L342) | return $b['count'] - $a['count']; |
| [343](#L343) | }); |
| [344](#L344) |  |
| [345](#L345) | // Display the top 5 most used plugins |
| [346](#L346) | $counter = 0; |
| [347](#L347) | foreach ($active\_plugins\_data as $plugin\_data) { |
| [348](#L348) | $system\_info .= '<tr><td>' . $plugin\_data['name'] . '</td><td>' . $plugin\_data['version'] . '</td></tr>'; |
| [349](#L349) | // $counter++; |
| [350](#L350) | // if ($counter >= 5) { |
| [351](#L351) | //     break; |
| [352](#L352) | // } |
| [353](#L353) | } |
| [354](#L354) | $system\_info .= '</table>'; |
| [355](#L355) | $system\_info .= '</div>'; |
| [356](#L356) | // Webserver Configuration |
| [357](#L357) | $system\_info .= '<h2 class="inner-title"><button id="show-server-info-button" class="info-button">Server<span class="dashicons dashicons-arrow-down"></span></h2>'; |
| [358](#L358) | $system\_info .= '<div id="server-info-container" class="info-content" style="display:none;">'; |
| [359](#L359) | $system\_info .= '<h3>Server</h3>'; |
| [360](#L360) | $system\_info .= '<table>'; |
| [361](#L361) | $system\_info .= '<p>The options shown below relate to your server setup. If changes are required, you may need your web host’s assistance.</p>'; |
| [362](#L362) | // Add Server information |
| [363](#L363) | $system\_info .= '<tr><td>Server Architecture</td><td>' . esc\_html(php\_uname('s')) . '</td></tr>'; |
| [364](#L364) | $system\_info .= '<tr><td>Web Server</td><td>' . esc\_html($\_SERVER['SERVER\_SOFTWARE']) . '</td></tr>'; |
| [365](#L365) | $system\_info .= '<tr><td>PHP Version</td><td>' . esc\_html(phpversion()) . '</td></tr>'; |
| [366](#L366) | $system\_info .= '<tr><td>PHP SAPI</td><td>' . esc\_html(php\_sapi\_name()) . '</td></tr>'; |
| [367](#L367) | $system\_info .= '<tr><td>PHP Max Input Variables</td><td>' . esc\_html(ini\_get('max\_input\_vars')) . '</td></tr>'; |
| [368](#L368) | $system\_info .= '<tr><td>PHP Time Limit</td><td>' . esc\_html(ini\_get('max\_execution\_time')) . ' seconds</td></tr>'; |
| [369](#L369) | $system\_info .= '<tr><td>PHP Memory Limit</td><td>' . esc\_html(ini\_get('memory\_limit')) . '</td></tr>'; |
| [370](#L370) | $system\_info .= '<tr><td>Max Input Time</td><td>' . esc\_html(ini\_get('max\_input\_time')) . ' seconds</td></tr>'; |
| [371](#L371) | $system\_info .= '<tr><td>Upload Max Filesize</td><td>' . esc\_html(ini\_get('upload\_max\_filesize')) . '</td></tr>'; |
| [372](#L372) | $system\_info .= '<tr><td>PHP Post Max Size</td><td>' . esc\_html(ini\_get('post\_max\_size')) . '</td></tr>'; |
| [373](#L373) | $system\_info .= '<tr><td>cURL Version</td><td>' . esc\_html(curl\_version()['version']) . '</td></tr>'; |
| [374](#L374) | $system\_info .= '<tr><td>Is SUHOSIN Installed?</td><td>' . (extension\_loaded('suhosin') ? 'Yes' : 'No') . '</td></tr>'; |
| [375](#L375) | $system\_info .= '<tr><td>Is the Imagick Library Available?</td><td>' . (extension\_loaded('imagick') ? 'Yes' : 'No') . '</td></tr>'; |
| [376](#L376) | $system\_info .= '<tr><td>Are Pretty Permalinks Supported?</td><td>' . (get\_option('permalink\_structure') ? 'Yes' : 'No') . '</td></tr>'; |
| [377](#L377) | $system\_info .= '<tr><td>.htaccess Rules</td><td>' . esc\_html(is\_writable('.htaccess') ? 'Writable' : 'Non Writable') . '</td></tr>'; |
| [378](#L378) | $system\_info .= '<tr><td>Current Time</td><td>' . esc\_html(current\_time('mysql')) . '</td></tr>'; |
| [379](#L379) | $system\_info .= '<tr><td>Current UTC Time</td><td>' . esc\_html(current\_time('mysql', true)) . '</td></tr>'; |
| [380](#L380) | $system\_info .= '<tr><td>Current Server Time</td><td>' . esc\_html(date('Y-m-d H:i:s')) . '</td></tr>'; |
| [381](#L381) | $system\_info .= '</table>'; |
| [382](#L382) | $system\_info .= '</div>'; |
| [383](#L383) |  |
| [384](#L384) | // Database Configuration |
| [385](#L385) | $system\_info .= '<h2 class="inner-title"><button id="show-database-info-button" class="info-button">Database<span class="dashicons dashicons-arrow-down"></span></h2>'; |
| [386](#L386) | $system\_info .= '<div id="database-info-container" class="info-content" style="display:none;">'; |
| [387](#L387) | $system\_info .= '<h3>Database</h3>'; |
| [388](#L388) | $system\_info .= '<table>'; |
| [389](#L389) | $database\_extension = 'mysqli'; |
| [390](#L390) | $database\_server\_version = $wpdb->get\_var("SELECT VERSION() as version"); |
| [391](#L391) | $database\_client\_version = $wpdb->db\_version(); |
| [392](#L392) | $database\_username = DB\_USER; |
| [393](#L393) | $database\_host = DB\_HOST; |
| [394](#L394) | $database\_name = DB\_NAME; |
| [395](#L395) | $table\_prefix = $wpdb->prefix; |
| [396](#L396) | $database\_charset = $wpdb->charset; |
| [397](#L397) | $database\_collation = $wpdb->collate; |
| [398](#L398) | $max\_allowed\_packet\_size = $wpdb->get\_var("SHOW VARIABLES LIKE 'max\_allowed\_packet'"); |
| [399](#L399) | $max\_connections\_number = $wpdb->get\_var("SHOW VARIABLES LIKE 'max\_connections'"); |
| [400](#L400) |  |
| [401](#L401) | $system\_info .= '<tr><td>Extension</td><td>' . esc\_html($database\_extension) . '</td></tr>'; |
| [402](#L402) | $system\_info .= '<tr><td>Server Version</td><td>' . esc\_html($database\_server\_version) . '</td></tr>'; |
| [403](#L403) | $system\_info .= '<tr><td>Client Version</td><td>' . esc\_html($database\_client\_version) . '</td></tr>'; |
| [404](#L404) | $system\_info .= '<tr><td>Database Username</td><td>' . esc\_html($database\_username) . '</td></tr>'; |
| [405](#L405) | $system\_info .= '<tr><td>Database Host</td><td>' . esc\_html($database\_host) . '</td></tr>'; |
| [406](#L406) | $system\_info .= '<tr><td>Database Name</td><td>' . esc\_html($database\_name) . '</td></tr>'; |
| [407](#L407) | $system\_info .= '<tr><td>Table Prefix</td><td>' . esc\_html($table\_prefix) . '</td></tr>'; |
| [408](#L408) | $system\_info .= '<tr><td>Database Charset</td><td>' . esc\_html($database\_charset) . '</td></tr>'; |
| [409](#L409) | $system\_info .= '<tr><td>Database Collation</td><td>' . esc\_html($database\_collation) . '</td></tr>'; |
| [410](#L410) | $system\_info .= '<tr><td>Max Allowed Packet Size</td><td>' . esc\_html($max\_allowed\_packet\_size) . '</td></tr>'; |
| [411](#L411) | $system\_info .= '<tr><td>Max Connections Number</td><td>' . esc\_html($max\_connections\_number) . '</td></tr>'; |
| [412](#L412) | $system\_info .= '</table>'; |
| [413](#L413) | $system\_info .= '</div>'; |
| [414](#L414) |  |
| [415](#L415) | // wordpress constants |
| [416](#L416) | $system\_info .= '<h2 class="inner-title"><button id="show-wrcons-info-button" class="info-button">WordPress Constants<span class="dashicons dashicons-arrow-down"></span></h2>'; |
| [417](#L417) | $system\_info .= '<div id="wrcons-info-container" class="info-content" style="display:none;">'; |
| [418](#L418) | $system\_info .= '<h3>WordPress Constants</h3>'; |
| [419](#L419) | $system\_info .= '<table>'; |
| [420](#L420) | // Add WordPress Constants information |
| [421](#L421) | $system\_info .= '<tr><td>ABSPATH</td><td>' . esc\_html(ABSPATH) . '</td></tr>'; |
| [422](#L422) | $system\_info .= '<tr><td>WP\_HOME</td><td>' . esc\_html(home\_url()) . '</td></tr>'; |
| [423](#L423) | $system\_info .= '<tr><td>WP\_SITEURL</td><td>' . esc\_html(site\_url()) . '</td></tr>'; |
| [424](#L424) | $system\_info .= '<tr><td>WP\_CONTENT\_DIR</td><td>' . esc\_html(WP\_CONTENT\_DIR) . '</td></tr>'; |
| [425](#L425) | $system\_info .= '<tr><td>WP\_PLUGIN\_DIR</td><td>' . esc\_html(WP\_PLUGIN\_DIR) . '</td></tr>'; |
| [426](#L426) | $system\_info .= '<tr><td>WP\_MEMORY\_LIMIT</td><td>' . esc\_html(WP\_MEMORY\_LIMIT) . '</td></tr>'; |
| [427](#L427) | $system\_info .= '<tr><td>WP\_MAX\_MEMORY\_LIMIT</td><td>' . esc\_html(WP\_MAX\_MEMORY\_LIMIT) . '</td></tr>'; |
| [428](#L428) | $system\_info .= '<tr><td>WP\_DEBUG</td><td>' . (defined('WP\_DEBUG') && WP\_DEBUG ? 'Yes' : 'No') . '</td></tr>'; |
| [429](#L429) | $system\_info .= '<tr><td>WP\_DEBUG\_DISPLAY</td><td>' . (defined('WP\_DEBUG\_DISPLAY') && WP\_DEBUG\_DISPLAY ? 'Yes' : 'No') . '</td></tr>'; |
| [430](#L430) | $system\_info .= '<tr><td>SCRIPT\_DEBUG</td><td>' . (defined('SCRIPT\_DEBUG') && SCRIPT\_DEBUG ? 'Yes' : 'No') . '</td></tr>'; |
| [431](#L431) | $system\_info .= '<tr><td>WP\_CACHE</td><td>' . (defined('WP\_CACHE') && WP\_CACHE ? 'Yes' : 'No') . '</td></tr>'; |
| [432](#L432) | $system\_info .= '<tr><td>CONCATENATE\_SCRIPTS</td><td>' . (defined('CONCATENATE\_SCRIPTS') && CONCATENATE\_SCRIPTS ? 'Yes' : 'No') . '</td></tr>'; |
| [433](#L433) | $system\_info .= '<tr><td>COMPRESS\_SCRIPTS</td><td>' . (defined('COMPRESS\_SCRIPTS') && COMPRESS\_SCRIPTS ? 'Yes' : 'No') . '</td></tr>'; |
| [434](#L434) | $system\_info .= '<tr><td>COMPRESS\_CSS</td><td>' . (defined('COMPRESS\_CSS') && COMPRESS\_CSS ? 'Yes' : 'No') . '</td></tr>'; |
| [435](#L435) | // Manually define the environment type (example values: 'development', 'staging', 'production') |
| [436](#L436) | $environment\_type = 'development'; |
| [437](#L437) |  |
| [438](#L438) | // Display the environment type |
| [439](#L439) | $system\_info .= '<tr><td>WP\_ENVIRONMENT\_TYPE</td><td>' . esc\_html($environment\_type) . '</td></tr>'; |
| [440](#L440) |  |
| [441](#L441) | $system\_info .= '<tr><td>WP\_DEVELOPMENT\_MODE</td><td>' . (defined('WP\_DEVELOPMENT\_MODE') && WP\_DEVELOPMENT\_MODE ? 'Yes' : 'No') . '</td></tr>'; |
| [442](#L442) | $system\_info .= '<tr><td>DB\_CHARSET</td><td>' . esc\_html(DB\_CHARSET) . '</td></tr>'; |
| [443](#L443) | $system\_info .= '<tr><td>DB\_COLLATE</td><td>' . esc\_html(DB\_COLLATE) . '</td></tr>'; |
| [444](#L444) |  |
| [445](#L445) | $system\_info .= '</table>'; |
| [446](#L446) | $system\_info .= '</div>'; |
| [447](#L447) |  |
| [448](#L448) | // Filesystem Permission |
| [449](#L449) | $system\_info .= '<h2 class="inner-title"><button id="show-ftps-info-button" class="info-button">Filesystem Permission <span class="dashicons dashicons-arrow-down"></span></button></h2>'; |
| [450](#L450) | $system\_info .= '<div id="ftps-info-container" class="info-content" style="display:none;">'; |
| [451](#L451) | $system\_info .= '<h3>Filesystem Permission</h3>'; |
| [452](#L452) | $system\_info .= '<p>Shows whether WordPress is able to write to the directories it needs access to.</p>'; |
| [453](#L453) | $system\_info .= '<table>'; |
| [454](#L454) | // Filesystem Permission information |
| [455](#L455) | $system\_info .= '<tr><td>The main WordPress directory</td><td>' . esc\_html(ABSPATH) . '</td><td>' . (is\_writable(ABSPATH) ? 'Writable' : 'Not Writable') . '</td></tr>'; |
| [456](#L456) | $system\_info .= '<tr><td>The wp-content directory</td><td>' . esc\_html(WP\_CONTENT\_DIR) . '</td><td>' . (is\_writable(WP\_CONTENT\_DIR) ? 'Writable' : 'Not Writable') . '</td></tr>'; |
| [457](#L457) | $system\_info .= '<tr><td>The uploads directory</td><td>' . esc\_html(wp\_upload\_dir()['basedir']) . '</td><td>' . (is\_writable(wp\_upload\_dir()['basedir']) ? 'Writable' : 'Not Writable') . '</td></tr>'; |
| [458](#L458) | $system\_info .= '<tr><td>The plugins directory</td><td>' . esc\_html(WP\_PLUGIN\_DIR) . '</td><td>' . (is\_writable(WP\_PLUGIN\_DIR) ? 'Writable' : 'Not Writable') . '</td></tr>'; |
| [459](#L459) | $system\_info .= '<tr><td>The themes directory</td><td>' . esc\_html(get\_theme\_root()) . '</td><td>' . (is\_writable(get\_theme\_root()) ? 'Writable' : 'Not Writable') . '</td></tr>'; |
| [460](#L460) |  |
| [461](#L461) | $system\_info .= '</table>'; |
| [462](#L462) | $system\_info .= '</div>'; |
| [463](#L463) |  |
| [464](#L464) | return $system\_info; |
| [465](#L465) | } |
| [466](#L466) |  |
| [467](#L467) |  |
| [468](#L468) | public function display\_error\_cf7\_log() { |
| [469](#L469) |  |
| [470](#L470) | // Define the path to your debug log file |
| [471](#L471) | $debug\_log\_file = WP\_CONTENT\_DIR. '/debug.log'; |
| [472](#L472) |  |
| [473](#L473) | // Check if the debug log file exists |
| [474](#L474) | if (file\_exists($debug\_log\_file)) { |
| [475](#L475) | // Read the contents of the debug log file |
| [476](#L476) | $debug\_log\_contents = file\_get\_contents($debug\_log\_file); |
| [477](#L477) |  |
| [478](#L478) | // Split the log content into an array of lines |
| [479](#L479) | $log\_lines = explode("\n", $debug\_log\_contents); |
| [480](#L480) |  |
| [481](#L481) | // Get the last 100 lines in reversed order |
| [482](#L482) | $last\_100\_lines = array\_slice(array\_reverse($log\_lines), 0, 100); |
| [483](#L483) |  |
| [484](#L484) | // Join the lines back together with line breaks |
| [485](#L485) | $last\_100\_log = implode("\n", $last\_100\_lines); |
| [486](#L486) |  |
| [487](#L487) | // Output the last 100 lines in reversed order in a textarea |
| [488](#L488) | ?> |
| [489](#L489) | <textarea class="errorlog" rows="20" cols="80"><?php echo esc\_textarea($last\_100\_log); ?></textarea> |
| [490](#L490) | <?php |
| [491](#L491) | } else { |
| [492](#L492) | echo 'Debug log file not found.'; |
| [493](#L493) | } |
| [494](#L494) | } |
| [495](#L495) |  |
| [496](#L496) |  |
| [497](#L497) | /\*\* |
| [498](#L498) | \* AJAX function - verifies the token |
| [499](#L499) | \* |
| [500](#L500) | \* @since 1.0 |
| [501](#L501) | \*/ |
| [502](#L502) | public function verify\_gs\_integation() { |
| [503](#L503) | // nonce checksave\_gs\_settings |
| [504](#L504) | check\_ajax\_referer( 'gs-ajax-nonce', 'security' ); |
| [505](#L505) |  |
| [506](#L506) | /\* sanitize incoming data \*/ |
| [507](#L507) | $Code = sanitize\_text\_field( $\_POST["code"] ); |
| [508](#L508) |  |
| [509](#L509) | update\_option( 'gs\_access\_code', $Code ); |
| [510](#L510) |  |
| [511](#L511) | if ( get\_option( 'gs\_access\_code' ) != '' ) { |
| [512](#L512) | include\_once( GS\_CONNECTOR\_ROOT . '/lib/google-sheets.php'); |
| [513](#L513) | cf7gsc\_googlesheet::preauth( get\_option( 'gs\_access\_code' ) ); |
| [514](#L514) | // update\_option( 'gs\_verify', 'valid' ); |
| [515](#L515) | wp\_send\_json\_success(); |
| [516](#L516) | } else { |
| [517](#L517) | update\_option( 'gs\_verify', 'invalid' ); |
| [518](#L518) | wp\_send\_json\_error(); |
| [519](#L519) | } |
| [520](#L520) | } |
| [521](#L521) |  |
| [522](#L522) | /\*\* |
| [523](#L523) | \* AJAX function - deactivate activation |
| [524](#L524) | \* @since 4.2 |
| [525](#L525) | \*/ |
| [526](#L526) | public function deactivate\_gs\_integation() { |
| [527](#L527) | // nonce check |
| [528](#L528) | check\_ajax\_referer('gs-ajax-nonce', 'security'); |
| [529](#L529) |  |
| [530](#L530) | if ( get\_option('gs\_token') !== '' ) { |
| [531](#L531) | $accesstoken = get\_option( 'gs\_token' ); |
| [532](#L532) | $client = new CF7GSC\_googlesheet(); |
| [533](#L533) | $client->revokeToken\_auto($accesstoken); |
| [534](#L534) | delete\_option('gs\_token'); |
| [535](#L535) | delete\_option('gs\_access\_code'); |
| [536](#L536) | delete\_option('gs\_verify'); |
| [537](#L537) |  |
| [538](#L538) | wp\_send\_json\_success(); |
| [539](#L539) | } else { |
| [540](#L540) | wp\_send\_json\_error(); |
| [541](#L541) | } |
| [542](#L542) | } |
| [543](#L543) |  |
| [544](#L544) | /\*\* |
| [545](#L545) | \* AJAX function - clear log file |
| [546](#L546) | \* @since 2.1 |
| [547](#L547) | \*/ |
| [548](#L548) | public function gs\_clear\_logs() { |
| [549](#L549) | // nonce check |
| [550](#L550) | check\_ajax\_referer( 'gs-ajax-nonce', 'security' ); |
| [551](#L551) | $existDebugFile = get\_option('gs\_debug\_log\_file'); |
| [552](#L552) | $clear\_file\_msg =''; |
| [553](#L553) | // check if debug unique log file exist or not then exists to clear file |
| [554](#L554) | if (!empty($existDebugFile) && file\_exists($existDebugFile)) { |
| [555](#L555) |  |
| [556](#L556) | $handle = fopen ( $existDebugFile, 'w'); |
| [557](#L557) |  |
| [558](#L558) | fclose( $handle ); |
| [559](#L559) | $clear\_file\_msg ='Logs are cleared.'; |
| [560](#L560) | } |
| [561](#L561) | else{ |
| [562](#L562) | $clear\_file\_msg = 'No log file exists to clear logs.'; |
| [563](#L563) | } |
| [564](#L564) |  |
| [565](#L565) |  |
| [566](#L566) | wp\_send\_json\_success($clear\_file\_msg); |
| [567](#L567) | } |
| [568](#L568) | /\*\* |
| [569](#L569) | \* AJAX function - clear log file for system status tab |
| [570](#L570) | \* @since 2.1 |
| [571](#L571) | \*/ |
| [572](#L572) | public function cf7\_clear\_debug\_logs() { |
| [573](#L573) | // nonce check |
| [574](#L574) | check\_ajax\_referer('gs-ajax-nonce', 'security'); |
| [575](#L575) | $handle = fopen(WP\_CONTENT\_DIR . '/debug.log', 'w'); |
| [576](#L576) | fclose($handle); |
| [577](#L577) | wp\_send\_json\_success(); |
| [578](#L578) | } |
| [579](#L579) |  |
| [580](#L580) | /\*\* |
| [581](#L581) | \* Add new tab to contact form 7 editors panel |
| [582](#L582) | \* @since 1.0 |
| [583](#L583) | \*/ |
| [584](#L584) | public function cf7\_gs\_editor\_panels( $panels ) { |
| [585](#L585) | if ( current\_user\_can( 'wpcf7\_edit\_contact\_forms' ) ) { |
| [586](#L586) | $panels['google\_sheets'] = array( |
| [587](#L587) | 'title' => \_\_( 'Google Sheets', 'contact-form-7' ), |
| [588](#L588) | 'callback' => array( $this, 'cf7\_editor\_panel\_google\_sheet' ) |
| [589](#L589) | ); |
| [590](#L590) | } |
| [591](#L591) | return $panels; |
| [592](#L592) | } |
| [593](#L593) |  |
| [594](#L594) | /\*\* |
| [595](#L595) | \* Set Google sheet settings with contact form |
| [596](#L596) | \* @since 1.0 |
| [597](#L597) | \*/ |
| [598](#L598) | public function save\_gs\_settings( $post ) { |
| [599](#L599) | $default = array( |
| [600](#L600) | "sheet-name" => "", |
| [601](#L601) | "sheet-id" => "", |
| [602](#L602) | "sheet-tab-name" => "", |
| [603](#L603) | "tab-id" => "" |
| [604](#L604) |  |
| [605](#L605) | ); |
| [606](#L606) | $sheet\_data = isset( $\_POST['cf7-gs'] ) ? $\_POST['cf7-gs'] : $default; |
| [607](#L607) | update\_post\_meta( $post->id(), 'gs\_settings', $sheet\_data ); |
| [608](#L608) |  |
| [609](#L609) | } |
| [610](#L610) |  |
| [611](#L611) | /\*\* |
| [612](#L612) | \* Create array of file name for the uploaded files |
| [613](#L613) | \* @since 4.5 |
| [614](#L614) | \*/ |
| [615](#L615) | public function save\_uploaded\_files\_local() { |
| [616](#L616) | $form = WPCF7\_Submission::get\_instance(); |
| [617](#L617) | if ( $form ) { |
| [618](#L618) | $files               = $form->uploaded\_files(); |
| [619](#L619) | $uploads\_stored      = array(); |
| [620](#L620) |  |
| [621](#L621) | foreach ( $files as $field\_name => $file\_path ) { |
| [622](#L622) | if ( ! isset( $\_FILES[ $field\_name ] ) ) { |
| [623](#L623) | continue; |
| [624](#L624) | } |
| [625](#L625) |  |
| [626](#L626) | $file\_details = $\_FILES[ $field\_name ]; |
| [627](#L627) | $file\_name = $file\_details['name']; |
| [628](#L628) | $uploads\_stored[ $field\_name ] = $file\_name; |
| [629](#L629) | } |
| [630](#L630) | $this->gs\_uploads = $uploads\_stored; |
| [631](#L631) | } |
| [632](#L632) | } |
| [633](#L633) |  |
| [634](#L634) | /\*\* |
| [635](#L635) | \* Function - To send contact form data to google spreadsheet |
| [636](#L636) | \* @param object $form |
| [637](#L637) | \* @since 1.0 |
| [638](#L638) | \*/ |
| [639](#L639) | public function cf7\_save\_to\_google\_sheets( $form ) { |
| [640](#L640) |  |
| [641](#L641) | $submission = WPCF7\_Submission::get\_instance(); |
| [642](#L642) |  |
| [643](#L643) | // get form data |
| [644](#L644) | $form\_id = $form->id(); |
| [645](#L645) | $form\_data = get\_post\_meta( $form\_id, 'gs\_settings' ); |
| [646](#L646) | $data = array(); |
| [647](#L647) |  |
| [648](#L648) | // if contact form sheet name and tab name is not empty than send data to spreedsheet |
| [649](#L649) | if ( $submission && (! empty( $form\_data[0]['sheet-name'] ) ) && (! empty( $form\_data[0]['sheet-tab-name'] ) ) ) { |
| [650](#L650) | $posted\_data = $submission->get\_posted\_data(); |
| [651](#L651) |  |
| [652](#L652) | // make sure the form ID matches the setting otherwise don't do anything |
| [653](#L653) | try { |
| [654](#L654) | include\_once( GS\_CONNECTOR\_ROOT . "/lib/google-sheets.php" ); |
| [655](#L655) | $doc = new cf7gsc\_googlesheet(); |
| [656](#L656) | $doc->auth(); |
| [657](#L657) | $doc->setSpreadsheetId( $form\_data[0]['sheet-id'] ); |
| [658](#L658) | $doc->setWorkTabId( $form\_data[0]['tab-id'] ); |
| [659](#L659) |  |
| [660](#L660) | // Special Mail Tags |
| [661](#L661) | $meta = array(); |
| [662](#L662) |  |
| [663](#L663) | $special\_mail\_tags = array( 'serial\_number', 'remote\_ip', 'user\_agent', 'url', 'date', 'time', 'post\_id', 'post\_name', 'post\_title', 'post\_url', 'post\_author', 'post\_author\_email', 'site\_title', 'site\_description', 'site\_url', 'site\_admin\_email', 'user\_login', 'user\_email', 'user\_url', 'user\_first\_name', 'user\_last\_name', 'user\_nickname', 'user\_display\_name' ); |
| [664](#L664) |  |
| [665](#L665) | foreach ( $special\_mail\_tags as $smt ) { |
| [666](#L666) | $tagname = sprintf( '\_%s', $smt ); |
| [667](#L667) |  |
| [668](#L668) | $mail\_tag = new WPCF7\_MailTag( |
| [669](#L669) | sprintf( '[%s]', $tagname ), |
| [670](#L670) | $tagname, |
| [671](#L671) | '' |
| [672](#L672) | ); |
| [673](#L673) |  |
| [674](#L674) | $meta[$smt] = apply\_filters( 'wpcf7\_special\_mail\_tags', '', $tagname, false, $mail\_tag ); |
| [675](#L675) |  |
| [676](#L676) | } |
| [677](#L677) |  |
| [678](#L678) | if ( ! empty( $meta ) ) { |
| [679](#L679) | $data["date"] = $meta["date"]; |
| [680](#L680) | $data["time"] = $meta["time"]; |
| [681](#L681) | $data["serial-number"] = $meta["serial\_number"]; |
| [682](#L682) | $data["remote-ip"] = $meta["remote\_ip"]; |
| [683](#L683) | $data["user-agent"] = $meta["user\_agent"]; |
| [684](#L684) | $data["url"] = $meta["url"]; |
| [685](#L685) | $data["post-id"] = $meta["post\_id"]; |
| [686](#L686) | $data["post-name"] = $meta["post\_name"]; |
| [687](#L687) | $data["post-title"] = $meta["post\_title"]; |
| [688](#L688) | $data["post-url"] = $meta["post\_url"]; |
| [689](#L689) | $data["post-author"] = $meta["post\_author"]; |
| [690](#L690) | $data["post-author-email"] = $meta["post\_author\_email"]; |
| [691](#L691) | $data["site-title"] = $meta["site\_title"]; |
| [692](#L692) | $data["site-description"] = $meta["site\_description"]; |
| [693](#L693) | $data["site-url"] = $meta["site\_url"]; |
| [694](#L694) | $data["site-admin-email"] = $meta["site\_admin\_email"]; |
| [695](#L695) | $data["user-login"] = $meta["user\_login"]; |
| [696](#L696) | $data["user-email"] = $meta["user\_email"]; |
| [697](#L697) | $data["user-url"] = $meta["user\_url"]; |
| [698](#L698) | $data["user-first-name"] = $meta["user\_first\_name"]; |
| [699](#L699) | $data["user-last-name"] = $meta["user\_last\_name"]; |
| [700](#L700) | $data["user-nickname"] = $meta["user\_nickname"]; |
| [701](#L701) | $data["user-display-name"] = $meta["user\_display\_name"]; |
| [702](#L702) | } |
| [703](#L703) |  |
| [704](#L704) | foreach ( $posted\_data as $key => $value ) { |
| [705](#L705) | // exclude the default wpcf7 fields in object |
| [706](#L706) | if ( strpos( $key, '\_wpcf7' ) !== false || strpos( $key, '\_wpnonce' ) !== false ) { |
| [707](#L707) | // do nothing |
| [708](#L708) | } else { |
| [709](#L709) | // Get file name array |
| [710](#L710) | $uploaded\_file = $this->gs\_uploads; |
| [711](#L711) | if ( array\_key\_exists( $key, $uploaded\_file ) || isset( $uploaded\_file[ $key ] ) ) { |
| [712](#L712) | $data[ $key ] = sanitize\_file\_name( $uploaded\_file[ $key ] ); |
| [713](#L713) | continue; |
| [714](#L714) | } |
| [715](#L715) |  |
| [716](#L716) | // handle strings and array elements |
| [717](#L717) | if ( is\_array( $value ) ) { |
| [718](#L718) | $data[ $key ] = sanitize\_text\_field( implode( ', ', $value ) ); |
| [719](#L719) | } else { |
| [720](#L720) | //$data[$key] = sanitize\_text\_field(stripcslashes($value));//Old Code |
| [721](#L721) | $data[$key] = sanitize\_textarea\_field(stripcslashes($value));//Line Break in textarea issue resolved. |
| [722](#L722) | } |
| [723](#L723) | } |
| [724](#L724) | } |
| [725](#L725) | if(!empty($data)){ |
| [726](#L726) | foreach ($data as $key => $value) { |
| [727](#L727) | // Check if the value starts with one of the specified characters and remove it if it does |
| [728](#L728) | if (strpos($value, '=') === 0 || strpos($value, '+') === 0 || strpos($value, '-') === 0 || strpos($value, '@') === 0) { |
| [729](#L729) | $data[$key] = ltrim($value, '=+-@'); |
| [730](#L730) | } |
| [731](#L731) | } |
| [732](#L732) | } |
| [733](#L733) |  |
| [734](#L734) |  |
| [735](#L735) | // Filter Form Submitted data such as for repetable fields plugin |
| [736](#L736) | $data = apply\_filters( 'gsc\_filter\_form\_data', $data, $form ); |
| [737](#L737) | if( ! empty( $data[0] ) && is\_array( $data[0] ) ) { |
| [738](#L738) | $doc->add\_multiple\_row( $data ); |
| [739](#L739) | } else { |
| [740](#L740) | $doc->add\_row( $data ); |
| [741](#L741) | } |
| [742](#L742) |  |
| [743](#L743) | } catch ( Exception $e ) { |
| [744](#L744) | $data['ERROR\_MSG'] = $e->getMessage(); |
| [745](#L745) | $data['TRACE\_STK'] = $e->getTraceAsString(); |
| [746](#L746) | Gs\_Connector\_Utility::gs\_debug\_log( $data ); |
| [747](#L747) | } |
| [748](#L748) | } |
| [749](#L749) | } |
| [750](#L750) |  |
| [751](#L751) | /\* |
| [752](#L752) | \* Google sheet settings page |
| [753](#L753) | \* @since 1.0 |
| [754](#L754) | \*/ |
| [755](#L755) |  |
| [756](#L756) | public function cf7\_editor\_panel\_google\_sheet( $post ) { |
| [757](#L757) |  |
| [758](#L758) | // Check if the user is authenticated |
| [759](#L759) | $authenticated = get\_option('gs\_token'); |
| [760](#L760) |  |
| [761](#L761) | $per = get\_option('gs\_verify'); |
| [762](#L762) | $per\_msg = \_\_( 'invalid-auth', 'gsconnector' ); |
| [763](#L763) | // check user is authenticated when save existing api method |
| [764](#L764) | $show\_setting = 0; |
| [765](#L765) |  |
| [766](#L766) | if ((!empty($authenticated) && $per == "valid") ) { |
| [767](#L767) | $show\_setting = 1; |
| [768](#L768) | } |
| [769](#L769) | else{ |
| [770](#L770) | ?> |
| [771](#L771) | <p class="gs-display-note"> |
| [772](#L772) | <?php |
| [773](#L773) | echo \_\_( '<strong>Authentication Required:</strong> |
| [774](#L774) | You must have to <a href="admin.php?page=wpcf7-google-sheet-config&tab=integration" target="\_blank">Authenticate using your Google Account</a> along with Google Drive and Google Sheets Permissions in order to enable the settings for configuration.', 'gsconnector' ); |
| [775](#L775) | ?> |
| [776](#L776) |  |
| [777](#L777) | </p> |
| [778](#L778) | <?php |
| [779](#L779) | } |
| [780](#L780) | if($show\_setting == 1){ |
| [781](#L781) | $form\_data = ""; |
| [782](#L782) | if(isset($\_GET['post'])){ |
| [783](#L783) | $form\_id = sanitize\_text\_field( $\_GET['post'] ); |
| [784](#L784) | $form\_data = get\_post\_meta( $form\_id, 'gs\_settings' ); |
| [785](#L785) | } |
| [786](#L786) |  |
| [787](#L787) | ?> |
| [788](#L788) |  |
| [789](#L789) |  |
| [790](#L790) | <ul id="contact-form-editor-tabs" role="tablist" |
| [791](#L791) | class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header"> |
| [792](#L792) | <li id="form-panel-tab" role="tab" tabindex="-1" |
| [793](#L793) | class="ui-tabs-tab ui-corner-top ui-state-default ui-tab cf7-sub-tab-active cf7-sub-tab-single-li" |
| [794](#L794) | aria-controls="form-panel" aria-labelledby="ui-id-1" aria-selected="false" aria-expanded="false" |
| [795](#L795) | onClick="sigle\_multi\_tab('cf7-sub-tab-single')"> |
| [796](#L796) | <a href="#form-panel" tabindex="-1" style='box-shadow: 0 0 0 0px #fff  !important; |
| [797](#L797) | outline: 0px solid transparent !important;' class="ui-tabs-anchor" |
| [798](#L798) | id="cf7-sub-tab-single"><?php echo esc\_html( \_\_('Single |
| [799](#L799) | Sheet Connection', 'gsconnector' ) ); ?></a> |
| [800](#L800) | </li> |
| [801](#L801) | <li id="form-panel-tab" role="tab" tabindex="-1" |
| [802](#L802) | class="ui-tabs-tab ui-corner-top ui-state-default ui-tab cf7-sub-tab-multi-li" aria-controls="form-panel" |
| [803](#L803) | aria-labelledby="ui-id-1" aria-selected="false" aria-expanded="false" |
| [804](#L804) | onClick="sigle\_multi\_tab('cf7-sub-tab-multi')"><a href="#form-panel-multi" tabindex="-1" |
| [805](#L805) | style=' box-shadow: 0 0 0 0px #fff  !important; |
| [806](#L806) | outline: 0px solid transparent !important;' class="ui-tabs-anchor" id="cf7-sub-tab-multi"><?php echo esc\_html( \_\_('Multi Sheet |
| [807](#L807) | Connection', 'gsconnector' ) ); ?> <span class="pro"><?php echo esc\_html( \_\_('Pro', 'gsconnector' ) ); ?></span></a> |
| [808](#L808) |  |
| [809](#L809) | </li> |
| [810](#L810) | </ul> |
| [811](#L811) |  |
| [812](#L812) |  |
| [813](#L813) |  |
| [814](#L814) |  |
| [815](#L815) |  |
| [816](#L816) | <div class="cf7-sub-tab-single cf7-sub-tab" style="display:block"> |
| [817](#L817) | <!-- Single sheet connection START --> |
| [818](#L818) | <form method="post" > |
| [819](#L819) | <div class="gs-fields" > |
| [820](#L820) | <h2 class="inner-title"><span><?php echo esc\_html( \_\_( 'Google Sheet Settings', 'gsconnector' ) ); ?></span><span class="gs-info"><?php echo \_\_( '( Fetch your sheets automatically using PRO )', 'gsconnector'); ?> </span></h2> |
| [821](#L821) | <p> |
| [822](#L822) | <label><?php echo esc\_html( \_\_( 'Google Sheet Name', 'gsconnector' ) ); ?></label> |
| [823](#L823) | <input type="text" name="cf7-gs[sheet-name]" id="gs-sheet-name" |
| [824](#L824) | value="<?php echo ( isset( $form\_data[0]['sheet-name'] ) ) ? esc\_attr( $form\_data[0]['sheet-name'] ) : ''; ?>"/> |
| [825](#L825) |  |
| [826](#L826) |  |
| [827](#L827) | <a href="" class=" gs-name help-link"><img src="<?php echo GS\_CONNECTOR\_URL; ?>assets/img/help.png" class="help-icon"><?php //echo esc\_html( \_\_( 'Where do i get Sheet Name?', 'gsconnector' ) ); ?><span class='hover-data'><?php echo esc\_html( \_\_( 'Go to your google account and click on"Google apps" icon and than click "Sheets". Select the name of the appropriate sheet you want to link your contact form or create new sheet.', 'gsconnector' ) ); ?> </span></a> |
| [828](#L828) | </p> |
| [829](#L829) | <p> |
| [830](#L830) | <label><?php echo esc\_html(\_\_('Google Sheet ID', 'gsconnector')); ?></label> |
| [831](#L831) | <input type="text" name="cf7-gs[sheet-id]" id="gs-sheet-id" |
| [832](#L832) | value="<?php echo ( isset($form\_data[0]['sheet-id']) ) ? esc\_attr($form\_data[0]['sheet-id']) : ''; ?>"/> |
| [833](#L833) | <a href="" class=" gs-name help-link"><img src="<?php echo GS\_CONNECTOR\_URL; ?>assets/img/help.png" class="help-icon"><?php //echo esc\_html(\_\_('Google Sheet Id?', 'gsconnector')); ?><span class='hover-data'><?php echo esc\_html(\_\_('you can get sheet id from your sheet URL', 'gsconnector')); ?></span></a> |
| [834](#L834) | </p> |
| [835](#L835) | <p> |
| [836](#L836) | <label><?php echo esc\_html( \_\_( 'Google Sheet Tab Name', 'gsconnector' ) ); ?></label> |
| [837](#L837) | <input type="text" name="cf7-gs[sheet-tab-name]" id="gs-sheet-tab-name" |
| [838](#L838) | value="<?php echo ( isset( $form\_data[0]['sheet-tab-name'] ) ) ? esc\_attr( $form\_data[0]['sheet-tab-name'] ) : ''; ?>"/> |
| [839](#L839) | <a href="" class=" gs-name help-link"><img src="<?php echo GS\_CONNECTOR\_URL; ?>assets/img/help.png" class="help-icon"><?php //echo esc\_html( \_\_( 'Where do i get Tab Name?', 'gsconnector' ) ); ?><span class='hover-data'><?php echo esc\_html( \_\_( 'Open your Google Sheet with which you want to link your contact form . You will notice a tab names at bottom of the screen. Copy the tab name where you want to have an entry of contact form.', 'gsconnector' ) ); ?></span></a> |
| [840](#L840) | </p> |
| [841](#L841) | <p> |
| [842](#L842) | <label><?php echo esc\_html(\_\_('Google Tab ID', 'gsconnector')); ?></label> |
| [843](#L843) | <input type="text" name="cf7-gs[tab-id]" id="gs-tab-id" |
| [844](#L844) | value="<?php echo ( isset($form\_data[0]['tab-id']) ) ? esc\_attr($form\_data[0]['tab-id']) : ''; ?>"/> |
| [845](#L845) | <a href="" class=" gs-name help-link"><img src="<?php echo GS\_CONNECTOR\_URL; ?>assets/img/help.png" class="help-icon"><?php //echo esc\_html(\_\_('Google Tab Id?', 'gsconnector')); ?><span class='hover-data'><?php echo esc\_html(\_\_('you can get tab id from your sheet URL', 'gsconnector')); ?></span></a> |
| [846](#L846) | </p> |
| [847](#L847) |  |
| [848](#L848) | <?php if((isset( $form\_data[0]['sheet-name'] )) && !empty($form\_data[0]['sheet-name']) && (isset($form\_data[0]['sheet-id'])) && (!empty($form\_data[0]['sheet-id'])) &&  (isset( $form\_data[0]['sheet-tab-name']))  && (!empty($form\_data[0]['sheet-tab-name'])) && (isset($form\_data[0]['tab-id']))) { |
| [849](#L849) | $link = "https://docs.google.com/spreadsheets/d/".$form\_data[0]['sheet-id']."/edit#gid=".$form\_data[0]['tab-id']; |
| [850](#L850) | ?> |
| [851](#L851) | <p> |
| [852](#L852) | <a href="<?php echo $link; ?>" target="\_blank" class="cf7\_gs\_link" >Google Sheet Link</a> |
| [853](#L853) | </p> |
| [854](#L854) | <?php } ?> |
| [855](#L855) | </div> |
| [856](#L856) | </form> |
| [857](#L857) |  |
| [858](#L858) | <div id="opener"> |
| [859](#L859) |  |
| [860](#L860) | <?php |
| [861](#L861) |  |
| [862](#L862) |  |
| [863](#L863) | include( GS\_CONNECTOR\_PATH . "includes/pages/gs-field-list.php" ); |
| [864](#L864) |  |
| [865](#L865) | include( GS\_CONNECTOR\_PATH . "includes/pages/gs-special-mailtags.php" ); |
| [866](#L866) |  |
| [867](#L867) | include( GS\_CONNECTOR\_PATH . "includes/pages/gs-custom-mail-tags.php" ); |
| [868](#L868) |  |
| [869](#L869) | include( GS\_CONNECTOR\_PATH . "includes/pages/gs-conditional-logic.php" ); |
| [870](#L870) |  |
| [871](#L871) | include( GS\_CONNECTOR\_PATH . "includes/pages/gs-custom-ordering.php"); |
| [872](#L872) |  |
| [873](#L873) | include( GS\_CONNECTOR\_PATH . "includes/pages/gs-miscellaneous-features.php" ); |
| [874](#L874) |  |
| [875](#L875) | //include( GS\_CONNECTOR\_PATH . "includes/pages/gs-demo-details.php" ); |
| [876](#L876) |  |
| [877](#L877) |  |
| [878](#L878) |  |
| [879](#L879) |  |
| [880](#L880) | } |
| [881](#L881) | ?> |
| [882](#L882) |  |
| [883](#L883) |  |
| [884](#L884) |  |
| [885](#L885) |  |
| [886](#L886) | <!-- Single sheet connection END --> |
| [887](#L887) |  |
| [888](#L888) | </div> |
| [889](#L889) | </div> <!-- #end #end --> |
| [890](#L890) |  |
| [891](#L891) | <!-- Multi sheet connection START--> |
| [892](#L892) | <div class="cf7-sub-tab-multi cf7-sub-tab" style="display:none"> |
| [893](#L893) | <div id="opener2"> |
| [894](#L894) | <?php |
| [895](#L895) |  |
| [896](#L896) | include( GS\_CONNECTOR\_PATH . "includes/pages/multisheet-sheets-connection.php" ); |
| [897](#L897) |  |
| [898](#L898) | ?> |
| [899](#L899) | </div> |
| [900](#L900) | </div> |
| [901](#L901) |  |
| [902](#L902) |  |
| [903](#L903) | <!-- Multi sheet connection END--> |
| [904](#L904) |  |
| [905](#L905) |  |
| [906](#L906) |  |
| [907](#L907) |  |
| [908](#L908) |  |
| [909](#L909) | <?php include( GS\_CONNECTOR\_PATH . "includes/pages/pro-popup.php" ) ;  ?> |
| [910](#L910) |  |
| [911](#L911) |  |
| [912](#L912) |  |
| [913](#L913) | <?php } |
| [914](#L914) |  |
| [915](#L915) | /\*\* |
| [916](#L916) | \* Function - fetch contact form list that is connected with google sheet |
| [917](#L917) | \* @since 2.1 |
| [918](#L918) | \*/ |
| [919](#L919) | public function get\_forms\_connected\_to\_sheet() { |
| [920](#L920) | global $wpdb; |
| [921](#L921) |  |
| [922](#L922) | $query = $wpdb->get\_results("SELECT ID, post\_title, meta\_value from ".$wpdb->prefix."posts as p JOIN ".$wpdb->prefix."postmeta as pm on p.ID = pm.post\_id where pm.meta\_key='gs\_settings' AND p.post\_type='wpcf7\_contact\_form' ORDER BY p.ID"); |
| [923](#L923) | return $query; |
| [924](#L924) | } |
| [925](#L925) |  |
| [926](#L926) | /\*\* |
| [927](#L927) | \* Function - display contact form fields to be mapped to google sheet |
| [928](#L928) | \* @param int $form\_id |
| [929](#L929) | \* @since 1.0 |
| [930](#L930) | \*/ |
| [931](#L931) | public function display\_form\_fields( $form\_id ) { ?> |
| [932](#L932) |  |
| [933](#L933) | <?php |
| [934](#L934) | // fetch saved fields |
| [935](#L935) | $saved\_mail\_tags = get\_post\_meta( $form\_id, 'gs\_map\_mail\_tags' ); |
| [936](#L936) |  |
| [937](#L937) | // fetch mail tags |
| [938](#L938) | $assoc\_arr = []; |
| [939](#L939) | $meta = get\_post\_meta( $form\_id, '\_form', true ); |
| [940](#L940) | $fields = $this->get\_contact\_form\_fields( $meta ); |
| [941](#L941) | if( $fields ) { |
| [942](#L942) | foreach ( $fields as $field ) { |
| [943](#L943) | $single = $this->get\_field\_assoc( $field ); |
| [944](#L944) | if ( $single ) { |
| [945](#L945) | $assoc\_arr[] = $single; |
| [946](#L946) | } |
| [947](#L947) | } |
| [948](#L948) | } |
| [949](#L949) |  |
| [950](#L950) | if( ! empty( $assoc\_arr ) ) { |
| [951](#L951) | ?> |
| [952](#L952) | <ul class="gs-field-list"> |
| [953](#L953) | <?php |
| [954](#L954) | $count = 0; |
| [955](#L955) | foreach ( $assoc\_arr as $key => $value ) { |
| [956](#L956) | foreach ( $value as $k => $v ) { |
| [957](#L957) | $saved\_val = ""; |
| [958](#L958) | $checked = ""; |
| [959](#L959) | if( ! empty( $saved\_mail\_tags ) && array\_key\_exists( $v, $saved\_mail\_tags[0] ) ) : |
| [960](#L960) | $saved\_val = $saved\_mail\_tags[0][$v]; |
| [961](#L961) | $checked = "checked"; |
| [962](#L962) | endif; |
| [963](#L963) |  |
| [964](#L964) | $placeholder = preg\_replace('/[\\\_]|\\s+/', '-', $v ); |
| [965](#L965) | ?> |
| [966](#L966) | <li> |
| [967](#L967) | <div class="input-field"> |
| [968](#L968) | <!-- <input type="checkbox" checked="checked" disabled="disabled" class="check-toggle-cf7" name="gs-custom-ck[<?php echo $count; ?>]" value="1" <?php echo $checked; ?> > --> |
| [969](#L969) | <label for="enable-sorting-option" class="button-woo-toggle-cf7" id="sorting-toggle"></label> |
| [970](#L970) | </div> |
| [971](#L971) | <div class="label"><?php echo $v; ?> : </div> |
| [972](#L972) | <div class="field-input"> |
| [973](#L973) | <input type="text" name="gs-custom-header[<?php echo $count; ?>]" value="<?php echo $saved\_val; ?>" placeholder="<?php echo $placeholder; ?>" disabled> |
| [974](#L974) | </div> |
| [975](#L975) | </li> |
| [976](#L976) | <?php |
| [977](#L977) | $count++; |
| [978](#L978) | } |
| [979](#L979) | } |
| [980](#L980) | ?> |
| [981](#L981) | </ul> |
| [982](#L982) | <?php |
| [983](#L983) | } else { |
| [984](#L984) | echo '<p><span class="gs-info">' . \_\_( 'No mail tags available.','gsconnector' ) . '</span></p>'; |
| [985](#L985) | } |
| [986](#L986) | } |
| [987](#L987) |  |
| [988](#L988) | public function get\_contact\_form\_fields( $meta ) { |
| [989](#L989) | $regexp = '/\[.\*\]/'; |
| [990](#L990) | $arr = []; |
| [991](#L991) | if ( preg\_match\_all($regexp, $meta, $arr) == false) { |
| [992](#L992) | return false; |
| [993](#L993) | } |
| [994](#L994) | return $arr[0]; |
| [995](#L995) | } |
| [996](#L996) |  |
| [997](#L997) | public function get\_field\_assoc($content) { |
| [998](#L998) | $regexp\_type = '/(?<=\[)[^\s\\*]\*/'; |
| [999](#L999) | $regexp\_name = '/(?<=\s)[^\s\]]\*/'; |
| [1000](#L1000) | $arr\_type = []; |
| [1001](#L1001) | $arr\_name = []; |
| [1002](#L1002) | if (preg\_match($regexp\_type, $content, $arr\_type) == false) { |
| [1003](#L1003) | return false; |
| [1004](#L1004) | } |
| [1005](#L1005) | if (!in\_array($arr\_type[0], $this->allowed\_tags)) { |
| [1006](#L1006) | return false; |
| [1007](#L1007) | } |
| [1008](#L1008) | if (preg\_match($regexp\_name, $content, $arr\_name) == false) { |
| [1009](#L1009) | return false; |
| [1010](#L1010) | } |
| [1011](#L1011) | return array($arr\_type[0] => $arr\_name[0]); |
| [1012](#L1012) | } |
| [1013](#L1013) |  |
| [1014](#L1014) | /\*\* |
| [1015](#L1015) | \* Function - display contact form special mail tags to be mapped to google sheet |
| [1016](#L1016) | \* @since 2.6 |
| [1017](#L1017) | \*/ |
| [1018](#L1018) | public function display\_form\_special\_tags( $form\_id ) { |
| [1019](#L1019) |  |
| [1020](#L1020) |  |
| [1021](#L1021) |  |
| [1022](#L1022) | $tags\_count = count( $this->special\_mail\_tags ); |
| [1023](#L1023) | $num\_of\_cols = 1; |
| [1024](#L1024) | ?> |
| [1025](#L1025) | <h2 class="inner-title"><span class="gs-info"><?php echo esc\_html( \_\_( 'Map special mail tags with custom header name and save automatically to google sheet. ', 'gsconnector' ) ); ?></span></h2> |
| [1026](#L1026) | <ul class="gs-field-list special"> |
| [1027](#L1027) | <?php |
| [1028](#L1028) |  |
| [1029](#L1029) | for ( $i = 0; $i <= $tags\_count; $i++ ) { |
| [1030](#L1030) | if ( $i == $tags\_count ) { |
| [1031](#L1031) | break; |
| [1032](#L1032) | } |
| [1033](#L1033) | $tag\_name = $this->special\_mail\_tags[ $i ]; |
| [1034](#L1034) |  |
| [1035](#L1035) | $placeholder = str\_replace( '\_', '-', $tag\_name ); |
| [1036](#L1036) | echo '<li>'; |
| [1037](#L1037) | echo '<div class="input-field"> |
| [1038](#L1038) | <!--<input type="checkbox" disabled="disabled" name="gs-st-ck['. $i . ']" value="1">--> |
| [1039](#L1039) | <label for="enable-sorting-option" class="button-woo-toggle-cf7" id="sorting-toggle"></label> |
| [1040](#L1040) | </div>'; |
| [1041](#L1041) | echo '<div class="special-tags label">[\_' . $tag\_name . '] </div>'; |
| [1042](#L1042) | echo '<div class="gs-r-pad field-input"><input type="text" class="name-field" name="gs-st-custom-header['. $i . ']" value="" disabled placeholder="'. $placeholder .'"> </div>'; |
| [1043](#L1043) | if ( $i % $num\_of\_cols == 1 ) { |
| [1044](#L1044) | echo '</li>'; |
| [1045](#L1045) | } |
| [1046](#L1046) | } |
| [1047](#L1047) | ?> |
| [1048](#L1048) | </ul> |
| [1049](#L1049) | <?php |
| [1050](#L1050) | } |
| [1051](#L1051) |  |
| [1052](#L1052) | function display\_form\_custom\_tag( $form\_id ){ |
| [1053](#L1053) | $custom\_mail\_tags = array(); |
| [1054](#L1054) | $num\_of\_cols = 2; |
| [1055](#L1055) |  |
| [1056](#L1056) | if ( has\_filter( "gscf7\_special\_mail\_tags" ) ) { |
| [1057](#L1057) | // Filter hook for custom mail tags |
| [1058](#L1058) | $custom\_tags = apply\_filters( "gscf7\_special\_mail\_tags", $custom\_mail\_tags, $form\_id ); |
| [1059](#L1059) | $custom\_tags\_count = count( $custom\_tags ); |
| [1060](#L1060) | $num\_of\_cols = 2; |
| [1061](#L1061) | // fetch saved fields |
| [1062](#L1062) | $saved\_cmail\_tags = get\_post\_meta( $form\_id, 'gs\_map\_custom\_mail\_tags' ); |
| [1063](#L1063) | ?> |
| [1064](#L1064) | <ul class="gs-field-list"> |
| [1065](#L1065) | <?php |
| [1066](#L1066) | echo '<li>'; |
| [1067](#L1067) | for ( $i = 0; $i <= $custom\_tags\_count; $i++ ) { |
| [1068](#L1068) | if ( $i == $custom\_tags\_count ) { |
| [1069](#L1069) | break; |
| [1070](#L1070) | } |
| [1071](#L1071) | $tag\_name = $custom\_tags[ $i ]; |
| [1072](#L1072) | $modify\_tag = ltrim( $tag\_name, '\_' ); |
| [1073](#L1073) | $saved\_val = ""; |
| [1074](#L1074) | $checked = ""; |
| [1075](#L1075) | if( ! empty( $saved\_cmail\_tags ) && array\_key\_exists( $modify\_tag, $saved\_cmail\_tags[0] ) ) : |
| [1076](#L1076) | $saved\_val = $saved\_cmail\_tags[0][$modify\_tag]; |
| [1077](#L1077) | $checked = "checked"; |
| [1078](#L1078) | endif; |
| [1079](#L1079) |  |
| [1080](#L1080) | //hack - todo |
| [1081](#L1081) | $placeholder\_explode = explode( '\_', $tag\_name, 2 ); |
| [1082](#L1082) | $placeholder = str\_replace( '\_', '-', $placeholder\_explode[1] ); |
| [1083](#L1083) |  |
| [1084](#L1084) | echo '<div class="input-field"> |
| [1085](#L1085) | <label for="enable-sorting-option" class="button-woo-toggle-cf7" id="sorting-toggle"></label> |
| [1086](#L1086) | </div>'; |
| [1087](#L1087) | echo '<div class="label">[' . $tag\_name . ']</div>'; |
| [1088](#L1088) | echo '<div class="gs-r-pad field-input"><input type="hidden" name="gs-ct-key['. $i . ']" value="' . $tag\_name . '" ><input type="hidden" name="gs-ct-placeholder['. $i . ']" value="' . $placeholder . '" > |
| [1089](#L1089) | <input type="text" name="gs-ct-custom-header['. $i . ']" value="' . $saved\_val . '" placeholder="'. $placeholder .'" disabled> |
| [1090](#L1090) |  |
| [1091](#L1091) | </div>'; |
| [1092](#L1092) | if ( $i % $num\_of\_cols == 1 ) { |
| [1093](#L1093) | echo '</li>'; |
| [1094](#L1094) | } |
| [1095](#L1095) | } |
| [1096](#L1096) | ?> |
| [1097](#L1097) | </ul> |
| [1098](#L1098) | <?php |
| [1099](#L1099) | } else { |
| [1100](#L1100) | echo '<p><span class="gs-info">' . \_\_( 'No custom mail tags available.','gsconnector' ) . '</span></p>'; |
| [1101](#L1101) | } |
| [1102](#L1102) | } |
| [1103](#L1103) |  |
| [1104](#L1104) | function display\_form\_conditional\_logic( $form\_id, $post ){ ?> |
| [1105](#L1105) | <div class="misc-conditional-row"> |
| [1106](#L1106) | <div class="misc-options-wrapper"> |
| [1107](#L1107) |  |
| [1108](#L1108) | <label for="enable-conditional-logic"> |
| [1109](#L1109) | <input type="checkbox" name="cf7-gs[enable\_conditional\_logic]" id="enable-conditional-logic" value="1" |
| [1110](#L1110) | style="display: none;"> |
| [1111](#L1111) | <label for="enable-conditional-logic" class="button-woo-toggle-cf7" id="conditional-toggle"></label> |
| [1112](#L1112) | <?php echo \_\_('Conditional Logic', 'gsconnector'); ?> |
| [1113](#L1113) | </label> |
| [1114](#L1114) |  |
| [1115](#L1115) | <span class="tooltip" style="display: inline !important;"> |
| [1116](#L1116) | <img src="<?php echo GS\_CONNECTOR\_URL; ?>assets/img/help.png" class="help-icon"> |
| [1117](#L1117) | <span |
| [1118](#L1118) | class="tooltiptext tooltip-right-msg"><?php echo \_\_("The Enable Conditional Logic option in the field settings allows you to create rules to dynamically display or hide the submission to google sheet based on values.", "gsconnector"); ?> |
| [1119](#L1119) |  |
| [1120](#L1120) | </span> |
| [1121](#L1121) | </span> |
| [1122](#L1122) | </div> |
| [1123](#L1123) | <?php |
| [1124](#L1124) |  |
| [1125](#L1125) |  |
| [1126](#L1126) | } |
| [1127](#L1127) |  |
| [1128](#L1128) | public function display\_upgrade\_notice() { |
| [1129](#L1129) | $get\_notification\_display\_interval = get\_option( 'gs\_upgrade\_notice\_interval' ); |
| [1130](#L1130) | $close\_notification\_interval = get\_option( 'gs\_close\_upgrade\_notice' ); |
| [1131](#L1131) |  |
| [1132](#L1132) | if( $close\_notification\_interval === "off" ) { |
| [1133](#L1133) | return; |
| [1134](#L1134) | } |
| [1135](#L1135) |  |
| [1136](#L1136) | if ( ! empty( $get\_notification\_display\_interval ) ) { |
| [1137](#L1137) | $adds\_interval\_date\_object = DateTime::createFromFormat( "Y-m-d", $get\_notification\_display\_interval ); |
| [1138](#L1138) | $notice\_interval\_timestamp = $adds\_interval\_date\_object->getTimestamp(); |
| [1139](#L1139) | } |
| [1140](#L1140) |  |
| [1141](#L1141) | if ( empty( $get\_notification\_display\_interval ) || current\_time( 'timestamp' ) > $notice\_interval\_timestamp ) { |
| [1142](#L1142) | $ajax\_nonce   = wp\_create\_nonce( "gs\_upgrade\_ajax\_nonce" ); |
| [1143](#L1143) | $upgrade\_text = '<div class="gs-adds-notice">'; |
| [1144](#L1144) | $upgrade\_text .= '<span><b>CF7 Google Sheet Connector </b> '; |
| [1145](#L1145) | $upgrade\_text .= 'version 4.0 would required you to <a href="'.  admin\_url("admin.php?page=wpcf7-google-sheet-config") . '">reauthenticate</a> with your Google Account again due to update of Google API V3 to V4.<br/><br/>'; |
| [1146](#L1146) | $upgrade\_text .= 'To avoid any loss of data redo the Google Sheet settings of each Contact Forms again with required sheet and tab details.</span>'; |
| [1147](#L1147) | $upgrade\_text .= '<ul class="review-rating-list">'; |
| [1148](#L1148) | $upgrade\_text .= '<li><a href="javascript:void(0);" class="cf7gsc\_upgrade" title="Done">Yes, I have done.</a></li>'; |
| [1149](#L1149) | $upgrade\_text .= '<li><a href="javascript:void(0);" class="cf7gsc\_upgrade\_later" title="Remind me later">Remind me later.</a></li>'; |
| [1150](#L1150) | $upgrade\_text .= '</ul>'; |
| [1151](#L1151) | $upgrade\_text .= '<input type="hidden" name="gs\_upgrade\_ajax\_nonce" id="gs\_upgrade\_ajax\_nonce" value="' . $ajax\_nonce . '" />'; |
| [1152](#L1152) | $upgrade\_text .= '</div>'; |
| [1153](#L1153) |  |
| [1154](#L1154) | $upgrade\_block = Gs\_Connector\_Utility::instance()->admin\_notice( array( |
| [1155](#L1155) | 'type'    => 'upgrade', |
| [1156](#L1156) | 'message' => $upgrade\_text |
| [1157](#L1157) | ) ); |
| [1158](#L1158) | echo $upgrade\_block; |
| [1159](#L1159) | } |
| [1160](#L1160) | } |
| [1161](#L1161) |  |
| [1162](#L1162) | public function set\_upgrade\_notification\_interval() { |
| [1163](#L1163) | // check nonce |
| [1164](#L1164) | check\_ajax\_referer( 'gs\_upgrade\_ajax\_nonce', 'security' ); |
| [1165](#L1165) | $time\_interval = date( 'Y-m-d', strtotime( '+10 day' ) ); |
| [1166](#L1166) | update\_option( 'gs\_upgrade\_notice\_interval', $time\_interval ); |
| [1167](#L1167) | wp\_send\_json\_success(); |
| [1168](#L1168) | } |
| [1169](#L1169) |  |
| [1170](#L1170) | public function close\_upgrade\_notification\_interval() { |
| [1171](#L1171) | // check nonce |
| [1172](#L1172) | check\_ajax\_referer( 'gs\_upgrade\_ajax\_nonce', 'security' ); |
| [1173](#L1173) | update\_option( 'gs\_close\_upgrade\_notice', 'off' ); |
| [1174](#L1174) | wp\_send\_json\_success(); |
| [1175](#L1175) | } |
| [1176](#L1176) |  |
| [1177](#L1177) | } |
| [1178](#L1178) |  |
| [1179](#L1179) | $gs\_connector\_service = new Gs\_Connector\_Service(); |
| [1180](#L1180) |  |
| [1181](#L1181) |  |
| [1182](#L1182) |  |
| [1183](#L1183) |  |
| [1184](#L1184) |  |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php?format=txt)
* [Original Format](/export/3220763/cf7-google-sheets-connector/trunk/includes/class-gs-service.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_e417e54c_20250111_152155.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# CF7 Google Sheets Connector <= 5.0.9 - Missing Authorization to Limited Site Configuration Update

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   CF7 Google Sheets Connector <= 5.0.9 - Missing Authorization to Limited Site Configuration Update

6.5

**Missing Authorization**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N)

| CVE | [CVE-2024-5654](https://www.cve.org/CVERecord?id=CVE-2024-5654) |
| --- | --- |
| CVSS | 6.5 (Medium) |
| Publicly Published | June 7, 2024 |
| Last Updated | June 8, 2024 |
| Researcher | [1337\_Wannabe - home](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/amrawad) |

### Description

The CF7 Google Sheets Connector plugin for WordPress is vulnerable to unauthorized modification of data due to a missing capability check on the 'execute\_post\_data\_cg7\_free' function in all versions up to, and including, 5.0.9. This makes it possible for unauthenticated attackers to toggle site configuration settings, including WP\_DEBUG, WP\_DEBUG\_LOG, SCRIPT\_DEBUG, and SAVEQUERIES.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/cf7-google-sheets-connector/trunk/includes/class-gs-service.php#L52)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3099184/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcf7-google-sheets-connector%2Fcf7-google-sheets-connector-509-missing-authorization-to-limited-site-configuration-update&t=CF7%20Google%20Sheets%20Connector%20%3C%3D%205.0.9%20-%20Missing%20Authorization%20to%20Limited%20Site%20Configuration%20Update "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcf7-google-sheets-connector%2Fcf7-google-sheets-connector-509-missing-authorization-to-limited-site-configuration-update&text=CF7%20Google%20Sheets%20Connector%20%3C%3D%205.0.9%20-%20Missing%20Authorization%20to%20Limited%20Site%20Configuration%20Update "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcf7-google-sheets-connector%2Fcf7-google-sheets-connector-509-missing-authorization-to-limited-site-configuration-update "LinkedIn")
Email

## Vulnerability Details for CF7 Google Sheets Connector

#### [CF7 Google Sheets Connector](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/cf7-google-sheets-connector)

| Software Type | Plugin |
| --- | --- |
| Software Slug | cf7-google-sheets-connector [(view on wordpress.org)](https://wordpress.org/plugins/cf7-google-sheets-connector) |
| Patched? | Yes |
| Remediation | Update to version 5.0.10, or a newer patched version |
| Affected Version | * <= 5.0.9 |
| Patched Version | * 5.0.10 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


