Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from a lack of proper sanitization of SQL parameters within the `ajax.php` script of the "Custom links" module (`pk_customlinks`) for PrestaShop. This allows for the injection of malicious SQL code.

**Weaknesses/Vulnerabilities:**

*   **SQL Injection (CWE-89):** The primary weakness is the presence of an exploitable SQL injection vulnerability due to insufficient input validation in the `ajax.php` script.

**Impact of Exploitation:**

*   **Admin Access:** Attackers can potentially gain administrative access to the PrestaShop instance.
*   **Data Manipulation:**  Attackers could remove data from the PrestaShop database, potentially causing significant disruption.
*   **Data Exfiltration:** Sensitive data could be copied to the front-end, exposing tokens and facilitating further attacks, including the potential to unlock admin's ajax scripts
*   **Email Hijacking:** Attackers may be able to modify SMTP settings, allowing them to intercept and control email communications.

**Attack Vectors:**

*   **Network:** The vulnerability is exploitable over the network.
*   **HTTP Requests:** A simple HTTP call is sufficient to trigger the vulnerable SQL code execution.

**Required Attacker Capabilities/Position:**

*   **No Privilege Required:** The attacker does not need any pre-existing privileges or user accounts.
*   **No User Interaction:** The attack can be carried out without any user interaction.

**Additional Notes:**

*   The vendor refused to provide the latest module version for vulnerability assessment; thus, all module versions are potentially affected.
*   While PrestaShop upgrades may offer some level of protection (e.g., disabling multiquery executions) they **do not fully mitigate** the risk from SQL injection attacks that use the UNION clause.
*   The use of `pSQL` and its included `strip_tags` function is mentioned in relation to Stored XSS vulnerabilities, and highlights that a missing `pSQL` function could expose the project to critical Stored XSS vulnerabilities, but that is not directly related to CVE-2024-36684.