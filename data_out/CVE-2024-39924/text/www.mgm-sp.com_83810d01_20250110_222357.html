
[0](/cart)

[Zum Inhalt springen](#page)

[![mgm-sp](//images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/53fbdf44-0f55-49c0-a164-e15ed43452dd/mgm-sp_logo.png?format=1500w)](/)

[mgm security partners](/home)

[mgm security partners](/main-menu)

[Application Security](/application-security-menu)
[Application Security](/application-security)

[Agile Security & Secure DevOps](/application-security/agile-security-secure-devops)

[Security Architekturworkshops](/application-security/security-architekturworkshops)

[Automatisiertes Testen von Anwendungssicherheit](/application-security/automatisiertes-testen-von-anwendungssicherheit)

[Secure Coding Guidelines](/application-security/secure-coding-guidelines)

[Threat Modelling](/application-security/threat-modelling)

[Lean Application Security](/application-security/lean-application-security)

[LLM Security](/security-testing/llm-security)

[Security Testing](/security-testing-menu)
[Security Testing](/security-testing)

[Red Teaming Assessment](/red-teaming-assessment)

[Niederschwellig zur Unternehmenssicherheit](/niederschwellig-zur-unternehmenssicherheit)

[Penetrationstests](/security-testing/penetrationstests)

[OWASP ASVS Assessment](/security-testing/owasp-asvs-assessment)

[Statische Codeanalyse](/security-testing/statische-codeanalyse)

[Fat Client Security Testing](/security-testing/fat-client-security-testing)

[Mobile App Security](/security-testing/mobile-app-security)

[Internet of Things Assessment](/security-testing/internet-of-things-assessment)

[Open Source Intelligence](/security-testing/open-source-intelligence)

[Automatisiertes Testen von Anwendungssicherheit](/security-testing/automatisiertes-testen-von-anwendungssicherheit)

[Infrastruktur-Penetrationstest](/security-testing/infrastruktur-penetrationstest)

[Host Audit / Server Hardening](/security-testing/host-audit-server-hardening)

[Docker Security](/security-testing/docker-security)

[Cloud Security Testing](/security-testing/cloud-security-testing)

[LLM Security Testing](/security-testing/llm-security)

[DORA Penetration Test](/dora-pentest)

[Information Security](/information-security)

[Schulungen](/schulungen-menu)
[Schulungen](/schulungen)

[Best Practices für sichere Webanwendungen](/schulungen/best-practices-fur-sichere-webanwendungen)

[OWASP Top 10 - Application Security Quickstart](/schulungen/owasp-top-10-application-security-quickstart)

[Secure Coding für Java](/schulungen/secure-coding-fuer-java)

[DevSecOps: Sicherheit in der CI/CD Pipeline](/schulungen/devsecops-sicherheit-in-der-ci-cd-pipeline)

[Best-Practices der Cloud Security](/schulungen/best-practices-der-cloud-security)

[Grundlagenschulung "Durchführung von Penetrationstests"](/schulungen/grundlagenschulung-durchfuehrung-von-penetrationstests)

[Advanced Application Security Penetration Testing](/schulungen/advanced-application-security-penetration-testing)

[Unsere Trainer](/schulungen/unsere-trainer)

[Online-Schulungen](/schulungen/online-schulungen)

[Schulungsumgebung NinjaDVA](/schulungen/ninjadva)

[Blog & News](/blog-and-news)

[Karriere](/karriere)

Deutsch

Menü öffnen
Menü schließen

[![mgm-sp](//images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/53fbdf44-0f55-49c0-a164-e15ed43452dd/mgm-sp_logo.png?format=1500w)](/)

[mgm security partners](/home)

[mgm security partners](/main-menu)

[Application Security](/application-security-menu)
[Application Security](/application-security)

[Agile Security & Secure DevOps](/application-security/agile-security-secure-devops)

[Security Architekturworkshops](/application-security/security-architekturworkshops)

[Automatisiertes Testen von Anwendungssicherheit](/application-security/automatisiertes-testen-von-anwendungssicherheit)

[Secure Coding Guidelines](/application-security/secure-coding-guidelines)

[Threat Modelling](/application-security/threat-modelling)

[Lean Application Security](/application-security/lean-application-security)

[LLM Security](/security-testing/llm-security)

[Security Testing](/security-testing-menu)
[Security Testing](/security-testing)

[Red Teaming Assessment](/red-teaming-assessment)

[Niederschwellig zur Unternehmenssicherheit](/niederschwellig-zur-unternehmenssicherheit)

[Penetrationstests](/security-testing/penetrationstests)

[OWASP ASVS Assessment](/security-testing/owasp-asvs-assessment)

[Statische Codeanalyse](/security-testing/statische-codeanalyse)

[Fat Client Security Testing](/security-testing/fat-client-security-testing)

[Mobile App Security](/security-testing/mobile-app-security)

[Internet of Things Assessment](/security-testing/internet-of-things-assessment)

[Open Source Intelligence](/security-testing/open-source-intelligence)

[Automatisiertes Testen von Anwendungssicherheit](/security-testing/automatisiertes-testen-von-anwendungssicherheit)

[Infrastruktur-Penetrationstest](/security-testing/infrastruktur-penetrationstest)

[Host Audit / Server Hardening](/security-testing/host-audit-server-hardening)

[Docker Security](/security-testing/docker-security)

[Cloud Security Testing](/security-testing/cloud-security-testing)

[LLM Security Testing](/security-testing/llm-security)

[DORA Penetration Test](/dora-pentest)

[Information Security](/information-security)

[Schulungen](/schulungen-menu)
[Schulungen](/schulungen)

[Best Practices für sichere Webanwendungen](/schulungen/best-practices-fur-sichere-webanwendungen)

[OWASP Top 10 - Application Security Quickstart](/schulungen/owasp-top-10-application-security-quickstart)

[Secure Coding für Java](/schulungen/secure-coding-fuer-java)

[DevSecOps: Sicherheit in der CI/CD Pipeline](/schulungen/devsecops-sicherheit-in-der-ci-cd-pipeline)

[Best-Practices der Cloud Security](/schulungen/best-practices-der-cloud-security)

[Grundlagenschulung "Durchführung von Penetrationstests"](/schulungen/grundlagenschulung-durchfuehrung-von-penetrationstests)

[Advanced Application Security Penetration Testing](/schulungen/advanced-application-security-penetration-testing)

[Unsere Trainer](/schulungen/unsere-trainer)

[Online-Schulungen](/schulungen/online-schulungen)

[Schulungsumgebung NinjaDVA](/schulungen/ninjadva)

[Blog & News](/blog-and-news)

[Karriere](/karriere)

Deutsch

Menü öffnen
Menü schließen

[mgm security partners](/home)

[Ordner:
mgm security partners](/main-menu)

[Zurück](/)

[Ordner:
Application Security](/application-security-menu)

[Zurück](/)

[Application Security](/application-security)

[Agile Security & Secure DevOps](/application-security/agile-security-secure-devops)

[Security Architekturworkshops](/application-security/security-architekturworkshops)

[Automatisiertes Testen von Anwendungssicherheit](/application-security/automatisiertes-testen-von-anwendungssicherheit)

[Secure Coding Guidelines](/application-security/secure-coding-guidelines)

[Threat Modelling](/application-security/threat-modelling)

[Lean Application Security](/application-security/lean-application-security)

[LLM Security](/security-testing/llm-security)

[Ordner:
Security Testing](/security-testing-menu)

[Zurück](/)

[Security Testing](/security-testing)

[Red Teaming Assessment](/red-teaming-assessment)

[Niederschwellig zur Unternehmenssicherheit](/niederschwellig-zur-unternehmenssicherheit)

[Penetrationstests](/security-testing/penetrationstests)

[OWASP ASVS Assessment](/security-testing/owasp-asvs-assessment)

[Statische Codeanalyse](/security-testing/statische-codeanalyse)

[Fat Client Security Testing](/security-testing/fat-client-security-testing)

[Mobile App Security](/security-testing/mobile-app-security)

[Internet of Things Assessment](/security-testing/internet-of-things-assessment)

[Open Source Intelligence](/security-testing/open-source-intelligence)

[Automatisiertes Testen von Anwendungssicherheit](/security-testing/automatisiertes-testen-von-anwendungssicherheit)

[Infrastruktur-Penetrationstest](/security-testing/infrastruktur-penetrationstest)

[Host Audit / Server Hardening](/security-testing/host-audit-server-hardening)

[Docker Security](/security-testing/docker-security)

[Cloud Security Testing](/security-testing/cloud-security-testing)

[LLM Security Testing](/security-testing/llm-security)

[DORA Penetration Test](/dora-pentest)

[Information Security](/information-security)

[Ordner:
Schulungen](/schulungen-menu)

[Zurück](/)

[Schulungen](/schulungen)

[Best Practices für sichere Webanwendungen](/schulungen/best-practices-fur-sichere-webanwendungen)

[OWASP Top 10 - Application Security Quickstart](/schulungen/owasp-top-10-application-security-quickstart)

[Secure Coding für Java](/schulungen/secure-coding-fuer-java)

[DevSecOps: Sicherheit in der CI/CD Pipeline](/schulungen/devsecops-sicherheit-in-der-ci-cd-pipeline)

[Best-Practices der Cloud Security](/schulungen/best-practices-der-cloud-security)

[Grundlagenschulung "Durchführung von Penetrationstests"](/schulungen/grundlagenschulung-durchfuehrung-von-penetrationstests)

[Advanced Application Security Penetration Testing](/schulungen/advanced-application-security-penetration-testing)

[Unsere Trainer](/schulungen/unsere-trainer)

[Online-Schulungen](/schulungen/online-schulungen)

[Schulungsumgebung NinjaDVA](/schulungen/ninjadva)

[Blog & News](/blog-and-news)

[Karriere](/karriere)

Deutsch
[Zurück](/)

![](https://images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/a481fe27-3aee-4756-b6bb-8bd8f9bb7232/background-security-assurance-2500x476.jpg)

# Missing authentication check for emergency access

**A missing authentication check, allowing to alter metadata of an emergency access, was found in *Vaultwarden* version 1.30.3 (or earlier). We have reported this vulnerability to the developer, who addressed the issue and fixed the vulnerability in version 1.32.0.**

**Once emergency access is initiated, the *grantee* could modify the access terms, including access level and wait time. This allows the *grantee* to access *grantor*'s data with a higher access level (full account takeover instead of just view access) and without having to wait for the defined wait time to expire (by default 7 days). This renders the limitation of access defined by the *grantor* to be ineffective. This access control vulnerability only affects the API endpoint for modifying emergency access. At the endpoint for creating emergency access, *Vaultwarden* correctly checks user permissions. The exploitability of this finding is therefore limited to the designated *grantee* gaining higher privilege to access *grantor*'s data. No vulnerabilities that allow unauthorized creating of emergency access for a targeted user were found.**

### **Description**

Emergency access is a feature of *Vaultwarden* that allows a user (*access grantor*) to designate a trusted contact (*grantee*), who can request access to their vault data in case of an emergency.

When setting up an emergency access, the *grantor* can define some terms of the granted access, including:

* Access level: dictates whether the *grantee* only has view access to the *grantor* data or grantee should be allowed to take over the *grantor* account
* Wait time: dictates how long the *grantee* must wait to access *grantor*'s data after initiating emergency access. This wait time gives the *grantor* a time window, during which the *grantor* could revoke the emergency access.

More information about *Vaultwarden* emergency access can be found in the upstream [Bitwarden server emergency access page](https://bitwarden.com/help/emergency-access/).

Once emergency access is initiated, its metadata can be changed via the API endpoint `PUT /api/emergency-access/<access_UUID>`. This allows the *grantor* to change their created emergency access conditions, including access level and wait time.

It was found that Vaultwarden does not enforce any access control at this API endpoint. Our tests showed that even an unauthenticated user could still modify emergency access with arbitrary data if the access UUID is known. The following screenshot depicts the issue.

To modify an emergency access, the valid access UUID has to be specified as a request parameter. *Vaultwarden* uses UUID version 4 for entity IDs, which are difficult to enumerate. Nevertheless, the grantee could find this information in the notification mail:

![](https://images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/df85b32f-6526-440f-9986-75a8823f0e1e/2024-06-10_02-58.frame.png)

The affected source code can be found here

<https://github.com/dani-garcia/vaultwarden/blob/1.30.3/src/api/core/emergency_access.rs#L115-L148>

![](https://images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/b63868c0-424e-4e2c-b6d4-f8dd51a6d9cb/2024-06-10_02-58_1.frame.png)

#### Assigned CVE

<https://nvd.nist.gov/vuln/detail/CVE-2024-39924>

#### Affected Component

<https://github.com/dani-garcia/vaultwarden/>

#### Attack Type

Remote

#### **Attack vectors**

To exploit the vulnerability, a malicious user needs be granted “low level” emergency access to another user's vault.

#### **Reference**

<https://github.com/dani-garcia/vaultwarden/pull/4715>

<https://github.com/dani-garcia/vaultwarden/releases/tag/1.32.0>

#### **Discoverer**

Mirko Richter (mgm security partners), Tuyen Thuc Nguyen (mgm securitry partners)

#### mgm security partners

**Unternehmen für die Sicherheit von Webanwendungen:** Experten für Sicherheit aus der Perspektive der Softwareentwicklung, einschließlich Quellcodeanalyse und Penetrationstests.

[Unternehmensinfo](/ueber-uns)[Stellenangebote](/karriere)

#### Alle Unternehmen der mgm Gruppe:

#### mgm technology partners

**Internationales Softwareunternehmen mit integriertem Dienstleistungsportfolio:**  A12 Enterprise Low Code platform, Model-driven software engineering, Enterprise project implementation

[Unternehmensinfo](https://www.mgm-tp.com/)[Stellenangebote](https://career.mgm-tp.com/de/p/mgm_security_partners/jobs)

#### mgm consulting partners

**Unternehmensberatung für
die Digitalisierung:** Experten für CIO-Beratung, Organisationsentwicklung und Change Management.

[Unternehmensinfo](https://www.mgm-cp.com/)[Stellenangebote](https://jobs.mgm-cp.com/de/home/)

#### mgm integration partners

**SAP Entwicklungs- und Beratungsunternehmen:** Experten für S4/HANA,
SAP ERP und Prozessoptimierung.

[Unternehmensinfo](https://www.mgm-ip.de/)[Stellenangebote](https://jobs.mgm-ip.de/)

#### QFS Quality First Software

**Tools für Software-Qualitätssicherung:** GUI Test Sofware QF-Test für Java, Web, Windows, Android, PDF.

[Unternehmensinfo](https://www.qftest.com/)[Stellenangebote](https://www.qftest.com/unternehmen/jobs.html)

[Impressum](/impressum) [Datenschutzerklärung](https://www.mgm-tp.com/privacy-policy.html) [AGB](https://www.mgm-tp.com/agb.html)

#### Application Security

Die umfassende Sicherstellung der Widerstandsfähigkeit Ihrer Anwendungen gegenüber Angriffen und Missbrauch.

 [ZUR ÜBERSICHT](/application-security)

[Agile Security & Secure DevOps](/application-security/agile-security-secure-devops)

[Security Architekturworkshops](/application-security/security-architekturworkshops)

[Automatisiertes Testen von Anwendungssicherhei](/application-security/automatisiertes-testen-von-anwendungssicherheit)t

[Secure Coding Guidelines / Security Libraries](/application-security/secure-coding-guidelines)

[Threat Modelling](/application-security/threat-modelling)

[Lean Application Security](/application-security/lean-application-security)

[LLM Security](/security-testing/llm-security)

![](https://images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/d3a78b96-e3e8-4aab-bc0f-9235608ebb6c/mgm-sp_Atlas.jpg)

**mgm ATLAS**

[Die effiziente Integration von automatisierten Tests in Entwicklungsprozesse](/mgm-atlas)

![](https://images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/cff79897-77da-4126-9b66-05807a78a887/mgm-sp_Application-Security_lean.png)

**Lean Application Security**

[Unser Vorgehensmodell zu einem sicheren Software Development Lifecycle](/application-security/lean-application-security)

[Impressum](/impressum) [Datenschutzerklärung](https://www.mgm-tp.com/privacy-policy.html) [AGB](https://www.mgm-tp.com/agb.html)

#### Security Assurance Testing

Sicherheitsanalysen, Penetrationstests & Mehr

 [ZUR ÜBERSICHT](/security-testing)

#### Application Security

[Penetrationstests](/security-testing/penetrationstests)

[OWASP ASVS Assessment](/security-testing/owasp-asvs-assessment)

[Statische Codeanalyse](/security-testing/statische-codeanalyse)

[Fat Client Security Testing](/security-testing/fat-client-security-testing)

[Mobile App Security Testing](/security-testing/mobile-app-security)

[Internet of Things Assessment](/security-testing/internet-of-things-assessment)

[Open Source Intelligence](/security-testing/open-source-intelligence)

[Security Testplattform mgm ATLAS](/security-testing/automatisiertes-testen-von-anwendungssicherheit)

#### Cyber Security

[Cybersecurity: Unser leichtgewichtiger Ansatz](https://www.mgm-sp.com/niederschwellig-zur-unternehmenssicherheit)

[Red Teaming Assessment](https://www.mgm-sp.com/red-teaming-assessment)

[Infrastruktur-Penetrationstest](/security-testing/infrastruktur-penetrationstest)

[Host Audit / Server Hardening](/security-testing/host-audit-server-hardening)

[Docker Security](/security-testing/docker-security)

#### Fokusthema

[DORA - IT-Sicherheitstests für digitale Resilienz](/dora-pentest)

#### Cloud & LLM

[Cloud Security Testing](/security-testing/cloud-security-testing)

[LLM Security Testing](/security-testing/llm-security-sicherheitsanalysen-und-penetrationstests)

![](https://images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/afde9417-3486-4ba7-bf27-3a302349eecb/Die+gro%C3%9Fe-Application-Security-Penetration-Test-FAQ-fu%CC%88r-Auftraggeber_PDF.png)

**FAQ:**
[Die große Application Security Penetration Test FAQ für Auftraggeber](/penetration-test-faq)

[Impressum](/impressum) [Datenschutzerklärung](https://www.mgm-tp.com/privacy-policy.html) [AGB](https://www.mgm-tp.com/agb.html)

#### Schulungen: Application Security

[Best Practices für sichere Webanwendungen](/schulungen/best-practices-fur-sichere-webanwendungen)

[OWASP Top 10 Quickstart](/schulungen/owasp-top-10-application-security-quickstart)

[Secure Coding für Java](/schulungen/secure-coding-fuer-java)

[Secure Coding mobiler Apps](/schulungen/secure-coding-fuer-mobile-apps)

[DevSecOps: Sicherheit in der CI/CD Pipeline](/schulungen/devsecops-sicherheit-in-der-ci-cd-pipeline)

[Best-Practices der Cloud Security](/schulungen/best-practices-der-cloud-security)

[Alle Schulungen](/schulungen)

#### Schulungen: Penetration Testing

[Grundlagenschulung "Durchführung von Penetrationstests"](/schulungen/grundlagenschulung-durchfuehrung-von-penetrationstests)

[Advanced Application Security Penetration Testing für Experten](/schulungen/best-practices-fur-sichere-webanwendungen)

#### LLM Security

[LLM-Security Best-Practices](/schulungen/llm-security-best-practices)

#### Personalisierte Trainings

Wir bieten darüber hinaus [Spezialthemen](/schulungen#spezial) an. Nennen Sie uns Ihre spezifischen Anforderungen, z.B.:
Threat Modeling Basics oder individuelle, projekt- und technologiestackbezogene Security Workshops.

[Schulungsumgebung NinjaDVA](/schulungen/ninjadva)

[Interaktive Online-Schulungen](/schulungen/online-schulungen)

![](https://images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/3f3ad305-4f3b-4680-acf5-9d01ceeccf4b/s50_0010_safe.png)

**Für Einsteiger:**
[Best-Practices für sichere Webanwendungen.](/schulungen/best-practices-fur-sichere-webanwendungen)

[Impressum](/impressum) [Datenschutzerklärung](https://www.mgm-tp.com/privacy-policy.html) [AGB](https://www.mgm-tp.com/agb.html)

[mgm insights](https://insights.mgm-tp.com/de/)

mgm Podcast:

[LinkedIn](https://de.linkedin.com/company/mgm-sp)
[Xing](https://www.xing.com/pages/mgmsecuritypartnersgmbh)
[kununu](https://www.kununu.com/de/mgm-security-partners1)
[YouTube](https://www.youtube.com/%40mgmsecuritypartners)

[Apple Podcasts](https://podcasts.apple.com/de/podcast/working-in-it-by-mgm/id1670920296)
[Spotify](https://open.spotify.com/show/4lWYAqZZfLaUNF00TNRJkr?si=143b73d11691444e)

**Die Unternehmen der mgm Gruppe:** [mgm technology partners](https://www.mgm-tp.com) | [mgm consulting partners](https://www.mgm-cp.com/) | [mgm integration partners](https://www.mgm-ip.de/) | [Quality First Software](https://www.qfs.de/index.html) | [mgm security partners](https://www.mgm-sp.com/)

[![](https://images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/f87698fa-2224-408a-9653-7a5015f96e28/mgm-sp_logo-white.png)](/home)

**mgm security partners**

Taunusstraße 23
80807 München

Phone +49 89-358 680-880
E-Mail hello@mgm-sp.com

[Kontaktformular](/kontakt)

![](https://images.squarespace-cdn.com/content/v1/661e1a7d6410e21852cb939c/a22b6b22-be87-41fd-8b3e-63b95156dbe2/mgm-sp_color-line.png)

**Wir machen Software sicher.**

[Imprint](/impressum) | [Privacy Policy](/datenschutzerklarung) | [Certifications](/ueber-uns) | [Compliance](https://www.mgm-tp.com/compliance.html)

© 2024 mgm security partners gmbh

