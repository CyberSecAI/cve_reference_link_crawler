=== Content from medium.com_c148eb6f_20250108_135557.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa2c4a3f9149d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40tomerp_77017%2Fexploiting-iotransfer-insecure-api-cve-2022-24562-a2c4a3f9149d&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40tomerp_77017%2Fexploiting-iotransfer-insecure-api-cve-2022-24562-a2c4a3f9149d&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Exploiting IOTransfer insecure API CVE-2022–24562

[![Tomer Peled](https://miro.medium.com/v2/resize:fill:88:88/1*GOFjb5W_nuSIIiZ_R5715w.jpeg)](/%40tomerp_77017?source=post_page---byline--a2c4a3f9149d--------------------------------)

[Tomer Peled](/%40tomerp_77017?source=post_page---byline--a2c4a3f9149d--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd42e0b5b0cd8&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40tomerp_77017%2Fexploiting-iotransfer-insecure-api-cve-2022-24562-a2c4a3f9149d&user=Tomer+Peled&userId=d42e0b5b0cd8&source=post_page-d42e0b5b0cd8--byline--a2c4a3f9149d---------------------post_header-----------)

4 min read·Jun 15, 2022

--

Listen

Share

# **Background**

Continuing the series about IPC vulnerabilities today we will look at another Chinese company, IObit.

IOTransfer by IObit is a program that allows the user to transfer files between their iPhone and their PC supposedly competing with apple’s iTunes. In order to operate IObit uses a node JS server for communication. The API is not obfuscated and does not contain any access control checks or any security measures at all. Understanding this communication can lead to arbitrary reading and writing to any location on the computer which can naturally lead to RCE with a bit of creativity.

# **Finding the first lead**

Starting with process hacker I found that “IOtransfer” is deploying a process that listens actively over TCP. By its logo it seemed like a node.js application

![]()

AirServ listening

Going over the details available in process hacker I found that the process is running with elevated privileges

![]()

AirServ Privileges

The process was executed with a command-line ending in “iot\_filetransfer.js” and the file details revealed it’s indeed a node.js server.

![]()

AirServ command line

Looking at the structure of the folder containing AirServ.exe we can see that the API is comprised from 5 files

![]()

folder structure

After opening “iot\_filetransfer.js” I could clearly see that:

1) The file was the “main” of the API implementation

2) There is no obfuscation of the code

3) There seems to be two different types of listeners one for GET methods and one for POST methods

![]()![]()

GET API Handler init

![]()

POST API Handler init

After making sure there is an ‘action’ parameter defined in the request the server will send the request to a dispatch function. This function is a parser for the actual requested method

Among those methods two are particularly interesting: “DOWNLOAD\_FILE”, “UPLOAD\_FILE”

![]()
# **Code Review**

AirServ is using a system of tasks to execute its actions it was probably implemented this way so the server will be able to keep track of what was downloaded/uploaded and to perform actions concurrently

In order to upload/download a file, the user must specify a taskID while the userID can be anything…

![]()

In order to get a taskid the user first needs to create a new task

The task should contain the following fields:

![]()

After sending these fields with the correct request the JS server will conveniently send a new taskID as a response:

![]()

After creating the task we need to set the details for it in a follow-up request

![]()

Size -the size of the file we want to upload

Savedfilepath -The path we want to upload a file to

Fullpath -not used so it can be any string

MD5 -not checked so it can be any string

Filetype -set to 3 in order to allow path traversal

The last request is for the function “newuploadtask” with the local file we want to upload as the data.

This request will trigger the execution of the task we created coupled with the data we sent to create a file in our desired folder.

This is the complete flow I used to create a payload in the target machine:

![]()

A very similar procedure can be used to download files from any location in the target machine to a remote computer

# **Conclusion**

IOTransfer’s AirServ lacks any kind of security measures. Even basic security measures such as obfuscation are not present. The fact that the service is running with ADMIN privileges is a major security hole. Blue Team personal should be aware of this and block IOTransfer communication port (7193) when not in use.

Github POC: <https://github.com/tomerpeled92/CVE/blob/main/CVE-2022%E2%80%9324562>

# **Disclosure timeline**

24/01/2022 - disclosed vulnerabilities to Iobit

29/01/2022 - Iobit emailed us saying they will analyze the information

05/02/2022 -RCE disclosed to IOtransfer no response

07/02/2022-2nd mail sent to IOtransfer team

21/02/2022- CVE number received from MITRE for the RCE (CVE-2022–24562)

03/03/2022 -CVE numbers received from MITRE for the 4 other vulnerabilities

07/03/2022-3rd mail sent to IOTransfer team no transfer

08/03/2022 - email sent to iobit again

29/05/2022 - Final email sent to iobit containing this document

15/06/2022- Article published

[Exploit](/tag/exploit?source=post_page-----a2c4a3f9149d--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----a2c4a3f9149d--------------------------------)[Hacking](/tag/hacking?source=post_page-----a2c4a3f9149d--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----a2c4a3f9149d--------------------------------)[Cve](/tag/cve?source=post_page-----a2c4a3f9149d--------------------------------)

--

--

[![Tomer Peled](https://miro.medium.com/v2/resize:fill:96:96/1*GOFjb5W_nuSIIiZ_R5715w.jpeg)](/%40tomerp_77017?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)[![Tomer Peled](https://miro.medium.com/v2/resize:fill:128:128/1*GOFjb5W_nuSIIiZ_R5715w.jpeg)](/%40tomerp_77017?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)Follow[## Written by Tomer Peled](/%40tomerp_77017?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)[12 Followers](/%40tomerp_77017/followers?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)·[2 Following](/%40tomerp_77017/following?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)

Security researcher at BugSec

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----a2c4a3f9149d--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----a2c4a3f9149d--------------------------------)[About](/about?autoplay=1&source=post_page-----a2c4a3f9149d--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----a2c4a3f9149d--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----a2c4a3f9149d--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----a2c4a3f9149d--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a2c4a3f9149d--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a2c4a3f9149d--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----a2c4a3f9149d--------------------------------)[Teams](/business?source=post_page-----a2c4a3f9149d--------------------------------)



=== Content from iobit.com_6b1f0a55_20250108_135555.html ===


 Explore worldwide content with a **Secure, Private, Fast, and Free VPN** in 1-click.

[Download Now >](https://www.itopvpn.com/vpn-windows?insur=iobittopbanner)

[IObit](../en/index.php)

* Products

  + PC Clean

    For Windows
    [Advanced SystemCare Free](../en/advancedsystemcarefree.php)

    [Advanced SystemCare PRO](../en/advancedsystemcarepro.php)

    [All IObit Products](../en/products.php)

    [IOTransfer](https://www.iotransfer.net/?ref=iobit)

      For Mac
    [Macbooster](https://www.macbooster.net/?ref=iobit_en)

      For Android

    [AMC Security](../en/advanced-mobile-care.php)
  + Protection

      For Windows

    [Advanced SystemCare Ultimate](../en/advanced-systemcare-antivirus.php)

    [IObit Malware Fighter Free](../en/malware-fighter.php)

    [IObit Malware Fighter PRO](../en/malware-fighter-pro.php)

    [Protected Folder](../en/password-protected-folder.php)

    [Random Password Generator](../en/passwordgenerator.php)

    [All IObit Products](../en/products.php)

      For Mac
    [Macbooster](https://www.macbooster.net/?ref=iobit_en)

     For Android
    [AMC Security](../en/advanced-mobile-care.php)

    [AppLock](../en/applock.php)
  + Optimization

      For Windows

    [IObit Uninstaller Free](../en/advanceduninstaller.php)

    [IObit Uninstaller PRO](../en/advanceduninstallerpro.php)

    [IObit Software Updater](../en/iobit-software-updater.php)

    [Smart Defrag](../en/iobitsmartdefrag.php)

    [Start Menu 8](../en/iobitstartmenu8.php)

    [IObit Unlocker](../en/iobit-unlocker.php)

    [IObit Undelete](../en/iobitundelete.php)

    [All IObit Products](../en/products.php)

      For Mac
    [Macbooster](https://www.macbooster.net/?ref=iobit_en)

    [iFreeUp](http://www.ifreeup.com/ifreeup-on-mac.php)
  + Driver Update

     For Windows
    [Driver Booster Free](../en/driver-booster.php)

    [Driver Booster PRO](../en/driver-booster-pro.php)

    [All IObit Products](../en/products.php)
  + Free Online Tools

    [Online Screen Recorder](https://recorder.iobit.com/en/online-screen-recorder)

    [Online Mic Test](../en/mic-test.php)
    [Online Webcam Test](../en/webcam-test.php)
    [Online Password Generator](../en/online-password-generator.php)
    [Internet Speed Test](../en/iobit-speed-test.php)
* [Store](../en/store.php)
* [Pressroom](../en/pressroom.php)
* Support

  + Support Center

    [FAQs](../en/faq.php)

    [Refund Request](../en/refund.php)

    [Product Manuals](../en/product-manuals.php)

    [Reinstall Product](../en/reinstallproduct.php)

    [Transfer to Another PC](../en/transferproduct.php)

    [Resend Code](../en/lostcode.php)

    [Renew License](../en/renew.php)

    [Online Feedback](../en/onlinefeedback.php)

    [IObit Forum](https://forums.iobit.com/)
  + IObit Forums
  + Multiple Languages

    [Language](../en/language.php)

    [Help Us Translate](../en/translate.php)
* [Partner](../en/partnersolutions.php)

[Expert in

PC Health Solution](../en/index.php)

* [Partner](../en/partnersolutions.php)
* Support
  Support Center
  + [FAQs](../en/faq.php)
  + [Refund Request](../en/refund.php)
  + [Product Manuals](../en/product-manuals.php)
  + [Reinstall Product](../en/reinstallproduct.php)
  + [Transfer to Another PC](../en/transferproduct.php)
  + [Resend Code](../en/lostcode.php)
  + [Renew License](../en/renew.php)
  + [Online Feedback](../en/onlinefeedback.php)
  + [IObit Forum](https://forums.iobit.com/)

  Multiple Languages
  [Language](../en/language.php)

  [Help Us Translate](../en/translate.php)

* Speedup
  [![](../tpl/images/product-icons/asc_96.png)](../en/advancedsystemcarefree.php)
  ### [Advanced SystemCare Free](../en/advancedsystemcarefree.php)

  Over 15 Years

  All-in-one PC health solution: clean, optimize and secure

  [![](../tpl/images/boxshot/asc_left600_524.png)](../en/advancedsystemcarepro.php)
  ### [Advanced SystemCare Pro](../en/advancedsystemcarepro.php)

  Best Seller

  Comprehensive PC cleaning, optimization and protection
* Driver Updater
  [![](../tpl/images/product-icons/db_96.png)](../en/driver-booster.php)
  ### [Driver Booster Free](../en/driver-booster.php)

  No.1 Driver Updater

  Keep drivers always up-to-date

  [![](../tpl/images/boxshot/db_left600_30.png)](../en/driver-booster-pro.php)
  ### [Driver Booster Pro](../en/driver-booster-pro.php)

  Most Popular

  More stable performance with less system crashes
* Antivirus
  [![](../tpl/images/product-icons/imf6_96_238.png)](../en/malware-fighter.php)

  ### [IObit Malware Fighter Free](../en/malware-fighter.php)

  Opswat Certified

  Protect millions of computers against malware

  [![](../tpl/images/boxshot/imf_left600_877.png)](../en/malware-fighter-pro.php)

  ### [IObit Malware Fighter Pro](../en/malware-fighter-pro.php)

  Awarded Protection

  Top computer security with full-round protection

  [![](../tpl/images/product-icons/ascu_96.png)](../en/advanced-systemcare-antivirus.php)

  ### [Advanced SystemCare Ultimate](../en/advanced-systemcare-antivirus.php)

  All-in-one Protection

  Protect against viruses & boost PC performance
* Must-have Tools
  ### Must-have Tools

  [IObit Uninstaller](../en/advanceduninstaller.php)
  Users’ Choice

  Easily removing unwanted programs & leftovers

  [Download Free >](../en/advanceduninstaller.php)
  [Get Pro >](../en/advanceduninstallerpro.php)

  [IObit Software Updater](../en/iobit-software-updater.php)

  Automatically keep your software up-to-date

  [Download Free >](../en/iobit-software-updater.php)
  [Get Pro >](../en/iobit-software-updater.php)

  [IObit SysInfo](../en/system-information.php)
  New

  Quickly check system information and PC specs

  [Download Free >](../en/system-information.php)

  [Protected Folder](../en/password-protected-folder.php)

  Never worry about data theft or privacy leaks

  [Download Free >](../en/password-protected-folder.php)
  [Get Pro >](../en/password-protected-folder.php)

  [Smart Defrag](../en/iobitsmartdefrag.php)

  Maximize hard drive optimization for faster PC

  [Download Free >](../en/iobitsmartdefrag.php)
  [Get Pro >](../en/iobitsmartdefrag.php)

  [MacBooster](https://www.macbooster.net)

  Enjoy a Faster and More Secure Mac

  [Download Free >](https://www.macbooster.net)
  [Get Pro >](https://www.macbooster.net)

  [See All IObit Products >](../en/products.php)

  Free Online Tools
  [Sound Test](../en/sound-test.php)
  [Keyboard Test](../en/keyboard-test.php)
  [Online Mic Test](../en/mic-test.php)
  [Online Webcam Test](../en/webcam-test.php)
  [Online Password Generator](../en/online-password-generator.php)
  [Internet Speed Test](../en/iobit-speed-test.php)
* Store

  ![](../tpl/images/product-icons/shop.svg)
  ### IObit Shop

  Up to 87% OFF

  Complete Solutions for PC
   Problems & Threats.

# **Advanced SystemCare 18 Free** NEW

Free PC Cleaner & Optimizer for Windows. Less Junk, Faster System.

* 1-click to clean useless junk files and registries to free up more disk space.
* Troubleshoot startup process and manage browser configuration for faster system.
* Sweep off traces and hide real identity for a 100% safe online browsing.

[Learn more](https://www.iobit.com/en/advancedsystemcarepro.php)

[Free Download](https://www.iobit.com/downloadcenter.php?product=advanced-systemcare-free-new)

Supports Windows 11

## Driver Booster 12 Free New Release

No.1 driver management tool. Reduce crashes, Boost PC performance.

![](https://www.iobit.com/tpl/images/home/db12-laptop.png)

![](https://www.iobit.com/tpl/images/home/icon-drivers.png)
Update 9,500,000+ Drivers Larger driver database allows detecting & updating more drivers in 1-click.

![](https://www.iobit.com//tpl/images/home/icon-fixpcissues.png)
Fewer Crashes and Freezes Enable multiple free tools to fix common issues to reduce 75% of system crashing, freezing, and PC issues.

![](https://www.iobit.com//tpl/images/home/icon-updating.png)
Safer Driver Updating All drivers are officially from the original hardware manufacturers as well as have passed the Microsoft WHQL test and IObit strict test.

[Learn more](https://www.iobit.com/en/driver-booster-pro.php)

[Free Download](https://www.iobit.com/downloadcenter.php?product=driver-booster-free-new)

## IObit Malware Fighter 12 Free

Provide an all-around security solution to secure you from malware, virus, spyware, ransomware, scams, and other online threats completely.

[Learn more](https://www.iobit.com/en/advanceduninstallerpro.php)

[Free Download](https://www.iobit.com/en/malware-fighter.php)

## IObit Uninstaller 14 Free

A light and free solution to scan, manage, and delete software in bulk. Completely uninstall all unwanted programs, stubborn programs, and extensions.

![](https://www.iobit.com/tpl/images/home/iu-left-laptop.png)

[Learn more](https://www.iobit.com/en/malware-fighter-pro.php)

[Free Download](https://www.iobit.com/en/advanceduninstaller.php)

## IObit Software Updater 7

Always keep your software at best. Better experience, Better productivity.

![](https://www.iobit.com/tpl/images/home/isu-right-laptop.png)

[Learn more](https://www.iobit.com/en/iobit-software-updater.php)

[Free Download](https://www.iobit.com/en/iobit-software-updater.php)

## World-wide Awards

Trusted by these world-leading media, we always strive for the best

* ![PC World](../tpl/images/home/logo-pcword.png)
* ![CHiP PICK](../tpl/images/home/logo-chippick.png)
* ![CNET](../tpl/images/home/logo-cnet.png)
* ![PCMAG.com](../tpl/images/home/logo-pcmag.png)
* ![majorgeeks.com](../tpl/images/home/logo-majorgeeks.png)

### Subscribe to IObit

Subscribe to keep you updated on products updates and special offers via email. And you can opt-out at any time.

---

United States (English)

#### Products

* [Advanced SystemCare](../en/advancedsystemcarefree.php)
* [Advanced SystemCare Ultimate](../en/advanced-systemcare-antivirus.php)
* [Driver Booster](../en/driver-booster.php)
* [IObit Malware Fighter](../en/malware-fighter.php)
* [Smart Defrag](../en/iobitsmartdefrag.php)
* [IObit Uninstaller](../en/advanceduninstaller.php)
* [IObit Software Updater](../en/iobit-software-updater.php)
* [Free AI Video Generator](https://www.vidnoz.com/ai-video-generator.html)
* [Free Download Other Products](../en/products.php)

#### About IObit

* [About Us](../en/about.php)
* [Partners](../en/partnersolutions.php)
* [Press Room](../en/pressroom.php)
* [Awards](../en/awards.php)
* [Jobs](../en/jobs.php)
* [Contact Us](../en/contact.php)
* [Sitemap](https://www.iobit.com/en/sitemap.php)

#### Customer Care

* [IObit Forum](http://forums.iobit.com)
* [Renew Your License](../en/renew.php)
* [Uninstall Instructions](https://www.iobit.com/en/allfaq.php#a1d33d0dfec820b41b54430b50e96b5c)

#### Follow

---

© 2005 -
 IObit.
All Rights Reserved
*|*[Refund Policy](../en/refundpolicy.php)
*|*[EULA](../en/eula.php)
*|*[Legal Notice](../en/legal.php)
*|*[Privacy Policy](../en/privacy.php)

[Vidqu](https://www.vidqu.ai/)
[Vidwud](https://www.vidwud.com/)
[Vidmud](https://www.vidmud.com/)
[iMofone](https://www.imofone.com/)
[EaseHow](https://www.easehow.com/)
[iSmartta](https://www.ismartta.com/)
[MioCreate](https://www.miocreate.com/)
[Contact Us](../en/contact.php)
[Support](../en/onlinefeedback.php)
[Products](../en/products.php)
[Home](../en/index.php)

IObit uses cookies to improve content and ensure you get the best experience on our website.
 Continue to browse our website agreeing to our [privacy policy](privacy.php).

I Accept

* [Argentina - (Español)](https://www.iobit.com/es/index.php)
* [Australia - (English)](https://www.iobit.com/en/index.php)
* [Belgique - (Français)](https://www.iobit.com/fr/index.php)
* [België - (Vlaams)](https://www.iobit.com/nl/index.php)
* [Brasil - (Português)](https://www.iobit.com/pt/index.php)
* [Canada - (English)](https://www.iobit.com/en/index.php)
* [Chile - (Español)](https://www.iobit.com/es/index.php)
* [Colombia - (Español)](https://www.iobit.com/es/index.php)
* [Danmark- (Dansk)](https://www.iobit.com/dk/index.php)
* [Deutschland - (Deutsch)](https://www.iobit.com/de/index.php)
* [España - (Español)](https://www.iobit.com/es/index.php)
* [France - (Français)](https://www.iobit.com/fr/index.php)

* [Indonesia - (Bahasa Indonesia)](https://www.iobit.com/en/index.php)
* [Italia - (Italiano)](https://www.iobit.com/it/index.php)
* [Luxembourg - (Français)](https://www.iobit.com/fr/index.php)
* [Malaysia - (Bahasa Melayu)](https://www.iobit.com/en/index.php)
* [Monaco - (Français)](https://www.iobit.com/fr/index.php)
* [Myanmar – (Burmese)](https://www.iobit.com/en/index.php)
* [México - (Español)](https://www.iobit.com/es/index.php)
* [Nederland - (Nederlands)](https://www.iobit.com/nl/index.php)
* [Perú - (Español)](https://www.iobit.com/es/index.php)
* [Philippines - (English)](https://www.iobit.com/en/index.php)
* [Polska - (Polski)](https://www.iobit.com/pl/index.php)
* [Schweiz - (Deutsch)](https://www.iobit.com/de/index.php)

* [Suisse - (Français)](https://www.iobit.com/fr/index.php)
* [Sverige - (Svenska)](https://www.iobit.com/sv/index.php)
* [Svizzera - (Italiano)](https://www.iobit.com/it/index.php)
* [United Kingdom - (English)](https://www.iobit.com/en/index.php)
* [United States - (English)](https://www.iobit.com/en/index.php)
* [Österreich - (Deutsch)](https://www.iobit.com/de/index.php)
* [Россия - (Русский)](https://ru.iobit.com/)
* [भारत - (हिंदी)](https://www.iobit.com/en/index.php)
* [ประเทศไทย - (ภาษาไทย)](https://www.iobit.com/en/index.php)
* [にっぽん - (にほんご)](http://jp.iobit.com/)
* [대한민국 - (한국어)](https://www.iobit.com/en/index.php)



=== Content from packetstormsecurity.com_5c61ca8d_20250108_135557.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


