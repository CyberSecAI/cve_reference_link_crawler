[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa2c4a3f9149d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40tomerp_77017%2Fexploiting-iotransfer-insecure-api-cve-2022-24562-a2c4a3f9149d&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40tomerp_77017%2Fexploiting-iotransfer-insecure-api-cve-2022-24562-a2c4a3f9149d&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Exploiting IOTransfer insecure API CVE-2022–24562

[![Tomer Peled](https://miro.medium.com/v2/resize:fill:88:88/1*GOFjb5W_nuSIIiZ_R5715w.jpeg)](/%40tomerp_77017?source=post_page---byline--a2c4a3f9149d--------------------------------)

[Tomer Peled](/%40tomerp_77017?source=post_page---byline--a2c4a3f9149d--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd42e0b5b0cd8&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40tomerp_77017%2Fexploiting-iotransfer-insecure-api-cve-2022-24562-a2c4a3f9149d&user=Tomer+Peled&userId=d42e0b5b0cd8&source=post_page-d42e0b5b0cd8--byline--a2c4a3f9149d---------------------post_header-----------)

4 min read·Jun 15, 2022

--

Listen

Share

# **Background**

Continuing the series about IPC vulnerabilities today we will look at another Chinese company, IObit.

IOTransfer by IObit is a program that allows the user to transfer files between their iPhone and their PC supposedly competing with apple’s iTunes. In order to operate IObit uses a node JS server for communication. The API is not obfuscated and does not contain any access control checks or any security measures at all. Understanding this communication can lead to arbitrary reading and writing to any location on the computer which can naturally lead to RCE with a bit of creativity.

# **Finding the first lead**

Starting with process hacker I found that “IOtransfer” is deploying a process that listens actively over TCP. By its logo it seemed like a node.js application

![]()

AirServ listening

Going over the details available in process hacker I found that the process is running with elevated privileges

![]()

AirServ Privileges

The process was executed with a command-line ending in “iot\_filetransfer.js” and the file details revealed it’s indeed a node.js server.

![]()

AirServ command line

Looking at the structure of the folder containing AirServ.exe we can see that the API is comprised from 5 files

![]()

folder structure

After opening “iot\_filetransfer.js” I could clearly see that:

1) The file was the “main” of the API implementation

2) There is no obfuscation of the code

3) There seems to be two different types of listeners one for GET methods and one for POST methods

![]()![]()

GET API Handler init

![]()

POST API Handler init

After making sure there is an ‘action’ parameter defined in the request the server will send the request to a dispatch function. This function is a parser for the actual requested method

Among those methods two are particularly interesting: “DOWNLOAD\_FILE”, “UPLOAD\_FILE”

![]()
# **Code Review**

AirServ is using a system of tasks to execute its actions it was probably implemented this way so the server will be able to keep track of what was downloaded/uploaded and to perform actions concurrently

In order to upload/download a file, the user must specify a taskID while the userID can be anything…

![]()

In order to get a taskid the user first needs to create a new task

The task should contain the following fields:

![]()

After sending these fields with the correct request the JS server will conveniently send a new taskID as a response:

![]()

After creating the task we need to set the details for it in a follow-up request

![]()

Size -the size of the file we want to upload

Savedfilepath -The path we want to upload a file to

Fullpath -not used so it can be any string

MD5 -not checked so it can be any string

Filetype -set to 3 in order to allow path traversal

The last request is for the function “newuploadtask” with the local file we want to upload as the data.

This request will trigger the execution of the task we created coupled with the data we sent to create a file in our desired folder.

This is the complete flow I used to create a payload in the target machine:

![]()

A very similar procedure can be used to download files from any location in the target machine to a remote computer

# **Conclusion**

IOTransfer’s AirServ lacks any kind of security measures. Even basic security measures such as obfuscation are not present. The fact that the service is running with ADMIN privileges is a major security hole. Blue Team personal should be aware of this and block IOTransfer communication port (7193) when not in use.

Github POC: <https://github.com/tomerpeled92/CVE/blob/main/CVE-2022%E2%80%9324562>

# **Disclosure timeline**

24/01/2022 - disclosed vulnerabilities to Iobit

29/01/2022 - Iobit emailed us saying they will analyze the information

05/02/2022 -RCE disclosed to IOtransfer no response

07/02/2022-2nd mail sent to IOtransfer team

21/02/2022- CVE number received from MITRE for the RCE (CVE-2022–24562)

03/03/2022 -CVE numbers received from MITRE for the 4 other vulnerabilities

07/03/2022-3rd mail sent to IOTransfer team no transfer

08/03/2022 - email sent to iobit again

29/05/2022 - Final email sent to iobit containing this document

15/06/2022- Article published

[Exploit](/tag/exploit?source=post_page-----a2c4a3f9149d--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----a2c4a3f9149d--------------------------------)[Hacking](/tag/hacking?source=post_page-----a2c4a3f9149d--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----a2c4a3f9149d--------------------------------)[Cve](/tag/cve?source=post_page-----a2c4a3f9149d--------------------------------)

--

--

[![Tomer Peled](https://miro.medium.com/v2/resize:fill:96:96/1*GOFjb5W_nuSIIiZ_R5715w.jpeg)](/%40tomerp_77017?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)[![Tomer Peled](https://miro.medium.com/v2/resize:fill:128:128/1*GOFjb5W_nuSIIiZ_R5715w.jpeg)](/%40tomerp_77017?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)Follow[## Written by Tomer Peled](/%40tomerp_77017?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)[12 Followers](/%40tomerp_77017/followers?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)·[2 Following](/%40tomerp_77017/following?source=post_page---post_author_info--a2c4a3f9149d--------------------------------)

Security researcher at BugSec

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----a2c4a3f9149d--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----a2c4a3f9149d--------------------------------)[About](/about?autoplay=1&source=post_page-----a2c4a3f9149d--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----a2c4a3f9149d--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----a2c4a3f9149d--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----a2c4a3f9149d--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a2c4a3f9149d--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a2c4a3f9149d--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----a2c4a3f9149d--------------------------------)[Teams](/business?source=post_page-----a2c4a3f9149d--------------------------------)

