The provided content relates to CVE-2024-35901.

**Root cause of vulnerability:**
The `mana_get_rxbuf_cfg()` function in the Linux kernel's `mana` driver aligns the RX buffer's DMA data size to be a multiple of 64 bytes. This alignment can cause a buffer overflow when a packet slightly larger than the MTU + 14 bytes is received, leading to an `skb_over_panic`. Specifically, if a packet such as 1536 bytes is received, and the MTU is slightly smaller, the alignment can cause a buffer overflow.

**Weaknesses/vulnerabilities present:**
- Incorrect DMA data size calculation.
- Potential buffer overflow in `skb_put` when receiving oversized packets.

**Impact of exploitation:**
- Kernel panic and denial of service.
- System crash

**Attack vectors:**
- Sending packets slightly larger than the configured MTU to a vulnerable system.

**Required attacker capabilities/position:**
- Ability to send network packets to the target system, possibly on the same local network or, depending on the network configuration, from a remote location.

**Additional details:**
The fix involves removing the unnecessary alignment of the RX buffer's DMA data size. This forces the NIC to mark oversized packets as `CQE_RX_TRUNCATED` and drop them, preventing the `skb_over_panic`. The patch removes the `ALIGN(mtu + ETH_HLEN, MANA_RX_DATA_ALIGN)` operation from `mana_get_rxbuf_cfg` and sets `*datasize` to `mtu + ETH_HLEN`.
The commit also removes the `MANA_RX_DATA_ALIGN` definition.