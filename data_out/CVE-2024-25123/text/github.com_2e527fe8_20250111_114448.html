
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpen-MSS%2FMSS%2Fsecurity%2Fadvisories%2FGHSA-pf2h-qjcr-qvq2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpen-MSS%2FMSS%2Fsecurity%2Fadvisories%2FGHSA-pf2h-qjcr-qvq2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Open-MSS%2FMSS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Open-MSS](/Open-MSS)
/
**[MSS](/Open-MSS/MSS)**
Public

* [Notifications](/login?return_to=%2FOpen-MSS%2FMSS) You must be signed in to change notification settings
* [Fork
  94](/login?return_to=%2FOpen-MSS%2FMSS)
* [Star
   66](/login?return_to=%2FOpen-MSS%2FMSS)

* [Code](/Open-MSS/MSS)
* [Issues
  157](/Open-MSS/MSS/issues)
* [Pull requests
  18](/Open-MSS/MSS/pulls)
* [Actions](/Open-MSS/MSS/actions)
* [Projects
  0](/Open-MSS/MSS/projects)
* [Wiki](/Open-MSS/MSS/wiki)
* [Security](/Open-MSS/MSS/security)
* [Insights](/Open-MSS/MSS/pulse)

Additional navigation options

* [Code](/Open-MSS/MSS)
* [Issues](/Open-MSS/MSS/issues)
* [Pull requests](/Open-MSS/MSS/pulls)
* [Actions](/Open-MSS/MSS/actions)
* [Projects](/Open-MSS/MSS/projects)
* [Wiki](/Open-MSS/MSS/wiki)
* [Security](/Open-MSS/MSS/security)
* [Insights](/Open-MSS/MSS/pulse)

# Potential Path Manipulation in file mslib/index.py

Critical

[ReimarBauer](/ReimarBauer)
published
GHSA-pf2h-qjcr-qvq2
Feb 15, 2024

## Package

mss
(conda-forge)

## Affected versions

>=5.0.0 <8.3.3

## Patched versions

8.3.3

## Description

In file: `index.py`, there is a method that is vulnerable to path manipulation attack. By modifying file paths, an attacker can acquire sensitive information from different resources.

[index.py](https://github.com/Open-MSS/MSS/blob/develop/mslib/index.py#L183)

```
--- mslib/index.py

+++ mslib/index.py

@@ -180,6 +180,15 @@

     @APP.route("/mss/code/<path:filename>")

     def code(filename):

         download = request.args.get("download", False)

+        '''

+        ***************** OpenRefactory Warning *****************

+        Possible Path manipulation attack!

+        Path:

+        		Tainted information is passed while initializing objects during dependency injection to the formal parameter filename of the method.

+        	File: index.py, Line: 183

+        		_file = os.path.join(STATIC_LOCATION, 'code', filename)

+        		Tainted information is used in a sink.

+        '''

         _file = os.path.join(STATIC_LOCATION, 'code', filename)

         content = get_content(_file)

         if not download:
```

Here `filename` is joined with other variables to form a file path `_file`. But `filename` is a route parameter that can capture `path` type values i.e. values including slashes (`\`). So it is possible for an attacker to manipulate the file being read by assigning a value containing `../` to `filename`.

### PoC

For the sake of demonstrating that such a case can potentially be exploited, I created a simple flask app containing a similar method which sends back contents of the file in HTML format.

```
STATIC_LOCATION = '/home/user/Documents/'

...

@app.route("/test/code/<path:filename>")
def code(filename):
    download = request.args.get("download", False)
    _file = os.path.join(STATIC_LOCATION, 'code', filename)
    content = get_content(_file)
    if not download:
        return Response(content,mimetype="text/html")

    ...
```

Consider an attacker requests the following URL:

```
http://127.0.0.1:5000/test/code/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd

```

The string of hex digits in place of `filename` parameter is an URL encoded version of `../../../../etc/passwd`. This causes the file path `_file` to be `/home/user/Documents/code/../../../../etc/passwd` which in turn causes `/etc/passwd` to be read and its contents sent back.

### CLA Requirements:

This section is only relevant if your project requires contributors to sign a Contributor License Agreement (CLA) for external contributions.

All contributed commits are already automatically signed off.

The meaning of a signoff depends on the project, but it typically certifies that committer has the rights to submit this work under the same license and agrees to a Developer Certificate of Origin (see <https://developercertificate.org/> for more information).

* [Git Commit SignOff documentation](https://developercertificate.org/)

### Sponsorship and Support:

This work is done by the security researchers from OpenRefactory and is supported by the [Open Source Security Foundation (OpenSSF)](https://openssf.org/): [Project Alpha-Omega](https://alpha-omega.dev/). Alpha-Omega is a project partnering with open source software project maintainers to systematically find new, as-yet-undiscovered vulnerabilities in open source code - and get them fixed - to improve global software supply chain security.

The bug is found by running the iCR tool by [OpenRefactory, Inc.](https://openrefactory.com/) and then manually triaging the results.

### Severity

Critical

### CVE ID

CVE-2024-25123

### Weaknesses

No CWEs

### Credits

* [![@ZuhairORZaki](https://avatars.githubusercontent.com/u/141129124?s=40&v=4)](/ZuhairORZaki)
  [ZuhairORZaki](/ZuhairORZaki)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

