
[Skip to content](#content)
[![GainSec](https://i0.wp.com/gainsec.com/wp-content/uploads/2019/06/cropped-glitch-circle-banner-1.jpg?fit=998%2C300&ssl=1?v=1664886777)](https://gainsec.com/)

[GainSec](https://gainsec.com/)

Where OSINT, Hacking, Penetration Testing, Privacy, Piracy, Information Security, Cyber Security and Law are a lifestyle.

Menu

* [Home](/)
* [Projects](https://gainsec.com/projects/)
* [Shop](https://gainsec.com/shop/)
* [Press](https://gainsec.com/mentions-quotes/)
* [Inquiries](https://gainsec.com/contact/)
* [About Me](https://gainsec.com/whoami/)
* [Archives](https://gainsec.com/archive-page/)
* [FAQ](https://gainsec.com/faq/)
* [Cart](https://gainsec.com/cart/)

* [$0.00 0 items](https://gainsec.com/cart/ "View your shopping cart")

# CVE-2022-34625 ‚Äì Server-Side Template Injection to Remote Code Execution (SSTI) to (RCE) in Mealie ‚Äì A lesson in patience

[gainsec](https://gainsec.com/author/gainsec/ "Posts by gainsec")
[CVE](https://gainsec.com/category/cve/), [Web Application Pen Testing](https://gainsec.com/category/web-application-pen-testing/)
August 2, 2022August 2, 2022

I told you there are more CVEs coming! And this is just the beginning as of right now, I have 14 MORE CVE numbers reserved which are waiting on developer confirmation/responsible disclosure dates to pass.

Anyway, to more important topics like CVE-2022-34625 aka Server-Side Template Injection (SSTI) to Remote Code Execution (RCE); More information about SSTI [HERE](https://portswigger.net/research/server-side-template-injection) and RCE [HERE](https://www.checkpoint.com/cyber-hub/cyber-security/what-is-remote-code-execution-rce/).

So my co-worker and I at [nVisium](https://nvisium.com/), Bruno Hern√°ndez ([GitHub](https://github.com/0xBruno) and [LinkedIn](https://www.linkedin.com/in/bruno-x-hernandez)) were looking for some CVEs testing an open source web application called Mealie after work hours which I suggested and can be found [HERE](https://hay-kot.github.io/mealie/).

Specifically for this night, we used docker to deploy this application which will later come to bite us (more on that in future posts).

Anyway, we spent a long night, finding things such as Denial of Service (DoS), a shitty password policy, multiple Cross-site Scripting, an arbitrary file write (can write a file to any directory on the entire host?!) and more.

After all these vulnerabilities it was hard to think there was nothing else there. However, to come across an RCE, well that‚Äôs the holy grail.

Bruno spent a lot of time working with the Python routes because with the arbitrary file write, we could overwrite a Python route with some extra code and it should execute when that route is accessed. Which it did, when executing the Python locally. The problem was, what we gathered to be a caching issue so after running the application, the malicious .py file wouldn‚Äôt be executed until the application was restarted.

I also suggested a crontab and he suggested overwriting/etc/passwd but these like the python route, wouldn‚Äôt run on demand which Bruno was unhappy with.

While he tinkered at that for what seemed to be hours I went back to back to page one. Reading the README, looking through the documentation.

It was then, at the crack of dawn, that I realized something,

![](https://i0.wp.com/gainsec.com/wp-content/uploads/2022/08/image-1024x276.png?resize=1024%2C276&ssl=1)

According to Mealie‚Äôs documentation located [HERE](https://nightly.mealie.io/) it supported Jinja2 templates. Now if you know, you know üôÇ

So I logged in as an Admin, Uploaded the ‚Äúrecipe‚Äù template and exported the backup. and BOOM had code execution.

Here is the payload used:

```
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}

```
![](https://i0.wp.com/gainsec.com/wp-content/uploads/2022/08/image-1.png?resize=791%2C140&ssl=1)

Here is the output when viewing exported ‚Äúrecipe‚Äù template.

What was super cool (beyond finding an RCE in the WILD) was Bruno‚Äôs arbitrary file upload allowed low privilege users to also upload a template which would then be executed when exporting the application.

Anyway, Bruno reported it to the dev via hunter.dev [HERE](https://huntr.dev/bounties/3ecd4a78-523e-4f84-a3fd-31a01a68f142/)

**He posted about it [HERE](https://0xbruno.netlify.app/posts/research/mealie/cve-2022-34625/) in a much more detailed and technical write-up!**

The issue being accepted and fixed by the developer can be found [HERE](https://github.com/hay-kot/mealie/pull/1515)

And further information about the CVE itself can be found [HERE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34625), [HERE](https://cve.report/CVE-2022-34625) and many other places in the near future üôÇ

More coming soon!

END TRANSMISSION

### Share this:

* [Twitter](https://gainsec.com/2022/08/02/cve-2022-34625-ssti-rce-mealie/?share=twitter "Click to share on Twitter")
* [Facebook](https://gainsec.com/2022/08/02/cve-2022-34625-ssti-rce-mealie/?share=facebook "Click to share on Facebook")
### Like this:

Like Loading...

* Tagged
* [0 Day](https://gainsec.com/tag/0-day/)
* [CVE](https://gainsec.com/tag/cve/)
* [Ethical Hacking](https://gainsec.com/tag/ethical-hacking/)
* [NEW CVE](https://gainsec.com/tag/new-cve/)
* [Penetration Testing](https://gainsec.com/tag/penetration-testing/)

**Published**
August 2, 2022August 2, 2022

## Post navigation

[Previous Post CVE-2022-34009](https://gainsec.com/2022/07/27/cve-2022-34009/)[Next Post CVE-2022-34613, CVE-2022-34618, CVE-2022-34619 ‚Äì Multiple XSS (And more) in Mealie](https://gainsec.com/2022/08/02/cve-2022-34613-cve-2022-34618-cve-2022-34619-xss-file-upload-and-more/)

### Leave a Reply[Cancel reply](/2022/08/02/cve-2022-34625-ssti-rce-mealie/#respond)

Search for:

# Follow Us

* [GitHub](https://github.com/GainSec/)
* [Twitter](https://twitter.com/GainSec)
* [Instagram](https://www.instagram.com/gain_sec/)
* [Tumblr](https://gainsec.tumblr.com/)
* [Pinterest](https://www.pinterest.com/gainsec/)
* [LinkedIn](https://www.linkedin.com/in/gainsec/)
* [YouTube](https://www.youtube.com/channel/UC8H3HtWOitNjF5py1_Pb9ig)
* [LinkedIn](https://www.linkedin.com/organization-guest/company/gainsec)
* [Twitch](https://www.twitch.tv/gainsec)
* [Facebook](https://www.facebook.com/GainSecSocial)
* [Etsy](https://www.etsy.com/shop/gainsec)

## Discover more from GainSec

Subscribe now to keep reading and get access to the full archive.

Type your email‚Ä¶

Subscribe

Continue reading

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

