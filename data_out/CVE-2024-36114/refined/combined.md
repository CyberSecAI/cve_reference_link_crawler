=== Content from github.com_3addda94_20250111_193817.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2Fd01ecb779375a092d00e224abe7869cdf49ddc3e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2Fd01ecb779375a092d00e224abe7869cdf49ddc3e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=airlift%2Faircompressor)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[airlift](/airlift)
/
**[aircompressor](/airlift/aircompressor)**
Public

* [Notifications](/login?return_to=%2Fairlift%2Faircompressor) You must be signed in to change notification settings
* [Fork
  116](/login?return_to=%2Fairlift%2Faircompressor)
* [Star
   588](/login?return_to=%2Fairlift%2Faircompressor)

* [Code](/airlift/aircompressor)
* [Issues
  17](/airlift/aircompressor/issues)
* [Pull requests
  4](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects
  0](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

Additional navigation options

* [Code](/airlift/aircompressor)
* [Issues](/airlift/aircompressor/issues)
* [Pull requests](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

## Commit

[Permalink](/airlift/aircompressor/commit/d01ecb779375a092d00e224abe7869cdf49ddc3e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add missing bounds checks

[Browse files](/airlift/aircompressor/tree/d01ecb779375a092d00e224abe7869cdf49ddc3e)
Browse the repository at this point in the history

* Loading branch information

[![@martint](https://avatars.githubusercontent.com/u/14387?s=40&v=4)](/martint)

[martint](/airlift/aircompressor/commits?author=martint "View all commits by martint")
committed
Feb 13, 2024

1 parent
[2cea90a](/airlift/aircompressor/commit/2cea90a45534f9aacbb77426fb64e975504dee6e)

commit d01ecb7

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**8 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/main/java/io/airlift/compress

  + lz4

    - src/main/java/io/airlift/compress/lz4/Lz4RawDecompressor.java
      [Lz4RawDecompressor.java](#diff-a1bfbc3f0a7bb8944e0a40d0e52dd5279743a1cc1a07dbde150c4b5293f5547e)
  + lzo

    - src/main/java/io/airlift/compress/lzo/LzoRawDecompressor.java
      [LzoRawDecompressor.java](#diff-3587c38eb9a49ecf1c59f750f8959c0949523e5cbf0e54b0249cc03831820b3e)
  + zstd

    - src/main/java/io/airlift/compress/zstd/ZstdFrameDecompressor.java
      [ZstdFrameDecompressor.java](#diff-115ab37cac58e2f90567bd02116d7d660bae29c5b2b4875846a1490641ddaafb)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[src/main/java/io/airlift/compress/lz4/Lz4RawDecompressor.java](#diff-a1bfbc3f0a7bb8944e0a40d0e52dd5279743a1cc1a07dbde150c4b5293f5547e "src/main/java/io/airlift/compress/lz4/Lz4RawDecompressor.java")

Show comments

[View file](/airlift/aircompressor/blob/d01ecb779375a092d00e224abe7869cdf49ddc3e/src/main/java/io/airlift/compress/lz4/Lz4RawDecompressor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -62,6 +62,9 @@ public static int decompress( |
|  |  | // decode literal length |
|  |  | int literalLength = token >>> 4; // top-most 4 bits of token |
|  |  | if (literalLength == 0xF) { |
|  |  | if (input >= inputLimit) { |
|  |  | throw new MalformedInputException(input - inputAddress); |
|  |  | } |
|  |  | int value; |
|  |  | do { |
|  |  | value = UNSAFE.getByte(inputBase, input++) & 0xFF; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/main/java/io/airlift/compress/lzo/LzoRawDecompressor.java](#diff-3587c38eb9a49ecf1c59f750f8959c0949523e5cbf0e54b0249cc03831820b3e "src/main/java/io/airlift/compress/lzo/LzoRawDecompressor.java")

Show comments

[View file](/airlift/aircompressor/blob/d01ecb779375a092d00e224abe7869cdf49ddc3e/src/main/java/io/airlift/compress/lzo/LzoRawDecompressor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -325,7 +325,7 @@ else if ((command & 0b1100\_0000) != 0) { |
|  |  | } |
|  |  | long literalOutputLimit = output + literalLength; |
|  |  | if (literalOutputLimit > fastOutputLimit || input + literalLength > inputLimit - SIZE\_OF\_LONG) { |
|  |  | if (literalOutputLimit > outputLimit) { |
|  |  | if (literalOutputLimit > outputLimit || input + literalLength > inputLimit) { |
|  |  | throw new MalformedInputException(input - inputAddress); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

6 changes: 4 additions & 2 deletions

6
[src/main/java/io/airlift/compress/zstd/ZstdFrameDecompressor.java](#diff-115ab37cac58e2f90567bd02116d7d660bae29c5b2b4875846a1490641ddaafb "src/main/java/io/airlift/compress/zstd/ZstdFrameDecompressor.java")

Show comments

[View file](/airlift/aircompressor/blob/d01ecb779375a092d00e224abe7869cdf49ddc3e/src/main/java/io/airlift/compress/zstd/ZstdFrameDecompressor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -197,6 +197,7 @@ public int decompress( |
|  |  |  |
|  |  | long hash = XxHash64.hash(0, outputBase, outputStart, decodedFrameSize); |
|  |  |  |
|  |  | verify(input + SIZE\_OF\_INT <= inputLimit, input, "Not enough input bytes"); |
|  |  | int checksum = UNSAFE.getInt(inputBase, input); |
|  |  | if (checksum != (int) hash) { |
|  |  | throw new MalformedInputException(input, format("Bad checksum. Expected: %s, actual: %s", Integer.toHexString(checksum), Integer.toHexString((int) hash))); |
| Expand Down  Expand Up | | @@ -510,14 +511,15 @@ else if (sequenceCount > 127) { |
|  |  | } |
|  |  |  |
|  |  | // last literal segment |
|  |  | output = copyLastLiteral(outputBase, literalsBase, literalsLimit, output, literalsInput); |
|  |  | output = copyLastLiteral(input, literalsBase, literalsInput, literalsLimit, outputBase, output, outputLimit); |
|  |  |  |
|  |  | return (int) (output - outputAddress); |
|  |  | } |
|  |  |  |
|  |  | private static long copyLastLiteral(Object outputBase, Object literalsBase, long literalsLimit, long output, long literalsInput) |
|  |  | private static long copyLastLiteral(long input, Object literalsBase, long literalsInput, long literalsLimit, Object outputBase, long output, long outputLimit) |
|  |  | { |
|  |  | long lastLiteralsSize = literalsLimit - literalsInput; |
|  |  | verify(output + lastLiteralsSize <= outputLimit, input, "Output buffer too small"); |
|  |  | UNSAFE.copyMemory(literalsBase, literalsInput, outputBase, output, lastLiteralsSize); |
|  |  | output += lastLiteralsSize; |
|  |  | return output; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d01ecb7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2Fd01ecb779375a092d00e224abe7869cdf49ddc3e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9dea91be_20250111_193817.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fsecurity%2Fadvisories%2FGHSA-973x-65j7-xcf4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fsecurity%2Fadvisories%2FGHSA-973x-65j7-xcf4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=airlift%2Faircompressor)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[airlift](/airlift)
/
**[aircompressor](/airlift/aircompressor)**
Public

* [Notifications](/login?return_to=%2Fairlift%2Faircompressor) You must be signed in to change notification settings
* [Fork
  116](/login?return_to=%2Fairlift%2Faircompressor)
* [Star
   588](/login?return_to=%2Fairlift%2Faircompressor)

* [Code](/airlift/aircompressor)
* [Issues
  17](/airlift/aircompressor/issues)
* [Pull requests
  4](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects
  0](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

Additional navigation options

* [Code](/airlift/aircompressor)
* [Issues](/airlift/aircompressor/issues)
* [Pull requests](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

# Decompressors can crash the JVM and leak memory content

High

[martint](/martint)
published
GHSA-973x-65j7-xcf4
May 29, 2024

## Package

maven

io.airlift:aircompressor
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 0.27

## Patched versions

0.27

## Description

### Summary

All decompressor implementations of Aircompressor (LZ4, LZO, Snappy, Zstandard) can crash the JVM for certain input, and in some cases also leak the content of other memory of the Java process (which could contain sensitive information).

### Details

When decompressing certain data, the decompressors try to access memory outside the bounds of the given byte arrays or byte buffers. Because Aircompressor uses the JDK class `sun.misc.Unsafe` to speed up memory access, no additional bounds checks are performed and this has similar security consequences as out-of-bounds access in C or C++, namely it can lead to non-deterministic behavior or crash the JVM.

Users should update to Aircompressor 0.27 or newer where these issues have been fixed.

### Impact

When decompressing data from untrusted users, this can be exploited for a denial-of-service attack by crashing the JVM, or to leak other sensitive information from the Java process.

### Severity

High

### CVE ID

CVE-2024-36114

### Weaknesses

[CWE-125](/advisories?query=cwe%3A125) [CWE-787](/advisories?query=cwe%3A787)

### Credits

* [![@ptaoussanis](https://avatars.githubusercontent.com/u/160011?s=40&v=4)](/ptaoussanis)
  [ptaoussanis](/ptaoussanis)
  Reporter
* [![@Marcono1234](https://avatars.githubusercontent.com/u/11685886?s=40&v=4)](/Marcono1234)
  [Marcono1234](/Marcono1234)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6a7ed17c_20250111_193816.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2Fcf66151541edb062ea88b6f3baab3f95e48b7b7f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2Fcf66151541edb062ea88b6f3baab3f95e48b7b7f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=airlift%2Faircompressor)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[airlift](/airlift)
/
**[aircompressor](/airlift/aircompressor)**
Public

* [Notifications](/login?return_to=%2Fairlift%2Faircompressor) You must be signed in to change notification settings
* [Fork
  116](/login?return_to=%2Fairlift%2Faircompressor)
* [Star
   588](/login?return_to=%2Fairlift%2Faircompressor)

* [Code](/airlift/aircompressor)
* [Issues
  17](/airlift/aircompressor/issues)
* [Pull requests
  4](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects
  0](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

Additional navigation options

* [Code](/airlift/aircompressor)
* [Issues](/airlift/aircompressor/issues)
* [Pull requests](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

## Commit

[Permalink](/airlift/aircompressor/commit/cf66151541edb062ea88b6f3baab3f95e48b7b7f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix bounds checks

[Browse files](/airlift/aircompressor/tree/cf66151541edb062ea88b6f3baab3f95e48b7b7f)
Browse the repository at this point in the history

* Loading branch information

[![@martint](https://avatars.githubusercontent.com/u/14387?s=40&v=4)](/martint)

[martint](/airlift/aircompressor/commits?author=martint "View all commits by martint")
committed
Feb 13, 2024

1 parent
[d01ecb7](/airlift/aircompressor/commit/d01ecb779375a092d00e224abe7869cdf49ddc3e)

commit cf66151

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**4 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + main/java/io/airlift/compress/zstd

    - src/main/java/io/airlift/compress/zstd/ZstdFrameDecompressor.java
      [ZstdFrameDecompressor.java](#diff-115ab37cac58e2f90567bd02116d7d660bae29c5b2b4875846a1490641ddaafb)
  + test/java/io/airlift/compress/zstd

    - src/test/java/io/airlift/compress/zstd/TestZstd.java
      [TestZstd.java](#diff-a8cad9b49cbcea1b5a4d6e45ebf8667f756af2f3a86a76952f0b47ce34e5e3ee)

## There are no files selected for viewing

6 changes: 3 additions & 3 deletions

6
[src/main/java/io/airlift/compress/zstd/ZstdFrameDecompressor.java](#diff-115ab37cac58e2f90567bd02116d7d660bae29c5b2b4875846a1490641ddaafb "src/main/java/io/airlift/compress/zstd/ZstdFrameDecompressor.java")

Show comments

[View file](/airlift/aircompressor/blob/cf66151541edb062ea88b6f3baab3f95e48b7b7f/src/main/java/io/airlift/compress/zstd/ZstdFrameDecompressor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -170,17 +170,17 @@ public int decompress( |
|  |  | int decodedSize; |
|  |  | switch (blockType) { |
|  |  | case RAW\_BLOCK: |
|  |  | verify(inputAddress + blockSize <= inputLimit, input, "Not enough input bytes"); |
|  |  | verify(input + blockSize <= inputLimit, input, "Not enough input bytes"); |
|  |  | decodedSize = decodeRawBlock(inputBase, input, blockSize, outputBase, output, outputLimit); |
|  |  | input += blockSize; |
|  |  | break; |
|  |  | case RLE\_BLOCK: |
|  |  | verify(inputAddress + 1 <= inputLimit, input, "Not enough input bytes"); |
|  |  | verify(input + 1 <= inputLimit, input, "Not enough input bytes"); |
|  |  | decodedSize = decodeRleBlock(blockSize, inputBase, input, outputBase, output, outputLimit); |
|  |  | input += 1; |
|  |  | break; |
|  |  | case COMPRESSED\_BLOCK: |
|  |  | verify(inputAddress + blockSize <= inputLimit, input, "Not enough input bytes"); |
|  |  | verify(input + blockSize <= inputLimit, input, "Not enough input bytes"); |
|  |  | decodedSize = decodeCompressedBlock(inputBase, input, blockSize, outputBase, output, outputLimit, frameHeader.windowSize, outputAddress); |
|  |  | input += blockSize; |
|  |  | break; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/test/java/io/airlift/compress/zstd/TestZstd.java](#diff-a8cad9b49cbcea1b5a4d6e45ebf8667f756af2f3a86a76952f0b47ce34e5e3ee "src/test/java/io/airlift/compress/zstd/TestZstd.java")

Show comments

[View file](/airlift/aircompressor/blob/cf66151541edb062ea88b6f3baab3f95e48b7b7f/src/test/java/io/airlift/compress/zstd/TestZstd.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -258,6 +258,6 @@ public void testBadHuffmanData() |
|  |  |  |
|  |  | assertThatThrownBy(() -> new ZstdDecompressor().decompress(data, 0, data.length, new byte[10], 0, 10)) |
|  |  | .isInstanceOf(MalformedInputException.class) |
|  |  | .hasMessageStartingWith("Input is corrupted"); |
|  |  | .hasMessageStartingWith("Not enough input bytes"); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cf66151`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2Fcf66151541edb062ea88b6f3baab3f95e48b7b7f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_dc5e0f74_20250111_193815.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2F15e68df9eb0c2bfde7f796231ee7cd1982965071)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2F15e68df9eb0c2bfde7f796231ee7cd1982965071)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=airlift%2Faircompressor)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[airlift](/airlift)
/
**[aircompressor](/airlift/aircompressor)**
Public

* [Notifications](/login?return_to=%2Fairlift%2Faircompressor) You must be signed in to change notification settings
* [Fork
  116](/login?return_to=%2Fairlift%2Faircompressor)
* [Star
   588](/login?return_to=%2Fairlift%2Faircompressor)

* [Code](/airlift/aircompressor)
* [Issues
  17](/airlift/aircompressor/issues)
* [Pull requests
  4](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects
  0](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

Additional navigation options

* [Code](/airlift/aircompressor)
* [Issues](/airlift/aircompressor/issues)
* [Pull requests](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

## Commit

[Permalink](/airlift/aircompressor/commit/15e68df9eb0c2bfde7f796231ee7cd1982965071)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix out of bounds read due to negative length

[Browse files](/airlift/aircompressor/tree/15e68df9eb0c2bfde7f796231ee7cd1982965071)
Browse the repository at this point in the history

```
If the computed literal or match length was greater than
Integer.MAX_VALUE, the value would overflow to a negative
and cause a read before the beginning of the buffer.
```

* Loading branch information

[![@martint](https://avatars.githubusercontent.com/u/14387?s=40&v=4)](/martint)

[martint](/airlift/aircompressor/commits?author=martint "View all commits by martint")
committed
Feb 13, 2024

1 parent
[99de82a](/airlift/aircompressor/commit/99de82a53a539cca07ddc918e60d0cb089b52941)

commit 15e68df

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**224 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + main/java/io/airlift/compress

    - lz4

      * src/main/java/io/airlift/compress/lz4/Lz4RawDecompressor.java
        [Lz4RawDecompressor.java](#diff-a1bfbc3f0a7bb8944e0a40d0e52dd5279743a1cc1a07dbde150c4b5293f5547e)
    - lzo

      * src/main/java/io/airlift/compress/lzo/LzoRawDecompressor.java
        [LzoRawDecompressor.java](#diff-3587c38eb9a49ecf1c59f750f8959c0949523e5cbf0e54b0249cc03831820b3e)
    - snappy

      * src/main/java/io/airlift/compress/snappy/SnappyRawDecompressor.java
        [SnappyRawDecompressor.java](#diff-0f21f8a92a79ed8a784b45920479066ccd13ea8d0acc50e46bf3726584028eb3)
    - zstd

      * src/main/java/io/airlift/compress/zstd/Huffman.java
        [Huffman.java](#diff-1eee57122ff7c45b73237a8c4e0422bff5ee3f16f73b905e9987152caf2ff9d5)
  + test/java/io/airlift/compress

    - lz4

      * src/test/java/io/airlift/compress/lz4/TestLz4.java
        [TestLz4.java](#diff-bcfd901e58e1da5ee942c299bb8d2732b69f20e023c0dbc62782321fe82e1c9b)
    - lzo

      * src/test/java/io/airlift/compress/lzo/TestLzo.java
        [TestLzo.java](#diff-f66ddebf6b0af5472d2974548d9d433e1d829bbd132cfc9ea766f2fdb460c715)
    - snappy

      * src/test/java/io/airlift/compress/snappy/TestSnappy.java
        [TestSnappy.java](#diff-4c009097f6f545c0c7a9fafde9dd843020063cf164d7a1f6418a7623c0cda9e9)
    - zstd

      * src/test/java/io/airlift/compress/zstd/TestZstd.java
        [TestZstd.java](#diff-a8cad9b49cbcea1b5a4d6e45ebf8667f756af2f3a86a76952f0b47ce34e5e3ee)

## There are no files selected for viewing

6 changes: 6 additions & 0 deletions

6
[src/main/java/io/airlift/compress/lz4/Lz4RawDecompressor.java](#diff-a1bfbc3f0a7bb8944e0a40d0e52dd5279743a1cc1a07dbde150c4b5293f5547e "src/main/java/io/airlift/compress/lz4/Lz4RawDecompressor.java")

Show comments

[View file](/airlift/aircompressor/blob/15e68df9eb0c2bfde7f796231ee7cd1982965071/src/main/java/io/airlift/compress/lz4/Lz4RawDecompressor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -69,6 +69,9 @@ public static int decompress( |
|  |  | } |
|  |  | while (value == 255 && input < inputLimit - 15); |
|  |  | } |
|  |  | if (literalLength < 0) { |
|  |  | throw new MalformedInputException(input - inputAddress); |
|  |  | } |
|  |  |  |
|  |  | // copy literal |
|  |  | long literalEnd = input + literalLength; |
| Expand Down  Expand Up | | @@ -127,6 +130,9 @@ public static int decompress( |
|  |  | while (value == 255); |
|  |  | } |
|  |  | matchLength += MIN\_MATCH; // implicit length from initial 4-byte match in encoder |
|  |  | if (matchLength < 0) { |
|  |  | throw new MalformedInputException(input - inputAddress); |
|  |  | } |
|  |  |  |
|  |  | long matchOutputLimit = output + matchLength; |
|  |  |  |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[src/main/java/io/airlift/compress/lzo/LzoRawDecompressor.java](#diff-3587c38eb9a49ecf1c59f750f8959c0949523e5cbf0e54b0249cc03831820b3e "src/main/java/io/airlift/compress/lzo/LzoRawDecompressor.java")

Show comments

[View file](/airlift/aircompressor/blob/15e68df9eb0c2bfde7f796231ee7cd1982965071/src/main/java/io/airlift/compress/lzo/LzoRawDecompressor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -248,6 +248,10 @@ else if ((command & 0b1100\_0000) != 0) { |
|  |  | } |
|  |  | firstCommand = false; |
|  |  |  |
|  |  | if (matchLength < 0) { |
|  |  | throw new MalformedInputException(input - inputAddress); |
|  |  | } |
|  |  |  |
|  |  | // copy match |
|  |  | if (matchLength != 0) { |
|  |  | // lzo encodes match offset minus one |
| Expand Down  Expand Up | | @@ -316,6 +320,9 @@ else if ((command & 0b1100\_0000) != 0) { |
|  |  | } |
|  |  |  |
|  |  | // copy literal |
|  |  | if (literalLength < 0) { |
|  |  | throw new MalformedInputException(input - inputAddress); |
|  |  | } |
|  |  | long literalOutputLimit = output + literalLength; |
|  |  | if (literalOutputLimit > fastOutputLimit || input + literalLength > inputLimit - SIZE\_OF\_LONG) { |
|  |  | if (literalOutputLimit > outputLimit) { |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[src/main/java/io/airlift/compress/snappy/SnappyRawDecompressor.java](#diff-0f21f8a92a79ed8a784b45920479066ccd13ea8d0acc50e46bf3726584028eb3 "src/main/java/io/airlift/compress/snappy/SnappyRawDecompressor.java")

Show comments

[View file](/airlift/aircompressor/blob/15e68df9eb0c2bfde7f796231ee7cd1982965071/src/main/java/io/airlift/compress/snappy/SnappyRawDecompressor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -116,6 +116,9 @@ private static int uncompressAll( |
|  |  |  |
|  |  | if ((opCode & 0x3) == LITERAL) { |
|  |  | int literalLength = length + trailer; |
|  |  | if (literalLength < 0) { |
|  |  | throw new MalformedInputException(input - inputAddress); |
|  |  | } |
|  |  |  |
|  |  | // copy literal |
|  |  | long literalOutputLimit = output + literalLength; |
| Expand Down  Expand Up | | @@ -147,6 +150,9 @@ private static int uncompressAll( |
|  |  | // bit 8). |
|  |  | int matchOffset = entry & 0x700; |
|  |  | matchOffset += trailer; |
|  |  | if (matchOffset < 0) { |
|  |  | throw new MalformedInputException(input - inputAddress); |
|  |  | } |
|  |  |  |
|  |  | long matchAddress = output - matchOffset; |
|  |  | if (matchAddress < outputAddress || output + length > outputLimit) { |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[src/main/java/io/airlift/compress/zstd/Huffman.java](#diff-1eee57122ff7c45b73237a8c4e0422bff5ee3f16f73b905e9987152caf2ff9d5 "src/main/java/io/airlift/compress/zstd/Huffman.java")

Show comments

[View file](/airlift/aircompressor/blob/15e68df9eb0c2bfde7f796231ee7cd1982965071/src/main/java/io/airlift/compress/zstd/Huffman.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -172,6 +172,8 @@ public void decode4Streams(final Object inputBase, final long inputAddress, fina |
|  |  | long start3 = start2 + (UNSAFE.getShort(inputBase, inputAddress + 2) & 0xFFFF); |
|  |  | long start4 = start3 + (UNSAFE.getShort(inputBase, inputAddress + 4) & 0xFFFF); |
|  |  |  |
|  |  | verify(start2 < start3 && start3 < start4 && start4 < inputLimit, inputAddress, "Input is corrupted"); |
|  |  |  |
|  |  | BitInputStream.Initializer initializer = new BitInputStream.Initializer(inputBase, start1, start2); |
|  |  | initializer.initialize(); |
|  |  | int stream1bitsConsumed = initializer.getBitsConsumed(); |
| Expand Down | |  |

49 changes: 49 additions & 0 deletions

49
[src/test/java/io/airlift/compress/lz4/TestLz4.java](#diff-bcfd901e58e1da5ee942c299bb8d2732b69f20e023c0dbc62782321fe82e1c9b "src/test/java/io/airlift/compress/lz4/TestLz4.java")

Show comments

[View file](/airlift/aircompressor/blob/15e68df9eb0c2bfde7f796231ee7cd1982965071/src/test/java/io/airlift/compress/lz4/TestLz4.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,9 +16,17 @@ |
|  |  | import io.airlift.compress.AbstractTestCompression; |
|  |  | import io.airlift.compress.Compressor; |
|  |  | import io.airlift.compress.Decompressor; |
|  |  | import io.airlift.compress.MalformedInputException; |
|  |  | import io.airlift.compress.thirdparty.JPountzLz4Compressor; |
|  |  | import io.airlift.compress.thirdparty.JPountzLz4Decompressor; |
|  |  | import net.jpountz.lz4.LZ4Factory; |
|  |  | import org.testng.annotations.Test; |
|  |  |  |
|  |  | import java.io.ByteArrayOutputStream; |
|  |  | import java.io.IOException; |
|  |  | import java.util.Arrays; |
|  |  |  |
|  |  | import static org.assertj.core.api.Assertions.assertThatThrownBy; |
|  |  |  |
|  |  | public class TestLz4 |
|  |  | extends AbstractTestCompression |
| Expand Down  Expand Up | | @@ -46,4 +54,45 @@ protected Decompressor getVerifyDecompressor() |
|  |  | { |
|  |  | return new JPountzLz4Decompressor(LZ4Factory.fastestInstance()); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testLiteralLengthOverflow() |
|  |  | throws IOException |
|  |  | { |
|  |  | ByteArrayOutputStream buffer = new ByteArrayOutputStream(); |
|  |  | buffer.write((byte) 0b1111\_0000); // token |
|  |  | // Causes overflow for `literalLength` |
|  |  | byte[] literalLengthBytes = new byte[Integer.MAX\_VALUE / 255 + 1]; // ~9MB |
|  |  | Arrays.fill(literalLengthBytes, (byte) 255); |
|  |  | buffer.write(literalLengthBytes); |
|  |  | buffer.write(1); |
|  |  | buffer.write(new byte[20]); |
|  |  |  |
|  |  | byte[] data = buffer.toByteArray(); |
|  |  |  |
|  |  | assertThatThrownBy(() -> new Lz4Decompressor().decompress(data, 0, data.length, new byte[2048], 0, 2048)) |
|  |  | .isInstanceOf(MalformedInputException.class); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testMatchLengthOverflow() |
|  |  | throws IOException |
|  |  | { |
|  |  | ByteArrayOutputStream buffer = new ByteArrayOutputStream(); |
|  |  | buffer.write((byte) 0b0000\_1111); // token |
|  |  | buffer.write(new byte[2]); // offset |
|  |  |  |
|  |  | // Causes overflow for `matchLength` |
|  |  | byte[] literalLengthBytes = new byte[Integer.MAX\_VALUE / 255 + 1]; // ~9MB |
|  |  | Arrays.fill(literalLengthBytes, (byte) 255); |
|  |  | buffer.write(literalLengthBytes); |
|  |  | buffer.write(1); |
|  |  |  |
|  |  | buffer.write(new byte[10]); |
|  |  |  |
|  |  | byte[] data = buffer.toByteArray(); |
|  |  |  |
|  |  | assertThatThrownBy(() -> new Lz4Decompressor().decompress(data, 0, data.length, new byte[2048], 0, 2048)) |
|  |  | .isInstanceOf(MalformedInputException.class); |
|  |  | } |
|  |  | } |

81 changes: 81 additions & 0 deletions

81
[src/test/java/io/airlift/compress/lzo/TestLzo.java](#diff-f66ddebf6b0af5472d2974548d9d433e1d829bbd132cfc9ea766f2fdb460c715 "src/test/java/io/airlift/compress/lzo/TestLzo.java")

Show comments

[View file](/airlift/aircompressor/blob/15e68df9eb0c2bfde7f796231ee7cd1982965071/src/test/java/io/airlift/compress/lzo/TestLzo.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,8 +17,15 @@ |
|  |  | import io.airlift.compress.Compressor; |
|  |  | import io.airlift.compress.Decompressor; |
|  |  | import io.airlift.compress.HadoopNative; |
|  |  | import io.airlift.compress.MalformedInputException; |
|  |  | import io.airlift.compress.thirdparty.HadoopLzoCompressor; |
|  |  | import io.airlift.compress.thirdparty.HadoopLzoDecompressor; |
|  |  | import org.testng.annotations.Test; |
|  |  |  |
|  |  | import java.io.ByteArrayOutputStream; |
|  |  | import java.io.IOException; |
|  |  |  |
|  |  | import static org.assertj.core.api.Assertions.assertThatThrownBy; |
|  |  |  |
|  |  | public class TestLzo |
|  |  | extends AbstractTestCompression |
| Expand Down  Expand Up | | @@ -50,4 +57,78 @@ protected Decompressor getVerifyDecompressor() |
|  |  | { |
|  |  | return new HadoopLzoDecompressor(); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testLiteralLengthOverflow() |
|  |  | throws IOException |
|  |  | { |
|  |  | ByteArrayOutputStream buffer = new ByteArrayOutputStream(); |
|  |  | // Command |
|  |  | buffer.write(0); |
|  |  | // Causes overflow for `literalLength` |
|  |  | buffer.write(new byte[Integer.MAX\_VALUE / 255 + 1]); // ~9MB |
|  |  | buffer.write(1); |
|  |  |  |
|  |  | byte[] data = buffer.toByteArray(); |
|  |  |  |
|  |  | assertThatThrownBy(() -> new LzoDecompressor().decompress(data, 0, data.length, new byte[20000], 0, 20000)) |
|  |  | .isInstanceOf(MalformedInputException.class); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testMatchLengthOverflow1() |
|  |  | throws IOException |
|  |  | { |
|  |  | ByteArrayOutputStream buffer = new ByteArrayOutputStream(); |
|  |  | // Write some data so that `matchOffset` validation later passes |
|  |  | // Command |
|  |  | buffer.write(0); |
|  |  | buffer.write(new byte[66]); |
|  |  | buffer.write(8); |
|  |  | buffer.write(new byte[2107 \* 8]); |
|  |  |  |
|  |  | // Command |
|  |  | buffer.write(0b001\_0000); |
|  |  | // Causes overflow for `matchLength` |
|  |  | buffer.write(new byte[Integer.MAX\_VALUE / 255 + 1]); // ~9MB |
|  |  | buffer.write(1); |
|  |  | // Trailer |
|  |  | buffer.write(0b0000\_0000); |
|  |  | buffer.write(0b0000\_0100); |
|  |  |  |
|  |  | buffer.write(new byte[10]); |
|  |  |  |
|  |  | byte[] data = buffer.toByteArray(); |
|  |  |  |
|  |  | assertThatThrownBy(() -> new LzoDecompressor().decompress(data, 0, data.length, new byte[20000], 0, 20000)) |
|  |  | .isInstanceOf(MalformedInputException.class); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testMatchLengthOverflow2() |
|  |  | throws IOException |
|  |  | { |
|  |  | ByteArrayOutputStream buffer = new ByteArrayOutputStream(); |
|  |  | // Write some data so that `matchOffset` validation later passes |
|  |  | // Command |
|  |  | buffer.write(0); |
|  |  | buffer.write(246); |
|  |  | buffer.write(new byte[264]); |
|  |  |  |
|  |  | // Command |
|  |  | buffer.write(0b0010\_0000); |
|  |  | // Causes overflow for `matchLength` |
|  |  | buffer.write(new byte[Integer.MAX\_VALUE / 255 + 1]); // ~9MB |
|  |  | buffer.write(1); |
|  |  | // Trailer |
|  |  | buffer.write(0b0000\_0000); |
|  |  | buffer.write(0b0000\_0100); |
|  |  |  |
|  |  | buffer.write(new byte[10]); |
|  |  |  |
|  |  | byte[] data = buffer.toByteArray(); |
|  |  |  |
|  |  | assertThatThrownBy(() -> new LzoDecompressor().decompress(data, 0, data.length, new byte[20000], 0, 20000)) |
|  |  | .isInstanceOf(MalformedInputException.class); |
|  |  | } |
|  |  | } |

22 changes: 22 additions & 0 deletions

22
[src/test/java/io/airlift/compress/snappy/TestSnappy.java](#diff-4c009097f6f545c0c7a9fafde9dd843020063cf164d7a1f6418a7623c0cda9e9 "src/test/java/io/airlift/compress/snappy/TestSnappy.java")

Show comments

[View file](/airlift/aircompressor/blob/15e68df9eb0c2bfde7f796231ee7cd1982965071/src/test/java/io/airlift/compress/snappy/TestSnappy.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,8 +16,12 @@ |
|  |  | import io.airlift.compress.AbstractTestCompression; |
|  |  | import io.airlift.compress.Compressor; |
|  |  | import io.airlift.compress.Decompressor; |
|  |  | import io.airlift.compress.MalformedInputException; |
|  |  | import io.airlift.compress.thirdparty.XerialSnappyCompressor; |
|  |  | import io.airlift.compress.thirdparty.XerialSnappyDecompressor; |
|  |  | import org.testng.annotations.Test; |
|  |  |  |
|  |  | import static org.assertj.core.api.Assertions.assertThatThrownBy; |
|  |  |  |
|  |  | public class TestSnappy |
|  |  | extends AbstractTestCompression |
| Expand Down  Expand Up | | @@ -45,4 +49,22 @@ protected Decompressor getVerifyDecompressor() |
|  |  | { |
|  |  | return new XerialSnappyDecompressor(); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testInvalidLiteralLength() |
|  |  | { |
|  |  | byte[] data = { |
|  |  | // Encoded uncompressed length 1024 |
|  |  | -128, 8, |
|  |  | // op-code |
|  |  | (byte) 252, |
|  |  | // Trailer value Integer.MAX\_VALUE |
|  |  | (byte) 0b1111\_1111, (byte) 0b1111\_1111, (byte) 0b1111\_1111, (byte) 0b0111\_1111, |
|  |  | // Some arbitrary data |
|  |  | 0, 0, 0, 0, 0, 0, 0, 0 |
|  |  | }; |
|  |  |  |
|  |  | assertThatThrownBy(() -> new SnappyDecompressor().decompress(data, 0, data.length, new byte[1024], 0, 1024)) |
|  |  | .isInstanceOf(MalformedInputException.class); |
|  |  | } |
|  |  | } |

51 changes: 51 additions & 0 deletions

51
[src/test/java/io/airlift/compress/zstd/TestZstd.java](#diff-a8cad9b49cbcea1b5a4d6e45ebf8667f756af2f3a86a76952f0b47ce34e5e3ee "src/test/java/io/airlift/compress/zstd/TestZstd.java")

Show comments

[View file](/airlift/aircompressor/blob/15e68df9eb0c2bfde7f796231ee7cd1982965071/src/test/java/io/airlift/compress/zstd/TestZstd.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,6 +23,7 @@ |
|  |  | import io.airlift.compress.thirdparty.ZstdJniDecompressor; |
|  |  | import org.testng.annotations.Test; |
|  |  |  |
|  |  | import java.io.ByteArrayOutputStream; |
|  |  | import java.io.IOException; |
|  |  | import java.io.UncheckedIOException; |
|  |  | import java.util.Arrays; |
| Expand Down  Expand Up | | @@ -209,4 +210,54 @@ public void testDecompressIsMissingData() |
|  |  | .matches(e -> e instanceof MalformedInputException || e instanceof UncheckedIOException) |
|  |  | .hasMessageContaining("Not enough input bytes"); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testBadHuffmanData() |
|  |  | throws IOException |
|  |  | { |
|  |  | ByteArrayOutputStream buffer = new ByteArrayOutputStream(); |
|  |  | // Magic |
|  |  | buffer.write(new byte[] { |
|  |  | (byte) 0b0010\_1000, |
|  |  | (byte) 0b1011\_0101, |
|  |  | (byte) 0b0010\_1111, |
|  |  | (byte) 0b1111\_1101, |
|  |  | }); |
|  |  | // Frame header |
|  |  | buffer.write(0); |
|  |  | buffer.write(0); |
|  |  | // Block header COMPRESSED\_BLOCK |
|  |  | buffer.write(new byte[] { |
|  |  | (byte) 0b1111\_0100, |
|  |  | (byte) 0b0000\_0000, |
|  |  | (byte) 0b0000\_0000, |
|  |  | }); |
|  |  | // Literals header |
|  |  | buffer.write(new byte[] { |
|  |  | // literalsBlockType COMPRESSED\_LITERALS\_BLOCK |
|  |  | // + literals type |
|  |  | 0b0000\_1010, |
|  |  | // ... header remainder |
|  |  | 0b0000\_0000, |
|  |  | // compressedSize |
|  |  | 0b0011\_1100, |
|  |  | 0b0000\_0000, |
|  |  | }); |
|  |  | // Huffman inputSize |
|  |  | buffer.write(128); |
|  |  | // weight value |
|  |  | buffer.write(0b0001\_0000); |
|  |  | // Bad start values |
|  |  | buffer.write(new byte[] {(byte) 255, (byte) 255}); |
|  |  | buffer.write(new byte[] {(byte) 255, (byte) 255}); |
|  |  | buffer.write(new byte[] {(byte) 255, (byte) 255}); |
|  |  |  |
|  |  | buffer.write(new byte[10]); |
|  |  |  |
|  |  | byte[] data = buffer.toByteArray(); |
|  |  |  |
|  |  | assertThatThrownBy(() -> new ZstdDecompressor().decompress(data, 0, data.length, new byte[10], 0, 10)) |
|  |  | .isInstanceOf(MalformedInputException.class) |
|  |  | .hasMessageStartingWith("Input is corrupted"); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `15e68df`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2F15e68df9eb0c2bfde7f796231ee7cd1982965071) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f23e69ad_20250111_193816.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2F2cea90a45534f9aacbb77426fb64e975504dee6e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2F2cea90a45534f9aacbb77426fb64e975504dee6e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=airlift%2Faircompressor)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[airlift](/airlift)
/
**[aircompressor](/airlift/aircompressor)**
Public

* [Notifications](/login?return_to=%2Fairlift%2Faircompressor) You must be signed in to change notification settings
* [Fork
  116](/login?return_to=%2Fairlift%2Faircompressor)
* [Star
   588](/login?return_to=%2Fairlift%2Faircompressor)

* [Code](/airlift/aircompressor)
* [Issues
  17](/airlift/aircompressor/issues)
* [Pull requests
  4](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects
  0](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

Additional navigation options

* [Code](/airlift/aircompressor)
* [Issues](/airlift/aircompressor/issues)
* [Pull requests](/airlift/aircompressor/pulls)
* [Actions](/airlift/aircompressor/actions)
* [Projects](/airlift/aircompressor/projects)
* [Wiki](/airlift/aircompressor/wiki)
* [Security](/airlift/aircompressor/security)
* [Insights](/airlift/aircompressor/pulse)

## Commit

[Permalink](/airlift/aircompressor/commit/2cea90a45534f9aacbb77426fb64e975504dee6e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Verify length is positive

[Browse files](/airlift/aircompressor/tree/2cea90a45534f9aacbb77426fb64e975504dee6e)
Browse the repository at this point in the history

* Loading branch information

[![@martint](https://avatars.githubusercontent.com/u/14387?s=40&v=4)](/martint)

[martint](/airlift/aircompressor/commits?author=martint "View all commits by martint")
committed
Feb 13, 2024

1 parent
[15e68df](/airlift/aircompressor/commit/15e68df9eb0c2bfde7f796231ee7cd1982965071)

commit 2cea90a

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**13 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + main/java/io/airlift/compress/snappy

    - src/main/java/io/airlift/compress/snappy/SnappyRawDecompressor.java
      [SnappyRawDecompressor.java](#diff-0f21f8a92a79ed8a784b45920479066ccd13ea8d0acc50e46bf3726584028eb3)
  + test/java/io/airlift/compress/snappy

    - src/test/java/io/airlift/compress/snappy/TestSnappy.java
      [TestSnappy.java](#diff-4c009097f6f545c0c7a9fafde9dd843020063cf164d7a1f6418a7623c0cda9e9)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[src/main/java/io/airlift/compress/snappy/SnappyRawDecompressor.java](#diff-0f21f8a92a79ed8a784b45920479066ccd13ea8d0acc50e46bf3726584028eb3 "src/main/java/io/airlift/compress/snappy/SnappyRawDecompressor.java")

Show comments

[View file](/airlift/aircompressor/blob/2cea90a45534f9aacbb77426fb64e975504dee6e/src/main/java/io/airlift/compress/snappy/SnappyRawDecompressor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -306,6 +306,9 @@ static int[] readUncompressedLength(Object compressed, long compressedAddress, l |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | if (result < 0) { |
|  |  | throw new MalformedInputException(compressedAddress, "negative compressed length"); |
|  |  | } |
|  |  | return new int[] {result, bytesRead}; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

10 changes: 10 additions & 0 deletions

10
[src/test/java/io/airlift/compress/snappy/TestSnappy.java](#diff-4c009097f6f545c0c7a9fafde9dd843020063cf164d7a1f6418a7623c0cda9e9 "src/test/java/io/airlift/compress/snappy/TestSnappy.java")

Show comments

[View file](/airlift/aircompressor/blob/2cea90a45534f9aacbb77426fb64e975504dee6e/src/test/java/io/airlift/compress/snappy/TestSnappy.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -67,4 +67,14 @@ public void testInvalidLiteralLength() |
|  |  | assertThatThrownBy(() -> new SnappyDecompressor().decompress(data, 0, data.length, new byte[1024], 0, 1024)) |
|  |  | .isInstanceOf(MalformedInputException.class); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testNegativeLength() |
|  |  | { |
|  |  | byte[] data = {(byte) 255, (byte) 255, (byte) 255, (byte) 255, 0b0000\_1000}; |
|  |  |  |
|  |  | assertThatThrownBy(() -> SnappyDecompressor.getUncompressedLength(data, 0)) |
|  |  | .isInstanceOf(MalformedInputException.class) |
|  |  | .hasMessageStartingWith("negative compressed length"); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2cea90a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairlift%2Faircompressor%2Fcommit%2F2cea90a45534f9aacbb77426fb64e975504dee6e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


