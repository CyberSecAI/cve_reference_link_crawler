

[![Humanativa](https://security.humanativaspa.it/sec/wp-content/themes/master-am/images/hn-security-logo.png)](https://security.humanativaspa.it/)

* + [Home](https://security.humanativaspa.it/ "Home")
  + [About Us](https://security.humanativaspa.it/#aboutus "About Us")
  + [Services](https://security.humanativaspa.it/#services "Services")
  + [Blog](https://security.humanativaspa.it/category/news/ "Blog")

Contacts

### Contacts

If you're looking to fortify your security and take your defenses to the next level, contact us at info@hnsecurity.it to explore how HN Security can help safeguard your digital assets.

Posted on [5 March 2024](https://security.humanativaspa.it/multiple-vulnerabilities-in-rt-thread-rtos/) Marco Ivaldi
### Multiple vulnerabilities in RT-Thread RTOS

> *“Security is in the mind of the programmer and in the mind of the designer.*
>
> *Not so much in the code.”*
>
> *— Alisa Esage*

### Summary

Welcome to another episode in [my journey](https://security.humanativaspa.it/ost2-zephyr-rtos-and-a-bunch-of-cves/) as a glorified static analysis tool for real-time operating systems!

This time, our target of choice is [RT-Thread](https://www.rt-thread.io/), an open-source, community-based **real-time operating system (RTOS)**. RT-Thread can be used in sensing nodes, wireless connection chips, and many other resource-constrained scenarios. It is also widely applied in gateways, IPC, smart speakers, and other high-performance **IoT applications**.

I reviewed RT-Thread’s [source code](https://github.com/RT-Thread/rt-thread) hosted on GitHub and identified multiple **security vulnerabilities** that may cause memory corruption and security feature bypass. Their impacts range from **denial of service** to potential **arbitrary code execution**.

During the source code review I also audited the [lwIP](https://savannah.nongnu.org/projects/lwip/) and [TinyDir](https://github.com/cxong/tinydir) codebases on which some RT-Thread functionalities depend, and found [some](https://git.savannah.nongnu.org/cgit/lwip.git/commit/?id=ee1523630a81fffa6b7d93dd0c7a6191de5856cd) [additional](https://git.savannah.nongnu.org/cgit/lwip.git/commit/?id=b413b040936f48d4cd9ed632ac579542c710efae) [vulnerabilities](https://github.com/cxong/tinydir/security/advisories/GHSA-jf5r-wgf4-qhxf) that were subsequently fixed by the respective maintainers.

My detailed **advisories** are available here:

* <https://github.com/hnsecurity/vulns/blob/main/HNS-2024-05-rt-thread.txt>
* <https://github.com/hnsecurity/vulns/blob/main/HNS-2023-04-tinydir.txt>

### Background

After my [recent vulnerability disclosures](https://security.humanativaspa.it/ost2-zephyr-rtos-and-a-bunch-of-cves/), I decided to keep assisting open-source projects in the IoT space in finding and fixing security vulnerabilities by **reviewing their source code**. RT-Thread was selected as a target of interest. Other RTOSes will be featured in future [advisories](https://github.com/hnsecurity/vulns) and writeups. So, [stay tuned](https://security.humanativaspa.it/tag/iot/).

During this review, I made use of my [Semgrep C/C++ ruleset](https://security.humanativaspa.it/semgrep-ruleset-for-c-c-vulnerability-research/) to identify hotspots in code on which to focus my attention. I also took advantage of this opportunity to [improve and update](https://security.humanativaspa.it/big-update-to-my-semgrep-c-cpp-ruleset/) the ruleset.

### Vulnerabilities

The **vulnerabilities** resulting from my source code review are:

* [CVE-2024-24335](https://github.com/RT-Thread/rt-thread/issues/8271) – Buffer overflow in RT-Thread dfs\_v2 romfs filesystem
* [CVE-2024-24334](https://github.com/RT-Thread/rt-thread/issues/8282) – Heap buffer overflows in RT-Thread dfs\_v2 dfs\_file
* [CVE-2024-25389](https://github.com/RT-Thread/rt-thread/issues/8283) – Weak random source in RT-Thread rt\_random driver
* [CVE-2024-25388](https://github.com/RT-Thread/rt-thread/issues/8285) – Heap buffer overflow in RT-Thread wlan driver
* [CVE-2024-25390](https://github.com/RT-Thread/rt-thread/issues/8286) – Heap buffer overflows in RT-Thread finsh
* [CVE-2024-25391](https://github.com/RT-Thread/rt-thread/issues/8287) – Stack buffer overflow in RT-Thread IPC
* [CVE-2024-25393](https://github.com/RT-Thread/rt-thread/issues/8288) – Stack buffer overflow in RT-Thread AT server
* [CVE-2024-25395](https://github.com/RT-Thread/rt-thread/issues/8289) – Static buffer overflow in RT-Thread rt-link utility
* [CVE-2024-25392](https://github.com/RT-Thread/rt-thread/issues/8290) – Out-of-bounds static array access in RT-Thread var\_export utility
* [CVE-2024-25394](https://github.com/RT-Thread/rt-thread/issues/8291) – Multiple vulnerabilities in RT-Thread ymodem utility
* Use of [outdated](https://git.savannah.nongnu.org/cgit/lwip.git/commit/?id=ee1523630a81fffa6b7d93dd0c7a6191de5856cd) [lwIP](https://git.savannah.nongnu.org/cgit/lwip.git/commit/?id=b413b040936f48d4cd9ed632ac579542c710efae) and [TinyDir](https://github.com/hnsecurity/vulns/blob/main/HNS-2023-04-tinydir.txt) dependencies in RT-Thread

For additional information about these **vulnerabilities** and their **fixes**, please refer to the detailed [advisory](https://github.com/hnsecurity/vulns/blob/main/HNS-2024-05-rt-thread.txt).

Since a few months, I’ve started to consistently keep track of my research efforts using the excellent [Be Focused](https://xwavesoft.com/be-focused-pro-for-iphone-ipad-mac-os-x.html) pomodoro timer app. Therefore, I know that it took me about **32 hours** to complete this project (not including the time spent for the disclosure process).

![](https://security.humanativaspa.it/sec/wp-content/uploads/2024/01/Screenshot-2024-01-27-at-11.09.29.png)

A nice graph that shows I was busy dealing with other stuff between September and October

### Disclosure and fixes

I reported the vulnerabilities discussed in this article to RT-Thread in November 2023, by opening [issues](https://github.com/search?o=desc&q=author%3A0xdea+rt-thread&s=created&type=issues) on GitHub [as directed](https://github.com/RT-Thread/rt-thread/issues/8250) by the maintainers. Following my [request](https://www.cve.org/ReportRequest/ReportRequestForNonCNAs), MITRE assigned **CVE IDs** to all vulnerabilities in February 2024.

RT-Thread developers have fixed some of the vulnerabilities discussed in this advisory. However, some of the reported vulnerabilities are still open. Even though not all vulnerabilities were fixed, I decided to go ahead with public disclosure after about 90 days since the initial reports. This decision was taken mainly based on the fact that the **vulnerability reports were already publicly accessible** as GitHub issues.

The detailed coordinated disclosure **timeline** follows:

* 2023-11-12: Asked on GitHub how to report potential security issues.
* 2023-11-13: RT-Thread founder replied to open issues directly on GitHub.
* 2023-11-20: Opened the first issue on GitHub.
* 2023-11-24: First vulnerability fixed; reported some other vulnerabilities.
* 2023-11-28: Second (and third) vulnerability fixed.
* 2023-12-24: Asked maintainers for updates.
* 2024-01-17: Requested the first batch of CVE IDs from MITRE.
* 2024-01-26: Informed maintainers of plan to publish advisory in February.
* 2024-02-02: Requested the second batch of CVE IDs from MITRE.
* 2024-02-07: CVE IDs for all reported vulnerabilities assigned by MITRE.
* 2024-02-08: Communicated CVE IDs and new 2024-03-05 publication date.
* 2024-02-18: Maintainers acknowledge publication date and inform about new fixes.
* 2024-03-05: Published advisory and writeup.

Please check the official RT-Thread channels for further information about fixes.

### Acknowledgments

I would like to thank RT-Thread, lwIP, and TinyDir developers for the time dedicated to triaging the reported vulnerabilities. I would also like to thank MITRE for assigning CVE IDs upon my request.

### Plug

You should submit an article to [Phrack](http://phrack.org/)! Clicky-clicky 🧑‍💻

> You should write an article for Phrack #71 !! I hear it's coming out by summer time. 👀
>
> Let's open the windows and get some phresh air back into the scene.
>
> If you've got a story to tell, you should send it in by April 1st and keep the vibe going. 🙂<https://t.co/Zc77uUWgvR> [pic.twitter.com/Q44xnCkug0](https://t.co/Q44xnCkug0)
>
> — Battle Programmer Yuu (@netspooky) [January 11, 2024](https://twitter.com/netspooky/status/1745260034966126946?ref_src=twsrc%5Etfw)

# Blog Categories * [Articles](https://security.humanativaspa.it/category/articles/) * [Events](https://security.humanativaspa.it/category/events/) * [Exploits](https://security.humanativaspa.it/category/exploits/) * [News](https://security.humanativaspa.it/category/news/) * [Servizi](https://security.humanativaspa.it/category/servizi/) * [Tools](https://security.humanativaspa.it/category/tools/) * [Vulnerabilities](https://security.humanativaspa.it/category/vulnerabilities/)

## Tags

[0day](https://security.humanativaspa.it/tag/0day/%20)
[active directory](https://security.humanativaspa.it/tag/active-directory/%20)
[advisory](https://security.humanativaspa.it/tag/advisory/%20)
[analytics](https://security.humanativaspa.it/tag/analytics/%20)
[android](https://security.humanativaspa.it/tag/android/%20)
[apache](https://security.humanativaspa.it/tag/apache/%20)
[ARM](https://security.humanativaspa.it/tag/arm/%20)
[assemblies](https://security.humanativaspa.it/tag/assemblies/%20)
[atdcm64a](https://security.humanativaspa.it/tag/atdcm64a/%20)
[attacks](https://security.humanativaspa.it/tag/attacks/%20)
[authentication](https://security.humanativaspa.it/tag/authentication/%20)
[azure rtos](https://security.humanativaspa.it/tag/azure-rtos/%20)
[bindiff](https://security.humanativaspa.it/tag/bindiff/%20)
[brida](https://security.humanativaspa.it/tag/brida/%20)
[Burp Suite](https://security.humanativaspa.it/tag/burp-suite/%20)
[Bus Pirate](https://security.humanativaspa.it/tag/bus-pirate/%20)
[business](https://security.humanativaspa.it/tag/business/%20)
[BUSSide](https://security.humanativaspa.it/tag/busside/%20)
[c/c++](https://security.humanativaspa.it/tag/c-c/%20)
[c2](https://security.humanativaspa.it/tag/c2/%20)
[code review](https://security.humanativaspa.it/tag/code-review/%20)
[cracking](https://security.humanativaspa.it/tag/cracking/%20)
[cve-2021-22205](https://security.humanativaspa.it/tag/cve-2021-22205/%20)
[CVE-2022-0342](https://security.humanativaspa.it/tag/cve-2022-0342/%20)
[CVE-2022-2030](https://security.humanativaspa.it/tag/cve-2022-2030/%20)
[cve-2022-26531](https://security.humanativaspa.it/tag/cve-2022-26531/%20)
[cve-2022-26532](https://security.humanativaspa.it/tag/cve-2022-26532/%20)
[cve-2022-46285](https://security.humanativaspa.it/tag/cve-2022-46285/%20)
[cve-2023-24039](https://security.humanativaspa.it/tag/cve-2023-24039/%20)
[cve-2023-24040](https://security.humanativaspa.it/tag/cve-2023-24040/%20)
[DevSecCon](https://security.humanativaspa.it/tag/devseccon/%20)
[disassembly](https://security.humanativaspa.it/tag/disassembly/%20)
[dll](https://security.humanativaspa.it/tag/dll/%20)
[dynamic analysis](https://security.humanativaspa.it/tag/dynamic-analysis/%20)
[EL](https://security.humanativaspa.it/tag/el/%20)
[EL Injection](https://security.humanativaspa.it/tag/el-injection/%20)
[exploit](https://security.humanativaspa.it/tag/exploit/%20)
[exploit development](https://security.humanativaspa.it/tag/exploit-development/%20)
[Extender](https://security.humanativaspa.it/tag/extender/%20)
[Extender course](https://security.humanativaspa.it/tag/extender-course/%20)
[Extending Burp Suite](https://security.humanativaspa.it/tag/extending-burp-suite/%20)
[fault injection](https://security.humanativaspa.it/tag/fault-injection/%20)
[firmware](https://security.humanativaspa.it/tag/firmware/%20)
[foreverday](https://security.humanativaspa.it/tag/foreverday/%20)
[format string](https://security.humanativaspa.it/tag/format-string/%20)
[frida](https://security.humanativaspa.it/tag/frida/%20)
[ghidra](https://security.humanativaspa.it/tag/ghidra/%20)
[ghidra2frida](https://security.humanativaspa.it/tag/ghidra2frida/%20)
[gitlab](https://security.humanativaspa.it/tag/gitlab/%20)
[golang](https://security.humanativaspa.it/tag/golang/%20)
[groovy](https://security.humanativaspa.it/tag/groovy/%20)
[Hack In Paris](https://security.humanativaspa.it/tag/hack-in-paris/%20)
[hacking](https://security.humanativaspa.it/tag/hacking/%20)
[HackRF](https://security.humanativaspa.it/tag/hackrf/%20)
[hardware](https://security.humanativaspa.it/tag/hardware/%20)
[hn security](https://security.humanativaspa.it/tag/hn-security/%20)
[I2C](https://security.humanativaspa.it/tag/i2c/%20)
[ida](https://security.humanativaspa.it/tag/ida/%20)
[incident response](https://security.humanativaspa.it/tag/incident-response/%20)
[infiltrate](https://security.humanativaspa.it/tag/infiltrate/%20)
[Instrumentation](https://security.humanativaspa.it/tag/instrumentation/%20)
[interview](https://security.humanativaspa.it/tag/interview/%20)
[iOS](https://security.humanativaspa.it/tag/ios/%20)
[iot](https://security.humanativaspa.it/tag/iot/%20)
[Java](https://security.humanativaspa.it/tag/java/%20)
[Java Applet](https://security.humanativaspa.it/tag/java-applet/%20)
[Java Deserialization Scanner](https://security.humanativaspa.it/tag/java-deserialization-scanner/%20)
[Java Serialization](https://security.humanativaspa.it/tag/java-serialization/%20)
[Keil](https://security.humanativaspa.it/tag/keil/%20)
[keycloak](https://security.humanativaspa.it/tag/keycloak/%20)
[kotlin](https://security.humanativaspa.it/tag/kotlin/%20)
[log4j](https://security.humanativaspa.it/tag/log4j/%20)
[maven](https://security.humanativaspa.it/tag/maven/%20)
[metasploit](https://security.humanativaspa.it/tag/metasploit/%20)
[meterpreter](https://security.humanativaspa.it/tag/meterpreter/%20)
[mimikatz](https://security.humanativaspa.it/tag/mimikatz/%20)
[minidump](https://security.humanativaspa.it/tag/minidump/%20)
[mips](https://security.humanativaspa.it/tag/mips/%20)
[mobile](https://security.humanativaspa.it/tag/mobile/%20)
[Montoya API](https://security.humanativaspa.it/tag/montoya-api/%20)
[offensive security](https://security.humanativaspa.it/tag/offensive-security/%20)
[oldschool](https://security.humanativaspa.it/tag/oldschool/%20)
[open source](https://security.humanativaspa.it/tag/open-source/%20)
[OpenSSH](https://security.humanativaspa.it/tag/openssh/%20)
[passwords](https://security.humanativaspa.it/tag/passwords/%20)
[penetration test](https://security.humanativaspa.it/tag/penetration-test/%20)
[pentest](https://security.humanativaspa.it/tag/pentest/%20)
[php](https://security.humanativaspa.it/tag/php/%20)
[Phrack](https://security.humanativaspa.it/tag/phrack/%20)
[podcast](https://security.humanativaspa.it/tag/podcast/%20)
[pom.xml](https://security.humanativaspa.it/tag/pom-xml/%20)
[protobuf](https://security.humanativaspa.it/tag/protobuf/%20)
[pseudocode](https://security.humanativaspa.it/tag/pseudocode/%20)
[radio](https://security.humanativaspa.it/tag/radio/%20)
[ransomware](https://security.humanativaspa.it/tag/ransomware/%20)
[RCE](https://security.humanativaspa.it/tag/rce/%20)
[red teaming](https://security.humanativaspa.it/tag/red-teaming/%20)
[research](https://security.humanativaspa.it/tag/research/%20)
[reverse engineering](https://security.humanativaspa.it/tag/reverse-engineering/%20)
[riot](https://security.humanativaspa.it/tag/riot/%20)
[romhack](https://security.humanativaspa.it/tag/romhack/%20)
[rt-thread](https://security.humanativaspa.it/tag/rt-thread/%20)
[rust](https://security.humanativaspa.it/tag/rust/%20)
[saleae](https://security.humanativaspa.it/tag/saleae/%20)
[Security Manager](https://security.humanativaspa.it/tag/security-manager/%20)
[seemposium](https://security.humanativaspa.it/tag/seemposium/%20)
[semgrep](https://security.humanativaspa.it/tag/semgrep/%20)
[Serialization](https://security.humanativaspa.it/tag/serialization/%20)
[shellcode](https://security.humanativaspa.it/tag/shellcode/%20)
[single sign-on](https://security.humanativaspa.it/tag/single-sign-on/%20)
[sliver](https://security.humanativaspa.it/tag/sliver/%20)
[solaris](https://security.humanativaspa.it/tag/solaris/%20)
[source code analysis](https://security.humanativaspa.it/tag/source-code-analysis/%20)
[sparc](https://security.humanativaspa.it/tag/sparc/%20)
[static analysis](https://security.humanativaspa.it/tag/static-analysis/%20)
[statistics](https://security.humanativaspa.it/tag/statistics/%20)
[tactical exploitation](https://security.humanativaspa.it/tag/tactical-exploitation/%20)
[Template Injection](https://security.humanativaspa.it/tag/template-injection/%20)
[threadx](https://security.humanativaspa.it/tag/threadx/%20)
[threat intelligence](https://security.humanativaspa.it/tag/threat-intelligence/%20)
[Tutorial](https://security.humanativaspa.it/tag/tutorial/%20)
[UART](https://security.humanativaspa.it/tag/uart/%20)
[Universal Radio Hacker](https://security.humanativaspa.it/tag/universal-radio-hacker/%20)
[vulnerability research](https://security.humanativaspa.it/tag/vulnerability-research/%20)
[web](https://security.humanativaspa.it/tag/web/%20)
[weggli](https://security.humanativaspa.it/tag/weggli/%20)
[whitebox](https://security.humanativaspa.it/tag/whitebox/%20)
[windows](https://security.humanativaspa.it/tag/windows/%20)
[x86](https://security.humanativaspa.it/tag/x86/%20)
[xamarin](https://security.humanativaspa.it/tag/xamarin/%20)
[yii](https://security.humanativaspa.it/tag/yii/%20)
[ysoserial](https://security.humanativaspa.it/tag/ysoserial/%20)
[zephyr](https://security.humanativaspa.it/tag/zephyr/%20)
[zyxel](https://security.humanativaspa.it/tag/zyxel/%20)

## Post navigation

[Previous: Seemposium Podcast interview](https://security.humanativaspa.it/seemposium-podcast-interview/)[Next: Frida on Java applications and applets in 2024](https://security.humanativaspa.it/frida-on-java-applets-in-2024/)

###### Legal and Administrative

Viale Oceano Pacifico, 66

00144 Rome (Italy)

###### [www.humanativaspa.it](https://humanativaspa.it)

Copyright © 2021-2025 HN Security S.r.l.

[Privacy Policy](https://humanativaspa.it/en/privacy-policy/)

We use cookies on our website to give you the most relevant experience by remembering your preferences and repeat visits. By clicking “Accept”, you consent to the use of ALL the cookies.Cookie settingsACCEPTManage consent

Close

#### Privacy Overview

This website uses cookies to improve your experience while you navigate through the website. Out of these, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities of the website. We also use third-party cookies that help us analyze and understand how you use this website. These cookies will be stored in your browser only with your consent. You also have the option to opt-out of these cookies. But opting out of some of these cookies may affect your browsing experience.

Necessary

Necessary

Always Enabled

Necessary cookies are absolutely essential for the website to function properly. These cookies ensure basic functionalities and security features of the website, anonymously.

| Cookie | Duration | Description |
| --- | --- | --- |
| cookielawinfo-checbox-analytics | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Analytics". |
| cookielawinfo-checbox-functional | 11 months | The cookie is set by GDPR cookie consent to record the user consent for the cookies in the category "Functional". |
| cookielawinfo-checbox-others | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Other. |
| cookielawinfo-checkbox-necessary | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookies is used to store the user consent for the cookies in the category "Necessary". |
| cookielawinfo-checkbox-performance | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Performance". |
| viewed\_cookie\_policy | 11 months | The cookie is set by the GDPR Cookie Consent plugin and is used to store whether or not user has consented to the use of cookies. It does not store any personal data. |

Functional

Functional

Functional cookies help to perform certain functionalities like sharing the content of the website on social media platforms, collect feedbacks, and other third-party features.

Performance

Performance

Performance cookies are used to understand and analyze the key performance indexes of the website which helps in delivering a better user experience for the visitors.

Analytics

Analytics

Analytical cookies are used to understand how visitors interact with the website. These cookies help provide information on metrics the number of visitors, bounce rate, traffic source, etc.

Advertisement

Advertisement

Advertisement cookies are used to provide visitors with relevant ads and marketing campaigns. These cookies track visitors across websites and collect information to provide customized ads.

Others

Others

Other uncategorized cookies are those that are being analyzed and have not been classified into a category as yet.

SAVE & ACCEPT

