```
{
  "vulnerability": {
    "root_cause": "The devmap code allocates hash buckets based on the next power of two of the max_entries. On 32-bit architectures, the rounding up calculation can overflow due to a left-shift of 32 bits on an unsigned long, resulting in undefined behavior and an incorrect number of buckets. The overflow check was done *after* the calculation, checking for a 0 value which isn't reliable because of the undefined behavior.",
    "weaknesses": [
      "Integer Overflow",
      "Undefined Behavior",
      "Improper Input Validation"
    ],
    "impact": "A crash can occur due to the incorrect hash table size when trying to update the map.",
    "attack_vectors": "Creating a BPF DEVMAP_HASH map with a max_entries value greater than 0x80000000, which leads to an overflow in the number of buckets calculation. Subsequently, attempting to update the map triggers the crash.",
     "required_attacker_capabilities": "The attacker needs to be able to create and update BPF maps, specifically DEVMAP_HASH maps, and have control over the max_entries value to trigger the overflow. This typically requires some level of privilege or access to the BPF subsystem."
  }
}
```