- **Root cause of vulnerability:** The "Remove approvals by Code Owners if their files changed" setting does not reset approvals when the target branch of a merge request is changed, unlike the "Remove all approvals" setting.
- **Weaknesses/vulnerabilities present:** Inconsistent behavior between different approval settings when the target branch is changed. Specifically, the "Remove approvals by Code Owners if their files changed" setting fails to remove approvals when the target branch of a merge request is changed, violating the expected behavior and stated behavior for similar settings.
- **Impact of exploitation:** A user could obtain approvals for merging changes into a test or feature branch. Subsequently, they could change the target branch to a protected branch and bypass the approval process. This would result in unauthorized code changes being merged into protected branches.
- **Attack vectors:** The attack vector is through the GitLab UI by changing the target branch of a merge request that has approvals.
- **Required attacker capabilities/position:** An attacker needs to be a user with permission to create merge requests and change their target branch within a GitLab project with the described configuration. The attacker also needs to have an understanding of how approvals are removed or retained for different settings and different actions in merge requests.