- **Root cause of vulnerability:** The application does not invalidate the magic sign-in link after it has been used, leading to session fixation.
- **Weaknesses/vulnerabilities present:** Session fixation vulnerability. Specifically, the access token is overwritten when an authenticated user clicks another magic sign-in link. The same session is shared with the attacker because the magic sign-in link is not invalidated after it is used.
- **Impact of exploitation:** An attacker can steal sensitive information by tricking the victim into clicking a crafted magic sign-in link, allowing the attacker to take over the victim's session.
- **Attack vectors:** The attacker obtains a valid magic sign-in link and tricks the victim into clicking on it.
- **Required attacker capabilities/position:** The attacker needs to be able to obtain a magic sign-in link (by logging in with email) and send it to the victim. The attacker does not need to have prior access to the victim's account.