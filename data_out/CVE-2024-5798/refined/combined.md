=== Content from discuss.hashicorp.com_cbd04e60_20250111_092940.html ===


[HashiCorp Discuss](/)

# [HCSEC-2024-11 - Vault Incorrectly Validated JSON Web Tokens (JWT) Audience Claims](/t/hcsec-2024-11-vault-incorrectly-validated-json-web-tokens-jwt-audience-claims/67770)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[mark.collao](https://discuss.hashicorp.com/u/mark.collao)

June 12, 2024, 6:47pm

1

**Bulletin ID:** HCSEC-2024-11

**Affected Products / Versions:** Vault and Vault Enterprise 0.11.0 up to 1.16.2; fixed in Vault and Vault Enterprise 1.17.0, 1.16.3, 1.15.9.

**Publication Date:** June 12, 2024

**Summary**

Vault and Vault Enterprise did not properly validate the JSON Web Token (JWT) role-bound audience claim when using the Vault JWT auth method. This may have resulted in Vault validating a JWT with audience and role-bound claims that do not match, allowing an invalid login to succeed when it should have been rejected.

This vulnerability, CVE-2024-5798, was fixed in Vault and Vault Enterprise 1.17.0, 1.16.3, and 1.15.9

**Background**

The JWT auth method can be used to authenticate with Vault using OIDC or by providing a JWT. More information on the JWT auth method can be found at [JWT/OIDC - Auth Methods | Vault | HashiCorp Developer](https://developer.hashicorp.com/vault/docs/auth/jwt).

**Details**

A bug existed in the JWT auth method where Vault would only apply the validation logic if the audience claim was a single string. This bug was an implementation error of RFC 7518, where the audience claim can be a single string or set of strings.

When Vault encountered an audience claim as a list of strings, it would skip the validation logic meant to check the existence of role bound audience claims against the audience claims. As a result, Vault would continue with other JWT validations and if successful, the JWT payload provided would be verified and may be used to log in to an underlying system.

**Remediation**

Customers using the JWT auth method configured in their Vault installation should evaluate the risk associated with this issue and consider upgrading to Vault 1.17.0, 1.16.3, 1.15.9 or newer. Please refer to [Upgrading Vault](https://learn.hashicorp.com/tutorials/vault/sop-upgrade?in=vault/standard-procedures) for general guidance and version-specific upgrade notes.

Upgrading Vault to the fixed versions also may break existing JWT auth method deployments. Please refer to the [1.17.x upgrade guide](https://developer.hashicorp.com/vault/docs/upgrading/upgrade-to-1.17.x#jwt-auth-login-requires-bound-audiences-on-the-role) for more information.

**Acknowledgement**

This issue was identified by Kacper Stysiński and Alex Scheel.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-07 - Vault TLS Cert Auth Method Did Not Correctly Validate OCSP Responses](https://discuss.hashicorp.com/t/hcsec-2024-07-vault-tls-cert-auth-method-did-not-correctly-validate-ocsp-responses/64573)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4985 | April 4, 2024 |
| [HCSEC-2024-05 - Vault Cert Auth Method Did Not Correctly Validate Non-CA Certificates](https://discuss.hashicorp.com/t/hcsec-2024-05-vault-cert-auth-method-did-not-correctly-validate-non-ca-certificates/63382)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 9293 | March 4, 2024 |
| [HCSEC-2020-16 - Vault’s AWS Auth Method Allows Authentication Bypass](https://discuss.hashicorp.com/t/hcsec-2020-16-vault-s-aws-auth-method-allows-authentication-bypass/18101)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4360 | November 25, 2020 |
| [HCSEC-2020-17 - Vault’s GCP Auth Method Allows Authentication Bypass](https://discuss.hashicorp.com/t/hcsec-2020-17-vault-s-gcp-auth-method-allows-authentication-bypass/18102)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4196 | November 25, 2020 |
| [Vault & GitLab CI integration using JWT](https://discuss.hashicorp.com/t/vault-gitlab-ci-integration-using-jwt/63079)  [Vault](/c/vault/30) [vault](https://discuss.hashicorp.com/tag/vault) | 2 | 395 | February 24, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


