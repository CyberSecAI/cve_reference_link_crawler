

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=56185434e1e50acecee56d8f5850135009b87947)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=56185434e1e50acecee56d8f5850135009b87947)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=56185434e1e50acecee56d8f5850135009b87947)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=56185434e1e50acecee56d8f5850135009b87947)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pavel Skripkin <paskripkin@gmail.com> | 2022-02-20 19:01:14 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-16 14:26:40 +0100 |
| commit | [56185434e1e50acecee56d8f5850135009b87947](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=56185434e1e50acecee56d8f5850135009b87947) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=56185434e1e50acecee56d8f5850135009b87947)) | |
| tree | [c3d5870246044766398065b55e0aad737a9105fe](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=56185434e1e50acecee56d8f5850135009b87947) | |
| parent | [ec7332452d905e546bde5ad0f48515c551717828](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ec7332452d905e546bde5ad0f48515c551717828) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=56185434e1e50acecee56d8f5850135009b87947&id2=ec7332452d905e546bde5ad0f48515c551717828)) | |
| download | [linux-56185434e1e50acecee56d8f5850135009b87947.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-56185434e1e50acecee56d8f5850135009b87947.tar.gz) | |

HID: hid-thrustmaster: fix OOB read in thrustmaster\_interrupts[ Upstream commit fc3ef2e3297b3c0e2006b5d7b3d66965e3392036 ]
Syzbot reported an slab-out-of-bounds Read in thrustmaster\_probe() bug.
The root case is in missing validation check of actual number of endpoints.
Code should not blindly access usb\_host\_interface::endpoint array, since
it may contain less endpoints than code expects.
Fix it by adding missing validaion check and print an error if
number of endpoints do not match expected number
Fixes: c49c33637802 ("HID: support for initialization of some Thrustmaster wheels")
Reported-and-tested-by: syzbot+35eebd505e97d315d01c@syzkaller.appspotmail.com
Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>
Signed-off-by: Jiri Kosina <jkosina@suse.cz>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=56185434e1e50acecee56d8f5850135009b87947)

| -rw-r--r-- | [drivers/hid/hid-thrustmaster.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/hid/hid-thrustmaster.c?id=56185434e1e50acecee56d8f5850135009b87947) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/drivers/hid/hid-thrustmaster.c b/drivers/hid/hid-thrustmaster.cindex 03b935ff02d561..9da4240530dd73 100644--- a/[drivers/hid/hid-thrustmaster.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/hid/hid-thrustmaster.c?id=ec7332452d905e546bde5ad0f48515c551717828)+++ b/[drivers/hid/hid-thrustmaster.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/hid/hid-thrustmaster.c?id=56185434e1e50acecee56d8f5850135009b87947)@@ -158,6 +158,12 @@ static void thrustmaster\_interrupts(struct hid\_device \*hdev) return; } + if (usbif->cur\_altsetting->desc.bNumEndpoints < 2) {+ kfree(send\_buf);+ hid\_err(hdev, "Wrong number of endpoints?\n");+ return;+ }+ ep = &usbif->cur\_altsetting->endpoint[1]; b\_ep = ep->desc.bEndpointAddress; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 13:45:15 +0000

