Based on the provided content, here's the breakdown of the vulnerability:

**CVE ID:** CVE-2024-1051

**Root Cause:**
The vulnerability stems from insufficient input sanitization and output escaping within the 'List category posts' WordPress plugin. Specifically, the plugin's 'catlist' shortcode does not properly handle user-supplied attributes like 'title_tag'.

**Weaknesses/Vulnerabilities:**
- **Stored Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS. This occurs because the plugin allows users to inject arbitrary web scripts through the 'title_tag' attribute. The injected script is then stored in the database and executed when a user accesses the affected page.
- **Insufficient Input Sanitization:** The plugin fails to adequately sanitize user input before using it in the HTML output.
- **Insufficient Output Escaping:** The plugin doesn't properly escape the user-supplied data, allowing the browser to interpret it as executable code.

**Impact of Exploitation:**
- An attacker can inject malicious JavaScript code into a page, which is then executed in the browsers of users who visit the page.
- This can lead to various malicious actions such as:
    - Stealing user session cookies.
    - Redirecting users to malicious websites.
    - Defacing the website.
    - Performing actions on behalf of the user without their knowledge (if they are logged in).

**Attack Vectors:**
- The attack vector is through the 'catlist' shortcode of the plugin.
- Attackers can exploit the vulnerability by injecting malicious script into the 'title_tag' attribute of the shortcode when creating or editing a page.

**Required Attacker Capabilities/Position:**
- **Authenticated User:** The attacker needs to be an authenticated WordPress user with at least contributor-level permissions. This allows the attacker to create or edit pages/posts.
- **Knowledge of Shortcode:** The attacker needs to be aware of the 'catlist' shortcode and its attributes.

**Technical Details:**

The vulnerability occurs in the `CatListDisplayer.php` file, specifically within the `get_post_title` function.
- The code was using `esc_attr` to sanitize the `title_tag` parameter.
- The fix was to use `tag_escape` instead of `esc_attr` to properly escape HTML tags.
- The `lcp-wrapper.php` was also modified from `esc_attr` to `tag_escape`

```php
// Previous code
$tag = esc_attr($this->params['title_tag']) ?: esc_attr($tag);

// Corrected code
$tag = tag_escape($this->params['title_tag']) ?: tag_escape($tag);
```
```php
// Previous code
$html = '<' . esc_attr($tag) . $props_str . '>' . $content;
if ($close) $html .= '</' . esc_attr($tag) . '>';

// Corrected code
$html = '<' . tag_escape($tag) . $props_str . '>' . $content;
if ($close) $html .= '</' . tag_escape($tag) . '>';
```

**Patch Information:**
- The vulnerability is patched in version 0.89.7 of the plugin.
- The fix includes changes in `lcp-catlistdisplayer.php` and `lcp-wrapper.php` files, replacing `esc_attr` with `tag_escape` for the `title_tag` attribute and HTML tags, to prevent the execution of malicious code injected in `title_tag`.