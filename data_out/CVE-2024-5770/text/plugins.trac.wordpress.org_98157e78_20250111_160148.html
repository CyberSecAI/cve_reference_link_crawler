

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse â†—ï¸](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv â†—ï¸](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp â†—ï¸](https://central.wordcamp.org/)
  + [Meetups â†—ï¸](https://www.meetup.com/pro/wordpress/)
  + [Job Board â†—ï¸](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg â†—ï¸](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store â†—ï¸](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwp-force-ssl%2Ftags%2F1.66%2Fwp-force-ssl.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* â† [Previous Revision](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=2656791 "Revision 2656791")
* [Next Revision](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110 "Revision 3099110") â†’
* [Blame](/browser/wp-force-ssl/trunk/wp-force-ssl.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wp-force-ssl/tags/1.66/wp-force-ssl.php)

---

# [source:](/browser?order=name "Go to repository root") [wp-force-ssl](/browser/wp-force-ssl?order=name "View wp-force-ssl")/[tags](/browser/wp-force-ssl/tags?order=name "View tags")/[1.66](/browser/wp-force-ssl/tags/1.66?order=name "View 1.66")/[wp-force-ssl.php](/browser/wp-force-ssl/tags/1.66/wp-force-ssl.php?order=name "View wp-force-ssl.php")

View diff against:

View revision:

| [Last change](/changeset/3058608/wp-force-ssl/trunk/wp-force-ssl.php "View differences") on this file was [3058608](/changeset/3058608/ "View changeset 3058608"), checked in by WebFactory, [10 months ago](/timeline?from=2024-03-25T20%3A13%3A23Z&precision=second "See timeline at 03/25/2024 08:13:23 PM") |
| --- |
| Minor update |
| **File size:** 49.7 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: WP Force SSL |
| [4](#L4) | Plugin URI: https://wpforcessl.com/ |
| [5](#L5) | Description: Redirect all traffic from HTTP to HTTPS and fix other SSL issues. |
| [6](#L6) | Author: WebFactory Ltd |
| [7](#L7) | Author URI: https://www.webfactoryltd.com/ |
| [8](#L8) | Version: 1.66 |
| [9](#L9) | Text Domain: wp-force-ssl |
| [10](#L10) | Requires at least: 4.6 |
| [11](#L11) | Requires PHP: 5.2 |
| [12](#L12) | Tested up to: 6.5 |
| [13](#L13) |  |
| [14](#L14) | Copyright 2019 - 2024Â  WebFactory LtdÂ  (email: support@webfactoryltd.com) |
| [15](#L15) |  |
| [16](#L16) | This program is free software; you can redistribute it and/or modify |
| [17](#L17) | it under the terms of the GNU General Public License, version 2, as |
| [18](#L18) | published by the Free Software Foundation. |
| [19](#L19) |  |
| [20](#L20) | This program is distributed in the hope that it will be useful, |
| [21](#L21) | but WITHOUT ANY WARRANTY; without even the implied warranty of |
| [22](#L22) | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the |
| [23](#L23) | GNU General Public License for more details. |
| [24](#L24) |  |
| [25](#L25) | You should have received a copy of the GNU General Public License |
| [26](#L26) | along with this program; if not, write to the Free Software |
| [27](#L27) | Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MAÂ  02110-1301Â  USA |
| [28](#L28) | \*/ |
| [29](#L29) |  |
| [30](#L30) |  |
| [31](#L31) | // if the file is called directly |
| [32](#L32) | ifÂ (!defined('ABSPATH'))Â { |
| [33](#L33) | exit('You are not allowed to access this file directly.'); |
| [34](#L34) | } |
| [35](#L35) |  |
| [36](#L36) | require\_onceÂ dirname(\_\_FILE\_\_)Â .Â '/inc/wp-force-ssl-status-tests.php'; |
| [37](#L37) | require\_onceÂ dirname(\_\_FILE\_\_)Â .Â '/inc/wp-force-ssl-utility.php'; |
| [38](#L38) | require\_onceÂ dirname(\_\_FILE\_\_)Â .Â '/wf-flyout/wf-flyout.php'; |
| [39](#L39) | newÂ wf\_flyout(\_\_FILE\_\_); |
| [40](#L40) |  |
| [41](#L41) | define('WPFSSL\_OPTIONS\_KEY',Â 'wpfssl\_options'); |
| [42](#L42) | define('WPFSSL\_META\_KEY',Â 'wpfssl\_meta'); |
| [43](#L43) |  |
| [44](#L44) |  |
| [45](#L45) | // start up the engine |
| [46](#L46) | classÂ wpForceSSL |
| [47](#L47) | { |
| [48](#L48) | protectedÂ staticÂ $instanceÂ =Â false; |
| [49](#L49) | publicÂ $optionsÂ =Â array(); |
| [50](#L50) | publicÂ $versionÂ =Â 0; |
| [51](#L51) | publicÂ $plugin\_urlÂ =Â ''; |
| [52](#L52) | publicÂ $plugin\_dirÂ =Â ''; |
| [53](#L53) | publicÂ $metaÂ =Â array(); |
| [54](#L54) |  |
| [55](#L55) |  |
| [56](#L56) | /\*\* |
| [57](#L57) | \* Check if minimum WP and PHP versions are available |
| [58](#L58) | \* Register all hooks for the plugin |
| [59](#L59) | \* |
| [60](#L60) | \* @since 1.5 |
| [61](#L61) | \* |
| [62](#L62) | \* @return null |
| [63](#L63) | \* |
| [64](#L64) | \*/ |
| [65](#L65) | privateÂ functionÂ \_\_construct() |
| [66](#L66) | { |
| [67](#L67) | $this->get\_plugin\_version(); |
| [68](#L68) |  |
| [69](#L69) | ifÂ (falseÂ ===Â $this->check\_wp\_version(4.6))Â { |
| [70](#L70) | returnÂ false; |
| [71](#L71) | } |
| [72](#L72) |  |
| [73](#L73) | $this->optionsÂ =Â get\_option(WPFSSL\_OPTIONS\_KEY,Â array()); |
| [74](#L74) | $defaultÂ =Â array( |
| [75](#L75) | 'wpfs\_ssl'Â =>Â 'yes', |
| [76](#L76) | 'wpfs\_hsts'Â =>Â 'no', |
| [77](#L77) | 'wpfs\_expect\_ct'Â =>Â 'no', |
| [78](#L78) | 'wpfs\_adminbar\_menu'Â =>Â 'yes', |
| [79](#L79) | 'wpfs\_dashboard\_widget'Â =>Â 'yes' |
| [80](#L80) | ); |
| [81](#L81) | $this->optionsÂ =Â array\_merge($default,Â $this->options); |
| [82](#L82) |  |
| [83](#L83) | $this->plugin\_urlÂ =Â plugin\_dir\_url(\_\_FILE\_\_); |
| [84](#L84) | $this->plugin\_dirÂ =Â plugin\_dir\_path(\_\_FILE\_\_); |
| [85](#L85) | $this->metaÂ =Â $this->get\_meta(); |
| [86](#L86) |  |
| [87](#L87) | ifÂ ($this->options['wpfs\_ssl']Â ==Â 'yes')Â { |
| [88](#L88) | add\_action('template\_redirect',Â array($this,Â 'wpfs\_core')); |
| [89](#L89) | } |
| [90](#L90) | ifÂ ($this->options['wpfs\_hsts']Â ==Â 'yes')Â { |
| [91](#L91) | add\_action('send\_headers',Â array($this,Â 'to\_strict\_transport\_security')); |
| [92](#L92) | } |
| [93](#L93) | ifÂ ($this->options['wpfs\_expect\_ct']Â ==Â 'yes')Â { |
| [94](#L94) | add\_action('send\_headers',Â array($this,Â 'enable\_expect\_ct')); |
| [95](#L95) | } |
| [96](#L96) |  |
| [97](#L97) | add\_action('admin\_menu',Â array($this,Â 'add\_settings\_page')); |
| [98](#L98) | add\_action('admin\_head',Â  array($this,Â 'cleanup\_enqueues'),Â 99999); |
| [99](#L99) | add\_action('wp\_before\_admin\_bar\_render',Â array($this,Â 'admin\_bar')); |
| [100](#L100) | add\_filter('admin\_footer\_text',Â array($this,Â 'admin\_footer\_text')); |
| [101](#L101) | add\_action('admin\_print\_scripts',Â array($this,Â 'remove\_admin\_notices')); |
| [102](#L102) | add\_action('admin\_enqueue\_scripts',Â array($this,Â 'admin\_scripts')); |
| [103](#L103) | add\_action('wp\_dashboard\_setup',Â array($this,Â 'add\_widget')); |
| [104](#L104) |  |
| [105](#L105) | add\_filter('plugin\_action\_links\_'Â .Â plugin\_basename(\_\_FILE\_\_),Â array($this,Â 'plugin\_action\_links')); |
| [106](#L106) | add\_filter('plugin\_row\_meta',Â array($this,Â 'plugin\_meta\_links'),Â 10,Â 2); |
| [107](#L107) |  |
| [108](#L108) | // ajax hooks for the settings, and SSL certificate test |
| [109](#L109) | add\_action('wp\_ajax\_wpfs\_save\_settting',Â array($this,Â 'ajax\_save\_setting')); |
| [110](#L110) | add\_action('wp\_ajax\_wpfs\_test\_ssl',Â array($this,Â 'ajax\_check\_ssl')); |
| [111](#L111) | add\_action('wp\_ajax\_wpfs\_run\_tests',Â array($this,Â 'ajax\_run\_tests')); |
| [112](#L112) | add\_action('wp\_ajax\_wpfs\_dismiss\_notice',Â array($this,Â 'ajax\_dismiss\_notice')); |
| [113](#L113) | }Â // \_\_construct |
| [114](#L114) |  |
| [115](#L115) |  |
| [116](#L116) | /\*\* |
| [117](#L117) | \* Get plugin meta data, create if not existent |
| [118](#L118) | \* |
| [119](#L119) | \* @since 1.5 |
| [120](#L120) | \* |
| [121](#L121) | \* @return array plugin meta |
| [122](#L122) | \* |
| [123](#L123) | \*/ |
| [124](#L124) | publicÂ functionÂ get\_meta() |
| [125](#L125) | { |
| [126](#L126) | $metaÂ =Â get\_option(WPFSSL\_META\_KEY,Â array()); |
| [127](#L127) | $defaultÂ =Â array( |
| [128](#L128) | 'first\_version'Â =>Â $this->get\_plugin\_version(), |
| [129](#L129) | 'first\_install'Â =>Â time(), |
| [130](#L130) | 'hide\_welcome\_pointer'Â =>Â false |
| [131](#L131) | ); |
| [132](#L132) |  |
| [133](#L133) | $metaÂ =Â array\_merge($default,Â $meta); |
| [134](#L134) | ifÂ (sizeof($default)Â !=Â sizeof($meta))Â { |
| [135](#L135) | update\_option(WPFSSL\_META\_KEY,Â $meta); |
| [136](#L136) | } |
| [137](#L137) |  |
| [138](#L138) | returnÂ $meta; |
| [139](#L139) | }Â // get\_meta |
| [140](#L140) |  |
| [141](#L141) |  |
| [142](#L142) | /\*\* |
| [143](#L143) | \* Dismiss notice via AJAX call |
| [144](#L144) | \* |
| [145](#L145) | \* @return null |
| [146](#L146) | \*/ |
| [147](#L147) | functionÂ ajax\_dismiss\_notice() |
| [148](#L148) | { |
| [149](#L149) | check\_ajax\_referer('wpfs\_dismiss\_notice'); |
| [150](#L150) |  |
| [151](#L151) | ifÂ (!current\_user\_can('administrator'))Â { |
| [152](#L152) | wp\_send\_json\_error('You are not allowed to run this action.'); |
| [153](#L153) | } |
| [154](#L154) |  |
| [155](#L155) | $notice\_nameÂ =Â trim(sanitize\_text\_field(@$\_GET['notice\_name'])); |
| [156](#L156) |  |
| [157](#L157) | ifÂ ($notice\_nameÂ !=Â 'welcome')Â { |
| [158](#L158) | wp\_send\_json\_error('Unknown notice'); |
| [159](#L159) | }Â elseÂ { |
| [160](#L160) | $this->meta['hide\_welcome\_pointer']Â =Â true; |
| [161](#L161) | update\_option(WPFSSL\_META\_KEY,Â $this->meta); |
| [162](#L162) | wp\_send\_json\_success(); |
| [163](#L163) | } |
| [164](#L164) | }Â // ajax\_dismiss\_notice |
| [165](#L165) |  |
| [166](#L166) |  |
| [167](#L167) | /\*\* |
| [168](#L168) | \* Get plugin version |
| [169](#L169) | \* |
| [170](#L170) | \* @since 1.5 |
| [171](#L171) | \* |
| [172](#L172) | \* @return string plugin version |
| [173](#L173) | \* |
| [174](#L174) | \*/ |
| [175](#L175) | publicÂ functionÂ get\_plugin\_version() |
| [176](#L176) | { |
| [177](#L177) | $plugin\_dataÂ =Â get\_file\_data(\_\_FILE\_\_,Â array('version'Â =>Â 'Version'),Â 'plugin'); |
| [178](#L178) | $this->versionÂ =Â $plugin\_data['version']; |
| [179](#L179) |  |
| [180](#L180) | returnÂ $plugin\_data['version']; |
| [181](#L181) | }Â // get\_plugin\_version |
| [182](#L182) |  |
| [183](#L183) |  |
| [184](#L184) | /\*\* |
| [185](#L185) | \* Return instance, create if not already existing |
| [186](#L186) | \* |
| [187](#L187) | \* @since 1.5 |
| [188](#L188) | \* |
| [189](#L189) | \* @return object wpForceSLL instance |
| [190](#L190) | \* |
| [191](#L191) | \*/ |
| [192](#L192) | publicÂ staticÂ functionÂ get\_instance() |
| [193](#L193) | { |
| [194](#L194) | ifÂ (falseÂ ==Â is\_a(self::$instance,Â 'wpForceSSL'))Â { |
| [195](#L195) | self::$instanceÂ =Â newÂ self; |
| [196](#L196) | } |
| [197](#L197) |  |
| [198](#L198) | returnÂ self::$instance; |
| [199](#L199) | }Â // get\_instance |
| [200](#L200) |  |
| [201](#L201) |  |
| [202](#L202) | /\*\* |
| [203](#L203) | \* Run websites tests |
| [204](#L204) | \* |
| [205](#L205) | \* @return null |
| [206](#L206) | \*/ |
| [207](#L207) | functionÂ ajax\_run\_tests() |
| [208](#L208) | { |
| [209](#L209) | globalÂ $wp\_force\_ssl\_tests; |
| [210](#L210) |  |
| [211](#L211) | check\_ajax\_referer('run\_tests\_nonce\_action'); |
| [212](#L212) | ifÂ (!current\_user\_can('administrator'))Â { |
| [213](#L213) | wp\_send\_json\_error('You are not allowed to run this action.'); |
| [214](#L214) | } |
| [215](#L215) |  |
| [216](#L216) | ifÂ (isset($\_REQUEST['force'])Â &&Â (bool)Â $\_REQUEST['force']Â ===Â true)Â { |
| [217](#L217) | $nocacheÂ =Â true; |
| [218](#L218) | }Â elseÂ { |
| [219](#L219) | $nocacheÂ =Â false; |
| [220](#L220) | } |
| [221](#L221) |  |
| [222](#L222) | $resÂ =Â $wp\_force\_ssl\_tests->get\_tests\_results($nocache); |
| [223](#L223) | ifÂ (is\_wp\_error($res))Â { |
| [224](#L224) | wp\_send\_json\_error($res->get\_error\_message()); |
| [225](#L225) | }Â elseÂ { |
| [226](#L226) | wp\_send\_json\_success($res); |
| [227](#L227) | } |
| [228](#L228) | }Â // ajax\_run\_tool |
| [229](#L229) |  |
| [230](#L230) |  |
| [231](#L231) | /\*\* |
| [232](#L232) | \* Enqueue admin scripts |
| [233](#L233) | \* |
| [234](#L234) | \* @since 1.5 |
| [235](#L235) | \* |
| [236](#L236) | \* @return null |
| [237](#L237) | \* |
| [238](#L238) | \*/ |
| [239](#L239) | publicÂ functionÂ admin\_scripts($hook) |
| [240](#L240) | { |
| [241](#L241) | $metaÂ =Â $this->get\_meta(); |
| [242](#L242) | $pointersÂ =Â array(); |
| [243](#L243) |  |
| [244](#L244) | ifÂ (!$meta['hide\_welcome\_pointer']Â &&Â !$this->is\_plugin\_page()Â &&Â current\_user\_can('administrator'))Â { |
| [245](#L245) | $pointers['\_nonce\_dismiss\_pointer']Â =Â wp\_create\_nonce('wpfs\_dismiss\_notice'); |
| [246](#L246) | $pointers['welcome']Â =Â array('target'Â =>Â '#menu-settings',Â 'edge'Â =>Â 'left',Â 'align'Â =>Â 'right',Â 'content'Â =>Â 'Thank you for installing the <b style="font-weight: 800;">WP Force SSL</b> plugin!<br>Open <a href="'Â .Â admin\_url('options-general.php?page=wpfs-settings')Â .Â '">Settings - WP Force SSL</a> to access SSL settings.'); |
| [247](#L247) |  |
| [248](#L248) | wp\_enqueue\_style('wp-pointer'); |
| [249](#L249) |  |
| [250](#L250) | wp\_enqueue\_script('wp-force-ssl-pointers',Â $this->plugin\_urlÂ .Â 'js/wpfs-pointers.js',Â array('jquery'),Â $this->version,Â true); |
| [251](#L251) | wp\_enqueue\_script('wp-pointer'); |
| [252](#L252) | wp\_localize\_script('wp-pointer',Â 'wp\_force\_ssl\_pointers',Â $pointers); |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | ifÂ (falseÂ ==Â $this->is\_plugin\_page())Â { |
| [256](#L256) | return; |
| [257](#L257) | } |
| [258](#L258) |  |
| [259](#L259) | wp\_enqueue\_style('wpfs-style',Â $this->plugin\_urlÂ .Â 'css/wpfs-style.css',Â null,Â $this->version); |
| [260](#L260) | wp\_enqueue\_style('wpfs-sweetalert2-style',Â $this->plugin\_urlÂ .Â 'css/sweetalert2.min.css',Â null,Â $this->version); |
| [261](#L261) | wp\_enqueue\_style('wp-jquery-ui-dialog'); |
| [262](#L262) |  |
| [263](#L263) | wp\_enqueue\_script('jquery-ui-tabs'); |
| [264](#L264) | wp\_enqueue\_script('jquery-ui-core'); |
| [265](#L265) | wp\_enqueue\_script('jquery-ui-position'); |
| [266](#L266) | wp\_enqueue\_script('jquery-ui-dialog'); |
| [267](#L267) |  |
| [268](#L268) | wp\_enqueue\_script('wpfs-sweetalert2',Â $this->plugin\_urlÂ .Â 'js/sweetalert2.min.js',Â array('jquery'),Â $this->version,Â true); |
| [269](#L269) | wp\_enqueue\_script('wpfs-script',Â $this->plugin\_urlÂ .Â 'js/wpfs-script.js',Â array('jquery'),Â $this->version,Â true); |
| [270](#L270) |  |
| [271](#L271) | wp\_localize\_script('wpfs-script',Â 'wpfs',Â array( |
| [272](#L272) | 'ajaxurl'Â =>Â admin\_url('admin-ajax.php'), |
| [273](#L273) | 'loading\_icon\_url'Â =>Â plugins\_url('img/wp-ssl.png',Â \_\_FILE\_\_), |
| [274](#L274) | 'testing'Â =>Â \_\_('Testing. Please wait ...',Â 'wp-force-ssl'), |
| [275](#L275) | 'saving'Â =>Â \_\_('Saving. Please wait ...',Â 'wp-force-ssl'), |
| [276](#L276) | 'test\_success'Â =>Â \_\_('Test Completed Successfully',Â 'wp-force-ssl'), |
| [277](#L277) | 'test\_failed'Â =>Â \_\_('Test Failed',Â 'wp-force-ssl'), |
| [278](#L278) | 'home\_url'Â =>Â get\_home\_url(), |
| [279](#L279) | 'save\_success'Â =>Â \_\_('Settings saved',Â 'wp-force-ssl'), |
| [280](#L280) | 'undocumented\_error'Â =>Â \_\_('An undocumented error has occurred. Please refresh the page and try again.',Â 'wp-force-ssl'), |
| [281](#L281) | 'documented\_error'Â =>Â \_\_('An error has occurred.',Â 'wp-force-ssl'), |
| [282](#L282) | 'nonce\_save\_settings'Â =>Â wp\_create\_nonce('save\_settting\_nonce\_action'), |
| [283](#L283) | 'nonce\_test\_ssl'Â =>Â wp\_create\_nonce('test\_ssl\_nonce\_action'), |
| [284](#L284) | 'nonce\_run\_tests'Â =>Â wp\_create\_nonce('run\_tests\_nonce\_action') |
| [285](#L285) | )); |
| [286](#L286) |  |
| [287](#L287) | $this->cleanup\_enqueues(); |
| [288](#L288) | }Â // admin\_scripts |
| [289](#L289) |  |
| [290](#L290) |  |
| [291](#L291) | /\*\* |
| [292](#L292) | \* Load text domain |
| [293](#L293) | \* |
| [294](#L294) | \* @since 1.5 |
| [295](#L295) | \* |
| [296](#L296) | \* @return null |
| [297](#L297) | \* |
| [298](#L298) | \*/ |
| [299](#L299) | staticÂ functionÂ plugins\_loaded() |
| [300](#L300) | { |
| [301](#L301) | load\_plugin\_textdomain('wp-force-ssl'); |
| [302](#L302) | }Â // plugins\_loaded |
| [303](#L303) |  |
| [304](#L304) |  |
| [305](#L305) | /\*\* |
| [306](#L306) | \* Register menu page |
| [307](#L307) | \* |
| [308](#L308) | \* @since 1.5 |
| [309](#L309) | \* |
| [310](#L310) | \* @return null |
| [311](#L311) | \* |
| [312](#L312) | \*/ |
| [313](#L313) | publicÂ functionÂ add\_settings\_page() |
| [314](#L314) | { |
| [315](#L315) | globalÂ $wp\_force\_ssl\_tests; |
| [316](#L316) | $test\_resultsÂ =Â $wp\_force\_ssl\_tests->count\_statuses(); |
| [317](#L317) |  |
| [318](#L318) | add\_options\_page( |
| [319](#L319) | \_\_('WP Force SSL',Â 'wp-force-ssl'), |
| [320](#L320) | \_\_('WP Force SSL',Â 'wp-force-ssl')Â .Â ($test\_results['fail']Â ?Â sprintf(' <span class="wfssl-failed-tests awaiting-mod">%d</span>',Â $test\_results['fail'])Â :Â ''), |
| [321](#L321) | 'administrator', |
| [322](#L322) | 'wpfs-settings', |
| [323](#L323) | array($this,Â 'settings\_page\_content') |
| [324](#L324) | ); |
| [325](#L325) | }Â // add\_settings\_page |
| [326](#L326) |  |
| [327](#L327) |  |
| [328](#L328) | /\*\* |
| [329](#L329) | \* Shows admin top menu entry |
| [330](#L330) | \* |
| [331](#L331) | \* @since 1.6 |
| [332](#L332) | \* |
| [333](#L333) | \* @return null |
| [334](#L334) | \* |
| [335](#L335) | \*/ |
| [336](#L336) | functionÂ admin\_bar() |
| [337](#L337) | { |
| [338](#L338) | ifÂ (!is\_admin())Â { |
| [339](#L339) | return; |
| [340](#L340) | } |
| [341](#L341) |  |
| [342](#L342) | globalÂ $wp\_admin\_bar,Â $wp\_force\_ssl\_tests; |
| [343](#L343) |  |
| [344](#L344) | $test\_resultsÂ =Â $wp\_force\_ssl\_tests->count\_statuses(); |
| [345](#L345) | $plugin\_nameÂ =Â \_\_('WP Force SSL',Â 'wp-force-ssl'); |
| [346](#L346) | $plugin\_logoÂ =Â esc\_url($this->plugin\_url)Â .Â 'img/wp-force-ssl-icon.png'; |
| [347](#L347) |  |
| [348](#L348) | ifÂ ( |
| [349](#L349) | 'yes'Â !=Â $this->options['wpfs\_adminbar\_menu']Â || |
| [350](#L350) | falseÂ ===Â current\_user\_can('administrator')Â || |
| [351](#L351) | falseÂ ===Â apply\_filters('wp\_force\_ssl\_show\_admin\_bar',Â true) |
| [352](#L352) | )Â { |
| [353](#L353) | return; |
| [354](#L354) | } |
| [355](#L355) |  |
| [356](#L356) | $titleÂ =Â '<div class="wfssl-adminbar-icon" style="display:inline-block;"><img style="height: 22px; padding: 4px; margin-bottom: -10px;Â  filter: invert(1) brightness(1.2) grayscale(1);" src="'Â .Â $plugin\_logoÂ .Â '" alt="'Â .Â $plugin\_nameÂ .Â '" title="'Â .Â $plugin\_nameÂ .Â '"></div> <span class="ab-label">'Â .Â $plugin\_nameÂ .Â '</span>'; |
| [357](#L357) | ifÂ ($test\_results['fail'])Â { |
| [358](#L358) | $titleÂ .=Â sprintf(' <span class="wfssl-failed-tests awaiting-mod" style="display: inline-block;vertical-align: top;box-sizing: border-box;margin: 1px 0 -1px 2px; padding: 0 5px; min-width: 18px;height: 18px; border-radius: 9px;background-color: #d63638; color: #fff; font-size: 11px; line-height: 1.6; text-align: center; z-index: 26;vertical-align: text-bottom;">%d</span>',Â $test\_results['fail']); |
| [359](#L359) | } |
| [360](#L360) |  |
| [361](#L361) | $wp\_admin\_bar->add\_node(array( |
| [362](#L362) | 'id'Â  Â  =>Â 'wfssl-ab', |
| [363](#L363) | 'title'Â =>Â $title, |
| [364](#L364) | 'href'Â  =>Â admin\_url('options-general.php?page=wpfs-settings'), |
| [365](#L365) | 'parent'Â =>Â '', |
| [366](#L366) | )); |
| [367](#L367) |  |
| [368](#L368) | $wp\_admin\_bar->add\_node(array( |
| [369](#L369) | 'id'Â  Â  =>Â 'wfssl-status', |
| [370](#L370) | 'title'Â =>Â 'Status', |
| [371](#L371) | 'href'Â  =>Â admin\_url('options-general.php?page=wpfs-settings#tab\_status'), |
| [372](#L372) | 'parent'Â =>Â 'wfssl-ab' |
| [373](#L373) | )); |
| [374](#L374) |  |
| [375](#L375) | $wp\_admin\_bar->add\_node(array( |
| [376](#L376) | 'id'Â  Â  =>Â 'wfssl-settings', |
| [377](#L377) | 'title'Â =>Â 'Settings', |
| [378](#L378) | 'href'Â  =>Â admin\_url('options-general.php?page=wpfs-settings#tab\_settings'), |
| [379](#L379) | 'parent'Â =>Â 'wfssl-ab' |
| [380](#L380) | )); |
| [381](#L381) |  |
| [382](#L382) | $wp\_admin\_bar->add\_node(array( |
| [383](#L383) | 'id'Â  Â  =>Â 'wfssl-scanner', |
| [384](#L384) | 'title'Â =>Â 'Content Scanner', |
| [385](#L385) | 'href'Â  =>Â admin\_url('options-general.php?page=wpfs-settings#tab\_scanner'), |
| [386](#L386) | 'parent'Â =>Â 'wfssl-ab' |
| [387](#L387) | )); |
| [388](#L388) |  |
| [389](#L389) | $wp\_admin\_bar->add\_node(array( |
| [390](#L390) | 'id'Â  Â  =>Â 'wfssl-snapshots', |
| [391](#L391) | 'title'Â =>Â 'SSL Certificate', |
| [392](#L392) | 'href'Â  =>Â admin\_url('options-general.php?page=wpfs-settings#tab\_ssl'), |
| [393](#L393) | 'parent'Â =>Â 'wfssl-ab' |
| [394](#L394) | )); |
| [395](#L395) | }Â // admin\_bar |
| [396](#L396) |  |
| [397](#L397) |  |
| [398](#L398) | // add widget to dashboard |
| [399](#L399) | functionÂ add\_widget() |
| [400](#L400) | { |
| [401](#L401) | ifÂ (current\_user\_can('administrator')Â &&Â $this->options['wpfs\_dashboard\_widget']Â ==Â 'yes')Â { |
| [402](#L402) | add\_meta\_box('wpfssl\_status',Â 'WP Force SSL Status',Â array($this,Â 'widget\_content'),Â 'dashboard',Â 'side',Â 'high'); |
| [403](#L403) | } |
| [404](#L404) | }Â // add\_widget |
| [405](#L405) |  |
| [406](#L406) |  |
| [407](#L407) | // render dashboard widget |
| [408](#L408) | functionÂ widget\_content() |
| [409](#L409) | { |
| [410](#L410) | globalÂ $wp\_force\_ssl\_tests; |
| [411](#L411) | $widget\_htmlÂ =Â ''; |
| [412](#L412) |  |
| [413](#L413) | $testsÂ =Â $wp\_force\_ssl\_tests->get\_tests\_results(false); |
| [414](#L414) | ifÂ (is\_wp\_error($tests))Â { |
| [415](#L415) | wpForceSSL\_Utility::wp\_kses\_wf('<p>Unable to get test results. Sorry :(<br>Open <a href="'Â .Â admin\_url('options-general.php?page=wpfs-settings#tab\_status')Â .Â '">WP Force SSL</a> plugin to contact support.</p>'); |
| [416](#L416) | return; |
| [417](#L417) | } |
| [418](#L418) |  |
| [419](#L419) | $widget\_htmlÂ .=Â '<style>'; |
| [420](#L420) | $widget\_htmlÂ .=Â '#wpfssl\_status .inside { padding: 0; margin: 0; }'; |
| [421](#L421) | $widget\_htmlÂ .=Â '#wpfssl\_status table td { max-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; border-top: 1px solid #f0f0f1; }'; |
| [422](#L422) | $widget\_htmlÂ .=Â '#wpfssl\_status table { border: none; }'; |
| [423](#L423) | $widget\_htmlÂ .=Â '#wpfssl\_status td .wpfssl-show-hover { color: #dcdcde; display: none; }'; |
| [424](#L424) | $widget\_htmlÂ .=Â '#wpfssl\_status td:hover .wpfssl-show-hover { display: inline; }'; |
| [425](#L425) | $widget\_htmlÂ .=Â '#wpfssl\_status p { padding: 0 12px 12px 12px; }'; |
| [426](#L426) | $widget\_htmlÂ .=Â '#wpfssl\_status .wpfssl-status-fail { border-left: 5px solid #d63638; }'; |
| [427](#L427) | $widget\_htmlÂ .=Â '#wpfssl\_status .wpfssl-status-warning { border-left: 5px solid #ffaa39; }'; |
| [428](#L428) | $widget\_htmlÂ .=Â '#wpfssl\_status .wpfssl-status-pass { border-left: 5px solid #42972d; }'; |
| [429](#L429) | $widget\_htmlÂ .=Â '</style>'; |
| [430](#L430) |  |
| [431](#L431) | $widget\_htmlÂ .=Â '<table class="striped widefat">'; |
| [432](#L432) | forÂ ($iÂ =Â 0;Â $iÂ <Â 7;Â $i++)Â { |
| [433](#L433) | $widget\_htmlÂ .=Â '<tr>'; |
| [434](#L434) | $widget\_htmlÂ .=Â '<td class="wpfssl-status-'Â .Â $tests[$i]['status']Â .Â '">'Â .Â $tests[$i]['title']Â .Â '<span class="wpfssl-show-hover"> | <a href="'Â .Â admin\_url('options-general.php?page=wpfs-settings#tab\_status')Â .Â '">View Details</a></span></td>'; |
| [435](#L435) | $widget\_htmlÂ .=Â '</tr>'; |
| [436](#L436) | }Â // for |
| [437](#L437) | $widget\_htmlÂ .=Â '</table>'; |
| [438](#L438) |  |
| [439](#L439) | $widget\_htmlÂ .=Â '<p>View all <b>'Â .Â sizeof($tests)Â .Â ' tests</b>, detailed test explanations, and how to fix problems in the <a href="'Â .Â admin\_url('options-general.php?page=wpfs-settings#tab\_status')Â .Â '">WP Force SSL</a> plugin settings.</p>'; |
| [440](#L440) |  |
| [441](#L441) | wpForceSSL\_Utility::wp\_kses\_wf($widget\_html); |
| [442](#L442) | }Â // widget\_content |
| [443](#L443) |  |
| [444](#L444) |  |
| [445](#L445) | // fix for aggressive plugins that include their CSS on all pages |
| [446](#L446) | functionÂ cleanup\_enqueues() |
| [447](#L447) | { |
| [448](#L448) | ifÂ (!$this->is\_plugin\_page())Â { |
| [449](#L449) | return; |
| [450](#L450) | } |
| [451](#L451) |  |
| [452](#L452) | wp\_dequeue\_style('uiStyleSheet'); |
| [453](#L453) | wp\_dequeue\_style('wpcufpnAdmin'); |
| [454](#L454) | wp\_dequeue\_style('unifStyleSheet'); |
| [455](#L455) | wp\_dequeue\_style('wpcufpn\_codemirror'); |
| [456](#L456) | wp\_dequeue\_style('wpcufpn\_codemirrorTheme'); |
| [457](#L457) | wp\_dequeue\_style('collapse-admin-css'); |
| [458](#L458) | wp\_dequeue\_style('jquery-ui-css'); |
| [459](#L459) | wp\_dequeue\_style('tribe-common-admin'); |
| [460](#L460) | wp\_dequeue\_style('file-manager\_\_jquery-ui-css'); |
| [461](#L461) | wp\_dequeue\_style('file-manager\_\_jquery-ui-css-theme'); |
| [462](#L462) | wp\_dequeue\_style('wpmegmaps-jqueryui'); |
| [463](#L463) | wp\_dequeue\_style('wp-botwatch-css'); |
| [464](#L464) | wp\_dequeue\_style('njt-filebird-admin'); |
| [465](#L465) | wp\_dequeue\_style('ihc\_jquery-ui.min.css'); |
| [466](#L466) | wp\_dequeue\_style('badgeos-juqery-autocomplete-css'); |
| [467](#L467) | wp\_dequeue\_style('mainwp'); |
| [468](#L468) | wp\_dequeue\_style('mainwp-responsive-layouts'); |
| [469](#L469) | wp\_dequeue\_style('jquery-ui-style'); |
| [470](#L470) | wp\_dequeue\_style('additional\_style'); |
| [471](#L471) | wp\_dequeue\_style('wobd-jqueryui-style'); |
| [472](#L472) | wp\_dequeue\_style('wpdp-style3'); |
| [473](#L473) | wp\_dequeue\_style('jquery\_smoothness\_ui'); |
| [474](#L474) | wp\_dequeue\_style('uap\_main\_admin\_style'); |
| [475](#L475) | wp\_dequeue\_style('uap\_font\_awesome'); |
| [476](#L476) | wp\_dequeue\_style('uap\_jquery-ui.min.css'); |
| [477](#L477) | }Â // cleanup\_enqueues |
| [478](#L478) |  |
| [479](#L479) |  |
| [480](#L480) | /\*\* |
| [481](#L481) | \* Add links to plugin's description in plugins table |
| [482](#L482) | \* |
| [483](#L483) | \* @param arrayÂ  $linksÂ  Initial list of links. |
| [484](#L484) | \* @param string $fileÂ  Â Basename of current plugin. |
| [485](#L485) | \* |
| [486](#L486) | \* @return array |
| [487](#L487) | \*/ |
| [488](#L488) | functionÂ plugin\_meta\_links($links,Â $file) |
| [489](#L489) | { |
| [490](#L490) | ifÂ ($fileÂ !==Â plugin\_basename(\_\_FILE\_\_))Â { |
| [491](#L491) | returnÂ $links; |
| [492](#L492) | } |
| [493](#L493) |  |
| [494](#L494) | $support\_linkÂ =Â '<a target="\_blank" href="https://wordpress.org/support/plugin/wp-force-ssl/" title="Get help">Support</a>'; |
| [495](#L495) | $home\_linkÂ =Â '<a target="\_blank" href="https://wpforcessl.com/?ref=wpfssl-free" title="Plugin Homepage">Plugin Homepage</a>'; |
| [496](#L496) |  |
| [497](#L497) | $links[]Â =Â $support\_link; |
| [498](#L498) | $links[]Â =Â $home\_link; |
| [499](#L499) |  |
| [500](#L500) | returnÂ $links; |
| [501](#L501) | }Â // plugin\_meta\_links |
| [502](#L502) |  |
| [503](#L503) |  |
| [504](#L504) | /\*\* |
| [505](#L505) | \* Add action links to plugins table, left part |
| [506](#L506) | \* |
| [507](#L507) | \* @param arrayÂ  $linksÂ  Initial list of links. |
| [508](#L508) | \* |
| [509](#L509) | \* @return array |
| [510](#L510) | \*/ |
| [511](#L511) | functionÂ plugin\_action\_links($links) |
| [512](#L512) | { |
| [513](#L513) | $settings\_linkÂ =Â '<a href="'Â .Â admin\_url('options-general.php?page=wpfs-settings')Â .Â '" title="Configure SSL settings">Configure SSL</a>'; |
| [514](#L514) | $buy\_linkÂ =Â '<a href="'Â .Â admin\_url('options-general.php?page=wpfs-settings#open-pro-dialog')Â .Â '" title="Buy the PRO version"><b>Buy PRO</b></a>'; |
| [515](#L515) |  |
| [516](#L516) | array\_unshift($links,Â $buy\_link); |
| [517](#L517) | array\_unshift($links,Â $settings\_link); |
| [518](#L518) |  |
| [519](#L519) | returnÂ $links; |
| [520](#L520) | }Â // plugin\_action\_links |
| [521](#L521) |  |
| [522](#L522) |  |
| [523](#L523) | /\*\* |
| [524](#L524) | \* Remove all WP notices on WPSSL page |
| [525](#L525) | \* |
| [526](#L526) | \* @return null |
| [527](#L527) | \*/ |
| [528](#L528) | functionÂ remove\_admin\_notices() |
| [529](#L529) | { |
| [530](#L530) | ifÂ (!$this->is\_plugin\_page())Â { |
| [531](#L531) | returnÂ false; |
| [532](#L532) | } |
| [533](#L533) |  |
| [534](#L534) | globalÂ $wp\_filter; |
| [535](#L535) | unset($wp\_filter['user\_admin\_notices'],Â $wp\_filter['admin\_notices']); |
| [536](#L536) | }Â // remove\_admin\_notices |
| [537](#L537) |  |
| [538](#L538) |  |
| [539](#L539) | /\*\* |
| [540](#L540) | \* Main function for displaying plugin's admin page |
| [541](#L541) | \* |
| [542](#L542) | \* @return null |
| [543](#L543) | \*/ |
| [544](#L544) | functionÂ settings\_page\_content() |
| [545](#L545) | { |
| [546](#L546) | // double check for admin privileges |
| [547](#L547) | ifÂ (!current\_user\_can('administrator'))Â { |
| [548](#L548) | wp\_die('Sorry, you are not allowed to access this page.'); |
| [549](#L549) | } |
| [550](#L550) |  |
| [551](#L551) | echoÂ '<header>'; |
| [552](#L552) | echoÂ '<img id="logo-icon" src="'Â .Â esc\_url($this->plugin\_url)Â .Â 'img/wp-force-ssl-logo.png" title="WP Force SSL" alt="WP Force SSL" />'; |
| [553](#L553) | echoÂ '</header>'; |
| [554](#L554) |  |
| [555](#L555) | echoÂ '<div id="wfssl-notifications">'; |
| [556](#L556) | echoÂ '</div>'; |
| [557](#L557) |  |
| [558](#L558) | echoÂ '<div class="wfssl-container-left">'; |
| [559](#L559) | echoÂ '<div id="wfssl-tabs" class="ui-tabs" style="display: none;">'; |
| [560](#L560) | $tabsÂ =Â array(); |
| [561](#L561) |  |
| [562](#L562) | $tabs[]Â =Â array('id'Â =>Â 'tab\_status',Â 'class'Â =>Â 'wfssl-tab',Â 'label'Â =>Â 'Status',Â 'callback'Â =>Â 'tab\_status'); |
| [563](#L563) | $tabs[]Â =Â array('id'Â =>Â 'tab\_settings',Â 'class'Â =>Â 'wfssl-tab',Â 'label'Â =>Â 'Settings',Â 'callback'Â =>Â 'tab\_settings'); |
| [564](#L564) | $tabs[]Â =Â array('id'Â =>Â 'tab\_scanner',Â 'class'Â =>Â 'wfssl-tab',Â 'label'Â =>Â 'Content Scanner',Â 'callback'Â =>Â 'tab\_scanner'); |
| [565](#L565) | $tabs[]Â =Â array('id'Â =>Â 'tab\_ssl',Â 'class'Â =>Â 'wfssl-tab',Â 'label'Â =>Â 'SSL Certificate',Â 'callback'Â =>Â 'tab\_ssl'); |
| [566](#L566) | $tabs[]Â =Â array('id'Â =>Â 'tab\_support',Â 'class'Â =>Â 'wfssl-tab',Â 'label'Â =>Â 'Support',Â 'callback'Â =>Â 'tab\_support'); |
| [567](#L567) | $tabs[]Â =Â array('id'Â =>Â 'tab\_pro',Â 'class'Â =>Â 'wfssl-tab wfssl-tab-pro',Â 'label'Â =>Â 'PRO',Â 'callback'Â =>Â ''); |
| [568](#L568) |  |
| [569](#L569) | echoÂ '<nav>'; |
| [570](#L570) | echoÂ '<div class="wfssl-container">'; |
| [571](#L571) | echoÂ '<ul class="wfssl-main-tab">'; |
| [572](#L572) | foreachÂ ($tabsÂ asÂ $tab)Â { |
| [573](#L573) | echoÂ '<li id="button-'Â .Â esc\_attr($tab['id'])Â .Â '" class="'Â .Â esc\_attr($tab['class'])Â .Â '"><a href="#'Â .Â esc\_attr($tab['id'])Â .Â '">'Â .Â esc\_attr($tab['label'])Â .Â '</a></li>'; |
| [574](#L574) | } |
| [575](#L575) | echoÂ '</ul>'; |
| [576](#L576) | echoÂ '</div>';Â // container |
| [577](#L577) | echoÂ '</nav>'; |
| [578](#L578) |  |
| [579](#L579) | // tabs |
| [580](#L580) | echoÂ '<div class="wfssl-container">'; |
| [581](#L581) |  |
| [582](#L582) | foreachÂ ($tabsÂ asÂ $tab)Â { |
| [583](#L583) | ifÂ (is\_callable(array($this,Â $tab['callback'])))Â { |
| [584](#L584) | echoÂ '<div id="'Â .Â esc\_attr($tab['id'])Â .Â '" class="wfssl-tab-content">'; |
| [585](#L585) | call\_user\_func(array($this,Â $tab['callback'])); |
| [586](#L586) | echoÂ '</div>'; |
| [587](#L587) | } |
| [588](#L588) | } |
| [589](#L589) |  |
| [590](#L590) | echoÂ '</div>';Â // wfssl-container |
| [591](#L591) | echoÂ '</div>'; |
| [592](#L592) | echoÂ '</div>';Â // wfssl-container-left |
| [593](#L593) |  |
| [594](#L594) | echoÂ '<div class="wfssl-container wfssl-container-right">'; |
| [595](#L595) | echoÂ '<div class="sidebar-box pro-ad-box"> |
| [596](#L596) | <p class="text-center"><a href="https://wpforcessl.com/?ref=wpfssl-free-sidebar-box" target="\_blank"> |
| [597](#L597) | <img src="'Â .Â esc\_url($this->plugin\_url)Â .Â 'img/wp-force-ssl-logo.png" alt="WP Force SSL PRO" title="WP Force SSL PRO"></a><br><b>PRO version</b> is here! Grab the launch discount - <b>all prices are LIFETIME!</b></p> |
| [598](#L598) | <ul class="plain-list"> |
| [599](#L599) | <li>15+ Options to Fine-Tune Your SSL</li> |
| [600](#L600) | <li>Mixed Content Scanner + Fixer</li> |
| [601](#L601) | <li>Real-Time SSL &amp; Site monitoring (via our SaaS)</li> |
| [602](#L602) | <li>Generate &amp; Install Free SSL Certificate</li> |
| [603](#L603) | <li>Licenses &amp; Sites Manager (remote SaaS dashboard)</li> |
| [604](#L604) | <li>White-label Mode + Complete Codeless Plugin Rebranding</li> |
| [605](#L605) | <li>Email support from plugin developers</li> |
| [606](#L606) | </ul> |
| [607](#L607) |  |
| [608](#L608) | <p class="text-center"><a href="#" class="open-pro-dialog button button-buy" data-pro-feature="sidebar-box">Get PRO Now</a></p> |
| [609](#L609) | </div>'; |
| [610](#L610) | echoÂ '<div class="sidebar-box" style="margin-top: 35px;"> |
| [611](#L611) | <p>Please <a href="https://wordpress.org/support/plugin/wp-force-ssl/reviews/#new-post" target="\_blank">rate the plugin â˜…â˜…â˜…â˜…â˜…</a> to <b>keep it up-to-date &amp; maintained</b>. It only takes a second to rate. Thank you! ğŸ‘‹</p> |
| [612](#L612) | </div>'; |
| [613](#L613) | echoÂ '</div>';Â // wfssl-container-right |
| [614](#L614) |  |
| [615](#L615) | wpForceSSL\_Utility::wp\_kses\_wf($this->pro\_dialog()); |
| [616](#L616) | }Â // settings\_page\_content |
| [617](#L617) |  |
| [618](#L618) |  |
| [619](#L619) | functionÂ tab\_support() |
| [620](#L620) | { |
| [621](#L621) | echoÂ '<div style="overflow: auto;"> |
| [622](#L622) | <div class="wfssl-box"> |
| [623](#L623) | <h3>Support</h3> |
| [624](#L624) | <p>Support for the free version is available only via the <a href="https://wordpress.org/support/plugin/wp-force-ssl/" target="\_blank">WP repo support forum</a>. If you need email support please <a href="#" class="open-pro-dialog" data-pro-feature="support">upgrade to PRO</a>.</p>'; |
| [625](#L625) | echoÂ '</div>'; |
| [626](#L626) | echoÂ '</div>'; |
| [627](#L627) | echoÂ '<h3>FAQ</h3> |
| [628](#L628) | <div class="wfssl-accordion-wfssl-accordion-tabs"> |
| [629](#L629) | <div class="wfssl-accordion-tab"> |
| [630](#L630) | <input type="checkbox" id="faq1"> |
| [631](#L631) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq1">Will WP Force SSL slow down my site?</label> |
| [632](#L632) | <div class="wfssl-accordion-tab-content"> |
| [633](#L633) | Absolutely not. Everything the plugin does happens in the admin. Nothing is loaded, added, or processed on the front-end so you can rest assured there is no impact on the performance of your site. |
| [634](#L634) | </div> |
| [635](#L635) | </div> |
| [636](#L636) |  |
| [637](#L637) | <div class="wfssl-accordion-tab"> |
| [638](#L638) | <input type="checkbox" id="faq8"> |
| [639](#L639) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq8">I just moved my site to another address, will WP Force SSL help?</label> |
| [640](#L640) | <div class="wfssl-accordion-tab-content"> |
| [641](#L641) | Definitely! Especially if you moved from HTTP to HTTPS. The plugin will make sure to properly redirect all your content, check your SSL certificate, and add other security features. |
| [642](#L642) | </div> |
| [643](#L643) | </div> |
| [644](#L644) |  |
| [645](#L645) | <div class="wfssl-accordion-tab d-none"> |
| [646](#L646) | <input type="checkbox" id="faq2"> |
| [647](#L647) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq2">Can you install an SSL certificate for me?</label> |
| [648](#L648) | <div class="wfssl-accordion-tab-content"> |
| [649](#L649) | Sorry, at the moment we can\'t. The automatic SSL certificate installation feature is on our to-do and will be available in one of the future versions. |
| [650](#L650) | </div> |
| [651](#L651) | </div> |
| [652](#L652) |  |
| [653](#L653) | <div class="wfssl-accordion-tab"> |
| [654](#L654) | <input type="checkbox" id="faq11"> |
| [655](#L655) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq11">What are the requirements for running SSL on a site?</label> |
| [656](#L656) | <div class="wfssl-accordion-tab-content">There are many but a short answer is "A valid SSL certificate". Please head over to the <a href="#" data-tab="0" class="change-tab">Status</a> tab and see the results. The tests were made specifically to see if a site is ready for SSL. |
| [657](#L657) | </div> |
| [658](#L658) | </div> |
| [659](#L659) |  |
| [660](#L660) | <div class="wfssl-accordion-tab"> |
| [661](#L661) | <input type="checkbox" id="faq4"> |
| [662](#L662) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq4">Is WP Force SSL dangerous for my site?</label> |
| [663](#L663) | <div class="wfssl-accordion-tab-content"> |
| [664](#L664) | No, definitely not! The plugin does not make any permanent changes to your site so even if it comes to a worst-case scenario you can just disable the plugin and that will undo all changes. |
| [665](#L665) | </div> |
| [666](#L666) | </div> |
| [667](#L667) |  |
| [668](#L668) | <div class="wfssl-accordion-tab d-none"> |
| [669](#L669) | <input type="checkbox" id="faq5"> |
| [670](#L670) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq5">Can you generate/get an SSL certificate for me?</label> |
| [671](#L671) | <div class="wfssl-accordion-tab-content"> |
| [672](#L672) | At the moment no. Sorry. We are already working on a feature that will automatically get a certificate from Let\'s Encrypt and install it on your site but it\'s not ready yet. |
| [673](#L673) | </div> |
| [674](#L674) | </div> |
| [675](#L675) |  |
| [676](#L676) | <div class="wfssl-accordion-tab"> |
| [677](#L677) | <input type="checkbox" id="faq7"> |
| [678](#L678) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq7">Will WP Force SSL modify my files, database or any content?</label> |
| [679](#L679) | <div class="wfssl-accordion-tab-content"> |
| [680](#L680) | It will not automatically modify anything. If anything needs permanent changes you\'ll be prompted to double-confirm the change. However, on 90% of sites, all changes are done on the fly so they are not permanent. Disabling the plugin undoes all changes. |
| [681](#L681) | </div> |
| [682](#L682) | </div> |
| [683](#L683) |  |
| [684](#L684) | <div class="wfssl-accordion-tab"> |
| [685](#L685) | <input type="checkbox" id="faq6"> |
| [686](#L686) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq6">When I buy PRO can I manage my licenses and change sites?</label> |
| [687](#L687) | <div class="wfssl-accordion-tab-content"> |
| [688](#L688) | Certainly! Purchases, sites, licenses & SSL monitors are managed in the <a href="https://dashboard.wpforcessl.com/" target="\_blank">WP Force SSL Dashboard</a>. It\'s a central place to manage all your sites. You can move the licenses (change sites/domains) as much as you need. There are no limits. |
| [689](#L689) | </div> |
| [690](#L690) | </div> |
| [691](#L691) | </div>'; |
| [692](#L692) | }Â // tab\_support |
| [693](#L693) |  |
| [694](#L694) |  |
| [695](#L695) | functionÂ tab\_status() |
| [696](#L696) | { |
| [697](#L697) | echoÂ '<div id="status\_progress\_wrapper" class="wfssl-progress" style="display:none;"> |
| [698](#L698) | <div id="status\_progress" class="bar orange" style="width:0%"> |
| [699](#L699) | <div id="status\_progress\_text" class="wfssl-progress-text"></div> |
| [700](#L700) | </div> |
| [701](#L701) | </div> |
| [702](#L702) |  |
| [703](#L703) | <div id="status\_tasks" class="wfssl-labels" style="display:none;"> |
| [704](#L704) | <div class="status-tasks status-tasks-selected">All tasks</div> |
| [705](#L705) | <div class="status-tasks-remaining">Remaining tasks</div> |
| [706](#L706) | </div> |
| [707](#L707) |  |
| [708](#L708) | <div id="test-results-wrapper"> |
| [709](#L709) | <div class="loading-wrapper"> |
| [710](#L710) | <img class="wfssl\_flicker" src="'Â .Â esc\_url($this->plugin\_url)Â .Â 'img/wp-force-ssl-icon.png'Â .Â '" alt="Loading. Please wait." title="Loading. Please wait."> |
| [711](#L711) | <p>Loading. Please wait.</p> |
| [712](#L712) | </div> |
| [713](#L713) | </div>'; |
| [714](#L714) | echoÂ '<div class="button button-primary run-tests" style="float: right; display:none;">Run Tests Again</div>'; |
| [715](#L715) | }Â // tab\_status |
| [716](#L716) |  |
| [717](#L717) |  |
| [718](#L718) | functionÂ tab\_settings() |
| [719](#L719) | { |
| [720](#L720) | echoÂ '<form id="wpfs\_form"><table class="form-table" id="settings-table">'; |
| [721](#L721) |  |
| [722](#L722) | echoÂ '<tr><td> |
| [723](#L723) | <label for="wpfs\_ssl">Redirect HTTP requests to HTTPS</label> |
| [724](#L724) | <small>Visitors will be automatically redirected from HTTP to HTTPS for all pages, posts and other WP content. The 301 redirect status is used. Files that are outside of WP, or accessed directly will still be served via HTTP.</small> |
| [725](#L725) | </td><td>'; |
| [726](#L726) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_ssl',Â array('saved\_value'Â =>Â ($this->options['wpfs\_ssl']Â ==Â 'yes'Â ?Â trueÂ :Â false))); |
| [727](#L727) | echoÂ '</td></tr>'; |
| [728](#L728) |  |
| [729](#L729) | echoÂ '<tr><td> |
| [730](#L730) | <label for="fix\_frontend\_mixed\_content\_fixer">Fix mixed content on frontend<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [731](#L731) | <small>Fix mixed content on the frontend on the fly (files and/or database is not changed) by replacing <code>http://</code> with <code>https://</code> for linked resources.</small> |
| [732](#L732) | </td><td>'; |
| [733](#L733) | wpForceSSL\_Utility::create\_toogle\_switch('fix\_frontend\_mixed\_content\_fixer',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [734](#L734) | echoÂ '</td></tr>'; |
| [735](#L735) |  |
| [736](#L736) | echoÂ '<tr><td> |
| [737](#L737) | <label for="fix\_backend\_mixed\_content\_fixer">Fix mixed content on backend (in WP admin)<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [738](#L738) | <small>Fix mixed content in the backend (WP admin) on the fly (files and/or database is not changed) by replacing <code>http://</code> with <code>https://</code> for linked resources</small> |
| [739](#L739) | </td><td>'; |
| [740](#L740) | wpForceSSL\_Utility::create\_toogle\_switch('fix\_backend\_mixed\_content\_fixer',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [741](#L741) | echoÂ '</td></tr>'; |
| [742](#L742) |  |
| [743](#L743) | echoÂ '<tr><td> |
| [744](#L744) | <label for="wpfs\_hsts">Enable HSTS</label> |
| [745](#L745) | <small>HSTS (HTTP Strict Transport Security) is a header sent by your website to your visitors\' browser telling it to only use HTTPS to connect to the website. If someone tried to perform a man-in-the-middle attack and redirect the visitor to their own malicious version of the domain the browser will refuse to load the website via HTTP and force them to show a valid SSL certificate for the domain, which they will not have and thus the attack will fail.</small> |
| [746](#L746) | </td><td>'; |
| [747](#L747) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_hsts',Â array('saved\_value'Â =>Â ($this->options['wpfs\_hsts']Â ==Â 'yes'Â ?Â trueÂ :Â false))); |
| [748](#L748) | echoÂ '</td></tr>'; |
| [749](#L749) |  |
| [750](#L750) | echoÂ '<tr><td> |
| [751](#L751) | <label for="force\_secure\_cookies">Force Secure Cookies<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [752](#L752) | <small>Cookies are small packets of data stored on your computer by the websites you visit so it remembers information like your logged in state. Most times this information is sensitive, so you should enable this option to harden the way cookies are exchanged with by your browser and to prevent anyone else from reading them.</small> |
| [753](#L753) | </td><td>'; |
| [754](#L754) | wpForceSSL\_Utility::create\_toogle\_switch('force\_secure\_cookies',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [755](#L755) | echoÂ '</td></tr>'; |
| [756](#L756) |  |
| [757](#L757) | echoÂ '<tr><td> |
| [758](#L758) | <label for="htaccess\_301\_redirect">Redirect HTTP to HTTPS requests via .htaccess<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [759](#L759) | <small>Redirect all <code>http://</code> requests to <code>https://</code> via .htaccess as soon as the request is received. This is slighly faster than PHP redirect but if your server does not use .htaccess you can use the PHP redirect option too.</small> |
| [760](#L760) | </td><td>'; |
| [761](#L761) | wpForceSSL\_Utility::create\_toogle\_switch('htaccess\_301\_redirect',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [762](#L762) | echoÂ '</td></tr>'; |
| [763](#L763) |  |
| [764](#L764) | echoÂ '<tr><td> |
| [765](#L765) | <label for="xss\_protection">Cross-site scripting (X-XSS) protection<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [766](#L766) | <small>Protects your site from cross-site scripting attacks. If a cross-site scripting attack is detected, the browser will automatically block those requests.</small> |
| [767](#L767) | </td><td>'; |
| [768](#L768) | wpForceSSL\_Utility::create\_toogle\_switch('xss\_protection',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [769](#L769) | echoÂ '</td></tr>'; |
| [770](#L770) |  |
| [771](#L771) | echoÂ '<tr><td> |
| [772](#L772) | <label for="x\_content\_options">X-Content-Type Options<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [773](#L773) | <small>This header prevents MIME-sniffing, which is used to disguise the content type of malicious files being uploaded to the website.</small> |
| [774](#L774) | </td><td>'; |
| [775](#L775) | wpForceSSL\_Utility::create\_toogle\_switch('x\_content\_options',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [776](#L776) | echoÂ '</td></tr>'; |
| [777](#L777) |  |
| [778](#L778) | echoÂ '<tr><td> |
| [779](#L779) | <label for="referrer\_policy">Referrer Policy<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [780](#L780) | <small>To prevent data leakage, only send referrer information when navigating to the same protocol (HTTPS -&gt; HTTPS) and not when downgrading (HTTPS -&gt; HTTP).</small> |
| [781](#L781) | </td><td>'; |
| [782](#L782) | wpForceSSL\_Utility::create\_toogle\_switch('referrer\_policy',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [783](#L783) | echoÂ '</td></tr>'; |
| [784](#L784) |  |
| [785](#L785) | echoÂ '<tr><td> |
| [786](#L786) | <label for="wpfs\_expect\_ct">Expect CT</label> |
| [787](#L787) | <small>Enables the Expect-CT header, requesting that the browser check that the certificate for that site appears in public CT logs.</small> |
| [788](#L788) | </td><td>'; |
| [789](#L789) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_expect\_ct',Â array('saved\_value'Â =>Â ($this->options['wpfs\_expect\_ct']Â ==Â 'yes'Â ?Â trueÂ :Â false))); |
| [790](#L790) | echoÂ '</td></tr>'; |
| [791](#L791) |  |
| [792](#L792) | echoÂ '<tr><td> |
| [793](#L793) | <label for="x\_frame\_options">X-Frame Options<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [794](#L794) | <small>This header prevents your site from being loaded in an iFrame on other domains. This is used to prevent clickjacking attacks. Be sure to enable this option!</small> |
| [795](#L795) | </td><td>'; |
| [796](#L796) | wpForceSSL\_Utility::create\_toogle\_switch('x\_frame\_options',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [797](#L797) | echoÂ '</td></tr>'; |
| [798](#L798) |  |
| [799](#L799) | echoÂ '<tr><td> |
| [800](#L800) | <label for="permissions\_policy">Permissions Policy<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [801](#L801) | <small>The Permissions Policy allows you to specify which browser resources to allow on your site (i.e. microphone, webcam, etc.).</small> |
| [802](#L802) | </td><td>'; |
| [803](#L803) | wpForceSSL\_Utility::create\_toogle\_switch('permissions\_policy',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [804](#L804) | echoÂ '</td></tr>'; |
| [805](#L805) |  |
| [806](#L806) | echoÂ '<tr><td> |
| [807](#L807) | <label for="wpfs\_adminbar\_menu">Show WP Force SSL menu to administrators in admin bar</label> |
| [808](#L808) | <small>When enabled an extra menu will be shown to admins in the admin topbar. Don\'t forget to reload the page after saving to see the change.</small> |
| [809](#L809) | </td><td>'; |
| [810](#L810) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_adminbar\_menu',Â array('saved\_value'Â =>Â ($this->options['wpfs\_adminbar\_menu']Â ==Â 'yes'Â ?Â trueÂ :Â false))); |
| [811](#L811) | echoÂ '</td></tr>'; |
| [812](#L812) |  |
| [813](#L813) | echoÂ '<tr><td> |
| [814](#L814) | <label for="wpfs\_dashboard\_widget">Show WP Force SSL widget to administrators in admin dashboard</label> |
| [815](#L815) | <small>When enabled a widget with status details will be shown to admins in the admin dashboard.</small> |
| [816](#L816) | </td><td>'; |
| [817](#L817) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_dashboard\_widget',Â array('saved\_value'Â =>Â ($this->options['wpfs\_dashboard\_widget']Â ==Â 'yes'Â ?Â trueÂ :Â false))); |
| [818](#L818) | echoÂ '</td></tr>'; |
| [819](#L819) |  |
| [820](#L820) | echoÂ '</table></form>'; |
| [821](#L821) |  |
| [822](#L822) | echoÂ '<p><a href="#" class="button button-primary save-ssl-options">'Â .Â \_\_('Save Settings',Â 'wp-force-ssl')Â .Â '</a></p>'; |
| [823](#L823) | }Â //tab\_settings |
| [824](#L824) |  |
| [825](#L825) |  |
| [826](#L826) | functionÂ tab\_scanner() |
| [827](#L827) | { |
| [828](#L828) | echoÂ '<div id="scanner\_progress\_wrapper" class="wfssl-progress" style="display:none;"> |
| [829](#L829) | <div id="scanner\_progress" class="bar"> |
| [830](#L830) | <div id="scanner\_progress\_text" class="wfssl-progress-text"></div> |
| [831](#L831) | </div> |
| [832](#L832) | </div>'; |
| [833](#L833) | $postsÂ =Â get\_posts(array('post\_type'Â =>Â get\_post\_types(array('public'Â =>Â true)),Â 'numberposts'Â =>Â 1000)); |
| [834](#L834) | echoÂ '<div class="scanner-stats">Total pages to scan: 'Â .Â esc\_html(number\_format(count($posts)))Â .Â '</div>'; |
| [835](#L835) | echoÂ '<a href="#" class="open-pro-dialog" data-pro-feature="content-scanner"><img class="scanner-preview" src="'Â .Â esc\_url($this->plugin\_urlÂ .Â 'img/content-scanner.jpg')Â .Â '" /></a>'; |
| [836](#L836) |  |
| [837](#L837) | echoÂ '<div id="start-scanner" data-pro-feature="start-scanning" class="button button-primary open-pro-dialog">Start Scanning</div>'; |
| [838](#L838) | }Â //tab\_scanner |
| [839](#L839) |  |
| [840](#L840) |  |
| [841](#L841) | functionÂ tab\_ssl() |
| [842](#L842) | { |
| [843](#L843) | echoÂ '<h2>SSL Certificate Information</h2>'; |
| [844](#L844) | echoÂ '<div id="ssl\_cert\_details" class="wfssl-box">'; |
| [845](#L845) | echoÂ 'Loading certificate information ...<span class="wfssl-green wfssl\_rotating dashicons dashicons-update"></span>'; |
| [846](#L846) | echoÂ '</div>'; |
| [847](#L847) | echoÂ '<div class="clear"></div>'; |
| [848](#L848) |  |
| [849](#L849) | echoÂ '<h2>Real-Time SSL &amp; Site Monitoring<span class="pro-feature">PRO</span></h2>'; |
| [850](#L850) | echoÂ '<div id="wfssl\_cert\_email" class="wfssl-box">'; |
| [851](#L851) | echoÂ '<span class="wfssl-red dashicons dashicons-dismiss"></span>'; |
| [852](#L852) | echoÂ '<p>Real-time site &amp; SSL certificate monitoring is a <a href="#" data-pro-feature="ssl-monitor-text" class="open-pro-dialog">PRO</a> feature powered by our SaaS that will help you and your clients sleep better. It monitors over 20 common errors related to SSL that can happen at any time. Forgot to renew your certificate? No problem, you\'ll get notified on time. Forgot to change certificate after switching the domain or server? Again, not a problem. You\'ll get notified.</p>'; |
| [853](#L853) | echoÂ '<label for="ssl-monitor-toggle">Enable Monitoring</label> &nbsp; '; |
| [854](#L854) | wpForceSSL\_Utility::create\_toogle\_switch('ssl-monitor-toggle',Â array('class'Â =>Â 'open-pro-dialog',Â 'saved\_value'Â =>Â false)); |
| [855](#L855) | echoÂ '<div id="wfssl-cert-expiration-email-box">'; |
| [856](#L856) | echoÂ '<input id="cert\_expiration\_email" name="cert\_expiration\_email" class="wfssl-cert-expiration-email-input open-pro-dialog" data-pro-feature="ssl-monitor-email" type="text" placeholder="Email for notifications" value="" style="height:32px; width:353px; background-color: #fff; margin-bottom: 20px;"><br>'; |
| [857](#L857) | echoÂ '<div class="button button-primary open-pro-dialog" data-pro-feature="ssl-monitor-save">Save &amp; Enable Monitoring</div>'; |
| [858](#L858) | echoÂ '</div>'; |
| [859](#L859) | echoÂ '</div>'; |
| [860](#L860) |  |
| [861](#L861) | echoÂ '<div class="clear"></div>'; |
| [862](#L862) | echoÂ '<h2>Generate Free SSL Certificate<span class="pro-feature">PRO</span></h2>'; |
| [863](#L863) | echoÂ '<div id="wfssl\_cert\_generate" class="wfssl-box">'; |
| [864](#L864) | echoÂ '<p>Use this <a href="#" data-pro-feature="generate-ssl-cert-text" class="open-pro-dialog">PRO</a> tool to generate a free Let\'s Encrypt certificate. The certificate will be renewed automatically as long as WP Force SSL is active on the website. All you need is an email address, no other personal information or payment is necessary.</p>'; |
| [865](#L865) | echoÂ '<div class="button button-primary open-pro-dialog" data-pro-feature="generate-ssl-cert">Generate Free SSL Certificate</div>'; |
| [866](#L866) | echoÂ '</div>'; |
| [867](#L867) | }Â // tab\_ssl |
| [868](#L868) |  |
| [869](#L869) |  |
| [870](#L870) | /\*\* |
| [871](#L871) | \* Perform the redirect to HTTPS if loaded over HTTP |
| [872](#L872) | \* |
| [873](#L873) | \* @since 1.5 |
| [874](#L874) | \* |
| [875](#L875) | \* @return null |
| [876](#L876) | \* |
| [877](#L877) | \*/ |
| [878](#L878) | publicÂ functionÂ wpfs\_core() |
| [879](#L879) | { |
| [880](#L880) | ifÂ (!is\_ssl())Â { |
| [881](#L881) | wp\_safe\_redirect('https://'Â .Â $\_SERVER['HTTP\_HOST']Â .Â $\_SERVER['REQUEST\_URI'],Â 301); |
| [882](#L882) | exit(); |
| [883](#L883) | } |
| [884](#L884) | }Â // wpfs\_core |
| [885](#L885) |  |
| [886](#L886) |  |
| [887](#L887) | /\*\* |
| [888](#L888) | \* Check if minimal WP version required by WP Force SSL is used |
| [889](#L889) | \* |
| [890](#L890) | \* @since 1.5 |
| [891](#L891) | \* |
| [892](#L892) | \* @return bool |
| [893](#L893) | \* |
| [894](#L894) | \*/ |
| [895](#L895) | publicÂ functionÂ check\_wp\_version($min\_version) |
| [896](#L896) | { |
| [897](#L897) | ifÂ (!version\_compare(get\_bloginfo('version'),Â $min\_version,Â  '>='))Â { |
| [898](#L898) | add\_action('admin\_notices',Â array($this,Â 'notice\_min\_wp\_version')); |
| [899](#L899) | returnÂ false; |
| [900](#L900) | }Â elseÂ { |
| [901](#L901) | returnÂ true; |
| [902](#L902) | } |
| [903](#L903) | }Â // check\_wp\_version |
| [904](#L904) |  |
| [905](#L905) |  |
| [906](#L906) | /\*\* |
| [907](#L907) | \* Display error message if WP version is too low |
| [908](#L908) | \* |
| [909](#L909) | \* @since 1.5 |
| [910](#L910) | \* |
| [911](#L911) | \* @return null |
| [912](#L912) | \* |
| [913](#L913) | \*/ |
| [914](#L914) | publicÂ functionÂ notice\_min\_wp\_version() |
| [915](#L915) | { |
| [916](#L916) | echoÂ '<div class="error"><p>'Â .Â sprintf(\_\_('WP Force SSL plugin <b>requires WordPress version 4.6</b> or higher to function properly. You are using WordPress version %s. Please <a href="%s">update it</a>.',Â 'wp-force-ssl'),Â get\_bloginfo('version'),Â admin\_url('update-core.php'))Â .Â '</p></div>'; |
| [917](#L917) | }Â // notice\_min\_wp\_version\_error |
| [918](#L918) |  |
| [919](#L919) |  |
| [920](#L920) | /\*\* |
| [921](#L921) | \* Send the HTTP Strict Transport Security (HSTS) header. |
| [922](#L922) | \* |
| [923](#L923) | \* @since 1.5 |
| [924](#L924) | \* |
| [925](#L925) | \* @return null |
| [926](#L926) | \*/ |
| [927](#L927) | publicÂ functionÂ to\_strict\_transport\_security() |
| [928](#L928) | { |
| [929](#L929) | header('Strict-Transport-Security: max-age=31536000; includeSubDomains; preload'); |
| [930](#L930) | }Â // to\_strict\_transport\_security |
| [931](#L931) |  |
| [932](#L932) |  |
| [933](#L933) | /\*\* |
| [934](#L934) | \* Send the Expect CT header. |
| [935](#L935) | \* |
| [936](#L936) | \* @since 1.5 |
| [937](#L937) | \* |
| [938](#L938) | \* @return null |
| [939](#L939) | \*/ |
| [940](#L940) | publicÂ functionÂ enable\_expect\_ct() |
| [941](#L941) | { |
| [942](#L942) | header('Expect-CT: max-age=5184000, enforce'); |
| [943](#L943) | }Â // enable\_expect\_ct |
| [944](#L944) |  |
| [945](#L945) |  |
| [946](#L946) | /\*\* |
| [947](#L947) | \* Save plugin settings received via AJAX |
| [948](#L948) | \* |
| [949](#L949) | \* @since 1.5 |
| [950](#L950) | \* |
| [951](#L951) | \* @return null |
| [952](#L952) | \*/ |
| [953](#L953) | publicÂ functionÂ ajax\_save\_setting() |
| [954](#L954) | { |
| [955](#L955) | check\_ajax\_referer('save\_settting\_nonce\_action'); |
| [956](#L956) |  |
| [957](#L957) | $wpfs\_sslÂ =Â isset($\_POST['wpfs\_ssl'])Â ?Â 'yes'Â :Â 'no'; |
| [958](#L958) | $wpfs\_hstsÂ =Â isset($\_POST['wpfs\_hsts'])Â ?Â 'yes'Â :Â 'no'; |
| [959](#L959) | $wpfs\_expect\_ctÂ =Â isset($\_POST['wpfs\_expect\_ct'])Â ?Â 'yes'Â :Â 'no'; |
| [960](#L960) | $wpfs\_adminbar\_menuÂ =Â isset($\_POST['wpfs\_adminbar\_menu'])Â ?Â 'yes'Â :Â 'no'; |
| [961](#L961) | $wpfs\_dashboard\_widgetÂ =Â isset($\_POST['wpfs\_dashboard\_widget'])Â ?Â 'yes'Â :Â 'no'; |
| [962](#L962) |  |
| [963](#L963) | $wpfs\_settingsÂ =Â array( |
| [964](#L964) | 'wpfs\_ssl'Â =>Â $wpfs\_ssl, |
| [965](#L965) | 'wpfs\_hsts'Â =>Â $wpfs\_hsts, |
| [966](#L966) | 'wpfs\_expect\_ct'Â =>Â $wpfs\_expect\_ct, |
| [967](#L967) | 'wpfs\_adminbar\_menu'Â =>Â $wpfs\_adminbar\_menu, |
| [968](#L968) | 'wpfs\_dashboard\_widget'Â =>Â $wpfs\_dashboard\_widget |
| [969](#L969) | ); |
| [970](#L970) | update\_option(WPFSSL\_OPTIONS\_KEY,Â $wpfs\_settings); |
| [971](#L971) |  |
| [972](#L972) | wp\_send\_json\_success(); |
| [973](#L973) | }Â // ajax\_save\_setting |
| [974](#L974) |  |
| [975](#L975) |  |
| [976](#L976) | /\*\* |
| [977](#L977) | \* Check SSL Certificate by performing a request to home\_url over https and send back a json response |
| [978](#L978) | \* |
| [979](#L979) | \* @since 1.5 |
| [980](#L980) | \* |
| [981](#L981) | \* @return null |
| [982](#L982) | \*/ |
| [983](#L983) | publicÂ functionÂ ajax\_check\_ssl() |
| [984](#L984) | { |
| [985](#L985) | globalÂ $wp\_force\_ssl\_tests; |
| [986](#L986) |  |
| [987](#L987) | check\_ajax\_referer('test\_ssl\_nonce\_action'); |
| [988](#L988) |  |
| [989](#L989) | ifÂ (isset($\_REQUEST['force'])Â &&Â (bool)$\_REQUEST['force']Â ===Â true)Â { |
| [990](#L990) | $nocacheÂ =Â true; |
| [991](#L991) | }Â elseÂ { |
| [992](#L992) | $nocacheÂ =Â false; |
| [993](#L993) | } |
| [994](#L994) | $statusÂ =Â $wp\_force\_ssl\_tests->get\_ssl\_status($nocache); |
| [995](#L995) |  |
| [996](#L996) | wp\_send\_json\_success($status); |
| [997](#L997) | }Â // check\_ssl |
| [998](#L998) |  |
| [999](#L999) | /\*\* |
| [1000](#L1000) | \* Check if currently on WP Force SSL settings page |
| [1001](#L1001) | \* |
| [1002](#L1002) | \* @since 1.5 |
| [1003](#L1003) | \* |
| [1004](#L1004) | \* @return bool is on WP Force SSL settings page |
| [1005](#L1005) | \*/ |
| [1006](#L1006) | publicÂ functionÂ is\_plugin\_page() |
| [1007](#L1007) | { |
| [1008](#L1008) | $current\_screenÂ =Â get\_current\_screen(); |
| [1009](#L1009) | ifÂ ($current\_screen->idÂ ===Â 'settings\_page\_wpfs-settings')Â { |
| [1010](#L1010) | returnÂ true; |
| [1011](#L1011) | }Â elseÂ { |
| [1012](#L1012) | returnÂ false; |
| [1013](#L1013) | } |
| [1014](#L1014) | }Â // is\_plugin\_page |
| [1015](#L1015) |  |
| [1016](#L1016) |  |
| [1017](#L1017) | /\*\* |
| [1018](#L1018) | \* Change admin footer text to show plugin information |
| [1019](#L1019) | \* |
| [1020](#L1020) | \* @since 1.5 |
| [1021](#L1021) | \* |
| [1022](#L1022) | \* @param string $text\_org original footer text |
| [1023](#L1023) | \* |
| [1024](#L1024) | \* @return string footer text html |
| [1025](#L1025) | \*/ |
| [1026](#L1026) | publicÂ functionÂ admin\_footer\_text($text\_org) |
| [1027](#L1027) | { |
| [1028](#L1028) | ifÂ (falseÂ ===Â $this->is\_plugin\_page())Â { |
| [1029](#L1029) | returnÂ $text\_org; |
| [1030](#L1030) | } |
| [1031](#L1031) |  |
| [1032](#L1032) | $textÂ =Â '<i><a target="\_blank" href="https://wpforcessl.com/?ref=wpfssl-free">WP Force SSL</a> v'Â .Â $this->versionÂ .Â ' by <a href="https://www.webfactoryltd.com/" title="'Â .Â \_\_('Visit our site to get more great plugins',Â 'wp-force-ssl')Â .Â '" target="\_blank">WebFactory Ltd</a>.'; |
| [1033](#L1033) | $textÂ .=Â ' Please <a target="\_blank" href="https://wordpress.org/support/plugin/wp-force-ssl/reviews/#new-post" title="'Â .Â \_\_('Rate the plugin',Â 'wp-force-ssl')Â .Â '">'Â .Â \_\_('Rate the plugin â˜…â˜…â˜…â˜…â˜…',Â 'wp-force-ssl')Â .Â '</a>.</i> '; |
| [1034](#L1034) | returnÂ $text; |
| [1035](#L1035) | }Â // admin\_footer\_text |
| [1036](#L1036) |  |
| [1037](#L1037) |  |
| [1038](#L1038) | functionÂ pro\_dialog() |
| [1039](#L1039) | { |
| [1040](#L1040) | $outÂ =Â ''; |
| [1041](#L1041) |  |
| [1042](#L1042) | $outÂ .=Â '<div id="wpfssl-pro-dialog" style="display: none;" title="WP Force SSL PRO is here!"><span class="ui-helper-hidden-accessible"><input type="text"/></span>'; |
| [1043](#L1043) |  |
| [1044](#L1044) | $outÂ .=Â '<div class="center logo"><a href="https://wpforcessl.com/?ref=wpfssl-free-pricing-table" target="\_blank"><img src="'Â .Â $this->plugin\_urlÂ .Â 'img/wp-force-ssl-logo.png'Â .Â '" alt="WP Force SSL PRO" title="WP Force SSL PRO"></a><br>'; |
| [1045](#L1045) |  |
| [1046](#L1046) | $outÂ .=Â '<span>Limited PRO Launch Discount - <b>all prices are LIFETIME</b>! Pay once &amp; use forever!</span>'; |
| [1047](#L1047) | $outÂ .=Â '</div>'; |
| [1048](#L1048) |  |
| [1049](#L1049) | $outÂ .=Â '<table id="wpfssl-pro-table">'; |
| [1050](#L1050) | $outÂ .=Â '<tr>'; |
| [1051](#L1051) | $outÂ .=Â '<td class="center">Lifetime Personal License</td>'; |
| [1052](#L1052) | $outÂ .=Â '<td class="center">Lifetime Team License</td>'; |
| [1053](#L1053) | $outÂ .=Â '<td class="center">Lifetime Agency License</td>'; |
| [1054](#L1054) | $outÂ .=Â '</tr>'; |
| [1055](#L1055) |  |
| [1056](#L1056) | $outÂ .=Â '<tr class="prices">'; |
| [1057](#L1057) | $outÂ .=Â '<td class="center"><del>$49 /year</del><br><span>$59</span> <b>/lifetime</b></td>'; |
| [1058](#L1058) | $outÂ .=Â '<td class="center"><del>$89 /year</del><br><span>$89</span> <b>/lifetime</b></td>'; |
| [1059](#L1059) | $outÂ .=Â '<td class="center"><del>$199 /year</del><br><span>$119</span> <b>/lifetime</b></td>'; |
| [1060](#L1060) | $outÂ .=Â '</tr>'; |
| [1061](#L1061) |  |
| [1062](#L1062) | $outÂ .=Â '<tr>'; |
| [1063](#L1063) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span><b>1 Site License</b></td>'; |
| [1064](#L1064) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span><b>5 Sites License</b></td>'; |
| [1065](#L1065) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span><b>100 Sites License</b></td>'; |
| [1066](#L1066) | $outÂ .=Â '</tr>'; |
| [1067](#L1067) |  |
| [1068](#L1068) | $outÂ .=Â '<tr>'; |
| [1069](#L1069) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>All Plugin Features</td>'; |
| [1070](#L1070) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>All Plugin Features</td>'; |
| [1071](#L1071) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>All Plugin Features</td>'; |
| [1072](#L1072) | $outÂ .=Â '</tr>'; |
| [1073](#L1073) |  |
| [1074](#L1074) | $outÂ .=Â '<tr>'; |
| [1075](#L1075) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Lifetime Updates &amp; Support</td>'; |
| [1076](#L1076) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Lifetime Updates &amp; Support</td>'; |
| [1077](#L1077) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Lifetime Updates &amp; Support</td>'; |
| [1078](#L1078) | $outÂ .=Â '</tr>'; |
| [1079](#L1079) |  |
| [1080](#L1080) | $outÂ .=Â '<tr>'; |
| [1081](#L1081) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Content Scanner</td>'; |
| [1082](#L1082) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Content Scanner</td>'; |
| [1083](#L1083) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Content Scanner</td>'; |
| [1084](#L1084) | $outÂ .=Â '</tr>'; |
| [1085](#L1085) |  |
| [1086](#L1086) | $outÂ .=Â '<tr>'; |
| [1087](#L1087) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Real-Time SSL &amp; Site Monitoring</td>'; |
| [1088](#L1088) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Real-Time SSL &amp; Site Monitoring</td>'; |
| [1089](#L1089) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Real-Time SSL &amp; Site Monitoring</td>'; |
| [1090](#L1090) | $outÂ .=Â '</tr>'; |
| [1091](#L1091) |  |
| [1092](#L1092) | $outÂ .=Â '<tr>'; |
| [1093](#L1093) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Free SSL Certificate Generating</td>'; |
| [1094](#L1094) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Free SSL Certificate Generating</td>'; |
| [1095](#L1095) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Free SSL Certificate Generating</td>'; |
| [1096](#L1096) | $outÂ .=Â '</tr>'; |
| [1097](#L1097) |  |
| [1098](#L1098) | $outÂ .=Â '<tr>'; |
| [1099](#L1099) | $outÂ .=Â '<td><span class="dashicons dashicons-no"></span>Licenses &amp; Sites Manager</td>'; |
| [1100](#L1100) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Licenses &amp; Sites Manager</td>'; |
| [1101](#L1101) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Licenses &amp; Sites Manager</td>'; |
| [1102](#L1102) | $outÂ .=Â '</tr>'; |
| [1103](#L1103) |  |
| [1104](#L1104) | $outÂ .=Â '<tr>'; |
| [1105](#L1105) | $outÂ .=Â '<td><span class="dashicons dashicons-no"></span>White-label Mode</td>'; |
| [1106](#L1106) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>White-label Mode</td>'; |
| [1107](#L1107) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>White-label Mode</td>'; |
| [1108](#L1108) | $outÂ .=Â '</tr>'; |
| [1109](#L1109) |  |
| [1110](#L1110) | $outÂ .=Â '<tr>'; |
| [1111](#L1111) | $outÂ .=Â '<td><span class="dashicons dashicons-no"></span>Full Plugin Rebranding</td>'; |
| [1112](#L1112) | $outÂ .=Â '<td><span class="dashicons dashicons-no"></span>Full Plugin Rebranding</td>'; |
| [1113](#L1113) | $outÂ .=Â '<td><span class="dashicons dashicons-yes"></span>Full Plugin Rebranding</td>'; |
| [1114](#L1114) | $outÂ .=Â '</tr>'; |
| [1115](#L1115) |  |
| [1116](#L1116) | $outÂ .=Â '<tr>'; |
| [1117](#L1117) | $outÂ .=Â '<td><a class="button button-buy" data-href-org="https://wpforcessl.com/buy/?product=personal-launch&ref=pricing-table" href="https://wpforcessl.com/buy/?product=personal-launch&ref=pricing-table" target="\_blank">Lifetime License<br>$59 -&gt; BUY NOW</a> |
| [1118](#L1118) | <br>or <a class="button-buy" data-href-org="https://wpforcessl.com/buy/?product=personal-monthly&ref=pricing-table" href="https://wpforcessl.com/buy/?product=personal-monthly&ref=pricing-table" target="\_blank">only $6.99 <small>/month</small></a></td>'; |
| [1119](#L1119) | $outÂ .=Â '<td><a class="button button-buy" data-href-org="https://wpforcessl.com/buy/?product=team-launch&ref=pricing-table" href="https://wpforcessl.com/buy/?product=team-launch&ref=pricing-table" target="\_blank">Lifetime License<br>$69 -&gt; BUY NOW</a></td>'; |
| [1120](#L1120) | $outÂ .=Â '<td><a class="button button-buy" data-href-org="https://wpforcessl.com/buy/?product=agency-launch&ref=pricing-table" href="https://wpforcessl.com/buy/?product=agency-launch&ref=pricing-table" target="\_blank">Lifetime License<br>$119 -&gt; BUY NOW</a></td>'; |
| [1121](#L1121) | $outÂ .=Â '</tr>'; |
| [1122](#L1122) |  |
| [1123](#L1123) | $outÂ .=Â '</table>'; |
| [1124](#L1124) |  |
| [1125](#L1125) | $outÂ .=Â '<div class="center footer"><b>100% No-Risk Money Back Guarantee!</b> If you don\'t like the plugin over the next 7 days, we will happily refund 100% of your money. No questions asked! Payments are processed by our merchant of records - <a href="https://paddle.com/" target="\_blank">Paddle</a>.</div></div>'; |
| [1126](#L1126) |  |
| [1127](#L1127) | returnÂ $out; |
| [1128](#L1128) | }Â // pro\_dialog |
| [1129](#L1129) |  |
| [1130](#L1130) |  |
| [1131](#L1131) | /\*\* |
| [1132](#L1132) | \* Clean-up on delete |
| [1133](#L1133) | \* |
| [1134](#L1134) | \* @since 1.5 |
| [1135](#L1135) | \* |
| [1136](#L1136) | \* @return null |
| [1137](#L1137) | \*/ |
| [1138](#L1138) | publicÂ staticÂ functionÂ uninstall() |
| [1139](#L1139) | { |
| [1140](#L1140) | delete\_option(WPFSSL\_OPTIONS\_KEY); |
| [1141](#L1141) | delete\_option(WPFSSL\_META\_KEY); |
| [1142](#L1142) | }Â // uninstall |
| [1143](#L1143) |  |
| [1144](#L1144) |  |
| [1145](#L1145) | /\*\* |
| [1146](#L1146) | \* Reset on deactivate |
| [1147](#L1147) | \* |
| [1148](#L1148) | \* @return null |
| [1149](#L1149) | \*/ |
| [1150](#L1150) | publicÂ staticÂ functionÂ deactivate() |
| [1151](#L1151) | { |
| [1152](#L1152) | $metaÂ =Â get\_option(WPFSSL\_META\_KEY,Â array()); |
| [1153](#L1153) | $meta['hide\_welcome\_pointer']Â =Â false; |
| [1154](#L1154) | update\_option(WPFSSL\_META\_KEY,Â $meta); |
| [1155](#L1155) | }Â // deactivate |
| [1156](#L1156) |  |
| [1157](#L1157) |  |
| [1158](#L1158) | /\*\* |
| [1159](#L1159) | \* Disabled; we use singleton pattern so magic functions need to be disabled. |
| [1160](#L1160) | \* |
| [1161](#L1161) | \* @since 1.5 |
| [1162](#L1162) | \* |
| [1163](#L1163) | \* @return null |
| [1164](#L1164) | \*/ |
| [1165](#L1165) | privateÂ functionÂ \_\_clone() |
| [1166](#L1166) | { |
| [1167](#L1167) | } |
| [1168](#L1168) |  |
| [1169](#L1169) |  |
| [1170](#L1170) | /\*\* |
| [1171](#L1171) | \* Disabled; we use singleton pattern so magic functions need to be disabled. |
| [1172](#L1172) | \* |
| [1173](#L1173) | \* @since 1.5 |
| [1174](#L1174) | \* |
| [1175](#L1175) | \* @return null |
| [1176](#L1176) | \*/ |
| [1177](#L1177) | publicÂ functionÂ \_\_sleep() |
| [1178](#L1178) | { |
| [1179](#L1179) | } |
| [1180](#L1180) |  |
| [1181](#L1181) |  |
| [1182](#L1182) | /\*\* |
| [1183](#L1183) | \* Disabled; we use singleton pattern so magic functions need to be disabled. |
| [1184](#L1184) | \* |
| [1185](#L1185) | \* @since 1.5 |
| [1186](#L1186) | \* |
| [1187](#L1187) | \* @return null |
| [1188](#L1188) | \*/ |
| [1189](#L1189) | publicÂ functionÂ \_\_wakeup() |
| [1190](#L1190) | { |
| [1191](#L1191) | } |
| [1192](#L1192) | // end class |
| [1193](#L1193) | } |
| [1194](#L1194) |  |
| [1195](#L1195) |  |
| [1196](#L1196) | $wpfsÂ =Â wpForceSSL::get\_instance(); |
| [1197](#L1197) | add\_action('plugins\_loaded',Â array($wpfs,Â 'plugins\_loaded')); |
| [1198](#L1198) | register\_deactivation\_hook(\_\_FILE\_\_,Â array('wpForceSSL',Â 'deactivate')); |
| [1199](#L1199) | register\_uninstall\_hook(\_\_FILE\_\_,Â array('wpForceSSL',Â 'uninstall')); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wp-force-ssl/tags/1.66/wp-force-ssl.php?format=txt)
* [Original Format](/export/3220773/wp-force-ssl/tags/1.66/wp-force-ssl.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

