

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3099110)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3099109 "Changeset 3099109")
* [Next Changeset](/changeset/3099111 "Changeset 3099111") →

---

# Changeset 3099110

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/07/2024 07:18:19 AM
([7 months](/timeline?from=2024-06-07T07%3A18%3A19Z&precision=second "See timeline at 06/07/2024 07:18:19 AM") ago)

Author:
WebFactory
Message:

Security fixes

Location:
[wp-force-ssl/trunk](/browser/wp-force-ssl/trunk?rev=3099110)
Files:

2 edited

* [readme.txt](/browser/wp-force-ssl/trunk/readme.txt?rev=3099110 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [wp-force-ssl.php](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110 "Show entry in browser")
  (modified)
  ([11 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-force-ssl/trunk/readme.txt](/changeset/3099110/wp-force-ssl/trunk/readme.txt "Show the changeset 3099110 restricted to wp-force-ssl/trunk/readme.txt")

  | [r3058608](/browser/wp-force-ssl/trunk/readme.txt?rev=3058608#L1 "Show revision 3058608 of this file in browser") | [r3099110](/browser/wp-force-ssl/trunk/readme.txt?rev=3099110#L1 "Show revision 3099110 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === WP Force SSL & HTTPS SSL Redirect === |
  | 2 | 2 | Contributors: WebFactory |
  | 3 |  | Tags: ssl, force ssl, ~~add ssl, install ssl, https, ssl certificate, ssl redirect, mixed content, hsts, lets encrypt, generate ssl certificate~~ |
  |  | 3 | Tags: ssl, force ssl, https, ssl certificate, mixed content |
  | 4 | 4 | Requires at least: 4.6 |
  | 5 | 5 | Tested up to: 6.5 |
  | 6 | 6 | Requires PHP: 5.2 |
  | 7 |  | Stable Tag: 1.6~~6~~ |
  |  | 7 | Stable Tag: 1.67 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/wp-force-ssl/trunk/readme.txt?rev=3058608#L86) | […](/browser/wp-force-ssl/trunk/readme.txt?rev=3099110#L86) |  |
  | 86 | 86 | == Changelog == |
  | 87 | 87 |  |
  |  | 88 | = v1.67 = |
  |  | 89 | - 2024/06/07 |
  |  | 90 | - Security fixes |
  |  | 91 |  |
  | 88 | 92 | = v1.66 = |
  | 89 | 93 | - 2024/03/26 |
* ## [wp-force-ssl/trunk/wp-force-ssl.php](/changeset/3099110/wp-force-ssl/trunk/wp-force-ssl.php "Show the changeset 3099110 restricted to wp-force-ssl/trunk/wp-force-ssl.php")

  | [r3058608](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L6 "Show revision 3058608 of this file in browser") | [r3099110](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L6 "Show revision 3099110 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Author: WebFactory Ltd |
  | 7 | 7 | Author URI: https://www.webfactoryltd.com/ |
  | 8 |  | Version: 1.6~~6~~ |
  |  | 8 | Version: 1.67 |
  | 9 | 9 | Text Domain: wp-force-ssl |
  | 10 | 10 | Requires at least: 4.6 |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L149) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L149) |  |
  | 149 | 149 | check\_ajax\_referer('wpfs\_dismiss\_notice'); |
  | 150 | 150 |  |
  | 151 |  | if (!current\_user\_can('~~administrator~~')) { |
  |  | 151 | if (!current\_user\_can('manage\_options')) { |
  | 152 | 152 | wp\_send\_json\_error('You are not allowed to run this action.'); |
  | 153 | 153 | } |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L210) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L210) |  |
  | 210 | 210 |  |
  | 211 | 211 | check\_ajax\_referer('run\_tests\_nonce\_action'); |
  | 212 |  | if (!current\_user\_can('administrator')) { |
  |  | 212 |  |
  |  | 213 | if (!current\_user\_can('manage\_options')) { |
  | 213 | 214 | wp\_send\_json\_error('You are not allowed to run this action.'); |
  | 214 | 215 | } |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L242) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L243) |  |
  | 242 | 243 | $pointers = array(); |
  | 243 | 244 |  |
  | 244 |  | if (!$meta['hide\_welcome\_pointer'] && !$this->is\_plugin\_page() && current\_user\_can('~~administrator~~')) { |
  |  | 245 | if (!$meta['hide\_welcome\_pointer'] && !$this->is\_plugin\_page() && current\_user\_can('manage\_options')) { |
  | 245 | 246 | $pointers['\_nonce\_dismiss\_pointer'] = wp\_create\_nonce('wpfs\_dismiss\_notice'); |
  | 246 | 247 | $pointers['welcome'] = array('target' => '#menu-settings', 'edge' => 'left', 'align' => 'right', 'content' => 'Thank you for installing the <b style="font-weight: 800;">WP Force SSL</b> plugin!<br>Open <a href="' . admin\_url('options-general.php?page=wpfs-settings') . '">Settings - WP Force SSL</a> to access SSL settings.'); |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L348) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L349) |  |
  | 348 | 349 | if ( |
  | 349 | 350 | 'yes' != $this->options['wpfs\_adminbar\_menu'] || |
  | 350 |  | false === current\_user\_can('~~administrator~~') || |
  |  | 351 | false === current\_user\_can('manage\_options') || |
  | 351 | 352 | false === apply\_filters('wp\_force\_ssl\_show\_admin\_bar', true) |
  | 352 | 353 | ) { |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L399) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L400) |  |
  | 399 | 400 | function add\_widget() |
  | 400 | 401 | { |
  | 401 |  | if (current\_user\_can('~~administrator~~') && $this->options['wpfs\_dashboard\_widget'] == 'yes') { |
  |  | 402 | if (current\_user\_can('manage\_options') && $this->options['wpfs\_dashboard\_widget'] == 'yes') { |
  | 402 | 403 | add\_meta\_box('wpfssl\_status', 'WP Force SSL Status', array($this, 'widget\_content'), 'dashboard', 'side', 'high'); |
  | 403 | 404 | } |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L545) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L546) |  |
  | 545 | 546 | { |
  | 546 | 547 | // double check for admin privileges |
  | 547 |  | if (!current\_user\_can('~~administrator~~')) { |
  |  | 548 | if (!current\_user\_can('manage\_options')) { |
  | 548 | 549 | wp\_die('Sorry, you are not allowed to access this page.'); |
  | 549 | 550 | } |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L820) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L821) |  |
  | 820 | 821 | echo '</table></form>'; |
  | 821 | 822 |  |
  | 822 |  | echo '<p><a href="#" class="button button-primary save-ssl-options">' . \_\_('Save Settings', 'wp-force-ssl') . '</a></p>'; |
  |  | 823 | echo '<p><a href="#" class="button button-primary save-ssl-options">' . esc\_html\_\_('Save Settings', 'wp-force-ssl') . '</a></p>'; |
  | 823 | 824 | } //tab\_settings |
  | 824 | 825 |  |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L914) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L915) |  |
  | 914 | 915 | public function notice\_min\_wp\_version() |
  | 915 | 916 | { |
  | 916 |  | ~~echo '<div class="error"><p>' . sprintf(\_\_('WP Force SSL plugin <b>requires WordPress version 4.6</b> or higher to function properly. You are using WordPress version %s. Please <a href="%s">update it</a>.', 'wp-force-ssl'), get\_bloginfo('version'), admin\_url('update-core.php')) . '</p></div>'~~; |
  |  | 917 | wpForceSSL\_Utility::wp\_kses\_wf('<div class="error"><p>' . sprintf(\_\_('WP Force SSL plugin <b>requires WordPress version 4.6</b> or higher to function properly. You are using WordPress version %s. Please <a href="%s">update it</a>.', 'wp-force-ssl'), get\_bloginfo('version'), admin\_url('update-core.php')) . '</p></div>'); |
  | 917 | 918 | } // notice\_min\_wp\_version\_error |
  | 918 | 919 |  |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L954) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L955) |  |
  | 954 | 955 | { |
  | 955 | 956 | check\_ajax\_referer('save\_settting\_nonce\_action'); |
  |  | 957 |  |
  |  | 958 | if (false === current\_user\_can('manage\_options')) { |
  |  | 959 | wp\_die('Sorry, you have to be an admin to run this action.'); |
  |  | 960 | } |
  | 956 | 961 |  |
  | 957 | 962 | $wpfs\_ssl = isset($\_POST['wpfs\_ssl']) ? 'yes' : 'no'; |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L987) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L992) |  |
  | 987 | 992 | check\_ajax\_referer('test\_ssl\_nonce\_action'); |
  | 988 | 993 |  |
  |  | 994 | if (false === current\_user\_can('manage\_options')) { |
  |  | 995 | wp\_die('Sorry, you have to be an admin to run this action.'); |
  |  | 996 | } |
  |  | 997 |  |
  | 989 | 998 | if (isset($\_REQUEST['force']) && (bool)$\_REQUEST['force'] === true) { |
  | 990 | 999 | $nocache = true; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3099110)
* [Zip Archive](?format=zip&new=3099110)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

