

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2932691%2Farmember-membership%2Ftrunk%2Fautoload.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2929715/armember-membership/trunk/autoload.php "Changeset 2929715 for armember-membership/trunk/autoload.php")
* [Next Change](/changeset/2935151/armember-membership/trunk/autoload.php "Changeset 2935151 for armember-membership/trunk/autoload.php") →

---

# Changeset [2932691](/changeset/2932691 "Show full changeset") for [armember-membership/trunk/autoload.php](/browser/armember-membership/trunk/autoload.php?rev=2932691 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/30/2023 03:17:08 PM
([19 months](/timeline?from=2023-06-30T15%3A17%3A08Z&precision=second "See timeline at 06/30/2023 03:17:08 PM") ago)

Author:
reputeinfosystems
Message:
# 4.0.6

* Security Fix
* Minor bug fixes.

File:

1 edited

* [armember-membership/trunk/autoload.php](/browser/armember-membership/trunk/autoload.php?rev=2932691 "Show entry in browser")
  (modified)
  ([9 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [armember-membership/trunk/autoload.php](/changeset/2932691/armember-membership/trunk/autoload.php "Show the changeset 2932691 restricted to armember-membership/trunk/autoload.php")

  | [r2929715](/browser/armember-membership/trunk/autoload.php?rev=2929715#L119 "Show revision 2929715 of this file in browser") | [r2932691](/browser/armember-membership/trunk/autoload.php?rev=2932691#L119 "Show revision 2932691 of this file in browser") |  |
  | --- | --- | --- |
  | 119 | 119 | /\* Defining Membership Plugin Version \*/ |
  | 120 | 120 | global $arm\_lite\_version; |
  | 121 |  | $arm\_lite\_version = '4.0.~~5~~'; |
  |  | 121 | $arm\_lite\_version = '4.0.6'; |
  | 122 | 122 | define( 'MEMBERSHIPLITE\_VERSION', $arm\_lite\_version ); |
  | 123 | 123 |  |
  | […](/browser/armember-membership/trunk/autoload.php?rev=2929715#L571) | […](/browser/armember-membership/trunk/autoload.php?rev=2932691#L571) |  |
  | 571 | 571 | if( current\_user\_can( 'administrator') ) |
  | 572 | 572 | { |
  | 573 |  | $noticeId = isset( $\_POST['notice\_id'] ) ? sanitize\_text\_field($\_POST['notice\_id']) : ''; |
  |  | 573 | $noticeId = isset( $\_POST['notice\_id'] ) ? sanitize\_text\_field($\_POST['notice\_id']) : ''; //phpcs:ignore |
  | 574 | 574 | if ( '' != $noticeId ) { |
  | 575 | 575 | update\_option( 'arm\_' . $noticeId . '\_is\_dismissed', true ); |
  | […](/browser/armember-membership/trunk/autoload.php?rev=2929715#L706) | […](/browser/armember-membership/trunk/autoload.php?rev=2932691#L706) |  |
  | 706 | 706 | } |
  | 707 | 707 | } |
  | 708 |  | echo $notice\_html; |
  |  | 708 | echo $notice\_html; //phpcs:ignore |
  | 709 | 709 | } |
  | 710 | 710 |  |
  | […](/browser/armember-membership/trunk/autoload.php?rev=2929715#L2945) | […](/browser/armember-membership/trunk/autoload.php?rev=2932691#L2945) |  |
  | 2945 | 2945 |  |
  | 2946 | 2946 | function arm\_do\_not\_show\_video() { |
  | 2947 |  | global $wp, $wpdb, $ARMemberLite, $pagenow; |
  | 2948 |  | $isShow = ( isset( $\_POST['isShow'] ) && $\_POST['isShow'] == '0' ) ? 0 : 1; |
  |  | 2947 | global $wp, $wpdb, $ARMemberLite, $pagenow, $arm\_capabilities\_global; |
  |  | 2948 |  |
  |  | 2949 | $ARMemberLite->arm\_check\_user\_cap( $arm\_capabilities\_global['arm\_manage\_general\_settings'], '1' ); |
  |  | 2950 |  |
  |  | 2951 | $isShow = ( isset( $\_POST['isShow'] ) && $\_POST['isShow'] == '0' ) ? 0 : 1; //phpcs:ignore |
  | 2949 | 2952 | $now    = strtotime( current\_time( 'mysql' ) ); |
  | 2950 | 2953 | $time   = strtotime( '+10 day', $now ); |
  | […](/browser/armember-membership/trunk/autoload.php?rev=2929715#L3165) | […](/browser/armember-membership/trunk/autoload.php?rev=2932691#L3168) |  |
  | 3165 | 3168 | return; |
  | 3166 | 3169 | } |
  |  | 3170 | var \_arm\_wpnonce   = jQuery( \'input[name="\_wpnonce"]\' ).val(); |
  | 3167 | 3171 | jQuery.ajax({ |
  | 3168 | 3172 | type: "POST", |
  | 3169 | 3173 | url: \_\_ARMAJAXURL, |
  | 3170 |  | data: "action=arm\_dont\_show\_upgrade\_notice&is\_hide=" + ishide, |
  |  | 3174 | data: "action=arm\_dont\_show\_upgrade\_notice&is\_hide=" + ishide + "&\_wpnonce=" + \_arm\_wpnonce, |
  | 3171 | 3175 | success: function (res) { |
  | 3172 | 3176 |  |
  | […](/browser/armember-membership/trunk/autoload.php?rev=2929715#L3195) | […](/browser/armember-membership/trunk/autoload.php?rev=2932691#L3199) |  |
  | 3195 | 3199 | $arm\_change\_log = array( |
  | 3196 | 3200 | 'show\_critical\_title' => 1, |
  | 3197 |  | 'critical\_title'      => 'Version 4.0.~~5~~ Changes', |
  |  | 3201 | 'critical\_title'      => 'Version 4.0.6 Changes', |
  | 3198 | 3202 | 'critical'            => array( |
  | 3199 | 3203 | 'Minor bug fixes.', |
  | […](/browser/armember-membership/trunk/autoload.php?rev=2929715#L3211) | […](/browser/armember-membership/trunk/autoload.php?rev=2932691#L3215) |  |
  | 3211 | 3215 |  |
  | 3212 | 3216 | function arm\_dont\_show\_upgrade\_notice() { |
  | 3213 |  | global $wp, $wpdb, $ARMemberLite, $pagenow; |
  | 3214 |  | $is\_hide = ( isset( $\_POST['is\_hide'] ) && $\_POST['is\_hide'] == '1' ) ? 1 : 0; |
  |  | 3217 | global $wp, $wpdb, $ARMemberLite, $pagenow, $arm\_capabilities\_global; |
  |  | 3218 |  |
  |  | 3219 | $ARMemberLite->arm\_check\_user\_cap( $arm\_capabilities\_global['arm\_manage\_general\_settings'], '1' ); |
  |  | 3220 |  |
  |  | 3221 | $is\_hide = ( isset( $\_POST['is\_hide'] ) && $\_POST['is\_hide'] == '1' ) ? 1 : 0; //phpcs:ignore |
  | 3215 | 3222 | if ( $is\_hide == 1 ) { |
  | 3216 | 3223 | delete\_option( 'arm\_lite\_new\_version\_installed' ); |
  | […](/browser/armember-membership/trunk/autoload.php?rev=2929715#L3389) | […](/browser/armember-membership/trunk/autoload.php?rev=2932691#L3396) |  |
  | 3389 | 3396 | } |
  | 3390 | 3397 |  |
  | 3391 |  | function arm\_check\_user\_cap( $arm\_capabilities = '', $is\_ajax\_call = ''~~, $nonce\_required = 0~~ ) { |
  |  | 3398 | function arm\_check\_user\_cap( $arm\_capabilities = '', $is\_ajax\_call = '' ) { |
  | 3392 | 3399 | global $arm\_global\_settings; |
  | 3393 | 3400 |  |
  | 3394 | 3401 | $errors  = array(); |
  | 3395 | 3402 | $message = ''; |
  | 3396 |  | if ( $is\_ajax\_call == true || $is\_ajax\_call == '1' || $is\_ajax\_call == 1 ) { |
  | 3397 |  | ~~if ( !~~ current\_user\_can( $arm\_capabilities ) ) { |
  | 3398 |  | $errors[]                = esc\_html\_\_( 'Sorry, You do not have permission to perform this action.', 'armember-membership' ); |
  | 3399 |  | ~~$return\_array            = $arm\_global\_settings->handle\_return\_messages( @$errors, @~~$message ); |
  | 3400 |  | $return\_array['message'] = $return\_array['msg']; |
  | 3401 |  |  |
  | 3402 |  | echo json\_encode( $return\_array ); |
  | 3403 |  | exit; |
  | 3404 |  | } |
  | 3405 |  | } |
  |  | 3403 | //if ( $is\_ajax\_call == true || $is\_ajax\_call == '1' || $is\_ajax\_call == 1 ) { |
  |  | 3404 | if (!empty($arm\_capabilities) &&  !current\_user\_can( $arm\_capabilities ) ) { |
  |  | 3405 | $errors[]                = esc\_html\_\_( 'Sorry, You do not have permission to perform this action.', 'armember-membership' ); |
  |  | 3406 | $return\_array            = $arm\_global\_settings->handle\_return\_messages( $errors, $message ); |
  |  | 3407 | $return\_array['message'] = $return\_array['msg']; |
  |  | 3408 |  |
  |  | 3409 | echo json\_encode( $return\_array ); |
  |  | 3410 | exit; |
  |  | 3411 | } |
  |  | 3412 | //} |
  | 3406 | 3413 |  |
  | 3407 | 3414 | $wpnonce               = isset( $\_REQUEST['\_wpnonce'] ) ? sanitize\_text\_field($\_REQUEST['\_wpnonce']) : ''; |
  | 3408 | 3415 | $arm\_verify\_nonce\_flag = wp\_verify\_nonce( $wpnonce, 'arm\_wp\_nonce' ); |
  | 3409 |  | if ( ! $arm\_verify\_nonce\_flag && ( !empty( $wpnonce ) || !empty($nonce\_required) ) ) { |
  |  | 3416 | //if ( ! $arm\_verify\_nonce\_flag && ( !empty( $wpnonce ) || !empty($nonce\_required) ) ) { |
  |  | 3417 | if(empty( $wpnonce) ) |
  |  | 3418 | { |
  |  | 3419 | $errors[]                = esc\_html\_\_( 'Sorry, Your request can not process due to nonce not found.', 'armember-membership' ); |
  |  | 3420 | $return\_array            = $arm\_global\_settings->handle\_return\_messages( $errors, $message ); |
  |  | 3421 | $return\_array['message'] = $return\_array['msg']; |
  |  | 3422 | echo json\_encode( $return\_array ); |
  |  | 3423 | exit; |
  |  | 3424 | } |
  |  | 3425 | else if( !$arm\_verify\_nonce\_flag ) { |
  | 3410 | 3426 | $errors[]                = esc\_html\_\_( 'Sorry, Your request can not process due to security reason.', 'armember-membership' ); |
  | 3411 |  | $return\_array            = $arm\_global\_settings->handle\_return\_messages( ~~@$errors, @~~$message ); |
  |  | 3427 | $return\_array            = $arm\_global\_settings->handle\_return\_messages( $errors, $message ); |
  | 3412 | 3428 | $return\_array['message'] = $return\_array['msg']; |
  | 3413 | 3429 | echo json\_encode( $return\_array ); |
  | […](/browser/armember-membership/trunk/autoload.php?rev=2929715#L3572) | […](/browser/armember-membership/trunk/autoload.php?rev=2932691#L3588) |  |
  | 3572 | 3588 | } |
  | 3573 | 3589 |  |
  |  | 3590 | function arm\_recursive\_sanitize\_data( $posted\_data ) { |
  |  | 3591 | global $ARMemberLite; |
  |  | 3592 | if ( is\_array( $posted\_data ) ) { |
  |  | 3593 | return array\_map( array( $ARMemberLite, \_\_FUNCTION\_\_ ), json\_decode( json\_encode( $posted\_data ), true ) ); |
  |  | 3594 | } elseif ( is\_object( $posted\_data ) ) { |
  |  | 3595 | return array\_map( array( $ARMemberLite, \_\_FUNCTION\_\_ ), json\_decode( json\_encode( $posted\_data ), true ) ); |
  |  | 3596 | } |
  |  | 3597 |  |
  |  | 3598 | if ( preg\_match( '/^(\d+)$/', $posted\_data ) ) { |
  |  | 3599 | return intval( $posted\_data ); |
  |  | 3600 | } elseif ( preg\_match( '/^(\d+(|\.\d+))$/', $posted\_data ) ) { |
  |  | 3601 | return floatval( $posted\_data ); |
  |  | 3602 | } elseif ( preg\_match( '/<[^<]+>/', $posted\_data ) ) { |
  |  | 3603 | $arplite\_allowed\_html = $ARMemberLite->armember\_allowed\_html\_tags(); |
  |  | 3604 | return wp\_kses( $posted\_data, $arplite\_allowed\_html ); |
  |  | 3605 | } elseif ( filter\_var( $posted\_data, FILTER\_VALIDATE\_URL ) ) { |
  |  | 3606 | return sanitize\_url( $posted\_data ); |
  |  | 3607 | } else { |
  |  | 3608 | return sanitize\_text\_field( $posted\_data ); |
  |  | 3609 | } |
  |  | 3610 | return $posted\_data; |
  |  | 3611 | } |
  |  | 3612 |  |
  | 3574 | 3613 | function armember\_global\_attributes(){ |
  | 3575 | 3614 | return array( |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2932691)
* [Zip Archive](?format=zip&new=2932691)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

