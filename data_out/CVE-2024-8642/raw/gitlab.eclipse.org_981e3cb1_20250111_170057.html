





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header with-system-footer" lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Eclipse EDC: Consumer pull transfer token validation does not apply any rules (e. g., expiration check) (#234) · Issues · Eclipse Projects Security / vulnerability-reports · GitLab</title>
<script>
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.eclipse.org/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="";gon.gitlab_url="https://gitlab.eclipse.org";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="9d81c27eee7";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-d746ae2450a3e9c626d338d77a101b84ff33a47c0c281b676d75c4a6ed2948a4.css";gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=false;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=false;gon.uf_error_prefix="UF";gon.pat_prefix="";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"commentTooltips":false,"glqlIntegration":false,"issueAutocompleteBackendFiltering":false,"workItems":true,"workItemsBeta":false,"workItemsAlpha":false,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"workItemEpics":false};gon.roadmap_epics_limit=1000;gon.licensed_features={"escalationPolicies":true};gon.abilities={"summarizeComments":false};
//]]>
</script>


<script>
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/security/vulnerability-reports/-/issues/234/discussions.json?per_page=20":{},"/security/vulnerability-reports/-/issues/234.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = null;

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"wCQpfJ-L79kkHgmJnFTXyal4-wiWYYb0K6e5dhjJE_jYTOjQdmV46Bx1x9jnqkvkq0HiQCE6GlfTK5fEK-KU7A","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.eclipse.org/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-8276cea79ef526c83539dd54f72382f170a49fbe45332e2f2c132a38880e38ff.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-5915182f24062982294a7689b2e490af18508f930186330e5eb94325919258cc.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-6598dbf61fe32a8ddb1b06150f2301451ad41554975581e771efc5f890d0443f.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-013502814f58518ea802ad05cf9775f47c9933e442b9e59dd4ac2f42fd0b71cf.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-985467dc606e2acde1735b642c5ce237ef7e965ad1c35cf33a4c9beb2ecb05b8.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-d9603c98e9259c19bbb47784abf3b63b5cb7ce8d7463608443b907773ab7197d.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-6e9d4ced3f78abb4b0b5d21e2c5069b8c88f8e045babafc20e3c7f57893d3ee1.css" />
<link rel="stylesheet" href="/assets/tailwind-05270112d01c5ef673f3a3a3f57249974bbc904a2fa6b327a35f12eece635a2b.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-9fc2e7ab1cefbb5a525a1e1b06c04b3141c2179a6d572b1d390cf9db8def8104.css" />


<link rel="preload" href="/assets/application_utilities-6e9d4ced3f78abb4b0b5d21e2c5069b8c88f8e045babafc20e3c7f57893d3ee1.css" as="style" type="text/css">
<link rel="preload" href="/assets/application-8276cea79ef526c83539dd54f72382f170a49fbe45332e2f2c132a38880e38ff.css" as="style" type="text/css">
<link rel="preload" href="/assets/highlight/themes/white-9fc2e7ab1cefbb5a525a1e1b06c04b3141c2179a6d572b1d390cf9db8def8104.css" as="style" type="text/css">




<script src="/assets/webpack/runtime.619e248a.bundle.js" defer="defer"></script>
<script src="/assets/webpack/main.bda67b2a.chunk.js" defer="defer"></script>
<script src="/assets/webpack/10.cfcff625.chunk.js" defer="defer"></script>
<script src="/assets/webpack/12.665b0ed5.chunk.js" defer="defer"></script>
<script src="/assets/webpack/13.f9ad3ff9.chunk.js" defer="defer"></script>
<script src="/assets/webpack/14.9cea632a.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.security.policies.edit-pages.groups.security.policies.new-pages.projects.blob.s-823210c2.3552e27d.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-43c0ecf9.cd411fdc.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.ce957725.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.c75bd97e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/super_sidebar.5bd734bb.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-e1be1070.7e2fa462.chunk.js" defer="defer"></script>
<script src="/assets/webpack/pages.projects.issues.show.684d6478.chunk.js" defer="defer"></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Eclipse EDC: Consumer pull transfer token validation does not apply any rules (e. g., expiration check) (#234) · Issues · Eclipse Projects Security / vulnerability-reports · GitLab" property="og:title">
<meta content=" Basic information Project name: Eclipse EDC Project id: technology.edc Maven artifact: org.eclipse.edc:transfer-data-plane " property="og:description">
<meta content="https://gitlab.eclipse.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/234" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Eclipse EDC: Consumer pull transfer token validation does not apply any rules (e. g., expiration check) (#234) · Issues · Eclipse Projects Security / vulnerability-reports · GitLab" property="twitter:title">
<meta content=" Basic information Project name: Eclipse EDC Project id: technology.edc Maven artifact: org.eclipse.edc:transfer-data-plane " property="twitter:description">
<meta content="https://gitlab.eclipse.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="Thomas Neidhart"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Markus Spiekermann, Paul Latzelsperger, and Philipp Neuschwander">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="AG73zU3gui9nbb9isl8t-C9Evd6gWmyngzLH8y-hcuMYBjZhpA4tHl8GcTPJobHVLX2klhcB8AR7vulBHIr19w" />
<meta name="csp-nonce" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/uploads/-/system/appearance/favicon/1/favicon.ico" id="favicon" data-original-href="/uploads/-/system/appearance/favicon/1/favicon.ico" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content=" Basic information Project name: Eclipse EDC Project id: technology.edc Maven artifact: org.eclipse.edc:transfer-data-plane " name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="security" data-group-full-path="security" data-namespace-id="3675" data-page="projects:issues:show" data-page-type-id="234" data-project="vulnerability-reports" data-project-full-path="security/vulnerability-reports" data-project-id="3804">
<script>
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/security/vulnerability-reports/-/autocomplete_sources/epics","iterations":"/security/vulnerability-reports/-/autocomplete_sources/iterations","vulnerabilities":"/security/vulnerability-reports/-/autocomplete_sources/vulnerabilities","members":"/security/vulnerability-reports/-/autocomplete_sources/members?type=Issue\u0026type_id=234","issues":"/security/vulnerability-reports/-/autocomplete_sources/issues","mergeRequests":"/security/vulnerability-reports/-/autocomplete_sources/merge_requests","labels":"/security/vulnerability-reports/-/autocomplete_sources/labels?type=Issue\u0026type_id=234","milestones":"/security/vulnerability-reports/-/autocomplete_sources/milestones","commands":"/security/vulnerability-reports/-/autocomplete_sources/commands?type=Issue\u0026type_id=234","snippets":"/security/vulnerability-reports/-/autocomplete_sources/snippets","contacts":"/security/vulnerability-reports/-/autocomplete_sources/contacts?type=Issue\u0026type_id=234","wikis":null};


//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" href="/"><img class="brand-header-logo lazy" alt="" data-src="/uploads/-/system/appearance/header_logo/1/ef_logis.png" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" />
</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/security/vulnerability-reports/-/files/main?format=json&quot;,&quot;project_blob_url&quot;:&quot;/security/vulnerability-reports/-/blob/main&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="false" data-root-path="/" data-sidebar="{&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;vulnerability-reports&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:3804,&quot;link&quot;:&quot;/security/vulnerability-reports&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar&quot;:null,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/activity&quot;,&quot;is_active&quot;:false,&quot;pill_count&quot;:null,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/activity&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/project_members&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/labels&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar&quot;:null,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/issues&quot;,&quot;is_active&quot;:true,&quot;pill_count&quot;:null,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/issues&quot;,&quot;pill_count&quot;:&quot;0&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/boards&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/milestones&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/cadences&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar&quot;:null,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/ml/models&quot;,&quot;is_active&quot;:false,&quot;pill_count&quot;:null,&quot;items&quot;:[{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/ml/models&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://wiki.eclipse.org/Gitlab&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:false,&quot;show_version_check&quot;:false,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:3675,&quot;name&quot;:&quot;Eclipse Projects Security&quot;,&quot;full_name&quot;:&quot;Eclipse Projects Security&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/security/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/security/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:3804,&quot;name&quot;:&quot;vulnerability-reports&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/security/vulnerability-reports/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/security/vulnerability-reports/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">

<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">




























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Eclipse Projects Security","item":"https://gitlab.eclipse.org/security"},{"@type":"ListItem","position":2,"name":"vulnerability-reports","item":"https://gitlab.eclipse.org/security/vulnerability-reports"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.eclipse.org/security/vulnerability-reports/-/issues"},{"@type":"ListItem","position":4,"name":"#234","item":"https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/234"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;Eclipse Projects Security&quot;,&quot;href&quot;:&quot;/security&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;vulnerability-reports&quot;,&quot;href&quot;:&quot;/security/vulnerability-reports&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/security/vulnerability-reports/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#234&quot;,&quot;href&quot;:&quot;/security/vulnerability-reports/-/issues/234&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/security/vulnerability-reports/-/issues/234&quot;,&quot;new_issue_path&quot;:&quot;/security/vulnerability-reports/-/issues/new?add_related_issue=234&quot;,&quot;project_path&quot;:&quot;security/vulnerability-reports&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:1708,&quot;reported_from_url&quot;:&quot;https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/234&quot;,&quot;submit_as_spam_path&quot;:&quot;/security/vulnerability-reports/-/issues/234/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/security/vulnerability-reports/-/issues/234&quot;,&quot;updateEndpoint&quot;:&quot;/security/vulnerability-reports/-/issues/234.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#234&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/security/vulnerability-reports/-/preview_markdown?target_id=234\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:0,&quot;issuableTemplateNamesPath&quot;:&quot;/security/vulnerability-reports/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Eclipse EDC: Consumer pull transfer token validation does not apply any rules (e. g., expiration check)&quot;,&quot;initialTitleText&quot;:&quot;Eclipse EDC: Consumer pull transfer token validation does not apply any rules (e. g., expiration check)&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u0026#x000A;\u0026#x000A;\u003ch2 data-sourcepos=\&quot;29:1-29:20\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#basic-information\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-basic-information\&quot;\u003e\u003c/a\u003eBasic information\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;33:1-33:29\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;33:1-33:17\&quot;\u003eProject name:\u003c/strong\u003e Eclipse EDC\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;37:1-37:30\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;37:1-37:15\&quot;\u003eProject id:\u003c/strong\u003e technology.edc\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;41:1-41:55\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;41:1-41:19\&quot;\u003eMaven artifact:\u003c/strong\u003e org.eclipse.edc:transfer-data-plane\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;45:1-45:34\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#what-are-the-affected-versions\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-what-are-the-affected-versions\&quot;\u003e\u003c/a\u003eWhat are the affected versions?\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;49:1-49:17\&quot; dir=\&quot;auto\&quot;\u003e[0.5.0 - current]\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;53:1-53:211\&quot; dir=\&quot;auto\&quot;\u003eWho is affected: Anyone using EDC version 0.5.0 or newer if they (a) have a dataplane configured to support http proxy consumer pull AND (b) include the modules \&quot;transfer-data-plane\&quot; and \&quot;data-plane-public-api\&quot;.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;57:1-57:23\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#details-of-the-issue\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-details-of-the-issue\&quot;\u003e\u003c/a\u003eDetails of the issue\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;61:1-61:127\&quot; dir=\&quot;auto\&quot;\u003eThe issue is located in the \u003ccode data-sourcepos=\&quot;61:30-61:77\&quot;\u003eConsumerPullTransferTokenValidationApiController\u003c/code\u003e at this position in the code (\&quot;issue location\&quot;):\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;63:1-63:274\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/api/ConsumerPullTransferTokenValidationApiController.java#L60\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/api/ConsumerPullTransferTokenValidationApiController.java#L60\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;67:1-67:65\&quot; dir=\&quot;auto\&quot;\u003eThe \u003ccode data-sourcepos=\&quot;67:6-67:27\&quot;\u003eTokenValidationService\u003c/code\u003e&#39;s validate method takes 3 arguments:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;69:1-69:101\&quot; dir=\&quot;auto\&quot;\u003e\u003ccode data-sourcepos=\&quot;69:2-69:99\&quot;\u003evalidate(@NotNull String token, PublicKeyResolver publicKeyResolver, TokenValidationRule... rules)\u003c/code\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;71:1-71:60\&quot; dir=\&quot;auto\&quot;\u003eBut only two arguments are provided in the \&quot;issue location\&quot;.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;73:1-73:78\&quot; dir=\&quot;auto\&quot;\u003eThe third argument determines which rules should be checked during validation.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;75:1-75:78\&quot; dir=\&quot;auto\&quot;\u003eTherefore, we will have an empty array at runtime, resulting in an empty list.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;79:1-79:295\&quot; dir=\&quot;auto\&quot;\u003eThe \u003ca data-sourcepos=\&quot;79:5-79:295\&quot; href=\&quot;https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/validation/ExpirationDateValidationRule.java\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003e\u003ccode data-sourcepos=\&quot;79:7-79:34\&quot;\u003eExpirationDateValidationRule\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;81:1-81:88\&quot; dir=\&quot;auto\&quot;\u003eshould be checked for context \u003ccode data-sourcepos=\&quot;81:32-81:86\&quot;\u003eTRANSFER_DATAPLANE_TOKEN_CONTEXT = \&quot;dataplane-transfer\&quot;\u003c/code\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;83:1-83:308\&quot; dir=\&quot;auto\&quot;\u003eSee \u003ca data-sourcepos=\&quot;83:5-83:307\&quot; href=\&quot;https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/TransferDataPlaneCoreExtension.java#L127\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eregistration to \u003ccode data-sourcepos=\&quot;83:23-83:50\&quot;\u003etokenValidationRulesRegistry\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;87:1-87:73\&quot; dir=\&quot;auto\&quot;\u003eBut the \u003ccode data-sourcepos=\&quot;87:10-87:37\&quot;\u003etokenValidationRulesRegistry\u003c/code\u003e is never queried for that context.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;89:1-89:168\&quot; dir=\&quot;auto\&quot;\u003eIn the \&quot;issue location\&quot; mentioned above, there should be something like \u003ccode data-sourcepos=\&quot;89:74-89:144\&quot;\u003etokenValidationRulesRegistry.getRules(TRANSFER_DATAPLANE_TOKEN_CONTEXT)\u003c/code\u003e as the third argument.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;93:1-93:92\&quot; dir=\&quot;auto\&quot;\u003eLacking this third argument causes that the token is only checked regarding valid signature.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;95:1-95:93\&quot; dir=\&quot;auto\&quot;\u003eThe expiration is not checked, i.e., expired tokens will indefinitely be considered as valid.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;99:1-99:382\&quot; dir=\&quot;auto\&quot;\u003eThe logic of the \&quot;issue location\&quot; / \u003ccode data-sourcepos=\&quot;99:38-99:85\&quot;\u003eConsumerPullTransferTokenValidationApiController\u003c/code\u003e is used for example in \u003ca data-sourcepos=\&quot;99:111-99:381\&quot; href=\&quot;https://github.com/eclipse-edc/Connector/blob/4e143774a2e844fb7c7883f06139d8100c5bd73d/extensions/data-plane/data-plane-public-api/src/main/java/org/eclipse/edc/connector/dataplane/api/validation/ConsumerPullTransferDataAddressResolver.java#L51\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003econsumer pull scenarios\u003c/a\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;103:1-103:137\&quot; dir=\&quot;auto\&quot;\u003eIn a Consumer Pull scenario the consumer / consumer-side systems can \&quot;pull data\&quot; from the provider using the token beyond its expiration.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;105:1-105:206\&quot; dir=\&quot;auto\&quot;\u003eBut data cannot only be pulled from the provider by the consumer. With EDC, \&quot;data transfers\&quot; can be used to modify resources at the provider side. Therefore, the impact of this vulnerability can be twofold:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;107:1-112:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;107:1-108:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;107:4-107:228\&quot;\u003eData can be pulled / data sources can be queried longer than actors are allowed to do so. This threatens confidentiality of the resources as consumers (that are no longer allowed to access the data) can still access the data.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;109:1-112:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;109:4-109:633\&quot;\u003eThere is a feature in EDC to proxy / forward the http request method, path, parameters, payload of the pull towards the data source (i.e., one can effectively expose a Web API to the consumer that can have POST endpoints and accepts payloads etc.). One can use consumer pull to issue an API call (with payload) to the provider&#39;s data source and receive the response (proxyMethod/Path/Payload/... feature enables some kind of bi-directional data transfer). Therefore, the threat is not limited to confidentiality / accessing resources longer than allowed but also to modify resources beyond the time allowed =\u0026gt; threatens integrity.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;113:1-113:138\&quot; dir=\&quot;auto\&quot;\u003eResult: Defective expiration / revocation of permissions granted to an entity to access / modify protected (possibly sensitive) resources.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;115:1-115:111\&quot; dir=\&quot;auto\&quot;\u003eIn case the token leaks, entities that were never allowed to access the resources can access them indefinitely.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;119:1-119:196\&quot; dir=\&quot;auto\&quot;\u003eThe only way to prevent access to the resources beyond expiration might be to block all accesses to the public (consumer pull) endpoint until a fix is available and the connector has been updated.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;123:1-123:262\&quot; dir=\&quot;auto\&quot;\u003eAs far as I was able to track, the issue / vulnerability has been introduced with version v0.5.0 via commit \u003ca href=\&quot;https://github.com/eclipse-edc/Connector/commit/19ebb19495dc78c5b27b925baaf378b7e85885c7\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/eclipse-edc/Connector/commit/19ebb19495dc78c5b27b925baaf378b7e85885c7\u003c/a\u003e and is still present in main branch (i.e., most recent versions).\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;127:1-127:101\&quot; dir=\&quot;auto\&quot;\u003eThe issue is located in the maven artifact \&quot;org.eclipse.edc:transfer-data-plane\&quot; ([0.5.0 - current]).\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;131:1-131:37\&quot; dir=\&quot;auto\&quot;\u003eI&#39;m unsure which CWEs suit best here.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;133:1-133:75\&quot; dir=\&quot;auto\&quot;\u003eAll in all, the issue is a missing check regarding the expiration of a JWT.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;135:1-135:179\&quot; dir=\&quot;auto\&quot;\u003eSo the JWT can be used to access the data source (i.e., a HTTP Endpoint; possibly with the http request method, path, parameter, payload of ones choice) way beyond its expiration.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;139:1-139:36\&quot; dir=\&quot;auto\&quot;\u003eI would grade the vulnerability as a\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;143:1-143:63\&quot; dir=\&quot;auto\&quot;\u003eCVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:N/VA:L/SC:H/SI:H/SA:L\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;147:1-147:10\&quot; dir=\&quot;auto\&quot;\u003e5.6 Medium\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;151:1-174:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;151:1-152:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;151:3-151:106\&quot;\u003eAV Network, because the (consumer pull) public endpoint at the provider side is exposed to the internet.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;153:1-154:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;153:3-153:109\&quot;\u003eAC Low, as consumers can just keep using their system to access the resources beyond token expiration time.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;155:1-156:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;155:3-155:313\&quot;\u003eAT Present, as the consumer needs to have negotiated a contract agreement with the provider and requested a data transfer using http proxy consumer pull method to get the EDR with the token. To threat integrity of subsequent systems, proxyMethod/Path/Payload/... configuration needs to be enabled for the asset.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;157:1-158:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;157:3-157:123\&quot;\u003ePR Low, one needs access to the consumer&#39;s system to request the data from the provider&#39;s public (consumer pull) endpoint\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;159:1-160:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;159:3-159:50\&quot;\u003eUI none, no additional user interaction required\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;161:1-162:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;161:3-161:73\&quot;\u003eVC none, as no information is leaked from the connector / control plane\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;163:1-164:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;163:3-163:43\&quot;\u003eVI none, no state change in the connector\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;165:1-166:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;165:3-165:135\&quot;\u003eVA low, small load on the connector to check the token and to proxy/forward the request to the subsequent system (data source / API).\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;167:1-168:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;167:3-167:201\&quot;\u003eSC high, (at least potentially) as the data / API access is provided based on strict policies to other data space participants that must meet certain criteria. =\u0026gt; potentially access to sensitive data\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;169:1-170:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;169:3-169:220\&quot;\u003eSI high, (at least potentially) as the data / API access is provided based on strict policies to other data space participants that must meet certain criteria. =\u0026gt; potentially access to business critical systems / APIs?\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;171:1-174:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;171:3-171:45\&quot;\u003eSA low, load on the subsequent system / API\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;175:1-175:144\&quot; dir=\&quot;auto\&quot;\u003ePlease let me know if the above description is sufficient to understand and assess the vulnerability and what are the next steps in the process.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;179:1-179:21\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-steps-to-reproduce\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;183:1-183:135\&quot; dir=\&quot;auto\&quot;\u003eRun the sample: \u003ca href=\&quot;https://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;187:1-187:272\&quot; dir=\&quot;auto\&quot;\u003eMake sure to use a version before commit \u003ca href=\&quot;https://github.com/eclipse-edc/Samples/commit/e2387fc2e5560c1b84c5a3fd33a776d6792aa0e7\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/eclipse-edc/Samples/commit/e2387fc2e5560c1b84c5a3fd33a776d6792aa0e7\u003c/a\u003e (in that commit they switched from \&quot;transfer-data-plane\&quot;/\&quot;data-plane-public-api\&quot; to \&quot;transfer-data-plane-signaling\&quot;/\&quot;data-plane-public-api-v2\&quot;).\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;191:1-191:67\&quot; dir=\&quot;auto\&quot;\u003eI tested it with revision 3a08baeb959b4bc177a3b80814abddd2f37fb254.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;195:1-195:119\&quot; dir=\&quot;auto\&quot;\u003eMake sure to use Linux to run the samples (because of \u003ca data-sourcepos=\&quot;195:55-195:118\&quot; href=\&quot;https://github.com/eclipse-edc/Connector/issues/4219\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ethis bug\u003c/a\u003e)\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;199:1-199:202\&quot; dir=\&quot;auto\&quot;\u003eUse the token to retrieve the data (see \u003ca data-sourcepos=\&quot;199:41-199:200\&quot; href=\&quot;https://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull#4-check-the-data\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003e4. step of the guide\u003c/a\u003e).\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;203:1-203:210\&quot; dir=\&quot;auto\&quot;\u003eYou can inspect the token using \u003ca data-sourcepos=\&quot;203:33-203:57\&quot; href=\&quot;https://jwt.io/\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ejwt.io\u003c/a\u003e (by default, the token expires 10 minutes after being issued). Wait 10 minutes, token should be expired then. Repeat step 4. =\u0026gt; Token is still accepted.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;207:1-207:76\&quot; dir=\&quot;auto\&quot;\u003eYou can observe that the token / authCode can be used beyond its expiration.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;211:1-211:44\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#do-you-know-any-mitigations-of-the-issue\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-do-you-know-any-mitigations-of-the-issue\&quot;\u003e\u003c/a\u003eDo you know any mitigations of the issue?\u003c/h2\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;215:1-218:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;215:1-218:0\&quot;\u003eBlock access to the public (consumer pull) endpoint.\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;219:1-219:35\&quot; dir=\&quot;auto\&quot;\u003eOnce version with fix is available:\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;223:1-228:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;223:1-224:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;223:3-223:28\&quot;\u003eUpdate to version with fix\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;225:1-228:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;225:3-225:56\&quot;\u003eUnblock access to the public (consumer pull) endpoint.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;229:1-229:209\&quot; dir=\&quot;auto\&quot;\u003eOr take the chance to get rid of deprecated \&quot;data-plane-public-api\&quot; and switch to \&quot;data-plane-public-api-v2\&quot; (which is not using the \u003ccode data-sourcepos=\&quot;229:135-229:182\&quot;\u003eConsumerPullTransferTokenValidationApiController\u003c/code\u003e with the missing checks).\u003c/p\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;\u003c!--\n\nNote that this issue is configured (see the quick actions at the bottom) to be created as confidential.\n\n \n\nNote that a vulnerability does not need to actually be resolved before it is reported and that these reports can be revised as needed (reopen the issue to request changes).\n\n \n\nIf you do not know how to fill certain fields, mark that in the comment and we will help you.\n\n \n\nYou can delete the comments (or not).\n\n--\u003e\n\n \n\n\u003c!--\n\nRequired. Specify the project&#39;s name (e.g., \&quot;Eclipse Dash\&quot;) and Eclipse Foundation ID, e.g., \&quot;technology.dash\&quot;.\n\n--\u003e\n\n \n\n## Basic information\n\n \n\n**Project name:** Eclipse EDC\n\n \n\n**Project id:** technology.edc\n\n \n\n**Maven artifact:** org.eclipse.edc:transfer-data-plane\n\n \n\n## What are the affected versions?\n\n \n\n[0.5.0 - current]\n\n \n\nWho is affected: Anyone using EDC version 0.5.0 or newer if they (a) have a dataplane configured to support http proxy consumer pull AND (b) include the modules \&quot;transfer-data-plane\&quot; and \&quot;data-plane-public-api\&quot;.\n\n \n\n## Details of the issue\n\n \n\nThe issue is located in the `ConsumerPullTransferTokenValidationApiController` at this position in the code (\&quot;issue location\&quot;):\n\nhttps://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/api/ConsumerPullTransferTokenValidationApiController.java#L60\n\n \n\nThe `TokenValidationService`&#39;s validate method takes 3 arguments:\n\n`validate(@NotNull String token, PublicKeyResolver publicKeyResolver, TokenValidationRule... rules)`.\n\nBut only two arguments are provided in the \&quot;issue location\&quot;.\n\nThe third argument determines which rules should be checked during validation.\n\nTherefore, we will have an empty array at runtime, resulting in an empty list.\n\n \n\nThe [`ExpirationDateValidationRule`](https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/validation/ExpirationDateValidationRule.java)\n\nshould be checked for context `TRANSFER_DATAPLANE_TOKEN_CONTEXT = \&quot;dataplane-transfer\&quot;`.\n\nSee [registration to `tokenValidationRulesRegistry`](https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/TransferDataPlaneCoreExtension.java#L127).\n\n \n\nBut the `tokenValidationRulesRegistry` is never queried for that context.\n\nIn the \&quot;issue location\&quot; mentioned above, there should be something like `tokenValidationRulesRegistry.getRules(TRANSFER_DATAPLANE_TOKEN_CONTEXT)` as the third argument.\n\n \n\nLacking this third argument causes that the token is only checked regarding valid signature.\n\nThe expiration is not checked, i.e., expired tokens will indefinitely be considered as valid.\n\n \n\nThe logic of the \&quot;issue location\&quot; / `ConsumerPullTransferTokenValidationApiController` is used for example in [consumer pull scenarios](https://github.com/eclipse-edc/Connector/blob/4e143774a2e844fb7c7883f06139d8100c5bd73d/extensions/data-plane/data-plane-public-api/src/main/java/org/eclipse/edc/connector/dataplane/api/validation/ConsumerPullTransferDataAddressResolver.java#L51).\n\n \n\nIn a Consumer Pull scenario the consumer / consumer-side systems can \&quot;pull data\&quot; from the provider using the token beyond its expiration.\n\nBut data cannot only be pulled from the provider by the consumer. With EDC, \&quot;data transfers\&quot; can be used to modify resources at the provider side. Therefore, the impact of this vulnerability can be twofold:\n\n1. Data can be pulled / data sources can be queried longer than actors are allowed to do so. This threatens confidentiality of the resources as consumers (that are no longer allowed to access the data) can still access the data.\n\n2. There is a feature in EDC to proxy / forward the http request method, path, parameters, payload of the pull towards the data source (i.e., one can effectively expose a Web API to the consumer that can have POST endpoints and accepts payloads etc.). One can use consumer pull to issue an API call (with payload) to the provider&#39;s data source and receive the response (proxyMethod/Path/Payload/... feature enables some kind of bi-directional data transfer). Therefore, the threat is not limited to confidentiality / accessing resources longer than allowed but also to modify resources beyond the time allowed =\u003e threatens integrity.\n\n \n\nResult: Defective expiration / revocation of permissions granted to an entity to access / modify protected (possibly sensitive) resources.\n\nIn case the token leaks, entities that were never allowed to access the resources can access them indefinitely.\n\n \n\nThe only way to prevent access to the resources beyond expiration might be to block all accesses to the public (consumer pull) endpoint until a fix is available and the connector has been updated.\n\n \n\nAs far as I was able to track, the issue / vulnerability has been introduced with version v0.5.0 via commit https://github.com/eclipse-edc/Connector/commit/19ebb19495dc78c5b27b925baaf378b7e85885c7 and is still present in main branch (i.e., most recent versions).\n\n \n\nThe issue is located in the maven artifact \&quot;org.eclipse.edc:transfer-data-plane\&quot; ([0.5.0 - current]).\n\n \n\nI&#39;m unsure which CWEs suit best here.\n\nAll in all, the issue is a missing check regarding the expiration of a JWT.\n\nSo the JWT can be used to access the data source (i.e., a HTTP Endpoint; possibly with the http request method, path, parameter, payload of ones choice) way beyond its expiration.\n\n \n\nI would grade the vulnerability as a\n\n \n\nCVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:N/VA:L/SC:H/SI:H/SA:L\n\n \n\n5.6 Medium\n\n \n\n- AV Network, because the (consumer pull) public endpoint at the provider side is exposed to the internet.\n\n- AC Low, as consumers can just keep using their system to access the resources beyond token expiration time.\n\n- AT Present, as the consumer needs to have negotiated a contract agreement with the provider and requested a data transfer using http proxy consumer pull method to get the EDR with the token. To threat integrity of subsequent systems, proxyMethod/Path/Payload/... configuration needs to be enabled for the asset.\n\n- PR Low, one needs access to the consumer&#39;s system to request the data from the provider&#39;s public (consumer pull) endpoint\n\n- UI none, no additional user interaction required\n\n- VC none, as no information is leaked from the connector / control plane\n\n- VI none, no state change in the connector\n\n- VA low, small load on the connector to check the token and to proxy/forward the request to the subsequent system (data source / API).\n\n- SC high, (at least potentially) as the data / API access is provided based on strict policies to other data space participants that must meet certain criteria. =\u003e potentially access to sensitive data\n\n- SI high, (at least potentially) as the data / API access is provided based on strict policies to other data space participants that must meet certain criteria. =\u003e potentially access to business critical systems / APIs?\n\n- SA low, load on the subsequent system / API\n\n \n\nPlease let me know if the above description is sufficient to understand and assess the vulnerability and what are the next steps in the process.\n\n \n\n## Steps to reproduce\n\n \n\nRun the sample: https://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull\n\n \n\nMake sure to use a version before commit https://github.com/eclipse-edc/Samples/commit/e2387fc2e5560c1b84c5a3fd33a776d6792aa0e7 (in that commit they switched from \&quot;transfer-data-plane\&quot;/\&quot;data-plane-public-api\&quot; to \&quot;transfer-data-plane-signaling\&quot;/\&quot;data-plane-public-api-v2\&quot;).\n\n \n\nI tested it with revision 3a08baeb959b4bc177a3b80814abddd2f37fb254.\n\n \n\nMake sure to use Linux to run the samples (because of [this bug](https://github.com/eclipse-edc/Connector/issues/4219))\n\n \n\nUse the token to retrieve the data (see [4. step of the guide](https://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull#4-check-the-data)).\n\n \n\nYou can inspect the token using [jwt.io](https://jwt.io/) (by default, the token expires 10 minutes after being issued). Wait 10 minutes, token should be expired then. Repeat step 4. =\u003e Token is still accepted.\n\n \n\nYou can observe that the token / authCode can be used beyond its expiration.\n\n \n\n## Do you know any mitigations of the issue?\n\n \n\n- Block access to the public (consumer pull) endpoint.\n\n \n\nOnce version with fix is available:\n\n \n\n- Update to version with fix\n\n- Unblock access to the public (consumer pull) endpoint.\n\n \n\nOr take the chance to get rid of deprecated \&quot;data-plane-public-api\&quot; and switch to \&quot;data-plane-public-api-v2\&quot; (which is not using the `ConsumerPullTransferTokenValidationApiController` with the missing checks).\n\n \n\n\u003c!--\n\n  Please, do not remove the line below. It will create a confidential issue that will be visible\n\n  only to you and the members of this project. Confidential issues are used to keep security\n\n  vulnerabilities private until they are sorted out.\n\n  Eclipse Projects follow Responsible Disclosure best practices: the initial report is made privately,\n\n  but with the full details being published once a patch has been made available (sometimes with\n\n  a delay to allow more time for the patches to be installed).\n\n--\u003e&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;security/vulnerability-reports&quot;,&quot;iid&quot;:234,&quot;issuableId&quot;:665613,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:1708,&quot;authorName&quot;:&quot;Thomas Neidhart&quot;,&quot;authorUsername&quot;:&quot;netomi&quot;,&quot;authorWebUrl&quot;:&quot;/netomi&quot;,&quot;createdAt&quot;:&quot;2024-07-23T15:27:26+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:3804,&quot;projectPath&quot;:&quot;vulnerability-reports&quot;,&quot;projectNamespace&quot;:&quot;security&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Eclipse EDC: Consumer pull transfer token validation does not apply any rules (e. g., expiration check)</h1>
</div>
<div class="description">
<div class="md">&#x000A;&#x000A;<h2 data-sourcepos="29:1-29:20" dir="auto">&#x000A;<a href="#basic-information" aria-hidden="true" class="anchor" id="user-content-basic-information"></a>Basic information</h2>&#x000A;<p data-sourcepos="33:1-33:29" dir="auto"><strong data-sourcepos="33:1-33:17">Project name:</strong> Eclipse EDC</p>&#x000A;<p data-sourcepos="37:1-37:30" dir="auto"><strong data-sourcepos="37:1-37:15">Project id:</strong> technology.edc</p>&#x000A;<p data-sourcepos="41:1-41:55" dir="auto"><strong data-sourcepos="41:1-41:19">Maven artifact:</strong> org.eclipse.edc:transfer-data-plane</p>&#x000A;<h2 data-sourcepos="45:1-45:34" dir="auto">&#x000A;<a href="#what-are-the-affected-versions" aria-hidden="true" class="anchor" id="user-content-what-are-the-affected-versions"></a>What are the affected versions?</h2>&#x000A;<p data-sourcepos="49:1-49:17" dir="auto">[0.5.0 - current]</p>&#x000A;<p data-sourcepos="53:1-53:211" dir="auto">Who is affected: Anyone using EDC version 0.5.0 or newer if they (a) have a dataplane configured to support http proxy consumer pull AND (b) include the modules "transfer-data-plane" and "data-plane-public-api".</p>&#x000A;<h2 data-sourcepos="57:1-57:23" dir="auto">&#x000A;<a href="#details-of-the-issue" aria-hidden="true" class="anchor" id="user-content-details-of-the-issue"></a>Details of the issue</h2>&#x000A;<p data-sourcepos="61:1-61:127" dir="auto">The issue is located in the <code data-sourcepos="61:30-61:77">ConsumerPullTransferTokenValidationApiController</code> at this position in the code ("issue location"):</p>&#x000A;<p data-sourcepos="63:1-63:274" dir="auto"><a href="https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/api/ConsumerPullTransferTokenValidationApiController.java#L60" rel="nofollow noreferrer noopener" target="_blank">https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/api/ConsumerPullTransferTokenValidationApiController.java#L60</a></p>&#x000A;<p data-sourcepos="67:1-67:65" dir="auto">The <code data-sourcepos="67:6-67:27">TokenValidationService</code>'s validate method takes 3 arguments:</p>&#x000A;<p data-sourcepos="69:1-69:101" dir="auto"><code data-sourcepos="69:2-69:99">validate(@NotNull String token, PublicKeyResolver publicKeyResolver, TokenValidationRule... rules)</code>.</p>&#x000A;<p data-sourcepos="71:1-71:60" dir="auto">But only two arguments are provided in the "issue location".</p>&#x000A;<p data-sourcepos="73:1-73:78" dir="auto">The third argument determines which rules should be checked during validation.</p>&#x000A;<p data-sourcepos="75:1-75:78" dir="auto">Therefore, we will have an empty array at runtime, resulting in an empty list.</p>&#x000A;<p data-sourcepos="79:1-79:295" dir="auto">The <a data-sourcepos="79:5-79:295" href="https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/validation/ExpirationDateValidationRule.java" rel="nofollow noreferrer noopener" target="_blank"><code data-sourcepos="79:7-79:34">ExpirationDateValidationRule</code></a></p>&#x000A;<p data-sourcepos="81:1-81:88" dir="auto">should be checked for context <code data-sourcepos="81:32-81:86">TRANSFER_DATAPLANE_TOKEN_CONTEXT = "dataplane-transfer"</code>.</p>&#x000A;<p data-sourcepos="83:1-83:308" dir="auto">See <a data-sourcepos="83:5-83:307" href="https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/TransferDataPlaneCoreExtension.java#L127" rel="nofollow noreferrer noopener" target="_blank">registration to <code data-sourcepos="83:23-83:50">tokenValidationRulesRegistry</code></a>.</p>&#x000A;<p data-sourcepos="87:1-87:73" dir="auto">But the <code data-sourcepos="87:10-87:37">tokenValidationRulesRegistry</code> is never queried for that context.</p>&#x000A;<p data-sourcepos="89:1-89:168" dir="auto">In the "issue location" mentioned above, there should be something like <code data-sourcepos="89:74-89:144">tokenValidationRulesRegistry.getRules(TRANSFER_DATAPLANE_TOKEN_CONTEXT)</code> as the third argument.</p>&#x000A;<p data-sourcepos="93:1-93:92" dir="auto">Lacking this third argument causes that the token is only checked regarding valid signature.</p>&#x000A;<p data-sourcepos="95:1-95:93" dir="auto">The expiration is not checked, i.e., expired tokens will indefinitely be considered as valid.</p>&#x000A;<p data-sourcepos="99:1-99:382" dir="auto">The logic of the "issue location" / <code data-sourcepos="99:38-99:85">ConsumerPullTransferTokenValidationApiController</code> is used for example in <a data-sourcepos="99:111-99:381" href="https://github.com/eclipse-edc/Connector/blob/4e143774a2e844fb7c7883f06139d8100c5bd73d/extensions/data-plane/data-plane-public-api/src/main/java/org/eclipse/edc/connector/dataplane/api/validation/ConsumerPullTransferDataAddressResolver.java#L51" rel="nofollow noreferrer noopener" target="_blank">consumer pull scenarios</a>.</p>&#x000A;<p data-sourcepos="103:1-103:137" dir="auto">In a Consumer Pull scenario the consumer / consumer-side systems can "pull data" from the provider using the token beyond its expiration.</p>&#x000A;<p data-sourcepos="105:1-105:206" dir="auto">But data cannot only be pulled from the provider by the consumer. With EDC, "data transfers" can be used to modify resources at the provider side. Therefore, the impact of this vulnerability can be twofold:</p>&#x000A;<ol data-sourcepos="107:1-112:0" dir="auto">&#x000A;<li data-sourcepos="107:1-108:0">&#x000A;<p data-sourcepos="107:4-107:228">Data can be pulled / data sources can be queried longer than actors are allowed to do so. This threatens confidentiality of the resources as consumers (that are no longer allowed to access the data) can still access the data.</p>&#x000A;</li>&#x000A;<li data-sourcepos="109:1-112:0">&#x000A;<p data-sourcepos="109:4-109:633">There is a feature in EDC to proxy / forward the http request method, path, parameters, payload of the pull towards the data source (i.e., one can effectively expose a Web API to the consumer that can have POST endpoints and accepts payloads etc.). One can use consumer pull to issue an API call (with payload) to the provider's data source and receive the response (proxyMethod/Path/Payload/... feature enables some kind of bi-directional data transfer). Therefore, the threat is not limited to confidentiality / accessing resources longer than allowed but also to modify resources beyond the time allowed =&gt; threatens integrity.</p>&#x000A;</li>&#x000A;</ol>&#x000A;<p data-sourcepos="113:1-113:138" dir="auto">Result: Defective expiration / revocation of permissions granted to an entity to access / modify protected (possibly sensitive) resources.</p>&#x000A;<p data-sourcepos="115:1-115:111" dir="auto">In case the token leaks, entities that were never allowed to access the resources can access them indefinitely.</p>&#x000A;<p data-sourcepos="119:1-119:196" dir="auto">The only way to prevent access to the resources beyond expiration might be to block all accesses to the public (consumer pull) endpoint until a fix is available and the connector has been updated.</p>&#x000A;<p data-sourcepos="123:1-123:262" dir="auto">As far as I was able to track, the issue / vulnerability has been introduced with version v0.5.0 via commit <a href="https://github.com/eclipse-edc/Connector/commit/19ebb19495dc78c5b27b925baaf378b7e85885c7" rel="nofollow noreferrer noopener" target="_blank">https://github.com/eclipse-edc/Connector/commit/19ebb19495dc78c5b27b925baaf378b7e85885c7</a> and is still present in main branch (i.e., most recent versions).</p>&#x000A;<p data-sourcepos="127:1-127:101" dir="auto">The issue is located in the maven artifact "org.eclipse.edc:transfer-data-plane" ([0.5.0 - current]).</p>&#x000A;<p data-sourcepos="131:1-131:37" dir="auto">I'm unsure which CWEs suit best here.</p>&#x000A;<p data-sourcepos="133:1-133:75" dir="auto">All in all, the issue is a missing check regarding the expiration of a JWT.</p>&#x000A;<p data-sourcepos="135:1-135:179" dir="auto">So the JWT can be used to access the data source (i.e., a HTTP Endpoint; possibly with the http request method, path, parameter, payload of ones choice) way beyond its expiration.</p>&#x000A;<p data-sourcepos="139:1-139:36" dir="auto">I would grade the vulnerability as a</p>&#x000A;<p data-sourcepos="143:1-143:63" dir="auto">CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:N/VA:L/SC:H/SI:H/SA:L</p>&#x000A;<p data-sourcepos="147:1-147:10" dir="auto">5.6 Medium</p>&#x000A;<ul data-sourcepos="151:1-174:0" dir="auto">&#x000A;<li data-sourcepos="151:1-152:0">&#x000A;<p data-sourcepos="151:3-151:106">AV Network, because the (consumer pull) public endpoint at the provider side is exposed to the internet.</p>&#x000A;</li>&#x000A;<li data-sourcepos="153:1-154:0">&#x000A;<p data-sourcepos="153:3-153:109">AC Low, as consumers can just keep using their system to access the resources beyond token expiration time.</p>&#x000A;</li>&#x000A;<li data-sourcepos="155:1-156:0">&#x000A;<p data-sourcepos="155:3-155:313">AT Present, as the consumer needs to have negotiated a contract agreement with the provider and requested a data transfer using http proxy consumer pull method to get the EDR with the token. To threat integrity of subsequent systems, proxyMethod/Path/Payload/... configuration needs to be enabled for the asset.</p>&#x000A;</li>&#x000A;<li data-sourcepos="157:1-158:0">&#x000A;<p data-sourcepos="157:3-157:123">PR Low, one needs access to the consumer's system to request the data from the provider's public (consumer pull) endpoint</p>&#x000A;</li>&#x000A;<li data-sourcepos="159:1-160:0">&#x000A;<p data-sourcepos="159:3-159:50">UI none, no additional user interaction required</p>&#x000A;</li>&#x000A;<li data-sourcepos="161:1-162:0">&#x000A;<p data-sourcepos="161:3-161:73">VC none, as no information is leaked from the connector / control plane</p>&#x000A;</li>&#x000A;<li data-sourcepos="163:1-164:0">&#x000A;<p data-sourcepos="163:3-163:43">VI none, no state change in the connector</p>&#x000A;</li>&#x000A;<li data-sourcepos="165:1-166:0">&#x000A;<p data-sourcepos="165:3-165:135">VA low, small load on the connector to check the token and to proxy/forward the request to the subsequent system (data source / API).</p>&#x000A;</li>&#x000A;<li data-sourcepos="167:1-168:0">&#x000A;<p data-sourcepos="167:3-167:201">SC high, (at least potentially) as the data / API access is provided based on strict policies to other data space participants that must meet certain criteria. =&gt; potentially access to sensitive data</p>&#x000A;</li>&#x000A;<li data-sourcepos="169:1-170:0">&#x000A;<p data-sourcepos="169:3-169:220">SI high, (at least potentially) as the data / API access is provided based on strict policies to other data space participants that must meet certain criteria. =&gt; potentially access to business critical systems / APIs?</p>&#x000A;</li>&#x000A;<li data-sourcepos="171:1-174:0">&#x000A;<p data-sourcepos="171:3-171:45">SA low, load on the subsequent system / API</p>&#x000A;</li>&#x000A;</ul>&#x000A;<p data-sourcepos="175:1-175:144" dir="auto">Please let me know if the above description is sufficient to understand and assess the vulnerability and what are the next steps in the process.</p>&#x000A;<h2 data-sourcepos="179:1-179:21" dir="auto">&#x000A;<a href="#steps-to-reproduce" aria-hidden="true" class="anchor" id="user-content-steps-to-reproduce"></a>Steps to reproduce</h2>&#x000A;<p data-sourcepos="183:1-183:135" dir="auto">Run the sample: <a href="https://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull" rel="nofollow noreferrer noopener" target="_blank">https://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull</a></p>&#x000A;<p data-sourcepos="187:1-187:272" dir="auto">Make sure to use a version before commit <a href="https://github.com/eclipse-edc/Samples/commit/e2387fc2e5560c1b84c5a3fd33a776d6792aa0e7" rel="nofollow noreferrer noopener" target="_blank">https://github.com/eclipse-edc/Samples/commit/e2387fc2e5560c1b84c5a3fd33a776d6792aa0e7</a> (in that commit they switched from "transfer-data-plane"/"data-plane-public-api" to "transfer-data-plane-signaling"/"data-plane-public-api-v2").</p>&#x000A;<p data-sourcepos="191:1-191:67" dir="auto">I tested it with revision 3a08baeb959b4bc177a3b80814abddd2f37fb254.</p>&#x000A;<p data-sourcepos="195:1-195:119" dir="auto">Make sure to use Linux to run the samples (because of <a data-sourcepos="195:55-195:118" href="https://github.com/eclipse-edc/Connector/issues/4219" rel="nofollow noreferrer noopener" target="_blank">this bug</a>)</p>&#x000A;<p data-sourcepos="199:1-199:202" dir="auto">Use the token to retrieve the data (see <a data-sourcepos="199:41-199:200" href="https://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull#4-check-the-data" rel="nofollow noreferrer noopener" target="_blank">4. step of the guide</a>).</p>&#x000A;<p data-sourcepos="203:1-203:210" dir="auto">You can inspect the token using <a data-sourcepos="203:33-203:57" href="https://jwt.io/" rel="nofollow noreferrer noopener" target="_blank">jwt.io</a> (by default, the token expires 10 minutes after being issued). Wait 10 minutes, token should be expired then. Repeat step 4. =&gt; Token is still accepted.</p>&#x000A;<p data-sourcepos="207:1-207:76" dir="auto">You can observe that the token / authCode can be used beyond its expiration.</p>&#x000A;<h2 data-sourcepos="211:1-211:44" dir="auto">&#x000A;<a href="#do-you-know-any-mitigations-of-the-issue" aria-hidden="true" class="anchor" id="user-content-do-you-know-any-mitigations-of-the-issue"></a>Do you know any mitigations of the issue?</h2>&#x000A;<ul data-sourcepos="215:1-218:0" dir="auto">&#x000A;<li data-sourcepos="215:1-218:0">Block access to the public (consumer pull) endpoint.</li>&#x000A;</ul>&#x000A;<p data-sourcepos="219:1-219:35" dir="auto">Once version with fix is available:</p>&#x000A;<ul data-sourcepos="223:1-228:0" dir="auto">&#x000A;<li data-sourcepos="223:1-224:0">&#x000A;<p data-sourcepos="223:3-223:28">Update to version with fix</p>&#x000A;</li>&#x000A;<li data-sourcepos="225:1-228:0">&#x000A;<p data-sourcepos="225:3-225:56">Unblock access to the public (consumer pull) endpoint.</p>&#x000A;</li>&#x000A;</ul>&#x000A;<p data-sourcepos="229:1-229:209" dir="auto">Or take the chance to get rid of deprecated "data-plane-public-api" and switch to "data-plane-public-api-v2" (which is not using the <code data-sourcepos="229:135-229:182">ConsumerPullTransferTokenValidationApiController</code> with the missing checks).</p></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/3804/issues/234/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="gl-border-solid gl-border-1 gl-border-gray-100 gl-rounded-base gl-mt-5 gl-p-3 gl-text-center">
To upload designs, you'll need to enable LFS and have an admin enable hashed storage. <a href="/help/user/project/issues/design_management.md#prerequisites" target="_blank" rel="noopener noreferrer">More information</a>
</div>

<div class="js-work-item-links-root" data-full-path="security/vulnerability-reports" data-issuable-id="665613" data-issuable-iid="234" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-default-branch="main" data-wi-epics-list-path="/groups/vulnerability-reports/-/epics" data-wi-full-path="security/vulnerability-reports" data-wi-group-issues-path="/groups/vulnerability-reports/-/issues" data-wi-group-path="security" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/security/vulnerability-reports/-/issues" data-wi-labels-fetch-path="/groups/vulnerability-reports/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/security/vulnerability-reports/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/security/vulnerability-reports/-/issues/234/links" data-full-path="security/vulnerability-reports" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-default-branch="main" data-wi-epics-list-path="/groups/vulnerability-reports/-/epics" data-wi-full-path="security/vulnerability-reports" data-wi-group-issues-path="/groups/vulnerability-reports/-/issues" data-wi-group-path="security" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/security/vulnerability-reports/-/issues" data-wi-labels-fetch-path="/groups/vulnerability-reports/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/security/vulnerability-reports/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="234" data-project-path="security/vulnerability-reports" id="js-related-merge-requests"></div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:665613,&quot;iid&quot;:234,&quot;description&quot;:&quot;\u003c!--\n\nNote that this issue is configured (see the quick actions at the bottom) to be created as confidential.\n\n \n\nNote that a vulnerability does not need to actually be resolved before it is reported and that these reports can be revised as needed (reopen the issue to request changes).\n\n \n\nIf you do not know how to fill certain fields, mark that in the comment and we will help you.\n\n \n\nYou can delete the comments (or not).\n\n--\u003e\n\n \n\n\u003c!--\n\nRequired. Specify the project&#39;s name (e.g., \&quot;Eclipse Dash\&quot;) and Eclipse Foundation ID, e.g., \&quot;technology.dash\&quot;.\n\n--\u003e\n\n \n\n## Basic information\n\n \n\n**Project name:** Eclipse EDC\n\n \n\n**Project id:** technology.edc\n\n \n\n**Maven artifact:** org.eclipse.edc:transfer-data-plane\n\n \n\n## What are the affected versions?\n\n \n\n[0.5.0 - current]\n\n \n\nWho is affected: Anyone using EDC version 0.5.0 or newer if they (a) have a dataplane configured to support http proxy consumer pull AND (b) include the modules \&quot;transfer-data-plane\&quot; and \&quot;data-plane-public-api\&quot;.\n\n \n\n## Details of the issue\n\n \n\nThe issue is located in the `ConsumerPullTransferTokenValidationApiController` at this position in the code (\&quot;issue location\&quot;):\n\nhttps://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/api/ConsumerPullTransferTokenValidationApiController.java#L60\n\n \n\nThe `TokenValidationService`&#39;s validate method takes 3 arguments:\n\n`validate(@NotNull String token, PublicKeyResolver publicKeyResolver, TokenValidationRule... rules)`.\n\nBut only two arguments are provided in the \&quot;issue location\&quot;.\n\nThe third argument determines which rules should be checked during validation.\n\nTherefore, we will have an empty array at runtime, resulting in an empty list.\n\n \n\nThe [`ExpirationDateValidationRule`](https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/validation/ExpirationDateValidationRule.java)\n\nshould be checked for context `TRANSFER_DATAPLANE_TOKEN_CONTEXT = \&quot;dataplane-transfer\&quot;`.\n\nSee [registration to `tokenValidationRulesRegistry`](https://github.com/eclipse-edc/Connector/blob/980f10f2ad21368a2dc07cf3654e640aa01e3216/extensions/control-plane/transfer/transfer-data-plane/src/main/java/org/eclipse/edc/connector/controlplane/transfer/dataplane/TransferDataPlaneCoreExtension.java#L127).\n\n \n\nBut the `tokenValidationRulesRegistry` is never queried for that context.\n\nIn the \&quot;issue location\&quot; mentioned above, there should be something like `tokenValidationRulesRegistry.getRules(TRANSFER_DATAPLANE_TOKEN_CONTEXT)` as the third argument.\n\n \n\nLacking this third argument causes that the token is only checked regarding valid signature.\n\nThe expiration is not checked, i.e., expired tokens will indefinitely be considered as valid.\n\n \n\nThe logic of the \&quot;issue location\&quot; / `ConsumerPullTransferTokenValidationApiController` is used for example in [consumer pull scenarios](https://github.com/eclipse-edc/Connector/blob/4e143774a2e844fb7c7883f06139d8100c5bd73d/extensions/data-plane/data-plane-public-api/src/main/java/org/eclipse/edc/connector/dataplane/api/validation/ConsumerPullTransferDataAddressResolver.java#L51).\n\n \n\nIn a Consumer Pull scenario the consumer / consumer-side systems can \&quot;pull data\&quot; from the provider using the token beyond its expiration.\n\nBut data cannot only be pulled from the provider by the consumer. With EDC, \&quot;data transfers\&quot; can be used to modify resources at the provider side. Therefore, the impact of this vulnerability can be twofold:\n\n1. Data can be pulled / data sources can be queried longer than actors are allowed to do so. This threatens confidentiality of the resources as consumers (that are no longer allowed to access the data) can still access the data.\n\n2. There is a feature in EDC to proxy / forward the http request method, path, parameters, payload of the pull towards the data source (i.e., one can effectively expose a Web API to the consumer that can have POST endpoints and accepts payloads etc.). One can use consumer pull to issue an API call (with payload) to the provider&#39;s data source and receive the response (proxyMethod/Path/Payload/... feature enables some kind of bi-directional data transfer). Therefore, the threat is not limited to confidentiality / accessing resources longer than allowed but also to modify resources beyond the time allowed =\u003e threatens integrity.\n\n \n\nResult: Defective expiration / revocation of permissions granted to an entity to access / modify protected (possibly sensitive) resources.\n\nIn case the token leaks, entities that were never allowed to access the resources can access them indefinitely.\n\n \n\nThe only way to prevent access to the resources beyond expiration might be to block all accesses to the public (consumer pull) endpoint until a fix is available and the connector has been updated.\n\n \n\nAs far as I was able to track, the issue / vulnerability has been introduced with version v0.5.0 via commit https://github.com/eclipse-edc/Connector/commit/19ebb19495dc78c5b27b925baaf378b7e85885c7 and is still present in main branch (i.e., most recent versions).\n\n \n\nThe issue is located in the maven artifact \&quot;org.eclipse.edc:transfer-data-plane\&quot; ([0.5.0 - current]).\n\n \n\nI&#39;m unsure which CWEs suit best here.\n\nAll in all, the issue is a missing check regarding the expiration of a JWT.\n\nSo the JWT can be used to access the data source (i.e., a HTTP Endpoint; possibly with the http request method, path, parameter, payload of ones choice) way beyond its expiration.\n\n \n\nI would grade the vulnerability as a\n\n \n\nCVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:N/VA:L/SC:H/SI:H/SA:L\n\n \n\n5.6 Medium\n\n \n\n- AV Network, because the (consumer pull) public endpoint at the provider side is exposed to the internet.\n\n- AC Low, as consumers can just keep using their system to access the resources beyond token expiration time.\n\n- AT Present, as the consumer needs to have negotiated a contract agreement with the provider and requested a data transfer using http proxy consumer pull method to get the EDR with the token. To threat integrity of subsequent systems, proxyMethod/Path/Payload/... configuration needs to be enabled for the asset.\n\n- PR Low, one needs access to the consumer&#39;s system to request the data from the provider&#39;s public (consumer pull) endpoint\n\n- UI none, no additional user interaction required\n\n- VC none, as no information is leaked from the connector / control plane\n\n- VI none, no state change in the connector\n\n- VA low, small load on the connector to check the token and to proxy/forward the request to the subsequent system (data source / API).\n\n- SC high, (at least potentially) as the data / API access is provided based on strict policies to other data space participants that must meet certain criteria. =\u003e potentially access to sensitive data\n\n- SI high, (at least potentially) as the data / API access is provided based on strict policies to other data space participants that must meet certain criteria. =\u003e potentially access to business critical systems / APIs?\n\n- SA low, load on the subsequent system / API\n\n \n\nPlease let me know if the above description is sufficient to understand and assess the vulnerability and what are the next steps in the process.\n\n \n\n## Steps to reproduce\n\n \n\nRun the sample: https://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull\n\n \n\nMake sure to use a version before commit https://github.com/eclipse-edc/Samples/commit/e2387fc2e5560c1b84c5a3fd33a776d6792aa0e7 (in that commit they switched from \&quot;transfer-data-plane\&quot;/\&quot;data-plane-public-api\&quot; to \&quot;transfer-data-plane-signaling\&quot;/\&quot;data-plane-public-api-v2\&quot;).\n\n \n\nI tested it with revision 3a08baeb959b4bc177a3b80814abddd2f37fb254.\n\n \n\nMake sure to use Linux to run the samples (because of [this bug](https://github.com/eclipse-edc/Connector/issues/4219))\n\n \n\nUse the token to retrieve the data (see [4. step of the guide](https://github.com/eclipse-edc/Samples/tree/3a08baeb959b4bc177a3b80814abddd2f37fb254/transfer/transfer-02-consumer-pull#4-check-the-data)).\n\n \n\nYou can inspect the token using [jwt.io](https://jwt.io/) (by default, the token expires 10 minutes after being issued). Wait 10 minutes, token should be expired then. Repeat step 4. =\u003e Token is still accepted.\n\n \n\nYou can observe that the token / authCode can be used beyond its expiration.\n\n \n\n## Do you know any mitigations of the issue?\n\n \n\n- Block access to the public (consumer pull) endpoint.\n\n \n\nOnce version with fix is available:\n\n \n\n- Update to version with fix\n\n- Unblock access to the public (consumer pull) endpoint.\n\n \n\nOr take the chance to get rid of deprecated \&quot;data-plane-public-api\&quot; and switch to \&quot;data-plane-public-api-v2\&quot; (which is not using the `ConsumerPullTransferTokenValidationApiController` with the missing checks).\n\n \n\n\u003c!--\n\n  Please, do not remove the line below. It will create a confidential issue that will be visible\n\n  only to you and the members of this project. Confidential issues are used to keep security\n\n  vulnerabilities private until they are sorted out.\n\n  Eclipse Projects follow Responsible Disclosure best practices: the initial report is made privately,\n\n  but with the full details being published once a patch has been made available (sometimes with\n\n  a delay to allow more time for the patches to be installed).\n\n--\u003e&quot;,&quot;title&quot;:&quot;Eclipse EDC: Consumer pull transfer token validation does not apply any rules (e. g., expiration check)&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:1708,&quot;created_at&quot;:&quot;2024-07-23T15:27:26Z&quot;,&quot;updated_at&quot;:&quot;2024-09-11T13:45:23Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[{&quot;id&quot;:69578,&quot;title&quot;:&quot;cve::published&quot;,&quot;color&quot;:&quot;#cce8b5&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2023-09-07T07:39:18.203Z&quot;,&quot;updated_at&quot;:&quot;2023-09-07T07:39:18.203Z&quot;},{&quot;id&quot;:58541,&quot;title&quot;:&quot;From_ML&quot;,&quot;color&quot;:&quot;#ff0000&quot;,&quot;description&quot;:null,&quot;group_id&quot;:null,&quot;project_id&quot;:3804,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-04-12T12:43:09.696Z&quot;,&quot;updated_at&quot;:&quot;2023-04-12T12:43:09.696Z&quot;},{&quot;id&quot;:116744,&quot;title&quot;:&quot;resolution::fixed&quot;,&quot;color&quot;:&quot;#cc338b&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2024-08-22T15:23:19.232Z&quot;,&quot;updated_at&quot;:&quot;2024-08-22T15:23:19.232Z&quot;},{&quot;id&quot;:116747,&quot;title&quot;:&quot;vulnerability::confirmed&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2024-08-22T15:24:38.252Z&quot;,&quot;updated_at&quot;:&quot;2024-08-22T15:24:38.252Z&quot;}],&quot;lock_version&quot;:0,&quot;author_id&quot;:1708,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:339,&quot;username&quot;:&quot;mspiekermann&quot;,&quot;name&quot;:&quot;Markus Spiekermann&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.eclipse.org/uploads/-/system/user/avatar/339/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.eclipse.org/mspiekermann&quot;},{&quot;id&quot;:1088,&quot;username&quot;:&quot;platzel&quot;,&quot;name&quot;:&quot;Paul Latzelsperger&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/9bd46ae5f666aa69e84fc7e7a98d6eecef6a571d20a080c7278bafc825a411ee?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.eclipse.org/platzel&quot;},{&quot;id&quot;:18592,&quot;username&quot;:&quot;neuschwa&quot;,&quot;name&quot;:&quot;Philipp Neuschwander&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.eclipse.org/uploads/-/system/user/avatar/18592/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.eclipse.org/neuschwa&quot;}],&quot;due_date&quot;:null,&quot;project_id&quot;:3804,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/security/vulnerability-reports/-/issues/234&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/security/vulnerability-reports/notes?target_id=665613\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/security/vulnerability-reports/-/preview_markdown?target_id=234\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:665613,&quot;projectId&quot;:3804,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/security/vulnerability-reports/-/issues/234/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/security/vulnerability-reports/-/issues/234.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/security/vulnerability-reports/-/issues/234.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/security/vulnerability-reports/noteable/issue/665613/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736614857000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-shadow-none gl-block " type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/security/vulnerability-reports/-/issues/234.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="security" data-issue-id="665613" data-issue-iid="234" data-project-path="security/vulnerability-reports"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="234" data-issuable-type="issue" data-labels-fetch-path="/security/vulnerability-reports/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/security/vulnerability-reports/-/labels" data-project-issues-path="/security/vulnerability-reports/-/issues" data-project-path="security/vulnerability-reports" data-selected-labels="[{&quot;id&quot;:69578,&quot;title&quot;:&quot;cve::published&quot;,&quot;color&quot;:&quot;#cce8b5&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2023-09-07T07:39:18.203Z&quot;,&quot;updated_at&quot;:&quot;2023-09-07T07:39:18.203Z&quot;},{&quot;id&quot;:58541,&quot;title&quot;:&quot;From_ML&quot;,&quot;color&quot;:&quot;#ff0000&quot;,&quot;description&quot;:null,&quot;group_id&quot;:null,&quot;project_id&quot;:3804,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-04-12T12:43:09.696Z&quot;,&quot;updated_at&quot;:&quot;2023-04-12T12:43:09.696Z&quot;},{&quot;id&quot;:116744,&quot;title&quot;:&quot;resolution::fixed&quot;,&quot;color&quot;:&quot;#cc338b&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2024-08-22T15:23:19.232Z&quot;,&quot;updated_at&quot;:&quot;2024-08-22T15:23:19.232Z&quot;},{&quot;id&quot;:116747,&quot;title&quot;:&quot;vulnerability::confirmed&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2024-08-22T15:24:38.252Z&quot;,&quot;updated_at&quot;:&quot;2024-08-22T15:24:38.252Z&quot;}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="234" data-project-path="security/vulnerability-reports"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="security" data-issue-id="665613" data-issue-iid="234" data-project-path="security/vulnerability-reports"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="234" data-project-path="security/vulnerability-reports"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="security/vulnerability-reports" data-iid="234" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="js-sidebar-confidential-widget-root"></div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/security/vulnerability-reports/-/issues/234.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/security/vulnerability-reports/-/issues/234/toggle_subscription","moveIssueEndpoint":"/security/vulnerability-reports/-/issues/234/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=3804","editable":"","currentUser":{},"rootPath":"/","fullPath":"security/vulnerability-reports","iid":234,"id":665613,"severity":"unknown","timeTrackingLimitToHours":false,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>

<div class="footer-message" style="background-color: #4c4d4e;color: #ffffff"><p>Copyright © Eclipse Foundation, Inc. All Rights Reserved.     <a style="color:#fff;" href="https://www.eclipse.org/legal/privacy.php" rel="nofollow noreferrer noopener" target="_blank">Privacy Policy</a> | <a style="color:#fff;" href="https://www.eclipse.org/legal/termsofuse.php" rel="nofollow noreferrer noopener" target="_blank">Terms of Use</a> | <a style="color:#fff;" href="https://www.eclipse.org/legal/copyright.php" rel="nofollow noreferrer noopener" target="_blank">Copyright Agent</a></p></div>
<script>
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

