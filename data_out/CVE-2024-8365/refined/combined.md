=== Content from discuss.hashicorp.com_14328f29_20250111_083618.html ===


[HashiCorp Discuss](/)

# [HCSEC-2024-18 - Vault Leaks Client Token and Token Accessor in Audit Devices](/t/hcsec-2024-18-vault-leaks-client-token-and-token-accessor-in-audit-devices/69669)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[eastebry](https://discuss.hashicorp.com/u/eastebry)

August 31, 2024, 12:59am

1

**Bulletin ID:** HCSEC-2024-18

**Affected Products / Versions:**

Vault Enterprise Edition 1.16.7 to 1.16.8; fixed in Vault Enterprise Edition 1.16.9.

Vault Community Edition and Vault Enterprise Edition 1.17.3 to 1.17.4; fixed in Vault Community Edition and Vault Enterprise Edition 1.17.5.

**Publication Date:** August 30, 2024

**Summary**

Vault Community Edition and Vault Enterprise experienced a regression where functionality that HMAC’d sensitive headers in the configured audit device, specifically client tokens and token accessors, was removed. This resulted in the plaintext values of client tokens and token accessors being stored in the audit log. This vulnerability, CVE-2024-8365, was fixed in Vault Community Edition and Vault Enterprise 1.17.5 and Vault Enterprise 1.16.9.

**Background**

Audit devices, or logs, are the components in Vault that collectively keep a detailed log of all requests to Vault, and their responses. Because every operation with Vault is an API request/response, when using a single audit device, the audit log contains every interaction with the Vault API, including errors (except for a few paths which do not go via the audit system).

**Details**

Every interaction is logged to the audit device, including requests where Vault tokens, client tokens, or other sensitive information is present. Vault will display an HMAC of the sensitive values when they are stored in the audit device. In the affected versions of Vault, a regression removed the functionality that performed the hashing of sensitive values, thus the plaintext value was stored in the audit device.

**Remediation**

Customers should update Vault to a fixed version and then review the logs in their audit devices and rotate any affected credentials identified.

Please refer to [Upgrading Vault](https://learn.hashicorp.com/tutorials/vault/sop-upgrade?in=vault/standard-procedures) for general guidance and version-specific upgrade notes.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

[Vault 1.17.5 and 1.16.9 released!](https://discuss.hashicorp.com/t/vault-1-17-5-and-1-16-9-released/69670)

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-01 - Vault May Expose Sensitive Information When Configuring An Audit Log Device](https://discuss.hashicorp.com/t/hcsec-2024-01-vault-may-expose-sensitive-information-when-configuring-an-audit-log-device/62311)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 6324 | February 1, 2024 |
| [HCSEC-2024-10 - Vault Enterprise Leaks Sensitive HTTP Request Headers in Audit Log When Deployed With a Performance Standby Node](https://discuss.hashicorp.com/t/hcsec-2024-10-vault-enterprise-leaks-sensitive-http-request-headers-in-audit-log-when-deployed-with-a-performance-standby-node/66553)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 3775 | April 30, 2024 |
| [HCSEC-2022-08 - Vault Enterprise’s Tokenization Transform Configuration Endpoint May Expose Transform Key](https://discuss.hashicorp.com/t/hcsec-2022-08-vault-enterprise-s-tokenization-transform-configuration-endpoint-may-expose-transform-key/36599)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7175 | March 4, 2022 |
| [HCSEC-2021-19 - Vault’s UI Cached User-Viewed Secrets Between Shared Browser Sessions](https://discuss.hashicorp.com/t/hcsec-2021-19-vault-s-ui-cached-user-viewed-secrets-between-shared-browser-sessions/28166)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7693 | August 12, 2021 |
| [HCSEC-2020-13 - Vault Proxy Environment Variable Was Logged to STDOUT](https://discuss.hashicorp.com/t/hcsec-2020-13-vault-proxy-environment-variable-was-logged-to-stdout/18096)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4128 | November 25, 2020 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


