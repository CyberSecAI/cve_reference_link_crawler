<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A hotel check-in kiosk application crashed when entering a single quote into the guest search, which enabled access to the Windows Desktop. The terminal uses the Ariane Allegro Scenario Player.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kiosk mode bypass for an Ariane Allegro Scenario Player based hotel check-in terminal | Pentagrid AG</title>
<link href="../../../assets/fontawesome/css/all.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<link rel="alternate" type="application/rss+xml" title="RSS (de)" href="../../../de/rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../rss.xml">
<link rel="canonical" href="https://www.pentagrid.ch/en/blog/ariane-allegro-hotel-check-in-terminal-kios-escape/">
<link rel="icon" href="../../../favicon.ico" sizes="16x16">
<link rel="icon" href="../../../icon_128x128.png" sizes="128x128">
<link rel="apple-touch-icon" href="../../../icon_128x128.png" sizes="128x128">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Pentagrid AG">
<link rel="prev" href="../ibis-hotel-check-in-terminal-keypad-code-leakage/" title="IBIS hotel check-in terminal keypad-code leakage" type="text/html">
<link rel="next" href="../domain-verification-bypass-prevention-caa-accounturi/" title="How to prevent domain verification bypasses of your server certificates using CAA and account URI binding and how to monitor problems?" type="text/html">
<meta property="og:site_name" content="Pentagrid AG">
<meta property="og:title" content="Kiosk mode bypass for an Ariane Allegro Scenario Player based hotel ch">
<meta property="og:url" content="https://www.pentagrid.ch/en/blog/ariane-allegro-hotel-check-in-terminal-kios-escape/">
<meta property="og:description" content="A hotel check-in kiosk application crashed when entering a single quote into the guest search, which enabled access to the Windows Desktop. The terminal uses the Ariane Allegro Scenario Player.">
<meta property="og:image" content="https://www.pentagrid.ch/images/202406_ariane_hotel_terminal_enter_name.jpg">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2024-06-05T08:42:00+01:00">
<meta property="article:tag" content="Advisory">
<meta property="article:tag" content="Kiosk mode">
<meta property="article:tag" content="Physical security">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@pentagridsec">
<meta name="twitter:creator" content="@pentagridsec">
<link rel="alternate" hreflang="de" href="../../../de/blog/ariane-allegro-hotel-check-in-terminal-kios-escape/">
<meta name="geo.region" content="CH-SG">
<meta name="geo.placename" content="Buchs SG">
<meta name="geo.position" content="47.166808762756524;9.47720487085083">
<meta name="ICBM" content="47.166808762756524, 9.47720487085083">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-dark bg-dark navbar-inverse bg-inverse "><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="https://www.pentagrid.ch/en/">
            <img src="../../../assets/images/logos/Logo_single_row_h25.png" alt="Pentagrid AG" id="logo" class="nav-link"><!-- was: d-inline-block align-middle --></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../pages/home/" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="../../pages/services/" class="nav-link">Services</a>
                </li>
<li class="nav-item">
<a href="../../pages/about-us/" class="nav-link">AboutÂ Us</a>
                </li>
<li class="nav-item">
<a href="../../pages/career/" class="nav-link">Career</a>
                </li>
<li class="nav-item">
<a href="../" class="nav-link">Blog</a>
                </li>
<li class="nav-item">
<a href="../../pages/imprint-and-contact/" class="nav-link">ImprintÂ andÂ Contact</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right">
<li>
            </li>
<li class="nav-item"><a href="https://www.pentagrid.ch/de/" rel="alternate" hreflang="de" class="nav-link">Deutsch</a></li>

                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- Insert Carusel? --><!-- Content --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Kiosk mode bypass for an Ariane Allegro Scenario Player based hotel check-in terminal</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Pentagrid AG
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2024-06-05T08:42:00+01:00" itemprop="datePublished" title="2024-06-05 08:42">2024-06-05 08:42</time><span class="updated"> (updated
                    <time class="updated dt-updated" datetime="2024-06-11T17:23:00+01:00" itemprop="dateUpdated" title="2024-06-11 17:23">2024-06-11 17:23</time>)</span>
            </a>
            </p>
            

        </div>
        
        <div class="metadata posttranslations translations">
            <h3 class="posttranslations-intro">Also available in:</h3>
                <p><a href="../../../de/blog/ariane-allegro-hotel-check-in-terminal-kios-escape/" rel="alternate" hreflang="de">Deutsch</a></p>
        </div>

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>A threat modeling workshop took us to a remote location where there was a new hotel. It was so small that there was no check-in staff, but a check-in terminal for self-service. What was bound to happen, happened.</p>
<p>The hotel check-in terminal is running an Ariane Allegro Scenario Player in a kiosk mode and the application crashed when entering a single quote character into the guest search. The application crash allowed access to the underlying Windows Desktop. According to Ariane, an outdated software version was installed in the new hotel.</p>
<p>According to the vendor Ariane Systems, "Ariane is the world leader in providing self-check-in and out solutions for the hotel industry. [...] Ariane currently serves 3,000 hotels and 500,000 rooms in more than 25 countries. This includes one-third of the top 100 global hotel chains."</p>
<!-- TEASER_END -->
<section id="timeline"><h2>Timeline</h2>
<ul class="simple">
<li><p>2024-03-05: Vulnerability was discovered at a check-in terminal.</p></li>
<li><p>2024-03-06: Preliminary advisory written.</p></li>
<li><p>2024-03-06: Information sent to the hotel brand that uses the check-in terminal and asked about used application versions.</p></li>
<li><p>2024-03-07: Tried to find information how a vulnerability can be reported to Ariane Systems. The vendor does not use security.txt nor a DNS TXT record for security contact lookup. There is no information on the website how to contact the product security team. Therefore, Pentagrid initially contacted Ariane Systems via <a class="reference external" href="mailto:support@ariane.com">support@ariane.com</a>.</p></li>
<li><p>2024-03-14: Sent another request to the Ariane Systems support, after not receiving any feedback.</p></li>
<li><p>2024-03-14: Sent a status information to the affected hotel.</p></li>
<li><p>2024-03-14: Contacted Ariane Systems' technical leader and chief product officer via Linkedin. Chief product officer responded and recommended to contact <a class="reference external" href="mailto:dataprivacy@ariane.com">dataprivacy@ariane.com</a>.</p></li>
<li><p>2024-03-14: Sent e-mail to <a class="reference external" href="mailto:dataprivacy@ariane.com">dataprivacy@ariane.com</a>.</p></li>
<li><p>2024-03-14: Verified all e-mails of previous communication attempts were received by Ariane Systems' mail server by reviewing Pentagrid's mail server logs.</p></li>
<li><p>2024-03-15: Tried to get an e-mail receipt confirmation from the chief product officer via Linkedin, after not receiving any feedback.</p></li>
<li><p>2024-03-18: Tried to contact chief product officer via e-mail by guessing the e-mail address, after not receiveing any response, but e-mail address guessing failed.</p></li>
<li><p>2024-03-18: Contacted chief product officer via Linkedin again, to get a confirmation that Pentagrid's e-mail for starting the coordinated disclosure process has been received.</p></li>
<li><p>2024-03-18: Contacted Ariane Systems publicly via Linkedin.</p></li>
<li><p>2024-03-18: Sent vulnerability details to <a class="reference external" href="mailto:dataprivacy@ariane.com">dataprivacy@ariane.com</a>, after getting a first contact confirmation via e-mail.</p></li>
<li><p>2024-03-18: Received first response, which stated that the systems are legacy systems, that USB ports are disabled and "no PII or exploitable data can be retrieved from the kiosk".</p></li>
<li><p>2024-03-25: Disputing Ariane Systems' claim that no PII data can be retrieved, because as part of the system design the kiosk produces and keeps accessible invoice files.</p></li>
<li><p>2024-04-11: Call with Ariane Systems.</p></li>
<li><p>2024-05-31: Asked Ariane for a status, but there was no response.</p></li>
<li><p>2024-06-05: Publication after 90 days.</p></li>
<li><p>2024-06-06: CVE-2024-37364 was assigned.</p></li>
</ul></section><section id="kiosk-mode-bypass"><h2>Kiosk mode bypass</h2>
<pre class="literal-block">CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, 6.8 Medium</pre>
<section id="affected-components"><h3>Affected Components</h3>
<p>The check-in terminal is likely a terminal of type Ariane Duo 6000 series, which runs the Ariane Allegro Scenario Player.</p>
<p>A hotel brand from Liechtenstein and Switzerland uses the check-in terminal for smaller hotel locations. The check-in terminal supports room booking as well as checking into the hotel. It initiates the payment process via a POS terminal, provisions RFID transponders to open the booked hotel room and it prints an invoice.</p>
</section><section id="summary"><h3>Summary</h3>
<p>The check-in terminal allows searching for existing room reservations. Reservations can be looked up by booking code or by surname. When searching a reservation by name and the entered name contains a single-quote, the application hangs. When touching the screen of the terminal again, the Windows operating system will ask the user if Windows should wait any longer or stop the task. Selecting stop ends the kiosk mode application.</p>
</section><section id="impact"><h3>Impact</h3>
<p>When stopping the application, the kiosk mode is stopped and the user gets access to a Windows desktop.</p>
<p>With access to the Windows desktop, attacks on the hotel network could become possible as well as access to data stored on the terminal, which includes PII, reservations and invoices. With the ability to inject and execute program code, it seems possible to get room keys created for other rooms, because the functionality of provisioning RFID transponders is implemented in the terminal.</p>
</section><section id="technical-details"><h3>Technical Details</h3>
<p>When a user searches an existing reservation and adds a single-quote to the surname, the application hangs. An example input that causes the effect is "O'YOLO".</p>
<a class="reference external image-reference" href="../../../images/202406_ariane_hotel_terminal_enter_name.jpg"><img alt="Entering a name into the search field with a single-quote character. In this example, &quot;O'YOLO&quot; is entered. The hotel's brand logo is masked in the photo." class="align-center" src="../../../images/202406_ariane_hotel_terminal_enter_name.thumbnail.jpg"></a>
<p>The application hangs. By touching the Elo display again, Windows will ask how to proceed with the application.</p>
<a class="reference external image-reference" href="../../../images/202406_ariane_hotel_terminal_stop_kiosk_application.jpg"><img alt="Windows asks whether the application should be continued or stopped." class="align-center" src="../../../images/202406_ariane_hotel_terminal_stop_kiosk_application.thumbnail.jpg"></a>
<p>When stopping the application, the Windows desktop becomes accessible.</p>
<a class="reference external image-reference" href="../../../images/202406_ariane_hotel_terminal_kiosk_mode_stopped.jpg"><img alt="Windows desktop is accessible after stopping the kiosk mode application." class="align-center" src="../../../images/202406_ariane_hotel_terminal_kiosk_mode_stopped.thumbnail.jpg"></a>
</section><section id="precondition"><h3>Precondition</h3>
<p>An attacker needs physical access to a check-in terminal and depending on the attack preparation some time at the terminal. The terminal must be in a state where it allows self-service, for example as Hotels might only enable it during specific times.</p>
</section><section id="recommendation"><h3>Recommendation</h3>
<p>According to Ariane, the problem was fixed in the Allegro Scenario Player. Therefore, Pentagrid recommends hotels using the terminal:</p>
<ul class="simple">
<li><p>To ensure that a recent version of the software is installed. The version that fixes the issue is not known to Pentagrid. Hence Ariane Systems should be asked.</p></li>
<li><p>To isolate check-in terminals so that bypassing the kiosk mode does not allow attacks on the hotel network or the Windows domain.</p></li>
</ul></section><section id="credits"><h3>Credits</h3>
<p>This vulnerability was accidentally found by Martin "O'YOLO" Schobert (Pentagrid).</p>
</section></section>
</div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/advisory/" rel="tag">Advisory</a></li>
            <li><a class="tag p-category" href="../../categories/kiosk-mode/" rel="tag">Kiosk mode</a></li>
            <li><a class="tag p-category" href="../../categories/physical-security/" rel="tag">Physical security</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../ibis-hotel-check-in-terminal-keypad-code-leakage/" rel="prev" title="IBIS hotel check-in terminal keypad-code leakage">Previous post</a>
            </li>
            <li class="next">
                <a href="../domain-verification-bypass-prevention-caa-accounturi/" rel="next" title="How to prevent domain verification bypasses of your server certificates using CAA and account URI binding and how to monitor problems?">Next post</a>
            </li>
        </ul></nav></aside></article><!--End of body content-->
</div>
</div>



            <script src="../../../assets/js/jquery.min.js"></script><script src="../../../assets/js/popper.min.js"></script><script src="../../../assets/js/bootstrap.min.js"></script><script src="../../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- Footer --><div class="d-print-none" style="position: relative; width: 20px; height: 20px; background-color: #ff0000; float: right; margin: 0px; top: -20px;"></div>


<footer class="jumbotron jumbotron-fluid bg-secondary text-light mb-0 d-print-none" id="footer"><div class="container">

    <!-- First footer row -->
    
    <div class="row">

      <div class="col-md-6">      
        <p>
	Contact:</p>
	<p>
        <b>PentagridÂ AG</b><br>
        Bahnhofstrasse 7<br>
        CH-9470 Buchs SG<br>
        Switzerland
        </p>
	<p>
        <b>PentagridÂ GmbH</b><br>
        Am Treptower Park 75<br>
        DE-12435 Berlin<br>
        Germany
        </p>
	<p>
        Phone: +41 81 511 2556<br>	
	E-mail: <a href="mailto:contact@pentagrid.ch">contact@pentagrid.ch</a>
	</p>
      </div>


      <div class="col-md-3">
      <p>
           Follow us:
      </p>
      <p>
	   <a href="../../rss.xml" aria-label="RSS">
	   <i class="fas fa-rss fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>

	   <a rel="me" href="https://infosec.exchange/@pentagrid" aria-label="Mastodon">
	   <i class="fab fa-mastodon fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>

	   <a href="https://bsky.app/profile/pentagrid.bsky.social" aria-label="Bluesky">
	   <i class="fab fa-bluesky fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>

	   <a href="https://github.com/pentagridsec" aria-label="Github">
	   <i class="fab fa-github fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>
	   
	   <a href="https://www.linkedin.com/company/67698060/" aria-label="LinkedIn">
	   <i class="fab fa-linkedin fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>
	   
	   <a href="https://www.xing.com/companies/pentagridag" aria-label="Xing">
	   <i class="fab fa-xing fa-2x fa-inverse mr-2" aria-hidden="true"></i>
	   </a>
	   	   
	</p>	   
      </div>


    </div>

    <!-- Second footer row -->
    <div class="row">
      <div class="col-md-3">
        <p>
	   
	   
           Â© 2025 PentagridÂ AG. All rights reserved.
        </p>
      </div>
    </div>
    
  </div>
</footer>
</body>
</html>
