=== Content from github.com_b8705cc7_20250110_141521.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapollographql%2Frouter%2Freleases%2Ftag%2Fv1.45.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapollographql%2Frouter%2Freleases%2Ftag%2Fv1.45.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=apollographql%2Frouter)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apollographql](/apollographql)
/
**[router](/apollographql/router)**
Public

* [Notifications](/login?return_to=%2Fapollographql%2Frouter) You must be signed in to change notification settings
* [Fork
  273](/login?return_to=%2Fapollographql%2Frouter)
* [Star
   829](/login?return_to=%2Fapollographql%2Frouter)

* [Code](/apollographql/router/tree/v1.45.1)
* [Issues
  428](/apollographql/router/issues)
* [Pull requests
  79](/apollographql/router/pulls)
* [Discussions](/apollographql/router/discussions)
* [Actions](/apollographql/router/actions)
* [Projects
  0](/apollographql/router/projects)
* [Security](/apollographql/router/security)
* [Insights](/apollographql/router/pulse)

Additional navigation options

* [Code](/apollographql/router/tree/v1.45.1)
* [Issues](/apollographql/router/issues)
* [Pull requests](/apollographql/router/pulls)
* [Discussions](/apollographql/router/discussions)
* [Actions](/apollographql/router/actions)
* [Projects](/apollographql/router/projects)
* [Security](/apollographql/router/security)
* [Insights](/apollographql/router/pulse)

1. [Releases](/apollographql/router/releases)
2. [v1.45.1](/apollographql/router/releases/tag/v1.45.1)

# v1.45.1

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/apollographql/router/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.45.1)

 Loading

[View all tags](/apollographql/router/tags)

![@apollo-bot2](https://avatars.githubusercontent.com/u/50160705?s=40&v=4)
[apollo-bot2](/apollo-bot2)
released this
26 Apr 23:09

¬∑
[1573 commits](/apollographql/router/compare/v1.45.1...dev)
to dev
since this release

[v1.45.1](/apollographql/router/tree/v1.45.1)

[`ff9f666`](/apollographql/router/commit/ff9f666598cd17661880fe7fc6e9c9611316e529)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## üêõ Fixes

### Correct v1.44.0 regression in query plan cache ([PR #5028](https://github.com/apollographql/router/pull/5028))

Correct a critical regression that was introduced in [v1.44.0](https://github.com/apollographql/router/pull/4883) which could lead to execution of an incorrect query plan. This issue only affects Routers that use [distributed query plan caching](https://www.apollographql.com/docs/router/configuration/distributed-caching/#distributed-query-plan-caching), enabled via the `supergraph.query_planning.cache.redis.urls` configuration property.

By [@o0Ignition0o](https://github.com/o0Ignition0o) in [#5028](https://github.com/apollographql/router/pull/5028)

### Use entire schema when hashing an introspection query ([Issue #5006](https://github.com/apollographql/router/issues/5006))

Correct a *different* hashing bug which impacted introspection queries which was also introduced in [v1.44.0](https://github.com/apollographql/router/pull/4883). This other hashing bug failed to account for introspection queries, resulting in introspection results being misaligned to the current schema. This issue only affects Routers that use [distributed query plan caching](https://www.apollographql.com/docs/router/configuration/distributed-caching/#distributed-query-plan-caching), enabled via the `supergraph.query_planning.cache.redis.urls` configuration property.

This release fixes the hashing mechanism by adding the schema string to hashed data if an introspection field is encountered. As a result, the entire schema is taken into account and the correct introspection result is returned.

By [@Geal](https://github.com/Geal) in [#5007](https://github.com/apollographql/router/pull/5007)

### Fix subgraph name mapping of Datadog exporter ([PR #5012](https://github.com/apollographql/router/pull/5012))

Previously in the router v1.45.0, subgraph name mapping didn't work correctly in the router's Datadog exporter. The exporter used the incorrect value `apollo.subgraph.name` for mapping attributes when it should have used the value `subgraph.name`. This issue has been fixed in this release.

By [@garypen](https://github.com/garypen) in [#5012](https://github.com/apollographql/router/pull/5012)

### Contributors

* [![@garypen](https://avatars.githubusercontent.com/u/107218?s=64&v=4)](https://github.com/garypen)
* [![@Geal](https://avatars.githubusercontent.com/u/119296?s=64&v=4)](https://github.com/Geal)
* [![@o0Ignition0o](https://avatars.githubusercontent.com/u/9465678?s=64&v=4)](https://github.com/o0Ignition0o)

garypen, Geal, and o0Ignition0o

 Assets
10

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_1c5fc773_20250110_141521.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapollographql%2Frouter%2Fcommit%2Fff9f666598cd17661880fe7fc6e9c9611316e529)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapollographql%2Frouter%2Fcommit%2Fff9f666598cd17661880fe7fc6e9c9611316e529)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=apollographql%2Frouter)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apollographql](/apollographql)
/
**[router](/apollographql/router)**
Public

* [Notifications](/login?return_to=%2Fapollographql%2Frouter) You must be signed in to change notification settings
* [Fork
  273](/login?return_to=%2Fapollographql%2Frouter)
* [Star
   829](/login?return_to=%2Fapollographql%2Frouter)

* [Code](/apollographql/router)
* [Issues
  428](/apollographql/router/issues)
* [Pull requests
  79](/apollographql/router/pulls)
* [Discussions](/apollographql/router/discussions)
* [Actions](/apollographql/router/actions)
* [Projects
  0](/apollographql/router/projects)
* [Security](/apollographql/router/security)
* [Insights](/apollographql/router/pulse)

Additional navigation options

* [Code](/apollographql/router)
* [Issues](/apollographql/router/issues)
* [Pull requests](/apollographql/router/pulls)
* [Discussions](/apollographql/router/discussions)
* [Actions](/apollographql/router/actions)
* [Projects](/apollographql/router/projects)
* [Security](/apollographql/router/security)
* [Insights](/apollographql/router/pulse)

## Commit

[Permalink](/apollographql/router/commit/ff9f666598cd17661880fe7fc6e9c9611316e529)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

release: v1.45.1 ([#5009](https://github.com/apollographql/router/pull/5009))

[Browse files](/apollographql/router/tree/ff9f666598cd17661880fe7fc6e9c9611316e529)
Browse the repository at this point in the history

* Loading branch information

[![@abernix](https://avatars.githubusercontent.com/u/841294?s=40&v=4)](/abernix)

[abernix](/apollographql/router/commits?author=abernix "View all commits by abernix")
authored
Apr 26, 2024

1 parent
[eb02494](/apollographql/router/commit/eb024949ab1f895470cf1ea2aa6f4fd2f962e1cb)

commit ff9f666

 Show file tree

 Hide file tree

Showing
**30 changed files**
with
**388 additions**
and
**385 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .circleci

  + .circleci/config.yml
    [config.yml](#diff-78a8a19706dbd2a4425dd72bdab0502ed7a2cef16365ab7030a5a0588927bf47)
* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* Cargo.lock
  [Cargo.lock](#diff-13ee4b2252c9e516a0547f2891aa2105c3ca71c6d7a1e682c69be97998dfc87e)
* apollo-router-benchmarks

  + apollo-router-benchmarks/Cargo.toml
    [Cargo.toml](#diff-434c5e6ed0b34e6d054746811fde31a064115a3a85ea26b6acc1d290488962b8)
* apollo-router-scaffold

  + apollo-router-scaffold/Cargo.toml
    [Cargo.toml](#diff-16e0852ca81fdc02bb019d31103f0528251bc8e87345b70b26ddf10a81465034)
  + templates/base

    - apollo-router-scaffold/templates/base/Cargo.toml
      [Cargo.toml](#diff-2a5b46149041aebc53d0eeb767d2b3c96cb952c5d8f15e0b210e1e63b92d4e38)
    - xtask

      * apollo-router-scaffold/templates/base/xtask/Cargo.toml
        [Cargo.toml](#diff-c4a539b83157dc547fe7557fa0508b19a012a8e7fe86eca6e59a181836e252e8)
* apollo-router

  + apollo-router/Cargo.toml
    [Cargo.toml](#diff-aca654efc6c22bebf4bd167370ab3bf380f3e086befe3d7c6761a8f7eb59d89c)
  + src

    - plugins

      * progressive\_override/snapshots

        + apollo-router/src/plugins/progressive\_override/snapshots/apollo\_router\_\_plugins\_\_progressive\_override\_\_tests\_\_non\_overridden\_field\_yields\_expected\_query\_plan.snap
          [apollo\_router\_\_plugins\_\_progressive\_override\_\_tests\_\_non\_overridden\_field\_yields\_expected\_query\_plan.snap](#diff-207aabbf5619ecf6c4ea00f45906c8225b2979f6b5ed0f1b6a22cd8f5404a8ef)
        + apollo-router/src/plugins/progressive\_override/snapshots/apollo\_router\_\_plugins\_\_progressive\_override\_\_tests\_\_overridden\_field\_yields\_expected\_query\_plan.snap
          [apollo\_router\_\_plugins\_\_progressive\_override\_\_tests\_\_overridden\_field\_yields\_expected\_query\_plan.snap](#diff-ba425b5f3a319b957754abc8e69d490bed4baf06438548f6f16955370a5ed6e5)
      * snapshots

        + apollo-router/src/plugins/snapshots/apollo\_router\_\_plugins\_\_expose\_query\_plan\_\_tests\_\_it\_expose\_query\_plan-2.snap
          [apollo\_router\_\_plugins\_\_expose\_query\_plan\_\_tests\_\_it\_expose\_query\_plan-2.snap](#diff-2b6c4d5904242581413b4678387b7c062f3e1ae5400dbc0ca0db6c1c664ddcc6)
        + apollo-router/src/plugins/snapshots/apollo\_router\_\_plugins\_\_expose\_query\_plan\_\_tests\_\_it\_expose\_query\_plan.snap
          [apollo\_router\_\_plugins\_\_expose\_query\_plan\_\_tests\_\_it\_expose\_query\_plan.snap](#diff-4ca5617a81a98e973ea78c6e34bf766c5e75f75581f733a361f90dd02940e44c)
      * telemetry

        + apollo-router/src/plugins/telemetry/apollo\_exporter.rs
          [apollo\_exporter.rs](#diff-c55c1d4741897a4ea4b6ca16330f1fecffded7713999e7fffef3b38ba37e499c)
        + tracing

          - apollo-router/src/plugins/telemetry/tracing/datadog.rs
            [datadog.rs](#diff-501bfeb11f487866359e28ecb571df00c18bf627bb51d49f8159dd7fd86d915b)
    - query\_planner

      * apollo-router/src/query\_planner/bridge\_query\_planner.rs
        [bridge\_query\_planner.rs](#diff-81b61a76f04cc56d2dfde521f8b4e7e621c11631d94162b1713ca98c9d5d988b)
      * apollo-router/src/query\_planner/caching\_query\_planner.rs
        [caching\_query\_planner.rs](#diff-560bfe015eb92a1ce9b2b1e2282f58d41574eeb3cb1d94385b5c8b96544e8b1c)
      * apollo-router/src/query\_planner/fetch.rs
        [fetch.rs](#diff-eeb037540a98ec5edc60c0a6551522bc4de624a77d424f2ddfea82798a54e95b)
      * apollo-router/src/query\_planner/plan.rs
        [plan.rs](#diff-21a82d277d12e8f21b6b71398d62e95303a117130cc4a27510b85ebfceeb8208)
      * snapshots

        + apollo-router/src/query\_planner/snapshots/apollo\_router\_\_query\_planner\_\_bridge\_query\_planner\_\_tests\_\_plan\_root.snap
          [apollo\_router\_\_query\_planner\_\_bridge\_query\_planner\_\_tests\_\_plan\_root.snap](#diff-c6a71dd799aea99defec6cd16b7ebc1d9db8a944e56cd0902b80d68f684f5c73)
    - spec

      * apollo-router/src/spec/query.rs
        [query.rs](#diff-ca21c6c2d8f5eacbc8fd08524c17571552b1ec649c2911b908b03b94b2c7c99f)
      * query

        + apollo-router/src/spec/query/change.rs
          [change.rs](#diff-b21dc8758c509f67655b816231a0ac2c2fd978c90b0ced9ce88a52fc74324e12)
  + tests/integration

    - apollo-router/tests/integration/redis.rs
      [redis.rs](#diff-233bab14edc417866e44f00208db77c61ec8ee2d08d86bea7bbbde0a90d537a4)
    - snapshots

      * apollo-router/tests/integration/snapshots/integration\_tests\_\_integration\_\_redis\_\_test\_\_query\_planner.snap
        [integration\_tests\_\_integration\_\_redis\_\_test\_\_query\_planner.snap](#diff-a41db31a0e170bc049754a1d76c056fcef2b7c73731060c0e539bc786d03fe95)
* dockerfiles/tracing

  + dockerfiles/tracing/docker-compose.datadog.yml
    [docker-compose.datadog.yml](#diff-e2075d236fe1ac8cf972cde8176d37469c873d74d71dad0d81446364ea4dcdee)
  + dockerfiles/tracing/docker-compose.jaeger.yml
    [docker-compose.jaeger.yml](#diff-538b94b0276c13d67df376938301d15bd08d46579ebbb5a17bef5f5fd5e21a2e)
  + dockerfiles/tracing/docker-compose.zipkin.yml
    [docker-compose.zipkin.yml](#diff-31e3825f3b6ab84644d05af11130e2ee1aae1b95fd5c644473d5dfbdf3e8e83e)
* helm/chart/router

  + helm/chart/router/Chart.yaml
    [Chart.yaml](#diff-9be0f0cacdb42dfe04daffca0ae832c12a9bc469b77feed05e6ffb88090a6c8d)
  + helm/chart/router/README.md
    [README.md](#diff-b4958c8f9d032763398a6614a572e0c42cad71184f04e1d80872ed8c592f5a4f)
* licenses.html
  [licenses.html](#diff-2edc42dfdb5939b87823f5a99bffd5b1395bb30ef71d3328c9fcff1b94b5448e)
* scripts

  + scripts/install.sh
    [install.sh](#diff-e076e43cb817ecc8b3c2ed18cd58baa50544ecc66293ed6e61129c43ca6a09cc)

## There are no files selected for viewing

16 changes: 8 additions & 8 deletions

16
[.circleci/config.yml](#diff-78a8a19706dbd2a4425dd72bdab0502ed7a2cef16365ab7030a5a0588927bf47 ".circleci/config.yml")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/.circleci/config.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,14 +48,14 @@ executors: |
|  |  | # See https://circleci.com/docs/xcode-policy along with the support matrix |
|  |  | # at https://circleci.com/docs/using-macos#supported-xcode-versions. |
|  |  | # We use the major.minor notation to bring in compatible patches. |
|  |  | xcode: 14.2 |
|  |  | xcode: "14.2.0" |
|  |  | resource\_class: macos.m1.medium.gen1 |
|  |  | macos\_test: &macos\_test\_executor |
|  |  | macos: |
|  |  | # See https://circleci.com/docs/xcode-policy along with the support matrix |
|  |  | # at https://circleci.com/docs/using-macos#supported-xcode-versions. |
|  |  | # We use the major.minor notation to bring in compatible patches. |
|  |  | xcode: 14.2 |
|  |  | xcode: "14.2.0" |
|  |  | resource\_class: macos.m1.medium.gen1 |
|  |  | windows\_build: &windows\_build\_executor |
|  |  | machine: |
| Expand Down  Expand Up | | @@ -201,7 +201,7 @@ commands: |
|  |  | find xtask/src -type f | while read name; do md5sum $name; done | sort -k 2 | md5sum > ~/.xtask\_version |
|  |  | # The closest common ancestor to the default branch, so that test jobs can take advantage previous compiles |
|  |  | git remote set-head origin -a |
|  |  | TARGET\_BRANCH=$(git rev-parse --abbrev-ref origin/HEAD) |
|  |  | TARGET\_BRANCH=$(git rev-parse --abbrev-ref origin/HEAD) |
|  |  | echo "Target branch is ${TARGET\_BRANCH}" |
|  |  | COMMON\_ANCESTOR\_REF=$(git merge-base HEAD "${TARGET\_BRANCH}") |
|  |  | echo "Common ancestor is ${COMMON\_ANCESTOR\_REF}" |
| Expand Down  Expand Up | | @@ -715,8 +715,8 @@ jobs: |
|  |  | # save containers for analysis |
|  |  | mkdir built-containers |
|  |  | docker save -o built-containers/router\_${VERSION}-debug.tar ${ROUTER\_TAG}:${VERSION}-debug |
|  |  | docker save -o built-containers/router\_${VERSION}.tar ${ROUTER\_TAG}:${VERSION} |
|  |  |  |
|  |  | docker save -o built-containers/router\_${VERSION}.tar ${ROUTER\_TAG}:${VERSION} |
|  |  |  |
|  |  | - persist\_to\_workspace: |
|  |  | root: . |
|  |  | paths: |
| Expand Down  Expand Up | | @@ -971,8 +971,8 @@ workflows: |
|  |  | # Disables all PR comments from this job |
|  |  | do-pr-comments: false |
|  |  | # Scan job will return 1 if findings violating the Wiz policy are found. |
|  |  | # Toggle off to prevent any CI failures OR |
|  |  | # contact Apollo's Security team to adjust what violates the |
|  |  | # Toggle off to prevent any CI failures OR |
|  |  | # contact Apollo's Security team to adjust what violates the |
|  |  | # Wiz policy used in this scan. |
|  |  | fail-on-findings: true |
|  |  | # Configure scan job to use a policy specific to apollo-router. |
| Expand Down  Expand Up | | @@ -1069,7 +1069,7 @@ workflows: |
|  |  | ignore: /.\*/ |
|  |  | tags: |
|  |  | only: /v.\*/ |
|  |  |  |
|  |  |  |
|  |  | security-scans: |
|  |  | when: |
|  |  | not: << pipeline.parameters.nightly >> |
| Expand Down | |  |

34 changes: 34 additions & 0 deletions

34
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -4,8 +4,37 @@ All notable changes to Router will be documented in this file. |
|  |  |  |
|  |  | This project adheres to [Semantic Versioning v2.0.0](https://semver.org/spec/v2.0.0.html). |
|  |  |  |
|  |  | # [1.45.1] - 2024-04-26 |
|  |  |  |
|  |  | ## üêõ Fixes |
|  |  |  |
|  |  | ### Correct v1.44.0 regression in query plan cache ([PR #5028](https://github.com/apollographql/router/pull/5028)) |
|  |  |  |
|  |  | Correct a critical regression that was introduced in [v1.44.0](https://github.com/apollographql/router/pull/4883) which could lead to execution of an incorrect query plan. |
|  |  |  |
|  |  | By [@o0Ignition0o](https://github.com/o0Ignition0o) in https://github.com/apollographql/router/pull/5028 |
|  |  |  |
|  |  | ### Use entire schema when hashing an introspection query ([Issue #5006](https://github.com/apollographql/router/issues/5006)) |
|  |  |  |
|  |  | Correct a \_different\_ hashing bug which impacted introspection queries which was also introduced in [v1.44.0](https://github.com/apollographql/router/pull/4883). This other hashing bug failed to account for introspection queries, resulting in introspection results being misaligned to the current schema. |
|  |  |  |
|  |  | This release fixes the hashing mechanism by adding the schema string to hashed data if an introspection field is encountered. As a result, the entire schema is taken into account and the correct introspection result is returned. |
|  |  |  |
|  |  | By [@Geal](https://github.com/Geal) in https://github.com/apollographql/router/pull/5007 |
|  |  |  |
|  |  | ### Fix subgraph name mapping of Datadog exporter ([PR #5012](https://github.com/apollographql/router/pull/5012)) |
|  |  |  |
|  |  | Previously in the router v1.45.0, subgraph name mapping didn't work correctly in the router's Datadog exporter. The exporter used the incorrect value `apollo.subgraph.name` for mapping attributes when it should have used the value `subgraph.name`. This issue has been fixed in this release. |
|  |  |  |
|  |  | By [@garypen](https://github.com/garypen) in https://github.com/apollographql/router/pull/5012 |
|  |  |  |
|  |  |  |
|  |  | # [1.45.0] - 2024-04-22 |
|  |  |  |
|  |  | > \*\*Warning\*\* |
|  |  | > |
|  |  | > \*\*This version has a critical bug impacting all users. See the \_Fixes\_ in [v1.45.1](https://github.com/apollographql/router/releases/tag/v1.45.1) for details. We highly recommend using v1.45.1 or v1.43.2 over v1.45.0.\*\* |
|  |  |  |
|  |  | ## üöÄ Features |
|  |  |  |
|  |  | ### Query validation process with Rust ([PR #4551](https://github.com/apollographql/router/pull/4551)) |
| Expand Down  Expand Up | | @@ -154,6 +183,11 @@ By [@bonnici](https://github.com/bonnici) in https://github.com/apollographql/ro |
|  |  |  |
|  |  | # [1.44.0] - 2024-04-12 |
|  |  |  |
|  |  | > \*\*Warning\*\* |
|  |  | > |
|  |  | > \*\*This version has a critical bug impacting all users. See the \_Fixes\_ in [v1.45.1](https://github.com/apollographql/router/releases/tag/v1.45.1) for details. We highly recommend using v1.45.1 or v1.43.2 over v1.44.0.\*\* |
|  |  |  |
|  |  |  |
|  |  | ## üöÄ Features |
|  |  |  |
|  |  | ### Add details to `router service call failed` errors ([Issue #4899](https://github.com/apollographql/router/issues/4899)) |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[Cargo.lock](#diff-13ee4b2252c9e516a0547f2891aa2105c3ca71c6d7a1e682c69be97998dfc87e "Cargo.lock")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/Cargo.lock)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -250,7 +250,7 @@ dependencies = [ |
|  |  |  |
|  |  | [[package]] |
|  |  | name = "apollo-router" |
|  |  | version = "1.45.0" |
|  |  | version = "1.45.1" |
|  |  | dependencies = [ |
|  |  | "access-json", |
|  |  | "anyhow", |
| Expand Down  Expand Up | | @@ -411,7 +411,7 @@ dependencies = [ |
|  |  |  |
|  |  | [[package]] |
|  |  | name = "apollo-router-benchmarks" |
|  |  | version = "1.45.0" |
|  |  | version = "1.45.1" |
|  |  | dependencies = [ |
|  |  | "apollo-parser", |
|  |  | "apollo-router", |
| Expand All | | @@ -427,7 +427,7 @@ dependencies = [ |
|  |  |  |
|  |  | [[package]] |
|  |  | name = "apollo-router-scaffold" |
|  |  | version = "1.45.0" |
|  |  | version = "1.45.1" |
|  |  | dependencies = [ |
|  |  | "anyhow", |
|  |  | "cargo-scaffold", |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[apollo-router-benchmarks/Cargo.toml](#diff-434c5e6ed0b34e6d054746811fde31a064115a3a85ea26b6acc1d290488962b8 "apollo-router-benchmarks/Cargo.toml")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router-benchmarks/Cargo.toml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | [package] |
|  |  | name = "apollo-router-benchmarks" |
|  |  | version = "1.45.0" |
|  |  | version = "1.45.1" |
|  |  | authors = ["Apollo Graph, Inc. <packages@apollographql.com>"] |
|  |  | edition = "2021" |
|  |  | license = "Elastic-2.0" |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[apollo-router-scaffold/Cargo.toml](#diff-16e0852ca81fdc02bb019d31103f0528251bc8e87345b70b26ddf10a81465034 "apollo-router-scaffold/Cargo.toml")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router-scaffold/Cargo.toml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | [package] |
|  |  | name = "apollo-router-scaffold" |
|  |  | version = "1.45.0" |
|  |  | version = "1.45.1" |
|  |  | authors = ["Apollo Graph, Inc. <packages@apollographql.com>"] |
|  |  | edition = "2021" |
|  |  | license = "Elastic-2.0" |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[apollo-router-scaffold/templates/base/Cargo.toml](#diff-2a5b46149041aebc53d0eeb767d2b3c96cb952c5d8f15e0b210e1e63b92d4e38 "apollo-router-scaffold/templates/base/Cargo.toml")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router-scaffold/templates/base/Cargo.toml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -22,7 +22,7 @@ apollo-router = { path ="{{integration\_test}}apollo-router" } |
|  |  | apollo-router = { git="https://github.com/apollographql/router.git", branch="{{branch}}" } |
|  |  | {{else}} |
|  |  | # Note if you update these dependencies then also update xtask/Cargo.toml |
|  |  | apollo-router = "1.45.0" |
|  |  | apollo-router = "1.45.1" |
|  |  | {{/if}} |
|  |  | {{/if}} |
|  |  | async-trait = "0.1.52" |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[apollo-router-scaffold/templates/base/xtask/Cargo.toml](#diff-c4a539b83157dc547fe7557fa0508b19a012a8e7fe86eca6e59a181836e252e8 "apollo-router-scaffold/templates/base/xtask/Cargo.toml")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router-scaffold/templates/base/xtask/Cargo.toml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,7 +13,7 @@ apollo-router-scaffold = { path ="{{integration\_test}}apollo-router-scaffold" } |
|  |  | {{#if branch}} |
|  |  | apollo-router-scaffold = { git="https://github.com/apollographql/router.git", branch="{{branch}}" } |
|  |  | {{else}} |
|  |  | apollo-router-scaffold = { git = "https://github.com/apollographql/router.git", tag = "v1.45.0" } |
|  |  | apollo-router-scaffold = { git = "https://github.com/apollographql/router.git", tag = "v1.45.1" } |
|  |  | {{/if}} |
|  |  | {{/if}} |
|  |  | anyhow = "1.0.58" |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[apollo-router/Cargo.toml](#diff-aca654efc6c22bebf4bd167370ab3bf380f3e086befe3d7c6761a8f7eb59d89c "apollo-router/Cargo.toml")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router/Cargo.toml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | [package] |
|  |  | name = "apollo-router" |
|  |  | version = "1.45.0" |
|  |  | version = "1.45.1" |
|  |  | authors = ["Apollo Graph, Inc. <packages@apollographql.com>"] |
|  |  | repository = "https://github.com/apollographql/router/" |
|  |  | documentation = "https://docs.rs/apollo-router" |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[...lugins\_\_progressive\_override\_\_tests\_\_non\_overridden\_field\_yields\_expected\_query\_plan.snap](#diff-207aabbf5619ecf6c4ea00f45906c8225b2979f6b5ed0f1b6a22cd8f5404a8ef "apollo-router/src/plugins/progressive_override/snapshots/apollo_router__plugins__progressive_override__tests__non_overridden_field_yields_expected_query_plan.snap")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router/src/plugins/progressive_override/snapshots/apollo_router__plugins__progressive_override__tests__non_overridden_field_yields_expected_query_plan.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,7 +18,7 @@ expression: query\_plan |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "9358047754b11522aac502a3c6a668cd4286c07d489680834e63d6e033db4eb5", |
|  |  | "schemaAwareHash": "12dda6193654ae4fe6e38bc09d4f81cc73d0c9e098692096f72d2158eef4776f", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[...r\_\_plugins\_\_progressive\_override\_\_tests\_\_overridden\_field\_yields\_expected\_query\_plan.snap](#diff-ba425b5f3a319b957754abc8e69d490bed4baf06438548f6f16955370a5ed6e5 "apollo-router/src/plugins/progressive_override/snapshots/apollo_router__plugins__progressive_override__tests__overridden_field_yields_expected_query_plan.snap")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router/src/plugins/progressive_override/snapshots/apollo_router__plugins__progressive_override__tests__overridden_field_yields_expected_query_plan.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,7 +23,7 @@ expression: query\_plan |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "8f445761c0bcdda90b8da35ccd13fd98e474514f3efc071bd2c39495b5af94e5", |
|  |  | "schemaAwareHash": "00ad582ea45fc1bce436b36b21512f3d2c47b74fdbdc61e4b349289722c9ecf2", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down  Expand Up | | @@ -61,7 +61,7 @@ expression: query\_plan |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "9a1feab7ee8c57c8a4ab4db29712412a9cfe94009bfcb40dc0d22ea54c410865", |
|  |  | "schemaAwareHash": "a8ebdc2151a2e5207882e43c6906c0c64167fd9a8e0c7c4becc47736a5105096", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[...s/snapshots/apollo\_router\_\_plugins\_\_expose\_query\_plan\_\_tests\_\_it\_expose\_query\_plan-2.snap](#diff-2b6c4d5904242581413b4678387b7c062f3e1ae5400dbc0ca0db6c1c664ddcc6 "apollo-router/src/plugins/snapshots/apollo_router__plugins__expose_query_plan__tests__it_expose_query_plan-2.snap")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router/src/plugins/snapshots/apollo_router__plugins__expose_query_plan__tests__it_expose_query_plan-2.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -68,7 +68,7 @@ expression: "serde\_json::to\_value(response).unwrap()" |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "34be619a78867ab9d0670048f4c93574e38cd9253e9cc032f567078355b25086", |
|  |  | "schemaAwareHash": "7245d488e97c3b2ac9f5fa4dd4660940b94ad81af070013305b2c0f76337b2f9", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down  Expand Up | | @@ -107,7 +107,7 @@ expression: "serde\_json::to\_value(response).unwrap()" |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "f1582d942020b23347d84f6ae46c018492ae7c59c9b1472e0b442121ddf16368", |
|  |  | "schemaAwareHash": "6e0b4156706ea0cf924500cfdc99dd44b9f0ed07e2d3f888d4aff156e6a33238", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down  Expand Up | | @@ -153,7 +153,7 @@ expression: "serde\_json::to\_value(response).unwrap()" |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "6fa5a74c5af2b18f343e9e69bbcbc9335e9faaa46c3d8964d199002dfeb0026f", |
|  |  | "schemaAwareHash": "ff649f3d70241d5a8cd5f5d03ff4c41ecff72b0e4129a480207b05ac92318042", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down  Expand Up | | @@ -196,7 +196,7 @@ expression: "serde\_json::to\_value(response).unwrap()" |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "6fa5a74c5af2b18f343e9e69bbcbc9335e9faaa46c3d8964d199002dfeb0026f", |
|  |  | "schemaAwareHash": "bf9f3beda78a7a565e47c862157bad4ec871d724d752218da1168455dddca074", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[...ins/snapshots/apollo\_router\_\_plugins\_\_expose\_query\_plan\_\_tests\_\_it\_expose\_query\_plan.snap](#diff-4ca5617a81a98e973ea78c6e34bf766c5e75f75581f733a361f90dd02940e44c "apollo-router/src/plugins/snapshots/apollo_router__plugins__expose_query_plan__tests__it_expose_query_plan.snap")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router/src/plugins/snapshots/apollo_router__plugins__expose_query_plan__tests__it_expose_query_plan.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -68,7 +68,7 @@ expression: "serde\_json::to\_value(response).unwrap()" |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "34be619a78867ab9d0670048f4c93574e38cd9253e9cc032f567078355b25086", |
|  |  | "schemaAwareHash": "7245d488e97c3b2ac9f5fa4dd4660940b94ad81af070013305b2c0f76337b2f9", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down  Expand Up | | @@ -107,7 +107,7 @@ expression: "serde\_json::to\_value(response).unwrap()" |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "f1582d942020b23347d84f6ae46c018492ae7c59c9b1472e0b442121ddf16368", |
|  |  | "schemaAwareHash": "6e0b4156706ea0cf924500cfdc99dd44b9f0ed07e2d3f888d4aff156e6a33238", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down  Expand Up | | @@ -153,7 +153,7 @@ expression: "serde\_json::to\_value(response).unwrap()" |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "6fa5a74c5af2b18f343e9e69bbcbc9335e9faaa46c3d8964d199002dfeb0026f", |
|  |  | "schemaAwareHash": "ff649f3d70241d5a8cd5f5d03ff4c41ecff72b0e4129a480207b05ac92318042", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down  Expand Up | | @@ -196,7 +196,7 @@ expression: "serde\_json::to\_value(response).unwrap()" |
|  |  | "id": null, |
|  |  | "inputRewrites": null, |
|  |  | "outputRewrites": null, |
|  |  | "schemaAwareHash": "6fa5a74c5af2b18f343e9e69bbcbc9335e9faaa46c3d8964d199002dfeb0026f", |
|  |  | "schemaAwareHash": "bf9f3beda78a7a565e47c862157bad4ec871d724d752218da1168455dddca074", |
|  |  | "authorization": { |
|  |  | "is\_authenticated": false, |
|  |  | "scopes": [], |
| Expand Down | |  |

14 changes: 0 additions & 14 deletions

14
[apollo-router/src/plugins/telemetry/apollo\_exporter.rs](#diff-c55c1d4741897a4ea4b6ca16330f1fecffded7713999e7fffef3b38ba37e499c "apollo-router/src/plugins/telemetry/apollo_exporter.rs")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router/src/plugins/telemetry/apollo_exporter.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -442,17 +442,3 @@ where |
|  |  | None => serializer.serialize\_none(), |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | #[cfg(not(windows))] // git checkout converts \n to \r\n, making == below fail |
|  |  | #[test] |
|  |  | fn check\_reports\_proto\_is\_up\_to\_date() { |
|  |  | let proto\_url = "https://usage-reporting.api.apollographql.com/proto/reports.proto"; |
|  |  | let response = reqwest::blocking::get(proto\_url).unwrap(); |
|  |  | let content = response.text().unwrap(); |
|  |  | // Not using assert\_eq! as printing the entire file would be too verbose |
|  |  | assert!( |
|  |  | content == include\_str!("proto/reports.proto"), |
|  |  | "Protobuf file is out of date. Run this command to update it:\n\n \ |
|  |  | curl -f {proto\_url} > apollo-router/src/plugins/telemetry/proto/reports.proto\n\n" |
|  |  | ); |
|  |  | } |

2 changes: 1 addition & 1 deletion

2
[apollo-router/src/plugins/telemetry/tracing/datadog.rs](#diff-501bfeb11f487866359e28ecb571df00c18bf627bb51d49f8159dd7fd86d915b "apollo-router/src/plugins/telemetry/tracing/datadog.rs")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router/src/plugins/telemetry/tracing/datadog.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,7 +29,7 @@ lazy\_static! { |
|  |  | map.insert("request", "http.route"); |
|  |  | map.insert("supergraph", "graphql.operation.name"); |
|  |  | map.insert("query\_planning", "graphql.operation.name"); |
|  |  | map.insert("subgraph", "apollo.subgraph.name"); |
|  |  | map.insert("subgraph", "subgraph.name"); |
|  |  | map.insert("subgraph\_request", "graphql.operation.name"); |
|  |  | map |
|  |  | }; |
| Expand Down | |  |

24 changes: 17 additions & 7 deletions

24
[apollo-router/src/query\_planner/bridge\_query\_planner.rs](#diff-81b61a76f04cc56d2dfde521f8b4e7e621c11631d94162b1713ca98c9d5d988b "apollo-router/src/query_planner/bridge_query_planner.rs")

Show comments

[View file](/apollographql/router/blob/ff9f666598cd17661880fe7fc6e9c9611316e529/apollo-router/src/query_planner/bridge_query_planner.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -379,7 +379,9 @@ impl BridgeQueryPlanner { |
|  |  | .into\_result() |
|  |  | { |
|  |  | Ok(mut plan) => { |
|  |  | plan.data.query\_plan.hash\_subqueries(&self.subgraph\_schemas); |
|  |  | plan.data |
|  |  | .query\_plan |
|  |  | .hash\_subqueries(&self.subgraph\_schemas, &self.schema.raw\_sdl); |
|  |  | plan.data |
|  |  | .query\_plan |
|  |  | .extract\_authorization\_metadata(&self.schema.definitions, &key); |
| Expand Down  Expand Up | | @@ -583,19 +585,22 @@ impl Service<QueryPlannerRequest> for BridgeQueryPlanner { |
|  |  | Some(d) => d, |
|  |  | }; |
|  |  |  |
|  |  | let schema = &this.schema.api\_schema().definitions; |
|  |  | match add\_defer\_labels(schema, &doc.ast) { |
|  |  | let api\_schema = this.schema.api\_schema(); |
|  |  | let api\_schema\_definitions = &api\_schema.definitions; |
|  |  | match add\_defer\_labels(api\_schema\_definitions, &doc.ast) { |
|  |  | Err(e) => { |
|  |  | return Err(QueryPlannerError::SpecError(SpecError::TransformError( |
|  |  | e.to\_string(), |
|  |  | ))) |
|  |  | } |
|  |  | Ok(modified\_query) => { |
|  |  | let executable\_document = modified\_query |
|  |  | .to\_executable\_validate(schema) |
|  |  | .to\_executable\_validate(api\_schema\_definitions) |
|  |  | // Assume transformation creates a valid document: ignore conversion errors |
|  |  | .map\_err(|e| SpecError::ValidationError(e.into()))?; |
|  |  | let hash = QueryHashVisitor::hash\_query( |
|  |  | schema, |
|  |  | api\_schema\_definitions, |
|  |  | &api\_schema.raw\_sdl, |
|  |  | &executable\_document, |
|  |  | operation\_name.as\_deref(), |
|  |  | ) |
| Expand Down  Expand Up | | @@ -715,6 +720,7 @@ impl BridgeQueryPlanner { |
|  |  | .map\_err(|e| SpecError::ValidationError(e.into()))?; |
|  |  | let hash = QueryHashVisitor::hash\_query( |
|  |  | &self.schema.definitions, |
|  |  | &self.schema.raw\_sdl, |
|  |  | &executable\_document, |
|  |  | key.operation\_name.as\_deref(), |
|  |  | ) |
| Expand Down  Expand Up | | @@ -807,9 +813,13 @@ struct QueryPlan { |
|  |  | } |
|  |  |  |
|  |  | impl QueryPlan { |
|  |  | fn hash\_subqueries(&mut self, schemas: &HashMap<String, Arc<Valid<apollo\_compiler::Schema>>>) { |
|  |  | fn hash\_subqueries( |
|  |  | &mut self, |
|  |  | schemas: &HashMap<String, Arc<Valid<apollo\_compiler::Schema>>>, |
|  |  | supergraph\_schema\_hash: &str, |
|  |  | ) { |
|  |  | if let Some(node) = self.node.as\_mut() { |
|  |  | node.hash\_subqueries(schemas); |
|  |  | node.hash\_subqueries(schemas, supergraph\_schema\_hash); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ff9f666`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapollographql%2Frouter%2Fcommit%2Fff9f666598cd17661880fe7fc6e9c9611316e529) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.apollographql.com_da5fb421_20250110_141523.html ===
        [Docs](/docs)          Search Apollo content (Cmd+K or /)             [Launch GraphOS Studio](https://studio.apollographql.com/signup?referrer=docs)        [Home Home](/docs/)  [Get Started Get Started](/docs/graphos/get-started)  [GraphOS Platform GraphOS Platform](/docs/graphos/platform)  [Schema Design Schema Design](/docs/graphos/schema-design)  [Routing Routing](/docs/graphos/routing)  [Reference Reference](/docs/graphos/reference)      Developer Tools Developer Tools          [Rover CLI](https://www.apollographql.com/docs/rover)[Apollo Sandbox](https://www.apollographql.com/docs/apollo-sandbox)[Apollo Client (Web)](https://www.apollographql.com/docs/react)[Apollo iOS](https://www.apollographql.com/docs/ios)[Apollo Kotlin](https://www.apollographql.com/docs/kotlin)[Apollo Server](https://www.apollographql.com/docs/apollo-server)[Apollo Router Core](https://github.com/apollographql/router)[VS Code Extension](https://www.apollographql.com/docs/vs-code-extension)                     [Overview](https://www.apollographql.com/docs/graphos/routing)[About GraphOS Router](https://www.apollographql.com/docs/graphos/routing/about-router)[Configure Your Router](https://www.apollographql.com/docs/graphos/routing/configure-your-router)
### Cloud Routing

[Overview](https://www.apollographql.com/docs/graphos/routing/cloud)[Configuration](https://www.apollographql.com/docs/graphos/routing/cloud/configuration)[Secure Subgraphs](https://www.apollographql.com/docs/graphos/routing/cloud/secure-subgraphs)[Subscriptions](https://www.apollographql.com/docs/graphos/routing/cloud/subscriptions)[Serverless](https://www.apollographql.com/docs/graphos/routing/cloud/serverless)
### Dedicated

[Overview](https://www.apollographql.com/docs/graphos/routing/cloud/dedicated)[Quickstart](https://www.apollographql.com/docs/graphos/routing/cloud/dedicated-quickstart)[Custom Domains](https://www.apollographql.com/docs/graphos/routing/cloud/custom-domains)[Throughput Guide](https://www.apollographql.com/docs/graphos/routing/cloud/throughput-guide)[Migrate to Dedicated](https://www.apollographql.com/docs/graphos/routing/cloud/migrate-to-dedicated)
### AWS Lattice

[Lattice Configuration](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-configuration)[Lattice Management](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-management)[Lattice Troubleshooting](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-troubleshooting)
### Self-Hosted Deployment

[Overview](https://www.apollographql.com/docs/graphos/routing/self-hosted)[Router Resource Estimator](https://www.apollographql.com/docs/graphos/routing/self-hosted/resource-estimator)[Health Checks](https://www.apollographql.com/docs/graphos/routing/self-hosted/health-checks)[Resource Management](https://www.apollographql.com/docs/graphos/routing/self-hosted/resource-management)
### Containerization

[Overview](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization)[Docker](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/docker)[Kubernetes](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/kubernetes)[Optimize Builds](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/optimize-build)
### Query Planning

[Native Query Planner](https://www.apollographql.com/docs/graphos/routing/query-planning/native-query-planner)
### Client Features

[HTTP Header Propagation](https://www.apollographql.com/docs/graphos/routing/header-propagation)[File Upload Support](https://www.apollographql.com/docs/graphos/routing/operations/file-upload)
### Real-Time Operations

[Overview](https://www.apollographql.com/docs/graphos/routing/operations)[Defer Support](https://www.apollographql.com/docs/graphos/routing/operations/defer)
### Subscription Support

[Overview](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions)[Callback Protocol](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/callback-protocol)[Multipart Protocol](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/multipart-protocol)[Enable with API Gateway](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/api-gateway)
### Security

[Overview](https://www.apollographql.com/docs/graphos/routing/security)[Persisted Queries](https://www.apollographql.com/docs/graphos/routing/security/persisted-queries)[Authorization](https://www.apollographql.com/docs/graphos/routing/security/authorization)
### Authentication

[JWT Authentication](https://www.apollographql.com/docs/graphos/routing/security/jwt)[Router Authentication](https://www.apollographql.com/docs/graphos/routing/security/router-authentication)[Subgraph Authentication](https://www.apollographql.com/docs/graphos/routing/security/subgraph-authentication)
### Operations Security

[Request Limits](https://www.apollographql.com/docs/graphos/routing/security/request-limits)[Demand Control](https://www.apollographql.com/docs/graphos/routing/security/demand-control)
### Web Security

[CORS](https://www.apollographql.com/docs/graphos/routing/security/cors)[CSRF Prevention](https://www.apollographql.com/docs/graphos/routing/security/csrf)
### Performance and Scaling

[Overview](https://www.apollographql.com/docs/graphos/routing/performance)[Traffic Shaping](https://www.apollographql.com/docs/graphos/routing/performance/traffic-shaping)[Query Batching](https://www.apollographql.com/docs/graphos/routing/performance/query-batching)[Query Planner Pools](https://www.apollographql.com/docs/graphos/routing/performance/query-planner-pools)
### Caching

[In-Memory Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/in-memory)[Distributed Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/distributed)[Entity Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/entity)
### Router Customization

[Router Request Lifecycle](https://www.apollographql.com/docs/graphos/routing/customization/overview)[Rhai Scripts](https://www.apollographql.com/docs/graphos/routing/customization/rhai)[Rust Plugins](https://www.apollographql.com/docs/graphos/routing/customization/native-plugins)[Coprocessors](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor)[Custom Binaries](https://www.apollographql.com/docs/graphos/routing/customization/custom-binary)
### GraphOS Integration

[Apollo Uplink](https://www.apollographql.com/docs/graphos/routing/uplink)[Operation Metrics Reporting](https://www.apollographql.com/docs/graphos/routing/graphos-reporting)
### Observability

[Overview](https://www.apollographql.com/docs/graphos/routing/observability)[Router Telemetry](https://www.apollographql.com/docs/graphos/routing/observability/telemetry)[Federated Trace Data](https://www.apollographql.com/docs/graphos/routing/observability/federated-trace-data)
### Subgraph Observability

[Subgraph Error Inclusion](https://www.apollographql.com/docs/graphos/routing/observability/subgraph-error-inclusion)[Opt-in Error Reporting](https://www.apollographql.com/docs/graphos/routing/observability/error-reporting)[Debugging Subgraph Requests](https://www.apollographql.com/docs/graphos/routing/observability/debugging-subgraph-requests)
### Client Observability

[Client ID Enforcement](https://www.apollographql.com/docs/graphos/routing/observability/client-id-enforcement)
### OpenTelemetry

[Set up OTel](https://www.apollographql.com/docs/graphos/routing/observability/otel)[Connect OTel to Prometheus](https://www.apollographql.com/docs/graphos/routing/observability/otel-traces-to-prometheus)
### Guides

[API Gateway Comparison](https://www.apollographql.com/docs/graphos/routing/router-api-gateway-comparison)Navigation controls
## Get Started

[Overview](https://www.apollographql.com/docs/graphos/get-started)
### Quickstarts

[Start with a GraphQL API](https://www.apollographql.com/docs/graphos/get-started/guides/quickstart)[Connect a REST API](https://www.apollographql.com/docs/graphos/get-started/guides/rest-quickstart)
### Concepts

[GraphQL](https://www.apollographql.com/docs/graphos/get-started/concepts/graphql)[Graph Types](https://www.apollographql.com/docs/graphos/get-started/concepts/graphs)[GraphOS Platform](https://www.apollographql.com/docs/graphos/get-started/concepts/graphos)
## GraphOS Platform

[Overview](https://www.apollographql.com/docs/graphos/platform)
### Schema Management

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management)
### Schema Delivery

[Publish](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/publish)[Launch](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/launch)
### Contracts

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/contracts/overview)[Create](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/contracts/create)[Usage Patterns](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/contracts/usage-patterns)[Reference](https://www.apollographql.com/docs/graphos/platform/schema-management/delivery/contracts/reference)
### Schema Checks

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management/checks)[Run Checks](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/run)[Custom Checks](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/custom)[Checks Configuration](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/configure)[GitHub Integration](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/github-integration)[Checks Reference](https://www.apollographql.com/docs/graphos/platform/schema-management/checks/reference)
### Schema Linting

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management/linting)[Linter Rules](https://www.apollographql.com/docs/graphos/platform/schema-management/linting/rules)
### Schema Proposals

[Overview](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals)[Configure](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals/configure)[Create](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals/create)[Review](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals/review)[Implement](https://www.apollographql.com/docs/graphos/platform/schema-management/proposals/implement)
### Explorer IDE

[Overview](https://www.apollographql.com/docs/graphos/platform/explorer)[Connect and Authenticate](https://www.apollographql.com/docs/graphos/platform/explorer/connect)[Operation Collections](https://www.apollographql.com/docs/graphos/platform/explorer/operation-collections)[Subscription Support](https://www.apollographql.com/docs/graphos/platform/explorer/subscription-support)[Embed](https://www.apollographql.com/docs/graphos/platform/explorer/embed)[Scripting](https://www.apollographql.com/docs/graphos/platform/explorer/scripting)[Additional Features](https://www.apollographql.com/docs/graphos/platform/explorer/additional-features)
### Graph Security

[Overview](https://www.apollographql.com/docs/graphos/platform/security/overview)[Persisted Queries](https://www.apollographql.com/docs/graphos/platform/security/persisted-queries)
### Metrics and Insights

[Overview](https://www.apollographql.com/docs/graphos/platform/insights)
### Metrics Collection and Forwarding

[Sending Metrics to GraphOS](https://www.apollographql.com/docs/graphos/platform/insights/sending-operation-metrics)[Operation Signatures](https://www.apollographql.com/docs/graphos/platform/insights/operation-signatures)[Datadog Forwarding](https://www.apollographql.com/docs/graphos/platform/insights/datadog-forwarding)
### Insights and Analysis

[Operation Metrics](https://www.apollographql.com/docs/graphos/platform/insights/operation-metrics)[Field Usage](https://www.apollographql.com/docs/graphos/platform/insights/field-usage)[Segmenting by Client](https://www.apollographql.com/docs/graphos/platform/insights/client-segmentation)
### Notifications and Alerts

[Overview](https://www.apollographql.com/docs/graphos/platform/insights/notifications)[Daily Reports](https://www.apollographql.com/docs/graphos/platform/insights/notifications/daily-reports)[Schema Changes](https://www.apollographql.com/docs/graphos/platform/insights/notifications/schema-changes)[Schema Proposals](https://www.apollographql.com/docs/graphos/platform/insights/notifications/schema-proposals)[Performance Alerts](https://www.apollographql.com/docs/graphos/platform/insights/notifications/performance-alerts)[Build Status](https://www.apollographql.com/docs/graphos/platform/insights/notifications/build-status)
### Access Management

[Organizations](https://www.apollographql.com/docs/graphos/platform/access-management/org)[API Keys](https://www.apollographql.com/docs/graphos/platform/access-management/api-keys)[Members, Roles, and Permissions](https://www.apollographql.com/docs/graphos/platform/access-management/member-roles)[Audit Logs](https://www.apollographql.com/docs/graphos/platform/access-management/audit-log)
### SSO

[Overview](https://www.apollographql.com/docs/graphos/platform/access-management/sso/overview)[Multi-Organization](https://www.apollographql.com/docs/graphos/platform/access-management/sso/multi-organization)
### SAML

[Okta](https://www.apollographql.com/docs/graphos/platform/access-management/sso/saml-okta)[Microsoft Entra ID](https://www.apollographql.com/docs/graphos/platform/access-management/sso/saml-microsoft-entra-id)[Generic SAML Setup](https://www.apollographql.com/docs/graphos/platform/access-management/sso/saml-integration-guide)
### OIDC

[Okta](https://www.apollographql.com/docs/graphos/platform/access-management/sso/oidc-okta)[Microsoft Entra ID](https://www.apollographql.com/docs/graphos/platform/access-management/sso/oidc-microsoft-entra-id)[Generic OIDC Setup](https://www.apollographql.com/docs/graphos/platform/access-management/sso/oidc-integration-guide)
### Graph Management

[Using Variants](https://www.apollographql.com/docs/graphos/platform/graph-management/variants)[Adding Subgraphs](https://www.apollographql.com/docs/graphos/platform/graph-management/add-subgraphs)[Managing Subgraphs](https://www.apollographql.com/docs/graphos/platform/graph-management/manage-subgraphs)[Updating Graph Components](https://www.apollographql.com/docs/graphos/platform/graph-management/updates)
### Production Readiness

[Production Readiness Checklist](https://www.apollographql.com/docs/graphos/platform/production-readiness/checklist)
### Testing and Load Management

[Overload Protection](https://www.apollographql.com/docs/graphos/platform/production-readiness/overload-protection)[Load Testing](https://www.apollographql.com/docs/graphos/platform/production-readiness/load-testing)[Testing with Federation](https://www.apollographql.com/docs/graphos/platform/production-readiness/testing-with-apollo-federation)
### Environment and Deployment

[Environment Best Practices](https://www.apollographql.com/docs/graphos/platform/production-readiness/environment-best-practices)[Schema Change Management](https://www.apollographql.com/docs/graphos/platform/production-readiness/change-management)[Updating Client Schema](https://www.apollographql.com/docs/graphos/platform/production-readiness/updating-client-schema)[Deployment Best Practices](https://www.apollographql.com/docs/graphos/platform/production-readiness/deployment-best-practices)[GraphOS Platform API](https://www.apollographql.com/docs/graphos/platform/platform-api)
## Schema Design

[Overview](https://www.apollographql.com/docs/graphos/schema-design)
### Federated Schemas

[Apollo Federation](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/federation)[Schema Types](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/schema-types)[Schema Composition](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/composition)[Sharing Types (Value Types)](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/sharing-types)[IDE Support](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/ide-support)
### Entities

[Introduction](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/intro)[Define Keys](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/define-keys)[Contribute Fields](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/contribute-fields)[Resolve Another Subgraph's Fields](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/resolve-another-subgraphs-fields)[Use Contexts](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/use-contexts)[Interfaces](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/interfaces)[Migrate Fields](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/migrate-fields)[Enforce Ownership](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/enforce-ownership)[Entity Best Practices](https://www.apollographql.com/docs/graphos/schema-design/federated-schemas/entities/best-practices)
### Apollo Connectors

[Overview](https://www.apollographql.com/docs/graphos/schema-design/connectors)[Common Patterns](https://www.apollographql.com/docs/graphos/schema-design/connectors/guides)
### Connectors Guides

[Making HTTP Requests](https://www.apollographql.com/docs/graphos/schema-design/connectors/http)[Working with Federation](https://www.apollographql.com/docs/graphos/schema-design/connectors/federation)[Working with Router](https://www.apollographql.com/docs/graphos/schema-design/connectors/router)[Selection Mapping](https://www.apollographql.com/docs/graphos/schema-design/connectors/selection)[Observability](https://www.apollographql.com/docs/graphos/schema-design/connectors/observability)[Troubleshooting](https://www.apollographql.com/docs/graphos/schema-design/connectors/troubleshooting)
### IDE Support

[Visual Studio Code](https://www.apollographql.com/docs/graphos/schema-design/connectors/vs-code)[Vim/NeoVim](https://www.apollographql.com/docs/graphos/schema-design/connectors/vim)
### Connectors Reference

[Directives](https://www.apollographql.com/docs/graphos/schema-design/connectors/directives)[Limitations](https://www.apollographql.com/docs/graphos/schema-design/connectors/limitations)[Changelog](https://www.apollographql.com/docs/graphos/schema-design/connectors/changelog)
### Schema Design Guides

[Handling the N+1 Problem](https://www.apollographql.com/docs/graphos/schema-design/guides/handling-n-plus-one)
### Schema Design Principles

[Schema Naming Conventions](https://www.apollographql.com/docs/graphos/schema-design/guides/naming-conventions)[Namespacing](https://www.apollographql.com/docs/graphos/schema-design/guides/namespacing-by-separation-of-concerns)[Mocking to Unblock Development](https://www.apollographql.com/docs/graphos/schema-design/guides/mocking)[Demand Oriented Schema Design](https://www.apollographql.com/docs/graphos/schema-design/guides/demand-oriented-schema-design)[Aggregating Data](https://www.apollographql.com/docs/graphos/schema-design/guides/aggregating-data-across-subgraphs)[Nullability](https://www.apollographql.com/docs/graphos/schema-design/guides/nullability)[Errors as Data](https://www.apollographql.com/docs/graphos/schema-design/guides/errors-as-data-explained)[Deprecations](https://www.apollographql.com/docs/graphos/schema-design/guides/deprecations)
### Advanced Schema Techniques

[Interfaces](https://www.apollographql.com/docs/graphos/schema-design/guides/interfaces)[Response Type Pattern](https://www.apollographql.com/docs/graphos/schema-design/guides/response-type-pattern)[Graph Identities](https://www.apollographql.com/docs/graphos/schema-design/guides/graph-identities)[Relay Style Connections and Pagination](https://www.apollographql.com/docs/graphos/schema-design/guides/relay-style-connections)[Distributed Orchestration](https://www.apollographql.com/docs/graphos/schema-design/guides/distributed-orchestration)
## Routing

[Overview](https://www.apollographql.com/docs/graphos/routing)[About GraphOS Router](https://www.apollographql.com/docs/graphos/routing/about-router)[Configure Your Router](https://www.apollographql.com/docs/graphos/routing/configure-your-router)
### Cloud Routing

[Overview](https://www.apollographql.com/docs/graphos/routing/cloud)[Configuration](https://www.apollographql.com/docs/graphos/routing/cloud/configuration)[Secure Subgraphs](https://www.apollographql.com/docs/graphos/routing/cloud/secure-subgraphs)[Subscriptions](https://www.apollographql.com/docs/graphos/routing/cloud/subscriptions)[Serverless](https://www.apollographql.com/docs/graphos/routing/cloud/serverless)
### Dedicated

[Overview](https://www.apollographql.com/docs/graphos/routing/cloud/dedicated)[Quickstart](https://www.apollographql.com/docs/graphos/routing/cloud/dedicated-quickstart)[Custom Domains](https://www.apollographql.com/docs/graphos/routing/cloud/custom-domains)[Throughput Guide](https://www.apollographql.com/docs/graphos/routing/cloud/throughput-guide)[Migrate to Dedicated](https://www.apollographql.com/docs/graphos/routing/cloud/migrate-to-dedicated)
### AWS Lattice

[Lattice Configuration](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-configuration)[Lattice Management](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-management)[Lattice Troubleshooting](https://www.apollographql.com/docs/graphos/routing/cloud/lattice-troubleshooting)
### Self-Hosted Deployment

[Overview](https://www.apollographql.com/docs/graphos/routing/self-hosted)[Router Resource Estimator](https://www.apollographql.com/docs/graphos/routing/self-hosted/resource-estimator)[Health Checks](https://www.apollographql.com/docs/graphos/routing/self-hosted/health-checks)[Resource Management](https://www.apollographql.com/docs/graphos/routing/self-hosted/resource-management)
### Containerization

[Overview](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization)[Docker](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/docker)[Kubernetes](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/kubernetes)[Optimize Builds](https://www.apollographql.com/docs/graphos/routing/self-hosted/containerization/optimize-build)
### Query Planning

[Native Query Planner](https://www.apollographql.com/docs/graphos/routing/query-planning/native-query-planner)
### Client Features

[HTTP Header Propagation](https://www.apollographql.com/docs/graphos/routing/header-propagation)[File Upload Support](https://www.apollographql.com/docs/graphos/routing/operations/file-upload)
### Real-Time Operations

[Overview](https://www.apollographql.com/docs/graphos/routing/operations)[Defer Support](https://www.apollographql.com/docs/graphos/routing/operations/defer)
### Subscription Support

[Overview](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions)[Callback Protocol](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/callback-protocol)[Multipart Protocol](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/multipart-protocol)[Enable with API Gateway](https://www.apollographql.com/docs/graphos/routing/operations/subscriptions/api-gateway)
### Security

[Overview](https://www.apollographql.com/docs/graphos/routing/security)[Persisted Queries](https://www.apollographql.com/docs/graphos/routing/security/persisted-queries)[Authorization](https://www.apollographql.com/docs/graphos/routing/security/authorization)
### Authentication

[JWT Authentication](https://www.apollographql.com/docs/graphos/routing/security/jwt)[Router Authentication](https://www.apollographql.com/docs/graphos/routing/security/router-authentication)[Subgraph Authentication](https://www.apollographql.com/docs/graphos/routing/security/subgraph-authentication)
### Operations Security

[Request Limits](https://www.apollographql.com/docs/graphos/routing/security/request-limits)[Demand Control](https://www.apollographql.com/docs/graphos/routing/security/demand-control)
### Web Security

[CORS](https://www.apollographql.com/docs/graphos/routing/security/cors)[CSRF Prevention](https://www.apollographql.com/docs/graphos/routing/security/csrf)
### Performance and Scaling

[Overview](https://www.apollographql.com/docs/graphos/routing/performance)[Traffic Shaping](https://www.apollographql.com/docs/graphos/routing/performance/traffic-shaping)[Query Batching](https://www.apollographql.com/docs/graphos/routing/performance/query-batching)[Query Planner Pools](https://www.apollographql.com/docs/graphos/routing/performance/query-planner-pools)
### Caching

[In-Memory Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/in-memory)[Distributed Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/distributed)[Entity Caching](https://www.apollographql.com/docs/graphos/routing/performance/caching/entity)
### Router Customization

[Router Request Lifecycle](https://www.apollographql.com/docs/graphos/routing/customization/overview)[Rhai Scripts](https://www.apollographql.com/docs/graphos/routing/customization/rhai)[Rust Plugins](https://www.apollographql.com/docs/graphos/routing/customization/native-plugins)[Coprocessors](https://www.apollographql.com/docs/graphos/routing/customization/coprocessor)[Custom Binaries](https://www.apollographql.com/docs/graphos/routing/customization/custom-binary)
### GraphOS Integration

[Apollo Uplink](https://www.apollographql.com/docs/graphos/routing/uplink)[Operation Metrics Reporting](https://www.apollographql.com/docs/graphos/routing/graphos-reporting)
### Observability

[Overview](https://www.apollographql.com/docs/graphos/routing/observability)[Router Telemetry](https://www.apollographql.com/docs/graphos/routing/observability/telemetry)[Federated Trace Data](https://www.apollographql.com/docs/graphos/routing/observability/federated-trace-data)
### Subgraph Observability

[Subgraph Error Inclusion](https://www.apollographql.com/docs/graphos/routing/observability/subgraph-error-inclusion)[Opt-in Error Reporting](https://www.apollographql.com/docs/graphos/routing/observability/error-reporting)[Debugging Subgraph Requests](https://www.apollographql.com/docs/graphos/routing/observability/debugging-subgraph-requests)
### Client Observability

[Client ID Enforcement](https://www.apollographql.com/docs/graphos/routing/observability/client-id-enforcement)
### OpenTelemetry

[Set up OTel](https://www.apollographql.com/docs/graphos/routing/observability/otel)[Connect OTel to Prometheus](https://www.apollographql.com/docs/graphos/routing/observability/otel-traces-to-prometheus)
### Guides

[API Gateway Comparison](https://www.apollographql.com/docs/graphos/routing/router-api-gateway-comparison)
## Reference

[Overview](https://www.apollographql.com/docs/graphos/reference)[Changelogs](https://www.apollographql.com/docs/graphos/reference/changelog)[Glossary](https://www.apollographql.com/docs/graphos/reference/glossary)[Examples and Resources](https://www.apollographql.com/docs/graphos/reference/solutions)
### Release Policies

[Apollo Feature Launch Stages](https://www.apollographql.com/docs/graphos/reference/feature-launch-stages)[GraphOS Router Release Lifecycle](https://www.apollographql.com/docs/graphos/reference/router-release-lifecycle)[Apollo Client Library Release Lifecycle](https://www.apollographql.com/docs/graphos/reference/client-library-release-lifecycle)
### Architecture

[Reference Architecture](https://www.apollographql.com/docs/graphos/reference/architecture)
### Supergraph Architecture Framework

[Overview](https://www.apollographql.com/docs/graphos/reference/saf)[Operational Excellence](https://www.apollographql.com/docs/graphos/reference/saf/operational-excellence)[Security](https://www.apollographql.com/docs/graphos/reference/saf/security)[Reliability](https://www.apollographql.com/docs/graphos/reference/saf/reliability)[Performance](https://www.apollographql.com/docs/graphos/reference/saf/performance)[Developer Experience](https://www.apollographql.com/docs/graphos/reference/saf/developer-experience)
### Federation Reference

[Federation Versions](https://www.apollographql.com/docs/graphos/reference/federation/versions)[Federated Directives](https://www.apollographql.com/docs/graphos/reference/federation/directives)[Composition Rules](https://www.apollographql.com/docs/graphos/reference/federation/composition-rules)
### Subgraph Reference

[Federation Subgraphs Specification](https://www.apollographql.com/docs/graphos/reference/federation/subgraph-spec)[Subgraph Specific Fields](https://www.apollographql.com/docs/graphos/reference/federation/subgraph-specific-fields)[Compatible Subgraph Libraries](https://www.apollographql.com/docs/graphos/reference/federation/compatible-subgraphs)
### Development and Debugging

[Query Plans](https://www.apollographql.com/docs/graphos/reference/federation/query-plans)[Composition Hints](https://www.apollographql.com/docs/graphos/reference/federation/hints)[Errors](https://www.apollographql.com/docs/graphos/reference/federation/errors)[Federation v1](https://www.apollographql.com/docs/graphos/reference/federation/v1)
### Router Reference

[Self-Hosted Installation](https://www.apollographql.com/docs/graphos/reference/router/self-hosted-install)[Configuration](https://www.apollographql.com/docs/graphos/reference/router/configuration)[GraphOS Router Features](https://www.apollographql.com/docs/graphos/reference/router/graphos-features)[Rhai API](https://www.apollographql.com/docs/graphos/reference/router/rhai)[Federation Version Support](https://www.apollographql.com/docs/graphos/reference/router/federation-version-support)[Errors](https://www.apollographql.com/docs/graphos/reference/router/errors)
### Router Telemetry

### Log Exporters

[Overview](https://www.apollographql.com/docs/graphos/reference/router/telemetry/log-exporters/overview)[Stdout](https://www.apollographql.com/docs/graphos/reference/router/telemetry/log-exporters/stdout)
### Metrics Exporters

[Overview](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/overview)[Datadog](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/datadog)[Dynatrace](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/dynatrace)[New Relic](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/new-relic)[OTLP](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/otlp)[Prometheus](https://www.apollographql.com/docs/graphos/reference/router/telemetry/metrics-exporters/prometheus)
### Trace Exporters

[Overview](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/overview)[Datadog](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/datadog)[Dynatrace](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/dynatrace)[Jaeger](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/jaeger)[New Relic](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/new-relic)[OTLP](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/otlp)[Zipkin](https://www.apollographql.com/docs/graphos/reference/router/telemetry/trace-exporters/zipkin)
### Instrumentation

[Instruments](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/instruments)[Events](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/events)[Conditions](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/conditions)[Spans](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/spans)[Selectors](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/selectors)[Standard Attributes](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/standard-attributes)[Standard Instruments](https://www.apollographql.com/docs/graphos/reference/router/telemetry/instrumentation/standard-instruments)
### Migration Guides

[From Router v1.x to v2.x](https://www.apollographql.com/docs/graphos/reference/migration/from-router-v1)[From Router v0.x to v1.x](https://www.apollographql.com/docs/graphos/reference/migration/from-router-version-0.x)[From @apollo/gateway to Router](https://www.apollographql.com/docs/graphos/reference/migration/from-gateway)[From Federation 1 to 2](https://www.apollographql.com/docs/graphos/reference/migration/to-federation-version-2)[Federation 2 Backwards Compatibility](https://www.apollographql.com/docs/graphos/reference/migration/backward-compatibility)[From a Monolith](https://www.apollographql.com/docs/graphos/reference/migration/from-monolith)[From Schema Stitching](https://www.apollographql.com/docs/graphos/reference/migration/from-schema-stitching)
### GraphQL Adoption Guides

[GraphQL Adoption Patterns](https://www.apollographql.com/docs/graphos/reference/guides/graphql-adoption-patterns)[Using GraphQL for Abstraction](https://www.apollographql.com/docs/graphos/reference/guides/using-graphql-for-abstraction)[Supergraph Stewardship](https://www.apollographql.com/docs/graphos/reference/guides/supergraph-stewardship)[Licensing](https://www.apollographql.com/docs/graphos/reference/licensing)[GraphOS Data Privacy](https://www.apollographql.com/docs/graphos/reference/data-privacy)[Sub-Processors](https://www.apollographql.com/docs/graphos/reference/sub-processors)
## Rover CLI

[Overview](https://www.apollographql.com/docs/rover)[Install](https://www.apollographql.com/docs/rover/getting-started)[Configure](https://www.apollographql.com/docs/rover/configuring)[Proxy Configuration](https://www.apollographql.com/docs/rover/proxy)[CI/CD](https://www.apollographql.com/docs/rover/ci-cd)[Conventions](https://www.apollographql.com/docs/rover/conventions)[Privacy and Data Collection](https://www.apollographql.com/docs/rover/privacy)[Contributing](https://www.apollographql.com/docs/rover/contributing)[Error Codes](https://www.apollographql.com/docs/rover/errors)
### Commands

[cloud](https://www.apollographql.com/docs/rover/commands/cloud)[config](https://www.apollographql.com/docs/rover/commands/config)[contract](https://www.apollographql.com/docs/rover/commands/contracts)[dev](https://www.apollographql.com/docs/rover/commands/dev)[explain](https://www.apollographql.com/docs/rover/commands/explain)[graph](https://www.apollographql.com/docs/rover/commands/graphs)[license](https://www.apollographql.com/docs/rover/commands/license)[persisted-queries](https://www.apollographql.com/docs/rover/commands/persisted-queries)[readme](https://www.apollographql.com/docs/rover/commands/readmes)[subgraph](https://www.apollographql.com/docs/rover/commands/subgraphs)[supergraph](https://www.apollographql.com/docs/rover/commands/supergraphs)[template](https://www.apollographql.com/docs/rover/commands/template)
### The Apollo CLI (deprecated)

[Installation](https://www.apollographql.com/docs/rover/apollo-cli)[Validating Client Operations](https://www.apollographql.com/docs/rover/validating-client-operations)[Moving to Rover](https://www.apollographql.com/docs/rover/migration)
## Apollo Sandbox

[Overview](https://www.apollographql.com/docs/apollo-sandbox)
## Apollo Client (Web)

Apollo Client (Web) - v3 (latest)[Introduction](https://www.apollographql.com/docs/react)[Why Apollo Client?](https://www.apollographql.com/docs/react/why-apollo)[Get started](https://www.apollographql.com/docs/react/get-started)[Changelog](https://github.com/apollographql/apollo-client/blob/main/CHANGELOG.md)
### Fetching

[Queries](https://www.apollographql.com/docs/react/data/queries)[Suspense](https://www.apollographql.com/docs/react/data/suspense)[Fragments](https://www.apollographql.com/docs/react/data/fragments)[Mutations](https://www.apollographql.com/docs/react/data/mutations)[Refetching](https://www.apollographql.com/docs/react/data/refetching)[Subscriptions](https://www.apollographql.com/docs/react/data/subscriptions)[Directives](https://www.apollographql.com/docs/react/data/directives)[Error handling](https://www.apollographql.com/docs/react/data/error-handling)[Document transforms](https://www.apollographql.com/docs/react/data/document-transforms)[Best practices](https://www.apollographql.com/docs/react/data/operation-best-practices)
### Caching

[Overview](https://www.apollographql.com/docs/react/caching/overview)[Configuration](https://www.apollographql.com/docs/react/caching/cache-configuration)[Reading and writing](https://www.apollographql.com/docs/react/caching/cache-interaction)[Garbage collection and eviction](https://www.apollographql.com/docs/react/caching/garbage-collection)[Customizing field behavior](https://www.apollographql.com/docs/react/caching/cache-field-behavior)[Memory Management](https://www.apollographql.com/docs/react/caching/memory-management)[Advanced topics](https://www.apollographql.com/docs/react/caching/advanced-topics)
### Pagination

[Overview](https://www.apollographql.com/docs/react/pagination/overview)[Core API](https://www.apollographql.com/docs/react/pagination/core-api)[Offset-based](https://www.apollographql.com/docs/react/pagination/offset-based)[Cursor-based](https://www.apollographql.com/docs/react/pagination/cursor-based)[keyArgs](https://www.apollographql.com/docs/react/pagination/key-args)
### Local State

[Overview](https://www.apollographql.com/docs/react/local-state/local-state-management)[Local-only fields](https://www.apollographql.com/docs/react/local-state/managing-state-with-field-policies)[Reactive variables](https://www.apollographql.com/docs/react/local-state/reactive-variables)[Client-side schema](https://www.apollographql.com/docs/react/local-state/client-side-schema)[Local resolvers](https://www.apollographql.com/docs/react/local-state/local-resolvers)
### Development & Testing

[Developer tools](https://www.apollographql.com/docs/react/development-testing/developer-tooling)[Using TypeScript](https://www.apollographql.com/docs/react/development-testing/static-typing)[Testing React components](https://www.apollographql.com/docs/react/development-testing/testing)[Schema-driven testing](https://www.apollographql.com/docs/react/development-testing/schema-driven-testing)[Mocking schema capabilities](https://www.apollographql.com/docs/react/development-testing/client-schema-mocking)[Reducing bundle size](https://www.apollographql.com/docs/react/development-testing/reducing-bundle-size)
### Performance

[Improving performance](https://www.apollographql.com/docs/react/performance/performance)[Optimistic mutation results](https://www.apollographql.com/docs/react/performance/optimistic-ui)[Server-side rendering](https://www.apollographql.com/docs/react/performance/server-side-rendering)[Compiling queries with Babel](https://www.apollographql.com/docs/react/performance/babel)
### Integrations

[Using Apollo Client with your view layer](https://www.apollographql.com/docs/react/integrations/integrations)[Integrating with React Native](https://www.apollographql.com/docs/react/integrations/react-native)[Loading queries with Webpack](https://www.apollographql.com/docs/react/integrations/webpack)
### Networking

[Basic HTTP networking](https://www.apollographql.com/docs/react/networking/basic-http-networking)[Advanced HTTP networking](https://www.apollographql.com/docs/react/networking/advanced-http-networking)[Authentication](https://www.apollographql.com/docs/react/networking/authentication)
### Migrating

[Migrating to Apollo Client 3.0](https://www.apollographql.com/docs/react/migrating/apollo-client-3-migration)[Hooks migration guide](https://www.apollographql.com/docs/react/migrating/hooks-migration)
### API Reference

### Core

[ApolloClient](https://www.apollographql.com/docs/react/api/core/ApolloClient)[InMemoryCache](https://www.apollographql.com/docs/react/api/cache/InMemoryCache)[ObservableQuery](https://www.apollographql.com/docs/react/api/core/ObservableQuery)
### React

[Hooks](https://www.apollographql.com/docs/react/api/react/hooks)[Preloading](https://www.apollographql.com/docs/react/api/react/preloading)[Testing](https://www.apollographql.com/docs/react/api/react/testing)[SSR](https://www.apollographql.com/docs/react/api/react/ssr)[Components (deprecated)](https://www.apollographql.com/docs/react/api/react/components)[HOC (deprecated)](https://www.apollographql.com/docs/react/api/react/hoc)
### Apollo Link

[Overview](https://www.apollographql.com/docs/react/api/link/introduction)[HTTP](https://www.apollographql.com/docs/react/api/link/apollo-link-http)[HTTP Batch](https://www.apollographql.com/docs/react/api/link/apollo-link-batch-http)[Context](https://www.apollographql.com/docs/react/api/link/apollo-link-context)[Error](https://www.apollographql.com/docs/react/api/link/apollo-link-error)[Persisted Queries](https://www.apollographql.com/docs/react/api/link/persisted-queries)[Remove Typename](https://www.apollographql.com/docs/react/api/link/apollo-link-remove-typename)[REST](https://www.apollographql.com/docs/react/api/link/apollo-link-rest)[Retry](https://www.apollographql.com/docs/react/api/link/apollo-link-retry)[Schema](https://www.apollographql.com/docs/react/api/link/apollo-link-schema)[Subscriptions (newer protocol)](https://www.apollographql.com/docs/react/api/link/apollo-link-subscriptions)[WebSocket (older protocol)](https://www.apollographql.com/docs/react/api/link/apollo-link-ws)[Community links](https://www.apollographql.com/docs/react/api/link/community-links)
## Apollo iOS

Apollo iOS - v1 (latest)[Introduction](https://www.apollographql.com/docs/ios)[Get Started](https://www.apollographql.com/docs/ios/get-started)
### Project Configuration

[Introduction](https://www.apollographql.com/docs/ios/project-configuration/intro)[1. Project Modularization](https://www.apollographql.com/docs/ios/project-configuration/modularization)[2. Schema Types](https://www.apollographql.com/docs/ios/project-configuration/schema-types)[3. Operation Models](https://www.apollographql.com/docs/ios/project-configuration/operation-models)[SDK components](https://www.apollographql.com/docs/ios/project-configuration/sdk-components)
### Migration Guides

[v1.0](https://www.apollographql.com/docs/ios/migrations/1.0)[v1.2](https://www.apollographql.com/docs/ios/migrations/1.2)[v1.3](https://www.apollographql.com/docs/ios/migrations/1.3)[v1.5](https://www.apollographql.com/docs/ios/migrations/1.5)[v1.6](https://www.apollographql.com/docs/ios/migrations/1.6)[v1.7](https://www.apollographql.com/docs/ios/migrations/1.7)
### Tutorial

[Code Generation](https://www.apollographql.com/docs/ios/tutorial/codegen-getting-started)
### Build a project with Apollo

[Introduction](https://www.apollographql.com/docs/ios/tutorial/tutorial-introduction)[1. Configure your project](https://www.apollographql.com/docs/ios/tutorial/tutorial-configure-project)[2. Add the GraphQL schema](https://www.apollographql.com/docs/ios/tutorial/tutorial-add-graphql-schema)[3. Write your first query](https://www.apollographql.com/docs/ios/tutorial/tutorial-write-your-first-query)[4. Running code generation](https://www.apollographql.com/docs/ios/tutorial/tutorial-running-code-generation)[5. Execute your first query](https://www.apollographql.com/docs/ios/tutorial/tutorial-execute-first-query)[6. Connect your queries to your UI](https://www.apollographql.com/docs/ios/tutorial/tutorial-connect-queries-to-ui)[7. Add more info to the list](https://www.apollographql.com/docs/ios/tutorial/tutorial-add-more-info-to-list)[8. Paginate results](https://www.apollographql.com/docs/ios/tutorial/tutorial-paginate-results)[9. Complete the details view](https://www.apollographql.com/docs/ios/tutorial/tutorial-complete-details-view)[10. Write your first mutation](https://www.apollographql.com/docs/ios/tutorial/tutorial-first-mutation)[11. Authenticate your operations](https://www.apollographql.com/docs/ios/tutorial/tutorial-authenticate-operations)[12. Define additional mutations](https://www.apollographql.com/docs/ios/tutorial/tutorial-define-additional-mutations)[13. Write your first subscription](https://www.apollographql.com/docs/ios/tutorial/tutorial-subscriptions)
### API Reference

[Overview](https://www.apollographql.com/docs/ios/docc/documentation/index)[Apollo Client](https://www.apollographql.com/docs/ios/docc/documentation/Apollo)[ApolloAPI](https://www.apollographql.com/docs/ios/docc/documentation/ApolloAPI)[ApolloWebSocket](https://www.apollographql.com/docs/ios/docc/documentation/ApolloWebSocket)[ApolloSQLite](https://www.apollographql.com/docs/ios/docc/documentation/ApolloSQLite)[ApolloCodegenLib](https://www.apollographql.com/docs/ios/docc/documentation/ApolloCodegenLib)[ApolloPagination](https://www.apollographql.com/docs/ios/docc/documentation/ApolloPagination)[Client Directives](https://www.apollographql.com/docs/ios/client-directives)
### Code Generation

[Introduction](https://www.apollographql.com/docs/ios/code-generation/introduction)[The Codegen CLI](https://www.apollographql.com/docs/ios/code-generation/codegen-cli)[Configuration](https://www.apollographql.com/docs/ios/code-generation/codegen-configuration)[Downloading a Schema](https://www.apollographql.com/docs/ios/code-generation/downloading-schema)[Running Code Generation in Swift Code](https://www.apollographql.com/docs/ios/code-generation/run-codegen-in-swift-code)[Code Generation Troubleshooting](https://www.apollographql.com/docs/ios/troubleshooting/codegen-troubleshooting)
### Fetching

[Fetching Data](https://www.apollographql.com/docs/ios/fetching/fetching-data)
### Operations

[Queries](https://www.apollographql.com/docs/ios/fetching/queries)[Mutations](https://www.apollographql.com/docs/ios/fetching/mutations)[Subscriptions](https://www.apollographql.com/docs/ios/fetching/subscriptions)[Fragments](https://www.apollographql.com/docs/ios/fetching/fragments)[Operation Arguments](https://www.apollographql.com/docs/ios/fetching/operation-arguments)[Error Handling](https://www.apollographql.com/docs/ios/fetching/error-handling)[Type Conditions](https://www.apollographql.com/docs/ios/fetching/type-conditions)[Custom Scalars](https://www.apollographql.com/docs/ios/custom-scalars)[Persisted Queries](https://www.apollographql.com/docs/ios/fetching/persisted-queries)[@defer support (experimental)](https://www.apollographql.com/docs/ios/fetching/defer)
### Caching

[Introduction](https://www.apollographql.com/docs/ios/caching/introduction)[Setup](https://www.apollographql.com/docs/ios/caching/cache-setup)[Direct Cache Access](https://www.apollographql.com/docs/ios/caching/cache-transactions)[Custom Cache Keys](https://www.apollographql.com/docs/ios/caching/cache-key-resolution)
### Networking

[Creating a Client](https://www.apollographql.com/docs/ios/networking/client-creation)
### Pagination

[Introduction](https://www.apollographql.com/docs/ios/pagination/introduction)[Using Custom Response Models](https://www.apollographql.com/docs/ios/pagination/custom-types)[Directional Pagination](https://www.apollographql.com/docs/ios/pagination/directional-pagers)[Multi-query Pagination](https://www.apollographql.com/docs/ios/pagination/multi-query)
### Development & Testing

[Test Mocks](https://www.apollographql.com/docs/ios/testing/test-mocks)[Including Apollo as an XCFramework](https://www.apollographql.com/docs/ios/development/using-xcframework)
### Advanced

[File Uploads](https://www.apollographql.com/docs/ios/file-uploads)[Request Chain Customization](https://www.apollographql.com/docs/ios/networking/request-pipeline)
## Apollo Kotlin

Apollo Kotlin - v4 (latest)[Get Started](https://www.apollographql.com/docs/kotlin)[Migrating to v4](https://www.apollographql.com/docs/kotlin/migration/4.0)[Modules](https://www.apollographql.com/docs/kotlin/essentials/modules)[Evolution policy](https://www.apollographql.com/docs/kotlin/essentials/evolution)[Kdoc](https://apollographql.github.io/apollo-kotlin/kdoc/)[Changelog](https://github.com/apollographql/apollo-kotlin/blob/main/CHANGELOG.md)
### Tutorial

[0. Introduction](https://www.apollographql.com/docs/kotlin/tutorial/00-introduction)[1. Configure your project](https://www.apollographql.com/docs/kotlin/tutorial/01-configure-project)[2. Add the GraphQL schema](https://www.apollographql.com/docs/kotlin/tutorial/02-add-the-graphql-schema)[3. Write your first query](https://www.apollographql.com/docs/kotlin/tutorial/03-write-your-first-query)[4. Execute your first query](https://www.apollographql.com/docs/kotlin/tutorial/04-execute-the-query)[5. Connect your queries to your UI](https://www.apollographql.com/docs/kotlin/tutorial/05-connect-queries-to-your-ui)[6. Add more info to the list](https://www.apollographql.com/docs/kotlin/tutorial/06-add-more-info)[7. Paginate results](https://www.apollographql.com/docs/kotlin/tutorial/07-paginate-results)[8. Add a details view](https://www.apollographql.com/docs/kotlin/tutorial/08-add-a-details-view)[9. Write your first mutation](https://www.apollographql.com/docs/kotlin/tutorial/09-write-your-first-mutation)[10. Authenticate your operations](https://www.apollographql.com/docs/kotlin/tutorial/10-authenticate-your-queries)[11. Write your first subscription](https://www.apollographql.com/docs/kotlin/tutorial/11-subscriptions)
### Configuration

[Gradle plugin configuration](https://www.apollographql.com/docs/kotlin/advanced/plugin-configuration)[Gradle plugin recipes](https://www.apollographql.com/docs/kotlin/advanced/plugin-recipes)[Multi Modules](https://www.apollographql.com/docs/kotlin/advanced/multi-modules)[File types](https://www.apollographql.com/docs/kotlin/essentials/file-types)[Client Awareness](https://www.apollographql.com/docs/kotlin/advanced/client-awareness)
### Fetching

[Queries](https://www.apollographql.com/docs/kotlin/essentials/queries)[Mutations](https://www.apollographql.com/docs/kotlin/essentials/mutations)[Subscriptions](https://www.apollographql.com/docs/kotlin/essentials/subscriptions)[GraphQL variables](https://www.apollographql.com/docs/kotlin/advanced/operation-variables)[Error handling](https://www.apollographql.com/docs/kotlin/essentials/errors)[Custom scalars](https://www.apollographql.com/docs/kotlin/essentials/custom-scalars)[Fragments](https://www.apollographql.com/docs/kotlin/essentials/fragments)[@defer support](https://www.apollographql.com/docs/kotlin/fetching/defer)[Persisted queries](https://www.apollographql.com/docs/kotlin/advanced/persisted-queries)
### Caching

[Introduction](https://www.apollographql.com/docs/kotlin/caching/introduction)[Normalized caches](https://www.apollographql.com/docs/kotlin/caching/normalized-cache)[Declarative cache IDs](https://www.apollographql.com/docs/kotlin/caching/declarative-ids)[Programmatic cache IDs](https://www.apollographql.com/docs/kotlin/caching/programmatic-ids)[Watching cached data](https://www.apollographql.com/docs/kotlin/caching/query-watchers)[ApolloStore](https://www.apollographql.com/docs/kotlin/caching/store)[HTTP cache](https://www.apollographql.com/docs/kotlin/caching/http-cache)[Troubleshooting](https://www.apollographql.com/docs/kotlin/caching/troubleshooting)
### Networking

[Interceptors](https://www.apollographql.com/docs/kotlin/advanced/interceptors-http)[Custom HTTP clients](https://www.apollographql.com/docs/kotlin/advanced/http-engine)[Using the models without apollo-runtime](https://www.apollographql.com/docs/kotlin/advanced/no-runtime)[Authentication](https://www.apollographql.com/docs/kotlin/advanced/authentication)[WebSocket errors](https://www.apollographql.com/docs/kotlin/advanced/websocket-errors)[Batching operations](https://www.apollographql.com/docs/kotlin/advanced/query-batching)
### Development & Testing

[Testing overview](https://www.apollographql.com/docs/kotlin/testing/overview)[Mocking HTTP responses](https://www.apollographql.com/docs/kotlin/testing/mocking-http-responses)[Mocking GraphQL responses](https://www.apollographql.com/docs/kotlin/testing/mocking-graphql-responses)[Data builders](https://www.apollographql.com/docs/kotlin/testing/data-builders)[Android Studio plugin](https://www.apollographql.com/docs/kotlin/testing/android-studio-plugin)[Apollo Debug Server](https://www.apollographql.com/docs/kotlin/testing/apollo-debug-server)
### Advanced

[Uploading files](https://www.apollographql.com/docs/kotlin/advanced/upload)[Monitoring the network state](https://www.apollographql.com/docs/kotlin/advanced/network-connectivity)[Handling nullability](https://www.apollographql.com/docs/kotlin/advanced/nullability)[Experimental WebSockets](https://www.apollographql.com/docs/kotlin/advanced/experimental-websockets)[Using aliases](https://www.apollographql.com/docs/kotlin/advanced/using-aliases)[Using Java](https://www.apollographql.com/docs/kotlin/advanced/java)[Apollo AST](https://www.apollographql.com/docs/kotlin/advanced/apollo-ast)[Compiler plugins](https://www.apollographql.com/docs/kotlin/advanced/compiler-plugins)[JS Interoperability](https://www.apollographql.com/docs/kotlin/advanced/js-interop)[Response based codegen](https://www.apollographql.com/docs/kotlin/advanced/response-based)[Apollo Kotlin galaxy](https://www.apollographql.com/docs/kotlin/advanced/galaxy)
## Apollo Server

Apollo Server - v4 (latest)[Introduction](https://www.apollographql.com/docs/apollo-server)[Get started](https://www.apollographql.com/docs/apollo-server/getting-started)
### New in v4

[Migrating to Apollo Server 4](https://www.apollographql.com/docs/apollo-server/migration)[Previous versions](https://www.apollographql.com/docs/apollo-server/previous-versions)[Changelog](https://github.com/apollographql/apollo-server/blob/main/packages/server/CHANGELOG.md)
### Defining a Schema

[Schema basics](https://www.apollographql.com/docs/apollo-server/schema/schema)[Unions and interfaces](https://www.apollographql.com/docs/apollo-server/schema/unions-interfaces)[Custom scalars](https://www.apollographql.com/docs/apollo-server/schema/custom-scalars)[Directives](https://www.apollographql.com/docs/apollo-server/schema/directives)
### Resolving Operations

[Resolvers](https://www.apollographql.com/docs/apollo-server/data/resolvers)[Sharing context](https://www.apollographql.com/docs/apollo-server/data/context)[Error handling](https://www.apollographql.com/docs/apollo-server/data/errors)[Subscriptions](https://www.apollographql.com/docs/apollo-server/data/subscriptions)
### Fetching Data

[Overview](https://www.apollographql.com/docs/apollo-server/data/fetching-data)[REST APIs](https://www.apollographql.com/docs/apollo-server/data/fetching-rest)
### Web Frameworks

[Integrations](https://www.apollographql.com/docs/apollo-server/integrations/integration-index)[Building integrations](https://www.apollographql.com/docs/apollo-server/integrations/building-integrations)[MERN stack tutorial](https://www.apollographql.com/docs/apollo-server/integrations/mern)
### Development Workflow

[Build and run queries](https://www.apollographql.com/docs/apollo-server/workflow/build-run-queries)[Request format](https://www.apollographql.com/docs/apollo-server/workflow/requests)[Generating TS types](https://www.apollographql.com/docs/apollo-server/workflow/generate-types)[Mocking](https://www.apollographql.com/docs/apollo-server/testing/mocking)[Integration testing](https://www.apollographql.com/docs/apollo-server/testing/testing)[Apollo Studio Explorer](https://www.apollographql.com/docs/studio/explorer/)
### Performance

[Caching](https://www.apollographql.com/docs/apollo-server/performance/caching)[Cache backends](https://www.apollographql.com/docs/apollo-server/performance/cache-backends)[Response Cache Eviction](https://www.apollographql.com/docs/apollo-server/performance/response-cache-eviction)[Automatic persisted queries](https://www.apollographql.com/docs/apollo-server/performance/apq)
### Security

[Auth](https://www.apollographql.com/docs/apollo-server/security/authentication)[CORS](https://www.apollographql.com/docs/apollo-server/security/cors)[Terminating SSL](https://www.apollographql.com/docs/apollo-server/security/terminating-ssl)[Proxy configuration](https://www.apollographql.com/docs/apollo-server/security/proxy-configuration)
### Deployment

[Lambda](https://www.apollographql.com/docs/apollo-server/deployment/lambda)[Heroku](https://www.apollographql.com/docs/apollo-server/deployment/heroku)
### Monitoring

[Metrics and logging](https://www.apollographql.com/docs/apollo-server/monitoring/metrics)[Health checks](https://www.apollographql.com/docs/apollo-server/monitoring/health-checks)
### API Reference

[ApolloServer](https://www.apollographql.com/docs/apollo-server/api/apollo-server)[startStandaloneServer](https://www.apollographql.com/docs/apollo-server/api/standalone)[expressMiddleware](https://www.apollographql.com/docs/apollo-server/api/express-middleware)
### Plugins

[Overview](https://www.apollographql.com/docs/apollo-server/builtin-plugins)
### Built-in

[Usage reporting](https://www.apollographql.com/docs/apollo-server/api/plugin/usage-reporting)[Schema reporting](https://www.apollographql.com/docs/apollo-server/api/plugin/schema-reporting)[Inline trace](https://www.apollographql.com/docs/apollo-server/api/plugin/inline-trace)[Drain HTTP server](https://www.apollographql.com/docs/apollo-server/api/plugin/drain-http-server)[Cache control](https://www.apollographql.com/docs/apollo-server/api/plugin/cache-control)[Landing pages](https://www.apollographql.com/docs/apollo-server/api/plugin/landing-pages)[Federated subscriptions](https://www.apollographql.com/docs/apollo-server/api/plugin/subscription-callback)
### Custom

[Creating plugins](https://www.apollographql.com/docs/apollo-server/integrations/plugins)[Event reference](https://www.apollographql.com/docs/apollo-server/integrations/plugins-event-reference)
### Using with Federation

### As a subgraph

[Setup](https://www.apollographql.com/docs/apollo-server/using-federation/apollo-subgraph-setup)[@apollo/subgraph reference](https://www.apollographql.com/docs/apollo-server/using-federation/api/apollo-subgraph)
### As a gateway

[Setup](https://www.apollographql.com/docs/apollo-server/using-federation/apollo-gateway-setup)[Gateway performance](https://www.apollographql.com/docs/apollo-server/using-federation/gateway-performance)[@apollo/gateway reference](https://www.apollographql.com/docs/apollo-server/using-federation/api/apollo-gateway)
## VS Code Extension

[Overview](https://www.apollographql.com/docs/vs-code-extension)

[Routing](graphos/routing)

        [Home](/docs/)   /  [Routing](/docs/graphos/routing)   /  [Performance and Scaling](/docs/graphos/routing/performance)   /  [Caching](/docs/graphos/routing/performance/caching/in-memory)   /  [Distributed Caching](/docs/graphos/routing/performance/caching/distributed)        [Routing /](/docs/graphos/routing)    [Performance and Scaling /](/docs/graphos/routing/performance)    [Caching](/docs/graphos/routing/performance/caching/in-memory)
# Distributed Caching for the GraphOS Router

Configure Redis-backed caching for query plans and APQ

---

   **This feature is only available with a GraphOS Enterprise plan.** You can test it out by signing up for a free [GraphOS trial](https://studio.apollographql.com/signup?&referrer=docs-content). To compare GraphOS feature support across all plan types, see the [pricing page](https://www.apollographql.com/pricing#graphos-router).

If you have multiple GraphOS Router instances, those instances can share a Redis-backed cache for their query plans and automatic persisted queries (APQ). This means that if *any* of your router instances caches a particular value, *all* of your instances can look up that value to significantly improve responsiveness. For more details on query plans and APQ, see the article on [in-memory caching](https://www.apollographql.com/docs/router/configuration/in-memory-caching).

## Prerequisites

To use this feature:

* You must have a Redis cluster (or single instance) that your router instances can communicate with.
* You must have a [GraphOS Enterprise plan](https://www.apollographql.com/pricing/) and [connect your router to GraphOS](https://www.apollographql.com/docs/router/configuration/overview/#environment-variables).

## How it works

Whenever a router instance requires a query plan or APQ query string to resolve a client operation:

1. The router instance checks its own [in-memory cache](https://www.apollographql.com/docs/graphos/routing/performance/caching/distributed#in-memory-caching) for the required value and uses it if found.
2. If *not* found, the router instance then checks the distributed Redis cache for the required value and uses it if found. It also then replicates the found value in its own in-memory cache.
3. If *not* found, the router instance *generates* the required query plan or requests the full operation string from the client for APQ.
4. The router instance stores the obtained value in both the distributed cache *and* its in-memory cache.

## Redis URL configuration

The distributed caching configuration must contain one or more URLs using different schemes depending on the expected deployment:

* `redis` - TCP connected to a centralized server.
* `rediss` - TLS connected to a centralized server.
* `redis-cluster` - TCP connected to a cluster.
* `rediss-cluster` - TLS connected to a cluster.
* `redis-sentinel` - TCP connected to a centralized server behind a sentinel layer.
* `rediss-sentinel` - TLS connected to a centralized server behind a sentinel layer.

The URLs must have the following format:

### One node

Text copy
```
1redis|rediss :// [[username:]password@] host [:port][/database]
```

Example: `redis://localhost:6379`

### Clustered

Text copy
```
1redis|rediss[-cluster] :// [[username:]password@] host [:port][?[node=host1:port1][&node=host2:port2][&node=hostN:portN]]
```

or, if configured with multiple URLs:

Text copy
```
1[
2  "redis|rediss[-cluster] :// [[username:]password@] host [:port]",
3  "redis|rediss[-cluster] :// [[username:]password@] host1 [:port1]",
4  "redis|rediss[-cluster] :// [[username:]password@] host2 [:port2]"
5]
```
### Sentinel

Text copy
```
1redis|rediss[-sentinel] :// [[username1:]password1@] host [:port][/database][?[node=host1:port1][&node=host2:port2][&node=hostN:portN]
2                            [&sentinelServiceName=myservice][&sentinelUsername=username2][&sentinelPassword=password2]]
```

or, if configured with multiple URLs:

Text copy
```
1[
2  "redis|rediss[-sentinel] :// [[username:]password@] host [:port][/database][?[&sentinelServiceName=myservice][&sentinelUsername=username2][&sentinelPassword=password2]]",
3  "redis|rediss[-sentinel] :// [[username1:]password1@] host [:port][/database][?[&sentinelServiceName=myservice][&sentinelUsername=username2][&sentinelPassword=password2]]"
4]
```
## Router configuration

**tip**In your router's YAML config file, **you should specify your Redis URLs via environment variables and [variable expansion](https://www.apollographql.com/docs/router/configuration/overview#variable-expansion)**. This prevents your Redis URLs from being committed to version control, which is especially dangerous if they include authentication information like a username and/or password.
### Distributed query plan caching

To enable distributed caching of query plans, add the following to your router's [YAML config file](https://www.apollographql.com/docs/router/configuration/overview/#yaml-config-file):

YAMLrouter.yaml copy
```
1supergraph:
2  query_planning:
3    cache:
4      redis:
5        urls: ["redis://..."]
```

The value of `urls` is a list of URLs for all Redis instances in your cluster.

All query plan cache entries will be prefixed with `plan.` within the distributed cache.

### Distributed APQ caching

To enable distributed caching of automatic persisted queries (APQ), add the following to your router's [YAML config file](https://www.apollographql.com/docs/router/configuration/overview/#yaml-config-file):

YAMLrouter.yaml copy
```
1apq:
2  router:
3    cache:
4      redis:
5        urls: ["redis://..."]
```

The value of `urls` is a list of URLs for all Redis instances in your cluster.

All APQ cache entries will be prefixed with `apq` followed by a null byte character (referenced by the escape sequence `\0` in most programming languages) within the distributed cache.

### Common Redis configuration

Redis configuration is done in the same way for APQ caching, query plan caching and [entity caching](https://www.apollographql.com/docs/router/configuration/entity-caching).

YAMLrouter.yaml copy
```
1supergraph:
2  query_planning:
3    cache:
4      redis:
5        urls: ["redis://..."]
6        username: admin/123 # Optional, can be part of the urls directly, mainly useful if you have special character like '/' in your password that doesn't work in url. This field takes precedence over the username in the URL
7        password: admin # Optional, can be part of the urls directly, mainly useful if you have special character like '/' in your password that doesn't work in url. This field takes precedence over the password in the URL
8        timeout: 2s # Optional, by default: 500ms
9        ttl: 24h # Optional
10        namespace: "prefix"  # Optional
11        #tls:
12        required_to_start: false # Optional, defaults to false
13        reset_ttl: true # Optional, defaults to true
14        pool_size: 4 # Optional, defaults to 1
```
#### Timeout

Connecting and sending commands to Redis are subject to a timeout, set by default to 500ms, that can be overriden.

#### TTL

The `ttl` option defines the default global expiration for Redis entries. For APQ caching, the default is no expiration, while for query plan caching, the default expiration is set to 30 days.

### Namespace

When using the same Redis instance for multiple purposes, the `namespace` option defines a prefix for all the keys defined by the router.

### TLS

For Redis TLS connections, you can set up a client certificate or override the root certificate authority by configuring `tls` in your router's [YAML config file](https://www.apollographql.com/docs/router/overview/#yaml-config-file). For example:

YAML copy
```
1apq:
2  router:
3    cache:
4      redis:
5        urls: [ "rediss://redis.example.com:6379" ]
6        tls:
7          certificate_authorities: ${file./path/to/ca.crt}
8          client_authentication:
9            certificate_chain: ${file./path/to/certificate_chain.pem}
10            key: ${file./path/to/key.pem}
```
### Required to start

When active, the `required_to_start` option will prevent the router from starting if it cannot connect to Redis. By default, the router will still start without a connection to Redis, which would result in only using the in-memory cache for APQ and query planning, and entity caching sending the requests to subgraphs undisturbed.

### Reset TTL

When this option is active, accessing a cache entry in Redis will reset its expiration.

### Pool size

The `pool_size` option defines the number of connections to Redis that the router will open. By default, the router will open a single connection to Redis. If there is a lot of traffic between router and Redis and/or there is some latency in thos requests, it is recommended to increase the pool size to reduce that latency.

 [PreviousIn-Memory Caching](/docs/graphos/routing/performance/caching/in-memory)[NextSubgraph Entity Caching for the GraphOS Router](/docs/graphos/routing/performance/caching/entity)
## On this page

* [Prerequisites](#prerequisites)
* [How it works](#how-it-works)
* [Redis URL configuration](#redis-url-configuration)
* [One node](#one-node)
* [Clustered](#clustered)
* [Sentinel](#sentinel)
* [Router configuration](#router-configuration)
* [Distributed query plan caching](#distributed-query-plan-caching)
* [Distributed APQ caching](#distributed-apq-caching)
* [Common Redis configuration](#common-redis-configuration)
* [Namespace](#namespace)
* [TLS](#tls)
* [Required to start](#required-to-start)
* [Reset TTL](#reset-ttl)
* [Pool size](#pool-size)
   Give FeedbackFeedback  [Edit on GitHub](https://github.com/apollographql/router/blob/main/docs/source/routing/performance/caching/distributed.mdx)   [Forums](https://community.apollographql.com/)

¬© 2025 Apollo Graph Inc., d/b/a Apollo GraphQL.

[Privacy Policy](https://www.apollographql.com/privacy-policy)
## Company

* [About Apollo](https://www.apollographql.com/about-us)
* [Careers](https://www.apollographql.com/careers)
* [Partners](https://www.apollographql.com/partners)
## Resources

* [Blog](https://blog.apollographql.com)
* [Tutorials](https://www.apollographql.com/tutorials)
* [Content Library](https://www.apollographql.com/resources)
## Get in touch

* [Contact Sales](https://www.apollographql.com/contact-sales)
* [Contact Support](https://www.apollographql.com/support)


=== Content from github.com_a9a32d92_20250110_141522.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapollographql%2Frouter%2Fsecurity%2Fadvisories%2FGHSA-q9p4-hw9m-fj2v)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapollographql%2Frouter%2Fsecurity%2Fadvisories%2FGHSA-q9p4-hw9m-fj2v)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=apollographql%2Frouter)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apollographql](/apollographql)
/
**[router](/apollographql/router)**
Public

* [Notifications](/login?return_to=%2Fapollographql%2Frouter) You must be signed in to change notification settings
* [Fork
  273](/login?return_to=%2Fapollographql%2Frouter)
* [Star
   829](/login?return_to=%2Fapollographql%2Frouter)

* [Code](/apollographql/router)
* [Issues
  428](/apollographql/router/issues)
* [Pull requests
  79](/apollographql/router/pulls)
* [Discussions](/apollographql/router/discussions)
* [Actions](/apollographql/router/actions)
* [Projects
  0](/apollographql/router/projects)
* [Security](/apollographql/router/security)
* [Insights](/apollographql/router/pulse)

Additional navigation options

* [Code](/apollographql/router)
* [Issues](/apollographql/router/issues)
* [Pull requests](/apollographql/router/pulls)
* [Discussions](/apollographql/router/discussions)
* [Actions](/apollographql/router/actions)
* [Projects](/apollographql/router/projects)
* [Security](/apollographql/router/security)
* [Insights](/apollographql/router/pulse)

# Defect in query plan cache may cause incorrect operations to be executed in Apollo Router 1.44.0 or 1.45.0

Critical

[jasonbarnett667](/jasonbarnett667)
published
GHSA-q9p4-hw9m-fj2v
May 1, 2024

## Package

cargo

apollo-router
([Rust](/advisories?query=ecosystem%3Arust))

## Affected versions

>=1.44.0 <1.45.1

## Patched versions

1.45.1

apollographql/helm-charts/router
(GitHub Packages Container Registry)

>=1.44.0 <1.45.1

1.45.1

apollographql/router
(GitHub Packages Container Registry)

>=1.44.0 <1.45.1

1.45.1

apollographql/router
(GitHub Releases)

>=1.44.0 <1.45.1

1.45.1

## Description

### Impact

Any instance of Apollo Router 1.44.0 or 1.45.0 that is using Distributed Query Plan Caching is impacted. These versions were released on 2024-04-12 and 2024-04-22 respectively.

The affected versions of Apollo Router contain a bug that could lead to unexpected operations being executed, which can result in unintended data or effects. This only affects Router instances configured to use distributed query plan caching. Router versions other than the ones listed above, and all Router deployments that are not using distributed query plan caching, are unaffected by this defect.

If you are using the affected versions, you can check your router‚Äôs configuration YAML to verify if you are impacted:

```
supergraph:
  query_planning:
    cache:
      # Look for this config below
      redis:
        urls: ["redis://..."]
```

A full reference on the [Distributed Query Plan Caching feature is available here.](https://www.apollographql.com/docs/router/configuration/distributed-caching/#distributed-query-plan-caching)

### Impact detail

The root cause of this defect is a bug in Apollo Router‚Äôs cache retrieval logic: When this defect is present and distributed query planning caching is enabled, asking the Router to execute an operation (whether it is a query, a mutation, or a subscription) may result in an unexpected variation of that operation being executed or the generation of unexpected errors.

The issue stems from inadvertently executing a modified version of a previously executed operation, whose query plan is stored in the underlying cache (specifically, Redis). Depending on the type of the operation, the result may vary. For a query, results may be fetched that don‚Äôt match what was requested (e.g., rather than running `fetchUsers(type: ENTERPRISE)` the Router may run `fetchUsers(type: TRIAL)`. For a mutation, this may result in incorrect mutations being sent to underlying subgraph servers (e.g., rather than sending `deleteUser(id: 10)` to a subgraph, the Router may run `deleteUser(id: 12)`.

### Patches

Apollo Router 1.45.1

If you are using distributed query plan caching, please either upgrade to version 1.45.1 or above or downgrade to version 1.43.2 of the Apollo Router. We do not recommend Apollo Router versions 1.44.0 or 1.45.0 for use and have withdrawn these releases. If you use impacted versions in production, we recommend that you migrate away immediately by redeploying to an unaffected Router version. For non-production use cases, we recommend you migrate at your earliest convenience.

### Workarounds

If you cannot upgrade or downgrade, you can disable distributed query plan caching by removing the `supergraph.query_planning.cache.redis.urls` configuration. Please note that when distributed query plan caching is disabled, each Router instance will maintain its own in-memory query plan cache. This may increase resource utilization for each Router instance and could increase cold-start times as each Router instance builds its query plan cache.

### References

[Apollo Router 1.45.1 Release Notes](https://github.com/apollographql/router/releases/tag/v1.45.1)

### Severity

Critical

9.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H

### CVE ID

CVE-2024-32971

### Weaknesses

[CWE-440](/advisories?query=cwe%3A440)

### Credits

* [![@xuorig](https://avatars.githubusercontent.com/u/1919498?s=40&v=4)](/xuorig)
  [xuorig](/xuorig)
  Reporter
* [![@o0Ignition0o](https://avatars.githubusercontent.com/u/9465678?s=40&v=4)](/o0Ignition0o)
  [o0Ignition0o](/o0Ignition0o)
  Remediation developer
* [![@peakematt](https://avatars.githubusercontent.com/u/7741049?s=40&v=4)](/peakematt)
  [peakematt](/peakematt)
  Coordinator
* [![@IvanGoncharov](https://avatars.githubusercontent.com/u/8336157?s=40&v=4)](/IvanGoncharov)
  [IvanGoncharov](/IvanGoncharov)
  Remediation reviewer
* [![@Geal](https://avatars.githubusercontent.com/u/119296?s=40&v=4)](/Geal)
  [Geal](/Geal)
  Remediation verifier
* [![@glasser](https://avatars.githubusercontent.com/u/16724?s=40&v=4)](/glasser)
  [glasser](/glasser)
  Remediation reviewer
* [![@jasonbarnett667](https://avatars.githubusercontent.com/u/38733417?s=40&v=4)](/jasonbarnett667)
  [jasonbarnett667](/jasonbarnett667)
  Coordinator
* [![@abernix](https://avatars.githubusercontent.com/u/841294?s=40&v=4)](/abernix)
  [abernix](/abernix)
  Coordinator

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


