<!-- MHonArc v2.6.19 -->
<!--X-Head-End-->
<!DOCTYPE html>
<html lang="en">
<head>
<script async src="/site.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://seclists.org/rss/fulldisclosure.rss">
<meta property="og:image" content="https://seclists.org/images/fulldisclosure-img.png" />
<link rel="image_src" href="https://seclists.org/images/fulldisclosure-img.png" />

<meta name="Subject" content="St. Poelten UAS | Multiple XSS in Advantech EKI 15XX Series"/>
<meta name="Author" content="Weber Thomas via Fulldisclosure"/>
<title>Full Disclosure: St. Poelten UAS | Multiple XSS in Advantech EKI 15XX Series</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#2A0D45">
<link rel="preload" as="image" href="/images/sitelogo.png" imagesizes="168px" imagesrcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x">
<link rel="preload" as="image" href="/shared/images/nst-icons.svg">
<link rel="stylesheet" href="/shared/css/nst.css?v=2">
<script async src="/shared/js/nst.js?v=2"></script>
<link rel="stylesheet" href="/shared/css/nst-foot.css?v=2" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/site.css">
<!--Google Analytics Code-->
<link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-11009417-1', 'auto');
ga('send', 'pageview');
</script>
<!--END Google Analytics Code-->
<META NAME="ROBOTS" CONTENT="NOARCHIVE">
<link rel="shortcut icon" href="/shared/images/tiny-eyeicon.png" type="image/png">
</head>
<body><div id="nst-wrapper">

<div id="menu">
 <div class="blur">
  <header id="nst-head">

    <a id="menu-open" href="#menu" aria-label="Open menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#menu">
    </a>
    <a id="menu-close" href="#" aria-label="Close menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#close">
    </a>

   <a id="nst-logo" href="/" aria-label="Home page">
    <img alt="Home page logo" srcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x" src="/images/sitelogo.png" onerror="this.onerror=null;this.srcset=this.src" height=90 width=168></a>

   <nav id="nst-gnav">
    <a class="nlink" href="https://nmap.org/">Nmap.org</a>
    <a class="nlink" href="https://npcap.com/">Npcap.com</a>
    <a class="nlink" href="https://seclists.org/">Seclists.org</a>
    <a class="nlink" href="https://sectools.org">Sectools.org</a>
    <a class="nlink" href="https://insecure.org/">Insecure.org</a>
   </nav>

   <form class="nst-search" id="nst-head-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>

  </header>
 </div>
</div>

<main id="nst-content">

<!--X-Body-Begin-->
<!--X-User-Header-->
<a href="/fulldisclosure/"><img src="/images/fulldisclosure-logo.png" width="80" class="l-logo right" alt="fulldisclosure logo"></a>
<h2 class="m-list"><a href="/fulldisclosure/">Full Disclosure</a>
mailing list archives</h2>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="12"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#13">By Date</a>
<a href="14"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="12"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#13">By Thread</a>
<a href="14"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<form class="nst-search center" action="/search/fulldisclosure">
<input class="nst-search-q" name="q" type="search" placeholder="List Archive Search">
<button class="nst-search-button" title="Search">
<img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
src="/shared/images/nst-icons.svg#search">
</button>
</form>

</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1 class="m-title">St. Poelten UAS | Multiple XSS in Advantech EKI 15XX Series</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->


<em>From</em>: Weber Thomas via Fulldisclosure &lt;fulldisclosure () seclists org&gt;<br>

<em>Date</em>: Tue, 8 Aug 2023 09:19:32 +0000<br>

<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">St. Pölten UAS
-------------------------------------------------------------------------------
               title| Multiple XSS in Advantech
             product| Advantech EKI-1524-CE series, EKI-1522 series,
                    | EKI-1521 series
  vulnerable version| &lt;=1.21 (CVE-2023-4202), &lt;=1.24 (CVE-2023-4203)
       fixed version| 1.26
          CVE number| CVE-2023-4202, CVE-2023-4203
              impact| Medium
            homepage| <a  rel="nofollow" href="https://advantech.com">https://advantech.com</a>
               found| 2023-05-04
                  by| R. Haas, A. Resanovic, T. Etzenberger, M. Bineder
                    | This vulnerability was discovery during research at
                    | St. Pölten UAS, supported and coordinated by CyberDanube.
                    |
                    | <a  rel="nofollow" href="https://fhstp.ac.at">https://fhstp.ac.at</a> | <a  rel="nofollow" href="https://cyberdanube.com">https://cyberdanube.com</a>
-------------------------------------------------------------------------------

Vendor description
-------------------------------------------------------------------------------
“Advantech’s corporate vision is to enable an intelligent planet. The company
is a global leader in the fields of IoT intelligent systems and embedded
platforms. To embrace the trends of IoT, big data, and artificial intelligence,
Advantech promotes IoT hardware and software solutions with the Edge
Intelligence WISE-PaaS core to assist business partners and clients in
connecting their industrial chains. Advantech is also working with business
partners to co-create business ecosystems that accelerate the goal of
industrial intelligence.”

Source: <a  rel="nofollow" href="https://www.advantech.com/en/about">https://www.advantech.com/en/about</a>


Vulnerable versions
-------------------------------------------------------------------------------
EKI-1524-CE series / 1.21 (CVE-2023-4202)
EKI-1522-CE series / 1.21 (CVE-2023-4202)
EKI-1521-CE series / 1.21 (CVE-2023-4202)

EKI-1524-CE series / 1.24 (CVE-2023-4203)
EKI-1522-CE series / 1.24 (CVE-2023-4203)
EKI-1521-CE series / 1.24 (CVE-2023-4203)


Vulnerability overview
-------------------------------------------------------------------------------
1) Stored Cross-Site Scripting (XSS) (CVE-2023-4202, CVE-2023-4203)
Two stored cross-site scripting vulnerabilities has been identified in the
firmware of the device. The first XSS was identified in the &quot;Device Name&quot; field
and the second XSS was found in the &quot;Ping&quot; tool. This can be exploited in the
context of a victim&apos;s session.

Proof of Concept
-------------------------------------------------------------------------------
1) Stored Cross-Site Scripting (XSS)
Both cross-site scripting vulnerabilities are permanently affecting the device.

1.1) Stored XSS in Device Name CVE-2023-4202
The first vulnerability can be triggerd by setting the device name
(&quot;System-&gt;Device Name&quot;) to the following value:
&quot;&gt;&lt;script&gt;alert(&quot;document.cookie&quot;)&lt;/script&gt;

This code prints out the cached cookies to the screen.

1.2) Stored XSS in Ping Function CVE-2023-4203
The second XSS vulnerability can be found in &quot;Tools-&gt;Ping&quot;. The following GET
request prints the current cached cookies of a user&apos;s session to the screen.

<a  rel="nofollow" href="http://$IP/cgi-bin/ping.sh?random_num=2013&amp;ip=172.16.0.141%3b%20">http://$IP/cgi-bin/ping.sh?random_num=2013&amp;ip=172.16.0.141%3b%20</a>&lt;script&gt;alert(1)&lt;/script&gt;&amp;size=56&amp;count=1&amp;interface=eth0&amp;_=1682793104513

An alternative to the used payload is using &quot;onmouseover&quot; event tags. In this
case it prints out the number &quot;1337&quot;:
&quot; onmousemove=&quot;alert(1337)&quot;

The vulnerability was manually verified on an emulated device by using the
MEDUSA scalable firmware runtime (<a  rel="nofollow" href="https://medusa.cyberdanube.com">https://medusa.cyberdanube.com</a>).


Solution
-------------------------------------------------------------------------------
Upgrade to the newest available firmware.

Workaround
-------------------------------------------------------------------------------
None.


Recommendation
-------------------------------------------------------------------------------
Advantech customers are advised to upgrade the firware to the latest
available version.


Contact Timeline
-------------------------------------------------------------------------------
2023-05-16: Contacting vendor via security contact.
2023-05-24: Contact stated that issue 1.1) is solved after firmware v1.21.
            The contact is trying to reproduce issue 1.2; Gave advice to
            reproduce issue.
2023-05-25: Contact stated that new firmware should resolve the issue.
2023-06-03: Sent new payload to the vendor.
2023-06-05: Vendor asked for clarification; Sent further explaination to the
            contact; Vendor contact said he knows a solution.
2023-06-22: Asked for an update; Contact stated that the beta firmware should
            resolve the issues.
2023-06-27: Asked for the release date.
2023-07-04: Contact stated, that they are currently doing QA tests.
2023-07-06: Asked if issue 1.1 is really resolved to be released; Vendor stated
            that it can be published.
2023-07-17: Assigned CVE numbers for the issues. Asked for an update.
2023-07-18: Vendor contact stated that the firmware will be released end of
            July.
2023-08-07: Asked contact for the new firmware version.
2023-08-08: Received version 1.26 as the official released firmware with fixes.
            Coordinated release of security advisory.



Web: <a  rel="nofollow" href="https://www.fhstp.ac.at/">https://www.fhstp.ac.at/</a>
Twitter: <a  rel="nofollow" href="https://twitter.com/fh_stpoelten">https://twitter.com/fh_stpoelten</a>
Mail: mis at fhstp dot ac dot at

EOF T. Weber / @2023

_______________________________________________
Sent through the Full Disclosure mailing list
<a  rel="nofollow" href="https://nmap.org/mailman/listinfo/fulldisclosure">https://nmap.org/mailman/listinfo/fulldisclosure</a>
Web Archives &amp; RSS: <a  rel="nofollow" href="https://seclists.org/fulldisclosure/">https://seclists.org/fulldisclosure/</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="12"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#13">By Date</a>
<a href="14"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="12"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#13">By Thread</a>
<a href="14"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
</div>
<h3 class="m-thread">Current thread:</h3>
<ul class="thread">
<li><strong>St. Poelten UAS | Multiple XSS in Advantech EKI 15XX Series</strong> <em>Weber Thomas via Fulldisclosure (Aug 11)</em>
</ul>


<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</main><!-- content -->

<footer id="nst-foot">
   <form class="nst-search" id="nst-foot-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>
<div class="flexlists">
<div class="fl-unit">
<h2><a class="nlink" href="https://nmap.org/">Nmap Security Scanner</a></h2>
<ul>
<li><a class="nlink" href="https://nmap.org/book/man.html">Ref Guide</a>
<li><a class="nlink" href="https://nmap.org/book/install.html">Install Guide</a>
<li><a class="nlink" href="https://nmap.org/docs.html">Docs</a>
<li><a class="nlink" href="https://nmap.org/download.html">Download</a>
<li><a class="nlink" href="https://nmap.org/oem/">Nmap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://npcap.com/">Npcap packet capture</a></h2>
<ul>
<li><a class="nlink" href="https://npcap.com/guide/">User's Guide</a>
<li><a class="nlink" href="https://npcap.com/guide/npcap-devguide.html#npcap-api">API docs</a>
<li><a class="nlink" href="https://npcap.com/#download">Download</a>
<li><a class="nlink" href="https://npcap.com/oem/">Npcap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://seclists.org/">Security Lists</a></h2>
<ul>
<li><a class="nlink" href="https://seclists.org/nmap-announce/">Nmap Announce</a>
<li><a class="nlink" href="https://seclists.org/nmap-dev/">Nmap Dev</a>
<li><a class="nlink" href="https://seclists.org/fulldisclosure/">Full Disclosure</a>
<li><a class="nlink" href="https://seclists.org/oss-sec/">Open Source Security</a>
<li><a class="nlink" href="https://seclists.org/dataloss/">BreachExchange</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://sectools.org">Security Tools</a></h2>
<ul>
<li><a class="nlink" href="https://sectools.org/tag/vuln-scanners/">Vuln scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/pass-audit/">Password audit</a>
<li><a class="nlink" href="https://sectools.org/tag/web-scanners/">Web scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/wireless/">Wireless</a>
<li><a class="nlink" href="https://sectools.org/tag/sploits/">Exploitation</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://insecure.org/">About</a></h2>
<ul>
<li><a class="nlink" href="https://insecure.org/fyodor/">About/Contact</a>
<li><a class="nlink" href="https://insecure.org/privacy.html">Privacy</a>
<li><a class="nlink" href="https://insecure.org/advertising.html">Advertising</a>
<li><a class="nlink" href="https://nmap.org/npsl/">Nmap Public Source License</a>
</ul>
</div>
<div class="fl-unit social-links">
<a class="nlink" href="https://twitter.com/nmap" title="Visit us on Twitter">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#twitter" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://facebook.com/nmap" title="Visit us on Facebook">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#facebook" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://github.com/nmap/" title="Visit us on Github">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#github" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://reddit.com/r/nmap/" title="Discuss Nmap on Reddit">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#reddit" alt="" aria-hidden="true">
 </a>
</div>
</div>
</footer>

</div><!-- wrapper -->
</body>
</html>

