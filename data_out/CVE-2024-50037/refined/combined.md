=== Content from git.kernel.org_ba6b83e5_20250110_164952.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Janne Grunau <j@jannau.net> | 2024-10-06 19:49:45 +0200 |
| --- | --- | --- |
| committer | Thomas Zimmermann <tzimmermann@suse.de> | 2024-10-10 09:49:25 +0200 |
| commit | [fcddc71ec7ecf15b4df3c41288c9cf0b8e886111](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111)) | |
| tree | [f2a1afa8ba60da67dc6721253cfe5ec2effa66e5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111) | |
| parent | [835745a377a4519decd1a36d6b926e369b3033e2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=835745a377a4519decd1a36d6b926e369b3033e2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111&id2=835745a377a4519decd1a36d6b926e369b3033e2)) | |
| download | [linux-fcddc71ec7ecf15b4df3c41288c9cf0b8e886111.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fcddc71ec7ecf15b4df3c41288c9cf0b8e886111.tar.gz) | |

drm/fbdev-dma: Only cleanup deferred I/O if necessaryCommit 5a498d4d06d6 ("drm/fbdev-dma: Only install deferred I/O if
necessary") initializes deferred I/O only if it is used.
drm\_fbdev\_dma\_fb\_destroy() however calls fb\_deferred\_io\_cleanup()
unconditionally with struct fb\_info.fbdefio == NULL. KASAN with the
out-of-tree Apple silicon display driver posts following warning from
\_\_flush\_work() of a random struct work\_struct instead of the expected
NULL pointer derefs.
[ 22.053799] ------------[ cut here ]------------
[ 22.054832] WARNING: CPU: 2 PID: 1 at kernel/workqueue.c:4177 \_\_flush\_work+0x4d8/0x580
[ 22.056597] Modules linked in: uhid bnep uinput nls\_ascii ip6\_tables ip\_tables i2c\_dev loop fuse dm\_multipath nfnetlink zram hid\_magicmouse btrfs xor xor\_neon brcmfmac\_wcc raid6\_pq hci\_bcm4377 bluetooth brcmfmac hid\_apple brcmutil nvmem\_spmi\_mfd simple\_mfd\_spmi dockchannel\_hid cfg80211 joydev regmap\_spmi nvme\_apple ecdh\_generic ecc macsmc\_hid rfkill dwc3 appledrm snd\_soc\_macaudio macsmc\_power nvme\_core apple\_isp phy\_apple\_atc apple\_sart apple\_rtkit\_helper apple\_dockchannel tps6598x macsmc\_hwmon snd\_soc\_cs42l84 videobuf2\_v4l2 spmi\_apple\_controller nvmem\_apple\_efuses videobuf2\_dma\_sg apple\_z2 videobuf2\_memops spi\_nor panel\_summit videobuf2\_common asahi videodev pwm\_apple apple\_dcp snd\_soc\_apple\_mca apple\_admac spi\_apple clk\_apple\_nco i2c\_pasemi\_platform snd\_pcm\_dmaengine mc i2c\_pasemi\_core mux\_core ofpart adpdrm drm\_dma\_helper apple\_dart apple\_soc\_cpufreq leds\_pwm phram
[ 22.073768] CPU: 2 UID: 0 PID: 1 Comm: systemd-shutdow Not tainted 6.11.2-asahi+ #asahi-dev
[ 22.075612] Hardware name: Apple MacBook Pro (13-inch, M2, 2022) (DT)
[ 22.077032] pstate: 01400005 (nzcv daif +PAN -UAO -TCO +DIT -SSBS BTYPE=--)
[ 22.078567] pc : \_\_flush\_work+0x4d8/0x580
[ 22.079471] lr : \_\_flush\_work+0x54/0x580
[ 22.080345] sp : ffffc000836ef820
[ 22.081089] x29: ffffc000836ef880 x28: 0000000000000000 x27: ffff80002ddb7128
[ 22.082678] x26: dfffc00000000000 x25: 1ffff000096f0c57 x24: ffffc00082d3e358
[ 22.084263] x23: ffff80004b7862b8 x22: dfffc00000000000 x21: ffff80005aa1d470
[ 22.085855] x20: ffff80004b786000 x19: ffff80004b7862a0 x18: 0000000000000000
[ 22.087439] x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000005
[ 22.089030] x14: 1ffff800106ddf0a x13: 0000000000000000 x12: 0000000000000000
[ 22.090618] x11: ffffb800106ddf0f x10: dfffc00000000000 x9 : 1ffff800106ddf0e
[ 22.092206] x8 : 0000000000000000 x7 : aaaaaaaaaaaaaaaa x6 : 0000000000000001
[ 22.093790] x5 : ffffc000836ef728 x4 : 0000000000000000 x3 : 0000000000000020
[ 22.095368] x2 : 0000000000000008 x1 : 00000000000000aa x0 : 0000000000000000
[ 22.096955] Call trace:
[ 22.097505] \_\_flush\_work+0x4d8/0x580
[ 22.098330] flush\_delayed\_work+0x80/0xb8
[ 22.099231] fb\_deferred\_io\_cleanup+0x3c/0x130
[ 22.100217] drm\_fbdev\_dma\_fb\_destroy+0x6c/0xe0 [drm\_dma\_helper]
[ 22.101559] unregister\_framebuffer+0x210/0x2f0
[ 22.102575] drm\_fb\_helper\_unregister\_info+0x48/0x60
[ 22.103683] drm\_fbdev\_dma\_client\_unregister+0x4c/0x80 [drm\_dma\_helper]
[ 22.105147] drm\_client\_dev\_unregister+0x1cc/0x230
[ 22.106217] drm\_dev\_unregister+0x58/0x570
[ 22.107125] apple\_drm\_unbind+0x50/0x98 [appledrm]
[ 22.108199] component\_del+0x1f8/0x3a8
[ 22.109042] dcp\_platform\_shutdown+0x24/0x38 [apple\_dcp]
[ 22.110357] platform\_shutdown+0x70/0x90
[ 22.111219] device\_shutdown+0x368/0x4d8
[ 22.112095] kernel\_restart+0x6c/0x1d0
[ 22.112946] \_\_arm64\_sys\_reboot+0x1c8/0x328
[ 22.113868] invoke\_syscall+0x78/0x1a8
[ 22.114703] do\_el0\_svc+0x124/0x1a0
[ 22.115498] el0\_svc+0x3c/0xe0
[ 22.116181] el0t\_64\_sync\_handler+0x70/0xc0
[ 22.117110] el0t\_64\_sync+0x190/0x198
[ 22.117931] ---[ end trace 0000000000000000 ]---
Signed-off-by: Janne Grunau <j@jannau.net>
Fixes: 5a498d4d06d6 ("drm/fbdev-dma: Only install deferred I/O if necessary")
Reviewed-by: Thomas Zimmermann <tzimmermann@suse.de>
Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
Signed-off-by: Thomas Zimmermann <tzimmermann@suse.de>
Link: [https://patchwork.freedesktop.org/patch/msgid/ZwLNuZL-8Gh5UUQb@robin](https://patchwork.freedesktop.org/patch/msgid/ZwLNuZL-8Gh5UUQb%40robin)
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111)

| -rw-r--r-- | [drivers/gpu/drm/drm\_fbdev\_dma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/drm_fbdev_dma.c?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/drivers/gpu/drm/drm\_fbdev\_dma.c b/drivers/gpu/drm/drm\_fbdev\_dma.cindex b0602c4f362830..51c2d742d19980 100644--- a/[drivers/gpu/drm/drm\_fbdev\_dma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/drm_fbdev_dma.c?id=835745a377a4519decd1a36d6b926e369b3033e2)+++ b/[drivers/gpu/drm/drm\_fbdev\_dma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/drm_fbdev_dma.c?id=fcddc71ec7ecf15b4df3c41288c9cf0b8e886111)@@ -50,7 +50,8 @@ static void drm\_fbdev\_dma\_fb\_destroy(struct fb\_info \*info) if (!fb\_helper->dev) return; - fb\_deferred\_io\_cleanup(info);+ if (info->fbdefio)+ fb\_deferred\_io\_cleanup(info); drm\_fb\_helper\_fini(fb\_helper);  drm\_client\_buffer\_vunmap(fb\_helper->buffer); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 16:48:29 +0000



=== Content from git.kernel.org_65884935_20250110_164951.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Janne Grunau <j@jannau.net> | 2024-10-06 19:49:45 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-17 15:26:51 +0200 |
| commit | [5a4a8ea14c54c651ec532a480bd560d0c6e52f3d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d)) | |
| tree | [bbe647f2ced3f740ff6fc1bf055b454d984521ab](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d) | |
| parent | [712a3af3710263444217df54e7f337f99df198d2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=712a3af3710263444217df54e7f337f99df198d2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d&id2=712a3af3710263444217df54e7f337f99df198d2)) | |
| download | [linux-5a4a8ea14c54c651ec532a480bd560d0c6e52f3d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5a4a8ea14c54c651ec532a480bd560d0c6e52f3d.tar.gz) | |

drm/fbdev-dma: Only cleanup deferred I/O if necessary[ Upstream commit fcddc71ec7ecf15b4df3c41288c9cf0b8e886111 ]
Commit 5a498d4d06d6 ("drm/fbdev-dma: Only install deferred I/O if
necessary") initializes deferred I/O only if it is used.
drm\_fbdev\_dma\_fb\_destroy() however calls fb\_deferred\_io\_cleanup()
unconditionally with struct fb\_info.fbdefio == NULL. KASAN with the
out-of-tree Apple silicon display driver posts following warning from
\_\_flush\_work() of a random struct work\_struct instead of the expected
NULL pointer derefs.
[ 22.053799] ------------[ cut here ]------------
[ 22.054832] WARNING: CPU: 2 PID: 1 at kernel/workqueue.c:4177 \_\_flush\_work+0x4d8/0x580
[ 22.056597] Modules linked in: uhid bnep uinput nls\_ascii ip6\_tables ip\_tables i2c\_dev loop fuse dm\_multipath nfnetlink zram hid\_magicmouse btrfs xor xor\_neon brcmfmac\_wcc raid6\_pq hci\_bcm4377 bluetooth brcmfmac hid\_apple brcmutil nvmem\_spmi\_mfd simple\_mfd\_spmi dockchannel\_hid cfg80211 joydev regmap\_spmi nvme\_apple ecdh\_generic ecc macsmc\_hid rfkill dwc3 appledrm snd\_soc\_macaudio macsmc\_power nvme\_core apple\_isp phy\_apple\_atc apple\_sart apple\_rtkit\_helper apple\_dockchannel tps6598x macsmc\_hwmon snd\_soc\_cs42l84 videobuf2\_v4l2 spmi\_apple\_controller nvmem\_apple\_efuses videobuf2\_dma\_sg apple\_z2 videobuf2\_memops spi\_nor panel\_summit videobuf2\_common asahi videodev pwm\_apple apple\_dcp snd\_soc\_apple\_mca apple\_admac spi\_apple clk\_apple\_nco i2c\_pasemi\_platform snd\_pcm\_dmaengine mc i2c\_pasemi\_core mux\_core ofpart adpdrm drm\_dma\_helper apple\_dart apple\_soc\_cpufreq leds\_pwm phram
[ 22.073768] CPU: 2 UID: 0 PID: 1 Comm: systemd-shutdow Not tainted 6.11.2-asahi+ #asahi-dev
[ 22.075612] Hardware name: Apple MacBook Pro (13-inch, M2, 2022) (DT)
[ 22.077032] pstate: 01400005 (nzcv daif +PAN -UAO -TCO +DIT -SSBS BTYPE=--)
[ 22.078567] pc : \_\_flush\_work+0x4d8/0x580
[ 22.079471] lr : \_\_flush\_work+0x54/0x580
[ 22.080345] sp : ffffc000836ef820
[ 22.081089] x29: ffffc000836ef880 x28: 0000000000000000 x27: ffff80002ddb7128
[ 22.082678] x26: dfffc00000000000 x25: 1ffff000096f0c57 x24: ffffc00082d3e358
[ 22.084263] x23: ffff80004b7862b8 x22: dfffc00000000000 x21: ffff80005aa1d470
[ 22.085855] x20: ffff80004b786000 x19: ffff80004b7862a0 x18: 0000000000000000
[ 22.087439] x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000005
[ 22.089030] x14: 1ffff800106ddf0a x13: 0000000000000000 x12: 0000000000000000
[ 22.090618] x11: ffffb800106ddf0f x10: dfffc00000000000 x9 : 1ffff800106ddf0e
[ 22.092206] x8 : 0000000000000000 x7 : aaaaaaaaaaaaaaaa x6 : 0000000000000001
[ 22.093790] x5 : ffffc000836ef728 x4 : 0000000000000000 x3 : 0000000000000020
[ 22.095368] x2 : 0000000000000008 x1 : 00000000000000aa x0 : 0000000000000000
[ 22.096955] Call trace:
[ 22.097505] \_\_flush\_work+0x4d8/0x580
[ 22.098330] flush\_delayed\_work+0x80/0xb8
[ 22.099231] fb\_deferred\_io\_cleanup+0x3c/0x130
[ 22.100217] drm\_fbdev\_dma\_fb\_destroy+0x6c/0xe0 [drm\_dma\_helper]
[ 22.101559] unregister\_framebuffer+0x210/0x2f0
[ 22.102575] drm\_fb\_helper\_unregister\_info+0x48/0x60
[ 22.103683] drm\_fbdev\_dma\_client\_unregister+0x4c/0x80 [drm\_dma\_helper]
[ 22.105147] drm\_client\_dev\_unregister+0x1cc/0x230
[ 22.106217] drm\_dev\_unregister+0x58/0x570
[ 22.107125] apple\_drm\_unbind+0x50/0x98 [appledrm]
[ 22.108199] component\_del+0x1f8/0x3a8
[ 22.109042] dcp\_platform\_shutdown+0x24/0x38 [apple\_dcp]
[ 22.110357] platform\_shutdown+0x70/0x90
[ 22.111219] device\_shutdown+0x368/0x4d8
[ 22.112095] kernel\_restart+0x6c/0x1d0
[ 22.112946] \_\_arm64\_sys\_reboot+0x1c8/0x328
[ 22.113868] invoke\_syscall+0x78/0x1a8
[ 22.114703] do\_el0\_svc+0x124/0x1a0
[ 22.115498] el0\_svc+0x3c/0xe0
[ 22.116181] el0t\_64\_sync\_handler+0x70/0xc0
[ 22.117110] el0t\_64\_sync+0x190/0x198
[ 22.117931] ---[ end trace 0000000000000000 ]---
Signed-off-by: Janne Grunau <j@jannau.net>
Fixes: 5a498d4d06d6 ("drm/fbdev-dma: Only install deferred I/O if necessary")
Reviewed-by: Thomas Zimmermann <tzimmermann@suse.de>
Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
Signed-off-by: Thomas Zimmermann <tzimmermann@suse.de>
Link: [https://patchwork.freedesktop.org/patch/msgid/ZwLNuZL-8Gh5UUQb@robin](https://patchwork.freedesktop.org/patch/msgid/ZwLNuZL-8Gh5UUQb%40robin)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d)

| -rw-r--r-- | [drivers/gpu/drm/drm\_fbdev\_dma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/drm_fbdev_dma.c?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/drivers/gpu/drm/drm\_fbdev\_dma.c b/drivers/gpu/drm/drm\_fbdev\_dma.cindex b0602c4f362830..51c2d742d19980 100644--- a/[drivers/gpu/drm/drm\_fbdev\_dma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/drm_fbdev_dma.c?id=712a3af3710263444217df54e7f337f99df198d2)+++ b/[drivers/gpu/drm/drm\_fbdev\_dma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/drm_fbdev_dma.c?id=5a4a8ea14c54c651ec532a480bd560d0c6e52f3d)@@ -50,7 +50,8 @@ static void drm\_fbdev\_dma\_fb\_destroy(struct fb\_info \*info) if (!fb\_helper->dev) return; - fb\_deferred\_io\_cleanup(info);+ if (info->fbdefio)+ fb\_deferred\_io\_cleanup(info); drm\_fb\_helper\_fini(fb\_helper);  drm\_client\_buffer\_vunmap(fb\_helper->buffer); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 16:48:28 +0000


