<!DOCTYPE html>

<html class="no-js" lang="en-US">

	<head>

		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="profile" href="https://gmpg.org/xfn/11">

		<title>Security Issues in Matrix&#8217;s Olm Library - Dhole Moments</title>
<script type="text/javascript">
  WebFontConfig = {"google":{"families":["Merriweather:r:latin,latin-ext","Libre+Franklin:r,i,b,bi:latin,latin-ext"]},"api_url":"https:\/\/fonts-api.wp.com\/css"};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://soatok.blog/wp-content/mu-plugins/wpcomsh/vendor/automattic/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active html, .wf-active body{font-family:"Libre Franklin",sans-serif}.wf-active input, .wf-active textarea{font-family:"Libre Franklin",sans-serif}.wf-active .entry-content, .wf-active .entry-content p, .wf-active .entry-content ol, .wf-active .entry-content ul, .wf-active .entry-content dl, .wf-active .entry-content dt, .wf-active .entry-content cite{font-family:"Libre Franklin",sans-serif}.wf-active .entry-content .wp-block-jetpack-contact-form, .wf-active .entry-content .wp-block-jetpack-button button, .wf-active .widget_text p, .wf-active .widget_text ol, .wf-active .widget_text ul, .wf-active .widget_text dl, .wf-active .widget_text dt, .wf-active .widget-content .rssSummary{font-family:"Libre Franklin",sans-serif}.wf-active .faux-heading, .wf-active h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6, .wf-active .entry-content h1, .wf-active .entry-content h2, .wf-active .entry-content h3, .wf-active .entry-content h4, .wf-active .entry-content h5, .wf-active .entry-content h6{font-family:"Merriweather",serif;font-weight:400;font-style:normal}.wf-active .heading-size-1, .wf-active h1{font-weight:400;font-style:normal}.wf-active .heading-size-2, .wf-active h2{font-style:normal;font-weight:400}.wf-active .heading-size-3, .wf-active h3{font-style:normal;font-weight:400}.wf-active .heading-size-4, .wf-active h4{font-style:normal;font-weight:400}.wf-active .heading-size-5, .wf-active h5{font-style:normal;font-weight:400}.wf-active .heading-size-6, .wf-active h6{font-style:normal;font-weight:400}.wf-active .button, .wf-active .faux-button, .wf-active .wp-block-button__link, .wf-active .wp-block-file__button, .wf-active button{font-family:"Merriweather",serif;font-style:normal;font-weight:400}</style>
<script>var _activityPubOptions = {"namespace":"activitypub\/1.0","defaultAvatarUrl":"https:\/\/soatok.blog\/wp-content\/plugins\/activitypub\/assets\/img\/mp.jpg","enabled":{"site":true,"users":true}};</script><meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<meta name="robots" content="noai, noimageai" /><!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="DpeQaIhOKu9M-A3VRRYWBqHa9_0l05GqRqYaFEvH4dk" />
<meta name="msvalidate.01" content="F2B31E9B72D3203F8DE76CC95DE7F826" />
<meta name="facebook-domain-verification" content="nyuv2dajpy6p5dz7tcl4y4wuxpahge" />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//0.gravatar.com' />
<link rel='dns-prefetch' href='//1.gravatar.com' />
<link rel='dns-prefetch' href='//2.gravatar.com' />
<link rel='preconnect' href='//i0.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Dhole Moments &raquo; Feed" href="https://soatok.blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="Dhole Moments &raquo; Comments Feed" href="https://soatok.blog/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Dhole Moments &raquo; Security Issues in Matrix&#8217;s Olm Library Comments Feed" href="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/feed/" />
<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/soatok.blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<link rel='stylesheet' id='all-css-4d9fe393a7594b69b609f3b3fea77f1d' href='https://soatok.blog/_static/??-eJy1UltOw0AMvBDbpYJCfxA/lXoATrDZNambfWntEHJ7nLSgNmoDqsRPpElmJmOPu6xsigyRdfZtjZG0AwbLKiARxloZV/lkGyjaIbG2RJq490CLgHEh8K67xSMaxg8wjhb7Wae6FVhBqXXVond6NFIeq2JKf0hyTepNn1pWdUE3T5z+w6aQUxQGneswWt86IL0nHcChAQ9hMDoFWX4LRXmoje1PJ7uqlm+neG4bNo3z02GPYzj1/U4tb1LBp3AJU6Sb5CZikCrT75F/5t9AhuggWhSwTRvjXK/fxps6FuANA/HUkXeyH9LcCegPz8u9XiAquxuM/4muDRHItQyH/S406ZqhXNvIHjgb2+iQXDvM7LEBmr/QqWTMoDglT+O1Gj7L85fIUsexyy6LxSB5DS/L54fH1f16vXr6An4VlY4=' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='twentytwenty-style-inline-css'>
.color-accent,.color-accent-hover:hover,.color-accent-hover:focus,:root .has-accent-color,.has-drop-cap:not(:focus):first-letter,.wp-block-button.is-style-outline,a { color: #ad9deb; }blockquote,.border-color-accent,.border-color-accent-hover:hover,.border-color-accent-hover:focus { border-color: #ad9deb; }button,.button,.faux-button,.wp-block-button__link,.wp-block-file .wp-block-file__button,input[type="button"],input[type="reset"],input[type="submit"],.bg-accent,.bg-accent-hover:hover,.bg-accent-hover:focus,:root .has-accent-background-color,.comment-reply-link { background-color: #ad9deb; }.fill-children-accent,.fill-children-accent * { fill: #ad9deb; }:root .has-background-color,button,.button,.faux-button,.wp-block-button__link,.wp-block-file__button,input[type="button"],input[type="reset"],input[type="submit"],.wp-block-button,.comment-reply-link,.has-background.has-primary-background-color:not(.has-text-color),.has-background.has-primary-background-color *:not(.has-text-color),.has-background.has-accent-background-color:not(.has-text-color),.has-background.has-accent-background-color *:not(.has-text-color) { color: #0d3d6e; }:root .has-background-background-color { background-color: #0d3d6e; }body,.entry-title a,:root .has-primary-color { color: #ffffff; }:root .has-primary-background-color { background-color: #ffffff; }cite,figcaption,.wp-caption-text,.post-meta,.entry-content .wp-block-archives li,.entry-content .wp-block-categories li,.entry-content .wp-block-latest-posts li,.wp-block-latest-comments__comment-date,.wp-block-latest-posts__post-date,.wp-block-embed figcaption,.wp-block-image figcaption,.wp-block-pullquote cite,.comment-metadata,.comment-respond .comment-notes,.comment-respond .logged-in-as,.pagination .dots,.entry-content hr:not(.has-background),hr.styled-separator,:root .has-secondary-color { color: #97b5d2; }:root .has-secondary-background-color { background-color: #97b5d2; }pre,fieldset,input,textarea,table,table *,hr { border-color: #0d5195; }caption,code,code,kbd,samp,.wp-block-table.is-style-stripes tbody tr:nth-child(odd),:root .has-subtle-background-background-color { background-color: #0d5195; }.wp-block-table.is-style-stripes { border-bottom-color: #0d5195; }.wp-block-latest-posts.is-grid li { border-top-color: #0d5195; }:root .has-subtle-background-color { color: #0d5195; }body:not(.overlay-header) .primary-menu > li > a,body:not(.overlay-header) .primary-menu > li > .icon,.modal-menu a,.footer-menu a, .footer-widgets a:where(:not(.wp-block-button__link)),#site-footer .wp-block-button.is-style-outline,.wp-block-pullquote:before,.singular:not(.overlay-header) .entry-header a,.archive-header a,.header-footer-group .color-accent,.header-footer-group .color-accent-hover:hover { color: #7d60f0; }.social-icons a,#site-footer button:not(.toggle),#site-footer .button,#site-footer .faux-button,#site-footer .wp-block-button__link,#site-footer .wp-block-file__button,#site-footer input[type="button"],#site-footer input[type="reset"],#site-footer input[type="submit"] { background-color: #7d60f0; }.social-icons a,body:not(.overlay-header) .primary-menu ul,.header-footer-group button,.header-footer-group .button,.header-footer-group .faux-button,.header-footer-group .wp-block-button:not(.is-style-outline) .wp-block-button__link,.header-footer-group .wp-block-file__button,.header-footer-group input[type="button"],.header-footer-group input[type="reset"],.header-footer-group input[type="submit"] { color: #0a0a0a; }#site-header,.footer-nav-widgets-wrapper,#site-footer,.menu-modal,.menu-modal-inner,.search-modal-inner,.archive-header,.singular .entry-header,.singular .featured-media:before,.wp-block-pullquote:before { background-color: #0a0a0a; }.header-footer-group,body:not(.overlay-header) #site-header .toggle,.menu-modal .toggle { color: #ffffff; }body:not(.overlay-header) .primary-menu ul { background-color: #ffffff; }body:not(.overlay-header) .primary-menu > li > ul:after { border-bottom-color: #ffffff; }body:not(.overlay-header) .primary-menu ul ul:after { border-left-color: #ffffff; }.site-description,body:not(.overlay-header) .toggle-inner .toggle-text,.widget .post-date,.widget .rss-date,.widget_archive li,.widget_categories li,.widget cite,.widget_pages li,.widget_meta li,.widget_nav_menu li,.powered-by-wordpress,.footer-credits .privacy-policy,.to-the-top,.singular .entry-header .post-meta,.singular:not(.overlay-header) .entry-header .post-meta a { color: #828282; }.header-footer-group pre,.header-footer-group fieldset,.header-footer-group input,.header-footer-group textarea,.header-footer-group table,.header-footer-group table *,.footer-nav-widgets-wrapper,#site-footer,.menu-modal nav *,.footer-widgets-outer-wrapper,.footer-top { border-color: #2b2b2b; }.header-footer-group table caption,body:not(.overlay-header) .header-inner .toggle-wrapper::before { background-color: #2b2b2b; }
</style>
<style id='twentytwenty-jetpack-inline-css'>

		.infinite-scroll #site-content #infinite-handle span button,
		.infinite-scroll #site-content #infinite-handle span button:hover,
		.infinite-scroll #site-content #infinite-handle span button:focus {
			background: #ad9deb;
			color: #0d3d6e;
		}
		#site-content .entry-content div.sharedaddy h3.sd-title,
		#site-content .entry-content h3.sd-title,
		#site-content .entry-content #jp-relatedposts h3.jp-relatedposts-headline {
			color: #97b5d2;
		}
		
</style>
<link rel='stylesheet' id='print-css-982da75c5981111d2bdfd0f67246b0b6' href='https://soatok.blog/wp-content/themes/twentytwenty/print.css?m=1732786075' type='text/css' media='print' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<style id='activitypub-followers-style-inline-css'>
.activitypub-follower-block.is-style-compact .activitypub-handle,.activitypub-follower-block.is-style-compact .sep{display:none}.activitypub-follower-block.is-style-with-lines ul li{border-bottom:.5px solid;margin-bottom:.5rem;padding-bottom:.5rem}.activitypub-follower-block.is-style-with-lines ul li:last-child{border-bottom:none}.activitypub-follower-block.is-style-with-lines .activitypub-handle,.activitypub-follower-block.is-style-with-lines .activitypub-name{text-decoration:none}.activitypub-follower-block.is-style-with-lines .activitypub-handle:hover,.activitypub-follower-block.is-style-with-lines .activitypub-name:hover{text-decoration:underline}.activitypub-follower-block ul{margin:0!important;padding:0!important}.activitypub-follower-block li{display:flex;margin-bottom:1rem}.activitypub-follower-block img{border-radius:50%;height:40px;margin-right:var(--wp--preset--spacing--20,.5rem);width:40px}.activitypub-follower-block .activitypub-link{align-items:center;color:inherit!important;display:flex;flex-flow:row nowrap;max-width:100%;text-decoration:none!important}.activitypub-follower-block .activitypub-handle,.activitypub-follower-block .activitypub-name{text-decoration:underline;text-decoration-thickness:.8px;text-underline-position:under}.activitypub-follower-block .activitypub-handle:hover,.activitypub-follower-block .activitypub-name:hover{text-decoration:none}.activitypub-follower-block .activitypub-name{font-size:var(--wp--preset--font-size--normal,16px)}.activitypub-follower-block .activitypub-actor{font-size:var(--wp--preset--font-size--small,13px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.activitypub-follower-block .sep{padding:0 .2rem}.activitypub-follower-block .wp-block-query-pagination{margin-top:1.5rem}.activitypub-follower-block .activitypub-pager{cursor:default}.activitypub-follower-block .activitypub-pager.current{opacity:.33}.activitypub-follower-block .page-numbers{padding:0 .2rem}.activitypub-follower-block .page-numbers.current{font-weight:700;opacity:1}

</style>
<style id='activitypub-follow-me-style-inline-css'>
.activitypub__modal.components-modal__frame{background-color:#f7f7f7;color:#333}.activitypub__modal.components-modal__frame .components-modal__header-heading,.activitypub__modal.components-modal__frame h4{color:#333;letter-spacing:inherit;word-spacing:inherit}.activitypub__modal.components-modal__frame .components-modal__header .components-button:hover{color:var(--color-white)}.activitypub__dialog{max-width:40em}.activitypub__dialog h4{line-height:1;margin:0}.activitypub__dialog .activitypub-dialog__section{margin-bottom:2em}.activitypub__dialog .activitypub-dialog__remember{margin-top:1em}.activitypub__dialog .activitypub-dialog__description{font-size:var(--wp--preset--font-size--normal,.75rem);margin:.33em 0 1em}.activitypub__dialog .activitypub-dialog__button-group{align-items:flex-end;display:flex;justify-content:flex-end}.activitypub__dialog .activitypub-dialog__button-group svg{height:21px;margin-right:.5em;width:21px}.activitypub__dialog .activitypub-dialog__button-group input{background-color:var(--wp--preset--color--white);border-radius:50px 0 0 50px;border-width:1px;border:1px solid var(--wp--preset--color--black);color:var(--wp--preset--color--black);flex:1;font-size:16px;height:inherit;line-height:1;margin-right:0;padding:15px 23px}.activitypub__dialog .activitypub-dialog__button-group button{align-self:center;background-color:var(--wp--preset--color--black);border-radius:0 50px 50px 0;border-width:1px;color:var(--wp--preset--color--white);font-size:16px;height:inherit;line-height:1;margin-left:0;padding:15px 23px;text-decoration:none}.activitypub__dialog .activitypub-dialog__button-group button:hover{border:inherit}.activitypub-follow-me-block-wrapper{width:100%}.activitypub-follow-me-block-wrapper.has-background .activitypub-profile,.activitypub-follow-me-block-wrapper.has-border-color .activitypub-profile{padding-left:1rem;padding-right:1rem}.activitypub-follow-me-block-wrapper .activitypub-profile{align-items:center;display:flex;padding:1rem 0}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__avatar{border-radius:50%;height:75px;margin-right:1rem;width:75px}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__content{flex:1;min-width:0}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__handle,.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__name{line-height:1.2;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__name{font-size:1.25em}.activitypub-follow-me-block-wrapper .activitypub-profile .activitypub-profile__follow{align-self:center;background-color:var(--wp--preset--color--black);color:var(--wp--preset--color--white);margin-left:1rem}

</style>
<link rel='stylesheet' id='dashicons-css' href='https://soatok.blog/wp-includes/css/dashicons.min.css?ver=6.7.1' media='all' />
<style id='activitypub-reactions-style-inline-css'>
.activitypub-reactions h6{border-top:1px solid;border-top-color:var(--wp--preset--color--contrast-2);display:inline-block;padding-top:.5em}.activitypub-reactions .reaction-group{align-items:center;display:flex;gap:.75em;justify-content:flex-start;margin:.5em 0;position:relative;width:100%}@media(max-width:782px){.activitypub-reactions .reaction-group:has(.reaction-avatars:not(:empty)){justify-content:space-between}}.activitypub-reactions .reaction-avatars{align-items:center;display:flex;flex-direction:row;list-style:none;margin:0;padding:0}.activitypub-reactions .reaction-avatars li{margin:0 -10px 0 0;padding:0}.activitypub-reactions .reaction-avatars li:last-child{margin-right:0}.activitypub-reactions .reaction-avatars li a{display:block;text-decoration:none}.activitypub-reactions .reaction-avatars .reaction-avatar{border:.5px solid var(--wp--preset--color--contrast,hsla(0,0%,100%,.8));border-radius:50%;box-shadow:0 0 0 .5px hsla(0,0%,100%,.8),0 1px 3px rgba(0,0,0,.2);height:32px;transition:transform .6s cubic-bezier(.34,1.56,.64,1);width:32px;will-change:transform}.activitypub-reactions .reaction-avatars .reaction-avatar.wave-active{transform:translateY(-5px)}.activitypub-reactions .reaction-avatars .reaction-avatar.wave-active.rotate-clockwise{transform:translateY(-5px) rotate(30deg)}.activitypub-reactions .reaction-avatars .reaction-avatar.wave-active.rotate-counter{transform:translateY(-5px) rotate(-30deg)}.activitypub-reactions .reaction-avatars .reaction-avatar:hover{position:relative;z-index:1}.activitypub-reactions .reaction-label.components-button{color:var(--wp--preset--color--contrast,--wp--preset--color--secondary,#2271b1);flex:0 0 auto;height:auto;padding:0;text-decoration:none;white-space:nowrap}.activitypub-reactions .reaction-label.components-button:hover{color:var(--wp--preset--color--contrast,--wp--preset--color--secondary,#135e96);text-decoration:underline}.activitypub-reactions .reaction-label.components-button:focus:not(:disabled){box-shadow:none;outline:1px solid var(--wp--preset--color--contrast,#135e96);outline-offset:2px}.activitypub-reaction-list{background-color:var(--wp--preset--color--background,var(--wp--preset--color--custom-background,var(--wp--preset--color--base)));list-style:none;margin:0;max-width:300px;padding:.25em 1.3em .25em .7em;width:-moz-max-content;width:max-content}.activitypub-reaction-list ul{margin:0;padding:0}.activitypub-reaction-list li{font-size:var(--wp--preset--font-size--small);margin:0;padding:0}.activitypub-reaction-list a{align-items:center;color:var(--wp--preset--color--contrast,var(--wp--preset--color--secondary));display:flex;font-size:var(--wp--preset--font-size--small,.75rem);gap:.5em;justify-content:flex-start;padding:.5em;text-decoration:none}.activitypub-reaction-list a:hover{text-decoration:underline}.activitypub-reaction-list a img{border-radius:50%;flex:none;height:24px;width:24px}

</style>
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--accent: #ad9deb;--wp--preset--color--primary: #ffffff;--wp--preset--color--secondary: #97b5d2;--wp--preset--color--subtle-background: #0d5195;--wp--preset--color--background: #0d3d6e;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 18px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 26.25px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 21px;--wp--preset--font-size--larger: 32px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<script id="jetpack-mu-wpcom-settings-js-before">
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/soatok.blog\/wp-content\/mu-plugins\/wpcomsh\/vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
</script>
<script type='text/javascript'  src='https://soatok.blog/wp-content/themes/twentytwenty/assets/js/index.js?m=1732786075'></script>
<link rel="https://api.w.org/" href="https://soatok.blog/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://soatok.blog/wp-json/wp/v2/posts/10255" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://soatok.blog/xmlrpc.php?rsd" />

<link rel="canonical" href="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/" />
<link rel='shortlink' href='https://soatok.blog/?p=10255' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://soatok.blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsoatok.blog%2F2024%2F08%2F14%2Fsecurity-issues-in-matrixs-olm-library%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://soatok.blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsoatok.blog%2F2024%2F08%2F14%2Fsecurity-issues-in-matrixs-olm-library%2F&#038;format=xml" />
	<style>img#wpstats{display:none}</style>
		<meta property="fediverse:creator" name="fediverse:creator" content="soatok@soatok.blog" />
	<script>document.documentElement.className = document.documentElement.className.replace( 'no-js', 'js' );</script>
	<meta name="description" content="I don&#039;t consider myself exceptional in any regard, but I stumbled upon a few cryptography vulnerabilities in Matrix&#039;s Olm library with so little effort that it was nearly accidental. It should not be this easy to find these kind of issues in any product people purportedly rely on for private messaging, which many people evangelize&hellip;" />
<style id="custom-background-css">
body.custom-background { background-color: #0d3d6e; background-image: url("https://soatok.blog/wp-content/uploads/2020/04/soatok-background-dark.jpg"); background-position: center bottom; background-size: cover; background-repeat: repeat; background-attachment: scroll; }
</style>
	<link rel="amphtml" href="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/?amp=1">
<link rel="alternate" title="ActivityPub (JSON)" type="application/activity+json" href="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/" />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Security Issues in Matrix&#8217;s Olm Library - Dhole Moments" />
<meta property="og:url" content="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/" />
<meta property="og:description" content="I don&#8217;t consider myself exceptional in any regard, but I stumbled upon a few cryptography vulnerabilities in Matrix&#8217;s Olm library with so little effort that it was nearly accidental. It…" />
<meta property="article:published_time" content="2024-08-14T12:00:00+00:00" />
<meta property="article:modified_time" content="2024-12-03T20:06:43+00:00" />
<meta property="og:site_name" content="Dhole Moments" />
<meta property="og:image" content="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?fit=1200%2C675&#038;ssl=1" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="675" />
<meta property="og:image:alt" content="Security Issues in Matrix&#039;s Olm Library" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@SoatokDhole" />
<meta name="twitter:text:title" content="Security Issues in Matrix&#8217;s Olm Library" />
<meta name="twitter:image" content="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?fit=1200%2C675&#038;ssl=1&#038;w=640" />
<meta name="twitter:image:alt" content="Security Issues in Matrix&#039;s Olm Library" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/11/cropped-cropped-soatok-johis-responsive.jpg?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/11/cropped-cropped-soatok-johis-responsive.jpg?fit=192%2C192&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/11/cropped-cropped-soatok-johis-responsive.jpg?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/11/cropped-cropped-soatok-johis-responsive.jpg?fit=270%2C270&#038;ssl=1" />
<style type="text/css" id="wp-custom-css">.td-bad { background-color: rgba(102, 0, 0, 0.2);}
.td-good { background-color: rgba(0, 102, 0, 0.2);}</style>
	</head>

	<body class="post-template-default single single-post postid-10255 single-format-standard custom-background wp-embed-responsive is-twentytwenty singular enable-search-modal has-post-thumbnail has-single-pagination showing-comments show-avatars footer-top-hidden hide-footer-credit">

		<a class="skip-link screen-reader-text" href="#site-content">Skip to the content</a>
		<header id="site-header" class="header-footer-group" role="banner">

			<div class="header-inner section-inner">

				<div class="header-titles-wrapper">

					
						<button class="toggle search-toggle mobile-search-toggle" data-toggle-target=".search-modal" data-toggle-body-class="showing-search-modal" data-set-focus=".search-modal .search-field" aria-expanded="false">
							<span class="toggle-inner">
								<span class="toggle-icon">
									<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23"><path d="M38.710696,48.0601792 L43,52.3494831 L41.3494831,54 L37.0601792,49.710696 C35.2632422,51.1481185 32.9839107,52.0076499 30.5038249,52.0076499 C24.7027226,52.0076499 20,47.3049272 20,41.5038249 C20,35.7027226 24.7027226,31 30.5038249,31 C36.3049272,31 41.0076499,35.7027226 41.0076499,41.5038249 C41.0076499,43.9839107 40.1481185,46.2632422 38.710696,48.0601792 Z M36.3875844,47.1716785 C37.8030221,45.7026647 38.6734666,43.7048964 38.6734666,41.5038249 C38.6734666,36.9918565 35.0157934,33.3341833 30.5038249,33.3341833 C25.9918565,33.3341833 22.3341833,36.9918565 22.3341833,41.5038249 C22.3341833,46.0157934 25.9918565,49.6734666 30.5038249,49.6734666 C32.7048964,49.6734666 34.7026647,48.8030221 36.1716785,47.3875844 C36.2023931,47.347638 36.2360451,47.3092237 36.2726343,47.2726343 C36.3092237,47.2360451 36.347638,47.2023931 36.3875844,47.1716785 Z" transform="translate(-20 -31)" /></svg>								</span>
								<span class="toggle-text">Search</span>
							</span>
						</button><!-- .search-toggle -->

					
					<div class="header-titles">

						<div class="site-title faux-heading"><a href="https://soatok.blog/">Dhole Moments</a></div><div class="site-description">Software, Security, Cryptography, and Furries</div><!-- .site-description -->
					</div><!-- .header-titles -->

					<button class="toggle nav-toggle mobile-nav-toggle" data-toggle-target=".menu-modal"  data-toggle-body-class="showing-menu-modal" aria-expanded="false" data-set-focus=".close-nav-toggle">
						<span class="toggle-inner">
							<span class="toggle-icon">
								<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="26" height="7" viewBox="0 0 26 7"><path fill-rule="evenodd" d="M332.5,45 C330.567003,45 329,43.4329966 329,41.5 C329,39.5670034 330.567003,38 332.5,38 C334.432997,38 336,39.5670034 336,41.5 C336,43.4329966 334.432997,45 332.5,45 Z M342,45 C340.067003,45 338.5,43.4329966 338.5,41.5 C338.5,39.5670034 340.067003,38 342,38 C343.932997,38 345.5,39.5670034 345.5,41.5 C345.5,43.4329966 343.932997,45 342,45 Z M351.5,45 C349.567003,45 348,43.4329966 348,41.5 C348,39.5670034 349.567003,38 351.5,38 C353.432997,38 355,39.5670034 355,41.5 C355,43.4329966 353.432997,45 351.5,45 Z" transform="translate(-329 -38)" /></svg>							</span>
							<span class="toggle-text">Menu</span>
						</span>
					</button><!-- .nav-toggle -->

				</div><!-- .header-titles-wrapper -->

				<div class="header-navigation-wrapper">

					
							<nav class="primary-menu-wrapper" aria-label="Horizontal" role="navigation">

								<ul class="primary-menu reset-list-style">

								<li id="menu-item-19" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-19"><a href="https://soatok.blog/">Home</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20"><a href="https://soatok.blog/b/">Blog</a></li>
<li id="menu-item-306" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306"><a href="https://soatok.blog/explore/">Explore</a></li>
<li id="menu-item-21" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21"><a href="https://soatok.blog/about/">About</a></li>

								</ul>

							</nav><!-- .primary-menu-wrapper -->

						
						<div class="header-toggles hide-no-js">

						
							<div class="toggle-wrapper search-toggle-wrapper">

								<button class="toggle search-toggle desktop-search-toggle" data-toggle-target=".search-modal" data-toggle-body-class="showing-search-modal" data-set-focus=".search-modal .search-field" aria-expanded="false">
									<span class="toggle-inner">
										<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23"><path d="M38.710696,48.0601792 L43,52.3494831 L41.3494831,54 L37.0601792,49.710696 C35.2632422,51.1481185 32.9839107,52.0076499 30.5038249,52.0076499 C24.7027226,52.0076499 20,47.3049272 20,41.5038249 C20,35.7027226 24.7027226,31 30.5038249,31 C36.3049272,31 41.0076499,35.7027226 41.0076499,41.5038249 C41.0076499,43.9839107 40.1481185,46.2632422 38.710696,48.0601792 Z M36.3875844,47.1716785 C37.8030221,45.7026647 38.6734666,43.7048964 38.6734666,41.5038249 C38.6734666,36.9918565 35.0157934,33.3341833 30.5038249,33.3341833 C25.9918565,33.3341833 22.3341833,36.9918565 22.3341833,41.5038249 C22.3341833,46.0157934 25.9918565,49.6734666 30.5038249,49.6734666 C32.7048964,49.6734666 34.7026647,48.8030221 36.1716785,47.3875844 C36.2023931,47.347638 36.2360451,47.3092237 36.2726343,47.2726343 C36.3092237,47.2360451 36.347638,47.2023931 36.3875844,47.1716785 Z" transform="translate(-20 -31)" /></svg>										<span class="toggle-text">Search</span>
									</span>
								</button><!-- .search-toggle -->

							</div>

							
						</div><!-- .header-toggles -->
						
				</div><!-- .header-navigation-wrapper -->

			</div><!-- .header-inner -->

			<div class="search-modal cover-modal header-footer-group" data-modal-target-string=".search-modal" role="dialog" aria-modal="true" aria-label="Search">

	<div class="search-modal-inner modal-inner">

		<div class="section-inner">

			<form role="search" aria-label="Search for:" method="get" class="search-form" action="https://soatok.blog/">
	<label for="search-form-1">
		<span class="screen-reader-text">
			Search for:		</span>
		<input type="search" id="search-form-1" class="search-field" placeholder="Search &hellip;" value="" name="s" />
	</label>
	<input type="submit" class="search-submit" value="Search" />
</form>

			<button class="toggle search-untoggle close-search-toggle fill-children-current-color" data-toggle-target=".search-modal" data-toggle-body-class="showing-search-modal" data-set-focus=".search-modal .search-field">
				<span class="screen-reader-text">
					Close search				</span>
				<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><polygon fill="" fill-rule="evenodd" points="6.852 7.649 .399 1.195 1.445 .149 7.899 6.602 14.352 .149 15.399 1.195 8.945 7.649 15.399 14.102 14.352 15.149 7.899 8.695 1.445 15.149 .399 14.102" /></svg>			</button><!-- .search-toggle -->

		</div><!-- .section-inner -->

	</div><!-- .search-modal-inner -->

</div><!-- .menu-modal -->

		</header><!-- #site-header -->

		
<div class="menu-modal cover-modal header-footer-group" data-modal-target-string=".menu-modal">

	<div class="menu-modal-inner modal-inner">

		<div class="menu-wrapper section-inner">

			<div class="menu-top">

				<button class="toggle close-nav-toggle fill-children-current-color" data-toggle-target=".menu-modal" data-toggle-body-class="showing-menu-modal" data-set-focus=".menu-modal">
					<span class="toggle-text">Close Menu</span>
					<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><polygon fill="" fill-rule="evenodd" points="6.852 7.649 .399 1.195 1.445 .149 7.899 6.602 14.352 .149 15.399 1.195 8.945 7.649 15.399 14.102 14.352 15.149 7.899 8.695 1.445 15.149 .399 14.102" /></svg>				</button><!-- .nav-toggle -->

				
					<nav class="mobile-menu" aria-label="Mobile" role="navigation">

						<ul class="modal-menu reset-list-style">

						<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-19"><div class="ancestor-wrapper"><a href="https://soatok.blog/">Home</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20"><div class="ancestor-wrapper"><a href="https://soatok.blog/b/">Blog</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-306"><div class="ancestor-wrapper"><a href="https://soatok.blog/explore/">Explore</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21"><div class="ancestor-wrapper"><a href="https://soatok.blog/about/">About</a></div><!-- .ancestor-wrapper --></li>

						</ul>

					</nav>

					
			</div><!-- .menu-top -->

			<div class="menu-bottom">

				
			</div><!-- .menu-bottom -->

		</div><!-- .menu-wrapper -->

	</div><!-- .menu-modal-inner -->

</div><!-- .menu-modal -->

<main id="site-content" role="main">

	
<article class="post-10255 post type-post status-publish format-standard has-post-thumbnail hentry category-cryptography category-software-security category-vulnerability tag-crypto tag-cryptography tag-end-to-end-encryption tag-matrix tag-side-channels tag-vulnerability" id="post-10255">

	
<header class="entry-header has-text-align-center header-footer-group">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					Categories				</span>
				<div class="entry-categories-inner">
					<a href="https://soatok.blog/category/cryptography/" rel="category tag">Cryptography</a> <a href="https://soatok.blog/category/technology/software-security/" rel="category tag">Software Security</a> <a href="https://soatok.blog/category/technology/software-security/vulnerability/" rel="category tag">Vulnerability</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h1 class="entry-title">Security Issues in Matrix&#8217;s Olm Library</h1>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								Post author							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewBox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z" /></svg>						</span>
						<span class="meta-text">
							By <a href="https://soatok.blog/author/soatok/">Soatok</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								Post date							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewBox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z" /></svg>						</span>
						<span class="meta-text">
							<a href="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/">August 14, 2024</a>
						</span>
					</li>
										<li class="post-comment-link meta-wrapper">
						<span class="meta-icon">
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 19 19"><path d="M9.43016863,13.2235931 C9.58624731,13.094699 9.7823475,13.0241935 9.98476849,13.0241935 L15.0564516,13.0241935 C15.8581553,13.0241935 16.5080645,12.3742843 16.5080645,11.5725806 L16.5080645,3.44354839 C16.5080645,2.64184472 15.8581553,1.99193548 15.0564516,1.99193548 L3.44354839,1.99193548 C2.64184472,1.99193548 1.99193548,2.64184472 1.99193548,3.44354839 L1.99193548,11.5725806 C1.99193548,12.3742843 2.64184472,13.0241935 3.44354839,13.0241935 L5.76612903,13.0241935 C6.24715123,13.0241935 6.63709677,13.4141391 6.63709677,13.8951613 L6.63709677,15.5301903 L9.43016863,13.2235931 Z M3.44354839,14.766129 C1.67980032,14.766129 0.25,13.3363287 0.25,11.5725806 L0.25,3.44354839 C0.25,1.67980032 1.67980032,0.25 3.44354839,0.25 L15.0564516,0.25 C16.8201997,0.25 18.25,1.67980032 18.25,3.44354839 L18.25,11.5725806 C18.25,13.3363287 16.8201997,14.766129 15.0564516,14.766129 L10.2979143,14.766129 L6.32072889,18.0506004 C5.75274472,18.5196577 4.89516129,18.1156602 4.89516129,17.3790323 L4.89516129,14.766129 L3.44354839,14.766129 Z" /></svg>						</span>
						<span class="meta-text">
							<a href="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/#comments">5 Comments<span class="screen-reader-text"> on Security Issues in Matrix&#8217;s Olm Library</span></a>						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<figure class="featured-media">

		<div class="featured-media-inner section-inner">

			<img width="1200" height="675" src="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?fit=1200%2C675&amp;ssl=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Security Issues in Matrix&#039;s Olm Library" decoding="async" fetchpriority="high" srcset="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?w=1200&amp;ssl=1 1200w, https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?resize=300%2C169&amp;ssl=1 300w, https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?resize=1024%2C576&amp;ssl=1 1024w, https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?resize=768%2C432&amp;ssl=1 768w" sizes="(max-width: 1200px) 100vw, 1200px" data-attachment-id="10256" data-permalink="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/blogheader-2024-matrix-olm-disclosure/" data-orig-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?fit=1200%2C675&amp;ssl=1" data-orig-size="1200,675" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="BlogHeader-2024-Matrix-Olm-Disclosure" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?fit=300%2C169&amp;ssl=1" data-large-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/07/BlogHeader-2024-Matrix-Olm-Disclosure.png?fit=768%2C432&amp;ssl=1" />
		</div><!-- .featured-media-inner -->

	</figure><!-- .featured-media -->

	
	<div class="post-inner thin ">

		<div class="entry-content">

			
<p>I don&#8217;t consider myself exceptional in any regard, but I stumbled upon a few cryptography vulnerabilities in Matrix&#8217;s Olm library with so little effort that it was nearly <em>accidental</em>. </p>



<p>It should not be this easy to find these kind of issues in any product people purportedly rely on for private messaging, which many people evangelize <a href="https://soatok.blog/2024/07/31/what-does-it-mean-to-be-a-signal-competitor/">incorrectly as a Signal alternative</a>.</p>



<p>Later, I thought I identified an additional vulnerability that would have been much worse, but I was wrong about that one. For the sake of transparency and humility, I&#8217;ll also describe that in detail.</p>



<p>This post is organized as follows:</p>



<ul class="wp-block-list">
<li><a href="#timeline">Disclosure Timeline</a></li>



<li><a href="#vulnerabilities">Vulnerabilities in Olm (Technical Details)</a></li>



<li><a href="#user-recommendations">Recommendations</a></li>



<li><a href="#background-information">Background Information</a></li>



<li><a href="#interesting-non-issue">An Interesting Non-Issue That Looked Critical</a></li>
</ul>



<p>I&#8217;ve opted to front-load the timeline and vulnerability details to respect the time of busy security professionals.</p>



<blockquote class="wp-block-quote quote-soatok is-layout-flow wp-block-quote-is-layout-flow">
<p>Please keep in mind that <a href="https://soatok.blog/2023/11/17/this-would-be-more-professionally-useful-if-not-for-the-furry-art/">this website is a furry blog, first and foremost</a>, that sometimes happens to cover security and cryptography topics.</p>



<p>Many people have, over the years, assumed the opposite and commented accordingly. The ensuing message board threads are usually is a waste of time and energy for everyone involved. So please adjust your expectations.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img data-recalc-dims="1" decoding="async" width="422" height="512" data-attachment-id="3597" data-permalink="https://soatok.blog/2021/08/20/lobste-rs-password-reset-vulnerability/neophyte-sitting/" data-orig-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/07/neophyte-sitting.png?fit=422%2C512&amp;ssl=1" data-orig-size="422,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Neophyte-Sitting" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/07/neophyte-sitting.png?fit=247%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/07/neophyte-sitting.png?fit=422%2C512&amp;ssl=1" src="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/07/neophyte-sitting.png?resize=422%2C512&#038;ssl=1" alt="" class="wp-image-3597" style="width:auto;height:256px"/><figcaption class="wp-element-caption">Art by <a href="https://harubaki.carrd.co/" target="_blank" rel="noreferrer noopener">Harubaki</a></figcaption></figure></div>


<p>If you&#8217;re curious, you can learn more <a href="https://soatok.blog/about/" target="_blank" rel="noreferrer noopener">here</a>.</p>
</blockquote>



<h2 class="wp-block-heading">Disclosure Timeline</h2>



<ul class="wp-block-list">
<li><strong>2024-05-15</strong>: I took a quick look at the Matrix source code. I identified two issues and emailed them to their <code>security@</code> email address.<br><br>In my email, I specify that I plan to disclose my findings publicly in 90 days (i.e. on August 14), in adherence <a href="https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-policy.html" target="_blank" rel="noreferrer noopener">with industry best practices for coordinated disclosure,</a> unless they request an extension in writing.</li>



<li><strong>2024-05-16</strong>: I checked something else on a whim and find a third issue, which I also email to their <code>security@</code> email address.</li>



<li><strong>2024-05-17</strong>: Matrix security team confirms receipt of my reports.</li>



<li><strong>2024-05-17</strong>: I follow up with a suspected fourth finding&#8211;the most critical of them all. They point out that it is not actually an issue, because I overlooked an important detail in how the code is architected. <em>Mea culpa!</em></li>



<li><strong>2024-05-18</strong>: A friend discloses a separate finding with Matrix: <a href="https://lotte.chir.rs/2024/08/17/Missing-Salamanders-Matrix-Media-can-be-decrypted-to-multiple-valid-plaintexts-using-different-keys/">Media can be decrypted to multiple valid plaintexts using different keys</a> and <a href="https://lotte.chir.rs/2024/08/17/Malicious-homeserver-can-trick-Element-Schildichat-into-revealing-links-in-E2EE-Rooms/">Malicious homeservers can trick Element/Schildichat into revealing links in E2EE rooms</a>.<br><br> They instructed the Matrix developers to consult with me if they needed cryptography guidance. I never heard from them on this externally reported issue.</li>



<li><strong>2024-07-12</strong>: I shared this blog post draft with the Matrix security team while reminding them of the public disclosure date.</li>



<li><strong>2024-07-31:</strong> Matrix <a href="https://gitlab.matrix.org/matrix-org/olm/-/commit/6d4b5b07887821a95b144091c8497d09d377f985" target="_blank" rel="noreferrer noopener">pushes a commit</a> that announces that libolm is deprecated.</li>



<li><strong>2024-07-31:</strong> I email the Matrix security team asking if they plan to fix the reported issues (and if not, if there&#8217;s any other reason I should withhold publication).</li>



<li><strong>2024-07-31:</strong> Matrix confirms they will not fix these issues (due to its now deprecated status), but ask that I withhold publication until the 14th as originally discussed.</li>



<li><strong>2024-08-14</strong>: This blog post is publicly disclosed to the Internet.</li>



<li><strong>2024-08-14</strong>: The lead Matrix dev claims they already knew about these issues, and, in fact, knowingly shipped cryptography code that was vulnerable to side-channel attacks for years. See <a href="#addendum-2024-08-14">Addendum</a>.</li>



<li><strong>2024-08-23</strong>: MITRE has assigned CVE IDs to these three findings.</li>
</ul>



<h2 class="wp-block-heading" id="vulnerabilities">Vulnerabilities in Olm</h2>



<p class="quote-soatok">I identified the following issues with Olm through a quick skim of <a href="https://gitlab.matrix.org/matrix-org/olm/-/tree/7e0c8277032e40308987257b711b38af8d77cc69" target="_blank" rel="noreferrer noopener">their source code on Gitlab</a>:</p>



<ol class="wp-block-list">
<li><a href="#vuln-aes">AES implementation is vulnerable to cache-timing attacks</a></li>



<li><a href="#vuln-ed25519">Ed25519 signatures are malleable</a></li>



<li><a href="#vuln-base64">Timing leakage in base64 decoding of private key material</a></li>
</ol>



<p>This is sorted by the order in which they were discovered, rather than severity.</p>



<h3 class="wp-block-heading" id="vuln-aes">AES implementation is vulnerable to cache-timing attacks</h3>



<p class="has-text-align-right"><strong>a.k.a. <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-45191" target="_blank" rel="noreferrer noopener">CVE-2024-45191</a></strong></p>



<p>Olm ships <a href="https://gitlab.matrix.org/matrix-org/olm/-/blob/7e0c8277032e40308987257b711b38af8d77cc69/lib/crypto-algorithms/aes.c#L518-528">a pure-software implementation of AES</a>, rather than leveraging hardware acceleration.</p>


<div class="wp-block-syntaxhighlighter-code dark-syntax-highlighter"><pre class="brush: cpp; auto-links: false; first-line: 518; title: ; quick-code: false; notranslate" title="">
// Substitutes a word using the AES S-Box.
WORD SubWord(WORD word)
{
	unsigned int result;

	result = (int)aes_sbox&#x5B;(word &gt;&gt; 4) &amp; 0x0000000F]&#x5B;word &amp; 0x0000000F];
	result += (int)aes_sbox&#x5B;(word &gt;&gt; 12) &amp; 0x0000000F]&#x5B;(word &gt;&gt; 8) &amp; 0x0000000F] &lt;&lt; 8;
	result += (int)aes_sbox&#x5B;(word &gt;&gt; 20) &amp; 0x0000000F]&#x5B;(word &gt;&gt; 16) &amp; 0x0000000F] &lt;&lt; 16;
	result += (int)aes_sbox&#x5B;(word &gt;&gt; 28) &amp; 0x0000000F]&#x5B;(word &gt;&gt; 24) &amp; 0x0000000F] &lt;&lt; 24;
	return(result);
}
</pre></div>


<p>The code in question is called from <a href="https://gitlab.matrix.org/matrix-org/olm/-/blob/7e0c8277032e40308987257b711b38af8d77cc69/src/crypto.cpp#L173-201">this code</a>, which is in turn used <a href="https://gitlab.matrix.org/matrix-org/olm/-/blob/7e0c8277032e40308987257b711b38af8d77cc69/src/cipher.cpp#L84">to actually encrypt messages</a>.</p>



<p>Software implementations of AES that use a look-up table for the SubWord step of the algorithm are famously <a href="https://cr.yp.to/antiforgery/cachetiming-20050414.pdf" target="_blank" rel="noreferrer noopener">susceptible to cache-timing attacks</a>. </p>



<p>This kind of vulnerability in software AES was previously used to <a href="https://eprint.iacr.org/2005/271" target="_blank" rel="noreferrer noopener">extract a secret key from OpenSSL and dm-crypt in about 65 milliseconds</a>. Both papers were published in 2005.</p>



<p>A general rule in cryptography is, <a href="https://www.schneier.com/blog/archives/2009/07/new_attack_on_a.html">&#8220;attacks only get better; they never get worse</a>&#8220;.</p>



<p>As of 2009, you could remotely detect a timing difference of <a href="https://www.cs.rice.edu/~dwallach/pub/crosby-timing2009.pdf" target="_blank" rel="noreferrer noopener">about 15 microseconds over the Internet</a> with under 50,000 samples. Side-channel exploits are generally statistical in nature, so such a sample size is generally not a significant mitigation.</p>



<h4 class="wp-block-heading">How is this code actually vulnerable?</h4>



<p>In the above code snippet, the vulnerability occurs in<br><code>aes_sbox[/* ... */][/* ... */]</code>.</p>



<p>Due to the details of how the AES block cipher works, the input variable (<code>word</code>) is a sensitive value.</p>



<p>Software written this way allows attackers to detect whether or not a specific value was present in one of the processor&#8217;s caches.</p>



<p>To state the obvious: Cache hits are faster than cache misses. This creates an observable timing difference.</p>



<p>Such a timing leak allows the attacker to learn the value that was actually stored in said cache. You can directly learn this from other processes on the same hardware, but it&#8217;s also observable over the Internet (with some jitter) through the normal operation of vulnerable software.</p>



<p><strong>See also: <a href="https://github.com/veorq/cryptocoding?tab=readme-ov-file#avoid-table-look-ups-indexed-by-secret-data" target="_blank" rel="noreferrer noopener">cryptocoding&#8217;s description for table look-ups indexed by secret data</a>.</strong></p>



<h4 class="wp-block-heading">How to mitigate this cryptographic side-channel</h4>



<p>The correct way to solve this problem is to use hardware accelerated AES, which uses distinct processor features to implement the AES round function and side-steps any cache-timing shenanigans with the S-box.</p>



<p>Not only is this more secure, but it&#8217;s faster and uses less energy too!</p>



<p>If you&#8217;re also targeting devices that don&#8217;t have hardware acceleration available, you should first use hardware acceleration where possible, but then fallback to <a href="https://www.bearssl.org/gitweb/?p=BearSSL;a=blob;f=src/symcipher/aes_ct.c;h=66776d9e206c92cbbf3fa799c651a3d3652bd75a;hb=HEAD#l27"> a bitsliced implementation such as the one in Thomas Pornin&#8217;s BearSSL</a>.</p>



<p>See also: <a href="https://www.bearssl.org/constanttime.html#aes">the BearSSL documentation for constant-time AES</a>.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img data-recalc-dims="1" decoding="async" width="512" height="445" data-attachment-id="8953" data-permalink="https://soatok.blog/2023/10/04/i-dont-care-if-strangers-can-take-me-seriously/soatokglitch/" data-orig-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2023/10/SoatokGlitch.png?fit=512%2C445&amp;ssl=1" data-orig-size="512,445" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="SoatokGlitch" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2023/10/SoatokGlitch.png?fit=300%2C261&amp;ssl=1" data-large-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2023/10/SoatokGlitch.png?fit=512%2C445&amp;ssl=1" src="https://i0.wp.com/soatok.blog/wp-content/uploads/2023/10/SoatokGlitch.png?resize=512%2C445&#038;ssl=1" alt="Soatok glitching out" class="wp-image-8953" style="width:256px" srcset="https://i0.wp.com/soatok.blog/wp-content/uploads/2023/10/SoatokGlitch.png?w=512&amp;ssl=1 512w, https://i0.wp.com/soatok.blog/wp-content/uploads/2023/10/SoatokGlitch.png?resize=300%2C261&amp;ssl=1 300w" sizes="(max-width: 512px) 100vw, 512px" /><figcaption class="wp-element-caption">Art by <a href="https://sfw.furaffinity.net/user/ajlovesdinos/">AJ</a></figcaption></figure></div>


<h3 class="wp-block-heading" id="vuln-ed25519">Ed25519 signatures are malleable</h3>



<p class="has-text-align-right"><strong>a.k.a. <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-45193" target="_blank" rel="noreferrer noopener">CVE-2024-45193</a></strong></p>



<p>Ed25519 libraries come in <a href="https://hdevalence.ca/blog/2020-10-04-its-25519am">various levels of quality regarding signature validation criteria</a>; much to the chagrin of cryptography engineers everywhere. One of those validation criteria involves signature malleability.</p>



<p>Signature malleability usually isn&#8217;t a big deal for most protocols, until suddenly you discover a use case where it is. If it matters, that usually that means you&#8217;re doing something with cryptocurrency.</p>



<p>Briefly, if your signatures are malleable, that means you can take an existing valid signature for a given message and public key, and generate a second valid signature for the same message. The utility of this flexibility is limited, and the impact depends a lot on how you&#8217;re using signatures and what properties you hope to get out of them.</p>



<p>For ECDSA, this means that for a given signature <img decoding="async" src="https://s0.wp.com/latex.php?latex=%28R%2C+S%29&#038;bg=0a0a0a&#038;fg=f0f0f0&#038;s=3&#038;c=20201002" alt="(R, S)" class="latex" />, a second signature <img decoding="async" src="https://s0.wp.com/latex.php?latex=%28R%2C+n+-+S%29&#038;bg=0a0a0a&#038;fg=f0f0f0&#038;s=3&#038;c=20201002" alt="(R, n - S)" class="latex" /> is also possible (where <img decoding="async" src="https://s0.wp.com/latex.php?latex=n&#038;bg=0a0a0a&#038;fg=f0f0f0&#038;s=3&#038;c=20201002" alt="n" class="latex" /> is the order of the elliptic curve group you&#8217;re working with).</p>



<p>Matrix uses Ed25519, whose malleability is demonstrated between <img decoding="async" src="https://s0.wp.com/latex.php?latex=%28R%2C+S%29&#038;bg=0a0a0a&#038;fg=f0f0f0&#038;s=3&#038;c=20201002" alt="(R, S)" class="latex" /> and <img decoding="async" src="https://s0.wp.com/latex.php?latex=%28R%2C+n+%2B+S%29&#038;bg=0a0a0a&#038;fg=f0f0f0&#038;s=3&#038;c=20201002" alt="(R, n + S)" class="latex" />. </p>



<p>This is trivially possible because S is implicitly reduced modulo the order of the curve, <img decoding="async" src="https://s0.wp.com/latex.php?latex=n&#038;bg=0a0a0a&#038;fg=f0f0f0&#038;s=3&#038;c=20201002" alt="n" class="latex" />, which is a 253-bit number (<code>0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed</code>) and S is encoded as a 256-bit number.</p>



<p>The Ed25519 library used within Olm does not ensure that <img decoding="async" src="https://s0.wp.com/latex.php?latex=S+%3C+n&#038;bg=0a0a0a&#038;fg=f0f0f0&#038;s=3&#038;c=20201002" alt="S &lt; n" class="latex" />, thus signatures are malleable. You can verify this yourself by <a href="https://gitlab.matrix.org/matrix-org/olm/-/blob/7e0c8277032e40308987257b711b38af8d77cc69/lib/ed25519/src/verify.c#L47-77" target="_blank" rel="noreferrer noopener">looking at the Ed25519 verification code</a>.</p>


<div class="wp-block-syntaxhighlighter-code dark-syntax-highlighter"><pre class="brush: cpp; auto-links: false; first-line: 47; title: ; quick-code: false; notranslate" title="">
int ed25519_verify(const unsigned char *signature, const unsigned char *message, size_t message_len, const unsigned char *public_key) {
    unsigned char h&#x5B;64];
    unsigned char checker&#x5B;32];
    sha512_context hash;
    ge_p3 A;
    ge_p2 R;

    if (signature&#x5B;63] &amp; 224) {
        return 0;
    }

    if (ge_frombytes_negate_vartime(&amp;A, public_key) != 0) {
        return 0;
    }

    sha512_init(&amp;hash);
    sha512_update(&amp;hash, signature, 32);
    sha512_update(&amp;hash, public_key, 32);
    sha512_update(&amp;hash, message, message_len);
    sha512_final(&amp;hash, h);
    
    sc_reduce(h);
    ge_double_scalarmult_vartime(&amp;R, h, &amp;A, signature + 32);
    ge_tobytes(checker, &amp;R);

    if (!consttime_equal(checker, signature)) {
        return 0;
    }

    return 1;
}
</pre></div>


<p>This is almost certainly a no-impact finding (or low-impact at worst), but still an annoying one to see in 2024.</p>



<p>If you&#8217;d like to learn more, <a href="https://slowli.github.io/ed25519-quirks/malleability/" target="_blank" rel="noreferrer noopener">this page is a fun demo of Ed25519 malleability</a>.</p>



<p>To mitigate this, I recommend implementing <a href="https://github.com/jedisct1/libsodium/blob/6e27e98777f3a6eeb233cd3280412414cead4e0d/src/libsodium/crypto_core/ed25519/ref10/ed25519_ref10.c#L1136-L1177" target="_blank" rel="noreferrer noopener">these checks from libsodium</a>.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img data-recalc-dims="1" loading="lazy" decoding="async" width="512" height="512" data-attachment-id="3102" data-permalink="https://soatok.blog/soatok-telegrams-wave-3-commission-11/" data-orig-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/04/soatok-telegrams-wave-3-commission-11.png?fit=512%2C512&amp;ssl=1" data-orig-size="512,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Soatok Telegrams Wave 3 Commission-11" data-image-description="" data-image-caption="&lt;p&gt;Clipboard Sticker&lt;/p&gt;
" data-medium-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/04/soatok-telegrams-wave-3-commission-11.png?fit=300%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/04/soatok-telegrams-wave-3-commission-11.png?fit=512%2C512&amp;ssl=1" src="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/04/soatok-telegrams-wave-3-commission-11.png?resize=512%2C512&#038;ssl=1" alt="Clipboard Sticker" class="wp-image-3102" style="width:auto;height:259px"/><figcaption class="wp-element-caption">Art: <a href="https://cmykat.carrd.co/">CMYKat</a></figcaption></figure></div>


<h3 class="wp-block-heading" id="vuln-base64">Timing leakage in base64 decoding of private key material</h3>



<p class="has-text-align-right"><strong>a.k.a. <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-45192" target="_blank" rel="noreferrer noopener">CVE-2024-45192</a></strong></p>



<p>If you weren&#8217;t already tired of cache-timing attacks based on table look-ups from AES, <a href="https://gitlab.matrix.org/matrix-org/olm/-/blob/7e0c8277032e40308987257b711b38af8d77cc69/src/base64.cpp#L119-129">the Matrix base64 code is also susceptible to the same implementation flaw</a>.</p>


<div class="wp-block-syntaxhighlighter-code dark-syntax-highlighter"><pre class="brush: cpp; auto-links: false; first-line: 119; title: ; quick-code: false; notranslate" title="">
while (pos != end) {
    unsigned value = DECODE_BASE64&#x5B;pos&#x5B;0] &amp; 0x7F];
    value &lt;&lt;= 6; value |= DECODE_BASE64&#x5B;pos&#x5B;1] &amp; 0x7F];
    value &lt;&lt;= 6; value |= DECODE_BASE64&#x5B;pos&#x5B;2] &amp; 0x7F];
    value &lt;&lt;= 6; value |= DECODE_BASE64&#x5B;pos&#x5B;3] &amp; 0x7F];
    pos += 4;
    output&#x5B;2] = value;
    value &gt;&gt;= 8; output&#x5B;1] = value;
    value &gt;&gt;= 8; output&#x5B;0] = value;
    output += 3;
}
</pre></div>


<p>The base64 decoding function in question is <a href="https://gitlab.matrix.org/matrix-org/olm/-/blob/7e0c8277032e40308987257b711b38af8d77cc69/src/inbound_group_session.c#L184">used to load the group session key</a>, which means <a href="https://arxiv.org/abs/2108.04600">the attack published in this paper almost certainly applies</a>.</p>



<h4 class="wp-block-heading">How would you mitigate this leakage?</h4>



<p>Steve Thomas (one of the judges of the Password Hashing Competition, among other noteworthy contributions) wrote some open source code a while back that <a href="https://github.com/Sc00bz/ConstTimeEncoding" target="_blank" rel="noreferrer noopener">implements base64 encoding routines in constant-time</a>.</p>



<p>The real interesting part is how it avoids a table look-up by using arithmetic (from <a href="https://github.com/Sc00bz/ConstTimeEncoding/blob/3c11bb8c8b0191980b533c8f7c16e76f69808096/base64.cpp#L26-L68" target="_blank" rel="noreferrer noopener">this file</a>):</p>


<div class="wp-block-syntaxhighlighter-code dark-syntax-highlighter"><pre class="brush: cpp; auto-links: false; first-line: 30; title: ; quick-code: false; notranslate" title="">
// Base64 character set:
// &#x5B;A-Z]      &#x5B;a-z]      &#x5B;0-9]      +     /
// 0x41-0x5a, 0x61-0x7a, 0x30-0x39, 0x2b, 0x2f

inline int base64Decode6Bits(char src)
{
	int ch  = (unsigned char) src;
	int ret = -1;

	// if (ch &gt; 0x40 &amp;&amp; ch &lt; 0x5b) ret += ch - 0x41 + 1; // -64
	ret += (((0x40 - ch) &amp; (ch - 0x5b)) &gt;&gt; 8) &amp; (ch - 64);

	// if (ch &gt; 0x60 &amp;&amp; ch &lt; 0x7b) ret += ch - 0x61 + 26 + 1; // -70
	ret += (((0x60 - ch) &amp; (ch - 0x7b)) &gt;&gt; 8) &amp; (ch - 70);

	// if (ch &gt; 0x2f &amp;&amp; ch &lt; 0x3a) ret += ch - 0x30 + 52 + 1; // 5
	ret += (((0x2f - ch) &amp; (ch - 0x3a)) &gt;&gt; 8) &amp; (ch + 5);

	// if (ch == 0x2b) ret += 62 + 1;
	ret += (((0x2a - ch) &amp; (ch - 0x2c)) &gt;&gt; 8) &amp; 63;

	// if (ch == 0x2f) ret += 63 + 1;
	ret += (((0x2e - ch) &amp; (ch - 0x30)) &gt;&gt; 8) &amp; 64;

	return ret;
}
</pre></div>


<p>Any C library that handles base64 codecs for private key material should use a similar implementation. It&#8217;s fine to have a faster base64 implementation for non-secret data.</p>



<p>Worth noting: <a href="https://github.com/jedisct1/libsodium/blob/master/src/libsodium/sodium/codecs.c" target="_blank" rel="noreferrer noopener">Libsodium also provides a reasonable Base64 codec</a>.</p>



<h2 class="wp-block-heading" id="user-recommendations">Recommendations</h2>



<p>These issues are not fixed in libolm.</p>



<p>Instead of fixing libolm, the Matrix team recommends all Matrix clients adopt vodozemac.</p>



<p>I can&#8217;t speak to the security of vodozemac.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img data-recalc-dims="1" loading="lazy" decoding="async" width="512" height="512" data-attachment-id="4555" data-permalink="https://soatok.blog/soatok_stickerpack-idk/" data-orig-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/11/soatok_stickerpack-idk.png?fit=512%2C512&amp;ssl=1" data-orig-size="512,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="soatok_stickerpack-idk" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/11/soatok_stickerpack-idk.png?fit=300%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/11/soatok_stickerpack-idk.png?fit=512%2C512&amp;ssl=1" src="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/11/soatok_stickerpack-idk.png?resize=512%2C512&#038;ssl=1" alt="" class="wp-image-4555" style="width:auto;height:256px"/><figcaption class="wp-element-caption">Art: <a href="https://cmykat.carrd.co/">CMYKat</a></figcaption></figure></div>


<p>But I can speak against the security of libolm, so moving to vodozemac is <em>probably</em> a good idea. <a href="https://leastauthority.com/blog/audits/audit-of-matrix-vodozemac/">It was audited by Least Authority at one point</a>, so it&#8217;s probably fine.</p>



<p>Most Matrix clients that still depended on libolm should treat this blog as public 0day, unless the Matrix security team already notified you about these issues.</p>



<h2 class="wp-block-heading" id="background-information">Background Information</h2>



<blockquote class="wp-block-quote quote-soatok is-layout-flow wp-block-quote-is-layout-flow">
<p>If you&#8217;re curious about the backstory and context of these findings, read on.</p>



<p>Otherwise, feel free to skip this section. It&#8217;s not pertinent to most audiences. The people that need to read it already know who they are.</p>
</blockquote>



<p>End-to-end encryption is one of the topics within cryptography that I find myself often writing about.</p>



<p>In 2020, I wrote <a href="https://soatok.blog/2020/11/14/going-bark-a-furrys-guide-to-end-to-end-encryption/">a blog post covering end-to-end encryption for application developers</a>. This was published several months after another blog I wrote covering gripes with AES-GCM, which included <a href="https://soatok.blog/2020/05/13/why-aes-gcm-sucks/#aes-signal-protocol">a shallow analysis of how Signal uses the algorithm for local storage</a>.</p>



<p>In 2021, I published <a href="https://soatok.blog/2021/11/05/threema-three-strikes-youre-out/">weaknesses in another so-called private messaging app called Threema</a>. </p>



<p>In 2022, after Elon Musk took over Twitter, I joined the Fediverse and <a href="https://github.com/soatok/mastodon-e2ee-specification">sought to build end-to-end encryption support for direct messages into ActivityPub, starting with a specification</a>. Work on this effort was stalled while <a href="https://soatok.blog/2022/11/22/towards-end-to-end-encryption-for-direct-messages-in-the-fediverse/">trying to solve Public Key distribution in a federated environment</a> (which I hope to pick up soon, but I digress).</p>



<p>Earlier this year, the Telegram CEO started fearmongering about Signal with assistance from Elon Musk, so I wrote a blog post <a href="https://soatok.blog/2024/05/14/its-time-for-furries-to-stop-using-telegram/">urging the furry fandom to move away from Telegram and start using Signal more</a>. As I had demonstrated years prior, I was familiar with Signal&#8217;s code and felt it was a good recommendation for security purposes (even if its user experience needs significant work).</p>



<p>I thought that would be a nice, self-contained blog post. Some might listen, most would ignore it, but I could move on with my life.</p>



<h3 class="wp-block-heading">I was mistaken about that last point.</h3>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img data-recalc-dims="1" loading="lazy" decoding="async" width="512" height="376" data-attachment-id="10278" data-permalink="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/soatoknerdrage/" data-orig-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/08/SoatokNerdRage.png?fit=512%2C376&amp;ssl=1" data-orig-size="512,376" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="SoatokNerdRage" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/08/SoatokNerdRage.png?fit=300%2C220&amp;ssl=1" data-large-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/08/SoatokNerdRage.png?fit=512%2C376&amp;ssl=1" src="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/08/SoatokNerdRage.png?resize=512%2C376&#038;ssl=1" alt="Soatok angrily grabbing his computer monitor and shouting" class="wp-image-10278" style="width:256px" srcset="https://i0.wp.com/soatok.blog/wp-content/uploads/2024/08/SoatokNerdRage.png?w=512&amp;ssl=1 512w, https://i0.wp.com/soatok.blog/wp-content/uploads/2024/08/SoatokNerdRage.png?resize=300%2C220&amp;ssl=1 300w" sizes="auto, (max-width: 512px) 100vw, 512px" /><figcaption class="wp-element-caption">Art by <a href="https://sfw.furaffinity.net/user/ajlovesdinos/">AJ</a></figcaption></figure></div>


<p>An overwhelming number of people took it upon themselves to recommend or inquire about Matrix, which prompted me to hastily scribble down <a href="https://web.archive.org/web/20240606031827/https://gist.github.com/soatok/8aef6f67fec9c702f510ee24d19ef92b" target="_blank" rel="noreferrer noopener">my opinion on Matrix</a> so that I might copy/paste a link around and save myself a lot of headache.</p>



<p>Just when I thought the firehose was manageable and I could move onto other topics, one of the Matrix developers responded to my opinion post.</p>



<p>Thus, I decided to briefly look at their source code and see if any major or obvious cryptography issues would fall out of a shallow visual scan.</p>



<p>Since you&#8217;re reading this post, you already know how that ended.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img data-recalc-dims="1" loading="lazy" decoding="async" width="512" height="512" data-attachment-id="70" data-permalink="https://soatok.blog/soatok_stickerpack-hacker/" data-orig-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2020/04/soatok_stickerpack-hacker.png?fit=512%2C512&amp;ssl=1" data-orig-size="512,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="soatok_stickerpack-hacker" data-image-description="&lt;p&gt;Hackerman Sticker&lt;/p&gt;
" data-image-caption="" data-medium-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2020/04/soatok_stickerpack-hacker.png?fit=300%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2020/04/soatok_stickerpack-hacker.png?fit=512%2C512&amp;ssl=1" src="https://i0.wp.com/soatok.blog/wp-content/uploads/2020/04/soatok_stickerpack-hacker.png?resize=512%2C512&#038;ssl=1" alt="" class="wp-image-70" style="width:256px;height:auto"/><figcaption class="wp-element-caption">Credit: <a href="https://cmykat.carrd.co/">CMYKat</a></figcaption></figure></div>


<p>Since the first draft of this blog post was penned, I also outlined what I mean <a href="https://soatok.blog/2024/07/31/what-does-it-mean-to-be-a-signal-competitor/">when I say an encrypted messaging app is a Signal competitor or not</a>, and published <a href="https://soatok.blog/2024/08/04/against-xmppomemo/">my opinion on XMPP+OMEMO</a> (which people also recommend for private messaging).</p>



<h3 class="wp-block-heading">Why mention all this?</h3>



<p>Because it&#8217;s important to know that I have not audited the Olm or Megolm codebases, nor even <em>glanced at</em> their new Rust codebase.</p>



<p>The fact is, I never intended to study Matrix. I was <em>annoyed</em> into looking at it in the first place.</p>



<p>My opinion of their project was already calcified by the previously discovered <a href="https://nebuchadnezzar-megolm.github.io/">practically-exploitable cryptographic vulnerabilities in Matrix</a> in 2022.</p>



<p>The bugs described above are the sort of thing I mentally scan for when I first look at a project <em>just to get a feel for the maturity of the codebase</em>. I do this with the expectation (hope, really) of not finding anything at all.</p>



<p>(If you want two specific projects that I&#8217;ve subjected to a similar treatment, and failed to discover anything interesting in: <a href="https://signal.org/">Signal</a> and <a href="https://www.wireguard.com/">WireGuard</a>. These two set the bar for cryptographic designs.)</p>



<p>It&#8217;s absolutely bonkers that an AES cache timing vulnerability was present in their code in 2024. </p>



<blockquote class="wp-block-quote quote-soatok is-layout-flow wp-block-quote-is-layout-flow">
<p>It&#8217;s even worse when you remember that I was inundated with Matrix evangelism in response to recommending furries use Signal. </p>



<p>I&#8217;m a little outraged because of how irresponsible this is, in context.</p>
</blockquote>



<p>It&#8217;s so bad that I didn&#8217;t even need to clone their git repository, let alone run basic static analysis tools locally. </p>



<p>So if you take nothing else away from this blog post, let it be this:</p>



<p><strong>There is roughly a 0% chance</strong> that I got extremely lucky in my mental <code>grep</code> and found the only cryptography implementation flaws in their source code. I barely tried at all and found these issues.</p>



<p>I would bet money on there being more bugs or design flaws that I <strong>didn&#8217;t</strong> find, because this discovery was the result of an extremely half-assed effort to blow off steam.</p>



<h3 class="wp-block-heading" id="vodozemac">Wasn&#8217;t libolm deprecated in May 2022?</h3>



<p>The Matrix developers like to insist that their new Rust hotness &#8220;vodozemac&#8221; is what people should be using today. </p>



<p>I haven&#8217;t looked at vodozemac at all, but let&#8217;s pretend, for the sake of argument, that its cryptography is actually secure. </p>



<p>(This is very likely if they turn out to be using RustCrypto for their primitives, but I don&#8217;t have the time or energy for that nerd snipe, so I&#8217;m not going to look. <em>Least Authority</em> did <a href="https://matrix.org/media/Least%20Authority%20-%20Matrix%20vodozemac%20Final%20Audit%20Report.pdf" target="_blank" rel="noreferrer noopener">audit their Rust library</a>, for what it&#8217;s worth, and Least Authority isn&#8217;t clownshoes.)</p>



<p>It&#8217;s been more than 2 years since they released vodozemac. What does the ecosystem penetration for this new library look like, in practice?</p>



<p>A quick survey of <a href="https://github.com/topics/matrix-client">the various Matrix clients on GitHub</a> says that libolm is still the most widely used cryptography implementation in the Matrix ecosystem (as of this writing):</p>



<figure class="wp-block-table"><table class="has-fixed-layout"><thead><tr><th><strong>Matrix Client</strong></th><th><strong>Cryptography Backend</strong></th></tr></thead><tbody><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/tulir/gomuks">https://github.com/tulir/gomuks</a></td><td><strong>libolm</strong> (<a rel="nofollow noopener" target="_blank" href="https://github.com/tulir/gomuks/blob/a4911282419bee6d3dbe06037f075736a9e67855/go.mod#L28C16-L28C24">1</a>, <a rel="nofollow noopener" target="_blank" href="https://github.com/mautrix/go/tree/85e0664cb441058513549a6e1e198f073bca9af4/crypto/olm">2</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/niochat/nio">https://github.com/niochat/nio</a></td><td><strong>libolm</strong> (<a rel="nofollow noopener" target="_blank" href="https://github.com/niochat/nio/blob/96c303e38794dfa229cb5077bd68cd4abeb6f4c7/Nio.xcodeproj/project.xcworkspace/xcshareddata/swiftpm/Package.resolved#L41-L47">1</a>, <a rel="nofollow noopener" target="_blank" href="https://github.com/matrix-org/matrix-ios-sdk/blob/1c4b3f5c32ed3bcf27d3404c770e000a50417352/Podfile#L14">2</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/ulyssa/iamb">https://github.com/ulyssa/iamb</a></td><td><strong>vodozemac</strong> (<a rel="nofollow noopener" target="_blank" href="https://github.com/ulyssa/iamb/blob/497be7f0998d850e123362aa0ac2f8fdb8362066/Cargo.toml#L76-L79">1</a>, <a rel="nofollow noopener" target="_blank" href="https://github.com/matrix-org/matrix-rust-sdk/blob/03e1fd78a699712c0c95591c5cfad61b43d113ff/Cargo.toml#L78">2</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/mirukana/mirage">https://github.com/mirukana/mirage</a></td><td><strong>libolm</strong> (<a rel="nofollow noopener" target="_blank" href="https://github.com/mirukana/mirage/blob/9a4ababd9aa59bd78ad239422918c2c4eaaf6b7d/docs/INSTALL.md#package-manager-dependencies">1</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/Pony-House/Client">https://github.com/Pony-House/Client</a></td><td><strong>libolm</strong> (<a rel="nofollow noopener" target="_blank" href="https://github.com/Pony-House/Client/blob/6af557e43684e4ab6699a21beb610801c12fbe84/package.json#L48">1</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/MTRNord/cetirizine">https://github.com/MTRNord/cetirizine</a></td><td><strong>vodozemac</strong> (<a href="https://github.com/MTRNord/cetirizine/blob/cb4e6a18b388553295e660fd6f6c167d5bd96bc0/package.json#L8" target="_blank" rel="noreferrer noopener nofollow">1</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/nadams/go-matrixcli">https://github.com/nadams/go-matrixcli</a></td><td><em>none</em></td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/mustang-im/mustang">https://github.com/mustang-im/mustang</a></td><td><strong>libolm</strong> (<a rel="nofollow noopener" target="_blank" href="https://github.com/mustang-im/mustang/blob/9b3fd73a6b4c3e219e2634ad804d8e388d0bc259/app/package.json#L48">1</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/marekvospel/libretrix">https://github.com/marekvospel/libretrix</a></td><td><strong>libolm</strong> (<a rel="nofollow noopener" target="_blank" href="https://github.com/marekvospel/libretrix/blob/62db1f05386d9a87e94e2664dd531ea2e9d47af3/services/frontend/package.json#L21">1</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/yusdacra/icy_matrix">https://github.com/yusdacra/icy_matrix</a></td><td><em>none</em></td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/ierho/element">https://github.com/ierho/element</a></td><td><strong>libolm</strong> (through <a rel="nofollow noopener" target="_blank" href="https://github.com/matrix-org/matrix-python-sdk/blob/887f5d55e16518a0a2bef4f2d6bff6ecf48d18c1/matrix_client/crypto/olm_device.py">the python SDK</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/mtorials/cordless">https://github.com/mtorials/cordless</a></td><td><em>none</em></td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/hwipl/nuqql-matrixd">https://github.com/hwipl/nuqql-matrixd</a></td><td><strong>libolm</strong> (through <a rel="nofollow noopener" target="_blank" href="https://github.com/matrix-org/matrix-python-sdk/blob/887f5d55e16518a0a2bef4f2d6bff6ecf48d18c1/matrix_client/crypto/olm_device.py">the python SDK</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/maxkratz/element-web">https://github.com/maxkratz/element-web</a></td><td><strong>vodozemac</strong> (<a rel="nofollow noopener" target="_blank" href="https://github.com/maxkratz/element-web/blob/faa602d73af40b0af456c897c0ce5900e17425d0/package.json#L77">1</a>, <a rel="nofollow noopener" target="_blank" href="https://github.com/matrix-org/matrix-js-sdk/blob/develop/package.json#L56C10-L56C44">2</a>, <a rel="nofollow noopener" target="_blank" href="https://github.com/matrix-org/matrix-rust-sdk-crypto-wasm/blob/3ecc63bb5dcac5638b2b2edde8a1d607213d651f/Cargo.toml#L62">3</a>, <a rel="nofollow noopener" target="_blank" href="https://github.com/matrix-org/matrix-rust-sdk/blob/03e1fd78a699712c0c95591c5cfad61b43d113ff/Cargo.toml#L78">4</a>)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/asozialesnetzwerk/riot">https://github.com/asozialesnetzwerk/riot</a></td><td><strong>libolm</strong> (wasm file)</td></tr><tr><td><a rel="nofollow noopener" target="_blank" href="https://github.com/NotAlexNoyle/Versi">https://github.com/NotAlexNoyle/Versi</a></td><td><strong>libolm</strong> (<a rel="nofollow noopener" target="_blank" href="https://github.com/NotAlexNoyle/Versi/blob/314611d6968a06aa40267d8bf65f5a30e950bbd0/package.json#L45">1</a>, <a rel="nofollow noopener" target="_blank" href="https://github.com/matrix-org/matrix-js-sdk/blob/7d45947fb3dc4b0e291e03adac5348ad8eeaf32a/package.json#L84">2</a>)</td></tr></tbody></table></figure>



<p>3 of the 16 clients surveyed use the new vodozemac library. 10 still use libolm, and 3 don&#8217;t appear to implement end-to-end encryption at all.</p>



<p>If we only focus on clients that support E2EE, vodozemac has successfully been adopted by 19% of the open source Matrix clients on GitHub.</p>



<p>I deliberately excluded any repositories that were archived or clearly marked as &#8220;old&#8221; or &#8220;legacy&#8221; software, because including those would artificially inflate the representation of libolm. It would make for a more compelling narrative to do so, but I&#8217;m not trying to be persuasive here.</p>



<p><strong>Deprecation policies are a beautiful lie.</strong> The impact of a vulnerability in Olm or Megolm is still far-reaching, and should be taken seriously by the Matrix community.</p>



<blockquote class="wp-block-quote quote-soatok is-layout-flow wp-block-quote-is-layout-flow">
<p>Worth calling out: this quick survey, which is based on a GitHub Topic, certainly misses other implementations. Both <a href="https://github.com/krille-chan/fluffychat/blob/e5bbb755d99c54ec051d66c9cdbf37b2f8568e18/pubspec.yaml#L44" target="_blank" rel="noreferrer noopener">FluffyChat</a> and <a href="https://github.com/cinnyapp/cinny/blob/e54bb2e42377c49e7179f6b59669592186281eff/package.json#L27" target="_blank" rel="noreferrer noopener">Cinny</a>, which were not tagged with this GitHub Topic, depend a language-specific Olm binding.</p>



<p>These bindings in turn <a href="https://github.com/matrix-org/matrix-js-sdk/blob/bddf2b96824cd6b438531b8b1781f1500cb71eb8/package.json#L82">wrap libolm</a> rather than the Rust replacement, vodozemac.</p>
</blockquote>



<h4 class="wp-block-heading">But the official clients&#8230;</h4>



<p>I thought the whole point of choosing Matrix over something like Signal is to be federated, and run your own third-party clients?</p>



<p>If we&#8217;re going to insist that everyone should be using Element if they want to be secure, that defeats the entire marketing point about third-party clients that Matrix evangelists cite when they decry Signal&#8217;s centralization.</p>



<p>So I <em>really</em> don&#8217;t want to hear it.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img data-recalc-dims="1" loading="lazy" decoding="async" width="512" height="512" data-attachment-id="1204" data-permalink="https://soatok.blog/soatoktelegrams2020-04/" data-orig-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2020/08/soatoktelegrams2020-04.png?fit=512%2C512&amp;ssl=1" data-orig-size="512,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="SoatokTelegrams2020-04" data-image-description="" data-image-caption="&lt;p&gt;NO sticker&lt;/p&gt;
" data-medium-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2020/08/soatoktelegrams2020-04.png?fit=300%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2020/08/soatoktelegrams2020-04.png?fit=512%2C512&amp;ssl=1" src="https://i0.wp.com/soatok.blog/wp-content/uploads/2020/08/soatoktelegrams2020-04.png?resize=512%2C512&#038;ssl=1" alt="NO sticker" class="wp-image-1204" style="width:auto;height:256px"/><figcaption class="wp-element-caption"><a href="https://cmykat.carrd.co/">CMYKat</a></figcaption></figure></div>


<h2 class="wp-block-heading" id="interesting-non-issue">An Interesting Non-Issue That Looked Critical</h2>



<p>As I mentioned in the timeline at the top, I thought I found a fourth issue with Matrix&#8217;s codebase. Had I been correct, this would have been a critical severity finding that the entire Matrix ecosystem would need to melt down to remediate.</p>



<p><strong>Fortunately for everyone, I made a mistake, and there is no fourth vulnerability after all.</strong></p>



<p>However, I thought it would be interesting to write about what I <em>thought</em> I found, the impact it would have had if it were real, and why I believed it to be an issue.</p>



<p>Let&#8217;s start with <a href="https://gitlab.matrix.org/matrix-org/olm/-/blob/7e0c8277032e40308987257b711b38af8d77cc69/lib/ed25519/src/sign.c#L7-31">the code in question</a>:</p>


<div class="wp-block-syntaxhighlighter-code dark-syntax-highlighter"><pre class="brush: cpp; auto-links: false; first-line: 7; highlight: [15]; title: ; quick-code: false; notranslate" title="">
void ed25519_sign(unsigned char *signature, const unsigned char *message, size_t message_len, const unsigned char *public_key, const unsigned char *private_key) {
    sha512_context hash;
    unsigned char hram&#x5B;64];
    unsigned char r&#x5B;64];
    ge_p3 R;


    sha512_init(&amp;hash);
    sha512_update(&amp;hash, private_key + 32, 32);
    sha512_update(&amp;hash, message, message_len);
    sha512_final(&amp;hash, r);

    sc_reduce(r);
    ge_scalarmult_base(&amp;R, r);
    ge_p3_tobytes(signature, &amp;R);

    sha512_init(&amp;hash);
    sha512_update(&amp;hash, signature, 32);
    sha512_update(&amp;hash, public_key, 32);
    sha512_update(&amp;hash, message, message_len);
    sha512_final(&amp;hash, hram);

    sc_reduce(hram);
    sc_muladd(signature + 32, hram, private_key, r);
}
</pre></div>


<p>The highlighted segment is doing pointer arithmetic. This means it&#8217;s reading 32 bytes, starting from the 32nd byte in <code>private_key</code>.</p>



<p>What&#8217;s actually happening here is: <code>private_key</code> is the SHA512 hash of a 256-bit seed. If you look at the function prototype, you&#8217;ll notice that <code>public_key</code> is a separate input.</p>



<p>Virtually every other Ed25519 implementation I&#8217;ve ever looked at before expected users to provide a 32 byte seed followed by the public key as a single input. </p>



<p>This led me to believe that this <code>private_key + 32</code> pointer arithmetic was actually using the <strong>public key</strong> for calculating <code>r</code>.</p>



<p>The variable <code>r</code> (not to be confused with big R) generated via the first SHA512 is the nonce for a given signature, it must remain secret for Ed25519 to remain secure. </p>



<p>If <code>r</code> is known to an attacker, you can do some arithmetic to recover the secret key from a single signature.</p>



<p>Because I had mistakenly believed that <code>r</code> was calculated from the SHA512 of only public inputs (the public key and message), <em>which I must emphasize isn&#8217;t correct</em>, I had falsely concluded that any previously intercepted signature could be used to steal user&#8217;s private keys.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img data-recalc-dims="1" loading="lazy" decoding="async" width="512" height="512" data-attachment-id="3100" data-permalink="https://soatok.blog/soatoktelegramswave3-10/" data-orig-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/04/soatoktelegramswave3-10.png?fit=512%2C512&amp;ssl=1" data-orig-size="512,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="SoatokTelegramsWave3-10" data-image-description="" data-image-caption="&lt;p&gt;Blue Screen of Death Sticker&lt;/p&gt;
" data-medium-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/04/soatoktelegramswave3-10.png?fit=300%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/04/soatoktelegramswave3-10.png?fit=512%2C512&amp;ssl=1" src="https://i0.wp.com/soatok.blog/wp-content/uploads/2021/04/soatoktelegramswave3-10.png?resize=512%2C512&#038;ssl=1" alt="Blue Screen of Death Sticker" class="wp-image-3100" style="width:auto;height:256px"/><figcaption class="wp-element-caption">Credit: <a href="https://cmykat.carrd.co/">CMYKat</a></figcaption></figure></div>


<p>But because <code>private_key</code> was actually the full SHA512 hash of the seed, rather than the seed concatenated with the public key, this pointer arithmetic did <strong>NOT</strong> use the public key for the calculation of <code>r</code>, so this vulnerability does not exist.</p>



<p>If the code did what I thought it did, however, this would have been a complete fucking disaster for the Matrix ecosystem. Any previously intercepted message would have allowed an attacker to recover a user&#8217;s secret key and impersonate them. It wouldn&#8217;t be enough to fix the code; every key in the ecosystem would need to be revoked and rotated.</p>



<p>Whew!</p>



<p>I&#8217;m happy to be wrong about this one, because that outcome is a headache nobody wants.</p>



<h4 class="wp-block-heading" id="wycheproof">So no action is needed, right?</h4>



<p>Well, maybe.</p>



<p>Matrix&#8217;s library was not vulnerable, but I honestly wouldn&#8217;t put it past software developers at large to somehow, somewhere, use the public key (rather than a secret value) to calculate the EdDSA signature nonces as described in the previous section.</p>



<p>To that end, I would like to propose a test vector be added to <a href="https://github.com/C2SP/wycheproof" target="_blank" rel="noreferrer noopener">the Wycheproof test suite</a> to catch any EdDSA implementation that misuses the public key in this way. </p>



<p>Then, if someone else screws up their Ed25519 implementation in the exact way I thought Matrix was, the Wycheproof tests will catch it.</p>



<p>For example, here&#8217;s a vulnerable test input for Ed25519:</p>


<div class="wp-block-syntaxhighlighter-code dark-syntax-highlighter"><pre class="brush: jscript; auto-links: false; gutter: false; title: ; quick-code: false; notranslate" title="">
{
    &quot;should-fail&quot;:
        true,
    &quot;secret-key&quot;:
        &quot;d1d0ef849f9ec88b4713878442aeebca5c7a43e18883265f7f864a8eaaa56c1ef3dbb3b71132206b81f0f3782c8df417524463d2daa8a7c458775c9af725b3fd&quot;,
    &quot;public-key&quot;:
        &quot;f3dbb3b71132206b81f0f3782c8df417524463d2daa8a7c458775c9af725b3fd&quot;,
    &quot;message&quot;:
        &quot;Test message&quot;,
    &quot;signature&quot;:
        &quot;ffc39da0ce356efb49eb0c08ed0d48a1cadddf17e34f921a8d2732a33b980f4ae32d6f5937a5ed25e03a998e4c4f5910c931b31416e143965e6ce85b0ea93c09&quot;
}
</pre></div>


<p>A similar test vector would also be worth creating for Ed448, but the only real users of Ed448 were <a href="https://github.com/amlweems/xzbot?tab=readme-ov-file#ed448-patch" target="_blank" rel="noreferrer noopener">the authors of the xz backdoor</a>, so I didn&#8217;t bother with that.</p>



<p>(None of the Project Wycheproof maintainers knew this suggestion is coming, by the way, because I was respecting the terms of the coordinated disclosure.)</p>



<h2 class="wp-block-heading">Closing Thoughts</h2>



<p>Despite finding cryptography implementation flaws in Matric&#8217;s Olm library, my personal opinion on Matrix remains largely unchanged from 2022. I had already <a href="https://web.archive.org/web/20240606031827/https://gist.github.com/soatok/8aef6f67fec9c702f510ee24d19ef92b">assumed it would not meet my bar for security</a>.</p>



<p>Cryptography engineering is difficult because the vulnerabilities you&#8217;re usually dealing with are extremely subtle. (<a href="https://www.bolet.org/~pornin/2005-acns-pornin+stern.pdf">Here&#8217;s an unrelated example</a> if you&#8217;re not convinced of this general observation.) As SwiftOnSecurity once wrote:</p>



<figure class="wp-block-embed aligncenter is-type-rich is-provider-twitter wp-block-embed-twitter"><div class="wp-block-embed__wrapper">
<blockquote class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Should math care what kind of pen you use to implement it? No, but Fuck You, this is Cryptography.</p>&mdash; SwiftOnSecurity (@SwiftOnSecurity) <a href="https://twitter.com/SwiftOnSecurity/status/832058185049579524?ref_src=twsrc%5Etfw">February 16, 2017</a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div><figcaption class="wp-element-caption"><a href="https://soatok.blog/wp-content/uploads/2024/07/SwiftOnSecurity-Nightmare-Magic-Math-Cryptography.pdf" target="_blank" rel="noreferrer noopener">Archived</a></figcaption></figure>



<p>The people that developed Olm and Megolm has not proven themselves ready to build a Signal competitor. In balance, most teams are not qualified to do so.</p>



<p>I really wish the Matrix evangelists would accept this and stop trying to cram Matrix down other people&#8217;s throats when they&#8217;re talking about problems with <em>other</em> platforms entirely.</p>



<blockquote class="wp-block-quote quote-soatok is-layout-flow wp-block-quote-is-layout-flow">
<p>More important for the communities of messaging apps:</p>



<p>You don&#8217;t <em>need</em> to be a Signal competitor. Having E2EE is <a href="https://soatok.blog/2020/11/14/going-bark-a-furrys-guide-to-end-to-end-encryption/">a good thing on its own merits</a>, and really should be table stakes for any social application in 2024.</p>



<p>It&#8217;s only when people try to advertise their apps as <a href="https://soatok.blog/2024/07/31/what-does-it-mean-to-be-a-signal-competitor/" target="_blank" rel="noreferrer noopener">a Signal alternative (or try to recommend it instead of Signal)</a>, and offer less security, that I take offense.</p>



<p>Just be your own thing.</p>



<p>My work-in-progress <a href="https://soatok.blog/2022/11/22/towards-end-to-end-encryption-for-direct-messages-in-the-fediverse/" target="_blank" rel="noreferrer noopener">proposal to bring end-to-end encryption to the Fediverse</a> doesn&#8217;t aim to compete with Signal. It&#8217;s just meant to improve privacy, which is a good thing to do on its own merits.</p>
</blockquote>



<p>If I never hear <a href="https://web.archive.org/web/20240731062107/https://pawb.social/post/9842375" target="_blank" rel="noreferrer noopener">Matrix evangelism</a> again after today, it would be far too soon.</p>



<p>If anyone feels like I&#8217;m picking on Matrix, don&#8217;t worry: I have <em>far</em> worse things to say about <a href="https://words.filippo.io/dispatches/telegram-ecdh/" target="_blank" rel="noreferrer noopener">Telegram</a>, <a href="https://soatok.blog/2021/11/05/threema-three-strikes-youre-out/">Threema</a>, <a href="https://soatok.blog/2024/08/04/against-xmppomemo/">XMPP+OMEMO</a>, <a href="https://github.com/TokTok/c-toxcore/issues/426" target="_blank" rel="noreferrer noopener">Tox</a>, and a myriad other projects that are hungry for Signal&#8217;s market share but don&#8217;t measure up from a cryptographic security perspective.</p>



<p>If Signal fucked up as bad as these projects, my criticism of Signal would be equally harsh. (And remember, <a href="https://soatok.blog/2020/05/13/why-aes-gcm-sucks/#aes-signal-protocol">I have looked at Signal before</a>.)</p>



<h2 class="wp-block-heading" id="addendum-2024-08-14">Addendum (2024-08-14)</h2>



<p>One of the lead Matrix devs <a href="https://news.ycombinator.com/item?id=41249371">posted a comment on Hacker News</a> after this blog post went live that I will duplicate here:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>the author literally picked random projects from github tagged as matrix, without considering their prevalence or whether they are actually maintained etc.</p>



<p>if you actually look at % of impacted clients, it’s tiny.</p>



<p>meanwhile, it is&nbsp;<em>very</em>&nbsp;unclear that any sidechannel attack on a libolm based client is practical over the network (which is why we didn’t fix this years ago). After all, the limited primitives are commented on in the readme and&nbsp;<a href="https://github.com/matrix-org/olm/issues/3">https://github.com/matrix-org/olm/issues/3</a>&nbsp;since day 1.</p>
</blockquote>



<p>So the Matrix developers already knew about these vulnerabilities, but deliberately didn&#8217;t fix them, for years.</p>



<p>Congratulations, you&#8217;ve changed my stance. It used to be &#8220;I don&#8217;t consider Matrix a Signal alternative and they&#8217;ve had some embarrassing and impactful crypto bugs but otherwise I don&#8217;t care&#8221;. Now it&#8217;s a stronger stance:</p>



<p><strong>Don&#8217;t use Matrix.</strong></p>



<p>I had incorrectly assumed ignorance, when it was in fact negligence.</p>



<p>There&#8217;s no reasonable world in which anyone should trust the developers of cryptographic software (i.e., libolm) that deliberately ships with side-channels for years, knowing they&#8217;re present, and never bother to fix them.</p>



<p>This is fucking clownshoes.</p>



<p></p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
		<div class="post-meta-wrapper post-meta-single post-meta-single-bottom">

			<ul class="post-meta">

									<li class="post-tags meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								Tags							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="" d="M15.4496399,8.42490555 L8.66109799,1.63636364 L1.63636364,1.63636364 L1.63636364,8.66081885 L8.42522727,15.44178 C8.57869221,15.5954158 8.78693789,15.6817418 9.00409091,15.6817418 C9.22124393,15.6817418 9.42948961,15.5954158 9.58327627,15.4414581 L15.4486339,9.57610048 C15.7651495,9.25692435 15.7649133,8.74206554 15.4496399,8.42490555 Z M16.6084423,10.7304545 L10.7406818,16.59822 C10.280287,17.0591273 9.65554997,17.3181054 9.00409091,17.3181054 C8.35263185,17.3181054 7.72789481,17.0591273 7.26815877,16.5988788 L0.239976954,9.57887876 C0.0863319284,9.4254126 0,9.21716044 0,9 L0,0.818181818 C0,0.366312477 0.366312477,0 0.818181818,0 L9,0 C9.21699531,0 9.42510306,0.0862010512 9.57854191,0.239639906 L16.6084423,7.26954545 C17.5601275,8.22691012 17.5601275,9.77308988 16.6084423,10.7304545 Z M5,6 C4.44771525,6 4,5.55228475 4,5 C4,4.44771525 4.44771525,4 5,4 C5.55228475,4 6,4.44771525 6,5 C6,5.55228475 5.55228475,6 5,6 Z" /></svg>						</span>
						<span class="meta-text">
							<a href="https://soatok.blog/tag/crypto/" rel="tag">crypto</a>, <a href="https://soatok.blog/tag/cryptography/" rel="tag">cryptography</a>, <a href="https://soatok.blog/tag/end-to-end-encryption/" rel="tag">end-to-end encryption</a>, <a href="https://soatok.blog/tag/matrix/" rel="tag">Matrix</a>, <a href="https://soatok.blog/tag/side-channels/" rel="tag">side-channels</a>, <a href="https://soatok.blog/tag/vulnerability/" rel="tag">vuln</a>						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		<div class="author-bio">
	<div class="author-title-wrapper">
		<div class="author-avatar vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/146676f54771c654ed4b7e59e7513974?s=160&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/146676f54771c654ed4b7e59e7513974?s=320&#038;d=identicon&#038;r=g 2x' class='avatar avatar-160 photo' height='160' width='160' loading='lazy' decoding='async'/>		</div>
		<h2 class="author-title heading-size-4">
			By Soatok		</h2>
	</div><!-- .author-name -->
	<div class="author-description">
		<p>Security engineer with a fursona. Ask me about dholes or Diffie-Hellman!</p>
		<a class="author-link" href="https://soatok.blog/author/soatok/" rel="author">
			View Archive <span aria-hidden="true">&rarr;</span>		</a>
	</div><!-- .author-description -->
</div><!-- .author-bio -->
	
	</div><!-- .section-inner -->

	
	<nav class="pagination-single section-inner" aria-label="Post" role="navigation">

		<hr class="styled-separator is-style-wide" aria-hidden="true" />

		<div class="pagination-single-inner">

			
				<a class="previous-post" href="https://soatok.blog/2024/08/04/against-xmppomemo/">
					<span class="arrow" aria-hidden="true">&larr;</span>
					<span class="title"><span class="title-inner">Against XMPP+OMEMO</span></span>
				</a>

				
				<a class="next-post" href="https://soatok.blog/2024/08/21/federated-key-transparency-project-update/">
					<span class="arrow" aria-hidden="true">&rarr;</span>
						<span class="title"><span class="title-inner">Federated Key Transparency Project Update</span></span>
				</a>
				
		</div><!-- .pagination-single-inner -->

		<hr class="styled-separator is-style-wide" aria-hidden="true" />

	</nav><!-- .pagination-single -->

	
		<div class="comments-wrapper section-inner">

			
	<div class="comments" id="comments">

		
		<div class="comments-header section-inner small max-percentage">

			<h2 class="comment-reply-title">
			5 replies on &ldquo;Security Issues in Matrix&#8217;s Olm Library&rdquo;			</h2><!-- .comments-title -->

		</div><!-- .comments-header -->

		<div class="comments-inner section-inner thin max-percentage">

						<div id="comment-5547" class="comment even thread-even depth-1 activitypub-comment">
				<article id="div-comment-5547" class="comment-body">
					<footer class="comment-meta">
						<div class="comment-author vcard">
							<a href="https://mastodon.guerilla.studio/@tixie" rel="external nofollow" class="url"><img alt='' src='https://guerillastudio.files.fedi.monster/accounts/avatars/109/643/118/455/372/150/original/470945f888a98613.jpeg' class='avatar avatar-120 photo avatar-default avatar-activitypub u-photo' height='120' width='120' loading='lazy' /><span class="fn">Tixie Salander</span><span class="screen-reader-text says">says:</span></a>						</div><!-- .comment-author -->

						<div class="comment-metadata">
							<a href="https://mastodon.guerilla.studio/@tixie/112961278182263810"><time datetime="2024-08-14T12:18:37-04:00">August 14, 2024 at 12:18 pm</time></a>						</div><!-- .comment-metadata -->

					</footer><!-- .comment-meta -->

					<div class="comment-content entry-content">

						<p><a href="https://soatok.blog/author/soatok/" rel="ugc">@soatok</a> thank you for your clear post and transparency! 🩷 </p>
<p>(and people who have complaints about the furryitude if your blog can go…turn off their computer 🙄)</p>

					</div><!-- .comment-content -->

					
				</article><!-- .comment-body -->

			</div><!-- #comment-## -->
			<div id="comment-5548" class="comment odd alt thread-odd thread-alt depth-1">
				<article id="div-comment-5548" class="comment-body">
					<footer class="comment-meta">
						<div class="comment-author vcard">
							<img alt='' src='https://secure.gravatar.com/avatar/e613b192bb34d5148d06d454a51c8638?s=120&#038;d=identicon&#038;r=g' class='avatar avatar-120 photo' height='120' width='120' loading='lazy' /><span class="fn">Bert Butze</span><span class="screen-reader-text says">says:</span>						</div><!-- .comment-author -->

						<div class="comment-metadata">
							<a href="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/#comment-5548"><time datetime="2024-08-14T13:51:57-04:00">August 14, 2024 at 1:51 pm</time></a>						</div><!-- .comment-metadata -->

					</footer><!-- .comment-meta -->

					<div class="comment-content entry-content">

						<p>Great post and work from you @soatok…thanks for diving into it and let anyone know! I excited what fancy bear may will find out about matrix, Olm and so since it used by others around them who feel safe….Cheers</p>

					</div><!-- .comment-content -->

					
				</article><!-- .comment-body -->

			</div><!-- #comment-## -->
			<div id="comment-5551" class="comment even thread-even depth-1">
				<article id="div-comment-5551" class="comment-body">
					<footer class="comment-meta">
						<div class="comment-author vcard">
							<a href="https://e621.net/posts" rel="external nofollow" class="url"><img alt='' src='https://secure.gravatar.com/avatar/01822efaf66e4b81d6f947cba7e0613a?s=120&#038;d=identicon&#038;r=g' class='avatar avatar-120 photo' height='120' width='120' loading='lazy' /><span class="fn">Anon</span><span class="screen-reader-text says">says:</span></a>						</div><!-- .comment-author -->

						<div class="comment-metadata">
							<a href="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/#comment-5551"><time datetime="2024-08-14T17:10:18-04:00">August 14, 2024 at 5:10 pm</time></a>						</div><!-- .comment-metadata -->

					</footer><!-- .comment-meta -->

					<div class="comment-content entry-content">

						<p>Been waiting for this post, thank you</p>

					</div><!-- .comment-content -->

					
				</article><!-- .comment-body -->

			</div><!-- #comment-## -->
			<div id="comment-5557" class="comment odd alt thread-odd thread-alt depth-1 parent activitypub-comment">
				<article id="div-comment-5557" class="comment-body">
					<footer class="comment-meta">
						<div class="comment-author vcard">
							<a href="https://tech.lgbt/@luana" rel="external nofollow" class="url"><img alt='' src='https://media.tech.lgbt/accounts/avatars/109/241/210/093/587/260/original/527c1c3271c49dc1.jpeg' class='avatar avatar-120 photo avatar-default avatar-activitypub u-photo' height='120' width='120' loading='lazy' /><span class="fn">🎄🏳️‍🌈🎃🇧🇷Luana🇧🇷🎃🏳️‍🌈 :verified:</span><span class="screen-reader-text says">says:</span></a>						</div><!-- .comment-author -->

						<div class="comment-metadata">
							<a href="https://tech.lgbt/@luana/112963606913220116"><time datetime="2024-08-14T22:10:51-04:00">August 14, 2024 at 10:10 pm</time></a>						</div><!-- .comment-metadata -->

					</footer><!-- .comment-meta -->

					<div class="comment-content entry-content">

						<p><a href="https://soatok.blog/author/soatok/" rel="ugc">@soatok</a> Completly unrelated, sorry, but this blog is so cool? </p>
<p>I’ve seen federated blogs in a way such as the entries link to a toot and the replies to that are shown/federated inside the blog before (there’s even a wordpress plugin for that), but this is on a whole other level!<br />You can not only reply, but also the entire entry is visible just like any fediverse toot! And it uses the same link as the blog website link for that! That’s so cool!!</p>
<p>(Now not unrelated tho: damn, fuck matrix… (can someone please make an actual real foss and federated discord alternative (matrix was never that anyway), pleeease))</p>

					</div><!-- .comment-content -->

					
				</article><!-- .comment-body -->

						<div id="comment-5559" class="comment byuser comment-author-soatok bypostauthor even depth-2">
				<article id="div-comment-5559" class="comment-body">
					<footer class="comment-meta">
						<div class="comment-author vcard">
							<a href="https://soatok.blog" rel="external nofollow" class="url"><img alt='' src='https://secure.gravatar.com/avatar/146676f54771c654ed4b7e59e7513974?s=120&#038;d=identicon&#038;r=g' class='avatar avatar-120 photo' height='120' width='120' loading='lazy' /><span class="fn">Soatok</span><span class="screen-reader-text says">says:</span></a>						</div><!-- .comment-author -->

						<div class="comment-metadata">
							<a href="https://soatok.blog/2024/08/14/security-issues-in-matrixs-olm-library/#comment-5559"><time datetime="2024-08-15T00:49:40-04:00">August 15, 2024 at 12:49 am</time></a>						</div><!-- .comment-metadata -->

					</footer><!-- .comment-meta -->

					<div class="comment-content entry-content">

						<p>Thanks, glad you like it.</p>

					</div><!-- .comment-content -->

					
						<footer class="comment-footer-meta">

							<span class="by-post-author">By Post Author</span>
						</footer>

						
				</article><!-- .comment-body -->

			</div><!-- #comment-## -->
</div><!-- #comment-## -->

		</div><!-- .comments-inner -->

	</div><!-- comments -->

	<hr class="styled-separator is-style-wide" aria-hidden="true" />
	<div class="comment-respond" id="respond">

		<p class="comments-closed">Comments are closed.</p>

	</div><!-- #respond -->

	
		</div><!-- .comments-wrapper -->

		
</article><!-- .post -->

</main><!-- #site-content -->


			<footer id="site-footer" role="contentinfo" class="header-footer-group">

				<div class="section-inner">

					<div class="footer-credits">

						<p class="footer-copyright">&copy;
							2025							<a href="https://soatok.blog/">Dhole Moments</a>
						</p><!-- .footer-copyright -->

						<p class="powered-by-wordpress">
							
						</p><!-- .powered-by-wordpress -->

					</div><!-- .footer-credits -->

					<a class="to-the-top" href="#site-header">
						<span class="to-the-top-long">
							To the top <span class="arrow" aria-hidden="true">&uarr;</span>						</span><!-- .to-the-top-long -->
						<span class="to-the-top-short">
							Up <span class="arrow" aria-hidden="true">&uarr;</span>						</span><!-- .to-the-top-short -->
					</a><!-- .to-the-top -->

				</div><!-- .section-inner -->

			</footer><!-- #site-footer -->

		<!--  -->
<script defer id="bilmur" data-customproperties="{&quot;woo_active&quot;:&quot;0&quot;}" data-provider="wordpress.com" data-service="atomic"  src="https://s0.wp.com/wp-content/js/bilmur.min.js?m=202502"></script>
      <style>
        @media (pointer:none), (pointer:coarse) {
          .ftf-dma-note {
              display: none !important;
          }
        }
      </style>
        <style>
      .ftf-dma-note {
          display: none;
          pointer-events: none;
      }
    </style>
    <div id="ftf-dma-note" class="ftf-dma-note d-none ad native-ad native-ad-1 ytd-j yxd-j yxd-jd aff-content-col aff-inner-col aff-item-list ark-ad-message inplayer-ad inplayer_banners in_stream_banner trafficjunky-float-right dbanner preroll-blocker happy-inside-player blocker-notice blocker-overlay exo-horizontal ave-pl bottom-hor-block brs-block advboxemb wgAdBlockMessage glx-watermark-container overlay-advertising-new header-menu-bottom-ads rkads mdp-deblocker-wrapper amp-ad-inner imggif bloc-pub bloc-pub2 hor_banner aan_fake aan_fake__video-units rps_player_ads fints-block__row full-ave-pl full-bns-block vertbars video-brs player-bns-block wps-player__happy-inside gallery-bns-bl stream-item-widget adsbyrunactive happy-under-player adde_modal_detector adde_modal-overlay ninja-recommend-block aoa_overlay message">
      <div class="ftf-dma-note-content-wrapper">
        <span onclick="" id="ftf-dma-close-btn" class="ftf-dma-close-btn">Close</span>
        <div class="ftf-dma-note-header">
          <p>Ad-blocker not detected</p>
        </div>
        <div class="ftf-dma-note-content"><p>
  Consider installing a browser extension that blocks ads and other malicious scripts in your browser to protect your privacy and security. <a href="https://stefanbohacek.com/project/detect-missing-adblocker-wordpress-plugin/#resources" target="_blank">Learn more.</a></p>
</div>
      </div>
    </div>
  		<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		<script type='text/javascript'  src='https://soatok.blog/_static/??-eJwrL9BNzs8rSc0r0S/IKU3PzCvWL67MK0msyMhMz8gB4pLUIkwRY/3i5KLMghKg4gzn/KJUvaxinXKKTXIqKgUaV1BARdO8gsF8oIn2ubaG5sYmBhaGxhYGACJPX1M='></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://soatok.blog/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://soatok.blog/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<link rel='stylesheet' id='all-css-e8b83d83117514b956f68a9aa68f68d6' href='https://soatok.blog/_static/??-eJyVjFsKgCAQAC+ULQaZP9FZTJewfOG6eP0I6gD9zjDTi7A5NUwNSuDDJ4ITWzH2gpgdBySwpmYmDEDdF6xi5+QCjpZo6D/qV4gPPIMtrlItk5y1VvoGzj40MA==' type='text/css' media='all' />
<script id="coblocks-tinyswiper-initializer-js-extra">
var coblocksTinyswiper = {"carouselPrevButtonAriaLabel":"Previous","carouselNextButtonAriaLabel":"Next","sliderImageAriaLabel":"Image"};
</script>
<script type='text/javascript'  src='https://soatok.blog/_static/??-eJyVzUEKwjAQheELOcYWtLgQzxKTUF5NJiEzNujpxUrduNHt8H9vWiGXWQOrKfE2gsX4oMEpJYiAR7L+ErO7hmo8RM20BttJNu1bu7zk8qnXA1lGsorMv8o5sM9VjILvJA0l1L+fvuybEhgKG/FYZs7p1A3dsR8O+13/BN5NY1c='></script>
<script src="https://stats.wp.com/e-202502.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script id="jetpack-stats-js-after">
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"176185133\",\"post\":\"10255\",\"tz\":\"-5\",\"srv\":\"soatok.blog\",\"hp\":\"atomic\",\"ac\":\"2\",\"amp\":\"0\",\"j\":\"1:14.2.1\"}") ]);
_stq.push([ "clickTrackerInit", "176185133", "10255" ]);
</script>
<script id="jetpack-carousel-js-extra">
var jetpackSwiperLibraryPath = {"url":"https:\/\/soatok.blog\/wp-content\/plugins\/jetpack\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/soatok.blog\/wp-admin\/admin-ajax.php","nonce":"c810e041ac","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"0","login_url":"https:\/\/soatok.blog\/wp-login.php?redirect_to=https%3A%2F%2Fsoatok.blog%2F2024%2F08%2F14%2Fsecurity-issues-in-matrixs-olm-library%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"]};
</script>
<script type='text/javascript'  src='https://soatok.blog/wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js?m=1734358916'></script>

	</body>
</html>
<!--
	generated in 0.246 seconds
	153787 bytes batcached for 300 seconds
-->
