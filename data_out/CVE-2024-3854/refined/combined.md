=== Content from lists.debian.org_cd5431e1_20250110_110900.html ===


---

[[Date Prev](msg00012.html)][[Date Next](msg00014.html)]
[[Thread Prev](msg00012.html)][[Thread Next](msg00014.html)]
[[Date Index](maillist.html#00013)]
[[Thread Index](threads.html#00013)]

# [SECURITY] [DLA 3791-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3791-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Mon, 22 Apr 2024 10:49:04 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240422084904.60FCF2A5A98%40andromeda)Â [20240422084904.60FCF2A5A98@andromeda](msg00013.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3791-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
April 22, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.10.1-1~deb10u1
CVE ID         : CVE-2024-2609 CVE-2024-3302 CVE-2024-3852 CVE-2024-3854
                 CVE-2024-3857 CVE-2024-3859 CVE-2024-3861 CVE-2024-3864

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:115.10.1-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmYmJH0ACgkQnUbEiOQ2
gwIQ1A//TyjC/KoCSUceHOil+UKFnoxBl+7AG0khIFn7gT+roJRgKtkBUFni/10a
Bbo4SbbZNZwQo6QVQEtCtvYvHsWqYKkPOOFUGODCXPkPbwGzTXVlcHRY+BR+Gsf1
YIv8AxkkVdgAQdu53acvLUXfkQuOVbjYAGdvZQmppjWPh32Frp0f0V4LaUWrI3uF
MBowGM2J4kUC/KIrPjec7EGo+otnHzcSTyl9xO/RQDISHLc8xqenI6hBVAxW9EaC
/kBdDRku/wC6mwYRIKJMvekwC5NI21y1Qa0VcvrSdzk8tCwetpzaKAeucJFfAl0C
sqz8vI0OF1BgBph6Jif3Rwc99Up9tSc8BUkqvISONJeKb9x3gbtAN90hDicP+aF6
3MPQLNuebLn/zJWyL9EPzIQ5V02hXk2s3YXJlS+aXuCjyQf6VV6bd5ISYgyRHe8u
UhBxFaKDhcrDoAC55FPOE4Ywx9fyvCD1uXzHjeqIj29jARLWRHP9rq8bqPFpxHXq
XX3te9jDewzWeu7Uze483cSNf/izSUmZNbaB+iHZsScI7im7PYw92RLBKuxJ46hT
PJNLVKPu9dW2EI9ugibDoDIoblEDndDQRUtFZn1P0Trk7zaPhlGKQn4zgL9y5kEL
fy2DxO0N3XFz2XijCgyAYTz5CQUlGtR2ARXba6E8+Skrxs5oy1k=
=QHOD
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_63abf701_20250110_110900.html ===


---

[[Date Prev](msg00011.html)][[Date Next](msg00013.html)]
[[Thread Prev](msg00011.html)][[Thread Next](msg00013.html)]
[[Date Index](maillist.html#00012)]
[[Thread Index](threads.html#00012)]

# [SECURITY] [DLA 3790-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3790-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Fri, 19 Apr 2024 12:39:37 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240419103937.C85162A590B%40andromeda)Â [20240419103937.C85162A590B@andromeda](msg00012.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3790-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
April 19, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.10.0esr-1~deb10u1
CVE ID         : CVE-2024-2609 CVE-2024-3302 CVE-2024-3852 CVE-2024-3854
                 CVE-2024-3857 CVE-2024-3859 CVE-2024-3861 CVE-2024-3864

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code or clickjacking.

For Debian 10 buster, these problems have been fixed in version
115.10.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmYiSekACgkQnUbEiOQ2
gwLDdw//Se9KFK8DGedq3gALJsodnMHsth1qAzwv6g23XTPCq+Jsl69fZXwT0pM5
VXB5wg5XbPa622MtrEPUJqwjfEB7iAd3Jchb2mPkeI3MyaSZXChduCxwE6G4zHrT
mkF++OVNyqehEWEYnN4tM9jo0xKG2j2duo2NnFgBwAMjYUkizjvRARrdvOVHqst4
v+1QMCQlbRitl7pNpe+elcXXXXTaA4e+5WIheN3jS+Y6Nd5k67ZCd80TSsw+JhkN
VuQRLqP4PVG2S9pTMBbZVF06FYhEAJSIfHZ0UmokgEXKo0SyDTdQW1oqyTid9iVu
iwu6cSxknAetqvKHa2hk45Z1VdD3RCqZB/i7n8ybGBW9Ol9jXfVpbLpSR4BZkCSs
2Ffl1amXwmyI1OAR95c4aaekEzGyHlebDrOJ2WWnnbdzF2tagJC3dCNjYSiYiwvl
rSeAOmBiqvd8HrX6z4yCAvhN3mn2VCG0+IY3z0ex+YZdm7+jGoeC1g87lgWLcGt3
ynQ9mnrS2c9Jiw+GhhpS4chEDUVF+KNbeU1/3ozQeb5KAssBcJY3isXWx89Nf1TG
kAQbsGxVCLqQuTUJOk6miE8BwmPSCbatKUETZ2PP8zlOpENc2toSbvtgA7/RZzdP
MKn7L/bYE/G7B3UiJ1czAmfO13/xXhUC/icjyml9yvTVkNjqywA=
=pOlm
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_9fd816d7_20250110_110902.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-20

## Security Vulnerabilities fixed in Thunderbird 115.10

Announced
April 16, 2024
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.10

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2024-3852: GetBoundName in the JIT returned the wrong object](#CVE-2024-3852)

Reporter
Logan Stratton
Impact
high
##### Description

GetBoundName could return the wrong version of an object when JIT optimizations were applied.

##### References

* [Bug 1883542](https://bugzilla.mozilla.org/show_bug.cgi?id=1883542)

#### [#CVE-2024-3854: Out-of-bounds-read after mis-optimized switch statement](#CVE-2024-3854)

Reporter
Lukas Bernhard
Impact
high
##### Description

In some code patterns the JIT incorrectly optimized switch statements and generated code with out-of-bounds-reads.

##### References

* [Bug 1884552](https://bugzilla.mozilla.org/show_bug.cgi?id=1884552)

#### [#CVE-2024-3857: Incorrect JITting of arguments led to use-after-free during garbage collection](#CVE-2024-3857)

Reporter
Lukas Bernhard
Impact
high
##### Description

The JIT created incorrect code for arguments in certain cases. This led to potential use-after-free crashes during garbage collection.

##### References

* [Bug 1886683](https://bugzilla.mozilla.org/show_bug.cgi?id=1886683)

#### [#CVE-2024-2609: Permission prompt input delay could expire when not in focus](#CVE-2024-2609)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

The permission prompt input delay could expire while the window is not in focus. This makes it vulnerable to clickjacking by malicious websites.

##### References

* [Bug 1866100](https://bugzilla.mozilla.org/show_bug.cgi?id=1866100)

#### [#CVE-2024-3859: Integer-overflow led to out-of-bounds-read in the OpenType sanitizer](#CVE-2024-3859)

Reporter
Ronald Crane
Impact
moderate
##### Description

On 32-bit versions there were integer-overflows that led to an out-of-bounds-read that potentially could be triggered by a malformed OpenType font.

##### References

* [Bug 1874489](https://bugzilla.mozilla.org/show_bug.cgi?id=1874489)

#### [#CVE-2024-3861: Potential use-after-free due to AlignedBuffer self-move](#CVE-2024-3861)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an AlignedBuffer were assigned to itself, the subsequent self-move could result in an incorrect reference count and later use-after-free.

##### References

* [Bug 1883158](https://bugzilla.mozilla.org/show_bug.cgi?id=1883158)

#### [#CVE-2024-3863: Download Protections were bypassed by .xrm-ms files on Windows](#CVE-2024-3863)

Reporter
Eduardo Braun Prado working with Trend Micro Zero Day Initiative
Impact
moderate
##### Description

The executable file warning was not presented when downloading .xrm-ms files.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1885855](https://bugzilla.mozilla.org/show_bug.cgi?id=1885855)

#### [#CVE-2024-3302: Denial of Service using HTTP/2 CONTINUATION frames](#CVE-2024-3302)

Reporter
Bartek Nowotarski via CERT
Impact
low
##### Description

There was no limit to the number of HTTP/2 CONTINUATION frames that would be processed. A server could abuse this to create an Out of Memory condition in the browser.

##### References

* [Bug 1881183](https://bugzilla.mozilla.org/show_bug.cgi?id=1881183)
* [VU#421644 - HTTP/2 CONTINUATION frames can be utilized for DoS attacks](https://kb.cert.org/vuls/id/421644)

#### [#CVE-2024-3864: Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](#CVE-2024-3864)

Reporter
Paul Bone
Impact
high
##### Description

Memory safety bug present in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9. This bug showed evidence of memory corruption and we presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](https://bugzilla.mozilla.org/show_bug.cgi?id=1888333)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_4f08cf9c_20250110_110901.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-19

## Security Vulnerabilities fixed in Firefox ESR 115.10

Announced
April 16, 2024
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.10

#### [#CVE-2024-3852: GetBoundName in the JIT returned the wrong object](#CVE-2024-3852)

Reporter
Logan Stratton
Impact
high
##### Description

GetBoundName could return the wrong version of an object when JIT optimizations were applied.

##### References

* [Bug 1883542](https://bugzilla.mozilla.org/show_bug.cgi?id=1883542)

#### [#CVE-2024-3854: Out-of-bounds-read after mis-optimized switch statement](#CVE-2024-3854)

Reporter
Lukas Bernhard
Impact
high
##### Description

In some code patterns the JIT incorrectly optimized switch statements and generated code with out-of-bounds-reads.

##### References

* [Bug 1884552](https://bugzilla.mozilla.org/show_bug.cgi?id=1884552)

#### [#CVE-2024-3857: Incorrect JITting of arguments led to use-after-free during garbage collection](#CVE-2024-3857)

Reporter
Lukas Bernhard
Impact
high
##### Description

The JIT created incorrect code for arguments in certain cases. This led to potential use-after-free crashes during garbage collection.

##### References

* [Bug 1886683](https://bugzilla.mozilla.org/show_bug.cgi?id=1886683)

#### [#CVE-2024-2609: Permission prompt input delay could expire when not in focus](#CVE-2024-2609)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

The permission prompt input delay could expire while the window is not in focus. This makes it vulnerable to clickjacking by malicious websites.

##### References

* [Bug 1866100](https://bugzilla.mozilla.org/show_bug.cgi?id=1866100)

#### [#CVE-2024-3859: Integer-overflow led to out-of-bounds-read in the OpenType sanitizer](#CVE-2024-3859)

Reporter
Ronald Crane
Impact
moderate
##### Description

On 32-bit versions there were integer-overflows that led to an out-of-bounds-read that potentially could be triggered by a malformed OpenType font.

##### References

* [Bug 1874489](https://bugzilla.mozilla.org/show_bug.cgi?id=1874489)

#### [#CVE-2024-3861: Potential use-after-free due to AlignedBuffer self-move](#CVE-2024-3861)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an AlignedBuffer were assigned to itself, the subsequent self-move could result in an incorrect reference count and later use-after-free.

##### References

* [Bug 1883158](https://bugzilla.mozilla.org/show_bug.cgi?id=1883158)

#### [#CVE-2024-3863: Download Protections were bypassed by .xrm-ms files on Windows](#CVE-2024-3863)

Reporter
Eduardo Braun Prado working with Trend Micro Zero Day Initiative
Impact
moderate
##### Description

The executable file warning was not presented when downloading .xrm-ms files.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1885855](https://bugzilla.mozilla.org/show_bug.cgi?id=1885855)

#### [#CVE-2024-3302: Denial of Service using HTTP/2 CONTINUATION frames](#CVE-2024-3302)

Reporter
Bartek Nowotarski via CERT
Impact
low
##### Description

There was no limit to the number of HTTP/2 CONTINUATION frames that would be processed. A server could abuse this to create an Out of Memory condition in the browser.

##### References

* [Bug 1881183](https://bugzilla.mozilla.org/show_bug.cgi?id=1881183)
* [VU#421644 - HTTP/2 CONTINUATION frames can be utilized for DoS attacks](https://kb.cert.org/vuls/id/421644)

#### [#CVE-2024-3864: Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](#CVE-2024-3864)

Reporter
Paul Bone
Impact
high
##### Description

Memory safety bug present in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9. This bug showed evidence of memory corruption and we presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](https://bugzilla.mozilla.org/show_bug.cgi?id=1888333)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_795f9353_20250110_110900.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1884552)
* [XML](/show_bug.cgi?ctype=xml&id=1884552)

Closed
[Bug 1884552](/show_bug.cgi?id=1884552)
(CVE-2024-3854)

Opened 10 months ago
Closed 10 months ago

# Assertion failure: ins->isGoto(), at jit/IonAnalysis.cpp:715

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: ins->isGoto(), at jit/IonAnalysis.cpp:715

## Categories

### (Core :: JavaScript Engine: JIT, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT#JavaScript%20Engine%3A%20JIT)

JavaScript Engine: JIT
â–¾

Core :: JavaScript Engine: JIT
JavaScript engine's JIT compilers
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

126 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [125+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=125%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox123 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix) |
| firefox124 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix) |
| firefox125 | [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 125+ | fixed |
| firefox-esr128 | --- | --- |
| firefox123 |  | wontfix |
| firefox124 |  | wontfix |
| firefox125 | + | fixed |
| firefox126 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: lukas.bernhard, Assigned: iain)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1243fc5f2c1c56a2f77ca1be38837e68?d=mm&size=40)  [iain](/user_profile?user_id=623993)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/59307c6d3ba87d521f5443530ecf72a9?d=mm&size=40)  [lukas.bernhard](/user_profile?user_id=656084)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

### (Blocks 2 open bugs)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[sm-opt-jits](/show_bug.cgi?id=1729509 "NEW - [meta] Optimizing Compiler"), [l11d-js-fuzzing](/show_bug.cgi?id=1758541 "NEW - [meta] Lukas JavaScript engine Fuzzing")

Dependency [tree](/showdependencytree.cgi?id=1884552&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1884552)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-high, Whiteboard: [adv-main125+][adv-esr115.10+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-3854

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main125+][adv-esr115.10+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1430256_1689 "10 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | [in-testsuite](#c17 "9 months ago") | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | in-testsuite | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a1293592_488993 "10 months ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Bug 1884552: Refactor IsDiamondPattern r=jandem](/attachment.cgi?id=9391110)  [10 months ago](#c4)  [Iain Ireland [:iain]](/user_profile?user_id=623993)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c11 "10 months ago")  RyanVM : [approval-mozilla-esr115+](#c11 "10 months ago")  tjr : [sec-approval+](#c7 "10 months ago") | [Details](/attachment.cgi?id=9391110&action=edit) | [Review](/attachment.cgi?id=9391110) |
| --- | --- | --- |
| [Bug 1884552: Add testcase r=jandem](/attachment.cgi?id=9391111)  [10 months ago](#c5)  [Iain Ireland [:iain]](/user_profile?user_id=623993)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9391111&action=edit) | [Review](/attachment.cgi?id=9391111) |
| [advisory.txt](/attachment.cgi?id=9396625)  [9 months ago](#c14)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   189 bytes, text/plain |  | [Details](/attachment.cgi?id=9396625&action=edit) |

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1884552#c0)â€¢ 10 months ago |
|  | |

Steps to reproduce:

On git commit e23c37371147c5ff5ac7d825ccaa90e096cd036e the attached sample asserts in the js-shell when invoked as `obj-x86_64-pc-linux-gnu/dist/bin/js --fuzzing-safe crash.js`.

```
for (let i22 = 0, i23 = 10;
    (() => {
        for (let i26 = 0, i27 = 10;
            (() => {
                let v28 = i26 != i27;
                const v29 = v28 === i23;
                if (v29) {
                    v28 = v29;
                } else {
                    switch (this) {
                    }
                }
                return v28;
            })();
            ) {
        }
        return i22 < i23;
    })();
    ) {
}

```
```
#0  0x0000555558fd8d7b in UpdateTestSuccessors (alloc=..., block=0x7ffff569f3f8, value=0x7ffff569eb20, ifTrue=0x7ffff56a0130,
    ifFalse=0x7ffff56a0b78, existingPred=0x7ffff569fc98) at js/src/jit/IonAnalysis.cpp:715
#1  0x0000555558fd7864 in MaybeFoldDiamondConditionBlock (graph=..., initialBlock=0x7ffff569e2e8)
    at js/src/jit/IonAnalysis.cpp:862
#2  0x0000555558fa8533 in MaybeFoldConditionBlock (graph=..., initialBlock=0x7ffff569e2e8)
    at js/src/jit/IonAnalysis.cpp:1095
#3  0x0000555558fa8475 in js::jit::FoldTests (graph=...) at js/src/jit/IonAnalysis.cpp:1294
#4  0x0000555558ee1af1 in js::jit::OptimizeMIR (mir=0x7ffff569b180) at js/src/jit/Ion.cpp:1037
#5  0x0000555558ee384a in js::jit::CompileBackEnd (mir=0x7ffff569b180, snapshot=0x7ffff569b6a0)
    at js/src/jit/Ion.cpp:1605
#6  0x0000555558fc9287 in js::jit::IonCompileTask::runTask (this=0x7ffff569b718)
    at js/src/jit/IonCompileTask.cpp:52
#7  0x0000555558fc91b6 in js::jit::IonCompileTask::runHelperThreadTask (this=0x7ffff569b718, locked=...)
    at js/src/jit/IonCompileTask.cpp:30
#8  0x0000555557d769d0 in js::GlobalHelperThreadState::runTaskLocked (this=0x7ffff7618400, task=0x7ffff569b718, locked=...)
    at js/src/vm/HelperThreads.cpp:1728
#9  0x0000555557d767ab in js::GlobalHelperThreadState::runOneTask (this=0x7ffff7618400, lock=...)
    at js/src/vm/HelperThreads.cpp:1697
#10 0x0000555557db61c8 in js::HelperThread::threadLoop (this=0x7ffff7627420, pool=0x7ffff7623100)
    at js/src/vm/InternalThreadPool.cpp:282
#11 0x0000555557db6022 in js::HelperThread::ThreadMain (pool=0x7ffff7623100, helper=0x7ffff7627420)
    at js/src/vm/InternalThreadPool.cpp:225
#12 0x0000555557dde732 in js::detail::ThreadTrampoline<void (&)(js::InternalThreadPool*, js::HelperThread*), js::InternalThreadPool*&, js::HelperThread*>::callMain<0ul, 1ul> (this=0x7ffff760f5f0) at js/src/threading/Thread.h:228
#13 0x0000555557dde57b in js::detail::ThreadTrampoline<void (&)(js::InternalThreadPool*, js::HelperThread*), js::InternalThreadPool*&, js::HelperThread*>::Start (aPack=0x7ffff760f5f0) at js/src/threading/Thread.h:217
#14 0x00007ffff7897b5a in start_thread (arg=<optimized out>) at ./nptl/pthread_create.c:444
#15 0x00007ffff79285fc in clone3 () at ../sysdeps/unix/sysv/linux/x86_64/clone3.S:78

```

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a21_656084)â€¢ 10 months ago |

Blocks: [l11d-js-fuzzing](/show_bug.cgi?id=1758541 "NEW - [meta] Lukas JavaScript engine Fuzzing")Group: firefox-core-security â†’ core-securityComponent: Untriaged â†’ JavaScript Engine: JITProduct: Firefox â†’ Core

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a103_656084)â€¢ 10 months ago |

Summary: Assertion failure: js::gc::IsCellPointerValid(&obj), at js/Value.h:633 â†’ Assertion failure: ins->isGoto(), at jit/IonAnalysis.cpp:715

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1884552#c1)â€¢ 10 months ago |
|  | |

This seems to be a long-standing issue; commit c9b61e116965bcf35c96a56f36de1b487aba1699 from Feb 24 2022 is affected already.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a120484_406194)â€¢ 10 months ago |

Group: core-security â†’ javascript-core-security

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1884552#c2)â€¢ 10 months ago |
|  | |

I am not able to find any non-OOM related crashes under `UpdateTestSuccessors`, which suggests that if we do not crash with the current assertion, then we might be generating some dangling pointers in our MIR graph.

Looking at the test case this might be related to the empty switch statement, generated from WarpBuilder.

Blocks: [sm-opt-jits](/show_bug.cgi?id=1729509 "NEW - [meta] Optimizing Compiler")Severity: -- â†’ S2Flags: needinfo?(iireland)Priority: -- â†’ P2

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1884552#c3)â€¢ 10 months ago |
|  | |

This is an interesting one. Here's a simpler test case:

```
function inner(cond) {
  var x;
  if (cond) {
    x = 0;
  } else {
    x = 1;
    switch (this) {}
  }
  return x;
}

function outer(cond) {
  var x;
  if (inner(cond)) {
    return 1;
  } else {
    return 2;
  }
}

with ({}) {}
for (var i = 0; i < 1000; i++) {
  outer(true);
  outer(false);
}

```

The problem is in [MaybeFoldDiamondConditionBlock](https://searchfox.org/mozilla-central/rev/b189986e26a92f749462094e7869771c1a6607c0/js/src/jit/IonAnalysis.cpp#770-794). We're looking for this pattern:

```
        initialBlock
          /     \
  trueBranch  falseBranch
          \     /
          phiBlock
             |
         testBlock
          /     \

```

If testBlock will branch based on a phi in phiBlock, then we can remove phiBlock and testBlock, and instead jump straight from trueBranch and falseBranch to the correct location. Importantly, when matching trueBranch and falseBranch, we only verify that they have the right number of incoming and outgoing edges, and not the actual control instruction. If we stick an empty switch statement in falseBranch (or theoretically trueBranch, although I haven't gotten that version to fail yet), then everything will work right up until we hit [this code](https://searchfox.org/mozilla-central/rev/b189986e26a92f749462094e7869771c1a6607c0/js/src/jit/IonAnalysis.cpp#715-729) in UpdateTestSuccessors, which wants to rewrite the end of falseBranch. It assumes that any block that's reached this point with a single successor must end in a goto. However, in this case we actually have a degenerate switch. We assert.

In a non-debug build, we incorrectly cast the MTableSwitch into an MGoto and try to load the target out of it. If my quick comparison of offsets is correct, we end up treating the pointer to the backing buffer of the switch's successors vector as if it were the target itself, then pass it to removePredecessor, where we read a variety of fields from it. I'm going to conservatively assume that it's somehow exploitable.

One easy fix might be to rewrite [these tests](https://searchfox.org/mozilla-central/rev/b189986e26a92f749462094e7869771c1a6607c0/js/src/jit/IonAnalysis.cpp#749-758) to check that the last instruction is a goto, instead of the number of successors. AFAICT, MGoto and MTableSwitch are the only control instructions that can have a single successor: MTest always has two, and the other control instructions (MReturn, MUnreachable, etc...) have zero.

Anba rewrote this code in [bug 1767966](/show_bug.cgi?id=1767966 "RESOLVED FIXED - Improve codegen for test expressions"), but as far as I can tell the necessary conditions for this bug were already present when this optimization was first added in [bug 1028580](/show_bug.cgi?id=1028580 "RESOLVED FIXED - Improve code generated for conditional expressions in tests"). Maybe we would have generated slightly different MIR pre-Warp.

Flags: needinfo?(iireland)Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a283589_75935)â€¢ 10 months ago |

[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix)
[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1884552#c4)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1884552: Refactor IsDiamondPattern r=jandem](attachment.cgi?id=9391110)
â€” [Details](attachment.cgi?id=9391110&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a307905_600971)â€¢ 10 months ago |

Assignee: nobody â†’ iirelandStatus: NEW â†’ ASSIGNED

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1884552#c5)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1884552: Add testcase r=jandem](attachment.cgi?id=9391111)
â€” [Details](attachment.cgi?id=9391111&action=edit)

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1884552#c6)â€¢ 10 months ago |
|  | |

Comment on [attachment 9391110](/attachment.cgi?id=9391110 "Bug 1884552: Refactor IsDiamondPattern r=jandem") [[details]](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem")

[Bug 1884552](/show_bug.cgi?id=1884552 "RESOLVED FIXED - Assertion failure: ins->isGoto(), at jit/IonAnalysis.cpp:715"): Refactor IsDiamondPattern r=jandem

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Medium difficulty. It isn't too hard to work out that the only thing this patch changes is how we handle TableSwitch nodes. After that it requires a bit of cleverness with inlining to trigger the bug, and then whatever work is necessary to turn some out-of-bounds reads into an exploit.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which branches (beta, release, and/or ESR) are affected by this flaw, and do the release status flags reflect this affected/unaffected state correctly?**: All, and yes
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: The patch should apply cleanly to all supported branches.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely. It should not have any effect outside of the buggy case.
* **Is the patch ready to land after security approval is given?**: Yes
* **Is Android affected?**: Yes
[Attachment #9391110](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a383388_75935)â€¢ 10 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix)
[tracking-firefox125](/buglist.cgi?f1=cf_tracking_firefox125&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- â†’ [125+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=125%2B)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a802354_695136)â€¢ 10 months ago |

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a894618_656084)â€¢ 10 months ago |

Flags: sec-bounty?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1884552#c7)â€¢ 10 months ago |
|  | |

Comment on [attachment 9391110](/attachment.cgi?id=9391110 "Bug 1884552: Refactor IsDiamondPattern r=jandem") [[details]](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem")

[Bug 1884552](/show_bug.cgi?id=1884552 "RESOLVED FIXED - Assertion failure: ins->isGoto(), at jit/IonAnalysis.cpp:715"): Refactor IsDiamondPattern r=jandem

sec-approvals were paused for a few days after merge, thanks for the patience. approved to land and uplift

[Attachment #9391110](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem") -
Flags: sec-approval? â†’ sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a983744_578488)â€¢ 10 months ago |

Whiteboard: [reminder-test 2024-05-28]

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1884552#c8)â€¢ 10 months ago |
|  | |

Pushed by iireland@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/cf42085d7c1d>
Refactor IsDiamondPattern r=jandem

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1884552#c9)â€¢ 10 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/cf42085d7c1d>

Group: javascript-core-security â†’ core-security-releaseStatus: ASSIGNED â†’ RESOLVEDClosed: 10 months ago
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 126 Branch

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1884552#c10)â€¢ 10 months ago |
|  | |

Comment on [attachment 9391110](/attachment.cgi?id=9391110 "Bug 1884552: Refactor IsDiamondPattern r=jandem") [[details]](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem")

[Bug 1884552](/show_bug.cgi?id=1884552 "RESOLVED FIXED - Assertion failure: ins->isGoto(), at jit/IonAnalysis.cpp:715"): Refactor IsDiamondPattern r=jandem

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Sec-high
* **User impact if declined**: Potentially exploitable type confusion during Ion compilation
* **Fix Landed on Version**: 126
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This patch replaces one check with a different check that should be the same in every case except the buggy case.

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potentially exploitable type confusion during Ion compilation
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**: None
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This patch replaces one check with a different check that should be the same in every case except the buggy case.
* **String changes made/needed**: None
* **Is Android affected?**: Yes
[Attachment #9391110](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem") -
Flags: approval-mozilla-esr115?
[Attachment #9391110](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1884552#c11)â€¢ 10 months ago |
|  | |

Comment on [attachment 9391110](/attachment.cgi?id=9391110 "Bug 1884552: Refactor IsDiamondPattern r=jandem") [[details]](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem")

[Bug 1884552](/show_bug.cgi?id=1884552 "RESOLVED FIXED - Assertion failure: ins->isGoto(), at jit/IonAnalysis.cpp:715"): Refactor IsDiamondPattern r=jandem

Approved for 125.0b4 and 115.10esr.

[Attachment #9391110](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem") -
Flags: approval-mozilla-esr115?
[Attachment #9391110](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem") -
Flags: approval-mozilla-esr115+
[Attachment #9391110](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem") -
Flags: approval-mozilla-beta?
[Attachment #9391110](/attachment.cgi?id=9391110&action=edit "Bug 1884552: Refactor IsDiamondPattern r=jandem") -
Flags: approval-mozilla-beta+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1884552#c12)â€¢ 10 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/928b0540e421>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a1067803_75935)â€¢ 10 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1884552#c13)â€¢ 10 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/b5a9b2119a23>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a1070144_75935)â€¢ 10 months ago |

[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a1293592_488993)â€¢ 10 months ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a1430256_1689)â€¢ 10 months ago |

Flags: sec-bounty? â†’ sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a2776804_1689)â€¢ 9 months ago |

Flags: in-testsuite?Whiteboard: [reminder-test 2024-05-28] â†’ [reminder-test 2024-05-28][adv-main125+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a2777520_1689)â€¢ 9 months ago |

Whiteboard: [reminder-test 2024-05-28][adv-main125+] â†’ [reminder-test 2024-05-28][adv-main125+][adv-esr115.10+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1884552#c14)â€¢ 9 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9396625)
â€” [Details](attachment.cgi?id=9396625&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a3160642_1689)â€¢ 9 months ago |

Alias: CVE-2024-3854

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1884552#c15)â€¢ 8 months ago |
|  | |

2 months ago, tjr placed a reminder on the bug using the whiteboard tag `[reminder-test 2024-05-28]` .

iain, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(iireland)Whiteboard: [reminder-test 2024-05-28][adv-main125+][adv-esr115.10+] â†’ [adv-main125+][adv-esr115.10+]

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a6856069_623993)â€¢ 8 months ago |

Flags: needinfo?(iireland)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1884552#c16)â€¢ 8 months ago |
|  | |

Pushed by sstanca@mozilla.com:
<https://hg.mozilla.org/mozilla-central/rev/147fdd4c5ddb>
Add testcase r=jandem

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1884552#c17)â€¢ 8 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/147fdd4c5ddb>

Flags: in-testsuite? â†’ in-testsuite+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a7041143_5898)â€¢ 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1884552#a16661240_1689)â€¢ 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1884552&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Iain Ireland [:iain]](/user_profile?user_id=623993)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_5e413429_20250110_110901.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-18

## Security Vulnerabilities fixed in Firefox 125

Announced
April 16, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 125

This advisory was updated June 11, 2024 to add XXX which was included in the original release of Firefox 125, but did not appear in the advisory published at that time.

#### [#CVE-2024-3852: GetBoundName in the JIT returned the wrong object](#CVE-2024-3852)

Reporter
Logan Stratton
Impact
high
##### Description

GetBoundName could return the wrong version of an object when JIT optimizations were applied.

##### References

* [Bug 1883542](https://bugzilla.mozilla.org/show_bug.cgi?id=1883542)

#### [#CVE-2024-5702: Use-after-free in networking](#CVE-2024-5702)

Reporter
Kershaw Chang
Impact
high
##### Description

Memory corruption in the networking stack could have led to a potentially exploitable crash.

##### References

* [Bug 1193389](https://bugzilla.mozilla.org/show_bug.cgi?id=1193389)

#### [#CVE-2024-3853: Use-after-free if garbage collection runs during realm initialization](#CVE-2024-3853)

Reporter
Gary Kwong
Impact
high
##### Description

A use-after-free could result if a JavaScript realm was in the process of being initialized when a garbage collection started.

##### References

* [Bug 1884427](https://bugzilla.mozilla.org/show_bug.cgi?id=1884427)

#### [#CVE-2024-3854: Out-of-bounds-read after mis-optimized switch statement](#CVE-2024-3854)

Reporter
Lukas Bernhard
Impact
high
##### Description

In some code patterns the JIT incorrectly optimized switch statements and generated code with out-of-bounds-reads.

##### References

* [Bug 1884552](https://bugzilla.mozilla.org/show_bug.cgi?id=1884552)

#### [#CVE-2024-3855: Incorrect JIT optimization of MSubstr leads to out-of-bounds reads](#CVE-2024-3855)

Reporter
Lukas Bernhard
Impact
high
##### Description

In certain cases the JIT incorrectly optimized MSubstr operations, which led to out-of-bounds reads.

##### References

* [Bug 1885828](https://bugzilla.mozilla.org/show_bug.cgi?id=1885828)

#### [#CVE-2024-3856: Use-after-free in WASM garbage collection](#CVE-2024-3856)

Reporter
Nan Wang
Impact
high
##### Description

A use-after-free could occur during WASM execution if garbage collection ran during the creation of an array.

##### References

* [Bug 1885829](https://bugzilla.mozilla.org/show_bug.cgi?id=1885829)

#### [#CVE-2024-3857: Incorrect JITting of arguments led to use-after-free during garbage collection](#CVE-2024-3857)

Reporter
Lukas Bernhard
Impact
high
##### Description

The JIT created incorrect code for arguments in certain cases. This led to potential use-after-free crashes during garbage collection.

##### References

* [Bug 1886683](https://bugzilla.mozilla.org/show_bug.cgi?id=1886683)

#### [#CVE-2024-3858: Corrupt pointer dereference in js::CheckTracedThing<js::Shape>](#CVE-2024-3858)

Reporter
Lukas Bernhard
Impact
high
##### Description

It was possible to mutate a JavaScript object so that the JIT could crash while tracing it.

##### References

* [Bug 1888892](https://bugzilla.mozilla.org/show_bug.cgi?id=1888892)

#### [#CVE-2024-3859: Integer-overflow led to out-of-bounds-read in the OpenType sanitizer](#CVE-2024-3859)

Reporter
Ronald Crane
Impact
moderate
##### Description

On 32-bit versions there were integer-overflows that led to an out-of-bounds-read that potentially could be triggered by a malformed OpenType font.

##### References

* [Bug 1874489](https://bugzilla.mozilla.org/show_bug.cgi?id=1874489)

#### [#CVE-2024-3860: Crash when tracing empty shape lists](#CVE-2024-3860)

Reporter
Gary Kwong
Impact
moderate
##### Description

An out-of-memory condition during object initialization could result in an empty shape list. If the JIT subsequently traced the object it would crash.

##### References

* [Bug 1881417](https://bugzilla.mozilla.org/show_bug.cgi?id=1881417)

#### [#CVE-2024-3861: Potential use-after-free due to AlignedBuffer self-move](#CVE-2024-3861)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an AlignedBuffer were assigned to itself, the subsequent self-move could result in an incorrect reference count and later use-after-free.

##### References

* [Bug 1883158](https://bugzilla.mozilla.org/show_bug.cgi?id=1883158)

#### [#CVE-2024-3862: Potential use of uninitialized memory in MarkStack assignment operator on self-assignment](#CVE-2024-3862)

Reporter
Ronald Crane
Impact
moderate
##### Description

The MarkStack assignment operator, part of the JavaScript engine, could access uninitialized memory if it were used in a self-assignment.

##### References

* [Bug 1884457](https://bugzilla.mozilla.org/show_bug.cgi?id=1884457)

#### [#CVE-2024-3863: Download Protections were bypassed by .xrm-ms files on Windows](#CVE-2024-3863)

Reporter
Eduardo Braun Prado working with Trend Micro Zero Day Initiative
Impact
moderate
##### Description

The executable file warning was not presented when downloading .xrm-ms files.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1885855](https://bugzilla.mozilla.org/show_bug.cgi?id=1885855)

#### [#CVE-2024-3302: Denial of Service using HTTP/2 CONTINUATION frames](#CVE-2024-3302)

Reporter
Bartek Nowotarski via CERT
Impact
low
##### Description

There was no limit to the number of HTTP/2 CONTINUATION frames that would be processed. A server could abuse this to create an Out of Memory condition in the browser.

##### References

* [Bug 1881183](https://bugzilla.mozilla.org/show_bug.cgi?id=1881183)
* [VU#421644 - HTTP/2 CONTINUATION frames can be utilized for DoS attacks](https://kb.cert.org/vuls/id/421644)

#### [#CVE-2024-3864: Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](#CVE-2024-3864)

Reporter
Paul Bone
Impact
high
##### Description

Memory safety bug present in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9. This bug showed evidence of memory corruption and we presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](https://bugzilla.mozilla.org/show_bug.cgi?id=1888333)

#### [#CVE-2024-3865: Memory safety bugs fixed in Firefox 125](#CVE-2024-3865)

Reporter
the Mozilla Fuzzing Team, Simon Friedberger, Andrew McCreight
Impact
high
##### Description

Memory safety bugs present in Firefox 124. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 125](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1881076%2C1884887%2C1885359%2C1889049)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


