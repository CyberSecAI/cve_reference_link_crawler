- **Root cause of vulnerability:** The vulnerability stems from how WireMock Studio constructs URLs when handling user-provided input in the "Test Requester", proxy mode, and webhook functionalities. Instead of properly sanitizing and concatenating the user input, the application concatenates the input to `<http://localhost:8000>` , allowing injection of characters such as `@` to change the target URL. Specifically, user input like `@127.0.0.1:1234` is parsed by the URL parser as a new address instead of a path.
- **Weaknesses/vulnerabilities present:** Server-Side Request Forgery (SSRF) due to improper handling of user-controlled URLs. The application allows users to specify arbitrary URLs, including internal addresses, when performing requests using the "Test Requester", proxy mode, or webhooks.
- **Impact of exploitation:** Exploitation of this SSRF vulnerability allows an attacker to send requests to arbitrary services reachable from the WireMock instance, including internal services not exposed to the public internet.  This can be used to perform internal port scanning and access to internal APIs. In an AWS EC2 environment, it can expose sensitive metadata including AWS Secret Keys. An attacker can control the HTTP method, headers and data.
- **Attack vectors:**
    - **Test Requester:** Using the "Test Requester" functionality in WireMock Studio, an attacker can specify a malicious URL and perform a full read SSRF.
    - **Proxy Mode:** When proxying is configured, a user can provide a malicious URL to be proxied, resulting in a full read SSRF.
    - **Webhooks:** Webhooks can be configured with malicious URLs, enabling the attacker to send arbitrary POST requests to internal services. This can be used to achieve similar results as the other two vectors, though the response isn't returned to the user.
- **Required attacker capabilities/position:** The attacker needs to have access to the WireMock Studio administrative API or the ability to configure proxying through the WebUI. No user interaction is required for the attack to be successful. The attacker's position is logically adjacent to the vulnerable server.