=== Content from git.kernel.org_fce9d9ff_20250110_235142.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maximmi@nvidia.com> | 2021-06-10 19:40:29 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-23 14:43:57 +0200 |
| commit | [f648089337cb8ed40b2bb96e244f72b9d97dc96b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b)) | |
| tree | [bc2fe9a92dc99e4bbbd93426ac484ae74a70add2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b) | |
| parent | [56c8b8333eb18513fef821591b18082162e92ebc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=56c8b8333eb18513fef821591b18082162e92ebc) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b&id2=56c8b8333eb18513fef821591b18082162e92ebc)) | |
| download | [linux-f648089337cb8ed40b2bb96e244f72b9d97dc96b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f648089337cb8ed40b2bb96e244f72b9d97dc96b.tar.gz) | |

netfilter: synproxy: Fix out of bounds when parsing TCP options[ Upstream commit 5fc177ab759418c9537433e63301096e733fb915 ]
The TCP option parser in synproxy (synproxy\_parse\_options) could read
one byte out of bounds. When the length is 1, the execution flow gets
into the loop, reads one byte of the opcode, and if the opcode is
neither TCPOPT\_EOL nor TCPOPT\_NOP, it reads one more byte, which exceeds
the length of 1.
This fix is inspired by commit 9609dad263f8 ("ipv4: tcp\_input: fix stack
out of bounds when parsing TCP options.").
v2 changes:
Added an early return when length < 0 to avoid calling
skb\_header\_pointer with negative length.
Cc: Young Xiao <92siuyang@gmail.com>
Fixes: 48b1de4c110a ("netfilter: add SYNPROXY core/target")
Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
Reviewed-by: Florian Westphal <fw@strlen.de>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b)

| -rw-r--r-- | [net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_synproxy_core.c?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/netfilter/nf\_synproxy\_core.c b/net/netfilter/nf\_synproxy\_core.cindex b100c04a0e4359..3d6d49420db8bf 100644--- a/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=56c8b8333eb18513fef821591b18082162e92ebc)+++ b/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=f648089337cb8ed40b2bb96e244f72b9d97dc96b)@@ -31,6 +31,9 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, int length = (th->doff \* 4) - sizeof(\*th); u8 buf[40], \*ptr; + if (unlikely(length < 0))+ return false;+ ptr = skb\_header\_pointer(skb, doff + sizeof(\*th), length, buf); if (ptr == NULL) return false;@@ -47,6 +50,8 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, length--; continue; default:+ if (length < 2)+ return true; opsize = \*ptr++; if (opsize < 2) return true; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:50:19 +0000



=== Content from git.kernel.org_a310eab2_20250110_235133.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5fc177ab759418c9537433e63301096e733fb915)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5fc177ab759418c9537433e63301096e733fb915)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5fc177ab759418c9537433e63301096e733fb915)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5fc177ab759418c9537433e63301096e733fb915)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maximmi@nvidia.com> | 2021-06-10 19:40:29 +0300 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2021-06-10 14:26:18 -0700 |
| commit | [5fc177ab759418c9537433e63301096e733fb915](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5fc177ab759418c9537433e63301096e733fb915) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5fc177ab759418c9537433e63301096e733fb915)) | |
| tree | [37b7b80b5a8f0c2156bb51e9af0fd0be5fba0ea0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5fc177ab759418c9537433e63301096e733fb915) | |
| parent | [d1b5bee4c8be01585033be9b3a8878789285285f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d1b5bee4c8be01585033be9b3a8878789285285f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5fc177ab759418c9537433e63301096e733fb915&id2=d1b5bee4c8be01585033be9b3a8878789285285f)) | |
| download | [linux-5fc177ab759418c9537433e63301096e733fb915.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5fc177ab759418c9537433e63301096e733fb915.tar.gz) | |

netfilter: synproxy: Fix out of bounds when parsing TCP optionsThe TCP option parser in synproxy (synproxy\_parse\_options) could read
one byte out of bounds. When the length is 1, the execution flow gets
into the loop, reads one byte of the opcode, and if the opcode is
neither TCPOPT\_EOL nor TCPOPT\_NOP, it reads one more byte, which exceeds
the length of 1.
This fix is inspired by commit 9609dad263f8 ("ipv4: tcp\_input: fix stack
out of bounds when parsing TCP options.").
v2 changes:
Added an early return when length < 0 to avoid calling
skb\_header\_pointer with negative length.
Cc: Young Xiao <92siuyang@gmail.com>
Fixes: 48b1de4c110a ("netfilter: add SYNPROXY core/target")
Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
Reviewed-by: Florian Westphal <fw@strlen.de>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5fc177ab759418c9537433e63301096e733fb915)

| -rw-r--r-- | [net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_synproxy_core.c?id=5fc177ab759418c9537433e63301096e733fb915) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/netfilter/nf\_synproxy\_core.c b/net/netfilter/nf\_synproxy\_core.cindex b100c04a0e4359..3d6d49420db8bf 100644--- a/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=d1b5bee4c8be01585033be9b3a8878789285285f)+++ b/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=5fc177ab759418c9537433e63301096e733fb915)@@ -31,6 +31,9 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, int length = (th->doff \* 4) - sizeof(\*th); u8 buf[40], \*ptr; + if (unlikely(length < 0))+ return false;+ ptr = skb\_header\_pointer(skb, doff + sizeof(\*th), length, buf); if (ptr == NULL) return false;@@ -47,6 +50,8 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, length--; continue; default:+ if (length < 2)+ return true; opsize = \*ptr++; if (opsize < 2) return true; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:50:10 +0000



=== Content from git.kernel.org_1eee6b09_20250110_235132.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maximmi@nvidia.com> | 2021-06-10 19:40:29 +0300 |
| --- | --- | --- |
| committer | Sasha Levin <sashal@kernel.org> | 2021-06-30 08:49:14 -0400 |
| commit | [576c1526b4d83c44ad7b673cb841f36cbc6cb6c4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4)) | |
| tree | [c773e41a0b9364d972be7ab2c28072617727fa97](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4) | |
| parent | [159554cbd9a6463f7845291d3ca26965866d70ae](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=159554cbd9a6463f7845291d3ca26965866d70ae) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4&id2=159554cbd9a6463f7845291d3ca26965866d70ae)) | |
| download | [linux-576c1526b4d83c44ad7b673cb841f36cbc6cb6c4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-576c1526b4d83c44ad7b673cb841f36cbc6cb6c4.tar.gz) | |

netfilter: synproxy: Fix out of bounds when parsing TCP options[ Upstream commit 5fc177ab759418c9537433e63301096e733fb915 ]
The TCP option parser in synproxy (synproxy\_parse\_options) could read
one byte out of bounds. When the length is 1, the execution flow gets
into the loop, reads one byte of the opcode, and if the opcode is
neither TCPOPT\_EOL nor TCPOPT\_NOP, it reads one more byte, which exceeds
the length of 1.
This fix is inspired by commit 9609dad263f8 ("ipv4: tcp\_input: fix stack
out of bounds when parsing TCP options.").
v2 changes:
Added an early return when length < 0 to avoid calling
skb\_header\_pointer with negative length.
Cc: Young Xiao <92siuyang@gmail.com>
Fixes: 48b1de4c110a ("netfilter: add SYNPROXY core/target")
Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
Reviewed-by: Florian Westphal <fw@strlen.de>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4)

| -rw-r--r-- | [net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_synproxy_core.c?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/netfilter/nf\_synproxy\_core.c b/net/netfilter/nf\_synproxy\_core.cindex c8a4a48bced988..8be604eb696164 100644--- a/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=159554cbd9a6463f7845291d3ca26965866d70ae)+++ b/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=576c1526b4d83c44ad7b673cb841f36cbc6cb6c4)@@ -34,6 +34,9 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, int length = (th->doff \* 4) - sizeof(\*th); u8 buf[40], \*ptr; + if (unlikely(length < 0))+ return false;+ ptr = skb\_header\_pointer(skb, doff + sizeof(\*th), length, buf); if (ptr == NULL) return false;@@ -50,6 +53,8 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, length--; continue; default:+ if (length < 2)+ return true; opsize = \*ptr++; if (opsize < 2) return true; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:50:09 +0000



=== Content from git.kernel.org_2e616d02_20250110_235137.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maximmi@nvidia.com> | 2021-06-10 19:40:29 +0300 |
| --- | --- | --- |
| committer | Sasha Levin <sashal@kernel.org> | 2021-06-30 08:48:17 -0400 |
| commit | [7d9a9a1a88a3da574e019b4de756bc73337b3b0b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b)) | |
| tree | [2679a72ca33dd0d169b4b00c0e020e8b9a6449c0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b) | |
| parent | [0facea514ab68feb7dca82a143f99d725c066672](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0facea514ab68feb7dca82a143f99d725c066672) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b&id2=0facea514ab68feb7dca82a143f99d725c066672)) | |
| download | [linux-7d9a9a1a88a3da574e019b4de756bc73337b3b0b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7d9a9a1a88a3da574e019b4de756bc73337b3b0b.tar.gz) | |

netfilter: synproxy: Fix out of bounds when parsing TCP options[ Upstream commit 5fc177ab759418c9537433e63301096e733fb915 ]
The TCP option parser in synproxy (synproxy\_parse\_options) could read
one byte out of bounds. When the length is 1, the execution flow gets
into the loop, reads one byte of the opcode, and if the opcode is
neither TCPOPT\_EOL nor TCPOPT\_NOP, it reads one more byte, which exceeds
the length of 1.
This fix is inspired by commit 9609dad263f8 ("ipv4: tcp\_input: fix stack
out of bounds when parsing TCP options.").
v2 changes:
Added an early return when length < 0 to avoid calling
skb\_header\_pointer with negative length.
Cc: Young Xiao <92siuyang@gmail.com>
Fixes: 48b1de4c110a ("netfilter: add SYNPROXY core/target")
Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
Reviewed-by: Florian Westphal <fw@strlen.de>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b)

| -rw-r--r-- | [net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_synproxy_core.c?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/netfilter/nf\_synproxy\_core.c b/net/netfilter/nf\_synproxy\_core.cindex 353a2aa80c3cc6..04b07b63c5408e 100644--- a/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=0facea514ab68feb7dca82a143f99d725c066672)+++ b/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=7d9a9a1a88a3da574e019b4de756bc73337b3b0b)@@ -34,6 +34,9 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, int length = (th->doff \* 4) - sizeof(\*th); u8 buf[40], \*ptr; + if (unlikely(length < 0))+ return false;+ ptr = skb\_header\_pointer(skb, doff + sizeof(\*th), length, buf); if (ptr == NULL) return false;@@ -50,6 +53,8 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, length--; continue; default:+ if (length < 2)+ return true; opsize = \*ptr++; if (opsize < 2) return true; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:50:14 +0000



=== Content from git.kernel.org_7a82aee9_20250110_235140.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maximmi@nvidia.com> | 2021-06-10 19:40:29 +0300 |
| --- | --- | --- |
| committer | Sasha Levin <sashal@kernel.org> | 2021-06-30 08:49:32 -0400 |
| commit | [e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8)) | |
| tree | [8ddff694c6384c20e6c5df09bc961718cd5f65ac](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8) | |
| parent | [d6e1d9597c22c4e97f54f1269fd53f7207266a1b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d6e1d9597c22c4e97f54f1269fd53f7207266a1b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8&id2=d6e1d9597c22c4e97f54f1269fd53f7207266a1b)) | |
| download | [linux-e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8.tar.gz) | |

netfilter: synproxy: Fix out of bounds when parsing TCP options[ Upstream commit 5fc177ab759418c9537433e63301096e733fb915 ]
The TCP option parser in synproxy (synproxy\_parse\_options) could read
one byte out of bounds. When the length is 1, the execution flow gets
into the loop, reads one byte of the opcode, and if the opcode is
neither TCPOPT\_EOL nor TCPOPT\_NOP, it reads one more byte, which exceeds
the length of 1.
This fix is inspired by commit 9609dad263f8 ("ipv4: tcp\_input: fix stack
out of bounds when parsing TCP options.").
v2 changes:
Added an early return when length < 0 to avoid calling
skb\_header\_pointer with negative length.
Cc: Young Xiao <92siuyang@gmail.com>
Fixes: 48b1de4c110a ("netfilter: add SYNPROXY core/target")
Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
Reviewed-by: Florian Westphal <fw@strlen.de>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8)

| -rw-r--r-- | [net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_synproxy_core.c?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/netfilter/nf\_synproxy\_core.c b/net/netfilter/nf\_synproxy\_core.cindex c8a4a48bced988..8be604eb696164 100644--- a/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=d6e1d9597c22c4e97f54f1269fd53f7207266a1b)+++ b/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=e1eb98cfeafdd85537e7e3cefe93ca9bfbcc3ea8)@@ -34,6 +34,9 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, int length = (th->doff \* 4) - sizeof(\*th); u8 buf[40], \*ptr; + if (unlikely(length < 0))+ return false;+ ptr = skb\_header\_pointer(skb, doff + sizeof(\*th), length, buf); if (ptr == NULL) return false;@@ -50,6 +53,8 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, length--; continue; default:+ if (length < 2)+ return true; opsize = \*ptr++; if (opsize < 2) return true; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:50:17 +0000



=== Content from git.kernel.org_42fdca43_20250110_235134.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maximmi@nvidia.com> | 2021-06-10 19:40:29 +0300 |
| --- | --- | --- |
| committer | Sasha Levin <sashal@kernel.org> | 2021-06-30 08:48:49 -0400 |
| commit | [674b5f0c6a4fc5d3abce877048290cea6091fcb1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1)) | |
| tree | [a6f0ef5b8de8162b0eb31077f48feed4ccafefac](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1) | |
| parent | [88cfd542f4390f992f47ab876accb2ab789e4056](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=88cfd542f4390f992f47ab876accb2ab789e4056) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1&id2=88cfd542f4390f992f47ab876accb2ab789e4056)) | |
| download | [linux-674b5f0c6a4fc5d3abce877048290cea6091fcb1.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-674b5f0c6a4fc5d3abce877048290cea6091fcb1.tar.gz) | |

netfilter: synproxy: Fix out of bounds when parsing TCP options[ Upstream commit 5fc177ab759418c9537433e63301096e733fb915 ]
The TCP option parser in synproxy (synproxy\_parse\_options) could read
one byte out of bounds. When the length is 1, the execution flow gets
into the loop, reads one byte of the opcode, and if the opcode is
neither TCPOPT\_EOL nor TCPOPT\_NOP, it reads one more byte, which exceeds
the length of 1.
This fix is inspired by commit 9609dad263f8 ("ipv4: tcp\_input: fix stack
out of bounds when parsing TCP options.").
v2 changes:
Added an early return when length < 0 to avoid calling
skb\_header\_pointer with negative length.
Cc: Young Xiao <92siuyang@gmail.com>
Fixes: 48b1de4c110a ("netfilter: add SYNPROXY core/target")
Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
Reviewed-by: Florian Westphal <fw@strlen.de>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1)

| -rw-r--r-- | [net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_synproxy_core.c?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/netfilter/nf\_synproxy\_core.c b/net/netfilter/nf\_synproxy\_core.cindex 49bd8bb16b1817..9ff26eb0309a19 100644--- a/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=88cfd542f4390f992f47ab876accb2ab789e4056)+++ b/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=674b5f0c6a4fc5d3abce877048290cea6091fcb1)@@ -34,6 +34,9 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, int length = (th->doff \* 4) - sizeof(\*th); u8 buf[40], \*ptr; + if (unlikely(length < 0))+ return false;+ ptr = skb\_header\_pointer(skb, doff + sizeof(\*th), length, buf); if (ptr == NULL) return false;@@ -50,6 +53,8 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, length--; continue; default:+ if (length < 2)+ return true; opsize = \*ptr++; if (opsize < 2) return true; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:50:11 +0000



=== Content from git.kernel.org_bf96683c_20250110_235139.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=9cdf299ba4e153b5e56187648420de22c6216f02)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9cdf299ba4e153b5e56187648420de22c6216f02)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9cdf299ba4e153b5e56187648420de22c6216f02)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9cdf299ba4e153b5e56187648420de22c6216f02)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maximmi@nvidia.com> | 2021-06-10 19:40:29 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-23 14:42:43 +0200 |
| commit | [9cdf299ba4e153b5e56187648420de22c6216f02](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9cdf299ba4e153b5e56187648420de22c6216f02) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=9cdf299ba4e153b5e56187648420de22c6216f02)) | |
| tree | [6742aee084656c8336efa79fcf6d3d6d859476e5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9cdf299ba4e153b5e56187648420de22c6216f02) | |
| parent | [a336dc6fdd5668211e846378da0cd6b40a96a1cc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a336dc6fdd5668211e846378da0cd6b40a96a1cc) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9cdf299ba4e153b5e56187648420de22c6216f02&id2=a336dc6fdd5668211e846378da0cd6b40a96a1cc)) | |
| download | [linux-9cdf299ba4e153b5e56187648420de22c6216f02.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-9cdf299ba4e153b5e56187648420de22c6216f02.tar.gz) | |

netfilter: synproxy: Fix out of bounds when parsing TCP options[ Upstream commit 5fc177ab759418c9537433e63301096e733fb915 ]
The TCP option parser in synproxy (synproxy\_parse\_options) could read
one byte out of bounds. When the length is 1, the execution flow gets
into the loop, reads one byte of the opcode, and if the opcode is
neither TCPOPT\_EOL nor TCPOPT\_NOP, it reads one more byte, which exceeds
the length of 1.
This fix is inspired by commit 9609dad263f8 ("ipv4: tcp\_input: fix stack
out of bounds when parsing TCP options.").
v2 changes:
Added an early return when length < 0 to avoid calling
skb\_header\_pointer with negative length.
Cc: Young Xiao <92siuyang@gmail.com>
Fixes: 48b1de4c110a ("netfilter: add SYNPROXY core/target")
Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
Reviewed-by: Florian Westphal <fw@strlen.de>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9cdf299ba4e153b5e56187648420de22c6216f02)

| -rw-r--r-- | [net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_synproxy_core.c?id=9cdf299ba4e153b5e56187648420de22c6216f02) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/netfilter/nf\_synproxy\_core.c b/net/netfilter/nf\_synproxy\_core.cindex d7d34a62d3bf5f..2fc4ae960769d1 100644--- a/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=a336dc6fdd5668211e846378da0cd6b40a96a1cc)+++ b/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=9cdf299ba4e153b5e56187648420de22c6216f02)@@ -31,6 +31,9 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, int length = (th->doff \* 4) - sizeof(\*th); u8 buf[40], \*ptr; + if (unlikely(length < 0))+ return false;+ ptr = skb\_header\_pointer(skb, doff + sizeof(\*th), length, buf); if (ptr == NULL) return false;@@ -47,6 +50,8 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, length--; continue; default:+ if (length < 2)+ return true; opsize = \*ptr++; if (opsize < 2) return true; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:50:16 +0000



=== Content from git.kernel.org_09150d25_20250110_235136.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=6defc77d48eff74075b80ad5925061b2fc010d98)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6defc77d48eff74075b80ad5925061b2fc010d98)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6defc77d48eff74075b80ad5925061b2fc010d98)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6defc77d48eff74075b80ad5925061b2fc010d98)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maxim Mikityanskiy <maximmi@nvidia.com> | 2021-06-10 19:40:29 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-23 14:41:25 +0200 |
| commit | [6defc77d48eff74075b80ad5925061b2fc010d98](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6defc77d48eff74075b80ad5925061b2fc010d98) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=6defc77d48eff74075b80ad5925061b2fc010d98)) | |
| tree | [d50fbd85d106226878800c8fb0a465a963f33edb](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6defc77d48eff74075b80ad5925061b2fc010d98) | |
| parent | [ad689fec4498e6d1aa02d1c4cbb97765ab45e74e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ad689fec4498e6d1aa02d1c4cbb97765ab45e74e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6defc77d48eff74075b80ad5925061b2fc010d98&id2=ad689fec4498e6d1aa02d1c4cbb97765ab45e74e)) | |
| download | [linux-6defc77d48eff74075b80ad5925061b2fc010d98.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-6defc77d48eff74075b80ad5925061b2fc010d98.tar.gz) | |

netfilter: synproxy: Fix out of bounds when parsing TCP options[ Upstream commit 5fc177ab759418c9537433e63301096e733fb915 ]
The TCP option parser in synproxy (synproxy\_parse\_options) could read
one byte out of bounds. When the length is 1, the execution flow gets
into the loop, reads one byte of the opcode, and if the opcode is
neither TCPOPT\_EOL nor TCPOPT\_NOP, it reads one more byte, which exceeds
the length of 1.
This fix is inspired by commit 9609dad263f8 ("ipv4: tcp\_input: fix stack
out of bounds when parsing TCP options.").
v2 changes:
Added an early return when length < 0 to avoid calling
skb\_header\_pointer with negative length.
Cc: Young Xiao <92siuyang@gmail.com>
Fixes: 48b1de4c110a ("netfilter: add SYNPROXY core/target")
Signed-off-by: Maxim Mikityanskiy <maximmi@nvidia.com>
Reviewed-by: Florian Westphal <fw@strlen.de>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6defc77d48eff74075b80ad5925061b2fc010d98)

| -rw-r--r-- | [net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_synproxy_core.c?id=6defc77d48eff74075b80ad5925061b2fc010d98) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/netfilter/nf\_synproxy\_core.c b/net/netfilter/nf\_synproxy\_core.cindex 4bb4cfde28b476..c6c0d27caaed33 100644--- a/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=ad689fec4498e6d1aa02d1c4cbb97765ab45e74e)+++ b/[net/netfilter/nf\_synproxy\_core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_synproxy_core.c?id=6defc77d48eff74075b80ad5925061b2fc010d98)@@ -31,6 +31,9 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, int length = (th->doff \* 4) - sizeof(\*th); u8 buf[40], \*ptr; + if (unlikely(length < 0))+ return false;+ ptr = skb\_header\_pointer(skb, doff + sizeof(\*th), length, buf); if (ptr == NULL) return false;@@ -47,6 +50,8 @@ synproxy\_parse\_options(const struct sk\_buff \*skb, unsigned int doff, length--; continue; default:+ if (length < 2)+ return true; opsize = \*ptr++; if (opsize < 2) return true; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:50:13 +0000


