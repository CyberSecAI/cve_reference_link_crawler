```
{
  "vulnerability": {
    "root_cause": "The Bitwarden browser extension auto-fills login forms within iframes, even if those iframes originate from different domains. This behavior, combined with the default URI matching setting ('Base domain'), creates a vulnerability.",
    "weaknesses": [
      "Insecure auto-fill behavior: Bitwarden auto-fills login forms within iframes, even from different origins, which is unusual for password managers.",
      "Default URI matching: The 'Base domain' setting allows auto-filling on any subdomain of a given domain, which can be exploited if an attacker hosts content on a subdomain of a site with a login page.",
        "Lack of iframe origin validation: Bitwarden does not validate the origin of iframes before auto-filling login forms, making it susceptible to malicious iframes."
    ],
    "impact": "An attacker can steal user credentials stored in Bitwarden. If ‘Auto-fill on page load’ is enabled, no user interaction is needed. Otherwise, even a manual fill via context menu will fill the iframe.",
    "attack_vectors": [
      "A malicious actor controls an iframe embedded in a legitimate website (not sandboxed). Iframes can be injected via compromised ad networks and similar services.",
      "An attacker hosts a specially crafted web page on a subdomain of a vulnerable website. This works because the extension offers autofill on any subdomain of a domain that is stored in the vault."
    ],
    "required_capabilities": "The attacker needs to control the content of an iframe embedded on a page where a user has stored credentials in Bitwarden, or host a webpage at the subdomain level of the target domain. No compromise of the main website is necessary."
  }
}
```