```
{
  "CVE-2022-21658": {
    "description": "The Rust Security Response WG was notified that the `std::fs::remove_dir_all` standard library function is vulnerable to a race condition enabling symlink following (CWE-363). An attacker could use this security issue to trick a privileged program into deleting files and directories the attacker couldn't otherwise access or delete. This issue has been assigned CVE-2022-21658.",
    "root_cause": "The `std::fs::remove_dir_all` function incorrectly implemented a check for symbolic links leading to a Time-of-check Time-of-use (TOCTOU) race condition. The function first checked if a target was a symlink, and if not, proceeded to recursively delete. An attacker could replace a directory with a symlink between the check and the deletion, leading to the function following the symlink.",
    "vulnerabilities": [
      "Time-of-check Time-of-use (TOCTOU) race condition",
      "Incorrect handling of symbolic links"
    ],
    "impact": "An attacker with unprivileged access could trick a privileged program into deleting files and directories the attacker didn't have access to, by exploiting the TOCTOU race condition and using symlinks.",
    "attack_vectors": [
      "Local access to a system",
      "Manipulating the filesystem by creating a directory and replacing it with a symlink"
    ],
    "attacker_capabilities": "An attacker needs unprivileged access to the system and the ability to manipulate the filesystem to create a symlink."
  }
}
```