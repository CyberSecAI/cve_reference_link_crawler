- **Root cause of vulnerability:** The Church Admin plugin lacks proper authorization and CSRF protection for some actions and requested files. Specifically, the "refresh-backup" action and the temporary file containing the backup filename are accessible without authentication.
- **Weaknesses/vulnerabilities present:**
  - **Missing Authorization:** Unauthenticated users can trigger the "refresh-backup" action.
  - **Publicly Accessible Temporary File:** The temporary file (`temp.sql`) containing the backup filename is publicly accessible.
  - **Lack of CSRF Protection:** No Cross-Site Request Forgery protection is implemented for the vulnerable action.
- **Impact of exploitation:** An unauthenticated attacker can repeatedly trigger the backup process and simultaneously monitor a publicly accessible temporary file to disclose the backup filename. The attacker can then download the full database backup.
- **Attack vectors:** The attack is carried out remotely via HTTP requests, targeting specific plugin actions and files.
- **Required attacker capabilities/position:** The attacker needs no special capabilities or prior knowledge other than the affected plugin's endpoint URLs. The attacker can be unauthenticated and remote.