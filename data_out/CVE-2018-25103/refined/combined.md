=== Content from blogvdoo.wordpress.com_8ccc5274_20250111_203130.html ===

[Skip to content](#content)

[VDOO](https://blogvdoo.wordpress.com/)

Embedding Security By Design

![](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/blog_1055.png?w=1055&h=553&crop=1)
Posted on [November 6, 2018November 15, 2018](https://blogvdoo.wordpress.com/2018/11/06/giving-back-securing-open-source-iot-projects/) by [Ori Hollander](https://blogvdoo.wordpress.com/author/orivdoo/)
# Giving Back – Securing Open Source IoT Projects

For the past several months, the security research teams at VDOO have been undertaking broad-scale security research of leading IoT products, from the fields of safety and security. In most cases, the research was carried out together with the device vendors for the sake of efficiency and transparency.

The research goal is to contribute knowledge and tools to mitigate risks, as well as encourage the devices’ manufacturers to implement the right security for their products. We believe that an appropriate implementation of the security essentials will dramatically decrease the chances of exploiting vulnerabilities on the device.

Open-source projects are implemented in many connected devices. In order to provide the highest security level for those devices as well, the research focuses on some of the most common projects. The findings are then implemented in all of our automated IoT security solutions for the widest risk mitigation coverage.

As part of this research, our researchers discovered zero-day vulnerabilities in several known open-source projects. In this article, we will discuss vulnerabilities found in 3 different projects – in the popular Lighttpd web server, the Live555 Media Library and a Linux driver for the Realtek’s RTL8189ES Wi-Fi chip.

# Live555 Media Library

The [Live555 Media library](http://www.live555.com/liveMedia/) forms a set of C++ libraries for multimedia streaming, using open standard protocols (RTP/RTCP, RTSP, SIP). These libraries – which can be compiled for Unix (including Linux and Mac OS X), Windows, and QNX (and other POSIX-compliant systems) – can be used to build streaming applications. The library is in use in different projects, some that are very well-known, and it is in use in several IoT devices.

While going over the source code of the library, we found an integer overflow vulnerability, which can cause denial of service to an application using its RTSP Server functionality. The vulnerability was found in version 2018.08.05 of the liveMedia library compiled for 32-bit architectures, and it was fixed in version 2018.08.26, as seen in the [change log](http://www.live555.com/liveMedia/public/changelog.txt).

## Technical Deep-Dive

In this part of the article, all code references will be to the files in the latest vulnerable version available online that can be found [here](https://github.com/rgaufman/live555/tree/73b3e770179579c9c671fa77a5377e759efaa323).

One of the protocols that are implemented in the library is the RTSP protocol. This protocol is pretty similar to HTTP. When implementing an RTSP server application, the developer can use the **RTSPServer** class implemented in [liveMedia/RTSPServer.cpp](https://github.com/rgaufman/live555/blob/73b3e770179579c9c671fa77a5377e759efaa323/liveMedia/RTSPServer.cpp).

Eventually RTSP requests reach the function **RTSPServer::RTSPClientConnection::handleRequestBytes** ([line 607 of liveMedia/RTSPServer.cpp](https://github.com/rgaufman/live555/blob/73b3e770179579c9c671fa77a5377e759efaa323/liveMedia/RTSPServer.cpp#L607)). In the function, there is a loop intended to parse the request when it becomes a valid full request. As part of the parsing, the **Content-Length** header is parsed (if exists) to check if all the data came in (or in rare cases, if too much data was read).

The **Content-Length** header is parsed into the variable **contentLength** ([line 204 of liveMedia/RTSPCommon.cpp](https://github.com/rgaufman/live555/blob/73b3e770179579c9c671fa77a5377e759efaa323/liveMedia/RTSPCommon.cpp#L204)). The code then checks if the entire request data was received. As shown in Figure 1, it does so by comparing the amount of bytes already received (represented by the pointer reached by adding the number of bytes read altogether to the pointer that indicates the beginning of the request buffer) to the amount of bytes expected (represented by the pointer reached by adding the **contentLength** to **tmpPtr**, a pointer that indicates the end of the request headers portion). If not enough data was received yet, the handler loop breaks to allow retrieving more data before trying to parse the request’s body. This is the first place that an integer overflow could happen. If the **Content-Length** header is a number that is big enough, when added to **tmpPtr** an overflow can occur, and the pointer retrieved won’t be the correct pointer, meaning that the loop might not break. In that case, the code will immediately proceed to the parsing logic, even though it shouldn’t.

![1](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/1.png?w=525)

*Figure 1 – [line 717 of liveMedia/RTSPCommon.cpp](https://github.com/rgaufman/live555/blob/73b3e770179579c9c671fa77a5377e759efaa323/liveMedia/RTSPServer.cpp#L717) – If the expected content length is shorter than the number of bytes read by this point, the loop breaks to allow reading the remaining bytes. In a case that **contentLength** is large enough, there will be an overflow and the result of “**tmpPtr + 2 + contentLength**” will wrap around, making the “if” condition false, and the loop won’t stop.*

After passing the test, the actual RTSP parsing logic begins. Towards the end of the loop the **contentLength** variable is used again to determine if there was too much data read (line 878 in Figure 2).  To understand what happens, let’s have a look at the source code:

![2](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/2.png?w=525)

*Figure 2 – [line 878 of liveMedia/RTSPServer.cpp](https://github.com/rgaufman/live555/blob/73b3e770179579c9c671fa77a5377e759efaa323/liveMedia/RTSPServer.cpp#L878) – The **contentLength** variable is added to a pointer representing the beginning of the content portion. If the result shows that the buffer holds extra bytes, they are moved to the beginning of the buffer.*

As we can see, the code calculates the **requestSize** variable by adding the **contentLength** variable to the headers portion size (indicated by **fLastCRLF+4-fRequestBuffer**). Afterwards, the number of bytes left to read is calculated by subtracting **requestSize** from the amount of bytes already seen. Let’s see an example request:

![1](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/11.png?w=525)

Let’s assume that the request was read as a whole to the buffer and it is all parsed at one time. In this example, **fRequestBuffer** (from Figure 2) points to the beginning of the request, **fLastCRLF** points to the end of the headers, and **contentLength** is 12. The **requestSize** variable will be calculated, and the result will be the full length of the request. Since **fRequsetBytesAlreadySeen** is the length of the packet too, **numBytesRemaining** will be 0. If the result would be more than 0, that would mean that we read a few bytes from the next request, and they need to be moved to the beginning of the buffer. That’s what happens in line 883.

Now let’s examine another example:

![2](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/21.png?w=525)

Note that there is no request body here. In this case, the **contentLength** variable is very big, and it will cause the integer overflow at the beginning of the loop that we discussed earlier, meaning that the code in Figure 2 will be reached, even though it shouldn’t have. Now let’s check the calculations: The **requestSize** variable will be calculated, but this time the result will not be as expected. Since all the variables are of 32-bit length, adding 4294957237 to the headers portion length will result in an overflow, causing the **requestSize** to be smaller than the headers portion length. So, if in our example the length of the headers portion is 59 (counting every newline as two characters, ‘\r\n’), **requestSize** will be 4294957237+ 59, which is 4294957296. This number, when looking at it as a 32-bit **signed** integer is -10000. The fact that **requestSize** is unsigned does not matter, since the arithmetic operations act the same as long as all variables are of same length (32 bit in this case). Now **numBytesRemaining** will be calculated as **fRequsetBytesAlreadySeen**-(-10000). Since the number of bytes seen so far is 59, the result of the calculation will be 10059, which is more than 0, so the **if** expression on line 882 is true, causing the memory movement to happen. Let’s look at the **memmove** arguments. The destination buffer is **fRequestBuffer**, and the source buffer is **&fRequestBuffer[requestSize]**, and as you can recall, **requestSize** is now -10000, meaning that **memmove** function will start copying a number of **numBytesRemaining** bytes (which is 10059) from 10000 bytes **before** the beginning of **fRequestBuffer** to the beginning of **fRequestBuffer**.

If we look carefully, we could see that the number we gave in the **Content-Length** header (4294957237) is the unsigned representation of -10059. We can see that **numBytesRemaining** will be equal to negating **contentLength**.

Since the length of **fRequestBuffer** is REQUEST\_BUFFER\_SIZE, if **contentLength** will be equivalent to something smaller than minus REQUEST\_BUFFER\_SIZE, the result will be copying more than REQUEST\_BUFFER\_SIZE bytes to the buffer, which results in overwriting the memory that is right after **fRequestBuffer**, which holds important variables for the continuation of the flow, which can result in a crash.

As said before, the first overflow could rarely happen in a 64-bit system since the variable is still 32-bit wide (this is compiler dependent, but is true for at least one checked case), and adding it to a 64-bit pointer using unsigned operators will mostly not result in an overflow (unless the pointer starts in an extremely high memory address, which is not likely to happen), and the loop will stop at that point. The same is true for cases that the compiler compiled the variables as 16-bit variables on a 32-bit system, but that should not happen (and in the cases tested by us that didn’t happen). Since the first overflow won’t happen in 64-bit systems, the second piece of code we examined will not be reached at all, and it will not be exploitable.

# Wi-Fi “Death Packet”

While researching multiple different devices we’ve noticed that sometimes mysterious Wi-Fi packets crash the device. Looking into the crash, we discovered a serious bug in the Wi-Fi driver. The research involved trying to find the exact place of the crash and trying to understand where the code came from. We found out that large pieces of the Wi-fi driver’s code are similar to different pieces of code we found online, meaning that the vulnerability may be out there in different devices too. Narrowing down the problem, we understood that the bug affects specific drivers for the Realtek RTL8189ES Wi-Fi chip, and may also reside in drivers for other Realtek chips.

It is important to note that in most devices running modern Linux the bug does not exist anymore since all network drivers were combined in such a way that there is a main driver with extensions for each device, and there are no more drivers all meant for specific devices, but the bug still exists in older versions of Linux or in specific devices that have the old driver code in them.

## Technical Deep-Dive

Some embedded devices have a feature to enable a Wi-Fi Access Point (AP). When sending a raw Wi-Fi packet to the AP, if the source mac address of the packet is the same as the AP’s mac address (which is retrievable easily by sniffing the beacon packets), the RTL8189ES driver crashes. In the next lines we’ll explain why, by using snippets of code that we reversed from the driver. Reversing the code was made simpler by finding snippets of similar code online, and the function and variable names we used are mostly from these snippets.

When the device starts, it allocates **macid**s for stations. It starts with itself, and as can be seen in this function, a mac address equal to the adapter’s mac address gets the id of NUM\_STA (which is 32, it is actually meant to indicate that this is a special id, not to be really used):

![3](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/32.png?w=525)

Upon receiving a packet (except for beacon packets), the code in the **update\_recvframe\_phyinfo\_88e** function below gets the **macid** for the source address and saves it as **StationID** for the next functions to handle (in the function “**sa**” stands for source address):

![4](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/41.png?w=525)

One of the functions that are called during the process is **odm\_Process\_RSSIForDM**. As seen at the beginning of the function, it takes a **pEntry** from an array of “station info”s, using the **StationID** as the index into the array. After taking the **pEntry**, the function checks if it’s valid, but it does that only by checking that it isn’t NULL.

![5](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/51.png?w=525)

At the definition of **pODM\_StaInfo**, the size of the array is 32. This fact can be seen in many sources online, and that can also explain why the **NUM\_STA** constant is 32.

All this means that when sending a packet that has the source address of the AP itself, the function tries to reach index 32 of the **dm\_odm->pODM\_StaInfo** array. Since the array’s length is 32, the last index in the array is 31, thus index 32 is out of the array’s bounds. When the code tries to reach to index 32 of the **dm\_odm->pODM\_StaInfo** array, it actually takes the value of whatever is after the array in the **dm\_odm** struct, which is usually not NULL thus considered valid by the code, and when trying to dereference it as a valid **pEntry** the driver crashes.

# Lighttpd Use-After-Free Bugs

Lighttpd is a very popular open-source web-server, used among many IoT devices. While auditing lighttpd 1.4.50, we discovered 3 use-after-free bugs in the HTTP header parsing code. These security issues have been fixed [by this commit](https://github.com/lighttpd/lighttpd1.4/commit/df8e4f95614e476276a55e34da2aa8b00b1148e9#diff-8800c58d198dc86ed580c0e0b78c9a26) and are incorporated in the lighttpd version 1.4.51 release.

## Technical Deep-Dive

The **http\_request\_parse** function handles the initial parsing of incoming HTTP requests. The parsing is done line by line. During header parsing stage, when encountering any one of the “If-Modified-Since”, “If-None-Match” and “Content-Type” headers, the pointer to the header value’s string is stored in a **con->request** struct member (**con->request** holds various info regarding the current HTTP request). We’ll use the “If-Modified-Since” header as an example:

![7](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/7.png?w=525)

*Figure 1 –**<https://github.com/lighttpd/lighttpd1.4/blob/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8/src/request.c#L1092>*

The code adds the header’s key-value pair into the **con->request.headers** array.

![8](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/8.png?w=525)

*Figure 2 – <https://github.com/lighttpd/lighttpd1.4/blob/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8/src/request.c#L1123>*

*Note that **ds->value->ptr** is now the same value as Figure 1’s **con->request.http\_if\_modified\_since***

When parsing the next line of the request, if it starts with a space or tab, it is treated as the continuation of the last header’s value (due to “Line Folding” feature – as header field values can be folded onto multiple lines). In such a case, the current line’s string is appended to the last header’s value:

![9](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/9.png?w=525)

*Figure 3 – <https://github.com/lighttpd/lighttpd1.4/blob/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8/src/request.c#L959>*

Inside **buffer\_append\_string()** call, **realloc** will be called on **ds->value->ptr** as part of this sequence:

![6](https://blogvdoo.wordpress.com/wp-content/uploads/2018/11/61.png?w=525)

Depending on the values’ strings lengths, and the heap state and algorithms, the realloc may allocate a new buffer at a new location, freeing the original one.

As a result, **con->request.http\_if\_modified\_since** that was set to the old pointer will become a dangling pointer, pointing to a freed memory location.

Later accesses to these dangling pointers can then be reached, and potentially crash the server (Denial of Service), in case the original pointer’s page has been freed.

## About VDOO

VDOO is a technology-driven company that strives to change the reality of unprotected connected devices by building a products line that supports device manufacturers in embedding security into their connected devices during the development stage. In addition to developing products and services, significant efforts are invested in a wide scope research of connected devices and its supply chain.

## Credit

Ori Hollander, Senior Security Researcher, VDOO

Or Peles, Vulnerability Research Team Leader, VDOO

### Share this:

* [Twitter](https://blogvdoo.wordpress.com/2018/11/06/giving-back-securing-open-source-iot-projects/?share=twitter "Click to share on Twitter")
* [Facebook](https://blogvdoo.wordpress.com/2018/11/06/giving-back-securing-open-source-iot-projects/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://blogvdoo.wordpress.com/2018/11/06/giving-back-securing-open-source-iot-projects/?share=linkedin "Click to share on LinkedIn")
Like Loading...
### *Related*

  Categories[IoT Ecosystem](https://blogvdoo.wordpress.com/category/iot-ecosystem/), [Technical](https://blogvdoo.wordpress.com/category/technical/)

## Post navigation

[Previous PostPrevious   Integrating Security into the IoT SDLC](https://blogvdoo.wordpress.com/2018/10/08/integrating-security-into-the-iot-sdlc/)[Next PostNext Significant Vulnerability in Hikvision Cameras](https://blogvdoo.wordpress.com/2018/11/13/significant-vulnerability-in-hikvision-cameras/)

## Website

[![](https://blogvdoo.files.wordpress.com/2018/06/flaticon1529327695.png)](https://www.vdoo.com)  [VDOO Main Website](https://www.vdoo.com)

## Social

[![](https://blogvdoo.files.wordpress.com/2018/06/facebook.jpg)](https://www.facebook.com/VDOOSEC/?ref=br_rs) [![](https://blogvdoo.files.wordpress.com/2018/06/twitter.jpg?w=31)](https://twitter.com/vdoosecurity) [![](https://blogvdoo.files.wordpress.com/2018/06/linkedin.jpg?w=30)](https://www.linkedin.com/company/18333531/)

## Recent Posts

* [Working With the Community – Significant Vulnerabilities in Reolink Cameras](https://blogvdoo.wordpress.com/2019/01/08/working-with-the-community-significant-vulnerabilities-in-reolink-cameras/)
* [Significant Vulnerability in Hikvision Cameras](https://blogvdoo.wordpress.com/2018/11/13/significant-vulnerability-in-hikvision-cameras/)
* [Giving Back – Securing Open Source IoT Projects](https://blogvdoo.wordpress.com/2018/11/06/giving-back-securing-open-source-iot-projects/)
* [Integrating Security into the IoT SDLC](https://blogvdoo.wordpress.com/2018/10/08/integrating-security-into-the-iot-sdlc/)
* [The Time for Security Is Now](https://blogvdoo.wordpress.com/2018/09/24/the-time-for-security-is-now/)
## Archives

* [January 2019](https://blogvdoo.wordpress.com/2019/01/)
* [November 2018](https://blogvdoo.wordpress.com/2018/11/)
* [October 2018](https://blogvdoo.wordpress.com/2018/10/)
* [September 2018](https://blogvdoo.wordpress.com/2018/09/)
* [August 2018](https://blogvdoo.wordpress.com/2018/08/)
* [July 2018](https://blogvdoo.wordpress.com/2018/07/)
* [June 2018](https://blogvdoo.wordpress.com/2018/06/)
* [May 2018](https://blogvdoo.wordpress.com/2018/05/)
* [April 2018](https://blogvdoo.wordpress.com/2018/04/)
* [March 2018](https://blogvdoo.wordpress.com/2018/03/)
* [January 2018](https://blogvdoo.wordpress.com/2018/01/)
* [December 2017](https://blogvdoo.wordpress.com/2017/12/)
## Categories

* [About Us](https://blogvdoo.wordpress.com/category/about-us/)
* [IoT Ecosystem](https://blogvdoo.wordpress.com/category/iot-ecosystem/)
* [IoT Revolution](https://blogvdoo.wordpress.com/category/iot-revolution/)
* [Technical](https://blogvdoo.wordpress.com/category/technical/)
* [Uncategorized](https://blogvdoo.wordpress.com/category/uncategorized/)

* [Facebook](https://www.facebook.com/VDOOSEC/ "VDOO")
* [LinkedIn](https://www.linkedin.com/company/vdoo/)
* [Twitter](https://twitter.com/vdoosecurity?lang=en)

* Reblog
* Subscribe
  Subscribed

  + [![](https://blogvdoo.wordpress.com/wp-content/uploads/2018/01/cropped-vdoo_sign_blue.png?w=50) VDOO](https://blogvdoo.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fblogvdoo.wordpress.com%2F2018%2F11%2F06%2Fgiving-back-securing-open-source-iot-projects%2F&signup_flow=account)
* Privacy
* + [![](https://blogvdoo.wordpress.com/wp-content/uploads/2018/01/cropped-vdoo_sign_blue.png?w=50) VDOO](https://blogvdoo.wordpress.com)
  + [Customize](https://blogvdoo.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fblogvdoo.wordpress.com%2F2018%2F11%2F06%2Fgiving-back-securing-open-source-iot-projects%2F)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fblogvdoo.wordpress.com%2F2018%2F11%2F06%2Fgiving-back-securing-open-source-iot-projects%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p9vWJv-bS)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blogvdoo.wordpress.com/2018/11/06/giving-back-securing-open-source-iot-projects/)
  + [View post in Reader](https://wordpress.com/read/blogs/140600965/posts/736)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from github.com_438ab228_20250111_203131.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flighttpd%2Flighttpd1.4%2Fcommit%2Fd161f53de04bc826ce1bdaeb3dce2c72ca50a3f8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flighttpd%2Flighttpd1.4%2Fcommit%2Fd161f53de04bc826ce1bdaeb3dce2c72ca50a3f8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lighttpd%2Flighttpd1.4)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lighttpd](/lighttpd)
/
**[lighttpd1.4](/lighttpd/lighttpd1.4)**
Public

* [Notifications](/login?return_to=%2Flighttpd%2Flighttpd1.4) You must be signed in to change notification settings
* [Fork
  286](/login?return_to=%2Flighttpd%2Flighttpd1.4)
* [Star
   623](/login?return_to=%2Flighttpd%2Flighttpd1.4)

* [Code](/lighttpd/lighttpd1.4)
* [Pull requests
  1](/lighttpd/lighttpd1.4/pulls)
* [Actions](/lighttpd/lighttpd1.4/actions)
* [Security](/lighttpd/lighttpd1.4/security)
* [Insights](/lighttpd/lighttpd1.4/pulse)

Additional navigation options

* [Code](/lighttpd/lighttpd1.4)
* [Pull requests](/lighttpd/lighttpd1.4/pulls)
* [Actions](/lighttpd/lighttpd1.4/actions)
* [Security](/lighttpd/lighttpd1.4/security)
* [Insights](/lighttpd/lighttpd1.4/pulse)

## Commit

[Permalink](/lighttpd/lighttpd1.4/commit/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[core] security: use-after-free invalid Range req

[Browse files](/lighttpd/lighttpd1.4/tree/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8)
Browse the repository at this point in the history

```
(thx Marcus Wengelin)
```

* Loading branch information

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=40&v=4)](/gstrauss)

[gstrauss](/lighttpd/lighttpd1.4/commits?author=gstrauss "View all commits by gstrauss")
committed
Aug 12, 2018

1 parent
[1de1746](/lighttpd/lighttpd1.4/commit/1de1746925813ed2571f862ad81cfc0df2069b37)

commit d161f53

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**75 additions**
and
**53 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/base.h
    [base.h](#diff-129ad0b5fc27e3ed3d2564e5dcf3baddd819f186e10b7a734038fa1a0b2b4a33)
  + src/connections.c
    [connections.c](#diff-f73da2f5a22e9e3b8fc4b928282446be064ca963fc12733689eeb2b0350c5ccb)
  + src/http-header-glue.c
    [http-header-glue.c](#diff-0d7cbd57ec01c8d201a82d1d4d085bb7a62ae2a45d48b463b374757a0189fa81)
  + src/request.c
    [request.c](#diff-97993831af601b77f01a192a52a79768f99ad758db5fc433acf165c2b5451589)
  + t

    - src/t/test\_request.c
      [test\_request.c](#diff-2a911b997ed7231ab419b3cd7e37f49c6e9ca39b43bcfa6ea7bf476324971c75)
* tests

  + tests/request.t
    [request.t](#diff-a30162d6308ffefff17102921cb02dba2170068ff473e1f040ccf0eae7d826e2)

## There are no files selected for viewing

4 changes: 0 additions & 4 deletions

4
[src/base.h](#diff-129ad0b5fc27e3ed3d2564e5dcf3baddd819f186e10b7a734038fa1a0b2b4a33 "src/base.h")

Show comments

[View file](/lighttpd/lighttpd1.4/blob/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8/src/base.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -47,7 +47,6 @@ typedef struct { |
|  |  |  |
|  |  | /\* strings to the header \*/ |
|  |  | buffer \*http\_host; /\* not alloced \*/ |
|  |  | const char \*http\_range; |
|  |  | const char \*http\_content\_type; |
|  |  | const char \*http\_if\_modified\_since; |
|  |  | const char \*http\_if\_none\_match; |
| Expand All | | @@ -58,9 +57,6 @@ typedef struct { |
|  |  | off\_t content\_length; /\* returned by strtoll() \*/ |
|  |  | off\_t te\_chunked; |
|  |  |  |
|  |  | /\* internal representation \*/ |
|  |  | int accept\_encoding; |
|  |  |  |
|  |  | /\* internal \*/ |
|  |  | buffer \*pathinfo; |
|  |  | } request; |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[src/connections.c](#diff-f73da2f5a22e9e3b8fc4b928282446be064ca963fc12733689eeb2b0350c5ccb "src/connections.c")

Show comments

[View file](/lighttpd/lighttpd1.4/blob/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8/src/connections.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -685,7 +685,6 @@ int connection\_reset(server \*srv, connection \*con) { |
|  |  | con->request.x = NULL; |
|  |  |  |
|  |  | CLEAN(http\_host); |
|  |  | CLEAN(http\_range); |
|  |  | CLEAN(http\_content\_type); |
|  |  | #undef CLEAN |
|  |  | con->request.content\_length = 0; |
| Expand Down | |  |

45 changes: 25 additions & 20 deletions

45
[src/http-header-glue.c](#diff-0d7cbd57ec01c8d201a82d1d4d085bb7a62ae2a45d48b463b374757a0189fa81 "src/http-header-glue.c")

Show comments

[View file](/lighttpd/lighttpd1.4/blob/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8/src/http-header-glue.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -229,7 +229,7 @@ int http\_response\_handle\_cachable(server \*srv, connection \*con, buffer \*mtime) { |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | static int http\_response\_parse\_range(server \*srv, connection \*con, buffer \*path, stat\_cache\_entry \*sce) { |
|  |  | static int http\_response\_parse\_range(server \*srv, connection \*con, buffer \*path, stat\_cache\_entry \*sce, const char \*range) { |
|  |  | int multipart = 0; |
|  |  | int error; |
|  |  | off\_t start, end; |
| Expand All | | @@ -247,11 +247,26 @@ static int http\_response\_parse\_range(server \*srv, connection \*con, buffer \*path, |
|  |  | content\_type = ds->value; |
|  |  | } |
|  |  |  |
|  |  | for (s = con->request.http\_range, error = 0; |
|  |  | for (s = range, error = 0; |
|  |  | !error && \*s && NULL != (minus = strchr(s, '-')); ) { |
|  |  | char \*err; |
|  |  | off\_t la, le; |
|  |  |  |
|  |  | if (s != minus) { |
|  |  | la = strtoll(s, &err, 10); |
|  |  | if (err != minus) { |
|  |  | /\* should not have multiple range-unit in Range, but |
|  |  | \* handle just in case multiple Range headers merged \*/ |
|  |  | while (\*s == ' ' || \*s == '\t') ++s; |
|  |  | if (0 != strncmp(s, "bytes=", 6)) return -1; |
|  |  | s += 6; |
|  |  | if (s != minus) { |
|  |  | la = strtoll(s, &err, 10); |
|  |  | if (err != minus) return -1; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (s == minus) { |
|  |  | /\* -<stop> \*/ |
|  |  |  |
| Expand Down  Expand Up | | @@ -281,9 +296,6 @@ static int http\_response\_parse\_range(server \*srv, connection \*con, buffer \*path, |
|  |  | } else if (\*(minus+1) == '\0' || \*(minus+1) == ',') { |
|  |  | /\* <start>- \*/ |
|  |  |  |
|  |  | la = strtoll(s, &err, 10); |
|  |  |  |
|  |  | if (err == minus) { |
|  |  | /\* ok \*/ |
|  |  |  |
|  |  | if (\*(err + 1) == '\0') { |
| Expand All | | @@ -301,16 +313,9 @@ static int http\_response\_parse\_range(server \*srv, connection \*con, buffer \*path, |
|  |  | } else { |
|  |  | error = 1; |
|  |  | } |
|  |  | } else { |
|  |  | /\* error \*/ |
|  |  | error = 1; |
|  |  | } |
|  |  | } else { |
|  |  | /\* <start>-<stop> \*/ |
|  |  |  |
|  |  | la = strtoll(s, &err, 10); |
|  |  |  |
|  |  | if (err == minus) { |
|  |  | le = strtoll(minus+1, &err, 10); |
|  |  |  |
|  |  | /\* RFC 2616 - 14.35.1 \*/ |
| Expand All | | @@ -335,11 +340,6 @@ static int http\_response\_parse\_range(server \*srv, connection \*con, buffer \*path, |
|  |  |  |
|  |  | error = 1; |
|  |  | } |
|  |  | } else { |
|  |  | /\* error \*/ |
|  |  |  |
|  |  | error = 1; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (!error) { |
| Expand Down  Expand Up | | @@ -516,9 +516,11 @@ void http\_response\_send\_file (server \*srv, connection \*con, buffer \*path) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (con->request.http\_range && con->conf.range\_requests |
|  |  | if (con->conf.range\_requests |
|  |  | && (200 == con->http\_status || 0 == con->http\_status) |
|  |  | && NULL != (ds = (data\_string \*)array\_get\_element(con->request.headers, "Range")) |
|  |  | && NULL == array\_get\_element(con->response.headers, "Content-Encoding")) { |
|  |  | buffer \*range = ds->value; |
|  |  | int do\_range\_request = 1; |
|  |  | /\* check if we have a conditional GET \*/ |
|  |  |  |
| Expand Down  Expand Up | | @@ -547,11 +549,14 @@ void http\_response\_send\_file (server \*srv, connection \*con, buffer \*path) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (do\_range\_request) { |
|  |  | if (do\_range\_request |
|  |  | && !buffer\_string\_is\_empty(range) |
|  |  | && 0 == strncmp(range->ptr, "bytes=", 6)) { |
|  |  | /\* support only "bytes" byte-unit \*/ |
|  |  | /\* content prepared, I'm done \*/ |
|  |  | con->file\_finished = 1; |
|  |  |  |
|  |  | if (0 == http\_response\_parse\_range(srv, con, path, sce)) { |
|  |  | if (0 == http\_response\_parse\_range(srv, con, path, sce, range->ptr+6)) { |
|  |  | con->http\_status = 206; |
|  |  | } |
|  |  | return; |
| Expand Down | |  |

24 changes: 0 additions & 24 deletions

24
[src/request.c](#diff-97993831af601b77f01a192a52a79768f99ad758db5fc433acf165c2b5451589 "src/request.c")

Show comments

[View file](/lighttpd/lighttpd1.4/blob/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8/src/request.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1118,30 +1118,6 @@ int http\_request\_parse(server \*srv, connection \*con) { |
|  |  | ds->free((data\_unset\*) ds); |
|  |  | ds = NULL; |
|  |  | } |
|  |  | } else if (cmp > 0 && 0 == (cmp = buffer\_caseless\_compare(CONST\_BUF\_LEN(ds->key), CONST\_STR\_LEN("Range")))) { |
|  |  | if (!con->request.http\_range) { |
|  |  | /\* bytes=.\*-.\* \*/ |
|  |  |  |
|  |  | if (0 == strncasecmp(ds->value->ptr, "bytes=", 6) && |
|  |  | NULL != strchr(ds->value->ptr+6, '-')) { |
|  |  |  |
|  |  | /\* if dup, only the first one will survive \*/ |
|  |  | con->request.http\_range = ds->value->ptr + 6; |
|  |  | } |
|  |  | } else { |
|  |  | con->http\_status = 400; |
|  |  | con->keep\_alive = 0; |
|  |  |  |
|  |  | if (srv->srvconf.log\_request\_header\_on\_error) { |
|  |  | log\_error\_write(srv, \_\_FILE\_\_, \_\_LINE\_\_, "s", |
|  |  | "duplicate Range-header -> 400"); |
|  |  | log\_error\_write(srv, \_\_FILE\_\_, \_\_LINE\_\_, "Sb", |
|  |  | "request-header:\n", |
|  |  | con->request.request); |
|  |  | } |
|  |  | array\_insert\_unique(con->request.headers, (data\_unset \*)ds); |
|  |  | return 0; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (ds) array\_insert\_unique(con->request.headers, (data\_unset \*)ds); |
| Expand Down | |  |

32 changes: 29 additions & 3 deletions

32
[src/t/test\_request.c](#diff-2a911b997ed7231ab419b3cd7e37f49c6e9ca39b43bcfa6ea7bf476324971c75 "src/t/test_request.c")

Show comments

[View file](/lighttpd/lighttpd1.4/blob/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8/src/t/test_request.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,7 +13,6 @@ static void test\_request\_connection\_reset(connection \*con) |
|  |  | con->request.http\_method = HTTP\_METHOD\_UNSET; |
|  |  | con->request.http\_version = HTTP\_VERSION\_UNSET; |
|  |  | con->request.http\_host = NULL; |
|  |  | con->request.http\_range = NULL; |
|  |  | con->request.http\_content\_type = NULL; |
|  |  | con->request.http\_if\_modified\_since = NULL; |
|  |  | con->request.http\_if\_none\_match = NULL; |
| Expand Down  Expand Up | | @@ -372,13 +371,40 @@ static void test\_request\_http\_request\_parse(server \*srv, connection \*con) |
|  |  | "Content-Type: 4\r\n" |
|  |  | "\r\n")); |
|  |  |  |
|  |  | run\_http\_request\_parse(srv, con, \_\_LINE\_\_, 400, |
|  |  | "Duplicate Range headers", |
|  |  | /\* (not actually testing Range here anymore; parsing deferred until use) \*/ |
|  |  |  |
|  |  | run\_http\_request\_parse(srv, con, \_\_LINE\_\_, 0, |
|  |  | "Duplicate Range headers (get appended)", |
|  |  | CONST\_STR\_LEN("GET / HTTP/1.0\r\n" |
|  |  | "Range: bytes=5-6\r\n" |
|  |  | "Range: bytes=5-9\r\n" |
|  |  | "\r\n")); |
|  |  |  |
|  |  | run\_http\_request\_parse(srv, con, \_\_LINE\_\_, 0, |
|  |  | "Duplicate Range headers with invalid range (a)", |
|  |  | CONST\_STR\_LEN("GET / HTTP/1.0\r\n" |
|  |  | "Range: bytes=0\r\n" |
|  |  | "Range: bytes=5-9\r\n" |
|  |  | "\r\n")); |
|  |  | run\_http\_request\_parse(srv, con, \_\_LINE\_\_, 0, |
|  |  | "Duplicate Range headers with invalid range (b)", |
|  |  | CONST\_STR\_LEN("GET / HTTP/1.0\r\n" |
|  |  | "Range: bytes=5-9\r\n" |
|  |  | "Range: bytes=0\r\n" |
|  |  | "\r\n")); |
|  |  | run\_http\_request\_parse(srv, con, \_\_LINE\_\_, 0, |
|  |  | "Duplicate Range headers with invalid range (c)", |
|  |  | CONST\_STR\_LEN("GET / HTTP/1.0\r\n" |
|  |  | "Range: 0\r\n" |
|  |  | "Range: bytes=5-9\r\n" |
|  |  | "\r\n")); |
|  |  | run\_http\_request\_parse(srv, con, \_\_LINE\_\_, 0, |
|  |  | "Duplicate Range headers with invalid range (d)", |
|  |  | CONST\_STR\_LEN("GET / HTTP/1.0\r\n" |
|  |  | "Range: bytes=5-9\r\n" |
|  |  | "Range: 0\r\n" |
|  |  | "\r\n")); |
|  |  |  |
|  |  | run\_http\_request\_parse(srv, con, \_\_LINE\_\_, 0, |
|  |  | "Duplicate If-None-Match headers", |
|  |  | CONST\_STR\_LEN("GET / HTTP/1.0\r\n" |
| Expand Down | |  |

22 changes: 21 additions & 1 deletion

22
[tests/request.t](#diff-a30162d6308ffefff17102921cb02dba2170068ff473e1f040ccf0eae7d826e2 "tests/request.t")

Show comments

[View file](/lighttpd/lighttpd1.4/blob/d161f53de04bc826ce1bdaeb3dce2c72ca50a3f8/tests/request.t)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,7 +8,7 @@ BEGIN { |
|  |  |  |
|  |  | use strict; |
|  |  | use IO::Socket; |
|  |  | use Test::More tests => 50; |
|  |  | use Test::More tests => 52; |
|  |  | use LightyTest; |
|  |  |  |
|  |  | my $tf = LightyTest->new(); |
| Expand Down  Expand Up | | @@ -391,6 +391,26 @@ EOF |
|  |  | $t->{RESPONSE} = [ { 'HTTP-Protocol' => 'HTTP/1.0', 'HTTP-Status' => 200 } ]; |
|  |  | ok($tf->handle\_http($t) == 0, 'GET, Range with range-requests-disabled'); |
|  |  |  |
|  |  | $t->{REQUEST} = ( <<EOF |
|  |  | GET /12345.txt HTTP/1.0 |
|  |  | Host: 123.example.org |
|  |  | Range: 0 |
|  |  | Range: bytes=0-3 |
|  |  | EOF |
|  |  | ); |
|  |  | $t->{RESPONSE} = [ { 'HTTP-Protocol' => 'HTTP/1.0', 'HTTP-Status' => 200, 'HTTP-Content' => "12345\n" } ]; |
|  |  | ok($tf->handle\_http($t) == 0, 'GET, Range invalid range-unit (first)'); |
|  |  |  |
|  |  | $t->{REQUEST} = ( <<EOF |
|  |  | GET /12345.txt HTTP/1.0 |
|  |  | Host: 123.example.org |
|  |  | Range: bytes=0-3 |
|  |  | Range: 0 |
|  |  | EOF |
|  |  | ); |
|  |  | $t->{RESPONSE} = [ { 'HTTP-Protocol' => 'HTTP/1.0', 'HTTP-Status' => 206 } ]; |
|  |  | ok($tf->handle\_http($t) == 0, 'GET, Range ignore invalid range (second)'); |
|  |  |  |
|  |  | $t->{REQUEST} = ( <<EOF |
|  |  | OPTIONS / HTTP/1.0 |
|  |  | Content-Length: 4 |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d161f53`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flighttpd%2Flighttpd1.4%2Fcommit%2Fd161f53de04bc826ce1bdaeb3dce2c72ca50a3f8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from 9443417.fs1.hubspotusercontent-na1.net_c4400cda_20250111_203129.html ===
AMI Security Advisory

OSS Vulnerability - MegaRAC SPX

ID: AMI-SA-2024002 | July 09, 2024

INTRODUCTION

AMI’s Product Security Incident Response Team (PSIRT) responded to a notification of a security
vulnerability in an OSS package used in the SPx line of products.

Note: The CVE-2024-3708 used in revision 1.0 document has been retired in favor of CVE-2018-25103 created by
CERTCC

SECURITY VULNERABILITIES AND REMEDIATION INFORMATION

Vulnerability

CVSS Vector

CVSS
Score

CWE

Fix Version

CVE-2018-25103

CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:L/VI:N/
VA:L/SC:N/SI:N/SA:N

2.3

CWE-113

SPx_12.7+

SPx_13.6

Change History

Date
4-15-2024
7-09-2024

Revision
1.00
2.00

Description
First publication of document
Updated the CVE-2018-25103 and Fixed version

For additional information AMI Security Center or email mediasecurityinqueries@ami.com



=== Content from www.runzero.com_61561219_20250111_203133.html ===

[ðï¸ Sign up for the 2025 runZero Hour webcast series and never miss a new episode!
Register Now](/research/runzero-hour/)

[Start Free](/try/)
[Book Demo](/contact-sales/)

* [Platform](/platform/)
  + [Overview](/platform/)

    The runZero Platform provides complete security visibility across IT, OT, IoT, cloud, mobile, and remote assets so that you can see and secure everything on your network.

    - [Attack Surface Management](/platform/attack-surface-management/)
    - [Exposure Mitigation](/platform/exposure-mitigation/)
    - [Risk & Compliance](/platform/risk-compliance/)
    - [Fast Deployment & Scalability](/platform/fast-deployment-scalability/)
  + [Integrations](/platform/integrations/)

    runZero seamlessly integrates with a wide variety of tools, enhancing network visibility, enriching asset data, and uncovering control gaps.
  + [Community Edition](/platform/community-edition/)

    Our completely free version of the runZero Platform is ideal for home use and environments with fewer than 100 assets.

  GartnerÂ® Peer Insightsâ¢ Customers' Choice for CAASM

  runZero has been recognized as a Customersâ Choice for cyber asset attack surface management (CAASM) in the 2024 Gartner Voice of the Customer report.

  [Get the Report](/gartner-customer-choice-2024/)
* [Resources](/resources/)
  + [runZero Blog](/blog/)

    See what's happening at runZero and read up on the latest ideas, opinions, and articles from our experts and researchers.
  + [runZero Research](/research/)

    Explore the world of exposure management through the runZero lens.

    - [Research Blogs](/blog/runzero-research/)
    - [Rapid Responses](/blog/rapid-response/)
  + [Resource Center](/resources/)

    Dive into a treasure trove of resources to expand your exposure management knowledge.

    - [Reports](/resources/report/)
    - [Webcasts](/resources/webcast/)
    - [Solution Briefs](/resources/solution-brief/)
    - [Product Videos](/resources/product-video/)
  + [Support Resources](https://help.runzero.com/)

    Everything you need to maximize your experience with the runZero Platform.

    - [Documentation](https://help.runzero.com/docs/)
    - [REST API](https://app.swaggerhub.com/apis/runZero/runZero/)
    - [Open Source](https://github.com/runZeroInc/)
    - [Changelog](https://help.runzero.com/docs/release-notes/)

  SSHamble is now available!

  Our researchers discovered a broad range of weaknesses across SSH implementations and applications that impact critical network security devices and software. These long standing issues have remained undiscovered due to the lack of tooling available. Enter SSHamble, our new open source tool.

  [Get SSHamble](/sshamble/)
* [Pricing](/pricing/)
* [Customers](/customers/)
  + [Our Customers](/customers/)

    Our customers are everything. We're super proud to be trusted by leading organizations around the globe to help them improve their security.
  + [Case Studies](/customers/#case-studies)

    See how runZero has empowered security teams to take control of their networks, uncover their unknowns, and save significant time and money.
  + [Testimonials](/customers/testimonials/)

    Read reviews of the runZero Platform and see how teams have improved their security with our technology.

  New Report Published by the U.S. Department of Energy

  CECA evaluations confirm runZero's active scanning enhances ICS visibility without performance impact on SCADA.

  [Read the Report](/nrel-ceca-report/)
* [Partners](/partners/)
  + [Infinity Partner Program](/partners/)

    See how we can work together to provide best-in-class security solutions and outcomes for our joint customers.
  + [Partner Directory](/partners/directory/)

    Explore our directory of trusted (and awesome) partners.
  + [Partner Sign In](https://partners.runzero.com/login)

    Sign in to our Infinity Partner Portal.

  Join our Infinity Partner Program

  Designed with a partner-first mindset, the runZero Infinity Partner Program offers incredibly valuable resources, relationships, and rewards to partners who choose to grow their business with us.

  [Become a runZero Partner](/partners/)
* [About](/about/)
  + [About Us](/about/)

    Wondering who the heck are these people? Meet the team and get the story behind runZero... once upon a time called Rumble.
  + [Events](/about/events/)

    Track down runZero Yetis in the wild! Join us in-person or virtually at one of our upcoming events.

    - [runZero Hour](/research/runzero-hour/)
  + [Investors](/about/investors/)

    Meet the cybersecurity investors, trailblazers, and innovators who help us navigate our journey and the evolving security landscape.
  + [Newsroom](/about/newsroom/)

    Read the latest articles, announcements, and press releases from runZero.
  + [Careers](/about/careers/)

    Want to join our forces? We're looking for bright minds and passionate souls who want to write the next chapter in exposure management.

  runZero Research Report: Volume 1

  As a leading CAASM platform, runZero has a unique, insiderâs perspective on the state of asset security. See the alarming gaps & unexpected exposures that our research team uncovered.

  [Get the Research Report](/research-report/)

* [Support](https://help.runzero.com)
* [Contact Us](/contact-us/)
* [Sign In](https://console.runzero.com/login)

[ðï¸ Sign up for the 2025 runZero Hour webcast series and never miss a new episode!
Register Now](/research/runzero-hour/)

* [Support](https://help.runzero.com)
* [Contact Us](/contact-us/)
* [Sign In](https://console.runzero.com/login)

[![runZero CAASM](/runzero-cyber-asset-attacks-surface-management.svg)](https://www.runzero.com/)

* [Platform](/platform/)
* [Resources](/resources/)
* [Pricing](/pricing/)
* [Customers](/customers/)
* [Partners](/partners/)
* [About](/about/)

[Start Free](/try/)
[Book Demo](/contact-sales/)

CAASM with its own powerful, proprietary active & passive discovery... not just the same old integrations.

* [Overview](/platform/)

  The runZero Platform provides complete security visibility across IT, OT, IoT, cloud, mobile, and remote assets so that you can see and secure everything on your network.

  + [Attack Surface Management](/platform/attack-surface-management/)
  + [Exposure Mitigation](/platform/exposure-mitigation/)
  + [Risk & Compliance](/platform/risk-compliance/)
  + [Fast Deployment & Scalability](/platform/fast-deployment-scalability/)
* [Integrations](/platform/integrations/)

  runZero seamlessly integrates with a wide variety of tools, enhancing network visibility, enriching asset data, and uncovering control gaps.
* [Community Edition](/platform/community-edition/)

  Our completely free version of the runZero Platform is ideal for home use and environments with fewer than 100 assets.

![](/uploads/assets/newsroom/Awards/2024-07-Gartner-PI-Customers-Choice/2024_05_DIGITAL_Award_GartnerPI_Web-Navigation-Tout.webp)

GartnerÂ® Peer Insightsâ¢ Customers' Choice for CAASM

runZero has been recognized as a Customersâ Choice for cyber asset attack surface management (CAASM) in the 2024 Gartner Voice of the Customer report.

[Get the Report](/gartner-customer-choice-2024/)

Explore our latest research, resources, & insights on all things exposure management.

* [runZero Blog](/blog/)

  See what's happening at runZero and read up on the latest ideas, opinions, and articles from our experts and researchers.
* [runZero Research](/research/)

  Explore the world of exposure management through the runZero lens.

  + [Research Blogs](/blog/runzero-research/)
  + [Rapid Responses](/blog/rapid-response/)
* [Resource Center](/resources/)

  Dive into a treasure trove of resources to expand your exposure management knowledge.

  + [Reports](/resources/report/)
  + [Webcasts](/resources/webcast/)
  + [Solution Briefs](/resources/solution-brief/)
  + [Product Videos](/resources/product-video/)
* [Support Resources](https://help.runzero.com/)

  Everything you need to maximize your experience with the runZero Platform.

  + [Documentation](https://help.runzero.com/docs/)
  + [REST API](https://app.swaggerhub.com/apis/runZero/runZero/)
  + [Open Source](https://github.com/runZeroInc/)
  + [Changelog](https://help.runzero.com/docs/release-notes/)

![](/uploads/assets/resources/SSHamble/2024_07_TOOL_SSHamble_FInal_Navigation-Tout.webp)

SSHamble is now available!

Our researchers discovered a broad range of weaknesses across SSH implementations and applications that impact critical network security devices and software. These long standing issues have remained undiscovered due to the lack of tooling available. Enter SSHamble, our new open source tool.

[Get SSHamble](/sshamble/)

See why the brands you know & love trust runZero.

* [Our Customers](/customers/)

  Our customers are everything. We're super proud to be trusted by leading organizations around the globe to help them improve their security.
* [Case Studies](/customers/#case-studies)

  See how runZero has empowered security teams to take control of their networks, uncover their unknowns, and save significant time and money.
* [Testimonials](/customers/testimonials/)

  Read reviews of the runZero Platform and see how teams have improved their security with our technology.

![](/uploads/assets/resources/CECA-Report/nrel-ceca-navigation-tout.webp)

New Report Published by the U.S. Department of Energy

CECA evaluations confirm runZero's active scanning enhances ICS visibility without performance impact on SCADA.

[Read the Report](/nrel-ceca-report/)

We're on a mission to create new solutions to solve persistent problems. Let's shake things up.

* [About Us](/about/)

  Wondering who the heck are these people? Meet the team and get the story behind runZero... once upon a time called Rumble.
* [Events](/about/events/)

  Track down runZero Yetis in the wild! Join us in-person or virtually at one of our upcoming events.

  + [runZero Hour](/research/runzero-hour/)
* [Investors](/about/investors/)

  Meet the cybersecurity investors, trailblazers, and innovators who help us navigate our journey and the evolving security landscape.
* [Newsroom](/about/newsroom/)

  Read the latest articles, announcements, and press releases from runZero.
* [Careers](/about/careers/)

  Want to join our forces? We're looking for bright minds and passionate souls who want to write the next chapter in exposure management.

![](/uploads/assets/research-report/volume1/2024_05_REPORT_Research_Vol1_DIgital_Tile-OG_Navigation-Tout.webp)

runZero Research Report: Volume 1

As a leading CAASM platform, runZero has a unique, insiderâs perspective on the state of asset security. See the alarming gaps & unexpected exposures that our research team uncovered.

[Get the Research Report](/research-report/)

Believe customers always come first? Into innovation & the unconventional? We might be great partners.

* [Infinity Partner Program](/partners/)

  See how we can work together to provide best-in-class security solutions and outcomes for our joint customers.
* [Partner Directory](/partners/directory/)

  Explore our directory of trusted (and awesome) partners.
* [Partner Sign In](https://partners.runzero.com/login)

  Sign in to our Infinity Partner Portal.

![](/uploads/assets/partners/Partner-Tout-Images/Navigation-Featured-Cards_Partner-Grid-6.webp)

Join our Infinity Partner Program

Designed with a partner-first mindset, the runZero Infinity Partner Program offers incredibly valuable resources, relationships, and rewards to partners who choose to grow their business with us.

[Become a runZero Partner](/partners/)

![Blog background pattern](/images/backgrounds/blog-top-right-pattern.svg)

1. [runZero Blog](/blog/)
   /
2. [Rapid Response](https://www.runzero.com/blog/rapid-response/)

On This Page:

1. [Latest lighttpd vulnerability](#latest-lighttpd-vulnerability)
2. [What is the impact?](#what-is-the-impact)
3. [Are updates or workarounds available?](#are-updates-or-workarounds-available)
4. [How do I find potentially vulnerable systems with runZero?](#how-do-i-find-potentially-vulnerable-systems-with-runZero)
5. [Known devices with outdated lighttpd installations](#known-devices-with-outdated-lighttpd-installations)

# How to find outdated lighttpd services

![](/uploads/assets/contributors/duo-tone/Authors_BlainSmith.webp)
[Blain Smith](/authors/blain-smith/)

![](/uploads/assets/contributors/duo-tone/Authors_HDMoore.webp)

[HD Moore](/authors/hd-moore/)

![](/uploads/assets/contributors/duo-tone/Authors_TomSellers.webp)

[Tom Sellers](/authors/tom-sellers/)

 |
Updated April 12, 2024, 10:00am EDT

---

## Latest lighttpd vulnerability [#](#latest-lighttpd-vulnerability)

On April 11th, 2024 Binarly [published research](https://www.binarly.io/blog/lighttpd-gains-new-life) showing that Baseboard Management Controllers (BMC) derived from the AMI MegaRAC product include older versions of the open source [lighttpd](https://www.lighttpd.net/) web server. Specifically, their research noted that lighttpd versions prior to 1.4.51 are susceptible to an information leak due to a string comparison against a stale pointer. This issue affects [AMI MegaRAC BMCs](https://www.runzero.com/blog/ami-megarac-bmc/), but also BMCs produced by Intel and Lenovo. This vulnerability was patched in version 1.4.51 and no CVE was assigned. Binarly calculated the CVSS v3.1 scoreas **5.3** *Medium* AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N.

runZero provided guidance on detection and mitigation of these issues on the same day, but also started a deeper investigation into the real-world impact of this issue, resulting in the following notes:

* Hundreds of devices from dozens of manufacturers appear to ship the same vulnerable versions of lighttpd. We've included examples of these at the end of this post.

* The lighttpd project did not assign a CVE to this issue, but they did flag it as a security fix in their [change log](https://github.com/lighttpd/lighttpd1.4/blob/master/NEWS).

* The folded header issue highlighted by Binarly may be tricky to exploit. The bug allows for a remote attacker to confirm whether a string referred to by previously-used pointer is equal to a separate string provided by the attacker. In effect, the attacker can only confirm something they can guess, and at worse can use this to do a case-insensitive compare against the reused pointer. An attacker could brute force string values and hope to confirm an address or value in memory, but practically this doesn't seem feasible, as the case-insensitive comparison and the character restrictions (especially in strict header mode) will result in false positive matches and unguessable values.

* The lighttpd project is part of Google's [OSS-Fuzz](https://google.github.io/oss-fuzz/) scope, but the test cases only [cover the "burl" implementation](https://github.com/google/oss-fuzz/tree/master/projects/lighttpd) and not the HTTP request parser.

* runZero was able to reproduce this issue using the [AFL++ fuzzing engine](https://aflplus.plus/), but did not identify any additional issues during an overnight fuzzing run.

![AFL++ identifying the header folder use-after-free](/uploads/assets/fuzz-lighttpd.png)

AFL++ identifying the header folding use-after-free bug

* In addition to the information leak with folded headers, lighttpd noted additional security issues in the same range of versions:

```
- 1.4.51 - 2018-10-14
  * [core,security] process headers after combining folded headers
  * [mod_userdir] security: skip username "." and ".."

- 1.4.50 - 2018-08-13
  * [mod_alias] security: potential path traversal with specific configs
  * [core] security: use-after-free invalid Range req
  * [mod_alias] security: path traversal in mod_alias (in some use cases) (fixes #2898)
  * [core] security: use-after-free after invalid Range request (fixes #2899)

```
## What is the impact? [#](#what-is-the-impact)

In the case of the folded header issue, AMI MegaRAC BMCs on servers running lighttpd before version 1.4.51 are susceptible to a limited information leak. This leak does not provide the contents of the stale pointer, but it does allow the attacker to confirm if the reused pointer has a specific string value. As a result, it doesn't appear to be significant, as the attacker can only confirm a value that they are already aware of.

The additional security issues outlined in the [lighttpd changelog](https://github.com/lighttpd/lighttpd1.4/blob/master/NEWS) may be more serious. The mod\_userdir issue can allow a directory traversal attack when the URL `/~../` is requested, but this module may not be commonly enabled. The [mod\_alias issue](https://redmine.lighttpd.net/issues/2898) seems similar in that it could allow traversal from the web root, but is unlikely to apply to most installations as it requires a missing trailing slash in the alias configuration.

This brings us to the [use-after-free fixes](https://redmine.lighttpd.net/issues/2899) for invalid Range requests. It's not clear yet how significant these are yet, but we plan to continue this investigation given how many devices are impacted.

## Are updates or workarounds available? [#](#are-updates-or-workarounds-available)

Although AMI has released updated firmware, Intel and Lenovo have both indicated that their affected products are end-of-life (EOL) and will not receive updates. runZero recommends using network segmentation to prevent access to these outdated lighttpd services from untrusted networks. For BMCs specifically, best practices include isolating these interfaces to a dedicated management network, and leveraging VPNs to provide remote access as needed.

## How do I find potentially vulnerable systems with runZero? [#](#how-do-i-find-potentially-vulnerable-systems-with-runZero)

From the [Services Inventory](https://console.runzero.com/inventory/services), use the following query to locate systems running potentially vulnerable software:

```
product:lighttpd (_service.product:=lighttpd:lighttpd:1.4.0% OR _service.product:=lighttpd:lighttpd:1.4.1% OR _service.product:=lighttpd:lighttpd:1.4.2% OR _service.product:=lighttpd:lighttpd:1.4.3% OR _service.product:=lighttpd:lighttpd:1.4.4% OR _service.product:=lighttpd:1.4.50)
```
## Known devices with outdated lighttpd installations [#](#known-devices-with-outdated-lighttpd-installations)

In addition to the AMI MegaRAC BMCs, runZero has observed outdated installations of lighttpd on the following devices:

* AAM-Router
* AE-200/AE-50/EW-50
* AMAG M4000 Physical Access Control System
* AMI MegaRAC
* ARRIS Device Management
* ARRIS Media Server
* ASUSTeK Asuswrt
* AWiND WePresent WiCS-2100
* Aiphone Intercom
* Alcatel-Lucent Enterprise OmniView Switch
* Aruba Switch
* Askey Computer Corp. Rt4230w-D187 Router
* Asus RT-AX88U
* Asus WAP
* Avaya CU360
* Axis Camera
* BASRouterLX
* BASgatewayLX
* BCM96750
* Barco ClickShare
* Belkin AC1900 WIRELESS RANGE EXTENDER
* Belkin Dual Band Wireless Range Extender
* Broadcom Corporation X1
* Buffalo NAS
* CBC Co.,Ltd. Network Camera
* Calient Photonic Switch
* Cambium Networks WLAN AP
* Canon ScanFront
* Chromebook
* Cisco Catalyst 2960S-48LPS-L
* Cisco IP Camera
* Cisco Meraki MR18
* Cisco Meraki MR32
* Cisco Meraki MR34
* Cisco Meraki MR72
* Cisco Router
* Cisco SX20
* Cisco TelePresence TANDBERG/257
* Cisco TelePresence TANDBERG/516
* Cisco TelePresence TANDBERG/518
* Cisco UCS Manager
* Cisco Video Surveillance 5010
* Cisco Video Surveillance 5011
* Cisco VoIP
* Cisco Wireless Access Point
* Cisco Wireless LAN Controller
* Contemporary Control Systems BASRTLX-B
* Crestron AM-100
* Crestron AirMedia
* DWC-MPTZ30X
* DWC-MPTZ336XW
* Dahua IPC-HDW4433C-A
* Dell iDRAC
* Digital Devices GmbH OctopusNet
* EDIMAX IC-7113W Network Camera
* Eaton Corporation Power Xpert 2000 Series Meter
* Eaton Power Xpert
* ecobee4
* EnGenius Technologies EAP1300
* EnGenius Technologies ENH500
* EnGenius Technologies ENH500v3
* EnGenius Technologies EWS300AP
* EnGenius Technologies EWS310AP
* EnGenius Technologies EWS360AP
* EnGenius Technologies WAP
* EtherWAN Switch
* Extron DTP System Display Controller
* Extron Scaling Presentation Switcher Display Controller
* FLIR IP Camera
* Fortinet FON-480
* Fortinet FON-580
* Foscam IP Camera
* GOLD Ver. E
* GW-5492
* Google Chromecast
* Grandstream GXP2130
* Grandstream GXP2135
* Grandstream GXP2160
* Grandstream GXP2170
* Grandstream UCM6202 1.7A
* Grandstream VoIP 1.10
* Green Electronics RainMachine
* HARMON International AMX N-Series Decoder
* HARMON International AMX N-Series Encoder
* HP 280 G3 SFF Business PC
* HP LaserJet 400 Color M451dn
* HPE OfficeConnect 1920S-48G
* HPE StoreEver MSL3040
* Haivision Makito X Decoder
* Hanwha Techwin IP Camera
* Honeywell H3W1F
* Honeywell Industrial Printer PD43
* Honeywell Intermec PC23d
* Honeywell Intermec PC42d
* Honeywell Intermec PC43d
* Honeywell Intermec PC43t
* Honeywell Intermec PM42
* Honeywell Intermec PM43
* Honeywell Intermec PM43c
* HoneywellACS 0.01
* I3 International IP Camera
* IBM FlashSystem 900
* IBM IMM2
* Intermec PC23d
* Intermec PC43d
* Intermec PC43t
* Intermec PD43
* Intermec PM42
* Intermec PM43
* Intermec PM43c
* HP J9147A
* LIP-ME204C
* LOYTEC Electronics GmbH BACnet
* LVIS-3ME7-G2
* Lantronix X5
* Lifesize TelePresence
* Linear EMerge
* Linksys MR5500
* Linksys Velop
* Linksys WAP300N
* Linksys, LLC Simultaneous Dual-Band Wireless-AC Gigabit Router
* MiOS, Ltd. MiOS Z-Wave Home Gateway
* MikroTik RB750r2
* Motorola AP650
* Motorola AP7522
* Motorola AP7532
* Moxa Terminal Server
* NAS4Free
* NEC 800
* NEC Smart TV
* NETGEAR EX6250
* NETGEAR Switch
* Nuuo DVR
* Omron Corporation NJ101 2.5
* Omron Corporation NJ301-1100 2.2
* Omron Corporation NJ501-1300 2.3
* Omron Corporation NJ501-1400 2.4
* Omron Corporation NJ501-1500 2.4
* Omron Corporation NX102-1000 2.6
* Omron Corporation NX102-1020 2.6
* Omron Corporation NX102-1220 2.6
* Omron Corporation NX102-9020 2.6
* Omron Corporation NX701 2.5
* Panasonic WJ-NX400
* Pelco IDS0DN
* Pelco IME219
* Pelco IME319
* Pelco IMS0DN10-1V
* Pelco IP Camera - Endura Enabled
* Pelco IX30DN
* Pelco IXE31
* Pelco MCE H264 - Endura Enabled
* Pelco Sarix D5118
* Pelco Sarix Pro Camera
* Pelco TXB-N
* Quanta Network Appliance
* Quantum Scalar I40
* Quantum Scalar I80
* Rittal PDU (7955.211)
* Roku 3
* SATO CL4NX
* SATO Printer
* SONY UBP-X700
* Samsung DVR
* Samsung IPolis IP Camera
* Samsung SND-6084R Network Camera
* Samsung SNV-6013 Network Camera
* Samsung SmartCam
* Sato CL4NX
* Schneider Electric Network Management Card 2 08
* Schneider Electric Trio QB450
* Schneider Electric Trio QR450
* ScreenBeam Conference
* Seagate BlackArmor NAS 4D
* Seagate Central NAS 1D
* Sierra Wireless AirLink
* Sonos ZonePlayer S3
* Sony BDP-2017
* Sony STR-2017
* Sony STR-DN1080
* Sony Smart TV
* Sony UBP-X700
* Sony XR-77A80K
* Spectra Logic Stack
* Super Micro IPMI
* Synology NAS
* TP-Link NC260
* TempAlert Router
* Toshiba Canvio Home
* Tyco IPS02D2ICWIT
* Tyco IPS02D2ICWTT
* Tyco IPS02D2OCWIT
* Tyco IPS02D2OCWTT
* Tyco IPS05D2ICWIY
* Tyco Illustra
* UPS Manufacturing NetMan Plus
* Ubiquiti AirCam
* Ubiquiti AirFiber 24G
* Ubiquiti AirFiber 24G HD
* Ubiquiti AirFiber 5
* Ubiquiti AirFiber 5X
* Ubiquiti AirFiber 5XHD
* Ubiquiti AirGrid M5 HP
* Ubiquiti AirMax
* Ubiquiti Bullet AC
* Ubiquiti Bullet M2
* Ubiquiti Camera G3
* Ubiquiti Camera G4 Pro
* Ubiquiti EdgePower-54V-150W
* Ubiquiti EdgeSwitch 5XP
* Ubiquiti ISO Station 5AC
* Ubiquiti ISO Station M5
* Ubiquiti LM5 NanoStation Loco M5
* Ubiquiti LTU-LR
* Ubiquiti LTU-Rocket
* Ubiquiti LiteAP AC
* Ubiquiti LiteBeam 5AC 23
* Ubiquiti LiteBeam 5AC Gen2
* Ubiquiti MFi MOutlet
* Ubiquiti MFi MPower Pro
* Ubiquiti N2B-400
* Ubiquiti NanoBeam 5AC 16
* Ubiquiti NanoBeam 5AC 19
* Ubiquiti NanoBeam 5AC Gen2
* Ubiquiti NanoBeam M2 13
* Ubiquiti NanoBeam M5 16
* Ubiquiti NanoBeam M5 400
* Ubiquiti NanoBridge M5
* Ubiquiti NanoStation 5AC
* Ubiquiti NanoStation 5AC Loco
* Ubiquiti NanoStation Loco M2
* Ubiquiti NanoStation Loco M5
* Ubiquiti NanoStation Loco M900
* Ubiquiti NanoStation M2
* Ubiquiti NanoStation M3
* Ubiquiti NanoStation M365
* Ubiquiti NanoStation M5
* Ubiquiti NanoStation M5 NanoStation Loco M5
* Ubiquiti PicoStation M2
* Ubiquiti PicoStation M2 UVC G3 Flex
* Ubiquiti PowerBeam 5AC 300
* Ubiquiti PowerBeam 5AC 400
* Ubiquiti PowerBeam 5AC 500
* Ubiquiti PowerBeam 5AC Gen2
* Ubiquiti PowerBeam 5AC ISO Gen2
* Ubiquiti PowerBeam M5 400
* Ubiquiti PowerBridge M5
* Ubiquiti PrismStation 5AC
* Ubiquiti Rocket 5AC Lite
* Ubiquiti Rocket 5AC PTMP
* Ubiquiti Rocket 5AC Prism
* Ubiquiti Rocket M2
* Ubiquiti Rocket M3
* Ubiquiti Rocket M365
* Ubiquiti Rocket M5
* Ubiquiti Rocket M5 GPS
* Ubiquiti Rocket M5 Titanium GPS
* Ubiquiti Rocket M900
* Ubiquiti Rocket Prism 5AC Gen2
* Ubiquiti TOUGHSwitch PoE
* Ubiquiti TOUGHSwitch PoE PRO
* Ubiquiti UniFi Router
* VIAVI ONT-600
* VIAVI ONT-601
* VIAVI ONT-602
* VICON SN663V-A-H.264 Network PTZ Camera
* VICON SN673V-B-H.264 Network PTZ Camera
* VMware Site Recovery Manager
* Verifone Payment Devices
* Video Storm LLC Gmediarender 0.0.7
* Vizio E65-E0
* Vizio E70u-D3
* Vizio Smart TV
* Vizio SmartCast Sound Bar
* Wansview NCM-631GA
* WonderMedia Technologies, Inc. 1.0
* ZebraNet Barcode Scanner

![](/uploads/assets/contributors/duo-tone/Authors_BlainSmith.webp)

Written by Blain Smith

[![](/images/svg/icon-linkedin.svg)](https://www.linkedin.com/in/blainsmith/)

Blain Smith is a Security Research Engineer at runZero. He spent most of his career in cloud and distributed systems for AAA gaming, entertainment, and networking working on some of the most popular games and systems millions of people play and watch daily. He has given numerous talks at conferences such as TEDx, GopherCon, and P99CONF. His shift into infosec has afforded him the ability to apply his distributed systems and networking knowledge to other industries such as IoT and OT.

[More about Blain Smith](/authors/blain-smith/)

![](/uploads/assets/contributors/duo-tone/Authors_HDMoore.webp)

Written by HD Moore

[![](/images/svg/icon-git.svg)](https://github.com/hdm)
[![](/images/svg/icon-twitter.svg)](https://twitter.com/hdmoore)
[![](/images/svg/icon-linkedin.svg)](https://www.linkedin.com/in/hdmoore)

HD Moore is the founder and CEOÂ of runZero. Previously, he founded the Metasploit Project and served as the main developer of the Metasploit Framework, which is the world's most widely used penetration testing framework.

[More about HD Moore](/authors/hd-moore/)

![](/uploads/assets/contributors/duo-tone/Authors_TomSellers.webp)

Written by Tom Sellers

[![](/images/svg/icon-git.svg)](https://github.com/TomSellers)
[![](/images/svg/icon-linkedin.svg)](https://www.linkedin.com/in/tomsellers)

Tom Sellers is a Principal Research Engineer at runZero. In his 25 years in IT and Security he has built, broken, and defended networks for companies in the finance, service provider, and security software industries. He has built and operated Internet scale scanning and honeypot projects. He is credited on many patents for network deception techonology. A strong believer in Open Source he has contributed to projects such as Nmap, Metasploit, and Recog.

[More about Tom Sellers](/authors/tom-sellers/)

Subscribe Now

Get the latest news and expert insights delivered in your inbox.

 Welcome to the club! Your subscription to our newsletter is successful.

---

#### Related Articles

[![](/uploads/blog/category-tile-images/rapid-response.webp)](/blog/beyondtrust-appliances/ "How to find BeyondTrust appliances on your network")
Rapid Response
[How to find BeyondTrust appliances on your network](/blog/beyondtrust-appliances/)
BeyondTrust disclosed that affects their Privileged Remote Access (PRA) and Remote Support (RS) products. This has also been added to the CISA KEV...

[Read More](/blog/beyondtrust-appliances/ "How to find BeyondTrust appliances on your network")

[![](/uploads/blog/category-tile-images/rapid-response.webp)](/blog/bind-services/ "How to find BIND services")
Rapid Response
[How to find BIND services](/blog/bind-services/)
ISC disclosed that authoritative servers may experience assertion failures or other unexpected events when using DNSSEC-signed zones using NSEC3.

[Read More](/blog/bind-services/ "How to find BIND services")

[![](/uploads/blog/category-tile-images/rapid-response.webp)](/blog/go-ssh/ "How to find Go SSH servers on your network")
Rapid Response
[How to find Go SSH servers on your network](/blog/go-ssh/)
How to discover Go SSH instances on your network that may be vulnerable to CVE-2024-45337

[Read More](/blog/go-ssh/ "How to find Go SSH servers on your network")

[![](/uploads/blog/category-tile-images/rapid-response.webp)](/blog/cleo-software/ "How to find Cleo Harmony, LexiCom, and VLTransfer installations on your network")
Rapid Response
[How to find Cleo Harmony, LexiCom, and VLTransfer installations on your network](/blog/cleo-software/)
Cleo Software has disclosed CVE-2024-50623 affecting installations of Cleo Harmony, VLTransfer, and LexiCom on your network. Here's how to find...

[Read More](/blog/cleo-software/ "How to find Cleo Harmony, LexiCom, and VLTransfer installations on your network")

![](/images/yeti/footer-cta/yeti-body@2x.png)

![](/images/yeti/footer-cta/yeti-arm-point@2x.png)

![](/images/yeti/footer-cta/yeti-hand@2x.png)

## See Results in Minutes

Get complete visibility into IT, OT, & IoT â without agents, credentials, or hardware.

[Try It Free](/try/)

![](/images/backgrounds/bg-zero-grid-left.svg)
![](/images/backgrounds/bg-zero-grid-right.svg)

[xml version="1.0" encoding="UTF-8"?](https://linkedin.com/company/runzero/)
[xml version="1.0" encoding="UTF-8"?
icon-bluesky](https://bsky.app/profile/runzero.com)
[xml version="1.0" encoding="UTF-8"?](https://infosec.exchange/%40runZeroInc)
[xml version="1.0" encoding="UTF-8"?](https://twitter.com/runZeroInc)
[xml version="1.0" encoding="UTF-8"?](https://www.youtube.com/c/runZeroInc)
[xml version="1.0" encoding="UTF-8"?](https://github.com/runZeroInc)
[xml version="1.0" encoding="UTF-8"?](/blog/index.xml)

Â© Copyright 2025 runZero, Inc. All Rights Reserved

* [Legal](/legal/)
* [Privacy Policy](/legal/privacy/)
* [Terms and Conditions](/legal/terms/)



=== Content from github.com_e2863a93_20250111_203132.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flighttpd%2Flighttpd1.4%2Fcommit%2Fdf8e4f95614e476276a55e34da2aa8b00b1148e9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flighttpd%2Flighttpd1.4%2Fcommit%2Fdf8e4f95614e476276a55e34da2aa8b00b1148e9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lighttpd%2Flighttpd1.4)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lighttpd](/lighttpd)
/
**[lighttpd1.4](/lighttpd/lighttpd1.4)**
Public

* [Notifications](/login?return_to=%2Flighttpd%2Flighttpd1.4) You must be signed in to change notification settings
* [Fork
  286](/login?return_to=%2Flighttpd%2Flighttpd1.4)
* [Star
   623](/login?return_to=%2Flighttpd%2Flighttpd1.4)

* [Code](/lighttpd/lighttpd1.4)
* [Pull requests
  1](/lighttpd/lighttpd1.4/pulls)
* [Actions](/lighttpd/lighttpd1.4/actions)
* [Security](/lighttpd/lighttpd1.4/security)
* [Insights](/lighttpd/lighttpd1.4/pulse)

Additional navigation options

* [Code](/lighttpd/lighttpd1.4)
* [Pull requests](/lighttpd/lighttpd1.4/pulls)
* [Actions](/lighttpd/lighttpd1.4/actions)
* [Security](/lighttpd/lighttpd1.4/security)
* [Insights](/lighttpd/lighttpd1.4/pulse)

## Commit

[Permalink](/lighttpd/lighttpd1.4/commit/df8e4f95614e476276a55e34da2aa8b00b1148e9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[core,security] process headers after combining folded headers

[Browse files](/lighttpd/lighttpd1.4/tree/df8e4f95614e476276a55e34da2aa8b00b1148e9)
Browse the repository at this point in the history

```
- this fixes various use-after-free scenarios (reported by Or Peles of
  VDOO): when parse_single_header stores pointers to header values in
  con->request, those pointers are not updated if the header value is
  reallocated when folded header lines are appended.
- also remove trailing white-space from folded lines
```

* Loading branch information

[![@stbuehler](https://avatars.githubusercontent.com/u/528446?s=40&v=4)](/stbuehler)

[stbuehler](/lighttpd/lighttpd1.4/commits?author=stbuehler "View all commits by stbuehler")
committed
Aug 26, 2018

1 parent
[a2cc330](/lighttpd/lighttpd1.4/commit/a2cc330fb495cb6b6fc76389e0f72e3d6cec6104)

commit df8e4f9

Showing
**1 changed file**
with
**42 additions**
and
**40 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

82 changes: 42 additions & 40 deletions

82
[src/request.c](#diff-97993831af601b77f01a192a52a79768f99ad758db5fc433acf165c2b5451589 "src/request.c")

Show comments

[View file](/lighttpd/lighttpd1.4/blob/df8e4f95614e476276a55e34da2aa8b00b1148e9/src/request.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -444,6 +444,11 @@ static void init\_parse\_header\_state(parse\_header\_state\* state) { |
|  |  | static int parse\_single\_header(server \*srv, connection \*con, parse\_header\_state \*state, data\_string \*ds) { |
|  |  | int cmp = 0; |
|  |  |  |
|  |  | /\* empty header-fields are not allowed by HTTP-RFC, we just ignore them \*/ |
|  |  | if (buffer\_string\_is\_empty(ds->value)) { |
|  |  | goto drop\_header; |
|  |  | } |
|  |  |  |
|  |  | /\* retreive values |
|  |  | \* |
|  |  | \* |
| Expand Down  Expand Up | | @@ -575,6 +580,7 @@ int http\_request\_parse(server \*srv, connection \*con) { |
|  |  | char \*uri = NULL, \*proto = NULL, \*method = NULL; |
|  |  | int is\_key = 1, key\_len = 0, is\_ws\_after\_key = 0, in\_folding; |
|  |  | char \*value = NULL, \*key = NULL; |
|  |  | data\_string \*current\_header = NULL; |
|  |  |  |
|  |  | int line = 0; |
|  |  |  |
| Expand Down  Expand Up | | @@ -1024,7 +1030,8 @@ int http\_request\_parse(server \*srv, connection \*con) { |
|  |  | case '\r': |
|  |  | case '\n': |
|  |  | if (\*cur == '\n' || con->parse\_request->ptr[i+1] == '\n') { |
|  |  | data\_string \*ds = NULL; |
|  |  | int value\_len; |
|  |  |  |
|  |  | if (\*cur == '\n') { |
|  |  | if (http\_header\_strict) { |
|  |  | http\_request\_missing\_CR\_before\_LF(srv, con); |
| Expand All | | @@ -1038,17 +1045,15 @@ int http\_request\_parse(server \*srv, connection \*con) { |
|  |  | /\* End of Headerline \*/ |
|  |  | con->parse\_request->ptr[i] = '\0'; |
|  |  |  |
|  |  | value\_len = cur - value; |
|  |  |  |
|  |  | /\* strip trailing white-spaces \*/ |
|  |  | while (value\_len > 0 && (value[value\_len - 1] == ' ' || value[value\_len - 1] == '\t')) { |
|  |  | --value\_len; |
|  |  | } |
|  |  |  |
|  |  | if (in\_folding) { |
|  |  | /\*\* |
|  |  | \* we use a evil hack to handle the line-folding |
|  |  | \* |
|  |  | \* As array\_insert\_unique() deletes 'ds' in the case of a duplicate |
|  |  | \* ds points somewhere and we get a evil crash. As a solution we keep the old |
|  |  | \* "key" and get the current value from the hash and append us |
|  |  | \* |
|  |  | \* \*/ |
|  |  |  |
|  |  | if (!key || !key\_len) { |
|  |  | if (!current\_header) { |
|  |  | /\* 400 \*/ |
|  |  |  |
|  |  | if (srv->srvconf.log\_request\_header\_on\_error) { |
| Expand All | | @@ -1062,47 +1067,32 @@ int http\_request\_parse(server \*srv, connection \*con) { |
|  |  | goto failure; |
|  |  | } |
|  |  |  |
|  |  | if (NULL != (ds = (data\_string \*)array\_get\_element\_klen(con->request.headers, key, key\_len))) { |
|  |  | buffer\_append\_string(ds->value, value); |
|  |  | } |
|  |  | buffer\_append\_string\_len(current\_header->value, value, value\_len); |
|  |  | } else { |
|  |  | int s\_len; |
|  |  | key = con->parse\_request->ptr + first; |
|  |  |  |
|  |  | s\_len = cur - value; |
|  |  |  |
|  |  | /\* strip trailing white-spaces \*/ |
|  |  | for (; s\_len > 0 && |
|  |  | (value[s\_len - 1] == ' ' || |
|  |  | value[s\_len - 1] == '\t'); s\_len--); |
|  |  |  |
|  |  | value[s\_len] = '\0'; |
|  |  |  |
|  |  | if (s\_len > 0) { |
|  |  | if (NULL == (ds = (data\_string \*)array\_get\_unused\_element(con->request.headers, TYPE\_STRING))) { |
|  |  | ds = data\_string\_init(); |
|  |  | } |
|  |  | buffer\_copy\_string\_len(ds->key, key, key\_len); |
|  |  | buffer\_copy\_string\_len(ds->value, value, s\_len); |
|  |  |  |
|  |  | /\* process previous header \*/ |
|  |  | if (current\_header) { |
|  |  | data\_string \*ds = current\_header; |
|  |  | current\_header = NULL; |
|  |  | if (!parse\_single\_header(srv, con, &state, ds)) { |
|  |  | /\* parse\_single\_header should already have logged it \*/ |
|  |  | goto failure; |
|  |  | } |
|  |  | } else { |
|  |  | /\* empty header-fields are not allowed by HTTP-RFC, we just ignore them \*/ |
|  |  | } |
|  |  |  |
|  |  | key = con->parse\_request->ptr + first; |
|  |  |  |
|  |  | if (NULL == (current\_header = (data\_string \*)array\_get\_unused\_element(con->request.headers, TYPE\_STRING))) { |
|  |  | current\_header = data\_string\_init(); |
|  |  | } |
|  |  |  |
|  |  | buffer\_copy\_string\_len(current\_header->key, key, key\_len); |
|  |  | buffer\_copy\_string\_len(current\_header->value, value, value\_len); |
|  |  | } |
|  |  |  |
|  |  | first = i+1; |
|  |  | is\_key = 1; |
|  |  | value = NULL; |
|  |  | #if 0 |
|  |  | /\*\* |
|  |  | \* for Bug 1230 keep the key\_len a live |
|  |  | \*/ |
|  |  | key\_len = 0; |
|  |  | #endif |
|  |  | in\_folding = 0; |
|  |  | } else { |
|  |  | if (srv->srvconf.log\_request\_header\_on\_error) { |
| Expand Down  Expand Up | | @@ -1132,6 +1122,16 @@ int http\_request\_parse(server \*srv, connection \*con) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\* process last header \*/ |
|  |  | if (current\_header) { |
|  |  | data\_string\* ds = current\_header; |
|  |  | current\_header = NULL; |
|  |  | if (!parse\_single\_header(srv, con, &state, ds)) { |
|  |  | /\* parse\_single\_header should already have logged it \*/ |
|  |  | goto failure; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | con->header\_len = i; |
|  |  |  |
|  |  | /\* do some post-processing \*/ |
| Expand Down  Expand Up | | @@ -1252,6 +1252,8 @@ int http\_request\_parse(server \*srv, connection \*con) { |
|  |  | return 0; |
|  |  |  |
|  |  | failure: |
|  |  | if (current\_header) current\_header->free((data\_unset \*)current\_header); |
|  |  |  |
|  |  | con->keep\_alive = 0; |
|  |  | con->response.keep\_alive = 0; |
|  |  | if (!con->http\_status) con->http\_status = 400; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `df8e4f9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flighttpd%2Flighttpd1.4%2Fcommit%2Fdf8e4f95614e476276a55e34da2aa8b00b1148e9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.kb.cert.org_3c386b6b_20250111_203132.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#312260

## Use-after-free vulnerability in lighttpd version 1.4.50 and earlier

#### Vulnerability Note VU#312260

Original Release Date: 2024-07-09 | Last Revised: 2024-07-10

---

### Overview

A use-after-free vulnerability in lighttpd in versions 1.4.50 and earlier permits a remote, unauthenticated attacker to trigger lighttpd to read from invalid pointers in memory. The attacker can use crafted HTTP Requests to crash the web server and/or leak memory in order to access sensitive data. This vulnerability was fixed in 2018 by the lighttpd project. However, a number of implementations of lighttpd remain vulnerable due to a failure to apply the security updates provided by lighttpd.

### Description

lighttpd is a lightweight web server software that is meant for low resource environments with limited CPU and memory. This open-source software is available in binary form and source code that is included in various IoT and firmware environments. In November of 2018, VDOO researchers disclosed a [vulnerability](https://blogvdoo.wordpress.com/2018/11/06/giving-back-securing-open-source-iot-projects/#Lighttpd%20Use-After-Free%20Bugs) related to the HTTP header parsing code in lighttpd versions 1.4.50 and earlier. This security issue was fixed by lighttpd as part of their [1.4.51 release](https://github.com/lighttpd/lighttpd1.4/commit/df8e4f95614e476276a55e34da2aa8b00b1148e9#diff-8800c58d198dc86ed580c0e0b78c9a26) in August 2018. At the time of disclosure, VDOO researchers identified the primary impact to be Denial of Service (DoS) using the released memory pointer.

However, a CVE ID was not obtained as part of the fix outlined above, leaving the vulnerability without a public identifier. In April of 2024, Binarly discovered that the lighttpd vulnerability was still present in a number of products, presenting a supply-chain risk. The lack of CVE ID rendered the security fix invisible to projects that utilize earlier versions of lighttpd. Many organizations depend on [a public CVE ID record](https://apps.dtic.mil/sti/trecms/pdf/AD1125343.pdf) to initiate security fixes and apply software updates. [Binarly also documented](https://www.binarly.io/blog/lighttpd-gains-new-life) many implementations of lighttpd (versions 1.4.50 and earlier) that allowed for a different set of attacks that can leak memory and access sensitive data. The supply-chain impact of this vulnerable software includes multiple products as highlighted in the [blog by runZero](https://www.runzero.com/blog/lighttpd/). The lighttpd project has now obtained [CVE-2018-25103](https://www.cve.org/CVERecord?id=CVE-2018-25103) to identify this vulnerability and to alert supply-chain partners to implement the required fix.

### Impact

The impact of this vulnerability varies largely due to the various ways lighttpd can be used a web server in various product implementations. In general, a remote unauthenticated attacker can use crafted HTTP Requests to crash the web server and/or leak memory in order to access sensitive data, such as process memory addresses.

### Solution

The CERT/CC recommends applying the latest vendor-provided patch to address this issue. Review the Vendor Information below or contact your vendor or supplier for specific mitigation advice. If your device's implementation of lighttpd is deemed end-of-life or end-of-support, replace your hardware or software as appropriate to avoid exposure to this vulnerability. Operators can also limit network access to lighttpd implementations to avoid exposure of this software to the public Internet and untrusted sources.

### Acknowledgements

Thanks to Binarly for highlighting this vulnerability in supply-chain implementations. Thanks to Ori Hollander, VDOO for identifying and reporting the vulnerability in 2018. Thanks also to lighttpd project and vendor AMI that cooperated in supporting this public disclosure and outreach.This document was written by Vijay Sarvepalli.

### Vendor Information

312260
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [American Megatrends Incorporated (AMI)](#American%20Megatrends%20Incorporated%20%28AMI%29) Affected

Notified:  2024-04-17
Updated: 2024-07-09

**Statement Date:   May 14, 2024**

| **CVE-2018-25103** | Affected |
| --- | --- |

#### Vendor Statement

AMI has published an advisory to customers.

### [lighttpd](#lighttpd) Affected

Notified:  2024-04-17
Updated: 2024-07-09

**Statement Date:   April 23, 2024**

| **CVE-2018-25103** | Affected |
| --- | --- |

#### Vendor Statement

lighttpd 1.4.50 and earlier have a use-after-free-vulnerability which might leak memory. Brute force attacks would have to guess exact matches. Guesses must not contain chars < 0x20 and would have to rely on stable contents of a specific, non-attacker-controlled memory location. On system not processing any other requests, and therefore with more stable memory location, the contents in freed memory are very unlikely to contain anything sensitive. This bug is read-only and not otherwise directly exploitable, but could theoretically be leveraged if other exploitable bugs were found.

#### References

* <https://git.lighttpd.net/lighttpd/lighttpd1.4/commit/df8e4f95614e476276a55e34da2aa8b00b1148e9>
* <https://blogvdoo.wordpress.com/2018/11/06/giving-back-securing-open-source-iot-projects/#more-736>
* <https://www.runzero.com/blog/lighttpd/>

### [Intel](#Intel) Not Affected

Notified:  2024-04-17
Updated: 2024-07-09

**Statement Date:   April 17, 2024**

| **CVE-2018-25103** | Not Affected |
| --- | --- |

#### Vendor Statement

The only impacted Intel device is end of lifed. This was previously shared with Binarly. Due to it being EOL'd Intel will not be providing a mitigation.

#### CERT Addendum

Intel's products are Affected by this vulnerability however these products have been identified as end-of-life by Intel. Users should replace these end-of-life products as they will not be fixed by Intel.

### [Amazon](#Amazon) Unknown

Notified:  2024-06-13
Updated: 2024-07-09

| **CVE-2018-25103** | Unknown |
| --- | --- |

#### Vendor Statement

We have not received a statement from the vendor.

### [Lenovo](#Lenovo) Unknown

Notified:  2024-04-17
Updated: 2024-07-09

| **CVE-2018-25103** | Unknown |
| --- | --- |

#### Vendor Statement

We have not received a statement from the vendor.

### References

* <https://www.runzero.com/blog/lighttpd/>
* <https://github.com/lighttpd/lighttpd1.4/commit/df8e4f95614e476276a55e34da2aa8b00b1148e9>
* <https://www.binarly.io/blog/lighttpd-gains-new-life>
* <https://9443417.fs1.hubspotusercontent-na1.net/hubfs/9443417/Security%20Advisories/2024/AMI-SA-2024002.pdf>
* <https://blogvdoo.wordpress.com/2018/11/06/giving-back-securing-open-source-iot-projects/#more-736>

### Other Information

| **CVE IDs:** | [CVE-2018-25103](https://www.cve.org/CVERecord?id=CVE-2018-25103) |
| --- | --- |
| **API URL:** | [VINCE JSON](/vuls/api/312260/) | [CSAF](/vuls/api/312260/csaf/) |
| **Date Public:** | 2024-07-09 |
| **Date First Published:** | 2024-07-09 |
| **Date Last Updated:** | 2024-07-10 18:25 UTC |
| **Document Revision:** | 2 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2024 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


