<!DOCTYPE html>
<html lang='en'>
<head>
<title>mfd: qcom-spmi-pmic: Fix revid implementation - kernel/git/stable/linux.git - Linux kernel stable tree</title>
<meta name='generator' content='cgit 1.2.3-korg'/>
<meta name='robots' content='noindex, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<script type='text/javascript' src='/cgit-data/cgit.js'></script>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://kernel.googlesource.com/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a href='/pub/scm/linux/kernel/git/stable/linux.git/'>kernel/git/stable/linux.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='7b439aaa62fee474a0d84d67a25f4984467e7b95'/><select name='h' onchange='this.form.submit();'>
<option value='linux-2.6.11.y'>linux-2.6.11.y</option>
<option value='linux-2.6.12.y'>linux-2.6.12.y</option>
<option value='linux-2.6.13.y'>linux-2.6.13.y</option>
<option value='linux-2.6.14.y'>linux-2.6.14.y</option>
<option value='linux-2.6.15.y'>linux-2.6.15.y</option>
<option value='linux-2.6.16.y'>linux-2.6.16.y</option>
<option value='linux-2.6.17.y'>linux-2.6.17.y</option>
<option value='linux-2.6.18.y'>linux-2.6.18.y</option>
<option value='linux-2.6.19.y'>linux-2.6.19.y</option>
<option value='linux-2.6.20.y'>linux-2.6.20.y</option>
<option value='linux-2.6.21.y'>linux-2.6.21.y</option>
<option value='linux-2.6.22.y'>linux-2.6.22.y</option>
<option value='linux-2.6.23.y'>linux-2.6.23.y</option>
<option value='linux-2.6.24.y'>linux-2.6.24.y</option>
<option value='linux-2.6.25.y'>linux-2.6.25.y</option>
<option value='linux-2.6.26.y'>linux-2.6.26.y</option>
<option value='linux-2.6.27.y'>linux-2.6.27.y</option>
<option value='linux-2.6.28.y'>linux-2.6.28.y</option>
<option value='linux-2.6.29.y'>linux-2.6.29.y</option>
<option value='linux-2.6.30.y'>linux-2.6.30.y</option>
<option value='linux-2.6.31.y'>linux-2.6.31.y</option>
<option value='linux-2.6.32.y'>linux-2.6.32.y</option>
<option value='linux-2.6.33.y'>linux-2.6.33.y</option>
<option value='linux-2.6.34.y'>linux-2.6.34.y</option>
<option value='linux-2.6.35.y'>linux-2.6.35.y</option>
<option value='linux-2.6.36.y'>linux-2.6.36.y</option>
<option value='linux-2.6.37.y'>linux-2.6.37.y</option>
<option value='linux-2.6.38.y'>linux-2.6.38.y</option>
<option value='linux-2.6.39.y'>linux-2.6.39.y</option>
<option value='linux-3.0.y'>linux-3.0.y</option>
<option value='linux-3.1.y'>linux-3.1.y</option>
<option value='linux-3.10.y'>linux-3.10.y</option>
<option value='linux-3.11.y'>linux-3.11.y</option>
<option value='linux-3.12.y'>linux-3.12.y</option>
<option value='linux-3.13.y'>linux-3.13.y</option>
<option value='linux-3.14.y'>linux-3.14.y</option>
<option value='linux-3.15.y'>linux-3.15.y</option>
<option value='linux-3.16.y'>linux-3.16.y</option>
<option value='linux-3.17.y'>linux-3.17.y</option>
<option value='linux-3.18.y'>linux-3.18.y</option>
<option value='linux-3.19.y'>linux-3.19.y</option>
<option value='linux-3.2.y'>linux-3.2.y</option>
<option value='linux-3.3.y'>linux-3.3.y</option>
<option value='linux-3.4.y'>linux-3.4.y</option>
<option value='linux-3.5.y'>linux-3.5.y</option>
<option value='linux-3.6.y'>linux-3.6.y</option>
<option value='linux-3.7.y'>linux-3.7.y</option>
<option value='linux-3.8.y'>linux-3.8.y</option>
<option value='linux-3.9.y'>linux-3.9.y</option>
<option value='linux-4.0.y'>linux-4.0.y</option>
<option value='linux-4.1.y'>linux-4.1.y</option>
<option value='linux-4.10.y'>linux-4.10.y</option>
<option value='linux-4.11.y'>linux-4.11.y</option>
<option value='linux-4.12.y'>linux-4.12.y</option>
<option value='linux-4.13.y'>linux-4.13.y</option>
<option value='linux-4.14.y'>linux-4.14.y</option>
<option value='linux-4.15.y'>linux-4.15.y</option>
<option value='linux-4.16.y'>linux-4.16.y</option>
<option value='linux-4.17.y'>linux-4.17.y</option>
<option value='linux-4.18.y'>linux-4.18.y</option>
<option value='linux-4.19.y'>linux-4.19.y</option>
<option value='linux-4.2.y'>linux-4.2.y</option>
<option value='linux-4.20.y'>linux-4.20.y</option>
<option value='linux-4.3.y'>linux-4.3.y</option>
<option value='linux-4.4.y'>linux-4.4.y</option>
<option value='linux-4.5.y'>linux-4.5.y</option>
<option value='linux-4.6.y'>linux-4.6.y</option>
<option value='linux-4.7.y'>linux-4.7.y</option>
<option value='linux-4.8.y'>linux-4.8.y</option>
<option value='linux-4.9.y'>linux-4.9.y</option>
<option value='linux-5.0.y'>linux-5.0.y</option>
<option value='linux-5.1.y'>linux-5.1.y</option>
<option value='linux-5.10.y'>linux-5.10.y</option>
<option value='linux-5.11.y'>linux-5.11.y</option>
<option value='linux-5.12.y'>linux-5.12.y</option>
<option value='linux-5.13.y'>linux-5.13.y</option>
<option value='linux-5.14.y'>linux-5.14.y</option>
<option value='linux-5.15.y'>linux-5.15.y</option>
<option value='linux-5.16.y'>linux-5.16.y</option>
<option value='linux-5.17.y'>linux-5.17.y</option>
<option value='linux-5.18.y'>linux-5.18.y</option>
<option value='linux-5.19.y'>linux-5.19.y</option>
<option value='linux-5.2.y'>linux-5.2.y</option>
<option value='linux-5.3.y'>linux-5.3.y</option>
<option value='linux-5.4.y'>linux-5.4.y</option>
<option value='linux-5.5.y'>linux-5.5.y</option>
<option value='linux-5.6.y'>linux-5.6.y</option>
<option value='linux-5.7.y'>linux-5.7.y</option>
<option value='linux-5.8.y'>linux-5.8.y</option>
<option value='linux-5.9.y'>linux-5.9.y</option>
<option value='linux-6.0.y'>linux-6.0.y</option>
<option value='linux-6.1.y'>linux-6.1.y</option>
<option value='linux-6.10.y'>linux-6.10.y</option>
<option value='linux-6.11.y'>linux-6.11.y</option>
<option value='linux-6.12.y'>linux-6.12.y</option>
<option value='linux-6.2.y'>linux-6.2.y</option>
<option value='linux-6.3.y'>linux-6.3.y</option>
<option value='linux-6.4.y'>linux-6.4.y</option>
<option value='linux-6.5.y'>linux-6.5.y</option>
<option value='linux-6.6.y'>linux-6.6.y</option>
<option value='linux-6.7.y'>linux-6.7.y</option>
<option value='linux-6.8.y'>linux-6.8.y</option>
<option value='linux-6.9.y'>linux-6.9.y</option>
<option value='linux-rolling-lts'>linux-rolling-lts</option>
<option value='linux-rolling-stable'>linux-rolling-stable</option>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Linux kernel stable tree</td><td class='sub right'>Stable Group</td></tr></table>
<table class='tabs'><tr><td>
<a href='/pub/scm/linux/kernel/git/stable/linux.git/about/'>about</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/'>summary</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>refs</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/log/'>log</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>tree</a><a class='active' href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>commit</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>diff</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/stats/'>stats</a></td><td class='form'><form class='right' method='get' action='/pub/scm/linux/kernel/git/stable/linux.git/log/'>
<input type='hidden' name='id' value='7b439aaa62fee474a0d84d67a25f4984467e7b95'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='7b439aaa62fee474a0d84d67a25f4984467e7b95'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Johan Hovold &lt;johan+linaro@kernel.org&gt;</td><td class='right'>2023-10-03 17:29:24 +0200</td></tr>
<tr><th>committer</th><td>Lee Jones &lt;lee@kernel.org&gt;</td><td class='right'>2023-11-01 10:02:16 +0000</td></tr>
<tr><th>commit</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>7b439aaa62fee474a0d84d67a25f4984467e7b95</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>3d36f340403108103dea38f79783db71e54d58a3</a></td></tr>
<tr><th>parent</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a0fa44c261e448c531f9adb3a5189a3520f3e316'>a0fa44c261e448c531f9adb3a5189a3520f3e316</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7b439aaa62fee474a0d84d67a25f4984467e7b95&amp;id2=a0fa44c261e448c531f9adb3a5189a3520f3e316'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7b439aaa62fee474a0d84d67a25f4984467e7b95.tar.gz'>linux-7b439aaa62fee474a0d84d67a25f4984467e7b95.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>mfd: qcom-spmi-pmic: Fix revid implementation</div><div class='commit-msg'>The Qualcomm SPMI PMIC revid implementation is broken in multiple ways.

First, it assumes that just because the sibling base device has been
registered that means that it is also bound to a driver, which may not
be the case (e.g. due to probe deferral or asynchronous probe). This
could trigger a NULL-pointer dereference when attempting to access the
driver data of the unbound device.

Second, it accesses driver data of a sibling device directly and without
any locking, which means that the driver data may be freed while it is
being accessed (e.g. on driver unbind).

Third, it leaks a struct device reference to the sibling device which is
looked up using the spmi_device_from_of() every time a function (child)
device is calling the revid function (e.g. on probe).

Fix this mess by reimplementing the revid lookup so that it is done only
at probe of the PMIC device; the base device fetches the revid info from
the hardware, while any secondary SPMI device fetches the information
from the base device and caches it so that it can be accessed safely
from its children. If the base device has not been probed yet then probe
of a secondary device is deferred.

Fixes: e9c11c6e3a0e ("mfd: qcom-spmi-pmic: expose the PMIC revid information to clients")
Cc: stable@vger.kernel.org      # 6.0
Signed-off-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
Acked-by: Caleb Connolly &lt;caleb.connolly@linaro.org&gt;
Link: <a href="https://lore.kernel.org/r/20231003152927.15000-3-johan+linaro@kernel.org">https://lore.kernel.org/r/20231003152927.15000-3-johan+linaro@kernel.org</a>
Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
</div><div class='diffstat-header'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/mfd/qcom-spmi-pmic.c?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>drivers/mfd/qcom-spmi-pmic.c</a></td><td class='right'>69</td><td class='graph'><table summary='file diffstat' width='69%'><tr><td class='add' style='width: 76.8%;'/><td class='rem' style='width: 23.2%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>1 files changed, 53 insertions, 16 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/drivers/mfd/qcom-spmi-pmic.c b/drivers/mfd/qcom-spmi-pmic.c<br/>index 47738f7e492ca9..8e449cff5cec40 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mfd/qcom-spmi-pmic.c?id=a0fa44c261e448c531f9adb3a5189a3520f3e316'>drivers/mfd/qcom-spmi-pmic.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mfd/qcom-spmi-pmic.c?id=7b439aaa62fee474a0d84d67a25f4984467e7b95'>drivers/mfd/qcom-spmi-pmic.c</a></div><div class='hunk'>@@ -30,6 +30,8 @@ struct qcom_spmi_dev {</div><div class='ctx'> 	struct qcom_spmi_pmic pmic;</div><div class='ctx'> };</div><div class='ctx'> </div><div class='add'>+static DEFINE_MUTEX(pmic_spmi_revid_lock);</div><div class='add'>+</div><div class='ctx'> #define N_USIDS(n)		((void *)n)</div><div class='ctx'> </div><div class='ctx'> static const struct of_device_id pmic_spmi_id_table[] = {</div><div class='hunk'>@@ -76,24 +78,21 @@ static const struct of_device_id pmic_spmi_id_table[] = {</div><div class='ctx'>  *</div><div class='ctx'>  * This only supports PMICs with 1 or 2 USIDs.</div><div class='ctx'>  */</div><div class='del'>-static struct spmi_device *qcom_pmic_get_base_usid(struct device *dev)</div><div class='add'>+static struct spmi_device *qcom_pmic_get_base_usid(struct spmi_device *sdev, struct qcom_spmi_dev *ctx)</div><div class='ctx'> {</div><div class='del'>-	struct spmi_device *sdev;</div><div class='del'>-	struct qcom_spmi_dev *ctx;</div><div class='ctx'> 	struct device_node *spmi_bus;</div><div class='ctx'> 	struct device_node *child;</div><div class='ctx'> 	int function_parent_usid, ret;</div><div class='ctx'> 	u32 pmic_addr;</div><div class='ctx'> </div><div class='del'>-	sdev = to_spmi_device(dev);</div><div class='del'>-	ctx = dev_get_drvdata(&amp;sdev-&gt;dev);</div><div class='del'>-</div><div class='ctx'> 	/*</div><div class='ctx'> 	 * Quick return if the function device is already in the base</div><div class='ctx'> 	 * USID. This will always be hit for PMICs with only 1 USID.</div><div class='ctx'> 	 */</div><div class='del'>-	if (sdev-&gt;usid % ctx-&gt;num_usids == 0)</div><div class='add'>+	if (sdev-&gt;usid % ctx-&gt;num_usids == 0) {</div><div class='add'>+		get_device(&amp;sdev-&gt;dev);</div><div class='ctx'> 		return sdev;</div><div class='add'>+	}</div><div class='ctx'> </div><div class='ctx'> 	function_parent_usid = sdev-&gt;usid;</div><div class='ctx'> </div><div class='hunk'>@@ -118,10 +117,8 @@ static struct spmi_device *qcom_pmic_get_base_usid(struct device *dev)</div><div class='ctx'> 			sdev = spmi_device_from_of(child);</div><div class='ctx'> 			if (!sdev) {</div><div class='ctx'> 				/*</div><div class='del'>-				 * If the base USID for this PMIC hasn't probed yet</div><div class='del'>-				 * but the secondary USID has, then we need to defer</div><div class='del'>-				 * the function driver so that it will attempt to</div><div class='del'>-				 * probe again when the base USID is ready.</div><div class='add'>+				 * If the base USID for this PMIC hasn't been</div><div class='add'>+				 * registered yet then we need to defer.</div><div class='ctx'> 				 */</div><div class='ctx'> 				sdev = ERR_PTR(-EPROBE_DEFER);</div><div class='ctx'> 			}</div><div class='hunk'>@@ -135,6 +132,35 @@ static struct spmi_device *qcom_pmic_get_base_usid(struct device *dev)</div><div class='ctx'> 	return sdev;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='add'>+static int pmic_spmi_get_base_revid(struct spmi_device *sdev, struct qcom_spmi_dev *ctx)</div><div class='add'>+{</div><div class='add'>+	struct qcom_spmi_dev *base_ctx;</div><div class='add'>+	struct spmi_device *base;</div><div class='add'>+	int ret = 0;</div><div class='add'>+</div><div class='add'>+	base = qcom_pmic_get_base_usid(sdev, ctx);</div><div class='add'>+	if (IS_ERR(base))</div><div class='add'>+		return PTR_ERR(base);</div><div class='add'>+</div><div class='add'>+	/*</div><div class='add'>+	 * Copy revid info from base device if it has probed and is still</div><div class='add'>+	 * bound to its driver.</div><div class='add'>+	 */</div><div class='add'>+	mutex_lock(&amp;pmic_spmi_revid_lock);</div><div class='add'>+	base_ctx = spmi_device_get_drvdata(base);</div><div class='add'>+	if (!base_ctx) {</div><div class='add'>+		ret = -EPROBE_DEFER;</div><div class='add'>+		goto out_unlock;</div><div class='add'>+	}</div><div class='add'>+	memcpy(&amp;ctx-&gt;pmic, &amp;base_ctx-&gt;pmic, sizeof(ctx-&gt;pmic));</div><div class='add'>+out_unlock:</div><div class='add'>+	mutex_unlock(&amp;pmic_spmi_revid_lock);</div><div class='add'>+</div><div class='add'>+	put_device(&amp;base-&gt;dev);</div><div class='add'>+</div><div class='add'>+	return ret;</div><div class='add'>+}</div><div class='add'>+</div><div class='ctx'> static int pmic_spmi_load_revid(struct regmap *map, struct device *dev,</div><div class='ctx'> 				 struct qcom_spmi_pmic *pmic)</div><div class='ctx'> {</div><div class='hunk'>@@ -210,11 +236,7 @@ const struct qcom_spmi_pmic *qcom_pmic_get(struct device *dev)</div><div class='ctx'> 	if (!of_match_device(pmic_spmi_id_table, dev-&gt;parent))</div><div class='ctx'> 		return ERR_PTR(-EINVAL);</div><div class='ctx'> </div><div class='del'>-	sdev = qcom_pmic_get_base_usid(dev-&gt;parent);</div><div class='del'>-</div><div class='del'>-	if (IS_ERR(sdev))</div><div class='del'>-		return ERR_CAST(sdev);</div><div class='del'>-</div><div class='add'>+	sdev = to_spmi_device(dev-&gt;parent);</div><div class='ctx'> 	spmi = dev_get_drvdata(&amp;sdev-&gt;dev);</div><div class='ctx'> </div><div class='ctx'> 	return &amp;spmi-&gt;pmic;</div><div class='hunk'>@@ -249,16 +271,31 @@ static int pmic_spmi_probe(struct spmi_device *sdev)</div><div class='ctx'> 		ret = pmic_spmi_load_revid(regmap, &amp;sdev-&gt;dev, &amp;ctx-&gt;pmic);</div><div class='ctx'> 		if (ret &lt; 0)</div><div class='ctx'> 			return ret;</div><div class='add'>+	} else {</div><div class='add'>+		ret = pmic_spmi_get_base_revid(sdev, ctx);</div><div class='add'>+		if (ret)</div><div class='add'>+			return ret;</div><div class='ctx'> 	}</div><div class='add'>+</div><div class='add'>+	mutex_lock(&amp;pmic_spmi_revid_lock);</div><div class='ctx'> 	spmi_device_set_drvdata(sdev, ctx);</div><div class='add'>+	mutex_unlock(&amp;pmic_spmi_revid_lock);</div><div class='ctx'> </div><div class='ctx'> 	return devm_of_platform_populate(&amp;sdev-&gt;dev);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='add'>+static void pmic_spmi_remove(struct spmi_device *sdev)</div><div class='add'>+{</div><div class='add'>+	mutex_lock(&amp;pmic_spmi_revid_lock);</div><div class='add'>+	spmi_device_set_drvdata(sdev, NULL);</div><div class='add'>+	mutex_unlock(&amp;pmic_spmi_revid_lock);</div><div class='add'>+}</div><div class='add'>+</div><div class='ctx'> MODULE_DEVICE_TABLE(of, pmic_spmi_id_table);</div><div class='ctx'> </div><div class='ctx'> static struct spmi_driver pmic_spmi_driver = {</div><div class='ctx'> 	.probe = pmic_spmi_probe,</div><div class='add'>+	.remove = pmic_spmi_remove,</div><div class='ctx'> 	.driver = {</div><div class='ctx'> 		.name = "pmic-spmi",</div><div class='ctx'> 		.of_match_table = pmic_spmi_id_table,</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit 1.2.3-korg</a> (<a href='https://git-scm.com/'>git 2.43.0</a>) at 2025-01-10 20:19:55 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
