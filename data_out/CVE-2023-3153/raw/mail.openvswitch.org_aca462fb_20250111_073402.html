<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ovs-announce] [ADVISORY] CVE-2023-3153 OVN: Service monitor MAC flow is not rate limited
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:ovs-announce%40openvswitch.org?Subject=Re:%20Re%3A%20%5Bovs-announce%5D%20%5BADVISORY%5D%20CVE-2023-3153%20OVN%3A%20Service%20monitor%20MAC%0A%20flow%20is%20not%20rate%20limited&In-Reply-To=%3C3b63d77a-d55b-85b3-0317-fbb313417525%40redhat.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000326.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ovs-announce] [ADVISORY] CVE-2023-3153 OVN: Service monitor MAC flow is not rate limited</H1>
    <B>Mark Michelson</B> 
    <A HREF="mailto:ovs-announce%40openvswitch.org?Subject=Re:%20Re%3A%20%5Bovs-announce%5D%20%5BADVISORY%5D%20CVE-2023-3153%20OVN%3A%20Service%20monitor%20MAC%0A%20flow%20is%20not%20rate%20limited&In-Reply-To=%3C3b63d77a-d55b-85b3-0317-fbb313417525%40redhat.com%3E"
       TITLE="[ovs-announce] [ADVISORY] CVE-2023-3153 OVN: Service monitor MAC flow is not rate limited">mmichels at redhat.com
       </A><BR>
    <I>Tue Aug 29 17:03:27 UTC 2023</I>
    <P><UL>
        <LI>Previous message: <A HREF="000326.html">[ovs-announce] OVN 22.03.3, 22.09.2, 22.12.1, 23.03.1,	and 23.06.1 Released
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#327">[ date ]</a>
              <a href="thread.html#327">[ thread ]</a>
              <a href="subject.html#327">[ subject ]</a>
              <a href="author.html#327">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Description
===========

Multiple versions of Open Virtual Network (OVN) are vulnerable to a 
potential denial of service via traffic sent to the svc_monitor_mac.

The svc_monitor_mac is a MAC address used by OVN for the purposes of 
load balancer health checks. The svc_monitor_mac may be explicitly 
configured in the northbound database's NB_Global 
&quot;options:svc_monitor_mac&quot;. If it is not configured, then ovn-northd will 
choose a random MAC address for svc_monitor_mac and save it in the 
NB_Global &quot;options:svc_monitor_mac&quot;. OVN will assign a svc_monitor_mac 
regardless of whether any load balancer health checks are configured.

If an attacker were to learn the svc_monitor_mac, then they could 
potentially cause a denial of service by continually sending traffic to 
the svc_monitor_mac, resulting in continuous upcalls to ovn-controller. 
These continuous upcalls can drive up the CPU usage of ovn-controller 
and prevent Open vSwitch from being able to handle legitimate traffic.

Note that learning the svc_monitor_mac is not straightforward. The 
attacker would need to either
a) Have access to the contents of the northbound database so that they 
can see NB_Global's options:svc_monitor_mac value.
b) If load balancer health checks are configured, then the attacker 
would need access to virtual machines attached to the br-int bridge so 
that traffic could be sniffed to learn the svc_monitor_mac.

Load balancer health checks were added to OVN in October 2019. 
Therefore, all OVN releases from 20.03 to 23.06 are vulnerable.

The Common Vulnerabilities and Exposures project (cve.mitre.org) has
assigned the identifier CVE-2023-3153 to this issue.

Mitigation
==========

Administrators can mitigate the risk by ensuring that access to the 
northbound database and to virtual machines attached to br-int is 
restricted. Administrators may further mitigate the risk by periodically 
clearing the NB_Global options:svc_monitor_mac in the northbound 
database, causing ovn-northd to generate a new random svc_monitor_mac.

Fix
===

Administrators may either apply one of the patches attached to this 
advisory, or they may upgrade their OVN version to a patched version. 
Administrators should also enable control plane protection (CoPP) for 
the new &quot;svc_monitor&quot; meter on logical switches. This goes especially 
for logical switches that accept traffic from the public internet. The 
OVN project only prepares patches for versions of OVN that are currently 
under support. The following versions of OVN have the vulnerability patched:

* OVN version 22.03.3 or higher
* OVN version 22.09.2 or higher
* OVN version 22.12.1 or higher
* OVN version 23.03.1 or higher
* OVN version 23.06.1 or higher

Recommendation
==============

OVN administrators should upgrade to any of the versions listed in the 
previous section. Administrators should also enable control plane 
protection (CoPP) for the new &quot;svc_monitor&quot; meter on logical switches. 
This goes especially for logical switches that accept traffic from the 
public internet

Acknowledgments
===============

Thanks to Ales Musil of Red Hat for discovering, disclosing, and fixing 
the vulnerability. Thanks to Dumitru Ceara of Red Hat for confirming the 
issue, determining the extent of the issue, and reviewing Ales's patch.

Patch
=====

The attached patches, all written by Ales Musil, provide a fix for each 
supported version of OVN.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: svc_23.06.patch
Type: text/x-patch
Size: 4778 bytes
Desc: not available
URL: &lt;<A HREF="http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0005.bin">http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0005.bin</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: svc_23.03.patch
Type: text/x-patch
Size: 4800 bytes
Desc: not available
URL: &lt;<A HREF="http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0006.bin">http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0006.bin</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: svc_22.12.patch
Type: text/x-patch
Size: 4800 bytes
Desc: not available
URL: &lt;<A HREF="http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0007.bin">http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0007.bin</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: svc_22.09.patch
Type: text/x-patch
Size: 4800 bytes
Desc: not available
URL: &lt;<A HREF="http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0008.bin">http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0008.bin</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: svc_22.03.patch
Type: text/x-patch
Size: 4800 bytes
Desc: not available
URL: &lt;<A HREF="http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0009.bin">http://mail.openvswitch.org/pipermail/ovs-announce/attachments/20230829/e3121130/attachment-0009.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000326.html">[ovs-announce] OVN 22.03.3, 22.09.2, 22.12.1, 23.03.1,	and 23.06.1 Released
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#327">[ date ]</a>
              <a href="thread.html#327">[ thread ]</a>
              <a href="subject.html#327">[ subject ]</a>
              <a href="author.html#327">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://mail.openvswitch.org/mailman/listinfo/ovs-announce">More information about the announce
mailing list</a><br>
</body></html>
