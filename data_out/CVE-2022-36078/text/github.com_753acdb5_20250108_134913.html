
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgagliardetto%2Fbinary%2Fpull%2F7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgagliardetto%2Fbinary%2Fpull%2F7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=gagliardetto%2Fbinary)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[gagliardetto](/gagliardetto)
/
**[binary](/gagliardetto/binary)**
Public

* [Notifications](/login?return_to=%2Fgagliardetto%2Fbinary) You must be signed in to change notification settings
* [Fork
  13](/login?return_to=%2Fgagliardetto%2Fbinary)
* [Star
   23](/login?return_to=%2Fgagliardetto%2Fbinary)

* [Code](/gagliardetto/binary)
* [Issues
  1](/gagliardetto/binary/issues)
* [Pull requests
  1](/gagliardetto/binary/pulls)
* [Actions](/gagliardetto/binary/actions)
* [Projects
  0](/gagliardetto/binary/projects)
* [Security](/gagliardetto/binary/security)
* [Insights](/gagliardetto/binary/pulse)

Additional navigation options

* [Code](/gagliardetto/binary)
* [Issues](/gagliardetto/binary/issues)
* [Pull requests](/gagliardetto/binary/pulls)
* [Actions](/gagliardetto/binary/actions)
* [Projects](/gagliardetto/binary/projects)
* [Security](/gagliardetto/binary/security)
* [Insights](/gagliardetto/binary/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgagliardetto%2Fbinary%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgagliardetto%2Fbinary%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Slice: use `reflect.Append` instead of pre-allocating whole slice. #7

 Merged

[gagliardetto](/gagliardetto)
merged 15 commits into
[master](/gagliardetto/binary/tree/master "gagliardetto/binary:master")
from
[slice-append](/gagliardetto/binary/tree/slice-append "gagliardetto/binary:slice-append")

Aug 28, 2022

 Merged

# [Slice: use `reflect.Append` instead of pre-allocating whole slice.](#top) #7

[gagliardetto](/gagliardetto)
merged 15 commits into
[master](/gagliardetto/binary/tree/master "gagliardetto/binary:master")
from
[slice-append](/gagliardetto/binary/tree/slice-append "gagliardetto/binary:slice-append")

Aug 28, 2022

[Conversation
9](/gagliardetto/binary/pull/7)
[Commits
15](/gagliardetto/binary/pull/7/commits)
[Checks
0](/gagliardetto/binary/pull/7/checks)
[Files changed](/gagliardetto/binary/pull/7/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=60&v=4)](/gagliardetto)

Copy link

Owner

### @gagliardetto **[gagliardetto](/gagliardetto)** commented [Aug 20, 2022](#issue-1345172206)

 *No description provided.*

Sorry, something went wrong.

All reactions

 [gagliardetto](/gagliardetto)
added 4 commits
[August 20, 2022 15:56](#commits-pushed-5cb550a)

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Decoding slices: use reflect.Append instead of allocating slice.](/gagliardetto/binary/pull/7/commits/5cb550a5af8cd5f3fd470db6fc2ea3de5cf03b3a "Decoding slices: use `reflect.Append` instead of allocating slice.")`

`[5cb550a](/gagliardetto/binary/pull/7/commits/5cb550a5af8cd5f3fd470db6fc2ea3de5cf03b3a)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Fix borsh test](/gagliardetto/binary/pull/7/commits/d8654f826569e16b02b52332f8dd7cfecb6b723f "Fix borsh test")`

`[d8654f8](/gagliardetto/binary/pull/7/commits/d8654f826569e16b02b52332f8dd7cfecb6b723f)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[readNBytes: add limit checks; ReadRustString: add limit check; add Di…](/gagliardetto/binary/pull/7/commits/4dc456978dc43c43aa8588bb239548e6fc505752 "readNBytes: add limit checks; ReadRustString: add limit check; add Discard method")`
 …

`[4dc4569](/gagliardetto/binary/pull/7/commits/4dc456978dc43c43aa8588bb239548e6fc505752)`

```
…scard method
```

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Add tests for go 1.19.x](/gagliardetto/binary/pull/7/commits/d94c91005d9ab9998ebf648b5056a42d035bc2ee "Add tests for go 1.19.x")`

`[d94c910](/gagliardetto/binary/pull/7/commits/d94c91005d9ab9998ebf648b5056a42d035bc2ee)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=80&u=285ccb15ceda22d7eead1d99568de23738e78944&v=4)](/gagliardetto)

Copy link

Owner

Author

### **[gagliardetto](/gagliardetto)** commented [Aug 20, 2022](#issuecomment-1221320374)

| [@terorie](https://github.com/terorie) pls take a look next week |
| --- |

All reactions

Sorry, something went wrong.

 [gagliardetto](/gagliardetto)
added 3 commits
[August 20, 2022 17:04](#commits-pushed-c0cb6ac)

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[More tests](/gagliardetto/binary/pull/7/commits/c0cb6acd1adc8c2182d0eb993179899c2d7ff72a "More tests")`

`[c0cb6ac](/gagliardetto/binary/pull/7/commits/c0cb6acd1adc8c2182d0eb993179899c2d7ff72a)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Add specialized uint array/slice encoders](/gagliardetto/binary/pull/7/commits/1ff28ef76f0ab0cb078b14ee5cc3e25ace417641 "Add specialized uint array/slice encoders")`

`[1ff28ef](/gagliardetto/binary/pull/7/commits/1ff28ef76f0ab0cb078b14ee5cc3e25ace417641)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Add optimized uint array/slice encoders](/gagliardetto/binary/pull/7/commits/a8f014978216e3d6700ad8a7f12de4dbb7f7336d "Add optimized uint array/slice encoders")`

`[a8f0149](/gagliardetto/binary/pull/7/commits/a8f014978216e3d6700ad8a7f12de4dbb7f7336d)`

[![riptl](https://avatars.githubusercontent.com/u/21371810?s=60&v=4)](/riptl)

**[riptl](/riptl)**
reviewed
[Aug 22, 2022](#pullrequestreview-1080124874)

 [View reviewed changes](/gagliardetto/binary/pull/7/files/a8f014978216e3d6700ad8a7f12de4dbb7f7336d)

[decoder.go](/gagliardetto/binary/pull/7/files/a8f014978216e3d6700ad8a7f12de4dbb7f7336d#diff-2a967f84f1af0d52111b8dbfbeadc44bfeb1092dacebb2bc0648a0e57284c04b)
Outdated

|  |  |  |
| --- | --- | --- |
|  |  | func reflect\_readArrayOfBytes(append bool, d \*Decoder, l int, rv reflect.Value) error { |
|  |  | for i := 0; i < l; i++ { |
|  |  | n, err := d.ReadByte() |

Copy link

Contributor

### @riptl **[riptl](/riptl)** [Aug 22, 2022](#discussion_r951195677)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

We can save a lot of bounds checking here by

* doing a bounds check for the entire array
* allocating the entire slice
* then filling it

Same for all the other primitive arrays and slices

`reflect.Append` is worse than pre-allocation when the slice size is known because the end result is the same (in terms of memory usage), but the former is less efficient

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @riptl **[riptl](/riptl)** [Aug 22, 2022](#discussion_r951240989)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Two more optimization ideas:

* On little endian machines without alignment requirements, no conversion is necessary for integer primitive types like uint16`. We could simply unsafely copy into the backing memory buffer of a slice.
* In all simple copy cases, allocating a slice isn't even necessary – The decoder could unsafely construct a slice that points to a place in the serialized buffer

Sorry, something went wrong.

All reactions

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Reduce usage of reflect](/gagliardetto/binary/pull/7/commits/179e9d3e10c255ee7c3007c41c7d30911843f3f1 "Reduce usage of reflect")`

`[179e9d3](/gagliardetto/binary/pull/7/commits/179e9d3e10c255ee7c3007c41c7d30911843f3f1)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=80&u=285ccb15ceda22d7eead1d99568de23738e78944&v=4)](/gagliardetto)

Copy link

Owner

Author

### **[gagliardetto](/gagliardetto)** commented [Aug 22, 2022](#issuecomment-1222273367) • edited Loading

| Thanks!  Before:  ``` Benchmark_uintSlices_Decode-8     	    6078	    179633 ns/op	   38688 B/op	    1297 allocs/op Benchmark_uintSlices_append-8     	    3704	    302197 ns/op	   64144 B/op	    2829 allocs/op Benchmark_uintSlices_allocate-8   	   10000	    103067 ns/op	   16408 B/op	    1026 allocs/op  ```  After:  ``` Benchmark_uintSlices_Decode-8        	   95216	     12386 ns/op	    4256 B/op	       6 allocs/op Benchmark_uintSlices_append-8        	   13005	     92601 ns/op	   16432 B/op	    1027 allocs/op Benchmark_uintSlices_preallocate-8   	   12608	     92314 ns/op	   24624 B/op	    1028 allocs/op  ```  (NOTE: the name poorly reflects what happens inside in the AFTER) |
| --- |

All reactions

Sorry, something went wrong.

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Make tests more uniform](/gagliardetto/binary/pull/7/commits/90ac7a194d265121087a8fce0bdab50a012eec20 "Make tests more uniform")`

`[90ac7a1](/gagliardetto/binary/pull/7/commits/90ac7a194d265121087a8fce0bdab50a012eec20)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=80&u=285ccb15ceda22d7eead1d99568de23738e78944&v=4)](/gagliardetto)

Copy link

Owner

Author

### **[gagliardetto](/gagliardetto)** commented [Aug 22, 2022](#issuecomment-1222295197) • edited Loading

| Okay, so now for slices of uints:   * checking if remaining bytes are enough for the desired slice size. * slice of that specific type is pre-allocated. * no reflect is involved in the creation of the slice or the writing to it. * when the slice is ready, it's set upstream using reflect. |
| --- |

All reactions

Sorry, something went wrong.

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[More tests](/gagliardetto/binary/pull/7/commits/e6ae9471b345f4205bd7d577fe87bf2997e0e1bd "More tests")`

`[e6ae947](/gagliardetto/binary/pull/7/commits/e6ae9471b345f4205bd7d577fe87bf2997e0e1bd)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=80&u=285ccb15ceda22d7eead1d99568de23738e78944&v=4)](/gagliardetto)

Copy link

Owner

Author

### **[gagliardetto](/gagliardetto)** commented [Aug 22, 2022](#issuecomment-1222307566)

| Ooops, wrong type in the benchmark. |
| --- |

All reactions

Sorry, something went wrong.

 [gagliardetto](/gagliardetto)
added 2 commits
[August 22, 2022 14:52](#commits-pushed-06d42a1)

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Improve benchmarks](/gagliardetto/binary/pull/7/commits/06d42a1bf34b3a722cc99233a40591a702ca59cf "Improve benchmarks")`

`[06d42a1](/gagliardetto/binary/pull/7/commits/06d42a1bf34b3a722cc99233a40591a702ca59cf)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Add benchmark for uint32 slices/arrays](/gagliardetto/binary/pull/7/commits/df95dbc19bc032b006cd28d9f5ba6afebf29023c "Add benchmark for uint32 slices/arrays")`

`[df95dbc](/gagliardetto/binary/pull/7/commits/df95dbc19bc032b006cd28d9f5ba6afebf29023c)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=80&u=285ccb15ceda22d7eead1d99568de23738e78944&v=4)](/gagliardetto)

Copy link

Owner

Author

### **[gagliardetto](/gagliardetto)** commented [Aug 22, 2022](#issuecomment-1222325960) • edited Loading

| Final benchmark: BEFORE optimizing uint slices (underlying use of reflect.Append) ``` goos: linux goarch: amd64 pkg: github.com/gagliardetto/binary cpu: Intel(R) Core(TM) i7-7700HQ CPU @ 2.80GHz Benchmark_uintSlice64_Decode_noMake-8         	    3636	    326426 ns/op	  131864 B/op	    5137 allocs/op Benchmark_uintSlice64_Decode_make-8           	    3724	    308653 ns/op	  131864 B/op	    5137 allocs/op Benchmark_uintSlice64_Decode_field_noMake-8   	    3643	    302873 ns/op	  132008 B/op	    5143 allocs/op Benchmark_uintSlice64_Decode_field_make-8     	    3644	    303124 ns/op	  132008 B/op	    5143 allocs/op Benchmark_uintSlice64_reflect_noMake-8        	   24592	     50456 ns/op	   16480 B/op	    1028 allocs/op Benchmark_uintSlice64_reflect_make-8          	   24235	     49264 ns/op	   16480 B/op	    1028 allocs/op Benchmark_uintSlice32_Decode_noMake-8         	    4402	    246662 ns/op	  107296 B/op	    4113 allocs/op Benchmark_uintSlice32_Decode_make-8           	    4700	    251511 ns/op	  107296 B/op	    4113 allocs/op Benchmark_uintSlice32_Decode_field_noMake-8   	    4592	    253552 ns/op	  107440 B/op	    4119 allocs/op Benchmark_uintSlice32_Decode_field_make-8     	    4332	    256575 ns/op	  107440 B/op	    4119 allocs/op Benchmark_uintSlice32_reflect_noMake-8        	  173953	      6631 ns/op	    4192 B/op	       4 allocs/op Benchmark_uintSlice32_reflect_make-8          	  165073	      6599 ns/op	    4192 B/op	       4 allocs/op PASS ok  	github.com/gagliardetto/binary	15.178s ``` BEFORE optimizing uint slices (underlying use of reflect.MakeSlice + rv.Index(i).Set) ``` goos: linux goarch: amd64 pkg: github.com/gagliardetto/binary cpu: Intel(R) Core(TM) i7-7700HQ CPU @ 2.80GHz Benchmark_uintSlice64_Decode_noMake-8         	    5041	    244716 ns/op	   90272 B/op	    4102 allocs/op Benchmark_uintSlice64_Decode_make-8           	    5509	    216908 ns/op	   90272 B/op	    4102 allocs/op Benchmark_uintSlice64_Decode_field_noMake-8   	    5554	    217488 ns/op	   90416 B/op	    4108 allocs/op Benchmark_uintSlice64_Decode_field_make-8     	    4992	    227863 ns/op	   90416 B/op	    4108 allocs/op Benchmark_uintSlice64_reflect_noMake-8        	   22930	     53717 ns/op	   16480 B/op	    1028 allocs/op Benchmark_uintSlice64_reflect_make-8          	   23380	     49189 ns/op	   16480 B/op	    1028 allocs/op Benchmark_uintSlice32_Decode_noMake-8         	    6961	    166826 ns/op	   73888 B/op	    3078 allocs/op Benchmark_uintSlice32_Decode_make-8           	    6466	    169598 ns/op	   73888 B/op	    3078 allocs/op Benchmark_uintSlice32_Decode_field_noMake-8   	    6379	    166451 ns/op	   74032 B/op	    3084 allocs/op Benchmark_uintSlice32_Decode_field_make-8     	    6475	    170186 ns/op	   74032 B/op	    3084 allocs/op Benchmark_uintSlice32_reflect_noMake-8        	  179046	      6314 ns/op	    4192 B/op	       4 allocs/op Benchmark_uintSlice32_reflect_make-8          	  169556	      6537 ns/op	    4192 B/op	       4 allocs/op PASS ok  	github.com/gagliardetto/binary	18.773s ``` AFTER optimizing for uint slices ``` $ go test  -bench "uintSlice" -benchmem  goos: linux goarch: amd64 pkg: github.com/gagliardetto/binary cpu: Intel(R) Core(TM) i7-7700HQ CPU @ 2.80GHz Benchmark_uintSlice64_Decode_noMake-8         	   22210	     52099 ns/op	   16544 B/op	    1030 allocs/op Benchmark_uintSlice64_Decode_make-8           	   22062	     54300 ns/op	   16544 B/op	    1030 allocs/op Benchmark_uintSlice64_Decode_field_noMake-8   	   21668	     54316 ns/op	   16688 B/op	    1036 allocs/op Benchmark_uintSlice64_Decode_field_make-8     	   22428	     54018 ns/op	   16688 B/op	    1036 allocs/op Benchmark_uintSlice64_reflect_noMake-8        	   22785	     53440 ns/op	   16480 B/op	    1028 allocs/op Benchmark_uintSlice64_reflect_make-8          	   22976	     52906 ns/op	   16480 B/op	    1028 allocs/op Benchmark_uintSlice32_Decode_noMake-8         	  149244	      7155 ns/op	    4256 B/op	       6 allocs/op Benchmark_uintSlice32_Decode_make-8           	  160652	      7149 ns/op	    4256 B/op	       6 allocs/op Benchmark_uintSlice32_Decode_field_noMake-8   	  151970	      7551 ns/op	    4400 B/op	      12 allocs/op Benchmark_uintSlice32_Decode_field_make-8     	  151761	      7708 ns/op	    4400 B/op	      12 allocs/op Benchmark_uintSlice32_reflect_noMake-8        	  160108	      7006 ns/op	    4192 B/op	       4 allocs/op Benchmark_uintSlice32_reflect_make-8          	  154717	      7048 ns/op	    4192 B/op	       4 allocs/op PASS ok  	github.com/gagliardetto/binary	17.686s ``` |
| --- |

All reactions

Sorry, something went wrong.

 [gagliardetto](/gagliardetto)
added 3 commits
[August 22, 2022 15:00](#commits-pushed-5788bc1)

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Add missing checks to benchmarks](/gagliardetto/binary/pull/7/commits/5788bc14303437392a18b22b33ff4df83ceb38e4 "Add missing checks to benchmarks")`

`[5788bc1](/gagliardetto/binary/pull/7/commits/5788bc14303437392a18b22b33ff4df83ceb38e4)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Add bench for custom decoder](/gagliardetto/binary/pull/7/commits/76b230862ea20945d697e4f225350722b8b3435e "Add bench for custom decoder")`

`[76b2308](/gagliardetto/binary/pull/7/commits/76b230862ea20945d697e4f225350722b8b3435e)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&v=4)](/gagliardetto)

`[Cleanup](/gagliardetto/binary/pull/7/commits/b4927ddf838a58757ea28038cb9a77a017043fd0 "Cleanup")`

`[b4927dd](/gagliardetto/binary/pull/7/commits/b4927ddf838a58757ea28038cb9a77a017043fd0)`

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=80&u=285ccb15ceda22d7eead1d99568de23738e78944&v=4)](/gagliardetto)

Copy link

Owner

Author

### **[gagliardetto](/gagliardetto)** commented [Aug 24, 2022](#issuecomment-1226352348)

| If this looks good, I'll proceed tomorrow to merge. [@terorie](https://github.com/terorie) |
| --- |

All reactions

Sorry, something went wrong.

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&u=285ccb15ceda22d7eead1d99568de23738e78944&v=4)](/gagliardetto)
[gagliardetto](/gagliardetto)
merged commit [`2b26380`](/gagliardetto/binary/commit/2b2638040b6d1921df7e9247b441a630ba80d517)
into
master

[Aug 28, 2022](https://github.com/gagliardetto/binary/pull/7#event-7273404913)

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=80&u=285ccb15ceda22d7eead1d99568de23738e78944&v=4)](/gagliardetto)

Copy link

Owner

Author

### **[gagliardetto](/gagliardetto)** commented [Aug 28, 2022](#issuecomment-1229454843)

| After simplifying `readNBytes`:  ``` goos: linux goarch: amd64 pkg: github.com/gagliardetto/binary cpu: Intel(R) Core(TM) i7-7700HQ CPU @ 2.80GHz Benchmark_uintSlice64_Decode_noMake-8                    	  109407	     10240 ns/op	    8352 B/op	       6 allocs/op Benchmark_uintSlice64_Decode_make-8                      	  104725	     10590 ns/op	    8352 B/op	       6 allocs/op Benchmark_uintSlice64_Decode_field_noMake-8              	  106695	     10673 ns/op	    8496 B/op	      12 allocs/op Benchmark_uintSlice64_Decode_field_make-8                	  109975	     11053 ns/op	    8496 B/op	      12 allocs/op Benchmark_uintSlice64_readArray_noMake-8                 	  109645	     10126 ns/op	    8288 B/op	       4 allocs/op Benchmark_uintSlice64_readArray_make-8                   	  104791	     10162 ns/op	    8288 B/op	       4 allocs/op Benchmark_uintSlice64_Decode_field_withCustomDecoder-8   	  110866	     10326 ns/op	    8240 B/op	       2 allocs/op Benchmark_uintSlice32_Decode_noMake-8                    	  162374	      7324 ns/op	    4256 B/op	       6 allocs/op Benchmark_uintSlice32_Decode_make-8                      	  140947	      7607 ns/op	    4256 B/op	       6 allocs/op Benchmark_uintSlice32_Decode_field_noMake-8              	  130076	      7981 ns/op	    4400 B/op	      12 allocs/op Benchmark_uintSlice32_Decode_field_make-8                	  127812	      8376 ns/op	    4400 B/op	      12 allocs/op Benchmark_uintSlice32_readArray_noMake-8                 	  150466	      7251 ns/op	    4192 B/op	       4 allocs/op Benchmark_uintSlice32_readArray_make-8                   	  160896	      6962 ns/op	    4192 B/op	       4 allocs/op Benchmark_uintSlice32_Decode_field_withCustomDecoder-8   	  151675	      7046 ns/op	    4144 B/op	       2 allocs/op ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Sep 2, 2022](#ref-issue-1360165933)

[x/vulndb: potential Go vuln in github.com/gagliardetto/binary: CVE-2022-36078
golang/vulndb#963](/golang/vulndb/issues/963)

Closed

 [![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=40&u=285ccb15ceda22d7eead1d99568de23738e78944&v=4)](/gagliardetto)
[gagliardetto](/gagliardetto)
deleted the
slice-append

branch
[October 2, 2022 09:58](#event-7501745641)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgagliardetto%2Fbinary%2Fpull%2F7)

Reviewers

[![@riptl](https://avatars.githubusercontent.com/u/21371810?s=40&v=4)](/riptl) [riptl](/riptl)

riptl left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@gagliardetto](https://avatars.githubusercontent.com/u/15271561?s=52&v=4)](/gagliardetto) [![@riptl](https://avatars.githubusercontent.com/u/21371810?s=52&v=4)](/riptl)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

