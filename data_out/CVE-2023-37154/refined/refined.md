The provided content relates to CVE-2023-37154.

**Root cause of vulnerability:**
The `check_by_ssh` plugin in Nagios-plugins allows users to pass arbitrary options to the `ssh` command. Specifically, the `-o` option can be used to inject commands via `ProxyCommand`, `LocalCommand`, or `PermitLocalCommand`, which are normally used on the client side of an SSH connection.

**Weaknesses/vulnerabilities present:**
- Argument Injection: The `check_by_ssh` plugin does not properly sanitize or restrict the options passed to the underlying ssh command, leading to argument injection vulnerability.
- Lack of input validation: The plugin does not validate or filter the options supplied through the `-o` parameter.

**Impact of exploitation:**
- Remote code execution: An attacker can execute arbitrary commands on the monitored server by injecting malicious SSH options that trigger local command execution on the monitored server through the `check_by_ssh` plugin. This is achievable even when the nagios user's SSH access is restricted to only running installed plugins.
- System takeover: Successful exploitation leads to complete compromise of the monitored server.

**Attack vectors:**
- The attacker must be able to control or influence the arguments passed to the `check_by_ssh` plugin on the Nagios server.
- The attacker needs to have access to the Nagios server and its SSH private key used for monitoring.
- The `check_by_ssh` plugin must be installed on the monitored server.

**Required attacker capabilities/position:**
- The attacker needs to compromise the Nagios Core server to get access to the private key used to connect to the monitored servers.
- The attacker needs to be able to execute commands on the Nagios core server.
- Knowledge of how to exploit the ssh options `ProxyCommand`, `LocalCommand`, and `PermitLocalCommand` for local command execution.

**Additional Notes:**
- The original `nagios-plugins` project considers this a vulnerability and has fixed it by restricting the mentioned SSH options. However, `monitoring-plugins` does not consider this a security issue, stating there may be legitimate reasons for supporting the functionality.
- The vulnerability can be mitigated by restricting the ssh options passed to the `check_by_ssh` plugin.
- The `negate` plugin can also be used to execute arbitrary commands by design.
- The provided exploit uses `${IFS}` to bypass restrictions regarding spaces in command arguments.