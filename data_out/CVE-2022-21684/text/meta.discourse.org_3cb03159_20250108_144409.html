

[Discourse Meta](/)

# [Invite redemption allowed user to access forum BEFORE approval](/t/invite-redemption-allowed-user-to-access-forum-before-approval/214328)

[Bug](/c/bug/1)

[approval](https://meta.discourse.org/tag/approval),
[invites](https://meta.discourse.org/tag/invites)

[nathank](https://meta.discourse.org/u/nathank)
(Nathan Kershaw)

January 10, 2022, 2:25am

1

Our Forum has these settings:

1. login\_required ON
2. must\_approve\_users ON
3. min\_trust\_level\_to\_allow\_invite 2 : member

When testing our forum invites, I noticed that:

1. When a TL2 user invites another user via email *and*
2. They click the invite link in their email *and*
3. They fill in the fields and submit it

This happens → they are taken straight into the Forum (as though pre-approved), and can read it at will. They should not be able to do this until approved.

They indeed remain unapproved. If they try to access the site again, they are prevented with the standard “you aren’t approved” message.

5 Likes

[Benjamin\_D](https://meta.discourse.org/u/Benjamin_D)
(Benjamin Decotte)

January 10, 2022, 7:50am

2

Indeed, I can repro this on 2.8.0.beta10 (  [bbca25e875](https://github.com/discourse/discourse/commits/bbca25e875c36d3541b22c520b6d56ae6322dfbe)  )

3 Likes

[JammyDodger](https://meta.discourse.org/u/JammyDodger)

January 10, 2022, 8:53am

4

I can confirm on my test site ([17ec3bc5b9](https://github.com/discourse/discourse/commits/17ec3bc5b9ebf2ed241035dc37cec25475c5e4ad))

* Log on required
* Must approve users
* TL2 can send invites

And my invitee could view and post on that ‘sign-up visit’ without being approved.

3 Likes

[sam](https://meta.discourse.org/u/sam)
(Sam Saffron)

January 11, 2022, 5:42am

5

This is a complicated situation.

We have no implementation at the moment for “Hold tight, until someone approves your account”

In fact I am not sure it even makes sense, why would you invite someone to the forum just for them to be blocked.

I would say your immediate workaround is disallowing invites on tl2/3 … that will at least seal off this quirk.

I guess we should, at least in the interim, completely disable invite for **non staff** when `must_approve_users` is ON.

[@dan](/u/dan) thoughts?

9 Likes

[nathank](https://meta.discourse.org/u/nathank)
(Nathan Kershaw)

January 11, 2022, 8:44am

6

![](https://d3bpeqsaub0i6y.cloudfront.net/user_avatar/meta.discourse.org/sam/48/102149_2.png) sam:
> I would say your immediate workaround is disallowing invites on tl2/3 … that will at least seal off this quirk.

Done. Of course, TL4s will still have the problem of course, but I don’t actually have any of those so all good!

![](https://d3bpeqsaub0i6y.cloudfront.net/user_avatar/meta.discourse.org/sam/48/102149_2.png) sam:
> I guess we should, at least in the interim, completely disable invite for **non staff** when `must_approve_users` is ON.

That makes sense to me as a permanent solution.

I was a little surprised that my punters could invite others!

6 Likes

[dan](https://meta.discourse.org/u/dan)
(Dan Ungureanu)

January 12, 2022, 7:09am

7

![](https://d3bpeqsaub0i6y.cloudfront.net/user_avatar/meta.discourse.org/sam/48/102149_2.png) sam:
> [@dan](/u/dan) thoughts?

I am torn on this one because I understand both sides. However, I am thinking the status quo is a bit misleading because not all users who sign up must be approved.

To a certain extent, I guess it depends on the community and how much trust you put in your users. Maybe in the future must\_approve\_users can be a dropdown: no, yes or if not invited.

I am going to put this on my TODO list.

6 Likes

[jomaxro](https://meta.discourse.org/u/jomaxro)
(Joshua Rosenfeld)

January 13, 2022, 4:31pm

17

Resolved via [SECURITY: Do not sign in unapproved users (#15552) · discourse/discourse@584c6a2 · GitHub](https://github.com/discourse/discourse/commit/584c6a2e8bc705072b09a9c4b55126d6f8ed4ad2). Thanks for the report [@nathank](/u/nathank)!

6 Likes

[david](https://meta.discourse.org/u/david)
(David Taylor)
Closed

January 15, 2022, 8:00am

19

This topic was automatically closed after 31 hours. New replies are no longer allowed.

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Trusted users cannot invite when must approve users admin setting enabled](https://meta.discourse.org/t/trusted-users-cannot-invite-when-must-approve-users-admin-setting-enabled/190809)  [Support](/c/support/6) | 10 | 884 | June 17, 2021 |
| [Reviewing New Members](https://meta.discourse.org/t/reviewing-new-members/228991)  [Support](/c/support/6) | 6 | 554 | June 7, 2022 |
| [Better way for my users to invite others?](https://meta.discourse.org/t/better-way-for-my-users-to-invite-others/61665)  [Support](/c/support/6) [invites](https://meta.discourse.org/tag/invites) | 36 | 5188 | December 3, 2023 |
| [3.4.0.beta3: Restricting profile visibility of low Trust level users](https://meta.discourse.org/t/3-4-0-beta3-restricting-profile-visibility-of-low-trust-level-users/344524)  [Feature](/c/feature/2) | 23 | 222 | December 31, 2024 |
| [Invite-only Forum - Can non staff members invite others?](https://meta.discourse.org/t/invite-only-forum-can-non-staff-members-invite-others/52287)  [Support](/c/support/6) [invites](https://meta.discourse.org/tag/invites) | 17 | 4229 | January 11, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://www.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

