```
{
  "vulnerability": "CSRF vulnerability and missing permission checks in Recipe Plugin allow XXE",
  "cve": "CVE-2022-34794",
  "security_advisory": "Jenkins Security Advisory 2022-06-30",
  "affected_plugin": "Recipe Plugin",
  "affected_versions": "1.2 and earlier",
    "description": "Recipe Plugin 1.2 and earlier does not perform a permission check in multiple HTTP endpoints. This allows attackers with Overall/Read permission to send an HTTP request to an attacker-specified URL and parse the response as XML. As the plugin does not configure its XML parser to prevent XML external entity (XXE) attacks, attackers can have Jenkins parse a crafted XML response that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery. Additionally, this form validation method does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability. Additionally, the plugin allows users to export the full configuration of jobs as part of a recipe, granting access to job configuration XML data to every user with Item/Read permission. The encrypted values of secrets stored in the job configuration are not redacted, as they would be by the config.xml API for users without Item/Configure permission.",
  "root_cause": "Missing permission checks and lack of CSRF protection in multiple HTTP endpoints, along with insecure XML parsing.",
  "weaknesses": [
    "Missing permission checks in HTTP endpoints",
    "Cross-site request forgery (CSRF)",
	"XML External Entity (XXE) vulnerability",
    "Exposed secret data due to insufficient redaction"
  ],
  "impact": "Attackers with Overall/Read permissions can trigger an XXE vulnerability, potentially leading to secrets extraction from the Jenkins controller or server-side request forgery. Additionally, attackers can access job configuration data and potentially expose encrypted secrets. They can also perform actions such as sending HTTP requests and parsing responses as XML due to missing CSRF protection.",
   "attack_vectors": [
    "Sending crafted HTTP requests to an attacker-controlled URL",
    "Exploiting CSRF to perform actions without the user's consent",
     "Manipulating XML responses to trigger an XXE vulnerability"
  ],
  "required_capabilities": "The attacker needs Overall/Read permissions to exploit the missing permission checks. For CSRF exploitation, no specific permissions are required but a user has to be tricked into clicking a crafted link. To exploit the XXE vulnerability, the attacker would need to craft a malicious XML response served from an attacker-controlled server and have the Jenkins server parse this crafted XML."
}
```