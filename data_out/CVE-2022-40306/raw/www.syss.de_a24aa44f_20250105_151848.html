-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

﻿Advisory ID:               SYSS-2022-042 
Product:                   Printanista Hub (formerly Printscout)
Manufacturer:              ECi Software Solutions LTD (formerly FMAudit LLC)
Affected Version(s):       unknown
Vulnerability Type:        Asymmetric Resource Consumption (CWE-405) 
Risk Level:                Medium
Solution Status:           Not fixed
Manufacturer Notification: 2022-06-27
Solution Date:             Not fixed
Public Disclosure:         2022-09-15
CVE Reference:             CVE-2022-40306 
Author of Advisory:        Thibaud Kehler, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

Printanista Hub (former FMAudit Printscout) is a printing management 
web application.

The manufacturer describes the product as follows (see [1]):

"Printanista provides powerful functionality that reduces the complexity
of supporting your customers’ diverse print environments."

Due to an expensive key generation operation in the login form, the web 
application is susceptible to a denial-of-service attack that has been
actively exploited.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

Every time the web server renders the login form, it generates a new 
RSA private/public key pair, as can be seen in the following HTTP 
request:

'''
$ curl 'https://<hostname>/Login' | nl

[...]
   168	    function encryptPassword() {
   169	        var clearPass = $("#login-password").val();
   170	        $("#login-passhash").val(null);
   171	
   172	        var publicKeyExponent = Base64.decode("AQAB");
   173	        if (publicKeyExponent != false) {
   174	
   175	            var publicKeyModulus = Base64.decode("pHxCpuRqiDJigigqS3cm0Kvh+n+O40X8FSUSxANORGRlapedKdWJqnoKKx2sB/QR5kyxPBkiDcpsa1rVUn8PK4hcyU/psclJDiNk7zEmA4FhaiSwxf1vLGSstelFzlZSM0YmCx619dSpAxNB9fyRkp0R1WbPoGSLpdda9QibyDc=");
   176	            var publicKey = new RSAPublicKey(publicKeyModulus, publicKeyExponent);
   177	            var encryptedPass = RSA.encrypt(clearPass, publicKey);
   178	
   179	            $("#login-passhash").val(encryptedPass);
   180	            $("#login-password").val(null);
   181	        }
   182	    }
[...]
'''

The RSA key is used to encrypt the password in addition to any 
Transport Layer Security (TLS). Since no validation of the public key 
is conducted, the encryption by design is prone to machine-in-the-
middle attacks and mostly useless in times where TLS is prevailing.

Generating the necessary prime numbers, however, is an expensive 
cryptographic operation. Furthermore, the private key has to be 
stored on the server in order to decrypt incoming logins. 

An attacker can abuse the asymmetric resource consumption by 
sending multiple comparatively simple HTTP request in order to 
consume the web server's resources, potentially resulting in a 
denial of service.

SySS has knowledge of an active denial-of-service attack relying on 
this vulnerability. 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

The vendor has not published any solution yet. 

As a mitigation, SySS recommends removing the additional RSA encryption 
completely in favor of a well-configured Transport Layer Security. 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2020-07-13: Vulnerability discovered
2022-06-27: Vulnerability reported to manufacturer
2022-09-09: CVE-2022-40306 assigned
2022-09-15: Public disclosure of vulnerability

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Product website for Printanista Hub
    https://www.ecisolutions.com/en-gb/products/printanista-hub/
[2] SySS Security Advisory SYSS-2022-042
    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2022-042.txt (not yet published)
[3] SySS Responsible Disclosure Policy
    https://www.syss.de/en/responsible-disclosure-policy

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Thibaud Kehler of SySS GmbH.

E-Mail: thibaud.kehler@syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Thibaud_Kehler.asc
Key ID: 0xB6457D7A
Key Fingerprint: CF29 54F1 1B7F 2FF5 7ED9 9BAD E9C7 9866 B645 7D7A

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is" 
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS website.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEzylU8Rt/L/V+2Zut6ceYZrZFfXoFAmM/BGkACgkQ6ceYZrZF
fXoU/BAAkU5IPMli6N6JIUwQgvC3ExJmtftC7hUUIce8c5zacUNXUoupXpvQRlYp
k8Gw2kTeeBXDo9+W18Yo2atdMCAxvglGMMQB4d7a9usM25CQLhVDUBBW9JtgjyB+
Q26O3kNP04Q3gq0NzOPoUrTk00f757OOwwuFcVkWQOKqOvZtob/+KfTSLYwbzcu3
n96L4PTdoc5z/oK4qnQ9CZm0Jr2k+Ds47blTCjE9+KZ7aNK4r3DRhBYZpqkRzj2H
SpALcWdGvSUdFvpw++KDXkv7p97Fz67FwMKDW3aWruCRxQQj+pgO4nBvsc3FXHoR
juRgXPjOGe2/HsQPipV+MTX/l6ZKPT6fvq/jrEwH+SapMxZrkSyadcVVdzY6oN7J
F2JokHXF487ogrShOtso2/hzLJwmehQ4OZ/83Y7P3BIRLaFbpfxA9rNkUAcrPtC6
LNGd2Ivykl6zoHNJvwT76O9wjXEalFIWihviON6NB0bsZD8n1+DByWM8vY51AgfG
kaxjYob7O77TF/ieNqNyNYMp3EQF++h9nRDO41z3Sx768ESgR92xIWB7oWf0vTNt
TnwH7s3ybHkxlqAxnslw/VIbQTtB9oarh9EpI5DPTx5rIkPbf7Ss6t4EWaaXqrsL
mn02C0Kz9kxFRuFlUGmDlHSkrZgZWbafrFZ5qyMUojoA0V6jHCY=
=arwx
-----END PGP SIGNATURE-----
