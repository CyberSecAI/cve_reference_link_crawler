```
{
  "vulnerability": {
    "root_cause": "The vulnerability occurs when a malicious actor registers an account using a target user's email address (which is unverified). If the target user later signs up with OAuth2, the system will incorrectly link the OAuth2 account with the existing unverified account without changing the password, granting the malicious actor access to the target user's account.",
    "weaknesses": [
      "Improper linking of OAuth2 accounts with unverified password-based accounts",
      "Lack of password reset during account linking when the original account was unverified"
    ],
    "impact": "A malicious actor can gain unauthorized access to a user's account by taking advantage of the vulnerability, potentially leading to data breaches or other malicious activities.",
    "attack_vectors": "The attack can be initiated by a malicious actor who registers an account with the target user's email. This is followed by the target user signing up via OAuth2, either naturally or due to an invite from the attacker. When the system attempts to link these two accounts, the vulnerability is triggered.",
    "required_capabilities": "The attacker needs to know the email address of the intended victim and the targeted application must have both password-based and OAuth2 authentication enabled. No special privileges are required. The attacker needs to create an account with the victim's email address before the victim does and must have the ability to initiate an account link, either by natural actions of the victim or by invitation."
  },
  "additional_details": "The vulnerability is addressed by resetting the password when linking an OAuth2 account to an existing unverified account. Additionally, an email alert is sent to users who log in with a password after linking an OAuth2 account to notify them of potential unauthorized access, prompting them to change their password. The vulnerability is present in PocketBase versions before v0.22.14. The fix is present in version v0.22.14 and later. The provided text contains some discussion about planned future refactoring of the project, but those are not directly related to the CVE."
}
```