

[Skip to content](#content)
[![Fortra](https://static.fortra.com/fortra-global-assets/fortra-logo-full.svg)
![fortra mobile logo](https://www.cobaltstrike.com/app/themes/helpsystems/img/fortra-delta-white.svg)

![Cobalt Strike](https://www.cobaltstrike.com/app/uploads/2023/06/fta-cobalt-strike-light-1.svg)](https://www.cobaltstrike.com/)

* [Fortra.com](https://www.fortra.com/?utm_source=coresecurity.com&utm_medium=referral&utm_campaign=fortra_secondarynav_link "Fortra.com")
* [Blog](/blog "Blog")
* [Download](https://download.cobaltstrike.com/download "Download")
* [Contact Us](/contact-us "Contact Us")

## Main Navigation

* [REQUEST PRICING](/product/quote-request "REQUEST PRICING")
* [Product](/product "Product")
  + Features
    - [Beacon](https://www.cobaltstrike.com/product/features/beacon "Beacon")
    - [Malleable C2](https://www.cobaltstrike.com/product/features/malleable-c2 "Malleable C2")
    - [Interoperability](https://www.cobaltstrike.com/product/features/interoperability "Interoperability")
    - [Community](https://www.cobaltstrike.com/product/features/community "Community")
    - [Flexibility](https://www.cobaltstrike.com/product/features/flexibility "Flexibility")
    - [UDRL](https://www.cobaltstrike.com/product/features/user-defined-reflective-loader "UDRL")
    - [View More Features >](/product/features/ "View More Features >")
  + Interoperability
    - [Core Impact](https://www.cobaltstrike.com/product/core-impact "Core Impact")
    - [Outflank Security Tooling](https://www.cobaltstrike.com/product/outflank-security-tooling "Outflank Security Tooling")
  + Bundles
    - [Cobalt Strike + Core Impact](/resources/datasheets/advanced-bundle/ "Cobalt Strike + Core Impact")
    - [Cobalt Strike + Outflank Security Tooling](/resources/datasheets/red-team-bundle/ "Cobalt Strike + Outflank Security Tooling")
    - [Cobalt Strike, Core Impact, Outflank Security Tooling](/resources/datasheets/advanced-red-team-bundle/ "Cobalt Strike, Core Impact, Outflank Security Tooling")
    - [View All Product Bundles >](/product/bundles/ "View All Product Bundles >")
* [Support](/support "Support")
  + [Training](https://www.cobaltstrike.com/support/training "Training")
  + [User Manuals](https://www.cobaltstrike.com/support/user-manuals "User Manuals")
  + [Community Kit](https://cobalt-strike.github.io/community_kit/ "Community Kit")
* [Resources](/resources "Resources")
  + [Blog](/blog "Blog")
  + [Screenshots](https://www.cobaltstrike.com/resources/screenshots "Screenshots")
  + [Datasheets](/resources/type-datasheet "Datasheets")
  + [Videos](/resources/type-video "Videos")
* [Search](#collapseSearch)

Search for:

[Home](https://www.cobaltstrike.com/) » [Blog](/blog/) » Out Of Band Update: Cobalt Strike 4.7.1

# Out Of Band Update: Cobalt Strike 4.7.1

Tuesday 20 September, 2022

Cobalt Strike 4.7.1 is now available. This is an out of band update to fix an issue discovered in the 4.7 release that was reported to be impacting users, and for which there was no workaround. We also took the opportunity to address a vulnerability that was reported shortly after the 4.7 release, along with mitigations for potential denial-of-service attacks.

### Sleep Mask Issue

An issue was reported whereby when `stage.sleep_mask` is not set (i.e. set to *false*), Beacon will still allocate space for the sleep mask BOF in memory. This issue has now been fixed.

### CVE-2022-39197

An independent researcher identified as “Beichendream” reached out to inform us about an XSS vulnerability that they discovered in the teamserver. This would allow an attacker to set a malformed username in the Beacon configuration, allowing them to remotely execute code. We created a CVE for this issue which has been fixed.

As part of this fix, a new property has been added to the TeamServer.prop file (located in the home folder of the teamserver):

`limits.beacons_xssvalidated` specifies whether XSS validation is performed on selected Beacon metadata. By default, this is set to *true*.

### Denial-of-Service Mitigations

We were also made aware of the potential to conduct a denial-of-service attack against the teamserver itself. While this can be mitigated by good OPSEC (using a redirector, turning staging off and so on), we have made updates to mitigate this type of attack.

A number of new properties have been added to the TeamServer.prop file as part of the mitigations:

`limits.beacons_max` sets a limit on the total number of Beacons that the teamserver will support. The default is *500*. To turn this off (support an unlimited number of Beacons), use *0*.

Three additional settings allow you to set a threshold rate for adding new Beacons (how many new Beacons can be added in a specific time period):

`limits.beacon_rate_period` specifies the time period (in milliseconds) during which the number of Beacons added is monitored and limited.

`limits.beacon_rate_maxperperiod` specifies how many new Beacons can be added in the specified time period.

`limits.beacon_rate_disableduration` specifies how long the teamserver will ignore additional new Beacons for if the number of new Beacons exceeds the limit in the given time period.

**Example**

`limits.beacon_rate_period` is set to 3000, `limits.beacon_rate_maxperperiod` is set to 50 and `limits.beacon_rate_disableduration` is set to 600000. If more than 50 new Beacons are added in a 3 second (3000ms) time period, any additional new Beacons added in the next 10 minutes (600000ms) will be ignored.

We apologise for any problems that these issues may have caused. If you notice any other issues with Cobalt Strike, please refer to the [online support page](https://www.cobaltstrike.com/support/?__hstc=51647990.dfa3e15903eada2a67bc549792e40605.1691086238250.1691086238250.1691096057689.2&__hssc=51647990.5.1691096057689&__hsfp=2968214243), or report them to our [support email address](/cdn-cgi/l/email-protection#12717d70737e663c716761667d6261527a777e62616b6166777f613c717d7f). Licensed users can [run the update program](https://www.cobaltstrike.com/help-update-cobalt-strike?__hstc=51647990.dfa3e15903eada2a67bc549792e40605.1691086238250.1691086238250.1691096057689.2&__hssc=51647990.5.1691096057689&__hsfp=2968214243) to get this version, or download version 4.7.1 from scratch from [the website](https://download.cobaltstrike.com/download?__hstc=51647990.dfa3e15903eada2a67bc549792e40605.1691086238250.1691086238250.1691096057689.2&__hssc=51647990.5.1691096057689&__hsfp=2968214243). We recommend taking a copy of your existing Cobalt Strike folder before upgrading in case you need to revert to the previous version. To purchase Cobalt Strike or learn more, please [contact us](https://www.cobaltstrike.com/quote-request/?__hstc=51647990.dfa3e15903eada2a67bc549792e40605.1691086238250.1691086238250.1691096057689.2&__hssc=51647990.5.1691096057689&__hsfp=2968214243).

![Greg Darwin bio picture](https://www.cobaltstrike.com/app/uploads/2023/07/Greg-profile.jpg)
#### [Greg Darwin](https://www.cobaltstrike.com/profile/greg-darwin)

Software Development Manager

[View Profile](https://www.cobaltstrike.com/profile/greg-darwin)

TOPICS

* [Development](https://www.cobaltstrike.com/blog?_sft_cornerstone=development "Development")
* [Releases](https://www.cobaltstrike.com/blog?_sft_cornerstone=releases "Releases")

[![Fortra](https://static.fortra.com/fortra-global-assets/fortra-logo-full.svg)](https://www.fortra.com "Home")

* tel:+1-800-328-1000
* [Email Us](/cdn-cgi/l/email-protection#3950575f56795f564b4d4b58175a5654)
* [Request Support](https://community.fortra.com/support)
* [Subscribe](https://www.fortra.com/resources/fortra-subscription-center)

* [X](https://twitter.com/_CobaltStrike?s=20)
* [Youtube](https://www.youtube.com/channel/UCXr2bT_K0WpaBrhRlhpFwdw)
* [Reddit](https://www.reddit.com/r/Fortra/)

### Footer Menu 1

* [Features](/product/features/)
  + [Beacon](/product/features/beacon)
  + [Interoperablity](/product/features/interoperability)
  + [Community](/product/features/community)
    - [All Features >](/product/features/)
### Footer Menu 2

* [Interoperability](/product/features/interoperability)
  + [Core Impact](/product/core-impact)
  + [Outflank Security Tooling](/product/outflank-security-tooling)
### Footer Menu 3

* [Support](/support)
  + [Training](/support/training)
  + [Community Kit](https://cobalt-strike.github.io/community_kit)
### Footer Menu 4

* [Resources](/resources)
  + [Blog](/blog)
  + [Screenshots](/screenshots)
  + [Datasheets](/resources/type-datasheet)
    - [All Resources >](/resources)
### Footer Menu 5

* [About](/about)
  + [Corporate Compliance & Ethics](https://www.cobaltstrike.com/about/corporate-compliance-ethics)
  + [Newsroom](https://www.fortra.com/about/newsroom)

### [Contact Information](https://www.fortra.com/contact-us)

### [Privacy Policy](https://www.fortra.com/privacy-policy)

### [Cookie Policy](https://www.fortra.com/cookie-policy)

### [Impressum](https://www.fortra.com/impressum)

Copyright © Fortra, LLC and its group of companies. Fortra®, the Fortra® logos, and other identified marks are proprietary trademarks of Fortra, LLC.

