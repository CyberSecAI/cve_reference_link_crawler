=== Content from www.wordfence.com_67d39162_20250111_151025.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# WP GPX Maps <= 1.7.08 - Authenticated (Contributor+) Stored Cross-Site Scripting via sgpx Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   WP GPX Maps <= 1.7.08 - Authenticated (Contributor+) Stored Cross-Site Scripting via sgpx Shortcode

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-9028](https://www.cve.org/CVERecord?id=CVE-2024-9028) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | September 24, 2024 |
| Last Updated | September 25, 2024 |
| Researcher | [Peter Thaleikis](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/spek) |

### Description

The WP GPX Maps plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's 'sgpx' shortcode in all versions up to, and including, 1.7.08 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wp-gpx-maps/trunk/wp-gpx-maps.php#L238)
* [wordpress.org](https://wordpress.org/plugins/wp-gpx-maps/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wp-gpx-maps/trunk/wp-gpx-maps-admin-tracks.php#L249)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-gpx-maps%2Fwp-gpx-maps-1708-authenticated-contributor-stored-cross-site-scripting-via-sgpx-shortcode&t=WP%20GPX%20Maps%20%3C%3D%201.7.08%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20sgpx%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-gpx-maps%2Fwp-gpx-maps-1708-authenticated-contributor-stored-cross-site-scripting-via-sgpx-shortcode&text=WP%20GPX%20Maps%20%3C%3D%201.7.08%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20sgpx%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-gpx-maps%2Fwp-gpx-maps-1708-authenticated-contributor-stored-cross-site-scripting-via-sgpx-shortcode "LinkedIn")
Email

## Vulnerability Details for WP GPX Maps

#### [WP GPX Maps](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-gpx-maps)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wp-gpx-maps [(view on wordpress.org)](https://wordpress.org/plugins/wp-gpx-maps) |
| Patched? | No |
| Remediation | No known patch available. Please review the vulnerability's details in depth and employ mitigations based on your organization's risk tolerance. It may be best to uninstall the affected software and find a replacement. |
| Affected Version | * <= 1.7.08 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_54e29862_20250111_151023.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwp-gpx-maps%2Ftrunk%2Fwp-gpx-maps.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wp-gpx-maps/trunk/wp-gpx-maps.php?rev=3057212 "Revision 3057212")
* Next Revision →
* [Blame](/browser/wp-gpx-maps/trunk/wp-gpx-maps.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wp-gpx-maps/trunk/wp-gpx-maps.php)

---

# [source:](/browser?order=name "Go to repository root") [wp-gpx-maps](/browser/wp-gpx-maps?order=name "View wp-gpx-maps")/[trunk](/browser/wp-gpx-maps/trunk?order=name "View trunk")/[wp-gpx-maps.php](/browser/wp-gpx-maps/trunk/wp-gpx-maps.php?order=name "View wp-gpx-maps.php")

View diff against:

View revision:

| [Last change](/changeset/3217023/wp-gpx-maps/trunk/wp-gpx-maps.php "View differences") on this file was [3217023](/changeset/3217023/ "View changeset 3217023"), checked in by bastianonm, [7 days ago](/timeline?from=2025-01-04T22%3A16%3A05Z&precision=second "See timeline at 01/04/2025 10:16:05 PM") |
| --- |
| Fix security issues |
| **File size:** 40.7 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Plugin Name: WP-GPX-Maps |
| [4](#L4) | \* Plugin URI: http://www.devfarm.it/ |
| [5](#L5) | \* Description: Draws a GPX track with altitude chart |
| [6](#L6) | \* Version: 1.7.10 |
| [7](#L7) | \* Author: Bastianon Massimo |
| [8](#L8) | \* Author URI: http://www.devfarm.it/ |
| [9](#L9) | \* Text Domain: wp-gpx-maps |
| [10](#L10) | \* Domain Path: /languages |
| [11](#L11) | \* License: GPL2 |
| [12](#L12) | \* |
| [13](#L13) | \* @package WP-GPX-Maps |
| [14](#L14) | \*/ |
| [15](#L15) |  |
| [16](#L16) | // error\_reporting (E\_ALL); |
| [17](#L17) |  |
| [18](#L18) | /\*\* |
| [19](#L19) | \* Version of the plugin |
| [20](#L20) | \*/ |
| [21](#L21) | define( 'WPGPXMAPS\_CURRENT\_VERSION', '1.7.06' ); |
| [22](#L22) |  |
| [23](#L23) | require 'wp-gpx-maps-utils.php'; |
| [24](#L24) | require 'wp-gpx-maps-admin.php'; |
| [25](#L25) |  |
| [26](#L26) | define("wpgpxmaps\_FEET\_MILES", "1"); |
| [27](#L27) | define("wpgpxmaps\_METERS\_KILOMETERS", "2"); |
| [28](#L28) | define("wpgpxmaps\_METERS\_NAUTICALMILES", "3"); |
| [29](#L29) | define("wpgpxmaps\_METER\_MILES", "4"); |
| [30](#L30) | define("wpgpxmaps\_FEET\_NAUTICALMILES", "5"); |
| [31](#L31) |  |
| [32](#L32) | define("wpgpxmaps\_KM\_PER\_HOURS", "1"); |
| [33](#L33) | define("wpgpxmaps\_MILES\_PER\_HOURS", "2"); |
| [34](#L34) | define("wpgpxmaps\_MINUTES\_PER\_KM", "3"); |
| [35](#L35) | define("wpgpxmaps\_MINUTES\_PER\_MILES", "4"); |
| [36](#L36) | define("wpgpxmaps\_KNOTS", "5"); |
| [37](#L37) | define("wpgpxmaps\_MINUTES\_PER\_100METERS", "6"); |
| [38](#L38) |  |
| [39](#L39) | add\_shortcode( 'sgpx', 'wpgpxmaps\_handle\_shortcodes' ); |
| [40](#L40) | add\_shortcode( 'sgpxf', 'wpgpxmaps\_handle\_folder\_shortcodes' ); |
| [41](#L41) | register\_activation\_hook( \_\_FILE\_\_, 'wpgpxmaps\_install\_option' ); |
| [42](#L42) | register\_deactivation\_hook( \_\_FILE\_\_, 'wpgpxmaps\_remove\_option' ); |
| [43](#L43) | add\_filter( 'plugin\_action\_links', 'wpgpxmaps\_action\_links', 10, 2 ); |
| [44](#L44) | add\_action( 'wp\_enqueue\_scripts', 'wpgpxmaps\_enqueue\_scripts' ); |
| [45](#L45) | add\_action( 'admin\_enqueue\_scripts', 'wpgpxmaps\_enqueue\_scripts\_admin' ); |
| [46](#L46) | add\_action( 'plugins\_loaded', 'wpgpxmaps\_lang\_init' ); |
| [47](#L47) |  |
| [48](#L48) |  |
| [49](#L49) | function wpgpxmaps\_lang\_init() { |
| [50](#L50) |  |
| [51](#L51) | if ( function\_exists( 'load\_plugin\_textdomain' ) ) { |
| [52](#L52) | load\_plugin\_textdomain( 'wp-gpx-maps', false, dirname( plugin\_basename( \_\_FILE\_\_ ) ) . '/languages/' ); |
| [53](#L53) | } |
| [54](#L54) |  |
| [55](#L55) | } |
| [56](#L56) |  |
| [57](#L57) | function wpgpxmaps\_action\_links( $links, $file ) { |
| [58](#L58) |  |
| [59](#L59) | static $this\_plugin; |
| [60](#L60) |  |
| [61](#L61) | if ( ! $this\_plugin ) { |
| [62](#L62) | $this\_plugin = plugin\_basename( \_\_FILE\_\_ ); |
| [63](#L63) | } |
| [64](#L64) |  |
| [65](#L65) | // Check to make sure we are on the correct plugin. |
| [66](#L66) | if ( $file == $this\_plugin ) { |
| [67](#L67) | // the anchor tag and href to the URL we want. For a "Settings" |
| [68](#L68) | // link, this needs to be the url of your settings page. Authors |
| [69](#L69) | // access tracks via the admin page. |
| [70](#L70) | if ( current\_user\_can( 'manage\_options' ) ) { |
| [71](#L71) | $menu\_root = 'options-general.php'; |
| [72](#L72) | } elseif ( current\_user\_can( 'publish\_posts' ) ) { |
| [73](#L73) | $menu\_root = 'admin.php'; |
| [74](#L74) | } |
| [75](#L75) | $settings\_link = '<a href="' . esc\_url( get\_bloginfo( 'wpurl' ) . '/wp-admin/' . $menu\_root . '?page=WP-GPX-Maps' ) . '">' . esc\_html\_\_( 'Settings', 'wp-gpx-maps' ) . '</a>'; |
| [76](#L76) | // Add the link to the list. |
| [77](#L77) | array\_unshift( $links, $settings\_link ); |
| [78](#L78) | } |
| [79](#L79) | return $links; |
| [80](#L80) |  |
| [81](#L81) | } |
| [82](#L82) |  |
| [83](#L83) | function wpgpxmaps\_enqueue\_scripts\_admin( $hook ) { |
| [84](#L84) |  |
| [85](#L85) | if ( strpos( $hook, 'WP-GPX-Maps' ) !== false ) { |
| [86](#L86) |  |
| [87](#L87) | /\* Admin Style CSS \*/ |
| [88](#L88) | wp\_register\_style( 'admin-style', plugins\_url( 'css/admin-style.css', \_\_FILE\_\_ ), array(), '1.0.0' ); |
| [89](#L89) | wp\_enqueue\_style( 'admin-style' ); |
| [90](#L90) | /\* mColorPicker \*/ |
| [91](#L91) | wp\_register\_script( 'mColorPicker', plugins\_url( '/js/mColorPicker\_min.js', \_\_FILE\_\_ ), array(), '1.0 r39' ); |
| [92](#L92) | wp\_enqueue\_script( 'mColorPicker' ); |
| [93](#L93) | /\* bootstrap-table \*/ |
| [94](#L94) | wp\_register\_script( 'bootstrap-table', plugins\_url( '/js/bootstrap-table.js', \_\_FILE\_\_ ), array(), '1.13.2' ); |
| [95](#L95) | wp\_enqueue\_script( 'bootstrap-table' ); |
| [96](#L96) | wp\_register\_style( 'bootstrap-table', plugins\_url( '/css/bootstrap-table.css', \_\_FILE\_\_ ), array(), '1.13.2' ); |
| [97](#L97) | wp\_enqueue\_style( 'bootstrap-table' ); |
| [98](#L98) | } |
| [99](#L99) |  |
| [100](#L100) | } |
| [101](#L101) |  |
| [102](#L102) |  |
| [103](#L103) | function downloadRemoteFile( $file\_url ) { |
| [104](#L104) |  |
| [105](#L105) | try { |
| [106](#L106) |  |
| [107](#L107) | // If the function it's not available, require it. |
| [108](#L108) | if ( ! function\_exists( 'download\_url' ) ) { |
| [109](#L109) | require\_once ABSPATH . 'wp-admin/includes/file.php'; |
| [110](#L110) | } |
| [111](#L111) |  |
| [112](#L112) | return download\_url( $file\_url ); |
| [113](#L113) |  |
| [114](#L114) | } catch ( Exception $e ) { |
| [115](#L115) | print\_r( $e ); |
| [116](#L116) | return ''; |
| [117](#L117) | } |
| [118](#L118) |  |
| [119](#L119) | } |
| [120](#L120) |  |
| [121](#L121) |  |
| [122](#L122) | function wpgpxmaps\_enqueue\_scripts() { |
| [123](#L123) |  |
| [124](#L124) | /\* Output Style CSS \*/ |
| [125](#L125) | wp\_register\_style( 'output-style', plugins\_url( 'css/wp-gpx-maps-output.css', \_\_FILE\_\_ ), array(), '1.0.0' ); |
| [126](#L126) | wp\_enqueue\_style( 'output-style' ); |
| [127](#L127) |  |
| [128](#L128) | /\* Leaflet \*/ |
| [129](#L129) | wp\_register\_style( 'leaflet', plugins\_url( '/ThirdParties/Leaflet\_1.5.1/leaflet.css', \_\_FILE\_\_ ), array(), '1.5.1' ); |
| [130](#L130) | wp\_enqueue\_style( 'leaflet' ); |
| [131](#L131) |  |
| [132](#L132) | /\* Leaflet.markercluster \*/ |
| [133](#L133) | wp\_register\_style( 'leaflet.markercluster', plugins\_url( '/ThirdParties/Leaflet.markercluster-1.4.1/MarkerCluster.css', \_\_FILE\_\_ ), array(), '1.4.1,' ); |
| [134](#L134) | wp\_enqueue\_style( 'leaflet.markercluster' ); |
| [135](#L135) |  |
| [136](#L136) | /\* Leaflet.Photo \*/ |
| [137](#L137) | wp\_register\_style( 'leaflet.Photo', plugins\_url( '/ThirdParties/Leaflet.Photo/Leaflet.Photo.css', \_\_FILE\_\_ ), array(), '0' ); |
| [138](#L138) | wp\_enqueue\_style( 'leaflet.Photo' ); |
| [139](#L139) |  |
| [140](#L140) | /\* Leaflet.fullscreen \*/ |
| [141](#L141) | wp\_register\_style( 'leaflet.fullscreen', plugins\_url( '/ThirdParties/leaflet.fullscreen-1.4.5/Control.FullScreen.css', \_\_FILE\_\_ ), array(), '1.5.1' ); |
| [142](#L142) | wp\_enqueue\_style( 'leaflet.fullscreen' ); |
| [143](#L143) |  |
| [144](#L144) | wp\_register\_script( 'leaflet', plugins\_url( '/ThirdParties/Leaflet\_1.5.1/leaflet.js', \_\_FILE\_\_ ), array(), '1.5.1' ); |
| [145](#L145) | wp\_register\_script( 'leaflet.markercluster', plugins\_url( '/ThirdParties/Leaflet.markercluster-1.4.1/leaflet.markercluster.js', \_\_FILE\_\_ ), array( 'leaflet' ), '1.4.1' ); |
| [146](#L146) | wp\_register\_script( 'leaflet.Photo', plugins\_url( '/ThirdParties/Leaflet.Photo/Leaflet.Photo.js', \_\_FILE\_\_ ), array( 'leaflet', 'leaflet.markercluster' ), '0' ); |
| [147](#L147) | wp\_register\_script( 'leaflet.fullscreen', plugins\_url( '/ThirdParties/leaflet.fullscreen-1.4.5/Control.FullScreen.js', \_\_FILE\_\_ ), array( 'leaflet' ), '1.4.5' ); |
| [148](#L148) |  |
| [149](#L149) | /\* Chartjs \*/ |
| [150](#L150) | wp\_register\_script( 'chartjs', plugins\_url( '/js/Chart.min.js', \_\_FILE\_\_ ), array(), '2.8.0' ); |
| [151](#L151) |  |
| [152](#L152) | wp\_register\_script( 'wp-gpx-maps', plugins\_url( 'js/WP-GPX-Maps.js', \_\_FILE\_\_ ), array( 'jquery', 'leaflet', 'chartjs' ), '1.6.02' ); |
| [153](#L153) |  |
| [154](#L154) | wp\_enqueue\_script( 'output-style' ); |
| [155](#L155) | wp\_enqueue\_script( 'leaflet' ); |
| [156](#L156) | wp\_enqueue\_script( 'leaflet.markercluster' ); |
| [157](#L157) | wp\_enqueue\_script( 'leaflet.Photo' ); |
| [158](#L158) | wp\_enqueue\_script( 'leaflet.fullscreen' ); |
| [159](#L159) | wp\_enqueue\_script( 'jquery' ); |
| [160](#L160) | wp\_enqueue\_script( 'chartjs' ); |
| [161](#L161) | wp\_enqueue\_script( 'wp-gpx-maps' ); |
| [162](#L162) |  |
| [163](#L163) | } |
| [164](#L164) |  |
| [165](#L165) | function wpgpxmaps\_findValue( $attr, $attributeName, $optionName, $defaultValue ) { |
| [166](#L166) |  |
| [167](#L167) | $val = ''; |
| [168](#L168) | if ( isset( $attr[$attributeName] ) ) { |
| [169](#L169) | $val = sanitize\_text\_field( $attr[$attributeName] ); |
| [170](#L170) | } |
| [171](#L171) | if ( $val == '' ) { |
| [172](#L172) | $val = sanitize\_text\_field( get\_option( $optionName ) ); |
| [173](#L173) | } |
| [174](#L174) | if ( $val == '' && isset( $\_GET[$attributeName] ) && $attributeName != 'download' ) { |
| [175](#L175) | $val = sanitize\_text\_field( $\_GET[$attributeName] ); |
| [176](#L176) | } |
| [177](#L177) | if ( $val == '' ) { |
| [178](#L178) | $val = sanitize\_text\_field( $defaultValue ); |
| [179](#L179) | } |
| [180](#L180) | return $val; |
| [181](#L181) |  |
| [182](#L182) | } |
| [183](#L183) |  |
| [184](#L184) | function wpgpxmaps\_handle\_folder\_shortcodes( $attr, $content = '' ) { |
| [185](#L185) |  |
| [186](#L186) | $folder                 = wpgpxmaps\_findValue( $attr, 'folder', '', '' ); |
| [187](#L187) | $pointsoffset           = wpgpxmaps\_findValue( $attr, 'pointsoffset', 'wpgpxmaps\_pointsoffset', 10 ); |
| [188](#L188) | $distanceType           = wpgpxmaps\_findValue( $attr, 'distanceType', 'wpgpxmaps\_distance\_type', 0 ); |
| [189](#L189) | $donotreducegpx         = wpgpxmaps\_findValue( $attr, 'donotreducegpx', 'wpgpxmaps\_donotreducegpx', false ); |
| [190](#L190) | $unit\_of\_measure    = wpgpxmaps\_findValue( $attr, 'uom', 'wpgpxmaps\_unit\_of\_measure', '0' ); |
| [191](#L191) |  |
| [192](#L192) | /\* Fix folder path \*/ |
| [193](#L193) | $sitePath = wp\_gpx\_maps\_sitePath(); |
| [194](#L194) | $folder   = trim( $folder ); |
| [195](#L195) | $folder   = str\_replace( array( '/', '\\' ), DIRECTORY\_SEPARATOR, $folder ); |
| [196](#L196) | $folder   = $sitePath . sanitize\_text\_field( $folder ); |
| [197](#L197) |  |
| [198](#L198) | $files = scandir( $folder ); |
| [199](#L199) |  |
| [200](#L200) | foreach ( $files as $file ) { |
| [201](#L201) |  |
| [202](#L202) | if ( strtolower( substr( $file, - 4 ) ) == '.gpx' ) { |
| [203](#L203) |  |
| [204](#L204) | $gpx    = $folder . DIRECTORY\_SEPARATOR . $file; |
| [205](#L205) | $points = wpgpxmaps\_getPoints( $gpx, $pointsoffset, $donotreducegpx, $distanceType ); |
| [206](#L206) |  |
| [207](#L207) | $points\_maps       = ''; |
| [208](#L208) | $points\_graph\_dist = ''; |
| [209](#L209) | $points\_graph\_ele  = ''; |
| [210](#L210) |  |
| [211](#L211) | if ( is\_array( $points\_x\_lat ) ) |
| [212](#L212) | foreach ( array\_keys( $points\_x\_lat ) as $i ) { |
| [213](#L213) | $\_lat = (float) $points\_x\_lat[$i]; |
| [214](#L214) | $\_lon = (float) $points\_x\_lon[$i]; |
| [215](#L215) |  |
| [216](#L216) | if ( 0 == $\_lat && 0 == $\_lon ) { |
| [217](#L217) | $points\_maps       .= 'null,'; |
| [218](#L218) | $points\_graph\_dist .= 'null,'; |
| [219](#L219) | $points\_graph\_ele  .= 'null,'; |
| [220](#L220) |  |
| [221](#L221) | } else { |
| [222](#L222) | $points\_maps .= '[' . number\_format( (float) $points\_x\_lat[$i], 7, '.', '' ) . ',' . number\_format( (float) $points\_x\_lon[$i], 7, '.', '' ) . '],'; |
| [223](#L223) |  |
| [224](#L224) | $\_ele  = (float) $points->ele[$i]; |
| [225](#L225) | $\_dist = (float) $points->dist[$i]; |
| [226](#L226) |  |
| [227](#L227) | if ( wpgpxmaps\_FEET\_MILES == $unit\_of\_measure ) { |
| [228](#L228) | /\* feet / miles \*/ |
| [229](#L229) | $\_dist \*= 0.000621371192; |
| [230](#L230) | $\_ele  \*= 3.2808399; |
| [231](#L231) |  |
| [232](#L232) | } elseif ( wpgpxmaps\_METERS\_KILOMETERS == $unit\_of\_measure ) { |
| [233](#L233) | /\* meters / kilometers \*/ |
| [234](#L234) | $\_dist = (float) ( $\_dist / 1000 ); |
| [235](#L235) |  |
| [236](#L236) | } elseif ( wpgpxmaps\_METERS\_NAUTICALMILES == $unit\_of\_measure ) { |
| [237](#L237) | /\* meters / nautical miles \*/ |
| [238](#L238) | $\_dist = (float) ( $\_dist / 1000 / 1.852 ); |
| [239](#L239) |  |
| [240](#L240) | } elseif ( wpgpxmaps\_METER\_MILES == $unit\_of\_measure ) { |
| [241](#L241) | /\* meters / miles \*/ |
| [242](#L242) | $\_dist \*= 0.000621371192; |
| [243](#L243) |  |
| [244](#L244) | } elseif ( wpgpxmaps\_FEET\_NAUTICALMILES == $unit\_of\_measure ) { |
| [245](#L245) | /\* feet / nautical miles \*/ |
| [246](#L246) | $\_dist = (float) ( $\_dist / 1000 / 1.852 ); |
| [247](#L247) | $\_ele \*= 3.2808399; |
| [248](#L248) | } |
| [249](#L249) |  |
| [250](#L250) | $points\_graph\_dist .= number\_format( $\_dist, 2, '.', '' ) . ','; |
| [251](#L251) | $points\_graph\_ele  .= number\_format( $\_ele, 2, '.', '' ) . ','; |
| [252](#L252) |  |
| [253](#L253) | } |
| [254](#L254) | } |
| [255](#L255) | print\_r( $points ); |
| [256](#L256) | } |
| [257](#L257) | } |
| [258](#L258) |  |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | function wpgpxmaps\_handle\_shortcodes( $attr, $content = '' ) { |
| [262](#L262) |  |
| [263](#L263) | $error = ''; |
| [264](#L264) | /\* General \*/ |
| [265](#L265) | $gpx            = wpgpxmaps\_findValue( $attr, 'gpx', '', '' ); |
| [266](#L266) | $w              = wpgpxmaps\_findValue( $attr, 'width', 'wpgpxmaps\_width', '100%' ); |
| [267](#L267) | $mh             = wpgpxmaps\_findValue( $attr, 'mheight', 'wpgpxmaps\_height', '450px' ); |
| [268](#L268) | $gh             = wpgpxmaps\_findValue( $attr, 'gheight', 'wpgpxmaps\_graph\_height', '200px' ); |
| [269](#L269) | $distanceType   = wpgpxmaps\_findValue( $attr, 'distanceType', 'wpgpxmaps\_distance\_type', 0 ); |
| [270](#L270) | $skipcache      = wpgpxmaps\_findValue( $attr, 'skipcache', 'wpgpxmaps\_skipcache', '' ); |
| [271](#L271) | $download       = wpgpxmaps\_findValue( $attr, 'download', 'wpgpxmaps\_download', '' ); |
| [272](#L272) | $usegpsposition = wpgpxmaps\_findValue( $attr, 'usegpsposition', 'wpgpxmaps\_usegpsposition', false ); |
| [273](#L273) | /\* Print Summary Table \*/ |
| [274](#L274) | $summary          = wpgpxmaps\_findValue( $attr, 'summary', 'wpgpxmaps\_summary', false ); |
| [275](#L275) | $p\_tot\_len        = wpgpxmaps\_findValue( $attr, 'summarytotlen', 'wpgpxmaps\_summary\_tot\_len', false ); |
| [276](#L276) | $p\_max\_ele        = wpgpxmaps\_findValue( $attr, 'summarymaxele', 'wpgpxmaps\_summary\_max\_ele', false ); |
| [277](#L277) | $p\_min\_ele        = wpgpxmaps\_findValue( $attr, 'summaryminele', 'wpgpxmaps\_summary\_min\_ele', false ); |
| [278](#L278) | $p\_total\_ele\_up   = wpgpxmaps\_findValue( $attr, 'summaryeleup', 'wpgpxmaps\_summary\_total\_ele\_up', false ); |
| [279](#L279) | $p\_total\_ele\_down = wpgpxmaps\_findValue( $attr, 'summaryeledown', 'wpgpxmaps\_summary\_total\_ele\_down', false ); |
| [280](#L280) | $p\_avg\_speed      = wpgpxmaps\_findValue( $attr, 'summaryavgspeed', 'wpgpxmaps\_summary\_avg\_speed', false ); |
| [281](#L281) | $p\_avg\_cad        = wpgpxmaps\_findValue( $attr, 'summaryavgcad', 'wpgpxmaps\_summary\_avg\_cad', false ); |
| [282](#L282) | $p\_avg\_hr         = wpgpxmaps\_findValue( $attr, 'summaryavghr', 'wpgpxmaps\_summary\_avg\_hr', false ); |
| [283](#L283) | $p\_avg\_temp       = wpgpxmaps\_findValue( $attr, 'summaryavgtemp', 'wpgpxmaps\_summary\_avg\_temp', false ); |
| [284](#L284) | $p\_total\_time     = wpgpxmaps\_findValue( $attr, 'summarytotaltime', 'wpgpxmaps\_summary\_total\_time', false ); |
| [285](#L285) | /\* Map \*/ |
| [286](#L286) | $mt                 = wpgpxmaps\_findValue( $attr, 'mtype', 'wpgpxmaps\_map\_type', 'HYBRID' ); |
| [287](#L287) | $color\_map          = wpgpxmaps\_findValue( $attr, 'mlinecolor', 'wpgpxmaps\_map\_line\_color', '#3366cc' ); |
| [288](#L288) | $zoomOnScrollWheel  = wpgpxmaps\_findValue( $attr, 'zoomonscrollwheel', 'wpgpxmaps\_zoomonscrollwheel', false ); |
| [289](#L289) | $showW              = wpgpxmaps\_findValue( $attr, 'waypoints', 'wpgpxmaps\_show\_waypoint', false ); |
| [290](#L290) | $startIcon          = wpgpxmaps\_findValue( $attr, 'starticon', 'wpgpxmaps\_map\_start\_icon', '' ); |
| [291](#L291) | $endIcon            = wpgpxmaps\_findValue( $attr, 'endicon', 'wpgpxmaps\_map\_end\_icon', '' ); |
| [292](#L292) | $currentpositioncon = wpgpxmaps\_findValue( $attr, 'currentpositioncon', 'wpgpxmaps\_currentpositioncon', '' ); |
| [293](#L293) | $currentIcon        = wpgpxmaps\_findValue( $attr, 'currenticon', 'wpgpxmaps\_map\_current\_icon', '' ); |
| [294](#L294) | $waypointIcon       = wpgpxmaps\_findValue( $attr, 'waypointicon', 'wpgpxmaps\_map\_waypoint\_icon', '' ); |
| [295](#L295) | /\* Diagram - Elevation \*/ |
| [296](#L296) | $showEle                = wpgpxmaps\_findValue( $attr, 'showele', 'wpgpxmaps\_show\_elevation', true ); |
| [297](#L297) | $color\_graph            = wpgpxmaps\_findValue( $attr, 'glinecolor', 'wpgpxmaps\_graph\_line\_color', '#3366cc' ); |
| [298](#L298) | $unit\_of\_measure    = wpgpxmaps\_findValue( $attr, 'uom', 'wpgpxmaps\_unit\_of\_measure', '0' ); |
| [299](#L299) | $chartFrom1             = wpgpxmaps\_findValue( $attr, 'chartfrom1', 'wpgpxmaps\_graph\_offset\_from1', '' ); |
| [300](#L300) | $chartTo1               = wpgpxmaps\_findValue( $attr, 'chartto1', 'wpgpxmaps\_graph\_offset\_to1', '' ); |
| [301](#L301) | /\* Diagram - Speed \*/ |
| [302](#L302) | $showSpeed         = wpgpxmaps\_findValue( $attr, 'showspeed', 'wpgpxmaps\_show\_speed', false ); |
| [303](#L303) | $color\_graph\_speed = wpgpxmaps\_findValue( $attr, 'glinecolorspeed', 'wpgpxmaps\_graph\_line\_color\_speed', '#ff0000' ); |
| [304](#L304) | $unit\_of\_measure\_speed          = wpgpxmaps\_findValue( $attr, 'uomspeed', 'wpgpxmaps\_unit\_of\_measure\_speed', '0' ); |
| [305](#L305) | $chartFrom2        = wpgpxmaps\_findValue( $attr, 'chartfrom2', 'wpgpxmaps\_graph\_offset\_from2', '' ); |
| [306](#L306) | $chartTo2          = wpgpxmaps\_findValue( $attr, 'chartto2', 'wpgpxmaps\_graph\_offset\_to2', '' ); |
| [307](#L307) | /\* Diagram - Heart rate \*/ |
| [308](#L308) | $showHr                         = wpgpxmaps\_findValue( $attr, 'showhr', 'wpgpxmaps\_show\_hr', false ); |
| [309](#L309) | $color\_graph\_hr         = wpgpxmaps\_findValue( $attr, 'glinecolorhr', 'wpgpxmaps\_graph\_line\_color\_hr', '#ff77bd' ); |
| [310](#L310) | /\* Diagram - Temperature \*/ |
| [311](#L311) | $showAtemp              = wpgpxmaps\_findValue( $attr, 'showatemp', 'wpgpxmaps\_show\_atemp', false ); |
| [312](#L312) | $color\_graph\_atemp      = wpgpxmaps\_findValue( $attr, 'glinecoloratemp', 'wpgpxmaps\_graph\_line\_color\_atemp', '#ff77bd' ); |
| [313](#L313) | /\* Diagram - Cadence \*/ |
| [314](#L314) | $showCad                = wpgpxmaps\_findValue( $attr, 'showcad', 'wpgpxmaps\_show\_cadence', false ); |
| [315](#L315) | $color\_graph\_cad        = wpgpxmaps\_findValue( $attr, 'glinecolorcad', 'wpgpxmaps\_graph\_line\_color\_cad', '#beecff' ); |
| [316](#L316) | /\* Diagram - Grade \*/ |
| [317](#L317) | $showGrade              = wpgpxmaps\_findValue( $attr, 'showgrade', 'wpgpxmaps\_show\_grade', false ); |
| [318](#L318) | $color\_graph\_grade      = wpgpxmaps\_findValue( $attr, 'glinecolorgrade', 'wpgpxmaps\_graph\_line\_color\_grade', '#beecff' ); |
| [319](#L319) | /\* Pictures \*/ |
| [320](#L320) | $ngGalleries            = wpgpxmaps\_findValue( $attr, 'nggalleries', 'wpgpxmaps\_map\_ngGalleries', '' ); |
| [321](#L321) | $ngImages               = wpgpxmaps\_findValue( $attr, 'ngimages', 'wpgpxmaps\_map\_ngImages', '' ); |
| [322](#L322) | $attachments            = wpgpxmaps\_findValue( $attr, 'attachments', 'wpgpxmaps\_map\_attachments', false ); |
| [323](#L323) | $dtoffset               = wpgpxmaps\_findValue( $attr, 'dtoffset', 'wpgpxmaps\_dtoffset', 0 ); |
| [324](#L324) | /\* Advanced \*/ |
| [325](#L325) | $pointsoffset           = wpgpxmaps\_findValue( $attr, 'pointsoffset', 'wpgpxmaps\_pointsoffset', 10 ); |
| [326](#L326) | $donotreducegpx         = wpgpxmaps\_findValue( $attr, 'donotreducegpx', 'wpgpxmaps\_donotreducegpx', false ); |
| [327](#L327) |  |
| [328](#L328) | $colors\_map = explode( ' ', $color\_map ); |
| [329](#L329) |  |
| [330](#L330) | $gpxurl = esc\_url( $gpx ); |
| [331](#L331) |  |
| [332](#L332) | /\* Add file modification time to cache filename to catch new uploads with same file name \*/ |
| [333](#L333) | $mtime = wp\_gpx\_maps\_sitePath() . str\_replace( array( '/', '\\' ), DIRECTORY\_SEPARATOR, trim( $gpx ) ); |
| [334](#L334) | if ( file\_exists( $mtime ) ) { |
| [335](#L335) | $mtime = filemtime( $mtime ); |
| [336](#L336) | } else { |
| [337](#L337) | $mtime = 0; |
| [338](#L338) | } |
| [339](#L339) | $cacheFileName = "$gpx,$mtime,$w,$mh,$mt,$gh,$showEle,$showW,$showHr,$showAtemp,$showCad,$donotreducegpx,$pointsoffset,$showSpeed,$showGrade,$unit\_of\_measure\_speed,$unit\_of\_measure,$distanceType,v1.3.9"; |
| [340](#L340) |  |
| [341](#L341) | $cacheFileName = md5( $cacheFileName ); |
| [342](#L342) |  |
| [343](#L343) | global $wp\_filesystem; |
| [344](#L344) | if (empty($wp\_filesystem)) { |
| [345](#L345) | require\_once (ABSPATH . '/wp-admin/includes/file.php'); |
| [346](#L346) | WP\_Filesystem(); |
| [347](#L347) | } |
| [348](#L348) |  |
| [349](#L349) | $gpxcache = gpxCacheFolderPath(); |
| [350](#L350) |  |
| [351](#L351) | if ( ! ( file\_exists( $gpxcache ) && is\_dir( $gpxcache ) ) ) |
| [352](#L352) | { |
| [353](#L353) | $wp\_filesystem->mkdir( $gpxcache, 0755, true ); |
| [354](#L354) | //@mkdir( $gpxcache, 0755, true ); |
| [355](#L355) | } |
| [356](#L356) |  |
| [357](#L357) |  |
| [358](#L358) | $gpxcache .= DIRECTORY\_SEPARATOR . $cacheFileName . '.tmp'; |
| [359](#L359) |  |
| [360](#L360) | /\* Try to load cache \*/ |
| [361](#L361) | if ( file\_exists( $gpxcache ) && ! ( true == $skipcache ) ) { |
| [362](#L362) |  |
| [363](#L363) | try { |
| [364](#L364) | $cache\_str          = $wp\_filesystem->get\_contents( $gpxcache ); |
| [365](#L365) | $cache\_obj          = unserialize( $cache\_str ); |
| [366](#L366) | $points\_maps        = $cache\_obj['points\_maps']; |
| [367](#L367) | $points\_x\_time      = $cache\_obj['points\_x\_time']; |
| [368](#L368) | $points\_x\_lat       = $cache\_obj['points\_x\_lat']; |
| [369](#L369) | $points\_x\_lon       = $cache\_obj['points\_x\_lon']; |
| [370](#L370) | $points\_graph\_dist  = $cache\_obj['points\_graph\_dist']; |
| [371](#L371) | $points\_graph\_ele   = $cache\_obj['points\_graph\_ele']; |
| [372](#L372) | $points\_graph\_speed = $cache\_obj['points\_graph\_speed']; |
| [373](#L373) | $points\_graph\_hr    = $cache\_obj['points\_graph\_hr']; |
| [374](#L374) | $points\_graph\_atemp = $cache\_obj['points\_graph\_atemp']; |
| [375](#L375) | $points\_graph\_cad   = $cache\_obj['points\_graph\_cad']; |
| [376](#L376) | $points\_graph\_grade = $cache\_obj['points\_graph\_grade']; |
| [377](#L377) | $waypoints          = $cache\_obj['waypoints']; |
| [378](#L378) | $max\_ele            = $cache\_obj['max\_ele']; |
| [379](#L379) | $min\_ele            = $cache\_obj['min\_ele']; |
| [380](#L380) | $max\_time           = $cache\_obj['max\_time']; |
| [381](#L381) | $min\_time           = $cache\_obj['min\_time']; |
| [382](#L382) | $total\_ele\_up       = $cache\_obj['total\_ele\_up']; |
| [383](#L383) | $total\_ele\_down     = $cache\_obj['total\_ele\_down']; |
| [384](#L384) | $avg\_speed          = $cache\_obj['avg\_speed']; |
| [385](#L385) | $avg\_cad            = $cache\_obj['avg\_cad']; |
| [386](#L386) | $avg\_hr             = $cache\_obj['avg\_hr']; |
| [387](#L387) | $avg\_temp           = $cache\_obj['avg\_temp']; |
| [388](#L388) | $tot\_len            = $cache\_obj['tot\_len']; |
| [389](#L389) |  |
| [390](#L390) | } catch ( Exception $e ) { |
| [391](#L391) | $points\_maps        = ''; |
| [392](#L392) | $points\_x\_time      = ''; |
| [393](#L393) | $points\_x\_lat       = ''; |
| [394](#L394) | $points\_x\_lon       = ''; |
| [395](#L395) | $points\_graph\_dist  = ''; |
| [396](#L396) | $points\_graph\_ele   = ''; |
| [397](#L397) | $points\_graph\_speed = ''; |
| [398](#L398) | $points\_graph\_hr    = ''; |
| [399](#L399) | $points\_graph\_atemp = ''; |
| [400](#L400) | $points\_graph\_cad   = ''; |
| [401](#L401) | $points\_graph\_grade = ''; |
| [402](#L402) | $waypoints          = ''; |
| [403](#L403) | $max\_ele            = 0; |
| [404](#L404) | $min\_ele            = 0; |
| [405](#L405) | $max\_time           = 0; |
| [406](#L406) | $min\_time           = 0; |
| [407](#L407) | $total\_ele\_up       = 0; |
| [408](#L408) | $total\_ele\_down     = 0; |
| [409](#L409) | $avg\_speed          = 0; |
| [410](#L410) | $avg\_cad            = 0; |
| [411](#L411) | $avgv\_hr            = 0; |
| [412](#L412) | $avg\_temp           = 0; |
| [413](#L413) | $tot\_len            = 0; |
| [414](#L414) | } |
| [415](#L415) | } |
| [416](#L416) |  |
| [417](#L417) | $isGpxUrl = ( preg\_match( '/^(http(s)?\:\/\/)/', trim( $gpx ) ) == 1 ); |
| [418](#L418) |  |
| [419](#L419) |  |
| [420](#L420) | if ( ( ! isset( $points\_maps ) || $points\_maps == '' ) && $gpx != '' ) { |
| [421](#L421) | // if (true) { |
| [422](#L422) |  |
| [423](#L423) | $sitePath = wp\_gpx\_maps\_sitePath(); |
| [424](#L424) |  |
| [425](#L425) | $gpx = trim( $gpx ); |
| [426](#L426) |  |
| [427](#L427) | if ( true == $isGpxUrl ) { |
| [428](#L428) | $gpx = downloadRemoteFile( $gpx ); |
| [429](#L429) | } else { |
| [430](#L430) | $gpx = str\_replace( array( '/', '\\' ), DIRECTORY\_SEPARATOR, $gpx ); |
| [431](#L431) | $gpx = $sitePath . $gpx; |
| [432](#L432) | } |
| [433](#L433) | if ( $gpx == '' ) { |
| [434](#L434) | return "No gpx found"; |
| [435](#L435) | } |
| [436](#L436) |  |
| [437](#L437) | $points = wpgpxmaps\_getPoints( $gpx, $pointsoffset, $donotreducegpx, $distanceType ); |
| [438](#L438) |  |
| [439](#L439) | $points\_maps        = ''; |
| [440](#L440) | $points\_graph\_dist  = ''; |
| [441](#L441) | $points\_graph\_ele   = ''; |
| [442](#L442) | $points\_graph\_speed = ''; |
| [443](#L443) | $points\_graph\_hr    = ''; |
| [444](#L444) | $points\_graph\_atemp = ''; |
| [445](#L445) | $points\_graph\_cad   = ''; |
| [446](#L446) | $points\_graph\_grade = ''; |
| [447](#L447) | $waypoints          = ''; |
| [448](#L448) |  |
| [449](#L449) | $points\_x\_time = $points->dt; |
| [450](#L450) | $points\_x\_lat  = $points->lat; |
| [451](#L451) | $points\_x\_lon  = $points->lon; |
| [452](#L452) |  |
| [453](#L453) | $max\_ele        = $points->maxEle; |
| [454](#L454) | $min\_ele        = $points->minEle; |
| [455](#L455) | $max\_time       = $points->maxTime; |
| [456](#L456) | $min\_time       = $points->minTime; |
| [457](#L457) | $total\_ele\_up   = $points->totalEleUp; |
| [458](#L458) | $total\_ele\_down = $points->totalEleDown; |
| [459](#L459) | $avg\_speed      = $points->avgSpeed; |
| [460](#L460) | $avg\_cad        = $points->avgCad; |
| [461](#L461) | $avg\_hr         = $points->avgHr; |
| [462](#L462) | $avg\_temp       = $points->avgTemp; |
| [463](#L463) | $tot\_len        = $points->totalLength; |
| [464](#L464) |  |
| [465](#L465) | if ( is\_array( $points\_x\_lat ) ) |
| [466](#L466) | foreach ( array\_keys( |
| [467](#L467) | $points\_x\_lat ) as $i ) { |
| [468](#L468) | $\_lat = (float) $points\_x\_lat[$i]; |
| [469](#L469) | $\_lon = (float) $points\_x\_lon[$i]; |
| [470](#L470) |  |
| [471](#L471) | if ( 0 == $\_lat && 0 == $\_lon ) { |
| [472](#L472) | $points\_maps       .= 'null,'; |
| [473](#L473) | $points\_graph\_dist .= 'null,'; |
| [474](#L474) | $points\_graph\_ele  .= 'null,'; |
| [475](#L475) |  |
| [476](#L476) | if ( true == $showSpeed ) |
| [477](#L477) | $points\_graph\_speed .= 'null,'; |
| [478](#L478) |  |
| [479](#L479) | if ( true == $showHr ) |
| [480](#L480) | $points\_graph\_hr .= 'null,'; |
| [481](#L481) |  |
| [482](#L482) | if ( true == $showAtemp ) |
| [483](#L483) | $points\_graph\_atemp .= 'null,'; |
| [484](#L484) |  |
| [485](#L485) | if ( true == $showCad ) |
| [486](#L486) | $points\_graph\_cad .= 'null,'; |
| [487](#L487) |  |
| [488](#L488) | if ( true == $showGrade ) |
| [489](#L489) | $points\_graph\_grade .= 'null,'; |
| [490](#L490) | } else { |
| [491](#L491) | $points\_maps .= '[' . number\_format( (float) $points\_x\_lat[$i], 7, '.', '' ) . ',' . number\_format( (float) $points\_x\_lon[$i], 7, '.', '' ) . '],'; |
| [492](#L492) |  |
| [493](#L493) | $\_ele  = (float) $points->ele[$i]; |
| [494](#L494) | $\_dist = (float) $points->dist[$i]; |
| [495](#L495) |  |
| [496](#L496) | if ( wpgpxmaps\_FEET\_MILES == $unit\_of\_measure ) { |
| [497](#L497) | /\* feet / miles \*/ |
| [498](#L498) | $\_dist \*= 0.000621371192; |
| [499](#L499) | $\_ele  \*= 3.2808399; |
| [500](#L500) |  |
| [501](#L501) | } elseif ( wpgpxmaps\_METERS\_KILOMETERS == $unit\_of\_measure ) { |
| [502](#L502) | /\* meters / kilometers \*/ |
| [503](#L503) | $\_dist = (float) ( $\_dist / 1000 ); |
| [504](#L504) |  |
| [505](#L505) | } elseif ( wpgpxmaps\_METERS\_NAUTICALMILES == $unit\_of\_measure ) { |
| [506](#L506) | /\* meters / nautical miles \*/ |
| [507](#L507) | $\_dist = (float) ( $\_dist / 1000 / 1.852 ); |
| [508](#L508) |  |
| [509](#L509) | } elseif ( wpgpxmaps\_METER\_MILES == $unit\_of\_measure ) { |
| [510](#L510) | /\* meters / miles \*/ |
| [511](#L511) | $\_dist \*= 0.000621371192; |
| [512](#L512) |  |
| [513](#L513) | } elseif ( wpgpxmaps\_FEET\_NAUTICALMILES == $unit\_of\_measure ) { |
| [514](#L514) | /\* feet / nautical miles \*/ |
| [515](#L515) | $\_dist = (float) ( $\_dist / 1000 / 1.852 ); |
| [516](#L516) | $\_ele \*= 3.2808399; |
| [517](#L517) | } |
| [518](#L518) |  |
| [519](#L519) | $points\_graph\_dist .= number\_format( $\_dist, 2, '.', '' ) . ','; |
| [520](#L520) | $points\_graph\_ele  .= number\_format( $\_ele, 2, '.', '' ) . ','; |
| [521](#L521) |  |
| [522](#L522) | if ( true == $showSpeed ) { |
| [523](#L523) | $\_speed              = (float) $points->speed[$i]; |
| [524](#L524) | $points\_graph\_speed .= convertSpeed( $\_speed, $unit\_of\_measure\_speed ) . ','; |
| [525](#L525) | } |
| [526](#L526) |  |
| [527](#L527) | if ( true == $showHr ) { |
| [528](#L528) | $points\_graph\_hr .= number\_format( $points->hr[$i], 2, '.', '' ) . ','; |
| [529](#L529) | } |
| [530](#L530) |  |
| [531](#L531) | if ( true == $showAtemp ) { |
| [532](#L532) | $points\_graph\_atemp .= number\_format( $points->atemp[$i], 1, '.', '' ) . ','; |
| [533](#L533) | } |
| [534](#L534) |  |
| [535](#L535) | if ( true == $showCad ) { |
| [536](#L536) | $points\_graph\_cad .= number\_format( $points->cad[$i], 2, '.', '' ) . ','; |
| [537](#L537) | } |
| [538](#L538) |  |
| [539](#L539) | if ( true == $showGrade ) { |
| [540](#L540) | $points\_graph\_grade .= number\_format( $points->grade[$i], 2, '.', '' ) . ','; |
| [541](#L541) | } |
| [542](#L542) | } |
| [543](#L543) | } |
| [544](#L544) |  |
| [545](#L545) | if ( wpgpxmaps\_FEET\_MILES == $unit\_of\_measure ) { |
| [546](#L546) | /\* feet / miles \*/ |
| [547](#L547) | $tot\_len        = round( $tot\_len \* 0.000621371192, 2 ) . ' mi'; |
| [548](#L548) | $max\_ele        = round( $max\_ele \* 3.2808399, 0 ) . ' ft'; |
| [549](#L549) | $min\_ele        = round( $min\_ele \* 3.2808399, 0 ) . ' ft'; |
| [550](#L550) | $total\_ele\_up   = round( $total\_ele\_up \* 3.2808399, 0 ) . ' ft'; |
| [551](#L551) | $total\_ele\_down = round( $total\_ele\_down \* 3.2808399, 0 ) . ' ft'; |
| [552](#L552) |  |
| [553](#L553) | } elseif ( wpgpxmaps\_METERS\_KILOMETERS == $unit\_of\_measure ) { |
| [554](#L554) | /\* meters / kilometers \*/ |
| [555](#L555) | $tot\_len        = round( $tot\_len / 1000, 2 ) . ' km'; |
| [556](#L556) | $max\_ele        = round( $max\_ele, 0 ) . ' m'; |
| [557](#L557) | $min\_ele        = round( $min\_ele, 0 ) . ' m'; |
| [558](#L558) | $total\_ele\_up   = round( $total\_ele\_up, 0 ) . ' m'; |
| [559](#L559) | $total\_ele\_down = round( $total\_ele\_down, 0 ) . ' m'; |
| [560](#L560) |  |
| [561](#L561) | } elseif ( wpgpxmaps\_METERS\_NAUTICALMILES == $unit\_of\_measure ) { |
| [562](#L562) | /\* meters / nautical miles \*/ |
| [563](#L563) | $tot\_len        = round( $tot\_len / 1000 / 1.852, 2 ) . ' NM'; |
| [564](#L564) | $max\_ele        = round( $max\_ele, 0 ) . ' m'; |
| [565](#L565) | $min\_ele        = round( $min\_ele, 0 ) . ' m'; |
| [566](#L566) | $total\_ele\_up   = round( $total\_ele\_up, 0 ) . ' m'; |
| [567](#L567) | $total\_ele\_down = round( $total\_ele\_down, 0 ) . ' m'; |
| [568](#L568) |  |
| [569](#L569) | } elseif ( wpgpxmaps\_METER\_MILES == $unit\_of\_measure ) { |
| [570](#L570) | /\* meters / miles \*/ |
| [571](#L571) | $tot\_len        = round( $tot\_len \* 0.000621371192, 2 ) . ' mi'; |
| [572](#L572) | $max\_ele        = round( $max\_ele, 0 ) . ' m'; |
| [573](#L573) | $min\_ele        = round( $min\_ele, 0 ) . ' m'; |
| [574](#L574) | $total\_ele\_up   = round( $total\_ele\_up, 0 ) . ' m'; |
| [575](#L575) | $total\_ele\_down = round( $total\_ele\_down, 0 ) . ' m'; |
| [576](#L576) |  |
| [577](#L577) | } elseif ( wpgpxmaps\_FEET\_NAUTICALMILES == $unit\_of\_measure ) { |
| [578](#L578) | /\* feet / nautical miles \*/ |
| [579](#L579) | $tot\_len        = round( $tot\_len / 1000 / 1.852, 2 ) . ' NM'; |
| [580](#L580) | $max\_ele        = round( $max\_ele \* 3.2808399, 0 ) . ' ft'; |
| [581](#L581) | $min\_ele        = round( $min\_ele \* 3.2808399, 0 ) . ' ft'; |
| [582](#L582) | $total\_ele\_up   = round( $total\_ele\_up \* 3.2808399, 0 ) . ' ft'; |
| [583](#L583) | $total\_ele\_down = round( $total\_ele\_down \* 3.2808399, 0 ) . ' ft'; |
| [584](#L584) |  |
| [585](#L585) | } else { |
| [586](#L586) | /\* meters / meters \*/ |
| [587](#L587) | $tot\_len        = round( $tot\_len, 0 ) . ' m'; |
| [588](#L588) | $max\_ele        = round( $max\_ele, 0 ) . ' m'; |
| [589](#L589) | $min\_ele        = round( $min\_ele, 0 ) . ' m'; |
| [590](#L590) | $total\_ele\_up   = round( $total\_ele\_up, 0 ) . ' m'; |
| [591](#L591) | $total\_ele\_down = round( $total\_ele\_down, 0 ) . ' m'; |
| [592](#L592) | } |
| [593](#L593) |  |
| [594](#L594) | $avg\_speed = convertSpeed( $avg\_speed, $unit\_of\_measure\_speed, true ); |
| [595](#L595) | $waypoints = '[]'; |
| [596](#L596) |  |
| [597](#L597) | if ( true == $showW ) { |
| [598](#L598) | $wpoints   = wpgpxmaps\_getWayPoints( $gpx ); |
| [599](#L599) | $waypoints = wp\_json\_encode( $wpoints ); |
| [600](#L600) | } |
| [601](#L601) | if ( false == $showEle ) { |
| [602](#L602) | $points\_graph\_ele = ''; |
| [603](#L603) | } |
| [604](#L604) |  |
| [605](#L605) | $p = '/(,|,null,)$/'; |
| [606](#L606) |  |
| [607](#L607) | $points\_maps = preg\_replace( $p, '', $points\_maps ); |
| [608](#L608) |  |
| [609](#L609) | $points\_graph\_dist  = preg\_replace( $p, '', $points\_graph\_dist ); |
| [610](#L610) | $points\_graph\_ele   = preg\_replace( $p, '', $points\_graph\_ele ); |
| [611](#L611) | $points\_graph\_speed = preg\_replace( $p, '', $points\_graph\_speed ); |
| [612](#L612) | $points\_graph\_hr    = preg\_replace( $p, '', $points\_graph\_hr ); |
| [613](#L613) | $points\_graph\_atemp = preg\_replace( $p, '', $points\_graph\_atemp ); |
| [614](#L614) | $points\_graph\_cad   = preg\_replace( $p, '', $points\_graph\_cad ); |
| [615](#L615) | $points\_graph\_grade = preg\_replace( $p, '', $points\_graph\_grade ); |
| [616](#L616) |  |
| [617](#L617) | $waypoints = preg\_replace( $p, '', $waypoints ); |
| [618](#L618) |  |
| [619](#L619) | if ( preg\_match( '/^(0,?)+$/', $points\_graph\_dist ) ) |
| [620](#L620) | $points\_graph\_dist = ''; |
| [621](#L621) |  |
| [622](#L622) | if ( preg\_match( '/^(0,?)+$/', $points\_graph\_ele ) ) |
| [623](#L623) | $points\_graph\_ele = ''; |
| [624](#L624) |  |
| [625](#L625) | if ( preg\_match( '/^(0,?)+$/', $points\_graph\_speed ) ) |
| [626](#L626) | $points\_graph\_speed = ''; |
| [627](#L627) |  |
| [628](#L628) | if ( preg\_match( '/^(0,?)+$/', $points\_graph\_hr ) ) |
| [629](#L629) | $points\_graph\_hr = ''; |
| [630](#L630) |  |
| [631](#L631) | if ( preg\_match( '/^(0,?)+$/', $points\_graph\_hr ) ) |
| [632](#L632) | $points\_graph\_hr = ''; |
| [633](#L633) |  |
| [634](#L634) | if ( preg\_match( '/^(0,?)+$/', $points\_graph\_atemp ) ) |
| [635](#L635) | $points\_graph\_atemp = ''; |
| [636](#L636) |  |
| [637](#L637) | if ( preg\_match( '/^(0,?)+$/', $points\_graph\_grade ) ) |
| [638](#L638) | $points\_graph\_grade = ''; |
| [639](#L639) |  |
| [640](#L640) | } |
| [641](#L641) |  |
| [642](#L642) | $ngimgs\_data = ''; |
| [643](#L643) | if ( $ngGalleries != '' || $ngImages != '' ) { |
| [644](#L644) | $ngimgs      = getNGGalleryImages( $ngGalleries, $ngImages, $points\_x\_time, $points\_x\_lat, $points\_x\_lon, $dtoffset, $error ); |
| [645](#L645) | $ngimgs\_data = ''; |
| [646](#L646) |  |
| [647](#L647) | foreach ( $ngimgs as $img ) { |
| [648](#L648) | $data         = $img['data']; |
| [649](#L649) | $data         = str\_replace( '\n', '', $data ); |
| [650](#L650) | $ngimgs\_data .= '<span lat="' . $img['lat'] . '" lon="' . $img['lon'] . '">' . $data . '</span>'; |
| [651](#L651) | } |
| [652](#L652) | } |
| [653](#L653) |  |
| [654](#L654) | if ( true == $attachments ) { |
| [655](#L655) | $attimgs = wpgpxmaps\_getAttachedImages( $points\_x\_time, $points\_x\_lat, $points\_x\_lon, $dtoffset, $error ); |
| [656](#L656) | foreach ( $attimgs as $img ) { |
| [657](#L657) | $data         = $img['data']; |
| [658](#L658) | $data         = str\_replace( '\n', '', $data ); |
| [659](#L659) | $ngimgs\_data .= '<span lat="' . $img['lat'] . '" lon="' . $img['lon'] . '">' . $data . '</span>'; |
| [660](#L660) | } |
| [661](#L661) | } |
| [662](#L662) |  |
| [663](#L663) | if ( ! ( true == $skipcache ) ) { |
| [664](#L664) |  |
| [665](#L665) | global $wp\_filesystem; |
| [666](#L666) | if (empty($wp\_filesystem)) { |
| [667](#L667) | require\_once (ABSPATH . '/wp-admin/includes/file.php'); |
| [668](#L668) | WP\_Filesystem(); |
| [669](#L669) | } |
| [670](#L670) |  |
| [671](#L671) | $wp\_filesystem->put\_contents( $gpxcache, serialize( array( |
| [672](#L672) | 'points\_maps'        => $points\_maps, |
| [673](#L673) | 'points\_x\_time'      => $points\_x\_time, |
| [674](#L674) | 'points\_x\_lat'       => $points\_x\_lat, |
| [675](#L675) | 'points\_x\_lon'       => $points\_x\_lon, |
| [676](#L676) | 'points\_graph\_dist'  => $points\_graph\_dist, |
| [677](#L677) | 'points\_graph\_ele'   => $points\_graph\_ele, |
| [678](#L678) | 'points\_graph\_speed' => $points\_graph\_speed, |
| [679](#L679) | 'points\_graph\_hr'    => $points\_graph\_hr, |
| [680](#L680) | 'points\_graph\_atemp' => $points\_graph\_atemp, |
| [681](#L681) | 'points\_graph\_cad'   => $points\_graph\_cad, |
| [682](#L682) | 'points\_graph\_grade' => $points\_graph\_grade, |
| [683](#L683) | 'waypoints'          => $waypoints, |
| [684](#L684) | 'max\_ele'            => $max\_ele, |
| [685](#L685) | 'min\_ele'            => $min\_ele, |
| [686](#L686) | 'total\_ele\_up'       => $total\_ele\_up, |
| [687](#L687) | 'total\_ele\_down'     => $total\_ele\_down, |
| [688](#L688) | 'avg\_speed'          => $avg\_speed, |
| [689](#L689) | 'avg\_cad'            => $avg\_cad, |
| [690](#L690) | 'avg\_hr'             => $avg\_hr, |
| [691](#L691) | 'avg\_temp'           => $avg\_temp, |
| [692](#L692) | 'tot\_len'            => $tot\_len, |
| [693](#L693) | 'max\_time'           => $max\_time, |
| [694](#L694) | 'min\_time'           => $min\_time, |
| [695](#L695) | ) |
| [696](#L696) | ), |
| [697](#L697) | LOCK\_EX); |
| [698](#L698) | @chmod( $gpxcache, 0755 ); |
| [699](#L699) | } |
| [700](#L700) |  |
| [701](#L701) | $hideGraph = ( '0' == $gh || '0px' == $gh ); |
| [702](#L702) |  |
| [703](#L703) | global $post; |
| [704](#L704) | $r = $post->ID . '\_' . rand( 1,5000000 ); |
| [705](#L705) |  |
| [706](#L706) | $output = ' |
| [707](#L707) | <div id="wpgpxmaps\_' . esc\_attr( $r ) . '" class="wpgpxmaps"> |
| [708](#L708) | <div id="map\_' . esc\_attr( $r ) . '\_cont" style="width:' . esc\_attr( $w ) . '; height:' . esc\_attr( $mh ) . ';position:relative" > |
| [709](#L709) | <div id="map\_' . esc\_attr( $r ) . '" style="width:' . esc\_attr( $w ) . '; height:' . esc\_attr( $mh ) . '"></div> |
| [710](#L710) | <div id="wpgpxmaps\_' . esc\_attr( $r ) . '\_osm\_footer" class="wpgpxmaps\_osm\_footer" style="display:none;"><span> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors</span></div> |
| [711](#L711) | </div> |
| [712](#L712) | <canvas id="myChart\_' . esc\_attr( $r ) . '" class="plot" style="width:' . esc\_attr( $w ) . '; height:' . esc\_attr( $gh ) . '"></canvas> |
| [713](#L713) | <div id="ngimages\_' . esc\_attr( $r ) . '" class="ngimages" style="display:none">' . wp\_kses\_post( $ngimgs\_data ) . '</div> |
| [714](#L714) | <div id="report\_' . esc\_attr( $r ) . '" class="report"></div> |
| [715](#L715) | </div> |
| [716](#L716) | ' . esc\_html( $error ) . ' |
| [717](#L717) | <script type="text/javascript"> |
| [718](#L718) |  |
| [719](#L719) | jQuery(document).ready(function() { |
| [720](#L720) |  |
| [721](#L721) | jQuery( "#wpgpxmaps\_' . esc\_js( $r ) . '" ).wpgpxmaps( { |
| [722](#L722) | targetId           : "' . esc\_js( $r ) . '", |
| [723](#L723) | mapType            : "' . esc\_js( $mt ) . '", |
| [724](#L724) | mapData            : [' . esc\_js( $points\_maps ) . '], |
| [725](#L725) | graphDist          : [' . esc\_js( $hideGraph ? '' : $points\_graph\_dist ) . '], |
| [726](#L726) | graphEle           : [' . esc\_js( $hideGraph ? '' : $points\_graph\_ele ) . '], |
| [727](#L727) | graphSpeed         : [' . esc\_js( $hideGraph ? '' : $points\_graph\_speed ) . '], |
| [728](#L728) | graphHr            : [' . esc\_js( $hideGraph ? '' : $points\_graph\_hr ) . '], |
| [729](#L729) | graphAtemp         : [' . esc\_js( $hideGraph ? '' : $points\_graph\_atemp ) . '], |
| [730](#L730) | graphCad           : [' . esc\_js( $hideGraph ? '' : $points\_graph\_cad ) . '], |
| [731](#L731) | graphGrade         : [' . esc\_js( $hideGraph ? '' : $points\_graph\_grade ) . '], |
| [732](#L732) | waypoints          : ' . esc\_js( $waypoints ) . ', |
| [733](#L733) | unit               : "' . esc\_js( $unit\_of\_measure ) . '", |
| [734](#L734) | unitspeed          : "' . esc\_js( $unit\_of\_measure\_speed ) . '", |
| [735](#L735) | color1             : '. json\_encode( $colors\_map ) . ', |
| [736](#L736) | color2             : "' . esc\_js( $color\_graph ) . '", |
| [737](#L737) | color3             : "' . esc\_js( $color\_graph\_speed ) . '", |
| [738](#L738) | color4             : "' . esc\_js( $color\_graph\_hr ) . '", |
| [739](#L739) | color5             : "' . esc\_js( $color\_graph\_cad ) . '", |
| [740](#L740) | color6             : "' . esc\_js( $color\_graph\_grade ) . '", |
| [741](#L741) | color7             : "' . esc\_js( $color\_graph\_atemp ) . '", |
| [742](#L742) | chartFrom1         : "' . esc\_js( $chartFrom1 ) . '", |
| [743](#L743) | chartTo1           : "' . esc\_js( $chartTo1 ) . '", |
| [744](#L744) | chartFrom2         : "' . esc\_js( $chartFrom2 ) . '", |
| [745](#L745) | chartTo2           : "' . esc\_js( $chartTo2 ) . '", |
| [746](#L746) | startIcon          : "' . esc\_js( $startIcon ) . '", |
| [747](#L747) | endIcon            : "' . esc\_js( $endIcon ) . '", |
| [748](#L748) | currentIcon        : "' . esc\_js( $currentIcon ) . '", |
| [749](#L749) | waypointIcon       : "' . esc\_js( $waypointIcon ) . '", |
| [750](#L750) | currentpositioncon : "' . esc\_js( $currentpositioncon ) . '", |
| [751](#L751) | usegpsposition     : "' . esc\_js( $usegpsposition ) . '", |
| [752](#L752) | zoomOnScrollWheel  : "' . esc\_js( $zoomOnScrollWheel ) . '", |
| [753](#L753) | ngGalleries        : [' . esc\_js( $ngGalleries ) . '], |
| [754](#L754) | ngImages           : [' . esc\_js( $ngImages ) . '], |
| [755](#L755) | pluginUrl          : "' . esc\_url( plugins\_url() ) . '", |
| [756](#L756) | TFApiKey           : "' . esc\_js( get\_option( 'wpgpxmaps\_openstreetmap\_apikey' ) ) . '", |
| [757](#L757) | MapBoxApiKey           : "' . esc\_js( get\_option( 'wpgpxmaps\_mapbox\_apikey' ) ) . '", |
| [758](#L758) | langs              : { |
| [759](#L759) | altitude        : "' . esc\_js( \_\_( 'Altitude', 'wp-gpx-maps' ) ) . '", |
| [760](#L760) | currentPosition : "' . esc\_js( \_\_( 'Current position', 'wp-gpx-maps' ) ) . '", |
| [761](#L761) | speed           : "' . esc\_js( \_\_( 'Speed', 'wp-gpx-maps' ) ) . '", |
| [762](#L762) | grade           : "' . esc\_js( \_\_( 'Grade', 'wp-gpx-maps' ) ) . '", |
| [763](#L763) | heartRate       : "' . esc\_js( \_\_( 'Heart rate', 'wp-gpx-maps' ) ) . '", |
| [764](#L764) | atemp           : "' . esc\_js( \_\_( 'Temperature', 'wp-gpx-maps' ) ) . '", |
| [765](#L765) | cadence         : "' . esc\_js( \_\_( 'Cadence', 'wp-gpx-maps' ) ) . '", |
| [766](#L766) | goFullScreen    : "' . esc\_js( \_\_( 'Go full screen', 'wp-gpx-maps' ) ) . '", |
| [767](#L767) | exitFullFcreen  : "' . esc\_js( \_\_( 'Exit full screen', 'wp-gpx-maps' ) ) . '", |
| [768](#L768) | hideImages      : "' . esc\_js( \_\_( 'Hide images', 'wp-gpx-maps' ) ) . '", |
| [769](#L769) | showImages      : "' . esc\_js( \_\_( 'Show images', 'wp-gpx-maps' ) ) . '", |
| [770](#L770) | backToCenter    : "' . esc\_js( \_\_( 'Back to center', 'wp-gpx-maps' ) ) . '" |
| [771](#L771) | } |
| [772](#L772) | }); |
| [773](#L773) |  |
| [774](#L774) | }); |
| [775](#L775) |  |
| [776](#L776) | </script>'; |
| [777](#L777) |  |
| [778](#L778) | /\* Print summary \*/ |
| [779](#L779) | if ( true == $summary && ( $points\_graph\_speed != '' || $points\_graph\_ele != '' || $points\_graph\_dist != '' ) ) { |
| [780](#L780) |  |
| [781](#L781) | $output .= "<div id='wpgpxmaps\_summary\_" . esc\_attr( $r ) . "' class='wpgpxmaps\_summary'>"; |
| [782](#L782) | if ( $points\_graph\_dist != '' && true == $p\_tot\_len ) { |
| [783](#L783) | $output .= "<span class='totlen'><span class='summarylabel'>" . esc\_html\_\_( 'Total distance:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $tot\_len</span></span><br />"; |
| [784](#L784) | } |
| [785](#L785) | if ( $points\_graph\_ele != ' ' ) { |
| [786](#L786) | if ( true == $p\_max\_ele ) |
| [787](#L787) | $output .= "<span class='maxele'><span class='summarylabel'>" . esc\_html\_\_( 'Max elevation:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $max\_ele</span></span><br />"; |
| [788](#L788) | if ( true == $p\_min\_ele ) |
| [789](#L789) | $output .= "<span class='minele'><span class='summarylabel'>" . esc\_html\_\_( 'Min elevation:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $min\_ele</span></span><br />"; |
| [790](#L790) | if ( true == $p\_total\_ele\_up ) |
| [791](#L791) | $output .= "<span class='totaleleup'><span class='summarylabel'>" . esc\_html\_\_( 'Total climbing:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $total\_ele\_up</span></span><br />"; |
| [792](#L792) | if ( true == $p\_total\_ele\_down ) |
| [793](#L793) | $output .= "<span class='totaleledown'><span class='summarylabel'>" . esc\_html\_\_( 'Total descent:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $total\_ele\_down</span></span><br />"; |
| [794](#L794) | } |
| [795](#L795) | if ( $points\_graph\_speed != '' && true == $p\_avg\_speed ) { |
| [796](#L796) | $output .= "<span class='avgspeed'><span class='summarylabel'>" . esc\_html\_\_( 'Average speed:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $avg\_speed</span></span><br />"; |
| [797](#L797) | } |
| [798](#L798) | if ( $points\_graph\_cad != '' && true == $p\_avg\_cad ) { |
| [799](#L799) | $output .= "<span class='avgcad'><span class='summarylabel'>" . esc\_html\_\_( 'Average cadence:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $avg\_cad</span></span><br />"; |
| [800](#L800) | } |
| [801](#L801) | if ( $points\_graph\_hr != '' && true == $p\_avg\_hr ) { |
| [802](#L802) | $output .= "<span class='avghr'><span class='summarylabel'>" . esc\_html\_\_( 'Average heart rate:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $avg\_hr</span></span><br />"; |
| [803](#L803) | } |
| [804](#L804) | if ( $points\_graph\_atemp != '' && true == $p\_avg\_temp ) { |
| [805](#L805) | $output .= "<span class='avgtemp'><span class='summarylabel'>" . esc\_html\_\_( 'Average temperature:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $avg\_temp</span></span><br />"; |
| [806](#L806) | } |
| [807](#L807) | if ( true == $p\_total\_time && $max\_time > 0 ) { |
| [808](#L808) | $time\_diff = date( 'H:i:s', ( $max\_time - $min\_time ) ); |
| [809](#L809) | $output   .= "<span class='totaltime'><span class='summarylabel'>" . esc\_html\_\_( 'Total time:', 'wp-gpx-maps' ) . "</span><span class='summaryvalue'> $time\_diff</span></span><br />"; |
| [810](#L810) | } |
| [811](#L811) | $output .= '</div>'; |
| [812](#L812) | } |
| [813](#L813) |  |
| [814](#L814) | //$output .="--$download--"; |
| [815](#L815) |  |
| [816](#L816) | /\* Print download link \*/ |
| [817](#L817) | if ( (true === $download || 'true' === $download ) && $gpxurl != '' ) { |
| [818](#L818) | if ( true == $isGpxUrl ) { |
| [819](#L819) |  |
| [820](#L820) |  |
| [821](#L821) | } else { |
| [822](#L822) |  |
| [823](#L823) | $dummy  = ( defined( 'WP\_SITEURL' ) ) ? WP\_SITEURL : get\_bloginfo( 'url' ); |
| [824](#L824) | $gpxurl = $dummy . $gpxurl; |
| [825](#L825) | } |
| [826](#L826) | $output .= "Download file: <a href='$gpxurl' target='\_new' download>" . basename($gpxurl) . '</a>'; |
| [827](#L827) | } |
| [828](#L828) |  |
| [829](#L829) | return $output; |
| [830](#L830) | } |
| [831](#L831) |  |
| [832](#L832) | function convertSeconds( $s ) { |
| [833](#L833) |  |
| [834](#L834) | if ( 0 == $s ) |
| [835](#L835) | return 0; |
| [836](#L836) |  |
| [837](#L837) | $s      = 1.0 / $s; |
| [838](#L838) | $\_sSecT = $s \* 60; // sec/km |
| [839](#L839) | $\_sMin  = floor( $\_sSecT / 60 ); |
| [840](#L840) | $\_sSec  = $\_sSecT - $\_sMin \* 60; |
| [841](#L841) | return $\_sMin + $\_sSec / 100; |
| [842](#L842) | } |
| [843](#L843) |  |
| [844](#L844) | function convertSpeed( $speed, $unit\_of\_measure\_speed, $addUom = false ) { |
| [845](#L845) |  |
| [846](#L846) | $unit\_of\_measure = ''; |
| [847](#L847) |  |
| [848](#L848) | if ( wpgpxmaps\_MINUTES\_PER\_100METERS == $unit\_of\_measure\_speed && $speed != 0 ) { |
| [849](#L849) | /\* min/100 meters \*/ |
| [850](#L850) | $speed = 1 / $speed \* 100 / 60; |
| [851](#L851) | $unit\_of\_measure   = ' min/100m'; |
| [852](#L852) |  |
| [853](#L853) | } elseif ( wpgpxmaps\_KNOTS == $unit\_of\_measure\_speed ) { |
| [854](#L854) | /\* knots \*/ |
| [855](#L855) | $speed \*= 1.94384449; |
| [856](#L856) | $unit\_of\_measure    = ' knots'; |
| [857](#L857) |  |
| [858](#L858) | } elseif ( wpgpxmaps\_MINUTES\_PER\_MILES == $unit\_of\_measure\_speed ) { |
| [859](#L859) | /\* min/miles\*/ |
| [860](#L860) | $speed = convertSeconds( $speed \* 0.037282272 ); |
| [861](#L861) | $unit\_of\_measure   = ' min/mi'; |
| [862](#L862) |  |
| [863](#L863) | } elseif ( wpgpxmaps\_MINUTES\_PER\_KM == $unit\_of\_measure\_speed ) { |
| [864](#L864) | /\* min/km \*/ |
| [865](#L865) | $speed = convertSeconds( $speed \* 0.06 ); |
| [866](#L866) | $unit\_of\_measure   = ' min/km'; |
| [867](#L867) |  |
| [868](#L868) | } elseif ( wpgpxmaps\_MILES\_PER\_HOURS == $unit\_of\_measure\_speed ) { |
| [869](#L869) | /\* miles/h \*/ |
| [870](#L870) | $speed \*= 2.2369362920544025; |
| [871](#L871) | $unit\_of\_measure    = ' mi/h'; |
| [872](#L872) |  |
| [873](#L873) | } elseif ( wpgpxmaps\_KM\_PER\_HOURS == $unit\_of\_measure\_speed ) { |
| [874](#L874) | /\* km/h \*/ |
| [875](#L875) | $speed \*= 3.6; |
| [876](#L876) | $unit\_of\_measure    = ' km/h'; |
| [877](#L877) |  |
| [878](#L878) | } else { |
| [879](#L879) | /\* default m/s \*/ |
| [880](#L880) | $unit\_of\_measure = ' m/s'; |
| [881](#L881) | } |
| [882](#L882) |  |
| [883](#L883) | if ( true == $addUom ) { |
| [884](#L884) | return number\_format( $speed, 2, '.', '' ) . $unit\_of\_measure; |
| [885](#L885) | } else { |
| [886](#L886) | return number\_format( $speed, 2, '.', '' ); |
| [887](#L887) | } |
| [888](#L888) |  |
| [889](#L889) | } |
| [890](#L890) |  |
| [891](#L891) | function unescape( $value ) { |
| [892](#L892) |  |
| [893](#L893) | $value = str\_replace( "'", "\'", $value ); |
| [894](#L894) | $value = str\_replace( array( '\n', '\r' ), '', $value ); |
| [895](#L895) | return $value; |
| [896](#L896) |  |
| [897](#L897) | } |
| [898](#L898) |  |
| [899](#L899) | function wpgpxmaps\_install\_option() { |
| [900](#L900) | $options = array( |
| [901](#L901) | // General |
| [902](#L902) | 'wpgpxmaps\_width' => '100%', |
| [903](#L903) | 'wpgpxmaps\_height' => '450px', |
| [904](#L904) | 'wpgpxmaps\_graph\_height' => '200px', |
| [905](#L905) | 'wpgpxmaps\_distance\_type' => '0', |
| [906](#L906) | 'wpgpxmaps\_skipcache' => '', |
| [907](#L907) | 'wpgpxmaps\_download' => '', |
| [908](#L908) | 'wpgpxmaps\_usegpsposition' => '', |
| [909](#L909) | // Print Summary Table |
| [910](#L910) | 'wpgpxmaps\_summary' => '', |
| [911](#L911) | 'wpgpxmaps\_summary\_tot\_len' => '', |
| [912](#L912) | 'wpgpxmaps\_summary\_max\_ele' => '', |
| [913](#L913) | 'wpgpxmaps\_summary\_min\_ele' => '', |
| [914](#L914) | 'wpgpxmaps\_summary\_total\_ele\_up' => '', |
| [915](#L915) | 'wpgpxmaps\_summary\_total\_ele\_down' => '', |
| [916](#L916) | 'wpgpxmaps\_summary\_avg\_speed' => '', |
| [917](#L917) | 'wpgpxmaps\_summary\_avg\_cad' => '', |
| [918](#L918) | 'wpgpxmaps\_summary\_avg\_hr' => '', |
| [919](#L919) | 'wpgpxmaps\_summary\_avg\_temp' => '', |
| [920](#L920) | 'wpgpxmaps\_summary\_total\_time' => '', |
| [921](#L921) | // Map |
| [922](#L922) | 'wpgpxmaps\_map\_type' => 'HYBRID', |
| [923](#L923) | 'wpgpxmaps\_map\_line\_color' => '#3366cc', |
| [924](#L924) | 'wpgpxmaps\_zoomonscrollwheel' => '', |
| [925](#L925) | 'wpgpxmaps\_show\_waypoint' => '', |
| [926](#L926) | 'wpgpxmaps\_map\_start\_icon' => '', |
| [927](#L927) | 'wpgpxmaps\_map\_end\_icon' => '', |
| [928](#L928) | 'wpgpxmaps\_currentpositioncon' => '', |
| [929](#L929) | 'wpgpxmaps\_map\_current\_icon' => '', |
| [930](#L930) | 'wpgpxmaps\_map\_waypoint\_icon' => '', |
| [931](#L931) | // Diagram - Elevation |
| [932](#L932) | 'wpgpxmaps\_show\_elevation' => 'true', |
| [933](#L933) | 'wpgpxmaps\_graph\_line\_color' => '#3366cc', |
| [934](#L934) | 'wpgpxmaps\_unit\_of\_measure' => '0', |
| [935](#L935) | 'wpgpxmaps\_graph\_offset\_from1' => '', |
| [936](#L936) | 'wpgpxmaps\_graph\_offset\_to1' => '', |
| [937](#L937) | // Diagram - Speed |
| [938](#L938) | 'wpgpxmaps\_show\_speed' => '', |
| [939](#L939) | 'wpgpxmaps\_graph\_line\_color\_speed' => '#ff0000', |
| [940](#L940) | 'wpgpxmaps\_unit\_of\_measure\_speed' => '0', |
| [941](#L941) | 'wpgpxmaps\_graph\_offset\_from2' => '', |
| [942](#L942) | 'wpgpxmaps\_graph\_offset\_to2' => '', |
| [943](#L943) | // Diagram - Heart rate |
| [944](#L944) | 'wpgpxmaps\_show\_hr' => '', |
| [945](#L945) | 'wpgpxmaps\_graph\_line\_color\_hr' => '#ff77bd', |
| [946](#L946) | // Diagram - Temperature |
| [947](#L947) | 'wpgpxmaps\_show\_atemp' => '', |
| [948](#L948) | 'wpgpxmaps\_graph\_line\_color\_atemp' => '#ff77bd', |
| [949](#L949) | // Diagram - Cadence |
| [950](#L950) | 'wpgpxmaps\_show\_cadence' => '', |
| [951](#L951) | 'wpgpxmaps\_graph\_line\_color\_cad' => '#beecff', |
| [952](#L952) | // Diagram - Grade |
| [953](#L953) | 'wpgpxmaps\_show\_grade' => '', |
| [954](#L954) | 'wpgpxmaps\_graph\_line\_color\_grade' => '#beecff', |
| [955](#L955) | // Pictures |
| [956](#L956) | 'wpgpxmaps\_map\_nggallery' => '', |
| [957](#L957) | // Advanced |
| [958](#L958) | 'wpgpxmaps\_pointsoffset' => '10', |
| [959](#L959) | 'wpgpxmaps\_donotreducegpx' => 'true', |
| [960](#L960) | // Administration |
| [961](#L961) | 'wpgpxmaps\_allow\_users\_upload' => '', |
| [962](#L962) | 'wpgpxmaps\_show\_notice' => '' |
| [963](#L963) | ); |
| [964](#L964) |  |
| [965](#L965) | foreach ( $options as $key => $value ) { |
| [966](#L966) | add\_option( $key, $value, '', 'yes' ); |
| [967](#L967) | } |
| [968](#L968) | } |
| [969](#L969) |  |
| [970](#L970) | function wpgpxmaps\_remove\_option() { |
| [971](#L971) | $options = array( |
| [972](#L972) | // General |
| [973](#L973) | 'wpgpxmaps\_width', |
| [974](#L974) | 'wpgpxmaps\_height', |
| [975](#L975) | 'wpgpxmaps\_graph\_height', |
| [976](#L976) | 'wpgpxmaps\_distance\_type', |
| [977](#L977) | 'wpgpxmaps\_skipcache', |
| [978](#L978) | 'wpgpxmaps\_download', |
| [979](#L979) | 'wpgpxmaps\_usegpsposition', |
| [980](#L980) | // Print Summary Table |
| [981](#L981) | 'wpgpxmaps\_summary', |
| [982](#L982) | 'wpgpxmaps\_summary\_tot\_len', |
| [983](#L983) | 'wpgpxmaps\_summary\_max\_ele', |
| [984](#L984) | 'wpgpxmaps\_summary\_min\_ele', |
| [985](#L985) | 'wpgpxmaps\_summary\_total\_ele\_up', |
| [986](#L986) | 'wpgpxmaps\_summary\_total\_ele\_down', |
| [987](#L987) | 'wpgpxmaps\_summary\_avg\_speed', |
| [988](#L988) | 'wpgpxmaps\_summary\_avg\_cad', |
| [989](#L989) | 'wpgpxmaps\_summary\_avg\_hr', |
| [990](#L990) | 'wpgpxmaps\_summary\_avg\_temp', |
| [991](#L991) | 'wpgpxmaps\_summary\_total\_time', |
| [992](#L992) | // Map |
| [993](#L993) | 'wpgpxmaps\_map\_type', |
| [994](#L994) | 'wpgpxmaps\_map\_line\_color', |
| [995](#L995) | 'wpgpxmaps\_zoomonscrollwheel', |
| [996](#L996) | 'wpgpxmaps\_show\_waypoint', |
| [997](#L997) | 'wpgpxmaps\_map\_start\_icon', |
| [998](#L998) | 'wpgpxmaps\_map\_end\_icon', |
| [999](#L999) | 'wpgpxmaps\_currentpositioncon', |
| [1000](#L1000) | 'wpgpxmaps\_map\_current\_icon', |
| [1001](#L1001) | 'wpgpxmaps\_map\_waypoint\_icon', |
| [1002](#L1002) | // Diagram - Elevation |
| [1003](#L1003) | 'wpgpxmaps\_show\_elevation', |
| [1004](#L1004) | 'wpgpxmaps\_graph\_line\_color', |
| [1005](#L1005) | 'wpgpxmaps\_unit\_of\_measure', |
| [1006](#L1006) | 'wpgpxmaps\_graph\_offset\_from1', |
| [1007](#L1007) | 'wpgpxmaps\_graph\_offset\_to1', |
| [1008](#L1008) | // Diagram - Speed |
| [1009](#L1009) | 'wpgpxmaps\_show\_speed', |
| [1010](#L1010) | 'wpgpxmaps\_graph\_line\_color\_speed', |
| [1011](#L1011) | 'wpgpxmaps\_unit\_of\_measure\_speed', |
| [1012](#L1012) | 'wpgpxmaps\_graph\_offset\_from2', |
| [1013](#L1013) | 'wpgpxmaps\_graph\_offset\_to2', |
| [1014](#L1014) | // Diagram - Heart rate |
| [1015](#L1015) | 'wpgpxmaps\_show\_hr', |
| [1016](#L1016) | 'wpgpxmaps\_graph\_line\_color\_hr', |
| [1017](#L1017) | // Diagram - Temperature |
| [1018](#L1018) | 'wpgpxmaps\_show\_atemp', |
| [1019](#L1019) | 'wpgpxmaps\_graph\_line\_color\_atemp', |
| [1020](#L1020) | // Diagram - Cadence |
| [1021](#L1021) | 'wpgpxmaps\_show\_cadence', |
| [1022](#L1022) | 'wpgpxmaps\_graph\_line\_color\_cad', |
| [1023](#L1023) | // Diagram - Grade |
| [1024](#L1024) | 'wpgpxmaps\_show\_grade', |
| [1025](#L1025) | 'wpgpxmaps\_graph\_line\_color\_grade', |
| [1026](#L1026) | // Pictures |
| [1027](#L1027) | 'wpgpxmaps\_map\_nggallery', |
| [1028](#L1028) | // Advanced |
| [1029](#L1029) | 'wpgpxmaps\_pointsoffset', |
| [1030](#L1030) | 'wpgpxmaps\_donotreducegpx', |
| [1031](#L1031) | // Administration |
| [1032](#L1032) | 'wpgpxmaps\_allow\_users\_upload', |
| [1033](#L1033) | 'wpgpxmaps\_show\_notice' |
| [1034](#L1034) | ); |
| [1035](#L1035) |  |
| [1036](#L1036) | foreach ( $options as $key ) { |
| [1037](#L1037) | delete\_option( $key ); |
| [1038](#L1038) | } |
| [1039](#L1039) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wp-gpx-maps/trunk/wp-gpx-maps.php?format=txt)
* [Original Format](/export/3220756/wp-gpx-maps/trunk/wp-gpx-maps.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_ac225f18_20250111_151019.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwp-gpx-maps%2Ftrunk%2Fwp-gpx-maps-admin-tracks.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wp-gpx-maps/trunk/wp-gpx-maps-admin-tracks.php?rev=3027198 "Revision 3027198")
* Next Revision →
* [Blame](/browser/wp-gpx-maps/trunk/wp-gpx-maps-admin-tracks.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wp-gpx-maps/trunk/wp-gpx-maps-admin-tracks.php)

---

# [source:](/browser?order=name "Go to repository root") [wp-gpx-maps](/browser/wp-gpx-maps?order=name "View wp-gpx-maps")/[trunk](/browser/wp-gpx-maps/trunk?order=name "View trunk")/[wp-gpx-maps-admin-tracks.php](/browser/wp-gpx-maps/trunk/wp-gpx-maps-admin-tracks.php?order=name "View wp-gpx-maps-admin-tracks.php")

View diff against:

View revision:

| [Last change](/changeset/3217023/wp-gpx-maps/trunk/wp-gpx-maps-admin-tracks.php "View differences") on this file was [3217023](/changeset/3217023/ "View changeset 3217023"), checked in by bastianonm, [7 days ago](/timeline?from=2025-01-04T22%3A16%3A05Z&precision=second "See timeline at 01/04/2025 10:16:05 PM") |
| --- |
| Fix security issues |
| **File size:** 9.4 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Tracks Tab |
| [4](#L4) | \* |
| [5](#L5) | \* Content for Tab Tracks and Cache. |
| [6](#L6) | \* |
| [7](#L7) | \* @package WP GPX Maps |
| [8](#L8) | \*/ |
| [9](#L9) |  |
| [10](#L10) | if ( ! ( is\_admin() ) ) |
| [11](#L11) | return; |
| [12](#L12) |  |
| [13](#L13) | $is\_admin = current\_user\_can( 'publish\_posts' ); |
| [14](#L14) |  |
| [15](#L15) | if ( $is\_admin != 1 ) |
| [16](#L16) | return; |
| [17](#L17) |  |
| [18](#L18) | $wpgpxmapsUrl = esc\_url( get\_admin\_url() . 'admin.php?page=WP-GPX-Maps' ); |
| [19](#L19) | $gpxRegEx     = '/.gpx$/i'; |
| [20](#L20) |  |
| [21](#L21) | if ( current\_user\_can( 'manage\_options' ) ) { |
| [22](#L22) |  |
| [23](#L23) | $menu\_root = 'options-general.php'; |
| [24](#L24) |  |
| [25](#L25) | } elseif ( current\_user\_can( 'publish\_posts' ) ) { |
| [26](#L26) |  |
| [27](#L27) | $menu\_root = 'admin.php'; |
| [28](#L28) |  |
| [29](#L29) | } |
| [30](#L30) |  |
| [31](#L31) | global $wp\_filesystem; |
| [32](#L32) | if (empty($wp\_filesystem)) { |
| [33](#L33) | require\_once (ABSPATH . '/wp-admin/includes/file.php'); |
| [34](#L34) | WP\_Filesystem(); |
| [35](#L35) | } |
| [36](#L36) |  |
| [37](#L37) |  |
| [38](#L38) | /\*\* |
| [39](#L39) | \* Override the default upload path. |
| [40](#L40) | \* |
| [41](#L41) | \* @param   array   $dir |
| [42](#L42) | \* @return  array |
| [43](#L43) | \*/ |
| [44](#L44) | function wpgpxmaps\_181088\_upload\_dir( $dir ) { |
| [45](#L45) |  |
| [46](#L46) | return array( |
| [47](#L47) | 'path'   => $dir['basedir'] . '/gpx', |
| [48](#L48) | 'url'    => $dir['baseurl'] . '/gpx', |
| [49](#L49) | 'subdir' => '/gpx', |
| [50](#L50) | ) + $dir; |
| [51](#L51) | } |
| [52](#L52) |  |
| [53](#L53) |  |
| [54](#L54) | function wpgpxmaps\_move\_uploaded\_file($uploadedfile) |
| [55](#L55) | { |
| [56](#L56) |  |
| [57](#L57) | // Register our path override. |
| [58](#L58) | add\_filter( 'upload\_dir', 'wpgpxmaps\_181088\_upload\_dir' ); |
| [59](#L59) |  |
| [60](#L60) | $upload\_overrides = array( 'test\_form' => false, 'test\_type' => false ); |
| [61](#L61) |  |
| [62](#L62) | // Do our thing. WordPress will move the file to 'uploads/gpx'. |
| [63](#L63) | $result = wp\_handle\_upload( $uploadedfile , $upload\_overrides); |
| [64](#L64) |  |
| [65](#L65) | // Set everything back to normal. |
| [66](#L66) | remove\_filter( 'upload\_dir', 'wpgpxmaps\_181088\_upload\_dir' ); |
| [67](#L67) |  |
| [68](#L68) | if ( $result && isset( $result['error'] )) |
| [69](#L69) | { |
| [70](#L70) | echo "<div class='notice notice-error'><p>". esc\_html( $result['error'] )."</p></div>"; |
| [71](#L71) | } |
| [72](#L72) |  |
| [73](#L73) | return ( $result && !isset( $result['error'] )); |
| [74](#L74) |  |
| [75](#L75) | } |
| [76](#L76) |  |
| [77](#L77) |  |
| [78](#L78) | /\* The First Div (for body) starts in wp-gpx-admin.php \*/ |
| [79](#L79) |  |
| [80](#L80) | if ( isset( $\_POST['clearcache'] ) ) { |
| [81](#L81) |  |
| [82](#L82) | if ( isset( $\_GET['\_wpnonce'] ) && wp\_verify\_nonce( sanitize\_text\_field( $\_GET['\_wpnonce'] ), 'wpgpx\_clearcache\_nonce' . $entry ) ) { |
| [83](#L83) |  |
| [84](#L84) | echo '<div class="notice notice-success"><p>'; |
| [85](#L85) | esc\_html\_e( 'Cache is now empty!', 'wp-gpx-maps' ); |
| [86](#L86) | echo '</p></div>'; |
| [87](#L87) | wpgpxmaps\_recursive\_remove\_directory( $cacheGpxPath, true ); |
| [88](#L88) |  |
| [89](#L89) | } |
| [90](#L90) | } |
| [91](#L91) |  |
| [92](#L92) | if ( is\_writable( $realGpxPath ) ) { |
| [93](#L93) | ?> |
| [94](#L94) |  |
| [95](#L95) | <div class="tablenav-top"> |
| [96](#L96) |  |
| [97](#L97) | <?php |
| [98](#L98) | echo '<form enctype="multipart/form-data" method="POST" style="float:left; margin:5px 20px 0 0" action="' . esc\_url( get\_bloginfo( 'wpurl' ) . '/wp-admin/' . $menu\_root . '?page=WP-GPX-Maps' ) . '">'; |
| [99](#L99) | ?> |
| [100](#L100) | <?php esc\_html\_e( 'Choose a file to upload:', 'wp-gpx-maps' ); ?> |
| [101](#L101) | <input name="wpgpxmapsuploadedfile[]" type="file" onchange="submitgpx(this);" multiple /> |
| [102](#L102) | <?php |
| [103](#L103) |  |
| [104](#L104) | if (isset($\_FILES['wpgpxmapsuploadedfile'])) { |
| [105](#L105) |  |
| [106](#L106) | $uploaded\_files = $\_FILES['wpgpxmapsuploadedfile']; |
| [107](#L107) | $upload\_dir = wp\_upload\_dir(); |
| [108](#L108) | $custom\_dir = $upload\_dir['basedir'] . '/gpx'; |
| [109](#L109) |  |
| [110](#L110) | // Ensure the directory exists |
| [111](#L111) | if (!is\_dir($custom\_dir)) { |
| [112](#L112) | wp\_mkdir\_p($custom\_dir); |
| [113](#L113) | } |
| [114](#L114) |  |
| [115](#L115) | // Loop through each uploaded file |
| [116](#L116) | foreach ($uploaded\_files['name'] as $key => $value) { |
| [117](#L117) | if ($uploaded\_files['name'][$key]) { |
| [118](#L118) |  |
| [119](#L119) | $file = array( |
| [120](#L120) | 'name'     => $uploaded\_files['name'][$key], |
| [121](#L121) | 'type'     => $uploaded\_files['type'][$key], |
| [122](#L122) | 'tmp\_name' => $uploaded\_files['tmp\_name'][$key], |
| [123](#L123) | 'error'    => $uploaded\_files['error'][$key], |
| [124](#L124) | 'size'     => $uploaded\_files['size'][$key] |
| [125](#L125) | ); |
| [126](#L126) |  |
| [127](#L127) | $uploadingFileName = basename( $file['name'] ); |
| [128](#L128) | if ( preg\_match( $gpxRegEx, $uploadingFileName ) ) { |
| [129](#L129) |  |
| [130](#L130) | if ( wpgpxmaps\_move\_uploaded\_file( $file ) ) { |
| [131](#L131) |  |
| [132](#L132) | echo '<div class="notice notice-success"><p>'; |
| [133](#L133) | printf( |
| [134](#L134) | /\* translators: %1s: GPX file name \*/ |
| [135](#L135) | esc\_html\_\_( 'The file %1s has been successfully uploaded.', 'wp-gpx-maps' ), |
| [136](#L136) | '<span class="code"><strong>' . esc\_html( $uploadingFileName ) . '</strong></span>' |
| [137](#L137) | ); |
| [138](#L138) | echo '</p></div>'; |
| [139](#L139) |  |
| [140](#L140) | } else { |
| [141](#L141) |  |
| [142](#L142) | echo '<div class=" notice notice-error"><p>'; |
| [143](#L143) | esc\_html\_e( 'There was an error uploading the file, please try again!', 'wp-gpx-maps' ); |
| [144](#L144) | echo '</p></div>'; |
| [145](#L145) |  |
| [146](#L146) | } |
| [147](#L147) | } else { |
| [148](#L148) |  |
| [149](#L149) | echo '<div class="notice notice-warning"><p>'; |
| [150](#L150) | esc\_html\_e( 'The file type is not supported!', 'wp-gpx-maps' ); |
| [151](#L151) | echo '</p></div>'; |
| [152](#L152) |  |
| [153](#L153) | } |
| [154](#L154) |  |
| [155](#L155) | } |
| [156](#L156) | } |
| [157](#L157) |  |
| [158](#L158) | // Remove the override to avoid affecting other uploads |
| [159](#L159) | remove\_filter('upload\_dir', 'custom\_upload\_dir'); |
| [160](#L160) | } |
| [161](#L161) |  |
| [162](#L162) |  |
| [163](#L163) | ?> |
| [164](#L164) | </form> |
| [165](#L165) |  |
| [166](#L166) | <form method="POST" style="float:left; margin:5px 20px 0 0" action="<?php echo esc\_url( $wpgpxmapsUrl . '&\_wpnonce=' . wp\_create\_nonce( 'wpgpx\_clearcache\_nonce' ) ); ?>" > |
| [167](#L167) | <input type="submit" name="clearcache" value="<?php esc\_html\_e( 'Clear Cache', 'wp-gpx-maps' ); ?>" /> |
| [168](#L168) | </form> |
| [169](#L169) |  |
| [170](#L170) | </div> |
| [171](#L171) |  |
| [172](#L172) | <?php |
| [173](#L173) |  |
| [174](#L174) | } else { |
| [175](#L175) | ?> |
| [176](#L176) | <br /> |
| [177](#L177) |  |
| [178](#L178) | <?php |
| [179](#L179) |  |
| [180](#L180) | echo '<div class=" notice notice-error"><p>'; |
| [181](#L181) | printf( |
| [182](#L182) | /\* translators: %1s: Relative path of the GPX folder \*/ |
| [183](#L183) | esc\_html\_\_( 'Your folder for GPX files %1s is not writable. Please change the folder permissions.', 'wp-gpx-maps' ), |
| [184](#L184) | '<span class="code"><strong>' . esc\_html( $relativeGpxPath ) . '</strong></span>' |
| [185](#L185) | ); |
| [186](#L186) | echo '</p></div>'; |
| [187](#L187) |  |
| [188](#L188) | ?> |
| [189](#L189) |  |
| [190](#L190) | <br /> |
| [191](#L191) |  |
| [192](#L192) | <?php |
| [193](#L193) | } |
| [194](#L194) |  |
| [195](#L195) | $myGpxFileNames = array(); |
| [196](#L196) | if ( is\_readable( $realGpxPath ) && $handle = opendir( $realGpxPath ) ) { |
| [197](#L197) | while ( false !== ( $entry = readdir( $handle ) ) ) { |
| [198](#L198) | if ( preg\_match( $gpxRegEx, $entry ) ) { |
| [199](#L199) | if ( isset( $\_GET['\_wpnonce'] ) && wp\_verify\_nonce( sanitize\_text\_field( $\_GET['\_wpnonce'] ), 'wpgpx\_deletefile\_nonce\_' . $entry ) ) { |
| [200](#L200) | if ( file\_exists( $realGpxPath . '/' . $entry ) ) { |
| [201](#L201) | unlink( $realGpxPath . '/' . $entry ); |
| [202](#L202) |  |
| [203](#L203) | echo '<div class="notice notice-success"><p>'; |
| [204](#L204) | printf( |
| [205](#L205) | /\* translators: %1s: GPX file name \*/ |
| [206](#L206) | esc\_html\_\_( 'The file %1s has been successfully deleted.', 'wp-gpx-maps' ), |
| [207](#L207) | '<span class="code"><strong>' . esc\_html( $entry ) . '</strong></span>' |
| [208](#L208) | ); |
| [209](#L209) | echo '</p></div>'; |
| [210](#L210) |  |
| [211](#L211) | } else { |
| [212](#L212) |  |
| [213](#L213) | echo '<div class=" notice notice-error"><p>'; |
| [214](#L214) | printf( |
| [215](#L215) | /\* translators: %1s: GPX file name \*/ |
| [216](#L216) | esc\_html\_\_( 'The file %1s could not be deleted.', 'wp-gpx-maps' ), |
| [217](#L217) | '<span class="code"><strong>' . esc\_html( $entry ) . '</strong></span>' |
| [218](#L218) | ); |
| [219](#L219) | echo '</p></div>'; |
| [220](#L220) |  |
| [221](#L221) | } |
| [222](#L222) | } else { |
| [223](#L223) |  |
| [224](#L224) | $myFile           = $realGpxPath . '/' . $entry; |
| [225](#L225) | $myGpxFileNames[] = array( |
| [226](#L226) | 'name'     => $entry, |
| [227](#L227) | 'size'     => filesize( $myFile ), |
| [228](#L228) | 'lastedit' => filemtime( $myFile ), |
| [229](#L229) | 'nonce'    => wp\_create\_nonce( 'wpgpx\_deletefile\_nonce\_' . $entry ), |
| [230](#L230) | ); |
| [231](#L231) | } |
| [232](#L232) | } |
| [233](#L233) | } |
| [234](#L234) | closedir( $handle ); |
| [235](#L235) | } |
| [236](#L236) |  |
| [237](#L237) | if ( is\_readable( $realGpxPath ) && $handle = opendir( $realGpxPath ) ) { |
| [238](#L238) | while ( false !== ( $entry = readdir( $handle ) ) ) { |
| [239](#L239) | if ( preg\_match( $gpxRegEx, $entry ) ) { |
| [240](#L240) | $filenames[] = $realGpxPath . '/' . $entry; |
| [241](#L241) | } |
| [242](#L242) | } |
| [243](#L243) | closedir( $handle ); |
| [244](#L244) | } |
| [245](#L245) |  |
| [246](#L246) | ?> |
| [247](#L247) |  |
| [248](#L248) | <table id="table" class="wp-list-table widefat plugins"></table> |
| [249](#L249) |  |
| [250](#L250) | <script type="text/javascript"> |
| [251](#L251) |  |
| [252](#L252) | function submitgpx(el){ |
| [253](#L253) | var newEl = document.createElement('span'); |
| [254](#L254) | newEl.innerHTML = '<?php esc\_html\_e( 'Uploading file...', 'wp-gpx-maps' ); ?>'; |
| [255](#L255) | el.parentNode.insertBefore(newEl,el.nextSibling); |
| [256](#L256) | el.parentNode.submit() |
| [257](#L257) | } |
| [258](#L258) |  |
| [259](#L259) | jQuery('#table').bootstrapTable({ |
| [260](#L260) | columns: [{ |
| [261](#L261) | field: 'name', |
| [262](#L262) | title: '<?php esc\_html\_e( 'File', 'wp-gpx-maps' ); ?>', |
| [263](#L263) | sortable: true, |
| [264](#L264) | formatter: function(value, row, index) { |
| [265](#L265) |  |
| [266](#L266) | return [ |
| [267](#L267) | '<b>' + row.name + '</b><br />', |
| [268](#L268) | '<a class="delete\_gpx\_row" href="<?php echo esc\_url( $wpgpxmapsUrl ); ?>&\_wpnonce=' + row.nonce + '" ><?php esc\_html\_e( 'Delete', 'wp-gpx-maps' ); ?></a>', |
| [269](#L269) | ' | ', |
| [270](#L270) | '<a href="<?php echo esc\_url( $relativeGpxPath ); ?>' + row.name + '"><?php esc\_html\_e( 'Download', 'wp-gpx-maps' ); ?></a>', |
| [271](#L271) | ' | ', |
| [272](#L272) | '<a href="#" class="copy-shortcode" title="<?php esc\_html\_e( 'Copy shortcode', 'wp-gpx-maps' ); ?>"><?php esc\_html\_e( 'Shortcode:', 'wp-gpx-maps' ); ?></a> <span class="code"> [sgpx gpx="<?php echo esc\_url( $relativeGpxPath ); ?>' + row.name + '"]</span>', |
| [273](#L273) | ].join('') |
| [274](#L274) |  |
| [275](#L275) | } |
| [276](#L276) | }, { |
| [277](#L277) | field: 'lastedit', |
| [278](#L278) | title: '<?php esc\_html\_e( 'Last modified', 'wp-gpx-maps' ); ?>', |
| [279](#L279) | sortable: true, |
| [280](#L280) | formatter: function(value, row, index) { |
| [281](#L281) | var d = new Date(value\*1000); |
| [282](#L282) | return d.toLocaleDateString() + " " + d.toLocaleTimeString(); |
| [283](#L283) | } |
| [284](#L284) | }, { |
| [285](#L285) | field: 'size', |
| [286](#L286) | title: '<?php esc\_html\_e( 'File size', 'wp-gpx-maps' ); ?>', |
| [287](#L287) | sortable: true, |
| [288](#L288) | formatter: function(value, row, index) { return humanFileSize(value); } |
| [289](#L289) | }], |
| [290](#L290) | sortName : 'lastedit', |
| [291](#L291) | sortOrder : 'desc', |
| [292](#L292) | data: <?php echo wp\_json\_encode( $myGpxFileNames ); ?> |
| [293](#L293) | }); |
| [294](#L294) |  |
| [295](#L295) | jQuery('.delete\_gpx\_row').click(function(){ |
| [296](#L296) | return confirm("<?php esc\_html\_e( 'Are you sure you want to delete the file?', 'wp-gpx-maps' ); ?>"); |
| [297](#L297) | }) |
| [298](#L298) |  |
| [299](#L299) | jQuery('.copy-shortcode').click(function(e){ |
| [300](#L300) | var $temp = jQuery("<input>"); |
| [301](#L301) | jQuery("body").append($temp); |
| [302](#L302) | var shortcode = jQuery(this).next().text().trim(); |
| [303](#L303) | $temp.val(shortcode).select(); |
| [304](#L304) | document.execCommand("copy"); |
| [305](#L305) | $temp.remove(); |
| [306](#L306) | e.preventDefault(); |
| [307](#L307) | }) |
| [308](#L308) |  |
| [309](#L309) | function humanFileSize(bytes, si) { |
| [310](#L310) | var thresh = si ? 1000 : 1024; |
| [311](#L311) | if(Math.abs(bytes) < thresh) { |
| [312](#L312) | return bytes + ' B'; |
| [313](#L313) | } |
| [314](#L314) | var units = si |
| [315](#L315) | ? ['kB','MB','GB','TB','PB','EB','ZB','YB'] |
| [316](#L316) | : ['KiB','MiB','GiB','TiB','PiB','EiB','ZiB','YiB']; |
| [317](#L317) | var u = -1; |
| [318](#L318) | do { |
| [319](#L319) | bytes /= thresh; |
| [320](#L320) | ++u; |
| [321](#L321) | } while(Math.abs(bytes) >= thresh && u < units.length - 1); |
| [322](#L322) | return bytes.toFixed(1)+' '+units[u]; |
| [323](#L323) | }; |
| [324](#L324) |  |
| [325](#L325) | </script> |
| [326](#L326) |  |
| [327](#L327) | </div> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wp-gpx-maps/trunk/wp-gpx-maps-admin-tracks.php?format=txt)
* [Original Format](/export/3220756/wp-gpx-maps/trunk/wp-gpx-maps-admin-tracks.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_d9fe4c81_20250111_151024.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

WP GPX Maps

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-gpx-maps&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-gpx-maps&locale=en_US)

Search plugins

![](https://ps.w.org/wp-gpx-maps/assets/banner-772x250.jpg?rev=539412)
![](https://s.w.org/plugins/geopattern-icon/wp-gpx-maps_bcbfb3.svg)
# WP GPX Maps

By [Bastianon Massimo](http://www.devfarm.it/)

[Download](https://downloads.wordpress.org/plugin/wp-gpx-maps.1.7.10.zip)

* [Details](https://wordpress.org/plugins/wp-gpx-maps/#description)
* [Reviews](https://wordpress.org/plugins/wp-gpx-maps/#reviews)
* [Installation](https://wordpress.org/plugins/wp-gpx-maps/#installation)
* [Development](https://wordpress.org/plugins/wp-gpx-maps/#developers)

[Support](https://wordpress.org/support/plugin/wp-gpx-maps/)

## Description

This plugin has, as input, the GPX file with the track you’ve made and as output it shows the map of the track and an interactive altitude graph (where available).

**Fully configurable:**

* Custom colors
* Custom icons
* Multiple language support

**Supported charts:**

* Altitude
* Speed
* Heart rate
* Temperature
* Cadence
* Grade

**NextGen Gallery Integration:**

Display your NextGen Gallery images inside the map!

Even if you don’t have a GPS camera, this plugin can retrive the image position starting from the image date and your GPX file.

**Post Attachments Integration:**

This version is extended by: [Stephan Klein](https://klein-gedruckt.de/2015/03/wordpress-plugin-wp-gpx-maps/) and supports displaying all images attached to a post without using NGG.

Try this plugin: <https://devfarm.it/wp-gpx-maps-demo/>

**Support:**

If you need help, please use: [www.devfarm.it Support Forum](http://www.devfarm.it/forums/forum/wp-gpx-maps/)

Would you like to help fix bugs or further develop the plugin? On [Github](https://github.com/devfarm-it/wp-gpx-maps) you can contribuite easly with your code.

**Translations:**

Translators are welcome to contribute to the plugin. Please use the [WordPress translation website](https://translate.wordpress.org/projects/wp-plugins/wp-gpx-maps/%29).

The language files in the plugin contain 18 translatable texts for 13 languages:

* Catalan ca
* Dutch nl\_NL
* English (default)
* French fr\_FR
* Hungarian hu\_HU
* Italian it\_IT
* Norwegian nb\_NO
* Polish pl\_PL
* Portuguese (Brazilian) pt\_BR
* Russian ru\_RU
* Spanish es\_ES
* Swedish sv\_SE
* Turkish tr\_TR
* Bulgarian bg\_BG
* Slovak cs\_CZ
* Norwegian nb\_NO
* Japanese ja\_JP

(Many thanks to all guys who helped me with the translations)

**Supported GPX namespaces are:**

1. http://www.topografix.com/GPX/1/0
2. [www.topografix.com/GPX/1/1](http://www.topografix.com/GPX/1/1)
3. http://www.garmin.com/xmlschemas/GpxExtensions/v3
4. http://www.garmin.com/xmlschemas/TrackPointExtension/v1

Thanks to: [www.securcube.net](http://www.securcube.net/), [www.devfarm.it](http://www.devfarm.it/)

Icons made by [Freepik](https://www.freepik.com/) from [www.flaticon.com](https://www.flaticon.com/) is licensed by [Creative Commons BY 3.0](http://creativecommons.org/licenses/by/3.0/)

## Screenshots

* [![](https://ps.w.org/wp-gpx-maps/trunk/screenshot-1.jpg?rev=3217023)](https://ps.w.org/wp-gpx-maps/trunk/screenshot-1.jpg?rev=3217023)

  Simple GPX
* [![](https://ps.w.org/wp-gpx-maps/trunk/screenshot-2.jpg?rev=3217023)](https://ps.w.org/wp-gpx-maps/trunk/screenshot-2.jpg?rev=3217023)

  GPX with waypoints
* [![](https://ps.w.org/wp-gpx-maps/trunk/screenshot-3.jpg?rev=3217023)](https://ps.w.org/wp-gpx-maps/trunk/screenshot-3.jpg?rev=3217023)

  Admin area – List of tracks
* [![](https://ps.w.org/wp-gpx-maps/trunk/screenshot-4.jpg?rev=3217023)](https://ps.w.org/wp-gpx-maps/trunk/screenshot-4.jpg?rev=3217023)

  Admin area – Settings
* [![](https://ps.w.org/wp-gpx-maps/trunk/screenshot-5.jpg?rev=3217023)](https://ps.w.org/wp-gpx-maps/trunk/screenshot-5.jpg?rev=3217023)

  Altitude & Speed
* [![](https://ps.w.org/wp-gpx-maps/trunk/screenshot-6.jpg?rev=3217023)](https://ps.w.org/wp-gpx-maps/trunk/screenshot-6.jpg?rev=3217023)

  Altitude & Speed & Heart rate

## Installation

1. Use the classic wordpress plugin installer or copy the plugins folder to the `/wp-content/plugins/` directory
2. Activate the plugin through the ‘Plugins’ menu in WordPress
3. Add the shortcode [sgpx gpx=”>relative path to your gpx<“] or [sgpx gpx=”>http://somesite.com/files/yourfile.gpx<“]

## FAQ

### Which map types are available?

You can use the following map types:

1. **OSM1** = Open Street Map (Default setting)
2. **OSM2** = Open Cycle Map / Thunderforest – Open Cycle Map (API Key required)
3. **OSM3** = Thunderforest – Outdoors (API Key required)
4. **OSM4** = Thunderforest – Transport (API Key required)
5. **OSM5** = Thunderforest – Landscape (API Key required)
6. **OSM7** = Open Street Map – Humanitarian map style
7. **OSM9** = Hike & Bike
8. **OSM10** = Open Sea Map

If you use the OpenCycleMap without the API key, a watermark appears on the card: “API Key required”.

The Thunderforest maps Outdoors, Transport and Landscape are only displayed with an API Key.

### Which shortcode attributes are available?

You can use the following shortcodes:

1. **gpx:** Relative path to the GPX file
2. **width:** Map width (Value in percent)
3. **mheight:** Map height (Value in pixeln)
4. **gheight:** Graph height (Value in pixeln)
5. **skipcache:** Do not use cache. If TRUE might be very slow (Default is false)
6. **download:** Allow users to download your GPX file (Default is false)
7. **summary:** Print summary details of your GPX track (Default is false)
8. **summarytotlen:** Print total distance in summary table (Default is false)
9. **summarymaxele:** Print max elevation in summary table (Default is false)
10. **summaryminele:** Print min Elevation in summary table (Default is false)
11. **summaryeleup:** Print total climbing in summary table (Default is false)
12. **summaryeledown:** Print total descent in summary table (Default is false)
13. **summaryavgspeed:** Print average Speed in summary table (Default is false)
14. **summarytotaltime:** Print total time in summary table (Default is false)
15. **mtype:** Map types
16. **mlinecolor:** Map line color (Default is #3366cc)
17. **zoomonscrollwheel:** Zoom on map when mouse scroll wheel (Default is false)
18. **waypoints:** Print the gpx waypoints inside the map (Default is false)
19. **startIcon:** Start track icon
20. **endIcon:** End track icon
21. **currentIcon:** Current position icon (when mouse hover)
22. **waypointicon:** Custom waypoint icon
23. **showele:** Show elevation data inside the chart (Default is true)
24. **uom:** Distance/altitude unit of measure
25. 0 = meters/meters (Default setting)
26. 1 = feet/miles
27. 2 = meters/kilometers
28. 3 = meters/nautical miles
29. 4 = meters/miles
30. 5 = feet/nautical miles
31. **glinecolor:** Altitude line color (Default is #3366cc)
32. **chartFrom1:** Minimun value for altitude chart
33. **chartTo1:** Maxumin value for altitude chart
34. **showspeed:** Show speed inside the chart (Default is false)
35. **glinecolorspeed:** Speed line color (Default is #ff0000)
36. **uomspeed:** Unit of measure for speed
37. 0 = m/s (Default setting)
38. 1 = km/h
39. 2 = miles/h
40. 3 = min/km
41. 4 = min/miles
42. 5 = Nautical Miles/Hour (Knots)
43. 6 = min/100 meters
44. **chartFrom2:** Minimun value for speed chart
45. **chartTo2:** Maxumin value for speed chart
46. **showhr:** Show heart rate inside the chart (Default is false)
47. **glinecolorhr:** Heart rate line color (Default is #ff77bd)
48. **showatemp:** Show temperature inside the chart (Default is false)
49. **glinecoloratemp:** Temperature line color (Default is #ff77bd)
50. **showcad:** Show cadence inside the chart (Default is false)
51. **glinecolorcad:** Cadence line color (Default is #beecff)
52. **showgrade:** Show grade inside the chart (Default is false)
53. **glinecolorgrade:** Grade line color (Default is #beecff)
54. **nggalleries:** NextGen Gallery id or a list of Galleries id separated by a comma
55. **ngimages:** NextGen Image id or a list of Images id separated by a comma
56. **attachments:** Show all images that are attached to post (Default is false)
57. **dtoffset:** The difference (in seconds) between your gpx tool date and your camera date
58. **pointsoffset:** Skip points closer than XX meters (Default is 10)
59. **donotreducegpx:** Print all the point without reduce it (Default is false)

### What happening if I’ve a very large GPX files?

This plugin will print a small amout of points to speedup javascript and pageload.

### Is it free?

Yes!

## Reviews

![](https://secure.gravatar.com/avatar/6809d744b1d6e8443076f6afbcd821c093a7f7979bc5c9171ccaa4127ad86103?s=60&d=retro&r=g)
### [test your updates better](https://wordpress.org/support/topic/test-your-updates-better/)

[sjoerd72](https://profiles.wordpress.org/sjoerd72/ "Posts by sjoerd72")
April 15, 2024

Great plugin but please – test better – you should test with tracks that do not have time/date/elevation per point.
Please update wp-gpx-maps-utils.php (lines 379 – 383):
$points->maxEle = (count($\_ele) > 0 ? max( $\_ele ) : 0);
$points->minEle = (count($\_ele) > 0 ? min( $\_ele ) : 0);
$points->totalLength = max( $\_dist );
$points->maxTime = (count($\_time) > 0 ? max( $\_time ) : 0);
$points->minTime = (count($\_time) > 0 ? min( $\_time ) : 0);
If tracks do not contains times(speed) or elevation the code breaks

![](https://secure.gravatar.com/avatar/aea490109c19b67f23dcf2958680779e0a07f921d6f55e5ba4f42154d2f427bd?s=60&d=retro&r=g)
### [TOP](https://wordpress.org/support/topic/top-1616/)

[alpencross](https://profiles.wordpress.org/alpencross/ "Posts by alpencross")
March 28, 2024

Ich nutze Sie auf meinem Alpencross Block und bin total begeistert!

![](https://secure.gravatar.com/avatar/12bca2419bff1803078f590ef0bca517195742cce080cd8019da744411e3b6d1?s=60&d=retro&r=g)
### [Was not no more – exactly what I needed to display routes](https://wordpress.org/support/topic/fantastic-exactly-what-i-needed-to-display-routes/)

[deepmill](https://profiles.wordpress.org/deepmill/ "Posts by deepmill")
August 3, 2022

This plugin is easy to use.
After cycling I download the gpx cycle route from my bike nav device and then upload to my cycle route site Zozibike.com. to display the route.
developer keeps up with updates and have always been stable.
Update: it now does not work and its been 3 weeks and no updates
does not work with PHP8

![](https://secure.gravatar.com/avatar/38415e89f51a22d44bf961feed80a67dd8fa02337b0cd5c4078b217905db8881?s=60&d=retro&r=g)
### [Once one of the best plugins but…](https://wordpress.org/support/topic/once-one-of-the-best-plugins-but/)

[stefanprobst](https://profiles.wordpress.org/stefanprobst/ "Posts by stefanprobst")
August 2, 2022
3 replies

each new version introduces so many new bugs that causes outages 🙁
This is the only plugin that I avoid to update as the old version is AWESOME.

![](https://secure.gravatar.com/avatar/bb5529282f578718b9feb9527b6e364e7a2814439814548ed8d51fbe06da2363?s=60&d=retro&r=g)
### [Superbe plugin Gps](https://wordpress.org/support/topic/superbe-plugin-gps/)

[michcro21](https://profiles.wordpress.org/michcro21/ "Posts by michcro21")
February 25, 2022

Excellent, c’est ce qui me fallait pour afficher les parcours club du “Quimper Cyclo Club”.
Merci

![](https://secure.gravatar.com/avatar/73a29ed6aad244e54333879a9795ce0768da66414381c4ee073e56a8af83eb73?s=60&d=retro&r=g)
### [Finally it’s working again](https://wordpress.org/support/topic/finally-its-working-again/)

[camperxr](https://profiles.wordpress.org/camperxr/ "Posts by camperxr")
February 2, 2022

Best plugin to show my bike trail.
And it’s free!
Bravo!

[Read all 56 reviews](https://wordpress.org/support/plugin/wp-gpx-maps/reviews/)
## Contributors & Developers

“WP GPX Maps” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/9deb7de2f5416eeb213748c58ec9ff8531eb55bad6aa19985ecc6fa802839be7?s=32&d=mm&r=g) [bastianonm](https://profiles.wordpress.org/bastianonm/)
* ![](https://secure.gravatar.com/avatar/df1bd553a6f688096fc739091d7fd68d52812283d0ca2175b11a1f4b5da81146?s=32&d=mm&r=g) [Kniebremser](https://profiles.wordpress.org/kniebremser/)

“WP GPX Maps” has been translated into 2 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/wp-gpx-maps/contributors) for their contributions.

[Translate “WP GPX Maps” into your language.](https://translate.wordpress.org/projects/wp-plugins/wp-gpx-maps)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/wp-gpx-maps/), check out the [SVN repository](https://plugins.svn.wordpress.org/wp-gpx-maps/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/wp-gpx-maps/) by [RSS](https://plugins.trac.wordpress.org/log/wp-gpx-maps/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 1.7.10

* Fix security issues

#### 1.7.06

* Fix vulnerability

#### 1.7.05

* Fix NextGen warnings

#### 1.7.04

* Fix php8+ errors

#### 1.7.03

* fix download file link
* fix error with images exif parsing

#### 1.7.02

* fix admin error

#### 1.7.01

* General: Removed Maptoolkit (code OSM6) map provider. Requested by H.F. (Maptoolkit Managing director)
* General: Added new map type “Thunderforest – Outddors” (OSM3)
* Admin: Added admin notices in the dashboard
* Settings Tab: In the map selection changed to the correct maps provider from “Open Cycle Map”\* Settings Tab: to “Thunderforest”
* Administration Tab: New Tab with the settings “Editor & Author upload” and “Show update notice”
* Help Tab: In the map selection changed to the correct maps provider from “Open Cycle Map” to “Thunderforest”
* Output: In the map selection changed to the correct maps provider from “Open Cycle Map” to “Thunderforest”
* Output: Fixed in map footer for each map, the corresponding map provider is displayed with URL
* Code: Added PHP version notices, WordPress 5.3 requires PHP 5.6.20
* Code: Added Missing entries for add and delete options
* Code: Style for output moved in a seperate CSS file
* Code: Adjustments a la WPCS
* Code: Small CSS design optimizations for the tabs
* Code: Upgrade bootstrap-table to 1.13.2
* Code: Removed german language file (now over translate.wordpress.org)

#### 1.7.00

* Added: Authors can upload GPX tracks in a folder called as *your user name*, inside [../wp-upload dir/gpx/[*your user name*] (thanks to wildcomputations)
* Added: Authors an Admins can see the current values for shortcodes in help tab
* Added: Button to instant copy the shortcode of the selected GPX file in the tab track
* Added: different size logos for the plugin store (icon.svg, icon128x128.png and icon256x256.png) [inside ../plugins/wp-gpx-maps/assets]
* Changed: Settings tab is for non-Admin users is not more visible
* Tweak: Help tab is easier to read
* Tweak: Plugin is now complete translatable (Backend + Frontend)
* Tweak: WordPress coding standards
* Upgrade: Leaflet to 1.5.1
* Upgrade: leaflet.fullscreen to 1.4.5
* Upgrade: Chart.min.js to 2.8.0

#### 1.6.07

* resolve admin error

#### 1.6.06

* Added average values under the graph (thanks to cyclinggeorgian)

#### 1.6.04

* NGG gallery is working
* Getting HR, Cad and Temp working again (thanks to cyclinggeorgian)
* Fix javascript errors
* Fix multiple traks gpx

#### 1.6.03

* Fix syntax error causing graph not to display (thanks to nickstabler)

#### 1.6.02

* Resolved errors with start and end icons

#### 1.6.01

* Removed Gogole maps. Leafletjs instead.
* — NextGen Gallery is not working, due next gen image format changed — I’ll fix soon

#### 1.5.05

* renamed javascript functions to avoid collision with other plugins
* reduced chart line thickness

#### 1.5.04

* fix uom
* fix file not found

#### 1.5.03

* fix random error

#### 1.5.02

* Security improvements

#### 1.5.01

* Improved security
* Included javascript
* Multiple file upload
* Implemented sorting in file list
* Renamed internal function to improve wp compatibility

#### 1.5.00

* replaced highcharts with chartjs. This is a forced choice due highcharts license issue, view: https://devfarm.it/wordpress-plugin/wordpress-plugin-directory-notice-wp-gpx-maps-temporarily-disabled/

#### 1.3.16

* Added Norwegian nb\_NO translation (thanks to thordivel)
* Added Japanese ja\_JP translation (thanks to dentos)

#### 1.3.15

* Switched to HTTPS where possible (thanks to delitestudio)

#### 1.3.14

* Added Thunderforest Api Key on settings: for OpenCycleMap

#### 1.3.13

* Added google maps api key on settings
* Removed parameter ‘sensor’ on google maps js
* Added unit of measure of speed for swimmers: min/100 meters

#### 1.3.12

* Fix incompatibility with Debian PHP7 (thanks to phbaer) https://github.com/devfarm-it/wp-gpx-maps/pull/5

#### 1.3.10

* Improved german translations (thanks to Konrad) http://tadesse.de/7882/2015-wanderung-ostrov-tisa-ii/

#### 1.3.9

* Retrieve waypoints in JSON, possibility to add a custom marker (Changed by Michel Selerin)

#### 1.3.8

* Improved Google Maps visualization

#### 1.3.7

* NextGen Gallery’s Attachment support. Thanks to Stephan Klein (https://klein-gedruckt.de/2015/03/wordpress-plugin-wp-gpx-maps/)

#### 1.3.6

* Fix: remote file download issue
* Fix: download file link with WPML
* Improved cache with filetime (thanks to David)

#### 1.3.5

* Fix: Garmin cadence again
* Fix: WP Tabs

#### 1.3.4

* Fix: Garmin cadence
* Infowindows closing on mouseout

#### 1.3.3

* Add feet/Nautical Miles units (thanks to elperepat)
* Update OpenStreetMaps Credits
* WP Tabs fix

#### 1.3.2

* fix: left axis not visible (downgrade highcharts to v3.0.10)
* fix: fullscreen map js error

#### 1.3.1

* fix: http/https javascript registration
* fix: full screen map css issue

#### 1.3.0

* Speed improvement
* Rewritten js classes
* Added Temperature chart
* Added HTML5 Gps position (you can now follow the gpx with your mobile phone/tablet/pc)

#### 1.2.6

* Speed improvement

#### 1.2.5

* Added Catalan translation, thanks to Edgar
* Updated Spanish translation, thanks to Dani
* Added different types of distance: Normal, Flat (don’t consider altitude) and Climb distance

#### 1.2.4

* Added Bulgarian translation, thanks to Svilen Savov
* Added possibility to hide the elevation chart

#### 1.2.2

* Smaller map type selector
* Fix: Google maps exception for NextGen Gallery

#### 1.2.1

* Fix: NextGen Gallery 1.9 compatibility

#### 1.2.0

* NextGen Gallery 2 support
* NextGen Gallery Pro support

#### 1.1.46

* Added meters/miles chart unit of measure
* Added Russian translation, thanks to G.A.P

#### 1.1.45

* Added nautical miles as distance (Many thanks to Anders)

#### 1.1.44

* Added Chart zoom feature
* Some small bug fixes

#### 1.1.43

* Added Portuguese (Brazilian) translation, thanks to André Ramos
* new map: Open Cycle Map – Transport
* new map: Open Cycle Map – Landscape

#### 1.1.42

* qTranslate compatible

#### 1.1.41

* Added Polish translation, thanks to Sebastian
* Fix: Spanish translation
* Minor javascript improvement

#### 1.1.40

* Improved italian translation
* Added grade chart (beta)

#### 1.1.39

* Added French translation, thanks to Hervé
* Added Nautical Miles per Hour (Knots) unit of measure

#### 1.1.38

* Fix: garmin gpx cadence and heart rate
* Updated Turkish translation, thanks to Edip
* Added Hungarian translation, thanks to Tami

#### 1.1.36

* Even Editor and Author users can upload their own gpx. Administrators can see all the administrators gpx. The other users can see only their uploads

#### 1.1.35

* Fix: In the post list, sometime, the maps was not displaying correctly ( the php rand() function was not working?? )
* Various improvements for multi track gpx. Thanks to GPSracks.tv
* Summary table is now avaiable even without chart. Thanks to David

#### 1.1.34

* 2 decimals for unit of measure min/km and min/mi
* translation file updated (a couple of phrases added)
* File list reverse order (from the newer to the older)
* nggallery integration: division by zero fixed

#### 1.1.33

* Decimals reducted to 1 for unit of measure min/km and min/mi
* map zoom and center position is working with waypoints only files
* automatic scale works again (thanks to MArkus)

#### 1.1.32

* You can exclude cache (slower and not recommended)
* You can decide what show in the summary table
* German translation (thanks to Ali)

#### 1.1.31

* Fixed fullscreen map image slideshow

#### 1.1.30

* Multi track gpx support
* Next Gen Gallery images positions derived from date. You can adjust the date with the shortcode attribute dtoffset
* If you set Chart Height (shortcode gheight) = 0 means hide the graph
* Fix: All images should work, independent from browser cache

#### 1.1.29

* Decimal separator is working with all the browsers
* minutes per mile and minutes per kilometer was wrong

#### 1.1.28

* Decimal and thousand separator derived from browser language
* Added summary table (see settings): Total distance, Max elevation, Min elevation, Total climbing, Total descent, Average speed
* Added 2 speed units of measure: minutes per mile and minutes per kilometer

#### 1.1.26

* Multilanguage implementation (only front-end). I’ve implemented the italian one, I hope somebody will help me with other languages..
* Map Full screen mode (I’m sure it’s not working in ie6. don’t even ask!)
* Added waypoint custom icon

#### 1.1.25

* Added possibility to download your gpx

#### 1.1.23

* Security fix, please update!

#### 1.1.22

* enable map zoom on scroll wheel (check settings)
* test attributes in get params

#### 1.1.21

* google maps images fixed (templates with bad css)
* upgrade to google maps 3.9

#### 1.1.20

* google maps images fixed in [Yoko theme](https://wordpress.org/extend/themes/yoko)

#### 1.1.19

* include jQuery if needed

#### 1.1.17

* Remove zero values from cadence and heart rate charts
* nextgen gallery improvement

#### 1.1.16

* Cadence chart (where available)
* minor bug fixes

#### 1.1.15

* migration from google chart to highcharts. Highcharts are much better than google chart! This is the base for a new serie of improvements. Stay in touch for the next releases!
* heart rate chart (where available)

#### 1.1.14

* added css to avoid map bars display issue

#### 1.1.13

* added new types of maps: Open Street Map, Open Cycle Map, Hike & Bike.
* fixed nextgen gallery caching problem

#### 1.1.12

* nextgen gallery display bug fixes

## Meta

* Version **1.7.10**
* Last updated **7 days ago**
* Active installations **4,000+**
* WordPress version **6.2.0 or higher**
* Tested up to **6.7.1**
* Languages
  See all 3

  Close

  [English (US)](https://wordpress.org/plugins/wp-gpx-maps/), [German](https://de.wordpress.org/plugins/wp-gpx-maps/), and [Spanish (Spain)](https://es.wordpress.org/plugins/wp-gpx-maps/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/wp-gpx-maps)
* Tags [chart](https://wordpress.org/plugins/tags/chart/)[gps](https://wordpress.org/plugins/tags/gps/)[GPX](https://wordpress.org/plugins/tags/gpx/)[graph](https://wordpress.org/plugins/tags/graph/)[maps](https://wordpress.org/plugins/tags/maps/)
* [Advanced View](https://wordpress.org/plugins/wp-gpx-maps/advanced/)

## Ratings

4.2 out of 5 stars.

* [38 5-star reviews
  5 stars

  38](https://wordpress.org/support/plugin/wp-gpx-maps/reviews/?filter=5)
* [7 4-star reviews
  4 stars

  7](https://wordpress.org/support/plugin/wp-gpx-maps/reviews/?filter=4)
* [2 3-star reviews
  3 stars

  2](https://wordpress.org/support/plugin/wp-gpx-maps/reviews/?filter=3)
* [3 2-star reviews
  2 stars

  3](https://wordpress.org/support/plugin/wp-gpx-maps/reviews/?filter=2)
* [7 1-star reviews
  1 star

  7](https://wordpress.org/support/plugin/wp-gpx-maps/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/wp-gpx-maps/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/wp-gpx-maps/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/9deb7de2f5416eeb213748c58ec9ff8531eb55bad6aa19985ecc6fa802839be7?s=32&d=mm&r=g) [bastianonm](https://profiles.wordpress.org/bastianonm/)
* ![](https://secure.gravatar.com/avatar/df1bd553a6f688096fc739091d7fd68d52812283d0ca2175b11a1f4b5da81146?s=32&d=mm&r=g) [Kniebremser](https://profiles.wordpress.org/kniebremser/)
## Support

Issues resolved in last two months:

0 out of 4

[View support forum](https://wordpress.org/support/plugin/wp-gpx-maps/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=8VHWLRW6JBTML)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


