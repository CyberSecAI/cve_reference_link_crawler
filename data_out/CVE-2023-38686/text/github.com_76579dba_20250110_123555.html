
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fsydent%2Fsecurity%2Fadvisories%2FGHSA-p6hw-wm59-3g5g)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fsydent%2Fsecurity%2Fadvisories%2FGHSA-p6hw-wm59-3g5g)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=matrix-org%2Fsydent)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[matrix-org](/matrix-org)
/
**[sydent](/matrix-org/sydent)**
Public

* [Notifications](/login?return_to=%2Fmatrix-org%2Fsydent) You must be signed in to change notification settings
* [Fork
  84](/login?return_to=%2Fmatrix-org%2Fsydent)
* [Star
   307](/login?return_to=%2Fmatrix-org%2Fsydent)

* [Code](/matrix-org/sydent)
* [Issues
  49](/matrix-org/sydent/issues)
* [Pull requests
  5](/matrix-org/sydent/pulls)
* [Actions](/matrix-org/sydent/actions)
* [Projects
  0](/matrix-org/sydent/projects)
* [Security](/matrix-org/sydent/security)
* [Insights](/matrix-org/sydent/pulse)

Additional navigation options

* [Code](/matrix-org/sydent)
* [Issues](/matrix-org/sydent/issues)
* [Pull requests](/matrix-org/sydent/pulls)
* [Actions](/matrix-org/sydent/actions)
* [Projects](/matrix-org/sydent/projects)
* [Security](/matrix-org/sydent/security)
* [Insights](/matrix-org/sydent/pulse)

# Sydent does not verify email server certificates

Low

[DMRobertson](/DMRobertson)
published
GHSA-p6hw-wm59-3g5g
Jul 31, 2023

## Package

pip

matrix-sydent
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<2.5.5

## Patched versions

2.5.6

## Description

## Impact

If configured to send emails using TLS, Sydent does not verify SMTP servers' certificates. This makes Sydent's emails vulnerable to interception via a [man-in-the-middle (MITM) attack](https://en.wikipedia.org/wiki/Man-in-the-middle_attack). Attackers with privileged access to the network can intercept room invitations and address confirmation emails.

CVSS 3.1 overall score: 3.3 - [AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N/CR:L/IR:L/AR:X/MAV:A/MAC:H/MPR:N/MUI:N/MS:C/MC:L/MI:L/MA:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N/CR:L/IR:L/AR:X/MAV:A/MAC:H/MPR:N/MUI:N/MS:C/MC:L/MI:L/MA:N&version=3.1)

*Reported by Martin Schobert, [Pentagrid AG](https://pentagrid.ch/).*

### Details

Sydent can be configured to send emails over a TLS-encrypted socket by setting

```
email:
    tlsmode: "TLS"  # or the legacy value "SSL"
```

in its config file. Alternatively it can be configured to use [Opportunistic TLS](https://en.wikipedia.org/wiki/Opportunistic_TLS) by setting

```
email:
    tlsmode: "STARTTLS"
```

In both situations, Sydent will encrypt its communication with the SMTP server when sending emails. **In affected versions, Sydent will not verify the destination server's certificate.**

### Vulnerability

Sydent sends email for two purposes:

* to inform a third party that they have been invited to a Matrix room by their email address; and
* to verify that a given Matrix user controls an email address.

Therefore, attackers capable of running a MITM attack can

1. Intercept room invitations sent to an email address. The invitation includes
   * the room ID and its avatar, and
   * the inviter's username, displayname and their avatar, and
   * credentials for a guest Matrix account on the inviter's homeserver.
2. Intercept address ownership confirmation emails. This would allow the attacker to falsely claim ownership of the indented recipient's Matrix account, if that account was permitted to log in using an email address and no other authentication factors.

### Patches

This is patched in [Sydent 2.5.6](https://github.com/matrix-org/sydent/releases/tag/v2.5.6), see PR [#574](https://github.com/matrix-org/sydent/pull/574).

When patching, make sure that Sydent trusts the certificate of the server it is connecting to. This should happen automatically when using properly issued certificates. If you are using self-signed certificates, make sure to copy your Certification Authority certificate, or your self signed certificate if using only one, to the trust store of your operating system.

### Workarounds

One can ensure Sydent's emails fail to send by setting the configured SMTP server to a loopback or [non-routable](https://datatracker.ietf.org/doc/html/rfc1918#section-3) address under your control which does not have a listening SMTP server. For example:

```
email:
    smtphost: "localhost"  # Assuming there is no SMTP server listening on localhost
```
### References

* [#574](https://github.com/matrix-org/sydent/pull/574) implements the fix.
* <https://github.com/matrix-org/sydent/releases/tag/v2.5.6> is the release including this fix.
* <https://docs.python.org/3/library/ssl.html?highlight=ssl#security-considerations> details the best-practice advice on how to use the standard library `smtp` module safely.
* <https://peps.python.org/pep-0476/> (accepted) proposed enabling TLS certificate verification by default in standard library HTTP clients.
* [python/cpython#91826](https://github.com/python/cpython/issues/91826) discusses enabling TLS certificate verification by default in the Python standard library, for SMTP and other protocols.

## For more information

If you have any questions or comments about this advisory, e-mail us at security@matrix.org.

### Severity

Low

### CVE ID

CVE-2023-38686

### Weaknesses

[CWE-295](/advisories?query=cwe%3A295)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

