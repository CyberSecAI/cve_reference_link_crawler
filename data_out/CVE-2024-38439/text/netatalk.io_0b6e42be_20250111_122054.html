

[[main]](/ "Return to Netatalk home")
[[wiki]](/docs "Netatalk Wiki")
[[documentation]](/documentation.html "Netatalk Manual")
[[downloads]](/download.html "Download Netatalk")
[[support]](/support.html "Support")
[[links]](/links.html "Netatalk related links")
![](/gfx/end.gif)

# netatalk.io

## search netatalk.io

powered by Google

## current releases

* [Netatalk 4.0.8 (source code)](https://github.com/Netatalk/netatalk/releases/download/netatalk-4-0-8/netatalk-4.0.8.tar.xz "download 4.0.8 xz compressed source code")
* [Netatalk 4.0.8 (sha256sum)](https://github.com/Netatalk/netatalk/releases/download/netatalk-4-0-8/netatalk-4.0.8.tar.xz.sha256sum "download 4.0.8 checksum")
* [Webmin Module](https://github.com/Netatalk/netatalk/releases/download/netatalk-4-0-8/netatalk-4.0.8.wbm.gz "download 4.0.8 Webmin module")
* [Release Notes](/4.0/ReleaseNotes4.0.8.html "view 4.0.8 Release Notes")

## netatalk manual

[Table of Contents](/stable/htmldocs)

1. [Introduction](/stable/htmldocs/intro)
2. [Installation](/stable/htmldocs/installation)
3. [Configuration](/stable/htmldocs/configuration)
4. [AppleTalk](/stable/htmldocs/appletalk)
5. [Upgrading](/stable/htmldocs/upgrade)
6. [List of Manual Pages](/stable/htmldocs/man-pages)

1. [Appendix: Compile](/stable/htmldocs/compile)
2. [Appendix: License](/stable/htmldocs/gpl)

## community

* [Contribute to Wiki Pages](https://github.com/Netatalk/netatalk/wiki "Wiki")
* [Participate in Discussions](https://github.com/Netatalk/netatalk/discussions "Discussions")
* [Subscribe to Mailing Lists](https://sourceforge.net/p/netatalk/mailman/ "Mailing Lists")

## development

* [Code Repository](https://github.com/Netatalk/netatalk "Code Repository, GitHub")
* [GitLab Mirror](https://gitlab.com/netatalk-team/netatalk "Code Repository, GitLab")
* [How to Contribute](https://netatalk.io/docs/Developer-Notes.html "How to Contribute")
* [Static Analysis by SonarQube](https://sonarcloud.io/summary/overall?id=Netatalk_netatalk "Static Analysis")

## continuous integration

[![GitHub Continuous Integration Status](https://github.com/Netatalk/netatalk/actions/workflows/build.yml/badge.svg)](https://github.com/Netatalk/netatalk/actions/workflows/build.yml)

[![GitHub Continuous Integration Status](https://github.com/Netatalk/netatalk/actions/workflows/containers.yml/badge.svg)](https://github.com/Netatalk/netatalk/actions/workflows/containers.yml)

# Netatalk Security Advisory

**Subject**
Heap out-of-bounds write in uams\_pam.c
**CVE ID**
[CVE-2024-38439](https://www.cve.org/CVERecord?id=CVE-2024-38439)
**Date of Publishing**
2024/06/28
**Affected Netatalk Versions**
3.2.0
3.0.0 - 3.1.18
1.5.0 - 2.4.0
**Summary**
Lack of user input validation can lead to an out-of-bounds heap write
## Description

This vulnerability arises due to a lack of validation for the length field after parsing user-provided data,
leading to an out-of-bounds heap write of one byte (\0). Under specific configurations,
this can result in an out-of-bounds write to the metadata of the next heap block,
potentially allowing an attacker to execute code in the root context.

The vulnerability is located in the FPLoginExt operation of Netatalk's afpd daemon,
in the afp\_mapname function found in /etc/uams/uams\_pam.c. It may be triggered
when logging in with the Clear Text user authentication module.

The vulnerable code paths are thought to have been added in the version 1.5.0
release cycle of Netatalk.

## Patch Availability

Apply the patch with git hash
[77b5d99](https://github.com/Netatalk/netatalk/commit/77b5d99007cfef4d73d76fd6f0c26584891608e5.diff) to hotfix your local Netatalk deployment.

Additionally, Netatalk 2.4.1, 3.1.19, and 3.2.1 have been released which include the security patch.
Netatalk administrators are advised to upgrade to this version or apply the patch as soon as possible.

## CVSS Calculation

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L (7.3)

## Workaround

Disable the uams\_clrtxt.so authentication module in your afp.conf file.

## Credits

Vulnerability found and reported by:
flysoar
Patch developed by:
Daniel Markstedt of the Netatalk team

[Go back to Support](../support.html)

[![Valid XHTML 1.0 Strict](https://www.w3.org/Icons/valid-xhtml10)](https://validator.w3.org/check?uri=referer)
[![Valid CSS!](https://jigsaw.w3.org/css-validator/images/vcss)](https://jigsaw.w3.org/css-validator/check?uri=referer)

Netatalk and the Netatalk website are licensed under the [GNU
General Public License 2.0](/stable/htmldocs/gpl).

