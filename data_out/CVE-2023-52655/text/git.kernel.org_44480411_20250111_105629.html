

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ccab434e674ca95d483788b1895a70c21b7f016a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ccab434e674ca95d483788b1895a70c21b7f016a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ccab434e674ca95d483788b1895a70c21b7f016a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ccab434e674ca95d483788b1895a70c21b7f016a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Oliver Neukum <oneukum@suse.com> | 2023-11-15 11:08:57 +0100 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2023-11-16 23:39:13 +0000 |
| commit | [ccab434e674ca95d483788b1895a70c21b7f016a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ccab434e674ca95d483788b1895a70c21b7f016a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ccab434e674ca95d483788b1895a70c21b7f016a)) | |
| tree | [492760485f98fbe37955c4816b39f96dc7f35fef](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ccab434e674ca95d483788b1895a70c21b7f016a) | |
| parent | [7475e51b87969e01a6812eac713a1c8310372e8a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7475e51b87969e01a6812eac713a1c8310372e8a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ccab434e674ca95d483788b1895a70c21b7f016a&id2=7475e51b87969e01a6812eac713a1c8310372e8a)) | |
| download | [linux-ccab434e674ca95d483788b1895a70c21b7f016a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ccab434e674ca95d483788b1895a70c21b7f016a.tar.gz) | |

usb: aqc111: check packet for fixup for true limitIf a device sends a packet that is inbetween 0
and sizeof(u64) the value passed to skb\_trim()
as length will wrap around ending up as some very
large value.
The driver will then proceed to parse the header
located at that position, which will either oops or
process some random value.
The fix is to check against sizeof(u64) rather than
0, which the driver currently does. The issue exists
since the introduction of the driver.
Signed-off-by: Oliver Neukum <oneukum@suse.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ccab434e674ca95d483788b1895a70c21b7f016a)

| -rw-r--r-- | [drivers/net/usb/aqc111.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/usb/aqc111.c?id=ccab434e674ca95d483788b1895a70c21b7f016a) | 8 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 4 deletions

| diff --git a/drivers/net/usb/aqc111.c b/drivers/net/usb/aqc111.cindex a017e9de2119d5..7b8afa589a53c4 100644--- a/[drivers/net/usb/aqc111.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/usb/aqc111.c?id=7475e51b87969e01a6812eac713a1c8310372e8a)+++ b/[drivers/net/usb/aqc111.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/usb/aqc111.c?id=ccab434e674ca95d483788b1895a70c21b7f016a)@@ -1079,17 +1079,17 @@ static int aqc111\_rx\_fixup(struct usbnet \*dev, struct sk\_buff \*skb) u16 pkt\_count = 0; u64 desc\_hdr = 0; u16 vlan\_tag = 0;- u32 skb\_len = 0;+ u32 skb\_len;  if (!skb) goto err; - if (skb->len == 0)+ skb\_len = skb->len;+ if (skb\_len < sizeof(desc\_hdr)) goto err; - skb\_len = skb->len; /\* RX Descriptor Header \*/- skb\_trim(skb, skb->len - sizeof(desc\_hdr));+ skb\_trim(skb, skb\_len - sizeof(desc\_hdr)); desc\_hdr = le64\_to\_cpup((u64 \*)skb\_tail\_pointer(skb));  /\* Check these packets \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:55:06 +0000

