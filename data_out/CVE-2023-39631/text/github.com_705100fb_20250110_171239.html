
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flangchain-ai%2Flangchain%2Fissues%2F8363)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flangchain-ai%2Flangchain%2Fissues%2F8363)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=langchain-ai%2Flangchain)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[langchain-ai](/langchain-ai)
/
**[langchain](/langchain-ai/langchain)**
Public

* [Notifications](/login?return_to=%2Flangchain-ai%2Flangchain) You must be signed in to change notification settings
* [Fork
  15.9k](/login?return_to=%2Flangchain-ai%2Flangchain)
* [Star
   98k](/login?return_to=%2Flangchain-ai%2Flangchain)

* [Code](/langchain-ai/langchain)
* [Issues
  382](/langchain-ai/langchain/issues)
* [Pull requests
  44](/langchain-ai/langchain/pulls)
* [Discussions](/langchain-ai/langchain/discussions)
* [Actions](/langchain-ai/langchain/actions)
* [Projects
  2](/langchain-ai/langchain/projects)
* [Security](/langchain-ai/langchain/security)
* [Insights](/langchain-ai/langchain/pulse)

Additional navigation options

* [Code](/langchain-ai/langchain)
* [Issues](/langchain-ai/langchain/issues)
* [Pull requests](/langchain-ai/langchain/pulls)
* [Discussions](/langchain-ai/langchain/discussions)
* [Actions](/langchain-ai/langchain/actions)
* [Projects](/langchain-ai/langchain/projects)
* [Security](/langchain-ai/langchain/security)
* [Insights](/langchain-ai/langchain/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Flangchain-ai%2Flangchain%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Flangchain-ai%2Flangchain%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Arbitrary code execution in LLMMathChain #8363

Closed

1 of 14 tasks

[jan-kubena](/jan-kubena) opened this issue
Jul 27, 2023
· 33 comments

Closed

1 of 14 tasks

# [Arbitrary code execution in LLMMathChain](#top) #8363

[jan-kubena](/jan-kubena) opened this issue
Jul 27, 2023
· 33 comments

Assignees
[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=40&v=4)](/eyurtsev)

Labels
[🤖:bug](/langchain-ai/langchain/labels/%F0%9F%A4%96%3Abug)
Related to a bug, vulnerability, unexpected error with an existing feature
[🤖:security](/langchain-ai/langchain/labels/%F0%9F%A4%96%3Asecurity)
Related to security issues, CVEs

## Comments

[![@jan-kubena](https://avatars.githubusercontent.com/u/140610022?s=80&v=4)](/jan-kubena)

Copy link

### **[jan-kubena](/jan-kubena)** commented [Jul 27, 2023](#issue-1824692692)

| System Info Langchain version: 0.0.244 Numexpr version: 2.8.4 Python version: 3.10.11 Who can help? [@hwchase17](https://github.com/hwchase17) [@vowelparrot](https://github.com/vowelparrot) Information  * The official example notebooks/scripts * My own modified scripts  Related Components  * LLMs/Chat Models * Embedding Models * Prompts / Prompt Templates / Prompt Selectors * Output Parsers * Document Loaders * Vector Stores / Retrievers * Memory * Agents / Agent Executors * Tools / Toolkits * Chains * Callbacks/Tracing * Async  Reproduction Numexpr's evaluate function that Langchain uses [here](https://github.com/langchain-ai/langchain/blob/master/libs/langchain/langchain/chains/llm_math/base.py#L80) in the LLMMathChain is susceptible to arbitrary code execution with eval in the latest released version. See this [issue](https://github.com/pydata/numexpr/issues/442) where PoC for numexpr's evaluate is also provided.  This vulnerability allows an arbitrary code execution, that is to run code and commands on target machine, via LLMMathChain's run method with the right prompt. I'd like to ask the Langchain's maintainers to confirm if they want a full PoC with Langchain posted here publicly. Expected behavior Numerical expressions should be evaluated securely so as to not allow code execution. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👀
2
 dosubot[bot] and Lplenka reacted with eyes emoji

All reactions

* 👀
  2 reactions

[![@dosubot](https://avatars.githubusercontent.com/in/324583?s=40&v=4)](/apps/dosubot)
[dosubot](/apps/dosubot)
bot
added
the
[🤖:bug](/langchain-ai/langchain/labels/%F0%9F%A4%96%3Abug)
Related to a bug, vulnerability, unexpected error with an existing feature
label
[Jul 27, 2023](#event-9937725530)

[![@hinthornw](https://avatars.githubusercontent.com/u/13333726?s=80&u=82ebf1e0eb0663ebd49ba66f67a43f51bbf11442&v=4)](/hinthornw)

Copy link

Collaborator

### **[hinthornw](/hinthornw)** commented [Jul 27, 2023](#issuecomment-1653923852)

| Thanks for raising! We are working to move the LLMMathChain out of the langchain core library, for reasons such as this |
| --- |

All reactions

Sorry, something went wrong.

[![@dosubot](https://avatars.githubusercontent.com/in/324583?s=80&v=4)](/apps/dosubot)

Copy link

### **[dosubot](/apps/dosubot) bot** commented [Jul 27, 2023](#issuecomment-1653939097)

| *Answer generated by a 🤖* Answer I understand your concern about the potential security vulnerability in the LLMMathChain class of LangChain. You've correctly identified that the `numexpr.evaluate` function, which is used in the `_evaluate_expression` method, could potentially execute arbitrary code if a malicious expression is passed to it. This is due to the fact that `numexpr.evaluate` uses Python's `eval` function, which can execute arbitrary Python code.  Here's the code snippet in question:  ``` def _evaluate_expression(self, expression: str) -> str:     try:         local_dict = {"pi": math.pi, "e": math.e}         output = str(             numexpr.evaluate(                 expression.strip(),                 global_dict={},  # restrict access to globals                 local_dict=local_dict,  # add common mathematical functions             )         )     except Exception as e:         raise ValueError(             f'LLMMathChain._evaluate("{expression}") raised error: {e}.'             " Please try again with a valid numerical expression"         )      # Remove any leading and trailing brackets from the output     return re.sub(r"^\[|\]$", "", output) ```  In this code, `numexpr.evaluate` is called with the `expression` argument, which could potentially contain malicious code. Although the `global_dict` argument is set to an empty dictionary to restrict access to global variables, and the `local_dict` argument is set to a dictionary containing common mathematical functions, this does not prevent the execution of arbitrary code.  This means that a malicious user could potentially execute arbitrary code on the server where LangChain is running by passing a specially crafted expression to the `LLMMathChain`'s `run` method. This is indeed a serious security issue that needs to be addressed.  However, please note that this is just one potential interpretation of the issue. If you believe this interpretation is correct and that this is a bug that could impact other users, I encourage you to make a pull request to address this issue. If your experience contradicts this interpretation, I would suggest upgrading to the latest version of LangChain to see if the issue persists. Sources  * [libs/langchain/langchain/chains/llm\_math/base.py](https://github.com/langchain-ai/langchain/blob/-/libs/langchain/langchain/chains/llm_math/base.py)  ---   This response is meant to be useful, save you time, and share context. It is **not meant to be a precise solution**, but rather a starting point for your own research.  Help me be more useful! Please leave a 👍 if this is helpful and 👎 if it is irrelevant. |
| --- |

 👍
4
 dosubot[bot], jan-kubena, arunstar, and rickypatel38 reacted with thumbs up emoji
 👎
1
 dosubot[bot] reacted with thumbs down emoji

All reactions

* 👍
  4 reactions
* 👎
  1 reaction

Sorry, something went wrong.

[![@zoeqevans](https://avatars.githubusercontent.com/u/32969601?s=80&u=ea66c9f4127c515cf25b7f7a419d3aad732c55c2&v=4)](/zoeqevans)

Copy link

Contributor

### **[zoeqevans](/zoeqevans)** commented [Jul 31, 2023](#issuecomment-1659011603) • edited Loading

| [@hinthornw](https://github.com/hinthornw) As an alternative, we could use `sympy.sympify`? It's a common alternative to `eval` / `numexpr` (see this thread on vulnerabilities in [numexpr](https://stackoverflow.com/questions/10076300/python-using-sympy-sympify-to-perform-a-safe-eval-on-mathematical-functions)). As well as avoiding that vulnerability, `sympy` also supports a much larger range of mathematical operations (i.e. rounding, factorials, etc.) and is about 10x as common as `numexpr` (as measured by github stars), so I'd guess its easier for an LLM to generate syntactically correct input (in fact, I spent about 10mins trying to get GPT-3 to generate a mathematical input that `sympy` *couldn't* process, and failed).  I was testing some multi-step QA workflows inspired by a Langchain multi-step agent QA [workflow](https://python.langchain.com/docs/modules/agents/how_to/intermediate_steps), and was using the `llm-math` tool in an Agent chain, with prompts like: "Who is Zoe Saldana's partner? What is their current age raised to the 0.43 power, rounded to 3sf?". This would cause `numexpr` to throw an error, since the chain would try and fail to pass it some kind of rounding instruction. This also happens with the factorial function in [#3071](https://github.com/langchain-ai/langchain/issues/3071). Both of these use cases are fixed by backing `LLMMathChain` with a `sympify` call.  Happy to attach some examples / create a PR to scope out the replacement if people agree. It's what I've been using locally and it works great! |
| --- |

All reactions

Sorry, something went wrong.

[![@hinthornw](https://avatars.githubusercontent.com/u/13333726?s=80&u=82ebf1e0eb0663ebd49ba66f67a43f51bbf11442&v=4)](/hinthornw)

Copy link

Collaborator

### **[hinthornw](/hinthornw)** commented [Jul 31, 2023](#issuecomment-1659358993)

| That makes sense to me. I'd be happy to review a PR! Thank you for being proactive about this! |
| --- |

All reactions

Sorry, something went wrong.

[![@jan-kubena](https://avatars.githubusercontent.com/u/140610022?s=80&v=4)](/jan-kubena)

Copy link

Author

### **[jan-kubena](/jan-kubena)** commented [Aug 1, 2023](#issuecomment-1659701463) • edited Loading

| I'd just like to point out that there still needs to be some kind of validation/protection because sympy.sympify uses eval and shouldn't be used on unsanitized input as per official [docs](https://docs.sympy.org/latest/modules/core.html#module-sympy.core.sympify). I think it could also be worth looking at [this](https://github.com/langchain-ai/langchain/pull/1134) langchain PR that implemented sympy in RestrictedPython as an inspiration. |
| --- |

All reactions

Sorry, something went wrong.

[![@zoeqevans](https://avatars.githubusercontent.com/u/32969601?s=80&u=ea66c9f4127c515cf25b7f7a419d3aad732c55c2&v=4)](/zoeqevans)

Copy link

Contributor

### **[zoeqevans](/zoeqevans)** commented [Aug 1, 2023](#issuecomment-1659884609)

| Ah damn, yeah I missed that: was foolishly going off the StackOverflow thread and a memory of a still-unresolved effort within [Sympify](https://github.com/sympy/sympy/issues/10805) to remove eval / add a safe-mode.  `sympify` still offers a lot more functionality than `numexpr`, so I'd still be in favour of swapping anyway, but agree that there aren't any extra security benefits vs. `numexpr` on the eval front. |
| --- |

All reactions

Sorry, something went wrong.

[![@zoeqevans](https://avatars.githubusercontent.com/u/32969601?s=40&u=ea66c9f4127c515cf25b7f7a419d3aad732c55c2&v=4)](/zoeqevans)
[zoeqevans](/zoeqevans)
mentioned this issue
[Aug 2, 2023](#ref-pullrequest-1833027175)

[Swap in Sympy instead of numexpr for more expressive LLMMath tool
#8627](/langchain-ai/langchain/pull/8627)
 Closed

[![@zoeqevans](https://avatars.githubusercontent.com/u/32969601?s=80&u=ea66c9f4127c515cf25b7f7a419d3aad732c55c2&v=4)](/zoeqevans)

Copy link

Contributor

### **[zoeqevans](/zoeqevans)** commented [Aug 2, 2023](#issuecomment-1662065358)

| [@hinthornw](https://github.com/hinthornw) [PR here](https://github.com/langchain-ai/langchain/pull/8627/files) |
| --- |

 ❤️
3
 GianfrancoCorrea, spashii, and nloeff reacted with heart emoji

All reactions

* ❤️
  3 reactions

Sorry, something went wrong.

[![@jan-kubena](https://avatars.githubusercontent.com/u/140610022?s=80&v=4)](/jan-kubena)

Copy link

Author

### **[jan-kubena](/jan-kubena)** commented [Sep 13, 2023](#issuecomment-1717742357)

| Hi all, input sanitization has been added in numexpr version 2.8.6 for `evaluate` by default (see this [issue](https://github.com/pydata/numexpr/issues/442) I mentioned previously). As far as I can tell, it looks to be pretty secure. It'd be nice for the expression execution to be done in a secure container/environment, but I think that for now, the sanitization that numexpr does is surely better than nothing.  Since that is the case, I'd like to ask [@hinthornw](https://github.com/hinthornw) to advise on the preferable next course of action, that is whether to just bump the numexpr version, replace numexpr completely with Sympy and a secure container/environment (since it'd be vulnerable by itself) or other solutions to this. Thank you! |
| --- |

All reactions

Sorry, something went wrong.

[![@tabdunabi](https://avatars.githubusercontent.com/u/32544620?s=80&v=4)](/tabdunabi)

Copy link

### **[tabdunabi](/tabdunabi)** commented [Sep 26, 2023](#issuecomment-1736023550)

| Hi [@hinthornw](https://github.com/hinthornw), Any ETA on resolving this issue? Thanks |
| --- |

All reactions

Sorry, something went wrong.

[![@elmegatan26](https://avatars.githubusercontent.com/u/124077199?s=80&v=4)](/elmegatan26)

Copy link

### **[elmegatan26](/elmegatan26)** commented [Sep 28, 2023](#issuecomment-1738943843)

| This vulnerability is getting flagged by InfoSec teams. Any idea on when the update is being released? |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=80&v=4)](/eyurtsev)

Copy link

Collaborator

### **[eyurtsev](/eyurtsev)** commented [Oct 2, 2023](#issuecomment-1743603528) • edited Loading

| [@elmegatan26](https://github.com/elmegatan26) , [@tabdunabi](https://github.com/tabdunabi) , [@jan-kubena](https://github.com/jan-kubena) , numexpr is now (on master) an optional dependency, we've also added a constraint to specify that code only works with >=2.8.6 (which has input sanitization).   * Is this enough to address concerns flagged by InfoSec teams? * Also do you mind sharing if you're using LLMathChain yourself and if so which mathematical operations do you rely on? |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=40&v=4)](/eyurtsev)
[eyurtsev](/eyurtsev)
self-assigned this
[Oct 2, 2023](#event-10529573680)

[![@tabdunabi](https://avatars.githubusercontent.com/u/32544620?s=80&v=4)](/tabdunabi)

Copy link

### **[tabdunabi](/tabdunabi)** commented [Oct 2, 2023](#issuecomment-1743707257)

| [@eyurtsev](https://github.com/eyurtsev), for our use case, we do not use `LLMathChain`, but our security scans detect the `numexpr` vulnerability. This is a critical issue for us and blocker to publish our solutions, used by our customers. If making `numexpr` optional (not installed by default with `LangChian`), then this is enough for us. |
| --- |

All reactions

Sorry, something went wrong.

[![@elmegatan26](https://avatars.githubusercontent.com/u/124077199?s=80&v=4)](/elmegatan26)

Copy link

### **[elmegatan26](/elmegatan26)** commented [Oct 2, 2023](#issuecomment-1743726992)

| [@eyurtsev](https://github.com/eyurtsev) We are not using LLMathChain but similar to [@tabdunabi](https://github.com/tabdunabi) the vulnerability is automatically detected and flagged. Example: <https://security.snyk.io/package/pip/langchain> and <https://security.snyk.io/package/pip/langchain/0.0.306> |
| --- |

All reactions

Sorry, something went wrong.

[![@tabdunabi](https://avatars.githubusercontent.com/u/32544620?s=80&v=4)](/tabdunabi)

Copy link

### **[tabdunabi](/tabdunabi)** commented [Oct 4, 2023](#issuecomment-1747356364) • edited Loading

| [@eyurtsev](https://github.com/eyurtsev) just installed `v0.0.308` (with optional `numexpr`), but `python-pipaudit` still reports the vulnerability. I've verified `numexpr` was not installed. It seems the CVE database still has it as a dependency. Anything can be done from your side to update the database? |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=80&v=4)](/eyurtsev)

Copy link

Collaborator

### **[eyurtsev](/eyurtsev)** commented [Oct 4, 2023](#issuecomment-1747573069)

| [@tabdunabi](https://github.com/tabdunabi) we're taking a look.  [@elmegatan26](https://github.com/elmegatan26) [@tabdunabi](https://github.com/tabdunabi) Are the [other CVEs](https://security.snyk.io/package/pip/langchain/0.0.306) a blocker for you right now? |
| --- |

 👍
1
 tabdunabi reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@tabdunabi](https://avatars.githubusercontent.com/u/32544620?s=80&v=4)](/tabdunabi)

Copy link

### **[tabdunabi](/tabdunabi)** commented [Oct 4, 2023](#issuecomment-1747621137) • edited Loading

| Yes [@eyurtsev](https://github.com/eyurtsev) they are blockers. Interestingly, for `v0.0.308`, `python-pipaudit` did not report <https://security.snyk.io/vuln/SNYK-PYTHON-LANGCHAIN-5850009> and <https://security.snyk.io/vuln/SNYK-PYTHON-LANGCHAIN-5843727>. `safety` only reported <https://security.snyk.io/vuln/SNYK-PYTHON-LANGCHAIN-5843727>. |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=40&v=4)](/eyurtsev)
[eyurtsev](/eyurtsev)
mentioned this issue
[Oct 4, 2023](#ref-pullrequest-1922465371)

[Bump min version of numexpr
#11302](/langchain-ai/langchain/pull/11302)
 Merged

[![@elmegatan26](https://avatars.githubusercontent.com/u/124077199?s=80&v=4)](/elmegatan26)

Copy link

### **[elmegatan26](/elmegatan26)** commented [Oct 4, 2023](#issuecomment-1747670492)

| [@eyurtsev](https://github.com/eyurtsev) Yes, any CVE ranked High or Critical is a blocker. Any vulnerabilities found by most infosec teams are flagged and Devs are required to patch or prove the issue is not exploitable. |
| --- |

All reactions

Sorry, something went wrong.

[![@dvirginz](https://avatars.githubusercontent.com/u/31047807?s=80&u=6f574df95d80eb3222059dd9713cdefac6e6e574&v=4)](/dvirginz)

Copy link

### **[dvirginz](/dvirginz)** commented [Oct 5, 2023](#issuecomment-1748258908) • edited Loading

| Hi everyone,  Thank you for opening the issue.  Just to clarify the status: Is there any version or installation of Langchain that doesn't currently contain high or critical CVEs?  From the Snyk website, it seems no version of Langchain is completely free from critical issues. <https://security.snyk.io/package/pip/langchain> |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=80&v=4)](/eyurtsev)

Copy link

Collaborator

### **[eyurtsev](/eyurtsev)** commented [Oct 5, 2023](#issuecomment-1749256899)

| [@tabdunabi](https://github.com/tabdunabi) Information about LLMathChain should now be reflected.  [@dvirginz](https://github.com/dvirginz) Not at the moment. We're working on addressing all the CVEs.   * <https://security.snyk.io/vuln/SNYK-PYTHON-LANGCHAIN-5850009> -- will be resolved next week ([Getting rid of more CVEs #11352](https://github.com/langchain-ai/langchain/discussions/11352)) * <https://security.snyk.io/vuln/SNYK-PYTHON-LANGCHAIN-5843727> -- will be resolved over the next few weeks. This CVE stems from a python ast repl tool used by some agents. You're at risk if your code uses this tool directly or else indirectlty via an agent that relies on it. |
| --- |

 👍
1
 tabdunabi reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@dvirginz](https://avatars.githubusercontent.com/u/31047807?s=80&u=6f574df95d80eb3222059dd9713cdefac6e6e574&v=4)](/dvirginz)

Copy link

### **[dvirginz](/dvirginz)** commented [Oct 5, 2023](#issuecomment-1749330773) via email

| Hi! Thank you for the update and detailed response. We look forward to a solution, as it will help us a lot. Message ID: \*\*\*@\*\*\*.\*\*\*>  ᐧ |
| --- |

All reactions

Sorry, something went wrong.

[![@tabdunabi](https://avatars.githubusercontent.com/u/32544620?s=80&v=4)](/tabdunabi)

Copy link

### **[tabdunabi](/tabdunabi)** commented [Oct 10, 2023](#issuecomment-1756342162) • edited Loading

| hi [@eyurtsev](https://github.com/eyurtsev), first apologies for pining you again. We are delaying our release for the CVEs to be patched.  I see <https://security.snyk.io/vuln/SNYK-PYTHON-LANGCHAIN-5850009> has been patched in `v0.0.312` (PR [#10252](https://github.com/langchain-ai/langchain/pull/10252) ).  Any chance you can accelerate PR [#5640](https://github.com/langchain-ai/langchain/pull/5640), referenced in issue [#7700](https://github.com/langchain-ai/langchain/issues/7700) as providing a fix for <https://security.snyk.io/vuln/SNYK-PYTHON-LANGCHAIN-5843727> . |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=80&v=4)](/eyurtsev)

Copy link

Collaborator

### **[eyurtsev](/eyurtsev)** commented [Oct 11, 2023](#issuecomment-1756607529)

| Hi [@tabdunabi](https://github.com/tabdunabi), realistic timeline is 1-3 weeks. Are you relying on any of the agents; i.e., the pandas agent, xorbits agent or spark agent (which dependent on the python ast tool?). |
| --- |

All reactions

Sorry, something went wrong.

[![@dvirginz](https://avatars.githubusercontent.com/u/31047807?s=80&u=6f574df95d80eb3222059dd9713cdefac6e6e574&v=4)](/dvirginz)

Copy link

### **[dvirginz](/dvirginz)** commented [Oct 11, 2023](#issuecomment-1757343766)

| If we aren't using agents or LLMMathChain, is there a clear version we can already use? |
| --- |

All reactions

Sorry, something went wrong.

[![@tabdunabi](https://avatars.githubusercontent.com/u/32544620?s=80&v=4)](/tabdunabi)

Copy link

### **[tabdunabi](/tabdunabi)** commented [Oct 11, 2023](#issuecomment-1758154597)

| Thank you [@eyurtsev](https://github.com/eyurtsev) for the update.  Currently, we are not using LangChain agents. However, our build pipeline fails because of any security vulnerabilities in the libraries shipped with our solutions. So, even though we are not using LangChain agents, we need to go through a formal approval process with our security team, and prove the vulnerable code is not actually used by our solutions, to be able to get an exception to release. Additionally, once we publish our code on GitHub, GitHub Dependabot will flag these security vulnerabilities, and we need to address auto-cut tickets for our team.  So, it would be much easier, and safer, to ship code with zero security vulnerabilities in downstream dependencies. |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=80&v=4)](/eyurtsev)

Copy link

Collaborator

### **[eyurtsev](/eyurtsev)** commented [Oct 11, 2023](#issuecomment-1758195848)

| Targeting end of month 10/28 (will announce in a bit with expected changes) to resolve the CVE to allow existing users to migrate. In the meantime, are you able to fork and remove affected code? |
| --- |

All reactions

Sorry, something went wrong.

[![@tabdunabi](https://avatars.githubusercontent.com/u/32544620?s=80&v=4)](/tabdunabi)

Copy link

### **[tabdunabi](/tabdunabi)** commented [Oct 11, 2023](#issuecomment-1758209720)

| Thank you [@eyurtsev](https://github.com/eyurtsev)!. Creating a fork is not an option for us. We want our customers to be able to build our code by themselves using published libraries, available on Pypi/NPM. We do not want to maintain forks of external libraries. |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=80&v=4)](/eyurtsev)

Copy link

Collaborator

### **[eyurtsev](/eyurtsev)** commented [Oct 11, 2023](#issuecomment-1758551800)

| [#11680](https://github.com/langchain-ai/langchain/discussions/11680) -- announcement |
| --- |

 👍
1
 tabdunabi reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=80&v=4)](/eyurtsev)

Copy link

Collaborator

### **[eyurtsev](/eyurtsev)** commented [Oct 27, 2023](#issuecomment-1783390328) • edited Loading

| Python AST tool CVE was resolved here: [#12427](https://github.com/langchain-ai/langchain/pull/12427) cc [@tabdunabi](https://github.com/tabdunabi) / [@dvirginz](https://github.com/dvirginz)  (The original CVE for LLMathChain was resolved a while back -- closing this issue.)  As of release: <https://github.com/langchain-ai/langchain/releases/tag/v0.0.325> |
| --- |

 👍
1
 tabdunabi reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=40&v=4)](/eyurtsev)
[eyurtsev](/eyurtsev)
closed this as [completed](/langchain-ai/langchain/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Oct 27, 2023](#event-10795049121)

[![@tabdunabi](https://avatars.githubusercontent.com/u/32544620?s=80&v=4)](/tabdunabi)

Copy link

### **[tabdunabi](/tabdunabi)** commented [Oct 27, 2023](#issuecomment-1783393173)

| Thank you [@eyurtsev](https://github.com/eyurtsev) !. We will immediately upgrade LangChain version, used by our code, to `v0.0.325` |
| --- |

All reactions

Sorry, something went wrong.

[![@dvirginz](https://avatars.githubusercontent.com/u/31047807?s=80&u=6f574df95d80eb3222059dd9713cdefac6e6e574&v=4)](/dvirginz)

Copy link

### **[dvirginz](/dvirginz)** commented [Oct 27, 2023](#issuecomment-1783395895) via email • edited Loading

| Thank you. It seems that Snyk still identifies 1 high-risk CVE in LangChain. Any thoughts? Thanks. <https://security.snyk.io/package/pip/langchain> |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=80&v=4)](/eyurtsev)

Copy link

Collaborator

### **[eyurtsev](/eyurtsev)** commented [Oct 28, 2023](#issuecomment-1783658610)

| [@dvirginz](https://github.com/dvirginz) that's the CVE that got patched with this release. It can take up to several days for the CVE to information to be updated in the relevant databases. |
| --- |

All reactions

Sorry, something went wrong.

[![@mschirmer84](https://avatars.githubusercontent.com/u/8063081?s=80&v=4)](/mschirmer84)

Copy link

### **[mschirmer84](/mschirmer84)** commented [Nov 14, 2023](#issuecomment-1811105202)

| Can this [[CVE-2023-39631](https://github.com/advisories/GHSA-f73w-4m7g-ch9x "CVE-2023-39631")] (<http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2023-39631>) be closed off with the above fix? |
| --- |

All reactions

Sorry, something went wrong.

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=80&v=4)](/eyurtsev)

Copy link

Collaborator

### **[eyurtsev](/eyurtsev)** commented [Feb 12, 2024](#issuecomment-1939027770)

| That CVE was resolved as well a while back: [GHSA-f73w-4m7g-ch9x](https://github.com/advisories/GHSA-f73w-4m7g-ch9x "GHSA-f73w-4m7g-ch9x")  Locking conversation |
| --- |

All reactions

Sorry, something went wrong.

[![@langchain-ai](https://avatars.githubusercontent.com/u/126733545?s=40&v=4)](/langchain-ai)
[langchain-ai](/langchain-ai)
locked as **resolved** and limited conversation to collaborators
[Feb 12, 2024](#event-11776708320)

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=40&v=4)](/eyurtsev)
[eyurtsev](/eyurtsev)
added
the
[🤖:security](/langchain-ai/langchain/labels/%F0%9F%A4%96%3Asecurity)
Related to security issues, CVEs
label
[Mar 13, 2024](#event-12105987720)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flangchain-ai%2Flangchain%2Fissues%2F8363).

Assignees

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=40&v=4)](/eyurtsev) [eyurtsev](/eyurtsev)

Labels

[🤖:bug](/langchain-ai/langchain/labels/%F0%9F%A4%96%3Abug)
Related to a bug, vulnerability, unexpected error with an existing feature
[🤖:security](/langchain-ai/langchain/labels/%F0%9F%A4%96%3Asecurity)
Related to security issues, CVEs

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

8 participants

[![@eyurtsev](https://avatars.githubusercontent.com/u/3205522?s=52&v=4)](/eyurtsev) [![@mschirmer84](https://avatars.githubusercontent.com/u/8063081?s=52&v=4)](/mschirmer84) [![@hinthornw](https://avatars.githubusercontent.com/u/13333726?s=52&v=4)](/hinthornw) [![@dvirginz](https://avatars.githubusercontent.com/u/31047807?s=52&v=4)](/dvirginz) [![@tabdunabi](https://avatars.githubusercontent.com/u/32544620?s=52&v=4)](/tabdunabi) [![@zoeqevans](https://avatars.githubusercontent.com/u/32969601?s=52&v=4)](/zoeqevans) [![@elmegatan26](https://avatars.githubusercontent.com/u/124077199?s=52&v=4)](/elmegatan26) [![@jan-kubena](https://avatars.githubusercontent.com/u/140610022?s=52&v=4)](/jan-kubena)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

