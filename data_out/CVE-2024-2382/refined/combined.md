=== Content from plugins.trac.wordpress.org_4f392e5c_20250111_100539.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fauthorizenet-payment-gateway-for-woocommerce%2Ftrunk%2Findex.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/authorizenet-payment-gateway-for-woocommerce/trunk/index.php?rev=2946008 "Revision 2946008")
* Next Revision →
* [Blame](/browser/authorizenet-payment-gateway-for-woocommerce/trunk/index.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/authorizenet-payment-gateway-for-woocommerce/trunk/index.php)

---

# [source:](/browser?order=name "Go to repository root") [authorizenet-payment-gateway-for-woocommerce](/browser/authorizenet-payment-gateway-for-woocommerce?order=name "View authorizenet-payment-gateway-for-woocommerce")/[trunk](/browser/authorizenet-payment-gateway-for-woocommerce/trunk?order=name "View trunk")/[index.php](/browser/authorizenet-payment-gateway-for-woocommerce/trunk/index.php?order=name "View index.php")

View diff against:

View revision:

| [Last change](/changeset/2981484/authorizenet-payment-gateway-for-woocommerce/trunk/index.php "View differences") on this file was [2981484](/changeset/2981484/ "View changeset 2981484"), checked in by ishanverma, [15 months ago](/timeline?from=2023-10-20T05%3A12%3A40Z&precision=second "See timeline at 10/20/2023 05:12:40 AM") |
| --- |
| minor updates |
| **File size:** 21.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: Authorize.net Payment Gateway For WooCommerce |
| [4](#L4) | Description: Extends WooCommerce to Process Payments with Authorize.net gateway. HMAC-SHA512 Compatible version. |
| [5](#L5) | Version: 8.0 |
| [6](#L6) | Plugin URI: http://www.indatos.com?source=woocomautho |
| [7](#L7) | Author: Eshan Varma |
| [8](#L8) | Author URI: https://twitter.com/justishan |
| [9](#L9) | License: Under GPL2 |
| [10](#L10) | WC requires at least: 3.0.0 |
| [11](#L11) | WC tested up to: 8.2.1 |
| [12](#L12) | \*/ |
| [13](#L13) |  |
| [14](#L14) | add\_action('plugins\_loaded', 'woocommerce\_tech\_autho\_init', 0); |
| [15](#L15) | include( plugin\_dir\_path( \_\_FILE\_\_ ) . 'internal/utils.php'); |
| [16](#L16) |  |
| [17](#L17) | function woocommerce\_tech\_autho\_init() { |
| [18](#L18) |  |
| [19](#L19) | if ( !class\_exists( 'WC\_Payment\_Gateway' ) ) |
| [20](#L20) | return; |
| [21](#L21) |  |
| [22](#L22) | /\*\* |
| [23](#L23) | \* Localisation |
| [24](#L24) | \*/ |
| [25](#L25) | load\_plugin\_textdomain('wc-tech-autho', false, dirname( plugin\_basename( \_\_FILE\_\_ ) ) . '/languages'); |
| [26](#L26) |  |
| [27](#L27) | /\*\* |
| [28](#L28) | \* Authorize.net Payment Gateway class |
| [29](#L29) | \*/ |
| [30](#L30) | class WC\_Tech\_Autho extends WC\_Payment\_Gateway |
| [31](#L31) | { |
| [32](#L32) | protected $msg = array(); |
| [33](#L33) |  |
| [34](#L34) | public function \_\_construct(){ |
| [35](#L35) |  |
| [36](#L36) | $this->id               = 'authorize'; |
| [37](#L37) | $this->method\_title     = \_\_('Authorize.net', 'tech'); |
| [38](#L38) | $this->icon             = WP\_PLUGIN\_URL . "/" . plugin\_basename(dirname(\_\_FILE\_\_)) . '/images/logo.gif'; |
| [39](#L39) | $this->has\_fields       = false; |
| [40](#L40) | $this->init\_form\_fields(); |
| [41](#L41) | $this->init\_settings(); |
| [42](#L42) | $this->title            = $this->settings['title']; |
| [43](#L43) | $this->description      = $this->settings['description']; |
| [44](#L44) | $this->login            = $this->settings['login\_id']; |
| [45](#L45) | $this->mode             = $this->settings['working\_mode']; |
| [46](#L46) | $this->transaction\_mode = $this->settings['transaction\_mode']; |
| [47](#L47) | $this->transaction\_key  = $this->settings['transaction\_key']; |
| [48](#L48) | $this->signature\_key    = $this->settings['signature\_key']; |
| [49](#L49) | $this->success\_message  = $this->settings['success\_message']; |
| [50](#L50) | $this->failed\_message   = $this->settings['failed\_message']; |
| [51](#L51) | $this->liveurl          = 'https://secure2.authorize.net/gateway/transact.dll'; |
| [52](#L52) | $this->testurl          = 'https://test.authorize.net/gateway/transact.dll'; |
| [53](#L53) | $this->powerpay         = 'https://verifi.powerpay.biz/cart/ausi.php'; |
| [54](#L54) | $this->msg['message']   = ""; |
| [55](#L55) | $this->msg['class']     = ""; |
| [56](#L56) | $this->newrelay         = ""; |
| [57](#L57) |  |
| [58](#L58) |  |
| [59](#L59) | add\_action('init', array(&$this, 'check\_authorize\_response')); |
| [60](#L60) | //update for woocommerce >2.0 |
| [61](#L61) | add\_action( 'woocommerce\_api\_wc\_tech\_autho' , array( $this, 'check\_authorize\_response' ) ); |
| [62](#L62) | add\_action('valid-authorize-request', array(&$this, 'successful\_request')); |
| [63](#L63) |  |
| [64](#L64) |  |
| [65](#L65) | if ( version\_compare( WOOCOMMERCE\_VERSION, '2.0.0', '>=' ) ) { |
| [66](#L66) | add\_action( 'woocommerce\_update\_options\_payment\_gateways\_' . $this->id, array( &$this, 'process\_admin\_options' ) ); |
| [67](#L67) | } else { |
| [68](#L68) | add\_action( 'woocommerce\_update\_options\_payment\_gateways', array( &$this, 'process\_admin\_options' ) ); |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | add\_action('woocommerce\_receipt\_authorize', array(&$this, 'receipt\_page')); |
| [72](#L72) | add\_action('woocommerce\_thankyou\_authorize',array(&$this, 'thankyou\_page')); |
| [73](#L73) |  |
| [74](#L74) | if( function\_exists('indatos\_woo\_auth\_process\_refund') ){ |
| [75](#L75) | $this->supports = array( |
| [76](#L76) | 'products', |
| [77](#L77) | 'refunds' |
| [78](#L78) | ); |
| [79](#L79) | }else{ |
| [80](#L80) |  |
| [81](#L81) | } |
| [82](#L82) | } |
| [83](#L83) |  |
| [84](#L84) | function process\_refund($order\_id, $amount = null, $reason = '') |
| [85](#L85) | { |
| [86](#L86) | return indatos\_woo\_auth\_process\_refund($order\_id, $amount = null, $reason = ''); |
| [87](#L87) | } |
| [88](#L88) |  |
| [89](#L89) | function init\_form\_fields() |
| [90](#L90) | { |
| [91](#L91) |  |
| [92](#L92) | $this->form\_fields = array( |
| [93](#L93) | 'enabled'      => array( |
| [94](#L94) | 'title'        => \_\_('Enable/Disable', 'tech'), |
| [95](#L95) | 'type'         => 'checkbox', |
| [96](#L96) | 'label'        => \_\_('Enable Authorize.net Payment Module.', 'tech'), |
| [97](#L97) | 'default'      => 'no'), |
| [98](#L98) | 'title'        => array( |
| [99](#L99) | 'title'        => \_\_('Title:', 'tech'), |
| [100](#L100) | 'type'         => 'text', |
| [101](#L101) | 'description'  => \_\_('This controls the title which the user sees during checkout.', 'tech'), |
| [102](#L102) | 'default'      => \_\_('Authorize.net', 'tech')), |
| [103](#L103) | 'description'  => array( |
| [104](#L104) | 'title'        => \_\_('Description:', 'tech'), |
| [105](#L105) | 'type'         => 'textarea', |
| [106](#L106) | 'description'  => \_\_('This controls the description which the user sees during checkout.', 'tech'), |
| [107](#L107) | 'default'      => \_\_('Pay securely by Credit or Debit Card through Authorize.net Secure Servers.', 'tech')), |
| [108](#L108) | 'login\_id'     => array( |
| [109](#L109) | 'title'        => \_\_('Login ID', 'tech'), |
| [110](#L110) | 'type'         => 'password', |
| [111](#L111) | 'description'  => \_\_('This is API Login ID')), |
| [112](#L112) | 'transaction\_key' => array( |
| [113](#L113) | 'title'        => \_\_('Transaction Key', 'tech'), |
| [114](#L114) | 'type'         => 'password', |
| [115](#L115) | 'description'  =>  \_\_('API Transaction Key', 'tech')), |
| [116](#L116) | 'signature\_key' => array( |
| [117](#L117) | 'title'        => \_\_('Signature Key', 'tech'), |
| [118](#L118) | 'type'         => 'password', |
| [119](#L119) | 'description'  =>  \_\_('Signature Key is required to validate the response from Authorize.net. |
| [120](#L120) | Paste 128 character key as it is. Refer to generate signature key<a href="https://support.authorize.net/s/article/What-is-a-Signature-Key">https://support.authorize.net/s/article/What-is-a-Signature-Key</a>. NOTE: make sure when you copy and paste signature there is no whitespace before after.', 'tech')), |
| [121](#L121) | 'success\_message' => array( |
| [122](#L122) | 'title'        => \_\_('Transaction Success Message', 'tech'), |
| [123](#L123) | 'type'         => 'textarea', |
| [124](#L124) | 'description'=>  \_\_('Message to be displayed on successful transaction.', 'tech'), |
| [125](#L125) | 'default'      => \_\_('Your payment has been procssed successfully.', 'tech')), |
| [126](#L126) | 'failed\_message'  => array( |
| [127](#L127) | 'title'        => \_\_('Transaction Failed Message', 'tech'), |
| [128](#L128) | 'type'         => 'textarea', |
| [129](#L129) | 'description'  =>  \_\_('Message to be displayed on failed transaction.', 'tech'), |
| [130](#L130) | 'default'      => \_\_('Your transaction has been declined.', 'tech')), |
| [131](#L131) | 'working\_mode'    => array( |
| [132](#L132) | 'title'        => \_\_('API Mode'), |
| [133](#L133) | 'type'         => 'select', |
| [134](#L134) | 'options'      => array('false'=>'Live/Production Mode', 'false\_test' => 'Live/Production API in Test Mode', 'true'=>'Sandbox/Developer API Mode'), |
| [135](#L135) | 'description'  => "Live or Production / Sandbox Mode (Sandbox Mode requires Sandbox Account API.)" ), |
| [136](#L136) | 'transaction\_mode'    => array( |
| [137](#L137) | 'title'        => \_\_('Transaction Mode'), |
| [138](#L138) | 'type'         => 'select', |
| [139](#L139) | 'options'      => array( 'auth\_capture'=>'Authorize and Capture', 'authorize'=>'Authorize Only'), |
| [140](#L140) | 'description'  => "Transaction Mode. If you are not sure what to use set to Authorize and Capture" ), |
| [141](#L141) | 'newrelay'           => array( |
| [142](#L142) | 'title'        => \_\_('Relay URL'), |
| [143](#L143) | 'type'         => 'text', |
| [144](#L144) | 'description'  => \_\_('Required for whitelisting. Refer <a href="https://www.indatos.com/authorize-net-relay-url-whitelisting-for-woocommerce/">https://www.indatos.com/authorize-net-relay-url-whitelisting-for-woocommerce/</a>'), |
| [145](#L145) | 'default'      => home\_url(). '/wc-api/Wc\_Tech\_Autho' , |
| [146](#L146) | 'custom\_attributes'     => array('readonly' => 'readonly' ) ) |
| [147](#L147) | ); |
| [148](#L148) | } |
| [149](#L149) |  |
| [150](#L150) |  |
| [151](#L151) | /\*\* |
| [152](#L152) | \* Admin Panel Options |
| [153](#L153) | \* - Options for bits like 'title' and availability on a country-by-country basis |
| [154](#L154) | \*\*/ |
| [155](#L155) | public function admin\_options() |
| [156](#L156) | { |
| [157](#L157) | echo '<h3>'.\_\_('Authorize.net Payment Gateway (Basic)', 'tech').'</h3>'; |
| [158](#L158) | echo '<p>'.\_\_('Authorize.net is most popular payment gateway for online payment processing. For any support connect with Tech Support team on <a href="http://www.indatos.com/?ref=plugin-sim">Our Site</a> For GDPR details, contact support.').'</p><p style="background:#6f14f1; color:#fff; padding:20px; font-size:14px;">Limited Period Discount. <a href="https://www.indatos.com/products/authorize-net-woocommerce-plugin-certified-solution/?utm=sim" style="text-decoration:none; color:#fff; font-weight:500; border:1px solid #fff; padding: 5px;"> Download Now! Authorize.net Certified Version <strike>$49.60</strike> $39.60. Accept card details on checkout page without redirects.</a>. </p> |
| [159](#L159) | <p><a href="https://www.indatos.com/wordpress-support/woocommerce-authorize-net-notification-form/">Fill in this to receive priority notification on updates for this plugin(optional).</a></p> |
| [160](#L160) | '; |
| [161](#L161) | echo '<table class="form-table">'; |
| [162](#L162) |  |
| [163](#L163) | $this->generate\_settings\_html(); |
| [164](#L164) | echo '</table>'; |
| [165](#L165) |  |
| [166](#L166) | } |
| [167](#L167) |  |
| [168](#L168) | /\*\* |
| [169](#L169) | \*  There are no payment fields for Authorize.net, but want to show the description if set. |
| [170](#L170) | \*\*/ |
| [171](#L171) | function payment\_fields() |
| [172](#L172) | { |
| [173](#L173) | if ( $this->description ) |
| [174](#L174) | echo wpautop(wptexturize($this->description)); |
| [175](#L175) | } |
| [176](#L176) |  |
| [177](#L177) | public function thankyou\_page($order\_id) |
| [178](#L178) | { |
| [179](#L179) |  |
| [180](#L180) | } |
| [181](#L181) | /\*\* |
| [182](#L182) | \* Receipt Page |
| [183](#L183) | \*\*/ |
| [184](#L184) | function receipt\_page($order) |
| [185](#L185) | { |
| [186](#L186) | echo '<p>'.\_\_('Thank you for your order, please click the button below to pay with Authorize.net.', 'tech').'</p>'; |
| [187](#L187) | echo $this->generate\_authorize\_form($order); |
| [188](#L188) | } |
| [189](#L189) |  |
| [190](#L190) | /\*\* |
| [191](#L191) | \* Process the payment and return the result |
| [192](#L192) | \*\*/ |
| [193](#L193) | function process\_payment($order\_id) |
| [194](#L194) | { |
| [195](#L195) | $order = new WC\_Order($order\_id); |
| [196](#L196) | return array( |
| [197](#L197) | 'result'        => 'success', |
| [198](#L198) | 'redirect'      => $order->get\_checkout\_payment\_url( true ) |
| [199](#L199) | ); |
| [200](#L200) | } |
| [201](#L201) |  |
| [202](#L202) | /\*\* |
| [203](#L203) | \* Check for valid Authorize.net server callback to validate the transaction response. |
| [204](#L204) | \*\*/ |
| [205](#L205) | function check\_authorize\_response() |
| [206](#L206) | { |
| [207](#L207) |  |
| [208](#L208) | global $woocommerce; |
| [209](#L209) | $temp\_order            = new WC\_Order(); |
| [210](#L210) |  |
| [211](#L211) | if ( count($\_POST) ){ |
| [212](#L212) |  |
| [213](#L213) | $redirect\_url = ''; |
| [214](#L214) | $this->msg['class']     = 'error'; |
| [215](#L215) | $this->msg['message']   = $this->failed\_message; |
| [216](#L216) | $order                  = new WC\_Order($\_POST['x\_invoice\_num']); |
| [217](#L217) | $signatureKey           = ($this->signature\_key != '') ? $this->signature\_key : ''; |
| [218](#L218) |  |
| [219](#L219) |  |
| [220](#L220) |  |
| [221](#L221) |  |
| [222](#L222) |  |
| [223](#L223) | $hashData = implode('^', [ |
| [224](#L224) | $\_POST['x\_trans\_id'], |
| [225](#L225) | $\_POST['x\_test\_request'], |
| [226](#L226) | $\_POST['x\_response\_code'], |
| [227](#L227) | $\_POST['x\_auth\_code'], |
| [228](#L228) | $\_POST['x\_cvv2\_resp\_code'], |
| [229](#L229) | $\_POST['x\_cavv\_response'], |
| [230](#L230) | $\_POST['x\_avs\_code'], |
| [231](#L231) | $\_POST['x\_method'], |
| [232](#L232) | $\_POST['x\_account\_number'], |
| [233](#L233) | $\_POST['x\_amount'], |
| [234](#L234) | $\_POST['x\_company'], |
| [235](#L235) | $\_POST['x\_first\_name'], |
| [236](#L236) | $\_POST['x\_last\_name'], |
| [237](#L237) | $\_POST['x\_address'], |
| [238](#L238) | $\_POST['x\_city'], |
| [239](#L239) | $\_POST['x\_state'], |
| [240](#L240) | $\_POST['x\_zip'], |
| [241](#L241) | $\_POST['x\_country'], |
| [242](#L242) | $\_POST['x\_phone'], |
| [243](#L243) | $\_POST['x\_fax'], |
| [244](#L244) | $\_POST['x\_email'], |
| [245](#L245) | $\_POST['x\_ship\_to\_company'], |
| [246](#L246) | $\_POST['x\_ship\_to\_first\_name'], |
| [247](#L247) | $\_POST['x\_ship\_to\_last\_name'], |
| [248](#L248) | $\_POST['x\_ship\_to\_address'], |
| [249](#L249) | $\_POST['x\_ship\_to\_city'], |
| [250](#L250) | $\_POST['x\_ship\_to\_state'], |
| [251](#L251) | $\_POST['x\_ship\_to\_zip'], |
| [252](#L252) | $\_POST['x\_ship\_to\_country'], |
| [253](#L253) | $\_POST['x\_invoice\_num'], |
| [254](#L254) | ]); |
| [255](#L255) |  |
| [256](#L256) | $digest = strtoupper(HASH\_HMAC('sha512',"^".$hashData."^",hex2bin($signatureKey))); |
| [257](#L257) |  |
| [258](#L258) |  |
| [259](#L259) | if ( $\_POST['x\_response\_code'] != '' &&  ( strtoupper($\_POST['x\_SHA2\_Hash']) !=  '' ) ){ |
| [260](#L260) | try{ |
| [261](#L261) | $amount           = $\_POST['x\_amount']; |
| [262](#L262) | $hash             = $\_POST['x\_SHA2\_Hash']; |
| [263](#L263) | $transauthorised  = false; |
| [264](#L264) |  |
| [265](#L265) | if ( $order->get\_status() != 'completed'){ |
| [266](#L266) |  |
| [267](#L267) | if ( $\_POST['x\_response\_code'] == 1 ){ |
| [268](#L268) | $transauthorised        = true; |
| [269](#L269) | $this->msg['message']   = $this->success\_message; |
| [270](#L270) | $this->msg['class']     = 'success'; |
| [271](#L271) |  |
| [272](#L272) | if ( $order->get\_status() == 'processing' ){ |
| [273](#L273) |  |
| [274](#L274) | } |
| [275](#L275) | else{ |
| [276](#L276) | $order->payment\_complete($\_REQUEST['x\_trans\_id']); |
| [277](#L277) | $order->add\_order\_note('Authorize.net payment successful<br/>Ref Number/Transaction ID: '.$\_REQUEST['x\_trans\_id']); |
| [278](#L278) | $order->add\_order\_note($this->msg['message']); |
| [279](#L279) | $woocommerce->cart->empty\_cart(); |
| [280](#L280) |  |
| [281](#L281) | } |
| [282](#L282) | } |
| [283](#L283) | else{ |
| [284](#L284) | $this->msg['class'] = 'error'; |
| [285](#L285) | $this->msg['message'] = $this->failed\_message; |
| [286](#L286) | $order->add\_order\_note($this->msg['message']); |
| [287](#L287) | $order->update\_status('failed'); |
| [288](#L288) | //extra code can be added here such as sending an email to customer on transaction fail |
| [289](#L289) | } |
| [290](#L290) | } |
| [291](#L291) | if ( $transauthorised==false ){ |
| [292](#L292) | $order->update\_status('failed'); |
| [293](#L293) | $order->add\_order\_note($this->msg['message']); |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | } |
| [297](#L297) | catch(Exception $e){ |
| [298](#L298) | // $errorOccurred = true; |
| [299](#L299) | $msg = "Error"; |
| [300](#L300) |  |
| [301](#L301) | } |
| [302](#L302) |  |
| [303](#L303) | }else{ |
| [304](#L304) | $order->add\_order\_note('SHA hash did not matched for this transaction. Please contact support <a href="http://www.indatos.com/wordpress-support/">contact plugin support</a> for help.'); |
| [305](#L305) | } |
| [306](#L306) | $redirect\_url = $order->get\_checkout\_order\_received\_url(); |
| [307](#L307) | $this->web\_redirect( $redirect\_url); exit; |
| [308](#L308) | } |
| [309](#L309) | else{ |
| [310](#L310) |  |
| [311](#L311) | $redirect\_url = $temp\_order->get\_checkout\_order\_received\_url(); |
| [312](#L312) | $this->web\_redirect($redirect\_url.'?msg=Unknown\_error\_occured'); |
| [313](#L313) | exit; |
| [314](#L314) | } |
| [315](#L315) | } |
| [316](#L316) |  |
| [317](#L317) |  |
| [318](#L318) | public function web\_redirect($url){ |
| [319](#L319) |  |
| [320](#L320) | echo "<html><head><script language=\"javascript\"> |
| [321](#L321) | <!-- |
| [322](#L322) | window.location=\"{$url}\"; |
| [323](#L323) | //--> |
| [324](#L324) | </script> |
| [325](#L325) | </head><body><noscript><meta http-equiv=\"refresh\" content=\"0;url={$url}\"></noscript>REDIRECTING...</body></html>"; |
| [326](#L326) |  |
| [327](#L327) | } |
| [328](#L328) | /\*\* |
| [329](#L329) | \* Generate authorize.net button link |
| [330](#L330) | \*\*/ |
| [331](#L331) | public function generate\_authorize\_form($order\_id) |
| [332](#L332) | { |
| [333](#L333) | global $woocommerce; |
| [334](#L334) |  |
| [335](#L335) | $order         = new WC\_Order($order\_id); |
| [336](#L336) | $timeStamp     = time(); |
| [337](#L337) | $order\_total   = $order->get\_total(); |
| [338](#L338) | $signatureKey  = ($this->signature\_key != '') ? $this->signature\_key : ''; |
| [339](#L339) |  |
| [340](#L340) |  |
| [341](#L341) | $hash\_d        = hash\_hmac('sha512', sprintf('%s^%s^%s^%s^', |
| [342](#L342) | $this->login, |
| [343](#L343) | $order\_id, |
| [344](#L344) | $timeStamp, |
| [345](#L345) | $order\_total |
| [346](#L346) | ), hex2bin($signatureKey)); |
| [347](#L347) |  |
| [348](#L348) |  |
| [349](#L349) | $relay\_url = get\_site\_url().'/wc-api/'.get\_class( $this ); |
| [350](#L350) | $authorize\_args = array( |
| [351](#L351) |  |
| [352](#L352) | 'x\_login'                  => $this->login, |
| [353](#L353) | 'x\_amount'                 => $order\_total, |
| [354](#L354) | 'x\_invoice\_num'            => $order\_id, |
| [355](#L355) | 'x\_relay\_response'         => "TRUE", |
| [356](#L356) | 'x\_relay\_url'              => $relay\_url, |
| [357](#L357) | 'x\_fp\_sequence'            => $order\_id, |
| [358](#L358) | 'x\_fp\_hash'                => $hash\_d, |
| [359](#L359) | 'x\_show\_form'              => 'PAYMENT\_FORM', |
| [360](#L360) | 'x\_version'                => '3.1', |
| [361](#L361) | 'x\_fp\_timestamp'           => $timeStamp, |
| [362](#L362) | 'x\_first\_name'             => $order->get\_billing\_first\_name() , |
| [363](#L363) | 'x\_last\_name'              => $order->get\_billing\_last\_name() , |
| [364](#L364) | 'x\_company'                => $order->get\_billing\_company() , |
| [365](#L365) | 'x\_address'                => $order->get\_billing\_address\_1() .' '. $order->get\_billing\_address\_2(), |
| [366](#L366) | 'x\_country'                => $order->get\_billing\_country(), |
| [367](#L367) | 'x\_state'                  => $order->get\_billing\_state(), |
| [368](#L368) | 'x\_city'                   => $order->get\_billing\_city(), |
| [369](#L369) | 'x\_zip'                    => $order->get\_billing\_postcode(), |
| [370](#L370) | 'x\_phone'                  => $order->get\_billing\_phone(), |
| [371](#L371) | 'x\_email'                  => $order->get\_billing\_email(), |
| [372](#L372) | 'x\_ship\_to\_first\_name'     => $order->get\_shipping\_first\_name() , |
| [373](#L373) | 'x\_ship\_to\_last\_name'      => $order->get\_shipping\_last\_name() , |
| [374](#L374) | 'x\_ship\_to\_company'        => $order->get\_shipping\_company() , |
| [375](#L375) | 'x\_ship\_to\_address'        => $order->get\_shipping\_address\_1() .' '. $order->get\_shipping\_address\_2(), |
| [376](#L376) | 'x\_ship\_to\_country'        => $order->get\_shipping\_country(), |
| [377](#L377) | 'x\_ship\_to\_state'          => $order->get\_shipping\_state(), |
| [378](#L378) | 'x\_ship\_to\_city'           => $order->get\_shipping\_city(), |
| [379](#L379) | 'x\_ship\_to\_zip'            => $order->get\_shipping\_postcode(), |
| [380](#L380) | 'x\_cancel\_url'             => wc\_get\_checkout\_url(), |
| [381](#L381) | 'x\_freight'                => $order->get\_total\_shipping(), |
| [382](#L382) | 'x\_cancel\_url\_text'        => 'Cancel Payment' |
| [383](#L383) | ); |
| [384](#L384) |  |
| [385](#L385) |  |
| [386](#L386) | if( $this->transaction\_mode == 'authorize' ){ |
| [387](#L387) | $authorize\_args['x\_type'] = 'AUTH\_ONLY'; |
| [388](#L388) | }else{ |
| [389](#L389) | $authorize\_args['x\_type'] = 'AUTH\_CAPTURE'; |
| [390](#L390) |  |
| [391](#L391) | } |
| [392](#L392) |  |
| [393](#L393) | if( $this->mode == 'false\_test' ){ |
| [394](#L394) | $authorize\_args['x\_test\_request'] = 'TRUE'; |
| [395](#L395) | }else{ |
| [396](#L396) | $authorize\_args['x\_test\_request'] = 'FALSE'; |
| [397](#L397) |  |
| [398](#L398) | } |
| [399](#L399) |  |
| [400](#L400) | if( $this->working\_mode == 'false' ){ |
| [401](#L401) | $authorize\_args['x\_solution\_id'] = 'AAA172029'; |
| [402](#L402) | } |
| [403](#L403) |  |
| [404](#L404) |  |
| [405](#L405) | $authorize\_args\_array = array(); |
| [406](#L406) |  |
| [407](#L407) | foreach($authorize\_args as $key => $value){ |
| [408](#L408) | $authorize\_args\_array[] = "<input type='hidden' name='$key' value='$value'/>"; |
| [409](#L409) | } |
| [410](#L410) |  |
| [411](#L411) | if($this->mode == 'true'){ |
| [412](#L412) | $processURI = $this->testurl; |
| [413](#L413) | } |
| [414](#L414) | else{ |
| [415](#L415) | $processURI = $this->liveurl; |
| [416](#L416) | } |
| [417](#L417) |  |
| [418](#L418) | $html\_form    = '<form action="'.$processURI.'" method="post" id="authorize\_payment\_form">' |
| [419](#L419) | . implode('', $authorize\_args\_array) |
| [420](#L420) | . '<input type="submit" class="button" id="submit\_authorize\_payment\_form" value="'.\_\_('Pay via Authorize.net', 'tech').'" /> <a class="button cancel" href="'.$order->get\_cancel\_order\_url().'">'.\_\_('Cancel order &amp; restore cart', 'tech').'</a>' |
| [421](#L421) | . '<script type="text/javascript"> |
| [422](#L422) | jQuery(function(){ |
| [423](#L423) | jQuery("body").block({ |
| [424](#L424) | message: "<img src=\"'.plugin\_dir\_url( \_\_FILE\_\_ ).'images/loader.gif\" alt=\"Redirecting…\" style=\"float:left; margin-right: 10px; width:48px;\" />'.\_\_('Thank you for your order. We are now redirecting you to Authorize.net to make payment.', 'tech').'", |
| [425](#L425) | overlayCSS: |
| [426](#L426) | { |
| [427](#L427) | background:       "#ccc", |
| [428](#L428) | opacity:          0.6, |
| [429](#L429) | "z-index": "99999999999999999999999999999999" |
| [430](#L430) | }, |
| [431](#L431) | css: { |
| [432](#L432) | padding:          20, |
| [433](#L433) | textAlign:        "center", |
| [434](#L434) | color:            "#555", |
| [435](#L435) | border:           "3px solid #aaa", |
| [436](#L436) | backgroundColor:  "#fff", |
| [437](#L437) | cursor:           "wait", |
| [438](#L438) | lineHeight:       "32px", |
| [439](#L439) | "z-index": "999999999999999999999999999999999", |
| [440](#L440) |  |
| [441](#L441) | } |
| [442](#L442) | }); |
| [443](#L443) | jQuery("#submit\_authorize\_payment\_form").click(); |
| [444](#L444) | }); |
| [445](#L445) | </script> |
| [446](#L446) | </form>'; |
| [447](#L447) |  |
| [448](#L448) | return $html\_form; |
| [449](#L449) | } |
| [450](#L450) |  |
| [451](#L451) |  |
| [452](#L452) | } |
| [453](#L453) |  |
| [454](#L454) | /\*\* |
| [455](#L455) | \* Add this Gateway to WooCommerce |
| [456](#L456) | \*\*/ |
| [457](#L457) | function woocommerce\_add\_tech\_autho\_gateway($methods) |
| [458](#L458) | { |
| [459](#L459) | $methods[] = 'WC\_Tech\_Autho'; |
| [460](#L460) | return $methods; |
| [461](#L461) | } |
| [462](#L462) |  |
| [463](#L463) | add\_filter('woocommerce\_payment\_gateways', 'woocommerce\_add\_tech\_autho\_gateway' ); |
| [464](#L464) | } |
| [465](#L465) | $utils  = new Indatos\_Authorizenetbasic\_Utils(); |
| [466](#L466) | add\_filter( 'plugin\_action\_links\_' . plugin\_basename(\_\_FILE\_\_), 'authsim\_action\_links' ); |
| [467](#L467) | function authsim\_action\_links ( $links ) { |
| [468](#L468) | $authsim\_links = array( |
| [469](#L469) | '<a href="admin.php?page=wc-settings&tab=checkout&section=authorize" >Settings</a>', |
| [470](#L470) | '<a href="http://www.indatos.com/wordpress-support/?ref=plugin" target="\_blank">Support</a>', |
| [471](#L471) | '<a href="https://www.indatos.com/products/authorize-net-woocommerce-plugin-certified-solution/?utm=sim" >Buy Authorize.net Certified</a>' |
| [472](#L472) |  |
| [473](#L473) | ); |
| [474](#L474) | return array\_merge( $links, $authsim\_links ); |
| [475](#L475) | } |
| [476](#L476) |  |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/authorizenet-payment-gateway-for-woocommerce/trunk/index.php?format=txt)
* [Original Format](/export/3220651/authorizenet-payment-gateway-for-woocommerce/trunk/index.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_2d2637c3_20250111_100540.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Authorize.net Payment Gateway For WooCommerce <= 8.0 - Insufficient Verification of Data Authenticity to Unauthenticated Payment Bypass

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Authorize.net Payment Gateway For WooCommerce <= 8.0 - Insufficient Verification of Data Authenticity to Unauthenticated Payment Bypass

5.3

**Insufficient Verification of Data Authenticity**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)

| CVE | [CVE-2024-2382](https://www.cve.org/CVERecord?id=CVE-2024-2382) |
| --- | --- |
| CVSS | 5.3 (Medium) |
| Publicly Published | June 3, 2024 |
| Last Updated | June 4, 2024 |
| Researcher | [Lucio Sá](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lucio-sa) |

### Description

The Authorize.net Payment Gateway For WooCommerce plugin for WordPress is vulnerable to payment bypass in all versions up to, and including, 8.0. This is due to the plugin not properly verifying the authenticity of the request that updates a orders payment status. This makes it possible for unauthenticated attackers to update order payment statuses to paid bypassing any payment.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/authorizenet-payment-gateway-for-woocommerce/trunk/index.php#L205)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fauthorizenet-payment-gateway-for-woocommerce%2Fauthorizenet-payment-gateway-for-woocommerce-80-insufficient-verification-of-data-authenticity-to-unauthenticated-payment-bypass&t=Authorize.net%20Payment%20Gateway%20For%20WooCommerce%20%3C%3D%208.0%20-%20Insufficient%20Verification%20of%20Data%20Authenticity%20to%20Unauthenticated%20Payment%20Bypass "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fauthorizenet-payment-gateway-for-woocommerce%2Fauthorizenet-payment-gateway-for-woocommerce-80-insufficient-verification-of-data-authenticity-to-unauthenticated-payment-bypass&text=Authorize.net%20Payment%20Gateway%20For%20WooCommerce%20%3C%3D%208.0%20-%20Insufficient%20Verification%20of%20Data%20Authenticity%20to%20Unauthenticated%20Payment%20Bypass "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fauthorizenet-payment-gateway-for-woocommerce%2Fauthorizenet-payment-gateway-for-woocommerce-80-insufficient-verification-of-data-authenticity-to-unauthenticated-payment-bypass "LinkedIn")
Email

## Vulnerability Details for Authorize.net Payment Gateway For WooCommerce

#### [Authorize.net Payment Gateway For WooCommerce](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/authorizenet-payment-gateway-for-woocommerce)

| Software Type | Plugin |
| --- | --- |
| Software Slug | authorizenet-payment-gateway-for-woocommerce [(view on wordpress.org)](https://wordpress.org/plugins/authorizenet-payment-gateway-for-woocommerce) |
| Patched? | No |
| Remediation | No known patch available. Please review the vulnerability's details in depth and employ mitigations based on your organization's risk tolerance. It may be best to uninstall the affected software and find a replacement. |
| Affected Version | * <= 8.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


