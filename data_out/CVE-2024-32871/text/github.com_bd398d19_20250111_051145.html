
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fsecurity%2Fadvisories%2FGHSA-277c-5vvj-9pwx)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fsecurity%2Fadvisories%2FGHSA-277c-5vvj-9pwx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=pimcore%2Fpimcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pimcore](/pimcore)
/
**[pimcore](/pimcore/pimcore)**
Public

* [Notifications](/login?return_to=%2Fpimcore%2Fpimcore) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fpimcore%2Fpimcore)
* [Star
   3.5k](/login?return_to=%2Fpimcore%2Fpimcore)

* [Code](/pimcore/pimcore)
* [Issues
  431](/pimcore/pimcore/issues)
* [Pull requests
  43](/pimcore/pimcore/pulls)
* [Discussions](/pimcore/pimcore/discussions)
* [Actions](/pimcore/pimcore/actions)
* [Security](/pimcore/pimcore/security)
* [Insights](/pimcore/pimcore/pulse)

Additional navigation options

* [Code](/pimcore/pimcore)
* [Issues](/pimcore/pimcore/issues)
* [Pull requests](/pimcore/pimcore/pulls)
* [Discussions](/pimcore/pimcore/discussions)
* [Actions](/pimcore/pimcore/actions)
* [Security](/pimcore/pimcore/security)
* [Insights](/pimcore/pimcore/pulse)

# Flooding Server with Thumbnail files

High

[wisconaut](/wisconaut)
published
GHSA-277c-5vvj-9pwx
Jun 4, 2024

## Package

composer

pimcore/pimcore
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

11.x

## Patched versions

11.2.4

## Description

# Summary

We ([@jheimbach](https://github.com/jheimbach), [@dandanx](https://github.com/dandanx)) found multiple problems with Pimcore Thumbnail generation that can be used to flood the server with large files.

# Details

## 1. All Imagick supported Fileformats are served without filtering

The Thumbnail endpoint does not check against any filters what file formats should be served. We can transcode the image in all formats imagemagick supports. With that we can create Files that are much larger in filesize than the original. For example we can create a .txt file for all thumbnails, and we get the text representation of the image.

We can demonstrate that with the pimcore demo:

This Thumbnail is found on the Frontend: <https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89.avif> (12kb Filesize)

We can generate a text representation by simply changing the file extension: <https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89.txt> (4.59mb Filesize)

Other (large) fileformats we tested: ftxt, dip, bmp, bmp3, bmp2, farbfeld, cmyk, cmyka, ycbcr, ycbcra and many more (just check imagemagick supported formats)

With that we can fill the available space of a server really easy.

With formats like yaml or json we can also expose exif data of the original image file - could be a concern with gps data in user uploaded images.

### TLDR

* we can generate all imagemagick supported formats with all thumbnail configs
* all configs were the format is set to "auto (Web-optimized)" are vulnerable
* private (exif) data can be exposed.
* We can flood the the server with a bunch of files that are a multiple magnitudes of the original thumbnail size (see txt example), for all thumbnail configs, with every image that we find (scriptable)

### Proposed Solution

Implement a list of allowed formats that the developer can modify if needed, if a file is requested in another format than listed, pimcore should return either "/bundles/pimcoreadmin/img/filetype-not-supported.svg" or a 404.

```
pimcore:
    thumbnails:
    	allowed_formats: ['jpg', 'png', 'avif', 'webp', 'gif']
```

For non-maintained Pimcore versions (<11), the webserver config could be used to only serve files that should be allowed.

## 2. Non Web optimized file formats (ORIGINAL, JPG, PNG) creates duplicated files on Server

With Thumbnail config that are configured to serve non web optimized file formats (such as ORIGINAL, jpg, png, print, etc) we can create files with arbitrary file formats that are saved to disk.

For example, the thumbnail configuration "print\_backgroundimage" (in the pimcore demo) can be used to create files such as:

<https://demo.pimcore.fun/Car%20Images/jaguar/3/image-thumb__3__print_backgroundimage/auto-3095119.aaa>

<https://demo.pimcore.fun/Car%20Images/jaguar/3/image-thumb__3__print_backgroundimage/auto-3095119.aab>

<https://demo.pimcore.fun/Car%20Images/jaguar/3/image-thumb__3__print_backgroundimage/auto-3095119.aac>

Each request creates a new copy of the original (jpg) thumbnail file. The server can be flooded with a bunch of files.

Code for this mechanism is here: <https://github.com/pimcore/pimcore/blob/11.x/models/Asset/Service.php#L621-L623>

### Proposed Solution

Use same filtered list from "All Imagick supported Fileformats are served without filtering" and do not copy the arbitrary file to disk, just serve the original image file under the "new" name.

## 3. Scaling Factor is not limited and can be modified via url

We can scale each thumbnail to an arbitrary factor with @x added to the request url.

For example:

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@1x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%401x.avif)

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@1.01x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%401.01x.avif)

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@1.08x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%401.08x.avif)

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@2x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%402x.avif)

If the thumbnail config allows "forced" resizing, we could also do something like:

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@192x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%40192x.avif)

Each request will create a new file, flooding the server with more files.

If the factor is big enough, we can also max out the CPU with a single request for quite some time (only really a problem with "forced")

In combination with the first vulnerability we can also generate (large) text files for scaled images:

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@4x.txt](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%404x.txt) (6.6 mb filesize)

### Proposed solution

Limit scale factors with an allowlist:

```
pimcore:
    thumbnails:
    	allowed_scale_factors: [1.25, 1.5, 2, 4]
```
# Impact

All Pimcore Instances are affected, as far as we can see, also all versions

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2024-32871

### Weaknesses

[CWE-770](/advisories?query=cwe%3A770)

### Credits

* [![@jheimbach](https://avatars.githubusercontent.com/u/1742040?s=40&v=4)](/jheimbach)
  [jheimbach](/jheimbach)
  Reporter
* [![@dandanx](https://avatars.githubusercontent.com/u/504698?s=40&v=4)](/dandanx)
  [dandanx](/dandanx)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

