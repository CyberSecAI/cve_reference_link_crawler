=== Content from github.com_bd398d19_20250111_051145.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fsecurity%2Fadvisories%2FGHSA-277c-5vvj-9pwx)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fsecurity%2Fadvisories%2FGHSA-277c-5vvj-9pwx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=pimcore%2Fpimcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pimcore](/pimcore)
/
**[pimcore](/pimcore/pimcore)**
Public

* [Notifications](/login?return_to=%2Fpimcore%2Fpimcore) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fpimcore%2Fpimcore)
* [Star
   3.5k](/login?return_to=%2Fpimcore%2Fpimcore)

* [Code](/pimcore/pimcore)
* [Issues
  431](/pimcore/pimcore/issues)
* [Pull requests
  43](/pimcore/pimcore/pulls)
* [Discussions](/pimcore/pimcore/discussions)
* [Actions](/pimcore/pimcore/actions)
* [Security](/pimcore/pimcore/security)
* [Insights](/pimcore/pimcore/pulse)

Additional navigation options

* [Code](/pimcore/pimcore)
* [Issues](/pimcore/pimcore/issues)
* [Pull requests](/pimcore/pimcore/pulls)
* [Discussions](/pimcore/pimcore/discussions)
* [Actions](/pimcore/pimcore/actions)
* [Security](/pimcore/pimcore/security)
* [Insights](/pimcore/pimcore/pulse)

# Flooding Server with Thumbnail files

High

[wisconaut](/wisconaut)
published
GHSA-277c-5vvj-9pwx
Jun 4, 2024

## Package

composer

pimcore/pimcore
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

11.x

## Patched versions

11.2.4

## Description

# Summary

We ([@jheimbach](https://github.com/jheimbach), [@dandanx](https://github.com/dandanx)) found multiple problems with Pimcore Thumbnail generation that can be used to flood the server with large files.

# Details

## 1. All Imagick supported Fileformats are served without filtering

The Thumbnail endpoint does not check against any filters what file formats should be served. We can transcode the image in all formats imagemagick supports. With that we can create Files that are much larger in filesize than the original. For example we can create a .txt file for all thumbnails, and we get the text representation of the image.

We can demonstrate that with the pimcore demo:

This Thumbnail is found on the Frontend: <https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89.avif> (12kb Filesize)

We can generate a text representation by simply changing the file extension: <https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89.txt> (4.59mb Filesize)

Other (large) fileformats we tested: ftxt, dip, bmp, bmp3, bmp2, farbfeld, cmyk, cmyka, ycbcr, ycbcra and many more (just check imagemagick supported formats)

With that we can fill the available space of a server really easy.

With formats like yaml or json we can also expose exif data of the original image file - could be a concern with gps data in user uploaded images.

### TLDR

* we can generate all imagemagick supported formats with all thumbnail configs
* all configs were the format is set to "auto (Web-optimized)" are vulnerable
* private (exif) data can be exposed.
* We can flood the the server with a bunch of files that are a multiple magnitudes of the original thumbnail size (see txt example), for all thumbnail configs, with every image that we find (scriptable)

### Proposed Solution

Implement a list of allowed formats that the developer can modify if needed, if a file is requested in another format than listed, pimcore should return either "/bundles/pimcoreadmin/img/filetype-not-supported.svg" or a 404.

```
pimcore:
    thumbnails:
    	allowed_formats: ['jpg', 'png', 'avif', 'webp', 'gif']
```

For non-maintained Pimcore versions (<11), the webserver config could be used to only serve files that should be allowed.

## 2. Non Web optimized file formats (ORIGINAL, JPG, PNG) creates duplicated files on Server

With Thumbnail config that are configured to serve non web optimized file formats (such as ORIGINAL, jpg, png, print, etc) we can create files with arbitrary file formats that are saved to disk.

For example, the thumbnail configuration "print\_backgroundimage" (in the pimcore demo) can be used to create files such as:

<https://demo.pimcore.fun/Car%20Images/jaguar/3/image-thumb__3__print_backgroundimage/auto-3095119.aaa>

<https://demo.pimcore.fun/Car%20Images/jaguar/3/image-thumb__3__print_backgroundimage/auto-3095119.aab>

<https://demo.pimcore.fun/Car%20Images/jaguar/3/image-thumb__3__print_backgroundimage/auto-3095119.aac>

Each request creates a new copy of the original (jpg) thumbnail file. The server can be flooded with a bunch of files.

Code for this mechanism is here: <https://github.com/pimcore/pimcore/blob/11.x/models/Asset/Service.php#L621-L623>

### Proposed Solution

Use same filtered list from "All Imagick supported Fileformats are served without filtering" and do not copy the arbitrary file to disk, just serve the original image file under the "new" name.

## 3. Scaling Factor is not limited and can be modified via url

We can scale each thumbnail to an arbitrary factor with @x added to the request url.

For example:

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@1x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%401x.avif)

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@1.01x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%401.01x.avif)

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@1.08x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%401.08x.avif)

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@2x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%402x.avif)

If the thumbnail config allows "forced" resizing, we could also do something like:

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@192x.avif](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%40192x.avif)

Each request will create a new file, flooding the server with more files.

If the factor is big enough, we can also max out the CPU with a single request for quite some time (only really a problem with "forced")

In combination with the first vulnerability we can also generate (large) text files for scaled images:

[https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb\_\_317\_\_standardTeaser/11.8c64bd89@4x.txt](https://demo.pimcore.fun/Sample%20Content/Background%20Images/317/image-thumb__317__standardTeaser/11.8c64bd89%404x.txt) (6.6 mb filesize)

### Proposed solution

Limit scale factors with an allowlist:

```
pimcore:
    thumbnails:
    	allowed_scale_factors: [1.25, 1.5, 2, 4]
```
# Impact

All Pimcore Instances are affected, as far as we can see, also all versions

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2024-32871

### Weaknesses

[CWE-770](/advisories?query=cwe%3A770)

### Credits

* [![@jheimbach](https://avatars.githubusercontent.com/u/1742040?s=40&v=4)](/jheimbach)
  [jheimbach](/jheimbach)
  Reporter
* [![@dandanx](https://avatars.githubusercontent.com/u/504698?s=40&v=4)](/dandanx)
  [dandanx](/dandanx)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b8f7cff0_20250111_051143.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fcommit%2F38af70b3130f16fc27f2aea34e2943d7bdaaba06)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fcommit%2F38af70b3130f16fc27f2aea34e2943d7bdaaba06)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pimcore%2Fpimcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pimcore](/pimcore)
/
**[pimcore](/pimcore/pimcore)**
Public

* [Notifications](/login?return_to=%2Fpimcore%2Fpimcore) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fpimcore%2Fpimcore)
* [Star
   3.5k](/login?return_to=%2Fpimcore%2Fpimcore)

* [Code](/pimcore/pimcore)
* [Issues
  431](/pimcore/pimcore/issues)
* [Pull requests
  43](/pimcore/pimcore/pulls)
* [Discussions](/pimcore/pimcore/discussions)
* [Actions](/pimcore/pimcore/actions)
* [Security](/pimcore/pimcore/security)
* [Insights](/pimcore/pimcore/pulse)

Additional navigation options

* [Code](/pimcore/pimcore)
* [Issues](/pimcore/pimcore/issues)
* [Pull requests](/pimcore/pimcore/pulls)
* [Discussions](/pimcore/pimcore/discussions)
* [Actions](/pimcore/pimcore/actions)
* [Security](/pimcore/pimcore/security)
* [Insights](/pimcore/pimcore/pulse)

## Commit

[Permalink](/pimcore/pimcore/commit/38af70b3130f16fc27f2aea34e2943d7bdaaba06)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix thumbnail generation if asset or config is null

[Browse files](/pimcore/pimcore/tree/38af70b3130f16fc27f2aea34e2943d7bdaaba06)
Browse the repository at this point in the history

* Loading branch information

[![@mattamon](https://avatars.githubusercontent.com/u/38959016?s=40&v=4)](/mattamon)

[mattamon](/pimcore/pimcore/commits?author=mattamon "View all commits by mattamon")
committed
May 13, 2024

1 parent
[825dd6f](/pimcore/pimcore/commit/825dd6f8bb44bdca6d5945e2bdd9ca6dcf24a9b6)

commit 38af70b

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**31 additions**
and
**17 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* models/Asset

  + Document

    - models/Asset/Document/ImageThumbnail.php
      [ImageThumbnail.php](#diff-c812583a60c34c23ab000a9fdbf0b38d5b1b66d7c10e4e48635c5a90a0cafc2a)
  + Image

    - models/Asset/Image/Thumbnail.php
      [Thumbnail.php](#diff-c1144c6a30525acb9f7006167ec8142edec7f4e974123db8824f11af57cfb4e6)
  + Thumbnail

    - models/Asset/Thumbnail/ImageThumbnailTrait.php
      [ImageThumbnailTrait.php](#diff-b48489e5be12fb4a4ec4f716c03e4690a799c39a87430cbb1a435d7badebf97c)
  + Video

    - models/Asset/Video/ImageThumbnail.php
      [ImageThumbnail.php](#diff-811119a3c592bcb32844b87edc2134235c0c5d55de765662f6753a079aba2ff2)

## There are no files selected for viewing

9 changes: 5 additions & 4 deletions

9
[models/Asset/Document/ImageThumbnail.php](#diff-c812583a60c34c23ab000a9fdbf0b38d5b1b66d7c10e4e48635c5a90a0cafc2a "models/Asset/Document/ImageThumbnail.php")

Show comments

[View file](/pimcore/pimcore/blob/38af70b3130f16fc27f2aea34e2943d7bdaaba06/models/Asset/Document/ImageThumbnail.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -76,14 +76,15 @@ public function getPath(array $args = []): string |
|  |  | \*/ |
|  |  | public function generate(bool $deferredAllowed = true): void |
|  |  | { |
|  |  | if (!$this->checkAllowedFormats($this->config->getFormat(), $this->asset)) { |
|  |  | throw new ThumbnailFormatNotSupportedException(); |
|  |  | } |
|  |  |  |
|  |  | $deferred = $deferredAllowed && $this->deferred; |
|  |  | $generated = false; |
|  |  |  |
|  |  | if ($this->asset && empty($this->pathReference)) { |
|  |  |  |
|  |  | if (!$this->checkAllowedFormats($this->config->getFormat(), $this->asset)) { |
|  |  | throw new ThumbnailFormatNotSupportedException(); |
|  |  | } |
|  |  |  |
|  |  | $config = $this->getConfig(); |
|  |  | $cacheFileStream = null; |
|  |  | $config->setFilenameSuffix('page-' . $this->page); |
| Expand Down | |  |

26 changes: 19 additions & 7 deletions

26
[models/Asset/Image/Thumbnail.php](#diff-c1144c6a30525acb9f7006167ec8142edec7f4e974123db8824f11af57cfb4e6 "models/Asset/Image/Thumbnail.php")

Show comments

[View file](/pimcore/pimcore/blob/38af70b3130f16fc27f2aea34e2943d7bdaaba06/models/Asset/Image/Thumbnail.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -112,13 +112,7 @@ protected function useOriginalFile(string $filename): bool |
|  |  | \*/ |
|  |  | public function generate(bool $deferredAllowed = true): void |
|  |  | { |
|  |  | if (!$this->checkAllowedFormats($this->config->getFormat(), $this->asset)) { |
|  |  | throw new ThumbnailFormatNotSupportedException(); |
|  |  | } |
|  |  |  |
|  |  | if (!$this->checkMaxScalingFactor($this->config->getHighResolution())) { |
|  |  | throw new ThumbnailMaxScalingFactorException(); |
|  |  | } |
|  |  | $this->validate(); |
|  |  |  |
|  |  | $deferred = false; |
|  |  | $generated = false; |
| Expand Down  Expand Up | | @@ -460,4 +454,22 @@ private function getSrcset(Config $thumbConfig, Image $image, array $options, ?s |
|  |  |  |
|  |  | return implode(', ', $srcSetValues); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @throws ThumbnailFormatNotSupportedException |
|  |  | \* @throws ThumbnailMaxScalingFactorException |
|  |  | \*/ |
|  |  | private function validate(): void |
|  |  | { |
|  |  | if(!$this->asset || !$this->config) { |
|  |  | return; |
|  |  | } |
|  |  | if (!$this->checkAllowedFormats($this->config->getFormat(), $this->asset)) { |
|  |  | throw new ThumbnailFormatNotSupportedException(); |
|  |  | } |
|  |  |  |
|  |  | if (!$this->checkMaxScalingFactor($this->config->getHighResolution())) { |
|  |  | throw new ThumbnailMaxScalingFactorException(); |
|  |  | } |
|  |  | } |
|  |  | } |

2 changes: 1 addition & 1 deletion

2
[models/Asset/Thumbnail/ImageThumbnailTrait.php](#diff-b48489e5be12fb4a4ec4f716c03e4690a799c39a87430cbb1a435d7badebf97c "models/Asset/Thumbnail/ImageThumbnailTrait.php")

Show comments

[View file](/pimcore/pimcore/blob/38af70b3130f16fc27f2aea34e2943d7bdaaba06/models/Asset/Thumbnail/ImageThumbnailTrait.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -434,7 +434,7 @@ private function checkAllowedFormats(string $format, ?Asset $asset = null): bool |
|  |  | { |
|  |  | $format = strtolower($format); |
|  |  | if($asset) { |
|  |  | $original = pathinfo($asset->getRealFullPath(), PATHINFO\_EXTENSION); |
|  |  | $original = strtolower(pathinfo($asset->getRealFullPath(), PATHINFO\_EXTENSION)); |
|  |  | if ($format === $original || $format === 'source') { |
|  |  | return true; |
|  |  | } |
| Expand Down | |  |

11 changes: 6 additions & 5 deletions

11
[models/Asset/Video/ImageThumbnail.php](#diff-811119a3c592bcb32844b87edc2134235c0c5d55de765662f6753a079aba2ff2 "models/Asset/Video/ImageThumbnail.php")

Show comments

[View file](/pimcore/pimcore/blob/38af70b3130f16fc27f2aea34e2943d7bdaaba06/models/Asset/Video/ImageThumbnail.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -77,20 +77,21 @@ public function getPath(array $args = []): string |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @throws Exception |
|  |  | \* @throws Exception|\League\Flysystem\FilesystemException|ThumbnailFormatNotSupportedException |
|  |  | \* |
|  |  | \* @internal |
|  |  | \*/ |
|  |  | public function generate(bool $deferredAllowed = true): void |
|  |  | { |
|  |  | if (!$this->checkAllowedFormats($this->config->getFormat(), $this->asset)) { |
|  |  | throw new ThumbnailFormatNotSupportedException(); |
|  |  | } |
|  |  |  |
|  |  | $deferred = $deferredAllowed && $this->deferred; |
|  |  | $generated = false; |
|  |  |  |
|  |  | if ($this->asset && empty($this->pathReference)) { |
|  |  |  |
|  |  | if (!$this->checkAllowedFormats($this->config->getFormat(), $this->asset)) { |
|  |  | throw new ThumbnailFormatNotSupportedException(); |
|  |  | } |
|  |  |  |
|  |  | $cs = $this->asset->getCustomSetting('image\_thumbnail\_time'); |
|  |  | $im = $this->asset->getCustomSetting('image\_thumbnail\_asset'); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `38af70b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fcommit%2F38af70b3130f16fc27f2aea34e2943d7bdaaba06) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3c631f23_20250111_051144.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fcommit%2Fa6821a16ea38086bf6012e682e1743488244bd85)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fcommit%2Fa6821a16ea38086bf6012e682e1743488244bd85)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pimcore%2Fpimcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pimcore](/pimcore)
/
**[pimcore](/pimcore/pimcore)**
Public

* [Notifications](/login?return_to=%2Fpimcore%2Fpimcore) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fpimcore%2Fpimcore)
* [Star
   3.5k](/login?return_to=%2Fpimcore%2Fpimcore)

* [Code](/pimcore/pimcore)
* [Issues
  431](/pimcore/pimcore/issues)
* [Pull requests
  43](/pimcore/pimcore/pulls)
* [Discussions](/pimcore/pimcore/discussions)
* [Actions](/pimcore/pimcore/actions)
* [Security](/pimcore/pimcore/security)
* [Insights](/pimcore/pimcore/pulse)

Additional navigation options

* [Code](/pimcore/pimcore)
* [Issues](/pimcore/pimcore/issues)
* [Pull requests](/pimcore/pimcore/pulls)
* [Discussions](/pimcore/pimcore/discussions)
* [Actions](/pimcore/pimcore/actions)
* [Security](/pimcore/pimcore/security)
* [Insights](/pimcore/pimcore/pulse)

## Commit

[Permalink](/pimcore/pimcore/commit/a6821a16ea38086bf6012e682e1743488244bd85)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-277c-5vvj-9pwx](https://github.com/advisories/GHSA-277c-5vvj-9pwx "GHSA-277c-5vvj-9pwx")

[Browse files](/pimcore/pimcore/tree/a6821a16ea38086bf6012e682e1743488244bd85)
Browse the repository at this point in the history

```
* Introduce allowed formats and max scale factor

* Add documentation, upgrade notes and use floatNode for max_scale_factor

* Update to max_scaling_factor

* Cast format to lower

* Fix typo
```

* Loading branch information

[![@mattamon](https://avatars.githubusercontent.com/u/38959016?s=40&v=4)](/mattamon)

[mattamon](/pimcore/pimcore/commits?author=mattamon "View all commits by mattamon")
authored
May 3, 2024

1 parent
[5dc4513](/pimcore/pimcore/commit/5dc451381218d0b039a3796fa89994fc4ea5c6df)

commit a6821a1

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**177 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* bundles/CoreBundle/src/DependencyInjection

  + bundles/CoreBundle/src/DependencyInjection/Configuration.php
    [Configuration.php](#diff-bab0da2e129502ead20a1f1ac979fd2260c5d4c8da202b6a8fbf1e9d906d4541)
* doc

  + 04\_Assets/03\_Working\_with\_Thumbnails

    - doc/04\_Assets/03\_Working\_with\_Thumbnails/01\_Image\_Thumbnails.md
      [01\_Image\_Thumbnails.md](#diff-24538f57bc72728a20f0cc486d4678a9d3d838a15a407f5bf62fd44a47604e61)
    - doc/04\_Assets/03\_Working\_with\_Thumbnails/README.md
      [README.md](#diff-4ce7688e141857f0cf1d238feb5ace0f3ac4e360630f78b082b86af29a1e9a7f)
  + 23\_Installation\_and\_Upgrade/09\_Upgrade\_Notes

    - doc/23\_Installation\_and\_Upgrade/09\_Upgrade\_Notes/README.md
      [README.md](#diff-375aded12dfb868b84d5b8c27d1aed2358680a27b683e8a985f1b85193dd79aa)
* models

  + Asset

    - Document

      * models/Asset/Document/ImageThumbnail.php
        [ImageThumbnail.php](#diff-c812583a60c34c23ab000a9fdbf0b38d5b1b66d7c10e4e48635c5a90a0cafc2a)
    - Image

      * models/Asset/Image/Thumbnail.php
        [Thumbnail.php](#diff-c1144c6a30525acb9f7006167ec8142edec7f4e974123db8824f11af57cfb4e6)
    - Thumbnail

      * models/Asset/Thumbnail/ImageThumbnailTrait.php
        [ImageThumbnailTrait.php](#diff-b48489e5be12fb4a4ec4f716c03e4690a799c39a87430cbb1a435d7badebf97c)
    - Video

      * models/Asset/Video/ImageThumbnail.php
        [ImageThumbnail.php](#diff-811119a3c592bcb32844b87edc2134235c0c5d55de765662f6753a079aba2ff2)
  + Exception

    - models/Exception/ThumbnailFormatNotSupportedException.php
      [ThumbnailFormatNotSupportedException.php](#diff-b8e39349a183563a5586c0b02da4d777b22ef4a004aff0c9e3cf676162595617)
    - models/Exception/ThumbnailMaxScalingFactorException.php
      [ThumbnailMaxScalingFactorException.php](#diff-4242e3561dc7b736483bf51ed99c46bad991adc451623beb7b4b177fbec65f54)

## There are no files selected for viewing

12 changes: 12 additions & 0 deletions

12
[bundles/CoreBundle/src/DependencyInjection/Configuration.php](#diff-bab0da2e129502ead20a1f1ac979fd2260c5d4c8da202b6a8fbf1e9d906d4541 "bundles/CoreBundle/src/DependencyInjection/Configuration.php")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/bundles/CoreBundle/src/DependencyInjection/Configuration.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -352,6 +352,18 @@ private function addAssetNode(ArrayNodeDefinition $rootNode): void |
|  |  | ->arrayNode('assets') |
|  |  | ->addDefaultsIfNotSet() |
|  |  | ->children() |
|  |  | ->arrayNode('thumbnails') |
|  |  | ->addDefaultsIfNotSet() |
|  |  | ->children() |
|  |  | ->arrayNode('allowed\_formats') |
|  |  | ->defaultValue(['avif', 'eps', 'gif', 'jpeg', 'jpg', 'pjpeg', 'png', 'svg', 'tiff', 'webm', 'webp']) |
|  |  | ->scalarPrototype()->end() |
|  |  | ->end() |
|  |  | ->floatNode('max\_scaling\_factor') |
|  |  | ->defaultValue(5.0) |
|  |  | ->end() |
|  |  | ->end() |
|  |  | ->end() |
|  |  | ->arrayNode('frontend\_prefixes') |
|  |  | ->addDefaultsIfNotSet() |
|  |  | ->children() |
| Expand Down | |  |

12 changes: 11 additions & 1 deletion

12
[doc/04\_Assets/03\_Working\_with\_Thumbnails/01\_Image\_Thumbnails.md](#diff-24538f57bc72728a20f0cc486d4678a9d3d838a15a407f5bf62fd44a47604e61 "doc/04_Assets/03_Working_with_Thumbnails/01_Image_Thumbnails.md")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/doc/04_Assets/03_Working_with_Thumbnails/01_Image_Thumbnails.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -9,7 +9,8 @@ which are not stored as an asset inside Pimcore. |
|  |  | > \*\*IMPORTANT\*\* |
|  |  | > Use Imagick PECL extension for best results, GDlib is just a fallback with limited functionality |
|  |  | > (only PNG, JPG, GIF) and less quality! |
|  |  | > Using ImageMagick Pimcore supports hundreds of formats including: AI, EPS, TIFF, PNG, JPG, GIF, PSD, ... |
|  |  | > Using ImageMagick Pimcore can support hundreds of formats including: AI, EPS, TIFF, PNG, JPG, GIF, PSD, etc. |
|  |  | > Not all formats are allowed out of the box. To extend the list [see](./README.md#allowed-formats). |
|  |  |  |
|  |  | To use the thumbnailing service of Pimcore, you have to create a transformation pipeline first. To do so, open |
|  |  | \_Settings\_ > \_Thumbnails\_ and click on \_Add Thumbnail\_ to create a new configuration. |
| Expand Down  Expand Up | | @@ -329,6 +330,15 @@ This is a special functionality to allow embedding high resolution (ppi/dpi) ima |
|  |  | The following is only necessary in special use-cases like Web-to-Print, in typical web-based cases, Pimcore |
|  |  | automatically adds the `srcset` attribute to `<img>` and `<picture>` tags automatically, so no manual work is necessary. |
|  |  |  |
|  |  | The high resolution scaling factor is limited to `5.0` eg. `@5x`. Float values are supported. |
|  |  | If you need to scale an image more than that, you can use the `max\_scaling\_factor` option in the configuration. |
|  |  | ```yaml |
|  |  | pimcore: |
|  |  | assets: |
|  |  | thumbnails: |
|  |  | max\_scaling\_factor: 6.0 |
|  |  | ``` |
|  |  |  |
|  |  | ### Use in the Thumbnail Configuration: |
|  |  |  |
|  |  | ![High Resolution](../../img/thumbnail\_high\_resolution.png) |
| Expand Down | |  |

27 changes: 26 additions & 1 deletion

27
[doc/04\_Assets/03\_Working\_with\_Thumbnails/README.md](#diff-4ce7688e141857f0cf1d238feb5ace0f3ac4e360630f78b082b86af29a1e9a7f "doc/04_Assets/03_Working_with_Thumbnails/README.md")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/doc/04_Assets/03_Working_with_Thumbnails/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -4,7 +4,32 @@ Pimcore provides a sophisticated thumbnail processing engine for calculating thu |
|  |  | different output channels Pimcore can calculate and provide optimized images in terms of dimensions, file sizes, formats |
|  |  | and much more. |
|  |  |  |
|  |  | This functionality allows true single source publishing with Pimcore. |
|  |  | This functionality allows true single source publishing with Pimcore. |
|  |  |  |
|  |  | ### Allowed formats |
|  |  | Pimcore allows the following formats for thumbnails out of the box: |
|  |  | `'avif', 'eps', 'gif', 'jpeg', 'jpg', 'pjpeg', 'png', 'svg', 'tiff', 'webm', 'webp'`. |
|  |  |  |
|  |  | If you want to use a different format, you can easily extend the list of supported formats. |
|  |  | Keep in mind that you must copy the whole list of formats and add your desired format to it. |
|  |  | ```yaml |
|  |  | pimcore: |
|  |  | assets: |
|  |  | thumbnails: |
|  |  | allowed\_formats: |
|  |  | - 'avif' |
|  |  | - 'eps' |
|  |  | - 'gif' |
|  |  | - 'jpeg' |
|  |  | - 'jpg' |
|  |  | - 'pjpeg' |
|  |  | - 'png' |
|  |  | - 'svg' |
|  |  | - 'tiff' |
|  |  | - 'webm' |
|  |  | - 'webp' |
|  |  | - 'pdf' # Add your desired format here |
|  |  | ``` |
|  |  |  |
|  |  | ##### Thumbnails are available for following file types: |
|  |  | \* [Image Thumbnails](./01\_Image\_Thumbnails.md) |
| Expand Down | |  |

30 changes: 30 additions & 0 deletions

30
[doc/23\_Installation\_and\_Upgrade/09\_Upgrade\_Notes/README.md](#diff-375aded12dfb868b84d5b8c27d1aed2358680a27b683e8a985f1b85193dd79aa "doc/23_Installation_and_Upgrade/09_Upgrade_Notes/README.md")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/doc/23_Installation_and_Upgrade/09_Upgrade_Notes/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,5 +1,35 @@ |
|  |  | # Upgrade Notes |
|  |  |  |
|  |  | ## Pimcore 11.2.4 |
|  |  | ### Assets Thumbnails |
|  |  | - Thumbnail generation for Assets, Documents and Videos now only support the following formats out of the box: `'avif', 'eps', 'gif', 'jpeg', 'jpg', 'pjpeg', 'png', 'svg', 'tiff', 'webm', 'webp'`. |
|  |  | - You can extend this list by adding your formats on the bottom: |
|  |  | ```yaml |
|  |  | pimcore: |
|  |  | assets: |
|  |  | thumbnails: |
|  |  | allowed\_formats: |
|  |  | - 'avif' |
|  |  | - 'eps' |
|  |  | - 'gif' |
|  |  | - 'jpeg' |
|  |  | - 'jpg' |
|  |  | - 'pjpeg' |
|  |  | - 'png' |
|  |  | - 'svg' |
|  |  | - 'tiff' |
|  |  | - 'webm' |
|  |  | - 'webp' |
|  |  | - 'pdf' # Add your desired format here |
|  |  | ``` |
|  |  | - High resolution scaling factor for image thumbnails has now been limited to a maximum of `5.0`. If you need to scale an image more than that, you can use the `max\_scaling\_factor` option in the configuration. |
|  |  | ```yaml |
|  |  | pimcore: |
|  |  | assets: |
|  |  | thumbnails: |
|  |  | max\_scaling\_factor: 6.0 |
|  |  | ``` |
|  |  |  |
|  |  | ## Pimcore 11.2.0 |
|  |  | ### Elements |
|  |  | #### [Documents]: |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[models/Asset/Document/ImageThumbnail.php](#diff-c812583a60c34c23ab000a9fdbf0b38d5b1b66d7c10e4e48635c5a90a0cafc2a "models/Asset/Document/ImageThumbnail.php")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/models/Asset/Document/ImageThumbnail.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,6 +24,7 @@ |
|  |  | use Pimcore\Model; |
|  |  | use Pimcore\Model\Asset\Image; |
|  |  | use Pimcore\Model\Exception\NotFoundException; |
|  |  | use Pimcore\Model\Exception\ThumbnailFormatNotSupportedException; |
|  |  | use Pimcore\Tool\Storage; |
|  |  | use Symfony\Component\EventDispatcher\GenericEvent; |
|  |  | use Symfony\Component\Lock\LockFactory; |
| Expand Down  Expand Up | | @@ -70,8 +71,15 @@ public function getPath(array $args = []): string |
|  |  | return $path; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @throws ThumbnailFormatNotSupportedException |
|  |  | \*/ |
|  |  | public function generate(bool $deferredAllowed = true): void |
|  |  | { |
|  |  | if (!$this->checkAllowedFormats($this->config->getFormat())) { |
|  |  | throw new ThumbnailFormatNotSupportedException(); |
|  |  | } |
|  |  |  |
|  |  | $deferred = $deferredAllowed && $this->deferred; |
|  |  | $generated = false; |
|  |  |  |
| Expand Down | |  |

12 changes: 12 additions & 0 deletions

12
[models/Asset/Image/Thumbnail.php](#diff-c1144c6a30525acb9f7006167ec8142edec7f4e974123db8824f11af57cfb4e6 "models/Asset/Image/Thumbnail.php")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/models/Asset/Image/Thumbnail.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,6 +24,8 @@ |
|  |  | use Pimcore\Model\Asset\Image\Thumbnail\Config; |
|  |  | use Pimcore\Model\Asset\Thumbnail\ImageThumbnailTrait; |
|  |  | use Pimcore\Model\Exception\NotFoundException; |
|  |  | use Pimcore\Model\Exception\ThumbnailFormatNotSupportedException; |
|  |  | use Pimcore\Model\Exception\ThumbnailMaxScalingFactorException; |
|  |  | use Pimcore\Tool; |
|  |  | use Symfony\Component\EventDispatcher\GenericEvent; |
|  |  |  |
| Expand Down  Expand Up | | @@ -103,10 +105,20 @@ protected function useOriginalFile(string $filename): bool |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @throws ThumbnailFormatNotSupportedException |
|  |  | \* @throws ThumbnailMaxScalingFactorException |
|  |  | \* @internal |
|  |  | \*/ |
|  |  | public function generate(bool $deferredAllowed = true): void |
|  |  | { |
|  |  | if (!$this->checkAllowedFormats($this->config->getFormat(), $this->asset)) { |
|  |  | throw new ThumbnailFormatNotSupportedException(); |
|  |  | } |
|  |  |  |
|  |  | if (!$this->checkMaxScalingFactor($this->config->getHighResolution())) { |
|  |  | throw new ThumbnailMaxScalingFactorException(); |
|  |  | } |
|  |  |  |
|  |  | $deferred = false; |
|  |  | $generated = false; |
|  |  |  |
| Expand Down | |  |

25 changes: 25 additions & 0 deletions

25
[models/Asset/Thumbnail/ImageThumbnailTrait.php](#diff-b48489e5be12fb4a4ec4f716c03e4690a799c39a87430cbb1a435d7badebf97c "models/Asset/Thumbnail/ImageThumbnailTrait.php")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/models/Asset/Thumbnail/ImageThumbnailTrait.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,6 +16,7 @@ |
|  |  |  |
|  |  | namespace Pimcore\Model\Asset\Thumbnail; |
|  |  |  |
|  |  | use Pimcore\Config as PimcoreConfig; |
|  |  | use Pimcore\Helper\TemporaryFileHelperTrait; |
|  |  | use Pimcore\Model\Asset; |
|  |  | use Pimcore\Model\Asset\Image; |
| Expand Down  Expand Up | | @@ -428,4 +429,28 @@ public function getAsFormat(string $format): static |
|  |  |  |
|  |  | return $thumb; |
|  |  | } |
|  |  |  |
|  |  | private function checkAllowedFormats(string $format, ?Asset $asset = null): bool |
|  |  | { |
|  |  | $format = strtolower($format); |
|  |  | if($asset) { |
|  |  | $original = pathinfo($asset->getRealFullPath(), PATHINFO\_EXTENSION); |
|  |  | if ($format === $original || $format === 'source') { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | $assetConfig = PimcoreConfig::getSystemConfiguration('assets'); |
|  |  | return in\_array( |
|  |  | $format, |
|  |  | $assetConfig['thumbnails']['allowed\_formats'], |
|  |  | true |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | private function checkMaxScalingFactor(float $scalingFactor): bool |
|  |  | { |
|  |  | $assetConfig = PimcoreConfig::getSystemConfiguration('assets'); |
|  |  | return $scalingFactor <= $assetConfig['thumbnails']['max\_scaling\_factor']; |
|  |  | } |
|  |  | } |

8 changes: 7 additions & 1 deletion

8
[models/Asset/Video/ImageThumbnail.php](#diff-811119a3c592bcb32844b87edc2134235c0c5d55de765662f6753a079aba2ff2 "models/Asset/Video/ImageThumbnail.php")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/models/Asset/Video/ImageThumbnail.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,12 +16,14 @@ |
|  |  |  |
|  |  | namespace Pimcore\Model\Asset\Video; |
|  |  |  |
|  |  | use Exception; |
|  |  | use Pimcore\Event\AssetEvents; |
|  |  | use Pimcore\Event\FrontendEvents; |
|  |  | use Pimcore\File; |
|  |  | use Pimcore\Logger; |
|  |  | use Pimcore\Model; |
|  |  | use Pimcore\Model\Asset\Image; |
|  |  | use Pimcore\Model\Exception\ThumbnailFormatNotSupportedException; |
|  |  | use Pimcore\Tool\Storage; |
|  |  | use Symfony\Component\EventDispatcher\GenericEvent; |
|  |  | use Symfony\Component\Lock\LockFactory; |
| Expand Down  Expand Up | | @@ -75,12 +77,16 @@ public function getPath(array $args = []): string |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @throws \Exception |
|  |  | \* @throws Exception |
|  |  | \* |
|  |  | \* @internal |
|  |  | \*/ |
|  |  | public function generate(bool $deferredAllowed = true): void |
|  |  | { |
|  |  | if (!$this->checkAllowedFormats($this->config->getFormat())) { |
|  |  | throw new ThumbnailFormatNotSupportedException(); |
|  |  | } |
|  |  |  |
|  |  | $deferred = $deferredAllowed && $this->deferred; |
|  |  | $generated = false; |
|  |  |  |
| Expand Down | |  |

23 changes: 23 additions & 0 deletions

23
[models/Exception/ThumbnailFormatNotSupportedException.php](#diff-b8e39349a183563a5586c0b02da4d777b22ef4a004aff0c9e3cf676162595617 "models/Exception/ThumbnailFormatNotSupportedException.php")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/models/Exception/ThumbnailFormatNotSupportedException.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,23 @@ |
|  |  | <?php |
|  |  | declare(strict\_types=1); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Pimcore |
|  |  | \* |
|  |  | \* This source file is available under two different licenses: |
|  |  | \* - GNU General Public License version 3 (GPLv3) |
|  |  | \* - Pimcore Commercial License (PCL) |
|  |  | \* Full copyright and license information is available in |
|  |  | \* LICENSE.md which is distributed with this source code. |
|  |  | \* |
|  |  | \* @copyright Copyright (c) Pimcore GmbH (http://www.pimcore.org) |
|  |  | \* @license http://www.pimcore.org/license GPLv3 and PCL |
|  |  | \*/ |
|  |  |  |
|  |  | namespace Pimcore\Model\Exception; |
|  |  |  |
|  |  | use Exception; |
|  |  |  |
|  |  | final class ThumbnailFormatNotSupportedException extends Exception |
|  |  | { |
|  |  | } |

23 changes: 23 additions & 0 deletions

23
[models/Exception/ThumbnailMaxScalingFactorException.php](#diff-4242e3561dc7b736483bf51ed99c46bad991adc451623beb7b4b177fbec65f54 "models/Exception/ThumbnailMaxScalingFactorException.php")

Show comments

[View file](/pimcore/pimcore/blob/a6821a16ea38086bf6012e682e1743488244bd85/models/Exception/ThumbnailMaxScalingFactorException.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,23 @@ |
|  |  | <?php |
|  |  | declare(strict\_types=1); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Pimcore |
|  |  | \* |
|  |  | \* This source file is available under two different licenses: |
|  |  | \* - GNU General Public License version 3 (GPLv3) |
|  |  | \* - Pimcore Commercial License (PCL) |
|  |  | \* Full copyright and license information is available in |
|  |  | \* LICENSE.md which is distributed with this source code. |
|  |  | \* |
|  |  | \* @copyright Copyright (c) Pimcore GmbH (http://www.pimcore.org) |
|  |  | \* @license http://www.pimcore.org/license GPLv3 and PCL |
|  |  | \*/ |
|  |  |  |
|  |  | namespace Pimcore\Model\Exception; |
|  |  |  |
|  |  | use Exception; |
|  |  |  |
|  |  | final class ThumbnailMaxScalingFactorException extends Exception |
|  |  | { |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a6821a1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpimcore%2Fpimcore%2Fcommit%2Fa6821a16ea38086bf6012e682e1743488244bd85) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


