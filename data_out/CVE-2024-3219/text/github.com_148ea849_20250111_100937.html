
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fpull%2F122134)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fpull%2F122134)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=python%2Fcpython)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[python](/python)
/
**[cpython](/python/cpython)**
Public

* [Notifications](/login?return_to=%2Fpython%2Fcpython) You must be signed in to change notification settings
* [Fork
  30.8k](/login?return_to=%2Fpython%2Fcpython)
* [Star
   64.7k](/login?return_to=%2Fpython%2Fcpython)

* [Code](/python/cpython)
* [Issues
  5k+](/python/cpython/issues)
* [Pull requests
  1.8k](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects
  28](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

Additional navigation options

* [Code](/python/cpython)
* [Issues](/python/cpython/issues)
* [Pull requests](/python/cpython/pulls)
* [Actions](/python/cpython/actions)
* [Projects](/python/cpython/projects)
* [Security](/python/cpython/security)
* [Insights](/python/cpython/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpython%2Fcpython%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpython%2Fcpython%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# gh-122133: Authenticate socket connection for `socket.socketpair()` fallback #122134

 Merged

[gpshead](/gpshead)
merged 6 commits into
[python:main](/python/cpython/tree/main "python/cpython:main")
from
[sethmlarson:socketpair-auth](/sethmlarson/cpython/tree/socketpair-auth "sethmlarson/cpython:socketpair-auth")

Jul 29, 2024

 Merged

# [gh-122133: Authenticate socket connection for `socket.socketpair()` fallback](#top) #122134

[gpshead](/gpshead)
merged 6 commits into
[python:main](/python/cpython/tree/main "python/cpython:main")
from
[sethmlarson:socketpair-auth](/sethmlarson/cpython/tree/socketpair-auth "sethmlarson/cpython:socketpair-auth")

Jul 29, 2024

[Conversation
52](/python/cpython/pull/122134)
[Commits
6](/python/cpython/pull/122134/commits)
[Checks
59](/python/cpython/pull/122134/checks)
[Files changed](/python/cpython/pull/122134/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=60&v=4)](/sethmlarson)

Copy link

Contributor

### @sethmlarson **[sethmlarson](/sethmlarson)** commented [Jul 22, 2024](#issue-2423478021) ‚Ä¢ edited by bedevere-app bot Loading

Socket connection for the `socket.socketpair()` fallback isn't authenticated. This changes this connection to authenticate the connection is the same expected process.

* Issue: [Pure-Python implementation of socket.socketpair() doesn't authenticate connected socket¬†#122133](https://github.com/python/cpython/issues/122133)

Sorry, something went wrong.

 üëç
2
 gpshead and ell1e reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&v=4)](/sethmlarson) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[Authenticate socket connection for socket.socketpair() fallback](/python/cpython/pull/122134/commits/d079ce3d362bd36ef3c95b50215e249afdd4a200 "Authenticate socket connection for `socket.socketpair()` fallback

Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
 ‚Ä¶

`[d079ce3](/python/cpython/pull/122134/commits/d079ce3d362bd36ef3c95b50215e249afdd4a200)`

```
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson)
[sethmlarson](/sethmlarson)
added
[type-security](/python/cpython/labels/type-security)
A security issue
[OS-windows](/python/cpython/labels/OS-windows)
labels
[Jul 22, 2024](#event-13605110798)

 [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson)
[sethmlarson](/sethmlarson)
requested review from
[gpshead](/gpshead) and
[zooba](/zooba)
[July 22, 2024 18:15](#event-13605110829)

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
mentioned this pull request
[Jul 22, 2024](#ref-issue-2423461729)

[Pure-Python implementation of socket.socketpair() doesn't authenticate connected socket
#122133](/python/cpython/issues/122133)

Closed

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
added
the
[awaiting review](/python/cpython/labels/awaiting%20review)
label
[Jul 22, 2024](#event-13605112927)

[![@njsmith](https://avatars.githubusercontent.com/u/609896?s=80&u=935a2bf5f98be8c08d87eaac095f1f3bc3332490&v=4)](/njsmith)

Copy link

Contributor

### **[njsmith](/njsmith)** commented [Jul 23, 2024](#issuecomment-2244101850)

| alternative approach: check `sock1.getpeername() == sock2.getsockname()` and vice-versa? |
| --- |

 ‚ù§Ô∏è
1
 gpshead reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[![picnixz](https://avatars.githubusercontent.com/u/10796600?s=60&v=4)](/picnixz)

**[picnixz](/picnixz)**
reviewed
[Jul 23, 2024](#pullrequestreview-2193508270)

 [View reviewed changes](/python/cpython/pull/122134/files/d079ce3d362bd36ef3c95b50215e249afdd4a200)

[Lib/socket.py](/python/cpython/pull/122134/files/d079ce3d362bd36ef3c95b50215e249afdd4a200#diff-081d33d48e9390350bb1ef860c52de799d1647b58e33b07173ae2549532cbfbe)
Outdated

Show resolved

Hide resolved

[Lib/socket.py](/python/cpython/pull/122134/files/d079ce3d362bd36ef3c95b50215e249afdd4a200#diff-081d33d48e9390350bb1ef860c52de799d1647b58e33b07173ae2549532cbfbe)
Outdated

Show resolved

Hide resolved

[Lib/socket.py](/python/cpython/pull/122134/files/d079ce3d362bd36ef3c95b50215e249afdd4a200#diff-081d33d48e9390350bb1ef860c52de799d1647b58e33b07173ae2549532cbfbe)
Outdated

Show resolved

Hide resolved

[Lib/socket.py](/python/cpython/pull/122134/files/d079ce3d362bd36ef3c95b50215e249afdd4a200#diff-081d33d48e9390350bb1ef860c52de799d1647b58e33b07173ae2549532cbfbe)
Outdated

Show resolved

Hide resolved

[Lib/test/test\_socket.py](/python/cpython/pull/122134/files/d079ce3d362bd36ef3c95b50215e249afdd4a200#diff-ce79808e12f7a252c1747c23ba11810d4dc22ce0af4b9419bac647ad3a2a8389)
Outdated

Show resolved

Hide resolved

[Lib/socket.py](/python/cpython/pull/122134/files/d079ce3d362bd36ef3c95b50215e249afdd4a200#diff-081d33d48e9390350bb1ef860c52de799d1647b58e33b07173ae2549532cbfbe)
Outdated

Show resolved

Hide resolved

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&v=4)](/sethmlarson)

`[Authenticate with getsocketname and getpeername](/python/cpython/pull/122134/commits/e08f3fb4ed781cd728b925b9e17ae07e75405fea "Authenticate with getsocketname and getpeername")`

`[e08f3fb](/python/cpython/pull/122134/commits/e08f3fb4ed781cd728b925b9e17ae07e75405fea)`

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=80&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson)

Copy link

Contributor

Author

### **[sethmlarson](/sethmlarson)** commented [Jul 23, 2024](#issuecomment-2246151815)

| [@njsmith](https://github.com/njsmith) I went ahead with your approach, it seems sound to me by checking the port. See: [e08f3fb](https://github.com/python/cpython/commit/e08f3fb4ed781cd728b925b9e17ae07e75405fea) |
| --- |

 üëç
1
 gpshead reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&v=4)](/sethmlarson)

`[Remove time import](/python/cpython/pull/122134/commits/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a "Remove time import")`

`[fcb43e9](/python/cpython/pull/122134/commits/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a)`

 [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson)
[sethmlarson](/sethmlarson)
requested a review
from [picnixz](/picnixz)
[July 23, 2024 21:05](#event-13621583958)

[![picnixz](https://avatars.githubusercontent.com/u/10796600?s=60&v=4)](/picnixz)

**[picnixz](/picnixz)**
reviewed
[Jul 24, 2024](#pullrequestreview-2196048465)

 [View reviewed changes](/python/cpython/pull/122134/files/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a)

[Lib/socket.py](/python/cpython/pull/122134/files/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a#diff-081d33d48e9390350bb1ef860c52de799d1647b58e33b07173ae2549532cbfbe)
Outdated

Show resolved

Hide resolved

[Lib/socket.py](/python/cpython/pull/122134/files/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a#diff-081d33d48e9390350bb1ef860c52de799d1647b58e33b07173ae2549532cbfbe)
Outdated

Show resolved

Hide resolved

[Lib/test/test\_socket.py](/python/cpython/pull/122134/files/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a#diff-ce79808e12f7a252c1747c23ba11810d4dc22ce0af4b9419bac647ad3a2a8389)
Outdated

Show resolved

Hide resolved

[Lib/test/test\_socket.py](/python/cpython/pull/122134/files/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a#diff-ce79808e12f7a252c1747c23ba11810d4dc22ce0af4b9419bac647ad3a2a8389)

Show resolved

Hide resolved

[Lib/test/test\_socket.py](/python/cpython/pull/122134/files/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a#diff-ce79808e12f7a252c1747c23ba11810d4dc22ce0af4b9419bac647ad3a2a8389)
Outdated

Show resolved

Hide resolved

[Lib/test/test\_socket.py](/python/cpython/pull/122134/files/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a#diff-ce79808e12f7a252c1747c23ba11810d4dc22ce0af4b9419bac647ad3a2a8389)

Show resolved

Hide resolved

[Misc/NEWS.d/next/Security/2024-07-22-13-11-28.gh-issue-122133.0mPeta.rst](/python/cpython/pull/122134/files/fcb43e91cce9fe9b6dc027f6b8955a128e0e310a#diff-269287ed280308c8c792893fa87e34ba782671da05d914d4ea1d83a0b64a4e87)
Outdated

Show resolved

Hide resolved

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&v=4)](/sethmlarson)

`[Address review comments](/python/cpython/pull/122134/commits/fe5da2d40a054b58c58275a77201557d1f8b13ff "Address review comments")`

`[fe5da2d](/python/cpython/pull/122134/commits/fe5da2d40a054b58c58275a77201557d1f8b13ff)`

 [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson)
[sethmlarson](/sethmlarson)
requested a review
from [picnixz](/picnixz)
[July 25, 2024 15:18](#event-13648038221)

[![picnixz](https://avatars.githubusercontent.com/u/10796600?s=60&v=4)](/picnixz)

**[picnixz](/picnixz)**
approved these changes
[Jul 25, 2024](#pullrequestreview-2199682561)

 [View reviewed changes](/python/cpython/pull/122134/files/fe5da2d40a054b58c58275a77201557d1f8b13ff)

Copy link

Contributor

### @picnixz **[picnixz](/picnixz)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Except for the last `call_socketpair` refactorization, I personally don't have anything else to say on that PR so I'll leave it to experts now :)

Sorry, something went wrong.

All reactions

[Lib/test/test\_socket.py](/python/cpython/pull/122134/files/fe5da2d40a054b58c58275a77201557d1f8b13ff#diff-ce79808e12f7a252c1747c23ba11810d4dc22ce0af4b9419bac647ad3a2a8389)
Outdated

Show resolved

Hide resolved

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
added
[awaiting core review](/python/cpython/labels/awaiting%20core%20review)
and removed
[awaiting review](/python/cpython/labels/awaiting%20review)
labels
[Jul 25, 2024](#event-13648517059)

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&v=4)](/sethmlarson)

`[Complete refactor from call_socketpair() to socketpair()](/python/cpython/pull/122134/commits/76522138935283586868c8d189e231d2e4c24286 "Complete refactor from call_socketpair() to socketpair()")`

`[7652213](/python/cpython/pull/122134/commits/76522138935283586868c8d189e231d2e4c24286)`

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)
[gpshead](/gpshead)
added
the
[üî® test-with-buildbots](/python/cpython/labels/%3Ahammer%3A%20test-with-buildbots)
Test PR w/ buildbots; report in status section
label
[Jul 25, 2024](#event-13650889259)

[![@bedevere-bot](https://avatars.githubusercontent.com/u/28579281?s=80&u=63eee11d3b5474c37a942e04a41607f58b3b0c3d&v=4)](/bedevere-bot)

Copy link

### **[bedevere-bot](/bedevere-bot)** commented [Jul 25, 2024](#issuecomment-2251054503)

| ü§ñ New build scheduled with the buildbot fleet by [@gpshead](https://github.com/gpshead) for commit [7652213](https://github.com/python/cpython/commit/76522138935283586868c8d189e231d2e4c24286) ü§ñ  If you want to schedule another build, you need to add the `üî® test-with-buildbots` label again. |
| --- |

All reactions

Sorry, something went wrong.

[![@bedevere-bot](https://avatars.githubusercontent.com/u/28579281?s=40&u=63eee11d3b5474c37a942e04a41607f58b3b0c3d&v=4)](/bedevere-bot)
[bedevere-bot](/bedevere-bot)
removed
the
[üî® test-with-buildbots](/python/cpython/labels/%3Ahammer%3A%20test-with-buildbots)
Test PR w/ buildbots; report in status section
label
[Jul 25, 2024](#event-13650889777)

[![graingert](https://avatars.githubusercontent.com/u/413772?s=60&v=4)](/graingert)

**[graingert](/graingert)**
reviewed
[Jul 25, 2024](#pullrequestreview-2200290735)

 [View reviewed changes](/python/cpython/pull/122134/files/76522138935283586868c8d189e231d2e4c24286)

[Lib/socket.py](/python/cpython/pull/122134/files/76522138935283586868c8d189e231d2e4c24286#diff-081d33d48e9390350bb1ef860c52de799d1647b58e33b07173ae2549532cbfbe)

Show resolved

Hide resolved

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&v=4)](/sethmlarson)

`[Try reversing order back to original](/python/cpython/pull/122134/commits/d1bc40886160e5f1f0e3b177f1f7562fe133031c "Try reversing order back to original")`

`[d1bc408](/python/cpython/pull/122134/commits/d1bc40886160e5f1f0e3b177f1f7562fe133031c)`

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson)
[sethmlarson](/sethmlarson)
added
the
[üî® test-with-buildbots](/python/cpython/labels/%3Ahammer%3A%20test-with-buildbots)
Test PR w/ buildbots; report in status section
label
[Jul 25, 2024](#event-13652999070)

[![@bedevere-bot](https://avatars.githubusercontent.com/u/28579281?s=80&u=63eee11d3b5474c37a942e04a41607f58b3b0c3d&v=4)](/bedevere-bot)

Copy link

### **[bedevere-bot](/bedevere-bot)** commented [Jul 25, 2024](#issuecomment-2251401979)

| ü§ñ New build scheduled with the buildbot fleet by [@sethmlarson](https://github.com/sethmlarson) for commit [d1bc408](https://github.com/python/cpython/commit/d1bc40886160e5f1f0e3b177f1f7562fe133031c) ü§ñ  If you want to schedule another build, you need to add the `üî® test-with-buildbots` label again. |
| --- |

All reactions

Sorry, something went wrong.

[![@bedevere-bot](https://avatars.githubusercontent.com/u/28579281?s=40&u=63eee11d3b5474c37a942e04a41607f58b3b0c3d&v=4)](/bedevere-bot)
[bedevere-bot](/bedevere-bot)
removed
the
[üî® test-with-buildbots](/python/cpython/labels/%3Ahammer%3A%20test-with-buildbots)
Test PR w/ buildbots; report in status section
label
[Jul 25, 2024](#event-13652999435)

[![gpshead](https://avatars.githubusercontent.com/u/68491?s=60&v=4)](/gpshead)

**[gpshead](/gpshead)**
approved these changes
[Jul 26, 2024](#pullrequestreview-2200712606)

 [View reviewed changes](/python/cpython/pull/122134/files/d1bc40886160e5f1f0e3b177f1f7562fe133031c)

Copy link

Member

### @gpshead **[gpshead](/gpshead)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This appears to solve the primary issue of allowing unintended potentially malicious connection from another process. I don't think adding a looping retry for the connection is worthwhile - at least as part of this issue resolution - the main goal is preventing the undesirable connection which this now does.

Sorry, something went wrong.

All reactions

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
removed
the
[awaiting core review](/python/cpython/labels/awaiting%20core%20review)
label
[Jul 26, 2024](#event-13654540965)

33 hidden items

Load more‚Ä¶

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
removed
the
[needs backport to 3.12](/python/cpython/labels/needs%20backport%20to%203.12)
bug and security fixes
label
[Jul 29, 2024](#event-13687053900)

[miss-islington](/miss-islington)
pushed a commit
to miss-islington/cpython
that referenced
this pull request
[Jul 29, 2024](#ref-commit-c590759)
[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&v=4)](/miss-islington)

`[pythongh-122133](https://github.com/python/cpython/issues/122133)[: Authenticate socket connection for `socket.socketpai‚Ä¶](/miss-islington/cpython/commit/c5907598b62d5278fe25508882c3980ab701d601 "gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134)

* Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
‚Ä¶

`[c590759](/miss-islington/cpython/commit/c5907598b62d5278fe25508882c3980ab701d601)`

```
‚Ä¶r()` fallback ([pythonGH-122134](https://github.com/python/cpython/pull/122134))

* Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit [78df104](https://github.com/miss-islington/cpython/commit/78df1043dbdce5c989600616f9f87b4ee72944e5))

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=80&v=4)](/apps/bedevere-app)

Copy link

### **[bedevere-app](/apps/bedevere-app) bot** commented [Jul 29, 2024](#issuecomment-2257063797)

| [GH-122426](https://github.com/python/cpython/pull/122426) is a backport of this pull request to the [3.11 branch](https://github.com/python/cpython/tree/3.11). |
| --- |

All reactions

Sorry, something went wrong.

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
removed
the
[needs backport to 3.11](/python/cpython/labels/needs%20backport%20to%203.11)
only security fixes
label
[Jul 29, 2024](#event-13687054621)

[miss-islington](/miss-islington)
pushed a commit
to miss-islington/cpython
that referenced
this pull request
[Jul 29, 2024](#ref-commit-9f83e2b)
[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&v=4)](/miss-islington)

`[pythongh-122133](https://github.com/python/cpython/issues/122133)[: Authenticate socket connection for `socket.socketpai‚Ä¶](/miss-islington/cpython/commit/9f83e2b6bf9881813a09ab94fa6b89f4c83e628e "gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134)

* Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
‚Ä¶

`[9f83e2b](/miss-islington/cpython/commit/9f83e2b6bf9881813a09ab94fa6b89f4c83e628e)`

```
‚Ä¶r()` fallback ([pythonGH-122134](https://github.com/python/cpython/pull/122134))

* Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit [78df104](https://github.com/miss-islington/cpython/commit/78df1043dbdce5c989600616f9f87b4ee72944e5))

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=80&v=4)](/apps/bedevere-app)

Copy link

### **[bedevere-app](/apps/bedevere-app) bot** commented [Jul 29, 2024](#issuecomment-2257063867)

| [GH-122427](https://github.com/python/cpython/pull/122427) is a backport of this pull request to the [3.10 branch](https://github.com/python/cpython/tree/3.10). |
| --- |

All reactions

Sorry, something went wrong.

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
removed
the
[needs backport to 3.10](/python/cpython/labels/needs%20backport%20to%203.10)
only security fixes
label
[Jul 29, 2024](#event-13687055242)

[miss-islington](/miss-islington)
pushed a commit
to miss-islington/cpython
that referenced
this pull request
[Jul 29, 2024](#ref-commit-7be6ba7)
[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&v=4)](/miss-islington)

`[pythongh-122133](https://github.com/python/cpython/issues/122133)[: Authenticate socket connection for `socket.socketpai‚Ä¶](/miss-islington/cpython/commit/7be6ba757cc36c9b9277dca6762e1f6f859a7293 "gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134)

* Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
‚Ä¶

`[7be6ba7](/miss-islington/cpython/commit/7be6ba757cc36c9b9277dca6762e1f6f859a7293)`

```
‚Ä¶r()` fallback ([pythonGH-122134](https://github.com/python/cpython/pull/122134))

* Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit [78df104](https://github.com/miss-islington/cpython/commit/78df1043dbdce5c989600616f9f87b4ee72944e5))

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=80&v=4)](/apps/bedevere-app)

Copy link

### **[bedevere-app](/apps/bedevere-app) bot** commented [Jul 29, 2024](#issuecomment-2257063955)

| [GH-122428](https://github.com/python/cpython/pull/122428) is a backport of this pull request to the [3.9 branch](https://github.com/python/cpython/tree/3.9). |
| --- |

All reactions

Sorry, something went wrong.

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
removed
the
[needs backport to 3.9](/python/cpython/labels/needs%20backport%20to%203.9)
only security fixes
label
[Jul 29, 2024](#event-13687055943)

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=80&v=4)](/apps/bedevere-app)

Copy link

### **[bedevere-app](/apps/bedevere-app) bot** commented [Jul 29, 2024](#issuecomment-2257064042)

| [GH-122429](https://github.com/python/cpython/pull/122429) is a backport of this pull request to the [3.8 branch](https://github.com/python/cpython/tree/3.8). |
| --- |

All reactions

Sorry, something went wrong.

[![@bedevere-app](https://avatars.githubusercontent.com/in/388350?s=40&v=4)](/apps/bedevere-app)
[bedevere-app](/apps/bedevere-app)
bot
removed
the
[needs backport to 3.8](/python/cpython/labels/needs%20backport%20to%203.8)
label
[Jul 29, 2024](#event-13687056627)

 [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson)
[sethmlarson](/sethmlarson)
deleted the
socketpair-auth

branch
[July 29, 2024 21:45](#event-13687060140)

[gpshead](/gpshead)
added a commit
that referenced
this pull request
[Jul 29, 2024](#ref-commit-220e31a)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.12]](/python/cpython/commit/220e31adeaaa8436c9ff234cba1398bc49e2bb6c "[3.12] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (GH-122425)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-122133](https://github.com/python/cpython/issues/122133)[: Authenticate socket connection for `socket.socketpa‚Ä¶](/python/cpython/commit/220e31adeaaa8436c9ff234cba1398bc49e2bb6c "[3.12] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (GH-122425)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
‚Ä¶

`[220e31a](/python/cpython/commit/220e31adeaaa8436c9ff234cba1398bc49e2bb6c)`

```
‚Ä¶ir()` fallback ([GH-122134](https://github.com/python/cpython/pull/122134)) ([GH-122425](https://github.com/python/cpython/pull/122425))

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit [78df104](https://github.com/python/cpython/commit/78df1043dbdce5c989600616f9f87b4ee72944e5))

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[gpshead](/gpshead)
added a commit
that referenced
this pull request
[Jul 30, 2024](#ref-commit-b252317)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.13]](/python/cpython/commit/b252317956b7fc035bb3774ef6a177e227f9fc54 "[3.13] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (GH-122424)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-122133](https://github.com/python/cpython/issues/122133)[: Authenticate socket connection for `socket.socketpa‚Ä¶](/python/cpython/commit/b252317956b7fc035bb3774ef6a177e227f9fc54 "[3.13] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (GH-122424)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
‚Ä¶

`[b252317](/python/cpython/commit/b252317956b7fc035bb3774ef6a177e227f9fc54)`

```
‚Ä¶ir()` fallback ([GH-122134](https://github.com/python/cpython/pull/122134)) ([GH-122424](https://github.com/python/cpython/pull/122424))

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit [78df104](https://github.com/python/cpython/commit/78df1043dbdce5c989600616f9f87b4ee72944e5))

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[![@bedevere-bot](https://avatars.githubusercontent.com/u/28579281?s=80&u=63eee11d3b5474c37a942e04a41607f58b3b0c3d&v=4)](/bedevere-bot)

Copy link

### **[bedevere-bot](/bedevere-bot)** commented [Jul 30, 2024](#issuecomment-2257423810)

| ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Buildbot failure ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Hi! The buildbot **iOS ARM64 Simulator 3.13** has failed when building commit [b252317](https://github.com/python/cpython/commit/b252317956b7fc035bb3774ef6a177e227f9fc54).  What do you need to do:   1. Don't panic. 2. Check [the buildbot page in the devguide](https://devguide.python.org/buildbots/) if you don't know what the buildbots are or how they work. 3. Go to the page of the buildbot that failed (<https://buildbot.python.org/#builders/1386/builds/444>) and take a look at the build logs. 4. Check if the failure is related to this commit ([b252317](https://github.com/python/cpython/commit/b252317956b7fc035bb3774ef6a177e227f9fc54)) or if it is a false positive. 5. If the failure is related to this commit, please, reflect that on the issue and make a new Pull Request with a fix.   You can take a look at the buildbot page here:  <https://buildbot.python.org/#builders/1386/builds/444>  Summary of the results of the build (if available):  Click to see traceback logs ``` remote: Enumerating objects: 11, done.         remote: Counting objects:  10% (1/10)         remote: Counting objects:  20% (2/10)         remote: Counting objects:  30% (3/10)         remote: Counting objects:  40% (4/10)         remote: Counting objects:  50% (5/10)         remote: Counting objects:  60% (6/10)         remote: Counting objects:  70% (7/10)         remote: Counting objects:  80% (8/10)         remote: Counting objects:  90% (9/10)         remote: Counting objects: 100% (10/10)         remote: Counting objects: 100% (10/10), done.         remote: Compressing objects:  12% (1/8)         remote: Compressing objects:  25% (2/8)         remote: Compressing objects:  37% (3/8)         remote: Compressing objects:  50% (4/8)         remote: Compressing objects:  62% (5/8)         remote: Compressing objects:  75% (6/8)         remote: Compressing objects:  87% (7/8)         remote: Compressing objects: 100% (8/8)         remote: Compressing objects: 100% (8/8), done.         remote: Total 11 (delta 2), reused 5 (delta 2), pack-reused 1         From https://github.com/python/cpython  * branch                  3.13       -> FETCH_HEAD Note: switching to 'b252317956b7fc035bb3774ef6a177e227f9fc54'.  You are in 'detached HEAD' state. You can look around, make experimental changes and commit them, and you can discard any commits you make in this state without impacting any branches by switching back to a branch.  If you want to create a new branch to retain commits you create, you may do so (now or later) by using -c with the switch command. Example:    git switch -c <new-branch-name>  Or undo this operation with:    git switch -  Turn off this advice by setting config variable advice.detachedHead to false  HEAD is now at b252317956 [3.13] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (GH-122424) Switched to and reset branch '3.13'  configure: WARNING: no system libmpdecimal found; falling back to bundled libmpdecimal (deprecated and scheduled for removal in Python 3.15) configure: WARNING: pkg-config is missing. Some dependencies may not be detected correctly.  configure: WARNING: no system libmpdecimal found; falling back to bundled libmpdecimal (deprecated and scheduled for removal in Python 3.15) configure: WARNING: pkg-config is missing. Some dependencies may not be detected correctly.  --- xcodebuild: WARNING: Using the first of multiple matching destinations: { platform:iOS Simulator, id:C6AEA11C-C34A-47B8-BD67-AF0403ECA353, OS:17.5, name:iPhone SE (3rd generation) } { platform:iOS Simulator, id:C6AEA11C-C34A-47B8-BD67-AF0403ECA353, OS:17.5, name:iPhone SE (3rd generation) } make: *** [testios] Terminated: 15 ** BUILD INTERRUPTED ** ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@bedevere-bot](https://avatars.githubusercontent.com/u/28579281?s=80&u=63eee11d3b5474c37a942e04a41607f58b3b0c3d&v=4)](/bedevere-bot)

Copy link

### **[bedevere-bot](/bedevere-bot)** commented [Jul 30, 2024](#issuecomment-2257459462)

| ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Buildbot failure ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Hi! The buildbot **AMD64 Ubuntu NoGIL Refleaks 3.13** has failed when building commit [b252317](https://github.com/python/cpython/commit/b252317956b7fc035bb3774ef6a177e227f9fc54).  What do you need to do:   1. Don't panic. 2. Check [the buildbot page in the devguide](https://devguide.python.org/buildbots/) if you don't know what the buildbots are or how they work. 3. Go to the page of the buildbot that failed (<https://buildbot.python.org/#builders/1431/builds/338>) and take a look at the build logs. 4. Check if the failure is related to this commit ([b252317](https://github.com/python/cpython/commit/b252317956b7fc035bb3774ef6a177e227f9fc54)) or if it is a false positive. 5. If the failure is related to this commit, please, reflect that on the issue and make a new Pull Request with a fix.   You can take a look at the buildbot page here:  <https://buildbot.python.org/#builders/1431/builds/338>  Failed tests:   * test\_free\_threading   Summary of the results of the build (if available):  ==  Click to see traceback logs ``` remote: Enumerating objects: 11, done.         remote: Counting objects:  10% (1/10)         remote: Counting objects:  20% (2/10)         remote: Counting objects:  30% (3/10)         remote: Counting objects:  40% (4/10)         remote: Counting objects:  50% (5/10)         remote: Counting objects:  60% (6/10)         remote: Counting objects:  70% (7/10)         remote: Counting objects:  80% (8/10)         remote: Counting objects:  90% (9/10)         remote: Counting objects: 100% (10/10)         remote: Counting objects: 100% (10/10), done.         remote: Compressing objects:  12% (1/8)         remote: Compressing objects:  25% (2/8)         remote: Compressing objects:  37% (3/8)         remote: Compressing objects:  50% (4/8)         remote: Compressing objects:  62% (5/8)         remote: Compressing objects:  75% (6/8)         remote: Compressing objects:  87% (7/8)         remote: Compressing objects: 100% (8/8)         remote: Compressing objects: 100% (8/8), done.         remote: Total 11 (delta 2), reused 5 (delta 2), pack-reused 1         From https://github.com/python/cpython  * branch                  3.13       -> FETCH_HEAD Note: switching to 'b252317956b7fc035bb3774ef6a177e227f9fc54'.  You are in 'detached HEAD' state. You can look around, make experimental changes and commit them, and you can discard any commits you make in this state without impacting any branches by switching back to a branch.  If you want to create a new branch to retain commits you create, you may do so (now or later) by using -c with the switch command. Example:    git switch -c <new-branch-name>  Or undo this operation with:    git switch -  Turn off this advice by setting config variable advice.detachedHead to false  HEAD is now at b252317956 [3.13] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (GH-122424) Switched to and reset branch '3.13'  configure: WARNING: no system libmpdecimal found; falling back to bundled libmpdecimal (deprecated and scheduled for removal in Python 3.15)  make: *** [Makefile:2264: buildbottest] Error 2 ``` |
| --- |

All reactions

Sorry, something went wrong.

[ambv](/ambv)
pushed a commit
that referenced
this pull request
[Jul 30, 2024](#ref-commit-5f90aba)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.11]](/python/cpython/commit/5f90abaa786f994db3907fc31e2ee00ea2cf0929 "[3.11] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (#122426)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-122133](https://github.com/python/cpython/issues/122133)[: Authenticate socket connection for `socket.socketpa‚Ä¶](/python/cpython/commit/5f90abaa786f994db3907fc31e2ee00ea2cf0929 "[3.11] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (#122426)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
‚Ä¶

`[5f90aba](/python/cpython/commit/5f90abaa786f994db3907fc31e2ee00ea2cf0929)`

```
‚Ä¶ir()` fallback ([GH-122134](https://github.com/python/cpython/pull/122134)) ([#122426](https://github.com/python/cpython/pull/122426))

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit [78df104](https://github.com/python/cpython/commit/78df1043dbdce5c989600616f9f87b4ee72944e5))

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[ambv](/ambv)
pushed a commit
that referenced
this pull request
[Jul 30, 2024](#ref-commit-0b65c8b)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.10]](/python/cpython/commit/0b65c8bf5367625673eafb92f85046a1b31259f2 "[3.10] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (#122427)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-122133](https://github.com/python/cpython/issues/122133)[: Authenticate socket connection for `socket.socketpa‚Ä¶](/python/cpython/commit/0b65c8bf5367625673eafb92f85046a1b31259f2 "[3.10] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (#122427)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
‚Ä¶

`[0b65c8b](/python/cpython/commit/0b65c8bf5367625673eafb92f85046a1b31259f2)`

```
‚Ä¶ir()` fallback ([GH-122134](https://github.com/python/cpython/pull/122134)) ([#122427](https://github.com/python/cpython/pull/122427))

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit [78df104](https://github.com/python/cpython/commit/78df1043dbdce5c989600616f9f87b4ee72944e5))

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[ambv](/ambv)
pushed a commit
that referenced
this pull request
[Jul 30, 2024](#ref-commit-06fa244)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead)

`[[3.9]](/python/cpython/commit/06fa244666ec6335a3b9bf2367e31b42b9a89b20 "[3.9] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (#122428)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>") [gh-122133](https://github.com/python/cpython/issues/122133)[: Authenticate socket connection for `socket.socketpai‚Ä¶](/python/cpython/commit/06fa244666ec6335a3b9bf2367e31b42b9a89b20 "[3.9] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (#122428)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>")`
‚Ä¶

`[06fa244](/python/cpython/commit/06fa244666ec6335a3b9bf2367e31b42b9a89b20)`

```
‚Ä¶r()` fallback ([GH-122134](https://github.com/python/cpython/pull/122134)) ([#122428](https://github.com/python/cpython/pull/122428))

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit [78df104](https://github.com/python/cpython/commit/78df1043dbdce5c989600616f9f87b4ee72944e5))

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
```

[ambv](/ambv)
added a commit
that referenced
this pull request
[Jul 30, 2024](#ref-commit-2621a8a)
[![@miss-islington](https://avatars.githubusercontent.com/u/31488909?s=40&u=31ad766412aaeb40a51582d882e34d67f2fae635&v=4)](/miss-islington) [![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=40&u=41090cc65ae0a34aee49c7a35cfbd40e2e12eb53&v=4)](/sethmlarson)
[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [![@ambv](https://avatars.githubusercontent.com/u/55281?s=40&u=e9e2a4147de2bb9a92dc0b865daf89bbfa666428&v=4)](/ambv)

`[[3.8]](/python/cpython/commit/2621a8a40ba4b2c68ca564671b7daa5da80a4508 "[3.8] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (GH-122429)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
Co-authored-by: ≈Åukasz Langa <lukasz@langa.pl>") [gh-122133](https://github.com/python/cpython/issues/122133)[: Authenticate socket connection for `socket.socketpai‚Ä¶](/python/cpython/commit/2621a8a40ba4b2c68ca564671b7daa5da80a4508 "[3.8] gh-122133: Authenticate socket connection for `socket.socketpair()` fallback (GH-122134) (GH-122429)

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit 78df1043dbdce5c989600616f9f87b4ee72944e5)

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
Co-authored-by: ≈Åukasz Langa <lukasz@langa.pl>")`
‚Ä¶

`[2621a8a](/python/cpython/commit/2621a8a40ba4b2c68ca564671b7daa5da80a4508)`

```
‚Ä¶r()` fallback ([GH-122134](https://github.com/python/cpython/pull/122134)) ([GH-122429](https://github.com/python/cpython/pull/122429))

Authenticate socket connection for `socket.socketpair()` fallback when the platform does not have a native `socketpair` C API.  We authenticate in-process using `getsocketname` and `getpeername` (thanks to Nathaniel J Smith for that suggestion).

(cherry picked from commit [78df104](https://github.com/python/cpython/commit/78df1043dbdce5c989600616f9f87b4ee72944e5))

Co-authored-by: Seth Michael Larson <seth@python.org>
Co-authored-by: Gregory P. Smith <greg@krypto.org>
Co-authored-by: ≈Åukasz Langa <lukasz@langa.pl>
```

[![@ell1e](https://avatars.githubusercontent.com/u/64124388?s=80&u=01cd9a3b3d726912cfb488b037650a0ae0e7924b&v=4)](/ell1e)

Copy link

### **[ell1e](/ell1e)** commented [Jul 30, 2024](#issuecomment-2259168407)

| My apologies for missing the review window of the fix, but it looks good to me üëç |
| --- |

All reactions

Sorry, something went wrong.

[![@freakboy3742](https://avatars.githubusercontent.com/u/37345?s=80&u=06b637e2290f584cfed894b6692a5e1269049d3c&v=4)](/freakboy3742)

Copy link

Contributor

### **[freakboy3742](/freakboy3742)** commented [Jul 31, 2024](#issuecomment-2259515407)

| [@sethmlarson](https://github.com/sethmlarson) Flagging that this PR is causing a problem with the iOS buildbot (on both 3.x and 3.13).  It's causing a number of tests in `test_ssl`, `test_urllib2_localnet`, `test_urllib2net` and `test_urllibnet` to fail - but we never see these failures because both `test_wsgiref` and `test_xmlrpc` lock up and don't complete (unfortunately, with no stack trace - but it seems reasonable to assume that it might be related to a timeout and a server dying).  I'm still poking around to see if I can make sense of this; if you've got any ideas, don't be a stranger :-)  The stack trace in the failed tests is mostly consistent:  ``` Traceback (most recent call last):   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/test/test_urllibnet.py", line 180, in test_specified_path     with self.urlretrieve(self.logo,          ~~~~~~~~~~~~~~~~^^^^^^^^^^^                           os_helper.TESTFN) as (file_location, info):                           ^^^^^^^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/contextlib.py", line 141, in __enter__     return next(self.gen)   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/test/test_urllibnet.py", line 163, in urlretrieve     file_location, info = urllib.request.urlretrieve(*args, **kwargs)                           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/urllib/request.py", line 214, in urlretrieve     with contextlib.closing(urlopen(url, data)) as fp:                             ~~~~~~~^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/urllib/request.py", line 189, in urlopen     return opener.open(url, data, timeout)            ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/urllib/request.py", line 489, in open     response = self._open(req, data)   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/urllib/request.py", line 506, in _open     result = self._call_chain(self.handle_open, protocol, protocol +                               '_open', req)   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/urllib/request.py", line 466, in _call_chain     result = func(*args)   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/urllib/request.py", line 1348, in http_open     return self.do_open(http.client.HTTPConnection, req)            ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/urllib/request.py", line 1319, in do_open     h.request(req.get_method(), req.selector, req.data, headers,     ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^               encode_chunked=req.has_header('Transfer-encoding'))               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/http/client.py", line 1336, in request     self._send_request(method, url, body, headers, encode_chunked)     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/http/client.py", line 1382, in _send_request     self.endheaders(body, encode_chunked=encode_chunked)     ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/http/client.py", line 1331, in endheaders     self._send_output(message_body, encode_chunked=encode_chunked)     ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/http/client.py", line 1091, in _send_output     self.send(msg)     ~~~~~~~~~^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/http/client.py", line 1035, in send     self.connect()     ~~~~~~~~~~~~^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/http/client.py", line 1001, in connect     self.sock = self._create_connection(                 ~~~~~~~~~~~~~~~~~~~~~~~^         (self.host,self.port), self.timeout, self.source_address)         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File "/Users/buildbot/Library/Developer/XCTestDevices/A7FBDE4D-FE55-443F-A16A-ECE998C18D1D/data/Containers/Bundle/Application/CB9423FE-C897-46F8-BE6C-5A60DF83AB1A/iOSTestbed.app/python/lib/python3.14/socket.py", line 851, in create_connection     sock.settimeout(timeout)     ~~~~~~~~~~~~~~~^^^^^^^^^ TypeError: 'object' object cannot be interpreted as an integer  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=80&v=4)](/gpshead)

Copy link

Member

### **[gpshead](/gpshead)** commented [Jul 31, 2024](#issuecomment-2259525854)

| Some code smell: `socket._GLOBAL_DEFAULT_TIMEOUT = object()` in `Lib/socket.py` and `Lib/urllib/request.py`'s `timeout=socket._GLOBAL_DEFAULT_TIMEOUT` and the test this PR adds is doing `importlib.reload(socket)` so the `socket` module changes multiple times... all of these tests must be being run in the same process.  That default argument assignement to `timeout=socket._GLOBAL_DEFAULT_TIMEOUT` is referring to the singleton from the original `socket` module and our use of `.reload(socket)` has caused that singleton to be replaced multiple time so it fails any later identity checks in that scenario.  patching the test to avoid reinitializing that would be a gross hack. we should do better. must we *really* use `reload()` at all in our new tests? that looks like the underlying cause. modules can't be presumed to be reload-safe. |
| --- |

All reactions

Sorry, something went wrong.

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=80&v=4)](/gpshead)

Copy link

Member

### **[gpshead](/gpshead)** commented [Jul 31, 2024](#issuecomment-2259529818)

| Not having Lib/socket.py use a conditional definition of two different versions of the function but instead always defining the pure python socketpair, just as a `socket._fallback_socketpair` so that we could just monkeypatch over socket.socketpair for the test instead of using reload after removing it from `_socket` would be preferred.  minor downside: a little more memory use for the new `_fallback_socketpair` on platforms that otherwise never use it, and execution time to materialize that `def` upon the first `import socket`. |
| --- |

All reactions

Sorry, something went wrong.

[![@freakboy3742](https://avatars.githubusercontent.com/u/37345?s=80&u=06b637e2290f584cfed894b6692a5e1269049d3c&v=4)](/freakboy3742)

Copy link

Contributor

### **[freakboy3742](/freakboy3742)** commented [Jul 31, 2024](#issuecomment-2259544328)

| Confirming that commenting out the new test that does the `importlib.reload()` fixes the problem. I'll work up a fix following [@gpshead](https://github.com/gpshead)'s suggestion. |
| --- |

 ‚ù§Ô∏è
1
 gpshead reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[![@freakboy3742](https://avatars.githubusercontent.com/u/37345?s=40&u=06b637e2290f584cfed894b6692a5e1269049d3c&v=4)](/freakboy3742)
[freakboy3742](/freakboy3742)
mentioned this pull request
[Jul 31, 2024](#ref-pullrequest-2439034911)

[gh-122133: Rework pure Python socketpair tests to avoid use of importlib.reload.
#122493](/python/cpython/pull/122493)
 Merged

[![@mhsmith](https://avatars.githubusercontent.com/u/166954?s=80&u=1288f328e87c2fd0da6dacfba324252b85c6ca9f&v=4)](/mhsmith)

Copy link

Member

### **[mhsmith](/mhsmith)** commented [Jul 31, 2024](#issuecomment-2260385712) ‚Ä¢ edited Loading

| It's causing a number of tests in `test_ssl`, `test_urllib2_localnet`, `test_urllib2net` and `test_urllibnet` to fail  FYI: I was seeing the same failures with the same stack trace on Android, which also runs all tests in a single process. This was also fixed by [#122493](https://github.com/python/cpython/pull/122493). |
| --- |

 üëç
1
 sethmlarson reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=80&v=4)](/gpshead)

Copy link

Member

### **[gpshead](/gpshead)** commented [Jul 31, 2024](#issuecomment-2260910534)

| yep, see the issue. We reworked the test to not use `importlib.reload(socket)` in follow up PR [#122493](https://github.com/python/cpython/pull/122493) and are backporting that as well. |
| --- |

All reactions

Sorry, something went wrong.

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=80&v=4)](/cfi-gb)

Copy link

### **[cfi-gb](/cfi-gb)** commented [Aug 12, 2024](#issuecomment-2284061689)

| Only for (easier) tracking purposes (because searching for this CVE doesn't yield any results in this repo), it seems [CVE-2024-3219](https://github.com/advisories/GHSA-r8h6-cwxj-rv5j "CVE-2024-3219") is now linked to this PR:   * <https://nvd.nist.gov/vuln/detail/CVE-2024-3219> * <https://osv.dev/vulnerability/PSF-2024-7> |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fpull%2F122134)

Reviewers

[![@graingert](https://avatars.githubusercontent.com/u/413772?s=40&v=4)](/graingert) [graingert](/graingert)

graingert left review comments

[![@picnixz](https://avatars.githubusercontent.com/u/10796600?s=40&v=4)](/picnixz) [picnixz](/picnixz)

picnixz approved these changes

[![@gpshead](https://avatars.githubusercontent.com/u/68491?s=40&v=4)](/gpshead) [gpshead](/gpshead)

gpshead approved these changes

[![@zooba](https://avatars.githubusercontent.com/u/1693688?s=40&v=4)](/zooba) [zooba](/zooba)

 Awaiting requested review from zooba

Assignees

No one assigned

Labels

[OS-windows](/python/cpython/labels/OS-windows)
[type-security](/python/cpython/labels/type-security)
A security issue

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

10 participants

[![@sethmlarson](https://avatars.githubusercontent.com/u/18519037?s=52&v=4)](/sethmlarson) [![@njsmith](https://avatars.githubusercontent.com/u/609896?s=52&v=4)](/njsmith) [![@bedevere-bot](https://avatars.githubusercontent.com/u/28579281?s=52&v=4)](/bedevere-bot) [![@picnixz](https://avatars.githubusercontent.com/u/10796600?s=52&v=4)](/picnixz) [![@ell1e](https://avatars.githubusercontent.com/u/64124388?s=52&v=4)](/ell1e) [![@freakboy3742](https://avatars.githubusercontent.com/u/37345?s=52&v=4)](/freakboy3742) [![@gpshead](https://avatars.githubusercontent.com/u/68491?s=52&v=4)](/gpshead) [![@mhsmith](https://avatars.githubusercontent.com/u/166954?s=52&v=4)](/mhsmith) [![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=52&v=4)](/cfi-gb) [![@graingert](https://avatars.githubusercontent.com/u/413772?s=52&v=4)](/graingert)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

