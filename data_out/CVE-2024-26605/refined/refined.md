Based on the provided information, this content is related to CVE-2024-26605.

**Root cause of vulnerability:** A deadlock can occur when enabling ASPM (Active State Power Management) during the probe of Qualcomm PCIe controllers. This happens due to a recursive locking scenario involving the `pci_bus_sem` semaphore.

**Weaknesses/vulnerabilities present:**
- Recursive locking: The code attempts to acquire the `pci_bus_sem` semaphore while already holding it, leading to a deadlock. This is triggered within the `pcie_aspm_pm_state_change` function, which is called during the power state change of a PCI device. The call to `pci_walk_bus` also uses the `pci_bus_sem` semaphore, causing the recursive lock.

**Impact of exploitation:**
- System deadlock: The deadlock causes the system to become unresponsive, requiring a reboot to recover.

**Attack vectors:**
- Asynchronous probe: The deadlock is more likely to occur during asynchronous device probing, where multiple threads might be involved in device initialization and power management.
- Increased race window: Adding a delay during the asynchronous probe can increase the likelihood of the deadlock by expanding the race window.

**Required attacker capabilities/position:**
- The attacker does not directly cause the deadlock, it is a programming error, however, an attacker might be able to force the condition by triggering device probes.
- The vulnerability can be triggered during normal system operation and does not require a specific user or privilege level.

**Additional details:**
- The fix involves adding a new function, `pci_set_power_state_locked()`, and associated helper functions. This allows calls to change the PCI power state with the `pci_bus_sem` held, avoiding the double acquisition of the read lock.
- The issue was introduced by a last-minute revert in the 6.7 kernel.
- The patch introduces `__pci_walk_bus` which takes a locked argument to allow the use of `pci_bus_sem` already held by the caller, and also `pci_walk_bus_locked` to provide a locked version of the function.  The same pattern is followed for `pci_set_power_state`, `__pci_set_power_state`, and `pci_set_power_state_locked`
- The fix has been backported to multiple stable kernel branches.