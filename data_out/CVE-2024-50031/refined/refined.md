```
{
  "vulnerability": {
    "root_cause": "The active performance monitor is not stopped when the file descriptor is closed (e.g., when kmscube is interrupted). Although the `v3d_perfmon_close_file()` function destroys all perfmons, the `v3d->active_perfmon` pointer is not reset. Thus, when kmscube is run again, the driver tries to stop the active performance monitor using a stale pointer, resulting in a kernel panic.",
    "weaknesses": [
      "Use-after-free vulnerability due to not stopping the active performance monitor before it is destroyed."
    ],
    "impact": "Kernel panic and denial of service.",
    "attack_vectors": "Interrupting the kmscube application while performance monitors are enabled. Subsequently, running kmscube again.",
    "required_attacker_capabilities": "Ability to execute applications such as kmscube with performance monitoring enabled, and the ability to interrupt them."
  },
  "fixes": [
    {
      "commit_id": "0c9e9a3a4873705740b19300cadc6599170646ef",
       "description": "drm/v3d: Stop the active perfmon before being destroyed. When the active performance monitor belongs to a given process, explicitly stop it before destroying and freeing it.",
      "file_changes": [
        {
          "file_path": "drivers/gpu/drm/v3d/v3d_perfmon.c",
          "insertions": 8,
          "deletions": 1
        }
      ]
    },
      {
      "commit_id": "07c51108d9e278831c16191d1223ee49986e7890",
       "description": "drm/v3d: Stop the active perfmon before being destroyed. When the active performance monitor belongs to a given process, explicitly stop it before destroying and freeing it.",
      "file_changes": [
        {
          "file_path": "drivers/gpu/drm/v3d/v3d_perfmon.c",
          "insertions": 8,
          "deletions": 1
        }
      ]
    },
      {
      "commit_id": "333767cbce6ac20ec794c76eec82ed0ef55022db",
       "description": "drm/v3d: Stop the active perfmon before being destroyed. When the active performance monitor belongs to a given process, explicitly stop it before destroying and freeing it.",
      "file_changes": [
        {
          "file_path": "drivers/gpu/drm/v3d/v3d_perfmon.c",
          "insertions": 8,
          "deletions": 1
        }
      ]
    },
      {
      "commit_id": "24ab54a066d2ef671b03eb909ca2114c0c9ac1e7",
      "description": "drm/v3d: Stop the active perfmon before being destroyed. When the active performance monitor belongs to a given process, explicitly stop it before destroying and freeing it.",
      "file_changes": [
        {
          "file_path": "drivers/gpu/drm/v3d/v3d_perfmon.c",
          "insertions": 8,
          "deletions": 1
        }
      ]
    },
      {
      "commit_id":"7d1fd3638ee3a9f9bca4785fffb638ca19120718",
      "description": "drm/v3d: Stop the active perfmon before being destroyed. When the active performance monitor belongs to a given process, explicitly stop it before destroying and freeing it.",
        "file_changes": [
        {
          "file_path": "drivers/gpu/drm/v3d/v3d_perfmon.c",
           "insertions": 8,
          "deletions": 1
        }
      ]
    }
  ]
}
```