=== Content from www.sonarsource.com_a8b88f60_20250111_190712.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog Post

# Joomla: PHP Bug Introduces Multiple XSS Vulnerabilities

![](data:image/svg+xml;charset=utf-8...)![Stefan Schiller photo]()![Stefan Schiller photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bfd8cc06-d437-4ab4-9039-66ec3affeeea/stefan.jpg?w=800&h=800&auto=format&fit=crop)

Stefan Schiller

Vulnerability Researcher

February 20, 2024

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/51277f8d-1245-4bb8-bbc4-7e0102838175/joomla_xss_vulnerabilities_blog_index.webp?w=2400&h=1256&auto=format&fit=crop)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/51277f8d-1245-4bb8-bbc4-7e0102838175/joomla_xss_vulnerabilities_blog_index.webp?w=2400&h=1256&auto=format&fit=crop)
#### Update 2024-02-23: Full technical details added.

## Key Information

* Sonar’s Vulnerability Research Team has discovered an issue that led to multiple XSS vulnerabilities in the popular Content Management System [Joomla](https://www.joomla.org/ "Joomla").
* The issue discovered with the help of [SonarQube Cloud](https://sonarcloud.io/ "SonarQube Cloud") affects Joomla’s core filter component and is tracked as [CVE-2024-21726](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-21726 "CVE-2024-21726").
* Attackers can leverage the issue to gain remote code execution by tricking an administrator into clicking on a malicious link.
* The underlying PHP bug is an inconsistency in how PHP’s mbstring functions handle invalid multibyte sequences.
* The bug was fixed with PHP versions 8.3 and 8.4, but not backported to older PHP versions.
* Joomla released a [security announcement](https://developer.joomla.org/security-centre/929-20240205-core-inadequate-content-filtering-within-the-filter-code.html "security announcement") and published [version 5.0.3/4.4.3](https://www.joomla.org/announcements/release-news/5904-joomla-5-0-3-and-4-4-3-security-and-bug-fix-release.html "version 5.0.3/4.4.3"), which mitigates the vulnerability.

## Joomla

Joomla is a free and open-source Content Management System (CMS) used for building websites and online applications. Roughly [2% of all websites](https://w3techs.com/technologies/overview/content_management "2% of all websites") use Joomla, which makes it one of the most popular CMSs with millions of deployments worldwide.

The widespread usage of Joomla and the fact that most deployments are publicly accessible makes it a valuable target for threat actors. Just recently, Joomla was targeted in an [attack against different organizations](https://thehackernews.com/2023/12/new-hacker-group-gambleforce-tageting.html "attack against different organizations") via an [improper access control vulnerability (CVE-2023-23752)](https://nvd.nist.gov/vuln/detail/CVE-2023-23752 "improper access control vulnerability (CVE-2023-23752)").

In this article, we dive into an interesting XSS issue detected by [SonarQube Cloud](https://sonarcloud.io/ "SonarQube Cloud"), which led us down the rabbit hole to the discovery of a bug in PHP. We will explain how an inconsistency in PHP’s mbstring functions can be leveraged by attackers to bypass Joomla’s input sanitization introducing multiple XSS vulnerabilities.

## Impact

Joomla versions 5.0.2/4.4.2 and below are prone to multiple XSS vulnerabilities. Attackers tricking an administrator into clicking on a malicious link can gain remote code execution (RCE):

Joomla [version 5.0.3/4.4.3](https://www.joomla.org/announcements/release-news/5904-joomla-5-0-3-and-4-4-3-security-and-bug-fix-release.html "version 5.0.3/4.4.3") mitigates the issue regardless of the PHP version. The underlying PHP bug was fixed with PHP versions 8.3 and 8.4, but not backported to older PHP versions.

**We strongly recommend updating Joomla to the latest version as well as keeping your PHP version up-to-date.**

## Technical Details

In our continuous effort to help secure open-source projects and improve our Clean Code solution, we regularly scan open-source projects via [SonarQube Cloud](https://sonarcloud.io/ "SonarQube Cloud") and evaluate the findings. When scanning Joomla, SonarQube Cloud reported an interesting XSS issue:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8c2f1aca-bded-40d2-8f83-0fa4acfa5a4a/joomla-sc.png?w=1005&h=214&auto=format&fit=crop)

[View this issue on SonarQube Cloud](https://sonarcloud.io/project/issues?resolved=false&types=VULNERABILITY&id=SonarSourceResearch_joomla-blogpost&open=AY3LbRnWdEw9LdiT4b6d "View this issue on SonarQube Cloud")

This small code snippet is taken from a settings page on the admin panel. According to the raised issue, the query parameter `forcedItemType` is reflected in the output, which introduces an XSS vulnerability.

Please notice that the third argument of the `get` method used to retrieve the query parameter is set to `string`. This value determines which filters should be applied to the query parameter. Under the hood, the `get` method uses the `Joomla\Filter\InputFilter` class to sanitize potentially malicious input, which should prevent an XSS attack.

The filter logic is [quite complex](https://github.com/joomla-framework/filter/blob/3.x-dev/src/InputFilter.php#L308-L514 "quite complex") and uses a method called `cleanTags` to remove all HTML tags that are not explicitly allowed. For query parameters, no tags are allowed at all.

Thus, for the following example input:

```
some-text<script>alert(1)</script>
```

…, the `<script>` tags are removed, which results in this output:

```
some-textalert(1)
```

The `cleanTags` method performs this sanitization by determining the position of any opening tags (`<`) and then removing all data following until and including the corresponding closing tag (`>`):

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/ce451afc-0a08-4ac9-8203-f9e46be1cd46/joomla-01.png?w=1520&h=438&auto=format&fit=crop)

The characters **before** an opening tag (e.g., `some-text` in the example above) are extracted by determining the offset of the opening tag (`$tagOpenStart`) via [`StringHelper::strpos`](https://github.com/joomla-framework/string/blob/3.x-dev/src/StringHelper.php#L147 "StringHelper::strpos") and then using [`StringHelper::substr`](https://github.com/joomla-framework/string/blob/3.x-dev/src/StringHelper.php#L189 "StringHelper::substr") to extract it:

```
// Is there a tag? If so it will certainly start with a '<'.
$tagOpenStart = StringHelper::strpos($source, '<');
while ($tagOpenStart !== false) {
    // Get some information about the tag we are processing
    $preTag .= StringHelper::substr($postTag, 0, $tagOpenStart);
```

For the example string `some-text<script>alert(1)</script>`, the first call to `StringHelper::substr` returns the string `some-text`, which is appended to the `$preTag` variable:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/f804fb61-7e68-4323-8881-524fc4910a13/joomla-02.png?w=1760&h=695&auto=format&fit=crop)

On the second iteration, the string `alert(1)` is added:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/7f86bc5f-ccec-4a1c-8a5a-3db33892f834/joomla-03.png?w=1760&h=695&auto=format&fit=crop)

The `$preTag` variable used to collect all sanitized substrings is later returned as the final result:

```
    // ...
    return $preTag;
}
```

The `StringHelper::strpos` and `StringHelper::substr` methods are just wrappers around the respective PHP [mbstring](https://www.php.net/manual/en/book.mbstring.php "mbstring") functions [`mb_strpos`](https://www.php.net/manual/en/function.mb-strpos.php "mb_strpos") and [`mb_substr`](https://www.php.net/manual/en/function.mb-substr.php "mb_substr").

When determining if this sanitization is safe, we noticed that both PHP functions, `mb_strpos,` and `mb_substr`, handle invalid UTF-8 sequences differently. When `mb_strpos` encounters a [UTF-8 leading byte](https://en.wikipedia.org/wiki/UTF-8#Encoding "UTF-8 leading byte"), it tries to parse the following continuation bytes until the full byte sequence is read. If an invalid byte is encountered, all previously read bytes are considered one character, and the parsing is started over again at the invalid byte:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/efa546f8-bbb7-41e9-9f1b-a6c7a45ef668/joomla-04.png?w=1480&h=740&auto=format&fit=crop)

Thus, the following call to `mb_strpos` returns the index `4`:

```
mb_strpos("\xf0\x9fAAA<BB", '<'); // 4
```

This index is the position of the opening angle bracket `<` (`3c`) character within the string.

`mb_substr`, on the other hand, skips over continuation bytes when encountering a leading byte:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/0316a339-0fd8-473f-907a-2eae37bd7ce0/joomla-05.png?w=1480&h=617&auto=format&fit=crop)

This means that for `mb_substr,` the first four bytes are considered one character and the opening angle bracket `<` (`3c`) character has the index `2`. Thus, the following call to `mb_substr` returns `"\xf0\x9fAAA<B"` when using the index returned by `mb_strpos` :

```
mb_substr("\xf0\x9fAAA<BB", 0, 4); // "\xf0\x9fAAA<B"
```

Because of this inconsistency between both functions, Joomla’s sanitization extracts not only the text before an opening angle bracket but also the opening angle bracket itself and the following character when encountering this invalid UTF-8 byte sequence:

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/e8a4e56e-2bb7-4e37-8edb-010dc20a8e25/joomla-06.png?w=1640&h=1691&auto=format&fit=crop)

An attacker can insert multiple invalid UTF-8 sequences, which effectively offset the index returned by `StringHelper::strpos` way beyond the opening angle bracket and thus include arbitrary HTML tags in the sanitized output. This completely bypasses the sanitization applied by Joomla. Since this issue affects Joomla’s core filter functionality, which is used all over the whole code base, this leads to multiple XSS vulnerabilities.

One of the resulting XSS vulnerabilities can for example be leveraged by an attacker to craft a malicious link. When an administrator clicks on this link, the injected JavaScript payload can be used to [customize a template](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla#rce "customize a template") and insert arbitrary PHP code. Thus, an attacker can gain remote code execution (RCE) by tricking an administrator into clicking on the malicious link.

### Patch

Joomla addressed the issue by replacing the usage of the mbstring functions with PHP’s regular string functions:

```
// Is there a tag? If so it will certainly start with a '<'.
- $tagOpenStart = StringHelper::strpos($source, '<');
+ $tagOpenStart = strpos($source, '<');

while ($tagOpenStart !== false) {
    // Get some information about the tag we are processing
-    $preTag .= StringHelper::substr($postTag, 0, $tagOpenStart);
+    $preTag .= substr($postTag, 0, $tagOpenStart);
```

The difference between these functions is that PHP’s regular string functions are not multibyte aware and operate on single bytes. Since multibyte awareness is not required for the applied sanitization, these functions should be preferred.

We also reported the inconsistent behavior of the mbstring functions to the PHP maintainers, since we consider it as unintended. The PHP maintainers provided a patch, which makes the behavior consistent by not skipping over continuation bytes when encountering a leading byte. Unfortunately, the issue was not classified as security-relevant, which means that the patch is not backported to older versions of PHP.

More background information on the behavior of the PHP mbstring functions and the patch can be found in the excellent explanation from Alex Dowad in the related [commit message](https://github.com/php/php-src/pull/12913 "commit message").

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2023-11-22 | We report the vulnerability to the Joomla! Security Strike Team |
| 2023-11-28 | The Joomla! Security Strike Team confirms our findings. |
| 2023-12-01 | We report the inconsistent mbstring function behavior to thePHP maintainers. |
| 2023-12-10 | The PHP maintainers provide a patch, which is applied toPHP 8.3 and 8.4. |
| 2024-02-20 | Joomla releases version 5.0.3/4.4.3, which mitigates the issueregardless of the PHP version. |
| 2024-02-20 | Coordinated release of security announcement by Joomla and Sonar. |
| 2024-02-23 | Full technical details added. |

## Summary

In this article, we explained how SonarQube Cloud led us to an interesting XSS finding in the popular CMS Joomla. During our analysis of the issue, we discovered an inconsistency in how PHP’s mbstring functions handle invalid multibyte sequences. Attackers could leverage this behavior to bypass the sanitization performed by Joomla’s core filter leading to multiple XSS vulnerabilities.

Finally, we would like to thank the Joomla! Security Strike Team for quickly responding to our notification, collaborating on a corresponding patch, and informing all users.

Also, thanks a lot to [Alex Dowad](https://github.com/alexdowad "Alex Dowad") for quickly addressing the issue from the PHP side!

## Related Blog Posts

* [WordPress Core - Unauthenticated Blind SSRF](https://www.sonarsource.com/blog/wordpress-core-unauthenticated-blind-ssrf/ "WordPress Core - Unauthenticated Blind SSRF")
* [WordPress < 5.8.3 - Object Injection Vulnerability](https://www.sonarsource.com/blog/wordpress-object-injection-vulnerability/ "WordPress < 5.8.3 - Object Injection Vulnerability")
* [Grav CMS 1.7.10 - Code Execution Vulnerabilities](https://www.sonarsource.com/blog/grav-cms-code-execution-vulnerabilities/ "Grav CMS 1.7.10 - Code Execution Vulnerabilities")
* [Ghost CMS 4.3.2 - Cross-Origin Admin Takeover](https://www.sonarsource.com/blog/ghost-admin-takeover/ "Ghost CMS 4.3.2 - Cross-Origin Admin Takeover")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail
## Get new blogs delivered directly to your inbox!

Stay up-to-date with the latest Sonar content. Subscribe now to receive the latest blog articles.

Email\*cheqSign up

By submitting this form, you agree to the storing and processing of your personal data as described in the [Privacy Policy](/company/privacy/ "Privacy Policy") and [Cookie Policy](/company/cookie-policy/ "Cookie Policy"). You can withdraw your consent by unsubscribing at any time.

This site is protected by reCAPTCHA and the Google [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms) apply.

[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from developer.joomla.org_e254ceed_20250111_190712.html ===


* Joomla!®
  + About us
  + [Joomla Home](https://www.joomla.org)
  + [What is Joomla?](https://www.joomla.org/about-joomla.html)
  + [Benefits & Features](https://www.joomla.org/core-features.html)
  + [Project & Leadership](https://www.joomla.org/about-joomla/the-project.html)
  + [Trademark & Licensing](https://tm.joomla.org)
  + [The Joomla Foundation](https://joomlafoundation.org)
  + Support us
  + [Contribute](https://www.joomla.org/contribute-to-joomla.html)
  + [Sponsor](https://www.joomla.org/sponsor.html)
  + [Partner](https://www.joomla.org/about-joomla/partners.html)
  + [Shop](https://shop.joomla.org)
* Download & Extend
  + [Downloads](https://downloads.joomla.org)
  + [Extensions](https://extensions.joomla.org)
  + [Languages](https://community.joomla.org/translations.html)
  + [Get a free site](https://launch.joomla.org)
  + [Get a domain](https://domains.joomla.org)
* Discover & Learn
  + [Documentation](https://docs.joomla.org)
  + [Training](https://community.joomla.org/joomla-training.html)
  + [Certification](https://certification.joomla.org)
  + [Site Showcase](https://showcase.joomla.org)
  + [Announcements](https://www.joomla.org/announcements.html)
  + [Blogs](https://community.joomla.org/blogs.html)
  + [Magazine](https://magazine.joomla.org)
* Community & Support
  + [Community Portal](https://community.joomla.org)
  + [Events](https://community.joomla.org/events.html)
  + [User Groups](https://community.joomla.org/user-groups.html)
  + [Forum](https://forum.joomla.org)
  + [Service Providers Directory](https://community.joomla.org/service-providers-directory.html)
  + [Volunteers Portal](https://volunteers.joomla.org)
  + [Vulnerable Extensions List](https://extensions.joomla.org/vulnerable-extensions/vulnerable/)
* Developer Resources
  + [Developer Network](https://developer.joomla.org)
  + [Security Centre](https://developer.joomla.org/security.html)
  + [Issue Tracker](https://issues.joomla.org)
  + [GitHub](https://github.com/joomla)
  + [API Documentation](https://api.joomla.org)
  + [Joomla! Framework](https://framework.joomla.org)

Search

# [Joomla! Developer Network™](/)

[Download](https://downloads.joomla.org/)

[Launch](https://launch.joomla.org)

* [Home](/)
* [News](/news.html)
* [Project Roadmap](/roadmap.html)
* [CMS](/cms.html)
* [Framework](/framework.html)
* [Tracker](/tracker.html)
* [About](/about.html)
* [Security](/security.html)

# Security Announcements

## [20240205] - Core - Inadequate content filtering within the filter code

* **Project:** Joomla! / Joomla! Framework
* **SubProject:** CMS / filter
* **Impact:** Moderate
* **Severity:** Moderate
* **Probability:** Moderate
* **Versions:**3.7.0-3.10.14-elts, 4.0.0-4.4.2, 5.0.0-5.0.2
* **Exploit type:** XSS
* **Reported Date:** 2023-11-22
* **Fixed Date:** 2024-02-20
* **CVE Number:** [CVE-2024-21726](https://www.cve.org/CVERecord?id=CVE-2024-21726)

### Description

Inadequate content filtering leads to XSS vulnerabilities in various components.
### Affected Installs

Joomla! CMS versions 3.7.0-3.10.14-elts, 4.0.0-4.4.2, 5.0.0-5.0.2

### Solution

Upgrade to version 3.10.15-elts, 4.4.3 or 5.0.3

### Contact

The JSST at the [Joomla! Security Centre](/security-centre.html "Contact the JSST").

[Previous article: [20240701] - Core - XSS in accessible media selection field
 Prev](/security-centre/935-20240701-core-xss-in-accessible-media-selection-field.html)
[Next article: [20240204] - Core - XSS in mail address outputs
Next](/security-centre/928-20240204-core-xss-in-mail-address-outputs.html)

1. You are here:
2. [Home](/)
3. [Security Announcements](/security-centre.html)
4. [20240205] - Core - Inadequate content filtering within the filter code

### Joomla! CMS

* [Current Release ![Joomla! CMS 3](/images/joomla-logo.png)](https://downloads.joomla.org/latest)
* [View known Issues](https://issues.joomla.org)
* [Development Status](https://github.com/joomla/joomla-cms#build-status)
* [Download Nightly builds](/nightly-builds.html)

### Joomla! Framework

* [Current Release ![Joomla! Framework Logo](/images/joomla-framework.png) 2**.x**](https://framework.joomla.org)
* [Development Status](https://framework.joomla.org/status)

### Resources

* [Development Strategy](/development-strategy.html)
* [Security Announcements](/security-centre.html)
* [Report Security Issues](/security/contact-the-team.html)
* [Usage Statistics](/about/stats.html)
* [Statistics API Documentation](/about/stats/api.html)
* [Joomla! API Documentation](https://api.joomla.org)
* [Coding Standards Manual](/coding-standards.html)
* [JoomlaCode Archive](/joomlacode-archive.html)

### Mailing Lists

* [Developer Network Newsletter](https://community.joomla.org/joomla-developer-network-newsletter.html)
* [General Extensions Mailing](https://groups.google.com/group/joomla-dev-general)
* [CMS Mailing](https://groups.google.com/group/joomla-dev-cms)
* [Framework Mailing](https://groups.google.com/group/joomla-dev-framework)
* [Documentation Mailing](https://groups.google.com/group/joomla-docs)

---

* [Joomla! on Twitter](https://twitter.com/joomla "Joomla! on Twitter")
* [Joomla! on Facebook](https://www.facebook.com/joomla "Joomla! on Facebook")
* [Joomla! on YouTube](https://www.youtube.com/user/joomla "Joomla! on YouTube")
* [Joomla! on LinkedIn](https://www.linkedin.com/company/joomla "Joomla! on LinkedIn")
* [Joomla! on Pinterest](https://www.pinterest.com/joomla "Joomla! on Pinterest")
* [Joomla! on Instagram](https://www.instagram.com/joomlaofficial/ "Joomla! on Instagram")
* [Joomla! on GitHub](https://github.com/joomla "Joomla! on GitHub")

* [Home](https://www.joomla.org)
* [About](https://www.joomla.org/about-joomla.html)
* [Community](https://community.joomla.org)
* [Forum](https://forum.joomla.org)
* [Extensions](https://extensions.joomla.org)
* [Services](https://community.joomla.org/service-providers-directory.html)
* [Docs](https://docs.joomla.org)
* [Developer](https://developer.joomla.org)
* [Shop](https://community.joomla.org/the-joomla-shop.html)

* [Accessibility Statement](https://www.joomla.org/accessibility-statement.html)
* [Privacy Policy](https://www.joomla.org/privacy-policy.html)
* [Cookie Policy](https://www.joomla.org/cookie-policy.html)
* [Sponsor Joomla! with $5](https://community.joomla.org/sponsorship-campaigns.html)
* [Help Translate](https://joomla.crowdin.com)
* [Report an Issue](https://github.com/joomla/joomla-websites/issues/new?title=[jdev]%20&body=Please%20describe%20the%20problem%20or%20your%20issue)
* [Log in](/component/content/article/929-20240205-core-inadequate-content-filtering-within-the-filter-code.html?layout=blog&Itemid=&catid=13)

© 2005 - 2025 [Open Source Matters, Inc.](https://opensourcematters.org) All Rights Reserved.

[![Rochen](https://cdn.joomla.org/rochen/rochen_footer_logo_white.svg)](https://www.rochen.com/joomla-hosting)
[Joomla! Hosting by Rochen](https://www.rochen.com/joomla-hosting)

Close

We have detected that you are using an ad blocker. The Joomla! Project relies on revenue from these advertisements so please consider disabling the ad blocker for this domain.


