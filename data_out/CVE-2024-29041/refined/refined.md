```
{
  "CVE-2024-29041": {
    "description": "Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`.",
    "root_cause": "The `res.location()` function in Express.js incorrectly handles malformed URLs when encoding them using the `encodeUrl` library, leading to a bypass of redirect allow list implementations.",
    "weaknesses": [
      "CWE-601",
      "CWE-1286"
    ],
    "impact": "Open redirect vulnerability allowing attackers to redirect users to malicious websites.",
     "attack_vectors": [
      "The vulnerability can be exploited via malformed URLs provided by users, which are then used in redirects with `res.location()` or `res.redirect()`."
     ],
    "required_capabilities": "The attacker needs to provide a malformed URL as input to the application, and the application must use the vulnerable `res.location()` function to redirect the user based on that input.",
    "additional_information": "The vulnerability arises because the `encodeUrl` function can encode characters within the host part of the URL, leading to a mismatch between the original and encoded URLs. This bypasses host-based allow list checks, which are common in redirect implementations. The fix involves parsing the URL and ensuring that the host does not change after encoding. The vulnerability exists in express versions prior to 4.19.2, and pre-release versions before 5.0.0-beta.3"
  }
}
```