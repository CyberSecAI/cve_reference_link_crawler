
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkoajs%2Fkoa%2Fissues%2F1800)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkoajs%2Fkoa%2Fissues%2F1800)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=koajs%2Fkoa)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[koajs](/koajs)
/
**[koa](/koajs/koa)**
Public

* [Notifications](/login?return_to=%2Fkoajs%2Fkoa) You must be signed in to change notification settings
* [Fork
  3.2k](/login?return_to=%2Fkoajs%2Fkoa)
* [Star
   35.3k](/login?return_to=%2Fkoajs%2Fkoa)

* [Code](/koajs/koa)
* [Issues
  19](/koajs/koa/issues)
* [Pull requests
  11](/koajs/koa/pulls)
* [Discussions](/koajs/koa/discussions)
* [Actions](/koajs/koa/actions)
* [Wiki](/koajs/koa/wiki)
* [Security](/koajs/koa/security)
* [Insights](/koajs/koa/pulse)

Additional navigation options

* [Code](/koajs/koa)
* [Issues](/koajs/koa/issues)
* [Pull requests](/koajs/koa/pulls)
* [Discussions](/koajs/koa/discussions)
* [Actions](/koajs/koa/actions)
* [Wiki](/koajs/koa/wiki)
* [Security](/koajs/koa/security)
* [Insights](/koajs/koa/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fkoajs%2Fkoa%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fkoajs%2Fkoa%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# if "\@" in url ï¼Œthe redirect result doesn't match the host of the new URL() #1800

Closed

[FDrag0n](/FDrag0n) opened this issue
Jan 17, 2024
Â· 2 comments
 Â· Fixed by [#1803](https://github.com/koajs/koa/pull/1803) or [#1804](https://github.com/koajs/koa/pull/1804)

Closed

# [if "\@" in url ï¼Œthe redirect result doesn't match the host of the new URL()](#top) #1800

[FDrag0n](/FDrag0n) opened this issue
Jan 17, 2024
Â· 2 comments
 Â· Fixed by [#1803](https://github.com/koajs/koa/pull/1803) or [#1804](https://github.com/koajs/koa/pull/1804)

Assignees
[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2)

Labels
[bug](/koajs/koa/labels/bug)

## Comments

[![@FDrag0n](https://avatars.githubusercontent.com/u/34733637?s=80&u=2848bcc9179a55d4f4bcb5f259e101c587aaca12&v=4)](/FDrag0n)

Copy link

Contributor

### **[FDrag0n](/FDrag0n)** commented [Jan 17, 2024](#issue-2085314029) â€¢ edited Loading

| [koa/lib/response.js](https://github.com/koajs/koa/blob/5f159415e58c42b54cb0703d7cfb10870d33d65f/lib/response.js#L269)  Line 269 in [5f15941](/koajs/koa/commit/5f159415e58c42b54cb0703d7cfb10870d33d65f)   |  | this.set('Location', encodeUrl(url)) | | --- | --- |     [image](https://private-user-images.githubusercontent.com/34733637/297249162-46c9d2dc-74a2-4e4a-bf94-d3e2e822004e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg4NjIsIm5iZiI6MTczNjYyODU2MiwicGF0aCI6Ii8zNDczMzYzNy8yOTcyNDkxNjItNDZjOWQyZGMtNzRhMi00ZTRhLWJmOTQtZDNlMmU4MjIwMDRlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDkyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRmYWViNGNhZWFkMzZhODcyYTdkZGUwNmU3MmJkMjU5ZmZlM2U3ZTVmY2UwNDZiODU2YzExZDE3MmRhYmMzZjYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.qkLarh2GB0QFVlhIDBxhWsUa5UQPMGlbMmCUOf3Al48) Developer often use `new URL()` `host` to verify the redirected url, but here the `encodeurl` will cause the host verification to fail, thus creating a URL hopping vulnerability |
| --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@FDrag0n](https://avatars.githubusercontent.com/u/34733637?s=80&u=2848bcc9179a55d4f4bcb5f259e101c587aaca12&v=4)](/FDrag0n)

Copy link

Contributor

Author

### **[FDrag0n](/FDrag0n)** commented [Jan 17, 2024](#issuecomment-1894880250)

| [image](https://private-user-images.githubusercontent.com/34733637/297251599-dfd3946f-5aef-4c1b-9ffa-cb63ad3d2487.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg4NjIsIm5iZiI6MTczNjYyODU2MiwicGF0aCI6Ii8zNDczMzYzNy8yOTcyNTE1OTktZGZkMzk0NmYtNWFlZi00YzFiLTlmZmEtY2I2M2FkM2QyNDg3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDkyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFjNmVhYWE3ODRmMzExNmFiM2I0Mzc3MWJmN2ViZjJmYWRhZWI4Y2NjZGI2YWU3ZDIyODRkZjYwZjRjMjMyNzQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.dgW-K_wgq1-j0c3JT1m5-nOOng7Ij5FbtFBFeFDrUgw) |
| --- |

All reactions

Sorry, something went wrong.

[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2)
[fengmk2](/fengmk2)
mentioned this issue
[Mar 15, 2024](#ref-pullrequest-2187829835)

[fix: formatting redirect url on http(s) protocol url
#1803](/koajs/koa/pull/1803)
 Merged

[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2)
[fengmk2](/fengmk2)
linked a pull request
[Mar 15, 2024](#event-12127339096)
that will
close
this issue

[fix: formatting redirect url on http(s) protocol url
#1803](/koajs/koa/pull/1803)
 Merged

[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2)
[fengmk2](/fengmk2)
self-assigned this
[Mar 15, 2024](#event-12127341086)

[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2)
[fengmk2](/fengmk2)
added
the
[bug](/koajs/koa/labels/bug)
label
[Mar 15, 2024](#event-12127341601)

[fengmk2](/fengmk2)
added a commit
that referenced
this issue
[Mar 15, 2024](#ref-commit-926243b)
[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2)

`[fix: formatting redirect url on http(s) protocol url](/koajs/koa/commit/926243bd3683ca1daf592665b7a3512bc148d3e3 "fix: formatting redirect url on http(s) protocol url

closes https://github.com/koajs/koa/issues/1800

pick from https://github.com/koajs/koa/pull/1803")`
â€¦

`[926243b](/koajs/koa/commit/926243bd3683ca1daf592665b7a3512bc148d3e3)`

```
closes [#1800](https://github.com/koajs/koa/issues/1800)

pick from [#1803](https://github.com/koajs/koa/pull/1803)
```

[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2)
[fengmk2](/fengmk2)
mentioned this issue
[Mar 15, 2024](#ref-pullrequest-2187874232)

[fix: formatting redirect url on http(s) protocol url
#1804](/koajs/koa/pull/1804)
 Merged

[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2)
[fengmk2](/fengmk2)
closed this as [completed](/koajs/koa/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#1804](/koajs/koa/pull/1804)
[Mar 15, 2024](#event-12127599887)

[fengmk2](/fengmk2)
added a commit
that referenced
this issue
[Mar 15, 2024](#ref-commit-435534a)
[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2)

`[fix: formatting redirect url on http(s) protocol url (](/koajs/koa/commit/435534aa08afd7749b121664f5ab2b54421b276e "fix: formatting redirect url on http(s) protocol url (#1804)

closes https://github.com/koajs/koa/issues/1800

pick from https://github.com/koajs/koa/pull/1803")[#1804](https://github.com/koajs/koa/pull/1804)[)](/koajs/koa/commit/435534aa08afd7749b121664f5ab2b54421b276e "fix: formatting redirect url on http(s) protocol url (#1804)

closes https://github.com/koajs/koa/issues/1800

pick from https://github.com/koajs/koa/pull/1803")`
â€¦

`[435534a](/koajs/koa/commit/435534aa08afd7749b121664f5ab2b54421b276e)`

```
closes [#1800](https://github.com/koajs/koa/issues/1800)

pick from [#1803](https://github.com/koajs/koa/pull/1803)
```

[![@FDrag0n](https://avatars.githubusercontent.com/u/34733637?s=80&u=2848bcc9179a55d4f4bcb5f259e101c587aaca12&v=4)](/FDrag0n)

Copy link

Contributor

Author

### **[FDrag0n](/FDrag0n)** commented [Mar 15, 2024](#issuecomment-1999090769)

| Great fix fit, thanks! |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Mar 15, 2024

[[deleted]
expressjs/express#5539](/expressjs/express/pull/5539)
 Closed

[fix: handle upper case protocol like HTTP or HTTPS
#1805](/koajs/koa/pull/1805)
 Merged

[kodiakhq](/apps/kodiakhq) bot
referenced
this issue
in X-oss-byte/Nextjs
[Mar 26, 2024](#ref-commit-348d420)
[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/marketplace/renovate)

`[Update dependency express to v4.19.2 [SECURITY] (](/X-oss-byte/Nextjs/commit/348d42052d59894729130fa0bc9500c7298fb01f "Update dependency express to v4.19.2 [SECURITY] (#1614)

[![Mend Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/) ([source](https://togithub.com/expressjs/express)) | [`4.18.3` -> `4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.3/4.19.2) | [![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) |

### GitHub Vulnerability Alerts

#### [CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd
https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)
[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

### [`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

### [`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

-   Allow passing non-strings to res.location with new encoding handling checks

### [`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] If you want to rebase/retry this PR, check this box

---

This PR has been generated by [Mend Renovate](https://www.mend.io/free-developer-tools/renovate/). View repository job log [here](https://developer.mend.io/github/X-oss-byte/Nextjs).")[#1614](https://github.com/X-oss-byte/Nextjs/pull/1614)[)](/X-oss-byte/Nextjs/commit/348d42052d59894729130fa0bc9500c7298fb01f "Update dependency express to v4.19.2 [SECURITY] (#1614)

[![Mend Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/) ([source](https://togithub.com/expressjs/express)) | [`4.18.3` -> `4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.3/4.19.2) | [![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) |

### GitHub Vulnerability Alerts

#### [CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd
https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)
[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

### [`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

### [`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

-   Allow passing non-strings to res.location with new encoding handling checks

### [`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] If you want to rebase/retry this PR, check this box

---

This PR has been generated by [Mend Renovate](https://www.mend.io/free-developer-tools/renovate/). View repository job log [here](https://developer.mend.io/github/X-oss-byte/Nextjs).")`
â€¦

`[348d420](/X-oss-byte/Nextjs/commit/348d42052d59894729130fa0bc9500c7298fb01f)`

```
[![Mend Renovate]([https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com](https://app.renovatebot.com/images/banner.svg%29%5D%28https%3A//renovatebot.com))

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](<http://expressjs.com/>) ([source](<https://togithub.com/expressjs/express>)) | [`4.18.3` -> `4.19.2`](<https://renovatebot.com/diffs/npm/express/4.18.3/4.19.2>) | [![age](<https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) | [![adoption](<https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) | [![passing](<https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) | [![confidence](<https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) |

### GitHub Vulnerability Alerts

#### [[CVE-2024-29041](https://github.com/advisories/GHSA-rv95-896h-c2vc "CVE-2024-29041")](<https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc>)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](<https://togithub.com/pillarjs/encodeurl>) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called from within `res.redirect()`.

### Patches

[expressjs/express@0867302](https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd)
[expressjs/express@0b74695](https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94)

An initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.

### References

[[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)](https://github.com/expressjs/express/pull/5539%5D%28https%3A//togithub.com/expressjs/express/pull/5539%29)
[[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)](https://github.com/koajs/koa/issues/1800%5D%28https%3A//togithub.com/koajs/koa/issues/1800%29)
<https://expressjs.com/en/4x/api.html#res.location>

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

### [`v4.19.2`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.19.1...4.19.2>)

\==========

-   Improved fix for open redirect allow list bypass

### [`v4.19.1`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.19.0...4.19.1>)

\==========

-   Allow passing non-strings to res.location with new encoding handling checks

### [`v4.19.0`](<https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.18.3...4.19.0>)

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - "" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] If you want to rebase/retry this PR, check this box

---

This PR has been generated by [Mend Renovate](<https://www.mend.io/free-developer-tools/renovate/>). View repository job log [here](<https://developer.mend.io/github/X-oss-byte/Nextjs>).
```

[Brooooooklyn](/Brooooooklyn)
referenced
this issue
in toeverything/AFFiNE
[Mar 26, 2024](#ref-commit-2662ba7)
[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/marketplace/renovate)

`[chore: bump up express version to v4.19.2 [SECURITY] (](/toeverything/AFFiNE/commit/2662ba763c4c33419d88946db1f9121bb56cd607 "chore: bump up express version to v4.19.2 [SECURITY] (#6308)

[![Mend Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/) ([source](https://togithub.com/expressjs/express)) | [`4.18.2` -> `4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2) | [![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) |

### GitHub Vulnerability Alerts

#### [CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd
https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)
[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

### [`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

### [`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

-   Allow passing non-strings to res.location with new encoding handling checks

### [`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

### [`v4.18.3`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.2...4.18.3)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about these updates again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box

---

This PR has been generated by [Mend Renovate](https://www.mend.io/free-developer-tools/renovate/). View repository job log [here](https://developer.mend.io/github/toeverything/AFFiNE).
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoiY2FuYXJ5In0=-->")[#6308](https://github.com/toeverything/AFFiNE/pull/6308)[)](/toeverything/AFFiNE/commit/2662ba763c4c33419d88946db1f9121bb56cd607 "chore: bump up express version to v4.19.2 [SECURITY] (#6308)

[![Mend Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/) ([source](https://togithub.com/expressjs/express)) | [`4.18.2` -> `4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2) | [![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) |

### GitHub Vulnerability Alerts

#### [CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd
https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)
[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

### [`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

### [`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

-   Allow passing non-strings to res.location with new encoding handling checks

### [`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

### [`v4.18.3`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.2...4.18.3)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about these updates again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box

---

This PR has been generated by [Mend Renovate](https://www.mend.io/free-developer-tools/renovate/). View repository job log [here](https://developer.mend.io/github/toeverything/AFFiNE).
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoiY2FuYXJ5In0=-->")`
â€¦

`[2662ba7](/toeverything/AFFiNE/commit/2662ba763c4c33419d88946db1f9121bb56cd607)`

```
[![Mend Renovate]([https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com](https://app.renovatebot.com/images/banner.svg%29%5D%28https%3A//renovatebot.com))

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](<http://expressjs.com/>) ([source](<https://togithub.com/expressjs/express>)) | [`4.18.2` -> `4.19.2`](<https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2>) | [![age](<https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) | [![adoption](<https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) | [![passing](<https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) | [![confidence](<https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) |

### GitHub Vulnerability Alerts

#### [[CVE-2024-29041](https://github.com/advisories/GHSA-rv95-896h-c2vc "CVE-2024-29041")](<https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc>)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](<https://togithub.com/pillarjs/encodeurl>) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called from within `res.redirect()`.

### Patches

[expressjs/express@0867302](https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd)
[expressjs/express@0b74695](https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94)

An initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.

### References

[[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)](https://github.com/expressjs/express/pull/5539%5D%28https%3A//togithub.com/expressjs/express/pull/5539%29)
[[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)](https://github.com/koajs/koa/issues/1800%5D%28https%3A//togithub.com/koajs/koa/issues/1800%29)
<https://expressjs.com/en/4x/api.html#res.location>

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

### [`v4.19.2`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.19.1...4.19.2>)

\==========

-   Improved fix for open redirect allow list bypass

### [`v4.19.1`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.19.0...4.19.1>)

\==========

-   Allow passing non-strings to res.location with new encoding handling checks

### [`v4.19.0`](<https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.18.3...4.19.0>)

### [`v4.18.3`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.18.2...4.18.3>)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - "" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about these updates again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box

---

This PR has been generated by [Mend Renovate](<https://www.mend.io/free-developer-tools/renovate/>). View repository job log [here](<https://developer.mend.io/github/toeverything/AFFiNE>).
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoiY2FuYXJ5In0=-->
```

[renovate](/apps/renovate) bot
referenced
this issue
in Unleash/unleash
[Mar 26, 2024](#ref-commit-91b3336)
[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/marketplace/renovate)

`[fix(deps): update dependency express to v4.19.2 [security] (](/Unleash/unleash/commit/91b33362bd592fd237caf2fe0f8a28ccf242659b "fix(deps): update dependency express to v4.19.2 [security] (#6693)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/)
([source](https://togithub.com/expressjs/express)) | [`4.18.3` ->
`4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.3/4.19.2) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

### GitHub Vulnerability Alerts

####
[CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta
versions before 5.0.0-beta.3 are affected by an open redirect
vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL
Express performs an encode [using
`encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents
before passing it to the `location` header. This can cause malformed
URLs to be evaluated in unexpected ways by common redirect allow list
implementations in Express applications, leading to an Open Redirect via
bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called
from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd

https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature
regression in `4.19.1` and added improved handling for the bypass in
`4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either
`require('node:url').parse` or `new URL`. These are steps you can take
on your own before passing the user input string to `res.location` or
`res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)

[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

###
[`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

###
[`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

- Allow passing non-strings to res.location with new encoding handling
checks

###
[`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" in timezone Europe/Madrid,
Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View
repository job log
[here](https://developer.mend.io/github/Unleash/unleash).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->

Co-authored-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>")[#6693](https://github.com/Unleash/unleash/pull/6693)[)](/Unleash/unleash/commit/91b33362bd592fd237caf2fe0f8a28ccf242659b "fix(deps): update dependency express to v4.19.2 [security] (#6693)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/)
([source](https://togithub.com/expressjs/express)) | [`4.18.3` ->
`4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.3/4.19.2) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

### GitHub Vulnerability Alerts

####
[CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta
versions before 5.0.0-beta.3 are affected by an open redirect
vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL
Express performs an encode [using
`encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents
before passing it to the `location` header. This can cause malformed
URLs to be evaluated in unexpected ways by common redirect allow list
implementations in Express applications, leading to an Open Redirect via
bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called
from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd

https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature
regression in `4.19.1` and added improved handling for the bypass in
`4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either
`require('node:url').parse` or `new URL`. These are steps you can take
on your own before passing the user input string to `res.location` or
`res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)

[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

###
[`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

###
[`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

- Allow passing non-strings to res.location with new encoding handling
checks

###
[`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" in timezone Europe/Madrid,
Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View
repository job log
[here](https://developer.mend.io/github/Unleash/unleash).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->

Co-authored-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>")`
â€¦

`[91b3336](/Unleash/unleash/commit/91b33362bd592fd237caf2fe0f8a28ccf242659b)`

```
[![Mend
Renovate]([https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com](https://app.renovatebot.com/images/banner.svg%29%5D%28https%3A//renovatebot.com))

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](<http://expressjs.com/>)
([source](<https://togithub.com/expressjs/express>)) | [`4.18.3` ->
`4.19.2`](<https://renovatebot.com/diffs/npm/express/4.18.3/4.19.2>) |
[![age](<https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![adoption](<https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![passing](<https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![confidence](<https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.3/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|

### GitHub Vulnerability Alerts

####
[[CVE-2024-29041](https://github.com/advisories/GHSA-rv95-896h-c2vc "CVE-2024-29041")](<https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc>)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta
versions before 5.0.0-beta.3 are affected by an open redirect
vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL
Express performs an encode [using
`encodeurl`](<https://togithub.com/pillarjs/encodeurl>) on the contents
before passing it to the `location` header. This can cause malformed
URLs to be evaluated in unexpected ways by common redirect allow list
implementations in Express applications, leading to an Open Redirect via
bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called
from within `res.redirect()`.

### Patches

[expressjs/express@0867302](https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd)

[expressjs/express@0b74695](https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94)

An initial fix went out with `express@4.19.0`, we then patched a feature
regression in `4.19.1` and added improved handling for the bypass in
`4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either
`require('node:url').parse` or `new URL`. These are steps you can take
on your own before passing the user input string to `res.location` or
`res.redirect`.

### References

[[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)](https://github.com/expressjs/express/pull/5539%5D%28https%3A//togithub.com/expressjs/express/pull/5539%29)

[[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)](https://github.com/koajs/koa/issues/1800%5D%28https%3A//togithub.com/koajs/koa/issues/1800%29)
<https://expressjs.com/en/4x/api.html#res.location>

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

###
[`v4.19.2`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.19.1...4.19.2>)

\==========

-   Improved fix for open redirect allow list bypass

###
[`v4.19.1`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.19.0...4.19.1>)

\==========

- Allow passing non-strings to res.location with new encoding handling
checks

###
[`v4.19.0`](<https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.18.3...4.19.0>)

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - "" in timezone Europe/Madrid,
Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](<https://www.mend.io/free-developer-tools/renovate/>). View
repository job log
[here](<https://developer.mend.io/github/Unleash/unleash>).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->

Co-authored-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>
```

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this issue
[Mar 27, 2024](#ref-pullrequest-2210013386)

[Fix CVEâ€“2024â€“29041
cemmenn/demo-app#1](/cemmenn/demo-app/pull/1)
 Open

[renovate](/apps/renovate) bot
referenced
this issue
in apollographql/apollo-server
[Mar 28, 2024](#ref-commit-5cf2928)
[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/marketplace/renovate)

`[chore(deps): update dependency express to v4.19.2 [security] (](/apollographql/apollo-server/commit/5cf29285f47a34f51d462b9653d27dd45b674f70 "chore(deps): update dependency express to v4.19.2 [security] (#7859)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/)
([source](https://togithub.com/expressjs/express)) | [`4.18.2` ->
`4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

### GitHub Vulnerability Alerts

####
[CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta
versions before 5.0.0-beta.3 are affected by an open redirect
vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL
Express performs an encode [using
`encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents
before passing it to the `location` header. This can cause malformed
URLs to be evaluated in unexpected ways by common redirect allow list
implementations in Express applications, leading to an Open Redirect via
bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called
from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd

https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature
regression in `4.19.1` and added improved handling for the bypass in
`4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either
`require('node:url').parse` or `new URL`. These are steps you can take
on your own before passing the user input string to `res.location` or
`res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)

[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

###
[`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

###
[`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

- Allow passing non-strings to res.location with new encoding handling
checks

###
[`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

###
[`v4.18.3`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.2...4.18.3)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" in timezone America/Los_Angeles,
Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR is behind base branch, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about these
updates again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View
repository job log
[here](https://developer.mend.io/github/apollographql/apollo-server).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->

Co-authored-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>")[#7859](https://github.com/apollographql/apollo-server/pull/7859)[)](/apollographql/apollo-server/commit/5cf29285f47a34f51d462b9653d27dd45b674f70 "chore(deps): update dependency express to v4.19.2 [security] (#7859)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/)
([source](https://togithub.com/expressjs/express)) | [`4.18.2` ->
`4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

### GitHub Vulnerability Alerts

####
[CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta
versions before 5.0.0-beta.3 are affected by an open redirect
vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL
Express performs an encode [using
`encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents
before passing it to the `location` header. This can cause malformed
URLs to be evaluated in unexpected ways by common redirect allow list
implementations in Express applications, leading to an Open Redirect via
bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called
from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd

https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature
regression in `4.19.1` and added improved handling for the bypass in
`4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either
`require('node:url').parse` or `new URL`. These are steps you can take
on your own before passing the user input string to `res.location` or
`res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)

[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

###
[`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

###
[`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

- Allow passing non-strings to res.location with new encoding handling
checks

###
[`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

###
[`v4.18.3`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.2...4.18.3)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" in timezone America/Los_Angeles,
Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR is behind base branch, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about these
updates again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View
repository job log
[here](https://developer.mend.io/github/apollographql/apollo-server).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->

Co-authored-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>")`
â€¦

`[5cf2928](/apollographql/apollo-server/commit/5cf29285f47a34f51d462b9653d27dd45b674f70)`

```
[![Mend
Renovate]([https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com](https://app.renovatebot.com/images/banner.svg%29%5D%28https%3A//renovatebot.com))

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](<http://expressjs.com/>)
([source](<https://togithub.com/expressjs/express>)) | [`4.18.2` ->
`4.19.2`](<https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2>) |
[![age](<https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![adoption](<https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![passing](<https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![confidence](<https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|

### GitHub Vulnerability Alerts

####
[[CVE-2024-29041](https://github.com/advisories/GHSA-rv95-896h-c2vc "CVE-2024-29041")](<https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc>)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta
versions before 5.0.0-beta.3 are affected by an open redirect
vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL
Express performs an encode [using
`encodeurl`](<https://togithub.com/pillarjs/encodeurl>) on the contents
before passing it to the `location` header. This can cause malformed
URLs to be evaluated in unexpected ways by common redirect allow list
implementations in Express applications, leading to an Open Redirect via
bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called
from within `res.redirect()`.

### Patches

[expressjs/express@0867302](https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd)

[expressjs/express@0b74695](https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94)

An initial fix went out with `express@4.19.0`, we then patched a feature
regression in `4.19.1` and added improved handling for the bypass in
`4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either
`require('node:url').parse` or `new URL`. These are steps you can take
on your own before passing the user input string to `res.location` or
`res.redirect`.

### References

[[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)](https://github.com/expressjs/express/pull/5539%5D%28https%3A//togithub.com/expressjs/express/pull/5539%29)

[[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)](https://github.com/koajs/koa/issues/1800%5D%28https%3A//togithub.com/koajs/koa/issues/1800%29)
<https://expressjs.com/en/4x/api.html#res.location>

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

###
[`v4.19.2`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.19.1...4.19.2>)

\==========

-   Improved fix for open redirect allow list bypass

###
[`v4.19.1`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.19.0...4.19.1>)

\==========

- Allow passing non-strings to res.location with new encoding handling
checks

###
[`v4.19.0`](<https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.18.3...4.19.0>)

###
[`v4.18.3`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.18.2...4.18.3>)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - "" in timezone America/Los_Angeles,
Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR is behind base branch, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about these
updates again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](<https://www.mend.io/free-developer-tools/renovate/>). View
repository job log
[here](<https://developer.mend.io/github/apollographql/apollo-server>).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->

Co-authored-by: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>
```

[holtskinner](/holtskinner)
referenced
this issue
in GoogleCloudPlatform/document-ai-samples
[Mar 28, 2024](#ref-commit-4f4de06)
[![@renovate-bot](https://avatars.githubusercontent.com/u/25180681?s=40&u=52b5860ab267400de6ab46df639ef58661455321&v=4)](/renovate-bot)

`[fix(deps): update dependency express to v4.19.2 [security] (](/GoogleCloudPlatform/document-ai-samples/commit/4f4de06c668d9bc5988f9bfc810e8ee979f39e33 "fix(deps): update dependency express to v4.19.2 [security] (#776)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/)
([source](https://togithub.com/expressjs/express)) | [`4.18.2` ->
`4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

### GitHub Vulnerability Alerts

####
[CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta
versions before 5.0.0-beta.3 are affected by an open redirect
vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL
Express performs an encode [using
`encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents
before passing it to the `location` header. This can cause malformed
URLs to be evaluated in unexpected ways by common redirect allow list
implementations in Express applications, leading to an Open Redirect via
bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called
from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd

https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature
regression in `4.19.1` and added improved handling for the bypass in
`4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either
`require('node:url').parse` or `new URL`. These are steps you can take
on your own before passing the user input string to `res.location` or
`res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)

[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

###
[`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

###
[`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

- Allow passing non-strings to res.location with new encoding handling
checks

###
[`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

###
[`v4.18.3`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.2...4.18.3)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - At any time (no schedule defined),
Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR is behind base branch, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View
repository job log
[here](https://developer.mend.io/github/GoogleCloudPlatform/document-ai-samples).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->")[#776](https://github.com/GoogleCloudPlatform/document-ai-samples/pull/776)[)](/GoogleCloudPlatform/document-ai-samples/commit/4f4de06c668d9bc5988f9bfc810e8ee979f39e33 "fix(deps): update dependency express to v4.19.2 [security] (#776)

[![Mend
Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/)
([source](https://togithub.com/expressjs/express)) | [`4.18.2` ->
`4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2) |
[![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|
[![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/)
|

### GitHub Vulnerability Alerts

####
[CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta
versions before 5.0.0-beta.3 are affected by an open redirect
vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL
Express performs an encode [using
`encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents
before passing it to the `location` header. This can cause malformed
URLs to be evaluated in unexpected ways by common redirect allow list
implementations in Express applications, leading to an Open Redirect via
bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called
from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd

https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature
regression in `4.19.1` and added improved handling for the bypass in
`4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either
`require('node:url').parse` or `new URL`. These are steps you can take
on your own before passing the user input string to `res.location` or
`res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)

[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

###
[`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

###
[`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

- Allow passing non-strings to res.location with new encoding handling
checks

###
[`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

###
[`v4.18.3`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26)

[Compare
Source](https://togithub.com/expressjs/express/compare/4.18.2...4.18.3)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - At any time (no schedule defined),
Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR is behind base branch, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](https://www.mend.io/free-developer-tools/renovate/). View
repository job log
[here](https://developer.mend.io/github/GoogleCloudPlatform/document-ai-samples).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->")`
â€¦

`[4f4de06](/GoogleCloudPlatform/document-ai-samples/commit/4f4de06c668d9bc5988f9bfc810e8ee979f39e33)`

```
[![Mend
Renovate]([https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com](https://app.renovatebot.com/images/banner.svg%29%5D%28https%3A//renovatebot.com))

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](<http://expressjs.com/>)
([source](<https://togithub.com/expressjs/express>)) | [`4.18.2` ->
`4.19.2`](<https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2>) |
[![age](<https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![adoption](<https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![passing](<https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|
[![confidence](<https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>)
|

### GitHub Vulnerability Alerts

####
[[CVE-2024-29041](https://github.com/advisories/GHSA-rv95-896h-c2vc "CVE-2024-29041")](<https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc>)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta
versions before 5.0.0-beta.3 are affected by an open redirect
vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL
Express performs an encode [using
`encodeurl`](<https://togithub.com/pillarjs/encodeurl>) on the contents
before passing it to the `location` header. This can cause malformed
URLs to be evaluated in unexpected ways by common redirect allow list
implementations in Express applications, leading to an Open Redirect via
bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called
from within `res.redirect()`.

### Patches

[expressjs/express@0867302](https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd)

[expressjs/express@0b74695](https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94)

An initial fix went out with `express@4.19.0`, we then patched a feature
regression in `4.19.1` and added improved handling for the bypass in
`4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either
`require('node:url').parse` or `new URL`. These are steps you can take
on your own before passing the user input string to `res.location` or
`res.redirect`.

### References

[[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)](https://github.com/expressjs/express/pull/5539%5D%28https%3A//togithub.com/expressjs/express/pull/5539%29)

[[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)](https://github.com/koajs/koa/issues/1800%5D%28https%3A//togithub.com/koajs/koa/issues/1800%29)
<https://expressjs.com/en/4x/api.html#res.location>

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

###
[`v4.19.2`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.19.1...4.19.2>)

\==========

-   Improved fix for open redirect allow list bypass

###
[`v4.19.1`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.19.0...4.19.1>)

\==========

- Allow passing non-strings to res.location with new encoding handling
checks

###
[`v4.19.0`](<https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.18.3...4.19.0>)

###
[`v4.18.3`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26>)

[Compare
Source](<https://togithub.com/expressjs/express/compare/4.18.2...4.18.3>)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - At any time (no schedule defined),
Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Enabled.

â™» **Rebasing**: Whenever PR is behind base branch, or you tick the
rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update
again.

---

- [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check
this box

---

This PR has been generated by [Mend
Renovate](<https://www.mend.io/free-developer-tools/renovate/>). View
repository job log
[here](<https://developer.mend.io/github/GoogleCloudPlatform/document-ai-samples>).

<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjI2OS4yIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->
```

[![@PavelMor25](https://avatars.githubusercontent.com/u/77216072?s=40&v=4)](/PavelMor25)
[PavelMor25](/PavelMor25)
mentioned this issue
[Mar 30, 2024](#ref-issue-2216148419)

[Express.js Open Redirect in malformed URLs
PavelMor25/testcafe-private#74](/PavelMor25/testcafe-private/issues/74)

Closed

1 task

[etroynov](/etroynov)
pushed a commit
to etroynov/koa
that referenced
this issue
[Apr 1, 2024](#ref-commit-69932e3)
[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2) [![@etroynov](https://avatars.githubusercontent.com/u/4591518?s=40&v=4)](/etroynov)

`[fix: formatting redirect url on http(s) protocol url (](/etroynov/koa/commit/69932e344f486da765eb62925b96a8c255f7d1b8 "fix: formatting redirect url on http(s) protocol url (#1804)

closes https://github.com/koajs/koa/issues/1800

pick from https://github.com/koajs/koa/pull/1803")[koajs#1804](https://github.com/koajs/koa/pull/1804)[)](/etroynov/koa/commit/69932e344f486da765eb62925b96a8c255f7d1b8 "fix: formatting redirect url on http(s) protocol url (#1804)

closes https://github.com/koajs/koa/issues/1800

pick from https://github.com/koajs/koa/pull/1803")`
â€¦

`[69932e3](/etroynov/koa/commit/69932e344f486da765eb62925b96a8c255f7d1b8)`

```
closes [koajs#1800](https://github.com/koajs/koa/issues/1800)

pick from [koajs#1803](https://github.com/koajs/koa/pull/1803)
```

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Apr 2, 2024](#ref-pullrequest-2220944871)

[chore(deps): update dependency n8n to v1.34.2
uniget-org/tools#3953](/uniget-org/tools/pull/3953)
 Merged

1 task

[![@hmdevelopermind](https://avatars.githubusercontent.com/u/52859974?s=40&v=4)](/hmdevelopermind)
[hmdevelopermind](/hmdevelopermind)
mentioned this issue
[Apr 3, 2024](#ref-issue-2222946341)

[Vulnerabilities in express
scottie1984/swagger-ui-express#369](/scottie1984/swagger-ui-express/issues/369)

Closed

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Apr 4, 2024](#ref-pullrequest-2206344572)

[essais de fix horizontal pod scaller
Khagou/khagu-devops#23](/Khagou/khagu-devops/pull/23)
 Merged

This was referenced Apr 13, 2024

[first try deploiement raspberry
Khagou/khagu-devops#24](/Khagou/khagu-devops/pull/24)
 Closed

[second try deploiement raspberry
Khagou/khagu-devops#25](/Khagou/khagu-devops/pull/25)
 Closed

[3eme essais deploiement raspberry, utilisation image compatible amd64+arm64
Khagou/khagu-devops#26](/Khagou/khagu-devops/pull/26)
 Closed

[Essais deploiement avec api url localhost
Khagou/khagu-devops#27](/Khagou/khagu-devops/pull/27)
 Closed

[4eme essais i guess, modif url pour utiliser ip
Khagou/khagu-devops#28](/Khagou/khagu-devops/pull/28)
 Closed

[Test
Khagou/khagu-devops#29](/Khagou/khagu-devops/pull/29)
 Closed

[Test2
Khagou/khagu-devops#30](/Khagou/khagu-devops/pull/30)
 Closed

This was referenced Apr 13, 2024

[Test
Khagou/khagu-devops#31](/Khagou/khagu-devops/pull/31)
 Closed

[Test
Khagou/khagu-devops#32](/Khagou/khagu-devops/pull/32)
 Closed

[Test
Khagou/khagu-devops#33](/Khagou/khagu-devops/pull/33)
 Closed

[should fix ssl pour back
Khagou/khagu-devops#34](/Khagou/khagu-devops/pull/34)
 Open

[hi5a](/hi5a)
referenced
this issue
in nordic-game-lab/learnhub-sdk
[May 4, 2024](#ref-commit-71e6f1c)
[![@renovate](https://avatars.githubusercontent.com/in/2740?s=40&v=4)](/marketplace/renovate)

`[Update dependency express to v4.19.2 [SECURITY] (](/nordic-game-lab/learnhub-sdk/commit/71e6f1c752652baae44d48f92ea6969c51d0d5aa "Update dependency express to v4.19.2 [SECURITY] (#15)

[![Mend Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/) ([source](https://togithub.com/expressjs/express)) | [`4.18.2` -> `4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2) | [![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) |

### GitHub Vulnerability Alerts

#### [CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd
https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)
[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

### [`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

### [`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

-   Allow passing non-strings to res.location with new encoding handling checks

### [`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

### [`v4.18.3`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.2...4.18.3)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box

---

This PR has been generated by [Mend Renovate](https://www.mend.io/free-developer-tools/renovate/). View repository job log [here](https://developer.mend.io/github/nordic-game-lab/ngl-api-sdk).
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjMzMS4wIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->")[#15](https://github.com/nordic-game-lab/learnhub-sdk/pull/15)[)](/nordic-game-lab/learnhub-sdk/commit/71e6f1c752652baae44d48f92ea6969c51d0d5aa "Update dependency express to v4.19.2 [SECURITY] (#15)

[![Mend Renovate](https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com)

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](http://expressjs.com/) ([source](https://togithub.com/expressjs/express)) | [`4.18.2` -> `4.19.2`](https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2) | [![age](https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/) |

### GitHub Vulnerability Alerts

#### [CVE-2024-29041](https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://togithub.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called from within `res.redirect()`.

### Patches

https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd
https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94

An initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.

### References

[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)
[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)
https://expressjs.com/en/4x/api.html#res.location

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

### [`v4.19.2`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.1...4.19.2)

\==========

-   Improved fix for open redirect allow list bypass

### [`v4.19.1`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20)

[Compare Source](https://togithub.com/expressjs/express/compare/4.19.0...4.19.1)

\==========

-   Allow passing non-strings to res.location with new encoding handling checks

### [`v4.19.0`](https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.3...4.19.0)

### [`v4.18.3`](https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26)

[Compare Source](https://togithub.com/expressjs/express/compare/4.18.2...4.18.3)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - \"\" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box

---

This PR has been generated by [Mend Renovate](https://www.mend.io/free-developer-tools/renovate/). View repository job log [here](https://developer.mend.io/github/nordic-game-lab/ngl-api-sdk).
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjMzMS4wIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->")`
â€¦

`[71e6f1c](/nordic-game-lab/learnhub-sdk/commit/71e6f1c752652baae44d48f92ea6969c51d0d5aa)`

```
[![Mend Renovate]([https://app.renovatebot.com/images/banner.svg)](https://renovatebot.com](https://app.renovatebot.com/images/banner.svg%29%5D%28https%3A//renovatebot.com))

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [express](<http://expressjs.com/>) ([source](<https://togithub.com/expressjs/express>)) | [`4.18.2` -> `4.19.2`](<https://renovatebot.com/diffs/npm/express/4.18.2/4.19.2>) | [![age](<https://developer.mend.io/api/mc/badges/age/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) | [![adoption](<https://developer.mend.io/api/mc/badges/adoption/npm/express/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) | [![passing](<https://developer.mend.io/api/mc/badges/compatibility/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) | [![confidence](<https://developer.mend.io/api/mc/badges/confidence/npm/express/4.18.2/4.19.2?slim=true)](https://docs.renovatebot.com/merge-confidence/>) |

### GitHub Vulnerability Alerts

#### [[CVE-2024-29041](https://github.com/advisories/GHSA-rv95-896h-c2vc "CVE-2024-29041")](<https://togithub.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc>)

### Impact

Versions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.

When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](<https://togithub.com/pillarjs/encodeurl>) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.

The main method impacted is `res.location()` but this is also called from within `res.redirect()`.

### Patches

[expressjs/express@0867302](https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd)
[expressjs/express@0b74695](https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94)

An initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.

### Workarounds

The fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.

### References

[[https://github.com/expressjs/express/pull/5539](https://togithub.com/expressjs/express/pull/5539)](https://github.com/expressjs/express/pull/5539%5D%28https%3A//togithub.com/expressjs/express/pull/5539%29)
[[https://github.com/koajs/koa/issues/1800](https://togithub.com/koajs/koa/issues/1800)](https://github.com/koajs/koa/issues/1800%5D%28https%3A//togithub.com/koajs/koa/issues/1800%29)
<https://expressjs.com/en/4x/api.html#res.location>

---

### Release Notes

<details>
<summary>expressjs/express (express)</summary>

### [`v4.19.2`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4192--2024-03-25>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.19.1...4.19.2>)

\==========

-   Improved fix for open redirect allow list bypass

### [`v4.19.1`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4191--2024-03-20>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.19.0...4.19.1>)

\==========

-   Allow passing non-strings to res.location with new encoding handling checks

### [`v4.19.0`](<https://togithub.com/expressjs/express/compare/4.18.3...83e77aff6a3859d58206f3ff9501277023c03f87>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.18.3...4.19.0>)

### [`v4.18.3`](<https://togithub.com/expressjs/express/blob/HEAD/History.md#4183--2024-02-26>)

[Compare Source](<https://togithub.com/expressjs/express/compare/4.18.2...4.18.3>)

\==========

-   Fix routing requests without method
-   deps: body-parser@1.20.2
    -   Fix strict json error message on Node.js 19+
    -   deps: content-type@~1.0.5
    -   deps: raw-body@2.5.2

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - "" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box

---

This PR has been generated by [Mend Renovate](<https://www.mend.io/free-developer-tools/renovate/>). View repository job log [here](<https://developer.mend.io/github/nordic-game-lab/ngl-api-sdk>).
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy4yNjkuMiIsInVwZGF0ZWRJblZlciI6IjM3LjMzMS4wIiwidGFyZ2V0QnJhbmNoIjoibWFpbiJ9-->
```

This was referenced Aug 15, 2024

[Fix missing node modules for theme
2pisoftware/cmfive-boilerplate#156](/2pisoftware/cmfive-boilerplate/pull/156)
 Merged

[Medium severity - Open Redirect vulnerability in express (package.json)
jordaniac89/juice-shop#206](/jordaniac89/juice-shop/issues/206)

Open

This was referenced Sep 12, 2024

[[Snyk] Security upgrade express from 4.17.1 to 4.21.0
m-mizutani/boilerplate-cdk-react-app#8](/m-mizutani/boilerplate-cdk-react-app/pull/8)
 Open

[[Snyk] Security upgrade express from 4.17.1 to 4.20.0
m-mizutani/boilerplate-cdk-react-app#9](/m-mizutani/boilerplate-cdk-react-app/pull/9)
 Open

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this issue
[Nov 14, 2024](#ref-pullrequest-2657732834)

[express4.17.3
tadashi0713/docker-scout-demo#8](/tadashi0713/docker-scout-demo/pull/8)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fkoajs%2Fkoa%2Fissues%2F1800)

Assignees

[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=40&v=4)](/fengmk2) [fengmk2](/fengmk2)

Labels

[bug](/koajs/koa/labels/bug)

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [fix: formatting redirect url on http(s) protocol url](/koajs/koa/pull/1803)
 [koajs/koa](/koajs/koa)

 [fix: formatting redirect url on http(s) protocol url](/koajs/koa/pull/1804)
 [koajs/koa](/koajs/koa)

2 participants

[![@fengmk2](https://avatars.githubusercontent.com/u/156269?s=52&v=4)](/fengmk2) [![@FDrag0n](https://avatars.githubusercontent.com/u/34733637?s=52&v=4)](/FDrag0n)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.

