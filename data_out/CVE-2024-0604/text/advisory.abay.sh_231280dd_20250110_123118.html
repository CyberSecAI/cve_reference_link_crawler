            LIGHT            DARK  [home](/)[archive](/archive/)[about](https://abay.sh/) [RSS](/feed.xml)            [WORDPRESS](/tags/#wordpress), [XSS](/tags/#xss)
# CVE-2024-0604 — Best WordPress Gallery Plugin – FooGallery <= 2.4.7 -Authenticated(Administrator+) Stored Cross-Site Scripting via settings

  Feb 14, 2024   Feb 14, 2024  abay

The Best WordPress Gallery Plugin – FooGallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via admin settings in all versions up to, and including, 2.4.7 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page. This only affects multi-site installations and installations where unfiltered\_html has been disabled.

The Best WordPress Gallery Plugin – FooGallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via admin settings in all versions up to, and including, 2.4.7 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page. This only affects multi-site installations and installations where unfiltered\_html has been disabled.

### Proof of Concepts

1. Open plugin setting and go to Language section /wp-admin/edit.php?post\_type=foogallery&page=foogallery-settings#language
2. Put XSS Payload ‘Image Viewer “Prev” Text’ form `Prev</script><img src onerror=alert(/XSS/)>`
3. Create new Gallery and put the shortcode in a new post

XSS Payload will triggered in the created post.

`var FooGallery_il8n = {"template":{"image-viewer":{"prev":"Prev</script><img src onerror=alert(/XSS/)>"}}};`

Note: All form in **\*\*Image Viewer Template**\*\* is vulnerable to XSS

### Impact

This makes it possible for authenticated attackers, with administrator-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

### Links

* [Best WordPress Gallery Plugin – FooGallery <= 2.4.7 -Authenticated(Administrator+) Stored Cross-Site Scripting via settings - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/foogallery/best-wordpress-gallery-plugin-foogallery-247-authenticatedadministrator-stored-cross-site-scripting-via-settings "Wordfence")
* [CVE-2024-0604 Detail - CVE.ORG](https://www.cve.org/CVERecord?id=CVE-2024-0604 "cve.org")
     [Previous CVE-2024-0597 — SEO Plugin by Squirrly SEO WP Plugin <= 12.3.15 Administrator+ Stored Cross-Site Scritpting](/cve-2024-0597/)   [Next CVE-2024-0621 — Simple Share Buttons Adder <= 8.4.11 - Authenticated(Administrator+) Stored Cross-Site Scripting via CSS Settings](/cve-2024-0621/)     © 2024   [klisé](https://github.com/piharpi/jekyll-klise) theme on [jekyll](https://jekyllrb.com)