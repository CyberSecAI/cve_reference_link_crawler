
[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

April 18, 2024
# GHSL-2024-033: Server-Side Request Forgery (SSRF) in open-webui - CVE-2024-30256

[![Author avatar](https://avatars.githubusercontent.com/u/102833689)
Sylwia Budzynska](https://github.com/sylwia-budzynska)

## Coordinated Disclosure Timeline

* 2024-03-18: Submitted the report via PVR.
* 2024-04-01: [PVR](https://github.com/open-webui/open-webui/security/advisories/GHSA-39wr-r5vm-3jxj#event-151566) is accepted, fix created and CVE requested.
* 2024-04-16: Advisory is [published](https://github.com/open-webui/open-webui/security/advisories/GHSA-39wr-r5vm-3jxj).

## Summary

Open-webui is vulnerable to authenticated blind server-side request forgery.

## Project

open-webui

## Tested Version

[v0.1.111](https://github.com/open-webui/open-webui/releases/tag/v0.1.111)

## Details

### Blind SSRF in backend/apps/web/routers/utils.py (`GHSL-2024-033`)

The `download` endpoint accepts user input in the [`url`](https://github.com/open-webui/open-webui/blob/7ae4669f350ad30b44594c5e76759db445d9bf5d/backend/apps/web/routers/utils.py#L96) GET parameter, which is later used in the `download_file_stream` function to send a [GET request](https://github.com/open-webui/open-webui/blob/7ae4669f350ad30b44594c5e76759db445d9bf5d/backend/apps/web/routers/utils.py#L61), which leads to a blind server-side request forgery.

```
async def download_file_stream(url, file_path, file_name, chunk_size=1024 * 1024):
    done = False

    if os.path.exists(file_path):
        current_size = os.path.getsize(file_path)
    else:
        current_size = 0

    headers = {"Range": f"bytes={current_size}-"} if current_size > 0 else {}

    timeout = aiohttp.ClientTimeout(total=600)  # Set the timeout

    async with aiohttp.ClientSession(timeout=timeout) as session:
        async with session.get(url, headers=headers) as response:
            total_size = int(response.headers.get("content-length", 0)) + current_size

```
#### Impact

This issue allows for sending requests on behalf of open-webui server and can be leveraged to probe for other vulnerabilities on the server itself or on other back-end systems on the internal network, that the open-webui server can reach.

## CVE

* CVE-2024-30256

## Credit

This issue was discovered and reported by GHSL team member [@sylwia-budzynska (Sylwia Budzynska)](https://github.com/sylwia-budzynska). This vulnerability was found with help of [CodeQL](https://codeql.github.com/codeql-query-help/python/py-full-ssrf/).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2024-033` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. Â©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information

