```
{
  "CVE-2024-0397": {
    "Description": "A defect was discovered in the Python “ssl” module where there is a memory race condition with the ssl.SSLContext methods “cert_store_stats()” and “get_ca_certs()”. The race condition can be triggered if the methods are called at the same time as certificates are loaded into the SSLContext, such as during the TLS handshake with a certificate directory configured. This issue is fixed in CPython 3.10.14, 3.11.9, 3.12.3, and 3.13.0a5.",
    "Root cause": "The functions `cert_store_stats` and `get_ca_certs` in Python's ssl module were querying the SSLContext's X509_STORE using `X509_STORE_get0_objects`, but reading the results required a lock that was not being acquired. This resulted in a race condition when the certificate store is modified in a different thread.",
    "Weaknesses": [
      "Race condition",
      "Improper locking"
    ],
    "Impact": "A memory race condition could occur when calling cert_store_stats or get_ca_certs concurrently with operations that modify the certificate store, potentially leading to a crash or data corruption.",
    "Attack vectors": "The vulnerability is triggered by concurrent access to the certificate store in multithreaded application.",
        "Required attacker capabilities/position": "The attacker would need to have control over a multithreaded python application that uses the affected ssl module, and be able to trigger the vulnerable functions, as well as operations that modify the cert store (e.g. during a TLS handshake with a certificate directory)."
  }
}
```