<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: CVE-2024-40761: Apache Answer: Avatar URL leaked
 user email addresses</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://twitter.com/openwall">
Follow @Openwall on Twitter for new release announcements and other news</a>

</TABLE>
</TABLE>

<a href="4">[&lt;prev]</a> <a href="6">[next&gt;]</a> <a href="4">[&lt;thread-prev]</a> <a href="8">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;dbf738ce-d236-4c8b-864d-900d4e7c3238&#64;rub.de&gt;
Date: Fri, 27 Sep 2024 14:49:00 +0200
From: Fabian Bäumer &lt;fabian.baeumer&#64;....de&gt;
To: oss-security&#64;...ts.openwall.com
Subject: Re: CVE-2024-40761: Apache Answer: Avatar URL leaked
 user email addresses

&gt; I don't think that a seeded PRF (with a per-server seed) would meet
&gt; the requirements here.
I think you are right. When I wrote my response yesterday I wasn't fully 
aware how Gravatar is supposed to be used. I always thought of Gravatar 
as a service to generate unique avatar images.

Now, this leaves me with a few observations:

 1. The 'should be taken' from Gravatar's documentation should be 'must
    be taken' to ensure consistent user hashes (therefore using MD5 in
    the first place rendered Gravatar useless if Gravatar doesn't match
    against MD5 hashes as well).
 2. The information leakage with Gravatar is in-spec. Fixing the
    information leakage would be possible but requires changes on
    Gravatar's side by implementing a symmetric cipher instead of a hash
    (as suggested; a hash wouldn't be tractable any more because
    Gravatar would need to hash every user's email address with every
    registered seed when using seeded PRF). Prior hashing wouldn't even
    be required given that both sides - Gravatar and the site itself -
    have access to the user's email address anyway.
 3. It may be advisable to not use Gravatar as the default (not sure if
    this is the case here). Instead, let user's choose it and let them
    know about the potential information leakage.
 4. The fix does not fix what it tries to fix.
 5. Assigning a CVE for an in-spec information leakage seems not useful
    to me. Otherwise, every single product using Gravatar would be
    affected by this.

M. Sc. Fabian Bäumer

Chair for Network and Data Security
Ruhr University Bochum
Universitätsstr. 150, Building MC 4/145
44780 Bochum
Germany

Am 27.09.2024 um 14:25 schrieb Alexander Patrakov:
&gt; On Thu, Sep 26, 2024 at 5:19 AM Demi Marie Obenour
&gt; &lt;demi&#64;...isiblethingslab.com&gt; wrote:
&gt;&gt; On Wed, Sep 25, 2024 at 06:28:16AM +0000, Enxin Xie wrote:
&gt;&gt;&gt; Severity: low
&gt;&gt;&gt;
&gt;&gt;&gt; Affected versions:
&gt;&gt;&gt;
&gt;&gt;&gt; - Apache Answer through 1.3.5
&gt;&gt;&gt;
&gt;&gt;&gt; Description:
&gt;&gt;&gt;
&gt;&gt;&gt; Inadequate Encryption Strength vulnerability in Apache Answer.
&gt;&gt;&gt;
&gt;&gt;&gt; This issue affects Apache Answer: through 1.3.5.
&gt;&gt;&gt;
&gt;&gt;&gt; Using the MD5 value of a user's email to access Gravatar is insecure and can lead to the leakage of user email. The official recommendation is to use SHA256 instead.
&gt;&gt;&gt; Users are recommended to upgrade to version 1.4.0, which fixes the issue.
&gt;&gt;&gt;
&gt;&gt;&gt; Credit:
&gt;&gt;&gt;
&gt;&gt;&gt; 张岳熙 (reporter)
&gt;&gt;&gt;
&gt;&gt;&gt; References:
&gt;&gt;&gt;
&gt;&gt;&gt; <a href="https://answer.incubator.apache.org" rel="nofollow">https://answer.incubator.apache.org</a>
&gt;&gt;&gt; <a href="https://www.cve.org/CVERecord?id=CVE-2024-40761" rel="nofollow">https://www.cve.org/CVERecord?id=CVE-2024-40761</a>
&gt;&gt; What is the specific property of SHA256 required here?  Email addresses
&gt;&gt; have low entropy and I suspect they can be easily brute-forced, so
&gt;&gt; leaking the SHA256 has is still bad.  Instead, I would use a seeded PRF
&gt;&gt; with a seed only known to the server, ensuring that the resulting value
&gt;&gt; does not leak any information about the email.
&gt;&gt; --
&gt;&gt; Sincerely,
&gt;&gt; Demi Marie Obenour (she/her/hers)
&gt;&gt; Invisible Things Lab
&gt; I don't think that a seeded PRF (with a per-server seed) would meet
&gt; the requirements here. The problem is that Gravatar would have no way
&gt; of understanding which email is in question. Indeed, that would
&gt; require storing all emails hashed with all registered server seeds.
&gt;
&gt; What would work is an email hash encrypted symmetrically with a
&gt; per-server key. Then Gravatar (who also knows this key) would decrypt
&gt; the email hash and look up the avatar image.
&gt;
&gt; Note that all of the above talks about a hypothetical improved version
&gt; of Gravatar, not what we have right now.
&gt;

<span style="font-family: times;"><strong>Content of type "</strong>text/html<strong>" skipped</strong></span>

<span style="font-family: times;"><strong>Download attachment "</strong><a href="5/1" rel="nofollow" download>smime.p7s</a><strong>" of type "</strong>application/pkcs7-signature<strong>" (6214 bytes)</strong></span>
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
