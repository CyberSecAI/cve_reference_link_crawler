

[Skip to content](#rbac-configuration)

[![logo](../../assets/logo.png)](../.. "Argo CD - Declarative GitOps CD for Kubernetes")

Argo CD - Declarative GitOps CD for Kubernetes

RBAC Configuration

Initializing search

[GitHub](https://github.com/argoproj/argo-cd "Go to repository")

[![logo](../../assets/logo.png)](../.. "Argo CD - Declarative GitOps CD for Kubernetes")
Argo CD - Declarative GitOps CD for Kubernetes

[GitHub](https://github.com/argoproj/argo-cd "Go to repository")

* [Overview](../..)
* [Understand The Basics](../../understand_the_basics/)
* [Core Concepts](../../core_concepts/)
* [Getting Started](../../getting_started/)
* Operator Manual

  Operator Manual
  + [Overview](../)
  + [Architectural Overview](../architecture/)
  + [Installation](../installation/)
  + [Feature Maturity](../feature-maturity/)
  + [Argo CD Core](../core/)
  + [Declarative Setup](../declarative-setup/)
  + [Applications in any namespace](../app-any-namespace/)
  + [Ingress Configuration](../ingress/)
  + High Availability

    High Availability
    - [Overview](../high_availability/)
    - [Dynamic Cluster Distribution](../dynamic-cluster-distribution/)
  + User Management

    User Management
    - [Overview](../user-management/)
    - [Auth0](../user-management/auth0/)
    - [Microsoft](../user-management/microsoft/)
    - [Okta](../user-management/okta/)
    - [OneLogin](../user-management/onelogin/)
    - [Keycloak](../user-management/keycloak/)
    - [OpenUnison](../user-management/openunison/)
    - [Google](../user-management/google/)
    - [Zitadel](../user-management/zitadel/)
    - [Identity Center (AWS SSO)](../user-management/identity-center/)
    - RBAC Configuration

      [RBAC Configuration](./)

      Table of contents
      * [Basic Built-in Roles](#basic-built-in-roles)
      * [Default Policy for Authenticated Users](#default-policy-for-authenticated-users)
      * [Anonymous Access](#anonymous-access)
      * [RBAC Model Structure](#rbac-model-structure)
        + [Application-Specific Policy](#application-specific-policy)
          - [Application in Any Namespaces](#application-in-any-namespaces)
        + [The applications resource](#the-applications-resource)
          - [Fine-grained Permissions for update/delete action](#fine-grained-permissions-for-updatedelete-action)
          - [The action action](#the-action-action)
          - [The override action](#the-override-action)
        + [The applicationsets resource](#the-applicationsets-resource)
        + [The logs resource](#the-logs-resource)
        + [The exec resource](#the-exec-resource)
        + [The extensions resource](#the-extensions-resource)
        + [The deny effect](#the-deny-effect)
      * [Policies Evaluation and Matching](#policies-evaluation-and-matching)
        + [Glob matching](#glob-matching)
      * [Using SSO Users/Groups](#using-sso-usersgroups)
      * [Local Users/Accounts](#local-usersaccounts)
      * [Policy CSV Composition](#policy-csv-composition)
      * [Validating and testing your RBAC policies](#validating-and-testing-your-rbac-policies)
        + [Validating a policy](#validating-a-policy)
        + [Testing a policy](#testing-a-policy)
  + Security

    Security
    - [Overview](../security/)
    - [Snyk Scans](../../snyk/)
    - [Verification of Argo CD Artifacts](../signed-release-assets/)
  + [TLS configuration](../tls/)
  + [Cluster Management](../cluster-management/)
  + [Cluster Bootstrapping](../cluster-bootstrapping/)
  + [Secret Management](../secret-management/)
  + [Disaster Recovery](../disaster_recovery/)
  + [Reconcile Optimization](../reconcile/)
  + [Git Webhook Configuration](../webhook/)
  + [Resource Health](../health/)
  + [Resource Actions](../resource_actions/)
  + [Custom Tooling](../custom_tools/)
  + [Custom Styles](../custom-styles/)
  + [UI Customization](../ui-customization/)
  + [Metrics](../metrics/)
  + [Web-based Terminal](../web_based_terminal/)
  + [Config Management Plugins](../config-management-plugins/)
  + [Deep Links](../deep_links/)
  + Notifications

    Notifications
    - [Overview](../notifications/)
    - [Triggers](../notifications/triggers/)
    - [Templates](../notifications/templates/)
    - [Functions](../notifications/functions/)
    - [Triggers and Templates Catalog](../notifications/catalog/)
    - [Monitoring](../notifications/monitoring/)
    - [Subscriptions](../notifications/subscriptions/)
    - [Troubleshooting](../notifications/troubleshooting/)
    - [Troubleshooting commands](../notifications/troubleshooting-commands/)
    - [Troubleshooting errors](../notifications/troubleshooting-errors/)
    - Notification Services

      Notification Services
      * [Alertmanager](../notifications/services/alertmanager/)
      * [AWS SQS](../notifications/services/awssqs/)
      * [Email](../notifications/services/email/)
      * [GitHub](../notifications/services/github/)
      * [Google Chat](../notifications/services/googlechat/)
      * [Grafana](../notifications/services/grafana/)
      * [Mattermost](../notifications/services/mattermost/)
      * [NewRelic](../notifications/services/newrelic/)
      * [Opsgenie](../notifications/services/opsgenie/)
      * [Overview](../notifications/services/overview/)
      * [PagerDuty](../notifications/services/pagerduty/)
      * [PagerDuty V2](../notifications/services/pagerduty_v2/)
      * [Pushover](../notifications/services/pushover/)
      * [Rocket.Chat](../notifications/services/rocketchat/)
      * [Slack](../notifications/services/slack/)
      * [Teams](../notifications/services/teams/)
      * [Telegram](../notifications/services/telegram/)
      * [Webex Teams](../notifications/services/webex/)
      * [Webhook](../notifications/services/webhook/)
  + [Troubleshooting Tools](../troubleshooting/)
  + ApplicationSet

    ApplicationSet
    - [Introduction](../applicationset/)
    - [Installations](../applicationset/Getting-Started/)
    - [Use Cases](../applicationset/Use-Cases/)
    - [Security](../applicationset/Security/)
    - [How ApplicationSet controller interacts with Argo CD](../applicationset/Argo-CD-Integration/)
    - Generators

      Generators
      * [Generators](../applicationset/Generators/)
      * [List Generator](../applicationset/Generators-List/)
      * [Cluster Generator](../applicationset/Generators-Cluster/)
      * [Git Generator](../applicationset/Generators-Git/)
      * [Matrix Generator](../applicationset/Generators-Matrix/)
      * [Merge Generator](../applicationset/Generators-Merge/)
      * [SCM Provider Generator](../applicationset/Generators-SCM-Provider/)
      * [Cluster Decision Resource Generator](../applicationset/Generators-Cluster-Decision-Resource/)
      * [Pull Request Generator](../applicationset/Generators-Pull-Request/)
      * [Post Selector all generators](../applicationset/Generators-Post-Selector/)
      * [Plugin Generator](../applicationset/Generators-Plugin/)
    - Template fields

      Template fields
      * [Templates](../applicationset/Template/)
      * [Go Template](../applicationset/GoTemplate/)
    - [Controlling Resource Modification](../applicationset/Controlling-Resource-Modification/)
    - [Application Pruning & Resource Deletion](../applicationset/Application-Deletion/)
    - [Progressive Syncs](../applicationset/Progressive-Syncs/)
    - [Git File Generator Globbing](../applicationset/Generators-Git-File-Globbing/)
    - [ApplicationSet Specification Reference](../applicationset/applicationset-specification/)
    - [ApplicationSet in any namespace](../applicationset/Appset-Any-Namespace/)
  + Server Configuration Parameters

    Server Configuration Parameters
    - [argocd-server Command Reference](../server-commands/argocd-server/)
    - [argocd-application-controller Command Reference](../server-commands/argocd-application-controller/)
    - [argocd-repo-server Command Reference](../server-commands/argocd-repo-server/)
    - [argocd-dex Command Reference](../server-commands/argocd-dex/)
    - [Additional configuration method](../server-commands/additional-configuration-method/)
  + Upgrading

    Upgrading
    - [Overview](../upgrading/overview/)
    - [v2.12 to 2.13](../upgrading/2.12-2.13/)
    - [v2.11 to 2.12](../upgrading/2.11-2.12/)
    - [v2.10 to 2.11](../upgrading/2.10-2.11/)
    - [v2.9 to 2.10](../upgrading/2.9-2.10/)
    - [v2.8 to 2.9](../upgrading/2.8-2.9/)
    - [v2.7 to 2.8](../upgrading/2.7-2.8/)
    - [v2.6 to 2.7](../upgrading/2.6-2.7/)
    - [v2.5 to 2.6](../upgrading/2.5-2.6/)
    - [v2.4 to 2.5](../upgrading/2.4-2.5/)
    - [v2.3 to 2.4](../upgrading/2.3-2.4/)
    - [v2.2 to 2.3](../upgrading/2.2-2.3/)
    - [v2.1 to 2.2](../upgrading/2.1-2.2/)
    - [v2.0 to 2.1](../upgrading/2.0-2.1/)
    - [v1.8 to 2.0](../upgrading/1.8-2.0/)
    - [v1.7 to 1.8](../upgrading/1.7-1.8/)
    - [v1.6 to 1.7](../upgrading/1.6-1.7/)
    - [v1.5 to 1.6](../upgrading/1.5-1.6/)
    - [v1.4 to 1.5](../upgrading/1.4-1.5/)
    - [v1.3 to 1.4](../upgrading/1.3-1.4/)
    - [v1.2 to 1.3](../upgrading/1.2-1.3/)
    - [v1.1 to 1.2](../upgrading/1.1-1.2/)
    - [v1.0 to 1.1](../upgrading/1.0-1.1/)
  + [Project Specification Reference](../project-specification/)
* User Guide

  User Guide
  + [Overview](../../user-guide/)
  + [Tools](../../user-guide/application_sources/)
  + [Kustomize](../../user-guide/kustomize/)
  + [Helm](../../user-guide/helm/)
  + [Importing Argo CD go packages](../../user-guide/import/)
  + [Jsonnet](../../user-guide/jsonnet/)
  + [Directory](../../user-guide/directory/)
  + [Tool Detection](../../user-guide/tool_detection/)
  + [Projects](../../user-guide/projects/)
  + [Private Repositories](../../user-guide/private-repositories/)
  + [Multiple Sources for an Application](../../user-guide/multiple_sources/)
  + [GnuPG verification](../../user-guide/gpg-verification/)
  + [Automated Sync Policy](../../user-guide/auto_sync/)
  + Diffing

    Diffing
    - [Diff Strategies](../../user-guide/diff-strategies/)
    - [Diff Customization](../../user-guide/diffing/)
  + [Orphaned Resources Monitoring](../../user-guide/orphaned-resources/)
  + [Compare Options](../../user-guide/compare-options/)
  + [Sync Options](../../user-guide/sync-options/)
  + [Parameter Overrides](../../user-guide/parameters/)
  + [Environment Variables](../../user-guide/environment-variables/)
  + [Build Environment](../../user-guide/build-environment/)
  + [Tracking and Deployment Strategies](../../user-guide/tracking_strategies/)
  + [Resource Tracking](../../user-guide/resource_tracking/)
  + [Resource Hooks](../../user-guide/resource_hooks/)
  + [Selective Sync](../../user-guide/selective_sync/)
  + [Sync Phases and Waves](../../user-guide/sync-waves/)
  + [Sync Windows](../../user-guide/sync_windows/)
  + [Sync Applications with Kubectl](../../user-guide/sync-kubectl/)
  + [Skip Application Reconcile](../../user-guide/skip_reconcile/)
  + [Generating Applications with ApplicationSet](../../user-guide/application-set/)
  + [Automation from CI Pipelines](../../user-guide/ci_automation/)
  + [App Deletion](../../user-guide/app_deletion/)
  + [Best Practices](../../user-guide/best_practices/)
  + [Status Badge](../../user-guide/status-badge/)
  + [Add external URL](../../user-guide/external-url/)
  + [Add extra Application info](../../user-guide/extra_info/)
  + [Notification subscriptions](../../user-guide/subscriptions/)
  + [Annotations and Labels used by Argo CD](../../user-guide/annotations-and-labels/)
  + [Command Reference](../../user-guide/commands/argocd/)
  + [Application Specification Reference](../../user-guide/application-specification/)
* Developer Guide

  Developer Guide
  + [Overview](../../developer-guide/)
  + Architecture

    Architecture
    - [Authentication and Authorization](../../developer-guide/architecture/authz-authn/)
    - [Component Architecture](../../developer-guide/architecture/components/)
  + [Code Contribution Guide](../../developer-guide/code-contributions/)
  + [Toolchain Guide](../../developer-guide/toolchain-guide/)
  + [Contributors Quick-Start](../../developer-guide/contributors-quickstart/)
  + [Release Process And Cadence](../../developer-guide/release-process-and-cadence/)
  + [Running Argo CD locally](../../developer-guide/running-locally/)
  + [Debugging a Remote ArgoCD Environment](../../developer-guide/debugging-remote-environment/)
  + [Use Gitpod](../../developer-guide/use-gitpod/)
  + [API Docs](../../developer-guide/api-docs/)
  + [E2E Tests](../../developer-guide/test-e2e/)
  + [Managing Dependencies](../../developer-guide/dependencies/)
  + [Continuous Integration (CI)](../../developer-guide/ci/)
  + [Releasing](../../developer-guide/releasing/)
  + [Documentation Site](../../developer-guide/docs-site/)
  + [Static Code Analysis](../../developer-guide/static-code-analysis/)
  + Extensions

    Extensions
    - [UI Extensions](../../developer-guide/extensions/ui-extensions/)
    - [Proxy Extensions](../../developer-guide/extensions/proxy-extensions/)
  + [Contribution FAQ](../../developer-guide/faq/)
* [FAQ](../../faq/)
* [Security Considerations](../../security_considerations/)
* [Support](../../SUPPORT/)
* [Roadmap](../../roadmap/)
* [Releases ⧉](https://github.com/argoproj/argo-cd/releases)
* [Blog ⧉](https://blog.argoproj.io/)

Table of contents

* [Basic Built-in Roles](#basic-built-in-roles)
* [Default Policy for Authenticated Users](#default-policy-for-authenticated-users)
* [Anonymous Access](#anonymous-access)
* [RBAC Model Structure](#rbac-model-structure)
  + [Application-Specific Policy](#application-specific-policy)
    - [Application in Any Namespaces](#application-in-any-namespaces)
  + [The applications resource](#the-applications-resource)
    - [Fine-grained Permissions for update/delete action](#fine-grained-permissions-for-updatedelete-action)
    - [The action action](#the-action-action)
    - [The override action](#the-override-action)
  + [The applicationsets resource](#the-applicationsets-resource)
  + [The logs resource](#the-logs-resource)
  + [The exec resource](#the-exec-resource)
  + [The extensions resource](#the-extensions-resource)
  + [The deny effect](#the-deny-effect)
* [Policies Evaluation and Matching](#policies-evaluation-and-matching)
  + [Glob matching](#glob-matching)
* [Using SSO Users/Groups](#using-sso-usersgroups)
* [Local Users/Accounts](#local-usersaccounts)
* [Policy CSV Composition](#policy-csv-composition)
* [Validating and testing your RBAC policies](#validating-and-testing-your-rbac-policies)
  + [Validating a policy](#validating-a-policy)
  + [Testing a policy](#testing-a-policy)

# RBAC Configuration[¶](#rbac-configuration "Permanent link")

The RBAC feature enables restrictions of access to Argo CD resources. Argo CD does not have its own
user management system and has only one built-in user, `admin`. The `admin` user is a superuser and
it has unrestricted access to the system. RBAC requires [SSO configuration](../user-management/) or [one or more local users setup](../user-management/).
Once SSO or local users are configured, additional RBAC roles can be defined, and SSO groups or local users can then be mapped to roles.

There are two main components where RBAC configuration can be defined:

* The global RBAC config map (see [argo-rbac-cm.yaml](../argocd-rbac-cm-yaml/))
* The [AppProject's roles](../../user-guide/projects/#project-roles)

## Basic Built-in Roles[¶](#basic-built-in-roles "Permanent link")

Argo CD has two pre-defined roles but RBAC configuration allows defining roles and groups (see below).

* `role:readonly`: read-only access to all resources
* `role:admin`: unrestricted access to all resources

These default built-in role definitions can be seen in [builtin-policy.csv](https://github.com/argoproj/argo-cd/blob/master/assets/builtin-policy.csv)

## Default Policy for Authenticated Users[¶](#default-policy-for-authenticated-users "Permanent link")

When a user is authenticated in Argo CD, it will be granted the role specified in `policy.default`.

Restricting Default Permissions

**All authenticated users get *at least* the permissions granted by the default policies. This access cannot be blocked
by a `deny` rule.** It is recommended to create a new `role:authenticated` with the minimum set of permissions possible,
then grant permissions to individual roles as needed.

## Anonymous Access[¶](#anonymous-access "Permanent link")

Enabling anonymous access to the Argo CD instance allows users to assume the default role permissions specified by `policy.default` **without being authenticated**.

The anonymous access to Argo CD can be enabled using the `users.anonymous.enabled` field in `argocd-cm` (see [argocd-cm.yaml](../argocd-cm-yaml/)).

Warning

When enabling anonymous access, consider creating a new default role and assigning it to the default policies
with `policy.default: role:unauthenticated`.

## RBAC Model Structure[¶](#rbac-model-structure "Permanent link")

The model syntax is based on [Casbin](https://casbin.org/docs/overview) (an open source ACL/ACLs). There are two different types of syntax: one for assigning policies, and another one for assigning users to internal roles.

**Group**: Allows to assign authenticated users/groups to internal roles.

Syntax: `g, <user/group>, <role>`

* `<user/group>`: The entity to whom the role will be assigned. It can be a local user or a user authenticated with SSO.
  When SSO is used, the `user` will be based on the `sub` claims, while the group is one of the values returned by the `scopes` configuration.
* `<role>`: The internal role to which the entity will be assigned.

**Policy**: Allows to assign permissions to an entity.

Syntax: `p, <role/user/group>, <resource>, <action>, <object>, <effect>`

* `<role/user/group>`: The entity to whom the policy will be assigned
* `<resource>`: The type of resource on which the action is performed.
* `<action>`: The operation that is being performed on the resource.
* `<object>`: The object identifier representing the resource on which the action is performed. Depending on the resource, the object's format will vary.
* `<effect>`: Whether this policy should grant or restrict the operation on the target object. One of `allow` or `deny`.

Below is a table that summarizes all possible resources and which actions are valid for each of them.

| Resource\Action | get | create | update | delete | sync | action | override | invoke |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **applications** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ❌ |
| **applicationsets** | ✅ | ✅ | ✅ | ✅ | ❌ | ❌ | ❌ | ❌ |
| **clusters** | ✅ | ✅ | ✅ | ✅ | ❌ | ❌ | ❌ | ❌ |
| **projects** | ✅ | ✅ | ✅ | ✅ | ❌ | ❌ | ❌ | ❌ |
| **repositories** | ✅ | ✅ | ✅ | ✅ | ❌ | ❌ | ❌ | ❌ |
| **accounts** | ✅ | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ |
| **certificates** | ✅ | ✅ | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ |
| **gpgkeys** | ✅ | ✅ | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ |
| **logs** | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| **exec** | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| **extensions** | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |

### Application-Specific Policy[¶](#application-specific-policy "Permanent link")

Some policy only have meaning within an application. It is the case with the following resources:

* `applications`
* `applicationsets`
* `logs`
* `exec`

While they can be set in the global configuration, they can also be configured in [AppProject's roles](../../user-guide/projects/#project-roles).
The expected `<object>` value in the policy structure is replaced by `<app-project>/<app-name>`.

For instance, these policies would grant `example-user` access to get any applications,
but only be able to see logs in `my-app` application part of the `example-project` project.

```
p, example-user, applications, get, *, allow
p, example-user, logs, get, example-project/my-app, allow

```
#### Application in Any Namespaces[¶](#application-in-any-namespaces "Permanent link")

When [application in any namespace](../app-any-namespace/) is enabled, the expected `<object>` value in the policy structure is replaced by `<app-project>/<app-ns>/<app-name>`.
Since multiple applications could have the same name in the same project, the policy below makes sure to restrict access only to `app-namespace`.

```
p, example-user, applications, get, */app-namespace/*, allow
p, example-user, logs, get, example-project/app-namespace/my-app, allow

```
### The `applications` resource[¶](#the-applications-resource "Permanent link")

The `applications` resource is an [Application-Specific Policy](#application-specific-policy).

#### Fine-grained Permissions for `update`/`delete` action[¶](#fine-grained-permissions-for-updatedelete-action "Permanent link")

The `update` and `delete` actions, when granted on an application, will allow the user to perform the operation on the application itself **and** all of its resources.
It can be desirable to only allow `update` or `delete` on specific resources within an application.

To do so, when the action if performed on an application's resource, the `<action>` will have the `<action>/<group>/<kind>/<ns>/<name>` format.

For instance, to grant access to `example-user` to only delete Pods in the `prod-app` Application, the policy could be:

```
p, example-user, applications, delete/*/Pod/*/*, default/prod-app, allow

```

Understand glob pattern behavior

Argo CD RBAC does not use `/` as a separator when evaluating glob patterns. So the pattern `delete/*/kind/*`
will match `delete/<group>/kind/<namespace>/<name>` but also `delete/<group>/<kind>/kind/<name>`.

The fact that both of these match will generally not be a problem, because resource kinds generally contain capital
letters, and namespaces cannot contain capital letters. However, it is possible for a resource kind to be lowercase.
So it is better to just always include all the parts of the resource in the pattern (in other words, always use four
slashes).

If we want to grant access to the user to update all resources of an application, but not the application itself:

```
p, example-user, applications, update/*, default/prod-app, allow

```

If we want to explicitly deny delete of the application, but allow the user to delete Pods:

```
p, example-user, applications, delete, default/prod-app, deny
p, example-user, applications, delete/*/Pod/*/*, default/prod-app, allow

```

Note

It is not possible to deny fine-grained permissions for a sub-resource if the action was **explicitly allowed on the application**.
For instance, the following policies will **allow** a user to delete the Pod and any other resources in the application:

```
p, example-user, applications, delete, default/prod-app, allow
p, example-user, applications, delete/*/Pod/*/*, default/prod-app, deny

```

#### The `action` action[¶](#the-action-action "Permanent link")

The `action` action corresponds to either built-in resource customizations defined
[in the Argo CD repository](https://github.com/argoproj/argo-cd/tree/master/resource_customizations),
or to [custom resource actions](../resource_actions/#custom-resource-actions) defined by you.

See the [resource actions documentation](../resource_actions/#built-in-actions) for a list of built-in actions.

The `<action>` has the `action/<group>/<kind>/<action-name>` format.

For example, a resource customization path `resource_customizations/extensions/DaemonSet/actions/restart/action.lua`
corresponds to the `action` path `action/extensions/DaemonSet/restart`. If the resource is not under a group (for example, Pods or ConfigMaps),
then the path will be `action//Pod/action-name`.

The following policies allows the user to perform any action on the DaemonSet resources, as well as the `maintenance-off` action on a Pod:

```
p, example-user, applications, action//Pod/maintenance-off, default/*, allow
p, example-user, applications, action/extensions/DaemonSet/*, default/*, allow

```

To allow the user to perform any actions:

```
p, example-user, applications, action/*, default/*, allow

```
#### The `override` action[¶](#the-override-action "Permanent link")

When granted along with the `sync` action, the override action will allow a user to synchronize local manifests to the Application.
These manifests will be used instead of the configured source, until the next sync is performed.

### The `applicationsets` resource[¶](#the-applicationsets-resource "Permanent link")

The `applicationsets` resource is an [Application-Specific policy](#application-specific-policy).

[ApplicationSets](../applicationset/) provide a declarative way to automatically create/update/delete Applications.

Allowing the `create` action on the resource effectively grants the ability to create Applications. While it doesn't allow the
user to create Applications directly, they can create Applications via an ApplicationSet.

Note

In v2.5, it is not possible to create an ApplicationSet with a templated Project field (e.g. `project: {{path.basename}}`)
via the API (or, by extension, the CLI). Disallowing templated projects makes project restrictions via RBAC safe:

With the resource being application-specific, the `<object>` of the applicationsets policy will have the format `<app-project>/<app-name>`.
However, since an ApplicationSet does belong to any project, the `<app-project>` value represents the projects in which the ApplicationSet will be able to create Applications.

With the following policy, a `dev-group` user will be unable to create an ApplicationSet capable of creating Applications
outside the `dev-project` project.

```
p, dev-group, applicationsets, *, dev-project/*, allow

```
### The `logs` resource[¶](#the-logs-resource "Permanent link")

The `logs` resource is an [Application-Specific Policy](#application-specific-policy).

When granted with the `get` action, this policy allows a user to see Pod's logs of an application via
the Argo CD UI. The functionality is similar to `kubectl logs`.

### The `exec` resource[¶](#the-exec-resource "Permanent link")

The `exec` resource is an [Application-Specific Policy](#application-specific-policy).

When granted with the `create` action, this policy allows a user to `exec` into Pods of an application via
the Argo CD UI. The functionality is similar to `kubectl exec`.

See [Web-based Terminal](../web_based_terminal/) for more info.

### The `extensions` resource[¶](#the-extensions-resource "Permanent link")

With the `extensions` resource, it is possible to configure permissions to invoke [proxy extensions](../../developer-guide/extensions/proxy-extensions/).
The `extensions` RBAC validation works in conjunction with the `applications` resource.
A user **needs to have read permission on the application** where the request is originated from.

Consider the example below, it will allow the `example-user` to invoke the `httpbin` extensions in all
applications under the `default` project.

```
p, example-user, applications, get, default/*, allow
p, example-user, extensions, invoke, httpbin, allow

```
### The `deny` effect[¶](#the-deny-effect "Permanent link")

When `deny` is used as an effect in a policy, it will be effective if the policy matches.
Even if more specific policies with the `allow` effect match as well, the `deny` will have priority.

The order in which the policies appears in the policy file configuration has no impact, and the result is deterministic.

## Policies Evaluation and Matching[¶](#policies-evaluation-and-matching "Permanent link")

The evaluation of access is done in two parts: validating against the default policy configuration, then validating against the policies for the current user.

**If an action is allowed or denied by the default policies, then this effect will be effective without further evaluation**.
When the effect is undefined, the evaluation will continue with subject-specific policies.

The access will be evaluated for the user, then for each configured group that the user is part of.

The matching engine, configured in `policy.matchMode`, can use two different match modes to compare the values of tokens:

* `glob`: based on the [`glob` package](https://pkg.go.dev/github.com/gobwas/glob).
* `regex`: based on the [`regexp` package](https://pkg.go.dev/regexp).

When all tokens match during the evaluation, the effect will be returned. The evaluation will continue until all matching policies are evaluated, or until a policy with the `deny` effect matches.
After all policies are evaluated, if there was at least one `allow` effect and no `deny`, access will be granted.

### Glob matching[¶](#glob-matching "Permanent link")

When `glob` is used, the policy tokens are treated as single terms, without separators.

Consider the following policy:

```
p, example-user, applications, action/extensions/*, default/*, allow

```

When the `example-user` executes the `extensions/DaemonSet/test` action, the following `glob` matches will happen:

1. The current user `example-user` matches the token `example-user`.
2. The value `applications` matches the token `applications`.
3. The value `action/extensions/DaemonSet/test` matches `action/extensions/*`. Note that `/` is not treated as a separator and the use of `**` is not necessary.
4. The value `default/my-app` matches `default/*`.

## Using SSO Users/Groups[¶](#using-sso-usersgroups "Permanent link")

The `scopes` field controls which OIDC scopes to examine during RBAC enforcement (in addition to `sub` scope).
If omitted, it defaults to `'[groups]'`. The scope value can be a string, or a list of strings.

For more information on `scopes` please review the [User Management Documentation](../user-management/).

The following example shows targeting `email` as well as `groups` from your OIDC provider.

```
apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-rbac-cm
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-rbac-cm
    app.kubernetes.io/part-of: argocd
data:
  policy.csv: |
    p, my-org:team-alpha, applications, sync, my-project/*, allow
    g, my-org:team-beta, role:admin
    g, user@example.org, role:admin
  policy.default: role:readonly
  scopes: '[groups, email]'

```

This can be useful to associate users' emails and groups directly in AppProject.

```
apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: team-beta-project
  namespace: argocd
spec:
  roles:
    - name: admin
      description: Admin privileges to team-beta
      policies:
        - p, proj:team-beta-project:admin, applications, *, *, allow
      groups:
        - user@example.org # Value from the email scope
        - my-org:team-beta # Value from the groups scope

```
## Local Users/Accounts[¶](#local-usersaccounts "Permanent link")

[Local users](../user-management/#local-usersaccounts) are assigned access by either grouping them with a role or by assigning policies directly
to them.

The example below shows how to assign a policy directly to a local user.

```
p, my-local-user, applications, sync, my-project/*, allow

```

This example shows how to assign a role to a local user.

```
g, my-local-user, role:admin

```

Ambiguous Group Assignments

If you have [enabled SSO](../user-management/#sso), any SSO user with a scope that matches a local user will be
added to the same roles as the local user. For example, if local user `sally` is assigned to `role:admin`, and if an
SSO user has a scope which happens to be named `sally`, that SSO user will also be assigned to `role:admin`.

An example of where this may be a problem is if your SSO provider is an SCM, and org members are automatically
granted scopes named after the orgs. If a user can create or add themselves to an org in the SCM, they can gain the
permissions of the local user with the same name.

To avoid ambiguity, if you are using local users and SSO, it is recommended to assign policies directly to local
users, and not to assign roles to local users. In other words, instead of using `g, my-local-user, role:admin`, you
should explicitly assign policies to `my-local-user`:

```
p, my-local-user, *, *, *, allow

```

## Policy CSV Composition[¶](#policy-csv-composition "Permanent link")

It is possible to provide additional entries in the `argocd-rbac-cm` configmap to compose the final policy csv.
In this case, the key must follow the pattern `policy.<any string>.csv`.
Argo CD will concatenate all additional policies it finds with this pattern below the main one ('policy.csv').
The order of additional provided policies are determined by the key string.

Example: if two additional policies are provided with keys `policy.A.csv` and `policy.B.csv`,
it will first concatenate `policy.A.csv` and then `policy.B.csv`.

This is useful to allow composing policies in config management tools like Kustomize, Helm, etc.

The example below shows how a Kustomize patch can be provided in an overlay to add additional configuration to an existing RBAC ConfigMap.

```
apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-rbac-cm
  namespace: argocd
data:
  policy.tester-overlay.csv: |
    p, role:tester, applications, *, */*, allow
    p, role:tester, projects, *, *, allow
    g, my-org:team-qa, role:tester

```
## Validating and testing your RBAC policies[¶](#validating-and-testing-your-rbac-policies "Permanent link")

If you want to ensure that your RBAC policies are working as expected, you can
use the [`argocd admin settings rbac` command](../../user-guide/commands/argocd_admin_settings_rbac/) to validate them.
This tool allows you to test whether a certain role or subject can perform the requested action with a policy
that's not live yet in the system, i.e. from a local file or config map.
Additionally, it can be used against the live RBAC configuration in the cluster your Argo CD is running in.

### Validating a policy[¶](#validating-a-policy "Permanent link")

To check whether your new policy configuration is valid and understood by Argo CD's RBAC implementation,
you can use the [`argocd admin settings rbac validate` command](../../user-guide/commands/argocd_admin_settings_rbac_validate/).

### Testing a policy[¶](#testing-a-policy "Permanent link")

To test whether a role or subject (group or local user) has sufficient
permissions to execute certain actions on certain resources, you can
use the [`argocd admin settings rbac can` command](../../user-guide/commands/argocd_admin_settings_rbac_can/).

[Previous

Identity Center (AWS SSO)](../user-management/identity-center/)
[Next

Overview](../security/)

Made with
[Material for MkDocs](https://squidfunk.github.io/mkdocs-material/)

