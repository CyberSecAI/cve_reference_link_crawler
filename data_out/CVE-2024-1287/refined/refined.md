- **Root cause of vulnerability**: The plugin does not properly restrict access to sensitive user information, allowing users with the "contributor" role and potentially unauthenticated users to access password hashes, activation keys and other user data. The vulnerability is due to insufficient access controls within the plugin's shortcode functionality, which allows retrieval of user data through crafted shortcodes. Additionally, the plugin is vulnerable to SQL injection via the `order_by` parameter within the shortcode, which can be used to bypass access controls and disclose sensitive user information.
- **Weaknesses/vulnerabilities present**:
    - Broken Access Control: The plugin fails to prevent users with lower privileges (contributor) from accessing sensitive information of other users.
    - SQL Injection: The `order_by` parameter in the `pmpro_member_directory` shortcode is vulnerable to SQL injection, allowing attackers to manipulate the query and bypass access controls, leading to disclosure of sensitive user data.
- **Impact of exploitation**:
    - Sensitive Information Disclosure: Attackers, including users with contributor roles and potentially unauthenticated users, can gain access to sensitive user information such as password hashes, activation keys, user levels, and other details by crafting specific shortcodes. This information can be used for privilege escalation, account takeover, and potentially further attacks.
- **Attack vectors**:
    - Crafted shortcodes: By adding and previewing specific shortcodes (e.g., `[pmpro_member_directory]` or `[pmpro_member_profile]`) to a post, a contributor or even an unauthenticated user (if the post is published) can trigger the vulnerability.
- **Required attacker capabilities/position**:
    - Contributor Role: A user with at least contributor role can exploit this vulnerability by adding a shortcode to a post.
    - Unauthenticated access: If the post containing the shortcode is published, an unauthenticated user can also exploit the vulnerability.
    - Knowledge of plugin shortcode parameters: The attacker needs to know how to craft the shortcode with specific parameters to expose the sensitive information.