

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3035108%2540oliver-pos%26old%3D3035108%2540oliver-pos)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3016388/oliver-pos "Changeset 3016388 for oliver-pos")
* [Next Change](/changeset/3035126/oliver-pos "Changeset 3035126 for oliver-pos") →

---

# Changeset [3035108](/changeset/3035108 "Show full changeset") for [oliver-pos](/browser/oliver-pos?rev=3035108 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
02/13/2024 01:13:44 PM
([11 months](/timeline?from=2024-02-13T13%3A13%3A44Z&precision=second "See timeline at 02/13/2024 01:13:44 PM") ago)

Author:
oliverpos
Message:

Tweak – Fixed security related issue

Tweak – Remove beta amelia support

Location:
[oliver-pos/trunk](/browser/oliver-pos/trunk?rev=3035108)
Files:

13 edited

* [includes/class-pos-bridge-config.php](/browser/oliver-pos/trunk/includes/class-pos-bridge-config.php?rev=3035108 "Show entry in browser")
  (modified)
  ([4 diffs](#file0 "Show differences"))
* [includes/class-pos-bridge-install.php](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108 "Show entry in browser")
  (modified)
  ([11 diffs](#file1 "Show differences"))
* [includes/class-pos-bridge-miscellaneous.php](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3035108 "Show entry in browser")
  (modified)
  ([7 diffs](#file2 "Show differences"))
* [includes/class-pos-bridge-order.php](/browser/oliver-pos/trunk/includes/class-pos-bridge-order.php?rev=3035108 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [includes/class-pos-bridge-tax.php](/browser/oliver-pos/trunk/includes/class-pos-bridge-tax.php?rev=3035108 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [includes/class-pos-bridge.php](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3035108 "Show entry in browser")
  (modified)
  ([5 diffs](#file5 "Show differences"))
* [includes/models/class-pos-bridge-order.php](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3035108 "Show entry in browser")
  (modified)
  ([8 diffs](#file6 "Show differences"))
* [includes/models/class-pos-bridge-user.php](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-user.php?rev=3035108 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [includes/version.php](/browser/oliver-pos/trunk/includes/version.php?rev=3035108 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [includes/views/backend/create-subscription-new.php](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108 "Show entry in browser")
  (modified)
  ([13 diffs](#file9 "Show differences"))
* [languages/oliver-pos.pot](/browser/oliver-pos/trunk/languages/oliver-pos.pot?rev=3035108 "Show entry in browser")
  (modified)
  ([2 diffs](#file10 "Show differences"))
* [oliver-pos.php](/browser/oliver-pos/trunk/oliver-pos.php?rev=3035108 "Show entry in browser")
  (modified)
  ([2 diffs](#file11 "Show differences"))
* [readme.txt](/browser/oliver-pos/trunk/readme.txt?rev=3035108 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [oliver-pos/trunk/includes/class-pos-bridge-config.php](/changeset/3035108/oliver-pos/trunk/includes/class-pos-bridge-config.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/class-pos-bridge-config.php")

  | [r3016376](/browser/oliver-pos/trunk/includes/class-pos-bridge-config.php?rev=3016376#L41 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/class-pos-bridge-config.php?rev=3035108#L41 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 41 | 41 | private $cost\_of\_goods\_for\_woo = false; |
  | 42 | 42 | private $yith\_cost\_of\_goods\_for\_woo = false; |
  | 43 |  | private $amelia\_plugin = false; |
  |  | 43 | //private $amelia\_plugin = false; |
  | 44 | 44 | private $asp\_payment\_type = 'PaymentType/'; |
  | 45 | 45 | private $asp\_initialization = 'Initialization/'; |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-config.php?rev=3016376#L53) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-config.php?rev=3035108#L53) |  |
  | 53 | 53 | $this->yith\_cost\_of\_goods\_for\_woo = true; |
  | 54 | 54 | } |
  | 55 |  | if ( in\_array( 'ameliabooking/ameliabooking.php', $active\_plugins ) ) { |
  | 56 |  | $this->amelia\_plugin = true; |
  | 57 |  | } |
  | 58 |  | $this->oliver\_pos\_define('AMELIA\_PLUGIN', $this->amelia\_plugin); |
  |  | 55 | // if ( in\_array( 'ameliabooking/ameliabooking.php', $active\_plugins ) ) { |
  |  | 56 | //     $this->amelia\_plugin = true; |
  |  | 57 | // } |
  |  | 58 | //$this->oliver\_pos\_define('AMELIA\_PLUGIN', $this->amelia\_plugin); |
  | 59 | 59 | $this->oliver\_pos\_define('COST\_OF\_GOODS\_FOR\_WOO', $this->cost\_of\_goods\_for\_woo); |
  | 60 | 60 | $this->oliver\_pos\_define('YITH\_COST\_OF\_GOODS\_FOR\_WOO', $this->yith\_cost\_of\_goods\_for\_woo); |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-config.php?rev=3016376#L209) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-config.php?rev=3035108#L209) |  |
  | 209 | 209 | $this->oliver\_pos\_define('AUTHORIZATION', 'Basic ' . base64\_encode( get\_option( 'oliver\_pos\_subscription\_client\_id' ).":".get\_option( 'oliver\_pos\_subscription\_token' ) )); |
  | 210 | 210 | //@Since add 2.4.1.8 |
  | 211 |  | $this->oliver\_pos\_define('ASP\_TRIGGER\_AMELIA\_MENU', $this->asp\_server\_url.$this->asp\_bridge.'TriggerAmeliaMenu/'); |
  |  | 211 | //$this->oliver\_pos\_define('ASP\_TRIGGER\_AMELIA\_MENU', $this->asp\_server\_url.$this->asp\_bridge.'TriggerAmeliaMenu/'); |
  | 212 | 212 | $this->oliver\_pos\_define('ASP\_TRIGGER\_SAVE\_EXTENTION', $this->asp\_server\_url.$this->asp\_bridge.'SaveExtention'); |
  | 213 | 213 | $this->oliver\_pos\_define('ASP\_GETEXTENTION', $this->asp\_server\_url.$this->asp\_bridge.'GetExtention'); |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-config.php?rev=3016376#L217) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-config.php?rev=3035108#L217) |  |
  | 217 | 217 | //This is the address a user types in their address bar to reach your WordPress site. |
  | 218 | 218 | $this->oliver\_pos\_define('HOME\_URL', home\_url()); |
  |  | 219 | //Since 2.4.1.9 |
  |  | 220 | $this->oliver\_pos\_define('OP\_POST\_TYPE', array('shop\_order', 'shop\_order\_placehold')); |
  | 219 | 221 | } |
  | 220 | 222 | /\*\* |
* ## [oliver-pos/trunk/includes/class-pos-bridge-install.php](/changeset/3035108/oliver-pos/trunk/includes/class-pos-bridge-install.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/class-pos-bridge-install.php")

  | [r3016376](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L28 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L28 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 28 | 28 | add\_action('check\_oliver\_points\_and\_rewards\_connected', array(\_\_CLASS\_\_, 'oliver\_pos\_check\_oliver\_pr\_connected')); |
  | 29 | 29 | //@Since 2.4.1.8 amelia |
  | 30 |  | add\_action('wp\_ajax\_oliver\_pos\_get\_amelia\_status', array(\_\_CLASS\_\_, 'oliver\_pos\_get\_amelia\_status')); |
  | 31 |  | add\_action('wp\_ajax\_oliver\_pos\_enable\_amelia\_app', array(\_\_CLASS\_\_, 'oliver\_pos\_enable\_amelia\_app')); |
  | 32 |  | add\_action('wp\_ajax\_oliver\_pos\_remove\_amelia', array(\_\_CLASS\_\_, 'oliver\_pos\_remove\_amelia')); |
  |  | 30 | //Comments amelia from 2.4.1.9 |
  |  | 31 | //add\_action('wp\_ajax\_oliver\_pos\_get\_amelia\_status', array(\_\_CLASS\_\_, 'oliver\_pos\_get\_amelia\_status')); |
  |  | 32 | //add\_action('wp\_ajax\_oliver\_pos\_enable\_amelia\_app', array(\_\_CLASS\_\_, 'oliver\_pos\_enable\_amelia\_app')); |
  |  | 33 | //add\_action('wp\_ajax\_oliver\_pos\_remove\_amelia', array(\_\_CLASS\_\_, 'oliver\_pos\_remove\_amelia')); |
  | 33 | 34 | } |
  | 34 | 35 |  |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L59) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L60) |  |
  | 59 | 60 | } |
  | 60 | 61 | public static function oliver\_pos\_init\_connection() { |
  |  | 62 | if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 63 | echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 64 | } |
  | 61 | 65 | $site\_address = HOME\_URL; |
  | 62 | 66 | // data to be sent |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L138) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L142) |  |
  | 138 | 142 |  |
  | 139 | 143 | public static function oliver\_pos\_remove\_subscription() { |
  |  | 144 | if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 145 | echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 146 | } |
  | 140 | 147 | $exceptions=''; |
  | 141 | 148 | update\_option('oliver\_pos\_sync\_data', false); |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L170) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L177) |  |
  | 170 | 177 | } |
  | 171 | 178 | public static function oliver\_pos\_connect\_site() { |
  |  | 179 | if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 180 | echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 181 | } |
  | 172 | 182 | $site\_address = urlencode(HOME\_URL); |
  | 173 | 183 | $version = OLIVER\_POS\_PLUGIN\_VERSION\_NUMBER; |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L199) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L209) |  |
  | 199 | 209 |  |
  | 200 | 210 | public static function oliver\_pos\_disconnect\_subscription() { |
  |  | 211 | if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 212 | echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 213 | } |
  | 201 | 214 | $url = esc\_url\_raw( ASP\_TRY\_DISCONNECT ); |
  | 202 | 215 | oliver\_log("disconnect\_subscription = {$url}"); |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L215) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L228) |  |
  | 215 | 228 |  |
  | 216 | 229 | public static function oliver\_pos\_delete\_subscription() { |
  |  | 230 | if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 231 | echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 232 | } |
  | 217 | 233 | oliver\_log("delete\_subscription"); |
  | 218 | 234 | // bridge |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L305) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L321) |  |
  | 305 | 321 | //Since 2.3.9.3 |
  | 306 | 322 | public static function oliver\_pos\_system\_check() { |
  |  | 323 | if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 324 | echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 325 | } |
  | 307 | 326 | $validateVersionUrl = ASP\_VALIDATE\_VERSION; |
  | 308 | 327 | $noErrors =''; |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L465) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L484) |  |
  | 465 | 484 | //Since 2.3.9.3 |
  | 466 | 485 | public static function oliver\_pos\_register\_url() { |
  |  | 486 | if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 487 | echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 488 | } |
  | 467 | 489 | $register\_url='not\_register'; |
  | 468 | 490 | $hub\_url=''; |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L498) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L520) |  |
  | 498 | 520 | //Since 2.3.9.3 |
  | 499 | 521 | public static function oliver\_pos\_getWebsiteSpeed() { |
  |  | 522 | if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 523 | echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 524 | } |
  | 500 | 525 | $opSpeed='noResponse'; |
  | 501 | 526 | $url = 'https://www.googleapis.com/pagespeedonline/v5/runPagespeed?url='.urlencode(HOME\_URL); |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L530) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L555) |  |
  | 530 | 555 | } |
  | 531 | 556 | public static function oliver\_pos\_syncing\_status(){ |
  |  | 557 | if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 558 | echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 559 | } |
  | 532 | 560 | $Synced= 'not\_started'; |
  | 533 | 561 | $SyncedPercent= 0; |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3016376#L601) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-install.php?rev=3035108#L629) |  |
  | 601 | 629 | \*Get Amelia status |
  | 602 | 630 | \*@since 2.4.1.8 |
  |  | 631 | \*omments amelia 2.4.1.9 |
  | 603 | 632 | \*/ |
  | 604 |  | public static function oliver\_pos\_get\_amelia\_status($send=NULL){ |
  | 605 |  | $url = esc\_url\_raw(ASP\_GETEXTENTION.'?code=oliver-pos-amelia'); |
  | 606 |  | $responceHub = wp\_remote\_get($url, array( |
  | 607 |  | 'headers' => array( |
  | 608 |  | 'Authorization' => AUTHORIZATION, |
  | 609 |  | ), |
  | 610 |  | )); |
  | 611 |  | $status='disconnected'; |
  | 612 |  | if ( is\_wp\_error($responceHub)) { |
  | 613 |  | $status = $responceHub->get\_error\_message(); |
  | 614 |  | } |
  | 615 |  | else |
  | 616 |  | { |
  | 617 |  | if (wp\_remote\_retrieve\_response\_code($responceHub) == 200) |
  | 618 |  | { |
  | 619 |  | $responceHubData = json\_decode(wp\_remote\_retrieve\_body($responceHub)); |
  | 620 |  | if ($responceHubData->Content=="plugin\_not\_registered" || $responceHubData->Content=="plugin\_deactivated" ) |
  | 621 |  | { |
  | 622 |  | $status = 'disconnected'; |
  | 623 |  | } |
  | 624 |  | if ($responceHubData->Content=="plugin\_activated") |
  | 625 |  | { |
  | 626 |  | $status = 'connected'; |
  | 627 |  | } |
  | 628 |  | } |
  | 629 |  | } |
  | 630 |  | if($send=='deactivate\_plugin'){ |
  | 631 |  | return $status; |
  | 632 |  | } |
  | 633 |  | else{ |
  | 634 |  | echo json\_encode(array("status" => $status)); |
  | 635 |  | } |
  | 636 |  | exit; |
  | 637 |  | } |
  |  | 633 | // public static function oliver\_pos\_get\_amelia\_status($send=NULL){ |
  |  | 634 | //  if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 635 | //      echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 636 | //  } |
  |  | 637 | //     $url = esc\_url\_raw(ASP\_GETEXTENTION.'?code=oliver-pos-amelia'); |
  |  | 638 | //     $responceHub = wp\_remote\_get($url, array( |
  |  | 639 | //         'headers' => array( |
  |  | 640 | //             'Authorization' => AUTHORIZATION, |
  |  | 641 | //         ), |
  |  | 642 | //     )); |
  |  | 643 | //     $status='disconnected'; |
  |  | 644 | //     if ( is\_wp\_error($responceHub)) { |
  |  | 645 | //         $status = $responceHub->get\_error\_message(); |
  |  | 646 | //     } |
  |  | 647 | //     else |
  |  | 648 | //     { |
  |  | 649 | //         if (wp\_remote\_retrieve\_response\_code($responceHub) == 200) |
  |  | 650 | //         { |
  |  | 651 | //             $responceHubData = json\_decode(wp\_remote\_retrieve\_body($responceHub)); |
  |  | 652 | //             if ($responceHubData->Content=="plugin\_not\_registered" || $responceHubData->Content=="plugin\_deactivated" ) |
  |  | 653 | //             { |
  |  | 654 | //                 $status = 'disconnected'; |
  |  | 655 | //             } |
  |  | 656 | //             if ($responceHubData->Content=="plugin\_activated") |
  |  | 657 | //             { |
  |  | 658 | //                 $status = 'connected'; |
  |  | 659 | //             } |
  |  | 660 | //         } |
  |  | 661 | //     } |
  |  | 662 | //     if($send=='deactivate\_plugin'){ |
  |  | 663 | //         return $status; |
  |  | 664 | //     } |
  |  | 665 | //     else{ |
  |  | 666 | //         echo json\_encode(array("status" => $status)); |
  |  | 667 | //     } |
  |  | 668 | //     exit; |
  |  | 669 | // } |
  | 638 | 670 | /\*\* |
  | 639 | 671 | \*Enable Amelia |
  | 640 | 672 | \*@since 2.4.1.8 |
  |  | 673 | \*Comments amelia 2.4.1.9 |
  | 641 | 674 | \*/ |
  | 642 |  | public static function oliver\_pos\_enable\_amelia\_app($send=NULL){ |
  | 643 |  | //Create pages for oliver amelia |
  | 644 |  | self::oliver\_pos\_create\_pages\_for\_amelia(); |
  | 645 |  | //Code for htaccess |
  | 646 |  | $content = array( |
  | 647 |  | 'Header always unset X-Frame-Options |
  | 648 |  | <IfModule mod\_headers.c> |
  | 649 |  | <IfModule mod\_setenvif.c> |
  | 650 |  | SetEnvIf Origin "^(.+)$" CORS=$0 |
  | 651 |  | </IfModule> |
  | 652 |  | Header set Access-Control-Allow-Origin %{CORS}e env=CORS |
  | 653 |  | Header always edit Set-Cookie (.\*) "$1; SameSite=None; Secure |
  | 654 |  | <FilesMatch "\.(php|html)$"> |
  | 655 |  | Header set Content-Security-Policy "frame-ancestors https://hub.oliverpos.com https://beta.sell.oliverpos.com https://sell1.oliverpos.com '.GET\_SITE\_URL.'" |
  | 656 |  | </FilesMatch> |
  | 657 |  | </IfModule>' |
  | 658 |  | ); |
  | 659 |  | self::oliver\_pos\_add\_x\_from\_option($content); |
  | 660 |  |  |
  | 661 |  | $PageUrl    = 'oliver-amelia/'; |
  | 662 |  | $ManageUrl  = 'oliver-amelia-setting/'; |
  | 663 |  | $esc\_url = ASP\_TRIGGER\_SAVE\_EXTENTION; |
  | 664 |  | $logo = plugins\_url('public/resource/img/amelia\_\_img.png', dirname(\_\_FILE\_\_)); |
  | 665 |  |  |
  | 666 |  | $data = array( |
  | 667 |  | 'Name' => 'Amelia', |
  | 668 |  | 'Description' => 'You can access amelia pages in pos from Oliver Amelia App', |
  | 669 |  | 'Version' => OLIVER\_POS\_PLUGIN\_VERSION\_NUMBER, |
  | 670 |  | 'code' => 'oliver-pos-amelia', //This code should not be change |
  | 671 |  | 'HostUrl' => HOME\_URL, |
  | 672 |  | 'PageUrl' => $PageUrl, |
  | 673 |  | 'logo' => $logo, |
  | 674 |  | 'ManageUrl' => $ManageUrl, |
  | 675 |  | 'viewManagement' => array(), |
  | 676 |  | ); |
  | 677 |  | $data['viewManagement'][]=array( |
  | 678 |  | 'ViewSlug'            => 'Customer View', |
  | 679 |  | 'ActionSlug'          => '1', |
  | 680 |  | 'SubTitle'          => '1', |
  | 681 |  | ); |
  | 682 |  | $data['viewManagement'][]=array( |
  | 683 |  | 'ViewSlug'            => 'checkout', |
  | 684 |  | 'ActionSlug'          => '1', |
  | 685 |  | 'SubTitle'          => '1', |
  | 686 |  | ); |
  | 687 |  | $responceHub = wp\_remote\_post( esc\_url\_raw( $esc\_url ), array( |
  | 688 |  | 'body' => $data, |
  | 689 |  | 'headers' => array( |
  | 690 |  | 'Authorization' => AUTHORIZATION, |
  | 691 |  | ), |
  | 692 |  | )); |
  | 693 |  |  |
  | 694 |  | $message='Something went wrong try again later'; |
  | 695 |  | $status=''; |
  | 696 |  | if ( is\_wp\_error($responceHub) ) { |
  | 697 |  | $message=$responceHub->get\_error\_message(); |
  | 698 |  | $status='not\_connected'; |
  | 699 |  | } |
  | 700 |  | else |
  | 701 |  | { |
  | 702 |  | if (wp\_remote\_retrieve\_response\_code($responceHub) == 200) |
  | 703 |  | { |
  | 704 |  | $responceHubData = json\_decode(wp\_remote\_retrieve\_body($responceHub)); |
  | 705 |  | if ( $responceHubData->IsSuccess ) |
  | 706 |  | { |
  | 707 |  | $status='done'; |
  | 708 |  | $message='Amelia App install successfully'; |
  | 709 |  | update\_option('oliver\_amelia\_status', true); |
  | 710 |  | update\_option('amelia\_settings\_disable\_automatically', false); |
  | 711 |  | } |
  | 712 |  | else{ |
  | 713 |  | $status='not\_connected'; |
  | 714 |  | $message=$responceHubData->Message; |
  | 715 |  | update\_option('oliver\_amelia\_status', false); |
  | 716 |  | } |
  | 717 |  | } |
  | 718 |  | } |
  | 719 |  | if($send=='activate\_plugin'){ |
  | 720 |  | return $status; |
  | 721 |  | } |
  | 722 |  | else{ |
  | 723 |  | echo json\_encode(array("status"=>$status, "Message"=>$message)); |
  | 724 |  | } |
  | 725 |  | exit(); |
  | 726 |  | } |
  |  | 675 | // public static function oliver\_pos\_enable\_amelia\_app($send=NULL){ |
  |  | 676 | //  if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 677 | //      echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 678 | //  } |
  |  | 679 | //     //Create pages for oliver amelia |
  |  | 680 | //     self::oliver\_pos\_create\_pages\_for\_amelia(); |
  |  | 681 | //     //Code for htaccess |
  |  | 682 | //     $content = array( |
  |  | 683 | //         'Header always unset X-Frame-Options |
  |  | 684 | //      <IfModule mod\_headers.c> |
  |  | 685 | //        <IfModule mod\_setenvif.c> |
  |  | 686 | //          SetEnvIf Origin "^(.+)$" CORS=$0 |
  |  | 687 | //        </IfModule> |
  |  | 688 | //        Header set Access-Control-Allow-Origin %{CORS}e env=CORS |
  |  | 689 | //        Header always edit Set-Cookie (.\*) "$1; SameSite=None; Secure |
  |  | 690 | //        <FilesMatch "\.(php|html)$"> |
  |  | 691 | //          Header set Content-Security-Policy "frame-ancestors https://hub.oliverpos.com https://beta.sell.oliverpos.com https://sell1.oliverpos.com '.GET\_SITE\_URL.'" |
  |  | 692 | //        </FilesMatch> |
  |  | 693 | //      </IfModule>' |
  |  | 694 | //     ); |
  |  | 695 | //     self::oliver\_pos\_add\_x\_from\_option($content); |
  |  | 696 |  |
  |  | 697 | //     $PageUrl     = 'oliver-amelia/'; |
  |  | 698 | //     $ManageUrl   = 'oliver-amelia-setting/'; |
  |  | 699 | //     $esc\_url = ASP\_TRIGGER\_SAVE\_EXTENTION; |
  |  | 700 | //     $logo = plugins\_url('public/resource/img/amelia\_\_img.png', dirname(\_\_FILE\_\_)); |
  |  | 701 |  |
  |  | 702 | //     $data = array( |
  |  | 703 | //         'Name' => 'Amelia', |
  |  | 704 | //         'Description' => 'You can access amelia pages in pos from Oliver Amelia App', |
  |  | 705 | //         'Version' => OLIVER\_POS\_PLUGIN\_VERSION\_NUMBER, |
  |  | 706 | //         'code' => 'oliver-pos-amelia', //This code should not be change |
  |  | 707 | //         'HostUrl' => HOME\_URL, |
  |  | 708 | //         'PageUrl' => $PageUrl, |
  |  | 709 | //         'logo' => $logo, |
  |  | 710 | //         'ManageUrl' => $ManageUrl, |
  |  | 711 | //         'viewManagement' => array(), |
  |  | 712 | //     ); |
  |  | 713 | //     $data['viewManagement'][]=array( |
  |  | 714 | //         'ViewSlug'            => 'Customer View', |
  |  | 715 | //         'ActionSlug'          => '1', |
  |  | 716 | //         'SubTitle'          => '1', |
  |  | 717 | //     ); |
  |  | 718 | //     $data['viewManagement'][]=array( |
  |  | 719 | //         'ViewSlug'            => 'checkout', |
  |  | 720 | //         'ActionSlug'          => '1', |
  |  | 721 | //         'SubTitle'          => '1', |
  |  | 722 | //     ); |
  |  | 723 | //     $responceHub = wp\_remote\_post( esc\_url\_raw( $esc\_url ), array( |
  |  | 724 | //         'body' => $data, |
  |  | 725 | //         'headers' => array( |
  |  | 726 | //             'Authorization' => AUTHORIZATION, |
  |  | 727 | //         ), |
  |  | 728 | //     )); |
  |  | 729 |  |
  |  | 730 | //     $message='Something went wrong try again later'; |
  |  | 731 | //     $status=''; |
  |  | 732 | //     if ( is\_wp\_error($responceHub) ) { |
  |  | 733 | //         $message=$responceHub->get\_error\_message(); |
  |  | 734 | //         $status='not\_connected'; |
  |  | 735 | //     } |
  |  | 736 | //     else |
  |  | 737 | //     { |
  |  | 738 | //         if (wp\_remote\_retrieve\_response\_code($responceHub) == 200) |
  |  | 739 | //         { |
  |  | 740 | //             $responceHubData = json\_decode(wp\_remote\_retrieve\_body($responceHub)); |
  |  | 741 | //             if ( $responceHubData->IsSuccess ) |
  |  | 742 | //             { |
  |  | 743 | //                 $status='done'; |
  |  | 744 | //                 $message='Amelia App install successfully'; |
  |  | 745 | //                 update\_option('oliver\_amelia\_status', true); |
  |  | 746 | //                 update\_option('amelia\_settings\_disable\_automatically', false); |
  |  | 747 | //             } |
  |  | 748 | //             else{ |
  |  | 749 | //                 $status='not\_connected'; |
  |  | 750 | //                 $message=$responceHubData->Message; |
  |  | 751 | //                 update\_option('oliver\_amelia\_status', false); |
  |  | 752 | //             } |
  |  | 753 | //         } |
  |  | 754 | //     } |
  |  | 755 | //     if($send=='activate\_plugin'){ |
  |  | 756 | //         return $status; |
  |  | 757 | //     } |
  |  | 758 | //     else{ |
  |  | 759 | //         echo json\_encode(array("status"=>$status, "Message"=>$message)); |
  |  | 760 | //     } |
  |  | 761 | //     exit(); |
  |  | 762 | // } |
  | 727 | 763 | //amelia 2.4.1.8 |
  | 728 |  | public static function oliver\_pos\_remove\_amelia($send=NULL) { |
  | 729 |  | $exceptions=''; |
  | 730 |  | $client\_id = get\_option("oliver\_pos\_subscription\_client\_id"); |
  | 731 |  | $url = esc\_url\_raw( ASP\_REMOVEEXTENTION )."?refId=$client\_id&code=oliver-pos-amelia"; |
  | 732 |  | $wp\_remote\_get = wp\_remote\_get($url, array( |
  | 733 |  | 'sslverify' => true, |
  | 734 |  | 'headers' => array( |
  | 735 |  | 'Authorization' => AUTHORIZATION, |
  | 736 |  | ), |
  | 737 |  | )); |
  | 738 |  | $message=''; |
  | 739 |  | $status=''; |
  | 740 |  | if ( is\_wp\_error( $wp\_remote\_get ) ) { |
  | 741 |  | $message=$wp\_remote\_get->get\_error\_message(); |
  | 742 |  | $status='error'; |
  | 743 |  | } else { |
  | 744 |  |  |
  | 745 |  | if (wp\_remote\_retrieve\_response\_code($wp\_remote\_get) == 200) { |
  | 746 |  | $decode\_response = json\_decode( wp\_remote\_retrieve\_body($wp\_remote\_get) ); |
  | 747 |  | if ( $decode\_response->IsSuccess ) { |
  | 748 |  | update\_option('oliver\_amelia\_status', false); |
  | 749 |  | update\_option('amelia\_settings\_disable\_automatically', false); |
  | 750 |  | $message = $decode\_response->Message; |
  | 751 |  | $status = 'done'; |
  | 752 |  | $content=""; |
  | 753 |  | //to remove content from htaccess |
  | 754 |  | self::oliver\_pos\_add\_x\_from\_option($content); |
  | 755 |  | } |
  | 756 |  | else{ |
  | 757 |  | $status = 'error'; |
  | 758 |  | $message = $decode\_response->Message; |
  | 759 |  | } |
  | 760 |  | } |
  | 761 |  | } |
  | 762 |  | if($send=='deactivate\_plugin'){ |
  | 763 |  | return $status; |
  | 764 |  | } |
  | 765 |  | else{ |
  | 766 |  | echo json\_encode(array("status"=>$status, "Message"=>$message)); |
  | 767 |  | } |
  | 768 |  |  |
  | 769 |  | exit(); |
  | 770 |  | } |
  |  | 764 | //Cooments amelia 2.4.1.9 |
  |  | 765 | // public static function oliver\_pos\_remove\_amelia($send=NULL) { |
  |  | 766 | //  if ( !wp\_verify\_nonce( $\_REQUEST['security'], "oliver-pos-nonce")) { |
  |  | 767 | //      echo json\_encode(array("exceptions"=>"Security validation failed")); |
  |  | 768 | //  } |
  |  | 769 | //     $exceptions=''; |
  |  | 770 | //     $client\_id = get\_option("oliver\_pos\_subscription\_client\_id"); |
  |  | 771 | //     $url = esc\_url\_raw( ASP\_REMOVEEXTENTION )."?refId=$client\_id&code=oliver-pos-amelia"; |
  |  | 772 | //     $wp\_remote\_get = wp\_remote\_get($url, array( |
  |  | 773 | //         'sslverify' => true, |
  |  | 774 | //         'headers' => array( |
  |  | 775 | //             'Authorization' => AUTHORIZATION, |
  |  | 776 | //         ), |
  |  | 777 | //     )); |
  |  | 778 | //     $message=''; |
  |  | 779 | //     $status=''; |
  |  | 780 | //     if ( is\_wp\_error( $wp\_remote\_get ) ) { |
  |  | 781 | //         $message=$wp\_remote\_get->get\_error\_message(); |
  |  | 782 | //         $status='error'; |
  |  | 783 | //     } else { |
  |  | 784 |  |
  |  | 785 | //         if (wp\_remote\_retrieve\_response\_code($wp\_remote\_get) == 200) { |
  |  | 786 | //             $decode\_response = json\_decode( wp\_remote\_retrieve\_body($wp\_remote\_get) ); |
  |  | 787 | //             if ( $decode\_response->IsSuccess ) { |
  |  | 788 | //                 update\_option('oliver\_amelia\_status', false); |
  |  | 789 | //                 update\_option('amelia\_settings\_disable\_automatically', false); |
  |  | 790 | //                 $message = $decode\_response->Message; |
  |  | 791 | //                 $status = 'done'; |
  |  | 792 | //                 $content=""; |
  |  | 793 | //                 //to remove content from htaccess |
  |  | 794 | //                 self::oliver\_pos\_add\_x\_from\_option($content); |
  |  | 795 | //             } |
  |  | 796 | //             else{ |
  |  | 797 | //                 $status = 'error'; |
  |  | 798 | //                 $message = $decode\_response->Message; |
  |  | 799 | //             } |
  |  | 800 | //         } |
  |  | 801 | //     } |
  |  | 802 | //     if($send=='deactivate\_plugin'){ |
  |  | 803 | //         return $status; |
  |  | 804 | //     } |
  |  | 805 | //     else{ |
  |  | 806 | //         echo json\_encode(array("status"=>$status, "Message"=>$message)); |
  |  | 807 | //     } |
  |  | 808 |  |
  |  | 809 | //     exit(); |
  |  | 810 | // } |
  | 771 | 811 | //amelia 2.4.1.8 |
  | 772 |  | public static function oliver\_pos\_add\_x\_from\_option($content){ |
  | 773 |  | $htaccess\_location = ABSPATH . '.htaccess'; |
  | 774 |  | if ( is\_plugin\_active( 'oliver-pos-points-and-rewards/oliver-pos-points-and-rewards.php' ) ) |
  | 775 |  | { |
  | 776 |  | //Check if oliver amelia want to disable but op points and rewards activated then don't change in htaccess |
  | 777 |  | if(empty($content)){ |
  | 778 |  | oliver\_log('points and rewards is activate already done'); |
  | 779 |  | return 0; |
  | 780 |  | } |
  | 781 |  | } |
  | 782 |  | insert\_with\_markers( $htaccess\_location, 'Oliver X-Frame', $content ); |
  | 783 |  | } |
  |  | 812 | // public static function oliver\_pos\_add\_x\_from\_option($content){ |
  |  | 813 | //     $htaccess\_location = ABSPATH . '.htaccess'; |
  |  | 814 | //     if ( is\_plugin\_active( 'oliver-pos-points-and-rewards/oliver-pos-points-and-rewards.php' ) ) |
  |  | 815 | //     { |
  |  | 816 | //      //Check if oliver amelia want to disable but op points and rewards activated then don't change in htaccess |
  |  | 817 | //         if(empty($content)){ |
  |  | 818 | //             oliver\_log('points and rewards is activate already done'); |
  |  | 819 | //             return 0; |
  |  | 820 | //         } |
  |  | 821 | //     } |
  |  | 822 | //     insert\_with\_markers( $htaccess\_location, 'Oliver X-Frame', $content ); |
  |  | 823 | // } |
  | 784 | 824 | //amelia 2.4.1.8 |
  | 785 |  | public static function oliver\_pos\_create\_pages\_for\_amelia(){ |
  | 786 |  | //Create pages for oliver amelia |
  | 787 |  | $page\_slug = 'oliver-amelia'; //Slug of the page |
  | 788 |  | $new\_page = array( |
  | 789 |  | 'post\_type'     => 'page', |
  | 790 |  | 'post\_title'    => 'Oliver Amelia', // Title of the Page |
  | 791 |  | 'post\_content'  => 'Do not use and delete this page',// Content |
  | 792 |  | 'post\_status'   => 'publish',       // Post Status |
  | 793 |  | 'post\_name'     => $page\_slug |
  | 794 |  | ); |
  | 795 |  | self::oliver\_pos\_create\_page($page\_slug, $new\_page); |
  | 796 |  |  |
  | 797 |  | $page\_slug = 'oliver-amelia-setting'; //Slug of the page |
  | 798 |  | $new\_page = array( |
  | 799 |  | 'post\_type'     => 'page', |
  | 800 |  | 'post\_title'    => 'Oliver Amelia Settings',// Title of the Page |
  | 801 |  | 'post\_content'  => 'do not use and delete this page',// Content |
  | 802 |  | 'post\_status'   => 'publish',           // Page Status |
  | 803 |  | 'post\_name'     => $page\_slug           // Slug of the Page |
  | 804 |  | ); |
  | 805 |  | self::oliver\_pos\_create\_page($page\_slug, $new\_page); |
  | 806 |  |  |
  | 807 |  | $page\_slug = 'oliver-amelia-pages'; // Slug of the Page |
  | 808 |  | $new\_page = array( |
  | 809 |  | 'post\_type'     => 'page', |
  | 810 |  | 'post\_title'    => 'Oliver Amelia pages',// Title of the Page |
  | 811 |  | 'post\_content'  => 'do not use and delete this page',// Content |
  | 812 |  | 'post\_status'   => 'publish',           // Page Status |
  | 813 |  | 'post\_name'     => $page\_slug           // Slug of the Page |
  | 814 |  | ); |
  | 815 |  | self::oliver\_pos\_create\_page($page\_slug, $new\_page); |
  | 816 |  | } |
  |  | 825 | // public static function oliver\_pos\_create\_pages\_for\_amelia(){ |
  |  | 826 | //     //Create pages for oliver amelia |
  |  | 827 | //     $page\_slug = 'oliver-amelia'; //Slug of the page |
  |  | 828 | //     $new\_page = array( |
  |  | 829 | //         'post\_type'     => 'page', |
  |  | 830 | //         'post\_title'    => 'Oliver Amelia',  // Title of the Page |
  |  | 831 | //         'post\_content'  => 'Do not use and delete this page',// Content |
  |  | 832 | //         'post\_status'   => 'publish',        // Post Status |
  |  | 833 | //         'post\_name'     => $page\_slug |
  |  | 834 | //     ); |
  |  | 835 | //     self::oliver\_pos\_create\_page($page\_slug, $new\_page); |
  |  | 836 |  |
  |  | 837 | //     $page\_slug = 'oliver-amelia-setting'; //Slug of the page |
  |  | 838 | //     $new\_page = array( |
  |  | 839 | //         'post\_type'     => 'page', |
  |  | 840 | //         'post\_title'    => 'Oliver Amelia Settings',// Title of the Page |
  |  | 841 | //         'post\_content'  => 'do not use and delete this page',// Content |
  |  | 842 | //         'post\_status'   => 'publish',            // Page Status |
  |  | 843 | //         'post\_name'     => $page\_slug            // Slug of the Page |
  |  | 844 | //     ); |
  |  | 845 | //     self::oliver\_pos\_create\_page($page\_slug, $new\_page); |
  |  | 846 |  |
  |  | 847 | //     $page\_slug = 'oliver-amelia-pages'; // Slug of the Page |
  |  | 848 | //     $new\_page = array( |
  |  | 849 | //         'post\_type'     => 'page', |
  |  | 850 | //         'post\_title'    => 'Oliver Amelia pages',// Title of the Page |
  |  | 851 | //         'post\_content'  => 'do not use and delete this page',// Content |
  |  | 852 | //         'post\_status'   => 'publish',           // Page Status |
  |  | 853 | //         'post\_name'     => $page\_slug            // Slug of the Page |
  |  | 854 | //     ); |
  |  | 855 | //     self::oliver\_pos\_create\_page($page\_slug, $new\_page); |
  |  | 856 | // } |
  | 817 | 857 | //amelia 2.4.1.8 |
  | 818 |  | public static function oliver\_pos\_create\_page($page\_slug, $new\_page){ |
  | 819 |  | // Check If Page Not Exits |
  | 820 |  | if (!get\_page\_by\_path( $page\_slug, OBJECT, 'page')) { |
  | 821 |  | $new\_page\_id = wp\_insert\_post($new\_page); |
  | 822 |  | } |
  | 823 |  | return 0; |
  | 824 |  | } |
  |  | 858 | // public static function oliver\_pos\_create\_page($page\_slug, $new\_page){ |
  |  | 859 | //     // Check If Page Not Exits |
  |  | 860 | //     if (!get\_page\_by\_path( $page\_slug, OBJECT, 'page')) { |
  |  | 861 | //         $new\_page\_id = wp\_insert\_post($new\_page); |
  |  | 862 | //     } |
  |  | 863 | //     return 0; |
  |  | 864 | // } |
  | 825 | 865 | } |
  | 826 | 866 | Pos\_Bridge\_Install::oliver\_pos\_init(); |
* ## [oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php](/changeset/3035108/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php")

  | [r3016376](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3016376#L1099 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3035108#L1099 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 1099 | 1099 | //@Since 2.4.1.8 |
  | 1100 | 1100 | //if amelia plugin deactivate then remove settings |
  | 1101 |  | if (in\_array("ameliabooking/ameliabooking.php", $plugin\_results)) { |
  | 1102 |  | $status = Pos\_Bridge\_Install::oliver\_pos\_get\_amelia\_status('deactivate\_plugin'); |
  | 1103 |  | oliver\_log('amelia plugin='.$status); |
  | 1104 |  | if($status=='connected'){ |
  | 1105 |  | $remove = Pos\_Bridge\_Install::oliver\_pos\_remove\_amelia('deactivate\_plugin'); |
  | 1106 |  | oliver\_log('amelia plugin deactivate='.$status); |
  | 1107 |  | if($remove=='done'){ |
  | 1108 |  | update\_option('amelia\_settings\_disable\_automatically', true); |
  | 1109 |  | } |
  | 1110 |  | } |
  | 1111 |  | } |
  | 1112 |  | if (in\_array("oliver-pos/oliver-pos.php", $plugin\_results)){ |
  | 1113 |  | if ( get\_option('oliver\_amelia\_status', false) ) |
  | 1114 |  | { |
  | 1115 |  | $content=""; |
  | 1116 |  | Pos\_Bridge\_Install::oliver\_pos\_add\_x\_from\_option($content); |
  | 1117 |  | update\_option('amelia\_settings\_disable\_automatically', true); |
  | 1118 |  | update\_option('oliver\_amelia\_status', false); |
  | 1119 |  | } |
  | 1120 |  | } |
  |  | 1101 | // if (in\_array("ameliabooking/ameliabooking.php", $plugin\_results)) { |
  |  | 1102 | //     $status = Pos\_Bridge\_Install::oliver\_pos\_get\_amelia\_status('deactivate\_plugin'); |
  |  | 1103 | //     oliver\_log('amelia plugin='.$status); |
  |  | 1104 | //     if($status=='connected'){ |
  |  | 1105 | //         $remove = Pos\_Bridge\_Install::oliver\_pos\_remove\_amelia('deactivate\_plugin'); |
  |  | 1106 | //         oliver\_log('amelia plugin deactivate='.$status); |
  |  | 1107 | //         if($remove=='done'){ |
  |  | 1108 | //             update\_option('amelia\_settings\_disable\_automatically', true); |
  |  | 1109 | //         } |
  |  | 1110 | //     } |
  |  | 1111 | // } |
  |  | 1112 | // if (in\_array("oliver-pos/oliver-pos.php", $plugin\_results)){ |
  |  | 1113 | //     if ( get\_option('oliver\_amelia\_status', false) ) |
  |  | 1114 | //     { |
  |  | 1115 | //         $content=""; |
  |  | 1116 | //         Pos\_Bridge\_Install::oliver\_pos\_add\_x\_from\_option($content); |
  |  | 1117 | //         update\_option('amelia\_settings\_disable\_automatically', true); |
  |  | 1118 | //         update\_option('oliver\_amelia\_status', false); |
  |  | 1119 | //     } |
  |  | 1120 | // } |
  | 1121 | 1121 | $active\_plugins['plugins\_update']='deactivate'; |
  | 1122 | 1122 | } |
  | 1123 | 1123 | else{ |
  | 1124 | 1124 | $active\_plugins['plugins\_update']='activate'; |
  | 1125 |  | if ( get\_option('amelia\_settings\_disable\_automatically', false)) { |
  | 1126 |  | $status = Pos\_Bridge\_Install::oliver\_pos\_enable\_amelia\_app('activate\_plugin'); |
  | 1127 |  | update\_option('amelia\_settings\_disable\_automatically', false); |
  | 1128 |  | update\_option('oliver\_amelia\_status', true); |
  | 1129 |  | } |
  |  | 1125 | // if ( get\_option('amelia\_settings\_disable\_automatically', false)) { |
  |  | 1126 | //     $status = Pos\_Bridge\_Install::oliver\_pos\_enable\_amelia\_app('activate\_plugin'); |
  |  | 1127 | //     update\_option('amelia\_settings\_disable\_automatically', false); |
  |  | 1128 | //     update\_option('oliver\_amelia\_status', true); |
  |  | 1129 | // } |
  | 1130 | 1130 | } |
  | 1131 | 1131 | foreach($plugin\_results as $plugin\_result) |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3016376#L1435) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3035108#L1435) |  |
  | 1435 | 1435 | $process\_order=0; |
  | 1436 | 1436 | $orders = get\_posts(array( |
  | 1437 |  | 'posts\_per\_page'  => -1, |
  |  | 1437 | 'posts\_per\_page'  => -1, |
  | 1438 | 1438 | 'fields'          => 'ids', |
  | 1439 |  | 'post\_status'     => OP\_ORDER\_STATUS, |
  | 1440 |  | 'post\_type' ~~=> array('shop\_order', 'shop\_order\_placehold')~~, |
  | 1441 |  | 'meta\_query'      => array( |
  |  | 1439 | 'post\_status'     => OP\_ORDER\_STATUS, |
  |  | 1440 | 'post\_type'       => OP\_POST\_TYPE, |
  |  | 1441 | 'meta\_query'      => array( |
  | 1442 | 1442 | array( |
  | 1443 | 1443 | 'key'       => '\_oliver\_pos\_receipt\_id', |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3016376#L1516) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3035108#L1516) |  |
  | 1516 | 1516 | ); |
  | 1517 | 1517 | //@Since 2.4.1.8 |
  | 1518 |  | if ( get\_option('oliver\_pos\_disable\_amelia', false)) { |
  | 1519 |  | $htaccess\_location = ABSPATH . '.htaccess'; |
  | 1520 |  | $content=""; |
  | 1521 |  | Pos\_Bridge\_Install::oliver\_pos\_add\_x\_from\_option($content); |
  | 1522 |  | update\_option('oliver\_pos\_disable\_amelia', false); |
  | 1523 |  | } |
  |  | 1518 | // if ( get\_option('oliver\_pos\_disable\_amelia', false)) { |
  |  | 1519 | //     $htaccess\_location = ABSPATH . '.htaccess'; |
  |  | 1520 | //     $content=""; |
  |  | 1521 | //     Pos\_Bridge\_Install::oliver\_pos\_add\_x\_from\_option($content); |
  |  | 1522 | //     update\_option('oliver\_pos\_disable\_amelia', false); |
  |  | 1523 | // } |
  | 1524 | 1524 | } |
  | 1525 | 1525 | /\*\* |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3016376#L1587) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3035108#L1587) |  |
  | 1587 | 1587 | \* @since 2.4.1.8 |
  | 1588 | 1588 | \*/ |
  | 1589 |  | public function oliver\_pos\_amelia\_menu($menu\_ord) { |
  | 1590 |  | global $submenu; |
  | 1591 |  | $amelia\_menu=''; |
  | 1592 |  | if ( AMELIA\_PLUGIN==true ) { |
  | 1593 |  | $amelia\_menu = $submenu['amelia']; |
  | 1594 |  | update\_option('oliver\_pos\_amelia\_menu', $amelia\_menu); |
  | 1595 |  | } |
  | 1596 |  | /\* wp\_remote\_post( esc\_url\_raw(ASP\_TRIGGER\_AMELIA\_MENU), array( |
  | 1597 |  | 'headers' => array('Content-Type' => 'application/json; charset=utf-8', |
  | 1598 |  | 'Authorization' => AUTHORIZATION, |
  | 1599 |  | ), |
  | 1600 |  | 'body' => json\_encode($amelia\_menu), |
  | 1601 |  | )); \*/ |
  | 1602 |  | return $menu\_ord; |
  | 1603 |  | } |
  |  | 1589 | // public function oliver\_pos\_amelia\_menu($menu\_ord) { |
  |  | 1590 | //     global $submenu; |
  |  | 1591 | //     $amelia\_menu=''; |
  |  | 1592 | //     if ( AMELIA\_PLUGIN==true ) { |
  |  | 1593 | //         $amelia\_menu = $submenu['amelia']; |
  |  | 1594 | //         update\_option('oliver\_pos\_amelia\_menu', $amelia\_menu); |
  |  | 1595 | //     } |
  |  | 1596 | //     /\* wp\_remote\_post( esc\_url\_raw(ASP\_TRIGGER\_AMELIA\_MENU), array( |
  |  | 1597 | //         'headers' => array('Content-Type' => 'application/json; charset=utf-8', |
  |  | 1598 | //             'Authorization' => AUTHORIZATION, |
  |  | 1599 | //         ), |
  |  | 1600 | //         'body' => json\_encode($amelia\_menu), |
  |  | 1601 | //     )); \*/ |
  |  | 1602 | //     return $menu\_ord; |
  |  | 1603 | // } |
  | 1604 | 1604 | /\*\* |
  | 1605 | 1605 | \* Get amelia details. |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3016376#L1607) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3035108#L1607) |  |
  | 1607 | 1607 | \* @return array Return amelia details |
  | 1608 | 1608 | \*/ |
  | 1609 |  | public function oliver\_pos\_get\_shop\_amelia\_details() { |
  | 1610 |  | $amelia\_menus = array( |
  | 1611 |  | 'amelia\_menus' => $this->oliver\_pos\_get\_amelia\_menu\_list(), |
  | 1612 |  | ); |
  | 1613 |  | return $amelia\_menus; |
  | 1614 |  | } |
  |  | 1609 | // public function oliver\_pos\_get\_shop\_amelia\_details() { |
  |  | 1610 | //     $amelia\_menus = array( |
  |  | 1611 | //         'amelia\_menus' => $this->oliver\_pos\_get\_amelia\_menu\_list(), |
  |  | 1612 | //     ); |
  |  | 1613 | //     return $amelia\_menus; |
  |  | 1614 | // } |
  | 1615 | 1615 | /\*\* |
  | 1616 | 1616 | \* Get amelia pages. |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3016376#L1618) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3035108#L1618) |  |
  | 1618 | 1618 | \* @return array Return amelia pages url |
  | 1619 | 1619 | \*/ |
  | 1620 |  | public function oliver\_pos\_get\_shop\_oliver\_amelia\_pages() { |
  | 1621 |  | $pages = array( |
  | 1622 |  | 'landing\_page' => home\_url().'/oliver-amelia', |
  | 1623 |  | 'manage\_page' => home\_url().'/oliver-amelia-setting' |
  | 1624 |  | ); |
  | 1625 |  | return $pages; |
  | 1626 |  | } |
  |  | 1620 | // public function oliver\_pos\_get\_shop\_oliver\_amelia\_pages() { |
  |  | 1621 | //     $pages = array( |
  |  | 1622 | //         'landing\_page' => home\_url().'/oliver-amelia', |
  |  | 1623 | //         'manage\_page' => home\_url().'/oliver-amelia-setting' |
  |  | 1624 | //     ); |
  |  | 1625 | //     return $pages; |
  |  | 1626 | // } |
  | 1627 | 1627 | /\*\* |
  | 1628 | 1628 | \* Get amelia permission. |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3016376#L1630) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge-miscellaneous.php?rev=3035108#L1630) |  |
  | 1630 | 1630 | \* @return array Return amelia permission |
  | 1631 | 1631 | \*/ |
  | 1632 |  | public function oliver\_pos\_get\_shop\_oliver\_amelia\_ability() { |
  | 1633 |  | $permission=false; |
  | 1634 |  | if ( get\_option('oliver\_amelia\_status', false) ){ |
  | 1635 |  | $permission=true; |
  | 1636 |  | } |
  | 1637 |  | $ability = array( |
  | 1638 |  | 'amelia\_ability' => $permission, |
  | 1639 |  | ); |
  | 1640 |  | return $ability; |
  | 1641 |  | } |
  |  | 1632 | // public function oliver\_pos\_get\_shop\_oliver\_amelia\_ability() { |
  |  | 1633 | //     $permission=false; |
  |  | 1634 | //     if ( get\_option('oliver\_amelia\_status', false) ){ |
  |  | 1635 | //         $permission=true; |
  |  | 1636 | //     } |
  |  | 1637 | //     $ability = array( |
  |  | 1638 | //         'amelia\_ability' => $permission, |
  |  | 1639 | //     ); |
  |  | 1640 | //     return $ability; |
  |  | 1641 | // } |
  | 1642 | 1642 | /\*\* |
  | 1643 | 1643 | \* @since 2.4.1.8 |
  | 1644 | 1644 | \* @return array |
  | 1645 | 1645 | \*/ |
  | 1646 |  | public function oliver\_pos\_disable\_amelia\_setting() { |
  | 1647 |  | $status = Pos\_Bridge\_Install::oliver\_pos\_get\_amelia\_status('deactivate\_plugin'); |
  | 1648 |  | update\_option('oliver\_pos\_disable\_amelia', false); |
  | 1649 |  | if($status=='disconnected'){ |
  | 1650 |  | update\_option('oliver\_pos\_disable\_amelia', true); |
  | 1651 |  | return oliver\_pos\_api\_response('it will done when admin init run', 1); |
  | 1652 |  | } |
  | 1653 |  | return oliver\_pos\_api\_response('hub show connected', 1); |
  | 1654 |  | } |
  |  | 1646 | // public function oliver\_pos\_disable\_amelia\_setting() { |
  |  | 1647 | //     $status = Pos\_Bridge\_Install::oliver\_pos\_get\_amelia\_status('deactivate\_plugin'); |
  |  | 1648 | //     update\_option('oliver\_pos\_disable\_amelia', false); |
  |  | 1649 | //     if($status=='disconnected'){ |
  |  | 1650 | //         update\_option('oliver\_pos\_disable\_amelia', true); |
  |  | 1651 | //         return oliver\_pos\_api\_response('it will done when admin init run', 1); |
  |  | 1652 | //     } |
  |  | 1653 | //     return oliver\_pos\_api\_response('hub show connected', 1); |
  |  | 1654 | // } |
  | 1655 | 1655 | /\*\* |
  | 1656 | 1656 | \* @since 2.4.1.8 |
  | 1657 | 1657 | \* @return menu names |
  | 1658 | 1658 | \*/ |
  | 1659 |  | public function oliver\_pos\_get\_amelia\_menu\_list() { |
  | 1660 |  | $social\_options = array(); |
  | 1661 |  | $social\_options[] = get\_option( 'oliver\_amelia\_dashboard' ); |
  | 1662 |  | $social\_options[] = get\_option( 'oliver\_amelia\_calendar' ); |
  | 1663 |  | $social\_options[] = get\_option( 'oliver\_amelia\_appointments' ); |
  | 1664 |  | $social\_options[] = get\_option( 'oliver\_amelia\_events' ); |
  | 1665 |  | $social\_options[] = get\_option( 'oliver\_amelia\_employees' ); |
  | 1666 |  | $social\_options[] = get\_option( 'oliver\_amelia\_services' ); |
  | 1667 |  | $social\_options[] = get\_option( 'oliver\_amelia\_customers' ); |
  | 1668 |  | $social\_options[] = get\_option( 'oliver\_amelia\_finance' ); |
  | 1669 |  | $social\_options[] = get\_option( 'oliver\_amelia\_notifications' ); |
  | 1670 |  | $social\_options[] = get\_option( 'oliver\_amelia\_customize' ); |
  | 1671 |  | $social\_options[] = get\_option( 'oliver\_amelia\_custom\_fields' ); |
  | 1672 |  | $social\_options[] = get\_option( 'oliver\_amelia\_settings' ); |
  | 1673 |  | $social\_options[] = get\_option( 'oliver\_amelia\_locations' ); |
  | 1674 |  | $menu\_data=array(); |
  | 1675 |  | $menus = get\_option('oliver\_pos\_amelia\_menu'); |
  | 1676 |  | if(!empty($menus)){ |
  | 1677 |  | foreach($menus as $menu){ |
  | 1678 |  | if (in\_array($menu[0], $social\_options)) { |
  | 1679 |  | $menu\_data[] = array( |
  | 1680 |  | 'menu\_name'=> $menu[0], |
  | 1681 |  | 'menu\_slug'=> $menu[2], |
  | 1682 |  | 'amelia\_read\_dashboard'=> $menu[1], |
  | 1683 |  | 'page\_url'=> home\_url().'/wp-admin/admin.php?page='.$menu[2], |
  | 1684 |  | ); |
  | 1685 |  | } |
  | 1686 |  | } |
  | 1687 |  | } |
  | 1688 |  | return $menu\_data; |
  | 1689 |  | } |
  |  | 1659 | // public function oliver\_pos\_get\_amelia\_menu\_list() { |
  |  | 1660 | //     $social\_options = array(); |
  |  | 1661 | //     $social\_options[] = get\_option( 'oliver\_amelia\_dashboard' ); |
  |  | 1662 | //     $social\_options[] = get\_option( 'oliver\_amelia\_calendar' ); |
  |  | 1663 | //     $social\_options[] = get\_option( 'oliver\_amelia\_appointments' ); |
  |  | 1664 | //     $social\_options[] = get\_option( 'oliver\_amelia\_events' ); |
  |  | 1665 | //     $social\_options[] = get\_option( 'oliver\_amelia\_employees' ); |
  |  | 1666 | //     $social\_options[] = get\_option( 'oliver\_amelia\_services' ); |
  |  | 1667 | //     $social\_options[] = get\_option( 'oliver\_amelia\_customers' ); |
  |  | 1668 | //     $social\_options[] = get\_option( 'oliver\_amelia\_finance' ); |
  |  | 1669 | //     $social\_options[] = get\_option( 'oliver\_amelia\_notifications' ); |
  |  | 1670 | //     $social\_options[] = get\_option( 'oliver\_amelia\_customize' ); |
  |  | 1671 | //     $social\_options[] = get\_option( 'oliver\_amelia\_custom\_fields' ); |
  |  | 1672 | //     $social\_options[] = get\_option( 'oliver\_amelia\_settings' ); |
  |  | 1673 | //     $social\_options[] = get\_option( 'oliver\_amelia\_locations' ); |
  |  | 1674 | //     $menu\_data=array(); |
  |  | 1675 | //     $menus = get\_option('oliver\_pos\_amelia\_menu'); |
  |  | 1676 | //     if(!empty($menus)){ |
  |  | 1677 | //         foreach($menus as $menu){ |
  |  | 1678 | //             if (in\_array($menu[0], $social\_options)) { |
  |  | 1679 | //                 $menu\_data[] = array( |
  |  | 1680 | //                     'menu\_name'=> $menu[0], |
  |  | 1681 | //                     'menu\_slug'=> $menu[2], |
  |  | 1682 | //                     'amelia\_read\_dashboard'=> $menu[1], |
  |  | 1683 | //                     'page\_url'=> home\_url().'/wp-admin/admin.php?page='.$menu[2], |
  |  | 1684 | //                 ); |
  |  | 1685 | //             } |
  |  | 1686 | //         } |
  |  | 1687 | //     } |
  |  | 1688 | //     return $menu\_data; |
  |  | 1689 | // } |
  | 1690 | 1690 | } |
* ## [oliver-pos/trunk/includes/class-pos-bridge-order.php](/changeset/3035108/oliver-pos/trunk/includes/class-pos-bridge-order.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/class-pos-bridge-order.php")

  | [r3016376](/browser/oliver-pos/trunk/includes/class-pos-bridge-order.php?rev=3016376#L490 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/class-pos-bridge-order.php?rev=3035108#L490 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 490 | 490 | 'order'            => 'ASC', |
  | 491 | 491 | 'post\_status'      => OP\_ORDER\_STATUS, |
  | 492 |  | 'post\_type'        => ~~array('shop\_order', 'shop\_order\_placehold')~~, |
  |  | 492 | 'post\_type'        => OP\_POST\_TYPE, |
  | 493 | 493 | 'paged'            => $parameters['page'], |
  | 494 | 494 | ) ); |
* ## [oliver-pos/trunk/includes/class-pos-bridge-tax.php](/changeset/3035108/oliver-pos/trunk/includes/class-pos-bridge-tax.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/class-pos-bridge-tax.php")

  | [r2998720](/browser/oliver-pos/trunk/includes/class-pos-bridge-tax.php?rev=2998720#L88 "Show revision 2998720 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/class-pos-bridge-tax.php?rev=3035108#L88 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 88 | 88 | 'pos\_tax\_display\_cart' => get\_option('woocommerce\_tax\_display\_cart'), |
  | 89 | 89 | 'pos\_price\_display\_suffix' => get\_option('woocommerce\_price\_display\_suffix'), |
  | 90 |  | 'pos\_tax\_total\_display' => get\_option('woocommerce\_tax\_total\_display') |
  |  | 90 | 'pos\_tax\_total\_display' => get\_option('woocommerce\_tax\_total\_display'), |
  |  | 91 | 'pos\_automated\_taxes' => get\_option('wc\_connect\_taxes\_enabled') |
  | 91 | 92 | ); |
  | 92 | 93 | } |
* ## [oliver-pos/trunk/includes/class-pos-bridge.php](/changeset/3035108/oliver-pos/trunk/includes/class-pos-bridge.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/class-pos-bridge.php")

  | [r3016376](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3016376#L614 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3035108#L614 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 614 | 614 | add\_action('update\_option\_oliver\_pos\_general\_setting\_field', array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_woocommerce\_general\_settings\_post\_listener' ), 10, 3); |
  | 615 | 615 | //Since 2.4.1.8 Add Amelia |
  | 616 |  | add\_filter('menu\_order', array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_amelia\_menu' ), 10, 1); |
  |  | 616 | //add\_filter('menu\_order', array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_amelia\_menu' ), 10, 1); |
  | 617 | 617 | //\*  Register tickera related trigger like add update delete |
  | 618 | 618 | add\_action('save\_post\_tc\_forms', array( $this->pos\_bridge\_tickera, 'oliver\_pos\_save\_tickera\_form\_post') , 10, 3); |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3016376#L1692) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3035108#L1692) |  |
  | 1692 | 1692 | \* @return array Return amelia details |
  | 1693 | 1693 | \*/ |
  | 1694 |  | register\_rest\_route( $this->namespace, '/amelia-details/', array( |
  | 1695 |  | 'methods' => WP\_REST\_Server::READABLE, |
  | 1696 |  | 'callback' => array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_get\_shop\_amelia\_details' ), |
  | 1697 |  | 'permission\_callback' => array( $this, 'oliver\_pos\_rest\_authentication' ) |
  | 1698 |  | ) |
  | 1699 |  | ); |
  |  | 1694 | // register\_rest\_route( $this->namespace, '/amelia-details/', array( |
  |  | 1695 | //         'methods' => WP\_REST\_Server::READABLE, |
  |  | 1696 | //         'callback' => array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_get\_shop\_amelia\_details' ), |
  |  | 1697 | //         'permission\_callback' => array( $this, 'oliver\_pos\_rest\_authentication' ) |
  |  | 1698 | //     ) |
  |  | 1699 | // ); |
  | 1700 | 1700 | /\*\* |
  | 1701 | 1701 | \* Get amelia pages. |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3016376#L1703) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3035108#L1703) |  |
  | 1703 | 1703 | \* @return array Return amelia pages |
  | 1704 | 1704 | \*/ |
  | 1705 |  | register\_rest\_route( $this->namespace, '/oliver-amelia-pages/', array( |
  | 1706 |  | 'methods' => WP\_REST\_Server::READABLE, |
  | 1707 |  | 'callback' => array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_get\_shop\_oliver\_amelia\_pages' ), |
  | 1708 |  | 'permission\_callback' => array( $this, 'oliver\_pos\_rest\_authentication' ) |
  | 1709 |  | ) |
  | 1710 |  | ); |
  |  | 1705 | // register\_rest\_route( $this->namespace, '/oliver-amelia-pages/', array( |
  |  | 1706 | //         'methods' => WP\_REST\_Server::READABLE, |
  |  | 1707 | //         'callback' => array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_get\_shop\_oliver\_amelia\_pages' ), |
  |  | 1708 | //         'permission\_callback' => array( $this, 'oliver\_pos\_rest\_authentication' ) |
  |  | 1709 | //     ) |
  |  | 1710 | // ); |
  | 1711 | 1711 | /\*\* |
  | 1712 | 1712 | \* Get amelia permission. |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3016376#L1714) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3035108#L1714) |  |
  | 1714 | 1714 | \* @return array Return amelia permission |
  | 1715 | 1715 | \*/ |
  | 1716 |  | register\_rest\_route( $this->namespace, '/oliver-amelia-ability/', array( |
  | 1717 |  | 'methods' => WP\_REST\_Server::READABLE, |
  | 1718 |  | 'callback' => array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_get\_shop\_oliver\_amelia\_ability' ), |
  | 1719 |  | 'permission\_callback' => array( $this, 'oliver\_pos\_rest\_authentication' ) |
  | 1720 |  | ) |
  | 1721 |  | ); |
  |  | 1716 | // register\_rest\_route( $this->namespace, '/oliver-amelia-ability/', array( |
  |  | 1717 | //         'methods' => WP\_REST\_Server::READABLE, |
  |  | 1718 | //         'callback' => array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_get\_shop\_oliver\_amelia\_ability' ), |
  |  | 1719 | //         'permission\_callback' => array( $this, 'oliver\_pos\_rest\_authentication' ) |
  |  | 1720 | //     ) |
  |  | 1721 | // ); |
  | 1722 | 1722 | /\*\* |
  | 1723 | 1723 | \* Get amelia permission. |
  | […](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3016376#L1725) | […](/browser/oliver-pos/trunk/includes/class-pos-bridge.php?rev=3035108#L1725) |  |
  | 1725 | 1725 | \* @return array Return amelia permission |
  | 1726 | 1726 | \*/ |
  | 1727 |  | register\_rest\_route( $this->namespace, '/oliver-amelia-disable/', array( |
  | 1728 |  | 'methods' => WP\_REST\_Server::READABLE, |
  | 1729 |  | 'callback' => array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_disable\_amelia\_setting' ), |
  | 1730 |  | 'permission\_callback' => array( $this, 'oliver\_pos\_rest\_authentication' ) |
  | 1731 |  | ) |
  | 1732 |  | ); |
  |  | 1727 | // register\_rest\_route( $this->namespace, '/oliver-amelia-disable/', array( |
  |  | 1728 | //         'methods' => WP\_REST\_Server::READABLE, |
  |  | 1729 | //         'callback' => array( $this->pos\_bridge\_miscellaneous, 'oliver\_pos\_disable\_amelia\_setting' ), |
  |  | 1730 | //         'permission\_callback' => array( $this, 'oliver\_pos\_rest\_authentication' ) |
  |  | 1731 | //     ) |
  |  | 1732 | // ); |
  | 1733 | 1733 | /\*\* |
  | 1734 | 1734 | \* Get Woo all log files name. |
* ## [oliver-pos/trunk/includes/models/class-pos-bridge-order.php](/changeset/3035108/oliver-pos/trunk/includes/models/class-pos-bridge-order.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/models/class-pos-bridge-order.php")

  | [r3016376](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3016376#L36 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3035108#L36 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 36 | 36 | 'order'            => 'DESC', |
  | 37 | 37 | 'post\_status' => OP\_ORDER\_STATUS, |
  | 38 |  | 'post\_type' => ~~array('shop\_order', 'shop\_order\_placehold')~~, |
  |  | 38 | 'post\_type' => OP\_POST\_TYPE, |
  | 39 | 39 | ) ); |
  | 40 | 40 |  |
  | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3016376#L60) | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3035108#L60) |  |
  | 60 | 60 | 'order'            => 'ASC', |
  | 61 | 61 | 'post\_status' => OP\_ORDER\_STATUS, |
  | 62 |  | 'post\_type' => ~~array('shop\_order', 'shop\_order\_placehold')~~, |
  |  | 62 | 'post\_type' => OP\_POST\_TYPE, |
  | 63 | 63 | 'paged' => $page, |
  | 64 | 64 | ) ); |
  | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3016376#L429) | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3035108#L429) |  |
  | 429 | 429 | 'posts\_per\_page'   => 1, |
  | 430 | 430 | 'post\_status'      => OP\_ORDER\_STATUS, |
  | 431 |  | 'post\_type'        => ~~array('shop\_order', 'shop\_order\_placehold')~~, |
  |  | 431 | 'post\_type'        => OP\_POST\_TYPE, |
  | 432 | 432 | 'meta\_query'       => array( |
  | 433 | 433 | array( |
  | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3016376#L575) | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3035108#L575) |  |
  | 575 | 575 |  |
  | 576 | 576 | //Since 2.4.0.1 |
  | 577 |  | //invent~~ry updat~~e |
  | 578 |  | if ( ~~! empty( $warehouse\_id )~~ ) { |
  |  | 577 | //inventory update for warehouse in warehouse found and prevent quantity if park sale |
  |  | 578 | if ( (! empty( $warehouse\_id )) && ($data['status'] != 'wc-pending' )) { |
  | 579 | 579 | $isdefault = $this->oliver\_pos\_get\_default\_warehouse( $warehouse\_id ); |
  | 580 | 580 | if ( $isdefault == 0 ) { |
  |  | 581 | //work as warehouse |
  | 581 | 582 | if ( empty( $item['variation\_id'] ) ) { |
  | 582 | 583 | $product\_id = wc\_get\_order\_item\_meta( $item\_id, '\_product\_id', true ); |
  | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3016376#L1170) | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3035108#L1171) |  |
  | 1170 | 1171 | 'posts\_per\_page'   => 1, |
  | 1171 | 1172 | 'post\_status'      => OP\_ORDER\_STATUS, |
  | 1172 |  | 'post\_type'        => ~~array('shop\_order', 'shop\_order\_placehold')~~, |
  |  | 1173 | 'post\_type'        => OP\_POST\_TYPE, |
  | 1173 | 1174 | 'meta\_query'       => array( |
  | 1174 | 1175 | array( |
  | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3016376#L1924) | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3035108#L1925) |  |
  | 1924 | 1925 | private function oliver\_pos\_set\_order\_custom\_fee( $order\_id, $data ) { |
  | 1925 | 1926 | foreach ($data as $key => $fee) { |
  | 1926 |  | $\_fee\_amount = isset($fee['~~amount']) ? sanitize\_text\_field($fee['amount~~']) : 0; |
  |  | 1927 | $\_fee\_amount = isset($fee['subtotal']) ? sanitize\_text\_field($fee['subtotal']) : 0; |
  | 1927 | 1928 | $\_fee\_name = isset($fee['note']) ? sanitize\_text\_field($fee['note']) : ''; |
  | 1928 |  | $total\_tax = isset($fee['~~total\_tax']) ? sanitize\_text\_field($fee['~~total\_tax']) : ''; |
  |  | 1929 | $total\_tax = isset($fee['subtotal\_tax']) ? sanitize\_text\_field($fee['subtotal\_tax']) : ''; |
  | 1929 | 1930 | $total\_taxes = isset($fee['total\_taxes']) ? $fee['total\_taxes'] : ''; |
  | 1930 | 1931 | if ( isset( $fee['fee\_id'] ) && $fee['fee\_id'] > 0 ) { |
  | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3016376#L2404) | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3035108#L2405) |  |
  | 2404 | 2405 | if(empty($data\_warehouse)){ |
  | 2405 | 2406 | oliver\_log('no warehouse found in warehouse table'); |
  |  | 2407 | //work as defoult |
  | 2406 | 2408 | return 1; |
  | 2407 | 2409 | } |
  | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3016376#L2409) | […](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-order.php?rev=3035108#L2411) |  |
  | 2409 | 2411 | if( $data == 1 ) |
  | 2410 | 2412 | { |
  |  | 2413 | //work as defoult |
  | 2411 | 2414 | oliver\_log('defoult warehouse found'); |
  | 2412 | 2415 | return 1; |
  | 2413 | 2416 | } |
  | 2414 | 2417 | else{ |
  | 2415 |  | oliver\_log('defoult warehouse not found'); |
  |  | 2418 | //work as warehouse |
  |  | 2419 | oliver\_log('warehouse found'); |
  | 2416 | 2420 | return 0; |
  | 2417 | 2421 | } |
* ## [oliver-pos/trunk/includes/models/class-pos-bridge-user.php](/changeset/3035108/oliver-pos/trunk/includes/models/class-pos-bridge-user.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/models/class-pos-bridge-user.php")

  | [r3016376](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-user.php?rev=3016376#L185 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/models/class-pos-bridge-user.php?rev=3035108#L185 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 185 | 185 | 'order'            => 'DESC', |
  | 186 | 186 | 'post\_status' => OP\_ORDER\_STATUS, |
  | 187 |  | 'post\_type' => ~~array('shop\_order', 'shop\_order\_placehold')~~, |
  |  | 187 | 'post\_type' => OP\_POST\_TYPE, |
  | 188 | 188 | 'paged'    => $page, |
  | 189 | 189 | 'meta\_query' => array( |
* ## [oliver-pos/trunk/includes/version.php](/changeset/3035108/oliver-pos/trunk/includes/version.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/version.php")

  | [r3016376](/browser/oliver-pos/trunk/includes/version.php?rev=3016376#L1 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/version.php?rev=3035108#L1 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  | return '2.4.1.~~8~~'; |
  |  | 2 | return '2.4.1.9'; |
  | 3 | 3 | ?> |
* ## [oliver-pos/trunk/includes/views/backend/create-subscription-new.php](/changeset/3035108/oliver-pos/trunk/includes/views/backend/create-subscription-new.php "Show the changeset 3035108 restricted to oliver-pos/trunk/includes/views/backend/create-subscription-new.php")

  | [r3016376](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L191 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L191 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 191 | 191 | </div> |
  | 192 | 192 | </div> |
  | 193 |  | ~~<!--amelia html start-->~~ |
  | 194 |  | ~~<?php~~ |
  | 195 |  | ~~if ( AMELIA\_PLUGIN==true ) {~~ |
  | 196 |  | ~~?>~~ |
  | 197 |  | ~~<div class="op-streached-card op-streached-card--2 op-amelia">~~ |
  | 198 |  | ~~<div class="op-streached-card-content">~~ |
  | 199 |  | ~~<div class="op-streached-card-img-group">~~ |
  | 200 |  | ~~<img src="<?php echo plugins\_url('public/resource/img/oliver\_\_break-blue.svg', dirname(dirname(dirname(\_\_FILE\_\_)))); ?>" alt="" />~~ |
  | 201 |  | ~~</div>~~ |
  | 202 |  | ~~<span><?php esc\_html\_e( 'Amelia plugin detected', 'oliver-pos' ); ?></span>~~ |
  | 203 |  | ~~<span class="op-streached-card-close">~~ |
  | 204 |  | ~~&times;~~ |
  | 205 |  | ~~</span>~~ |
  | 206 |  | ~~</div>~~ |
  | 207 |  | ~~<div class="op-streached-card-container">~~ |
  | 208 |  | ~~<div class="op-streached-card-start">~~ |
  | 209 |  | ~~<h1 class="op-streached-card-heading"><?php esc\_html\_e( 'Getting started with Amelia for Oliver POS', 'oliver-pos' ); ?></h1>~~ |
  | 210 |  | ~~<p class="op-enable-amelia"><?php esc\_html\_e( 'In order to use Amelia in the Oliver Register, you need to update the HT Access file. Clicking the button below will do this automatically. More information ', 'oliver-pos' ); ?><a href="https://help.oliverpos.com" target="\_blank"><?php esc\_html\_e( 'here', 'oliver-pos' ); ?></a>.</p>~~ |
  | 211 |  | ~~<button type="button" class="op-btn-primary op-enable-amelia" id="op-enable-amelia">~~ |
  | 212 |  | ~~<?php esc\_html\_e( 'Enable Amelia', 'oliver-pos' ); ?>~~ |
  | 213 |  | ~~<svg width="16" class="op-span--icon" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">~~ |
  | 214 |  | ~~<path fill-rule="evenodd" clip-rule="evenodd" d="M10.6921 1H5.30807C4.15914 1.00635 3.0598 1.46885 2.25189 2.28576C1.44398 3.10268 0.993684 4.20708 1.00007 5.356V10.644C0.993684 11.7929 1.44398 12.8973 2.25189 13.7142C3.0598 14.5311 4.15914 14.9937 5.30807 15H10.6921C11.841 14.9937 12.9403 14.5311 13.7482 13.7142C14.5562 12.8973 15.0064 11.7929 15.0001 10.644V5.356C15.0064 4.20708 14.5562 3.10268 13.7482 2.28576C12.9403 1.46885 11.841 1.00635 10.6921 1Z"  stroke-linecap="round" stroke-linejoin="round"/>~~ |
  | 215 |  | ~~<path fill-rule="evenodd" clip-rule="evenodd" d="M5.5 9L8 4V7H10.5L8 12V9H5.5Z" stroke-linecap="round" stroke-linejoin="round"/>~~ |
  | 216 |  | ~~</svg>~~ |
  | 217 |  | ~~</button>~~ |
  | 218 |  | ~~<p class="op-disable-amelia"><?php esc\_html\_e( 'In order to disable Amelia from Oliver Register, it will reset the HTAccess settings and remove app configuration Oliver Register. Clicking the button below will do this  automatically...', 'oliver-pos'); ?></p>~~ |
  | 219 |  | ~~<button type="button" class="op-delete-connection op-disable-amelia" id="op-disable-amelia"><?php esc\_html\_e( 'Disable Amelia', 'oliver-pos' ); ?></button>~~ |
  | 220 |  | ~~<p class="op\_show\_msg"></p>~~ |
  | 221 |  | ~~</div>~~ |
  | 222 |  | ~~<div class="op-streached-card-end">~~ |
  | 223 |  | ~~<img src="<?php echo plugins\_url('public/resource/img/amelia\_\_img.png', dirname(dirname(dirname(\_\_FILE\_\_)))); ?>" alt="" />~~ |
  | 224 |  | ~~</div>~~ |
  | 225 |  | ~~</div>~~ |
  | 226 |  | ~~</div>~~ |
  | 227 |  | ~~<!-- model start confirm disble amelia-->~~ |
  | 228 |  | ~~<div class="op-modal op-close" id="op\_confirm\_desable\_amelia">~~ |
  | 229 |  | ~~<div class="op-modal\_overlay"></div>~~ |
  | 230 |  | ~~<div class="op-modal\_container">~~ |
  | 231 |  | ~~<div class="op-modal\_header">~~ |
  | 232 |  | ~~<h3><?php esc\_html\_e( 'Disable amelia app', 'oliver-pos' ); ?></h3>~~ |
  | 233 |  | ~~<div class="op-modal\_close ">&times;</div>~~ |
  | 234 |  | ~~</div>~~ |
  | 235 |  | ~~<div class="op-modal\_content">~~ |
  | 236 |  | ~~<p><?php esc\_html\_e( 'Are you sure that you want to disable Amelia app', 'oliver-pos' ); ?></p>~~ |
  | 237 |  | ~~<div class="op-modal\_buttons-container">~~ |
  | 238 |  | ~~<button class="op-btn-primary op-cancel-btn"><?php esc\_html\_e( 'Cancel', 'oliver-pos' ); ?></button>~~ |
  | 239 |  | ~~<button class="op-delete-connection" id="op-confirm-delete-amelia"><?php esc\_html\_e( 'Disable', 'oliver-pos' ); ?></button>~~ |
  | 240 |  | ~~</div>~~ |
  | 241 |  | ~~</div>~~ |
  | 242 |  | ~~</div>~~ |
  | 243 |  | ~~</div>~~ |
  | 244 |  | ~~<!--amelia html end-->~~ |
  | 245 |  | ~~<?php } ?>~~ |
  | 246 | 193 | <div class="op-streached-card op-streached-card--2 op-woo-pos" style="display: none"> |
  | 247 | 194 | <div class="op-streached-card-container"> |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L581) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L528) |  |
  | 581 | 528 | oliver\_pos\_get\_sync\_status(); |
  | 582 | 529 | }); |
  | 583 |  | jQuery('#op-disable-amelia').click(function(){ |
  | 584 |  | jQuery('#op\_confirm\_desable\_amelia').css({"display": "block"}); |
  | 585 |  | }); |
  | 586 |  | jQuery(document).on('click', '#op-confirm-delete-amelia', function() { |
  | 587 |  | jQuery('#op\_confirm\_desable\_amelia').css({"display": "none"}); |
  | 588 |  | oliver\_pos\_startLoader(); |
  | 589 |  | oliver\_pos\_remove\_amelia(); |
  | 590 |  | }); |
  | 591 |  | //On Click ebnable amelia button |
  | 592 |  | jQuery("#op-enable-amelia").click(function(){ |
  | 593 |  | oliver\_pos\_enable\_amelia(); |
  | 594 |  | }); |
  |  | 530 | // jQuery('#op-disable-amelia').click(function(){ |
  |  | 531 | //     jQuery('#op\_confirm\_desable\_amelia').css({"display": "block"}); |
  |  | 532 | // }); |
  |  | 533 | // jQuery(document).on('click', '#op-confirm-delete-amelia', function() { |
  |  | 534 | //     jQuery('#op\_confirm\_desable\_amelia').css({"display": "none"}); |
  |  | 535 | //     oliver\_pos\_startLoader(); |
  |  | 536 | //     oliver\_pos\_remove\_amelia(); |
  |  | 537 | // }); |
  |  | 538 | // //On Click ebnable amelia button |
  |  | 539 | // jQuery("#op-enable-amelia").click(function(){ |
  |  | 540 | //     oliver\_pos\_enable\_amelia(); |
  |  | 541 | // }); |
  | 595 | 542 | }); |
  | 596 | 543 | //CHeck sync status |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L599) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L546) |  |
  | 599 | 546 | jQuery.post(JQueryAjaxUrl ,{ |
  | 600 | 547 | 'action'    : 'oliver\_pos\_syncing\_status', |
  | 601 |  | 'se~~rvice'   : '1'~~, |
  |  | 548 | 'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  | 602 | 549 | }, |
  | 603 | 550 | function( result ){ |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L632) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L579) |  |
  | 632 | 579 | jQuery.post(JQueryAjaxUrl ,{ |
  | 633 | 580 | 'action'    : 'oliver\_pos\_init\_connection', |
  | 634 |  | 'se~~rvice'   : '1'~~, |
  |  | 581 | 'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  | 635 | 582 | }, |
  | 636 | 583 | function(result){ |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L664) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L611) |  |
  | 664 | 611 | oliver\_pos\_systemCheck(); |
  | 665 | 612 | //amelia |
  | 666 |  | if(jQuery('.op-amelia').length >0 ){ |
  | 667 |  | oliver\_pos\_get\_amelia\_info(); |
  | 668 |  | } |
  |  | 613 | // if(jQuery('.op-amelia').length >0 ){ |
  |  | 614 | //     oliver\_pos\_get\_amelia\_info(); |
  |  | 615 | // } |
  | 669 | 616 | return; //this means compiler should not read next line |
  | 670 | 617 | } |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L735) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L682) |  |
  | 735 | 682 | jQuery.post(JQueryAjaxUrl ,{ |
  | 736 | 683 | 'action'    : 'oliver\_pos\_disconnect\_subscription', |
  | 737 |  | 'se~~rvice'   : '1'~~, |
  |  | 684 | 'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  | 738 | 685 | }, |
  | 739 | 686 | function( response ){ |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L749) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L696) |  |
  | 749 | 696 | jQuery.post(JQueryAjaxUrl ,{ |
  | 750 | 697 | 'action'    : 'oliver\_pos\_delete\_subscription', |
  | 751 |  | 'se~~rvice'   : '1'~~, |
  |  | 698 | 'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  | 752 | 699 | }, |
  | 753 | 700 | function( response ){ |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L765) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L712) |  |
  | 765 | 712 | jQuery.post(JQueryAjaxUrl ,{ |
  | 766 | 713 | 'action'    : 'oliver\_pos\_remove\_subscription', |
  | 767 |  | 'se~~rvice'   : '1'~~, |
  |  | 714 | 'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  | 768 | 715 | }, |
  | 769 | 716 | function( response ){ |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L792) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L739) |  |
  | 792 | 739 | 'action'    : 'oliver\_pos\_connect\_site', |
  | 793 | 740 | 'subscription\_key'   : subscription\_key, |
  |  | 741 | 'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  | 794 | 742 | }, |
  | 795 | 743 | function( response ){ |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L882) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L830) |  |
  | 882 | 830 | jQuery.post(JQueryAjaxUrl ,{ |
  | 883 | 831 | 'action'    : 'oliver\_pos\_getWebsiteSpeed', |
  |  | 832 | 'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  | 884 | 833 | }, |
  | 885 | 834 | function(plans\_result){ |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L900) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L849) |  |
  | 900 | 849 | jQuery.post(JQueryAjaxUrl ,{ |
  | 901 | 850 | 'action'    : 'oliver\_pos\_register\_url', |
  |  | 851 | 'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  | 902 | 852 | }, |
  | 903 | 853 | function(reg\_result){ |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L915) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L865) |  |
  | 915 | 865 | } |
  | 916 | 866 | //amelia js |
  | 917 |  | function oliver\_pos\_get\_amelia\_info(){ |
  | 918 |  | jQuery.post(JQueryAjaxUrl ,{ |
  | 919 |  | 'action'    : 'oliver\_pos\_get\_amelia\_status', |
  | 920 |  | }, |
  | 921 |  | function(op\_result){ |
  | 922 |  | let op\_response = JSON.parse(op\_result); |
  | 923 |  | if(op\_response.status=='connected'){ |
  | 924 |  | jQuery('.op-system-check.op-login-user').css("display", "flex"); |
  | 925 |  | jQuery(".op-disable-amelia").css("display", "block"); |
  | 926 |  | jQuery(".op-enable-amelia").css("display", "none"); |
  | 927 |  | } |
  | 928 |  | else if(op\_response.status=='disconnected'){ |
  | 929 |  | jQuery(".op-enable-amelia").css("display", "block"); |
  | 930 |  | jQuery(".op-disable-amelia").css("display", "none"); |
  | 931 |  | } |
  | 932 |  | } |
  | 933 |  | ); |
  | 934 |  | } |
  |  | 867 | // function oliver\_pos\_get\_amelia\_info(){ |
  |  | 868 | //     jQuery.post(JQueryAjaxUrl ,{ |
  |  | 869 | //             'action'    : 'oliver\_pos\_get\_amelia\_status', |
  |  | 870 | //             'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  |  | 871 | //         }, |
  |  | 872 | //         function(op\_result){ |
  |  | 873 | //             let op\_response = JSON.parse(op\_result); |
  |  | 874 | //             if(op\_response.status=='connected'){ |
  |  | 875 | //                 jQuery('.op-system-check.op-login-user').css("display", "flex"); |
  |  | 876 | //                 jQuery(".op-disable-amelia").css("display", "block"); |
  |  | 877 | //                 jQuery(".op-enable-amelia").css("display", "none"); |
  |  | 878 | //             } |
  |  | 879 | //             else if(op\_response.status=='disconnected'){ |
  |  | 880 | //                 jQuery(".op-enable-amelia").css("display", "block"); |
  |  | 881 | //                 jQuery(".op-disable-amelia").css("display", "none"); |
  |  | 882 | //             } |
  |  | 883 | //         } |
  |  | 884 | //     ); |
  |  | 885 | // } |
  | 935 | 886 | //enable amelia |
  | 936 |  | function oliver\_pos\_enable\_amelia() { |
  | 937 |  | jQuery("#op-enable-amelia").addClass("op\_disable"); |
  | 938 |  | jQuery.post(JQueryAjaxUrl ,{ |
  | 939 |  | 'action'    : 'oliver\_pos\_enable\_amelia\_app', |
  | 940 |  | }, |
  | 941 |  | function(op\_result){ |
  | 942 |  | let op\_response = JSON.parse(op\_result); |
  | 943 |  | jQuery('.op\_show\_msg').css("display", "flex"); |
  | 944 |  | jQuery(".op\_show\_msg").text(op\_response.Message); |
  | 945 |  | if(op\_response.status=='done'){ |
  | 946 |  | jQuery(".op\_show\_msg").addClass("op\_success-message"); |
  | 947 |  | jQuery(".op-enable-amelia").css("display", "none"); |
  | 948 |  | jQuery(".op-disable-amelia").css("display", "block"); |
  | 949 |  | } |
  | 950 |  | else{ |
  | 951 |  | jQuery(".op\_show\_msg").addClass("op\_error-message"); |
  | 952 |  | jQuery(".op-enable-amelia").css("display", "block"); |
  | 953 |  | jQuery(".op-disable-amelia").css("display", "none"); |
  | 954 |  | } |
  | 955 |  | setTimeout(function(){ |
  | 956 |  | jQuery('.op\_show\_msg').html(''); |
  | 957 |  | jQuery('.op\_show\_msg').css("display", "none"); |
  | 958 |  | }, 5000); |
  | 959 |  | } |
  | 960 |  | ); |
  | 961 |  | } |
  |  | 887 | // function oliver\_pos\_enable\_amelia() { |
  |  | 888 | //     jQuery("#op-enable-amelia").addClass("op\_disable"); |
  |  | 889 | //     jQuery.post(JQueryAjaxUrl ,{ |
  |  | 890 | //             'action'    : 'oliver\_pos\_enable\_amelia\_app', |
  |  | 891 | //             'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  |  | 892 | //         }, |
  |  | 893 | //         function(op\_result){ |
  |  | 894 | //             let op\_response = JSON.parse(op\_result); |
  |  | 895 | //             jQuery('.op\_show\_msg').css("display", "flex"); |
  |  | 896 | //             jQuery(".op\_show\_msg").text(op\_response.Message); |
  |  | 897 | //             if(op\_response.status=='done'){ |
  |  | 898 | //                 jQuery(".op\_show\_msg").addClass("op\_success-message"); |
  |  | 899 | //                 jQuery(".op-enable-amelia").css("display", "none"); |
  |  | 900 | //                 jQuery(".op-disable-amelia").css("display", "block"); |
  |  | 901 | //             } |
  |  | 902 | //             else{ |
  |  | 903 | //                 jQuery(".op\_show\_msg").addClass("op\_error-message"); |
  |  | 904 | //                 jQuery(".op-enable-amelia").css("display", "block"); |
  |  | 905 | //                 jQuery(".op-disable-amelia").css("display", "none"); |
  |  | 906 | //             } |
  |  | 907 | //             setTimeout(function(){ |
  |  | 908 | //                 jQuery('.op\_show\_msg').html(''); |
  |  | 909 | //                 jQuery('.op\_show\_msg').css("display", "none"); |
  |  | 910 | //             }, 5000); |
  |  | 911 | //         } |
  |  | 912 | //     ); |
  |  | 913 | // } |
  | 962 | 914 | // remove amelia |
  | 963 |  | function oliver\_pos\_remove\_amelia() { |
  | 964 |  | oliver\_pos\_startLoader(); |
  | 965 |  | jQuery.post(JQueryAjaxUrl ,{ |
  | 966 |  | 'action'    : 'oliver\_pos\_remove\_amelia', |
  | 967 |  | ~~'service'   : '1'~~, |
  | 968 |  | }, |
  | 969 |  | function( response ){ |
  | 970 |  | oliver\_pos\_stopLoader(); |
  | 971 |  | let op\_response = JSON.parse(response); |
  | 972 |  | jQuery('.op\_show\_msg').css("display", "block"); |
  | 973 |  | if(op\_response.status=='done'){ |
  | 974 |  | jQuery(".op\_show\_msg").addClass("op\_success-message"); |
  | 975 |  | jQuery(".op\_show\_msg").text(op\_response.Message); |
  | 976 |  | jQuery(".op-enable-amelia").css("display", "block"); |
  | 977 |  | jQuery("#op-enable-amelia").removeClass("op\_disable"); |
  | 978 |  | jQuery(".op-disable-amelia").css("display", "none"); |
  | 979 |  | } |
  | 980 |  | else{ |
  | 981 |  | jQuery(".op\_show\_msg").addClass("op\_error-message"); |
  | 982 |  | jQuery(".op\_show\_msg").html("<strong>Error Amelia Disable:</strong> There is an error occurent while disabling the Amelia settings, please try again later or contact to support for <a target='\_blank' href='support link'>help</a>"); |
  | 983 |  | } |
  | 984 |  | setTimeout(function(){ |
  | 985 |  | jQuery('.op\_show\_msg').html(''); |
  | 986 |  | jQuery('.op\_show\_msg').css("display", "none"); |
  | 987 |  | }, 5000); |
  | 988 |  | } |
  | 989 |  | ); |
  | 990 |  | } |
  |  | 915 | // function oliver\_pos\_remove\_amelia() { |
  |  | 916 | //     oliver\_pos\_startLoader(); |
  |  | 917 | //     jQuery.post(JQueryAjaxUrl ,{ |
  |  | 918 | //             'action'    : 'oliver\_pos\_remove\_amelia', |
  |  | 919 | //             'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  |  | 920 | //         }, |
  |  | 921 | //         function( response ){ |
  |  | 922 | //             oliver\_pos\_stopLoader(); |
  |  | 923 | //             let op\_response = JSON.parse(response); |
  |  | 924 | //             jQuery('.op\_show\_msg').css("display", "block"); |
  |  | 925 | //             if(op\_response.status=='done'){ |
  |  | 926 | //                 jQuery(".op\_show\_msg").addClass("op\_success-message"); |
  |  | 927 | //                 jQuery(".op\_show\_msg").text(op\_response.Message); |
  |  | 928 | //                 jQuery(".op-enable-amelia").css("display", "block"); |
  |  | 929 | //                 jQuery("#op-enable-amelia").removeClass("op\_disable"); |
  |  | 930 | //                 jQuery(".op-disable-amelia").css("display", "none"); |
  |  | 931 | //             } |
  |  | 932 | //             else{ |
  |  | 933 | //                 jQuery(".op\_show\_msg").addClass("op\_error-message"); |
  |  | 934 | //                 jQuery(".op\_show\_msg").html("<strong>Error Amelia Disable:</strong> There is an error occurent while disabling the Amelia settings, please try again later or contact to support for <a target='\_blank' href='support link'>help</a>"); |
  |  | 935 | //             } |
  |  | 936 | //             setTimeout(function(){ |
  |  | 937 | //                 jQuery('.op\_show\_msg').html(''); |
  |  | 938 | //                 jQuery('.op\_show\_msg').css("display", "none"); |
  |  | 939 | //             }, 5000); |
  |  | 940 | //         } |
  |  | 941 | //     ); |
  |  | 942 | // } |
  | 991 | 943 | function oliver\_pos\_systemCheck() { |
  | 992 | 944 | console.log('system check'); |
  | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3016376#L995) | […](/browser/oliver-pos/trunk/includes/views/backend/create-subscription-new.php?rev=3035108#L947) |  |
  | 995 | 947 | jQuery.post(JQueryAjaxUrl ,{ |
  | 996 | 948 | 'action'    : 'oliver\_pos\_system\_check', |
  |  | 949 | 'security': "<?php echo wp\_create\_nonce( 'oliver-pos-nonce' ); ?>", |
  | 997 | 950 | }, |
  | 998 | 951 | function(op\_result){ |
* ## [oliver-pos/trunk/languages/oliver-pos.pot](/changeset/3035108/oliver-pos/trunk/languages/oliver-pos.pot "Show the changeset 3035108 restricted to oliver-pos/trunk/languages/oliver-pos.pot")

  | [r2206749](/browser/oliver-pos/trunk/languages/oliver-pos.pot?rev=2206749#L1 "Show revision 2206749 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/languages/oliver-pos.pot?rev=3035108#L1 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 | #, fuzzy |
  | 1 | 2 | msgid "" |
  | 2 | 3 | msgstr "" |
  | 3 | 4 | "Project-Id-Version: \n" |
  | 4 |  | "POT-Creation-Date: 20~~19-11-26 11:12~~+0530\n" |
  |  | 5 | "POT-Creation-Date: 2023-11-23 15:23+0530\n" |
  | 5 | 6 | "PO-Revision-Date: 2019-11-26 11:12+0530\n" |
  | 6 | 7 | "Last-Translator: \n" |
  | […](/browser/oliver-pos/trunk/languages/oliver-pos.pot?rev=2206749#L10) | […](/browser/oliver-pos/trunk/languages/oliver-pos.pot?rev=3035108#L11) |  |
  | 10 | 11 | "Content-Type: text/plain; charset=UTF-8\n" |
  | 11 | 12 | "Content-Transfer-Encoding: 8bit\n" |
  | 12 |  | "X-Generator: Poedit 2.2.4\n" |
  |  | 13 | "Plural-Forms: nplurals=2; plural=(n != 1);\n" |
  |  | 14 | "X-Generator: Poedit 3.4.1\n" |
  | 13 | 15 | "X-Poedit-Basepath: ..\n" |
  | 14 |  | "Plural-Forms: nplurals=2; plural=(n != 1);\n" |
  | 15 |  | "X-Poedit-KeywordsList: \_\_;\_e;esc\_attr\_e\n" |
  |  | 16 | "X-Poedit-KeywordsList: \_\_;\_e;esc\_attr\_e;esc\_html\_e\n" |
  | 16 | 17 | "X-Poedit-SearchPath-0: .\n" |
  | 17 |  |  |
  | 18 |  | #: includes/class-pos-bridge.php:221 |
  |  | 18 | "X-Poedit-SearchPath-1: includes\n" |
  |  | 19 |  |
  |  | 20 | #: includes/class-pos-bridge-product.php:351 |
  |  | 21 | msgid "Visibility oliver pos :" |
  |  | 22 | msgstr "" |
  |  | 23 |  |
  |  | 24 | #: includes/class-pos-bridge-product.php:357 |
  |  | 25 | msgid "Edit" |
  |  | 26 | msgstr "" |
  |  | 27 |  |
  |  | 28 | #: includes/class-pos-bridge-product.php:365 |
  |  | 29 | msgid "OK" |
  |  | 30 | msgstr "" |
  |  | 31 |  |
  |  | 32 | #: includes/class-pos-bridge-product.php:366 |
  |  | 33 | #: includes/views/backend/create-subscription-new.php:401 |
  |  | 34 | msgid "Cancel" |
  |  | 35 | msgstr "" |
  |  | 36 |  |
  |  | 37 | #: includes/class-pos-bridge-product.php:406 |
  |  | 38 | #: includes/class-pos-bridge-product.php:445 |
  |  | 39 | msgid "( quantity )" |
  |  | 40 | msgstr "" |
  |  | 41 |  |
  |  | 42 | #: includes/class-pos-bridge.php:386 |
  | 19 | 43 | msgid "Cost (" |
  | 20 | 44 | msgstr "" |
  | 21 | 45 |  |
  | 22 |  | #: includes/class-pos-bridge.php:~~224~~ |
  |  | 46 | #: includes/class-pos-bridge.php:389 |
  | 23 | 47 | msgid "Enter Product Cost value here." |
  | 24 | 48 | msgstr "" |
  | 25 | 49 |  |
  | 26 |  | #: includes/class-pos-bridge.php:~~240~~ |
  |  | 50 | #: includes/class-pos-bridge.php:402 |
  | 27 | 51 | msgid "Barcode" |
  | 28 | 52 | msgstr "" |
  | 29 | 53 |  |
  | 30 |  | #: includes/class-pos-bridge.php:~~243~~ |
  |  | 54 | #: includes/class-pos-bridge.php:405 |
  | 31 | 55 | msgid "Scan the product's barcode." |
  | 32 | 56 | msgstr "" |
  | 33 | 57 |  |
  | 34 |  | #: includes/models/class-pos-bridge-product.php:~~337~~ |
  | 35 |  | #: includes/models/class-pos-bridge-product.php:~~338~~ |
  |  | 58 | #: includes/models/class-pos-bridge-product.php:440 |
  |  | 59 | #: includes/models/class-pos-bridge-product.php:441 |
  | 36 | 60 | msgid "Placeholder" |
  | 37 | 61 | msgstr "" |
  | 38 | 62 |  |
  | 39 |  | #: includes/models/class-pos-bridge-user.php:~~498~~ |
  |  | 63 | #: includes/models/class-pos-bridge-user.php:557 |
  | 40 | 64 | msgid "Invalid customer ID" |
  | 41 | 65 | msgstr "" |
  | 42 | 66 |  |
  | 43 |  | #: includes/models/class-pos-bridge-user.php:5~~05~~ |
  |  | 67 | #: includes/models/class-pos-bridge-user.php:564 |
  | 44 | 68 | msgid "Invalid customer" |
  | 45 | 69 | msgstr "" |
  | 46 | 70 |  |
  | 47 |  | #: includes/models/class-pos-bridge-user.php:5~~13~~ |
  |  | 71 | #: includes/models/class-pos-bridge-user.php:572 |
  | 48 | 72 | msgid "You do not have permission to read this customer" |
  | 49 | 73 | msgstr "" |
  | 50 | 74 |  |
  | 51 |  | #: includes/models/class-pos-bridge-user.php:5~~19~~ |
  |  | 75 | #: includes/models/class-pos-bridge-user.php:578 |
  | 52 | 76 | msgid "You do not have permission to edit this customer" |
  | 53 | 77 | msgstr "" |
  | 54 | 78 |  |
  | 55 |  | #: includes/models/class-pos-bridge-user.php:5~~25~~ |
  |  | 79 | #: includes/models/class-pos-bridge-user.php:584 |
  | 56 | 80 | msgid "You do not have permission to delete this customer" |
  | 57 | 81 | msgstr "" |
  | 58 | 82 |  |
  | 59 |  | #: includes/views/backend/create-subscription-new.php:65 |
  | 60 |  | msgid "Your shop is Connected!" |
  | 61 |  | msgstr "" |
  | 62 |  |  |
  | 63 |  | #: includes/views/backend/create-subscription-new.php:70 |
  | 64 |  | msgid "Launch Oliver POS" |
  | 65 |  | msgstr "" |
  | 66 |  |  |
  | 67 |  | #: includes/views/backend/create-subscription-new.php:83 |
  | 68 |  | msgid "Disconnect" |
  | 69 |  | msgstr "" |
  | 70 |  |  |
  | 71 |  | #: includes/views/backend/create-subscription-new.php:84 |
  | 72 |  | msgid "Powered by Oliver POS" |
  | 73 |  | msgstr "" |
  | 74 |  |  |
  | 75 |  | #: includes/views/backend/create-subscription-new.php:91 |
  | 76 |  | msgid "Disconnect Bridge" |
  | 77 |  | msgstr "" |
  | 78 |  |  |
  | 79 |  | #: includes/views/backend/create-subscription-new.php:92 |
  | 80 |  | msgid "Are you sure want to disconnect bridge?" |
  | 81 |  | msgstr "" |
  | 82 |  |  |
  | 83 |  | #: includes/views/backend/create-subscription-new.php:94 |
  | 84 |  | msgid "Yes" |
  |  | 83 | #: includes/views/backend/create-subscription-new.php:59 |
  |  | 84 | #: includes/views/backend/create-subscription-new.php:322 |
  |  | 85 | msgid "Try Again" |
  |  | 86 | msgstr "" |
  |  | 87 |  |
  |  | 88 | #: includes/views/backend/create-subscription-new.php:68 |
  |  | 89 | #: includes/views/backend/create-subscription-new.php:90 |
  |  | 90 | msgid "Time to" |
  |  | 91 | msgstr "" |
  |  | 92 |  |
  |  | 93 | #: includes/views/backend/create-subscription-new.php:68 |
  |  | 94 | #: includes/views/backend/create-subscription-new.php:90 |
  |  | 95 | msgid "sync" |
  |  | 96 | msgstr "" |
  |  | 97 |  |
  |  | 98 | #: includes/views/backend/create-subscription-new.php:68 |
  |  | 99 | #: includes/views/backend/create-subscription-new.php:90 |
  |  | 100 | msgid "your WooCommerce store" |
  |  | 101 | msgstr "" |
  |  | 102 |  |
  |  | 103 | #: includes/views/backend/create-subscription-new.php:72 |
  |  | 104 | msgid "Ready to start syncing?" |
  |  | 105 | msgstr "" |
  |  | 106 |  |
  |  | 107 | #: includes/views/backend/create-subscription-new.php:73 |
  |  | 108 | msgid "Oliver relies on a two-way sync with customers, orders, and stock to bring your WooCommerce store in-store." |
  |  | 109 | msgstr "" |
  |  | 110 |  |
  |  | 111 | #: includes/views/backend/create-subscription-new.php:75 |
  |  | 112 | msgid "Start syncing" |
  | 85 | 113 | msgstr "" |
  | 86 | 114 |  |
  | 87 | 115 | #: includes/views/backend/create-subscription-new.php:95 |
  | 88 |  | msgid "No" |
  | 89 |  | msgstr "" |
  | 90 |  |  |
  | 91 |  | #: includes/views/backend/create-subscription-new.php:97 |
  | 92 |  | msgid "Close" |
  | 93 |  | msgstr "" |
  | 94 |  |  |
  | 95 |  | #: oliver-pos.php:62 |
  |  | 116 | msgid "Just a moment while we sync" |
  |  | 117 | msgstr "" |
  |  | 118 |  |
  |  | 119 | #: includes/views/backend/create-subscription-new.php:107 |
  |  | 120 | msgid "Welcome" |
  |  | 121 | msgstr "" |
  |  | 122 |  |
  |  | 123 | #: includes/views/backend/create-subscription-new.php:107 |
  |  | 124 | msgid "home" |
  |  | 125 | msgstr "" |
  |  | 126 |  |
  |  | 127 | #: includes/views/backend/create-subscription-new.php:113 |
  |  | 128 | msgid "The Oliver HUB" |
  |  | 129 | msgstr "" |
  |  | 130 |  |
  |  | 131 | #: includes/views/backend/create-subscription-new.php:114 |
  |  | 132 | msgid "Resync your WooCommerce store, access reports & configure your Oliver products with Oliver Hub." |
  |  | 133 | msgstr "" |
  |  | 134 |  |
  |  | 135 | #: includes/views/backend/create-subscription-new.php:119 |
  |  | 136 | msgid "Open Hub" |
  |  | 137 | msgstr "" |
  |  | 138 |  |
  |  | 139 | #: includes/views/backend/create-subscription-new.php:124 |
  |  | 140 | msgid "The Oliver Register" |
  |  | 141 | msgstr "" |
  |  | 142 |  |
  |  | 143 | #: includes/views/backend/create-subscription-new.php:125 |
  |  | 144 | msgid "Start selling with our uncluttered and intuitive WooCommerce POS register." |
  |  | 145 | msgstr "" |
  |  | 146 |  |
  |  | 147 | #: includes/views/backend/create-subscription-new.php:130 |
  |  | 148 | msgid "Open Register" |
  |  | 149 | msgstr "" |
  |  | 150 |  |
  |  | 151 | #: includes/views/backend/create-subscription-new.php:139 |
  |  | 152 | msgid "System" |
  |  | 153 | msgstr "" |
  |  | 154 |  |
  |  | 155 | #: includes/views/backend/create-subscription-new.php:139 |
  |  | 156 | msgid "Check" |
  |  | 157 | msgstr "" |
  |  | 158 |  |
  |  | 159 | #: includes/views/backend/create-subscription-new.php:141 |
  |  | 160 | msgid "Refresh" |
  |  | 161 | msgstr "" |
  |  | 162 |  |
  |  | 163 | #: includes/views/backend/create-subscription-new.php:150 |
  |  | 164 | msgid "Good news!" |
  |  | 165 | msgstr "" |
  |  | 166 |  |
  |  | 167 | #: includes/views/backend/create-subscription-new.php:150 |
  |  | 168 | msgid "No issues found." |
  |  | 169 | msgstr "" |
  |  | 170 |  |
  |  | 171 | #: includes/views/backend/create-subscription-new.php:160 |
  |  | 172 | msgid "Error: Outdated SSL Certification" |
  |  | 173 | msgstr "" |
  |  | 174 |  |
  |  | 175 | #: includes/views/backend/create-subscription-new.php:162 |
  |  | 176 | msgid "Learn More" |
  |  | 177 | msgstr "" |
  |  | 178 |  |
  |  | 179 | #: includes/views/backend/create-subscription-new.php:171 |
  |  | 180 | msgid "Error: Permalinks Not Set" |
  |  | 181 | msgstr "" |
  |  | 182 |  |
  |  | 183 | #: includes/views/backend/create-subscription-new.php:173 |
  |  | 184 | msgid "Fix Now" |
  |  | 185 | msgstr "" |
  |  | 186 |  |
  |  | 187 | #: includes/views/backend/create-subscription-new.php:183 |
  |  | 188 | msgid "Connection Issue" |
  |  | 189 | msgstr "" |
  |  | 190 |  |
  |  | 191 | #: includes/views/backend/create-subscription-new.php:185 |
  |  | 192 | msgid "Looks like something is blocking us!" |
  |  | 193 | msgstr "" |
  |  | 194 |  |
  |  | 195 | #: includes/views/backend/create-subscription-new.php:186 |
  |  | 196 | msgid "" |
  |  | 197 | "This can be because you are on a local host environment or your hosting provider is blocking us. Please contact host to allow\n" |
  |  | 198 | "                        the ip below." |
  |  | 199 | msgstr "" |
  |  | 200 |  |
  |  | 201 | #: includes/views/backend/create-subscription-new.php:187 |
  |  | 202 | msgid "Oliver IP: 168.648.48.48" |
  |  | 203 | msgstr "" |
  |  | 204 |  |
  |  | 205 | #: includes/views/backend/create-subscription-new.php:188 |
  |  | 206 | #: includes/views/backend/create-subscription-new.php:228 |
  |  | 207 | msgid "Get a free migration offer" |
  |  | 208 | msgstr "" |
  |  | 209 |  |
  |  | 210 | #: includes/views/backend/create-subscription-new.php:190 |
  |  | 211 | msgid "Learn more" |
  |  | 212 | msgstr "" |
  |  | 213 |  |
  |  | 214 | #: includes/views/backend/create-subscription-new.php:200 |
  |  | 215 | msgid "Potential Issue:  Plugin" |
  |  | 216 | msgstr "" |
  |  | 217 |  |
  |  | 218 | #: includes/views/backend/create-subscription-new.php:202 |
  |  | 219 | msgid "It looks like you have " |
  |  | 220 | msgstr "" |
  |  | 221 |  |
  |  | 222 | #: includes/views/backend/create-subscription-new.php:202 |
  |  | 223 | msgid "Plugin name" |
  |  | 224 | msgstr "" |
  |  | 225 |  |
  |  | 226 | #: includes/views/backend/create-subscription-new.php:202 |
  |  | 227 | msgid " installed!" |
  |  | 228 | msgstr "" |
  |  | 229 |  |
  |  | 230 | #: includes/views/backend/create-subscription-new.php:203 |
  |  | 231 | msgid "This can potentially cause issues. For the best experience it is advised to deactivate while using Oliver." |
  |  | 232 | msgstr "" |
  |  | 233 |  |
  |  | 234 | #: includes/views/backend/create-subscription-new.php:204 |
  |  | 235 | msgid "If you are just trying Oliver out you can get a free test environment" |
  |  | 236 | msgstr "" |
  |  | 237 |  |
  |  | 238 | #: includes/views/backend/create-subscription-new.php:204 |
  |  | 239 | #: includes/views/backend/create-subscription-new.php:318 |
  |  | 240 | #: includes/views/backend/create-subscription-new.php:319 |
  |  | 241 | msgid "here" |
  |  | 242 | msgstr "" |
  |  | 243 |  |
  |  | 244 | #: includes/views/backend/create-subscription-new.php:218 |
  |  | 245 | msgid "Optimization: Slow server response detected!" |
  |  | 246 | msgstr "" |
  |  | 247 |  |
  |  | 248 | #: includes/views/backend/create-subscription-new.php:220 |
  |  | 249 | msgid "Your server took more than" |
  |  | 250 | msgstr "" |
  |  | 251 |  |
  |  | 252 | #: includes/views/backend/create-subscription-new.php:220 |
  |  | 253 | msgid "500ms" |
  |  | 254 | msgstr "" |
  |  | 255 |  |
  |  | 256 | #: includes/views/backend/create-subscription-new.php:220 |
  |  | 257 | msgid "to respond!" |
  |  | 258 | msgstr "" |
  |  | 259 |  |
  |  | 260 | #: includes/views/backend/create-subscription-new.php:221 |
  |  | 261 | msgid "Get a professional migration from our server partner Nexcess" |
  |  | 262 | msgstr "" |
  |  | 263 |  |
  |  | 264 | #: includes/views/backend/create-subscription-new.php:222 |
  |  | 265 | #: includes/views/backend/create-subscription-new.php:244 |
  |  | 266 | msgid "14 day money-back guarantee" |
  |  | 267 | msgstr "" |
  |  | 268 |  |
  |  | 269 | #: includes/views/backend/create-subscription-new.php:240 |
  |  | 270 | msgid "Optimization: Very slow site speed detected!" |
  |  | 271 | msgstr "" |
  |  | 272 |  |
  |  | 273 | #: includes/views/backend/create-subscription-new.php:242 |
  |  | 274 | msgid "Did you know that" |
  |  | 275 | msgstr "" |
  |  | 276 |  |
  |  | 277 | #: includes/views/backend/create-subscription-new.php:242 |
  |  | 278 | msgid "one" |
  |  | 279 | msgstr "" |
  |  | 280 |  |
  |  | 281 | #: includes/views/backend/create-subscription-new.php:242 |
  |  | 282 | msgid "second delay cost you on average" |
  |  | 283 | msgstr "" |
  |  | 284 |  |
  |  | 285 | #: includes/views/backend/create-subscription-new.php:242 |
  |  | 286 | msgid "$70 pr. day?" |
  |  | 287 | msgstr "" |
  |  | 288 |  |
  |  | 289 | #: includes/views/backend/create-subscription-new.php:243 |
  |  | 290 | msgid "Optimize your site in minutes with our partner Nitro pack." |
  |  | 291 | msgstr "" |
  |  | 292 |  |
  |  | 293 | #: includes/views/backend/create-subscription-new.php:250 |
  |  | 294 | msgid "Optimize site" |
  |  | 295 | msgstr "" |
  |  | 296 |  |
  |  | 297 | #: includes/views/backend/create-subscription-new.php:258 |
  |  | 298 | msgid "Need" |
  |  | 299 | msgstr "" |
  |  | 300 |  |
  |  | 301 | #: includes/views/backend/create-subscription-new.php:258 |
  |  | 302 | msgid "help?" |
  |  | 303 | msgstr "" |
  |  | 304 |  |
  |  | 305 | #: includes/views/backend/create-subscription-new.php:264 |
  |  | 306 | msgid "Contact" |
  |  | 307 | msgstr "" |
  |  | 308 |  |
  |  | 309 | #: includes/views/backend/create-subscription-new.php:264 |
  |  | 310 | msgid "Us" |
  |  | 311 | msgstr "" |
  |  | 312 |  |
  |  | 313 | #: includes/views/backend/create-subscription-new.php:267 |
  |  | 314 | msgid "WooCommerce & POS Experts" |
  |  | 315 | msgstr "" |
  |  | 316 |  |
  |  | 317 | #: includes/views/backend/create-subscription-new.php:271 |
  |  | 318 | #, no-php-format |
  |  | 319 | msgid "Works with 99% of WC stores" |
  |  | 320 | msgstr "" |
  |  | 321 |  |
  |  | 322 | #: includes/views/backend/create-subscription-new.php:274 |
  |  | 323 | msgid "Visit our support center" |
  |  | 324 | msgstr "" |
  |  | 325 |  |
  |  | 326 | #: includes/views/backend/create-subscription-new.php:287 |
  |  | 327 | msgid "Let's get you ready to sell." |
  |  | 328 | msgstr "" |
  |  | 329 |  |
  |  | 330 | #: includes/views/backend/create-subscription-new.php:288 |
  |  | 331 | msgid "First thing's first. You'll need to create an account to get started with Oliver." |
  |  | 332 | msgstr "" |
  |  | 333 |  |
  |  | 334 | #: includes/views/backend/create-subscription-new.php:290 |
  |  | 335 | msgid "Create an Account" |
  |  | 336 | msgstr "" |
  |  | 337 |  |
  |  | 338 | #: includes/views/backend/create-subscription-new.php:300 |
  |  | 339 | #: includes/views/backend/create-subscription-new.php:315 |
  |  | 340 | msgid "Already got a subscription?" |
  |  | 341 | msgstr "" |
  |  | 342 |  |
  |  | 343 | #: includes/views/backend/create-subscription-new.php:302 |
  |  | 344 | msgid "Subscription Key" |
  |  | 345 | msgstr "" |
  |  | 346 |  |
  |  | 347 | #: includes/views/backend/create-subscription-new.php:303 |
  |  | 348 | msgid "Enter your subscription key here" |
  |  | 349 | msgstr "" |
  |  | 350 |  |
  |  | 351 | #: includes/views/backend/create-subscription-new.php:304 |
  |  | 352 | msgid "Connect Site" |
  |  | 353 | msgstr "" |
  |  | 354 |  |
  |  | 355 | #: includes/views/backend/create-subscription-new.php:308 |
  |  | 356 | msgid "Where to find your subscription key?" |
  |  | 357 | msgstr "" |
  |  | 358 |  |
  |  | 359 | #: includes/views/backend/create-subscription-new.php:309 |
  |  | 360 | msgid "You will receive your subscription key once you sign up for Oliver. Contact us if you've lost it." |
  |  | 361 | msgstr "" |
  |  | 362 |  |
  |  | 363 | #: includes/views/backend/create-subscription-new.php:310 |
  |  | 364 | msgid "If you signed up with an Oliver Expert, contact them to get started." |
  |  | 365 | msgstr "" |
  |  | 366 |  |
  |  | 367 | #: includes/views/backend/create-subscription-new.php:317 |
  |  | 368 | msgid "Subscription ID is already in use." |
  |  | 369 | msgstr "" |
  |  | 370 |  |
  |  | 371 | #: includes/views/backend/create-subscription-new.php:318 |
  |  | 372 | msgid "Please make sure that you have used the right subscription ID. You can view your subscription ID and connected domain by going to my account" |
  |  | 373 | msgstr "" |
  |  | 374 |  |
  |  | 375 | #: includes/views/backend/create-subscription-new.php:319 |
  |  | 376 | msgid "If you are still having issues please contact us by clicking" |
  |  | 377 | msgstr "" |
  |  | 378 |  |
  |  | 379 | #: includes/views/backend/create-subscription-new.php:320 |
  |  | 380 | msgid "If a partner has signed you up please contact them in order to get your key." |
  |  | 381 | msgstr "" |
  |  | 382 |  |
  |  | 383 | #: includes/views/backend/create-subscription-new.php:336 |
  |  | 384 | msgid "Subscription expired." |
  |  | 385 | msgstr "" |
  |  | 386 |  |
  |  | 387 | #: includes/views/backend/create-subscription-new.php:338 |
  |  | 388 | msgid "Click here to renew" |
  |  | 389 | msgstr "" |
  |  | 390 |  |
  |  | 391 | #: includes/views/backend/create-subscription-new.php:350 |
  |  | 392 | msgid "Support you can count on" |
  |  | 393 | msgstr "" |
  |  | 394 |  |
  |  | 395 | #: includes/views/backend/create-subscription-new.php:351 |
  |  | 396 | msgid "With Oliver, you're in good hands" |
  |  | 397 | msgstr "" |
  |  | 398 |  |
  |  | 399 | #: includes/views/backend/create-subscription-new.php:361 |
  |  | 400 | msgid "Talk to an Oliver support agent" |
  |  | 401 | msgstr "" |
  |  | 402 |  |
  |  | 403 | #: includes/views/backend/create-subscription-new.php:362 |
  |  | 404 | msgid "The Oliver support team is available 24/7 and offers free onboarding and demo calls." |
  |  | 405 | msgstr "" |
  |  | 406 |  |
  |  | 407 | #: includes/views/backend/create-subscription-new.php:363 |
  |  | 408 | msgid "Contact support" |
  |  | 409 | msgstr "" |
  |  | 410 |  |
  |  | 411 | #: includes/views/backend/create-subscription-new.php:370 |
  |  | 412 | msgid "Check out our Knowledge Base" |
  |  | 413 | msgstr "" |
  |  | 414 |  |
  |  | 415 | #: includes/views/backend/create-subscription-new.php:371 |
  |  | 416 | msgid "Don't feel like waiting? Read our knowledge base to see if your question has been answered already." |
  |  | 417 | msgstr "" |
  |  | 418 |  |
  |  | 419 | #: includes/views/backend/create-subscription-new.php:372 |
  |  | 420 | msgid "Knowledge Base" |
  |  | 421 | msgstr "" |
  |  | 422 |  |
  |  | 423 | #: includes/views/backend/create-subscription-new.php:382 |
  |  | 424 | msgid "Disconnect Site:" |
  |  | 425 | msgstr "" |
  |  | 426 |  |
  |  | 427 | #: includes/views/backend/create-subscription-new.php:382 |
  |  | 428 | msgid "This will disconnect the site from your Oliver Subscription" |
  |  | 429 | msgstr "" |
  |  | 430 |  |
  |  | 431 | #: includes/views/backend/create-subscription-new.php:384 |
  |  | 432 | msgid "Disconnect Site" |
  |  | 433 | msgstr "" |
  |  | 434 |  |
  |  | 435 | #: includes/views/backend/create-subscription-new.php:395 |
  |  | 436 | msgid "Delete Subscription" |
  |  | 437 | msgstr "" |
  |  | 438 |  |
  |  | 439 | #: includes/views/backend/create-subscription-new.php:399 |
  |  | 440 | msgid "Are you sure that you want to delete your Subscription?" |
  |  | 441 | msgstr "" |
  |  | 442 |  |
  |  | 443 | #: includes/views/backend/create-subscription-new.php:402 |
  |  | 444 | msgid "Delete" |
  |  | 445 | msgstr "" |
  |  | 446 |  |
  |  | 447 | #: includes/views/backend/create-subscription-new.php:412 |
  |  | 448 | msgid "Subscription Deleted" |
  |  | 449 | msgstr "" |
  |  | 450 |  |
  |  | 451 | #: includes/views/backend/create-subscription-new.php:420 |
  |  | 452 | msgid "Your subscription has been deleted successfully" |
  |  | 453 | msgstr "" |
  |  | 454 |  |
  |  | 455 | #: includes/views/backend/create-subscription-new.php:423 |
  |  | 456 | #: includes/views/backend/create-subscription-new.php:443 |
  |  | 457 | msgid "Go Back" |
  |  | 458 | msgstr "" |
  |  | 459 |  |
  |  | 460 | #: includes/views/backend/create-subscription-new.php:437 |
  |  | 461 | msgid "Oh no!" |
  |  | 462 | msgstr "" |
  |  | 463 |  |
  |  | 464 | #: includes/views/backend/create-subscription-new.php:439 |
  |  | 465 | msgid "Olivers immunity system have found an issue" |
  |  | 466 | msgstr "" |
  |  | 467 |  |
  |  | 468 | #: includes/views/backend/create-subscription-new.php:440 |
  |  | 469 | msgid "Please fix the system check issues before continuing" |
  |  | 470 | msgstr "" |
  |  | 471 |  |
  |  | 472 | #: includes/views/backend/create-subscription-new.php:445 |
  |  | 473 | msgid "Contact us." |
  |  | 474 | msgstr "" |
  |  | 475 |  |
  |  | 476 | #: includes/views/backend/create-subscription-new.php:455 |
  |  | 477 | msgid "System Check" |
  |  | 478 | msgstr "" |
  |  | 479 |  |
  |  | 480 | #: includes/views/backend/create-subscription-new.php:460 |
  |  | 481 | msgid "Please fix all the red errors before proceeding with syncronization" |
  |  | 482 | msgstr "" |
  |  | 483 |  |
  |  | 484 | #: oliver-pos.php:60 |
  | 96 | 485 | msgid "Variation Product Cost (" |
  | 97 | 486 | msgstr "" |
  | 98 | 487 |  |
  | 99 |  | #: oliver-pos.php:6~~5~~ |
  |  | 488 | #: oliver-pos.php:63 |
  | 100 | 489 | msgid "Enter Variation Product Cost value here." |
  | 101 | 490 | msgstr "" |
  | 102 | 491 |  |
  | 103 |  | #: oliver-pos.php:7~~3~~ |
  |  | 492 | #: oliver-pos.php:71 |
  | 104 | 493 | msgid "Variation Product Barcode (" |
  | 105 | 494 | msgstr "" |
  | 106 | 495 |  |
  | 107 |  | #: oliver-pos.php:7~~6~~ |
  |  | 496 | #: oliver-pos.php:74 |
  | 108 | 497 | msgid "Enter Variation Product Barcode value here." |
  | 109 | 498 | msgstr "" |
  | 110 | 499 |  |
  | 111 |  | #: oliver-pos.php:~~216~~ |
  |  | 500 | #: oliver-pos.php:199 |
  | 112 | 501 | msgid "Ok, you deserved it" |
  | 113 | 502 | msgstr "" |
  | 114 | 503 |  |
  | 115 |  | #: oliver-pos.php:2~~17~~ |
  |  | 504 | #: oliver-pos.php:200 |
  | 116 | 505 | msgid "I already did" |
  | 117 | 506 | msgstr "" |
  | 118 | 507 |  |
  | 119 |  | #: oliver-pos.php:2~~18~~ |
  |  | 508 | #: oliver-pos.php:201 |
  | 120 | 509 | msgid "No, not good enough, i do not like to rate it!" |
  | 121 | 510 | msgstr "" |
  | 122 | 511 |  |
  | 123 |  | #: oliver-pos.php:2~~77~~ |
  |  | 512 | #: oliver-pos.php:260 |
  | 124 | 513 | msgid "<strong>OliverPOS Receipt #</strong>" |
  | 125 | 514 | msgstr "" |
  |  | 515 |  |
  |  | 516 | #: woocommerce/global/quantity-input.php:41 |
  |  | 517 | msgid "Quantity" |
  |  | 518 | msgstr "" |
  |  | 519 |  |
  |  | 520 | #: woocommerce/single-product/add-to-cart/booking.php:32 |
  |  | 521 | msgid "Your browser must support JavaScript in order to make a booking." |
  |  | 522 | msgstr "" |
  |  | 523 |  |
  |  | 524 | #: woocommerce/single-product/add-to-cart/variable.php:30 |
  |  | 525 | msgid "This product is currently out of stock and unavailable." |
  |  | 526 | msgstr "" |
  |  | 527 |  |
  |  | 528 | #: woocommerce/single-product/bundled-item-image.php:42 |
  |  | 529 | msgid "Bundled product placeholder image" |
  |  | 530 | msgstr "" |
  |  | 531 |  |
  |  | 532 | #: woocommerce/single-product/bundled-item-title.php:26 |
  |  | 533 | msgid "optional" |
  |  | 534 | msgstr "" |
  |  | 535 |  |
  |  | 536 | #: woocommerce/single-product/bundled-item-title.php:28 |
  |  | 537 | msgid "View product" |
  |  | 538 | msgstr "" |
* ## [oliver-pos/trunk/oliver-pos.php](/changeset/3035108/oliver-pos/trunk/oliver-pos.php "Show the changeset 3035108 restricted to oliver-pos/trunk/oliver-pos.php")

  | [r3016376](/browser/oliver-pos/trunk/oliver-pos.php?rev=3016376#L3 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/oliver-pos.php?rev=3035108#L3 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* Plugin Name:             Oliver POS - A WooCommerce Point of Sale (POS) |
  | 4 | 4 | \* Description:             Oliver POS is a WooCommerce Point of Sale (POS) integrated into your shop. Always insync with your e-commerce shop, Oliver POS lets you sell in-store. |
  | 5 |  | \* Version:                 2.4.1.~~8~~ |
  |  | 5 | \* Version:                 2.4.1.9 |
  | 6 | 6 | \* Author:                  Oliver POS |
  | 7 | 7 | \* Author URI:              https://oliverpos.com/ |
  | […](/browser/oliver-pos/trunk/oliver-pos.php?rev=3016376#L550) | […](/browser/oliver-pos/trunk/oliver-pos.php?rev=3035108#L550) |  |
  | 550 | 550 | return( array('message' => $msg, 'status' => $status) ); |
  | 551 | 551 | } |
  |  | 552 | //Comment Amelia from 2.4.1.9 |
  | 552 | 553 | //Since 2.4.1.8 start amelia |
  | 553 | 554 | // include page template for oliver amelia |
  | 554 |  | add\_filter( 'page\_template', 'oliver\_pos\_amelia\_include\_page\_template' ); |
  | 555 |  | function oliver\_pos\_amelia\_include\_page\_template( $page\_template ) |
  | 556 |  | { |
  | 557 |  | if ( is\_page( 'Oliver Amelia' ) ) { |
  | 558 |  | $page\_template = dirname( \_\_FILE\_\_ ) . '/templates/oliver-amelia-iframe.php'; |
  | 559 |  | } |
  | 560 |  | if ( is\_page( 'Oliver Amelia Settings' ) ) { |
  | 561 |  | $page\_template = dirname( \_\_FILE\_\_ ) . '/templates/amelia-setting.php'; |
  | 562 |  | } |
  | 563 |  | if ( is\_page( 'Oliver Amelia pages' ) ) { |
  | 564 |  | $page\_template = dirname( \_\_FILE\_\_ ) . '/templates/amelia-login.php'; |
  | 565 |  | } |
  | 566 |  | return $page\_template; |
  | 567 |  | } |
  | 568 |  |  |
  | 569 |  | add\_action( 'init', 'oliver\_pos\_prevent\_admin\_dashboard\_from\_iframe' ); |
  | 570 |  | function oliver\_pos\_prevent\_admin\_dashboard\_from\_iframe() { |
  | 571 |  |  |
  | 572 |  | if ( is\_plugin\_active( 'ameliabooking/ameliabooking.php' ) ){ |
  | 573 |  | //Logout if someone come after autologin |
  | 574 |  | $all\_headers = getallheaders(); |
  | 575 |  | if(@$all\_headers['Sec-Fetch-Dest'] == "document"){ |
  | 576 |  | $login = get\_option('oliver\_auto\_login'); |
  | 577 |  | //Logout after autologin try to open admin dashboard |
  | 578 |  | if(!empty($login) && isset( $\_COOKIE['show\_amelia\_only'] )){ |
  | 579 |  | update\_option('oliver\_auto\_login', false); |
  | 580 |  | wp\_destroy\_current\_session(); |
  | 581 |  | wp\_clear\_auth\_cookie(); |
  | 582 |  | } |
  | 583 |  | } |
  | 584 |  | //Prevent, If someone put custome url in iframe |
  | 585 |  | if(@$all\_headers['Sec-Fetch-Dest'] == "iframe"){ |
  | 586 |  | //Check open front end pages in iframe |
  | 587 |  | if ( strpos($\_SERVER['HTTP\_REFERER'], get\_admin\_url()) === false ) { |
  | 588 |  | //get page name |
  | 589 |  | $page = $\_SERVER['QUERY\_STRING']; |
  | 590 |  | if(!empty($page)){ |
  | 591 |  | //get amelia pages slug |
  | 592 |  | $result = explode ("&", $page); |
  | 593 |  | $pages =array(); |
  | 594 |  | $pages[]='page=wpamelia-dashboard'; |
  | 595 |  | $pages[]='page=wpamelia-calendar'; |
  | 596 |  | $pages[]='page=wpamelia-appointments'; |
  | 597 |  | $pages[]='page=wpamelia-events'; |
  | 598 |  | $pages[]='page=wpamelia-employees'; |
  | 599 |  | $pages[]='page=wpamelia-services'; |
  | 600 |  | $pages[]='page=wpamelia-locations'; |
  | 601 |  | $pages[]='page=wpamelia-customers'; |
  | 602 |  | $pages[]='page=wpamelia-finance'; |
  | 603 |  | $pages[]='page=wpamelia-notifications'; |
  | 604 |  | $pages[]='page=wpamelia-customize'; |
  | 605 |  | $pages[]='page=wpamelia-cf'; |
  | 606 |  | $pages[]='page=wpamelia-settings'; |
  | 607 |  |  |
  | 608 |  | if ( in\_array( $result[0], $pages ) ) { |
  | 609 |  | if(isset( $\_COOKIE['show\_amelia\_only'] )){ ?> |
  | 610 |  | <style> |
  | 611 |  | #adminmenumain, #wpadminbar{ |
  | 612 |  | display: none; |
  | 613 |  | } |
  | 614 |  | .notice, .updated, .toplevel\_page\_oliver-pos .notice-error, .error, .is-dismissible{ |
  | 615 |  | display: none !important; |
  | 616 |  | } |
  | 617 |  | #wpcontent, #wpfooter { |
  | 618 |  | margin-left: 0px !important; |
  | 619 |  | } |
  | 620 |  | </style> |
  | 621 |  | <?php |
  | 622 |  | } |
  | 623 |  | } |
  | 624 |  | else{ |
  | 625 |  | wp\_destroy\_current\_session(); |
  | 626 |  | wp\_clear\_auth\_cookie(); |
  | 627 |  | } |
  | 628 |  | } |
  | 629 |  | else{ |
  | 630 |  | wp\_destroy\_current\_session(); |
  | 631 |  | wp\_clear\_auth\_cookie(); |
  | 632 |  |  |
  | 633 |  | } |
  | 634 |  | } |
  | 635 |  | } |
  | 636 |  | } |
  | 637 |  | } |
  |  | 555 | // add\_filter( 'page\_template', 'oliver\_pos\_amelia\_include\_page\_template' ); |
  |  | 556 | // function oliver\_pos\_amelia\_include\_page\_template( $page\_template ) |
  |  | 557 | // { |
  |  | 558 | //     if ( is\_page( 'Oliver Amelia' ) ) { |
  |  | 559 | //         $page\_template = dirname( \_\_FILE\_\_ ) . '/templates/oliver-amelia-iframe.php'; |
  |  | 560 | //     } |
  |  | 561 | //     if ( is\_page( 'Oliver Amelia Settings' ) ) { |
  |  | 562 | //         $page\_template = dirname( \_\_FILE\_\_ ) . '/templates/amelia-setting.php'; |
  |  | 563 | //     } |
  |  | 564 | //     if ( is\_page( 'Oliver Amelia pages' ) ) { |
  |  | 565 | //         $page\_template = dirname( \_\_FILE\_\_ ) . '/templates/amelia-login.php'; |
  |  | 566 | //     } |
  |  | 567 | //     return $page\_template; |
  |  | 568 | // } |
  |  | 569 |  |
  |  | 570 | //Comment Amelia from 2.4.1.9 |
  |  | 571 | // add\_action( 'init', 'oliver\_pos\_prevent\_admin\_dashboard\_from\_iframe' ); |
  |  | 572 | // function oliver\_pos\_prevent\_admin\_dashboard\_from\_iframe() { |
  |  | 573 |  |
  |  | 574 | //     if ( is\_plugin\_active( 'ameliabooking/ameliabooking.php' ) ){ |
  |  | 575 | //         //Logout if someone come after autologin |
  |  | 576 | //         $all\_headers = getallheaders(); |
  |  | 577 | //         if(@$all\_headers['Sec-Fetch-Dest'] == "document"){ |
  |  | 578 | //             $login = get\_option('oliver\_auto\_login'); |
  |  | 579 | //             //Logout after autologin try to open admin dashboard |
  |  | 580 | //             if(!empty($login) && isset( $\_COOKIE['show\_amelia\_only'] )){ |
  |  | 581 | //                 update\_option('oliver\_auto\_login', false); |
  |  | 582 | //                 wp\_destroy\_current\_session(); |
  |  | 583 | //                 wp\_clear\_auth\_cookie(); |
  |  | 584 | //             } |
  |  | 585 | //         } |
  |  | 586 | //         //Prevent, If someone put custome url in iframe |
  |  | 587 | //         if(@$all\_headers['Sec-Fetch-Dest'] == "iframe"){ |
  |  | 588 | //             //Check open front end pages in iframe |
  |  | 589 | //             if ( strpos($\_SERVER['HTTP\_REFERER'], get\_admin\_url()) === false ) { |
  |  | 590 | //                 //get page name |
  |  | 591 | //                 $page = $\_SERVER['QUERY\_STRING']; |
  |  | 592 | //                 if(!empty($page)){ |
  |  | 593 | //                     //get amelia pages slug |
  |  | 594 | //                     $result = explode ("&", $page); |
  |  | 595 | //                     $pages =array(); |
  |  | 596 | //                     $pages[]='page=wpamelia-dashboard'; |
  |  | 597 | //                     $pages[]='page=wpamelia-calendar'; |
  |  | 598 | //                     $pages[]='page=wpamelia-appointments'; |
  |  | 599 | //                     $pages[]='page=wpamelia-events'; |
  |  | 600 | //                     $pages[]='page=wpamelia-employees'; |
  |  | 601 | //                     $pages[]='page=wpamelia-services'; |
  |  | 602 | //                     $pages[]='page=wpamelia-locations'; |
  |  | 603 | //                     $pages[]='page=wpamelia-customers'; |
  |  | 604 | //                     $pages[]='page=wpamelia-finance'; |
  |  | 605 | //                     $pages[]='page=wpamelia-notifications'; |
  |  | 606 | //                     $pages[]='page=wpamelia-customize'; |
  |  | 607 | //                     $pages[]='page=wpamelia-cf'; |
  |  | 608 | //                     $pages[]='page=wpamelia-settings'; |
  |  | 609 |  |
  |  | 610 | //                     if ( in\_array( $result[0], $pages ) ) { |
  |  | 611 | //                         if(isset( $\_COOKIE['show\_amelia\_only'] )){ |
  |  | 612 | // |
  |  | 613 | //                         } |
  |  | 614 | //                     } |
  |  | 615 | //                     else{ |
  |  | 616 | //                         wp\_destroy\_current\_session(); |
  |  | 617 | //                         wp\_clear\_auth\_cookie(); |
  |  | 618 | //                     } |
  |  | 619 | //                 } |
  |  | 620 | //                 else{ |
  |  | 621 | //                     wp\_destroy\_current\_session(); |
  |  | 622 | //                     wp\_clear\_auth\_cookie(); |
  |  | 623 |  |
  |  | 624 | //                 } |
  |  | 625 | //             } |
  |  | 626 | //         } |
  |  | 627 | //     } |
  |  | 628 | // } |
  |  | 629 | //HPOS |
  | 638 | 630 | add\_action('before\_woocommerce\_init', function(){ |
  | 639 | 631 | if ( class\_exists( \Automattic\WooCommerce\Utilities\FeaturesUtil::class ) ) { |
* ## [oliver-pos/trunk/readme.txt](/changeset/3035108/oliver-pos/trunk/readme.txt "Show the changeset 3035108 restricted to oliver-pos/trunk/readme.txt")

  | [r3016376](/browser/oliver-pos/trunk/readme.txt?rev=3016376#L219 "Show revision 3016376 of this file in browser") | [r3035108](/browser/oliver-pos/trunk/readme.txt?rev=3035108#L219 "Show revision 3035108 of this file in browser") |  |
  | --- | --- | --- |
  | 219 | 219 |  |
  | 220 | 220 | == Changelog == |
  |  | 221 | = 2.4.1.9 - 2024-02-13 |
  |  | 222 | \* Tweak – Fixed security related issue |
  |  | 223 | \* Tweak – Remove beta amelia support |
  |  | 224 |  |
  | 221 | 225 | = 2.4.1.8 - 2024-01-02 |
  | 222 | 226 | \* Enhancement - Supporting HPOS |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3035108)
* [Zip Archive](?format=zip&new=3035108)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

