

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Maslowski <cyrevolt@googlemail.com> | 2024-07-19 19:04:37 +0200 |
| --- | --- | --- |
| committer | Palmer Dabbelt <palmer@rivosinc.com> | 2024-08-01 07:14:34 -0700 |
| commit | [fb197c5d2fd24b9af3d4697d0cf778645846d6d5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5)) | |
| tree | [bd44fd9ddd59cb0d9de2b693ca54911283247312](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5) | |
| parent | [b75a22e7d4f23dcd4f78ed2ff368a3d2a4556c0c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b75a22e7d4f23dcd4f78ed2ff368a3d2a4556c0c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5&id2=b75a22e7d4f23dcd4f78ed2ff368a3d2a4556c0c)) | |
| download | [linux-fb197c5d2fd24b9af3d4697d0cf778645846d6d5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fb197c5d2fd24b9af3d4697d0cf778645846d6d5.tar.gz) | |

riscv/purgatory: align riscv\_kernel\_entryWhen alignment handling is delegated to the kernel, everything must be
word-aligned in purgatory, since the trap handler is then set to the
kexec one. Without the alignment, hitting the exception would
ultimately crash. On other occasions, the kernel's handler would take
care of exceptions.
This has been tested on a JH7110 SoC with oreboot and its SBI delegating
unaligned access exceptions and the kernel configured to handle them.
Fixes: 736e30af583fb ("RISC-V: Add purgatory")
Signed-off-by: Daniel Maslowski <cyrevolt@gmail.com>
Reviewed-by: Alexandre Ghiti <alexghiti@rivosinc.com>
Link: [https://lore.kernel.org/r/20240719170437.247457-1-cyrevolt@gmail.com](https://lore.kernel.org/r/20240719170437.247457-1-cyrevolt%40gmail.com)
Signed-off-by: Palmer Dabbelt <palmer@rivosinc.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5)

| -rw-r--r-- | [arch/riscv/purgatory/entry.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/riscv/purgatory/entry.S?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 0 deletions

| diff --git a/arch/riscv/purgatory/entry.S b/arch/riscv/purgatory/entry.Sindex 5bcf3af903daa2..0e6ca6d5ae4b41 100644--- a/[arch/riscv/purgatory/entry.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/riscv/purgatory/entry.S?id=b75a22e7d4f23dcd4f78ed2ff368a3d2a4556c0c)+++ b/[arch/riscv/purgatory/entry.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/riscv/purgatory/entry.S?id=fb197c5d2fd24b9af3d4697d0cf778645846d6d5)@@ -7,6 +7,7 @@ \* Author: Li Zhengyu (lizhengyu3@huawei.com) \* \*/+#include <asm/asm.h> #include <linux/linkage.h>  .text@@ -34,6 +35,7 @@ SYM\_CODE\_END(purgatory\_start)  .data +.align LGREG SYM\_DATA(riscv\_kernel\_entry, .quad 0)  .end |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 15:33:36 +0000

