

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@linaro.org> | 2023-10-27 15:19:01 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-20 11:08:28 +0100 |
| commit | [a1a485e45d24b1cd8fe834fd6f1b06e2903827da](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da)) | |
| tree | [0b8ccaee406b0baa3b08faf7bbae8e65ccd29c10](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da) | |
| parent | [352887b3edd007cf9b0abc30fe9d98622acd859b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=352887b3edd007cf9b0abc30fe9d98622acd859b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da&id2=352887b3edd007cf9b0abc30fe9d98622acd859b)) | |
| download | [linux-a1a485e45d24b1cd8fe834fd6f1b06e2903827da.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a1a485e45d24b1cd8fe834fd6f1b06e2903827da.tar.gz) | |

hsr: Prevent use after free in prp\_create\_tagged\_frame()[ Upstream commit 876f8ab52363f649bcc74072157dfd7adfbabc0d ]
The prp\_fill\_rct() function can fail. In that situation, it frees the
skb and returns NULL. Meanwhile on the success path, it returns the
original skb. So it's straight forward to fix bug by using the returned
value.
Fixes: 451d8123f897 ("net: prp: add packet handling support")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Acked-by: Paolo Abeni <pabeni@redhat.com>
Link: [https://lore.kernel.org/r/57af1f28-7f57-4a96-bcd3-b7a0f2340845@moroto.mountain](https://lore.kernel.org/r/57af1f28-7f57-4a96-bcd3-b7a0f2340845%40moroto.mountain)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da)

| -rw-r--r-- | [net/hsr/hsr\_forward.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/hsr/hsr_forward.c?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 3 deletions

| diff --git a/net/hsr/hsr\_forward.c b/net/hsr/hsr\_forward.cindex 12ba43023d30ec..e31747d328e700 100644--- a/[net/hsr/hsr\_forward.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/hsr/hsr_forward.c?id=352887b3edd007cf9b0abc30fe9d98622acd859b)+++ b/[net/hsr/hsr\_forward.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/hsr/hsr_forward.c?id=a1a485e45d24b1cd8fe834fd6f1b06e2903827da)@@ -300,9 +300,7 @@ struct sk\_buff \*prp\_create\_tagged\_frame(struct hsr\_frame\_info \*frame, skb = skb\_copy\_expand(frame->skb\_std, 0, skb\_tailroom(frame->skb\_std) + HSR\_HLEN, GFP\_ATOMIC);- prp\_fill\_rct(skb, frame, port);-- return skb;+ return prp\_fill\_rct(skb, frame, port); }  static void hsr\_deliver\_master(struct sk\_buff \*skb, struct net\_device \*dev, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 18:15:30 +0000

