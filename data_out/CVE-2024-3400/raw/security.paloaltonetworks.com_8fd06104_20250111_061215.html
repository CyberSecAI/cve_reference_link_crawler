<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><title>CVE-2024-3400 PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="keywords" content="psirt, PANW, PAN, CVE, Report Vulnerabilities, Palo Alto Networks"><meta name="og:site_name" content="Palo Alto Networks Product Security Assurance"><meta name="theme-color" content="#f0f8ff"><meta property="og:type" content="website"><link rel="apple-touch-icon" sizes="180x180" href="/icon-180x180.png"><link rel="icon" type="image/png" href="/icon-180x180.png" sizes="180x180"><link rel="shortcut icon" href="/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Montserrat:700&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/min.css"><script src="https://assets.adobedtm.com/9273d4aedcd2/fde2d38db50b/launch-4c3207301e79.min.js" async></script><meta name="description" content="Palo Alto Networks Security Advisory: CVE-2024-3400 PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect A command injection as a result of arbitrary file creation vulnerability in the GlobalProtect feature of Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature configurations may enable an unauthenticated attacker to execute arbitrary code with root privileges on the firewall.

Cloud NGFW, Panorama appliances, and Prisma Access are not impacted by this vulnerability.

Customers should continue to monitor this security advisory for the latest updates and product guidance."><meta property="og:title" content="CVE-2024-3400 PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect"><meta property="og:description" content="A command injection as a result of arbitrary file creation vulnerability in the GlobalProtect feature of Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature configurat..."><meta name="twitter:image" content="https://security.paloaltonetworks.com/CRITICAL.png"><meta property="og:image" content="https://security.paloaltonetworks.com/CRITICAL.png"><meta property="og:type" content="article"><meta property="article:publisher" content="Palo Alto Networks Product Security Assurance"><meta property="article:author" content="PAN PSIRT"><meta property="article:published_time" content="2024-04-12T06:55:00.000Z"><meta name="twitter:card" contet="summary"><meta name="twitter:label1" content="Severity"><meta name="twitter:data1" content="CRITICAL"><meta name="twitter:label2" content="Published"><meta name="twitter:data2" content="2024-04-12"></head><body id="body"><nav id="nav"><a class="ico logo tsz" href="https://www.paloaltonetworks.com"></a><input class="hid" id="menu" type="checkbox"><label class="rt ico menu nsz" for="menu" onclick></label><ul><li><a href="https://support.paloaltonetworks.com/support" target="_blank" nav-track="true" nav-track-breadcrumb="nav:support">Get support</a></li><li><a href="/">Security advisories</a></li><li><a href="/report">Report vulnerabilities</a></li><li><a href="/scope">Bug Bounty</a></li><li><a href="https://support.paloaltonetworks.com/SupportAccount/Preferences"><span class="ico eml"></span>
<span>Subscribe</span></a></li><li><a href="/rss.xml"><span class="ico rss"></span>
<span>RSS feed</span></a></li></ul></nav><div class="pad" id="content"><a href="/">Palo Alto Networks Security Advisories</a> /
<a href="">CVE-2024-3400</a><h2>CVE-2024-3400 PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect</h2><div class="sa_summary"><div class="pad rnd bg-blu sa_cvss"><div class="rnd tag CVSS CRITICAL"><span title="We suggest responding to this with the highest urgency.">Urgency
HIGHEST</span></div><br><style>@keyframes rotate{0%{transform: rotate(0deg);} 100%{transform: rotate(303deg);} }</style><svg id="CVSSSVG" width="42mm" height="42mm" version="1.1" viewbox="0 0 42 42" xmlns="http://www.w3.org/2000/svg"><circle cx="21" cy="21" r="18.5" fill="#fff" fill-rule="evenodd" stroke="#000" stroke-width="1"></circle><g fill-rule="evenodd" shape-rendering="auto"><path d="m15.383 32.46-1.8893 3.5011c0.5329 0.26616 1.0775 0.5058 1.634 0.71365l1.2842-3.7672c-0.34867-0.13443-0.69246-0.28245-1.0289-0.44752z" fill="#00CC66"></path><path d="m27.258 32.107c-3.1418 1.7714-6.7034 2.0742-9.9002 1.1219l-1.2842 3.7651c4.2936 1.3207 9.1009 0.93103 13.285-1.4785z" fill="#dedede"></path><path d="m31.982 27.496c-0.94261 1.5912-2.245 2.9961-3.8731 4.0861l2.1001 3.4075c2.2361-1.4705 4.0115-3.4052 5.2772-5.6022z" fill="#FA582D"></path><path d="m35.515 12.642-3.4091 2.1006c2.1467 3.8069 2.1408 8.2319 0.35398 11.875l3.5011 1.8893c2.4288-4.8643 2.4604-10.818-0.44597-15.865z" fill="#FD911A"></path><path d="m11.792 7.0094c-7.3432 4.8289-9.7459 14.66-5.2968 22.366 1.5194 2.6317 3.6551 4.6912 6.119 6.1107l1.8914-3.5042c-1.824-1.0806-3.4064-2.6318-4.5465-4.6064-3.3873-5.8669-1.6124-13.247 3.9331-16.959z" fill="#BFCB1E"></path><path d="m21.353 4.2607c-2.9582-0.068747-5.9687 0.64401-8.7111 2.2231l2.1006 3.4091c5.8474-3.2966 13.152-1.5088 16.839 3.9992l3.4081-2.1001c-3.1076-4.7254-8.2855-7.407-13.637-7.5313z" fill="#FFCB06"></path></g><path d="m9.1779 41.476" fill="none" stroke="#000"></path><g fill="#b2b2b2" font-family="Montserrat,Arial" font-size="3px" font-weight="bold"><text x="15.7" y="32">0</text><text x="14.1" y="13.3">4</text><text x="29.2" y="17">7</text><text x="29.6" y="27">9</text><text x="24.6" y="31">10</text></g><g id="ndg"><path id="needle" d="m20.59 15.532-4.4675 16.877 9.1162-14.889-2.6053-0.33678z" fill="#000" transform="rotate(303 21 21)"></path><circle cx="21" cy="21" r="2" fill="#f5f5f5" stroke="#000"></circle></g></svg><br><a class="rnd tag CVSS CRITICAL" href="https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:M/U:Red" title="CVSS-B: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:M/U:Red">Severity
10 ·
CRITICAL</a></div><div class="rnd pad1 bg-blu sa_vector v4"><div title="The actions required to respond to a vulnerability require some effort on behalf of the consumer and could cause minimal service impact to implement. Examples include: simple remote update, disabling of a subsystem, or a low-touch software upgrade such as a driver update."><small>Response Effort
</small><b>MODERATE</b></div><div title="The system requires manual intervention by the user to recover services, after an attack has been performed."><small>Recovery
</small><b>USER</b></div><div title="The vulnerable system is rich in resources. Heuristically, such systems are often the direct responsibility of “system operators” rather than users. An example of Concentrated (think: broad) Value Density would be an attack on a central email server."><small>Value Density
</small><b>CONCENTRATED</b></div><div title="Worst: The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable at the protocol level one or more network hops away (e.g., across one or more routers)."><small>Attack Vector
</small><b>NETWORK</b></div><div title="Worst: Specialized access conditions or extenuating circumstances do not exist. An attacker can expect repeatable success when attacking the vulnerable component."><small>Attack Complexity
</small><b>LOW</b></div><div title="Worst: The successful attack does not depend on the deployment and execution conditions of the vulnerable system. The attacker can expect to be able to reach the vulnerability and execute the exploit under all or most instances of the vulnerability."><small>Attack Requirements
</small><b>NONE</b></div><div title="Attackers can reliably automate all 4 steps of the kill chain. These steps are reconnaissance, weaponization, delivery, and exploitation (e.g., the vulnerability is “wormable”)."><small>Automatable
</small><b>YES</b></div><div title="Worst: The vulnerable system can be exploited without interaction from any user."><small>User Interaction
</small><b>NONE</b></div><div title="Worst: There is a total loss of confidentiality, resulting in all information within the Vulnerable System being divulged to the attacker. Alternatively, access to only some restricted information is obtained, but the disclosed information presents a direct, serious impact. For example, an attacker steals the administrator's password, or private encryption keys of a web server."><small>Product Confidentiality
</small><b>HIGH</b></div><div title="Worst: There is a total loss of integrity, or a complete loss of protection. For example, the attacker is able to modify any/all files protected by the vulnerable system. Alternatively, only some files can be modified, but malicious modification would present a direct, serious consequence to the vulnerable system."><small>Product Integrity
</small><b>HIGH</b></div><div title="Worst: There is a total loss of availability, resulting in the attacker being able to fully deny access to resources in the Vulnerable System; this loss is either sustained (while the attacker continues to deliver the attack) or persistent (the condition persists even after the attack has completed). Alternatively, the attacker has the ability to deny some availability, but the loss of availability presents a direct, serious consequence to the Vulnerable System (e.g., the attacker cannot disrupt existing connections, but can prevent new connections; the attacker can repeatedly exploit a vulnerability that, in each instance of a successful attack, leaks a only small amount of memory, but after repeated exploitation causes a service to become completely unavailable)."><small>Product Availability
</small><b>HIGH</b></div><div title="Worst: The attacker is unauthorized before the attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack."><small>Privileges Required
</small><b>NONE</b></div><div title="Worst: There is a total loss of confidentiality, resulting in all resources within the Subsequent System being divulged to the attacker. Alternatively, access to only some restricted information is obtained, but the disclosed information presents a direct, serious impact. For example, an attacker steals the administrator's password, or private encryption keys of a web server."><small>Subsequent Confidentiality
</small><b>HIGH</b></div><div title="Worst: There is a total loss of integrity, or a complete loss of protection. For example, the attacker is able to modify any/all files protected by the Subsequent System. Alternatively, only some files can be modified, but malicious modification would present a direct, serious consequence to the Subsequent System."><small>Subsequent Integrity
</small><b>HIGH</b></div><div title="Worst: There is a total loss of availability, resulting in the attacker being able to fully deny access to resources in the Subsequent System; this loss is either sustained (while the attacker continues to deliver the attack) or persistent (the condition persists even after the attack has completed). Alternatively, the attacker has the ability to deny some availability, but the loss of availability presents a direct, serious consequence to the Subsequent System (e.g., the attacker cannot disrupt existing connections, but can prevent new connections; the attacker can repeatedly exploit a vulnerability that, in each instance of a successful attack, leaks a only small amount of memory, but after repeated exploitation causes a service to become completely unavailable)."><small>Subsequent Availability
</small><b>HIGH</b></div></div><div class="rnd pad1 bg-blu sa_expand"><div class="sa_links pull_right"><span><a class="tag blue" href="https://www.cve.org/CVERecord?id=CVE-2024-3400" target="_blank" title="See CVE.org record">CVE</a>
<a class="tag orange" href="/json/CVE-2024-3400" title="Download the information in this advisory in CVE-JSON format">JSON</a>
<a class="tag csaf" href="/csaf/CVE-2024-3400" title="Download the information in this advisory in CSAF format">CSAF</a>
<a class="btn blue" href="/CVE-2024-3400" title="Permanent link to this advisory"><span class="ico link"></span></a>
<a class="btn" title="Share this advisory in email" href="mailto:?subject=CVE-2024-3400 PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect&amp;body=CVE-2024-3400 PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect%0A%0Ahttps://security.paloaltonetworks.com/CVE-2024-3400"><span class="ico eml"></span></a></span><div><span class="ico date"></span><small> Published
</small><b><span class="date-tt" data-date="2024-04-12T06:55:00.000Z">2024-04-12</span></b></div><div><span class="ico date"></span><small> Updated
</small><b><span class="date-tt" data-date="2024-05-03T04:50:00.000Z">2024-05-03</span></b></div><div><small>Reference
</small><b>PAN-252214</b></div><div title="A customer encountered this issue while using the product."><small>Discovered
</small><b>in production use</b></div></div></div></div><h3>Description</h3><p>A command injection as a result of arbitrary file creation vulnerability in the GlobalProtect feature of Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature configurations may enable an unauthenticated attacker to execute arbitrary code with root privileges on the firewall.</p><p>Cloud NGFW, Panorama appliances, and Prisma Access are not impacted by this vulnerability.</p><p>Customers should continue to monitor this security advisory for the latest updates and product guidance.</p><h3>Product Status</h3><table class="neat card"><colgroup><col><col class="affectedCol"></colgroup><tr><th>Versions</th><th>Affected</th><th>Unaffected</th></tr><tr><td>Cloud NGFW </td><td>None</td><td>All</td></tr><tr><td>PAN-OS 11.1</td><td>&lt; 11.1.0-h3, &lt; 11.1.1-h1, &lt; 11.1.2-h3</td><td>&gt;= 11.1.0-h3, &gt;= 11.1.1-h1, &gt;= 11.1.2-h3</td></tr><tr><td>PAN-OS 11.0</td><td>&lt; 11.0.0-h3, &lt; 11.0.1-h4, &lt; 11.0.2-h4, &lt; 11.0.3-h10, &lt; 11.0.4-h1</td><td>&gt;= 11.0.0-h3, &gt;= 11.0.1-h4, &gt;= 11.0.2-h4, &gt;= 11.0.3-h10, &gt;= 11.0.4-h1</td></tr><tr><td>PAN-OS 10.2</td><td>&lt; 10.2.0-h3, &lt; 10.2.1-h2, &lt; 10.2.2-h5, &lt; 10.2.3-h13, &lt; 10.2.4-h16, &lt; 10.2.5-h6, &lt; 10.2.6-h3, &lt; 10.2.7-h8, &lt; 10.2.8-h3, &lt; 10.2.9-h1</td><td>&gt;= 10.2.0-h3, &gt;= 10.2.1-h2, &gt;= 10.2.2-h5, &gt;= 10.2.3-h13, &gt;= 10.2.4-h16, &gt;= 10.2.5-h6, &gt;= 10.2.6-h3, &gt;= 10.2.7-h8, &gt;= 10.2.8-h3, &gt;= 10.2.9-h1</td></tr><tr><td>PAN-OS 10.1</td><td>None</td><td>All</td></tr><tr><td>PAN-OS 10.0</td><td>None</td><td>All</td></tr><tr><td>PAN-OS 9.1</td><td>None</td><td>All</td></tr><tr><td>PAN-OS 9.0</td><td>None</td><td>All</td></tr><tr><td>Prisma Access </td><td>None</td><td>All</td></tr></table><h3>Required Configuration for Exposure</h3><p>This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both). Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability.</p><p>You can verify whether you have a GlobalProtect gateway or GlobalProtect portal configured by checking for entries in your firewall web interface (Network &gt; GlobalProtect &gt; Gateways or Network &gt; GlobalProtect &gt; Portals).</p><h3>Severity:
CRITICAL, Suggested Urgency:
HIGHEST</h3><p><span title="CVSS Base metrics">CVSS-B:</span>
10.0 (<a href="https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:M/U:Red">CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:M/U:Red</a>)</p><h3>Exploitation Status</h3><p>Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Proof of concepts for this vulnerability have been publicly disclosed by third parties.</p><p>We are also aware of proof-of-concept by third parties of post-exploit persistence techniques that survive resets and upgrades. We are not aware at this time of any malicious attempts to use these persistence techniques in active exploitation of the vulnerability. These fixes listed below and Threat Prevention signatures completely prevent the initial remote command execution, stopping subsequent post-exploitation or persistence.</p><p>More information about the vulnerability's exploitation in the wild can be found in the Unit 42 threat brief (<a href="https://unit42.paloaltonetworks.com/cve-2024-3400/" class="linkified" target="_blank">https://unit42.paloaltonetworks.com/cve-2024-3400/</a>) and the Palo Alto Networks PSIRT blog post (<a href="https://www.paloaltonetworks.com/blog/2024/04/more-on-the-pan-os-cve/" class="linkified" target="_blank">https://www.paloaltonetworks.com/blog/2024/04/more-on-the-pan-os-cve/</a>).</p><h3>Weakness Type</h3><p><a href="https://cwe.mitre.org/data/definitions/77" target="_blank" title="More at https://cwe.mitre.org/data/definitions/77">CWE-77 Improper Neutralization of Special Elements used in a Command ('Command Injection')</a></p><p><a href="https://cwe.mitre.org/data/definitions/20" target="_blank" title="More at https://cwe.mitre.org/data/definitions/20">CWE-20 Improper Input Validation</a></p><h3>Solution</h3><p>We strongly advise customers to immediately upgrade to a fixed version of PAN-OS to protect their devices even when workarounds and mitigations have been applied.</p><p>This issue is fixed in PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3, and in all later PAN-OS versions. These fixes and those listed below completely prevent the initial remote command execution, stopping subsequent post-exploitation or persistence.</p><p>In addition, to provide the most seamless upgrade path for customers, additional hotfixes have been made available as a courtesy for other commonly deployed maintenance releases.</p><code>  PAN-OS 10.2:</code><br/><code>  - 10.2.9-h1 (Released 4/14/24)</code><br/><code>  - 10.2.8-h3 (Released 4/15/24)</code><br/><code>  - 10.2.7-h8 (Released 4/15/24)</code><br/><code>  - 10.2.6-h3 (Released 4/16/24)</code><br/><code>  - 10.2.5-h6 (Released 4/16/24)</code><br/><code>  - 10.2.4-h16 (Released 4/18/24)</code><br/><code>  - 10.2.3-h13 (Released 4/18/24)</code><br/><code>  - 10.2.2-h5 (Released 4/18/24)</code><br/><code>  - 10.2.1-h2 (Released 4/18/24)</code><br/><code>  - 10.2.0-h3 (Released 4/18/24)</code><br/><code>  </code><br/><code>  PAN-OS 11.0:</code><br/><code>  - 11.0.4-h1 (Released 4/14/24)</code><br/><code>  - 11.0.4-h2 (Released 4/17/24)</code><br/><code>  - 11.0.3-h10 (Released 4/16/24)</code><br/><code>  - 11.0.2-h4 (Released 4/16/24)</code><br/><code>  - 11.0.1-h4 (Released 4/18/24)</code><br/><code>  - 11.0.0-h3 (Released 4/18/24)</code><br/><code>  </code><br/><code>  PAN-OS 11.1:</code><br/><code>  - 11.1.2-h3 (Released 4/14/24)</code><br/><code>  - 11.1.1-h1 (Released 4/16/24)</code><br/><code>  - 11.1.0-h3 (Released 4/16/24)</code><br/><p>Note: Due to naming convention limitations, “-h” hotfix versions on Azure marketplace are instead named via addition of an extra “0”. Ex: 11.1.2-h3 is published on Azure as 11.1.203.</p><p>If any exploitation was observed on a device, please take the remediation steps suggested here: <a href="https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK" class="linkified" target="_blank">https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK</a></p><p>An enhanced factory reset (EFR) procedure that does not rely on the integrity of a potentially compromised device can be scheduled by opening a case through Customer Support (TAC). This is recommended for:</p><p>1. Customers who have not applied the PAN-OS fixes or Threat Prevention signatures with vulnerability protection applied to the GlobalProtect interface (regardless of level of compromise) on or before April 25, 2024; or</p><p>2. Customers who are concerned about a persistent risk.</p><h3>Workarounds and Mitigations</h3><p>Recommended Mitigation: Customers with a Threat Prevention subscription can block attacks for this vulnerability using Threat IDs 95187, 95189, and 95191 (available in Applications and Threats content version 8836-8695 and later). Please monitor this advisory and new Threat Prevention content updates for additional Threat Prevention IDs around CVE-2024-3400.</p><p>To apply the Threat IDs, customers must ensure that vulnerability protection has been applied to their GlobalProtect interface to prevent exploitation of this issue on their device. Please see <a href="https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184" class="linkified" target="_blank">https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184</a> for more information.</p><p>In earlier versions of this advisory, disabling device telemetry was listed as a secondary mitigation action. Disabling device telemetry is no longer an effective mitigation. Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability.</p><h3>Acknowledgments</h3><div class="pad rnd bg-wht flx"><div class="tsz ico credit"></div><div class="pad1"><div>Palo Alto Networks thanks Volexity for detecting and identifying this issue, Capability Development Group at Bishop Fox for helping us improve threat prevention signatures, Nick Wilson, and Louis Lingg for sharing their research into post-exploitation persistence techniques.</div></div></div><h3>Frequently Asked Questions</h3><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
Has this issue been exploited in the wild?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p><p>Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Proof of concepts for this vulnerability have been publicly disclosed by third parties.</p><p>We are also aware of proof of concepts by third parties of post-exploit persistence techniques that survive resets and upgrades. These techniques work on a device that is already compromised with interactive root level command execution.</p></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
Are there any checks I can run on my device to look for evidence of attempted exploit activity?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p><p>The following command can be used from the PAN-OS CLI to help identify if there was an attempted exploit activity on the device:</p><code>grep pattern "failed to unmarshal session(.\+.\/" mp-log gpsvc.log*</code><br><p>If the value between "session(" and ")" does not look like a GUID, but instead contains a file system path or embedded shell commands, this could be related to an attempted exploitation of CVE-2024-3400, which will warrant further investigation to correlate with other indicators of compromise.</p><p>Grep output indicating an attempted exploit may look like the following entry:</p><code>failed to unmarshal session(../../some/path)</code><br><p>Grep output indicating normal behavior will typically appear like the following entry:</p><code>failed to unmarshal session(01234567-89ab-cdef-1234-567890abcdef)</code><br></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
When should I collect a Tech Support File (TSF) and forensic evidence during the upgrade process?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p>You should obtain a TSF for forensic analysis before rebooting into a fixed version of PAN-OS. If you have already upgraded the firewall, but did not collect a TSF, some logs from the prior system installation will become inaccessible on the device. Please reach out to support if you need help investigating a prior PAN-OS installation.<br></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
Has my device been compromised by this vulnerability?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p>Customers are able to open a case in the Customer Support Portal (CSP) and upload a technical support file (TSF) to determine if their device logs match known attempted exploits for this vulnerability.<br></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
How do I verify I applied the Threat Prevention signatures correctly?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p><p>Run the following command against the GlobalProtect enabled PAN-OS 10.2+ firewall:</p><code>curl -v -k -H "Cookie: SESSID=/../TESTVULN" https://&lt;target-host&gt;/global-protect/login.esp</code><br><p>If the firewall is protected by the necessary Threat Prevention signatures, no response will be returned. A TCP reset will occur. A successful response indicates that Threat Prevention signatures are not correctly applied. Please follow the steps in <a target="_blank" rel="nofollow" href="https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184">https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184</a></p></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
Where can I find additional indicators of compromise for this issue?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p><p><span style="background-color: rgb(255, 255, 255);">Please refer to the Unit42 Threat Brief (</span><a target="_blank" rel="nofollow" href="https://unit42.paloaltonetworks.com/cve-2024-3400/">https://unit42.paloaltonetworks.com/cve-2024-3400/</a><span style="background-color: rgb(255, 255, 255);">) and the Volexity blog post (</span><a target="_blank" rel="nofollow" href="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/">https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/</a><span style="background-color: rgb(255, 255, 255);">) for the latest information.</span></p></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
Are VMs deployed and managed by customers in the cloud impacted?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p><span style="background-color: rgb(255, 255, 255);">While the Cloud NGFW managed services on AWS and Azure are not impacted, VM-Series managed by customers and with specific PAN-OS versions and Global Protect configurations are impacted.</span><br></p></blockquote><h3>Timeline</h3><div class="timeline"><div><label><span class="date-tt" data-date="2024-05-03T04:50:00.000Z">2024-05-03</span></label>
<span class="t">Enhanced Factory Reset (EFR) Procedure is Available Against any Potential Post-Exploit Persistence Techniques.</span></div><div><label><span class="date-tt" data-date="2024-05-01T23:45:00.000Z">2024-05-01</span></label>
<span class="t">Answered a FAQ about how to verify the fix or threat prevention signature was applied correctly</span></div><div><label><span class="date-tt" data-date="2024-04-29T17:58:00.000Z">2024-04-29</span></label>
<span class="t">Updated exploitation status about proof-of-concept by third parties of post-exploit persistence techniques</span></div><div><label><span class="date-tt" data-date="2024-04-25T01:48:00.000Z">2024-04-25</span></label>
<span class="t">Added link to KB article for remediating a device</span></div><div><label><span class="date-tt" data-date="2024-04-20T18:23:00.000Z">2024-04-20</span></label>
<span class="t">Answered a FAQ about Tech Support File collection and forensic evidence</span></div><div><label><span class="date-tt" data-date="2024-04-19T22:25:00.000Z">2024-04-19</span></label>
<span class="t">Added reference to PSIRT blog post about CVE-2024-3400</span></div><div><label><span class="date-tt" data-date="2024-04-19T01:15:00.000Z">2024-04-19</span></label>
<span class="t">Clarified vulnerability title and description</span></div><div><label><span class="date-tt" data-date="2024-04-17T22:00:00.000Z">2024-04-17</span></label>
<span class="t">Clarified FAQ regarding evidence of attempted exploit activity</span></div><div><label><span class="date-tt" data-date="2024-04-17T05:10:00.000Z">2024-04-17</span></label>
<span class="t">Added new Threat Prevention Threat ID to Workarounds and Mitigations</span></div><div><label><span class="date-tt" data-date="2024-04-17T02:00:00.000Z">2024-04-17</span></label>
<span class="t">Added a CLI command to search for possible attempts of exploit activity</span></div><div><label><span class="date-tt" data-date="2024-04-16T20:45:00.000Z">2024-04-16</span></label>
<span class="t">Updated product and mitigation guidance, exploit status, and PAN-OS fix availability</span></div><div><label><span class="date-tt" data-date="2024-04-15T02:30:00.000Z">2024-04-15</span></label>
<span class="t">All necessary PAN-OS fixes are now available, clarified Workarounds and Mitigations when using Panorama templates</span></div><div><label><span class="date-tt" data-date="2024-04-14T02:50:00.000Z">2024-04-14</span></label>
<span class="t">Clarified impact on GlobalProtect portal configurations</span></div><div><label><span class="date-tt" data-date="2024-04-13T05:50:00.000Z">2024-04-13</span></label>
<span class="t">Added link to Unit42 threat brief and clarified impact to customer-managed VMs in the cloud</span></div><div><label><span class="date-tt" data-date="2024-04-12T06:55:00.000Z">2024-04-12</span></label>
<span class="t">Initial publication</span></div></div><script>function localiseDates() {
  document.querySelectorAll("span[data-date]").forEach((elem) => {
    let localDate = new Date(elem.getAttribute("data-date"));
    let isoLocalDate = new Date(localDate.getTime() - localDate.getTimezoneOffset() * 60000).toISOString().slice(0, 10);
    elem.textContent = isoLocalDate;
    let fmtOpts = { dateStyle: "long", timeStyle: "long" };
    elem.setAttribute("title", new Intl.DateTimeFormat(undefined, fmtOpts).format(localDate));
  });
}

window.addEventListener("load", localiseDates);
</script></div><div class="footer"><a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of use</a><a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a><a href="https://paloaltonetworks.com/product-security-assurance">Product Security Assurance and Vulnerability Disclosure Policy</a><a href="/report">Report vulnerabilities</a><a href="https://support.paloaltonetworks.com/SupportAccount/Preferences">Manage subscriptions</a></div><div class="pad bg-blu"><div class="btop">© 2025 Palo Alto Networks, Inc. All rights reserved.</div></div></body></html>