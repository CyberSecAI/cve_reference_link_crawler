=== Content from samh4cks.github.io_a5da3a33_20250111_204100.html ===
 [![avatar](https://samh4cks.netlify.app/assets/commons/hacker.jpg)](/)
# [Samarth Dad](/)

Security Researcher @ **Yogosha**

* [HOME](/) * [CATEGORIES](/categories/) * [TAGS](/tags/) * [ARCHIVES](/archives/) * [ABOUT](/about/)
          [Home](/)  CVE-2023-43458 - Stored Cross-Site Scripting (XSS)   Post       Cancel
# CVE-2023-43458 - Stored Cross-Site Scripting (XSS)

  Posted  Sep 19, 2023    By  *[Samarth](https://github.com/samh4cks/)*    *4 min* read

[![CVE-2023-43456](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/banner.png)](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/banner.png)

## About the Application

This simple project is entitled `Resort Reservation System v.1.0`. It is a simple web application that provides an automated platform for certain resort management to easily store and retrieve reservation records. It was mainly developed using PHP Language and SQLite3 Database. It has a simple and pleasant user interface using Bootstrap v5 Framework. The project contains CRUD (Create, Read, Update, and Delete) Operations and user-friendly features and functionalities.

This `Resort Reservation System v.1.0` was mainly developed and can only be accessed by the resort management. Here, resort management can dynamically list all the rooms/cottages and extra fees that are available at their resort. They can simply encode or store their customer reservation records along with some other charges. Using the system, users can encode first the customer reservation details and the room or cottage they wanted to take and add extra fees or charges when the customer checked in.

## Vulnerability Description

Cross Site Scripting vulnerability in `Resort Reservation System v.1.0` allows a remote attacker to execute arbitrary code and obtain sensitive information via the `room`, `name`, and `description` parameters in the `/php-sqlite-rrs/?page=manage_room`.

## Vulnerable Code

**Filename:** `/php-sqlite-rrs/manage_room.php`

**Vulnerable Endpoint:** `/php-sqlite-rrs/?page=manage_room`

**Vulnerable Parameter:** `room, name and descripton`

**Code:**

  `| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  ```  ``` <form action="" id="room-form">     <input type="hidden" name="formToken" value="<?= $_SESSION['formToken']['room-form'] ?>">     <input type="hidden" name="room_id" value="<?= $data['room_id'] ?? '' ?>">     <div class="mb-3">         <label for="room_no" class="text-body-tertiary">Room/Cottage Number</label>         <input type="text" class="form-control rounded-0" id="room_no" name="room_no" required="required" autofocus value="<?= $data['room_no'] ?? "" ?>" >     </div>     <div class="mb-3">         <label for="name" class="text-body-tertiary">Name</label>         <input type="text" class="form-control rounded-0" id="name" name="name" required="required" value="<?= $data['name'] ?? "" ?>">     </div>     <div class="mb-3">         <label for="description" class="text-body-tertiary">Description</label>         <textarea rows="5" class="form-control rounded-0" id="description" name="description" required="required" ><?= $data['description'] ?? "" ?></textarea>     </div>     <div class="mb-3">         <label for="price" class="text-body-tertiary">Price</label>         <input type="number" step="any" class="form-control rounded-0" id="price" name="price" value="<?= $data['price'] ?? "" ?>">     </div>     <div class="mb-3">         <label for="status" class="text-body-tertiary">Status</label>         <select class="form-select rounded-0" id="status" name="status">         	<option value="0" <?= isset($data['status']) && $data['status'] == 0 ? "selected" : "" ?>>Inactive</option>             <option value="1" <?= isset($data['status']) && $data['status'] == 1 ? "selected" : "" ?>>Active</option>         </select>     </div> </form>  ``` | |
| --- | --- |`

When users input their names, such as their `room`, `name`, and `description`, the website neglects the critical step of sanitizing this information to ensure it’s free from potentially harmful characters before storing it in the backend. This oversight creates a security vulnerability known as ‘Stored Cross-Site Scripting’ (Stored XSS), especially concerning these name parameters.

`Stored Cross-Site Scripting (XSS)` is a type of security vulnerability that occurs in web applications when user input, often in the form of text or other content, is not properly sanitized or validated before being stored on the server and then later displayed to other users. This vulnerability allows attackers to inject malicious scripts, typically in the form of JavaScript code, into the application’s data storage. When other users retrieve and view this data, the injected script code is executed within their browsers, potentially leading to a range of malicious actions.

## Impact of Stored Cross-Site Scripting

The impacts of Stored Cross-Site Scripting (Stored XSS) are mentioned below:

**Session Hijacking**: Attackers can hijack user sessions, gaining unauthorized access to accounts and allowing them to perform actions on behalf of users or access confidential data.

**Manipulation of Web Pages**: Stored XSS can alter the appearance and functionality of web pages, potentially tricking users into executing unintended actions, clicking on malicious links, or downloading malware.

## Attack Scenario

* Go to `http://application ip/php-sqlite-rrs/?page=manage_room`.

[![Application view](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/1.png)](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/1.png)

* Provide payload as `"><script>alert("XSS on Room")`, `"><script>alert("XSS on Name")`, `"><script>alert("XSS on Description")` on parameter such as `room_no`, `name` and `description` respectively.

[![XSS on Room's detail](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/2.png)](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/2.png)*Room’s Detail*

* Click on Save.

  * You will observe the popup of each payload we provided.

[![XSS on room](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/3.png)](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/3.png)*XSS on Room*

[![XSS on name](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/4.png)](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/4.png)*XSS on Name*

[![XSS on description](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/5.png)](https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43458/5.png)*XSS on Description*

## Remediation

Mitigating stored cross-site scripting (XSS) vulnerabilities is crucial for securing web applications. To prevent stored XSS, follow these best practices:

* **Whitelist Input**: Only allow specific, safe characters and patterns in user input. Reject any input that doesn’t conform to this whitelist.

  * **Data Sanitization**: Filter and clean user input to remove or encode any potentially malicious characters. Use libraries like OWASP’s Java Encoder, PHP’s htmlspecialchars, or equivalent functions in other languages.

    * **Sanitization Libraries**: Use security libraries and frameworks that provide built-in XSS prevention mechanisms, such as Ruby on Rails, Django, or AngularJS.

      * **Use HTTP-Only Cookies**: Mark cookies as HTTP-only to prevent JavaScript from accessing them, reducing the impact of XSS attacks.

        * **Session Management**: Implement secure session management to ensure that session cookies and tokens are properly protected and rotated.

          * **Security Headers**: Use security headers like `X-XSS-Protection` and `X-Content-Type-Options` to instruct browsers to mitigate certain types of attacks.

That’s all in this writeup.

Thanks for reading this far. If you enjoyed the writeup, do support me [**here**](https://www.buymeacoffee.com/h4xplo1t).

  [CVEs](/categories/cves/)  [CVE-2023-43458](/tags/cve-2023-43458/) [Cross-Site Scripting](/tags/cross-site-scripting/) [Source Code Analysis](/tags/source-code-analysis/) [CVEs](/tags/cves/) This post is licensed under  [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/)  by the author. Share
## Recently Updated

* [HackTheBox Heal Writeup](/posts/HackTheBox-Heal/)* [HackTheBox LinkVortex Writeup](/posts/HackTheBox-LinkVortex/)* [HackTheBox Sightless Writeup](/posts/HackTheBox-Sightless/)* [HackTheBox Cicada Writeup](/posts/HackTheBox-Cicada/)* [CVE-2023-43458 - Stored Cross-Site Scripting (XSS)](/posts/cve-2023-43458/)
## Trending Tags

 [Linux](/tags/linux/) [Cross-Site Scripting](/tags/cross-site-scripting/) [CVEs](/tags/cves/) [SMB](/tags/smb/) [Source Code Analysis](/tags/source-code-analysis/) [Windows](/tags/windows/) [FTPd](/tags/ftpd/) [Web](/tags/web/) [Active Directory](/tags/active-directory/) [Blind Command Injection](/tags/blind-command-injection/)
## Contents

### Further Reading

  [Sep 19, 2023
#### CVE-2023-43456 - Stored Cross-Site Scripting (XSS)

About the Application This Service Provider Management System v.1.0 is a sort of Content Management System (CMS) that is built specifically for companies that provide different services. The pro...](/posts/cve-2023-43456/)  [Sep 19, 2023
#### CVE-2023-43457 - Broken Access Control (BAC)

About the Application This Service Provider Management System v.1.0 is a sort of Content Management System (CMS) that is built specifically for companies that provide different services. The pro...](/posts/cve-2023-43457/)  [Aug 15, 2023
#### A tale of finding an interesting XSS vulnerability

Introduction Hello everyone, I trust you’re all doing great. Over the past weekend, my friend n3hal\_ and I stumbled upon an intriguing XSS vulnerability while participating in a bug bounty prog...](/posts/a-tale-of-finding-an-interesting-xss-vulnerability/) [CVE-2023-43457 - Broken Access Control (BAC)](/posts/cve-2023-43457/) [HackTheBox Cicada Writeup](/posts/HackTheBox-Cicada/)

© 2024 [Samarth Dad](https://samarthdad.com/). Some rights reserved.

Using the [Chirpy](https://github.com/cotes2020/jekyll-theme-chirpy) theme for [Jekyll](https://jekyllrb.com).

## Trending Tags

 [Linux](/tags/linux/) [Cross-Site Scripting](/tags/cross-site-scripting/) [CVEs](/tags/cves/) [SMB](/tags/smb/) [Source Code Analysis](/tags/source-code-analysis/) [Windows](/tags/windows/) [FTPd](/tags/ftpd/) [Web](/tags/web/) [Active Directory](/tags/active-directory/) [Blind Command Injection](/tags/blind-command-injection/)

A new version of content is available.

 Update


=== Content from www.sourcecodester.com_a5ed4a76_20250111_204101.html ===

[Skip to main content](#main-content)

[![sourcecodester logo](/sites/default/files/logo.png)](/)

Toggle navigation

## Main navigation

* [Home](/)
* [Blog](/blog)
* +
  [Projects](/project)
  + [C# Projects](/c-sharp-project)
  + [PHP Projects](/php-project)
  + [Visual Basic Projects](/visual-basic-project)
* +
  [Programming](/programming)
  + [Python](/python)
  + [PHP](/php)
  + [Visual Basic .NET](/visual-basic-net)
  + [Visual Basic](/visual-basic)
  + [C#](/c-sharp)
  + [Java](/java)
  + [JavaScript](/javascript)
  + [C/C++](/cpp)
  + [ASP/ASP.NET](/asp)
  + [HTML/CSS](/html)
  + [Microsoft Access](/microsoft-access)
  + [Assembly](/assembly)
  + [Assembly](/assembly)
  + [Delphi](/delphi)
  + [Other](/other)
  + [SAP/ABAP](/sap)
  + [SQL](/sql)
  + [Visual FoxPro](/foxpro)
* +
  Compilers
  + [Online Python Compiler](https://www.sourcecodester.com/online-python-compiler.html)
  + [Online PHP Compiler](https://www.sourcecodester.com/online-php-compiler.html)
  + [Online JavaScript Compiler](https://www.sourcecodester.com/online-javascript-compiler.html)
* +
  [Mobile](/mobile)
  + [Android](/android)
  + [Firefox OS](/firefox-os)
  + [Windows Phone](/windows-phone)
  + [iOS](/ios)
* +
  [Tutorials](/tutorial)
  + [ASP/ASP.NET](/tutorial/asp)
  + [C#](/tutorial/c-sharp)
  + [C/C++](/tutorial/cpp)
  + [HTML/CSS Tutorial](/tutorial/html)
  + [Java Tutorial](/tutorial/java)
  + [JavaScript Tutorial](/tutorial/javascript)
  + [PHP](/tutorial/php)
  + [Python](/tutorial/python)
  + [Visual Basic .NET](/tutorial/visual-basic-net)
* [Contact](/contact)
* [Submit Code](/user/login?destination=submit-code)
* [Log In](/user/login)

1. [PHP](/php)
2. Resort Reservation System in PHP and SQLite3 Source Code Free Download

# Resort Reservation System in PHP and SQLite3 Source Code Free Download

Submitted by [oretnom23](/users/tips23 "View user profile.") on Saturday, April 15, 2023 - 15:51.
Language
[PHP](/language/php)

 [![](/sites/default/files/styles/large/public/images/oretnom23/php-sqlite-rrs-banner.jpg?itok=BN2Rfrbm)](/sites/default/files/images/oretnom23/php-sqlite-rrs-banner.jpg)

This simple project is entitled **Resort Reservation System**. It is a simple web application that provides an automated platform for certain resort management to easily store and retrieve reservation records. It was mainly developed using **PHP Language** and **SQLite3 Database**. It has a simple and pleasant user interface using **Bootstrap v5 Framework**. The project contains [**CRUD**](https://www.sourcecodester.com/tutorials/php/12699/php-simple-crud-sqlite-using-pdo.html) *(Create, Read, Update, and Delete)* Operations and user-friendly features and functionalities.

## **How does the Resort Reservation System work?**

This **Resort Reservation System** was mainly developed and can only be accessed by the resort management. Here, resort management can [dynamically](https://www.sourcecodester.com/php/14479/dynamic-transaction-queuing-system-using-phpmysql-source-code.html) list all the rooms/cottages and extra fees that are available at their resort. They can simply encode or store their customer reservation records along with some other charges. Using the system, users can encode first the customer reservation details and the room or cottage they wanted to take and add extra fees or charges when the customer checked in.

## **Features and Functionalities**

This **Resort Reservation System** project contains the following features and functionalities:

* **Login and Logout**
* **Room/Cottage Management**
  + **Add New Room/Cottage**
  + **List All Rooms/Cottages**
  + **Update Room/Cottage Details**
  + **View Room/Cottage Details**
  + **Delete Room/Cottage**
* **Extra Fee Management**
  + **Add New Extra Fee**
  + **List All Extra Fees**
  + **Update Extra Fee Details**
  + **View Extra Fee Details**
  + **Delete Extra Fee**
* **[Reservation](https://www.sourcecodester.com/php/14923/shipferry-ticket-reservation-system-using-php-free-source-code.html) Management**
  + **Add New Reservation**
  + **List All Reservation**
  + **Update Reservation Details**
  + **View Reservation Details**
  + **Delete Reservation**
* **User Management**
  + **Add New User**
  + **List All Users**
  + **Update User Details**
  + **View User Details**
  + **Delete User**

## **Technologies**

This **Resort Reservation System** was developed using the following technologies:

* **XAMPP**
* **VS Code Editor**
* **HTML**
* **CSS**
* **PHP**
* **SQLite3**
* **JavaScript**
* **jQuery**
* **Ajax Request**
* **Bootstrap Framework**
* **Google Icons**

## **Snapshots**

Here are some snapshots of some pages of this **Resort Reservation System**:

### **Login Page**

[![Resort Reservation System in PHP and SQLite3](/sites/default/files/images/oretnom23/php-sqlite-rrs-login.jpg)](https://www.sourcecodester.com/sites/default/files/images/oretnom23/php-sqlite-rrs-login.jpg)

### **Home Page**

[![Resort Reservation System in PHP and SQLite3](/sites/default/files/images/oretnom23/php-sqlite-rrs-home.jpg)](https://www.sourcecodester.com/sites/default/files/images/oretnom23/php-sqlite-rrs-home.jpg)

### **Room and Cottages List**

[![Resort Reservation System in PHP and SQLite3](/sites/default/files/images/oretnom23/php-sqlite-rrs-room-list.jpg)](https://www.sourcecodester.com/sites/default/files/images/oretnom23/php-sqlite-rrs-room-list.jpg)

### **Extra Fees List**

[![Resort Reservation System in PHP and SQLite3](/sites/default/files/images/oretnom23/php-sqlite-rrs-fee-list.jpg)](https://www.sourcecodester.com/sites/default/files/images/oretnom23/php-sqlite-rrs-fee-list.jpg)

### **Reservation List**

[![Resort Reservation System in PHP and SQLite3](/sites/default/files/images/oretnom23/php-sqlite-rrs-reservation-list.jpg)](https://www.sourcecodester.com/sites/default/files/images/oretnom23/php-sqlite-rrs-reservation-list.jpg)

### **Reservation Details**

[![Resort Reservation System in PHP and SQLite3](/sites/default/files/images/oretnom23/php-sqlite-rrs-reservation-details.jpg)](https://www.sourcecodester.com/sites/default/files/images/oretnom23/php-sqlite-rrs-reservation-details.jpg)

The **Resort Reservation System** project complete source code zip file is available on this website and is free to download. Feel free to download and modify the source code the way you desire. The project was mainly developed for educational purposes only and not commercially.

## **How to Run**

**Requirements**

* **Download** and **Install** any **local web server** such as **XAMPP/WAMP.**
* **Download** the provided source code **zip** file. (*download button is located below*)

**Installation/Setup**

1. Open your XAMPP/WAMP `php.ini` file and uncomment the **sqlite3** **extension**. Then, save the file.
2. **Open** your **XAMPP/WAMP's Control Panel** and start ****Apache****.
3. **Extract** the **downloaded source code **zip** file**.
4. If you are using **XAMPP**, **copy** the extracted source code folder and **paste** it into the **XAMPP's "htdocs" directory**. And If you are using **WAMP**, **paste** it into the **"www" directory.**
5. **Browse** the **Resort Reservation System** in a **browser**. i.e. ****http://localhost/php-sqlite-cqs/****.

### **Default Admin Access**

Username: **admin**

Password: **sourcecodester&123**

That's it! I hope this **Resort Reservation System in PHP and SQLite3 Source Code** will help you with what you are looking for and that you'll find something useful for your current and future **PHP Projects**.

Explore more on this website for more **Tutorials** and **Free Source Codes**.

### **Enjoy =)**

Note: Due to the size or complexity of this submission, the author has submitted it as a .zip file to shorten your download time. After downloading it, you will need a program like Winzip to decompress it.

Virus note: All files are scanned once-a-day by SourceCodester.com for viruses, but new viruses come out every day, so no prevention program can catch 100% of them.

FOR YOUR OWN SAFETY, PLEASE:

1. Re-scan downloaded files using your personal virus checker before using it.

2. NEVER, EVER run compiled files (.exe's, .ocx's, .dll's etc.)--only run source code.

Tags
[php](/tags/php-1)
[SQLite](/tags/sqlite-0)
[SQLite3 Database](/tags/sqlite3-database)
[PHP and SQLite3 Integration](/tags/php-and-sqlite3-integration)
[Resort Reservation](/tags/resort-reservation)
[Simple Reservation in PHP](/tags/simple-reservation-php)
[Open-source PHP Project](/tags/open-source-php-project-0)
[HTML](/tags/html-0)
[css](/tags/css)
[Javascript](/tags/javascript)
[jQuery](/tags/jquery-0)
[AJAX](/tags/ajax-2)
[Bootstrap](/tags/bootstrap)
[Google Icons](/tags/google-icons)

## Add new comment

Your name

Comment

Text format
Filtered HTMLFull HTML 1

[About text formats](/filter/tips "Opens in new window")

Subject

Save
Preview

* 9624 views

## Share Source Code or Tutorial

Do you have source code, articles, tutorials or thesis to share? Submit it here by clicking the link below

## [Submit now...](//www.sourcecodester.com/user/login?destination=submit)

## Popular Source Code

[Free and Open Source inventory management system php source code](/php/16741/free-and-open-source-inventory-management-system-php-source-code.html)
[PHP Task Management System Free Download](/php/17217/employee-management-system-php-and-mysql-free-download.html)
[Online Voting System using PHP Free Source Code](/php/4808/voting-system-php.html)
[Event Management System Project in PHP with Source Code](/php/15238/event-management-system-project-php-source-code.html)
[Online Learning Management System using PHP/MySQLi with Source Code](/php/7339/learning-management-system.html)
[Doctor's Appointment System using PHP Free Source Code](/hashenudara/simple-doctors-appointment-project.html)
[Employee Management System using PHP and MySQL](/php/16999/employee-management-system.html)
[Simple Student Attendance System using PHP and MySQL](/php/17018/simple-student-attendance-system-using-php-and-mysql.html)
[Best house rental management system project in php](/php/17375/best-courier-management-system-project-php.html)
[Online Pet Shop We App using PHP and PayPal Free Source Code](/php/14839/online-pet-shop-we-app-using-php-and-paypal-free-source-code.html)

## User account menu

* [Log in](/user/login)

## Book navigation

* [SQL Tutorial](/Tutorials/sql/sql-tutorial.html)

* [PHP Tutorial](/tutorials/php/php-tutorial.html)

* [CodeIgniter Tutorial](/book/4810/codeigniter-tutorial.html)

* [Android Tutorial](/book/5225/android-tutorial.html)

* [Visual Basic Tutorial](/book/5645/visual-basic-tutorial.html)

* [C# Tutorial](/book/6085/c-tutorial.html)

* [CSS Tutorial](/tutorials/htmlcss/6382/css-tutorial.html)

* [Learn C in 15 Days](/book/7551/learn-c-15-days.html)

* [Object Oriented Programming in C++](/book/7670/object-oriented-programming-c.html)

* [Data Structures in C++](/book/7757/data-structures-cpp.html)

* [Fundamentals of C Language](/book/7948/fundamentals-c-language.html)

* [Learn Object Oriented Programming in C++](/book/8090/learn-object-oriented-programming-c.html)

* [Java Tutorial](/tutorials/java/9467/java-tutorial.html)

* [Python Tutorial](/book/python/14118/python-tutorial.html)

## Recent content

* [Dice Roll Game using HTML & CSS in VanillaJS with Source Code](/javascript/17838/dice-roll-game-using-html-css-vanillajs-source-code.html)3 hours 37 minutes ago
* [How to Remove Punctuation Marks in a String using Python](/tutorial/python/17839/how-remove-punctuation-marks-string-using-python)3 hours 51 minutes ago
* [Step-by-Step Guide to Creating a 3D Layer Effect with HTML and CSS](/tutorial/htmlcss/17837/how-step-step-guide-creating-3d-layer-effect-html-css-and-javascript)11 hours 32 minutes ago
* [Vote Tally App Using HTML, CSS and JavaScript with Source Code](/javascript/17836/vote-tally-app-using-html-css-and-javascript-source-code.html)12 hours 26 minutes ago
* [Event ID Badge Generator Using HTML, CSS and JavaScript with Source Code](/javascript/17835/event-id-badge-generator-using-html-css-and-javascript-source-code.html)14 hours ago
* [Color Guessing Game using HTML & CSS in VanillaJS with Source Code](/javascript/17833/color-guessing-game-using-html-css-vanillajs-source-code.html)1 day 3 hours ago
* [How Read a File Line by Line Into a List in Python](/tutorial/python/17834/how-read-file-line-line-list-python)1 day 3 hours ago
* [Login System with Forgot Password Using PHP, MySQL and PHPMailer](/php/17832/login-system-forgot-password-using-php-mysql-and-phpmailer.html)1 day 11 hours ago
* [Schedule Maker App Using HTML, CSS and JavaScript with Source Code](/javascript/17831/schedule-maker-app-using-html-css-and-javascript-source-code.html)1 day 17 hours ago
* [Digital Piano App using HTML & CSS in VanillaJS with Source Code](/javascript/17829/digital-piano-app-using-html-css-vanillajs-source-code.html)2 days 3 hours ago

 [Advertise Here](https://www.sourcecodester.com/advertise-us.html) | [FAQ](https://www.sourcecodester.com/faq) | [Forums](https://www.sourcecodester.com/forum) | [About Us](https://www.sourcecodester.com/about-sourcecodester.html) | [Hire Us](https://www.sourcecodester.com/hire-us-do-your-work.html)

---

 [Privacy Statement](https://www.sourcecodester.com/privacy.html) | [Disclaimer](https://www.sourcecodester.com/disclaimer.html) |  [Terms and Agreement](/terms-and-conditions.html)


