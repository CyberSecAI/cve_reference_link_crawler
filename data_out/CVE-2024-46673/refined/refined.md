```
{
  "vulnerability_details": {
    "root_cause": "The `aac_init_adapter()` function in the `aacraid` driver allocates memory for `aac_dev::queues`. If `aac_comm_init()` or `aac_fib_setup()` fail, the allocated memory is freed using `kfree(dev->queues)`, but the `dev->queues` pointer is not set to `NULL`. Consequently, if the hardware-specific init function in `aac_probe_one()` returns an error, the error path in `aac_probe_one()` attempts to free `dev->queues` again leading to a double-free.",
    "weaknesses": [
      "Double-free vulnerability",
      "Memory management error"
    ],
    "impact": "A double-free vulnerability can lead to memory corruption and potential system instability or crashes. It might be exploitable for arbitrary code execution in certain scenarios.",
     "attack_vectors": "The vulnerability is triggered during the driver initialization process, specifically in the `aac_probe_one()` function when the initialization of the hardware adapter fails, triggering the error path.",
    "required_capabilities": "An attacker would need to trigger the probe function of the aacraid driver with a device that will cause the init function `aac_init_adapter()` to fail after the memory allocation for `queues` to be successful."
  },
  "affected_component": "Linux Kernel aacraid driver",
    "fix_details": "The fix involves setting `dev->queues = NULL` after freeing the memory with `kfree(dev->queues)` in `aac_init_adapter()` during error conditions. This prevents the double-free in the error path of `aac_probe_one()`.",
  "content_relation": "The content is directly related to the CVE, providing detailed information about the double-free vulnerability and its fix."
}
```