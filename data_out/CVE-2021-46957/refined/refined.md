Based on the provided information, this content relates to CVE-2021-46957.

**Root Cause:**
The vulnerability stems from a race condition during kprobe handling on the RISC-V architecture. Specifically, when a kprobe is set at the entry of `sys_read`, the process of single-stepping through the original instruction can lead to an "Instruction page fault" exception. The page fault handler incorrectly overwrites the saved interrupt enable flag (SIE bit in sstatus) in the `pt_regs` structure. This leads to the interrupt being disabled when it's needed, causing a kernel panic in `__find_get_block`.

**Weaknesses/Vulnerabilities:**
- **Incorrect sstatus restoration:** The kprobe fault handler does not properly restore the saved `sstatus` value from `pt_regs` when a page fault occurs during single stepping, specifically when the `sstatus` register has interrupt disabled. This leads to an incorrect sstatus value being used later on.
- **Race condition during single-step:** When a page fault occurs during the single-step execution of an instruction which is being probed by kprobe, the process of restoring sstatus is not properly handled.

**Impact of Exploitation:**
- **Kernel panic:** The immediate impact is a kernel panic, causing a denial of service. The system becomes unstable and requires a reboot.

**Attack Vectors:**
- The vulnerability is triggered by setting a kprobe at the entry of the `sys_read` system call on RISC-V architecture. Then executing any code that calls the `sys_read`.
- Specifically, it requires triggering a page fault during the single-step execution of the instruction probed by kprobe.

**Required Attacker Capabilities/Position:**
- The attacker needs to have the capability to set up kprobes, which usually requires root privileges.
- The attacker also needs to trigger the vulnerable code path of the kprobe and `sys_read`.