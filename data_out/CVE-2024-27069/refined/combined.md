=== Content from git.kernel.org_cb6d7c10_20250111_095425.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=77a28aa476873048024ad56daf8f4f17d58ee48e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=77a28aa476873048024ad56daf8f4f17d58ee48e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=77a28aa476873048024ad56daf8f4f17d58ee48e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=77a28aa476873048024ad56daf8f4f17d58ee48e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Amir Goldstein <amir73il@gmail.com> | 2024-03-17 13:59:43 +0200 |
| --- | --- | --- |
| committer | Amir Goldstein <amir73il@gmail.com> | 2024-03-17 15:59:41 +0200 |
| commit | [77a28aa476873048024ad56daf8f4f17d58ee48e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=77a28aa476873048024ad56daf8f4f17d58ee48e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=77a28aa476873048024ad56daf8f4f17d58ee48e)) | |
| tree | [94e3c50296b58d7d48c3e6025f11b5256eeac782](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=77a28aa476873048024ad56daf8f4f17d58ee48e) | |
| parent | [1b17f399a6e07405059fe401cfbe59f9b572093d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1b17f399a6e07405059fe401cfbe59f9b572093d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=77a28aa476873048024ad56daf8f4f17d58ee48e&id2=1b17f399a6e07405059fe401cfbe59f9b572093d)) | |
| download | [linux-77a28aa476873048024ad56daf8f4f17d58ee48e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-77a28aa476873048024ad56daf8f4f17d58ee48e.tar.gz) | |

ovl: relax WARN\_ON in ovl\_verify\_area()syzbot hit an assertion in copy up data loop which looks like it is
the result of a lower file whose size is being changed underneath
overlayfs.
This type of use case is documented to cause undefined behavior, so
returning EIO error for the copy up makes sense, but it should not be
causing a WARN\_ON assertion.
Reported-and-tested-by: syzbot+3abd99031b42acf367ef@syzkaller.appspotmail.com
Fixes: ca7ab482401c ("ovl: add permission hooks outside of do\_splice\_direct()")
Signed-off-by: Amir Goldstein <amir73il@gmail.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=77a28aa476873048024ad56daf8f4f17d58ee48e)

| -rw-r--r-- | [fs/overlayfs/copy\_up.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/overlayfs/copy_up.c?id=77a28aa476873048024ad56daf8f4f17d58ee48e) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 3 deletions

| diff --git a/fs/overlayfs/copy\_up.c b/fs/overlayfs/copy\_up.cindex 8586e2f5d24390..0762575a1e7080 100644--- a/[fs/overlayfs/copy\_up.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/overlayfs/copy_up.c?id=1b17f399a6e07405059fe401cfbe59f9b572093d)+++ b/[fs/overlayfs/copy\_up.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/overlayfs/copy_up.c?id=77a28aa476873048024ad56daf8f4f17d58ee48e)@@ -234,11 +234,11 @@ static int ovl\_verify\_area(loff\_t pos, loff\_t pos2, loff\_t len, loff\_t totlen) { loff\_t tmp; - if (WARN\_ON\_ONCE(pos != pos2))+ if (pos != pos2) return -EIO;- if (WARN\_ON\_ONCE(pos < 0 || len < 0 || totlen < 0))+ if (pos < 0 || len < 0 || totlen < 0) return -EIO;- if (WARN\_ON\_ONCE(check\_add\_overflow(pos, len, &tmp)))+ if (check\_add\_overflow(pos, len, &tmp)) return -EIO; return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:53:02 +0000



=== Content from git.kernel.org_fdfe1f21_20250111_095425.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Amir Goldstein <amir73il@gmail.com> | 2024-03-17 13:59:43 +0200 |
| --- | --- | --- |
| committer | Sasha Levin <sashal@kernel.org> | 2024-03-26 18:17:28 -0400 |
| commit | [c3c85aefc0da1e5074a06c682542a54ccc99bdca](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca)) | |
| tree | [580057e1e265dab0d6864177b433ca9610523538](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca) | |
| parent | [dac068f164ad05b35e7c0be13f138c3f6adca58f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dac068f164ad05b35e7c0be13f138c3f6adca58f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca&id2=dac068f164ad05b35e7c0be13f138c3f6adca58f)) | |
| download | [linux-c3c85aefc0da1e5074a06c682542a54ccc99bdca.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c3c85aefc0da1e5074a06c682542a54ccc99bdca.tar.gz) | |

ovl: relax WARN\_ON in ovl\_verify\_area()[ Upstream commit 77a28aa476873048024ad56daf8f4f17d58ee48e ]
syzbot hit an assertion in copy up data loop which looks like it is
the result of a lower file whose size is being changed underneath
overlayfs.
This type of use case is documented to cause undefined behavior, so
returning EIO error for the copy up makes sense, but it should not be
causing a WARN\_ON assertion.
Reported-and-tested-by: syzbot+3abd99031b42acf367ef@syzkaller.appspotmail.com
Fixes: ca7ab482401c ("ovl: add permission hooks outside of do\_splice\_direct()")
Signed-off-by: Amir Goldstein <amir73il@gmail.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca)

| -rw-r--r-- | [fs/overlayfs/copy\_up.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/overlayfs/copy_up.c?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 3 deletions

| diff --git a/fs/overlayfs/copy\_up.c b/fs/overlayfs/copy\_up.cindex 8586e2f5d24390..0762575a1e7080 100644--- a/[fs/overlayfs/copy\_up.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/overlayfs/copy_up.c?id=dac068f164ad05b35e7c0be13f138c3f6adca58f)+++ b/[fs/overlayfs/copy\_up.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/overlayfs/copy_up.c?id=c3c85aefc0da1e5074a06c682542a54ccc99bdca)@@ -234,11 +234,11 @@ static int ovl\_verify\_area(loff\_t pos, loff\_t pos2, loff\_t len, loff\_t totlen) { loff\_t tmp; - if (WARN\_ON\_ONCE(pos != pos2))+ if (pos != pos2) return -EIO;- if (WARN\_ON\_ONCE(pos < 0 || len < 0 || totlen < 0))+ if (pos < 0 || len < 0 || totlen < 0) return -EIO;- if (WARN\_ON\_ONCE(check\_add\_overflow(pos, len, &tmp)))+ if (check\_add\_overflow(pos, len, &tmp)) return -EIO; return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:53:03 +0000


