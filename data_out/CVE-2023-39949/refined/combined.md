=== Content from github.com_a2fc4e58_20250111_164251.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fsecurity%2Fadvisories%2FGHSA-3jv9-j9x3-95cg)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fsecurity%2Fadvisories%2FGHSA-3jv9-j9x3-95cg)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  787](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  48](/eProsima/Fast-DDS/issues)
* [Pull requests
  78](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

# Improper validation of sequence numbers leading to remotely reachable assertion failure

High

[MiguelCompany](/MiguelCompany)
published
GHSA-3jv9-j9x3-95cg
Aug 11, 2023

## Package

Fast-DDS

## Affected versions

< 2.9.1

## Patched versions

2.9.1 / 2.6.5

## Description

### Summary

This was reported as [#3236](https://github.com/eProsima/Fast-DDS/issues/3236).

Opening an advisory for CVE assignment as per the request of Miguel.

### Details

Hexdump of a (semantically) malformed RTPS heartbeat message:

```
0000  45 00 00 68 00 01 40 00 40 11 D9 76 80 3D F0 CF  E..h..@.@..v.=..
0010  EF FF 00 01 05 39 1C E8 00 54 08 B9 52 54 50 53  .....9...T..RTPS
0020  02 04 01 0F 01 03 02 42 AC 11 00 02 45 E5 E2 FD  .......B....E...
0030  07 BF 34 00 00 00 10 00 00 00 00 00 00 01 00 C2  ..4.............
0040  00 00 00 00 A7 9B EA 8C BE ED DC CB 00 03 00 00  ................
0050  77 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00  w...............
0060  00 00 00 00 00 00 00 00                          ........

```

This heartbeat submessage has bad sequence numbers, i.e.,

```
firstSN.high = 0xc2000100 // -1040187136
firstSN.low = 0x00

lastSN.high = 0x8cea9ba7
lastSN.low = 0xcbdcedbe

```

The sanity check line at [MessageReceiver.cpp:1057](https://github.com/eProsima/Fast-DDS/blob/v2.9.0/src/cpp/rtps/messages/MessageReceiver.cpp#L1059), invokes the `-` operator (`firstSN - 1`):

```
inline SequenceNumber_t operator -(
        const SequenceNumber_t& seq,
        const uint32_t inc) noexcept
{
    SequenceNumber_t res(seq.high, seq.low - inc);

    if (inc > seq.low)
    {
        // Being the type of the parameter an 'uint32_t', the decrement of 'high' will be as much as 1.
        assert(0 < res.high);
        --res.high;
    }

    return res;
}

```

in which `inc (== 1) > seq.low (== 0)` is `false` and the assert() inside is triggered as `0 < res.high (== -1040187136)` is `false`.

### PoC

Run any fastdds process on domain 0.

Send the RTPS packet above to 127.0.0.1:7400.

### Impact

This can remotely crash any Fast-DDS process.

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-39949

### Weaknesses

[CWE-617](/advisories?query=cwe%3A617)

### Credits

* [![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617)
  [squizz617](/squizz617)
  Reporter

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from www.debian.org_b13f5b96_20250111_164252.html ===


---

[[Date Prev](msg00172.html)][[Date Next](msg00174.html)]
[[Thread Prev](msg00172.html)][[Thread Next](msg00174.html)]
[[Date Index](maillist.html#00173)]
[[Thread Index](threads.html#00173)]

# [SECURITY] [DSA 5481-1] fastdds security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5481-1] fastdds security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 20 Aug 2023 17:44:52 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZOJRFLYFwem2LOtP%40seger.debian.org)Â [ZOJRFLYFwem2LOtP@seger.debian.org](msg00173.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5481-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
August 20, 2023                       <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : fastdds
CVE ID         : CVE-2023-39534 CVE-2023-39945 CVE-2023-39946 CVE-2023-39947
                 CVE-2023-39948 CVE-2023-39949

Multipe security issues were discovered in Fast DDS, a C++ implementation
of the DDS (Data Distribution Service), which might result in denial of
service or potentially the execution of arbitrary code when processing
malformed RTPS packets.

For the oldstable distribution (bullseye), these problems have been fixed
in version 2.1.0+ds-9+deb11u1.

For the stable distribution (bookworm), these problems have been fixed in
version 2.9.1+ds-1+deb12u1.

We recommend that you upgrade your fastdds packages.

For the detailed security status of fastdds please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/fastdds>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmTiT8EACgkQEMKTtsN8
TjYjMRAAhNc26qPpZ0p9Jnbujlg6M6j1YFLLSv0wBH0bwG41mJthfVaB7pjPWhS1
jABPZ8whfOwPXqigcXWSpDqVO0JrVzyI2uLtyrm0TNaf1y8extPrqQRL1epPNJvh
AjXjX+CSRSSp20mEGr9bYg2a/FWnt60Vx+enyWd3xJE0KLucfkstNkD5cNv8Szxz
I/Qnb5bnmjEE1UKzaZgOLaw1rciCAvlsmoORMqps+FxIXm1KqdGtLKBNta3Y/vrr
QQMrK+oCsQkclQeC5Zm5BT6TNuRz7g6imEFP5bZCEkX0XNnZpF1tCSOSQ9z0CR3B
4QuGhV8jIcArTwLEns5U3yZr8XgSqiXAoAdL8uVBZ1a67ZFktz2riKz8AYAQiBhj
o58N4aYxjQnqw5h6OmIiuwl3QuYW1AhTQ5JyLNBrhBx/xBLznZtWkg5YBi3lzOVQ
KIh7fOO0lzpkgXVgf4ggeBuF9K/8fes89QjlIN3PzUYiVAA/Uu0XpTCocBALlsKP
rv5eZJkxKAyqrcCGzOBodhoMOKm+SeCKhrc/t2kQnD9G0MPk7eY/Gm26Oms0FHzE
IR5gcPvnIQ0p+N2psu/YNxboeBrycxxN2nCnjAReO4U4kcfycOCG66ogTGWEEUb0
/UbqHYjBiC3Z/wDzYtE8tni9HktHn0E1aYj5xgdtc4X92TioNrE=
=ALwP
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_6cfb53e5_20250111_164250.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fblob%2Fv2.9.0%2Fsrc%2Fcpp%2Frtps%2Fmessages%2FMessageReceiver.cpp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fblob%2Fv2.9.0%2Fsrc%2Fcpp%2Frtps%2Fmessages%2FMessageReceiver.cpp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  787](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS/tree/v2.9.0)
* [Issues
  48](/eProsima/Fast-DDS/issues)
* [Pull requests
  78](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS/tree/v2.9.0)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

## Files

Â v2.9.0
## Breadcrumbs

1. [Fast-DDS](/eProsima/Fast-DDS/tree/v2.9.0)
2. /[src](/eProsima/Fast-DDS/tree/v2.9.0/src)
3. /[cpp](/eProsima/Fast-DDS/tree/v2.9.0/src/cpp)
4. /[rtps](/eProsima/Fast-DDS/tree/v2.9.0/src/cpp/rtps)
5. /[messages](/eProsima/Fast-DDS/tree/v2.9.0/src/cpp/rtps/messages)
/
# MessageReceiver.cpp

Copy path Blame  Blame
## Latest commit

## History

[History](/eProsima/Fast-DDS/commits/v2.9.0/src/cpp/rtps/messages/MessageReceiver.cpp)1424 lines (1257 loc) Â· 43.8 KBÂ v2.9.0
## Breadcrumbs

1. [Fast-DDS](/eProsima/Fast-DDS/tree/v2.9.0)
2. /[src](/eProsima/Fast-DDS/tree/v2.9.0/src)
3. /[cpp](/eProsima/Fast-DDS/tree/v2.9.0/src/cpp)
4. /[rtps](/eProsima/Fast-DDS/tree/v2.9.0/src/cpp/rtps)
5. /[messages](/eProsima/Fast-DDS/tree/v2.9.0/src/cpp/rtps/messages)
/
# MessageReceiver.cpp

Top
## File metadata and controls

* Code
* Blame

1424 lines (1257 loc) Â· 43.8 KB[Raw](https://github.com/eProsima/Fast-DDS/raw/refs/tags/v2.9.0/src/cpp/rtps/messages/MessageReceiver.cpp)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000// Copyright 2016 Proyectos y Sistemas de Mantenimiento SL (eProsima).//// Licensed under the Apache License, Version 2.0 (the "License");// you may not use this file except in compliance with the License.// You may obtain a copy of the License at//// http://www.apache.org/licenses/LICENSE-2.0//// Unless required by applicable law or agreed to in writing, software// distributed under the License is distributed on an "AS IS" BASIS,// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.// See the License for the specific language governing permissions and// limitations under the License.
/\*\* \* @file MessageReceiver.cpp \* \*/
#include <fastdds/rtps/messages/MessageReceiver.h>
#include <cassert>#include <limits>
#include <fastdds/core/policy/ParameterList.hpp>#include <fastdds/dds/log/Log.hpp>#include <fastdds/rtps/reader/RTPSReader.h>#include <fastdds/rtps/writer/RTPSWriter.h>#include <fastrtps/utils/shared\_mutex.hpp>
#include <rtps/participant/RTPSParticipantImpl.h>#include <statistics/rtps/StatisticsBase.hpp>#include <statistics/rtps/messages/RTPSStatisticsMessages.hpp>
#define INFO\_SRC\_SUBMSG\_LENGTH 20
#define IDSTRING "(ID:" << std::this\_thread::get\_id() << ") " <<
using ParameterList = eprosima::fastdds::dds::ParameterList;
namespace eprosima {namespace fastrtps {namespace rtps {
MessageReceiver::MessageReceiver( RTPSParticipantImpl\* participant, uint32\_t rec\_buffer\_size) : participant\_(participant) , source\_version\_(c\_ProtocolVersion) , source\_vendor\_id\_(c\_VendorId\_Unknown) , source\_guid\_prefix\_(c\_GuidPrefix\_Unknown) , dest\_guid\_prefix\_(c\_GuidPrefix\_Unknown) , have\_timestamp\_(false) , timestamp\_(c\_TimeInvalid)#if HAVE\_SECURITY , crypto\_msg\_(participant->is\_secure() ? rec\_buffer\_size : 0) , crypto\_submsg\_(participant->is\_secure() ? rec\_buffer\_size : 0) , crypto\_payload\_(participant->is\_secure() ? rec\_buffer\_size : 0)#endif // if HAVE\_SECURITY{ (void)rec\_buffer\_size; EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, "Created with CDRMessage of size: " << rec\_buffer\_size);
#if HAVE\_SECURITY if (participant->is\_secure()) { process\_data\_message\_function\_ = std::bind( &MessageReceiver::process\_data\_message\_with\_security, this, std::placeholders::\_1, std::placeholders::\_2);
 process\_data\_fragment\_message\_function\_ = std::bind( &MessageReceiver::process\_data\_fragment\_message\_with\_security, this, std::placeholders::\_1, std::placeholders::\_2, std::placeholders::\_3, std::placeholders::\_4, std::placeholders::\_5); } else {#endif // if HAVE SECURITY process\_data\_message\_function\_ = std::bind( &MessageReceiver::process\_data\_message\_without\_security, this, std::placeholders::\_1, std::placeholders::\_2);
 process\_data\_fragment\_message\_function\_ = std::bind( &MessageReceiver::process\_data\_fragment\_message\_without\_security, this, std::placeholders::\_1, std::placeholders::\_2, std::placeholders::\_3, std::placeholders::\_4, std::placeholders::\_5);#if HAVE\_SECURITY}
#endif // if HAVE SECURITY}
MessageReceiver::~MessageReceiver(){ EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, ""); assert(associated\_writers\_.empty()); assert(associated\_readers\_.empty());}
 #if HAVE\_SECURITYvoid MessageReceiver::process\_data\_message\_with\_security( const EntityId\_t& reader\_id, CacheChange\_t& change){ auto process\_message = [&change, this](RTPSReader\* reader) { if (!reader->getAttributes().security\_attributes().is\_payload\_protected) { reader->processDataMsg(&change); return; }
 if (!reader->matched\_writer\_is\_matched(change.writerGUID)) { return; }
 if (!participant\_->security\_manager().decode\_serialized\_payload(change.serializedPayload, crypto\_payload\_, reader->getGuid(), change.writerGUID)) { return; }
 std::swap(change.serializedPayload.data, crypto\_payload\_.data); std::swap(change.serializedPayload.length, crypto\_payload\_.length);
 SerializedPayload\_t original\_payload = change.serializedPayload; reader->processDataMsg(&change); IPayloadPool\* payload\_pool = change.payload\_owner(); if (payload\_pool) { payload\_pool->release\_payload(change); change.serializedPayload = original\_payload; } original\_payload.data = nullptr; std::swap(change.serializedPayload.data, crypto\_payload\_.data); std::swap(change.serializedPayload.length, crypto\_payload\_.length); };
 findAllReaders(reader\_id, process\_message);}
void MessageReceiver::process\_data\_fragment\_message\_with\_security( const EntityId\_t& reader\_id, CacheChange\_t& change, uint32\_t sample\_size, uint32\_t fragment\_starting\_num, uint16\_t fragments\_in\_submessage){ auto process\_message = [&change, sample\_size, fragment\_starting\_num, fragments\_in\_submessage, this](RTPSReader\* reader) { if (!reader->getAttributes().security\_attributes().is\_payload\_protected) { reader->processDataFragMsg(&change, sample\_size, fragment\_starting\_num, fragments\_in\_submessage); return; }
 if (!reader->matched\_writer\_is\_matched(change.writerGUID)) { return; }
 if (!participant\_->security\_manager().decode\_serialized\_payload(change.serializedPayload, crypto\_payload\_, reader->getGuid(), change.writerGUID)) { return; }
 std::swap(change.serializedPayload.data, crypto\_payload\_.data); std::swap(change.serializedPayload.length, crypto\_payload\_.length); reader->processDataFragMsg(&change, sample\_size, fragment\_starting\_num, fragments\_in\_submessage); std::swap(change.serializedPayload.data, crypto\_payload\_.data); std::swap(change.serializedPayload.length, crypto\_payload\_.length); };
 findAllReaders(reader\_id, process\_message);}
#endif // if HAVE SECURITY
void MessageReceiver::process\_data\_message\_without\_security( const EntityId\_t& reader\_id, CacheChange\_t& change){ auto process\_message = [&change](RTPSReader\* reader) { reader->processDataMsg(&change); };
 findAllReaders(reader\_id, process\_message);}
void MessageReceiver::process\_data\_fragment\_message\_without\_security( const EntityId\_t& reader\_id, CacheChange\_t& change, uint32\_t sample\_size, uint32\_t fragment\_starting\_num, uint16\_t fragments\_in\_submessage){ auto process\_message = [&change, sample\_size, fragment\_starting\_num, fragments\_in\_submessage](RTPSReader\* reader) { reader->processDataFragMsg(&change, sample\_size, fragment\_starting\_num, fragments\_in\_submessage); };
 findAllReaders(reader\_id, process\_message);}
void MessageReceiver::associateEndpoint( Endpoint\* to\_add){ std::lock\_guard<eprosima::shared\_mutex> guard(mtx\_); if (to\_add->getAttributes().endpointKind == WRITER) { const auto writer = dynamic\_cast<RTPSWriter\*>(to\_add); for (const auto& it : associated\_writers\_) { if (it == writer) { return; } }
 associated\_writers\_.push\_back(writer); } else { const auto reader = dynamic\_cast<RTPSReader\*>(to\_add); const auto entityId = reader->getGuid().entityId; // search for set of readers by entity ID const auto readers = associated\_readers\_.find(entityId); if (readers == associated\_readers\_.end()) { auto vec = std::vector<RTPSReader\*>(); vec.push\_back(reader); associated\_readers\_.emplace(entityId, vec); } else { for (const auto& it : readers->second) { if (it == reader) { return; } }
 readers->second.push\_back(reader); } }}
void MessageReceiver::removeEndpoint( Endpoint\* to\_remove){ std::lock\_guard<eprosima::shared\_mutex> guard(mtx\_);
 if (to\_remove->getAttributes().endpointKind == WRITER) { auto\* var = dynamic\_cast<RTPSWriter\*>(to\_remove); for (auto it = associated\_writers\_.begin(); it != associated\_writers\_.end(); ++it) { if (\*it == var) { associated\_writers\_.erase(it); break; } } } else { auto readers = associated\_readers\_.find(to\_remove->getGuid().entityId); if (readers != associated\_readers\_.end()) { auto\* var = dynamic\_cast<RTPSReader\*>(to\_remove); for (auto it = readers->second.begin(); it != readers->second.end(); ++it) { if (\*it == var) { readers->second.erase(it); if (readers->second.empty()) { associated\_readers\_.erase(readers); } break; } } } }}
void MessageReceiver::reset(){ source\_version\_ = c\_ProtocolVersion; source\_vendor\_id\_ = c\_VendorId\_Unknown; source\_guid\_prefix\_ = c\_GuidPrefix\_Unknown; dest\_guid\_prefix\_ = c\_GuidPrefix\_Unknown; have\_timestamp\_ = false; timestamp\_ = c\_TimeInvalid;}
void MessageReceiver::processCDRMsg( const Locator\_t& source\_locator, const Locator\_t& reception\_locator, CDRMessage\_t\* msg){ if (msg->length < RTPSMESSAGE\_HEADER\_SIZE) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Received message too short, ignoring"); return; }
#ifdef FUZZING\_BUILD\_MODE\_UNSAFE\_FOR\_PRODUCTION GuidPrefix\_t participantGuidPrefix;#else GuidPrefix\_t participantGuidPrefix = participant\_->getGuid().guidPrefix;#endif // ifdef FUZZING\_BUILD\_MODE\_UNSAFE\_FOR\_PRODUCTION
#if HAVE\_SECURITY security::SecurityManager& security = participant\_->security\_manager(); CDRMessage\_t\* auxiliary\_buffer = &crypto\_msg\_; int decode\_ret = 0;#endif // if HAVE\_SECURITY
 { std::lock\_guard<eprosima::shared\_mutex> guard(mtx\_);
 reset();
 dest\_guid\_prefix\_ = participantGuidPrefix;
 msg->pos = 0; //Start reading at 0
 //Once everything is set, the reading begins: if (!checkRTPSHeader(msg)) { return; }
 notify\_network\_statistics(source\_locator, reception\_locator, msg);
#if HAVE\_SECURITY decode\_ret = security.decode\_rtps\_message(\*msg, \*auxiliary\_buffer, source\_guid\_prefix\_);
 if (decode\_ret < 0) { return; }
 if (decode\_ret == 0) { // The original CDRMessage buffer (msg) now points to the proprietary temporary buffer crypto\_msg\_. // The auxiliary buffer now points to the propietary temporary buffer crypto\_submsg\_. // This way each decoded sub-message will be processed using the crypto\_submsg\_ buffer. msg = auxiliary\_buffer; auxiliary\_buffer = &crypto\_submsg\_; }#endif // if HAVE\_SECURITY }
 // Loop until there are no more submessages // Each submessage processing method choses the lock kind required bool valid; SubmessageHeader\_t submsgh; //Current submessage header
 while (msg->pos < msg->length)// end of the message { CDRMessage\_t\* submessage = msg;
#if HAVE\_SECURITY decode\_ret = security.decode\_rtps\_submessage(\*msg, \*auxiliary\_buffer, source\_guid\_prefix\_);
 if (decode\_ret < 0) { return; }
 if (decode\_ret == 0) { submessage = auxiliary\_buffer; }#endif // if HAVE\_SECURITY
 //First 4 bytes must contain: ID | flags | octets to next header if (!readSubmessageHeader(submessage, &submsgh)) { return; }
 valid = true; uint32\_t next\_msg\_pos = submessage->pos; next\_msg\_pos += (submsgh.submessageLength + 3u) & ~3u; switch (submsgh.submessageId) { case DATA: { if (dest\_guid\_prefix\_ != participantGuidPrefix) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Data Submsg ignored, DST is another RTPSParticipant"); } else { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Data Submsg received, processing."); valid = proc\_Submsg\_Data(submessage, &submsgh); } break; } case DATA\_FRAG: if (dest\_guid\_prefix\_ != participantGuidPrefix) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "DataFrag Submsg ignored, DST is another RTPSParticipant"); } else { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "DataFrag Submsg received, processing."); valid = proc\_Submsg\_DataFrag(submessage, &submsgh); } break; case GAP: { if (dest\_guid\_prefix\_ != participantGuidPrefix) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Gap Submsg ignored, DST is another RTPSParticipant..."); } else { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Gap Submsg received, processing..."); valid = proc\_Submsg\_Gap(submessage, &submsgh); } break; } case ACKNACK: { if (dest\_guid\_prefix\_ != participantGuidPrefix) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Acknack Submsg ignored, DST is another RTPSParticipant..."); } else { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Acknack Submsg received, processing..."); valid = proc\_Submsg\_Acknack(submessage, &submsgh); } break; } case NACK\_FRAG: { if (dest\_guid\_prefix\_ != participantGuidPrefix) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "NackFrag Submsg ignored, DST is another RTPSParticipant..."); } else { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "NackFrag Submsg received, processing..."); valid = proc\_Submsg\_NackFrag(submessage, &submsgh); } break; } case HEARTBEAT: { if (dest\_guid\_prefix\_ != participantGuidPrefix) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "HB Submsg ignored, DST is another RTPSParticipant..."); } else { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Heartbeat Submsg received, processing..."); valid = proc\_Submsg\_Heartbeat(submessage, &submsgh); } break; } case HEARTBEAT\_FRAG: { if (dest\_guid\_prefix\_ != participantGuidPrefix) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "HBFrag Submsg ignored, DST is another RTPSParticipant..."); } else { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "HeartbeatFrag Submsg received, processing..."); valid = proc\_Submsg\_HeartbeatFrag(submessage, &submsgh); } break; } case PAD: EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "PAD messages not yet implemented, ignoring"); break; case INFO\_DST: EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "InfoDST message received, processing..."); valid = proc\_Submsg\_InfoDST(submessage, &submsgh); break; case INFO\_SRC: EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "InfoSRC message received, processing..."); valid = proc\_Submsg\_InfoSRC(submessage, &submsgh); break; case INFO\_TS: { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "InfoTS Submsg received, processing..."); valid = proc\_Submsg\_InfoTS(submessage, &submsgh); break; } case INFO\_REPLY: break; case INFO\_REPLY\_IP4: break; default: break; }
 if (!valid || submsgh.is\_last) { break; }
 submessage->pos = next\_msg\_pos; }
#ifndef FUZZING\_BUILD\_MODE\_UNSAFE\_FOR\_PRODUCTION participant\_->assert\_remote\_participant\_liveliness(source\_guid\_prefix\_);#endif // ifndef FUZZING\_BUILD\_MODE\_UNSAFE\_FOR\_PRODUCTION}
bool MessageReceiver::checkRTPSHeader( CDRMessage\_t\* msg){ //check and proccess the RTPS Header if (msg->buffer[0] != 'R' || msg->buffer[1] != 'T' || msg->buffer[2] != 'P' || msg->buffer[3] != 'S') { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Msg received with no RTPS in header, ignoring..."); return false; }
 msg->pos += 4;
 //CHECK AND SET protocol version if (msg->buffer[msg->pos] == c\_ProtocolVersion.m\_major) { source\_version\_.m\_major = msg->buffer[msg->pos]; msg->pos++; source\_version\_.m\_minor = msg->buffer[msg->pos]; msg->pos++; } else { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Major RTPS Version not supported"); return false; }
 //Set source vendor id source\_vendor\_id\_[0] = msg->buffer[msg->pos]; msg->pos++; source\_vendor\_id\_[1] = msg->buffer[msg->pos]; msg->pos++; //set source guid prefix CDRMessage::readData(msg, source\_guid\_prefix\_.value, GuidPrefix\_t::size); have\_timestamp\_ = false; return true;}
bool MessageReceiver::readSubmessageHeader( CDRMessage\_t\* msg, SubmessageHeader\_t\* smh) const{ if (msg->length - msg->pos < 4) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "SubmessageHeader too short"); return false; }
 smh->submessageId = msg->buffer[msg->pos]; msg->pos++; smh->flags = msg->buffer[msg->pos]; msg->pos++;
 //Set endianness of message msg->msg\_endian = (smh->flags & BIT(0)) != 0 ? LITTLEEND : BIGEND; uint16\_t length = 0; CDRMessage::readUInt16(msg, &length); if (msg->pos + length > msg->length) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "SubMsg of invalid length (" << length << ") with current msg position/length (" << msg->pos << "/" << msg->length << ")"); return false; }
 if ((length == 0) && (smh->submessageId != INFO\_TS) && (smh->submessageId != PAD)) { // THIS IS THE LAST SUBMESSAGE smh->submessageLength = msg->length - msg->pos; smh->is\_last = true; } else { smh->submessageLength = length; smh->is\_last = false; }
 return true;}
bool MessageReceiver::willAReaderAcceptMsgDirectedTo( const EntityId\_t& readerID, RTPSReader\*& first\_reader) const{ first\_reader = nullptr; if (associated\_readers\_.empty()) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Data received when NO readers are listening"); return false; }
 if (readerID != c\_EntityId\_Unknown) { const auto readers = associated\_readers\_.find(readerID); if (readers != associated\_readers\_.end()) { first\_reader = readers->second.front(); return true; } } else { for (const auto& readers : associated\_readers\_) { for (const auto& it : readers.second) { if (it->m\_acceptMessagesToUnknownReaders) { first\_reader = it; return true; } } } }
 EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "No Reader accepts this message (directed to: " << readerID << ")"); return false;}
template<typename Functor>void MessageReceiver::findAllReaders( const EntityId\_t& readerID, const Functor& callback) const{ if (readerID != c\_EntityId\_Unknown) { const auto readers = associated\_readers\_.find(readerID); if (readers != associated\_readers\_.end()) { for (const auto& it : readers->second) { callback(it); } } } else { for (const auto& readers : associated\_readers\_) { for (const auto& it : readers.second) { if (it->m\_acceptMessagesToUnknownReaders) { callback(it); } } } }}
bool MessageReceiver::proc\_Submsg\_Data( CDRMessage\_t\* msg, SubmessageHeader\_t\* smh) const{ eprosima::shared\_lock<eprosima::shared\_mutex> guard(mtx\_);
 //READ and PROCESS if (smh->submessageLength < RTPSMESSAGE\_DATA\_MIN\_LENGTH) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Too short submessage received, ignoring"); return false; } //Fill flags bool values bool endiannessFlag = (smh->flags & BIT(0)) != 0; bool inlineQosFlag = (smh->flags & BIT(1)) != 0; bool dataFlag = (smh->flags & BIT(2)) != 0; bool keyFlag = (smh->flags & BIT(3)) != 0; if (keyFlag && dataFlag) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Message received with Data and Key Flag set, ignoring"); return false; }
 //Assign message endianness if (endiannessFlag) { msg->msg\_endian = LITTLEEND; } else { msg->msg\_endian = BIGEND; }
 //Extra flags don't matter now. Avoid those bytes msg->pos += 2;
 bool valid = true; int16\_t octetsToInlineQos = 0; valid &= CDRMessage::readInt16(msg, &octetsToInlineQos); //it should be 16 in this implementation
 //reader and writer ID RTPSReader\* first\_reader = nullptr; EntityId\_t readerID; valid &= CDRMessage::readEntityId(msg, &readerID);
 //WE KNOW THE READER THAT THE MESSAGE IS DIRECTED TO SO WE LOOK FOR IT: if (!willAReaderAcceptMsgDirectedTo(readerID, first\_reader)) { return false; }
 //FOUND THE READER. //We ask the reader for a cachechange to store the information. CacheChange\_t ch; ch.kind = ALIVE; ch.writerGUID.guidPrefix = source\_guid\_prefix\_; valid &= CDRMessage::readEntityId(msg, &ch.writerGUID.entityId);
 //Get sequence number valid &= CDRMessage::readSequenceNumber(msg, &ch.sequenceNumber);
 if (!valid) { return false; }
 if (ch.sequenceNumber <= SequenceNumber\_t()) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Invalid message received, bad sequence Number"); return false; }
 //Jump ahead if more parameters are before inlineQos (not in this version, maybe if further minor versions.) if (octetsToInlineQos > RTPSMESSAGE\_OCTETSTOINLINEQOS\_DATASUBMSG) { msg->pos += (octetsToInlineQos - RTPSMESSAGE\_OCTETSTOINLINEQOS\_DATASUBMSG); if (msg->pos > msg->length) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Invalid jump through msg, msg->pos " << msg->pos << " > msg->length " << msg->length); return false; } }
 uint32\_t inlineQosSize = 0;
 if (inlineQosFlag) { if (!ParameterList::updateCacheChangeFromInlineQos(ch, msg, inlineQosSize)) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "SubMessage Data ERROR, Inline Qos ParameterList error"); return false; } ch.inline\_qos.data = &msg->buffer[msg->pos - inlineQosSize]; ch.inline\_qos.max\_size = inlineQosSize; ch.inline\_qos.length = inlineQosSize; ch.inline\_qos.encapsulation = endiannessFlag ? PL\_CDR\_LE : PL\_CDR\_BE; ch.inline\_qos.pos = 0; }
 if (dataFlag || keyFlag) { uint32\_t payload\_size; payload\_size = smh->submessageLength - (RTPSMESSAGE\_DATA\_EXTRA\_INLINEQOS\_SIZE + octetsToInlineQos + inlineQosSize);
 if (dataFlag) { uint32\_t next\_pos = msg->pos + payload\_size; if (msg->length >= next\_pos && payload\_size > 0) { ch.serializedPayload.data = &msg->buffer[msg->pos]; ch.serializedPayload.length = payload\_size; ch.serializedPayload.max\_size = payload\_size; msg->pos = next\_pos; } else { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Serialized Payload value invalid or larger than maximum allowed size" "(" << payload\_size << "/" << (msg->length - msg->pos) << ")"); return false; } } else if (keyFlag) { if (payload\_size <= 0) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Serialized Payload value invalid (" << payload\_size << ")"); return false; }
 if (payload\_size <= PARAMETER\_KEY\_HASH\_LENGTH) { memcpy(ch.instanceHandle.value, &msg->buffer[msg->pos], payload\_size); } else { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Ignoring Serialized Payload for too large key-only data (" << payload\_size << ")"); } msg->pos += payload\_size; } }
 // Set sourcetimestamp if (have\_timestamp\_) { ch.sourceTimestamp = timestamp\_; }
 EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "from Writer " << ch.writerGUID << "; possible RTPSReader entities: " << associated\_readers\_.size());
 //Look for the correct reader to add the change process\_data\_message\_function\_(readerID, ch);
 IPayloadPool\* payload\_pool = ch.payload\_owner(); if (payload\_pool) { payload\_pool->release\_payload(ch); }
 //TODO(Ricardo) If an exception is thrown (ex, by fastcdr), these lines are not executed -> segmentation fault ch.serializedPayload.data = nullptr; ch.inline\_qos.data = nullptr;
 EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Sub Message DATA processed"); return true;}
bool MessageReceiver::proc\_Submsg\_DataFrag( CDRMessage\_t\* msg, SubmessageHeader\_t\* smh) const{ eprosima::shared\_lock<eprosima::shared\_mutex> guard(mtx\_);
 //READ and PROCESS if (smh->submessageLength < RTPSMESSAGE\_DATA\_MIN\_LENGTH) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "Too short submessage received, ignoring"); return false; }
 //Fill flags bool values bool endiannessFlag = (smh->flags & BIT(0)) != 0; bool inlineQosFlag = (smh->flags & BIT(1)) != 0; bool keyFlag = (smh->flags & BIT(2)) != 0;
 //Assign message endianness if (endiannessFlag) { msg->msg\_endian = LITTLEEND; } else { msg->msg\_endian = BIGEND; }
 //Extra flags don't matter now. Avoid those bytes msg->pos += 2;
 bool valid = true; int16\_t octetsToInlineQos = 0; valid &= CDRMessage::readInt16(msg, &octetsToInlineQos); //it should be 16 in this implementation
 //reader and writer ID RTPSReader\* first\_reader = nullptr; EntityId\_t readerID; valid &= CDRMessage::readEntityId(msg, &readerID);
 //WE KNOW THE READER THAT THE MESSAGE IS DIRECTED TO SO WE LOOK FOR IT: if (!willAReaderAcceptMsgDirectedTo(readerID, first\_reader)) { return false; }
 //FOUND THE READER. //We ask the reader for a cachechange to store the information. CacheChange\_t ch; ch.writerGUID.guidPrefix = source\_guid\_prefix\_; valid &= CDRMessage::readEntityId(msg, &ch.writerGUID.entityId);
 //Get sequence number valid &= CDRMessage::readSequenceNumber(msg, &ch.sequenceNumber);
 if (ch.sequenceNumber <= SequenceNumber\_t()) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Invalid message received, bad sequence Number"); return false; }
 // READ FRAGMENT NUMBER uint32\_t fragmentStartingNum; valid &= CDRMessage::readUInt32(msg, &fragmentStartingNum);
 // READ FRAGMENTSINSUBMESSAGE uint16\_t fragmentsInSubmessage; valid &= CDRMessage::readUInt16(msg, &fragmentsInSubmessage);
 // READ FRAGMENTSIZE uint16\_t fragmentSize = 0; valid &= CDRMessage::readUInt16(msg, &fragmentSize);
 // READ SAMPLESIZE uint32\_t sampleSize; valid &= CDRMessage::readUInt32(msg, &sampleSize);
 if (!valid) { return false; }
 //Jump ahead if more parameters are before inlineQos (not in this version, maybe if further minor versions.) if (octetsToInlineQos > RTPSMESSAGE\_OCTETSTOINLINEQOS\_DATAFRAGSUBMSG) { msg->pos += (octetsToInlineQos - RTPSMESSAGE\_OCTETSTOINLINEQOS\_DATAFRAGSUBMSG); if (msg->pos > msg->length) { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Invalid jump through msg, msg->pos " << msg->pos << " > msg->length " << msg->length); return false; } }
 uint32\_t inlineQosSize = 0;
 if (inlineQosFlag) { if (!ParameterList::updateCacheChangeFromInlineQos(ch, msg, inlineQosSize)) { EPROSIMA\_LOG\_INFO(RTPS\_MSG\_IN, IDSTRING "SubMessage Data ERROR, Inline Qos ParameterList error"); return false; } ch.inline\_qos.data = &msg->buffer[msg->pos - inlineQosSize]; ch.inline\_qos.max\_size = inlineQosSize; ch.inline\_qos.length = inlineQosSize; ch.inline\_qos.encapsulation = endiannessFlag ? PL\_CDR\_LE : PL\_CDR\_BE; ch.inline\_qos.pos = 0; }
 uint32\_t payload\_size; payload\_size = smh->submessageLength - (RTPSMESSAGE\_DATA\_EXTRA\_INLINEQOS\_SIZE + octetsToInlineQos + inlineQosSize);
 // Validations??? XXX TODO
 if (!keyFlag) { uint32\_t next\_pos = msg->pos + payload\_size; if (msg->length >= next\_pos && payload\_size > 0) { ch.kind = ALIVE; ch.serializedPayload.data = &msg->buffer[msg->pos]; ch.serializedPayload.length = payload\_size; ch.serializedPayload.max\_size = payload\_size; ch.setFragmentSize(fragmentSize);
 msg->pos = next\_pos; } else { EPROSIMA\_LOG\_WARNING(RTPS\_MSG\_IN, IDSTRING "Serialized Payload value invalid or larger than maximum allowed size " "(" << payload\_size << "/" << (msg->length - msg->pos) << ")"); return false; } } else if (keyFlag) { /\* XXX TODO Endianness\_t previous\_endian = msg->msg\_endian; if (ch->serializedPayload.encapsulation == PL\_CDR\_BE) msg->msg\_endian = BIGEND; else if (ch->serializedPayload.encapsulation == PL\_CDR\_LE) msg->msg\_endian = LITTLEEND; else { EPROSIMA\_LOG\_ERROR(RTPS\_MSG\_IN, IDSTRING"Bad encapsulation for KeyHash and status parameter list");[View remainder of file in raw view](https://github.com/eProsima/Fast-DDS/raw/refs/tags/v2.9.0/src/cpp/rtps/messages/MessageReceiver.cpp)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_f2bd09c7_20250111_164251.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fissues%2F3236)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fissues%2F3236)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  787](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  48](/eProsima/Fast-DDS/issues)
* [Pull requests
  78](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FeProsima%2FFast-DDS%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FeProsima%2FFast-DDS%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Assertion failure in SequenceNumber.h via malformed SPDP packet only when compiled in logging-enabled (Debug) mode #3236

Closed

1 task done

[squizz617](/squizz617) opened this issue
Jan 19, 2023
Â· 5 comments
 Â· Fixed by [#3274](https://github.com/eProsima/Fast-DDS/pull/3274)

Closed

1 task done

# [Assertion failure in SequenceNumber.h via malformed SPDP packet only when compiled in logging-enabled (Debug) mode](#top) #3236

[squizz617](/squizz617) opened this issue
Jan 19, 2023
Â· 5 comments
 Â· Fixed by [#3274](https://github.com/eProsima/Fast-DDS/pull/3274)

Labels
[bug](/eProsima/Fast-DDS/labels/bug)
Issue to report a bug

## Comments

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=80&v=4)](/squizz617)

Copy link

Contributor

### **[squizz617](/squizz617)** commented [Jan 19, 2023](#issue-1550082318) â€¢ edited Loading

| Is there an already existing issue for this?  * I have searched the existing issues  Expected behavior Malformed submessages handled gracefully. Current behavior I came across two following issues.   1. An SPDP payload with a malformed heartbeat submessage triggers an assertion failure at `fastrtps/include/fastdds/rtps/common/SequenceNumber.h:247`. 2. This only happens when fastrtps is compiled with the following CMake arguments for logging:  ``` --cmake-args -DCMAKE_BUILD_TYPE=Debug -DLOG_NO_INFO=OFF -DINTERNAL_DEBUG=ON -DLOG_CONSUMER_DEFAULT=STDOUT -DLOG_NO_WARNING=OFF -DLOG_NO_ERROR=OFF  ``` Steps to reproduce  1. Build fastdds v2.9.0 and HelloWorldExample with logging (Debug mode)  ``` mkdir -p ~/fastdds-log/src cd ~/fastdds-log wget https://raw.githubusercontent.com/eProsima/Fast-DDS/v2.9.0/fastrtps.repos vcs import src < fastrtps.repos colcon build --cmake-args -DCMAKE_BUILD_TYPE=Debug -DLOG_NO_INFO=OFF -DINTERNAL_DEBUG=ON -DLOG_CONSUMER_DEFAULT=STDOUT -DLOG_NO_WARNING=OFF -DLOG_NO_ERROR=OFF source install/setup.sh cd src/fastrtps/examples/cpp/dds/HelloWorldExample cmake . make  ```  2. Build fastdds v2.9.0 and HelloWorldExample without logging  ``` mkdir -p ~/fastdds-nolog/src cd ~/fastdds-nolog wget https://raw.githubusercontent.com/eProsima/Fast-DDS/v2.9.0/fastrtps.repos vcs import src < fastrtps.repos colcon build source install/setup.sh cd src/fastrtps/examples/cpp/dds/HelloWorldExample cmake . make  ```  3. Launch `DDSHelloWorldExample` with logging and send the malformed packet     * Launching:    ```    source ~/fastdds-log/install/setup.sh && ~/fastdds-log/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample publisher        ```    * Hexdump of the SPDP packet to send (to `239.255.0.1:7400`):    ```    0000  45 00 00 68 00 01 40 00 40 11 D9 76 80 3D F0 CF  E..h..@.@..v.=..    0010  EF FF 00 01 05 39 1C E8 00 54 08 B9 52 54 50 53  .....9...T..RTPS    0020  02 04 01 0F 01 03 02 42 AC 11 00 02 45 E5 E2 FD  .......B....E...    0030  07 BF 34 00 00 00 10 00 00 00 00 00 00 01 00 C2  ..4.............    0040  00 00 00 00 A7 9B EA 8C BE ED DC CB 00 03 00 00  ................    0050  77 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00  w...............    0060  00 00 00 00 00 00 00 00                          ........        ```    * Result after sending the packet:    ```    Starting     Publisher running 10 samples.    DDSHelloWorldExample: /home/seulbae/fastdds-log/src/fastrtps/include/fastdds/rtps/common/SequenceNumber.h:247: eprosima::fastrtps::rtps::SequenceNumber_t eprosima::fastrtps::rtps::operator-(const eprosima::fastrtps::rtps::SequenceNumber_t&, uint32_t): Assertion `0 < res.high' failed.    [1]    3561127 abort       publisher        ```     Assertion failure has been triggered! 4. Launch `DDSHelloWorldExample` without logging and send the malformed packet     * Launching:    ```    source ~/fastdds-nolog/install/setup.sh && ~/fastdds-nolog/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample publisher        ```    * Send the same SPDP packet    * Result after sending:    ```    Starting     Publisher running 10 samples.        ```     No assertion failure this time..  Fast DDS version/commit Tag v2.9.0 ([4c55488](https://github.com/eProsima/Fast-DDS/commit/4c55488d6225283b2e2114438a1bd726411876e7)) Platform/Architecture Ubuntu Focal 20.04 amd64 Transport layer Default configuration, UDPv4 & SHM Additional context Alternatively, you can directly use [this PoC](https://gist.github.com/squizz617/e558b28c1005c6ad96db1856f49d8263) to quickly test the behavior. But make sure to compile this with an afl compiler (e.g., `afl-clang-fast++`) or manually enable the `FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION` flag to keep `participantGuidPrefix` uninitialized.  Thank you. XML configuration file *No response* Relevant log output *No response* Network traffic capture *No response* |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617)
[squizz617](/squizz617)
added
the
[triage](/eProsima/Fast-DDS/labels/triage)
Issue pending classification
label
[Jan 19, 2023](#event-8316997695)

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=80&v=4)](/squizz617)

Copy link

Contributor

Author

### **[squizz617](/squizz617)** commented [Jan 20, 2023](#issuecomment-1398619273)

| [Update] sharing my analysis. Seems like the culprit is the compiler optimization.  The heartbeat submessage has bad sequence numbers, i.e.,  ``` firstSN.high = 0xc2000100 // -1040187136 firstSN.low = 0x00  lastSN.high = 0x8cea9ba7 lastSN.low = 0xcbdcedbe  ```  The sanity check line at [MessageReceiver.cpp:1057](https://github.com/eProsima/Fast-DDS/blob/v2.9.0/src/cpp/rtps/messages/MessageReceiver.cpp#L1059), invokes the `-` operator (`firstSN - 1`):  ``` inline SequenceNumber_t operator -(         const SequenceNumber_t& seq,         const uint32_t inc) noexcept {     SequenceNumber_t res(seq.high, seq.low - inc);      if (inc > seq.low)     {         // Being the type of the parameter an 'uint32_t', the decrement of 'high' will be as much as 1.         assert(0 < res.high);         --res.high;     }      return res; }  ```  in which `inc (== 1) > seq.low (== 0)` is `false` and the assert() inside is triggered as `0 < res.high (== -1040187136)` is `false`.  However, when built with default config using `colcon` and `cmake`, which sets -O2 or -O3, the check is replaced with other instructions and the block is never executed, hence no assertion failure. More info about this is [here](https://docs.google.com/presentation/d/1PJFdG4h-NOe2xpVVqw7CRxDXx53i8W0PHR4i2M36AWQ/edit?usp=sharing) (pages 5-9). |
| --- |

All reactions

Sorry, something went wrong.

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)
[MiguelCompany](/MiguelCompany)
added
[bug](/eProsima/Fast-DDS/labels/bug)
Issue to report a bug
and removed
[triage](/eProsima/Fast-DDS/labels/triage)
Issue pending classification
labels
[Jan 31, 2023](#event-8400380510)

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=80&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)

Copy link

Member

### **[MiguelCompany](/MiguelCompany)** commented [Jan 31, 2023](#issuecomment-1410509275)

| [@squizz617](https://github.com/squizz617) Thank you for the report and the analysis.  We will try to have a regression test and a fix.  I think that MessageReceiver should first check that the received sequences are valid (i.e. they have a positive high part), and then check for `(lastSN + 1) != firstSN`, to avoid calling the substraction operand. |
| --- |

All reactions

Sorry, something went wrong.

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=80&v=4)](/squizz617)

Copy link

Contributor

Author

### **[squizz617](/squizz617)** commented [Jan 31, 2023](#issuecomment-1410643257)

| Hi [@MiguelCompany](https://github.com/MiguelCompany), thank you for your reply.  I think that MessageReceiver should first check that the received sequences are valid  I agree. Having a validity check on `firstSN.value` is also congruent with what's stated in section 8.3.8.6.3 of [the RTPS specification](https://www.omg.org/spec/DDSI-RTPS/2.5/PDF):  "the submessage is invalid if firstSN.value is zero or negative" |
| --- |

All reactions

Sorry, something went wrong.

[squizz617](/squizz617)
added a commit
to squizz617/Fast-DDS
that referenced
this issue
[Feb 7, 2023](#ref-commit-60c15ed)
[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617)

`[Implement a validity check for firstSN](/squizz617/Fast-DDS/commit/60c15edf9e5ddf813d3ea25fa3ef2ccdae4e11a6 "Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>")`
â€¦

`[60c15ed](/squizz617/Fast-DDS/commit/60c15edf9e5ddf813d3ea25fa3ef2ccdae4e11a6)`

```
Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue [eProsima#3236](https://github.com/eProsima/Fast-DDS/issues/3236).

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
```

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617)
[squizz617](/squizz617)
mentioned this issue
[Feb 7, 2023](#ref-pullrequest-1573512678)

[Implement a validity check for firstSN
#3274](/eProsima/Fast-DDS/pull/3274)
 Merged

7 tasks

[squizz617](/squizz617)
added a commit
to squizz617/Fast-DDS
that referenced
this issue
[Mar 15, 2023](#ref-commit-ffac167)
[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617)

`[add test input for issue](/squizz617/Fast-DDS/commit/ffac167859455ba450c2bcd029ec9a5f01553a65 "add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>") [eProsima#3236](https://github.com/eProsima/Fast-DDS/issues/3236) [(pr](/squizz617/Fast-DDS/commit/ffac167859455ba450c2bcd029ec9a5f01553a65 "add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>") [eProsima#3274](https://github.com/eProsima/Fast-DDS/pull/3274)[)](/squizz617/Fast-DDS/commit/ffac167859455ba450c2bcd029ec9a5f01553a65 "add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>")`
â€¦

`[ffac167](/squizz617/Fast-DDS/commit/ffac167859455ba450c2bcd029ec9a5f01553a65)`

```
Signed-off-by: Seulbae Kim <squizz617@gmail.com>
```

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)
[MiguelCompany](/MiguelCompany)
closed this as [completed](/eProsima/Fast-DDS/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#3274](/eProsima/Fast-DDS/pull/3274)
[Mar 16, 2023](#event-8768920989)

[MiguelCompany](/MiguelCompany)
pushed a commit
that referenced
this issue
[Mar 16, 2023](#ref-commit-3aa3ee0)
[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617)

`[Implement a validity check for firstSN (](/eProsima/Fast-DDS/commit/3aa3ee0259deaebe3d578e0ec200947bdfe7d06f "Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>")[#3274](https://github.com/eProsima/Fast-DDS/pull/3274)[)](/eProsima/Fast-DDS/commit/3aa3ee0259deaebe3d578e0ec200947bdfe7d06f "Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>")`
â€¦

`[3aa3ee0](/eProsima/Fast-DDS/commit/3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)`

```
* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236).

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236) (pr [#3274](https://github.com/eProsima/Fast-DDS/pull/3274))

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
```

[mergify](/apps/mergify) bot
pushed a commit
that referenced
this issue
[Mar 16, 2023](#ref-commit-749e2a1)
[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617) [![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify)

`[Implement a validity check for firstSN (](/eProsima/Fast-DDS/commit/749e2a161d1caeb3c126f8e3fd15995c6a0d360b "Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)")[#3274](https://github.com/eProsima/Fast-DDS/pull/3274)[)](/eProsima/Fast-DDS/commit/749e2a161d1caeb3c126f8e3fd15995c6a0d360b "Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)")`
â€¦

`[749e2a1](/eProsima/Fast-DDS/commit/749e2a161d1caeb3c126f8e3fd15995c6a0d360b)`

```
* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236).

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236) (pr [#3274](https://github.com/eProsima/Fast-DDS/pull/3274))

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit [3aa3ee0](https://github.com/eProsima/Fast-DDS/commit/3aa3ee0259deaebe3d578e0ec200947bdfe7d06f))
```

[mergify](/apps/mergify) bot
pushed a commit
that referenced
this issue
[Mar 16, 2023](#ref-commit-083e082)
[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617) [![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify)

`[Implement a validity check for firstSN (](/eProsima/Fast-DDS/commit/083e0826d9413cde74a291359155e98ccc851716 "Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)")[#3274](https://github.com/eProsima/Fast-DDS/pull/3274)[)](/eProsima/Fast-DDS/commit/083e0826d9413cde74a291359155e98ccc851716 "Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)")`
â€¦

`[083e082](/eProsima/Fast-DDS/commit/083e0826d9413cde74a291359155e98ccc851716)`

```
* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236).

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236) (pr [#3274](https://github.com/eProsima/Fast-DDS/pull/3274))

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit [3aa3ee0](https://github.com/eProsima/Fast-DDS/commit/3aa3ee0259deaebe3d578e0ec200947bdfe7d06f))
```

[mergify](/apps/mergify) bot
pushed a commit
that referenced
this issue
[Mar 16, 2023](#ref-commit-ab754a8)
[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617) [![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify)

`[Implement a validity check for firstSN (](/eProsima/Fast-DDS/commit/ab754a8623e5d6b5f551a5b5ef41f1acc9b4651e "Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)")[#3274](https://github.com/eProsima/Fast-DDS/pull/3274)[)](/eProsima/Fast-DDS/commit/ab754a8623e5d6b5f551a5b5ef41f1acc9b4651e "Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)")`
â€¦

`[ab754a8](/eProsima/Fast-DDS/commit/ab754a8623e5d6b5f551a5b5ef41f1acc9b4651e)`

```
* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236).

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236) (pr [#3274](https://github.com/eProsima/Fast-DDS/pull/3274))

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit [3aa3ee0](https://github.com/eProsima/Fast-DDS/commit/3aa3ee0259deaebe3d578e0ec200947bdfe7d06f))
```

[MiguelCompany](/MiguelCompany)
pushed a commit
that referenced
this issue
[Mar 22, 2023](#ref-commit-6bc2f80)
[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617)

`[Implement a validity check for firstSN (](/eProsima/Fast-DDS/commit/6bc2f8048eb9760dcbd148bdb73492e58da8eb1e "Implement a validity check for firstSN (#3382)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)

Co-authored-by: Seulbae Kim <squizz617@gmail.com>")[#3382](https://github.com/eProsima/Fast-DDS/pull/3382)[)](/eProsima/Fast-DDS/commit/6bc2f8048eb9760dcbd148bdb73492e58da8eb1e "Implement a validity check for firstSN (#3382)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)

Co-authored-by: Seulbae Kim <squizz617@gmail.com>")`
â€¦

`[6bc2f80](/eProsima/Fast-DDS/commit/6bc2f8048eb9760dcbd148bdb73492e58da8eb1e)`

```
* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236).

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236) (pr [#3274](https://github.com/eProsima/Fast-DDS/pull/3274))

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit [3aa3ee0](https://github.com/eProsima/Fast-DDS/commit/3aa3ee0259deaebe3d578e0ec200947bdfe7d06f))

Co-authored-by: Seulbae Kim <squizz617@gmail.com>
```

[MiguelCompany](/MiguelCompany)
pushed a commit
that referenced
this issue
[Mar 24, 2023](#ref-commit-e02775a)
[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617) [![@Mario-DL](https://avatars.githubusercontent.com/u/116071334?s=40&u=ec089747c3f33adaff62732a4589230c804dd887&v=4)](/Mario-DL)

`[Implement a validity check for firstSN (](/eProsima/Fast-DDS/commit/e02775af226692379e6797907e143fec407d4783 "Implement a validity check for firstSN (#3383)

* Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)

* Refs #17717: Logging Macro fix

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

---------

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>
Co-authored-by: Seulbae Kim <squizz617@gmail.com>
Co-authored-by: Mario Dominguez <mariodominguez@eprosima.com>")[#3383](https://github.com/eProsima/Fast-DDS/pull/3383)[)](/eProsima/Fast-DDS/commit/e02775af226692379e6797907e143fec407d4783 "Implement a validity check for firstSN (#3383)

* Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)

* Refs #17717: Logging Macro fix

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

---------

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>
Co-authored-by: Seulbae Kim <squizz617@gmail.com>
Co-authored-by: Mario Dominguez <mariodominguez@eprosima.com>")`
â€¦

`[e02775a](/eProsima/Fast-DDS/commit/e02775af226692379e6797907e143fec407d4783)`

```
* Implement a validity check for firstSN ([#3274](https://github.com/eProsima/Fast-DDS/pull/3274))

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236).

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236) (pr [#3274](https://github.com/eProsima/Fast-DDS/pull/3274))

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit [3aa3ee0](https://github.com/eProsima/Fast-DDS/commit/3aa3ee0259deaebe3d578e0ec200947bdfe7d06f))

* Refs #17717: Logging Macro fix

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

---------

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>
Co-authored-by: Seulbae Kim <squizz617@gmail.com>
Co-authored-by: Mario Dominguez <mariodominguez@eprosima.com>
```

[JLBuenoLopez](/JLBuenoLopez)
pushed a commit
that referenced
this issue
[Apr 11, 2023](#ref-commit-141fa03)
[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617) [![@Mario-DL](https://avatars.githubusercontent.com/u/116071334?s=40&u=ec089747c3f33adaff62732a4589230c804dd887&v=4)](/Mario-DL)

`[Implement a validity check for firstSN (backport](/eProsima/Fast-DDS/commit/141fa03097c2f0485e80a6ec980ef6d2e1f2f972 "Implement a validity check for firstSN (backport #3274) (#3384)

* Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)

* Refs #17717: Logging Macro fix

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

---------

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>
Co-authored-by: Seulbae Kim <squizz617@gmail.com>
Co-authored-by: Mario Dominguez <mariodominguez@eprosima.com>") [#3274](https://github.com/eProsima/Fast-DDS/pull/3274)[) (](/eProsima/Fast-DDS/commit/141fa03097c2f0485e80a6ec980ef6d2e1f2f972 "Implement a validity check for firstSN (backport #3274) (#3384)

* Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)

* Refs #17717: Logging Macro fix

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

---------

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>
Co-authored-by: Seulbae Kim <squizz617@gmail.com>
Co-authored-by: Mario Dominguez <mariodominguez@eprosima.com>")[#3384](https://github.com/eProsima/Fast-DDS/pull/3384)[)](/eProsima/Fast-DDS/commit/141fa03097c2f0485e80a6ec980ef6d2e1f2f972 "Implement a validity check for firstSN (backport #3274) (#3384)

* Implement a validity check for firstSN (#3274)

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue #3236.

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue #3236 (pr #3274)

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit 3aa3ee0259deaebe3d578e0ec200947bdfe7d06f)

* Refs #17717: Logging Macro fix

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

---------

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>
Co-authored-by: Seulbae Kim <squizz617@gmail.com>
Co-authored-by: Mario Dominguez <mariodominguez@eprosima.com>")`
â€¦

`[141fa03](/eProsima/Fast-DDS/commit/141fa03097c2f0485e80a6ec980ef6d2e1f2f972)`

```
* Implement a validity check for firstSN ([#3274](https://github.com/eProsima/Fast-DDS/pull/3274))

* Implement a validity check for firstSN

Following 8.3.8.6.3 of DDS-RTPS 2.5.
This fixes issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236).

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* fix typo

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

* add test input for issue [#3236](https://github.com/eProsima/Fast-DDS/issues/3236) (pr [#3274](https://github.com/eProsima/Fast-DDS/pull/3274))

Signed-off-by: Seulbae Kim <squizz617@gmail.com>

---------

Signed-off-by: Seulbae Kim <squizz617@gmail.com>
(cherry picked from commit [3aa3ee0](https://github.com/eProsima/Fast-DDS/commit/3aa3ee0259deaebe3d578e0ec200947bdfe7d06f))

* Refs #17717: Logging Macro fix

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>

---------

Signed-off-by: Mario Dominguez <mariodominguez@eprosima.com>
Co-authored-by: Seulbae Kim <squizz617@gmail.com>
Co-authored-by: Mario Dominguez <mariodominguez@eprosima.com>
```

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=80&v=4)](/squizz617)

Copy link

Contributor

Author

### **[squizz617](/squizz617)** commented [May 19, 2023](#issuecomment-1554520051)

| Hi [@MiguelCompany](https://github.com/MiguelCompany), could you assign a CVE ID for this issue? A relevant CWE would be CWE-617: Reachable Assertion. |
| --- |

All reactions

Sorry, something went wrong.

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [Aug 11, 2023](#issuecomment-1675384985)

| CVE-2023-39949 appears to have been assigned for this issue. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fissues%2F3236)

Assignees

No one assigned

Labels

[bug](/eProsima/Fast-DDS/labels/bug)
Issue to report a bug

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Implement a validity check for firstSN](/eProsima/Fast-DDS/pull/3274)
 [squizz617/Fast-DDS](/squizz617/Fast-DDS)

3 participants

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=52&v=4)](/carnil) [![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=52&v=4)](/squizz617) [![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=52&v=4)](/MiguelCompany)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


