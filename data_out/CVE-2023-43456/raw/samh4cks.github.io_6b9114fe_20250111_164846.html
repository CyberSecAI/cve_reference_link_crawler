<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="CVE-2023-43456 - Stored Cross-Site Scripting (XSS)" /><meta property="og:locale" content="en" /><meta name="description" content="Security Researcher who shares his findings with the digital world, uncovering crucial vulnerabilities." /><meta property="og:description" content="Security Researcher who shares his findings with the digital world, uncovering crucial vulnerabilities." /><link rel="canonical" href="https://samarthdad.com/posts/cve-2023-43456/" /><meta property="og:url" content="https://samarthdad.com/posts/cve-2023-43456/" /><meta property="og:site_name" content="Samarth Dad" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-09-19T08:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CVE-2023-43456 - Stored Cross-Site Scripting (XSS)" /><meta name="twitter:site" content="@samh4cks" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-09-19T08:00:00+05:30","datePublished":"2023-09-19T08:00:00+05:30","description":"Security Researcher who shares his findings with the digital world, uncovering crucial vulnerabilities.","headline":"CVE-2023-43456 - Stored Cross-Site Scripting (XSS)","mainEntityOfPage":{"@type":"WebPage","@id":"https://samarthdad.com/posts/cve-2023-43456/"},"url":"https://samarthdad.com/posts/cve-2023-43456/"}</script><title>CVE-2023-43456 - Stored Cross-Site Scripting (XSS) | Samarth Dad</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Samarth Dad"><meta name="application-name" content="Samarth Dad"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://cdnjs.cloudflare.com" ><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://samh4cks.netlify.app/assets/commons/hacker.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Samarth Dad</a></h1><p class="site-subtitle fst-italic mb-0">Security Researcher @ <b>Yogosha</b></p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/samh4cks" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/samh4cks" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['samarth.webappsec','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>CVE-2023-43456 - Stored Cross-Site Scripting (XSS)</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>CVE-2023-43456 - Stored Cross-Site Scripting (XSS)</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1695090600" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 19, 2023 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/samh4cks/">Samarth</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="825 words" > <em>4 min</em> read</span></div></div></header><div class="content"><p><a href="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/banner.png" class="popup img-link shimmer"><img src="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/banner.png" alt="CVE-2023-43456" loading="lazy"></a></p><h2 id="about-the-application"><span class="me-2">About the Application</span><a href="#about-the-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This <code class="language-plaintext highlighter-rouge">Service Provider Management System v.1.0</code> is a sort of Content Management System (CMS) that is built specifically for companies that provide different services. The project is a company website that allows the management to dynamically manage the site information and other data on the front end. This project has 2 modules which are the Public and Management site.</p><p>The Management Site is the side of the system where accessible to the company staff or system-registered users only. On this site, users are required to log in with their valid system credentials to gain access to the features and functionalities. Users have 2 different roles which are the <code class="language-plaintext highlighter-rouge">Administrator</code> and the <code class="language-plaintext highlighter-rouge">Staff</code>. The Administrator users have the privilege to manage and access all the features and functionalities of the said site while the Staff users only have limited permissions. Here, system users can manage the list of services that their company provided. They can also update the dynamic page content of the public website on this side.</p><h2 id="vulnerability-description"><span class="me-2">Vulnerability Description</span><a href="#vulnerability-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Cross Site Scripting vulnerability in <code class="language-plaintext highlighter-rouge">Service Provider Management System v.1.0</code> allows a remote attacker to execute arbitrary code and obtain sensitive information via the <code class="language-plaintext highlighter-rouge">firstname</code>, <code class="language-plaintext highlighter-rouge">middlename</code> and <code class="language-plaintext highlighter-rouge">lastname</code> parameters in the <code class="language-plaintext highlighter-rouge">/php-spms/admin/?page=user</code> endpoint.</p><h2 id="vulnerable-code"><span class="me-2">Vulnerable Code</span><a href="#vulnerable-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><b>Filename:</b> <code class="language-plaintext highlighter-rouge">/php-spms/admin/user/index.php</code></p><p><b>Vulnerable Endpoint:</b> <code class="language-plaintext highlighter-rouge">/php-spms/admin/?page=user</code></p><p><b>Vulnerable Parameter:</b> <code class="language-plaintext highlighter-rouge">firstname, middlename, lastname</code></p><p><b>Code:</b></p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">""</span> <span class="na">id=</span><span class="s">"manage-user"</span><span class="nt">&gt;</span>	
	<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"id"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_settings</span><span class="o">-&gt;</span><span class="nf">userdata</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"name"</span><span class="nt">&gt;</span>First Name<span class="nt">&lt;/label&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"firstname"</span> <span class="na">id=</span><span class="s">"firstname"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$meta</span><span class="p">[</span><span class="s1">'firstname'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$meta</span><span class="p">[</span><span class="s1">'firstname'</span><span class="p">]</span><span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="s">"</span> <span class="na">required</span><span class="nt">&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"name"</span><span class="nt">&gt;</span>Middle Name<span class="nt">&lt;/label&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"middlename"</span> <span class="na">id=</span><span class="s">"middlename"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$meta</span><span class="p">[</span><span class="s1">'middlename'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$meta</span><span class="p">[</span><span class="s1">'middlename'</span><span class="p">]</span><span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"name"</span><span class="nt">&gt;</span>Last Name<span class="nt">&lt;/label&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"lastname"</span> <span class="na">id=</span><span class="s">"lastname"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$meta</span><span class="p">[</span><span class="s1">'lastname'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$meta</span><span class="p">[</span><span class="s1">'lastname'</span><span class="p">]</span><span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="s">"</span> <span class="na">required</span><span class="nt">&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"username"</span><span class="nt">&gt;</span>Username<span class="nt">&lt;/label&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">id=</span><span class="s">"username"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$meta</span><span class="p">[</span><span class="s1">'username'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$meta</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]</span><span class="o">:</span> <span class="s1">''</span> <span class="cp">?&gt;</span><span class="s">"</span> <span class="na">required</span>  <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"password"</span><span class="nt">&gt;</span>Password<span class="nt">&lt;/label&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">id=</span><span class="s">"password"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">value=</span><span class="s">""</span> <span class="na">autocomplete=</span><span class="s">"off"</span><span class="nt">&gt;&lt;small&gt;&lt;i&gt;</span>Leave this blank if you dont want to change the password.<span class="nt">&lt;/i&gt;&lt;/small&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">""</span> <span class="na">class=</span><span class="s">"control-label"</span><span class="nt">&gt;</span>Avatar<span class="nt">&lt;/label&gt;</span>
			<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"custom-file"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"customFile"</span> <span class="na">name=</span><span class="s">"img"</span> <span class="na">onchange=</span><span class="s">"displayImg(this,$(this))"</span> <span class="na">accept=</span><span class="s">"image/png, image/jpeg"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group d-flex justify-content-center"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nf">validate_image</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$meta</span><span class="p">[</span><span class="s1">'avatar'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$meta</span><span class="p">[</span><span class="s1">'avatar'</span><span class="p">]</span> <span class="o">:</span><span class="s1">''</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="s">"</span> <span class="na">alt=</span><span class="s">""</span> <span class="na">id=</span><span class="s">"cimg"</span> <span class="na">class=</span><span class="s">"img-fluid img-thumbnail"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></table></code></div></div><p>When users input their names, such as their <code class="language-plaintext highlighter-rouge">firstname</code>, <code class="language-plaintext highlighter-rouge">middlename</code>, and <code class="language-plaintext highlighter-rouge">lastname</code>, the website neglects the critical step of sanitizing this information to ensure it’s free from potentially harmful characters before storing it in the backend. This oversight creates a security vulnerability known as ‘Stored Cross-Site Scripting’ (Stored XSS), especially concerning these name parameters.</p><p><code class="language-plaintext highlighter-rouge">Stored Cross-Site Scripting (XSS)</code> is a type of security vulnerability that occurs in web applications when user input, often in the form of text or other content, is not properly sanitized or validated before being stored on the server and then later displayed to other users. This vulnerability allows attackers to inject malicious scripts, typically in the form of JavaScript code, into the application’s data storage. When other users retrieve and view this data, the injected script code is executed within their browsers, potentially leading to a range of malicious actions.</p><h2 id="impact-of-stored-cross-site-scripting"><span class="me-2">Impact of Stored Cross-Site Scripting</span><a href="#impact-of-stored-cross-site-scripting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The impacts of Stored Cross-Site Scripting (Stored XSS) are mentioned below:</p><p><b>Session Hijacking</b>: Attackers can hijack user sessions, gaining unauthorized access to accounts and allowing them to perform actions on behalf of users or access confidential data.</p><p><b>Manipulation of Web Pages</b>: Stored XSS can alter the appearance and functionality of web pages, potentially tricking users into executing unintended actions, clicking on malicious links, or downloading malware.</p><h2 id="attack-scenario"><span class="me-2">Attack Scenario</span><a href="#attack-scenario" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Go to <code class="language-plaintext highlighter-rouge">http://application ip/php-spms/admin/?page=user</code>.</ul><p><a href="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/1.png" class="popup img-link shimmer"><img src="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/1.png" alt="Application view" loading="lazy"></a></p><ul><li>Provide payload as <code class="language-plaintext highlighter-rouge">"&gt;&lt;script&gt;alert("XSS on Firstname")</code>, <code class="language-plaintext highlighter-rouge">"&gt;&lt;script&gt;alert("XSS on Middlename")</code>, <code class="language-plaintext highlighter-rouge">"&gt;&lt;script&gt;alert("XSS on Lastname")</code> on parameter such as <code class="language-plaintext highlighter-rouge">firstname</code>, <code class="language-plaintext highlighter-rouge">middlename</code> and <code class="language-plaintext highlighter-rouge">lastname</code> respectively.</ul><p><a href="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/2.png" class="popup img-link shimmer"><img src="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/2.png" alt="XSS Payload" loading="lazy"></a><em>User Details</em></p><ul><li><p>Click on Update.</p><li><p>You will observe the popup of each payload we provided.</p></ul><p><a href="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/3.png" class="popup img-link shimmer"><img src="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/3.png" alt="XSS on firstname" loading="lazy"></a><em>XSS on Firstname</em></p><p><a href="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/4.png" class="popup img-link shimmer"><img src="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/4.png" alt="XSS on middlename" loading="lazy"></a><em>XSS on Middlename</em></p><p><a href="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/5.png" class="popup img-link shimmer"><img src="https://samh4cks.netlify.app/assets/images/CVE/CVE-2023-43456/5.png" alt="XSS on lastname" loading="lazy"></a><em>XSS on Lastname</em></p><h2 id="remediation"><span class="me-2">Remediation</span><a href="#remediation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Mitigating stored cross-site scripting (XSS) vulnerabilities is crucial for securing web applications. To prevent stored XSS, follow these best practices:</p><ul><li><p><b>Whitelist Input</b>: Only allow specific, safe characters and patterns in user input. Reject any input that doesn’t conform to this whitelist.</p><li><p><b>Data Sanitization</b>: Filter and clean user input to remove or encode any potentially malicious characters. Use libraries like OWASP’s Java Encoder, PHP’s htmlspecialchars, or equivalent functions in other languages.</p><li><p><b>Sanitization Libraries</b>: Use security libraries and frameworks that provide built-in XSS prevention mechanisms, such as Ruby on Rails, Django, or AngularJS.</p><li><p><b>Use HTTP-Only Cookies</b>: Mark cookies as HTTP-only to prevent JavaScript from accessing them, reducing the impact of XSS attacks.</p><li><p><b>Session Management</b>: Implement secure session management to ensure that session cookies and tokens are properly protected and rotated.</p><li><p><b>Security Headers</b>: Use security headers like <code class="language-plaintext highlighter-rouge">X-XSS-Protection</code> and <code class="language-plaintext highlighter-rouge">X-Content-Type-Options</code> to instruct browsers to mitigate certain types of attacks.</p></ul><p>That’s all in this writeup.</p><p>Thanks for reading this far. If you enjoyed the writeup, do support me <a href="https://www.buymeacoffee.com/h4xplo1t"><strong>here</strong></a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/cves/">CVEs</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/cve-2023-43456/" class="post-tag no-text-decoration" >CVE-2023-43456</a> <a href="/tags/cross-site-scripting/" class="post-tag no-text-decoration" >Cross-Site Scripting</a> <a href="/tags/source-code-analysis/" class="post-tag no-text-decoration" >Source Code Analysis</a> <a href="/tags/cves/" class="post-tag no-text-decoration" >CVEs</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fsamarthdad.com%2Fposts%2Fcve-2023-43456%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="https://twitter.com/intent/tweet?text=CVE-2023-43456%20-%20Stored%20Cross-Site%20Scripting%20(XSS)%20-%20Samarth%20Dad&url=https%3A%2F%2Fsamarthdad.com%2Fposts%2Fcve-2023-43456%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fsamarthdad.com%2Fposts%2Fcve-2023-43456%2F&text=CVE-2023-43456%20-%20Stored%20Cross-Site%20Scripting%20(XSS)%20-%20Samarth%20Dad" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/HackTheBox-Heal/">HackTheBox Heal Writeup</a><li class="text-truncate lh-lg"> <a href="/posts/HackTheBox-LinkVortex/">HackTheBox LinkVortex Writeup</a><li class="text-truncate lh-lg"> <a href="/posts/HackTheBox-Sightless/">HackTheBox Sightless Writeup</a><li class="text-truncate lh-lg"> <a href="/posts/HackTheBox-Cicada/">HackTheBox Cicada Writeup</a><li class="text-truncate lh-lg"> <a href="/posts/cve-2023-43458/">CVE-2023-43458 - Stored Cross-Site Scripting (XSS)</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/cross-site-scripting/">Cross-Site Scripting</a> <a class="post-tag btn btn-outline-primary" href="/tags/cves/">CVEs</a> <a class="post-tag btn btn-outline-primary" href="/tags/smb/">SMB</a> <a class="post-tag btn btn-outline-primary" href="/tags/source-code-analysis/">Source Code Analysis</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">Windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/ftpd/">FTPd</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">Active Directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/blind-command-injection/">Blind Command Injection</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/cve-2023-43458/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1695094200" data-df="ll" > Sep 19, 2023 </time><h4 class="pt-0 my-2">CVE-2023-43458 - Stored Cross-Site Scripting (XSS)</h4><div class="text-muted"><p> About the Application This simple project is entitled Resort Reservation System v.1.0. It is a simple web application that provides an automated platform for certain resort management to easily ...</p></div></div></a></article><article class="col"> <a href="/posts/cve-2023-43457/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1695092400" data-df="ll" > Sep 19, 2023 </time><h4 class="pt-0 my-2">CVE-2023-43457 - Broken Access Control (BAC)</h4><div class="text-muted"><p> About the Application This Service Provider Management System v.1.0 is a sort of Content Management System (CMS) that is built specifically for companies that provide different services. The pro...</p></div></div></a></article><article class="col"> <a href="/posts/a-tale-of-finding-an-interesting-xss-vulnerability/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1692048600" data-df="ll" > Aug 15, 2023 </time><h4 class="pt-0 my-2">A tale of finding an interesting XSS vulnerability</h4><div class="text-muted"><p> Introduction Hello everyone, I trust you’re all doing great. Over the past weekend, my friend n3hal_ and I stumbled upon an intriguing XSS vulnerability while participating in a bug bounty prog...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/HackTheBox-CozyHosting/" class="btn btn-outline-primary" aria-label="Older" ><p>HackTheBox CozyHosting Writeup</p></a> <a href="/posts/cve-2023-43457/" class="btn btn-outline-primary" aria-label="Newer" ><p>CVE-2023-43457 - Broken Access Control (BAC)</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://samarthdad.com/">Samarth Dad</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/cross-site-scripting/">Cross-Site Scripting</a> <a class="post-tag btn btn-outline-primary" href="/tags/cves/">CVEs</a> <a class="post-tag btn btn-outline-primary" href="/tags/smb/">SMB</a> <a class="post-tag btn btn-outline-primary" href="/tags/source-code-analysis/">Source Code Analysis</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">Windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/ftpd/">FTPd</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">Web</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">Active Directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/blind-command-injection/">Blind Command Injection</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js,npm/mermaid@10.8.0/dist/mermaid.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { /* start/end delimiter pairs for in-line math */ inlineMath: [ ['$', '$'], ['\\(', '\\)'] ], /* start/end delimiter pairs for display math */ displayMath: [ ['$$', '$$'], ['\\[', '\\]'] ], /* equation numbering */ tags: 'ams' } }; </script> <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script> <script defer src="/assets/js/dist/app.min.js"></script> <script type="text/javascript"> (function () { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === 'undefined') { return; } let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default'; let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $('.mermaid').each(function () { let svgCode = $(this).prev().children().html(); $(this).removeAttr('data-processed'); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, '.mermaid'); } } let initTheme = 'default'; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = 'dark'; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Create mermaid tag */ document.querySelectorAll('pre>code.language-mermaid').forEach((elem) => { const svgCode = elem.textContent; const backup = elem.parentElement; backup.classList.add('unloaded'); /* create mermaid node */ let mermaid = document.createElement('pre'); mermaid.classList.add('mermaid'); const text = document.createTextNode(svgCode); mermaid.appendChild(text); backup.after(mermaid); }); mermaid.initialize(mermaidConf); window.addEventListener('message', updateMermaid); })(); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
