

[skip to main](#main)  |
[skip to sidebar](#sidebar)

# [BugiX - Security Research](http://bugix-security.blogspot.com/)

## Tuesday, April 12, 2011

### [CVE-2011-0611 Adobe Flash Zero Day embeded in DOC](http://bugix-security.blogspot.com/2011/04/cve-2011-0611-adobe-flash-zero-day.html)

information about new zero day in adobe flash player :

<http://contagiodump.blogspot.com/2011/04/apr-8-cve-2011-0611-flash-player-zero.html>

<http://www.adobe.com/support/security/advisories/apsa11-02.html>

Filename: **Disentangling Industrial Policy and Competition Policy.doc**

Size:176,144 bytes

My analysis of  **Disentangling Industrial Policy and Competition Policy.doc**

 [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjeL1C82sxqgiLJMBqtCo23GMOdyPG9Cos0JLNqyZegYqF_XkkAbdj6Ralbly6xaWM1KPXo71Po8GE8VQBGzkxG5REvSqalVZPG2yx7T3ya_bj1kofissX1pJpD_g5v38b_6NZn2_Ze1Jg2/s1600/doc1.PNG)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjeL1C82sxqgiLJMBqtCo23GMOdyPG9Cos0JLNqyZegYqF_XkkAbdj6Ralbly6xaWM1KPXo71Po8GE8VQBGzkxG5REvSqalVZPG2yx7T3ya_bj1kofissX1pJpD_g5v38b_6NZn2_Ze1Jg2/s1600/doc1.PNG)

File created 04-Apr-2011 9:50 , by user 7 , and company hust

There are no vulnerabilities in MS Office, there is a vulnerability in embeded swf as was described below.

embeded swf file(local name d:\513.swf)

size 10,421 bytes

[decoded action  script](http://pastebin.com/DkQThUUY)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiwcDkybKiNCV_Ai7P9FKmOyBHv2xLonNjJ7PpRh4zhcJU0hX0fq4cRjEs2oaEZQogWwn0oUf1obl51_8Mf17PiTZ_UzylqnX0qI6CQqRp-yiWGShyphenhypheni_hOPGbMOefffYBlLgkUy5HIGRamh/s1600/swf1.PNG)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiwcDkybKiNCV_Ai7P9FKmOyBHv2xLonNjJ7PpRh4zhcJU0hX0fq4cRjEs2oaEZQogWwn0oUf1obl51_8Mf17PiTZ_UzylqnX0qI6CQqRp-yiWGShyphenhypheni_hOPGbMOefffYBlLgkUy5HIGRamh/s1600/swf1.PNG)

this is heap spray, allocate memory with nop slide=0x11111111.

and load second swf file.

second swf

size 1,484 bytes

*SWFTools>swfdump.exe -D 1.swf*

[HEADER]        File version: 10

[HEADER]        File size: 1484

[HEADER]        Frame rate: 24.000000

[HEADER]        Frame count: 1

[HEADER]        Movie width: 550.00

[HEADER]        Movie height: 400.00

[045]         4 FILEATTRIBUTES

[00c]      1447 DOACTION

GetU8() out of bounds: TagID = 12

*flasm16win>flasm.exe -d 1.swf*

movie '1.swf' // flash 10, total frames: 1, frame rate: 24 fps, 550x400 px

frame 0

00000000    push FALSE, 326943637, 326943739

0000000F    oldEquals

00000010    not

00000011    branchIfTrue label2 // offset 1100

00000016    branchIfTrue label1 // offset 24

0000001B    constants 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'  Declared constant pool length 21 differs from calculated length 20

Disassembly may be incomplete: wrong action length encountered

          end // of frame 0

end

crash exist in Adobe Flash Player plugin .

in my test NPSWF32.dll (10.2.153.1)

crash at location **100cfc03**

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFCGBbFHSwlQSxVFjDnPLOnE3mSDkmr36whXE2aoR3TmmT-4AqMGpA_vhEDNV-rVsYBqXxZHq6KfCwaZr5k_iMN0wKRxhu8PIstAv921lV45MF-IiqD6FXu1jeSLYeQZm6ucY7-Op3dM_T/s1600/crash1.PNG)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFCGBbFHSwlQSxVFjDnPLOnE3mSDkmr36whXE2aoR3TmmT-4AqMGpA_vhEDNV-rVsYBqXxZHq6KfCwaZr5k_iMN0wKRxhu8PIstAv921lV45MF-IiqD6FXu1jeSLYeQZm6ucY7-Op3dM_T/s1600/crash1.PNG)

this possibly related to tweet :

 [yuange1975](http://twitter.com/#%21/yuange1975 "Yuange") Yuange

 call [0x11111110+0x08][7 Apr](http://twitter.com/#%21/yuange1975/status/55864987553501184 "8:30 AM Apr 7th")

to be continue ...

Posted by
villy

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=3955802477964832585&postID=517573903654346932&from=pencil "Edit Post")

Labels:
[CVE-2011-0611](http://bugix-security.blogspot.com/search/label/CVE-2011-0611)

#### 2 comments:

1. ![]()[SEO Company](http://1seocompany.com.au)[August 16, 2011 at 9:49 AM](http://bugix-security.blogspot.com/2011/04/cve-2011-0611-adobe-flash-zero-day.html?showComment=1313477342796#c8445383562805682396)

   I am trying this code, but sorry it's didn't work. Can you give me solution for this. Thanks for it.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=3955802477964832585&postID=8445383562805682396)Replies
   Reply
2. ![]()[stop sharing](http://www.locklizard.com/stop-sharing-printing.htm)[September 15, 2011 at 11:12 AM](http://bugix-security.blogspot.com/2011/04/cve-2011-0611-adobe-flash-zero-day.html?showComment=1316074377457#c4801153280401351619)

   HI,
    Can you give me solution for this.I loved all of these posts. A lot of these things we have, but I got some really great ideas.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=3955802477964832585&postID=4801153280401351619)Replies
   Reply

Add commentLoad more...

[Older Post](http://bugix-security.blogspot.com/2011/03/cve-2011-0609-adobe-flash-player.html "Older Post")

[Home](http://bugix-security.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://bugix-security.blogspot.com/feeds/517573903654346932/comments/default)

## About me

Developer

## Blog Archive

* ▼
  [2011](http://bugix-security.blogspot.com/2011/)
  (3)
  + ▼
    [April](http://bugix-security.blogspot.com/2011/04/)
    (1)
    - [CVE-2011-0611 Adobe Flash Zero Day embeded in DOC](http://bugix-security.blogspot.com/2011/04/cve-2011-0611-adobe-flash-zero-day.html)
  + ►
    [March](http://bugix-security.blogspot.com/2011/03/)
    (1)
  + ►
    [February](http://bugix-security.blogspot.com/2011/02/)
    (1)

* ►
  [2010](http://bugix-security.blogspot.com/2010/)
  (6)
  + ►
    [October](http://bugix-security.blogspot.com/2010/10/)
    (2)
  + ►
    [September](http://bugix-security.blogspot.com/2010/09/)
    (2)
  + ►
    [March](http://bugix-security.blogspot.com/2010/03/)
    (2)

## Search This Blog

|  |  |
| --- | --- |

