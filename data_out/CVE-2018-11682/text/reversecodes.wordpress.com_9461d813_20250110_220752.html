
[Saltar al contenido.](#content)

* [Inicio](https://reversecodes.wordpress.com/)

Buscar:

# Entradas recientes

* [[Bug-Bounty] Encadenando 5 vulnerabilidades hasta conseguir shell a partir de app android.](https://reversecodes.wordpress.com/2018/08/28/bug-bounty-encadenando-5-vulnerabilidades-hasta-conseguir-shell-a-partir-de-app-android/)
* [Analizando la app de La Liga para Android](https://reversecodes.wordpress.com/2018/06/12/analizando-la-app-de-la-liga-para-android/)
* [[0-Day] Tomando el control de las instalaciones de la NASA en Cabo Cañaveral.](https://reversecodes.wordpress.com/2018/06/02/0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral/)
* [DCS17 Writeup](https://reversecodes.wordpress.com/2017/05/17/dcs17-writeup/)
* [Ingenieria inversa en android | Cap 1](https://reversecodes.wordpress.com/2016/12/28/ingenieria-inversa-en-android-cap-1/)
# Comentarios recientes

|  | [Mdevs](http://mobiledevstories.com) en [Analizando la app de La Liga p…](https://reversecodes.wordpress.com/2018/06/12/analizando-la-app-de-la-liga-para-android/comment-page-4/#comment-60) |
| --- | --- |
|  | [Nestor Sanz](https://plus.google.com/%2BNestorSanz) en [Analizando la app de La Liga p…](https://reversecodes.wordpress.com/2018/06/12/analizando-la-app-de-la-liga-para-android/comment-page-4/#comment-56) |
|  | ByLoCK en [Analizando la app de La Liga p…](https://reversecodes.wordpress.com/2018/06/12/analizando-la-app-de-la-liga-para-android/comment-page-3/#comment-55) |
|  | elbarrakon en [Analizando la app de La Liga p…](https://reversecodes.wordpress.com/2018/06/12/analizando-la-app-de-la-liga-para-android/comment-page-3/#comment-54) |
|  | rastersoft en [Analizando la app de La Liga p…](https://reversecodes.wordpress.com/2018/06/12/analizando-la-app-de-la-liga-para-android/comment-page-3/#comment-53) |

# Archivos

* [agosto 2018](https://reversecodes.wordpress.com/2018/08/)
* [junio 2018](https://reversecodes.wordpress.com/2018/06/)
* [May 2017](https://reversecodes.wordpress.com/2017/05/)
* [diciembre 2016](https://reversecodes.wordpress.com/2016/12/)
* [noviembre 2016](https://reversecodes.wordpress.com/2016/11/)
* [octubre 2016](https://reversecodes.wordpress.com/2016/10/)
* [septiembre 2016](https://reversecodes.wordpress.com/2016/09/)
* [agosto 2016](https://reversecodes.wordpress.com/2016/08/)
* [junio 2016](https://reversecodes.wordpress.com/2016/06/)
* [May 2016](https://reversecodes.wordpress.com/2016/05/)
* [abril 2016](https://reversecodes.wordpress.com/2016/04/)
* [marzo 2016](https://reversecodes.wordpress.com/2016/03/)
* [enero 2016](https://reversecodes.wordpress.com/2016/01/)
* [diciembre 2015](https://reversecodes.wordpress.com/2015/12/)
# Categorías

* [Algoritmia](https://reversecodes.wordpress.com/category/algoritmia/)
* [android](https://reversecodes.wordpress.com/category/android/)
* [bug-bounty](https://reversecodes.wordpress.com/category/bug-bounty/)
* [codigo en general](https://reversecodes.wordpress.com/category/codigo-en-general/)
* [Criptografía](https://reversecodes.wordpress.com/category/criptografia/)
* [Esteganografía](https://reversecodes.wordpress.com/category/esteganografia/)
* [exploit](https://reversecodes.wordpress.com/category/exploit/)
* [informe](https://reversecodes.wordpress.com/category/informe/)
* [Ingeniería inversa](https://reversecodes.wordpress.com/category/ingenieria-inversa/)
* [Ingenieria social](https://reversecodes.wordpress.com/category/ingenieria-social/)
* [Investigacion](https://reversecodes.wordpress.com/category/investigacion/)
* [iot](https://reversecodes.wordpress.com/category/iot/)
* [Malware](https://reversecodes.wordpress.com/category/malware/)
* [Retos](https://reversecodes.wordpress.com/category/retos/)
* [scada](https://reversecodes.wordpress.com/category/scada/)
* [Sin categoría](https://reversecodes.wordpress.com/category/sin-categoria/)
* [YARA](https://reversecodes.wordpress.com/category/yara/)
[Mis tuits](https://twitter.com/)

# [reversecoder](https://reversecodes.wordpress.com/)

## Dedicado a la ingeniería inversa, la criptografía y el malware.

[![](https://reversecodes.wordpress.com/wp-content/uploads/2018/06/lima.jpg?w=611)](https://reversecodes.wordpress.com/2018/06/02/0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral/ "Enlace permanente a [0-Day] Tomando el control de las instalaciones de la NASA en Cabo Cañaveral.")

# [0-Day] Tomando el control de las instalaciones de la NASA en Cabo Cañaveral.

Buenas,

Mas de un año sin escribir nada, supongo que ya iba siendo hora… Al lio.

![](https://pbs.twimg.com/media/Bl7pVeHCEAAXJxl.jpg)

De vez en cuando me gusta jugar con dispositivos IOT y SCADA, creo que la razón principal es la relación impacto/dificultad de explotación, ya que el impacto suele ser bastante alto (entendiendo impacto como lo que se consigue tras una explotación satisfactoria) en comparación con lo que cuesta encontrar vulnerabilidades «criticas», realmente creo que lo mas complicado es encontrar los dispositivos, al menos para mi.

\****Antes de entrar en materia quiero aclarar que no tengo nada en contra de las empresas y/o instituciones que mencione a continuación y que la finalidad de la entrada es completamente informativa y educativa.***

Se ha hablado mucho de seguridad en iot desde mirai, también se ha hablado de la aspiradora autónoma que generaba un plano de tu casa usando el sensor de detección de obstáculos y mas recientemente de las pulseras fitbit.

El caso que quiero exponer hoy es el de tres vulnerabilidades para las cuales al momento de escribir esta entrada no hay parche y que pueden tener graves consecuencias.

[CVSSv3:](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H/RL:U/RC:C/CR:H/IR:M/AR:M/MAV:N/MAC:L/MPR:N/MUI:N/MS:U/MC:H/MI:H/MA:H)

![](https://i.imgur.com/5luDmfy.png)

Identificadores:

## [CVE-2018-11629](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11629)

## [CVE-2018-11681](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11681)

## [CVE-2018-11682](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11682)

Si habéis visitado alguno de los enlaces y habéis leído la pequeña referencia en ingles ya sabéis de lo que va la entrada. Para los que no, lo escribo de nuevo detallando un poco mas y explicando el por que del titulo.

La situación es la siguiente:

Hay un fabricante que desarrolla dispositivos iot y que ademas es capaz de interconectar sus propios dispositivos y los de otros fabricantes a traves de un protocolo de integración que contiene  ̶*u̶n̶ ̶b̶a̶c̶k̶d̶o̶o̶r̶ ̶p̶a̶r̶a̶ ̶l̶a̶s̶ ̶a̶g̶e̶n̶c̶i̶a̶s̶ ̶d̶e̶ ̶t̶r̶e̶s̶ ̶l̶e̶t̶r̶a̶s̶* una cuenta para ofrecer soporte en remoto al cliente, pero que el cliente no puede deshabilitar y que por supuesto ofrece acceso completo al dispositivo.

Impacto:

Un atacante que conozca estas credenciales podrá conectarse via telnet al dispositivo y tomar el control sobre la instalación.

Concretando un poco mas a que afecta y a que no esta vulnerabilidad.

Afecta a dispositivos que usen los protocolos de integración HomeWorks QS, radioRA 2 o stanza del fabricante Lutron Electronics.

De acuerdo con las especificaciones de esta misma empresa, los productos que usan RadioRA 2:

![](https://i.imgur.com/qtJuQQ9.png)

HomeWork QS:

![](https://i.imgur.com/9T7ZWM8.png)

Stanza:

![](https://i.imgur.com/r1mPZAn.png)

Las credenciales para cada caso (user:pwd)

lutron:integration

nwk:nwk2

![](https://i0.wp.com/intech.com.co/27850-large_default_2x/botonera-6-botones-con-r-l-hqrd-w6brl.jpg)

Lo que podemos hacer en este punto es interactuar con la instalación emulando pulsaciones en los botones a través de ? y # seguido de comando tal y como aparecerá explicado detalladamente en cada manual, así que tendremos acceso completo para manejar la instalación eléctrica a nuestro antojo.

![](https://i.imgur.com/LQypx2f.png)

***\*Captura tomada en un entorno controlado***

Actualmente hay entre 7000 y 8000 dispositivos vulnerables expuestos en internet.

Ahora la explicación de el por que del titulo, aunque te podrás imaginar por donde van los tiros.

![](https://i.imgur.com/QicoZ3k.png)

Las empresas y en general las personas tienden a compartir públicamente cosas de las que se sienten orgullosas y en este caso no es diferente, esta empresa comparte [públicamente](http://www.lutron.com/asia/Residential-Commercial-Solutions/Pages/SolApp/AllCaseStudies.aspx) como forma de marketing grandes proyectos en los que participa y con que dispositivos con unos resultados, todo hay que decir, bastante interesantes; pero visto desde el punto de vista de un atacante, le estas dando un vector de entrada muy valioso a sitios como el estadio de Wimbledon, el museo Guggenheim el centro financiero de Taipei, entidades bancarias, hospitales e incluso las instalaciones de la NASA en cabo cañaberal.

### Posible solución:

Dado que entre las características del protocolo de integración se encuentra la imposibilidad de establecer mas de una conexión simultánea con el mismo usuario, si establecemos nosotros mismos una conexión a nuestros dispositivos con esas credenciales seria imposible para un atacante hacerlo.

Antes de acabar, me gustaría hacer una reflexión y es que se habla mucho cuando pwnean una compañía, como por ejemplo Telefónica, Deloitte o las contraseñas en plano de Twitter. Se critica duramente a esas empresas (y con acierto bajo mi punto de vista (aunque al menos han dado la cara)) pero viendo casos como por ejemplo el reciente [bug](https://github.com/ezelf/CVE-2018-9995_dvr_credentials) descubierto por [Capitan alfa](https://twitter.com/Capitan_Alfa) en dispositivos DVR que afectaba cientos de miles de dispositivos de videovigilancia; que es lo que deberían hacer las empresas que comercializan estos dispositivos aparte de la obligación moral (y no se si legal) de publicar un parche que lo solucione? Porque tampoco veo grandes reacciones ni comunicados irrelevantes para limpiar su imagen como si hacen las compañías que mencione antes (es posible que el tema seguridad en el mundo industrial se considere irrelevante, no lo se). Supongo que sera cuestión de esperar a que a un banco le hagan un robo físico tomando el control de su edificio «inteligente» o algo similar donde quede patente que las debilidades del mundo ciber tienen impacto en el mundo físico.

Gracias por leer, hasta la próxima.

PD: Si eres de las personas que visitaba el blog para leer sobre ingeniería inversa, decir que seguramente vuelva a darle actividad relacionada con esos temas, aunque es probable que sea en formato vídeo por mayor comodidad. Si lo visitabas por temas relativos a malware decir que en este tiempo off he estado trabajando sobre un sistema para trackear malware bancario que pondré pronto online.

### Comparte:

* [Twitter](https://reversecodes.wordpress.com/2018/06/02/0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral/?share=twitter "Haz clic para compartir en Twitter")
* [Facebook](https://reversecodes.wordpress.com/2018/06/02/0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral/?share=facebook "Haz clic para compartir en Facebook")
Me gusta Cargando...
### *Relacionado*

Publicado el [2 junio, 20182 junio, 2018](https://reversecodes.wordpress.com/2018/06/02/0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral/) por [SadFud](https://reversecodes.wordpress.com/author/davidcv2/)
This entry was posted in [exploit](https://reversecodes.wordpress.com/category/exploit/), [iot](https://reversecodes.wordpress.com/category/iot/), [scada](https://reversecodes.wordpress.com/category/scada/). Bookmark the [permalink](https://reversecodes.wordpress.com/2018/06/02/0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral/).

# Navegador de artículos

[← DCS17 Writeup](https://reversecodes.wordpress.com/2017/05/17/dcs17-writeup/)[Analizando la app de La Liga para Android →](https://reversecodes.wordpress.com/2018/06/12/analizando-la-app-de-la-liga-para-android/)

### Deja un comentario [Cancelar la respuesta](/2018/06/02/0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral/#respond)

Δ

[Crea un blog o un sitio web gratuitos con WordPress.com.](https://wordpress.com/es/?ref=footer_website)

* [Comentar](https://reversecodes.wordpress.com/2018/06/02/0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral/#respond)
* Rebloguear
* Suscribirse
  Suscrito

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) reversecoder](https://reversecodes.wordpress.com)

  Suscríbeme

  + ¿Ya tienes una cuenta de WordPress.com? [Inicia sesión](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Freversecodes.wordpress.com%2F2018%2F06%2F02%2F0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral%2F&signup_flow=account).
* Privacidad
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) reversecoder](https://reversecodes.wordpress.com)
  + [Personalizar](https://reversecodes.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Freversecodes.wordpress.com%2F2018%2F06%2F02%2F0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral%2F)
  + Suscribirse
    Suscrito
  + [Regístrate](https://wordpress.com/start/)
  + [Iniciar sesión](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Freversecodes.wordpress.com%2F2018%2F06%2F02%2F0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral%2F&signup_flow=account)
  + [Copiar enlace corto](https://wp.me/p72OrA-iF)
  + [Denunciar este contenido](https://wordpress.com/abuse/?report_url=https://reversecodes.wordpress.com/2018/06/02/0-day-tomando-el-control-de-las-instalaciones-de-la-nasa-en-cabo-canaveral/)
  + [View post in Reader](https://wordpress.com/read/blogs/104104918/posts/1157)
  + [Gestionar las suscripciones](https://subscribe.wordpress.com/)
  + Contraer esta barra

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Diseña un sitio como este con WordPress.com[Comenzar](https://wordpress.com/start/es?ref=marketing_bar)

