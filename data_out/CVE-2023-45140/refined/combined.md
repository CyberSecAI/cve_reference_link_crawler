=== Content from github.com_3aca6f26_20250110_163030.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fovh%2Fthe-bastion%2Freleases%2Ftag%2Fv3.14.15)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fovh%2Fthe-bastion%2Freleases%2Ftag%2Fv3.14.15)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=ovh%2Fthe-bastion)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ovh](/ovh)
/
**[the-bastion](/ovh/the-bastion)**
Public

* [Notifications](/login?return_to=%2Fovh%2Fthe-bastion) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2Fovh%2Fthe-bastion)
* [Star
   1.6k](/login?return_to=%2Fovh%2Fthe-bastion)

* [Code](/ovh/the-bastion/tree/v3.14.15)
* [Issues
  33](/ovh/the-bastion/issues)
* [Pull requests
  0](/ovh/the-bastion/pulls)
* [Actions](/ovh/the-bastion/actions)
* [Security](/ovh/the-bastion/security)
* [Insights](/ovh/the-bastion/pulse)

Additional navigation options

* [Code](/ovh/the-bastion/tree/v3.14.15)
* [Issues](/ovh/the-bastion/issues)
* [Pull requests](/ovh/the-bastion/pulls)
* [Actions](/ovh/the-bastion/actions)
* [Security](/ovh/the-bastion/security)
* [Insights](/ovh/the-bastion/pulse)

1. [Releases](/ovh/the-bastion/releases)
2. [v3.14.15](/ovh/the-bastion/releases/tag/v3.14.15)

# v3.14.15

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/ovh/the-bastion/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.14.15)

 Loading

[View all tags](/ovh/the-bastion/tags)

![@speed47](https://avatars.githubusercontent.com/u/218502?s=40&v=4)
[speed47](/speed47)
released this
08 Nov 14:02

¬∑
[127 commits](/ovh/the-bastion/compare/v3.14.15...master)
to master
since this release

[v3.14.15](/ovh/the-bastion/tree/v3.14.15)

[`137c7b5`](/ovh/the-bastion/commit/137c7b54540595f557debe3c804f00553119bd60)

# ‚ö° Security

* Fixed [CVE-2023-45140](https://github.com/ovh/the-bastion/security/advisories/GHSA-pr4q-w883-pf5x) with severity 4.8 (CVSS 3.0)

# üí° Highlights

This release fixes a security issue where JIT MFA on `sftp` and `scp` plugins was not honored. Please refer to [CVE-2023-45140](https://github.com/ovh/the-bastion/security/advisories/GHSA-pr4q-w883-pf5x) for impact and mitigation details.

Upgrading to this version is sufficient to fix the issue, but please read through the specific [upgrading instructions](https://ovh.github.io/the-bastion/installation/upgrading.html#v3-14-15-2023-11-08) of this version.

A more complete list of changes can be found below, for an exhaustive (and boring) list, please refer to the commit log.

# üìå Changes

* feat: support JIT MFA through plugins, including `sftp` and `scp` (fixes [CVE-2023-45140](https://github.com/ovh/the-bastion/security/advisories/GHSA-pr4q-w883-pf5x))
* feat: add configuration option for plugins to override the global lock/kill timeout
* enh: `setup-gpg.sh`: allow importing multiple public keys at once
* enh: `connect.pl`: report empty ttyrec as `ttyrec_empty` instead of `ttyrec_error`
* enh: orphaned homedirs: adjust behavior on master instances
* fix: check\_collisions: don't report orphan uids on slave, just use their name
* fix: `scp`: adapt wrapper and tests to new `scp` versions requiring `-O`
* meta: dev: add devenv docker, pre-commit info, and documentation on how to use them, along with how to write integration tests

# ‚è© Upgrading

* [General upgrade instructions](https://ovh.github.io/the-bastion/installation/upgrading.html)
* [Specific upgrade instructions for v3.14.15](https://ovh.github.io/the-bastion/installation/upgrading.html#v3-14-15-2023-11-08)

 Assets
2

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_c8ce8a5c_20250110_163030.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fovh%2Fthe-bastion%2Fsecurity%2Fadvisories%2FGHSA-pr4q-w883-pf5x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fovh%2Fthe-bastion%2Fsecurity%2Fadvisories%2FGHSA-pr4q-w883-pf5x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=ovh%2Fthe-bastion)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ovh](/ovh)
/
**[the-bastion](/ovh/the-bastion)**
Public

* [Notifications](/login?return_to=%2Fovh%2Fthe-bastion) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2Fovh%2Fthe-bastion)
* [Star
   1.6k](/login?return_to=%2Fovh%2Fthe-bastion)

* [Code](/ovh/the-bastion)
* [Issues
  33](/ovh/the-bastion/issues)
* [Pull requests
  0](/ovh/the-bastion/pulls)
* [Actions](/ovh/the-bastion/actions)
* [Security](/ovh/the-bastion/security)
* [Insights](/ovh/the-bastion/pulse)

Additional navigation options

* [Code](/ovh/the-bastion)
* [Issues](/ovh/the-bastion/issues)
* [Pull requests](/ovh/the-bastion/pulls)
* [Actions](/ovh/the-bastion/actions)
* [Security](/ovh/the-bastion/security)
* [Insights](/ovh/the-bastion/pulse)

# Group-based and account-based JIT MFA bypass on scp and sftp

Moderate

[speed47](/speed47)
published
GHSA-pr4q-w883-pf5x
Nov 8, 2023

## Package

The Bastion

## Affected versions

3.0.0 to 3.14.0 included

## Patched versions

3.14.15 and up

## Description

### Summary

SCP and SFTP plugins don't honor group-based and account-based JIT MFA

### Details

Establishing a SCP/SFTP connection through The Bastion via a group or personal access where MFA is enforced does not ask for additional factor. This abnormal behavior only applies to [per-group-based JIT MFA](https://ovh.github.io/the-bastion/administration/mfa.html#on-a-per-group-basis) and [JIT MFA on a per-account basis](https://ovh.github.io/the-bastion/administration/mfa.html#on-a-per-account-basis).

Other MFA setup types, such as [Immediate MFA](https://ovh.github.io/the-bastion/administration/mfa.html#immediate-mfa) or [JIT MFA on a per-plugin basis](https://ovh.github.io/the-bastion/administration/mfa.html#on-a-per-plugin-basis) are not affected.

Normal SSH access (i.e. not SCP nor SFTP) is not affected.

### How to reproduce for group-based JIT MFA

* Create a group
* Apply `groupModify --mfa-required any` to this group
* Grant SSH access to someone via this group on a given IP
* Grant scp download right (or sftp right) to the same person via this group on the same IP
* This group should now force MFA for any connection of the person allowed through the group's rights set. This is the case for SSH, but not for SCP or SFTP as would be expected.

### How to reproduce for account-based JIT MFA

* Create an account
* Apply `accountModify --personal-egress-mfa-required any` to this account
* Grant a personal SSH access to this account on a given IP
* Grant scp download right (or sftp right) to the same account via their personal access on the same IP
* This account should now have forced MFA for any egress connection allowed through their personal rights set. This is the case for SSH, but not for SCP or SFTP as would be expected.

### Impact for group-based JIT MFA

For an actor to be able to bypass MFA for scp/sftp to a given remote server, ALL the following conditions must apply:

* The target server must be part of a group (and have the egress group's public key trusted in its `authorized_keys` file)
* The group must have JIT MFA enabled on it (through `groupModify --mfa-required any`)
* The actor must have an account on the bastion
* The actor must be a member of the group (granted by the groups's gatekeepers)
* scp and/or sftp must be globally enabled on the bastion (this is the default)
* scp and/or sftp must be explicitly allowed to the given remote server through the group (granted by the groups's aclkeepers)

When all conditions above apply, the actor would be able to use scp or sftp on the target server without requiring to provide an additional factor where it should.

### Impact for account-based JIT MFA

For an actor to be able to bypass MFA for scp/sftp to a given remote server, ALL the following conditions must apply:

* The target server must be part of the actor's account personal accesses (and have the account's egress public key trusted in its `authorized_keys` file)
* The account must have JIT MFA enabled on it (through `accountModify --personal-egress-mfa-required any`)
* scp and/or sftp must be globally enabled on the bastion (this is the default)
* scp and/or sftp must be explicitly allowed to the given remote server through this account's personal accesses (granted by either `selfAddPersonalAccess` or `accountAddPersonalAccess`)

When all conditions above apply, the actor would be able to use scp or sftp on the target server without requiring to provide an additional factor where it should.

### Mitigation

If you don't use the [per-group-based JIT MFA](https://ovh.github.io/the-bastion/administration/mfa.html#on-a-per-group-basis%3E) on any of your groups (through `groupModify --mfa-required`), and don't use the [JIT MFA on a per-account basis](https://ovh.gi%E2%86%AA%C2%B7thub.io/the-bastion/administration/mfa.html#on-a-per-account-basis) (through `accountModify --personal-egress-mfa-required`), you don't need to mitigate the issue as you don't use the impacted feature (see above for impact details).

Otherwise, if you can't immediately upgrade to v3.14.15 or more recent, and you feel that the aforementioned impacts are important enough in your environment, you may choose to temporarily disable the `scp` and `sftp` plugins globally on the bastion, by setting `"disabled": true` in these plugins configuration files, which can be found in `/etc/bastion/plugin.scp.conf` and `/etc/bastion/plugin.sftp.conf` respectively. If these files don't exist, create them with the contents as `{ "disabled": true }`. They should be readable by anyone but modifiable only by root (i.e. `chmod 664; chown root:root`)

### Severity

Moderate

4.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
Required

Scope
Changed

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N

### CVE ID

CVE-2023-45140

### Weaknesses

[CWE-288](/advisories?query=cwe%3A288)

### Credits

* [![@ThibaultDewailly](https://avatars.githubusercontent.com/u/18576270?s=40&v=4)](/ThibaultDewailly)
  [ThibaultDewailly](/ThibaultDewailly)
  Reporter
* [![@deathiop](https://avatars.githubusercontent.com/u/1357332?s=40&v=4)](/deathiop)
  [deathiop](/deathiop)
  Remediation reviewer
* [![@speed47](https://avatars.githubusercontent.com/u/218502?s=40&v=4)](/speed47)
  [speed47](/speed47)
  Remediation developer

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


