The content is related to CVE-2023-45140.

**Root cause of vulnerability:**
The vulnerability arises from the fact that the SCP and SFTP plugins in The Bastion do not correctly enforce Just-in-Time (JIT) Multi-Factor Authentication (MFA) when it is configured on a per-group or per-account basis. This means that users can bypass MFA when using SCP or SFTP, even when MFA is required for other access methods like SSH.

**Weaknesses/vulnerabilities present:**
- Improper enforcement of JIT MFA for SCP and SFTP plugins when configured per-group or per-account.
- Bypass of MFA requirement for SCP/SFTP connections.
- Inconsistent behavior in MFA enforcement across different access methods (SSH vs. SCP/SFTP).

**Impact of exploitation:**
- Attackers can bypass MFA, gaining unauthorized access to remote servers via SCP or SFTP, when group-based or account-based JIT MFA is enabled.
- Potential unauthorized data access/exfiltration using SCP/SFTP.

**Attack vectors:**
- Network-based attack via SCP/SFTP protocols.

**Required attacker capabilities/position:**
For group-based JIT MFA bypass:
    - The target server must be part of a group.
    - The group must have JIT MFA enabled.
    - The attacker must have an account on the bastion.
    - The attacker must be a member of the group.
    - SCP/SFTP must be globally enabled on the bastion and explicitly allowed through the group.
For account-based JIT MFA bypass:
    - The target server must be part of the attacker's account personal accesses.
    - The account must have JIT MFA enabled.
    - SCP/SFTP must be globally enabled on the bastion and explicitly allowed through the account's personal accesses.