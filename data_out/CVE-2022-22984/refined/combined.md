=== Content from security.snyk.io_645c0d16_20250108_125137.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. snyk
# Command Injection Affecting [snyk](/package/npm/snyk) package, versions **<1.1064.0**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-SNYK-3038622#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.52% (77th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Command Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**SNYK-JS-SNYK-3038622**
* published**30 Nov 2022**
* disclosed**29 Sept 2022**
* credit**Ron Masas - Imperva**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 29 Sep 2022

[CVE-2022-22984  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-22984) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-77  (opens in a new tab)](https://cwe.mitre.org/data/definitions/77.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `snyk` to version 1.1064.0 or higher.

## Overview

[snyk](https://www.npmjs.com/package/snyk) is an advanced tool that scans and monitors projects for security vulnerabilities.

Affected versions of this package are vulnerable to Command Injection due to an incomplete fix for [CVE-2022-40764](https://security.snyk.io/vuln/SNYK-JS-SNYK-3037342).

A successful exploit allows attackers to run arbitrary commands on the host system where the Snyk CLI is installed by passing in crafted command line flags.

In order to exploit this vulnerability, a user would have to execute the `snyk test` command on untrusted files. In most cases, an attacker positioned to control the command line arguments to the Snyk CLI would already be positioned to execute arbitrary commands. However, this could be abused in specific scenarios, such as continuous integration pipelines, where developers can control the arguments passed to the Snyk CLI to leverage this component as part of a wider attack against an integration/build pipeline.

This issue has been addressed in the latest Snyk Docker images available at <https://hub.docker.com/r/snyk/snyk> as of 2022-11-29. Images downloaded and built prior to that date should be updated.

The issue has also been addressed in the Snyk TeamCity CI/CD plugin as of version v20221130.093605.

## References

* [GitHub Commit (CLI)](https://github.com/snyk/cli/commit/80d97a93326406e09776156daf72e3caa03ae25a)
* [GitHub Commit (snyk-cocoapods-plugin)](https://github.com/snyk/snyk-cocoapods-plugin/commit/c73e049c5200772babde61c40aab57296bf91381)
* [GitHub Commit (snyk-docker-plugin)](https://github.com/snyk/snyk-docker-plugin/commit/d730d7630691a61587b120bb11daaaf4b58a8357)
* [GitHub Commit (snyk-gradle-plugin)](https://github.com/snyk/snyk-gradle-plugin/commit/bb1c1c72a75e97723a76b14d2d73f70744ed5009)
* [GitHub Commit (snyk-hex-plugin)](https://github.com/snyk/snyk-hex-plugin/commit/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)
* [GitHub Commit (snyk-mvn-plugin)](https://github.com/snyk/snyk-mvn-plugin/commit/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)
* [GitHub Commit (snyk-python-plugin)](https://github.com/snyk/snyk-python-plugin/commit/8591abdd9236108ac3e30c70c09238d6bb6aabf4)
* [GitHub Commit (snyk-sbt-plugin)](https://github.com/snyk/snyk-sbt-plugin/commit/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)
* [Imperva Blog Post](https://www.imperva.com/blog/how-scanning-your-projects-for-security-issues-can-lead-to-remote-code-execution/)
* [Snyk Blog Post](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev/)
### CVSS Scores

version 3.1
### Snyk

5 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker requires privileges that provide basic user capabilities that could normally affect only settings and files owned by a user. Alternatively, an attacker with Low privileges has the ability to access only non-sensitive resources.

  **Low**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

6.3 medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_660ffcbb_20250108_125132.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-docker-plugin%2Fcommit%2Fd730d7630691a61587b120bb11daaaf4b58a8357)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-docker-plugin%2Fcommit%2Fd730d7630691a61587b120bb11daaaf4b58a8357)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-docker-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-docker-plugin](/snyk/snyk-docker-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-docker-plugin) You must be signed in to change notification settings
* [Fork
  25](/login?return_to=%2Fsnyk%2Fsnyk-docker-plugin)
* [Star
   33](/login?return_to=%2Fsnyk%2Fsnyk-docker-plugin)

* [Code](/snyk/snyk-docker-plugin)
* [Issues
  0](/snyk/snyk-docker-plugin/issues)
* [Pull requests
  5](/snyk/snyk-docker-plugin/pulls)
* [Actions](/snyk/snyk-docker-plugin/actions)
* [Security](/snyk/snyk-docker-plugin/security)
* [Insights](/snyk/snyk-docker-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-docker-plugin)
* [Issues](/snyk/snyk-docker-plugin/issues)
* [Pull requests](/snyk/snyk-docker-plugin/pulls)
* [Actions](/snyk/snyk-docker-plugin/actions)
* [Security](/snyk/snyk-docker-plugin/security)
* [Insights](/snyk/snyk-docker-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-docker-plugin/commit/d730d7630691a61587b120bb11daaaf4b58a8357)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: quote spawn args

[Browse files](/snyk/snyk-docker-plugin/tree/d730d7630691a61587b120bb11daaaf4b58a8357)
Browse the repository at this point in the history

* Loading branch information

[![@darscan](https://avatars.githubusercontent.com/u/59090?s=40&v=4)](/darscan) [![@tommyknows](https://avatars.githubusercontent.com/u/16387735?s=40&v=4)](/tommyknows)

[darscan](/snyk/snyk-docker-plugin/commits?author=darscan "View all commits by darscan")
authored and
[tommyknows](/snyk/snyk-docker-plugin/commits?author=tommyknows "View all commits by tommyknows")
committed
Nov 29, 2022

1 parent
[2b999b8](/snyk/snyk-docker-plugin/commit/2b999b81b4a9541801d2935546600b181f17abd3)

commit d730d76

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**15 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .snyk
  [.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f)
* lib

  + lib/docker.ts
    [docker.ts](#diff-3d74d8b37c8032953dd285c224e15c2856d3513f59517efb7e9514907dc50791)
  + lib/sub-process.ts
    [sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)

## There are no files selected for viewing

10 changes: 8 additions & 2 deletions

10
[.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f ".snyk")

Show comments

[View file](/snyk/snyk-docker-plugin/blob/d730d7630691a61587b120bb11daaaf4b58a8357/.snyk)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,10 @@ |
|  |  | # Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities. |
|  |  | version: v1.7.1 |
|  |  | ignore: {} |
|  |  | version: v1.25.0 |
|  |  | # ignores vulnerabilities until expiry date; change duration by modifying expiry date |
|  |  | ignore: |
|  |  | 'snyk:lic:npm:shescape:MPL-2.0': |
|  |  | - '\*': |
|  |  | reason: None Given |
|  |  | expires: 2122-12-29T08:08:41.608Z |
|  |  | created: 2022-11-29T08:08:41.611Z |
|  |  | patch: {} |

6 changes: 3 additions & 3 deletions

6
[lib/docker.ts](#diff-3d74d8b37c8032953dd285c224e15c2856d3513f59517efb7e9514907dc50791 "lib/docker.ts")

Show comments

[View file](/snyk/snyk-docker-plugin/blob/d730d7630691a61587b120bb11daaaf4b58a8357/lib/docker.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,12 +55,12 @@ class Docker { |
|  |  | targetImage: string, |
|  |  | options?: DockerOptions, |
|  |  | ): Promise<subProcess.CmdOutput> { |
|  |  | const opts: string[] = ["pull", targetImage]; |
|  |  | const args: string[] = ["pull", targetImage]; |
|  |  | if (options?.platform) { |
|  |  | opts.push(`--platform=${options.platform}`); |
|  |  | args.push(`--platform=${options.platform}`); |
|  |  | } |
|  |  |  |
|  |  | return subProcess.execute("docker", opts); |
|  |  | return subProcess.execute("docker", args); |
|  |  | } |
|  |  |  |
|  |  | public async save(targetImage: string, destination: string) { |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[lib/sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d "lib/sub-process.ts")

Show comments

[View file](/snyk/snyk-docker-plugin/blob/d730d7630691a61587b120bb11daaaf4b58a8357/lib/sub-process.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,5 @@ |
|  |  | import \* as childProcess from "child\_process"; |
|  |  | import { quoteAll } from "shescape"; |
|  |  |  |
|  |  | export { execute, CmdOutput }; |
|  |  | interface CmdOutput { |
| Expand All | | @@ -8,13 +9,14 @@ interface CmdOutput { |
|  |  |  |
|  |  | function execute( |
|  |  | command: string, |
|  |  | args?: string[], |
|  |  | args: string[], |
|  |  | options?, |
|  |  | ): Promise<CmdOutput> { |
|  |  | const spawnOptions: any = { shell: true }; |
|  |  | if (options && options.cwd) { |
|  |  | spawnOptions.cwd = options.cwd; |
|  |  | } |
|  |  | args = quoteAll(args, spawnOptions); |
|  |  |  |
|  |  | return new Promise((resolve, reject) => { |
|  |  | let stdout = ""; |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/snyk/snyk-docker-plugin/blob/d730d7630691a61587b120bb11daaaf4b58a8357/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -44,6 +44,7 @@ |
|  |  | "gunzip-maybe": "^1.4.2", |
|  |  | "mkdirp": "^1.0.4", |
|  |  | "semver": "^7.3.4", |
|  |  | "shescape": "1.6.1", |
|  |  | "snyk-nodejs-lockfile-parser": "1.40.0", |
|  |  | "snyk-poetry-lockfile-parser": "^1.1.7", |
|  |  | "tar-stream": "^2.1.0", |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d730d76`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-docker-plugin%2Fcommit%2Fd730d7630691a61587b120bb11daaaf4b58a8357) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f50f4b49_20250108_125131.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fcli%2Fcommit%2F80d97a93326406e09776156daf72e3caa03ae25a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fcli%2Fcommit%2F80d97a93326406e09776156daf72e3caa03ae25a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fcli)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[cli](/snyk/cli)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fcli) You must be signed in to change notification settings
* [Fork
  567](/login?return_to=%2Fsnyk%2Fcli)
* [Star
   5k](/login?return_to=%2Fsnyk%2Fcli)

* [Code](/snyk/cli)
* [Pull requests
  23](/snyk/cli/pulls)
* [Actions](/snyk/cli/actions)
* [Security](/snyk/cli/security)
* [Insights](/snyk/cli/pulse)

Additional navigation options

* [Code](/snyk/cli)
* [Pull requests](/snyk/cli/pulls)
* [Actions](/snyk/cli/actions)
* [Security](/snyk/cli/security)
* [Insights](/snyk/cli/pulse)

## Commit

[Permalink](/snyk/cli/commit/80d97a93326406e09776156daf72e3caa03ae25a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: escape child process arguments

[Browse files](/snyk/cli/tree/80d97a93326406e09776156daf72e3caa03ae25a)
Browse the repository at this point in the history

* Loading branch information

[![@gitphill](https://avatars.githubusercontent.com/u/6598617?s=40&v=4)](/gitphill) [![@xzhou-snyk](https://avatars.githubusercontent.com/u/102186579?s=40&v=4)](/xzhou-snyk)

[gitphill](/snyk/cli/commits?author=gitphill "View all commits by gitphill")
authored and
[xzhou-snyk](/snyk/cli/commits?author=xzhou-snyk "View all commits by xzhou-snyk")
committed
Nov 29, 2022

1 parent
[c028b50](/snyk/cli/commit/c028b50760b068d0461b558e80256364a52f5d77)

commit 80d97a9

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**60 additions**
and
**48 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* package-lock.json
  [package-lock.json](#diff-053150b640a7ce75eff69d1a22cae7f0f94ad64ce9a855db544dda0929316519)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)

## There are no files selected for viewing

96 changes: 54 additions & 42 deletions

96
[package-lock.json](#diff-053150b640a7ce75eff69d1a22cae7f0f94ad64ce9a855db544dda0929316519 "package-lock.json")

Show comments

[View file](/snyk/cli/blob/80d97a93326406e09776156daf72e3caa03ae25a/package-lock.json)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

12 changes: 6 additions & 6 deletions

12
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/snyk/cli/blob/80d97a93326406e09776156daf72e3caa03ae25a/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -67,8 +67,8 @@ |
|  |  | "@snyk/docker-registry-v2-client": "^2.7.3", |
|  |  | "@snyk/fix": "file:packages/snyk-fix", |
|  |  | "@snyk/gemfile": "1.2.0", |
|  |  | "@snyk/snyk-cocoapods-plugin": "2.5.2", |
|  |  | "@snyk/snyk-hex-plugin": "1.1.4", |
|  |  | "@snyk/snyk-cocoapods-plugin": "2.5.3", |
|  |  | "@snyk/snyk-hex-plugin": "1.1.6", |
|  |  | "@types/jest-json-schema": "^6.1.1", |
|  |  | "@types/marked": "^4.0.0", |
|  |  | "abbrev": "^1.1.1", |
| Expand Down  Expand Up | | @@ -113,18 +113,18 @@ |
|  |  | "semver": "^6.0.0", |
|  |  | "snyk-config": "4.0.0", |
|  |  | "snyk-cpp-plugin": "2.20.1", |
|  |  | "snyk-docker-plugin": "^5.6.4", |
|  |  | "snyk-docker-plugin": "5.6.5", |
|  |  | "snyk-go-plugin": "^1.19.4", |
|  |  | "snyk-gradle-plugin": "3.24.6", |
|  |  | "snyk-module": "3.1.0", |
|  |  | "snyk-mvn-plugin": "2.31.2", |
|  |  | "snyk-mvn-plugin": "2.31.3", |
|  |  | "snyk-nodejs-lockfile-parser": "1.44.0", |
|  |  | "snyk-nuget-plugin": "1.23.5", |
|  |  | "snyk-php-plugin": "1.9.2", |
|  |  | "snyk-policy": "^1.25.0", |
|  |  | "snyk-python-plugin": "1.24.1", |
|  |  | "snyk-python-plugin": "1.24.2", |
|  |  | "snyk-resolve-deps": "4.7.3", |
|  |  | "snyk-sbt-plugin": "2.16.1", |
|  |  | "snyk-sbt-plugin": "2.16.2", |
|  |  | "strip-ansi": "^5.2.0", |
|  |  | "tar": "^6.1.2", |
|  |  | "uuid": "^8.3.2", |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `80d97a9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fcli%2Fcommit%2F80d97a93326406e09776156daf72e3caa03ae25a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.snyk.io_4a0ddc28_20250108_125140.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. @snyk/snyk-cocoapods-plugin
# Command Injection Affecting [@snyk/snyk-cocoapods-plugin](/package/npm/%40snyk/snyk-cocoapods-plugin) package, versions **<2.5.3**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-SNYKSNYKCOCOAPODSPLUGIN-3038625#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.52% (77th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Command Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**SNYK-JS-SNYKSNYKCOCOAPODSPLUGIN-3038625**
* published**30 Nov 2022**
* disclosed**29 Sept 2022**
* credit**Ron Masas - Imperva**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 29 Sep 2022

[CVE-2022-22984  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-22984) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-77  (opens in a new tab)](https://cwe.mitre.org/data/definitions/77.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `@snyk/snyk-cocoapods-plugin` to version 2.5.3 or higher.

## Overview

Affected versions of this package are vulnerable to Command Injection due to an incomplete fix for [CVE-2022-40764](https://security.snyk.io/vuln/SNYK-JS-SNYK-3037342).

A successful exploit allows attackers to run arbitrary commands on the host system where the Snyk CLI is installed by passing in crafted command line flags.

In order to exploit this vulnerability, a user would have to execute the `snyk test` command on untrusted files. In most cases, an attacker positioned to control the command line arguments to the Snyk CLI would already be positioned to execute arbitrary commands. However, this could be abused in specific scenarios, such as continuous integration pipelines, where developers can control the arguments passed to the Snyk CLI to leverage this component as part of a wider attack against an integration/build pipeline.

This issue has been addressed in the latest Snyk Docker images available at <https://hub.docker.com/r/snyk/snyk> as of 2022-11-29. Images downloaded and built prior to that date should be updated.

The issue has also been addressed in the Snyk TeamCity CI/CD plugin as of version v20221130.093605.

## References

* [GitHub Commit (CLI)](https://github.com/snyk/cli/commit/80d97a93326406e09776156daf72e3caa03ae25a)
* [GitHub Commit (snyk-cocoapods-plugin)](https://github.com/snyk/snyk-cocoapods-plugin/commit/c73e049c5200772babde61c40aab57296bf91381)
* [GitHub Commit (snyk-docker-plugin)](https://github.com/snyk/snyk-docker-plugin/commit/d730d7630691a61587b120bb11daaaf4b58a8357)
* [GitHub Commit (snyk-gradle-plugin)](https://github.com/snyk/snyk-gradle-plugin/commit/bb1c1c72a75e97723a76b14d2d73f70744ed5009)
* [GitHub Commit (snyk-hex-plugin)](https://github.com/snyk/snyk-hex-plugin/commit/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)
* [GitHub Commit (snyk-mvn-plugin)](https://github.com/snyk/snyk-mvn-plugin/commit/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)
* [GitHub Commit (snyk-python-plugin)](https://github.com/snyk/snyk-python-plugin/commit/8591abdd9236108ac3e30c70c09238d6bb6aabf4)
* [GitHub Commit (snyk-sbt-plugin)](https://github.com/snyk/snyk-sbt-plugin/commit/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)
* [Imperva Blog Post](https://www.imperva.com/blog/how-scanning-your-projects-for-security-issues-can-lead-to-remote-code-execution/)
* [Snyk Blog Post](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev/)
### CVSS Scores

version 3.1
### Snyk

5 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker requires privileges that provide basic user capabilities that could normally affect only settings and files owned by a user. Alternatively, an attacker with Low privileges has the ability to access only non-sensitive resources.

  **Low**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

6.3 medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_509d5003_20250108_125136.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-sbt-plugin%2Fcommit%2F99c09eb12c9f8f2b237aea9627aab1ae3cab6437)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-sbt-plugin%2Fcommit%2F99c09eb12c9f8f2b237aea9627aab1ae3cab6437)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-sbt-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-sbt-plugin](/snyk/snyk-sbt-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-sbt-plugin) You must be signed in to change notification settings
* [Fork
  14](/login?return_to=%2Fsnyk%2Fsnyk-sbt-plugin)
* [Star
   9](/login?return_to=%2Fsnyk%2Fsnyk-sbt-plugin)

* [Code](/snyk/snyk-sbt-plugin)
* [Issues
  2](/snyk/snyk-sbt-plugin/issues)
* [Pull requests
  9](/snyk/snyk-sbt-plugin/pulls)
* [Actions](/snyk/snyk-sbt-plugin/actions)
* [Projects
  0](/snyk/snyk-sbt-plugin/projects)
* [Security](/snyk/snyk-sbt-plugin/security)
* [Insights](/snyk/snyk-sbt-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-sbt-plugin)
* [Issues](/snyk/snyk-sbt-plugin/issues)
* [Pull requests](/snyk/snyk-sbt-plugin/pulls)
* [Actions](/snyk/snyk-sbt-plugin/actions)
* [Projects](/snyk/snyk-sbt-plugin/projects)
* [Security](/snyk/snyk-sbt-plugin/security)
* [Insights](/snyk/snyk-sbt-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-sbt-plugin/commit/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: escape child process arguments

[Browse files](/snyk/snyk-sbt-plugin/tree/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)
Browse the repository at this point in the history

* Loading branch information

[![@gitphill](https://avatars.githubusercontent.com/u/6598617?s=40&v=4)](/gitphill)

[gitphill](/snyk/snyk-sbt-plugin/commits?author=gitphill "View all commits by gitphill")
committed
Nov 29, 2022

1 parent
[63e5c44](/snyk/snyk-sbt-plugin/commit/63e5c44063b33bd5c06072d192e9d804c5644d75)

commit 99c09eb

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**21 additions**
and
**8 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .snyk
  [.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f)
* lib

  + lib/index.ts
    [index.ts](#diff-d5a4b3a0309f2337144861084c1014523cced561eb722cb9684c63f5e41e0567)
  + lib/sub-process.ts
    [sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* test/functional

  + test/functional/sbt-plugin.test.ts
    [sbt-plugin.test.ts](#diff-9ac4d8f547629622ef544579db791e8062f2b82e3969d24528830ed2d7815617)

## There are no files selected for viewing

10 changes: 10 additions & 0 deletions

10
[.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f ".snyk")

Show comments

[View file](/snyk/snyk-sbt-plugin/blob/99c09eb12c9f8f2b237aea9627aab1ae3cab6437/.snyk)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,10 @@ |
|  |  | # Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities. |
|  |  | version: v1.19.0 |
|  |  | # ignores vulnerabilities until expiry date; change duration by modifying expiry date |
|  |  | ignore: |
|  |  | 'snyk:lic:npm:shescape:MPL-2.0': |
|  |  | - '\*': |
|  |  | reason: None Given |
|  |  | expires: 2122-12-29T08:01:32.423Z |
|  |  | created: 2022-11-29T08:01:32.424Z |
|  |  | patch: {} |

2 changes: 1 addition & 1 deletion

2
[lib/index.ts](#diff-d5a4b3a0309f2337144861084c1014523cced561eb722cb9684c63f5e41e0567 "lib/index.ts")

Show comments

[View file](/snyk/snyk-sbt-plugin/blob/99c09eb12c9f8f2b237aea9627aab1ae3cab6437/lib/index.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -265,7 +265,7 @@ export function buildArgs( |
|  |  | isOutputGraph?: boolean, |
|  |  | ) { |
|  |  | // force plain output so we don't have to parse colour codes |
|  |  | let args = ['"-Dsbt.log.noformat=true"']; |
|  |  | let args = ['-Dsbt.log.noformat=true']; |
|  |  | if (sbtArgs) { |
|  |  | args = args.concat(sbtArgs); |
|  |  | } |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[lib/sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d "lib/sub-process.ts")

Show comments

[View file](/snyk/snyk-sbt-plugin/blob/99c09eb12c9f8f2b237aea9627aab1ae3cab6437/lib/sub-process.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,7 @@ |
|  |  | import \* as childProcess from 'child\_process'; |
|  |  | import \* as treeKill from 'tree-kill'; |
|  |  | import \* as debugModule from 'debug'; |
|  |  | import { quoteAll } from 'shescape'; |
|  |  |  |
|  |  | // To enable debugging output, run the CLI as `DEBUG=snyk-sbt-plugin snyk ...` |
|  |  | const debugLogging = debugModule('snyk-sbt-plugin'); |
| Expand All | | @@ -18,6 +19,7 @@ export const execute = ( |
|  |  | if (options && options.cwd) { |
|  |  | spawnOptions.cwd = options.cwd; |
|  |  | } |
|  |  | args = quoteAll(args, spawnOptions); |
|  |  |  |
|  |  | return new Promise((resolve, reject) => { |
|  |  | const out = { |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/snyk/snyk-sbt-plugin/blob/99c09eb12c9f8f2b237aea9627aab1ae3cab6437/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -44,6 +44,7 @@ |
|  |  | "dependencies": { |
|  |  | "debug": "^4.1.1", |
|  |  | "semver": "^6.1.2", |
|  |  | "shescape": "1.6.1", |
|  |  | "tmp": "^0.1.0", |
|  |  | "tree-kill": "^1.2.2", |
|  |  | "tslib": "^1.10.0" |
| Expand Down | |  |

14 changes: 7 additions & 7 deletions

14
[test/functional/sbt-plugin.test.ts](#diff-9ac4d8f547629622ef544579db791e8062f2b82e3969d24528830ed2d7815617 "test/functional/sbt-plugin.test.ts")

Show comments

[View file](/snyk/snyk-sbt-plugin/blob/99c09eb12c9f8f2b237aea9627aab1ae3cab6437/test/functional/sbt-plugin.test.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,7 +7,7 @@ test('check build args with array not coursier', (t) => { |
|  |  | '-Pjaxen', |
|  |  | ], false); |
|  |  | t.deepEqual(result, [ |
|  |  | '"-Dsbt.log.noformat=true\"', |
|  |  | '-Dsbt.log.noformat=true', |
|  |  | '-Paxis', |
|  |  | '-Pjaxen', |
|  |  | 'dependencyTree', |
| Expand All | | @@ -18,7 +18,7 @@ test('check build args with array not coursier', (t) => { |
|  |  | test('check build args with string not coursie', (t) => { |
|  |  | const result = plugin.buildArgs('-Paxis -Pjaxen', false); |
|  |  | t.deepEqual(result, [ |
|  |  | '"-Dsbt.log.noformat=true\"', |
|  |  | '-Dsbt.log.noformat=true', |
|  |  | '-Paxis -Pjaxen', |
|  |  | 'dependencyTree', |
|  |  | ]); |
| Expand All | | @@ -31,7 +31,7 @@ test('check build args with array for coursier', (t) => { |
|  |  | '-Pjaxen', |
|  |  | ], true); |
|  |  | t.deepEqual(result, [ |
|  |  | '"-Dsbt.log.noformat=true\"', |
|  |  | '-Dsbt.log.noformat=true', |
|  |  | '-Paxis', |
|  |  | '-Pjaxen', |
|  |  | 'coursierDependencyTree', |
| Expand All | | @@ -42,7 +42,7 @@ test('check build args with array for coursier', (t) => { |
|  |  | test('check build args with string for coursier', (t) => { |
|  |  | const result = plugin.buildArgs('-Paxis -Pjaxen', true); |
|  |  | t.deepEqual(result, [ |
|  |  | '"-Dsbt.log.noformat=true\"', |
|  |  | '-Dsbt.log.noformat=true', |
|  |  | '-Paxis -Pjaxen', |
|  |  | 'coursierDependencyTree', |
|  |  | ]); |
| Expand All | | @@ -52,7 +52,7 @@ test('check build args with string for coursier', (t) => { |
|  |  | test('check build args with string for snykRenderTree', (t) => { |
|  |  | const result = plugin.buildArgs('-Paxis -Pjaxen', false, true); |
|  |  | t.deepEqual(result, [ |
|  |  | '"-Dsbt.log.noformat=true\"', |
|  |  | '-Dsbt.log.noformat=true', |
|  |  | '-Paxis -Pjaxen', |
|  |  | 'snykRenderTree', |
|  |  | ]); |
| Expand All | | @@ -62,7 +62,7 @@ test('check build args with string for snykRenderTree', (t) => { |
|  |  | test('check build args with string for coursier and not snykRenderTree', (t) => { |
|  |  | const result = plugin.buildArgs('-Paxis -Pjaxen', true, false); |
|  |  | t.deepEqual(result, [ |
|  |  | '"-Dsbt.log.noformat=true\"', |
|  |  | '-Dsbt.log.noformat=true', |
|  |  | '-Paxis -Pjaxen', |
|  |  | 'coursierDependencyTree', |
|  |  | ]); |
| Expand All | | @@ -72,7 +72,7 @@ test('check build args with string for coursier and not snykRenderTree', (t) => |
|  |  | test('check build args with string for not coursier and not snykRenderTree', (t) => { |
|  |  | const result = plugin.buildArgs('-Paxis -Pjaxen', false, false); |
|  |  | t.deepEqual(result, [ |
|  |  | '"-Dsbt.log.noformat=true\"', |
|  |  | '-Dsbt.log.noformat=true', |
|  |  | '-Paxis -Pjaxen', |
|  |  | 'dependencyTree', |
|  |  | ]); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `99c09eb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-sbt-plugin%2Fcommit%2F99c09eb12c9f8f2b237aea9627aab1ae3cab6437) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.imperva.com_93335c4e_20250108_125141.html ===


[![Imperva](https://www.imperva.com/blog/wp-content/uploads/2023/12/imperva-a-thales-company-light.svg)](https://www.imperva.com)

[Under DDoS Attack?](/under-ddos-attack/)

1-866-777-9980

Login

LoginCloud Security ConsoleRASP Console
English

EnglishENDeutschDEEspañolESFrançaisFRPortuguêsPT-BR日本語日本語한국어KR中文CNภาษาไทยTH

[Under DDoS Attack?](/under-ddos-attack/)

1-866-777-9980

[Start for Free](/free-trial/)[Contact Us](/contact-us/)[Start for Free](/free-trial/)[Contact Us](/contact-us/)

* [Why Imperva](/products/why-imperva/)
* Products
  Products
  + ![](https://www.imperva.com/blog/wp-content/uploads/2023/02/application-security.svg)
  + ![](https://www.imperva.com/blog/wp-content/uploads/2023/02/data-security.svg)Data Security
  + [Imperva Plans](/products/plans)Application Security[Application Security OverviewIndustry-leading application and API protection](/products/application-security/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/waf.svg)Web Application FirewallInstantly secure applications from the latest threats](/products/web-application-firewall-waf/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/advanced-bot-protection.svg)Advanced Bot ProtectionIdentify and mitigate the most sophisticated bad bot](/products/advanced-bot-protection-management/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/api-security.svg)API SecurityDiscover shadow APIs and the sensitive data they handle](/products/api-security/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2024/11/DDoS.svg)DDoS ProtectionSecure all assets at the edge with guaranteed uptime](/products/ddos-protection-services/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/client-side-protection.svg)Client-Side ProtectionVisibility and control over third-party JavaScript code](/products/client-side-protection-csp/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/runtime-protection.svg)Runtime ProtectionSecure workloads from unknown threats and vulnerabilities](/products/runtime-application-self-protection-rasp/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2024/11/ATO-icon.svg)Account Takeover ProtectionProtect login endpoints and prevent account-based fraud](/products/account-takeover-protection/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2024/11/CDN-icon.svg)Content Delivery NetworkBoost website performance with caching and compression](/products/content-delivery-network-cdn/)
  ##### Imperva named a security leader in the SecureIQlab CyberRisk Report

  [Get featured report](/resources/resource-library/reports/secureiqlab-2024-cloud-waap-cyberrisk-validation-report/)Data Security[Data Security OverviewProtect all data and ensure compliance at any scale](/products/data-security/)
  + [![](https://www.imperva.com/blog/wp-content/uploads/2023/02/data-security-fabric.svg)Data Security FabricMulticloud, hybrid security platform protecting all data types](/products/data-security-fabric/)
  + Business Capabilities
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_data_security.3b69d8d2-2-1.svg)Data security at scale](/products/data-security/data-security-at-scale/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_multicloud.5be4b003-1.svg)Data security for multicloud](/products/data-security/multicloud-expansion/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/Data-Risk-Analytics_black.svg)Risk analytics & insights](/products/data-security/risk-analytics-insights/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_brief.4af47836.svg)Data compliance at scale](/products/data-security/data-security-compliance-at-scale/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_discover_classify.ca96a429.svg)Data discovery & classification](/products/data-security/data-discovery-classification/)
  + The Imperva Advantage
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_coverage_black.845bc853-1.svg)Broadest coverage](/products/data-security/broadest-coverage/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_protect_data_black.c2346606.svg)Protect any data source](/products/data-security/protect-any-data-source/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_integrate_black.fbdab592-1.svg)Ecosystem integration](/products/data-security/expansive-fabric-ecosystem/)
  - [![](https://www.imperva.com/blog/wp-content/uploads/2023/12/icon_unify_black.fe30fb89.svg)Unified visibility](/products/data-security/unified-visibility/)
  ##### IDC Spotlight: Effective Multicloud Data Security

  [Get featured report](/resources/resource-library/reports/idc-spotlight-effective-multicloud-data-security-requires-a-unified-approach/)[Imperva Plans](/products/plans)
* Solutions
  Solutions
  + By Use Case
  + By Industry
  + [Imperva Plans](/products/plans)By Use Case
  + Application Security
  + [Secure applications and APIs](/solutions/secure-applications-apis/)
  + [Protect from DDoS attacks](/solutions/prevent-ddos-attacks/)
  + [Stop bad bots](/solutions/stop-bots/)
  + [Comply with PCI DSS 4.0](/solutions/pci-dss-4-0-compliance-services/)
  + [Accelerate application delivery](/solutions/application-delivery/)
  + Data Security
  + [Advance data governance](/solutions/advancing-data-governance/)
  + [Assure data compliance and privacy](/solutions/data-discovery-and-classification/)
  + [Data encryption and cryptographic solutions](https://cpl.thalesgroup.com/encryption/data-security-platform)
  + [Monitor user behavior analytics](/solutions/user-behavior-analytics/)
  + [Data risk visibility and scoring](/solutions/data-risk-visibility/)
  + [Safeguard sensitive data](/solutions/safeguard-sensitive-and-personal-data/)
  + [Securely move data to the cloud](/solutions/secure-cloud-data-migration/)
  ##### A Unifying Approach to Data Protection

  [Start guided tour](/data-security-demo-tours/a-unifying-approach-to-data-protection/)By IndustrySolutions by IndustryDefense-in-depth security for every industry
  + [Government](/solutions/government-cyber-protection/)
  + [Healthcare](/solutions/healthcare-protection/)
  + [Financial Services](/solutions/financial-services-protection/)
  + [Telecom & ISPs](/solutions/protection-for-telecoms-and-isps/)
  + [Retail](/solutions/retail-and-ecommerce-protection/)
  ##### The State of Security within eCommerce 2022

  [Get free report](/resources/resource-library/reports/the-state-of-security-for-ecommerce-2022/)[Imperva Plans](/products/plans)
* Support
  Support
  SupportSupportLooking for technical support or services, please review our various channels below
  + [Technical Support](/support/technical-support)
  + [Services](/support/services/)
  + [Imperva University](/support/imperva-university/)
  + [Community](https://community.imperva.com/home)
  + [Support Portal Login](https://support.imperva.com/)
  + [Documentation](//docs.imperva.com/)
  + [EOL Policy](/support/eol-policy/)
* Partners
  Partners
  + Channel Partners
  + Technology Alliance PartnersChannel PartnersChannel Partners ProgramLooking for an Imperva partner? Find an approved one with the expertise to help you
  + [Channel Partners](/partners/channel-partners/)
  + [Find a Partner](/partners/find-a-partner/)
  + [Partner Portal Login](https://partners.cpl.thalesgroup.com/)
  ##### Imperva reimagines partner program: Imperva Accelerate

  [Learn how](/company/press_releases/new-partner-program/)Technology Alliance PartnersTechnology Alliance PartnersImperva collaborates with the top technology companies
  + [Technology Alliance Partners (TAP)](/partners/technology-alliance-program-tap/)
  + [Become a TAP](/partners/technology-alliance-program-tap-application/)
  + [Find a TAP](/partners/technology-alliance-program-tap/#TAP-finder)
  ##### Protect your Cloudera data with Imperva

  [Learn more](/resources/resource-library/datasheets/protect-your-cloudera-data-with-imperva/)
* Customers
  Customers
  + Application Security Customer Stories
  + Data Security Customer Stories
  + [See all Customer Stories](/resources/customers/)Application Security Customer StoriesApplication Security Customer StoriesLearn how Imperva enables and protects industry leaders
  + [Tower ensures website visibility and uninterrupted business operations](/resources/customers/case-studies/tower/)
  + [Smallpdf protects its customers and ensures availability](/resources/customers/case-studies/smallpdf/)
  ##### Quálitas continues its quality services using Imperva Application Security

  [Learn how](/resources/customers/case-studies/qualitas/)Data Security Customer StoriesData Security Customer StoriesLearn how Imperva enables and protects industry leaders
  + [Banco Popular streamlines operations and lowers operational costs](/resources/customers/case-studies/banco-popular-dominicano/)
  + [Discovery Inc. tackles data compliance in public cloud with Imperva Data Security Fabric](/resources/customers/case-studies/discovery-inc/)
  ##### BSE bolsters data security and compliance

  [Learn more](/resources/customers/case-studies/bse/)[See all Customer Stories](/resources/customers/)
* Resources
  Resources
  + Resources
  + Threat Research
  + Learning AssetsResourcesResourcesGet all the information you need about Imperva products and solutions
  + [Resource Library](/resources/resource-library/)
  + [Blog](/blog/)
  + [Webinars](/resources/resource-library/?type=webinars)
  + [Case Studies](/resources/customers/)
  + [Data Security Demo Tours](/data-security-demo-tours/)
  + [Application Security Demo Tours](/demo-tours/)
  + [Privacy, Compliance & Trust Center](/trust-center/)
  + [Imperva Certifications](https://docs.imperva.com/bundle/articles/page/product-service-certifications.htm)
  ##### Imperva Protects Against Critical Apache OFBiz Vulnerability (CVE-2024-45195)

  [Read more](/blog/imperva-protects-against-critical-apache-ofbiz-vulnerability/)Threat Research[Threat ResearchStay informed on the latest threats and vulnerabilities](/cyber-threat-index/threat-research/)
  + [Threat Research Overview](/cyber-threat-index/threat-research/)
  + [Cyber Threat Index](/cyber-threat-index/)
  + [Cyber Attack Map](/cyber-threat-attack-map/)
  + [Free Tools](/resources/free-cyber-security-testing-tools/)
  + [Network Map](/products/global-network-map/)
  ##### Cyber Threat Index

  [Latest threat analysis](/cyber-threat-index/)Learning AssetsLearning AssetsExpand and share your knowledge
  + [Learning Center](/learn/)
  + [Application Security Guide](/learn/application-security/application-security/)
  + [Data Security Guide](/learn/data-security/data-security/)
  + [Imperva Community](https://community.imperva.com/home)
  + [Documentation Portal](https://docs.imperva.com/)
  ##### Browse the Imperva Learning Center for the latest cybersecurity topics

  [Explore now](/learn/)
* Company
  Company
  CompanyCompanyGet to know us, beyond our products and services
  + [About Us](/company/about/)
  + [Events](/company/events/)
  + [Careers](/company/careers/)
  + [Press & Awards](/company/news/)
  + [Contact Information](/company/locations/)
  ##### Imperva ESG Reports

  [Read more](/environmental-social-governance-esg-reports/)

[Home](/) > [Blog](/blog/) > How Scanning Your Projects for Security Issues Can Lead to Remote Code Execution

# How Scanning Your Projects for Security Issues Can Lead to Remote Code Execution

[Application Security](https://www.imperva.com/blog/?category=application-security)

![How Scanning Your Projects for Security Issues Can Lead to Remote Code Execution](https://www.imperva.com/blog/wp-content/uploads/sites/9/2022/09/Snyk-Command-Injection-Vulnerability-Cover-1-e1664469145118.jpg)

[![]()](https://www.imperva.com/blog/author/rmasas/ "Ron Masas")
[Ron Masas](https://www.imperva.com/blog/author/rmasas/)

Sep 29, 2022  4 min read

***UPDATE:** Snyk has recently addressed **2 additional vulnerabilities** we have reported to them, CVE-2022-24441 and CVE-2022-22984, affecting versions of Snyk CLI before XXX, which leads to arbitrary code execution when scanning untrusted Maven or Gradle projects. Similar to CVE-2022-40764 these vulnerabilities could have been exploited through the Snyk IDE extensions when viewing untrusted projects. Snyk has released new versions of its CLI and IDE extensions to address these vulnerabilities. We want to thank Snyk again for their responsible disclosure practices and for their collaboration in addressing the vulnerabilities we reported. Snyk has also released [a blog post about the vulnerabilities](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev).*

The Imperva Red Team recently discovered and disclosed CVE-2022-40764, a command injection vulnerability affecting Snyk CLI. Snyk is a security company best known for its dependency vulnerability management software.

The disclosed command injection vulnerability affects the Snyk command-line interface tool that helps developers find and fix vulnerabilities. Exploitation of CVE-2022-40764 allows attackers to execute arbitrary commands on the host system where the Snyk CLI is installed. This can be exploited to gain access to sensitive data, modify files, or install malicious software.

We’d like to note Snyk’s responsible response and cooperation on this matter. Snyk released a patch for the vulnerability and recommends that users update to the latest version of Snyk CLI.

In this post, we explain the method we used to discover the vulnerability and different exploit scenarios.

## Monkey Patching

Traditionally, monkey patching is used to alter the behavior of a program at runtime. This technique can be used to add or modify a program functionality without changing the program code.

We used monkey patching to log information about function calls, parameters, and return values in order to locate potential vulnerabilities.

You can view the monkey patching script we used in our Github repository: [monkeyp](https://github.com/imperva/monkeyp).

## Finding the Vulnerability

When using dynamic analysis techniques to hunt for vulnerabilities, supplying the right input is crucial. We started by broadly defining the input range of our target. In Snyk’s case, it was a variety of programming languages and package managers. These projects were easily gathered using the Github API.

We monkey patched the Snyk CLI so it logged sensitive NodeJS operations such as file system access and shell/program execution. We then wrote a script that used our patched Snyk CLI to scan each of the projects we collected.

After a few minutes, we had all the execution logs. We started looking into them when we noticed that the “child\_process.spawn” method was called with what seems to be a “user-supplied” input and the shell option set to true. The “shell” option is a boolean option that, when set to true, runs commands inside of a shell (i.e. uses ‘/bin/sh’ on Unix, and process.env.ComSpec on Windows). Thus, if we could control any part of the input, we would be able to execute arbitrary shell commands.

After further investigation, we landed on the “vendor.json” file, which is used to specify the packages used by go projects. The “ignore” property value seemed to be the one used in the spawn command.

We tried modifying it to write a file to the */tmp* directory like so:

![Snyk Command Injection Vulnerability Image 1]()

However, it did not work. The Snyk CLI output the following error:

![Snyk Command Injection Vulnerability Image 2]()

Judging by the first line, we saw that some of our input was interpreted as a shell command. Looking at monkeyp logs, we could clearly see the issue.

![Snyk Command Injection Vulnerability Image 3]()

The Snyk CLI modifies our “ignore” value. Below, you can see the relevant code from the “snyk-go-parser” package which is responsible for these modifications.

![Snyk Command Injection Vulnerability Image 4]()

The “ignore” value is divided into chunks based on the space character. Then, for each chunk the following logic is performed:

1. If the chunk contains a forward slash, ignore it

2. Replace the last forward slash with an empty string

3. Push the chunk as is to the “ignorePkgs” array

4. Push the chunk again to the “ignorePkgs” array with the “/\*” string appended to it

The “ignorePkgs” array is later converted to a string in the “snyk-go-plugin” package by calling the join method with the separator argument set to a comma, which is later passed to the “child\_process.spawn” method as one of the arguments.

![Snyk Command Injection Vulnerability Image 6]()

Putting this all together, it means we either execute a file or we need to find a way to execute shell commands without using spaces.

When our command was interpreted by bash or zsh, we could use [IFS](https://bash.cyberciti.biz/guide/%24IFS) (Input Field Separator), which is a common WAF bypass technique. IFS is a special shell variable, where each character is treated like a delimiter. If IFS is unset, the default value will be , which was ideal for our objective.

Finally, we had to include at least one forward slash to ensure our input was added to the “ignorePkgs” array.

You can see the final payload below; it simply opens the calculator app on macOS.

![Snyk Command Injection Vulnerability Image 7]()

×
![2024 trends replay]()

Jan 22 Upcoming Webinar
### Unveiling the Cybersecurity Trends for 2025

Register Now

×

## Exploitation

To successfully exploit this vulnerability, a target would have to execute the “snyk test” command on untrusted files. While this is bad, practical exploitation is hard. We decided to go back and look for libraries that use Snyk CLI as a dependency to see if there would be a way to make exploitation more practical.

After going over a few libraries, we found that Snyk built a [VSCode extension](https://marketplace.visualstudio.com/items?itemName=snyk-security.snyk-vulnerability-scanner) that uses the CLI to automatically scan every project opened with VSCode. This is already an improvement as the user would only need to view untrusted files in the VSCode editor to trigger our exploit, which is more likely in our view.

![ezgif 4 e85eae3e81]()

## Closing Thoughts

The Imperva Red Team mission is to make attackers’ jobs harder by finding and responsibly disclosing vulnerabilities in popular services. It was a privilege to contribute to protecting the privacy of Snyk’s user community, as we continuously do for our own Imperva customers.

We hope you found this post informative and we look forward to sharing more technical walkthroughs in the future.

### Try Imperva for Free

Protect your business for 30 days on Imperva.

[Start Now](https://www.imperva.com/free-trial/)

### Try Imperva for Free

Protect your business for 30 days on Imperva.

[Start Now](https://www.imperva.com/free-trial/)
### Suggested Report

[The State of API Security in 2024](https://www.imperva.com/resources/resource-library/reports/the-state-of-api-security-in-2024/) [Read more](https://www.imperva.com/resources/resource-library/reports/the-state-of-api-security-in-2024/)

## Trending

[![holiday shopping 2](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/10/holiday-shopping-2.jpeg)](https://www.imperva.com/blog/seven-tips-to-protect-retail-businesses-this-holiday-season/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
[Seven Cybersecurity Tips to Protect Your Retail Business This Holiday Season](https://www.imperva.com/blog/seven-tips-to-protect-retail-businesses-this-holiday-season/)
[![]()](https://www.imperva.com/blog/author/erez-hassonimperva-com/ "Erez Hasson")
[Erez Hasson](https://www.imperva.com/blog/author/erez-hassonimperva-com/)

Oct 21, 2024  13 min read

[![Screenshot 2024 09 17 at 09.37.34](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/09/Screenshot-2024-09-17-at-09.37.34.png)](https://www.imperva.com/blog/rising-cost-of-vulnerable-apis-and-bot-attacks-a-186b-wake-up-call/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
[The Rising Cost of Vulnerable APIs and Bot Attacks – A $186 Billion Wake-Up Call for Businesses](https://www.imperva.com/blog/rising-cost-of-vulnerable-apis-and-bot-attacks-a-186b-wake-up-call/)
[![]()](https://www.imperva.com/blog/author/erez-hassonimperva-com/ "Erez Hasson")
[Erez Hasson](https://www.imperva.com/blog/author/erez-hassonimperva-com/)

Sep 18, 2024  2 min read

[![shutterstock 1071270287 23](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/09/shutterstock_1071270287-23.jpg.webp)](https://www.imperva.com/blog/imperva-protects-against-critical-apache-ofbiz-vulnerability/)
[Imperva Threat Research](https://www.imperva.com/blog/?category=labs)
...

* [Application Security](https://www.imperva.com/blog/?category=application-security)

[Imperva Protects Against Critical Apache OFBiz Vulnerability (CVE-2024-45195)](https://www.imperva.com/blog/imperva-protects-against-critical-apache-ofbiz-vulnerability/)
[![]()](https://www.imperva.com/blog/author/gabriellastapel/ "Gabi Sharadin")[![]()](https://www.imperva.com/blog/author/mulylevy/ "Muly Levy")
[Gabi Sharadin](https://www.imperva.com/blog/author/gabriellastapel/)[, Muly Levy](https://www.imperva.com/blog/author/mulylevy/)

Sep 11, 2024  1 min read

[![skyscraper in the clouds](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/08/skyscraper-in-the-clouds.jpg.webp)](https://www.imperva.com/blog/imperva-leads-industry-in-secureiqlabs-cloud-waap-comparative/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
[Imperva Security Efficacy and Operational Efficiency Leads the Industry in SecureIQLab's Cloud WAAP Comparative Report](https://www.imperva.com/blog/imperva-leads-industry-in-secureiqlabs-cloud-waap-comparative/)
[![]()](https://www.imperva.com/blog/author/lukerichardson/ "Luke Richardson")[![user copy 6@3x]()](https://www.imperva.com/blog/author/ericguillotin/ "Eric Guillotin")
[Luke Richardson](https://www.imperva.com/blog/author/lukerichardson/)[, Eric Guillotin](https://www.imperva.com/blog/author/ericguillotin/)

Aug 12, 2024  3 min read

[![mobile scans](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/07/shutterstock_1071270287-19.jpg.webp)](https://www.imperva.com/blog/imperva-customers-protected-against-critical-servicenow-vulnerability/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
...

* [Imperva Threat Research](https://www.imperva.com/blog/?category=labs)

[Imperva Customers Protected Against Critical ServiceNow Vulnerability](https://www.imperva.com/blog/imperva-customers-protected-against-critical-servicenow-vulnerability/)
[![]()](https://www.imperva.com/blog/author/gabriellastapel/ "Gabi Sharadin")[![]()](https://www.imperva.com/blog/author/mulylevy/ "Muly Levy")
[Gabi Sharadin](https://www.imperva.com/blog/author/gabriellastapel/)[, Muly Levy](https://www.imperva.com/blog/author/mulylevy/)

Jul 23, 2024  2 min read

[![Imperva DDos Report 2024](https://www.imperva.com/blog/wp-content/uploads/sites/9/2024/07/shutterstock_1071270287-16.jpg.webp)](https://www.imperva.com/blog/unveiling-the-2024-imperva-ddos-threat-landscape-report/)
[Application Security](https://www.imperva.com/blog/?category=application-security)
[Unveiling the 2024 Imperva DDoS Threat Landscape Report](https://www.imperva.com/blog/unveiling-the-2024-imperva-ddos-threat-landscape-report/)
[![]()](https://www.imperva.com/blog/author/grainnemckeevera/ "Grainne McKeever")
[Grainne McKeever](https://www.imperva.com/blog/author/grainnemckeevera/)

Jul 16, 2024  2 min read

[![Imperva](https://www.imperva.com/blog/wp-content/themes/impv/img/logo-imperva-a-thales-company.svg)](https://www.imperva.com)

+1 866 926 4678

Partners

* [Imperva Partner Ecosystem](/partners/)
* [Channel Partners](/partners/channel-partners/)
* [Technology Alliances](/partners/technology-alliance-program-tap/)
* [Find a Partner](/partners/find-a-partner/)
* [Partner Portal Login](https://partners.cpl.thalesgroup.com/)

Resources

* [Imperva Blog](/blog/)
* [Resource Library](/resources/resource-library/)
* [Case Studies](/resources/customers/)
* [Learning Center](/learn/)

About Us

* [Why Imperva](/products/why-imperva/)
* [Who We Are](/company/about/)
* [Events](/company/events/)
* [Careers](/company/careers/)
* [Press & Awards](/company/news/)
* [Contact Information](/company/locations/)

Network

* [Network Map](/products/global-network-map/)
* [System Status](https://status.imperva.com/)

Support

* [Emergency DDoS Protection](/under-ddos-attack/)
* [Support Portal](https://support.imperva.com/)
* [Imperva Community](https://community.imperva.com/home)
* [Documentation Portal](https://docs.imperva.com/)
* [API Integration](https://docs.imperva.com/bundle/cloud-application-security/page/api/api.htm)
* [Trust Center](/trust-center/)

Cookie Preferences [Trust Center](/trust-center/) [Modern Slavery Statement](/legal/modern-slavery-statement/) [Privacy](/trust-center/privacy-statement/) [Legal](/legal/website-terms-of-use/)

English

EnglishDeutschEspañolFrançaisPortuguês日本語中文ภาษาไทย

+1 866 926 4678

English

EnglishDeutschEspañolFrançaisPortuguês日本語中文ภาษาไทย

Cookie Preferences [Trust Center](/trust-center/) [Modern Slavery Statement](/legal/modern-slavery-statement/) [Privacy](/trust-center/privacy-statement/) [Legal](/legal/website-terms-of-use/)

Copyright © 2024 Imperva. All rights reserved

×

### KuppingerCole Leadership Compass 2024 for Web Application Firewalls

Learn how Imperva is leading by delivering “comprehensive WAF capabilities”

[Download Now](/resources/resource-library/reports/kuppingercole-leadership-compass-2024-for-web-application-firewalls/)

×

### The Economic Impact of API and Bot Attacks

What is the true cost of API and bot-related attacks to your organization?

[Download Now](/resources/resource-library/reports/the-economic-impact-of-api-and-bot-attacks/)

×

### Future-proofing Data Security

Integrating DSPM, AI, and encryption for comprehensive protection

Download Now

×

### The State of API Security in 2024

Learn about the current API threat landscape and the key security insights for 2024

[Download Now](/resources/resource-library/reports/the-state-of-api-security-in-2024/)

×

### Protect Against Business Logic Abuse

Identify key capabilities to prevent attacks targeting your business logic

[Download Now](/resources/resource-library/white-papers/buyers-guide-essential-capabilities-for-business-logic-protection/)

×

### The State of Security Within eCommerce in 2022

Learn how automated threats and API attacks on retailers are increasing

[Free Report](/resources/resource-library/reports/the-state-of-security-for-ecommerce-2022/)

×
### Prevoty is now part of the Imperva Runtime Protection

* Protection against zero-day attacks
* No tuning, highly-accurate out-of-the-box
* Effective against OWASP top 10 vulnerabilities

[Learn more here](https://www.imperva.com/blog/5-things-to-know-about-imperva-rasp/)

×

Want to see Imperva in action?
Fill out the form and our experts will be in touch shortly to book your personal demo.

## Thank you!

![envelope](/wp-content/uploads/2020/12/shape.svg)

An Imperva security specialist will contact you shortly.

×

![](/wp-content/uploads/2021/03/Group-2554.svg)



=== Content from security.snyk.io_8eff953e_20250108_125139.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. snyk-sbt-plugin
# Command Injection Affecting [snyk-sbt-plugin](/package/npm/snyk-sbt-plugin) package, versions **<2.16.2**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-SNYKSBTPLUGIN-3038626#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.52% (77th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Command Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**SNYK-JS-SNYKSBTPLUGIN-3038626**
* published**30 Nov 2022**
* disclosed**29 Sept 2022**
* credit**Ron Masas - Imperva**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 29 Sep 2022

[CVE-2022-22984  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-22984) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-77  (opens in a new tab)](https://cwe.mitre.org/data/definitions/77.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `snyk-sbt-plugin` to version 2.16.2 or higher.

## Overview

Affected versions of this package are vulnerable to Command Injection due to an incomplete fix for [CVE-2022-40764](https://security.snyk.io/vuln/SNYK-JS-SNYK-3037342).

A successful exploit allows attackers to run arbitrary commands on the host system where the Snyk CLI is installed by passing in crafted command line flags.

In order to exploit this vulnerability, a user would have to execute the `snyk test` command on untrusted files. In most cases, an attacker positioned to control the command line arguments to the Snyk CLI would already be positioned to execute arbitrary commands. However, this could be abused in specific scenarios, such as continuous integration pipelines, where developers can control the arguments passed to the Snyk CLI to leverage this component as part of a wider attack against an integration/build pipeline.

This issue has been addressed in the latest Snyk Docker images available at <https://hub.docker.com/r/snyk/snyk> as of 2022-11-29. Images downloaded and built prior to that date should be updated.

The issue has also been addressed in the Snyk TeamCity CI/CD plugin as of version v20221130.093605.

## References

* [GitHub Commit (CLI)](https://github.com/snyk/cli/commit/80d97a93326406e09776156daf72e3caa03ae25a)
* [GitHub Commit (snyk-cocoapods-plugin)](https://github.com/snyk/snyk-cocoapods-plugin/commit/c73e049c5200772babde61c40aab57296bf91381)
* [GitHub Commit (snyk-docker-plugin)](https://github.com/snyk/snyk-docker-plugin/commit/d730d7630691a61587b120bb11daaaf4b58a8357)
* [GitHub Commit (snyk-gradle-plugin)](https://github.com/snyk/snyk-gradle-plugin/commit/bb1c1c72a75e97723a76b14d2d73f70744ed5009)
* [GitHub Commit (snyk-hex-plugin)](https://github.com/snyk/snyk-hex-plugin/commit/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)
* [GitHub Commit (snyk-mvn-plugin)](https://github.com/snyk/snyk-mvn-plugin/commit/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)
* [GitHub Commit (snyk-python-plugin)](https://github.com/snyk/snyk-python-plugin/commit/8591abdd9236108ac3e30c70c09238d6bb6aabf4)
* [GitHub Commit (snyk-sbt-plugin)](https://github.com/snyk/snyk-sbt-plugin/commit/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)
* [Imperva Blog Post](https://www.imperva.com/blog/how-scanning-your-projects-for-security-issues-can-lead-to-remote-code-execution/)
* [Snyk Blog Post](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev/)
### CVSS Scores

version 3.1
### Snyk

5 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker requires privileges that provide basic user capabilities that could normally affect only settings and files owned by a user. Alternatively, an attacker with Low privileges has the ability to access only non-sensitive resources.

  **Low**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

6.3 medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_66426f99_20250108_125135.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-mvn-plugin%2Fcommit%2F02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-mvn-plugin%2Fcommit%2F02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-mvn-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-mvn-plugin](/snyk/snyk-mvn-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-mvn-plugin) You must be signed in to change notification settings
* [Fork
  11](/login?return_to=%2Fsnyk%2Fsnyk-mvn-plugin)
* [Star
   10](/login?return_to=%2Fsnyk%2Fsnyk-mvn-plugin)

* [Code](/snyk/snyk-mvn-plugin)
* [Issues
  1](/snyk/snyk-mvn-plugin/issues)
* [Pull requests
  6](/snyk/snyk-mvn-plugin/pulls)
* [Actions](/snyk/snyk-mvn-plugin/actions)
* [Projects
  0](/snyk/snyk-mvn-plugin/projects)
* [Security](/snyk/snyk-mvn-plugin/security)
* [Insights](/snyk/snyk-mvn-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-mvn-plugin)
* [Issues](/snyk/snyk-mvn-plugin/issues)
* [Pull requests](/snyk/snyk-mvn-plugin/pulls)
* [Actions](/snyk/snyk-mvn-plugin/actions)
* [Projects](/snyk/snyk-mvn-plugin/projects)
* [Security](/snyk/snyk-mvn-plugin/security)
* [Insights](/snyk/snyk-mvn-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-mvn-plugin/commit/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: escape child process arguments

[Browse files](/snyk/snyk-mvn-plugin/tree/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)
Browse the repository at this point in the history

* Loading branch information

[![@gitphill](https://avatars.githubusercontent.com/u/6598617?s=40&v=4)](/gitphill)

[gitphill](/snyk/snyk-mvn-plugin/commits?author=gitphill "View all commits by gitphill")
committed
Nov 29, 2022

1 parent
[13c6f33](/snyk/snyk-mvn-plugin/commit/13c6f33a60653ec7f27534b30985bd9940a1be3d)

commit 02cda9b

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**15 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .snyk
  [.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f)
* lib

  + lib/sub-process.ts
    [sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)

## There are no files selected for viewing

10 changes: 10 additions & 0 deletions

10
[.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f ".snyk")

Show comments

[View file](/snyk/snyk-mvn-plugin/blob/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50/.snyk)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,10 @@ |
|  |  | # Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities. |
|  |  | version: v1.25.0 |
|  |  | # ignores vulnerabilities until expiry date; change duration by modifying expiry date |
|  |  | ignore: |
|  |  | 'snyk:lic:npm:shescape:MPL-2.0': |
|  |  | - '\*': |
|  |  | reason: None Given |
|  |  | expires: 2122-12-29T08:08:41.608Z |
|  |  | created: 2022-11-29T08:08:41.611Z |
|  |  | patch: {} |

4 changes: 4 additions & 0 deletions

4
[lib/sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d "lib/sub-process.ts")

Show comments

[View file](/snyk/snyk-mvn-plugin/blob/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50/lib/sub-process.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,6 @@ |
|  |  | import \* as childProcess from 'child\_process'; |
|  |  | import { debug } from './index'; |
|  |  | import { quoteAll } from 'shescape'; |
|  |  |  |
|  |  | export function execute(command, args, options): Promise<string> { |
|  |  | const spawnOptions: { |
| Expand All | | @@ -9,6 +10,9 @@ export function execute(command, args, options): Promise<string> { |
|  |  | if (options && options.cwd) { |
|  |  | spawnOptions.cwd = options.cwd; |
|  |  | } |
|  |  | if (args) { |
|  |  | args = quoteAll(args, spawnOptions); |
|  |  | } |
|  |  |  |
|  |  | return new Promise((resolve, reject) => { |
|  |  | let stdout = ''; |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/snyk/snyk-mvn-plugin/blob/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,6 +48,7 @@ |
|  |  | "debug": "^4.1.1", |
|  |  | "glob": "^7.1.6", |
|  |  | "needle": "^2.5.0", |
|  |  | "shescape": "1.6.1", |
|  |  | "tslib": "^2.4.0" |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `02cda9b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-mvn-plugin%2Fcommit%2F02cda9ba1ea36b00ead3f6ec2de0f97397ebec50) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5331c237_20250108_125134.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-hex-plugin%2Fcommit%2Fe8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-hex-plugin%2Fcommit%2Fe8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-hex-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-hex-plugin](/snyk/snyk-hex-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-hex-plugin) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fsnyk%2Fsnyk-hex-plugin)
* [Star
   7](/login?return_to=%2Fsnyk%2Fsnyk-hex-plugin)

* [Code](/snyk/snyk-hex-plugin)
* [Issues
  1](/snyk/snyk-hex-plugin/issues)
* [Pull requests
  5](/snyk/snyk-hex-plugin/pulls)
* [Actions](/snyk/snyk-hex-plugin/actions)
* [Security](/snyk/snyk-hex-plugin/security)
* [Insights](/snyk/snyk-hex-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-hex-plugin)
* [Issues](/snyk/snyk-hex-plugin/issues)
* [Pull requests](/snyk/snyk-hex-plugin/pulls)
* [Actions](/snyk/snyk-hex-plugin/actions)
* [Security](/snyk/snyk-hex-plugin/security)
* [Insights](/snyk/snyk-hex-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-hex-plugin/commit/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: quote spawn args

[Browse files](/snyk/snyk-hex-plugin/tree/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)
Browse the repository at this point in the history

* Loading branch information

[![@xzhou-snyk](https://avatars.githubusercontent.com/u/102186579?s=40&v=4)](/xzhou-snyk)

[xzhou-snyk](/snyk/snyk-hex-plugin/commits?author=xzhou-snyk "View all commits by xzhou-snyk")
committed
Nov 29, 2022

1 parent
[86090ee](/snyk/snyk-hex-plugin/commit/86090ee55478807bc099a662832539a169ca56c1)

commit e8dd2a3

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**11 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .snyk
  [.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f)
* lib

  + lib/sub-process.ts
    [sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)

## There are no files selected for viewing

11 changes: 8 additions & 3 deletions

11
[.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f ".snyk")

Show comments

[View file](/snyk/snyk-hex-plugin/blob/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3/.snyk)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,10 @@ |
|  |  | # Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities. |
|  |  | version: v1.13.5 |
|  |  | ignore: {} |
|  |  | # patches apply the minimum changes required to fix a vulnerability |
|  |  | version: v1.25.0 |
|  |  | # ignores vulnerabilities until expiry date; change duration by modifying expiry date |
|  |  | ignore: |
|  |  | 'snyk:lic:npm:shescape:MPL-2.0': |
|  |  | - '\*': |
|  |  | reason: None Given |
|  |  | expires: 2122-12-29T08:08:41.608Z |
|  |  | created: 2022-11-29T08:08:41.611Z |
|  |  | patch: {} |

2 changes: 2 additions & 0 deletions

2
[lib/sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d "lib/sub-process.ts")

Show comments

[View file](/snyk/snyk-hex-plugin/blob/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3/lib/sub-process.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,6 @@ |
|  |  | import \* as childProcess from 'child\_process'; |
|  |  | import { debug } from './debug'; |
|  |  | import { quoteAll } from 'shescape'; |
|  |  |  |
|  |  | export function execute( |
|  |  | command: string, |
| Expand All | | @@ -12,6 +13,7 @@ export function execute( |
|  |  | if (options && options.cwd) { |
|  |  | spawnOptions.cwd = options.cwd; |
|  |  | } |
|  |  | args = quoteAll(args, spawnOptions); |
|  |  |  |
|  |  | return new Promise((resolve, reject) => { |
|  |  | let stdout = ''; |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/snyk/snyk-hex-plugin/blob/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,6 +33,7 @@ |
|  |  | "@snyk/dep-graph": "^1.28.0", |
|  |  | "@snyk/mix-parser": "^1.1.1", |
|  |  | "debug": "^4.3.1", |
|  |  | "shescape": "1.6.1", |
|  |  | "tmp": "^0.0.33", |
|  |  | "tslib": "^2.0.0", |
|  |  | "upath": "2.0.1" |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e8dd2a3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-hex-plugin%2Fcommit%2Fe8dd2a330b40d7fc0ab47e34413e80a0146d7ac3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.snyk.io_5702c6b3_20250108_125139.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. snyk-python-plugin
# Command Injection Affecting [snyk-python-plugin](/package/npm/snyk-python-plugin) package, versions **<1.24.2**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-SNYKPYTHONPLUGIN-3039677#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.52% (77th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Command Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**SNYK-JS-SNYKPYTHONPLUGIN-3039677**
* published**30 Nov 2022**
* disclosed**29 Sept 2022**
* credit**Ron Masas - Imperva**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 29 Sep 2022

[CVE-2022-22984  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-22984) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-77  (opens in a new tab)](https://cwe.mitre.org/data/definitions/77.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `snyk-python-plugin` to version 1.24.2 or higher.

## Overview

Affected versions of this package are vulnerable to Command Injection due to an incomplete fix for [CVE-2022-40764](https://security.snyk.io/vuln/SNYK-JS-SNYK-3037342).

A successful exploit allows attackers to run arbitrary commands on the host system where the Snyk CLI is installed by passing in crafted command line flags.

In order to exploit this vulnerability, a user would have to execute the `snyk test` command on untrusted files. In most cases, an attacker positioned to control the command line arguments to the Snyk CLI would already be positioned to execute arbitrary commands. However, this could be abused in specific scenarios, such as continuous integration pipelines, where developers can control the arguments passed to the Snyk CLI to leverage this component as part of a wider attack against an integration/build pipeline.

This issue has been addressed in the latest Snyk Docker images available at <https://hub.docker.com/r/snyk/snyk> as of 2022-11-29. Images downloaded and built prior to that date should be updated.

The issue has also been addressed in the Snyk TeamCity CI/CD plugin as of version v20221130.093605.

## References

* [GitHub Commit (CLI)](https://github.com/snyk/cli/commit/80d97a93326406e09776156daf72e3caa03ae25a)
* [GitHub Commit (snyk-cocoapods-plugin)](https://github.com/snyk/snyk-cocoapods-plugin/commit/c73e049c5200772babde61c40aab57296bf91381)
* [GitHub Commit (snyk-docker-plugin)](https://github.com/snyk/snyk-docker-plugin/commit/d730d7630691a61587b120bb11daaaf4b58a8357)
* [GitHub Commit (snyk-gradle-plugin)](https://github.com/snyk/snyk-gradle-plugin/commit/bb1c1c72a75e97723a76b14d2d73f70744ed5009)
* [GitHub Commit (snyk-hex-plugin)](https://github.com/snyk/snyk-hex-plugin/commit/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)
* [GitHub Commit (snyk-mvn-plugin)](https://github.com/snyk/snyk-mvn-plugin/commit/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)
* [GitHub Commit (snyk-python-plugin)](https://github.com/snyk/snyk-python-plugin/commit/8591abdd9236108ac3e30c70c09238d6bb6aabf4)
* [GitHub Commit (snyk-sbt-plugin)](https://github.com/snyk/snyk-sbt-plugin/commit/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)
* [Imperva Blog Post](https://www.imperva.com/blog/how-scanning-your-projects-for-security-issues-can-lead-to-remote-code-execution/)
* [Snyk Blog Post](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev/)
### CVSS Scores

version 3.1
### Snyk

5 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker requires privileges that provide basic user capabilities that could normally affect only settings and files owned by a user. Alternatively, an attacker with Low privileges has the ability to access only non-sensitive resources.

  **Low**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

6.3 medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from security.snyk.io_8449316a_20250108_125138.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. snyk-gradle-plugin
# Command Injection Affecting [snyk-gradle-plugin](/package/npm/snyk-gradle-plugin) package, versions **<3.24.5**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-SNYKGRADLEPLUGIN-3038624#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.52% (77th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Command Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**SNYK-JS-SNYKGRADLEPLUGIN-3038624**
* published**30 Nov 2022**
* disclosed**29 Sept 2022**
* credit**Ron Masas - Imperva**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 29 Sep 2022

[CVE-2022-22984  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-22984) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-77  (opens in a new tab)](https://cwe.mitre.org/data/definitions/77.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `snyk-gradle-plugin` to version 3.24.5 or higher.

## Overview

[snyk-gradle-plugin](https://www.npmjs.com/package/snyk-gradle-plugin) is a plugin for the Snyk CLI tool, providing dependency metadata for Gradle projects.

Affected versions of this package are vulnerable to Command Injection due to an incomplete fix for [CVE-2022-40764](https://security.snyk.io/vuln/SNYK-JS-SNYK-3037342).

A successful exploit allows attackers to run arbitrary commands on the host system where the Snyk CLI is installed by passing in crafted command line flags.

In order to exploit this vulnerability, a user would have to execute the `snyk test` command on untrusted files. In most cases, an attacker positioned to control the command line arguments to the Snyk CLI would already be positioned to execute arbitrary commands. However, this could be abused in specific scenarios, such as continuous integration pipelines, where developers can control the arguments passed to the Snyk CLI to leverage this component as part of a wider attack against an integration/build pipeline.

This issue has been addressed in the latest Snyk Docker images available at <https://hub.docker.com/r/snyk/snyk> as of 2022-11-29. Images downloaded and built prior to that date should be updated.

The issue has also been addressed in the Snyk TeamCity CI/CD plugin as of version v20221130.093605.

## References

* [GitHub Commit (CLI)](https://github.com/snyk/cli/commit/80d97a93326406e09776156daf72e3caa03ae25a)
* [GitHub Commit (snyk-cocoapods-plugin)](https://github.com/snyk/snyk-cocoapods-plugin/commit/c73e049c5200772babde61c40aab57296bf91381)
* [GitHub Commit (snyk-docker-plugin)](https://github.com/snyk/snyk-docker-plugin/commit/d730d7630691a61587b120bb11daaaf4b58a8357)
* [GitHub Commit (snyk-gradle-plugin)](https://github.com/snyk/snyk-gradle-plugin/commit/bb1c1c72a75e97723a76b14d2d73f70744ed5009)
* [GitHub Commit (snyk-hex-plugin)](https://github.com/snyk/snyk-hex-plugin/commit/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)
* [GitHub Commit (snyk-mvn-plugin)](https://github.com/snyk/snyk-mvn-plugin/commit/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)
* [GitHub Commit (snyk-python-plugin)](https://github.com/snyk/snyk-python-plugin/commit/8591abdd9236108ac3e30c70c09238d6bb6aabf4)
* [GitHub Commit (snyk-sbt-plugin)](https://github.com/snyk/snyk-sbt-plugin/commit/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)
* [Imperva Blog Post](https://www.imperva.com/blog/how-scanning-your-projects-for-security-issues-can-lead-to-remote-code-execution/)
* [Snyk Blog Post](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev/)
### CVSS Scores

version 3.1
### Snyk

5 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker requires privileges that provide basic user capabilities that could normally affect only settings and files owned by a user. Alternatively, an attacker with Low privileges has the ability to access only non-sensitive resources.

  **Low**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

6.3 medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_690582a2_20250108_125133.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-gradle-plugin%2Fcommit%2Fbb1c1c72a75e97723a76b14d2d73f70744ed5009)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-gradle-plugin%2Fcommit%2Fbb1c1c72a75e97723a76b14d2d73f70744ed5009)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-gradle-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-gradle-plugin](/snyk/snyk-gradle-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-gradle-plugin) You must be signed in to change notification settings
* [Fork
  21](/login?return_to=%2Fsnyk%2Fsnyk-gradle-plugin)
* [Star
   25](/login?return_to=%2Fsnyk%2Fsnyk-gradle-plugin)

* [Code](/snyk/snyk-gradle-plugin)
* [Issues
  0](/snyk/snyk-gradle-plugin/issues)
* [Pull requests
  0](/snyk/snyk-gradle-plugin/pulls)
* [Actions](/snyk/snyk-gradle-plugin/actions)
* [Security](/snyk/snyk-gradle-plugin/security)
* [Insights](/snyk/snyk-gradle-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-gradle-plugin)
* [Issues](/snyk/snyk-gradle-plugin/issues)
* [Pull requests](/snyk/snyk-gradle-plugin/pulls)
* [Actions](/snyk/snyk-gradle-plugin/actions)
* [Security](/snyk/snyk-gradle-plugin/security)
* [Insights](/snyk/snyk-gradle-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-gradle-plugin/commit/bb1c1c72a75e97723a76b14d2d73f70744ed5009)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: escape child process arguments

[Browse files](/snyk/snyk-gradle-plugin/tree/bb1c1c72a75e97723a76b14d2d73f70744ed5009)
Browse the repository at this point in the history

* Loading branch information

Jas Kuner
committed
Nov 14, 2022

1 parent
[f115e10](/snyk/snyk-gradle-plugin/commit/f115e10c069f3bf404f164e9f88ba20a2a09a185)

commit bb1c1c7

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**39 additions**
and
**41 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .snyk
  [.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f)
* lib

  + lib/index.ts
    [index.ts](#diff-d5a4b3a0309f2337144861084c1014523cced561eb722cb9684c63f5e41e0567)
  + lib/sub-process.ts
    [sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* test/functional

  + test/functional/gradle-plugin.spec.ts
    [gradle-plugin.spec.ts](#diff-537f27092dc961b1c00cd16e2ac964554b03b7fe140904be4fb7fa0bcf5c6bc6)

## There are no files selected for viewing

10 changes: 10 additions & 0 deletions

10
[.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f ".snyk")

Show comments

[View file](/snyk/snyk-gradle-plugin/blob/bb1c1c72a75e97723a76b14d2d73f70744ed5009/.snyk)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,10 @@ |
|  |  | # Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities. |
|  |  | version: v1.25.0 |
|  |  | # ignores vulnerabilities until expiry date; change duration by modifying expiry date |
|  |  | ignore: |
|  |  | 'snyk:lic:npm:shescape:MPL-2.0': |
|  |  | - '\*': |
|  |  | reason: Snyk CLI handles MPL-2.0 by appending dependency to snyk --about |
|  |  | expires: 2122-12-14T13:33:15.042Z |
|  |  | created: 2022-11-14T13:33:15.045Z |
|  |  | patch: {} |

39 changes: 12 additions & 27 deletions

39
[lib/index.ts](#diff-d5a4b3a0309f2337144861084c1014523cced561eb722cb9684c63f5e41e0567 "lib/index.ts")

Show comments

[View file](/snyk/snyk-gradle-plugin/blob/bb1c1c72a75e97723a76b14d2d73f70744ed5009/lib/index.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -37,9 +37,6 @@ export function debugLog(s: string) { |
|  |  | logger(s); |
|  |  | } |
|  |  |  |
|  |  | const isWin = /^win/.test(os.platform()); |
|  |  | const quot = isWin ? '"' : "'"; |
|  |  |  |
|  |  | const cannotResolveVariantMarkers = [ |
|  |  | 'Cannot choose between the following', |
|  |  | 'Could not select value from candidates', |
| Expand Down  Expand Up | | @@ -115,6 +112,7 @@ export async function inspect( |
|  |  | let subProject = (options as api.SingleSubprojectInspectOptions).subProject; |
|  |  | if (subProject) { |
|  |  | subProject = subProject.trim(); |
|  |  | (options as api.SingleSubprojectInspectOptions).subProject = subProject; |
|  |  | } |
|  |  | const plugin: api.PluginMetadata = { |
|  |  | name: 'bundled:gradle', |
| Expand Down  Expand Up | | @@ -671,13 +669,6 @@ function getCommand(root: string, targetFile: string) { |
|  |  | return 'gradle'; |
|  |  | } |
|  |  |  |
|  |  | export function formatArgWithWhiteSpace(arg: string): string { |
|  |  | if (/\s/.test(arg)) { |
|  |  | return quot + arg + quot; |
|  |  | } |
|  |  | return arg; |
|  |  | } |
|  |  |  |
|  |  | function buildArgs( |
|  |  | root: string, |
|  |  | targetFile: string | null, |
| Expand All | | @@ -692,31 +683,25 @@ function buildArgs( |
|  |  | args.push(taskName, '-q'); |
|  |  |  |
|  |  | if (targetFile) { |
|  |  | if (!fs.existsSync(path.resolve(root, targetFile))) { |
|  |  | throw new Error('File not found: "' + targetFile + '"'); |
|  |  | const resolvedTargetFilePath = path.resolve(root, targetFile); |
|  |  | if (!fs.existsSync(resolvedTargetFilePath)) { |
|  |  | throw new Error('File not found: "' + resolvedTargetFilePath + '"'); |
|  |  | } |
|  |  | args.push('--build-file'); |
|  |  |  |
|  |  | const formattedTargetFile = formatArgWithWhiteSpace(targetFile); |
|  |  | args.push(formattedTargetFile); |
|  |  | args.push(resolvedTargetFilePath); |
|  |  | } |
|  |  |  |
|  |  | // Arguments to init script are supplied as properties: https://stackoverflow.com/a/48370451 |
|  |  | if (options['configuration-matching']) { |
|  |  | args.push( |
|  |  | `-Pconfiguration=${quot}${options['configuration-matching']}${quot}`, |
|  |  | ); |
|  |  | args.push(`-Pconfiguration=${options['configuration-matching']}`); |
|  |  | } |
|  |  | if (options['configuration-attributes']) { |
|  |  | args.push( |
|  |  | `-PconfAttr=${quot}${options['configuration-attributes']}${quot}`, |
|  |  | ); |
|  |  | args.push(`-PconfAttr=${options['configuration-attributes']}`); |
|  |  | } |
|  |  |  |
|  |  | if (options.initScript) { |
|  |  | const formattedInitScript = formatArgWithWhiteSpace( |
|  |  | path.resolve(options.initScript), |
|  |  | ); |
|  |  | const formattedInitScript = path.resolve(options.initScript); |
|  |  | args.push('--init-script', formattedInitScript); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -738,7 +723,7 @@ function buildArgs( |
|  |  | args.push('-PonlySubProject=' + (options.subProject || '.')); |
|  |  | } |
|  |  |  |
|  |  | args.push('-I ' + initGradlePath); |
|  |  | args.push('-I', initGradlePath); |
|  |  |  |
|  |  | if (options.args) { |
|  |  | args.push(...options.args); |
| Expand All | | @@ -751,16 +736,16 @@ function buildArgs( |
|  |  | // Transform --configuration=foo |
|  |  | args[i] = a.replace( |
|  |  | /^--configuration[= ]([a-zA-Z\_]+)/, |
|  |  | `-Pconfiguration=${quot}^$1$$${quot}`, |
|  |  | `-Pconfiguration=^$1$$`, |
|  |  | ); |
|  |  | // Transform --configuration foo |
|  |  | if (a === '--configuration') { |
|  |  | args[i] = `-Pconfiguration=${quot}^${args[i + 1]}$${quot}`; |
|  |  | args[i] = `-Pconfiguration=^${args[i + 1]}$`; |
|  |  | args[i + 1] = ''; |
|  |  | } |
|  |  | }); |
|  |  |  |
|  |  | return args; |
|  |  | return args.filter(Boolean); |
|  |  | } |
|  |  |  |
|  |  | export const exportsForTests = { |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[lib/sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d "lib/sub-process.ts")

Show comments

[View file](/snyk/snyk-gradle-plugin/blob/bb1c1c72a75e97723a76b14d2d73f70744ed5009/lib/sub-process.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,6 @@ |
|  |  | import \* as childProcess from 'child\_process'; |
|  |  | import debugModule = require('debug'); |
|  |  | import { quoteAll } from 'shescape'; |
|  |  |  |
|  |  | const debugLogging = debugModule('snyk-gradle-plugin'); |
|  |  |  |
| Expand All | | @@ -14,6 +15,7 @@ export function execute( |
|  |  | if (options && options.cwd) { |
|  |  | spawnOptions.cwd = options.cwd; |
|  |  | } |
|  |  | args = quoteAll(args, spawnOptions); |
|  |  |  |
|  |  | return new Promise((resolve, reject) => { |
|  |  | let stdout = ''; |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/snyk/snyk-gradle-plugin/blob/bb1c1c72a75e97723a76b14d2d73f70744ed5009/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -51,6 +51,7 @@ |
|  |  | "debug": "^4.1.1", |
|  |  | "p-map": "^4.0.0", |
|  |  | "packageurl-js": "^1.0.0", |
|  |  | "shescape": "1.6.1", |
|  |  | "tmp": "0.2.1", |
|  |  | "tslib": "^2.0.0" |
|  |  | }, |
| Expand Down | |  |

28 changes: 14 additions & 14 deletions

28
[test/functional/gradle-plugin.spec.ts](#diff-537f27092dc961b1c00cd16e2ac964554b03b7fe140904be4fb7fa0bcf5c6bc6 "test/functional/gradle-plugin.spec.ts")

Show comments

[View file](/snyk/snyk-gradle-plugin/blob/bb1c1c72a75e97723a76b14d2d73f70744ed5009/test/functional/gradle-plugin.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,8 +1,4 @@ |
|  |  | import { exportsForTests as testableMethods } from '../../lib'; |
|  |  | import \* as os from 'os'; |
|  |  |  |
|  |  | const isWin = /^win/.test(os.platform()); |
|  |  | const quot = isWin ? '"' : "'"; |
|  |  |  |
|  |  | const JEST\_TIMEOUT = 15000; |
|  |  |  |
| Expand All | | @@ -16,7 +12,8 @@ describe('Gradle Plugin', () => { |
|  |  | '-Dorg.gradle.parallel=', |
|  |  | '-Dorg.gradle.console=plain', |
|  |  | '-PonlySubProject=.', |
|  |  | '-I /tmp/init.gradle', |
|  |  | '-I', |
|  |  | '/tmp/init.gradle', |
|  |  | ]); |
|  |  | }); |
|  |  |  |
| Expand All | | @@ -28,12 +25,13 @@ describe('Gradle Plugin', () => { |
|  |  | expect(result).toEqual([ |
|  |  | 'snykResolvedDepsJson', |
|  |  | '-q', |
|  |  | `-Pconfiguration=${quot}confRegex${quot}`, |
|  |  | `-Pconfiguration=confRegex`, |
|  |  | '--no-daemon', |
|  |  | '-Dorg.gradle.parallel=', |
|  |  | '-Dorg.gradle.console=plain', |
|  |  | '-PonlySubProject=.', |
|  |  | '-I /tmp/init.gradle', |
|  |  | '-I', |
|  |  | '/tmp/init.gradle', |
|  |  | '--build-file', |
|  |  | 'build.gradle', |
|  |  | ]); |
| Expand All | | @@ -48,11 +46,12 @@ describe('Gradle Plugin', () => { |
|  |  | expect(result).toEqual([ |
|  |  | 'snykResolvedDepsJson', |
|  |  | '-q', |
|  |  | `-Pconfiguration=${quot}confRegex${quot}`, |
|  |  | `-Pconfiguration=confRegex`, |
|  |  | '-Dorg.gradle.parallel=', |
|  |  | '-Dorg.gradle.console=plain', |
|  |  | '-PonlySubProject=.', |
|  |  | '-I /tmp/init.gradle', |
|  |  | '-I', |
|  |  | '/tmp/init.gradle', |
|  |  | '--build-file', |
|  |  | 'build.gradle', |
|  |  | ]); |
| Expand All | | @@ -69,10 +68,11 @@ describe('Gradle Plugin', () => { |
|  |  | '-Dorg.gradle.parallel=', |
|  |  | '-Dorg.gradle.console=plain', |
|  |  | '-PonlySubProject=.', |
|  |  | '-I /tmp/init.gradle', |
|  |  | '-I', |
|  |  | '/tmp/init.gradle', |
|  |  | '--build-file', |
|  |  | 'build.gradle', |
|  |  | `-Pconfiguration=${quot}^compile$${quot}`, |
|  |  | `-Pconfiguration=^compile$`, |
|  |  | ]); |
|  |  | }); |
|  |  |  |
| Expand All | | @@ -89,11 +89,11 @@ describe('Gradle Plugin', () => { |
|  |  | '--no-daemon', |
|  |  | '-Dorg.gradle.parallel=', |
|  |  | '-Dorg.gradle.console=plain', |
|  |  | '-I /tmp/init.gradle', |
|  |  | '-I', |
|  |  | '/tmp/init.gradle', |
|  |  | '--build-file', |
|  |  | 'build.gradle', |
|  |  | `-Pconfiguration=${quot}^compile$${quot}`, |
|  |  | '', // this is a harmless artifact of argument transformation |
|  |  | `-Pconfiguration=^compile$`, |
|  |  | ]); |
|  |  | }, |
|  |  | JEST\_TIMEOUT, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bb1c1c7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-gradle-plugin%2Fcommit%2Fbb1c1c72a75e97723a76b14d2d73f70744ed5009) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.snyk.io_68a3aeba_20250108_125137.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. snyk-docker-plugin
# Command Injection Affecting [snyk-docker-plugin](/package/npm/snyk-docker-plugin) package, versions **<5.6.5**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-SNYKDOCKERPLUGIN-3039679#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.52% (77th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Command Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**SNYK-JS-SNYKDOCKERPLUGIN-3039679**
* published**30 Nov 2022**
* disclosed**29 Sept 2022**
* credit**Ron Masas - Imperva**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 29 Sep 2022

[CVE-2022-22984  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-22984) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-77  (opens in a new tab)](https://cwe.mitre.org/data/definitions/77.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `snyk-docker-plugin` to version 5.6.5 or higher.

## Overview

Affected versions of this package are vulnerable to Command Injection due to an incomplete fix for [CVE-2022-40764](https://security.snyk.io/vuln/SNYK-JS-SNYK-3037342).

A successful exploit allows attackers to run arbitrary commands on the host system where the Snyk CLI is installed by passing in crafted command line flags.

In order to exploit this vulnerability, a user would have to execute the `snyk test` command on untrusted files. In most cases, an attacker positioned to control the command line arguments to the Snyk CLI would already be positioned to execute arbitrary commands. However, this could be abused in specific scenarios, such as continuous integration pipelines, where developers can control the arguments passed to the Snyk CLI to leverage this component as part of a wider attack against an integration/build pipeline.

This issue has been addressed in the latest Snyk Docker images available at <https://hub.docker.com/r/snyk/snyk> as of 2022-11-29. Images downloaded and built prior to that date should be updated.

The issue has also been addressed in the Snyk TeamCity CI/CD plugin as of version v20221130.093605.

## References

* [GitHub Commit (CLI)](https://github.com/snyk/cli/commit/80d97a93326406e09776156daf72e3caa03ae25a)
* [GitHub Commit (snyk-cocoapods-plugin)](https://github.com/snyk/snyk-cocoapods-plugin/commit/c73e049c5200772babde61c40aab57296bf91381)
* [GitHub Commit (snyk-docker-plugin)](https://github.com/snyk/snyk-docker-plugin/commit/d730d7630691a61587b120bb11daaaf4b58a8357)
* [GitHub Commit (snyk-gradle-plugin)](https://github.com/snyk/snyk-gradle-plugin/commit/bb1c1c72a75e97723a76b14d2d73f70744ed5009)
* [GitHub Commit (snyk-hex-plugin)](https://github.com/snyk/snyk-hex-plugin/commit/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)
* [GitHub Commit (snyk-mvn-plugin)](https://github.com/snyk/snyk-mvn-plugin/commit/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)
* [GitHub Commit (snyk-python-plugin)](https://github.com/snyk/snyk-python-plugin/commit/8591abdd9236108ac3e30c70c09238d6bb6aabf4)
* [GitHub Commit (snyk-sbt-plugin)](https://github.com/snyk/snyk-sbt-plugin/commit/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)
* [Imperva Blog Post](https://www.imperva.com/blog/how-scanning-your-projects-for-security-issues-can-lead-to-remote-code-execution/)
* [Snyk Blog Post](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev/)
### CVSS Scores

version 3.1
### Snyk

5 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker requires privileges that provide basic user capabilities that could normally affect only settings and files owned by a user. Alternatively, an attacker with Low privileges has the ability to access only non-sensitive resources.

  **Low**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

6.3 medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_74982790_20250108_125132.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-cocoapods-plugin%2Fcommit%2Fc73e049c5200772babde61c40aab57296bf91381)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-cocoapods-plugin%2Fcommit%2Fc73e049c5200772babde61c40aab57296bf91381)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-cocoapods-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-cocoapods-plugin](/snyk/snyk-cocoapods-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-cocoapods-plugin) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fsnyk%2Fsnyk-cocoapods-plugin)
* [Star
   4](/login?return_to=%2Fsnyk%2Fsnyk-cocoapods-plugin)

* [Code](/snyk/snyk-cocoapods-plugin)
* [Issues
  1](/snyk/snyk-cocoapods-plugin/issues)
* [Pull requests
  4](/snyk/snyk-cocoapods-plugin/pulls)
* [Actions](/snyk/snyk-cocoapods-plugin/actions)
* [Projects
  0](/snyk/snyk-cocoapods-plugin/projects)
* [Security](/snyk/snyk-cocoapods-plugin/security)
* [Insights](/snyk/snyk-cocoapods-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-cocoapods-plugin)
* [Issues](/snyk/snyk-cocoapods-plugin/issues)
* [Pull requests](/snyk/snyk-cocoapods-plugin/pulls)
* [Actions](/snyk/snyk-cocoapods-plugin/actions)
* [Projects](/snyk/snyk-cocoapods-plugin/projects)
* [Security](/snyk/snyk-cocoapods-plugin/security)
* [Insights](/snyk/snyk-cocoapods-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-cocoapods-plugin/commit/c73e049c5200772babde61c40aab57296bf91381)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: quote args

[Browse files](/snyk/snyk-cocoapods-plugin/tree/c73e049c5200772babde61c40aab57296bf91381)
Browse the repository at this point in the history

* Loading branch information

[![@danlucian](https://avatars.githubusercontent.com/u/6909300?s=40&v=4)](/danlucian)

[danlucian](/snyk/snyk-cocoapods-plugin/commits?author=danlucian "View all commits by danlucian")
committed
Nov 29, 2022

1 parent
[eb1737c](/snyk/snyk-cocoapods-plugin/commit/eb1737ca919e08c5380a9f9de9b4d311469eb1e1)

commit c73e049

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**13 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .snyk
  [.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f)
* lib

  + lib/sub-process.ts
    [sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* test/lib

  + test/lib/sub-process.test.ts
    [sub-process.test.ts](#diff-24f29e195038ebf9e74db87c9d0dad51a59af4a0dc597449c9ab7b0bc89a6b13)

## There are no files selected for viewing

10 changes: 8 additions & 2 deletions

10
[.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f ".snyk")

Show comments

[View file](/snyk/snyk-cocoapods-plugin/blob/c73e049c5200772babde61c40aab57296bf91381/.snyk)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,12 @@ |
|  |  | # Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities. |
|  |  | version: v1.13.5 |
|  |  | ignore: {} |
|  |  | version: v1.25.0 |
|  |  | # ignores vulnerabilities until expiry date; change duration by modifying expiry date |
|  |  | ignore: |
|  |  | 'snyk:lic:npm:shescape:MPL-2.0': |
|  |  | - '\*': |
|  |  | reason: None Given |
|  |  | expires: 2022-12-29T09:11:54.820Z |
|  |  | created: 2022-11-29T09:11:54.829Z |
|  |  | # patches apply the minimum changes required to fix a vulnerability |
|  |  | patch: |
|  |  | SNYK-JS-LODASH-450202: |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[lib/sub-process.ts](#diff-a104851af2f93d46e15fc9f1fda5456189a4f72e1974559130d2299e318bae3d "lib/sub-process.ts")

Show comments

[View file](/snyk/snyk-cocoapods-plugin/blob/c73e049c5200772babde61c40aab57296bf91381/lib/sub-process.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,5 @@ |
|  |  | import \* as childProcess from 'child\_process'; |
|  |  | import { quoteAll } from 'shescape'; |
|  |  |  |
|  |  | export function execute( |
|  |  | command: string, |
| Expand All | | @@ -13,6 +14,8 @@ export function execute( |
|  |  | spawnOptions.cwd = options.cwd; |
|  |  | } |
|  |  |  |
|  |  | args = quoteAll(args, spawnOptions); |
|  |  |  |
|  |  | return new Promise((resolve, reject) => { |
|  |  | let stdout = ''; |
|  |  | let stderr = ''; |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/snyk/snyk-cocoapods-plugin/blob/c73e049c5200772babde61c40aab57296bf91381/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,6 +34,7 @@ |
|  |  | "@snyk/cli-interface": "^2.11.0", |
|  |  | "@snyk/cocoapods-lockfile-parser": "3.6.2", |
|  |  | "@snyk/dep-graph": "^1.23.1", |
|  |  | "shescape": "1.6.1", |
|  |  | "source-map-support": "^0.5.7", |
|  |  | "tslib": "^2.0.0" |
|  |  | }, |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/lib/sub-process.test.ts](#diff-24f29e195038ebf9e74db87c9d0dad51a59af4a0dc597449c9ab7b0bc89a6b13 "test/lib/sub-process.test.ts")

Show comments

[View file](/snyk/snyk-cocoapods-plugin/blob/c73e049c5200772babde61c40aab57296bf91381/test/lib/sub-process.test.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -27,7 +27,7 @@ describe('execute()', () => { |
|  |  |  |
|  |  | test('Considers option.cwd', async () => { |
|  |  | await expect( |
|  |  | subProcess.execute('basename', ['$PWD'], { cwd: \_\_dirname }), |
|  |  | subProcess.execute('basename $PWD', [], { cwd: \_\_dirname }), |
|  |  | ).resolves.toEqual('lib\n'); |
|  |  | }); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c73e049`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-cocoapods-plugin%2Fcommit%2Fc73e049c5200772babde61c40aab57296bf91381) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.snyk.io_ccdeb44f_20250108_125140.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. @snyk/snyk-hex-plugin
# Command Injection Affecting [@snyk/snyk-hex-plugin](/package/npm/%40snyk/snyk-hex-plugin) package, versions **<1.1.6**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-SNYKSNYKHEXPLUGIN-3039680#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.52% (77th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Command Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**SNYK-JS-SNYKSNYKHEXPLUGIN-3039680**
* published**30 Nov 2022**
* disclosed**29 Sept 2022**
* credit**Ron Masas - Imperva**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 29 Sep 2022

[CVE-2022-22984  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-22984) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-77  (opens in a new tab)](https://cwe.mitre.org/data/definitions/77.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `@snyk/snyk-hex-plugin` to version 1.1.6 or higher.

## Overview

Affected versions of this package are vulnerable to Command Injection due to an incomplete fix for [CVE-2022-40764](https://security.snyk.io/vuln/SNYK-JS-SNYK-3037342).

A successful exploit allows attackers to run arbitrary commands on the host system where the Snyk CLI is installed by passing in crafted command line flags.

In order to exploit this vulnerability, a user would have to execute the `snyk test` command on untrusted files. In most cases, an attacker positioned to control the command line arguments to the Snyk CLI would already be positioned to execute arbitrary commands. However, this could be abused in specific scenarios, such as continuous integration pipelines, where developers can control the arguments passed to the Snyk CLI to leverage this component as part of a wider attack against an integration/build pipeline.

This issue has been addressed in the latest Snyk Docker images available at <https://hub.docker.com/r/snyk/snyk> as of 2022-11-29. Images downloaded and built prior to that date should be updated.

The issue has also been addressed in the Snyk TeamCity CI/CD plugin as of version v20221130.093605.

## References

* [GitHub Commit (CLI)](https://github.com/snyk/cli/commit/80d97a93326406e09776156daf72e3caa03ae25a)
* [GitHub Commit (snyk-cocoapods-plugin)](https://github.com/snyk/snyk-cocoapods-plugin/commit/c73e049c5200772babde61c40aab57296bf91381)
* [GitHub Commit (snyk-docker-plugin)](https://github.com/snyk/snyk-docker-plugin/commit/d730d7630691a61587b120bb11daaaf4b58a8357)
* [GitHub Commit (snyk-gradle-plugin)](https://github.com/snyk/snyk-gradle-plugin/commit/bb1c1c72a75e97723a76b14d2d73f70744ed5009)
* [GitHub Commit (snyk-hex-plugin)](https://github.com/snyk/snyk-hex-plugin/commit/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)
* [GitHub Commit (snyk-mvn-plugin)](https://github.com/snyk/snyk-mvn-plugin/commit/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)
* [GitHub Commit (snyk-python-plugin)](https://github.com/snyk/snyk-python-plugin/commit/8591abdd9236108ac3e30c70c09238d6bb6aabf4)
* [GitHub Commit (snyk-sbt-plugin)](https://github.com/snyk/snyk-sbt-plugin/commit/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)
* [Imperva Blog Post](https://www.imperva.com/blog/how-scanning-your-projects-for-security-issues-can-lead-to-remote-code-execution/)
* [Snyk Blog Post](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev/)
### CVSS Scores

version 3.1
### Snyk

5 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker requires privileges that provide basic user capabilities that could normally affect only settings and files owned by a user. Alternatively, an attacker with Low privileges has the ability to access only non-sensitive resources.

  **Low**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

6.3 medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from security.snyk.io_66b41da2_20250108_125138.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. snyk-mvn-plugin
# Command Injection Affecting [snyk-mvn-plugin](/package/npm/snyk-mvn-plugin) package, versions **<2.31.3**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-SNYKMVNPLUGIN-3038623#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.52% (77th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Command Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**SNYK-JS-SNYKMVNPLUGIN-3038623**
* published**30 Nov 2022**
* disclosed**29 Sept 2022**
* credit**Ron Masas - Imperva**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 29 Sep 2022

[CVE-2022-22984  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-22984) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-77  (opens in a new tab)](https://cwe.mitre.org/data/definitions/77.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `snyk-mvn-plugin` to version 2.31.3 or higher.

## Overview

[snyk-mvn-plugin](https://www.npmjs.com/package/snyk-mvn-plugin) is a plugin for the Snyk CLI tool, providing dependency metadata for Maven projects that use mvn and have a pom.xml file.

Affected versions of this package are vulnerable to Command Injection due to an incomplete fix for [CVE-2022-40764](https://security.snyk.io/vuln/SNYK-JS-SNYK-3037342).

A successful exploit allows attackers to run arbitrary commands on the host system where the Snyk CLI is installed by passing in crafted command line flags.

In order to exploit this vulnerability, a user would have to execute the `snyk test` command on untrusted files. In most cases, an attacker positioned to control the command line arguments to the Snyk CLI would already be positioned to execute arbitrary commands. However, this could be abused in specific scenarios, such as continuous integration pipelines, where developers can control the arguments passed to the Snyk CLI to leverage this component as part of a wider attack against an integration/build pipeline.

This issue has been addressed in the latest Snyk Docker images available at <https://hub.docker.com/r/snyk/snyk> as of 2022-11-29. Images downloaded and built prior to that date should be updated.

The issue has also been addressed in the Snyk TeamCity CI/CD plugin as of version v20221130.093605.

## References

* [GitHub Commit (CLI)](https://github.com/snyk/cli/commit/80d97a93326406e09776156daf72e3caa03ae25a)
* [GitHub Commit (snyk-cocoapods-plugin)](https://github.com/snyk/snyk-cocoapods-plugin/commit/c73e049c5200772babde61c40aab57296bf91381)
* [GitHub Commit (snyk-docker-plugin)](https://github.com/snyk/snyk-docker-plugin/commit/d730d7630691a61587b120bb11daaaf4b58a8357)
* [GitHub Commit (snyk-gradle-plugin)](https://github.com/snyk/snyk-gradle-plugin/commit/bb1c1c72a75e97723a76b14d2d73f70744ed5009)
* [GitHub Commit (snyk-hex-plugin)](https://github.com/snyk/snyk-hex-plugin/commit/e8dd2a330b40d7fc0ab47e34413e80a0146d7ac3)
* [GitHub Commit (snyk-mvn-plugin)](https://github.com/snyk/snyk-mvn-plugin/commit/02cda9ba1ea36b00ead3f6ec2de0f97397ebec50)
* [GitHub Commit (snyk-python-plugin)](https://github.com/snyk/snyk-python-plugin/commit/8591abdd9236108ac3e30c70c09238d6bb6aabf4)
* [GitHub Commit (snyk-sbt-plugin)](https://github.com/snyk/snyk-sbt-plugin/commit/99c09eb12c9f8f2b237aea9627aab1ae3cab6437)
* [Imperva Blog Post](https://www.imperva.com/blog/how-scanning-your-projects-for-security-issues-can-lead-to-remote-code-execution/)
* [Snyk Blog Post](https://snyk.io/blog/code-injection-vulns-cli-ide-plugins-medium-sev/)
### CVSS Scores

version 3.1
### Snyk

5 medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected.

  **High**
* Privileges Required (PR)

  The attacker requires privileges that provide basic user capabilities that could normally affect only settings and files owned by a user. Alternatively, an attacker with Low privileges has the ability to access only non-sensitive resources.

  **Low**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

6.3 medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_f16d632c_20250108_125135.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-python-plugin%2Fcommit%2F8591abdd9236108ac3e30c70c09238d6bb6aabf4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-python-plugin%2Fcommit%2F8591abdd9236108ac3e30c70c09238d6bb6aabf4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snyk%2Fsnyk-python-plugin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snyk](/snyk)
/
**[snyk-python-plugin](/snyk/snyk-python-plugin)**
Public

* [Notifications](/login?return_to=%2Fsnyk%2Fsnyk-python-plugin) You must be signed in to change notification settings
* [Fork
  25](/login?return_to=%2Fsnyk%2Fsnyk-python-plugin)
* [Star
   18](/login?return_to=%2Fsnyk%2Fsnyk-python-plugin)

* [Code](/snyk/snyk-python-plugin)
* [Issues
  4](/snyk/snyk-python-plugin/issues)
* [Pull requests
  2](/snyk/snyk-python-plugin/pulls)
* [Actions](/snyk/snyk-python-plugin/actions)
* [Security](/snyk/snyk-python-plugin/security)
* [Insights](/snyk/snyk-python-plugin/pulse)

Additional navigation options

* [Code](/snyk/snyk-python-plugin)
* [Issues](/snyk/snyk-python-plugin/issues)
* [Pull requests](/snyk/snyk-python-plugin/pulls)
* [Actions](/snyk/snyk-python-plugin/actions)
* [Security](/snyk/snyk-python-plugin/security)
* [Insights](/snyk/snyk-python-plugin/pulse)

## Commit

[Permalink](/snyk/snyk-python-plugin/commit/8591abdd9236108ac3e30c70c09238d6bb6aabf4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: quote spawn args

[Browse files](/snyk/snyk-python-plugin/tree/8591abdd9236108ac3e30c70c09238d6bb6aabf4)
Browse the repository at this point in the history

* Loading branch information

[![@xzhou-snyk](https://avatars.githubusercontent.com/u/102186579?s=40&v=4)](/xzhou-snyk)

[xzhou-snyk](/snyk/snyk-python-plugin/commits?author=xzhou-snyk "View all commits by xzhou-snyk")
committed
Nov 29, 2022

1 parent
[43d4b85](/snyk/snyk-python-plugin/commit/43d4b856ff649fa315598a99451830caee6da306)

commit 8591abd

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**15 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .snyk
  [.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f)
* lib/dependencies

  + lib/dependencies/sub-process.ts
    [sub-process.ts](#diff-8b04b3b23f0054f952310954cdf2277792d6251e3ec15b6db347580b4d43120c)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)

## There are no files selected for viewing

11 changes: 11 additions & 0 deletions

11
[.snyk](#diff-45f12c395c9d92360df0720e2b2503c35b68af15bc53c5f5cd5b8ebfa763163f ".snyk")

Show comments

[View file](/snyk/snyk-python-plugin/blob/8591abdd9236108ac3e30c70c09238d6bb6aabf4/.snyk)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,11 @@ |
|  |  | # Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities. |
|  |  | version: v1.25.0 |
|  |  | # ignores vulnerabilities until expiry date; change duration by modifying expiry date |
|  |  | ignore: |
|  |  | 'snyk:lic:npm:shescape:MPL-2.0': |
|  |  | - '\*': |
|  |  | reason: None Given |
|  |  | expires: 2122-12-29T08:08:41.608Z |
|  |  | created: 2022-11-29T08:08:41.611Z |
|  |  | patch: {} |
|  |  |  |

3 changes: 3 additions & 0 deletions

3
[lib/dependencies/sub-process.ts](#diff-8b04b3b23f0054f952310954cdf2277792d6251e3ec15b6db347580b4d43120c "lib/dependencies/sub-process.ts")

Show comments

[View file](/snyk/snyk-python-plugin/blob/8591abdd9236108ac3e30c70c09238d6bb6aabf4/lib/dependencies/sub-process.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,5 @@ |
|  |  | import { spawn, spawnSync, SpawnOptions } from 'child\_process'; |
|  |  | import { quoteAll } from 'shescape'; |
|  |  |  |
|  |  | interface ProcessOptions { |
|  |  | cwd?: string; |
| Expand All | | @@ -22,6 +23,7 @@ export function execute( |
|  |  | options?: ProcessOptions |
|  |  | ): Promise<string> { |
|  |  | const spawnOptions = makeSpawnOptions(options); |
|  |  | args = quoteAll(args, spawnOptions); |
|  |  | return new Promise((resolve, reject) => { |
|  |  | let stdout = ''; |
|  |  | let stderr = ''; |
| Expand Down  Expand Up | | @@ -49,6 +51,7 @@ export function executeSync( |
|  |  | options?: ProcessOptions |
|  |  | ) { |
|  |  | const spawnOptions = makeSpawnOptions(options); |
|  |  | args = quoteAll(args, spawnOptions); |
|  |  |  |
|  |  | return spawnSync(command, args, spawnOptions); |
|  |  | } |

1 change: 1 addition & 0 deletions

1
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/snyk/snyk-python-plugin/blob/8591abdd9236108ac3e30c70c09238d6bb6aabf4/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,6 +25,7 @@ |
|  |  | "dependencies": { |
|  |  | "@snyk/cli-interface": "^2.11.2", |
|  |  | "@snyk/dep-graph": "^1.28.1", |
|  |  | "shescape": "1.6.1", |
|  |  | "snyk-poetry-lockfile-parser": "^1.1.7", |
|  |  | "tmp": "0.2.1" |
|  |  | }, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8591abd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnyk%2Fsnyk-python-plugin%2Fcommit%2F8591abdd9236108ac3e30c70c09238d6bb6aabf4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


