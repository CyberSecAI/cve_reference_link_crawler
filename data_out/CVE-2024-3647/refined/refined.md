Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-3647

**Root Cause:** The vulnerability stems from insufficient input sanitization and output escaping of user-supplied attributes within the "Premium Addons for Elementor" plugin's post ticker widget. Specifically, the `arrow_style` attribute within the plugin's settings is not properly sanitized or escaped.

**Weaknesses/Vulnerabilities:**
*   **Stored Cross-Site Scripting (XSS):** The lack of proper sanitization and escaping allows an attacker to inject arbitrary web scripts, which are then stored in the database and executed when a user accesses the affected page. This is a stored XSS vulnerability.
*   **Insufficient Input Sanitization:** The plugin fails to properly sanitize user-supplied data before storing it in the database.
*  **Insufficient Output Escaping:** The plugin fails to properly escape user-supplied data when rendering it on a web page.
* The code diff shows that `esc_attr` and `esc_html` were added, to sanitize and escape respectively the vulnerable fields that were previously lacking it.

**Impact of Exploitation:**
*   **Arbitrary Script Execution:** An attacker can execute malicious JavaScript code in the context of a user's browser.
*   **Account Takeover:** Through XSS, an attacker can potentially steal cookies or session tokens, leading to account hijacking.
*   **Malware Distribution:** An attacker could redirect users to malicious websites or inject scripts that download malware.
*   **Defacement:** An attacker could alter the appearance of the website or display unwanted content.

**Attack Vectors:**
*   **Plugin Settings:** The vulnerability is present in the settings of the Premium Post Ticker widget within the "Premium Addons for Elementor" plugin.
*   **User-Supplied Attributes:** Attackers inject malicious scripts via the `arrow_style` attribute of the post ticker widget.

**Required Attacker Capabilities/Position:**
*   **Authenticated Contributor Access (or higher):** An attacker needs to have at least contributor-level privileges on the WordPress site to access the vulnerable widget settings.
*   **Knowledge of Elementor:** Attackers need some knowledge of how to use Elementor page builder and the Premium Addons for Elementor plugin.

**Additional Information**
* The vulnerability was found by stealthcopter.
* The fix was released in version 4.10.29
* The vulnerable code was in `premium-addons-for-elementor/trunk/widgets/premium-post-ticker.php`