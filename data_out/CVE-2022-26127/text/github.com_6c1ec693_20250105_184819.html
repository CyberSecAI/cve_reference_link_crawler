
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10487)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10487)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=FRRouting%2Ffrr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FRRouting](/FRRouting)
/
**[frr](/FRRouting/frr)**
Public

* [Notifications](/login?return_to=%2FFRRouting%2Ffrr) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FFRRouting%2Ffrr)
* [Star
   3.5k](/login?return_to=%2FFRRouting%2Ffrr)

* [Code](/FRRouting/frr)
* [Issues
  354](/FRRouting/frr/issues)
* [Pull requests
  221](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects
  1](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

Additional navigation options

* [Code](/FRRouting/frr)
* [Issues](/FRRouting/frr/issues)
* [Pull requests](/FRRouting/frr/pulls)
* [Discussions](/FRRouting/frr/discussions)
* [Actions](/FRRouting/frr/actions)
* [Projects](/FRRouting/frr/projects)
* [Wiki](/FRRouting/frr/wiki)
* [Security](/FRRouting/frr/security)
* [Insights](/FRRouting/frr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FFRRouting%2Ffrr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Miss a check on length in Babel #10487

Closed

[whichbug](/whichbug) opened this issue
Feb 3, 2022
· 3 comments
 · Fixed by [#10494](https://github.com/FRRouting/frr/pull/10494)

Closed

# [Miss a check on length in Babel](#top) #10487

[whichbug](/whichbug) opened this issue
Feb 3, 2022
· 3 comments
 · Fixed by [#10494](https://github.com/FRRouting/frr/pull/10494)

## Comments

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

### **[whichbug](/whichbug)** commented [Feb 3, 2022](#issue-1122594188) • edited Loading

| The code below misses a check on the relationship between `packetlen` and `bodylen` before Line 298, which may lead to buffer overflows when accessing the memory at Line 300 and Line 309.     [frr/babeld/message.c](https://github.com/FRRouting/frr/blob/3d1ff4bfdb159583a62e72ccb359a8508c4cbb2e/babeld/message.c#L289-L309)  Lines 289 to 309 in [3d1ff4b](/FRRouting/frr/commit/3d1ff4bfdb159583a62e72ccb359a8508c4cbb2e)   |  | babel\_packet\_examin(const unsigned char \*packet, int packetlen) | | --- | --- | |  | { | |  | unsigned i = 0, bodylen; | |  | const unsigned char \*message; | |  | unsigned char type, len; | |  |  | |  | if(packetlen < 4 || packet[0] != 42 || packet[1] != 2) | |  | return 1; | |  | DO\_NTOHS(bodylen, packet + 2); | |  | while (i < bodylen){ | |  | message = packet + 4 + i; | |  | type = message[0]; | |  | if(type == MESSAGE\_PAD1) { | |  | i++; | |  | continue; | |  | } | |  | if(i + 1 > bodylen) { | |  | debugf(BABEL\_DEBUG\_COMMON,"Received truncated message."); | |  | return 1; | |  | } | |  | len = message[1]; |      To fix, we may put the code below before the while loop:  ``` if (packetlen < bodylen + 4) {     debugf(BABEL_DEBUG_COMMON,"Received truncated message.");      return 1;  }  ```  The output of the address sanitizer:  ``` ==271648==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x603000000114 at pc 0x00000059301a bp 0x7fff3f7301f0 sp 0x7fff3f7301e8 READ of size 1 at 0x603000000114 thread T0     #0 0x593019 in babel_packet_examin /home/parallels/myfrr/babeld/message.c:300:16     #1 0x593019 in parse_packet /home/parallels/myfrr/babeld/message.c:354:9  ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[whichbug](/whichbug)
pushed a commit
to whichbug/frr
that referenced
this issue
[Feb 3, 2022](#ref-commit-ff0f99d)

`[babeld:](/whichbug/frr/commit/ff0f99d2cc12df57e0808d4fa86a70892f20867c "babeld: fix #10487 by adding a check on packet length") [fix](/whichbug/frr/commit/ff0f99d2cc12df57e0808d4fa86a70892f20867c "babeld: fix #10487 by adding a check on packet length") [FRRouting#10487](https://github.com/FRRouting/frr/issues/10487) [by adding a check on packet length](/whichbug/frr/commit/ff0f99d2cc12df57e0808d4fa86a70892f20867c "babeld: fix #10487 by adding a check on packet length")`

`[ff0f99d](/whichbug/frr/commit/ff0f99d2cc12df57e0808d4fa86a70892f20867c)`

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Feb 3, 2022](#issuecomment-1029261449)

| Awesome! Since you already have a fix, would you be willing to submit the patch as a PR? That would be super helpful. |
| --- |

All reactions

Sorry, something went wrong.

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=40&v=4)](/whichbug)
[whichbug](/whichbug)
mentioned this issue
[Feb 3, 2022](#ref-pullrequest-1123405477)

[babeld: add a check for truncated packets
#10494](/FRRouting/frr/pull/10494)
 Merged

[whichbug](/whichbug)
pushed a commit
to whichbug/frr
that referenced
this issue
[Feb 3, 2022](#ref-commit-32d3742)

`[babeld:](/whichbug/frr/commit/32d3742a6561e334a7a352189d9c85dcda0b079a "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [fix](/whichbug/frr/commit/32d3742a6561e334a7a352189d9c85dcda0b079a "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [FRRouting#10487](https://github.com/FRRouting/frr/issues/10487) [by adding a check on packet length](/whichbug/frr/commit/32d3742a6561e334a7a352189d9c85dcda0b079a "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>")`
…

`[32d3742](/whichbug/frr/commit/32d3742a6561e334a7a352189d9c85dcda0b079a)`

```
The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>
```

[![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=80&v=4)](/whichbug)

Copy link

Author

### **[whichbug](/whichbug)** commented [Feb 3, 2022](#issuecomment-1029421896)

| Awesome! Since you already have a fix, would you be willing to submit the patch as a PR? That would be super helpful.  Thanks for your reply. I have created the pull request. |
| --- |

All reactions

Sorry, something went wrong.

[whichbug](/whichbug)
pushed a commit
to whichbug/frr
that referenced
this issue
[Feb 4, 2022](#ref-commit-6a0b68a)

`[babeld:](/whichbug/frr/commit/6a0b68a90b6d507754a49e37d4ce2f3900c64ae0 "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [fix](/whichbug/frr/commit/6a0b68a90b6d507754a49e37d4ce2f3900c64ae0 "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [FRRouting#10487](https://github.com/FRRouting/frr/issues/10487) [by adding a check on packet length](/whichbug/frr/commit/6a0b68a90b6d507754a49e37d4ce2f3900c64ae0 "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>")`
…

`[6a0b68a](/whichbug/frr/commit/6a0b68a90b6d507754a49e37d4ce2f3900c64ae0)`

```
The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>
```

[whichbug](/whichbug)
pushed a commit
to whichbug/frr
that referenced
this issue
[Feb 4, 2022](#ref-commit-50044ec)

`[babeld:](/whichbug/frr/commit/50044ec7fe129e0a74d3a679dd29fe17ce30e6bf "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [fix](/whichbug/frr/commit/50044ec7fe129e0a74d3a679dd29fe17ce30e6bf "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [FRRouting#10487](https://github.com/FRRouting/frr/issues/10487) [by adding a check on packet length](/whichbug/frr/commit/50044ec7fe129e0a74d3a679dd29fe17ce30e6bf "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>")`
…

`[50044ec](/whichbug/frr/commit/50044ec7fe129e0a74d3a679dd29fe17ce30e6bf)`

```
The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>
```

[![@idryzhov](https://avatars.githubusercontent.com/u/1313087?s=40&u=51fd13af16a6eb7beaa64b47f435e1dfe9beb920&v=4)](/idryzhov)
[idryzhov](/idryzhov)
closed this as [completed](/FRRouting/frr/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#10494](/FRRouting/frr/pull/10494)
[Feb 6, 2022](#event-6015340176)

[plsaranya](/plsaranya)
pushed a commit
to plsaranya/frr
that referenced
this issue
[Feb 28, 2022](#ref-commit-02d7418)
[![@plsaranya](https://avatars.githubusercontent.com/u/10954528?s=40&v=4)](/plsaranya)

`[babeld:](/plsaranya/frr/commit/02d7418199bd14d435b085bda7965ee6ca9a8ead "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [fix](/plsaranya/frr/commit/02d7418199bd14d435b085bda7965ee6ca9a8ead "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [FRRouting#10487](https://github.com/FRRouting/frr/issues/10487) [by adding a check on packet length](/plsaranya/frr/commit/02d7418199bd14d435b085bda7965ee6ca9a8ead "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>")`
…

`[02d7418](/plsaranya/frr/commit/02d7418199bd14d435b085bda7965ee6ca9a8ead)`

```
The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>
```

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=80&u=e4fb7eefa8244a2824931fa7e2c426cd89802ac1&v=4)](/qlyoung)

Copy link

Member

### **[qlyoung](/qlyoung)** commented [Mar 28, 2022](#issuecomment-1080992389) • edited Loading

| This has been assigned [CVE-2022-26127](https://nvd.nist.gov/vuln/detail/CVE-2022-26127) with a severity score of 7.8.  No assessment of exploitability has been made.  Please see my comment [here](https://github.com/FRRouting/frr/issues/10507#issuecomment-1080985102) |
| --- |

All reactions

Sorry, something went wrong.

[patrasar](/patrasar)
pushed a commit
to patrasar/frr
that referenced
this issue
[Apr 28, 2022](#ref-commit-805b4d5)
[![@patrasar](https://avatars.githubusercontent.com/u/40834655?s=40&v=4)](/patrasar)

`[babeld:](/patrasar/frr/commit/805b4d59665a42329801bf7549c7f70db43a8e4c "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [fix](/patrasar/frr/commit/805b4d59665a42329801bf7549c7f70db43a8e4c "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [FRRouting#10487](https://github.com/FRRouting/frr/issues/10487) [by adding a check on packet length](/patrasar/frr/commit/805b4d59665a42329801bf7549c7f70db43a8e4c "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>")`
…

`[805b4d5](/patrasar/frr/commit/805b4d59665a42329801bf7549c7f70db43a8e4c)`

```
The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>
```

[gpnaveen](/gpnaveen)
pushed a commit
to gpnaveen/frr
that referenced
this issue
[Jun 7, 2022](#ref-commit-8645122)

`[babeld:](/gpnaveen/frr/commit/86451228c215b193f9e35768b05c77e2086dd2b7 "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [fix](/gpnaveen/frr/commit/86451228c215b193f9e35768b05c77e2086dd2b7 "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>") [FRRouting#10487](https://github.com/FRRouting/frr/issues/10487) [by adding a check on packet length](/gpnaveen/frr/commit/86451228c215b193f9e35768b05c77e2086dd2b7 "babeld: fix #10487 by adding a check on packet length

The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>")`
…

`[8645122](/gpnaveen/frr/commit/86451228c215b193f9e35768b05c77e2086dd2b7)`

```
The body length of a packet should satisfy the condition:
packetlen >= bodylen + 4. Otherwise, heap overflows may happen.

Signed-off-by: whichbug <whichbug@github.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FFRRouting%2Ffrr%2Fissues%2F10487)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [babeld: add a check for truncated packets](/FRRouting/frr/pull/10494)
 [whichbug/frr](/whichbug/frr)

2 participants

[![@qlyoung](https://avatars.githubusercontent.com/u/6827003?s=52&v=4)](/qlyoung) [![@whichbug](https://avatars.githubusercontent.com/u/31231681?s=52&v=4)](/whichbug)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

