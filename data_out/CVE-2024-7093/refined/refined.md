Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause:**
- The vulnerability is due to Server-Side Template Injection (SSTI) in Dispatch's notification service, which uses Jinja templates to generate messages. Jinja templates allow for code execution within blocks, and this functionality was not properly sanitized or sandboxed.

**Weaknesses/Vulnerabilities Present:**
- Server-Side Template Injection (SSTI) vulnerability.
- Lack of proper sanitization and sandboxing of Jinja template code.
- Vulnerable message templates can be created/edited by admin users, and can also be created by non-admin users if they are the first ones to do so.

**Impact of Exploitation:**
- Remote Code Execution (RCE) is possible.
- Attackers can construct command-line scripts within custom message templates.
- These scripts are executed whenever the corresponding notification is rendered and sent out.

**Attack Vectors:**
- Creating or editing message templates with malicious Jinja code.
- Triggering the execution of these templates through notification functionality.

**Required Attacker Capabilities/Position:**
- Authenticated user access to Dispatch.
- Ability to create or edit message templates which can be achieved by administrator users, or by non-admin users if they create the template first.

**Additional Details:**
- The vulnerability affects all versions of Dispatch before commit `c1626bf` which was included in pull request [#5002](https://github.com/Netflix/dispatch/pull/5002).
- A new release (`v20240731`) was created to address the vulnerability.
- The vulnerability was credited to [StrCXY](https://github.com/StrCXY).
- The fix involves ensuring that user-provided Jinja template code is properly sanitized and sandboxed before execution.