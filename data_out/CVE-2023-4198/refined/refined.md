Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2023-4198

**Root Cause of Vulnerability:**
The vulnerability stems from a missing authorization check in the `/core/ajax/ajaxcompanies.php` endpoint of Dolibarr ERP CRM. This allows any authenticated user, regardless of their privileges, to access and retrieve information about all third-party customers.

**Weaknesses/Vulnerabilities Present:**

*   **Missing Authorization (CWE-862):** The primary weakness is the absence of proper access control mechanisms on the vulnerable endpoint. This allows unauthorized access to sensitive data.
*   **SQL Injection (via LIKE clause):** Although not the primary vulnerability, the SQL query is formed by concatenating user-input in the LIKE clause, which allows an attacker to list all rows in the database using `%` as input, which allows for broader data retrieval.

**Impact of Exploitation:**

*   **Confidentiality Breach:** An attacker can gain access to sensitive information of third-party customers, including addresses, ZIP codes, and town names.
*   **Potential Data Leakage:** The vulnerability exposes the database table `societe` which holds information about third-party customers.

**Attack Vectors:**

*   **Network-based:** The attack is carried out over the network by sending HTTP GET requests to the vulnerable endpoint.
*   **Authentication Required:** The attacker must have a valid user account on the Dolibarr system, although it can be a low-privilege account.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs a valid user account, any user account, on the Dolibarr ERP CRM system to exploit this vulnerability.
*   **Network Access:** The attacker must be able to send HTTP requests to the Dolibarr server.

**Additional Details:**

*   The vulnerable endpoint is `/core/ajax/ajaxcompanies.php`.
*   The `newcompany` parameter is used to search for companies, but no authorization checks are performed.
*   The vulnerability was fixed by removing the vulnerable endpoint in version 18.0.0

This analysis provides more detail than the official CVE description, by describing the vulnerable code, the SQL injection, and providing a working PoC.