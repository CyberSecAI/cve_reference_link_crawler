<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: The GNU C Library security advisories update for
 2024-04-17: GLIBC-SA-2024-0004/CVE-2024-2961: ISO-2022-CN-EXT: fix
 out-of-bound writes when writing escape sequence</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://hashsuite.openwall.net">
Hash Suite - Windows password security audit tool. GUI, reports in PDF.</a>

</TABLE>
</TABLE>

<a href="../../../2024/05/26/1">[&lt;prev]</a> <a href="2">[next&gt;]</a> <a href="../../../2024/04/24/2">[&lt;thread-prev]</a> <a href="2">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;7789a6d5-92c9-4239-8a07-7b0131ed166b&#64;lexfo.fr&gt;
Date: Mon, 27 May 2024 11:16:53 +0200
From: Charles Fol &lt;c.fol&#64;...fo.fr&gt;
To: oss-security&#64;...ts.openwall.com
Subject: Re: The GNU C Library security advisories update for
 2024-04-17: GLIBC-SA-2024-0004/CVE-2024-2961: ISO-2022-CN-EXT: fix
 out-of-bound writes when writing escape sequence

Hello all,

Although very late, here is a follow up explaining the impact of the 
vulnerability.

Provided that you can force an application to convert a partially 
controlled buffer to ISO-2022-CN-EXT, you get an
overflow of 1 to 3 bytes whose value you don't control.

This can be triggered in at least two ways in PHP:

- Through direct calls to iconv()
- Through the use of PHP filters (i.e. using a "file read" vulnerability)

Due to the way PHP's heap is built, you can use such a memory corruption 
to alter part of a free list pointer,
which can in turn give you an arbitrary write primitive in the program's 
memory.

With this bug, any person that has a file read vulnerability with a 
controlled prefix on a PHP application has RCE.
Any person that can force PHP into calling iconv() with controlled 
parameters has RCE.

We have provided more explanations on a blogpost of ours (I do not think 
that I can post it here, it shouldn't be too
hard to find if you're interested).

Best regards,
Charles

On 18/04/2024 18:42, Solar Designer wrote:
&gt; On Wed, Apr 17, 2024 at 02:36:02PM -0300, Adhemerval Zanella Netto wrote:
&gt;&gt; GLIBC-SA-2024-0004:
&gt;&gt; ===================
&gt;&gt; ISO-2022-CN-EXT: fix out-of-bound writes when writing escape sequence
&gt;&gt;
&gt;&gt; The iconv() function in the GNU C Library versions 2.39 and older may
&gt;&gt; overflow the output buffer passed to it by up to 4 bytes when converting
&gt;&gt; strings to the ISO-2022-CN-EXT character set, which may be used to
&gt;&gt; crash an application or overwrite a neighbouring variable.
&gt;&gt;
&gt;&gt; ISO-2022-CN-EXT uses escape sequences to indicate character set changes
&gt;&gt; (as specified by RFC 1922).  While the SOdesignation has the expected
&gt;&gt; bounds checks, neither SS2designation nor SS3designation have its;
&gt;&gt; allowing a write overflow of 1, 2, or 3 bytes with fixed values:
&gt;&gt; '$+I', '$+J', '$+K', '$+L', '$+M', or '$*H'.
&gt;&gt;
&gt;&gt; CVE-Id: CVE-2024-2961
&gt;&gt; Public-Date: 2024-04-17
&gt;&gt; Vulnerable-Commit: 755104edc75c53f4a0e7440334e944ad3c6b32fc (2.1.93-169)
&gt;&gt; Fix-Commit: f9dc609e06b1136bb0408be9605ce7973a767ada (2.40)
&gt;&gt; Fix-Commit: 31da30f23cddd36db29d5b6a1c7619361b271fb4 (2.39-31)
&gt;&gt; Fix-Commit: e1135387deded5d73924f6ca20c72a35dc8e1bda (2.38-66)
&gt;&gt; Fix-Commit: 89ce64b269a897a7780e4c73a7412016381c6ecf (2.37-89)
&gt;&gt; Fix-Commit: 4ed98540a7fd19f458287e783ae59c41e64df7b5 (2.36-164)
&gt;&gt; Fix-Commit: 36280d1ce5e245aabefb877fe4d3c6cff95dabfa (2.35-315)
&gt;&gt; Fix-Commit: a8b0561db4b9847ebfbfec20075697d5492a363c (2.34-459)
&gt;&gt; Fix-Commit: ed4f16ff6bed3037266f1fa682ebd32a18fce29c (2.33-263)
&gt;&gt; Fix-Commit: 682ad4c8623e611a971839990ceef00346289cc9 (2.32-140)
&gt;&gt;
&gt;&gt; Reported-By: Charles Fol
&gt; I hope Charles will share further detail with oss-security in due time,
&gt; but meanwhile his upcoming OffensiveCon talk abstract reveals a bit:
&gt;
&gt; <a href="https://www.offensivecon.org/speakers/2024/charles-fol.html" rel="nofollow">https://www.offensivecon.org/speakers/2024/charles-fol.html</a>
&gt;
&gt;&gt; CHARLES FOL
&gt;&gt; ICONV, SET THE CHARSET TO RCE: EXPLOITING THE GLIBC TO HACK THE PHP ENGINE
&gt;&gt;
&gt;&gt; Abstract
&gt;&gt; A few months ago, I stumbled upon a 24 years old buffer overflow in the
&gt;&gt; glibc. Despite being reachable in multiple well-known libraries or
&gt;&gt; programs, it proved rarely exploitable. Indeed, this was not a foos bug:
&gt;&gt; with hard-to-achieve preconditions, it did not even provide a nice
&gt;&gt; primitive. On PHP however, it lead to amazing results: a new
&gt;&gt; exploitation technique that affects the whole PHP ecosystem, and the
&gt;&gt; compromission of several applications.
&gt;&gt;
&gt;&gt; This talk will first walk you through the discovery of the bug and its
&gt;&gt; limitations, before describing the conception of several remote binary
&gt;&gt; PHP exploits, and through them offer unique insight in the internal of
&gt;&gt; the engine of the web language, and the difficulties one faces when
&gt;&gt; exploiting it.
&gt;&gt;
&gt;&gt; BIO
&gt;&gt; Charles Fol, also known as cfreal, is a security researcher at LEXFO /
&gt;&gt; AMBIONICS. He has discovered remote code execution vulnerabilities
&gt;&gt; targeting renowned CMS and frameworks such as Drupal, Magento, Symfony
&gt;&gt; or Laravel, but also enjoys binary exploitation, to escalate privileges
&gt;&gt; (Apache, PHP-FPM) or compromise security solutions (DataDog's Sqreen,
&gt;&gt; Fortinet SSL VPN, Watchguard). He is the creator for PHPGGC, the go-to
&gt;&gt; tool to exploit PHP deserialization, and an expert in PHP internals.
&gt; The event is on May 10-11th, so in 3 weeks from now.
&gt;
&gt; Alexander
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
