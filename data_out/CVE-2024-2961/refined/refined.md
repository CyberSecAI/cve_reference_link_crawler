```
{
  "cve": "CVE-2024-2961",
  "description": "The iconv() function in the GNU C Library versions 2.39 and older may overflow the output buffer passed to it by up to 4 bytes when converting strings to the ISO-2022-CN-EXT character set, which may be used to crash an application or overwrite a neighbouring variable.\n\nISO-2022-CN-EXT uses escape sequences to indicate character set changes (as specified by RFC 1922). While the SOdesignation has the expected bounds checks, neither SS2designation nor SS3designation have its; allowing a write overflow of 1, 2, or 3 bytes with fixed values: '$+I', '$+J', '$+K', '$+L', '$+M', or '$*H'.",
  "affected_versions": "glibc versions 2.39 and older",
  "root_cause": "Missing bounds check in the iconv() function when converting strings to the ISO-2022-CN-EXT character set.",
  "vulnerabilities": [
    "Out-of-bounds write"
  ],
  "impact": "An out-of-bounds write can lead to a crash, information disclosure, data modification, or remote code execution.",
  "attack_vectors": [
    "Conversion of a string to the ISO-2022-CN-EXT character set using the iconv() function."
  ],
  "attacker_capabilities": "The attacker needs to be able to control part of the input string and the output character set to trigger the vulnerability. In some PHP contexts, the attacker needs the ability to perform a file read with a controlled prefix or force a call to iconv() with controlled parameters.",
   "additional_details": [
    "The vulnerability is a 24 year old bug.",
    "The overflow is 1 to 3 bytes with fixed values.",
    "The vulnerability can be triggered in PHP via direct calls to iconv() or through PHP filters using a 'file read' vulnerability.",
    "A successful exploit on PHP can alter part of a free list pointer, allowing an arbitrary write primitive.",
    "In PHP, the vulnerability can be triggered by a php://filter chain which can lead to RCE.",
    "The vulnerability is also reachable through the mbstring extension in PHP when mb_convert_encoding() is used with the ISO-2022-CN-EXT encoding",
    "The vulnerability can be used to achieve remote code execution in a variety of ways, including SQL injection, XXE, or other file read vulnerabilities.",
    "The exploit can use 'dechunk' and 'zlib.inflate' filters in PHP to manipulate the heap and prepare the memory corruption."
  ]
}
```