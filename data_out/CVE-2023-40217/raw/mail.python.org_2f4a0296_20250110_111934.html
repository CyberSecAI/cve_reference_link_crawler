




<!DOCTYPE HTML>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="ROBOTS" content="INDEX, FOLLOW" />
        <title>Mailman 3 
[CVE-2023-40217] Bypass TLS handshake on closed sockets - Security-announce - python.org
</title>
        <meta name="author" content="" />
        <meta name="dc.language" content="en" />
        <link rel="shortcut icon" href="/static/hyperkitty/img/favicon.ico" />
        <link rel="stylesheet" href="/static/hyperkitty/libs/jquery/smoothness/jquery-ui-1.13.1.min.css" type="text/css" media="all" />
        <link rel="stylesheet" href="/static/hyperkitty/libs/fonts/font-awesome/css/font-awesome.min.css" type="text/css" media="all" />
        <link rel="stylesheet" href="/static/CACHE/css/output.3fca2eb45ed9.css" type="text/css" media="all"><link rel="stylesheet" href="/static/CACHE/css/output.e68c4908b3de.css" type="text/css"><link rel="stylesheet" href="/static/CACHE/css/output.9488c1a3a2d5.css" type="text/css" media="all">
         
        
        

    </head>

    <body>

    


    <nav class="navbar sticky-top navbar-expand-md mb-2" id="navbar-main">
        <div class="container-xxl">
            <div class="navbar-header"> <!--part of navbar that's always present-->
                <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target=".navbar-collapse">
                    <span class="fa fa-bars"></span>
                </button>
                <a class="navbar-brand" href="/archives/">Mailman 3 python.org</a>

            </div> <!-- /navbar-header -->
            <div class="d-flex">
                <div class="auth dropdown d-md-none">
                        
                </div>
                
                <a  href="/accounts/login/?next=/archives/list/security-announce%40python.org/thread/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/" class="nav-link d-md-none">
                    <span class="fa fa-sign-in"></span>
                    Sign In
                </a>
                <a  href="/accounts/signup/?next=/archives/list/security-announce%40python.org/thread/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/" class="nav-link d-md-none">
                    <span class="fa fa-user-plus"></span>
                    Sign Up
                </a>
                
            </div>
            <div class="navbar-collapse collapse justify-content-end"> <!--part of navbar that's collapsed on small screens-->
                <!-- show dropdown for smaller viewports b/c login name/email may be too long -->
                <!-- only show this extra button/dropdown if we're in small screen sizes -->
            
                
                <a href="/mailman3/lists/security-announce.python.org/" class="nav-link">
                    <span class="fa fa-cog"></span>
                    Manage this list
                </a>
                
            
            
            <a  href="/accounts/login/?next=/archives/list/security-announce%40python.org/thread/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/" class="nav-link d-none d-md-block">
                <span class="fa fa-sign-in"></span>
                Sign In
            </a>
            <a  href="/accounts/signup/?next=/archives/list/security-announce%40python.org/thread/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/" class="nav-link d-none d-md-block">
                <span class="fa fa-user-plus"></span>
                Sign Up
            </a>
            
                <form name="search" method="get" action="/archives/search" class="navbar-form navbar-right my-2 my-lg-2 ms-2" role="search">
                    <input type="hidden" name="mlist" value="security-announce@python.org" />
                    <div class="input-group">
                    <input name="q" type="text" class="form-control rounded-4 search"
                            
                                placeholder="Search this list"
                                aria-label="Search this list"
                            
                            
                            />
                    <button class="btn search-button" aria-label="Search"><span class="fa fa-search"></span></button>
                    </div>
                </form>
                <!-- larger viewports -->
                <ul class="nav navbar-nav auth d-none d-md-flex">
                    
                </ul>
            </div> <!--/navbar-collapse -->
        </div><!-- /container for navbar -->
    </nav>

    

     <div class="modal fade" tabindex="-1" role="dialog" id="keyboard-shortcuts">
       <div class="modal-dialog" role="document">
         <div class="modal-content">
           <div class="modal-header">
             <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
             <h4 class="modal-title">Keyboard Shortcuts</h4>
           </div>
           <div class="modal-body">
             <h3>Thread View</h3>
             <ul>
               <li><code>j</code>: Next unread message </li>
               <li><code>k</code>: Previous unread message </li>
               <li><code>j a</code>: Jump to all threads
               <li><code>j l</code>: Jump to MailingList overview
             </ul>
           </div>
         </div><!-- /.modal-content -->
       </div><!-- /.modal-dialog -->
     </div><!-- /.modal -->

     <div class="container-xxl" role="main">
        

<div class="row view-thread d-flex">

        <!-- thread header: navigation (older/newer), thread title -->
        <div class="thread-header">
          <div class="d-flex">
            
            <div>
                
                <a id="next-thread" class="btn btn-secondary btn-sm "
                        title="[CVE-2022-48564] DoS when reading malformed Apple Property List files in binary format"
                        href="/archives/list/security-announce@python.org/thread/K2T3WIJM6OCTVTPW5TVW62EMAULA2426/">
                    <span class="fa fa-chevron-left"></span>
                    <span class="d-none d-md-inline">newer</span>
                </a>
                <br />
                <a href="/archives/list/security-announce@python.org/thread/K2T3WIJM6OCTVTPW5TVW62EMAULA2426/"
                title="[CVE-2022-48564] DoS when reading malformed Apple Property List files in binary format" class="thread-titles d-none d-md-block">
                    [CVE-2022-48564] DoS when reading...
                </a>
               
            </div>
            <div class="flex-grow-1">
                <h3>[CVE-2023-40217] Bypass TLS handshake on closed sockets</h3>
            </div>
            <div class="right">
                <a id="prev-thread" class="btn btn-secondary btn-sm "
                    
                    title="[CVE-2023-41105] os.path.normpath() truncates on null bytes"
                    href="/archives/list/security-announce@python.org/thread/D6CDW3ZZC5D444YGL3VQUY6D4ECMCQLD/"
                    >
                    <span class="fa fa-chevron-right"></span>
                    <span class="d-none d-md-inline">older</span>
                </a><br />
                
                <a href="/archives/list/security-announce@python.org/thread/D6CDW3ZZC5D444YGL3VQUY6D4ECMCQLD/"
                    title="[CVE-2023-41105] os.path.normpath() truncates on null bytes" class="thread-titles d-none d-md-block">
                    [CVE-2023-41105]...
                </a>
                
            </div>
          </div>
         
         </div>
        </div> <!-- /thread-header -->

        <div class="row">
            <div class="col-sm-12 col-md-9">
                <!-- main section, the email thread -->
                <div id="thread-content">

                    <!-- Start first email -->
                    





<div class="email email-first">

    <div id="PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY" class="email-header">
        <div class="gravatar-wrapper d-flex">
            <div class="gravatar circle">
                <img class="gravatar" src="https://secure.gravatar.com/avatar/b5a0900288ad3a29fd4a5ef260486055.jpg?s=120&amp;d=mm&amp;r=g" width="120" height="120" alt="" />
            </div>
            <div class="email-author d-flex">
                <h2 class="name">
                    
                    <a href="/archives/users/eb0c073014124400ac984fd5e76d1f7e/"
                       title="See the profile for Seth Larson"
                       >Seth Larson</a>
                    
                </h2>
            </div>
        </div>
        <div class="email-date right">
            
            
            <span class="date d-none d-sm-inline">
                24 Aug
                
                    2023
                
            </span>
            <span class="date d-sm-none">
                24 Aug
                
                '23
                
            </span>
            
            <div class="time">
                <span title="Sender's time: Aug. 24, 2023, 3:41 p.m.">8:41 p.m.</span>
            </div>

        </div>
        
    </div> <!-- /email-header: gravatar, author-info, date, peramlink, changed_subject -->
    <div class="email-body ">
      <p>Description
Instances of ssl.SSLSocket are vulnerable to a bypass of the TLS handshake
and included protections (like certificate verification) and treating sent
unencrypted data as if it were post-handshake TLS encrypted data if the
socket is closed before initiating its own handshake.</p>
<p>This vulnerability is of severity: <em>*HIGH*</em>.</p>
<p>The vulnerability is caused when a socket is connected, data is sent by the
malicious peer and stored in a buffer, and then the malicious peer closes
the socket within a small timing window before the other peers’ TLS
handshake can begin. After this sequence of events the closed socket will
not immediately attempt a TLS handshake due to not being connected but will
also allow the buffered data to be read as if a successful TLS handshake
had occurred.</p>
<p>Affected usages</p>
<p>This vulnerability <em>*primarily affects*</em> HTTPS servers and other server-side
protocols using TLS client authentication (such as mTLS) due to requiring
reading data immediately after the handshake to be vulnerable. Operations
which would fail on a closed socket (like sending data) immediately after
the handshake are not affected by this vulnerability.</p>
<p>Because disconnecting the socket is a necessary step to trigger the
vulnerability <em>*there is no risk of data exfiltration or data leakage
directly from the malicious TLS connection*</em>, however the vulnerability
<em>*does*</em> carry risk for modifying or deleting resources which are
authenticated using only TLS client certificates.</p>
<p>This vulnerability <em>*affects*</em> clients who are reading and processing data
from the server after a TLS handshake without sending any data first. Our
team is unaware of a protocol that uses TLS that fits this usage pattern.</p>
<p>This vulnerability <em>*does not affect*</em> client-side HTTPS connections like pip
or requests as an HTTP request must be sent before an HTTP response is read
meaning the connection would already be closed by the time the client is
sending an HTTP request, leading to an error.</p>
<p>This vulnerability <em>*affects, but has no impact*</em> on servers that aren’t
using TLS client certificate authentication as traffic to a
non-authenticating TLS server loses nothing from a bypassed handshake to
inject a query and close the connection as the same action could be taken
by a peer using a TLS connection with a proper handshake.</p>
<p>Affected versions</p>
<ul>
<li>Python 3.12.0a1 to 3.12.0rc1 *</li>
<li>Python 3.11.0 to 3.11.4</li>
<li>Python 3.10.0 to 3.10.12</li>
<li>Python 3.9.0 to 3.9.17</li>
<li>Python 3.8.0 to 3.8.17</li>
<li>Python 3.7.17 and earlier **</li>
</ul>
<ul>
<li>Note that Python 3.12.0rc2 will not be published for a few weeks.
<em>*Pre-release
versions of Python are not recommended for production use.*</em></li>
</ul>
<p>** <em>*Note that Python 3.7.17 and earlier will not be receiving an upstream
security fix due to being end-of-life
&lt;<a target="_blank" href="https://devguide.python.org/versions/#versions">https://devguide.python.org/versions/#versions</a>>,*</em> contact your distributor
of Python for additional guidance.</p>
<p>Remediation and work-arounds</p>
<ul>
<li>Upgrade to Python 3.11.5, 3.10.13, 3.9.18, or 3.8.18.</li>
<li>Apply a patch for your corresponding version of Python.</li>
<li>Add a call to SSLSocket.getpeername() after calling
SSLSocket.wrap_socket() before any calls to SSLSocket.recv(). This call
to getpeername() will raise an OSError if the socket isn’t connected
thus mitigating the vulnerability.</li>
</ul>
<p>Patches are available for all affected feature, bugfix, and security
branches of Python:</p>
<ul>
<li></li>
</ul>
<h2>main: 0cb0c238d520a8718e313b52cffc356a5a7561bf
&lt;<a target="_blank" href="https://github.com/python/cpython/commit/0cb0c238d520a8718e313b52cffc356a5a7561bf">https://github.com/python/cpython/commit/0cb0c238d520a8718e313b52cffc356a5a7...</a>></h2>
<h2>3.12: 256586ab8776e4526ca594b4866b9a3492e628f1
&lt;<a target="_blank" href="https://github.com/python/cpython/commit/256586ab8776e4526ca594b4866b9a3492e628f1">https://github.com/python/cpython/commit/256586ab8776e4526ca594b4866b9a3492e...</a>></h2>
<h2>3.11: 75a875e0df0530b75b1470d797942f90f4a718d3
&lt;<a target="_blank" href="https://github.com/python/cpython/commit/75a875e0df0530b75b1470d797942f90f4a718d3">https://github.com/python/cpython/commit/75a875e0df0530b75b1470d797942f90f4a...</a>></h2>
<h2>3.10: 37d7180cb647f0bed0c1caab0037f3bc82e2af96
&lt;<a target="_blank" href="https://github.com/python/cpython/commit/37d7180cb647f0bed0c1caab0037f3bc82e2af96">https://github.com/python/cpython/commit/37d7180cb647f0bed0c1caab0037f3bc82e...</a>></h2>
<h2>3.9: 264b1dacc67346efa0933d1e63f622676e0ed96b
&lt;<a target="_blank" href="https://github.com/python/cpython/commit/264b1dacc67346efa0933d1e63f622676e0ed96b">https://github.com/python/cpython/commit/264b1dacc67346efa0933d1e63f622676e0...</a>></h2>
<p>3.8: b4bcc06a9cfe13d96d5270809d963f8ba278f89b
&lt;<a target="_blank" href="https://github.com/python/cpython/commit/b4bcc06a9cfe13d96d5270809d963f8ba278f89b">https://github.com/python/cpython/commit/b4bcc06a9cfe13d96d5270809d963f8ba27...</a>></p>
<p>Additional patches to stabilize the test suite may also be applied to all
versions:</p>
<ul>
<li>64f99350351bc46e016b2286f36ba7cd669b79e3
&lt;<a target="_blank" href="https://github.com/python/cpython/commit/64f99350351bc46e016b2286f36ba7cd669b79e3">https://github.com/python/cpython/commit/64f99350351bc46e016b2286f36ba7cd669...</a>></li>
<li>592bacb6fc0833336c0453e818e9b95016e9fd47
&lt;<a target="_blank" href="https://github.com/python/cpython/commit/592bacb6fc0833336c0453e818e9b95016e9fd47">https://github.com/python/cpython/commit/592bacb6fc0833336c0453e818e9b95016e...</a>></li>
</ul>
<p>References</p>
<ul>
<li></li>
</ul>
<h2><a target="_blank" href="https://github.com/python/cpython/issues/108310">https://github.com/python/cpython/issues/108310</a></h2>
<p><a target="_blank" href="https://github.com/python/cpython/pull/108315">https://github.com/python/cpython/pull/108315</a></p>
<p>Credits</p>
<ul>
<li>Reporter: Aapo Oksman</li>
<li>Remediation Developer: Gregory P. Smith</li>
<li>Remediation Reviewer: Thomas Wouters</li>
<li>Coordinator: Seth Michael Larson</li>
</ul>
<p>Timeline</p>
<ul>
<li>August 8,2023: Reported by Aapo Oksman to security@python.org.</li>
<li>August 8, 2023: Acknowledged the report.</li>
<li>August 9, 2023: Acknowledgement of the vulnerability, sent CVE ID
request to MITRE.</li>
<li>August 10, 2023: CVE-2023-40217 assigned by MITRE.</li>
<li>August 15, 2023: Patch authored by Gregory P Smith, reviewed by Thomas
Wouters.</li>
<li>August 22, 2023: Patch applied to feature and security branches by
Łukasz Langa.</li>
<li>August 24, 2023: Python 3.11.5, 3.10.13, 3.9.18, 3.8.18 are published
containing the fix for CVE-2023-40217.</li>
<li>August 24, 2023: Advisory published.</li>
</ul>

    </div>

    
    <div class="attachments">
        <p class="attachments">Attachments:</p>
        <ul class="attachments-list list-unstyled">
        
            <li><a href="/archives/list/security-announce@python.org/message/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/attachment/2/attachment.html">attachment.html</a>
                (text/html &mdash; 14.6 KB)
            </li>
        
        </ul>
    </div>
    

    <div class="email-info">
      <div class="likeform-wrapper right">
        <div class="messagelink pull-right">
          <button class="toggle-font btn btn-sm"
                title="Display in fixed font"
                data-bs-toggle="tooltip" data-placement="bottom">
                <i class="fa fa-font"></i>
          </button>
          <a href="/archives/list/security-announce@python.org/message/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/"
             title="Permalink for this message"
             data-bs-toggle="tooltip" data-placement="bottom"><i class="fa fa-link"></i></a>
        </div>
        

    <form method="post" class="likeform"
          action="/archives/list/security-announce@python.org/message/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/vote">
    <input type="hidden" name="csrfmiddlewaretoken" value="b4RGXQFrr0KPs3cOyTTgayr6Lu9p2TP0uWOuYssujTJL0Na6pkc1tOmPHC5WdTzo">
    
		
			<a class="youlike vote  disabled" title="You must be logged-in to vote."
			href="#like" data-vote="1" aria-label="Like thread">
					<i class="fa fa-thumbs-o-up"></i> 0
			</a>
			<a class="youdislike vote disabled" title="You must be logged-in to vote."
			href="#dislike" data-vote="-1" aria-label="Dislike thread">
				<i class="fa fa-thumbs-o-down"></i> 0
			</a>
		
    

    </form>

        </div>

        <!-- Reply link -->
        
        
        <a class="reply reply-mailto" title="Reply" href="#">
            <i class="fa fa-reply"></i>
            Reply
        </a>
        
        

        <!-- Attachments -->
        
        <!-- Reply form -->
        
        <div class="reply-form-unauthenticated">
            <a class="btn btn-sm btn-primary" href="/accounts/login/?next=/archives/list/security-announce%40python.org/thread/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/#">
                Sign in to reply online
            </a>
            <a class="btn btn-sm btn-secondary reply-mailto"
                       href="mailto:security-announce@python.org?Subject=Re%3A%20%5BSecurity-announce%5D%5BCVE-2023-40217%5D%20Bypass%20TLS%20handshake%20on%20closed%20sockets&amp;In-Reply-To=&lt;CAADqWPTCfkbMOsDvp-2Uo%3DPvLNsdvrhxCf2J1N6YR4tW96fTiA%40mail.gmail.com&gt;"
                       >Use email software</a></li>
        </div>
        

        

    </div>

</div>

                    <!-- End first email -->

                    <p class="sort-mode">
                        
                        <a href="/archives/list/security-announce@python.org/thread/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/?sort=date"
                            >Show replies by date</a>
                        
                    </p>

                    <div class="anchor-link">
                        <a id="replies"></a>
                    </div>
                    <div class="replies">
                        
                            <img alt="Loading..." class="ajaxloader" src="/static/hyperkitty/img/ajax-loader.gif" />
                            <noscript>
                              <a href="/archives/list/security-announce@python.org/thread/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/?noscript">Visit here for a non-javascript version of this page.</a>
                            </noscript>
                        
                    </div>

                </div>
            </div>

            <div class="col-12 col-md-3">
                <div class="anchor-link">
                    <a id="stats"></a>
                </div>
                




<!-- right column -->
<section id="thread-overview-info">
    <!-- Start stats re: dates -->
    <div id="thread-date-info" class="row">
      <div class="col">
        <span class="days-num">505</span>
        <div class="days-text">
          Age (days ago)
        </div>
      </div>
      <div class="col">
        <span class="days-num">505</span>
        <div class="days-text">
          Last active (days ago)
        </div>
        </div>
    </div> <!-- /Stats re: dates -->

    <p>
        <a href="/archives/list/security-announce@python.org/" class="btn btn-outline-primary btn-sm">
            List overview
        </a>
    </p>

    

    
    <a href="/archives/list/security-announce@python.org/export/security-announce@python.org-PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY.mbox.gz?thread=PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY" title="This thread in gzipped mbox format"
          class="btn btn-outline-primary">
        <i class="fa fa-download"></i> Download</a>
    

    <p class="thread-overview-details">
    <div>
        <i class="fa fa-fw fa-comment"></i>
        0 comments
    </div>
    <div>
        <i class="fa fa-fw fa-user"></i>
        1 participants
    </div>
    
    </p>

    <form id="fav_form" name="favorite" method="post" class="favorite"
          action="/archives/list/security-announce@python.org/thread/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/favorite">
        <input type="hidden" name="csrfmiddlewaretoken" value="b4RGXQFrr0KPs3cOyTTgayr6Lu9p2TP0uWOuYssujTJL0Na6pkc1tOmPHC5WdTzo">
        <input type="hidden" name="action" value="add" />
        <p>
            <a href="#AddFav" class="notsaved disabled" title="You must be logged-in to have favorites.">
                <i class="fa fa-fw fa-star"></i>Add to favorites</a>
            <a href="#RmFav" class="saved">
                <i class="fa fa-fw fa-star"></i>Remove from favorites</a>
        </p>
    </form>

    

    <div id="tags">
        

        <h3 id="tag-title">tags </h3>
        

    </div>
    
    
    <div id="participants">
        <h3 id="participants_title">participants (1)</h3>
        <ul class="list-unstyled">
            
            <li class="d-flex">
                <div class="participant-gravatar circle"><img class="gravatar" src="https://secure.gravatar.com/avatar/b5a0900288ad3a29fd4a5ef260486055.jpg?s=48&amp;d=mm&amp;r=g" width="48" height="48" alt="" /></div>
                <div class="participant-name d-flex align-items-center">
                    <span>Seth Larson</span>
                </div>
            </li>
            
        </ul>
    </div>
    
</section>



            </div>

        </div>

</div>

<!-- end of content -->

    </div> <!-- /container for content -->

    <footer class="footer">
      <div class="container">
        <p class="text-muted">
            <img class="logo" alt="HyperKitty" src="/static/hyperkitty/img/logo.png" />
            Powered by <a href="http://hyperkitty.readthedocs.org">HyperKitty</a> version 1.3.12.
        </p>
      </div>
    </footer>

    <script src="/static/hyperkitty/libs/jquery/jquery-3.6.0.min.js"></script>
    <script src="/static/hyperkitty/libs/jquery/jquery-ui-1.13.1.min.js"></script>
    <script src="/static/CACHE/js/output.3aaa7705d68a.js"></script>
    <script>
      // Add the .js-enabled class to the body so we can style the elements
      // depending on whether Javascript is enabled.
      $(document).ready(function(){
          $("body").addClass("js-enabled");
          $(".gravatar").addClass("rounded-circle");
      });
    </script>
    

<script type="text/javascript">
    $(document).ready(function() {
        //enable tooltips for thread buttons
        $("btn#next-thread").tooltip();
        $("btn#prev-thread").tooltip();

        setup_category();
        setup_tags();
        setup_favorites();
        // Hide quotes by default in the thread view
        fold_quotes("div.container-xxl");
        // Load the replies
        update_thread_replies("/archives/list/security-announce@python.org/thread/PEPLII27KYHLF4AK3ZQGKYNCRERG4YXY/replies?sort=thread&last_view=");
        setup_unreadnavbar("#unreadnavbar");
        setup_thread_keyboard_shortcuts();
    });
</script>



    


    </body>
</html>
