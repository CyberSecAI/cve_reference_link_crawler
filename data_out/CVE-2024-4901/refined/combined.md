=== Content from gitlab.com_5fba5a73_20250111_163105.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored-XSS injected in commit notes

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2500163](https://hackerone.com/reports/2500163)** by `yvvdwf` on 2024-05-10, assigned to [@ottilia\_westerlund](/ottilia_westerlund "Ottilia Westerlund"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hello,

This [code](https://gitlab.com/gitlab-org/gitlab/blob/0b723ee8265958e643f1557cc1f619a747c0ecd1/app/assets/javascripts/deprecated_notes.js#L1382-1389) is vulnerable:

```
...
     const headerMessage = $systemNote
        .find('.note-text')
        .find('p')
        .first()
        .text()
        .replace(':', '');

      $systemNote.find('.note-header .system-note-message').html(headerMessage);
...
```

It use `text()` function to get content of a `p` element, then later inject the content by `html` function. It allows to convert `&lt;script&gt;` to `<script>` for example, thus leads to XSS

### Steps to reproduce

In gitlab.com, create a new project via `Import project`, then click `Gitlab export` button to import an exported GitLab project. Fill the form as you want and use `demo.tar.gz` in attached file to import to the new project.

[![import-project.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/59ac62ac81f26b5ece118ea910ca3e385a287f0f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65646438393034382d643632372d346365362d396632322d3462623235663935303232662f696d706f72742d70726f6a6563742e706e67)

Once the project has been successfully imported, click on `Initial commit` link to view the first commit of the project. You should see a popup alert which is caused by `alert("Hello from " + document.location)`

[![project.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/143a9966a9b8fa755522b60e4bfbe68f6eda4468/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32363135643062662d316233342d343638362d616561332d3036386336626264303661302f70726f6a6563742e706e67)

#### Impact

Stored-XSS with CSP-bypass allows attackers to execute arbitrary actions on behalf of victims at the client side.

Best regards,

yvvdwf

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [demo.tar.gz](https://h1.sec.gitlab.net/a/996a8b10-30f6-4cb2-93cd-e7544fcc95f4/demo.tar.gz)
* [project.png](https://h1.sec.gitlab.net/a/2615d0bf-1b34-4686-aea3-068c6bbd06a0/project.png)
* [import-project.png](https://h1.sec.gitlab.net/a/edd89048-d627-4ce6-9f22-4bb25f95022f/import-project.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


