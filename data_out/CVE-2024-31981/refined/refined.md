Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from the way XWiki handles PDF export templates. Specifically, it allows Velocity code within a PDF template's style property to be executed with programming rights, leading to privilege escalation. The vulnerability occurs because the PDF export process does not properly check the rights of the user providing the PDF template.

**Weaknesses/Vulnerabilities Present:**

*   **Improper Authorization:** The core issue is that the PDF export functionality does not adequately verify if the user providing the PDF template has the necessary rights to execute arbitrary code.
*   **Velocity Template Injection:** The vulnerability is exploited by injecting malicious Velocity code into the style property of a PDF template. This code is then executed during the PDF export process.
*   **Unrestricted Access:** The system fails to restrict access to the PDFClass object, which allows for its creation by a low privileged user and allows them to inject malicious code via the style property.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** Attackers can achieve remote code execution by injecting malicious Velocity code. This code can perform a variety of actions, including reading/modifying sensitive data, executing system commands and gaining full control over the application.
*   **Privilege Escalation:** A low-privileged user can gain programming rights, allowing them to perform actions that are normally restricted to administrators.
*   **Data Modification/Exfiltration:** Attackers can use the RCE to modify data, potentially leading to unauthorized data manipulation or data theft.
*   **Full System Compromise:** By executing arbitrary system commands, the attacker could potentially achieve full system compromise.

**Attack Vectors:**

*   **Network:** The vulnerability can be exploited over the network by crafting a specific PDF export request.
*   **User Registration:** If user registration is enabled, an attacker can register a new user account with the username "PDFClass", and use this account to create a PDFClass object with malicious code.
*   **PDF Export Template:** The attack vector involves crafting a PDF template (specifically, manipulating the style property of a PDFClass) with malicious Velocity code, and then triggering a PDF export using this malicious template.

**Required Attacker Capabilities/Position:**

*   **Low-Privileged User:** The attacker needs to be a low-privileged user (or create one via user registration) on the XWiki instance.
*   **Network Access:** The attacker needs to be able to make HTTP requests to the XWiki instance to trigger the PDF export functionality.

**More details than CVE description:**

* The provided content includes detailed steps to reproduce the vulnerability.
* It specifies the exact Velocity code injection to use for testing the vulnerability.
* It explains that the attack also works if an administrator has created the PDFClass.
* It highlights that the vulnerability occurs due to missing authorization checks during PDF template processing.

**Affected versions:**

The vulnerability affects XWiki versions:
* >= 3.0.1, < 14.10.19
* >= 15.0-rc-1, < 15.5.4
* >= 15.6-rc-1, < 15.9

**Patched versions:**
* 14.10.19
* 15.5.4
* 15.9

**Workarounds**
* If PDF templates are not typically used, an administrator can create the document `XWiki.PDFClass` and block its edition, after making sure that it does not contain a `style` attribute.
* Otherwise, the instance needs to be updated.

**Additional Notes:**

The fix for this vulnerability involves ensuring that the Velocity code in PDF templates is executed with the rights of the template author, not the user triggering the export. This is achieved through the `authorExecutor`.
The commit `d28e21a670c69880b951e415dd2ddd69d273eae9` addresses this issue by ensuring the `authorExecutor` is used when processing PDF templates.
The provided information also includes references to the Jira ticket (`XWIKI-21337`) and the relevant GitHub commits.