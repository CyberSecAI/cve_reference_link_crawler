

![Ruby on Rails Discussions](data:image/svg;base64...)
Loading

[Ruby on Rails Discussions](/)

# [[CVE-2023-27530] Possible DoS Vulnerability in Multipart MIME parsing](/t/cve-2023-27530-possible-dos-vulnerability-in-multipart-mime-parsing/82388)

[Security Announcements](/c/security-announcements/9)

[security](https://discuss.rubyonrails.org/tag/security),
[announcement](https://discuss.rubyonrails.org/tag/announcement)

[tenderlove](https://discuss.rubyonrails.org/u/tenderlove)
(Aaron Patterson)

March 2, 2023, 11:03pm

1

There is a possible DoS vulnerability in the Multipart MIME parsing code in
Rack. This vulnerability has been assigned the CVE identifier CVE-2023-27530.

Versions Affected: All.
Not affected: None
Fixed Versions: 3.0.4.2, 2.2.6.3, 2.1.4.3, 2.0.9.3

## Impact

The Multipart MIME parsing code in Rack limits the number of *file* parts, but
does not limit the *total* number of parts that can be uploaded. Carefully
crafted requests can abuse this and cause multipart parsing to take longer than
expected.

All users running an affected release should either upgrade or use one of the
workarounds immediately.

## Releases

The fixed releases are available at the normal locations.

## Workarounds

A proxy can be configured to limit the POST body size which will mitigate this
issue.

## Patches

To aid users who aren’t able to upgrade immediately we have provided patches for
the two supported release series. They are in git-am format and consist of a
single changeset.

* 3-0-multipart-dos.patch - Patch for the 3.0 series
* 2-2-multipart-dos.patch - Patch for the 2.2 series
* 2-1-multipart-dos.patch - Patch for the 2.1 series
* 2-0-multipart-dos.patch - Patch for the 2.0 series

## Credits

Thanks to [@das7pad](https://hackerone.com/das7pad) for reporting this!

[2-1-multipart-dos.patch](/uploads/short-url/n8aw2jFnqTftXaEkBGyWynJmgZ8.patch) (7.3 KB)
[2-2-multipart-dos.patch](/uploads/short-url/dlk1WGLasGtGeRWQsD6pOn4QX8h.patch) (7.3 KB)
[3-0-multipart-dos.patch](/uploads/short-url/usW0W9jkB9Uydt14hYNpccP89Ql.patch) (7.8 KB)
[2-0-multipart-dos.patch](/uploads/short-url/hXEQEVjo7OBaiti2GxdTL1o8zss.patch) (7.3 KB)

1 Like

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [[CVE-2022-30122] Denial of Service Vulnerability in Rack Multipart Parsing](https://discuss.rubyonrails.org/t/cve-2022-30122-denial-of-service-vulnerability-in-rack-multipart-parsing/80729)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 8313 | May 27, 2022 |
| [[CVE-2022-44572] Possible Denial of Service Vulnerability in Rack's RFC2183 boundary parsing](https://discuss.rubyonrails.org/t/cve-2022-44572-possible-denial-of-service-vulnerability-in-racks-rfc2183-boundary-parsing/82124)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 4528 | January 17, 2023 |
| [[CVE-2022-44571] Possible Denial of Service Vulnerability in Rack Content-Disposition parsing](https://discuss.rubyonrails.org/t/cve-2022-44571-possible-denial-of-service-vulnerability-in-rack-content-disposition-parsing/82126)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 6768 | January 17, 2023 |
| [[CVE-2023-27539] Possible Denial of Service Vulnerability in Rack's header parsing](https://discuss.rubyonrails.org/t/cve-2023-27539-possible-denial-of-service-vulnerability-in-racks-header-parsing/82466)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [patch](https://discuss.rubyonrails.org/tag/patch) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 6909 | March 13, 2023 |
| [Possible Denial of Service Vulnerability in Rack Header Parsing](https://discuss.rubyonrails.org/t/possible-denial-of-service-vulnerability-in-rack-header-parsing/84942)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [rack](https://discuss.rubyonrails.org/tag/rack) | 0 | 4472 | February 21, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

