

![HashiCorp Discuss](data:image/svg;base64...)
Loading

[HashiCorp Discuss](/)

# [HCSEC-2022-15 - Vault Enterprise Does Not Verify Existing Voter Status When Joining An Integrated Storage HA Node](/t/hcsec-2022-15-vault-enterprise-does-not-verify-existing-voter-status-when-joining-an-integrated-storage-ha-node/42420)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

July 26, 2022, 12:39am

1

**Bulletin ID:** HCSEC-2022-15

**Affected Products / Versions:** Vault Enterprise 1.7.0 through 1.9.7, 1.10.4, and 1.11.0; fixed in 1.9.8, 1.10.5, and 1.11.1.

**Publication Date:** July 25, 2022

**Summary**

Vault Enterprise (“Vault”) clusters using Integrated Storage expose an unauthenticated API endpoint that could be abused to override the voter status of a node within a Vault HA cluster, introducing potential for future data loss or catastrophic failure. This vulnerability, CVE-2022-36129, was fixed in Vault 1.9.8, 1.10.5, and 1.11.1.

**Background**

Vault Enterprise nodes operating in [high availability mode](https://www.vaultproject.io/docs/concepts/ha) (HA) with [Integrated Storage](https://www.vaultproject.io/docs/concepts/integrated-storage#integrated-storage) have the ability to add new nodes to the cluster. This is accomplished through the [join CLI command](https://www.vaultproject.io/docs/concepts/integrated-storage#join-from-the-cli) or its accompanying [API endpoint](https://www.vaultproject.io/api-docs/system/storage/raft#join-a-raft-cluster). Included in the API request is a parameter to change the [voter status](https://www.vaultproject.io/api-docs/system/storage/raft#non_voter-1) of the node. By design, this specific operation requires no authentication to interact with the API, but it does require the targeted node to be unsealed to complete a challenge/response with the leader node.

**Details**

It was reported that the `/sys/storage/raft/join` API endpoint was able to be called multiple times for a given node, even after a successful join. Modifying the `voter_status` parameter from `true` to `false` changed the voter status of the targeted node.

A malicious actor with access to the unauthenticated `join` API may be able to programmatically change the voter status of each node in a cluster, which may increase the operational risk of the cluster. This modification, in addition to any subsequent node failures, may lead to data loss or catastrophic failure of the high availability cluster, resulting in the cluster being inaccessible.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault Enterprise 1.9.8, 1.10.5, 1.11.1, or newer. Please refer to [Upgrading Vault](https://learn.hashicorp.com/tutorials/vault/sop-upgrade?in=vault/standard-procedures) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by a third party who reported it to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security.>*

1 Like

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-10 - Vault Enterprise Leaks Sensitive HTTP Request Headers in Audit Log When Deployed With a Performance Standby Node](https://discuss.hashicorp.com/t/hcsec-2024-10-vault-enterprise-leaks-sensitive-http-request-headers-in-audit-log-when-deployed-with-a-performance-standby-node/66553)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 3749 | April 30, 2024 |
| [HCSEC-2021-04 - Vault Enterprise’s DR Secondaries Allowed Raft Peer Removal Without Authentication](https://discuss.hashicorp.com/t/hcsec-2021-04-vault-enterprise-s-dr-secondaries-allowed-raft-peer-removal-without-authentication/20337)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7717 | January 29, 2021 |
| [HCSEC-2024-26 - Vault Vulnerable to Denial of Service Through Memory Exhaustion When Processing Raft Cluster Join Requests](https://discuss.hashicorp.com/t/hcsec-2024-26-vault-vulnerable-to-denial-of-service-through-memory-exhaustion-when-processing-raft-cluster-join-requests/71047)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 976 | October 31, 2024 |
| [HCSEC-2021-10 - Vault’s Cassandra Integrations Did Not Validate TLS Certificates](https://discuss.hashicorp.com/t/hcsec-2021-10-vault-s-cassandra-integrations-did-not-validate-tls-certificates/23463)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7481 | April 21, 2021 |
| [Vault Enterprise non-voter configuration for autoscaling appears to be ignored](https://discuss.hashicorp.com/t/vault-enterprise-non-voter-configuration-for-autoscaling-appears-to-be-ignored/29033)  [Vault](/c/vault/30) | 3 | 530 | September 2, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

