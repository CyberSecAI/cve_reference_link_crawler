

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-18430)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-18430)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-18430](/browse/XWIKI-18430)

# Page content is revealed to users that don't have rights if used as a template for the creation of another page

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-18430 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.") Critical
* **Fix Version/s:**
  [13.2-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.2-rc-1 "13.2-rc-1 "), [12.10.6](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+12.10.6 "12.10.6 ")
* **Affects Version/s:**
  1.0
* **Component/s:**
  [Old Core](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Old+Core%22 "Old Core ")
* **Labels:**
  + [attack\_dataleak](/issues/?jql=labels+%3D+attack_dataleak "attack_dataleak")
  + [attacker\_edit](/issues/?jql=labels+%3D+attacker_edit "attacker_edit")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Unit
* **Difficulty:**
  Unknown
* **Documentation:**
  <https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-gf7x-2j2x-7f73>
* **Documentation in Release Notes:**
  <https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-gf7x-2j2x-7f73>
* **Similar issues:**

#### Description

How to reproduce:

* with some admin, create a page called Sandbox.SecretPage (terminal in my example, but probably reproduces with non-terminal as well)
* put some content in it, for example "Secret content. If you see this it's bad."
* edit rights on the page, give view rights only to the admin group on the page

Switch to a regular user

* Access the Sandbox.SecretPage the page displays this:

  [![](https://jira.xwiki.org/secure/thumbnail/39000/_thumb_39000.png)](/secure/attachment/39000/39000_image-2021-03-10-23-17-13-401.png "image-2021-03-10-23-17-13-401.png")
* use a creation like URL that uses Sandbox.SecretPage as template:

  [...]/xwiki/bin/edit/Sandbox/NewPage/WebHome?template=Sandbox.SecretPage&parent=Sandbox.WebHome&title=NewPage

Expected result:

* the content of Sandbox.SecretPage is not displayed

Actual result

* the content of Sandbox.SecretPage is copied into the newly created page and displayed to the user that "uses" it as template, even if they don't have the right to see the page:

[![](https://jira.xwiki.org/secure/thumbnail/38999/_thumb_38999.png)](/secure/attachment/38999/38999_image-2021-03-10-23-25-40-106.png "image-2021-03-10-23-25-40-106.png")

If, at this point, the page is saved, the resulting page (Sandbox.NewPage) is not actually visible to the user that has just created it.

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/browse/XWIKI-18430?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/browse/XWIKI-18430?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/browse/XWIKI-18430?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/browse/XWIKI-18430?attachmentOrder=desc#attachmentmodule "Descending")
  + [Thumbnails](/browse/XWIKI-18430?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
  + [List](/browse/XWIKI-18430?attachmentViewMode=list#attachmentmodule "List")
  + [Download All](/secure/attachmentzip/65667.zip "Download all attachments as a ZIP file")

1. [![image-2021-03-10-23-17-13-401.png](https://jira.xwiki.org/secure/thumbnail/39000/_thumb_39000.png)](/secure/attachment/39000/image-2021-03-10-23-17-13-401.png "image-2021-03-10-23-17-13-401.png - Latest 10/Mar/21 23:17 - Anca Luca")[image-2021-03-10-23-17-13-401.png](/secure/attachment/39000/image-2021-03-10-23-17-13-401.png "image-2021-03-10-23-17-13-401.png - Latest 10/Mar/21 23:17 - Anca Luca")8 kB10/Mar/21 23:17
2. [![image-2021-03-10-23-25-40-106.png](https://jira.xwiki.org/secure/thumbnail/38999/_thumb_38999.png)](/secure/attachment/38999/image-2021-03-10-23-25-40-106.png "image-2021-03-10-23-25-40-106.png - Latest 10/Mar/21 23:25 - Anca Luca")[image-2021-03-10-23-25-40-106.png](/secure/attachment/38999/image-2021-03-10-23-25-40-106.png "image-2021-03-10-23-25-40-106.png - Latest 10/Mar/21 23:25 - Anca Luca")22 kB10/Mar/21 23:25
#### Issue Links

causes

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19796](/browse/XWIKI-19796)
Infinite loop on Save when creating a page from a template without rights

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[GHSA-gf7x-2j2x-7f73](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-gf7x-2j2x-7f73)

#### Activity

#### People

Assignee:

![tmortagne](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Thomas Mortagne

Reporter:

![lucaa](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Anca Luca

Votes:
0
Vote for this issue

Watchers:
2
Start watching this issue

#### Dates

Created:

10/Mar/21 23:26

Updated:

07/Jul/22 11:31

Resolved:

15/Mar/21 11:51

Date of First Response:

11/Mar/21 11:37 AM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

