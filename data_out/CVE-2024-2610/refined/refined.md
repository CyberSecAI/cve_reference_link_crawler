Based on the provided information, here's an analysis of CVE-2024-2610:

**Root Cause:**
The vulnerability stems from the improper handling of duplicate `<html>` and `<body>` tags by the HTML parser. When duplicate tags are encountered, their attributes are merged into the original (parent) elements. This merging operation bypasses the standard security checks, including the mechanism intended to hide the `nonce` attribute from CSS selectors.

**Weakness/Vulnerability:**
-   **CSP Nonce Leakage:** The `nonce` attribute, meant to be a secret value for Content Security Policy (CSP), is exposed through CSS selectors due to the attribute merging.
-   **Bypassing CSP:** By leaking the nonce, an attacker can bypass CSP, which relies on the nonce to ensure that only authorized scripts are executed.

**Impact of Exploitation:**
-   **CSP Bypass:** Successful exploitation allows an attacker to bypass the intended protection of CSP.
-   **Arbitrary Script Execution:** By bypassing CSP, an attacker can inject and execute malicious scripts on the victim's browser, which can lead to various attacks such as data theft or account hijacking.
-   **Information Disclosure:** The nonce value itself is not meant to be exposed, so its leakage can be considered information disclosure.

**Attack Vectors:**
-   **Markup Injection:** An attacker injects malicious markup before a `<script>` element that has a `nonce` attribute, including dangling `<html` or `<body` tags.
-   **CSS Injection:** An attacker uses CSS selectors to exfiltrate the nonce value once it has been merged into the parent element.

**Required Attacker Capabilities/Position:**
-   **Ability to Inject HTML:** The attacker needs to be able to inject HTML markup into a page. This can be achieved through various means, such as cross-site scripting (XSS) or other vulnerabilities that allow arbitrary HTML injection.
-   **Knowledge of the Target's CSP:** While not strictly required, it would be helpful for the attacker to have some knowledge of the target's CSP in order to craft effective attack vectors.
-   **Target User Visiting Malicious Page:** The target user needs to visit the malicious page or a page that is affected by the injection.

**Technical Details:**

The HTML parser merges attributes of duplicate `<html>` and `<body>` elements into the original elements. The fix involves modifying `nsHtml5TreeOperation::AddAttributes` to skip copying the `nonce` attribute when merging attributes, preventing the nonce from being accessible via CSS. The following code snippet shows the fix:
```cpp
    if (!node->HasAttr(nsuri, localName) &&
        !(nsuri == kNameSpaceID_None && localName == nsGkAtoms::nonce)) {
      nsString value;  // Not Auto, because using it to hold nsStringBuffer*
      aAttributes->getValueNoBoundsCheck(i).ToString(value);
      node->SetAttr(nsuri, localName, aAttributes->getPrefixNoBoundsCheck(i),
```
**Additional Notes:**
- This vulnerability affects multiple browsers, including Firefox, Chromium, and Safari.
- The fix was implemented in Firefox 124 and Firefox ESR 115.9.
-  The vulnerability is considered to have a moderate impact