

![Ruby on Rails Discussions](data:image/svg;base64...)
Loading

[Ruby on Rails Discussions](/)

# [Denial of Service Vulnerability in Rack Content-Type Parsing](/t/denial-of-service-vulnerability-in-rack-content-type-parsing/84941)

[Security Announcements](/c/security-announcements/9)

[rack](https://discuss.rubyonrails.org/tag/rack),
[announcement](https://discuss.rubyonrails.org/tag/announcement)

[tenderlove](https://discuss.rubyonrails.org/u/tenderlove)
(Aaron Patterson)

February 21, 2024, 8:30pm

1

There is a possible denial of service vulnerability in the content type parsing
component of Rack. This vulnerability has been assigned the CVE identifier
CVE-2024-25126.

Versions Affected: >= 0.4
Not affected: < 0.4
Fixed Versions: 3.0.9.1, 2.2.8.1

## Impact

Carefully crafted content type headers can cause Rack’s media type parser to
take much longer than expected, leading to a possible denial of service
vulnerability.

Impacted code will use Rack’s media type parser to parse content type headers.
This code will look like below:

```
request.media_type

## OR
request.media_type_params

## OR
Rack::MediaType.type(content_type)

```

Some frameworks (including Rails) call this code internally, so upgrading is
recommended!

All users running an affected release should either upgrade or use one of the
workarounds immediately.

## Releases

The fixed releases are available at the normal locations.

## Workarounds

There are no feasible workarounds for this issue.

## Patches

To aid users who aren’t able to upgrade immediately we have provided patches for
the two supported release series. They are in git-am format and consist of a
single changeset.

* 3-0-media-type.patch - Patch for 3.0 series
* 2-2-media-type.patch - Patch for 2.2 series

## Credits

Thanks to [@byroot](/u/byroot) and [@jeremyevans](/u/jeremyevans) for the patch, also thank you to [svalkanov](https://github.com/svalkanov) for reporting this issue!

[2-2-media-type.patch](/uploads/short-url/l8JDNKiIf94ttPuOGQMxHIujY3K.patch) (1.6 KB)
[3-0-media-type.patch](/uploads/short-url/4YqhCH8sLzJMf7yjlvnmkk6lNCv.patch) (1.6 KB)

2 Likes

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [[CVE-2022-44571] Possible Denial of Service Vulnerability in Rack Content-Disposition parsing](https://discuss.rubyonrails.org/t/cve-2022-44571-possible-denial-of-service-vulnerability-in-rack-content-disposition-parsing/82126)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 6768 | January 17, 2023 |
| [[CVE-2023-27539] Possible Denial of Service Vulnerability in Rack's header parsing](https://discuss.rubyonrails.org/t/cve-2023-27539-possible-denial-of-service-vulnerability-in-racks-header-parsing/82466)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [patch](https://discuss.rubyonrails.org/tag/patch) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 6909 | March 13, 2023 |
| [Possible Denial of Service Vulnerability in Rack Header Parsing](https://discuss.rubyonrails.org/t/possible-denial-of-service-vulnerability-in-rack-header-parsing/84942)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [rack](https://discuss.rubyonrails.org/tag/rack) | 0 | 4472 | February 21, 2024 |
| [[CVE-2022-30122] Denial of Service Vulnerability in Rack Multipart Parsing](https://discuss.rubyonrails.org/t/cve-2022-30122-denial-of-service-vulnerability-in-rack-multipart-parsing/80729)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 8313 | May 27, 2022 |
| [[CVE-2022-44572] Possible Denial of Service Vulnerability in Rack's RFC2183 boundary parsing](https://discuss.rubyonrails.org/t/cve-2022-44572-possible-denial-of-service-vulnerability-in-racks-rfc2183-boundary-parsing/82124)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 4528 | January 17, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

