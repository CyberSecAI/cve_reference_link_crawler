 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Remote Code Execution (RCE) through an external lookup due to “copybuckets.py“ script in the “splunk\_archiver“ application in Splunk Enterprise

**Advisory ID:** SVD-2024-0705

**CVE ID:** [CVE-2024-36985](https://www.cve.org/CVERecord?id=CVE-2024-36985)

**Published:** 2024-07-01

**Last Update:** 2024-07-01

**CVSSv3.1 Score:** 8.8, High

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**CWE:** [CWE-687](https://cwe.mitre.org/data/definitions/687.html)

**Bug ID:** VULN-8937

## Description

In Splunk Enterprise versions below 9.0.10, 9.1.5, and 9.2.2, a low-privileged user that does not hold the “admin“ or “power“ Splunk roles could cause a Remote Code Execution through an external lookup that likely references the “splunk\_archiver“ application.

The “splunk\_archiver“ application likely contains a script called “copybuckets.py“ that itself references a file called “erp\_launcher.py“, which would likely execute a script called “sudobash“.

The “sudobash“ script does not perform any input checking. Therefore it runs a bash shell with arguments supplied by the “erp\_launcher.py“ file. This can lead to an RCE.

## Solution

Upgrade Splunk Enterprise to versions 9.2.2, 9.1.5, and 9.0.10, or higher.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 9.2 | splunk\_archiver | 9.2.0 to 9.2.1 | 9.2.2 |
| Splunk Enterprise | 9.1 | splunk\_archiver | 9.1.0 to 9.1.4 | 9.1.5 |
| Splunk Enterprise | 9.0 | splunk\_archiver | 9.0.0 to 9.0.9 | 9.0.10 |

## Mitigations and Workarounds

Disable the “splunk\_archiver“ application

## Detections

* [Splunk RCE via external lookup copybuckets](https://research.splunk.com/application/8598f9de-bba8-42a4-8ef0-12e1adda4131)

## Severity

Splunk rates this vulnerability as 8.8, High, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H.

If the Splunk Enterprise instance disabled splunk\_archiver, there is no impact and the severity is Informational.

## Acknowledgments

Alex Hordijk

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)