

[HashiCorp Discuss](/)

# [HCSEC-2023-30 - Vault’s Google Cloud Secrets Engine Removed Existing IAM Conditions When Creating / Updating Rolesets](/t/hcsec-2023-30-vault-s-google-cloud-secrets-engine-removed-existing-iam-conditions-when-creating-updating-rolesets/58654)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

September 28, 2023, 11:12pm

1

**Bulletin ID:** HCSEC-2023-30

**Affected Products / Versions:** Vault and Vault Enterprise since 0.10; fixed in 1.13.0.

**Publication Date:** September 28, 2023

**Summary**

The Vault and Vault Enterprise (“Vault”) Google Cloud secrets engine did not preserve existing Google Cloud IAM Conditions upon creating or updating rolesets. This vulnerability, CVE-2023-5077, was fixed in Vault 1.13.0.

*For this retroactive bulletin, the Vault 1.13 fix for this issue has already been inherited by Vault 1.14 and 1.15 releases.*

**Background**

The [Google Cloud secrets engine](https://developer.hashicorp.com/vault/docs/secrets/gcp) allows Vault to provision dynamic IAM credentials for accessing Google Cloud environments.

Google Cloud [IAM Conditions](https://cloud.google.com/iam/docs/conditions-overview) allow an operator to define conditions to grant access to resources.

A [roleset](https://developer.hashicorp.com/vault/docs/secrets/gcp#rolesets) consists of a Vault managed Google Cloud service account along with a set of IAM bindings, possibly including IAM conditions, defined for that service account.

**Details**

It was discovered that when creating or updating a roleset, Vault did not copy existing conditions to the newly-created IAM policy binding object, resulting in existing IAM conditions no longer being enforced for that roleset.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault 1.13.0, or newer. Please refer to [Upgrading Vault](https://learn.hashicorp.com/tutorials/vault/sop-upgrade?in=vault/standard-procedures) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by a third party who [reported it](https://github.com/hashicorp/vault-plugin-secrets-gcp/issues/113) and [provided a fix](https://github.com/hashicorp/vault-plugin-secrets-gcp/pull/114) to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2021-28 - Vault's Google Cloud Secrets Engine Policies With Globs May Provide Additional Privileges in Vault 1.8.0 Onwards](https://discuss.hashicorp.com/t/hcsec-2021-28-vaults-google-cloud-secrets-engine-policies-with-globs-may-provide-additional-privileges-in-vault-1-8-0-onwards/30422)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7265 | October 7, 2021 |
| [HCSEC-2020-17 - Vault’s GCP Auth Method Allows Authentication Bypass](https://discuss.hashicorp.com/t/hcsec-2020-17-vault-s-gcp-auth-method-allows-authentication-bypass/18102)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4196 | November 25, 2020 |
| [HCSEC-2020-09 - Vault's GCP Secrets Engine Service Account Keys Not Enforcing Configured TTL](https://discuss.hashicorp.com/t/hcsec-2020-09-vaults-gcp-secrets-engine-service-account-keys-not-enforcing-configured-ttl/18092)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4098 | November 25, 2020 |
| [HCSEC-2022-15 - Vault Enterprise Does Not Verify Existing Voter Status When Joining An Integrated Storage HA Node](https://discuss.hashicorp.com/t/hcsec-2022-15-vault-enterprise-does-not-verify-existing-voter-status-when-joining-an-integrated-storage-ha-node/42420)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 8249 | July 26, 2022 |
| [HCSEC-2022-09 - Vault PKI Secrets Engine Policy Results In Incorrect Wildcard Certificate Issuance](https://discuss.hashicorp.com/t/hcsec-2022-09-vault-pki-secrets-engine-policy-results-in-incorrect-wildcard-certificate-issuance/36600)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7874 | March 4, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

