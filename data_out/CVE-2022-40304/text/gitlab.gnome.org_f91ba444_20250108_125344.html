

[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

**Commit
1b41ec4e**

authored
Aug 31, 2022
by
**[![Nick Wellnhofer's avatar](https://secure.gravatar.com/avatar/bd619578e916998bef4460286dbe97b828d8801a7bb53544d8abcb80d50fcfb8?s=96&d=identicon "Nick Wellnhofer")](/nwellnhof)
[Nick Wellnhofer](/nwellnhof)**

[Browse files](/GNOME/libxml2/-/tree/1b41ec4e9433b05bb0376be4725804c54ef1d80b)

### [CVE-2022-40304] Fix dict corruption caused by entity reference cycles

```

When an entity reference cycle is detected, the entity content is
cleared by setting its first byte to zero. But the entity content might
be allocated from a dict. In this case, the dict entry becomes corrupted
leading to all kinds of logic errors, including memory errors like
double-frees.

Stop storing entity content, orig, ExternalID and SystemID in a dict.
These values are unlikely to occur multiple times in a document, so they
shouldn't have been stored in a dict in the first place.

Thanks to Ned Williamson and Nathan Wachholz working with Google Project
Zero for the report!
```

parent
[c8469863](/GNOME/libxml2/-/commit/c846986356fc149915a74972bf198abc266bc2c0)

Loading

Loading

Loading

* [Changes
  1](/GNOME/libxml2/-/commit/1b41ec4e9433b05bb0376be4725804c54ef1d80b)

[Hide whitespace changes](/GNOME/libxml2/-/commit/1b41ec4e9433b05bb0376be4725804c54ef1d80b?action=show&controller=projects%2Fcommit&id=1b41ec4e9433b05bb0376be4725804c54ef1d80b&namespace_id=GNOME&project_id=libxml2&w=1)
[Inline](/GNOME/libxml2/-/commit/1b41ec4e9433b05bb0376be4725804c54ef1d80b?view=inline)
[Side-by-side](/GNOME/libxml2/-/commit/1b41ec4e9433b05bb0376be4725804c54ef1d80b?view=parallel)

Loading

* [Nick Wellnhofer](/nwellnhof)
  @nwellnhof

  mentioned in issue [#401 (closed)](/GNOME/libxml2/-/issues/401 "[CVE-2022-40304] Double-free when parsing default attributes")

  ·

  [Oct 14, 2022](#note_1574135)

  mentioned in issue [#401 (closed)](/GNOME/libxml2/-/issues/401 "[CVE-2022-40304] Double-free when parsing default attributes")

  mentioned in issue #401

  Toggle commit list
* [Alan Coopersmith](/alanc)
  @alanc

  mentioned in issue [Teams/Releng/security#145 (closed)](/Teams/Releng/security/-/issues/145 "CVE ids to be added on wiki page")

  ·

  [Nov 13, 2024](#note_2273889)

  mentioned in issue [Teams/Releng/security#145 (closed)](/Teams/Releng/security/-/issues/145 "CVE ids to be added on wiki page")

  mentioned in issue Teams/Releng/security#145

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment

