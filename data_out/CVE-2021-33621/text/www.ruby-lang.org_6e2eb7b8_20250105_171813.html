
[# Ruby

## A Programmer's Best Friend](/en/)
[Home](/en/)
[Downloads](/en/downloads/)
[Documentation](/en/documentation/)
[Libraries](/en/libraries/)
[Community](/en/community/)
[News](/en/news/)
[Security](/en/security/)
[About Ruby](/en/about/)
Menu

|  |  |
| --- | --- |

# CVE-2021-33621: HTTP response splitting in CGI

Posted by mame on 22 Nov 2022

We have released the cgi gem version 0.3.5, 0.2.2, and 0.1.0.2 that has a security fix for a HTTP response splitting vulnerability.
This vulnerability has been assigned the CVE identifier [CVE-2021-33621](https://www.cve.org/CVERecord?id=CVE-2021-33621).

## Details

If an application that generates HTTP responses using the cgi gem with untrusted user input, an attacker can exploit it to inject a malicious HTTP response header and/or body.

Also, the contents for a `CGI::Cookie` object were not checked properly. If an application creates a `CGI::Cookie` object based on user input, an attacker may exploit it to inject invalid attributes in `Set-Cookie` header. We think such applications are unlikely, but we have included a change to check arguments for `CGI::Cookie#initialize` preventatively.

Please update the cgi gem to version 0.3.5, 0.2.2, and 0.1.0.2, or later. You can use `gem update cgi` to update it.
If you are using bundler, please add `gem "cgi", ">= 0.3.5"` to your `Gemfile`.

## Affected versions

* cgi gem 0.3.3 or before
* cgi gem 0.2.1 or before
* cgi gem 0.1.1 or 0.1.0.1 or 0.1.0

## Credits

Thanks to [Hiroshi Tokumaru](https://hackerone.com/htokumaru?type=user) for discovering this issue.

## History

* Originally published at 2022-11-22 02:00:00 (UTC)

---

### **Recent News**

* [Ruby 3.4.1 Released](/en/news/2024/12/25/ruby-3-4-1-released/)
* [Ruby 3.4.0 Released](/en/news/2024/12/25/ruby-3-4-0-released/)
* [Ruby 3.4.0 rc1 Released](/en/news/2024/12/12/ruby-3-4-0-rc1-released/)
* [Ruby 3.3.6 Released](/en/news/2024/11/05/ruby-3-3-6-released/)
* [Ruby 3.2.6 Released](/en/news/2024/10/30/ruby-3-2-6-released/)
### Syndicate

[Recent News (RSS)](/en/feeds/news.rss)

---

[Home](/en/)
[Downloads](/en/downloads/)
[Documentation](/en/documentation/)
[Libraries](/en/libraries/)
[Community](/en/community/)
[News](/en/news/)
[Security](/en/security/)
[About Ruby](/en/about/)

This site in other languages:
[Български](/bg/),
[Deutsch](/de/),
[English](/en/),
[Español](/es/),
[Français](/fr/),
[Bahasa Indonesia](/id/),
[Italiano](/it/),
[日本語](/ja/),
[한국어](/ko/),
[polski](/pl/),
[Português](/pt/),
[Русский](/ru/),
[Türkçe](/tr/),
[Tiếng Việt](/vi/),
[简体中文](/zh_cn/),
[繁體中文](/zh_tw/).

[This website](/en/about/website/) is proudly maintained by members of the Ruby community.

