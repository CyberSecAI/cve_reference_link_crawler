The provided content is related to the vulnerability described in CVE-2022-48781.

**Root cause of vulnerability:**
The `alg_memory_allocated` field in the `alg_proto` structure within the `crypto/af_alg.c` file was not correctly used, leading to a NULL pointer dereference. Specifically, while `alg_proto` had a `.memory_allocated` field, it lacked a corresponding `.sysctl_mem`, resulting in `sk_has_account()` returning true, and subsequent calls to `sk_prot_mem_limits()` resulting in a NULL dereference. This issue was triggered by the introduction of the `SO_RESERVE_MEM` socket option.

**Weaknesses/vulnerabilities present:**
- NULL pointer dereference: The lack of a corresponding `.sysctl_mem` for the `.memory_allocated` field in `alg_proto` caused a NULL pointer dereference when `sk_prot_mem_limits()` was called, specifically when `SO_RESERVE_MEM` was used.

**Impact of exploitation:**
- Kernel crash: The NULL pointer dereference resulted in a general protection fault, causing a kernel crash.

**Attack vectors:**
- The vulnerability can be triggered through the `setsockopt` syscall with the `SO_RESERVE_MEM` option on an AF_ALG socket.

**Required attacker capabilities/position:**
- The attacker needs the ability to create an AF_ALG socket and call the `setsockopt` syscall with the `SO_RESERVE_MEM` option.

**Additional notes:**
- The fix removes the `alg_memory_allocated` and the corresponding `.memory_allocated` field from `alg_proto` in `crypto/af_alg.c` file.
- The issue was reported by syzbot.
- The crash occurred in the `sock_reserve_memory` function.
- The fix was introduced in commit `25206111512de994dfc914f5b2972a22aa904ef3` and `9d06f489b9e901580159e21fdc29f73df7ed08dc`.