
![](/staticassets/4.7.2/dist/common/images/media-viewer-image-icon.svg)
##

![]()

Products
[# Bitbucket Support](https://support.atlassian.com/bitbucket/)

* [Documentation](/display/BitbucketServer/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [Knowledge base](/display/BitbucketServerKB/Bitbucket%2BData%2BCenter%2Band%2BServer%2BKnowledge%2BBase)
* Resources

* [Search](https://support.atlassian.com/search-results/)
* [Log in](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/bitbucketserver/bitbucket-server-and-data-center-security-advisory-2022-11-16-1180141667.html)
* ![]()
  + [View account](https://my.atlassian.com/)
  + [View requests](https://support.atlassian.com/servicedesk/customer/user/requests)
  + [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/bitbucketserver/bitbucket-server-and-data-center-security-advisory-2022-11-16-1180141667.html)
* ...

## [Knowledge base](/display/BitbucketServerKB/Bitbucket%2BData%2BCenter%2Band%2BServer%2BKnowledge%2BBase)

## Products

* [### Jira Software

  Project and issue tracking](https://support.atlassian.com/jira-software-cloud)
* [### Jira Service Management

  Service management and customer support](https://support.atlassian.com/jira-service-management-cloud)
* [### Jira Work Management

  Manage any business project](https://support.atlassian.com/jira-work-management)
* [### Confluence

  Document collaboration](https://support.atlassian.com/confluence-cloud)
* [### Bitbucket

  Git code management](https://support.atlassian.com/bitbucket-cloud)

[See all](https://support.atlassian.com/products/)

## Resources

* [### Documentation

  Usage and admin help](/display/BitbucketServer/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [### Community

  Answers, support, and inspiration](https://community.atlassian.com/t5/Bitbucket/ct-p/bitbucket)
* [### Suggestions and bugs

  Feature suggestions and bug reports](https://jira.atlassian.com/secure/Dashboard.jspa)
* [### Marketplace

  Product apps](https://marketplace.atlassian.com/search?hosting=server&product=bitbucket)
* [### Billing and licensing

  Frequently asked questions](https://www.atlassian.com/licensing/bitbucket-server)

* [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/bitbucketserver/bitbucket-server-and-data-center-security-advisory-2022-11-16-1180141667.html)
* [Log in to account](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/bitbucketserver/bitbucket-server-and-data-center-security-advisory-2022-11-16-1180141667.html)
* [Contact support](https://support.atlassian.com/contact/)
* [Training & Certification](https://www.atlassian.com/university)
* [Cloud Migration Center](https://www.atlassian.com/cloud-migration)
* [GDPR guides](https://confluence.atlassian.com/gdpr)
* [Enterprise services](https://www.atlassian.com/enterprise/services)
* [Atlassian partners](https://www.atlassian.com/partners)
* [Developers](https://developer.atlassian.com/)
* [User groups](http://aug.atlassian.com/)
* [Automation for Jira](https://confluence.atlassian.com/automation/)
* [Atlassian.com](http://www.atlassian.com/)

* #### Page
* [View in Confluence](/login.action?os_destination=%2Fpages%2Fviewpage.action%3FpageId%3D1180141667)
* [Edit Page](/login.action?os_destination=https%3A%2F%2Fconfluence.atlassian.com%2Fpages%2Feditpage.action%3FpageId%3D1180141667%26atl_token%3D25c4426e6fff9435ba4d55056962f6258003cec2)
* #### Viewport
* [Manage Viewport](/login.action?os_destination=%2Fspaces%2Fscroll-viewport%2Fconfig.action%3Fkey%3DBitbucketServer)
* #### Confluence
* [Dashboard](/login.action?os_destination=%2Fdashboard.action)
* [Space Directory](/login.action?os_destination=%2Fspacedirectory%2Fview.action)
* [People Directory](/login.action?os_destination=%2Fpeopledirectory.action)

![](/staticassets/4.7.2/dist/common/images/product-icons/bitbucket.svg)

[Bitbucket Data Center 9.5 (Latest)](/display/BitbucketServer/Bitbucket%2BData%2BCenter%2Bdocumentation)

Documentation

Unable to load

* [Atlassian Support](https://support.atlassian.com/ "Atlassian Support")
* [Bitbucket 9.5](https://support.atlassian.com/bitbucket/ "Bitbucket")
* [Documentation](/display/BitbucketServer/Bitbucket%2BData%2BCenter%2Bdocumentation "Bitbucket Data Center 9.5 (Latest)")
* [Release notes](/bitbucketserver/release-notes-872139866.html "Release notes")
* [Bitbucket Server security advisories](/bitbucketserver/bitbucket-server-security-advisories-776640597.html "Bitbucket Server security advisories")
* [Bitbucket Server and Data Center Security Advisory 2022-11-16](/bitbucketserver/bitbucket-server-and-data-center-security-advisory-2022-11-16-1180141667.html "Bitbucket Server and Data Center Security Advisory 2022-11-16")

[Cloud](/display/BITBUCKET/Bitbucket%2BCloud%2Bdocumentation)
Data Center 9.5
###### Versions

* 9.5
* [9.4](/display/BITBUCKETSERVER094/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [9.3](/display/BITBUCKETSERVER093/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [9.2](/display/BITBUCKETSERVER092/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [9.1](/display/BITBUCKETSERVER091/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [9.0](/display/BITBUCKETSERVER090/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [8.19](/display/BITBUCKETSERVER0819/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [8.18](/display/BITBUCKETSERVER0818/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [8.17](/display/BITBUCKETSERVER0817/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [8.16](/display/BITBUCKETSERVER0816/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [8.15](/display/BITBUCKETSERVER0815/Bitbucket%2BData%2BCenter%2Bdocumentation)
* [8.14](/display/BITBUCKETSERVER0814/Bitbucket%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.13](/display/BITBUCKETSERVER0813/Bitbucket%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.12](/display/BITBUCKETSERVER0812/Bitbucket%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.11](/display/BITBUCKETSERVER0811/Bitbucket%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.10](/display/BITBUCKETSERVER0810/Bitbucket%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.9](/display/BITBUCKETSERVER089/Bitbucket%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.8](/display/BITBUCKETSERVER088/Bitbucket%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [8.7](/display/BITBUCKETSERVER087/Bitbucket%2BData%2BCenter%2Band%2BServer%2Bdocumentation)
* [See all](/display/ALLDOC/Applications%2Band%2BTools%2BDocumentation%2BDirectory)

# Bitbucket Server and Data Center Security Advisory 2022-11-16

#### Bitbucket Server security advisories

* [Stash security advisory 2012-09-04](/bitbucketserver/stash-security-advisory-2012-09-04-776640598.html)
* [Stash security advisory 2014-02-26](/bitbucketserver/stash-security-advisory-2014-02-26-776640599.html)
* [Bitbucket Server security advisory 2016-09-21](/bitbucketserver/bitbucket-server-security-advisory-2016-09-21-840698321.html)
* [Bitbucket Server security advisory 2017-01-24](/bitbucketserver/bitbucket-server-security-advisory-2017-01-24-872255334.html)
* [Bitbucket Server security advisory 2018-03-21](/bitbucketserver/bitbucket-server-security-advisory-2018-03-21-946627549.html)
* [Bitbucket Data Center Security Advisory 2019-05-22](/bitbucketserver/bitbucket-data-center-security-advisory-2019-05-22-969526871.html)
* [Bitbucket Server security advisory 2019-09-18](/bitbucketserver/bitbucket-server-security-advisory-2019-09-18-976762635.html)
* [Bitbucket Server Security Advisory 2020-01-15](/bitbucketserver/bitbucket-server-security-advisory-2020-01-15-985498238.html)
* [Multiple Products Security Advisory - Unrendered unicode bidirectional override characters - CVE-2021-42574 - 2021-11-01](/bitbucketserver/multiple-products-security-advisory-unrendered-unicode-bidirectional-override-characters-cve-2021-42574-2021-11-01-1095762261.html)
* [Multiple Products Security Advisory - Log4j Vulnerable To Remote Code Execution - CVE-2021-44228](/bitbucketserver/multiple-products-security-advisory-log4j-vulnerable-to-remote-code-execution-cve-2021-44228-1115677322.html)
* [Multiple Products Security Advisory - Hazelcast Vulnerable To Remote Code Execution - CVE-2016-10750](/bitbucketserver/multiple-products-security-advisory-hazelcast-vulnerable-to-remote-code-execution-cve-2016-10750-1115678753.html)
* [Bitbucket Server and Data Center Advisory 2022-08-24](/bitbucketserver/bitbucket-server-and-data-center-advisory-2022-08-24-1155489835.html)
* [Bitbucket Server and Data Center Security Advisory 2022-11-16](/bitbucketserver/bitbucket-server-and-data-center-security-advisory-2022-11-16-1180141667.html)

#### On this page

#### Related content

* No related content found

#### Still need help?

The Atlassian Community is here for you.

[Ask the community](https://community.atlassian.com/t5/custom/page/page-id/create-post-step-1?add-tags=Bitbucket)

## Bitbucket Server and Data Center- Command Injection Vulnerability - CVE-2022-43781

| Summary | CVE-2022-43781 - Command Injection Vulnerability |
| --- | --- |
| Advisory Release Date | 16 Nov 2022 10 AM PDT (Pacific Time, -7 hours) |
| Product | * Bitbucket Server * Bitbucket Data Center |
| CVE ID(s) | CVE-2022-43781 |

### **Summary of Vulnerability**

This advisory discloses a critical severity security vulnerability introduced in version 7.0.0 of Bitbucket Server and Data Center. The following versions are affected by this vulnerability:

* Bitbucket Data Center and Server 7.0 to 7.21
* Bitbucket Data Center and Server 8.0 to 8.4 if mesh.enabled is set to false in bitbucket.properties

There is a command injection vulnerability using environment variables in Bitbucket Server and Data Center. An attacker with permission to control their username can exploit this issue to gain code execution and execute code on the system.

This issue can be tracked here:
[BSERV-13522](https://jira.atlassian.com/browse/BSERV-13522)
-
Getting issue details...
STATUS

| **Atlassian Cloud sites are not affected.**  If you access Bitbucket via a [bitbucket.org](http://bitbucket.org) domain, it is hosted by Atlassian and you are not affected by the vulnerability. |
| --- |

### **Severity**

Atlassian rates the severity level of this vulnerability as **critical**, according to the scale published in [our Atlassian severity levels](https://www.atlassian.com/security/security-severity-levels). The scale allows us to rank the severity as critical, high, moderate or low.

This is our assessment and you should evaluate its applicability to your own IT environment.

### **Affected Versions**

All versions of Bitbucket Server and Data Center from 7.0 to 7.21 are affected by this vulnerability. Versions 8.0 to 8.4 of Bitbucket Server and Data Center are also affected by this vulnerability if mesh.enabled=false is set in bitbucket.properties.

| **Product** | **Affected Versions** |
| --- | --- |
| Bitbucket Server and Data Center | * 7.0 to 7.5 (all versions) * 7.6.0 to 7.6.18 * 7.7 to 7.16 (all versions) * 7.17.0 to 7.17.11 * 7.18 to 7.20 (all versions) * 7.21.0 to 7.21.5   If mesh.enabled=false is set in bitbucket.properties:   * 8.0.0 to 8.0.4 * 8.1.0 to 8.1.4 * 8.2.0 to 8.2.3 * 8.3.0 to 8.3.2 * 8.4.0 to 8.4.1 |

### **Fixed Versions**

| **Product** | **Fixed Versions** |
| --- | --- |
| Bitbucket Server and Data Center | * 7.6.19 or newer * 7.17.12 or newer * 7.21.6 or newer * 8.0.5 or newer * 8.1.5 or newer * 8.2.4 or newer * 8.3.3 or newer * 8.4.2 or newer * 8.5.0 or newer |

### **What You Need to Do**

Atlassian recommends that you upgrade each of your affected installations to one of the listed fixed versions (or any later version) above (see the “Fixed Versions” section of this page for details). For a full description of the latest version of Bitbucket Server and Data Center, see the [release notes](https://confluence.atlassian.com/bitbucketserver/release-notes-872139866.html). You can download the latest version of Bitbucket from the [download center.](https://www.atlassian.com/software/bitbucket/download-archives) For Frequently Asked Questions (FAQ) [click here.](https://confluence.atlassian.com/x/5XmaRQ)

#### **Mitigation**

To remediate this vulnerability, update each affected product installation to a fixed version listed above.

If you’re unable to upgrade your Bitbucket instance, a temporary mitigation step is to disable “Public Signup”. Disabling public signup would change the attack vector from an unauthenticated attack to an authenticated one which would reduce the risk of exploitation. To disable this setting, go to **Administration > Authentication** and clear the **Allow public sign up** checkbox.

ADMIN or SYS\_ADMIN authenticated users still have the ability to exploit the vulnerability when public signup is disabled. For this reason, this mitigation should be treated as a temporary step and customers are recommended to upgrade to a fixed version as soon as possible.

Bitbucket Server and Data Center instances running PostgreSQL are **not affected by the vulnerability**.

### **Acknowledgements**

Information that led to the discovery of this vulnerability was provided by [@Ry0taK](https://github.com/Ry0taK).

### **Support**

If you did not receive an email for this advisory and you wish to receive such emails in the future go to <https://my.atlassian.com/email> and subscribe to Alerts emails.

If you have questions or concerns regarding this advisory, please raise a support request at <https://support.atlassian.com/>.

### **References**

| [Security Bug fix Policy](https://www.atlassian.com/trust/security/bug-fix-policy) | As per our new policy critical security bug fixes will be back ported in accordance with <https://www.atlassian.com/trust/security/bug-fix-policy>.  We will release new maintenance releases for the versions covered by the policy instead of binary patches.  **Binary patches are no longer released.** |
| --- | --- |
| [Severity Levels for security issues](https://www.atlassian.com/security/security-severity-levels) | Atlassian security advisories include a severity level and a CVE identifier. This severity level is based on our self-calculated CVSS score for each specific vulnerability. CVSS is an industry standard vulnerability metric. You can also learn more about CVSS at [FIRST.org](https://www.first.org/cvss/user-guide). |
| [End of Life Policy](/support/atlassian-support-end-of-life-policy-201851003.html) | Our end of life policy varies for different products. Please refer to our EOL Policy for details. |

Last modified on Dec 2, 2022

Was this helpful?

Yes
No
 It wasn't accurate

 It wasn't clear

 It wasn't relevant

Provide feedback about this article

#### Related content

* No related content found

Powered by [Confluence](http://www.atlassian.com/) and [Scroll Viewport](https://www.k15t.com/go/scroll-viewport).

[Atlassian](https://www.atlassian.com/)

* [Notice at Collection](https://www.atlassian.com/legal/privacy-policy#additional-disclosures-for-ca-residents)
* [Privacy Policy](https://www.atlassian.com/legal/privacy-policy)
* [Terms of Use](https://www.atlassian.com/legal/customer-agreement)
* [Security](https://www.atlassian.com/trust/security)
* ©  Atlassian

