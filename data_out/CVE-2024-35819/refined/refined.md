```
{
  "vulnerability": {
    "root_cause": "The `cgr_lock` spinlock was not a raw spinlock, which caused issues when the smp_call_function callback was invoked in hard IRQ context where a regular spinlock can sleep. This situation is problematic under PREEMPT_RT.",
    "weaknesses": [
      "Incorrect use of spinlock in hard IRQ context.",
      "Potential for deadlock due to sleeping in a critical section."
    ],
    "impact": "The use of a regular spinlock instead of a raw spinlock can lead to a deadlock condition, because the smp_call_function can be invoked in a hard IRQ context, where a normal spinlock can sleep. This would stop the system from responding. The issue became apparent after commit ef2a8d5478b9 introduced more frequent usage of `smp_call_function_single` via `qman_update_cgr_safe`.",
    "attack_vectors": [
      "Triggering network link up/down events which would call `qman_update_cgr_safe` which uses smp_call_function_single which uses the non-raw spinlock."
    ],
     "required_attacker_capabilities": "The attacker needs to be able to trigger link up or down events on network devices which would trigger the vulnerable code path. This could be done via physical access to network interfaces or through a network management interface."
  },
  "affected_component": "drivers/soc/fsl/qbman/qman.c"
}
```