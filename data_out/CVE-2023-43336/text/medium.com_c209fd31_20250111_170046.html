[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4429d416f826&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40janirudransh%2Fsecurity-disclosure-of-vulnerability-cve-2023-23336-4429d416f826&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40janirudransh%2Fsecurity-disclosure-of-vulnerability-cve-2023-23336-4429d416f826&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Security Disclosure of Vulnerability : CVE-2023–43336

[![Janirudransh](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*tjabe5QDp2CMAH46)](/%40janirudransh?source=post_page---byline--4429d416f826--------------------------------)

[Janirudransh](/%40janirudransh?source=post_page---byline--4429d416f826--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8bd83b5257b4&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40janirudransh%2Fsecurity-disclosure-of-vulnerability-cve-2023-23336-4429d416f826&user=Janirudransh&userId=8bd83b5257b4&source=post_page-8bd83b5257b4--byline--4429d416f826---------------------post_header-----------)

3 min read·Sep 28, 2023

--

Listen

Share

**Disclosure Summary**

FreePBX version 16.0.26 is vulnerable to privilege escalation. An authenticated least privilege user is able to view details of other user which may include call recordings and other details.

![]()

**Description**Privilege escalation vulnerabilities allow attackers to impersonate other users, or gain permissions they should not have. These vulnerabilities occur when code makes access decisions on the back of untrusted inputs.
Many websites hold sensitive data on behalf of their users. If an attacker can exploit horizontal escalation vulnerabilities to gain access to another user’s data, you are betraying your users’ trust, which can have reputational, legal, and financial implications.
If an attacker can exploit vertical escalation vulnerabilities to gain
administrative access, they can interrupt critical functions and possibly
compromise your application.

**Version We Tested On:** 16.0.26

![]()

**Proof Of Concept:**

**Step 1**: Login to <https://example.com/ucp> with non-admin user who has access to “Call History” module. Add “Call History” widget to dashboard.

![]()

**Step 2**: Upon adding the widget, several request got triggered. Following is one of the request that got triggered which fetches call history data.

![]()

**Step 3**: Observe that we are able access the module.

![]()

**Step 4**: Now login with admin user and navigate to “User Management”.
Disable the access of “Call History” module.

![]()

**Step 5**: Again login to <https://example.com/ucp> as non-admin user and observe that user don't have access to “Call History” module.

![]()

**Step 6**: Using the previously captured request of “Call History” having current session(non-admin user), send the request to server and observe that we are able to access the “Call History” module.

Here we were able to access the non-accessible module which is a bypass

![]()

**Step 7**: Using the previously captured request of “Call History”, change the
value of parameter “extension” from “self” to “101” or any existing
extension number. Send the modified request and observe that we are able to fetch call history of other extensions to which we don't have access to.

![]()

**Instances**
1) <https://example.com/ucp/ajax.php>?module=cdr&command=grid&extension=self&sort=timestamp&order=desc&offset=0&limit=10&\_=1681287486402

2) <https://example.com/ucp/ajax.php>?module=cel&command=grid&extension=self&sort=timestamp&order=desc&offset=0&limit=10&\_=1681287486402

**Fixed Versions**

1. Module cdr: 15.0.18, 16.0.40
2. Module cel : 15.0.16, 16.0.17

Fixed versions are available via the FreePBX and PBXact mirror servers since August 24, 2023

**References**
1) <https://portswigger.net/web-security/access-control>
2) <https://www.cynet.com/network-attacks/privilege-escalation/>
3) [https://www.hacksplaining.com/prevention/privilege](https://www.hacksplaining.com/prevention/privilege-)

[Privilege Escalation](/tag/privilege-escalation?source=post_page-----4429d416f826--------------------------------)[Freepbx](/tag/freepbx?source=post_page-----4429d416f826--------------------------------)[Cve](/tag/cve?source=post_page-----4429d416f826--------------------------------)[Hacking](/tag/hacking?source=post_page-----4429d416f826--------------------------------)[Security](/tag/security?source=post_page-----4429d416f826--------------------------------)

--

--

[![Janirudransh](https://miro.medium.com/v2/resize:fill:96:96/0*tjabe5QDp2CMAH46)](/%40janirudransh?source=post_page---post_author_info--4429d416f826--------------------------------)[![Janirudransh](https://miro.medium.com/v2/resize:fill:128:128/0*tjabe5QDp2CMAH46)](/%40janirudransh?source=post_page---post_author_info--4429d416f826--------------------------------)Follow[## Written by Janirudransh](/%40janirudransh?source=post_page---post_author_info--4429d416f826--------------------------------)[27 Followers](/%40janirudransh/followers?source=post_page---post_author_info--4429d416f826--------------------------------)·[10 Following](/%40janirudransh/following?source=post_page---post_author_info--4429d416f826--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----4429d416f826--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----4429d416f826--------------------------------)[About](/about?autoplay=1&source=post_page-----4429d416f826--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----4429d416f826--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----4429d416f826--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----4429d416f826--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4429d416f826--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4429d416f826--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----4429d416f826--------------------------------)[Teams](/business?source=post_page-----4429d416f826--------------------------------)

