Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The Avalara for Salesforce integration stores the Avalara license key and account number in a custom Salesforce setting.
*   This custom setting is accessible to all users due to the application's default installation settings and lack of proper permission controls.
*   The Avalara API uses basic authentication with the account ID and license key.

**Weaknesses/Vulnerabilities:**

*   **Insecure Credential Storage:** Storing the license key and account number in a custom setting accessible to all users.
*   **Weak Permission Boundaries:** The Salesforce application's permission model fails to properly restrict access to the custom setting containing sensitive credentials.
*   **Basic Authentication Vulnerability:** The Avalara API's reliance on basic authentication exposes credentials to interception if not used over TLS.
*   **Lack of Least Privilege:** API session granted with admin permissions.

**Impact of Exploitation:**

*   **Full Takeover of Avalara Account:** An attacker can retrieve the license key and account number, granting them complete administrative control over the victim's Avalara account.
*   **Access to Sensitive Financial Data:** An attacker can access banking, tax, and invoice data managed by the Avalara platform.
*   **Data Manipulation and Modification:** With admin access, the attacker can potentially manipulate tax calculations, modify enterprise nexus registrations, and change other business-critical configurations.
*   **Lateral Movement:** Ability to potentially pivot to other integrated apps.

**Attack Vectors:**

*   **Network Interception:** By intercepting Aura API calls.
*   **Salesforce Session Hijacking:** By acquiring a session on the victim's Salesforce site.

**Required Attacker Capabilities/Position:**

*   **Access to a Salesforce Org:** The attacker needs a valid session on the Salesforce instance where the vulnerable Avalara integration is installed.
*   **Knowledge of Salesforce Aura API:** Understanding how to make Aura API requests.
*   **Knowledge of Avalara API:** Understanding how to use the Avalara API with the exposed credentials.

**Additional Notes:**

*   The provided content includes specific examples of the Aura API request to extract credentials and cURL commands to interact with the Avalara API.
*   The content provides a detailed technical breakdown of the vulnerability and exploit steps.
*   The content suggests using "AuraQL" tool for finding such issues in salesforce org.