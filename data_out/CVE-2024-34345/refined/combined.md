=== Content from github.com_cad2ad35_20250110_225812.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCycloneDX%2Fcyclonedx-javascript-library%2Fcommit%2F5e5e1e0b9422f47d2de81c7c4064b803a01e7203)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCycloneDX%2Fcyclonedx-javascript-library%2Fcommit%2F5e5e1e0b9422f47d2de81c7c4064b803a01e7203)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=CycloneDX%2Fcyclonedx-javascript-library)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CycloneDX](/CycloneDX)
/
**[cyclonedx-javascript-library](/CycloneDX/cyclonedx-javascript-library)**
Public

* [Notifications](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library) You must be signed in to change notification settings
* [Fork
  12](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library)
* [Star
   15](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library)

* [Code](/CycloneDX/cyclonedx-javascript-library)
* [Issues
  15](/CycloneDX/cyclonedx-javascript-library/issues)
* [Pull requests
  4](/CycloneDX/cyclonedx-javascript-library/pulls)
* [Discussions](/CycloneDX/cyclonedx-javascript-library/discussions)
* [Actions](/CycloneDX/cyclonedx-javascript-library/actions)
* [Security](/CycloneDX/cyclonedx-javascript-library/security)
* [Insights](/CycloneDX/cyclonedx-javascript-library/pulse)

Additional navigation options

* [Code](/CycloneDX/cyclonedx-javascript-library)
* [Issues](/CycloneDX/cyclonedx-javascript-library/issues)
* [Pull requests](/CycloneDX/cyclonedx-javascript-library/pulls)
* [Discussions](/CycloneDX/cyclonedx-javascript-library/discussions)
* [Actions](/CycloneDX/cyclonedx-javascript-library/actions)
* [Security](/CycloneDX/cyclonedx-javascript-library/security)
* [Insights](/CycloneDX/cyclonedx-javascript-library/pulse)

## Commit

[Permalink](/CycloneDX/cyclonedx-javascript-library/commit/5e5e1e0b9422f47d2de81c7c4064b803a01e7203)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: revert to v6.6.1

[Browse files](/CycloneDX/cyclonedx-javascript-library/tree/5e5e1e0b9422f47d2de81c7c4064b803a01e7203)
Browse the repository at this point in the history

```
Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>
```

* Loading branch information

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)

[jkowalleck](/CycloneDX/cyclonedx-javascript-library/commits?author=jkowalleck "View all commits by jkowalleck")
committed
May 7, 2024

1 parent
[974c558](/CycloneDX/cyclonedx-javascript-library/commit/974c5585dac0428f2863459b215a3dc2951421a6)

commit 5e5e1e0

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**8 additions**
and
**57 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* HISTORY.md
  [HISTORY.md](#diff-648afe3d986261d8f2015b2b131b0e4a448d4dc6946cfde1a7a836876cee255e)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* src/validation

  + src/validation/xmlValidator.node.ts
    [xmlValidator.node.ts](#diff-885f6a484f2f5b81fadec7d487d8f377a59efe6e261ddd75a682576c1f03ba61)
* tests/integration

  + tests/integration/Validation.XmlValidator.test.js
    [Validation.XmlValidator.test.js](#diff-cd52f37c26fcf682d02f4d73f37d32bbefca5aeb826aaea525bdfa644f88393b)

## There are no files selected for viewing

6 changes: 6 additions & 0 deletions

6
[HISTORY.md](#diff-648afe3d986261d8f2015b2b131b0e4a448d4dc6946cfde1a7a836876cee255e "HISTORY.md")

Show comments

[View file](/CycloneDX/cyclonedx-javascript-library/blob/5e5e1e0b9422f47d2de81c7c4064b803a01e7203/HISTORY.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -6,8 +6,14 @@ All notable changes to this project will be documented in this file. |
|  |  |  |
|  |  | <!-- add unreleased items here --> |
|  |  |  |
|  |  | ## 6.7.1 -- 2024-05-07 |
|  |  |  |
|  |  | Reverted v6.7.0, back to v6.6.1 |
|  |  |  |
|  |  | ## 6.7.0 -- 2024-05-07 |
|  |  |  |
|  |  | !! THIS VERSION GOT YANKED !! |
|  |  |  |
|  |  | \* Changed |
|  |  | \* The provided XML validation capabilities no longer supports external entities (via [#1063]; concerns [#1061]) |
|  |  | This is considered a security measure to prevent XML external entity (XXE) injection. |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/CycloneDX/cyclonedx-javascript-library/blob/5e5e1e0b9422f47d2de81c7c4064b803a01e7203/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | { |
|  |  | "name": "@cyclonedx/cyclonedx-library", |
|  |  | "version": "6.7.0", |
|  |  | "version": "6.6.1", |
|  |  | "description": "Core functionality of CycloneDX for JavaScript (Node.js or WebBrowser).", |
|  |  | "license": "Apache-2.0", |
|  |  | "keywords": [ |
| Expand Down | |  |

3 changes: 1 addition & 2 deletions

3
[src/validation/xmlValidator.node.ts](#diff-885f6a484f2f5b81fadec7d487d8f377a59efe6e261ddd75a682576c1f03ba61 "src/validation/xmlValidator.node.ts")

Show comments

[View file](/CycloneDX/cyclonedx-javascript-library/blob/5e5e1e0b9422f47d2de81c7c4064b803a01e7203/src/validation/xmlValidator.node.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,8 +48,7 @@ async function getParser (): Promise<typeof parseXml> { |
|  |  |  |
|  |  | const xmlParseOptions: Readonly<ParserOptions> = Object.freeze({ |
|  |  | nonet: true, |
|  |  | compact: true, |
|  |  | noent: true // prevent https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061 |
|  |  | compact: true |
|  |  | }) |
|  |  |  |
|  |  | export class XmlValidator extends BaseValidator { |
| Expand Down | |  |

54 changes: 0 additions & 54 deletions

54
[tests/integration/Validation.XmlValidator.test.js](#diff-cd52f37c26fcf682d02f4d73f37d32bbefca5aeb826aaea525bdfa644f88393b "tests/integration/Validation.XmlValidator.test.js")

Show comments

[View file](/CycloneDX/cyclonedx-javascript-library/blob/5e5e1e0b9422f47d2de81c7c4064b803a01e7203/tests/integration/Validation.XmlValidator.test.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -99,59 +99,5 @@ describe('Validation.XmlValidator', () => { |
|  |  | const validationError = await validator.validate(input) |
|  |  | assert.strictEqual(validationError, null) |
|  |  | }) |
|  |  |  |
|  |  | it('is not vulnerable to advisories/GHSA-mjr4-7xg5-pfvh', async () => { |
|  |  | /\* report: |
|  |  | see https://github.com/advisories/GHSA-mjr4-7xg5-pfvh |
|  |  | see https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061 |
|  |  | \*/ |
|  |  | const validator = new XmlValidator(version) |
|  |  | /\* POC payload: |
|  |  | see https://research.jfrog.com/vulnerabilities/libxmljs2-attrs-type-confusion-rce-jfsa-2024-001034097/#poc |
|  |  | \*/ |
|  |  | const input = `<?xml version="1.0" encoding="UTF-8"?> |
|  |  | <!DOCTYPE note |
|  |  | [ |
|  |  | <!ENTITY writer "` + 'A'.repeat(0x1234) + `"> |
|  |  | ]> |
|  |  | <bom xmlns="http://cyclonedx.org/schema/bom/${version}"> |
|  |  | <components> |
|  |  | <component type="library"> |
|  |  | <name>&writer;</name><!-- << XML external entity (XXE) injection --> |
|  |  | <version>1.337</version> |
|  |  | ${version === '1.0' ? '<modified>false</modified>' : ''} |
|  |  | </component> |
|  |  | </components> |
|  |  | </bom>` |
|  |  | const validationError = await validator.validate(input) |
|  |  | assert.strictEqual(validationError, null) |
|  |  | }) |
|  |  |  |
|  |  | it('is not vulnerable to advisories/GHSA-78h3-pg4x-j8cv', async () => { |
|  |  | /\* report: |
|  |  | see https://github.com/advisories/GHSA-78h3-pg4x-j8cv |
|  |  | see https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061 |
|  |  | \*/ |
|  |  | const validator = new XmlValidator(version) |
|  |  | /\* POC payload: |
|  |  | see https://research.jfrog.com/vulnerabilities/libxmljs2-namespaces-type-confusion-rce-jfsa-2024-001034098/#poc |
|  |  | \*/ |
|  |  | const input = `<?xml version="1.0" encoding="UTF-8"?> |
|  |  | <!DOCTYPE note |
|  |  | [ |
|  |  | <!ENTITY writer PUBLIC "` + 'A'.repeat(8) + 'B'.repeat(8) + 'C'.repeat(8) + 'D'.repeat(8) + 'P'.repeat(8) + `" "JFrog Security"> |
|  |  | ]> |
|  |  | <bom xmlns="http://cyclonedx.org/schema/bom/${version}"> |
|  |  | <components> |
|  |  | <component type="library"> |
|  |  | <name>&writer;</name><!-- << XML external entity (XXE) injection --> |
|  |  | <version>1.337</version> |
|  |  | ${version === '1.0' ? '<modified>false</modified>' : ''} |
|  |  | </component> |
|  |  | </components> |
|  |  | </bom>` |
|  |  | const validationError = await validator.validate(input) |
|  |  | assert.strictEqual(validationError, null) |
|  |  | }) |
|  |  | })) |
|  |  | }) |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5e5e1e0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCycloneDX%2Fcyclonedx-javascript-library%2Fcommit%2F5e5e1e0b9422f47d2de81c7c4064b803a01e7203) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_adb412e9_20250110_225814.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCycloneDX%2Fcyclonedx-javascript-library%2Fpull%2F1063)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCycloneDX%2Fcyclonedx-javascript-library%2Fpull%2F1063)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=CycloneDX%2Fcyclonedx-javascript-library)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CycloneDX](/CycloneDX)
/
**[cyclonedx-javascript-library](/CycloneDX/cyclonedx-javascript-library)**
Public

* [Notifications](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library) You must be signed in to change notification settings
* [Fork
  12](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library)
* [Star
   15](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library)

* [Code](/CycloneDX/cyclonedx-javascript-library)
* [Issues
  15](/CycloneDX/cyclonedx-javascript-library/issues)
* [Pull requests
  4](/CycloneDX/cyclonedx-javascript-library/pulls)
* [Discussions](/CycloneDX/cyclonedx-javascript-library/discussions)
* [Actions](/CycloneDX/cyclonedx-javascript-library/actions)
* [Security](/CycloneDX/cyclonedx-javascript-library/security)
* [Insights](/CycloneDX/cyclonedx-javascript-library/pulse)

Additional navigation options

* [Code](/CycloneDX/cyclonedx-javascript-library)
* [Issues](/CycloneDX/cyclonedx-javascript-library/issues)
* [Pull requests](/CycloneDX/cyclonedx-javascript-library/pulls)
* [Discussions](/CycloneDX/cyclonedx-javascript-library/discussions)
* [Actions](/CycloneDX/cyclonedx-javascript-library/actions)
* [Security](/CycloneDX/cyclonedx-javascript-library/security)
* [Insights](/CycloneDX/cyclonedx-javascript-library/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# feat: XML Validator prevent parsing XXE #1063

 Merged

[jkowalleck](/jkowalleck)
merged 8 commits into
[main](/CycloneDX/cyclonedx-javascript-library/tree/main "CycloneDX/cyclonedx-javascript-library:main")
from
[fix/XmlValidator-not-parse-XXE](/CycloneDX/cyclonedx-javascript-library/tree/fix/XmlValidator-not-parse-XXE "CycloneDX/cyclonedx-javascript-library:fix/XmlValidator-not-parse-XXE")

May 7, 2024

 Merged

# [feat: XML Validator prevent parsing XXE](#top) #1063

[jkowalleck](/jkowalleck)
merged 8 commits into
[main](/CycloneDX/cyclonedx-javascript-library/tree/main "CycloneDX/cyclonedx-javascript-library:main")
from
[fix/XmlValidator-not-parse-XXE](/CycloneDX/cyclonedx-javascript-library/tree/fix/XmlValidator-not-parse-XXE "CycloneDX/cyclonedx-javascript-library:fix/XmlValidator-not-parse-XXE")

May 7, 2024

[Conversation
14](/CycloneDX/cyclonedx-javascript-library/pull/1063)
[Commits
8](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits)
[Checks
42](/CycloneDX/cyclonedx-javascript-library/pull/1063/checks)
[Files changed](/CycloneDX/cyclonedx-javascript-library/pull/1063/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=60&v=4)](/jkowalleck)

Copy link

Member

### @jkowalleck **[jkowalleck](/jkowalleck)** commented [May 7, 2024](#issue-2283149028) ‚Ä¢ edited Loading

prevent the XmlValidation from XXE parsing - prevent XML external entity (XXE) injection

This is considered a security measure.

fixes [#1061](https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061) as described here: [#1063 (comment)](https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063#issuecomment-2098335774)

Sorry, something went wrong.

All reactions

 [jkowalleck](/jkowalleck)
added 7 commits
[May 7, 2024 14:04](#commits-pushed-43cc752)

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)

`[test: reproduce reported security issues for](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/43cc75216e7c08248f72b69e23a5f2b4c410af8f "test: reproduce reported security issues for #1061

Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>") [#1061](https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061)`
 ‚Ä¶

`[43cc752](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/43cc75216e7c08248f72b69e23a5f2b4c410af8f)`

```
Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>
```

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)

`[fix](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/56e296631d7728956cbf105934b60b4bfd307de9 "fix

Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>")`
 ‚Ä¶

`[56e2966](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/56e296631d7728956cbf105934b60b4bfd307de9)`

```
Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>
```

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)

`[tests](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/709268a6ad9980497146f9809e32d0bdc529d32b "tests

Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>")`
 ‚Ä¶

`[709268a](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/709268a6ad9980497146f9809e32d0bdc529d32b)`

```
Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>
```

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)

`[tidy](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/dc137524e84f60b0ed05f68126faa4dec9897889 "tidy

Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>")`
 ‚Ä¶

`[dc13752](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/dc137524e84f60b0ed05f68126faa4dec9897889)`

```
Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>
```

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)

`[docs](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/cc9c21458fa75439039e4f37ee89141e3310d160 "docs

Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>")`
 ‚Ä¶

`[cc9c214](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/cc9c21458fa75439039e4f37ee89141e3310d160)`

```
Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>
```

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)

`[docs](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/91f6d27f1ea9b4546e42908fbbfbc030d6acd0d9 "docs

Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>")`
 ‚Ä¶

`[91f6d27](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/91f6d27f1ea9b4546e42908fbbfbc030d6acd0d9)`

```
Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>
```

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)

`[clean](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/60cca6cbb0c7940bb5dcb336f142d38af8c0aaa0 "clean

Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>")`
 ‚Ä¶

`[60cca6c](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/60cca6cbb0c7940bb5dcb336f142d38af8c0aaa0)`

```
Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>
```

 [![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)
[jkowalleck](/jkowalleck)
marked this pull request as ready for review
[May 7, 2024 12:39](#event-12728954337)

 [![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)
[jkowalleck](/jkowalleck)
requested a review
from a team
as a [code owner](/CycloneDX/cyclonedx-javascript-library/blob/309dd5ac4dbb96303759a1dcc083dd56dff3708d/CODEOWNERS#L6)
[May 7, 2024 12:39](#event-12728954449)

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=80&v=4)](/jkowalleck)

Copy link

Member

Author

### **[jkowalleck](/jkowalleck)** commented [May 7, 2024](#issuecomment-2098315082)

| [@artola](https://github.com/artola) please review |
| --- |

 ‚ù§Ô∏è
1
 artola reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)

`[test](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/96ae0656e0e5bd40817c1ddaaecf357791b138fd "test

Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>")`
 ‚Ä¶

`[96ae065](/CycloneDX/cyclonedx-javascript-library/pull/1063/commits/96ae0656e0e5bd40817c1ddaaecf357791b138fd)`

```
Signed-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>
```

[![@codacy-production](https://avatars.githubusercontent.com/in/56611?s=80&v=4)](/apps/codacy-production)
[![Codacy Production](https://avatars.githubusercontent.com/in/56611?s=40&u=babb904834d0aff57593ad91ec99249a9cf1a3a7&v=4)](https://github.com/apps/codacy-production)

Copy link

### **[codacy-production](/apps/codacy-production) bot** commented [May 7, 2024](#issuecomment-2098331382)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Coverage summary from Codacy[See diff coverage on Codacy](https://app.codacy.com/gh/CycloneDX/cyclonedx-javascript-library/coverage/pull-requests/1063?utm_source=github.com&utm_medium=coverageSummary&utm_campaign=coverageSummaryPullRequest)  | Coverage variation | Diff coverage | | --- | --- | | Report missing for [309dd5a](https://github.com/CycloneDX/cyclonedx-javascript-library/commit/309dd5ac4dbb96303759a1dcc083dd56dff3708d)[1](#user-content-fn-1-8b2bbfae1cb571dbfcb0a2e4d4b961fe) | ‚úÖ **100.00%** (target: 90.00%) |   Coverage variation details  |  | Coverable lines | Covered lines | Coverage | | --- | --- | --- | --- | | Common ancestor commit ([309dd5a](https://github.com/CycloneDX/cyclonedx-javascript-library/commit/309dd5ac4dbb96303759a1dcc083dd56dff3708d)) | Report Missing | Report Missing | Report Missing | | Head commit ([96ae065](https://github.com/CycloneDX/cyclonedx-javascript-library/commit/96ae0656e0e5bd40817c1ddaaecf357791b138fd)) | 22779 | 22368 | 98.20% |   **Coverage variation** is the difference between the coverage for the head and common ancestor commits of the pull request branch: `<coverage of head commit> - <coverage of common ancestor commit>`  Diff coverage details  |  | Coverable lines | Covered lines | Diff coverage | | --- | --- | --- | --- | | Pull request ([#1063](https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063)) | 2 | 2 | **100.00%** |   **Diff coverage** is the percentage of lines that are covered by tests out of the coverable lines that the pull request added or modified: `<covered lines added or modified>/<coverable lines added or modified> * 100%` [See your quality gate settings](https://app.codacy.com/gh/CycloneDX/cyclonedx-javascript-library/settings/quality?utm_source=github.com&utm_medium=coverageSummary&utm_campaign=coverageSummaryGates)¬†¬†¬†¬†[Change summary preferences](https://app.codacy.com/gh/CycloneDX/cyclonedx-javascript-library/settings/integrations?utm_source=github.com&utm_medium=coverageSummary&utm_campaign=coverageSummarySettings) Codacy will stop sending the deprecated coverage status from June 5th, 2024. [Learn more](https://docs.codacy.com/release-notes/cloud/cloud-2023-11-23-new-coverage-engine-status-checks/#deprecation-and-removal-of-the-old-coverage-engine-status-checks) Footnotes  1. Codacy didn't receive coverage data for the commit, or there was an error processing the received data. [Check your integration for errors](https://app.codacy.com/gh/CycloneDX/cyclonedx-javascript-library/settings/coverage?utm_source=github.com&utm_medium=coverageSummary&utm_campaign=coverageSummarySetup) and [validate that your coverage setup is correct](https://docs.codacy.com/coverage-reporter/#validating-coverage?utm_source=github.com&utm_medium=coverageSummary&utm_campaign=coverageSummaryTroubleshoot). [‚Ü©](#user-content-fnref-1-8b2bbfae1cb571dbfcb0a2e4d4b961fe) |

All reactions

Sorry, something went wrong.

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=80&v=4)](/jkowalleck)

Copy link

Member

Author

### **[jkowalleck](/jkowalleck)** commented [May 7, 2024](#issuecomment-2098335774) ‚Ä¢ edited Loading

| <https://research.jfrog.com/vulnerabilities/libxmljs2-namespaces-type-confusion-rce-jfsa-2024-001034098/#poc> reports DOS via payload  ``` const libxmljs2 = require('libxmljs2');  var d = `<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE note [ <!ENTITY writer PUBLIC "` + "A".repeat(8) + "B".repeat(8) + "C".repeat(8) + "D".repeat(8) + "P".repeat(8) + `" "JFrog Security"> ]> <from>&writer;</from> `;  t = libxmljs2.parseXml(d) from = t.get('//from') c = from.childNodes()[0] c2 = c.childNodes()[0] //entity_decl n = c2.namespaces(true) //onlyLocal = true ```  tested, acknowledged.  to prevent this, the following parser options were used:  ``` Object.freeze({   nonet: true,   compact: true,   noent: false // prevent https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061 /* !!! do not set to true. setting true would enable XXE. the oposite is the intended solution */  }) ```  see <https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063/files#r1592446370>  fixed code:  ``` const libxmljs2 = require('libxmljs2');  var d = `<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE note [ <!ENTITY writer PUBLIC "` + "A".repeat(8) + "B".repeat(8) + "C".repeat(8) + "D".repeat(8) + "P".repeat(8) + `" "JFrog Security"> ]> <from>&writer;</from> `;  var po = Object.freeze({   nonet: true,   compact: true,   noent: false // prevent https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061 })  t = libxmljs2.parseXml(d, po) from = t.get('//from') c = from.childNodes()[0] c2 = c.childNodes()[0] //entity_decl n = c2.namespaces(true) //onlyLocal = true  ```  This code does not cause a DOS anymore, nor does it open any sockets or such... Instead, it crashes, since the XXE is not parsable nor executed. This behavior is acceptable.  I consider this a fix. The vulnerability of [#1061](https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061) is not usable anymore.  Therefore: fixes [#1061](https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061) |
| --- |

All reactions

Sorry, something went wrong.

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)
[jkowalleck](/jkowalleck)
mentioned this pull request
[May 7, 2024](#ref-issue-2281009977)

[[SECURITY] advisories/GHSA-mjr4-7xg5-pfvh for optional dependency `libxmljs2`
#1061](/CycloneDX/cyclonedx-javascript-library/issues/1061)

Closed

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)
[jkowalleck](/jkowalleck)
changed the title
~~fix: XML Validator prevent parsing XXE~~
feat: XML Validator prevent parsing XXE
[May 7, 2024](#event-12729261940)

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)
[jkowalleck](/jkowalleck)
added
the
[enhancement](/CycloneDX/cyclonedx-javascript-library/labels/enhancement)
New feature or request
label
[May 7, 2024](#event-12729269984)

[![jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=60&v=4)](/jkowalleck)

**[jkowalleck](/jkowalleck)**
commented
[May 7, 2024](#pullrequestreview-2043127821)

 [View reviewed changes](/CycloneDX/cyclonedx-javascript-library/pull/1063/files/96ae0656e0e5bd40817c1ddaaecf357791b138fd)

[src/validation/xmlValidator.node.ts](/CycloneDX/cyclonedx-javascript-library/pull/1063/files/96ae0656e0e5bd40817c1ddaaecf357791b138fd#diff-885f6a484f2f5b81fadec7d487d8f377a59efe6e261ddd75a682576c1f03ba61)

Show resolved

Hide resolved

[![artola](https://avatars.githubusercontent.com/u/11500763?s=60&v=4)](/artola)

**[artola](/artola)**
approved these changes
[May 7, 2024](#pullrequestreview-2043169447)

 [View reviewed changes](/CycloneDX/cyclonedx-javascript-library/pull/1063/files/96ae0656e0e5bd40817c1ddaaecf357791b138fd)

Copy link

### @artola **[artola](/artola)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Awesome!

Sorry, something went wrong.

All reactions

 Hide details
View details

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)
[jkowalleck](/jkowalleck)
merged commit [`7c34096`](/CycloneDX/cyclonedx-javascript-library/commit/7c34096576165dce02c3c922934113755f35076c)
into
main

[May 7, 2024](https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063#event-12729571309)
42 checks passed

 [![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)
[jkowalleck](/jkowalleck)
deleted the
fix/XmlValidator-not-parse-XXE

branch
[May 7, 2024 13:23](#event-12729572285)

[![@sven-rsb](https://avatars.githubusercontent.com/u/118808157?s=80&v=4)](/sven-rsb)

Copy link

### **[sven-rsb](/sven-rsb)** commented [May 7, 2024](#issuecomment-2098617430)

| Great work [@jkowalleck](https://github.com/jkowalleck)! I found this when I was researching on how to prevent the parsing vulnerabilities following up on [CVE-2024-34393](https://github.com/advisories/GHSA-mjr4-7xg5-pfvh). This looks great and I agree that the `nonet` and `noent` options should solve the vulnerabilities. I was wondering the reason behind adding the `compact` option. Was it only for the performance improvements for your specific use case or can it also prevent some kind of vulnerability? According to the official documentation, all it does is:  Compact small text nodes; no modification of the tree allowed afterwards (will possibly crash if you try to modify the tree) |
| --- |

All reactions

Sorry, something went wrong.

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=80&v=4)](/jkowalleck)

Copy link

Member

Author

### **[jkowalleck](/jkowalleck)** commented [May 7, 2024](#issuecomment-2098636724) ‚Ä¢ edited Loading

| yes, the `compact` was added for my specific purposes, it is not related to the actual workaround for the thing.  LIBXML\_COMPACT: Activate small nodes allocation optimization. This may speed up your application without needing to change the code. Note: Only available in Libxml >= 2.6.21 |
| --- |

 üëç
1
 sven-rsb reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=80&v=4)](/jkowalleck)

Copy link

Member

Author

### **[jkowalleck](/jkowalleck)** commented [May 7, 2024](#issuecomment-2098655497) ‚Ä¢ edited Loading

| FYI: this fix will be resulting an security advisory: [GHSA-38gf-rh2w-gmj7](https://github.com/CycloneDX/cyclonedx-javascript-library/security/advisories/GHSA-38gf-rh2w-gmj7 "GHSA-38gf-rh2w-gmj7") |
| --- |

All reactions

Sorry, something went wrong.

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=80&v=4)](/jkowalleck)

Copy link

Member

Author

### **[jkowalleck](/jkowalleck)** commented [May 7, 2024](#issuecomment-2099012278)

| !!! REVERTED !!! had to revert this merge/patch. And had to yank v6.7.0 !!! REVERTED !!!  instead of preventing XXE, it actually enabled it. |
| --- |

 üëÄ
2
 sven-rsb and satanshiro reacted with eyes emoji

All reactions

* üëÄ
  2 reactions

Sorry, something went wrong.

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=80&v=4)](/jkowalleck)

Copy link

Member

Author

### **[jkowalleck](/jkowalleck)** commented [May 8, 2024](#issuecomment-2100751377)

| I was wrong. This library was not affected by XXE in the first place. see a hardening and POC/tests [#1064](https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1064) |
| --- |

All reactions

Sorry, something went wrong.

[![prabhu](https://avatars.githubusercontent.com/u/7842?s=60&v=4)](/prabhu)

**[prabhu](/prabhu)**
reviewed
[May 10, 2024](#pullrequestreview-2050823231)

 [View reviewed changes](/CycloneDX/cyclonedx-javascript-library/pull/1063/files/96ae0656e0e5bd40817c1ddaaecf357791b138fd)

[src/validation/xmlValidator.node.ts](/CycloneDX/cyclonedx-javascript-library/pull/1063/files/96ae0656e0e5bd40817c1ddaaecf357791b138fd#diff-885f6a484f2f5b81fadec7d487d8f377a59efe6e261ddd75a682576c1f03ba61)

|  |  | @@ -48,7 +48,8 @@ async function getParser (): Promise<typeof parseXml> { | |
| --- | --- | --- | --- |
|  |  |  |
|  |  | const xmlParseOptions: Readonly<ParserOptions> = Object.freeze({ |
|  |  | nonet: true, |
|  |  | compact: true |
|  |  | compact: true, |
|  |  | noent: true // prevent https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061 |

Copy link

### @prabhu **[prabhu](/prabhu)** [May 10, 2024](#discussion_r1597195712)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

noent: true means [substitute](https://gnome.pages.gitlab.gnome.org/libxml2/devhelp/libxml2-parser.html) entities.

Omitting this option is the secure default.

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @jkowalleck **[jkowalleck](/jkowalleck)** [May 11, 2024](#discussion_r1597421309)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

exactly.

therefore [GHSA-38gf-rh2w-gmj7](https://github.com/CycloneDX/cyclonedx-javascript-library/security/advisories/GHSA-38gf-rh2w-gmj7 "GHSA-38gf-rh2w-gmj7") exists,

and the [#1064](https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1064) introduced test for this

Sorry, something went wrong.

 üëç
1
 prabhu reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![prabhu](https://avatars.githubusercontent.com/u/7842?s=60&v=4)](/prabhu)

**[prabhu](/prabhu)**
reviewed
[May 10, 2024](#pullrequestreview-2050828092)

 [View reviewed changes](/CycloneDX/cyclonedx-javascript-library/pull/1063/files/96ae0656e0e5bd40817c1ddaaecf357791b138fd)

[tests/integration/Validation.XmlValidator.test.js](/CycloneDX/cyclonedx-javascript-library/pull/1063/files/96ae0656e0e5bd40817c1ddaaecf357791b138fd#diff-cd52f37c26fcf682d02f4d73f37d32bbefca5aeb826aaea525bdfa644f88393b)

Show resolved

Hide resolved

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)
[jkowalleck](/jkowalleck)
mentioned this pull request
[May 11, 2024](#ref-pullrequest-2285767241)

[refactor: XML validator explicitely harden against XXE injections
#1064](/CycloneDX/cyclonedx-javascript-library/pull/1064)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FCycloneDX%2Fcyclonedx-javascript-library%2Fpull%2F1063)

Reviewers

[![@prabhu](https://avatars.githubusercontent.com/u/7842?s=40&v=4)](/prabhu) [prabhu](/prabhu)

prabhu left review comments

[![@artola](https://avatars.githubusercontent.com/u/11500763?s=40&v=4)](/artola) [artola](/artola)

artola approved these changes

Assignees

No one assigned

Labels

[enhancement](/CycloneDX/cyclonedx-javascript-library/labels/enhancement)
New feature or request

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [[SECURITY] advisories/GHSA-mjr4-7xg5-pfvh for optional dependency `libxmljs2`](https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061)

4 participants

[![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=52&v=4)](/jkowalleck) [![@sven-rsb](https://avatars.githubusercontent.com/u/118808157?s=52&v=4)](/sven-rsb) [![@prabhu](https://avatars.githubusercontent.com/u/7842?s=52&v=4)](/prabhu) [![@artola](https://avatars.githubusercontent.com/u/11500763?s=52&v=4)](/artola)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_fc991bd1_20250110_225814.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCycloneDX%2Fcyclonedx-javascript-library%2Fsecurity%2Fadvisories%2FGHSA-38gf-rh2w-gmj7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCycloneDX%2Fcyclonedx-javascript-library%2Fsecurity%2Fadvisories%2FGHSA-38gf-rh2w-gmj7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=CycloneDX%2Fcyclonedx-javascript-library)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CycloneDX](/CycloneDX)
/
**[cyclonedx-javascript-library](/CycloneDX/cyclonedx-javascript-library)**
Public

* [Notifications](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library) You must be signed in to change notification settings
* [Fork
  12](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library)
* [Star
   15](/login?return_to=%2FCycloneDX%2Fcyclonedx-javascript-library)

* [Code](/CycloneDX/cyclonedx-javascript-library)
* [Issues
  15](/CycloneDX/cyclonedx-javascript-library/issues)
* [Pull requests
  4](/CycloneDX/cyclonedx-javascript-library/pulls)
* [Discussions](/CycloneDX/cyclonedx-javascript-library/discussions)
* [Actions](/CycloneDX/cyclonedx-javascript-library/actions)
* [Security](/CycloneDX/cyclonedx-javascript-library/security)
* [Insights](/CycloneDX/cyclonedx-javascript-library/pulse)

Additional navigation options

* [Code](/CycloneDX/cyclonedx-javascript-library)
* [Issues](/CycloneDX/cyclonedx-javascript-library/issues)
* [Pull requests](/CycloneDX/cyclonedx-javascript-library/pulls)
* [Discussions](/CycloneDX/cyclonedx-javascript-library/discussions)
* [Actions](/CycloneDX/cyclonedx-javascript-library/actions)
* [Security](/CycloneDX/cyclonedx-javascript-library/security)
* [Insights](/CycloneDX/cyclonedx-javascript-library/pulse)

# Improper Restriction of XML External Entity Reference in @cyclonedx/cyclonedx-library

High

[jkowalleck](/jkowalleck)
published
GHSA-38gf-rh2w-gmj7
May 8, 2024

## Package

npm

@cyclonedx/cyclonedx-library
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

6.7.0

## Patched versions

6.7.1

## Description

### Impact

XML External entity injections could be possible, when running the provided XML Validator on arbitrary input.

#### POC

```
const {
  Spec: { Version },
  Validation: { XmlValidator }
} = require('@cyclonedx/cyclonedx-library');

const version = Version.v1dot5;
const validator = new XmlValidator(version);
const input = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE poc [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<bom xmlns="http://cyclonedx.org/schema/bom/1.5">
  <components>
    <component type="library">
      <name>testing</name>
      <version>1.337</version>
      <licenses>
        <license>
          <id>&xxe;</id><!-- << XML external entity (XXE) injection -->
        </license>
      </licenses>
    </component>
  </components>
</bom>`;

// validating this forged(^) input might lead to unintended behaviour
// for the fact that the XML external entity would be taken into account.
validator.validate(input).then(ve => {
  console.error('validation error', ve);
});
```
### Patches

This issue was fixed in `@cyclonedx/cyclonedx-library@6.7.1` .

### Workarounds

Do not run the provided XML validator on untrusted inputs.

### References

* issue was introduced via [#1063](https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063).

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

### CVE ID

No known CVE

### Weaknesses

[CWE-611](/advisories?query=cwe%3A611)

### Credits

* [![@jkowalleck](https://avatars.githubusercontent.com/u/2765863?s=40&v=4)](/jkowalleck)
  [jkowalleck](/jkowalleck)
  Coordinator

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


