-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2024-020
Product: C-MOR Video Surveillance
Manufacturer: za-internet GmbH
Affected Version(s): 5.2401
Tested Version(s): 5.2401
Vulnerability Type: Reflected Cross-Site Scripting (CWE-79)
Risk Level: Medium
Solution Status: Fixed
Manufacturer Notification: 2024-04-05
Solution Date: 2024-07-31
Public Disclosure: 2024-09-04
CVE Reference: CVE-2024-45176
Authors of Advisory: Chris Beiter, Frederik Beimgraben,
and Matthias Deeg
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
The software product C-MOR is an IP video surveillance system.
The manufacturer describes the product as follows:
"With C-MOR video surveillance, it is possible to check your
surveillance over network and the Internet. You can access the live
view as well as previous recordings from any PC or mobile device.
C-MOR is managed and controlled over the C-MOR web interface.
IP settings, camera recording setup, user rights and so on are set
over the web without the installation of any software on the
client."[1]
Due to improper input validation, the C-MOR web interface is vulnerable
to reflected cross-site scripting attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
By analyzing the C-MOR web interface, it was found that different
functions are prone to reflected cross-site scripting attacks due to
insufficient user input validation.
This kind of attack allows an attacker to send a manipulated link to
an authenticated victim in order to execute arbitrary JavaScript code
in the context of the victim's web browser.
Reflected cross-site scripting vulnerabilities were found in the
following C-MOR scripts and exploited via different URL parameters,
for instance the parameter "ujava":
\* index-de.plm
\* list-timelapse.plm
\* list-motion.plm
\* setdelays.plm
\* show-movies.plm
\* show-movies-f.plm
\* uploadcambackup.plm
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The following three sample attack vectors exemplarily demonstrate
the found security issue.
1) index-de.plm
The following URL is an example of an attack vector exploiting a
reflected cross-site scripting vulnerability via the URL parameter
"ujava" of the web interface index page "index-de.plm":
https:///index-de.pml?ujava=">/list-timelapse.pml?days=1100&cam=cam1">/show-movies.pml?cam=cam1&days="><z="
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Install C-MOR Video Surveillance version 6.00PL1.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2024-04-05: Vulnerability reported to manufacturer
2024-04-05: Manufacturer acknowledges receipt of security advisories
2024-04-08: Exchange regarding security updates and disclosure timeline
2024-05-08: Further exchange concerning security updates and disclosure
timeline; public release of all security advisories
scheduled for release of C-MOR Video Surveillance version 6
2024-05-10: Release of C-MOR software version 5.30 with security updates
for some reported security issues
2024-07-19: E-mail to manufacturer concerning release date of C-MOR
Video Surveillance version 6; response with planned
release date of 2024-08-01
2024-07-30: E-mail from manufacturer with further information
concerning security fixes
2024-07-31: Release of C-MOR software version 6.00PL1
2024-09-04: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for C-MOR Video Surveillance
https://www.c-mor.com/
[2] SySS Security Advisory SYSS-2024-020
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2024-020.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Chris Beiter, Frederik
Beimgraben, and Matthias Deeg.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAmbW+kAACgkQ2aS/ajSt
TavkuhAAn3hwas8S5KBrlrJ8NlfASo01kMaTu2zGAb1D4PTt7sYVWYY2sZs/fuFv
TaZFk9VMZSy9Sak3kR6mjzaaAtt5jcE+L3S374qT/x4Z8ROfniahVcH0/aYhQQSt
1lGvxfBpOS95B4IHWpFqJKiscx9RNvh8h5FEEE09fUDxPXsLqAJsFoWPH1C0EtQ3
aPzHyuf12Zx80C07I8nOPpuHzH+AgJwIYDAbqoRmO9s6TROOUv3vqAHTTp4oZ3c4
N6muVT4fDBwKJO1mMIW5rcblWTjPCdalebGARrp7+03a2Mp3hyacb+65JUUwZJqz
HKn9ymkTtSeQLbxilZVJPhtHFw8IRCm8WLQXOmYyaeo18tJi9ypFx/5sA0w127cn
y438iNQ1M8nv5T5flUMw809k8Z9u9dPptJf5H30P0L5Uv7qs2u0fn83J05Yhm/WP
uncWQpYiWeJg5CL8dQhZGGtkMpm+MhVE/Q/Jf7m9TG1oMZj3yuSEx66h3QqI0IiA
N+zSvwaCbt3xSeGRGHmvNFJ/ZTSN7n0Nk6GzlUxCx21gUcGJ42KggHh0a1znfodI
vGS2fC0XtQqqU93DrCXInxnDBTtX9/uYpE9HM/hgL21023BVCx8kGxARleAVd5d/
Fk2j6ExHG8WbCvLYLjvoQsz49v2EcC3RUVgQ8wEnnNlxOuofl8M=
=/Zvp
-----END PGP SIGNATURE-----
