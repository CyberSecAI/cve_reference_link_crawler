<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  






  <head>
    <title>
      feedzy-rss-feeds-import.php in feedzy-rss-feeds/tags/4.4.2/includes/admin
     – WordPress Plugin Repository
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
          <link rel="search" href="/search" />
          <link rel="help" href="/wiki/TracGuide" />
          <link rel="alternate" href="/browser/feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php?format=txt" type="text/plain" title="Plain Text" />
          <link rel="alternate" href="/export/3220479/feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php" type="text/x-php; charset=utf-8" title="Original Format" />
          <link rel="next" href="/browser/feedzy-rss-feeds/trunk/includes/admin/feedzy-rss-feeds-import.php?rev=3033749" title="Revision 3033749" />
          <link rel="start" href="/wiki" />
	<link rel="stylesheet" href="https://s.w.org/style/trac/common/css/trac.css?v=212" />
	<link rel="stylesheet" href="https://s.w.org/style/trac/common/css/code.css?v=212" />
          <link rel="stylesheet" href="/pygments/trac.css" type="text/css" />
	<link rel="stylesheet" href="https://s.w.org/style/trac/common/css/browser.css?v=212" />
          <link rel="prev" href="/browser/feedzy-rss-feeds/trunk/includes/admin/feedzy-rss-feeds-import.php?rev=3020937" title="Revision 3020937" />
          <link rel="icon" href="/chrome/common/trac.ico" type="image/x-icon" />
    <style id="trac-noscript" type="text/css">.trac-noscript { display: none !important }</style>
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Search WordPress Plugin Repository" />
	<link rel="dns-prefetch" href="//s.w.org" />
	<link rel="dns-prefetch" href="//fonts.googleapis.com" />
	<link rel="dns-prefetch" href="//fonts.gstatic.com" />
	<link rel="dns-prefetch" href="//www.googletagmanager.com" />
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s);j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-5Z8B3BX');</script>
	
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="preload" href="https://wordpress.org/wp-content/mu-plugins/pub-sync/global-fonts/Inter/Inter-latin.woff2" as="font" crossorigin="crossorigin" type="font/woff2" />
<meta name="robots" content="max-image-preview:large" />
<link rel="dns-prefetch" href="//s.w.org" />
<link rel="dns-prefetch" href="//fonts.googleapis.com" />
<link rel="dns-prefetch" href="//www.googletagmanager.com" />
<link rel="dns-prefetch" href="//v0.wordpress.com" />
<link rel="dns-prefetch" href="//i0.wp.com" />
<script>//<![CDATA[
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P24PF4B');
//]]></script>
	<script type="text/javascript">//<![CDATA[
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/wordpress.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.3-alpha-55651"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){p.clearRect(0,0,i.width,i.height),p.fillText(e,0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(t,0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s("\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!s("\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!s("\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!s("\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
//]]></script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="open-sans-css" href="https://fonts.googleapis.com/css2?family=Open+Sans%3Aital%2Cwght%400%2C300%3B0%2C400%3B0%2C600%3B1%2C300%3B1%2C400%3B1%2C600&amp;display=swap" type="text/css" media="all" />
<link rel="stylesheet" id="wp4-styles-css" href="https://s.w.org/style/wp4.css?ver=1645139188" type="text/css" media="all" />
<link rel="stylesheet" id="wp-block-library-css" href="https://wordpress.org/wp-content/plugins/gutenberg/build/block-library/style.css?ver=15.4.0" type="text/css" media="all" />
<style id="wp-block-library-inline-css" type="text/css">
.has-text-align-justify{text-align:justify;}
</style>
<style id="wporg-language-suggest-style-inline-css" type="text/css">
.wp-block-wporg-language-suggest{background-color:#eff2ff;color:#1e1e1e;font-size:12px;line-height:1;text-align:center}.wp-block-wporg-language-suggest&gt;*{padding:10px 4px}
</style>
<style id="wporg-latest-news-style-inline-css" type="text/css">
.wporg-latest-news{list-style:none;margin:0;padding:0}.wporg-latest-news li:not(:last-child){padding-bottom:var(--wp--custom--latest-news--spacing,16px)}.wporg-latest-news li a{text-decoration:none}.wporg-latest-news li a:hover{text-decoration:underline}.wporg-latest-news li&gt;a{color:var(--wp--custom--latest-news--link--color);display:block;font-family:var(--wp--custom--latest-news--title--font-family);font-size:var(--wp--custom--latest-news--title--font-size,24px);line-height:var(--wp--custom--latest-news--title--line-height);margin-bottom:var(--wp--custom--latest-news--link--spacing,4px)}.wporg-latest-news__details{font-size:var(--wp--custom--latest-news--link--details-font-size,14px)}.wporg-latest-news__details&gt;:not(:last-child){margin-right:4px}.wporg-latest-news__category{text-transform:uppercase}
</style>
<style id="wporg-notice-style-inline-css" type="text/css">
.wp-block-wporg-notice{--wp--custom--wporg-notice--color--background:var(--wp--preset--color--acid-green-3);--wp--custom--wporg-notice--color--text:var(--wp--preset--color--charcoal-1)}.wp-block-wporg-notice.is-info-notice{--wp--custom--wporg-notice--color--background:var(--wp--preset--color--blueberry-4)}.wp-block-wporg-notice.is-alert-notice{--wp--custom--wporg-notice--color--background:var(--wp--preset--color--lemon-3)}.wp-block-wporg-notice.is-warning-notice{--wp--custom--wporg-notice--color--background:var(--wp--preset--color--pomegrade-3)}.wp-block-wporg-notice{background-color:var(--wp--custom--wporg-notice--color--background);color:var(--wp--custom--wporg-notice--color--text);display:grid;gap:.5em;grid-template-columns:auto 1fr;padding:1.25em}.wp-block-wporg-notice&gt;*{align-self:start}.wp-block-wporg-notice p:first-child{margin-block-start:0}.wp-block-wporg-notice p:last-child{margin-block-end:0}.wp-block-wporg-notice a:active,.wp-block-wporg-notice a:focus,.wp-block-wporg-notice a:hover,.wp-block-wporg-notice a:link,.wp-block-wporg-notice a:visited{color:var(--wp--custom--wporg-notice--color--text)}.wp-block-wporg-notice.alignleft,.wp-block-wporg-notice.alignright{max-width:calc(var(--wp--style--global--content-size)*.66)}.wp-block-wporg-notice__icon{align-self:flex-start;background-image:url(/wp-content/mu-plugins/pub-sync/blocks/notice/build/../src/icon/library/tip.svg);background-position:50%;background-repeat:no-repeat;background-size:24px 24px;display:flex;height:1.875em;width:24px}.is-info-notice .wp-block-wporg-notice__icon{background-image:url(/wp-content/mu-plugins/pub-sync/blocks/notice/build/../src/icon/library/info.svg)}.is-alert-notice .wp-block-wporg-notice__icon{background-image:url(/wp-content/mu-plugins/pub-sync/blocks/notice/build/../src/icon/library/alert.svg)}.is-warning-notice .wp-block-wporg-notice__icon{background-image:url(/wp-content/mu-plugins/pub-sync/blocks/notice/build/../src/icon/library/warning.svg)}.wp-block-wporg-notice__content{align-self:center}
</style>
<style id="wporg-site-breadcrumbs-style-inline-css" type="text/css">
.wp-block-wporg-site-breadcrumbs{align-items:center;display:flex}.wp-block-wporg-site-breadcrumbs a{color:var(--wp--preset--color--charcoal-1)}.wp-block-wporg-site-breadcrumbs a:hover{text-decoration-line:underline}.wp-block-wporg-site-breadcrumbs&gt;span:not(:first-child){align-items:center;display:flex;margin-top:0}.wp-block-wporg-site-breadcrumbs&gt;span:not(:first-child):before{content:"/";display:inline-block;font-weight:400;margin:0 .5rem}.wp-block-wporg-site-breadcrumbs .is-current-page{font-weight:700}
</style>
<style id="wporg-table-of-contents-style-inline-css" type="text/css">
@media (min-width:890px){#wp--skip-link--target,.is-toc-heading{scroll-margin-top:var(--wp-local-header-offset,0)}}.is-toc-heading a{--local--icon-size:24px;color:inherit;display:inline-block;padding-right:calc(var(--local--icon-size) + .1em)}.is-toc-heading a,.is-toc-heading a:after{text-decoration:none!important}.is-toc-heading a:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M10.083 17.639H8.444a5.194 5.194 0 1 1 0-10.389h1.64v1.5H8.443a3.694 3.694 0 0 0 0 7.389h1.641v1.5ZM13.917 7.25h1.639a5.194 5.194 0 0 1 0 10.39h-1.641v-1.5h1.642a3.694 3.694 0 0 0 0-7.39h-1.642v-1.5Zm-4.584 6.084h5.334v-1.5H9.333v1.5Z' fill='%233858E9'/%3E%3C/svg%3E");background-position:100%;background-repeat:no-repeat;background-size:contain;content:"";display:inline-block;height:var(--local--icon-size);margin-right:calc(var(--local--icon-size)*-1 - .1em);opacity:0;vertical-align:baseline;width:calc(var(--local--icon-size) + .1em)}.is-toc-heading a:focus:after,.is-toc-heading a:hover:after,.is-toc-heading:focus a:after{opacity:1}.is-toc-heading:focus,.is-toc-heading:focus-visible{outline:none}.is-toc-heading:target{border-left:2px solid var(--wp--preset--color--blueberry-1);padding-left:8px}
</style>
<style id="wporg-two-factor-settings-style-inline-css" type="text/css">
.wp-block-wporg-two-factor-settings{position:relative}.wp-block-wporg-two-factor-settings h3{clear:none;font-size:14px}.bbp-single-user .wp-block-wporg-two-factor-settings input[type=email],.bbp-single-user .wp-block-wporg-two-factor-settings input[type=number],.bbp-single-user .wp-block-wporg-two-factor-settings input[type=password],.bbp-single-user .wp-block-wporg-two-factor-settings input[type=search],.bbp-single-user .wp-block-wporg-two-factor-settings input[type=text]{font-family:Open Sans,sans-serif;font-size:14px;padding:6px 10px}.wp-block-wporg-two-factor-settings .components-button{margin-right:20px}.wporg-2fa__navigation{justify-content:center!important;padding:24px 0!important;position:relative}.wporg-2fa__navigation a{align-items:center;display:flex;left:24px;position:absolute}.wporg-2fa__navigation svg{fill:#4ca6cf}.wporg-2fa__navigation h3{margin:unset;text-transform:capitalize}.wporg-2fa__token{letter-spacing:.3em}.components-notice{margin-left:0;margin-right:0}.components-notice.is-error,.components-notice.is-success{margin:0}.components-notice .components-notice__content{align-items:center;display:flex;gap:8px}.components-notice .components-notice__content svg{flex-shrink:0}.wporg-2fa__account-status .wporg-2fa__status-card:focus-within,.wporg-2fa__account-status .wporg-2fa__status-card:hover{z-index:1}.wporg-2fa__account-status .wporg-2fa__status-card a{display:block;text-decoration:none}.wporg-2fa__account-status .wporg-2fa__status-card a:focus,.wporg-2fa__account-status .wporg-2fa__status-card a:hover{outline:var(--wp-admin-border-width-focus) solid var(--wp-components-color-accent,var(--wp-admin-theme-color,#007cba));outline-offset:0}.wporg-2fa__account-status .wporg-2fa__status-card .components-card__body{grid-column-gap:10px;display:grid;grid-template-areas:"status header      open" "status description open";grid-template-columns:min-content auto min-content;padding:18px 14px}.wporg-2fa__account-status .wporg-2fa__status-card .components-card__body .wporg-2fa__status-icon{-ms-grid-row-span:2;align-self:center;grid-area:status;-ms-grid-column:1;-ms-grid-row:1}.wporg-2fa__account-status .wporg-2fa__status-card .components-card__body h3{align-self:end;color:#1e1e1e;font-size:1.1em;grid-area:header;-ms-grid-column:3;-ms-grid-row:1;margin:0}.wporg-2fa__account-status .wporg-2fa__status-card .components-card__body p{align-self:start;color:#757575;grid-area:description;-ms-grid-column:3;-ms-grid-row:2;margin:0}.wporg-2fa__account-status .wporg-2fa__status-card .components-card__body .wporg-2fa__status-card-open{-ms-grid-row-span:2;align-self:center;grid-area:open;-ms-grid-column:5;-ms-grid-row:1}.wporg-2fa__account-status .wporg-2fa__status-icon.is-enabled,.wporg-2fa__account-status .wporg-2fa__status-icon.is-ok{fill:#4ab866}.wporg-2fa__account-status .wporg-2fa__status-icon.is-pending{fill:#f0b849}.wporg-2fa__account-status .wporg-2fa__status-icon.is-disabled,.wporg-2fa__account-status .wporg-2fa__status-icon.is-error{fill:#cc1818}.bbp-single-user .wporg-2fa__password .wporg-2fa__password_container,.wporg-2fa__password .wporg-2fa__password_container{align-items:flex-start;justify-content:flex-start;position:relative;width:-moz-fit-content;width:fit-content}.bbp-single-user .wporg-2fa__password .wporg-2fa__password_container input,.wporg-2fa__password .wporg-2fa__password_container input{padding-right:35px}.bbp-single-user .wporg-2fa__password .wporg-2fa__show-password,.wporg-2fa__password .wporg-2fa__show-password{height:31px;margin:0;padding:0 5px;position:absolute;right:1px;top:24px}.wporg-2fa__email .components-notice.actions-on-right&gt;div{display:flex}.wporg-2fa__email .components-notice.actions-on-right&gt;div&gt;p{flex-grow:1;margin:initial}.wporg-2fa__email .email-error{color:#cc1818}.wporg-2fa__qr-code{text-align:center}#bbpress-forums .wporg-2fa__qr-code&gt;a{display:inline-block}#bbpress-forums .wporg-2fa__qr-code&gt;a:focus,#bbpress-forums .wporg-2fa__qr-code&gt;a:hover{box-shadow:0 0 0 var(--wp-admin-border-width-focus) var(--wp-components-color-accent,var(--wp-admin-theme-color,#007cba));outline:3px solid transparent}.wporg-2fa__manual-code{font-family:monospace;font-weight:700;letter-spacing:.1em}.wporg-2fa__verify-code{margin-bottom:20px;width:23ch}.wporg-2fa__submit-btn-wrapper{margin-bottom:15px}.wporg-2fa__enabled-status{color:#4ab866;text-transform:uppercase}.wporg-2fa__backup-codes .wporg-2fa__backup-codes-list{background-color:#ddd;margin:1em 0;padding:15px 20px}.wporg-2fa__backup-codes .wporg-2fa__backup-codes-list ol{-moz-column-count:2;-moz-column-width:110px;columns:110px 2;margin:0}.wporg-2fa__backup-codes .wporg-2fa__backup-codes-list li::marker{color:#757575}.wporg-2fa__backup-codes .components-notice{margin:0 0 1em}#bbpress-forums .wporg-2fa__backup-codes .wporg-2fa__backup-codes-list li{list-style-position:inside;list-style-type:decimal}#bbpress-forums .wporg-2fa__progress-bar,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar,.wporg-2fa__progress-bar{--color-enabled:#0475c4;--color-disabled:#ccc;--color-disabled-text:#757575;margin:0 -24px;position:relative}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-steps,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-steps,.wporg-2fa__progress-bar .wporg-2fa__setup-steps{display:flex;justify-content:space-evenly;position:relative;z-index:2}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-steps li,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-steps li,.wporg-2fa__progress-bar .wporg-2fa__setup-steps li{text-align:center}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-steps svg,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-steps svg,.wporg-2fa__progress-bar .wporg-2fa__setup-steps svg{border:1px solid;border-radius:30px;box-sizing:content-box;padding:15px}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-enabled,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-enabled,.wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-enabled{color:var(--color-enabled);font-weight:700}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-enabled svg,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-enabled svg,.wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-enabled svg{fill:#fff;background-color:var(--color-enabled);border-color:var(--color-enabled)}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-disabled,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-disabled,.wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-disabled{color:var(--color-disabled-text)}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-disabled svg,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-disabled svg,.wporg-2fa__progress-bar .wporg-2fa__setup-steps li.is-disabled svg{fill:var(--color-disabled);background-color:#fff;border-color:var(--color-disabled)}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-step-separators,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-step-separators,.wporg-2fa__progress-bar .wporg-2fa__setup-step-separators{display:flex;justify-content:space-between;position:absolute;top:27px;width:100%;z-index:1}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-step-separators li,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-step-separators li,.wporg-2fa__progress-bar .wporg-2fa__setup-step-separators li{flex-basis:33%;flex-grow:1;flex-shrink:1;height:3px}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-step-separators li.is-enabled,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-step-separators li.is-enabled,.wporg-2fa__progress-bar .wporg-2fa__setup-step-separators li.is-enabled{background-color:var(--color-enabled)}#bbpress-forums .wporg-2fa__progress-bar .wporg-2fa__setup-step-separators li.is-disabled,#bbpress-forums.bbpress-wrapper .wporg-2fa__progress-bar .wporg-2fa__setup-step-separators li.is-disabled,.wporg-2fa__progress-bar .wporg-2fa__setup-step-separators li.is-disabled{background-color:var(--color-disabled)}.wporg-2fa__global-notice{position:absolute;right:0;top:-60px;z-index:2}.wporg-2fa__global-notice .components-snackbar__content,.wporg-2fa__global-notice.components-snackbar{cursor:auto}.wporg-2fa__global-notice .components-snackbar__content{position:relative}.wporg-2fa__global-notice .components-snackbar .components-snackbar__icon,.wporg-2fa__global-notice .components-snackbar__icon{fill:#4ab866;left:-34px!important;position:absolute;top:-6px!important;width:30px}#bbpress-forums .wp-block-wporg-two-factor-settings a.components-button.is-secondary{box-shadow:inset 0 0 0 1px var(--wp-components-color-accent,var(--wp-admin-theme-color,#007cba));text-decoration:none}#bbpress-forums .wp-block-wporg-two-factor-settings a.components-button.is-secondary:not(:disabled):focus{box-shadow:inset 0 0 0 var(--wp-admin-border-width-focus) var(--wp-components-color-accent,var(--wp-admin-theme-color,#007cba));outline:3px solid transparent}
</style>
<link rel="stylesheet" id="dashicons-css" href="https://s.w.org/wp-includes/css/dashicons.min.css?ver=6.3-alpha-55651" type="text/css" media="all" />
<link rel="stylesheet" id="wp-components-css" href="https://wordpress.org/wp-content/plugins/gutenberg/build/components/style.css?ver=15.4.0" type="text/css" media="all" />
<link rel="stylesheet" id="mediaelement-css" href="https://wordpress.org/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.17" type="text/css" media="all" />
<link rel="stylesheet" id="wp-mediaelement-css" href="https://wordpress.org/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=6.3-alpha-55651" type="text/css" media="all" />
<link rel="stylesheet" id="classic-theme-styles-css" href="https://wordpress.org/wp-includes/css/classic-themes.min.css?ver=6.3-alpha-55651" type="text/css" media="all" />
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow &gt; .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow &gt; .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow &gt; .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained &gt; .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained &gt; .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained &gt; .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained &gt; :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained &gt; .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex &gt; *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
</style>
<link rel="stylesheet" id="wporg-global-fonts-css" href="https://wordpress.org/wp-content/mu-plugins/pub-sync/global-fonts/style.css?ver=1675220034" type="text/css" media="all" />
<link rel="stylesheet" id="wporg-global-header-footer-css" href="https://wordpress.org/wp-content/mu-plugins/pub-sync/blocks/global-header-footer/build/style.css?ver=1681488560" type="text/css" media="all" />
<script type="text/javascript" src="https://wordpress.org/wp-content/plugins/gutenberg/build/block-library/blocks/navigation/view.min.js?ver=aa58d4d058136adf2722" id="wp-block-navigation-view-js"></script>
<script type="text/javascript" src="https://wordpress.org/wp-content/plugins/gutenberg/build/block-library/blocks/navigation/view-modal.min.js?ver=774770b5630ff20f41e1" id="wp-block-navigation-view-modal-js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com" /><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="" />
	<style>img#wpstats{display:none}</style>
		<link rel="icon" href="https://s.w.org/style/trac/common/trac.ico?v=67c19393add65fcabf9516a6475c2be5" sizes="32x32" />
<link rel="icon" href="https://s.w.org/style/trac/common/trac.ico?v=67c19393add65fcabf9516a6475c2be5" sizes="192x192" />
<link rel="apple-touch-icon" href="https://s.w.org/images/wmark.png" />
<meta name="msapplication-TileImage" content="https://s.w.org/images/wmark.png" />
	
	<meta name="viewport" content="width=device-width" />
	<link rel="stylesheet" href="https://s.w.org/wp-includes/css/dashicons.min.css?20150710" type="text/css" />
	<link rel="stylesheet" type="text/css" href="https://s.w.org/style/trac/wp-trac.css?212" />
	<script src="https://s.w.org/style/trac/common/js/jquery.js?v=212"></script>
	<script src="https://s.w.org/style/trac/common/js/babel.js?v=212"></script>
	<script src="https://s.w.org/style/trac/common/js/trac.js?v=212"></script>
	<script src="https://s.w.org/style/trac/common/js/search.js?v=212"></script>
    <script type="text/javascript">
      jQuery("#trac-noscript").remove();
      jQuery(document).ready(function($) {
        $(".trac-autofocus").focus();
        $(".trac-target-new").attr("target", "_blank");
        if ($.ui) { /* is jquery-ui added? */
          $(".trac-datepicker:not([readonly])").prop("autocomplete", "off").datepicker();
          $(".trac-datetimepicker:not([readonly])").prop("autocomplete", "off").datetimepicker();
          $("#main").addClass("trac-nodatetimehint");
        }
        $(".trac-disable").disableSubmit(".trac-disable-determinant");
        setTimeout(function() { $(".trac-scroll").scrollToTop() }, 1);
        $(".trac-disable-on-submit").disableOnSubmit();
      });
    </script>
	<script src="https://s.w.org/style/trac/common/js/folding.js?v=212"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $(".trac-toggledeleted").show().click(function() {
                  $(this).siblings().find(".trac-deleted").toggle();
                  return false;
        }).click();
        $("#jumploc input").hide();
        $("#jumploc select").change(function () {
          this.parentNode.parentNode.submit();
        });
          $('#preview table.code').enableCollapsibleColumns($('#preview table.code thead th.content'));
      });
    </script>
  </head>
  <body id="wordpress-org" class="plugins trac wporg-make make-plugins">
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5Z8B3BX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	
		<a id="wporg-skip-link" tabindex="" class="skip-link screen-reader-text" href="#main" data-selector="#main">Skip to content</a>
<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0.49803921568627"></fefuncr><fefuncg type="table" tablevalues="0 0.49803921568627"></fefuncg><fefuncb type="table" tablevalues="0 0.49803921568627"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.54901960784314 0.98823529411765"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.71764705882353 0.25490196078431"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 0.27843137254902"></fefuncg><fefuncb type="table" tablevalues="0.5921568627451 0.27843137254902"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0"></fefuncr><fefuncg type="table" tablevalues="0 0.64705882352941"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.78039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.94901960784314"></fefuncg><fefuncb type="table" tablevalues="0.35294117647059 0.47058823529412"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.65098039215686 0.40392156862745"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.44705882352941 0.4"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.098039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.66274509803922"></fefuncg><fefuncb type="table" tablevalues="0.84705882352941 0.41960784313725"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P24PF4B" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<header class="global-header wp-block-group wp-block-wporg-global-header">
<figure class="wp-block-image global-header__wporg-logo-mark">
	<a href="https://wordpress.org/">
		<svg xmlns="http://www.w3.org/2000/svg" role="img" width="28" height="28" viewbox="0 0 28 28">
	<title>WordPress.org</title>
	<path fill="currentColor" d="M13.6052 0.923525C16.1432 0.923525 18.6137 1.67953 20.7062 3.09703C22.7447 4.47403 24.3512 6.41803 25.3097 8.68603C26.9837 12.6415 26.5382 17.164 24.1352 20.7145C22.7582 22.753 20.8142 24.3595 18.5462 25.318C14.5907 26.992 10.0682 26.5465 6.51772 24.1435C4.47922 22.7665 2.87272 20.8225 1.91422 18.5545C0.240225 14.599 0.685725 10.0765 3.08872 6.52603C4.46572 4.48753 6.40973 2.88103 8.67772 1.92253C10.2302 1.26103 11.9177 0.923525 13.6052 0.923525ZM13.6052 0.113525C6.15322 0.113525 0.105225 6.16153 0.105225 13.6135C0.105225 21.0655 6.15322 27.1135 13.6052 27.1135C21.0572 27.1135 27.1052 21.0655 27.1052 13.6135C27.1052 6.16153 21.0572 0.113525 13.6052 0.113525Z"></path>
	<path fill="currentColor" d="M2.36011 13.6133C2.36011 17.9198 4.81711 21.8618 8.70511 23.7383L3.33211 9.03684C2.68411 10.4813 2.36011 12.0338 2.36011 13.6133ZM21.2061 13.0463C21.2061 11.6558 20.7066 10.6973 20.2746 9.94134C19.8426 9.18534 19.1676 8.22684 19.1676 7.30884C19.1676 6.39084 19.9506 5.31084 21.0576 5.31084H21.2061C16.6296 1.11234 9.51511 1.42284 5.31661 6.01284C4.91161 6.45834 4.53361 6.93084 4.20961 7.43034H4.93861C6.11311 7.43034 7.93561 7.28184 7.93561 7.28184C8.54311 7.24134 8.61061 8.13234 8.00311 8.21334C8.00311 8.21334 7.39561 8.28084 6.72061 8.32134L10.8111 20.5118L13.2681 13.1273L11.5131 8.32134C10.9056 8.28084 10.3386 8.21334 10.3386 8.21334C9.73111 8.17284 9.79861 7.25484 10.4061 7.28184C10.4061 7.28184 12.2691 7.43034 13.3626 7.43034C14.4561 7.43034 16.3596 7.28184 16.3596 7.28184C16.9671 7.24134 17.0346 8.13234 16.4271 8.21334C16.4271 8.21334 15.8196 8.28084 15.1446 8.32134L19.2081 20.4173L20.3691 16.7453C20.8821 15.1388 21.1926 14.0048 21.1926 13.0328L21.2061 13.0463ZM13.7946 14.5853L10.4196 24.3998C12.6876 25.0613 15.1041 25.0073 17.3316 24.2243L17.2506 24.0758L13.7946 14.5853ZM23.4741 8.21334C23.5281 8.59134 23.5551 8.98284 23.5551 9.37434C23.5551 10.5218 23.3391 11.8043 22.7046 13.3973L19.2621 23.3333C24.5271 20.2688 26.4036 13.5593 23.4741 8.21334Z"></path>
</svg>	</a>
</figure>
<nav class="is-responsive global-header__navigation wp-block-navigation is-horizontal is-layout-flex wp-block-navigation-is-layout-flex" aria-label=""><button aria-haspopup="true" aria-label="Open menu" class="wp-block-navigation__responsive-container-open " data-micromodal-trigger="modal-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><rect x="4" y="7.5" width="16" height="1.5"></rect><rect x="4" y="15" width="16" height="1.5"></rect></svg></button>
			<div class="wp-block-navigation__responsive-container  " style="" id="modal-1">
				<div class="wp-block-navigation__responsive-close" tabindex="-1" data-micromodal-close="">
					<div class="wp-block-navigation__responsive-dialog" aria-label="Menu">
							<button aria-label="Close menu" data-micromodal-close="" class="wp-block-navigation__responsive-container-close"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" width="24" height="24" aria-hidden="true" focusable="false"><path d="M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"></path></svg></button>
						<div class="wp-block-navigation__responsive-container-content" id="modal-1-content">
							<ul class="wp-block-navigation__container"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/news/"><span class="wp-block-navigation-item__label">News</span></a></li><li class=" wp-block-navigation-item has-child open-on-hover-click wp-block-navigation-submenu"><a class="wp-block-navigation-item__content" href="https://wordpress.org/download/">Download &amp; Extend</a><button aria-label="Download &amp; Extend submenu" class="wp-block-navigation__submenu-icon wp-block-navigation-submenu__toggle" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewbox="0 0 12 12" fill="none" aria-hidden="true" focusable="false"><path d="M1.50002 4L6.00002 8L10.5 4" stroke-width="1.5"></path></svg></button><ul class="wp-block-navigation__submenu-container wp-block-navigation-submenu"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/download/"><span class="wp-block-navigation-item__label">Get WordPress</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/themes/"><span class="wp-block-navigation-item__label">Themes</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/patterns/"><span class="wp-block-navigation-item__label">Patterns</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/plugins/"><span class="wp-block-navigation-item__label">Plugins</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/mobile/"><span class="wp-block-navigation-item__label">Mobile</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/hosting/"><span class="wp-block-navigation-item__label">Hosting</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://openverse.org/"><span class="wp-block-navigation-item__label">Openverse ↗︎</span></a></li></ul></li><li class=" wp-block-navigation-item has-child open-on-hover-click wp-block-navigation-submenu"><a class="wp-block-navigation-item__content" href="https://learn.wordpress.org/">Learn</a><button aria-label="Learn submenu" class="wp-block-navigation__submenu-icon wp-block-navigation-submenu__toggle" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewbox="0 0 12 12" fill="none" aria-hidden="true" focusable="false"><path d="M1.50002 4L6.00002 8L10.5 4" stroke-width="1.5"></path></svg></button><ul class="wp-block-navigation__submenu-container wp-block-navigation-submenu"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://learn.wordpress.org/"><span class="wp-block-navigation-item__label">Learn WordPress</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/documentation/"><span class="wp-block-navigation-item__label">Documentation</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/support/forums/"><span class="wp-block-navigation-item__label">Forums</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://developer.wordpress.org/"><span class="wp-block-navigation-item__label">Developers</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.tv/"><span class="wp-block-navigation-item__label">WordPress.tv ↗︎</span></a></li></ul></li><li class=" wp-block-navigation-item has-child open-on-hover-click wp-block-navigation-submenu"><a class="wp-block-navigation-item__content" href="https://make.wordpress.org/">Community</a><button aria-label="Community submenu" class="wp-block-navigation__submenu-icon wp-block-navigation-submenu__toggle" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewbox="0 0 12 12" fill="none" aria-hidden="true" focusable="false"><path d="M1.50002 4L6.00002 8L10.5 4" stroke-width="1.5"></path></svg></button><ul class="wp-block-navigation__submenu-container wp-block-navigation-submenu"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://make.wordpress.org/"><span class="wp-block-navigation-item__label">Make WordPress</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/photos/"><span class="wp-block-navigation-item__label">Photo Directory</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/five-for-the-future/"><span class="wp-block-navigation-item__label">Five for the Future</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://central.wordcamp.org/"><span class="wp-block-navigation-item__label">WordCamp ↗︎</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://www.meetup.com/pro/wordpress/"><span class="wp-block-navigation-item__label">Meetups ↗︎</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://jobs.wordpress.net/"><span class="wp-block-navigation-item__label">Job Board ↗︎</span></a></li></ul></li><li class=" wp-block-navigation-item has-child open-on-hover-click wp-block-navigation-submenu"><a class="wp-block-navigation-item__content" href="https://wordpress.org/about/">About</a><button aria-label="About submenu" class="wp-block-navigation__submenu-icon wp-block-navigation-submenu__toggle" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewbox="0 0 12 12" fill="none" aria-hidden="true" focusable="false"><path d="M1.50002 4L6.00002 8L10.5 4" stroke-width="1.5"></path></svg></button><ul class="wp-block-navigation__submenu-container wp-block-navigation-submenu"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/about/"><span class="wp-block-navigation-item__label">About WordPress</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/showcase/"><span class="wp-block-navigation-item__label">Showcase</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/enterprise/"><span class="wp-block-navigation-item__label">Enterprise</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/gutenberg/"><span class="wp-block-navigation-item__label">Gutenberg ↗︎</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://mercantile.wordpress.org/"><span class="wp-block-navigation-item__label">WordPress Swag Store ↗︎</span></a></li></ul></li><li class=" wp-block-navigation-item global-header__mobile-get-wordpress global-header__get-wordpress wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/download/"><span class="wp-block-navigation-item__label">Get WordPress</span></a></li></ul>
						</div>
					</div>
				</div>
			</div></nav>
<nav class="is-responsive  is-vertical global-header__search wp-block-navigation is-layout-flex wp-container-6 wp-block-navigation-is-layout-flex" aria-label=""><button aria-haspopup="true" aria-label="Open menu" class="wp-block-navigation__responsive-container-open always-shown" data-micromodal-trigger="modal-5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><rect x="4" y="7.5" width="16" height="1.5"></rect><rect x="4" y="15" width="16" height="1.5"></rect></svg></button>
			<div class="wp-block-navigation__responsive-container hidden-by-default " style="" id="modal-5">
				<div class="wp-block-navigation__responsive-close" tabindex="-1" data-micromodal-close="">
					<div class="wp-block-navigation__responsive-dialog" aria-label="Menu">
							<button aria-label="Close menu" data-micromodal-close="" class="wp-block-navigation__responsive-container-close"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" width="24" height="24" aria-hidden="true" focusable="false"><path d="M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"></path></svg></button>
						<div class="wp-block-navigation__responsive-container-content" id="modal-5-content">
							<form role="search" method="GET" action="/search" class="wp-block-search__button-inside wp-block-search__icon-button wp-block-search"><label for="wp-block-search__input-4" class="wp-block-search__label">Search Trac</label><div class="wp-block-search__inside-wrapper "><input type="search" id="wp-block-search__input-4" class="wp-block-search__input" name="q" value="" placeholder="Type to search…" required="" /><button type="submit" class="wp-block-search__button has-icon wp-element-button" aria-label="Search"><svg class="search-icon" viewbox="0 0 24 24" width="24" height="24">
					<path d="M13.5 6C10.5 6 8 8.5 8 11.5c0 1.1.3 2.1.9 3l-3.4 3 1 1.1 3.4-2.9c1 .9 2.2 1.4 3.6 1.4 3 0 5.5-2.5 5.5-5.5C19 8.5 16.5 6 13.5 6zm0 9.5c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z"></path>
				</svg></button></div></form>
						</div>
					</div>
				</div>
			</div></nav>
<div class="global-header__desktop-get-wordpress-container is-layout-flow wp-block-group-is-layout-flow">
	<a href="https://wordpress.org/download/" class="global-header__desktop-get-wordpress global-header__get-wordpress">
		Get WordPress	</a>
</div>
</header>
	
	<div id="headline" class="no-menu">
		<div class="wrapper">
			<h2><a href="//wordpress.org/plugins/">Plugin Directory</a></h2>
		</div>
	</div>

    <div id="banner">
      <form id="search" action="/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="last first">
	<a href="https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Ffeedzy-rss-feeds%2Ftags%2F4.4.2%2Fincludes%2Fadmin%2Ffeedzy-rss-feeds-import.php" class="login">Login</a>
</li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="/timeline">Timeline</a></li><li><a href="/report">View Tickets</a></li><li class="last active"><a href="/browser">Browse Source</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li class="first"><span>&larr; <a class="prev" href="/browser/feedzy-rss-feeds/trunk/includes/admin/feedzy-rss-feeds-import.php?rev=3020937" title="Revision 3020937">Previous Revision</a></span></li><li><span><a class="next" href="/browser/feedzy-rss-feeds/trunk/includes/admin/feedzy-rss-feeds-import.php?rev=3033749" title="Revision 3033749">Next Revision</a> &rarr;</span></li><li><a href="/browser/feedzy-rss-feeds/trunk/includes/admin/feedzy-rss-feeds-import.php?annotate=blame" title="Annotate each line with the last changed revision (this can be time consuming...)">Blame</a></li><li class="last"><a href="/log/feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php">Revision Log</a></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="browser">
        <h1>
          
<a class="pathentry first" href="/browser?order=name" title="Go to repository root">source:</a>
<a class="pathentry" href="/browser/feedzy-rss-feeds?order=name" title="View feedzy-rss-feeds">feedzy-rss-feeds</a><span class="pathentry sep">/</span><a class="pathentry" href="/browser/feedzy-rss-feeds/tags?order=name" title="View tags">tags</a><span class="pathentry sep">/</span><a class="pathentry" href="/browser/feedzy-rss-feeds/tags/4.4.2?order=name" title="View 4.4.2">4.4.2</a><span class="pathentry sep">/</span><a class="pathentry" href="/browser/feedzy-rss-feeds/tags/4.4.2/includes?order=name" title="View includes">includes</a><span class="pathentry sep">/</span><a class="pathentry" href="/browser/feedzy-rss-feeds/tags/4.4.2/includes/admin?order=name" title="View admin">admin</a><span class="pathentry sep">/</span><a class="pathentry" href="/browser/feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php?order=name" title="View feedzy-rss-feeds-import.php">feedzy-rss-feeds-import.php</a>
<br style="clear: both" />

        </h1>
        <div id="diffrev">
          <form action="/changeset" method="get">
            <div>
              <label title="Show the diff against a specific revision">
                View diff against: <input type="text" name="old" size="6" />
                <input type="hidden" name="old_path" value="feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php" />
                <input type="hidden" name="new" />
                <input type="hidden" name="new_path" value="feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php" />
              </label>
            </div>
          </form>
        </div>
        <div id="jumprev">
          <form action="" method="get">
            <div>
              <label for="rev">
                View revision:</label>
              <input type="text" id="rev" name="rev" size="6" />
            </div>
          </form>
        </div>
        <div class="trac-tags">
        </div>
      <table id="info" summary="Revision info">
        <tr>
          <th>
                <a href="/changeset/3026692/feedzy-rss-feeds/trunk/includes/admin/feedzy-rss-feeds-import.php" title="View differences">Last change</a>
                  on this file was
                  <a href="/changeset/3026692/" title="View changeset 3026692">3026692</a>,
                  checked in by <span class="trac-author">themeisle</span>, <a class="timeline" href="/timeline?from=2024-01-25T10%3A15%3A51Z&amp;precision=second" title="See timeline at 01/25/2024 10:15:51 AM">12 months ago</a>
          </th>
        </tr>
        <tr>
          <td class="message searchable">
              <p>
Update to version 4.4.0 from GitHub<br />
</p>
          </td>
        </tr>
        <tr><td colspan="2">
            <strong>File size:</strong>
            <span title="102974 bytes">100.6 KB</span>
          </td></tr>
      </table>
      <div id="preview" class="searchable">
        
  <table class="code"><thead><tr><th class="lineno" title="Line numbers">Line</th><th class="content"> </th></tr></thead><tbody><tr><th id="L1"><a href="#L1">1</a></th><td><span class="cp">&lt;?php</span></td></tr><tr><th id="L2"><a href="#L2">2</a></th><td><span class="sd">/**</span></td></tr><tr><th id="L3"><a href="#L3">3</a></th><td><span class="sd"> * The admin-specific functionality of the plugin.</span></td></tr><tr><th id="L4"><a href="#L4">4</a></th><td><span class="sd"> *</span></td></tr><tr><th id="L5"><a href="#L5">5</a></th><td><span class="sd"> * @link       http://themeisle.com/plugins/feedzy-rss-feed/</span></td></tr><tr><th id="L6"><a href="#L6">6</a></th><td><span class="sd"> * @since      1.0.0</span></td></tr><tr><th id="L7"><a href="#L7">7</a></th><td><span class="sd"> *</span></td></tr><tr><th id="L8"><a href="#L8">8</a></th><td><span class="sd"> * @package    feedzy-rss-feeds</span></td></tr><tr><th id="L9"><a href="#L9">9</a></th><td><span class="sd"> * @subpackage feedzy-rss-feeds/includes/admin</span></td></tr><tr><th id="L10"><a href="#L10">10</a></th><td><span class="sd"> */</span></td></tr><tr><th id="L11"><a href="#L11">11</a></th><td><span class="sd">/**</span></td></tr><tr><th id="L12"><a href="#L12">12</a></th><td><span class="sd"> * The admin-specific functionality of the plugin.</span></td></tr><tr><th id="L13"><a href="#L13">13</a></th><td><span class="sd"> *</span></td></tr><tr><th id="L14"><a href="#L14">14</a></th><td><span class="sd"> * Defines the plugin name, version, and two examples hooks for how to</span></td></tr><tr><th id="L15"><a href="#L15">15</a></th><td><span class="sd"> * enqueue the admin-specific stylesheet and JavaScript.</span></td></tr><tr><th id="L16"><a href="#L16">16</a></th><td><span class="sd"> *</span></td></tr><tr><th id="L17"><a href="#L17">17</a></th><td><span class="sd"> * @package    feedzy-rss-feeds</span></td></tr><tr><th id="L18"><a href="#L18">18</a></th><td><span class="sd"> * @subpackage feedzy-rss-feeds/includes/admin</span></td></tr><tr><th id="L19"><a href="#L19">19</a></th><td><span class="sd"> * @author     Bogdan Preda &lt;bogdan.preda@themeisle.com&gt;</span></td></tr><tr><th id="L20"><a href="#L20">20</a></th><td><span class="sd"> */</span></td></tr><tr><th id="L21"><a href="#L21">21</a></th><td></td></tr><tr><th id="L22"><a href="#L22">22</a></th><td><span class="sd">/**</span></td></tr><tr><th id="L23"><a href="#L23">23</a></th><td><span class="sd"> * Class Feedzy_Rss_Feeds_Import</span></td></tr><tr><th id="L24"><a href="#L24">24</a></th><td><span class="sd"> */</span></td></tr><tr><th id="L25"><a href="#L25">25</a></th><td><span class="k">class</span> <span class="nc">Feedzy_Rss_Feeds_Import</span> <span class="p">{</span></td></tr><tr><th id="L26"><a href="#L26">26</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L27"><a href="#L27">27</a></th><td><span class="sd">         * The ID of this plugin.</span></td></tr><tr><th id="L28"><a href="#L28">28</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L29"><a href="#L29">29</a></th><td><span class="sd">         * @since    1.0.0</span></td></tr><tr><th id="L30"><a href="#L30">30</a></th><td><span class="sd">         * @access   private</span></td></tr><tr><th id="L31"><a href="#L31">31</a></th><td><span class="sd">         * @var      string $plugin_name The ID of this plugin.</span></td></tr><tr><th id="L32"><a href="#L32">32</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L33"><a href="#L33">33</a></th><td>        <span class="k">private</span> <span class="nv">$plugin_name</span><span class="p">;</span></td></tr><tr><th id="L34"><a href="#L34">34</a></th><td></td></tr><tr><th id="L35"><a href="#L35">35</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L36"><a href="#L36">36</a></th><td><span class="sd">         * The version of this plugin.</span></td></tr><tr><th id="L37"><a href="#L37">37</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L38"><a href="#L38">38</a></th><td><span class="sd">         * @since    1.0.0</span></td></tr><tr><th id="L39"><a href="#L39">39</a></th><td><span class="sd">         * @access   private</span></td></tr><tr><th id="L40"><a href="#L40">40</a></th><td><span class="sd">         * @var      string $version The current version of this plugin.</span></td></tr><tr><th id="L41"><a href="#L41">41</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L42"><a href="#L42">42</a></th><td>        <span class="k">private</span> <span class="nv">$version</span><span class="p">;</span></td></tr><tr><th id="L43"><a href="#L43">43</a></th><td></td></tr><tr><th id="L44"><a href="#L44">44</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L45"><a href="#L45">45</a></th><td><span class="sd">         * The settings for Feedzy PRO services.</span></td></tr><tr><th id="L46"><a href="#L46">46</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L47"><a href="#L47">47</a></th><td><span class="sd">         * @since   1.3.2</span></td></tr><tr><th id="L48"><a href="#L48">48</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L49"><a href="#L49">49</a></th><td><span class="sd">         * @var     array $settings The settings for Feedzy PRO.</span></td></tr><tr><th id="L50"><a href="#L50">50</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L51"><a href="#L51">51</a></th><td>        <span class="k">private</span> <span class="nv">$settings</span><span class="p">;</span></td></tr><tr><th id="L52"><a href="#L52">52</a></th><td></td></tr><tr><th id="L53"><a href="#L53">53</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L54"><a href="#L54">54</a></th><td><span class="sd">         * The settings for Feedzy free.</span></td></tr><tr><th id="L55"><a href="#L55">55</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L56"><a href="#L56">56</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L57"><a href="#L57">57</a></th><td><span class="sd">         * @var     array $settings The settings for Feedzy free.</span></td></tr><tr><th id="L58"><a href="#L58">58</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L59"><a href="#L59">59</a></th><td>        <span class="k">private</span> <span class="nv">$free_settings</span><span class="p">;</span></td></tr><tr><th id="L60"><a href="#L60">60</a></th><td></td></tr><tr><th id="L61"><a href="#L61">61</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L62"><a href="#L62">62</a></th><td><span class="sd">         * Initialize the class and set its properties.</span></td></tr><tr><th id="L63"><a href="#L63">63</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L64"><a href="#L64">64</a></th><td><span class="sd">         * @param string $plugin_name The name of this plugin.</span></td></tr><tr><th id="L65"><a href="#L65">65</a></th><td><span class="sd">         * @param string $version The version of this plugin.</span></td></tr><tr><th id="L66"><a href="#L66">66</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L67"><a href="#L67">67</a></th><td><span class="sd">         * @since       1.0.0</span></td></tr><tr><th id="L68"><a href="#L68">68</a></th><td><span class="sd">         * @access      public</span></td></tr><tr><th id="L69"><a href="#L69">69</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L70"><a href="#L70">70</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span> <span class="nv">$plugin_name</span><span class="p">,</span> <span class="nv">$version</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L71"><a href="#L71">71</a></th><td>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">=</span> <span class="nv">$plugin_name</span><span class="p">;</span></td></tr><tr><th id="L72"><a href="#L72">72</a></th><td>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span>     <span class="o">=</span> <span class="nv">$version</span><span class="p">;</span></td></tr><tr><th id="L73"><a href="#L73">73</a></th><td></td></tr><tr><th id="L74"><a href="#L74">74</a></th><td>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">settings</span>      <span class="o">=</span> <span class="nx">get_option</span><span class="p">(</span> <span class="s1">'feedzy-rss-feeds-settings'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span></td></tr><tr><th id="L75"><a href="#L75">75</a></th><td>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span> <span class="o">=</span> <span class="nx">get_option</span><span class="p">(</span> <span class="s1">'feedzy-settings'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span></td></tr><tr><th id="L76"><a href="#L76">76</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L77"><a href="#L77">77</a></th><td></td></tr><tr><th id="L78"><a href="#L78">78</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L79"><a href="#L79">79</a></th><td><span class="sd">         * Adds the class to the div that shows the upsell.</span></td></tr><tr><th id="L80"><a href="#L80">80</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L81"><a href="#L81">81</a></th><td><span class="sd">         * @since       ?</span></td></tr><tr><th id="L82"><a href="#L82">82</a></th><td><span class="sd">         * @access      public</span></td></tr><tr><th id="L83"><a href="#L83">83</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L84"><a href="#L84">84</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">upsell_class</span><span class="p">(</span> <span class="nv">$class</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L85"><a href="#L85">85</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L86"><a href="#L86">86</a></th><td>                        <span class="nv">$class</span> <span class="o">=</span> <span class="s1">'only-pro'</span><span class="p">;</span></td></tr><tr><th id="L87"><a href="#L87">87</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L88"><a href="#L88">88</a></th><td></td></tr><tr><th id="L89"><a href="#L89">89</a></th><td>                <span class="k">return</span> <span class="nv">$class</span><span class="p">;</span></td></tr><tr><th id="L90"><a href="#L90">90</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L91"><a href="#L91">91</a></th><td></td></tr><tr><th id="L92"><a href="#L92">92</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L93"><a href="#L93">93</a></th><td><span class="sd">         * Adds the content to the div that shows the upsell.</span></td></tr><tr><th id="L94"><a href="#L94">94</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L95"><a href="#L95">95</a></th><td><span class="sd">         * @since       ?</span></td></tr><tr><th id="L96"><a href="#L96">96</a></th><td><span class="sd">         * @access      public</span></td></tr><tr><th id="L97"><a href="#L97">97</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L98"><a href="#L98">98</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">upsell_content</span><span class="p">(</span> <span class="nv">$content</span><span class="p">,</span> <span class="nv">$area</span><span class="p">,</span> <span class="nv">$location</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L99"><a href="#L99">99</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L100"><a href="#L100">100</a></th><td>                        <span class="nv">$content</span> <span class="o">=</span> <span class="s1">'</span></td></tr><tr><th id="L101"><a href="#L101">101</a></th><td><span class="s1">                        &lt;div class="only-pro-content"&gt;</span></td></tr><tr><th id="L102"><a href="#L102">102</a></th><td><span class="s1">                                &lt;div class="only-pro-container"&gt;</span></td></tr><tr><th id="L103"><a href="#L103">103</a></th><td><span class="s1">                                        &lt;div class="only-pro-inner upgrade-alert"&gt;</span></td></tr><tr><th id="L104"><a href="#L104">104</a></th><td><span class="s1">                                                '</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'This feature is available in the Pro version.  Unlock more features, by'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'</span></td></tr><tr><th id="L105"><a href="#L105">105</a></th><td><span class="s1">                                                &lt;a target="_blank" href="'</span> <span class="o">.</span> <span class="nx">tsdk_utmify</span><span class="p">(</span> <span class="nx">FEEDZY_UPSELL_LINK</span><span class="p">,</span> <span class="nv">$area</span><span class="p">,</span> <span class="nv">$location</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'" title="'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Buy Now'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'"&gt;'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'upgrading to Feedzy Pro'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;/a&gt;</span></td></tr><tr><th id="L106"><a href="#L106">106</a></th><td><span class="s1">                                        &lt;/div&gt;</span></td></tr><tr><th id="L107"><a href="#L107">107</a></th><td><span class="s1">                                &lt;/div&gt;</span></td></tr><tr><th id="L108"><a href="#L108">108</a></th><td><span class="s1">                        &lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L109"><a href="#L109">109</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L110"><a href="#L110">110</a></th><td></td></tr><tr><th id="L111"><a href="#L111">111</a></th><td>                <span class="k">return</span> <span class="nv">$content</span><span class="p">;</span></td></tr><tr><th id="L112"><a href="#L112">112</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L113"><a href="#L113">113</a></th><td></td></tr><tr><th id="L114"><a href="#L114">114</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L115"><a href="#L115">115</a></th><td><span class="sd">         * Register the stylesheets for the admin area.</span></td></tr><tr><th id="L116"><a href="#L116">116</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L117"><a href="#L117">117</a></th><td><span class="sd">         * @since       1.0.0</span></td></tr><tr><th id="L118"><a href="#L118">118</a></th><td><span class="sd">         * @access      public</span></td></tr><tr><th id="L119"><a href="#L119">119</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L120"><a href="#L120">120</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">enqueue_styles</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L121"><a href="#L121">121</a></th><td>                <span class="nx">wp_enqueue_style</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span><span class="p">,</span> <span class="nx">FEEDZY_ABSURL</span> <span class="o">.</span> <span class="s1">'css/feedzy-rss-feed-import.css'</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">,</span> <span class="s1">'all'</span> <span class="p">);</span></td></tr><tr><th id="L122"><a href="#L122">122</a></th><td>                <span class="nx">wp_register_style</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_chosen'</span><span class="p">,</span> <span class="nx">FEEDZY_ABSURL</span> <span class="o">.</span> <span class="s1">'includes/views/css/chosen.css'</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">,</span> <span class="s1">'all'</span> <span class="p">);</span></td></tr><tr><th id="L123"><a href="#L123">123</a></th><td>                <span class="nx">wp_register_script</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_chosen_script'</span><span class="p">,</span> <span class="nx">FEEDZY_ABSURL</span> <span class="o">.</span> <span class="s1">'includes/views/js/chosen.js'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'jquery'</span> <span class="p">),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L124"><a href="#L124">124</a></th><td></td></tr><tr><th id="L125"><a href="#L125">125</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">get_current_screen</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">post_type</span> <span class="o">===</span> <span class="s1">'feedzy_imports'</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L126"><a href="#L126">126</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">did_action</span><span class="p">(</span> <span class="s1">'wp_enqueue_media'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L127"><a href="#L127">127</a></th><td>                                <span class="nx">wp_enqueue_media</span><span class="p">();</span></td></tr><tr><th id="L128"><a href="#L128">128</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L129"><a href="#L129">129</a></th><td>                        <span class="nx">wp_enqueue_style</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_chosen'</span><span class="p">,</span> <span class="nx">FEEDZY_ABSURL</span> <span class="o">.</span> <span class="s1">'includes/views/css/chosen.css'</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">,</span> <span class="s1">'all'</span> <span class="p">);</span></td></tr><tr><th id="L130"><a href="#L130">130</a></th><td>                        <span class="nx">wp_enqueue_style</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_tagify'</span><span class="p">,</span> <span class="nx">FEEDZY_ABSURL</span> <span class="o">.</span> <span class="s1">'includes/views/css/tagify.css'</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">,</span> <span class="s1">'all'</span> <span class="p">);</span></td></tr><tr><th id="L131"><a href="#L131">131</a></th><td>                        <span class="nx">wp_enqueue_style</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_metabox_edit'</span><span class="p">,</span> <span class="nx">FEEDZY_ABSURL</span> <span class="o">.</span> <span class="s1">'includes/views/css/import-metabox-edit.css'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'wp-jquery-ui-dialog'</span> <span class="p">),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">,</span> <span class="s1">'all'</span> <span class="p">);</span></td></tr><tr><th id="L132"><a href="#L132">132</a></th><td>                        <span class="nx">wp_enqueue_script</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_chosen_script'</span><span class="p">,</span> <span class="nx">FEEDZY_ABSURL</span> <span class="o">.</span> <span class="s1">'includes/views/js/chosen.js'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'jquery'</span> <span class="p">),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L133"><a href="#L133">133</a></th><td>                        <span class="nx">wp_enqueue_script</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_tagify_script'</span><span class="p">,</span> <span class="nx">FEEDZY_ABSURL</span> <span class="o">.</span> <span class="s1">'includes/views/js/jquery.tagify.min.js'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'jquery'</span> <span class="p">),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L134"><a href="#L134">134</a></th><td>                        <span class="nx">wp_enqueue_script</span><span class="p">(</span></td></tr><tr><th id="L135"><a href="#L135">135</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_metabox_edit_script'</span><span class="p">,</span></td></tr><tr><th id="L136"><a href="#L136">136</a></th><td>                                <span class="nx">FEEDZY_ABSURL</span> <span class="o">.</span> <span class="s1">'includes/views/js/import-metabox-edit.js'</span><span class="p">,</span></td></tr><tr><th id="L137"><a href="#L137">137</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L138"><a href="#L138">138</a></th><td>                                        <span class="s1">'jquery'</span><span class="p">,</span></td></tr><tr><th id="L139"><a href="#L139">139</a></th><td>                                        <span class="s1">'jquery-ui-dialog'</span><span class="p">,</span></td></tr><tr><th id="L140"><a href="#L140">140</a></th><td>                                        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_chosen_script'</span><span class="p">,</span></td></tr><tr><th id="L141"><a href="#L141">141</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L142"><a href="#L142">142</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">,</span></td></tr><tr><th id="L143"><a href="#L143">143</a></th><td>                                <span class="k">true</span></td></tr><tr><th id="L144"><a href="#L144">144</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L145"><a href="#L145">145</a></th><td>                        <span class="nx">wp_localize_script</span><span class="p">(</span></td></tr><tr><th id="L146"><a href="#L146">146</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">plugin_name</span> <span class="o">.</span> <span class="s1">'_metabox_edit_script'</span><span class="p">,</span></td></tr><tr><th id="L147"><a href="#L147">147</a></th><td>                                <span class="s1">'feedzy'</span><span class="p">,</span></td></tr><tr><th id="L148"><a href="#L148">148</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L149"><a href="#L149">149</a></th><td>                                        <span class="s1">'ajax'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L150"><a href="#L150">150</a></th><td>                                                <span class="s1">'security'</span> <span class="o">=&gt;</span> <span class="nx">wp_create_nonce</span><span class="p">(</span> <span class="nx">FEEDZY_BASEFILE</span> <span class="p">),</span></td></tr><tr><th id="L151"><a href="#L151">151</a></th><td>                                        <span class="p">),</span></td></tr><tr><th id="L152"><a href="#L152">152</a></th><td>                                        <span class="s1">'i10n'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L153"><a href="#L153">153</a></th><td>                                                <span class="s1">'importing'</span>       <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Importing'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'...'</span><span class="p">,</span></td></tr><tr><th id="L154"><a href="#L154">154</a></th><td>                                                <span class="s1">'run_now'</span>         <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Run Now'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L155"><a href="#L155">155</a></th><td>                                                <span class="s1">'dry_run_loading'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;p class="hide-when-loaded"&gt;'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Processing the source and loading the items that will be imported when it runs'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'...&lt;/p&gt;'</span></td></tr><tr><th id="L156"><a href="#L156">156</a></th><td>                                                                                         <span class="o">.</span> <span class="s1">'&lt;p&gt;&lt;b&gt;'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Please note that if some of these items have already have been imported in previous runs with the same filters, they may be shown here but will not be imported again.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;/b&gt;&lt;/p&gt;'</span></td></tr><tr><th id="L157"><a href="#L157">157</a></th><td>                                                                                         <span class="o">.</span> <span class="s1">'&lt;p class="loading-img hide-when-loaded"&gt;&lt;img src="'</span> <span class="o">.</span> <span class="nx">includes_url</span><span class="p">(</span> <span class="s1">'images/wpspin-2x.gif'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'"&gt;&lt;/p&gt;&lt;div&gt;&lt;/div&gt;'</span><span class="p">,</span></td></tr><tr><th id="L158"><a href="#L158">158</a></th><td>                                                <span class="s1">'dry_run_title'</span>   <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Importable Items'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L159"><a href="#L159">159</a></th><td>                                                <span class="s1">'delete_post_message'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Would you also like to delete all the imported posts for this import job?'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L160"><a href="#L160">160</a></th><td>                                                <span class="s1">'media_iframe_title'</span>  <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Select image'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L161"><a href="#L161">161</a></th><td>                                                <span class="s1">'media_iframe_button'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Set default image'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L162"><a href="#L162">162</a></th><td>                                                <span class="s1">'action_btn_text_1'</span>   <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Choose image'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L163"><a href="#L163">163</a></th><td>                                                <span class="s1">'action_btn_text_2'</span>   <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Replace image'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L164"><a href="#L164">164</a></th><td>                                        <span class="p">),</span></td></tr><tr><th id="L165"><a href="#L165">165</a></th><td>                                <span class="p">)</span></td></tr><tr><th id="L166"><a href="#L166">166</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L167"><a href="#L167">167</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L168"><a href="#L168">168</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L169"><a href="#L169">169</a></th><td></td></tr><tr><th id="L170"><a href="#L170">170</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L171"><a href="#L171">171</a></th><td><span class="sd">         * Add attributes to $itemArray.</span></td></tr><tr><th id="L172"><a href="#L172">172</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L173"><a href="#L173">173</a></th><td><span class="sd">         * @param array  $itemArray The item attributes array.</span></td></tr><tr><th id="L174"><a href="#L174">174</a></th><td><span class="sd">         * @param object $item The feed item.</span></td></tr><tr><th id="L175"><a href="#L175">175</a></th><td><span class="sd">         * @param array  $sc The shorcode attributes array.</span></td></tr><tr><th id="L176"><a href="#L176">176</a></th><td><span class="sd">         * @param int    $index The item number (may not be the same as the item_index).</span></td></tr><tr><th id="L177"><a href="#L177">177</a></th><td><span class="sd">         * @param int    $item_index The real index of this items in the feed (maybe be different from $index if filters are used).</span></td></tr><tr><th id="L178"><a href="#L178">178</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L179"><a href="#L179">179</a></th><td><span class="sd">         * @return mixed</span></td></tr><tr><th id="L180"><a href="#L180">180</a></th><td><span class="sd">         * @since   1.0.0</span></td></tr><tr><th id="L181"><a href="#L181">181</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L182"><a href="#L182">182</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L183"><a href="#L183">183</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">add_data_to_item</span><span class="p">(</span> <span class="nv">$itemArray</span><span class="p">,</span> <span class="nv">$item</span><span class="p">,</span> <span class="nv">$sc</span> <span class="o">=</span> <span class="k">null</span><span class="p">,</span> <span class="nv">$index</span> <span class="o">=</span> <span class="k">null</span><span class="p">,</span> <span class="nv">$item_index</span> <span class="o">=</span> <span class="k">null</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L184"><a href="#L184">184</a></th><td>                <span class="nv">$itemArray</span><span class="p">[</span><span class="s1">'item_categories'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">retrieve_categories</span><span class="p">(</span> <span class="k">null</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L185"><a href="#L185">185</a></th><td></td></tr><tr><th id="L186"><a href="#L186">186</a></th><td>                <span class="c1">// If set to true, SimplePie will return a unique MD5 hash for the item.</span></td></tr><tr><th id="L187"><a href="#L187">187</a></th><td><span class="c1"></span>                <span class="c1">// If set to false, it will check &lt;guid&gt;, &lt;link&gt;, and &lt;title&gt; before defaulting to the hash.</span></td></tr><tr><th id="L188"><a href="#L188">188</a></th><td><span class="c1"></span>                <span class="nv">$itemArray</span><span class="p">[</span><span class="s1">'item_id'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$item</span><span class="o">-&gt;</span><span class="na">get_id</span><span class="p">(</span> <span class="k">false</span> <span class="p">);</span></td></tr><tr><th id="L189"><a href="#L189">189</a></th><td></td></tr><tr><th id="L190"><a href="#L190">190</a></th><td>                <span class="nv">$itemArray</span><span class="p">[</span><span class="s1">'item'</span><span class="p">]</span>       <span class="o">=</span> <span class="nv">$item</span><span class="p">;</span></td></tr><tr><th id="L191"><a href="#L191">191</a></th><td>                <span class="nv">$itemArray</span><span class="p">[</span><span class="s1">'item_index'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$item_index</span><span class="p">;</span></td></tr><tr><th id="L192"><a href="#L192">192</a></th><td></td></tr><tr><th id="L193"><a href="#L193">193</a></th><td>                <span class="k">return</span> <span class="nv">$itemArray</span><span class="p">;</span></td></tr><tr><th id="L194"><a href="#L194">194</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L195"><a href="#L195">195</a></th><td></td></tr><tr><th id="L196"><a href="#L196">196</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L197"><a href="#L197">197</a></th><td><span class="sd">         * Retrieve the categories.</span></td></tr><tr><th id="L198"><a href="#L198">198</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L199"><a href="#L199">199</a></th><td><span class="sd">         * @param string $dumb The initial categories (only a placeholder argument for the filter).</span></td></tr><tr><th id="L200"><a href="#L200">200</a></th><td><span class="sd">         * @param object $item The feed item.</span></td></tr><tr><th id="L201"><a href="#L201">201</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L202"><a href="#L202">202</a></th><td><span class="sd">         * @return string</span></td></tr><tr><th id="L203"><a href="#L203">203</a></th><td><span class="sd">         * @since   ?</span></td></tr><tr><th id="L204"><a href="#L204">204</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L205"><a href="#L205">205</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L206"><a href="#L206">206</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">retrieve_categories</span><span class="p">(</span> <span class="nv">$dumb</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L207"><a href="#L207">207</a></th><td>                <span class="nv">$cats</span>       <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L208"><a href="#L208">208</a></th><td>                <span class="nv">$categories</span> <span class="o">=</span> <span class="nv">$item</span><span class="o">-&gt;</span><span class="na">get_categories</span><span class="p">();</span></td></tr><tr><th id="L209"><a href="#L209">209</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$categories</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L210"><a href="#L210">210</a></th><td>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$categories</span> <span class="k">as</span> <span class="nv">$category</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L211"><a href="#L211">211</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">is_string</span><span class="p">(</span> <span class="nv">$category</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L212"><a href="#L212">212</a></th><td>                                        <span class="nv">$cats</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$category</span><span class="p">;</span></td></tr><tr><th id="L213"><a href="#L213">213</a></th><td>                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L214"><a href="#L214">214</a></th><td>                                        <span class="nv">$cats</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$category</span><span class="o">-&gt;</span><span class="na">get_label</span><span class="p">();</span></td></tr><tr><th id="L215"><a href="#L215">215</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L216"><a href="#L216">216</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L217"><a href="#L217">217</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L218"><a href="#L218">218</a></th><td></td></tr><tr><th id="L219"><a href="#L219">219</a></th><td>                <span class="k">return</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_categories'</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span> <span class="s1">', '</span><span class="p">,</span> <span class="nv">$cats</span> <span class="p">),</span> <span class="nv">$cats</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L220"><a href="#L220">220</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L221"><a href="#L221">221</a></th><td></td></tr><tr><th id="L222"><a href="#L222">222</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L223"><a href="#L223">223</a></th><td><span class="sd">         * Register a new post type for feed imports.</span></td></tr><tr><th id="L224"><a href="#L224">224</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L225"><a href="#L225">225</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L226"><a href="#L226">226</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L227"><a href="#L227">227</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L228"><a href="#L228">228</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">register_import_post_type</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L229"><a href="#L229">229</a></th><td>                <span class="nv">$labels</span>   <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L230"><a href="#L230">230</a></th><td>                        <span class="s1">'name'</span>               <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Import Posts'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L231"><a href="#L231">231</a></th><td>                        <span class="s1">'singular_name'</span>      <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Import Post'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L232"><a href="#L232">232</a></th><td>                        <span class="s1">'add_new'</span>            <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'New Import'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L233"><a href="#L233">233</a></th><td>                        <span class="s1">'add_new_item'</span>       <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span></td></tr><tr><th id="L234"><a href="#L234">234</a></th><td>                        <span class="s1">'edit_item'</span>          <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span></td></tr><tr><th id="L235"><a href="#L235">235</a></th><td>                        <span class="s1">'new_item'</span>           <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'New Import Post'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L236"><a href="#L236">236</a></th><td>                        <span class="s1">'view_item'</span>          <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'View Import'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L237"><a href="#L237">237</a></th><td>                        <span class="s1">'search_items'</span>       <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Search Imports'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L238"><a href="#L238">238</a></th><td>                        <span class="s1">'not_found'</span>          <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'No imports found'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L239"><a href="#L239">239</a></th><td>                        <span class="s1">'not_found_in_trash'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'No imports in the trash'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L240"><a href="#L240">240</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L241"><a href="#L241">241</a></th><td>                <span class="nv">$supports</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L242"><a href="#L242">242</a></th><td>                        <span class="s1">'title'</span><span class="p">,</span></td></tr><tr><th id="L243"><a href="#L243">243</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L244"><a href="#L244">244</a></th><td>                <span class="nv">$args</span>     <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L245"><a href="#L245">245</a></th><td>                        <span class="s1">'labels'</span>              <span class="o">=&gt;</span> <span class="nv">$labels</span><span class="p">,</span></td></tr><tr><th id="L246"><a href="#L246">246</a></th><td>                        <span class="s1">'supports'</span>            <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span></td></tr><tr><th id="L247"><a href="#L247">247</a></th><td>                        <span class="s1">'public'</span>              <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L248"><a href="#L248">248</a></th><td>                        <span class="s1">'exclude_from_search'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L249"><a href="#L249">249</a></th><td>                        <span class="s1">'publicly_queryable'</span>  <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span></td></tr><tr><th id="L250"><a href="#L250">250</a></th><td>                        <span class="s1">'capability_type'</span>     <span class="o">=&gt;</span> <span class="s1">'post'</span><span class="p">,</span></td></tr><tr><th id="L251"><a href="#L251">251</a></th><td>                        <span class="s1">'show_in_nav_menus'</span>   <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span></td></tr><tr><th id="L252"><a href="#L252">252</a></th><td>                        <span class="s1">'rewrite'</span>             <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L253"><a href="#L253">253</a></th><td>                                <span class="s1">'slug'</span> <span class="o">=&gt;</span> <span class="s1">'feedzy-import'</span><span class="p">,</span></td></tr><tr><th id="L254"><a href="#L254">254</a></th><td>                        <span class="p">),</span></td></tr><tr><th id="L255"><a href="#L255">255</a></th><td>                        <span class="s1">'show_in_menu'</span>        <span class="o">=&gt;</span> <span class="s1">'feedzy-admin-menu'</span><span class="p">,</span></td></tr><tr><th id="L256"><a href="#L256">256</a></th><td>                        <span class="s1">'show_ui'</span>             <span class="o">=&gt;</span> <span class="nx">feedzy_current_user_can</span><span class="p">(),</span></td></tr><tr><th id="L257"><a href="#L257">257</a></th><td>                        <span class="s1">'show_in_rest'</span>        <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L258"><a href="#L258">258</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L259"><a href="#L259">259</a></th><td>                <span class="nv">$args</span>     <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_imports_args'</span><span class="p">,</span> <span class="nv">$args</span> <span class="p">);</span></td></tr><tr><th id="L260"><a href="#L260">260</a></th><td>                <span class="nx">register_post_type</span><span class="p">(</span> <span class="s1">'feedzy_imports'</span><span class="p">,</span> <span class="nv">$args</span> <span class="p">);</span></td></tr><tr><th id="L261"><a href="#L261">261</a></th><td></td></tr><tr><th id="L262"><a href="#L262">262</a></th><td>                <span class="c1">// Register user meta field.</span></td></tr><tr><th id="L263"><a href="#L263">263</a></th><td><span class="c1"></span>                <span class="nx">register_meta</span><span class="p">(</span></td></tr><tr><th id="L264"><a href="#L264">264</a></th><td>                        <span class="s1">'user'</span><span class="p">,</span></td></tr><tr><th id="L265"><a href="#L265">265</a></th><td>                        <span class="s1">'feedzy_import_tour'</span><span class="p">,</span></td></tr><tr><th id="L266"><a href="#L266">266</a></th><td>                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L267"><a href="#L267">267</a></th><td>                                <span class="s1">'type'</span>         <span class="o">=&gt;</span> <span class="s1">'boolean'</span><span class="p">,</span></td></tr><tr><th id="L268"><a href="#L268">268</a></th><td>                                <span class="s1">'description'</span>  <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Show tour for Feedzy.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L269"><a href="#L269">269</a></th><td>                                <span class="s1">'show_in_rest'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L270"><a href="#L270">270</a></th><td>                                <span class="s1">'single'</span>       <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L271"><a href="#L271">271</a></th><td>                                <span class="s1">'default'</span>      <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L272"><a href="#L272">272</a></th><td>                        <span class="p">)</span></td></tr><tr><th id="L273"><a href="#L273">273</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L274"><a href="#L274">274</a></th><td>                <span class="nx">register_meta</span><span class="p">(</span></td></tr><tr><th id="L275"><a href="#L275">275</a></th><td>                        <span class="s1">'user'</span><span class="p">,</span></td></tr><tr><th id="L276"><a href="#L276">276</a></th><td>                        <span class="s1">'feedzy_hide_action_message'</span><span class="p">,</span></td></tr><tr><th id="L277"><a href="#L277">277</a></th><td>                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L278"><a href="#L278">278</a></th><td>                                <span class="s1">'type'</span>         <span class="o">=&gt;</span> <span class="s1">'boolean'</span><span class="p">,</span></td></tr><tr><th id="L279"><a href="#L279">279</a></th><td>                                <span class="s1">'description'</span>  <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Show intro message for Feedzy action popup.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L280"><a href="#L280">280</a></th><td>                                <span class="s1">'show_in_rest'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L281"><a href="#L281">281</a></th><td>                                <span class="s1">'single'</span>       <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L282"><a href="#L282">282</a></th><td>                                <span class="s1">'default'</span>      <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span></td></tr><tr><th id="L283"><a href="#L283">283</a></th><td>                        <span class="p">)</span></td></tr><tr><th id="L284"><a href="#L284">284</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L285"><a href="#L285">285</a></th><td></td></tr><tr><th id="L286"><a href="#L286">286</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L287"><a href="#L287">287</a></th><td></td></tr><tr><th id="L288"><a href="#L288">288</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L289"><a href="#L289">289</a></th><td><span class="sd">         * Method to add a meta box to `feedzy_imports`</span></td></tr><tr><th id="L290"><a href="#L290">290</a></th><td><span class="sd">         * custom post type.</span></td></tr><tr><th id="L291"><a href="#L291">291</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L292"><a href="#L292">292</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L293"><a href="#L293">293</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L294"><a href="#L294">294</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L295"><a href="#L295">295</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">add_feedzy_import_metaboxes</span><span class="p">(</span> <span class="nv">$post_type</span><span class="p">,</span> <span class="nv">$post</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L296"><a href="#L296">296</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="s1">'feedzy_imports'</span> <span class="o">!==</span> <span class="nv">$post_type</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L297"><a href="#L297">297</a></th><td>                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L298"><a href="#L298">298</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L299"><a href="#L299">299</a></th><td></td></tr><tr><th id="L300"><a href="#L300">300</a></th><td>                <span class="nx">add_meta_box</span><span class="p">(</span></td></tr><tr><th id="L301"><a href="#L301">301</a></th><td>                        <span class="s1">'feedzy_import_feeds'</span><span class="p">,</span></td></tr><tr><th id="L302"><a href="#L302">302</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Feed Import Options'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L303"><a href="#L303">303</a></th><td>                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L304"><a href="#L304">304</a></th><td>                                <span class="nv">$this</span><span class="p">,</span></td></tr><tr><th id="L305"><a href="#L305">305</a></th><td>                                <span class="s1">'feedzy_import_feed_options'</span><span class="p">,</span></td></tr><tr><th id="L306"><a href="#L306">306</a></th><td>                        <span class="p">),</span></td></tr><tr><th id="L307"><a href="#L307">307</a></th><td>                        <span class="s1">'feedzy_imports'</span><span class="p">,</span></td></tr><tr><th id="L308"><a href="#L308">308</a></th><td>                        <span class="s1">'normal'</span><span class="p">,</span></td></tr><tr><th id="L309"><a href="#L309">309</a></th><td>                        <span class="s1">'high'</span></td></tr><tr><th id="L310"><a href="#L310">310</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L311"><a href="#L311">311</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L312"><a href="#L312">312</a></th><td></td></tr><tr><th id="L313"><a href="#L313">313</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L314"><a href="#L314">314</a></th><td><span class="sd">         * Method to display metabox for import post type.</span></td></tr><tr><th id="L315"><a href="#L315">315</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L316"><a href="#L316">316</a></th><td><span class="sd">         * @return mixed</span></td></tr><tr><th id="L317"><a href="#L317">317</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L318"><a href="#L318">318</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L319"><a href="#L319">319</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L320"><a href="#L320">320</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_import_feed_options</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L321"><a href="#L321">321</a></th><td>                <span class="k">global</span> <span class="nv">$post</span><span class="p">,</span> <span class="nv">$pagenow</span><span class="p">;</span></td></tr><tr><th id="L322"><a href="#L322">322</a></th><td>                <span class="nv">$args</span>                  <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L323"><a href="#L323">323</a></th><td>                        <span class="s1">'post_type'</span>      <span class="o">=&gt;</span> <span class="s1">'feedzy_categories'</span><span class="p">,</span></td></tr><tr><th id="L324"><a href="#L324">324</a></th><td>                        <span class="s1">'posts_per_page'</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="p">,</span></td></tr><tr><th id="L325"><a href="#L325">325</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L326"><a href="#L326">326</a></th><td>                <span class="nv">$feed_categories</span>       <span class="o">=</span> <span class="nx">get_posts</span><span class="p">(</span> <span class="nv">$args</span> <span class="p">);</span></td></tr><tr><th id="L327"><a href="#L327">327</a></th><td>                <span class="nv">$post_types</span>            <span class="o">=</span> <span class="nx">get_post_types</span><span class="p">(</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">'names'</span> <span class="p">);</span></td></tr><tr><th id="L328"><a href="#L328">328</a></th><td>                <span class="nv">$post_types</span>            <span class="o">=</span> <span class="nb">array_diff</span><span class="p">(</span> <span class="nv">$post_types</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'feedzy_imports'</span><span class="p">,</span> <span class="s1">'feedzy_categories'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L329"><a href="#L329">329</a></th><td>                <span class="nv">$published_status</span>      <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'publish'</span><span class="p">,</span> <span class="s1">'draft'</span> <span class="p">);</span></td></tr><tr><th id="L330"><a href="#L330">330</a></th><td>                <span class="nv">$keyword_filter_fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Title'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L331"><a href="#L331">331</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L332"><a href="#L332">332</a></th><td>                        <span class="nv">$keyword_filter_fields</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span></td></tr><tr><th id="L333"><a href="#L333">333</a></th><td>                                <span class="nv">$keyword_filter_fields</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L334"><a href="#L334">334</a></th><td>                                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Description'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L335"><a href="#L335">335</a></th><td>                                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Author'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L336"><a href="#L336">336</a></th><td>                                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Full Content'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L337"><a href="#L337">337</a></th><td>                                <span class="p">)</span></td></tr><tr><th id="L338"><a href="#L338">338</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L339"><a href="#L339">339</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L340"><a href="#L340">340</a></th><td>                <span class="nv">$import_post_type</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_type'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L341"><a href="#L341">341</a></th><td>                <span class="nv">$import_post_term</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_term'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L342"><a href="#L342">342</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">metadata_exists</span><span class="p">(</span> <span class="nv">$import_post_type</span><span class="p">,</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_status'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L343"><a href="#L343">343</a></th><td>                        <span class="nv">$import_post_status</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_status'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L344"><a href="#L344">344</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L345"><a href="#L345">345</a></th><td>                        <span class="nx">add_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_status'</span><span class="p">,</span> <span class="s1">'publish'</span> <span class="p">);</span></td></tr><tr><th id="L346"><a href="#L346">346</a></th><td>                        <span class="nv">$import_post_status</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_status'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L347"><a href="#L347">347</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L348"><a href="#L348">348</a></th><td>                <span class="nv">$source</span>                   <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'source'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L349"><a href="#L349">349</a></th><td>                <span class="nv">$inc_key</span>                  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'inc_key'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L350"><a href="#L350">350</a></th><td>                <span class="nv">$exc_key</span>                  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'exc_key'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L351"><a href="#L351">351</a></th><td>                <span class="nv">$inc_on</span>                   <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'inc_on'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L352"><a href="#L352">352</a></th><td>                <span class="nv">$exc_on</span>                   <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'exc_on'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L353"><a href="#L353">353</a></th><td>                <span class="nv">$import_title</span>             <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_title'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L354"><a href="#L354">354</a></th><td>                <span class="nv">$import_date</span>              <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_date'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L355"><a href="#L355">355</a></th><td>                <span class="nv">$post_excerpt</span>             <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_excerpt'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L356"><a href="#L356">356</a></th><td>                <span class="nv">$import_content</span>           <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_content'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L357"><a href="#L357">357</a></th><td>                <span class="nv">$import_item_img_url</span>      <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_use_external_image'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L358"><a href="#L358">358</a></th><td>                <span class="nv">$import_item_img_url</span>      <span class="o">=</span> <span class="s1">'yes'</span> <span class="o">===</span> <span class="nv">$import_item_img_url</span> <span class="o">?</span> <span class="s1">'checked'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L359"><a href="#L359">359</a></th><td>                <span class="nv">$import_featured_img</span>      <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_featured_img'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L360"><a href="#L360">360</a></th><td>                <span class="nv">$import_remove_duplicates</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_remove_duplicates'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L361"><a href="#L361">361</a></th><td>                <span class="nv">$import_remove_duplicates</span> <span class="o">=</span> <span class="s1">'yes'</span> <span class="o">===</span> <span class="nv">$import_remove_duplicates</span> <span class="o">||</span> <span class="s1">'post-new.php'</span> <span class="o">===</span> <span class="nv">$pagenow</span> <span class="o">?</span> <span class="s1">'checked'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L362"><a href="#L362">362</a></th><td>                <span class="nv">$import_selected_language</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'language'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L363"><a href="#L363">363</a></th><td>                <span class="nv">$from_datetime</span>            <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'from_datetime'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L364"><a href="#L364">364</a></th><td>                <span class="nv">$to_datetime</span>              <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'to_datetime'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L365"><a href="#L365">365</a></th><td>                <span class="nv">$import_auto_translation</span>  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_auto_translation'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L366"><a href="#L366">366</a></th><td>                <span class="nv">$import_auto_translation</span>  <span class="o">=</span> <span class="s1">'yes'</span> <span class="o">===</span> <span class="nv">$import_auto_translation</span> <span class="o">?</span> <span class="s1">'checked'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L367"><a href="#L367">367</a></th><td>                <span class="nv">$import_translation_lang</span>  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_auto_translation_lang'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L368"><a href="#L368">368</a></th><td>                <span class="c1">// default values so that post is not created empty.</span></td></tr><tr><th id="L369"><a href="#L369">369</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_title</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L370"><a href="#L370">370</a></th><td>                        <span class="nv">$import_title</span> <span class="o">=</span> <span class="s1">'[#item_title]'</span><span class="p">;</span></td></tr><tr><th id="L371"><a href="#L371">371</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L372"><a href="#L372">372</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_content</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L373"><a href="#L373">373</a></th><td>                        <span class="nv">$import_content</span> <span class="o">=</span> <span class="s1">'[#item_content]'</span><span class="p">;</span></td></tr><tr><th id="L374"><a href="#L374">374</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L375"><a href="#L375">375</a></th><td></td></tr><tr><th id="L376"><a href="#L376">376</a></th><td>                <span class="nv">$import_link_author_admin</span>  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_link_author_admin'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L377"><a href="#L377">377</a></th><td>                <span class="nv">$import_link_author_public</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_link_author_public'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L378"><a href="#L378">378</a></th><td></td></tr><tr><th id="L379"><a href="#L379">379</a></th><td>                <span class="c1">// Admin / Public</span></td></tr><tr><th id="L380"><a href="#L380">380</a></th><td><span class="c1"></span>                <span class="nv">$import_link_author</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">''</span> <span class="p">);</span></td></tr><tr><th id="L381"><a href="#L381">381</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="s1">'yes'</span> <span class="o">===</span> <span class="nv">$import_link_author_admin</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L382"><a href="#L382">382</a></th><td>                        <span class="nv">$import_link_author</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'checked'</span><span class="p">;</span></td></tr><tr><th id="L383"><a href="#L383">383</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L384"><a href="#L384">384</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="s1">'yes'</span> <span class="o">===</span> <span class="nv">$import_link_author_public</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L385"><a href="#L385">385</a></th><td>                        <span class="nv">$import_link_author</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'checked'</span><span class="p">;</span></td></tr><tr><th id="L386"><a href="#L386">386</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L387"><a href="#L387">387</a></th><td></td></tr><tr><th id="L388"><a href="#L388">388</a></th><td>                <span class="c1">// maybe more options are required from pro?</span></td></tr><tr><th id="L389"><a href="#L389">389</a></th><td><span class="c1"></span>                <span class="nv">$pro_options</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_metabox_options'</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span> <span class="p">);</span></td></tr><tr><th id="L390"><a href="#L390">390</a></th><td></td></tr><tr><th id="L391"><a href="#L391">391</a></th><td>                <span class="nv">$import_custom_fields</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'imports_custom_fields'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L392"><a href="#L392">392</a></th><td>                <span class="nv">$import_feed_limit</span>    <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_feed_limit'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L393"><a href="#L393">393</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_feed_limit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L394"><a href="#L394">394</a></th><td>                        <span class="nv">$import_feed_limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span></td></tr><tr><th id="L395"><a href="#L395">395</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L396"><a href="#L396">396</a></th><td>                <span class="nv">$import_feed_delete_days</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_feed_delete_days'</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L397"><a href="#L397">397</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_feed_delete_days</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L398"><a href="#L398">398</a></th><td>                        <span class="nv">$import_feed_delete_days</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'feedzy-delete-days'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'feedzy-delete-days'</span><span class="p">]</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span></td></tr><tr><th id="L399"><a href="#L399">399</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L400"><a href="#L400">400</a></th><td>                <span class="nv">$default_thumbnail_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></td></tr><tr><th id="L401"><a href="#L401">401</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L402"><a href="#L402">402</a></th><td>                        <span class="nv">$default_thumbnail_id</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'default_thumbnail_id'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L403"><a href="#L403">403</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$default_thumbnail_id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L404"><a href="#L404">404</a></th><td>                                <span class="nv">$default_thumbnail_id</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'default-thumbnail-id'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'default-thumbnail-id'</span><span class="p">]</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span></td></tr><tr><th id="L405"><a href="#L405">405</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L406"><a href="#L406">406</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L407"><a href="#L407">407</a></th><td>                <span class="nv">$post_status</span>        <span class="o">=</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">post_status</span><span class="p">;</span></td></tr><tr><th id="L408"><a href="#L408">408</a></th><td>                <span class="nv">$nonce</span>              <span class="o">=</span> <span class="nx">wp_create_nonce</span><span class="p">(</span> <span class="nx">FEEDZY_BASEFILE</span> <span class="p">);</span></td></tr><tr><th id="L409"><a href="#L409">409</a></th><td>                <span class="nv">$invalid_source_msg</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_get_source_validity_error'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="nv">$post</span> <span class="p">);</span></td></tr><tr><th id="L410"><a href="#L410">410</a></th><td>                <span class="nv">$output</span>             <span class="o">=</span> <span class="s1">'</span></td></tr><tr><th id="L411"><a href="#L411">411</a></th><td><span class="s1">            &lt;input type="hidden" name="feedzy_category_meta_noncename" id="feedzy_category_meta_noncename" value="'</span> <span class="o">.</span> <span class="nv">$nonce</span> <span class="o">.</span> <span class="s1">'" /&gt;</span></td></tr><tr><th id="L412"><a href="#L412">412</a></th><td><span class="s1">        '</span><span class="p">;</span></td></tr><tr><th id="L413"><a href="#L413">413</a></th><td></td></tr><tr><th id="L414"><a href="#L414">414</a></th><td>                <span class="nx">add_thickbox</span><span class="p">();</span></td></tr><tr><th id="L415"><a href="#L415">415</a></th><td>                <span class="k">include</span> <span class="nx">FEEDZY_ABSPATH</span> <span class="o">.</span> <span class="s1">'/includes/views/import-metabox-edit.php'</span><span class="p">;</span></td></tr><tr><th id="L416"><a href="#L416">416</a></th><td>                <span class="k">echo</span> <span class="nx">wp_kses</span><span class="p">(</span> <span class="nv">$output</span><span class="p">,</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_wp_kses_allowed_html'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L417"><a href="#L417">417</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L418"><a href="#L418">418</a></th><td></td></tr><tr><th id="L419"><a href="#L419">419</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L420"><a href="#L420">420</a></th><td><span class="sd">         * Change number of posts imported.</span></td></tr><tr><th id="L421"><a href="#L421">421</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L422"><a href="#L422">422</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">items_limit</span><span class="p">(</span> <span class="nv">$range</span><span class="p">,</span> <span class="nv">$post</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L423"><a href="#L423">423</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L424"><a href="#L424">424</a></th><td>                        <span class="nv">$range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="p">);</span></td></tr><tr><th id="L425"><a href="#L425">425</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L426"><a href="#L426">426</a></th><td></td></tr><tr><th id="L427"><a href="#L427">427</a></th><td>                <span class="k">return</span> <span class="nv">$range</span><span class="p">;</span></td></tr><tr><th id="L428"><a href="#L428">428</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L429"><a href="#L429">429</a></th><td></td></tr><tr><th id="L430"><a href="#L430">430</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L431"><a href="#L431">431</a></th><td><span class="sd">         * Save method for custom post type</span></td></tr><tr><th id="L432"><a href="#L432">432</a></th><td><span class="sd">         * import feeds.</span></td></tr><tr><th id="L433"><a href="#L433">433</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L434"><a href="#L434">434</a></th><td><span class="sd">         * @param integer $post_id The post ID.</span></td></tr><tr><th id="L435"><a href="#L435">435</a></th><td><span class="sd">         * @param object  $post The post object.</span></td></tr><tr><th id="L436"><a href="#L436">436</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L437"><a href="#L437">437</a></th><td><span class="sd">         * @return bool</span></td></tr><tr><th id="L438"><a href="#L438">438</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L439"><a href="#L439">439</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L440"><a href="#L440">440</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L441"><a href="#L441">441</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">save_feedzy_import_feed_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nv">$post</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L442"><a href="#L442">442</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_POST</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L443"><a href="#L443">443</a></th><td>                        <span class="k">return</span> <span class="nv">$post_id</span><span class="p">;</span></td></tr><tr><th id="L444"><a href="#L444">444</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L445"><a href="#L445">445</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'feedzy_post_nonce'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L446"><a href="#L446">446</a></th><td>                        <span class="k">return</span> <span class="nv">$post_id</span><span class="p">;</span></td></tr><tr><th id="L447"><a href="#L447">447</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L448"><a href="#L448">448</a></th><td>                <span class="k">if</span> <span class="p">(</span></td></tr><tr><th id="L449"><a href="#L449">449</a></th><td>                        <span class="nx">get_post_type</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">)</span> <span class="o">!==</span> <span class="s1">'feedzy_imports'</span> <span class="o">||</span></td></tr><tr><th id="L450"><a href="#L450">450</a></th><td>                        <span class="p">(</span> <span class="o">!</span> <span class="nb">defined</span><span class="p">(</span> <span class="s1">'TI_UNIT_TESTING'</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nx">wp_verify_nonce</span><span class="p">(</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'feedzy_post_nonce'</span><span class="p">]</span> <span class="p">)</span> <span class="p">),</span> <span class="s1">'feedzy_post_nonce'</span> <span class="p">)</span> <span class="p">)</span> <span class="o">||</span></td></tr><tr><th id="L451"><a href="#L451">451</a></th><td>                        <span class="o">!</span> <span class="nx">current_user_can</span><span class="p">(</span> <span class="s1">'edit_post'</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="p">)</span></td></tr><tr><th id="L452"><a href="#L452">452</a></th><td>                <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L453"><a href="#L453">453</a></th><td>                        <span class="k">return</span> <span class="nv">$post_id</span><span class="p">;</span></td></tr><tr><th id="L454"><a href="#L454">454</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L455"><a href="#L455">455</a></th><td></td></tr><tr><th id="L456"><a href="#L456">456</a></th><td>                <span class="nv">$data_meta</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L457"><a href="#L457">457</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'feedzy_meta_data'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'feedzy_meta_data'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L458"><a href="#L458">458</a></th><td>                        <span class="c1">// phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized</span></td></tr><tr><th id="L459"><a href="#L459">459</a></th><td><span class="c1"></span>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'feedzy_meta_data'</span><span class="p">]</span> <span class="p">)</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$val</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L460"><a href="#L460">460</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$val</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L461"><a href="#L461">461</a></th><td>                                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$val</span> <span class="k">as</span> <span class="nv">$sub_key</span> <span class="o">=&gt;</span> <span class="nv">$sub_val</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L462"><a href="#L462">462</a></th><td>                                                <span class="nv">$data_meta</span><span class="p">[</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">][</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$sub_key</span> <span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">wp_kses</span><span class="p">(</span> <span class="nv">$sub_val</span><span class="p">,</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_wp_kses_allowed_html'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L463"><a href="#L463">463</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L464"><a href="#L464">464</a></th><td>                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L465"><a href="#L465">465</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="s1">'import_post_content'</span> <span class="o">===</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L466"><a href="#L466">466</a></th><td>                                                <span class="nv">$val</span> <span class="o">=</span> <span class="nx">feedzy_custom_tag_escape</span><span class="p">(</span> <span class="nv">$val</span> <span class="p">);</span></td></tr><tr><th id="L467"><a href="#L467">467</a></th><td>                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L468"><a href="#L468">468</a></th><td>                                                <span class="nv">$val</span> <span class="o">=</span> <span class="nx">wp_kses</span><span class="p">(</span> <span class="nv">$val</span><span class="p">,</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_wp_kses_allowed_html'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L469"><a href="#L469">469</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L470"><a href="#L470">470</a></th><td>                                        <span class="nv">$data_meta</span><span class="p">[</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$val</span><span class="p">;</span></td></tr><tr><th id="L471"><a href="#L471">471</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L472"><a href="#L472">472</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L473"><a href="#L473">473</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L474"><a href="#L474">474</a></th><td>                <span class="nv">$custom_fields_keys</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L475"><a href="#L475">475</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'custom_vars_key'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'custom_vars_key'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L476"><a href="#L476">476</a></th><td>                        <span class="c1">// phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized</span></td></tr><tr><th id="L477"><a href="#L477">477</a></th><td><span class="c1"></span>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'custom_vars_key'</span><span class="p">]</span> <span class="p">)</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$val</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L478"><a href="#L478">478</a></th><td>                                <span class="nv">$custom_fields_keys</span><span class="p">[</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">esc_html</span><span class="p">(</span> <span class="nv">$val</span> <span class="p">);</span></td></tr><tr><th id="L479"><a href="#L479">479</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L480"><a href="#L480">480</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L481"><a href="#L481">481</a></th><td>                <span class="nv">$custom_fields_values</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L482"><a href="#L482">482</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'custom_vars_value'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'custom_vars_value'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L483"><a href="#L483">483</a></th><td>                        <span class="c1">// phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized</span></td></tr><tr><th id="L484"><a href="#L484">484</a></th><td><span class="c1"></span>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'custom_vars_value'</span><span class="p">]</span> <span class="p">)</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$val</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L485"><a href="#L485">485</a></th><td>                                <span class="nv">$custom_fields_values</span><span class="p">[</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">esc_html</span><span class="p">(</span> <span class="nv">$val</span> <span class="p">);</span></td></tr><tr><th id="L486"><a href="#L486">486</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L487"><a href="#L487">487</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L488"><a href="#L488">488</a></th><td>                <span class="nv">$custom_fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L489"><a href="#L489">489</a></th><td>                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$custom_fields_keys</span> <span class="k">as</span> <span class="nv">$index</span> <span class="o">=&gt;</span> <span class="nv">$key_value</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L490"><a href="#L490">490</a></th><td>                        <span class="nv">$value</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L491"><a href="#L491">491</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$custom_fields_values</span><span class="p">[</span> <span class="nv">$index</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L492"><a href="#L492">492</a></th><td>                                <span class="nv">$value</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span> <span class="s1">','</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$custom_fields_values</span><span class="p">[</span> <span class="nv">$index</span> <span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L493"><a href="#L493">493</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L494"><a href="#L494">494</a></th><td>                        <span class="nv">$custom_fields</span><span class="p">[</span> <span class="nv">$key_value</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span></td></tr><tr><th id="L495"><a href="#L495">495</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L496"><a href="#L496">496</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">post_type</span> <span class="o">!==</span> <span class="s1">'revision'</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L497"><a href="#L497">497</a></th><td>                        <span class="c1">// delete these checkbox related fields; if checked, they will be added below.</span></td></tr><tr><th id="L498"><a href="#L498">498</a></th><td><span class="c1"></span>                        <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'import_link_author_admin'</span> <span class="p">);</span></td></tr><tr><th id="L499"><a href="#L499">499</a></th><td>                        <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'import_link_author_public'</span> <span class="p">);</span></td></tr><tr><th id="L500"><a href="#L500">500</a></th><td></td></tr><tr><th id="L501"><a href="#L501">501</a></th><td>                        <span class="c1">// we will activate this import only if the source has no invalid URL(s)</span></td></tr><tr><th id="L502"><a href="#L502">502</a></th><td><span class="c1"></span>                        <span class="nv">$source_is_valid</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L503"><a href="#L503">503</a></th><td>                        <span class="c1">// Check feeds remove duplicates checkbox checked OR not.</span></td></tr><tr><th id="L504"><a href="#L504">504</a></th><td><span class="c1"></span>                        <span class="nv">$data_meta</span><span class="p">[</span><span class="s1">'import_remove_duplicates'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$data_meta</span><span class="p">[</span><span class="s1">'import_remove_duplicates'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$data_meta</span><span class="p">[</span><span class="s1">'import_remove_duplicates'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">'no'</span><span class="p">;</span></td></tr><tr><th id="L505"><a href="#L505">505</a></th><td>                        <span class="c1">// Check feeds automatically translation checkbox checked OR not.</span></td></tr><tr><th id="L506"><a href="#L506">506</a></th><td><span class="c1"></span>                        <span class="nv">$data_meta</span><span class="p">[</span><span class="s1">'import_auto_translation'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$data_meta</span><span class="p">[</span><span class="s1">'import_auto_translation'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$data_meta</span><span class="p">[</span><span class="s1">'import_auto_translation'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">'no'</span><span class="p">;</span></td></tr><tr><th id="L507"><a href="#L507">507</a></th><td>                        <span class="c1">// Check feeds external image URL checkbox checked OR not.</span></td></tr><tr><th id="L508"><a href="#L508">508</a></th><td><span class="c1"></span>                        <span class="nv">$data_meta</span><span class="p">[</span><span class="s1">'import_use_external_image'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$data_meta</span><span class="p">[</span><span class="s1">'import_use_external_image'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$data_meta</span><span class="p">[</span><span class="s1">'import_use_external_image'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">'no'</span><span class="p">;</span></td></tr><tr><th id="L509"><a href="#L509">509</a></th><td>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$data_meta</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L510"><a href="#L510">510</a></th><td>                                <span class="nv">$value</span> <span class="o">=</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">implode</span><span class="p">(</span> <span class="s1">','</span><span class="p">,</span> <span class="nv">$value</span> <span class="p">)</span> <span class="o">:</span> <span class="nb">implode</span><span class="p">(</span> <span class="s1">','</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$value</span> <span class="p">);</span></td></tr><tr><th id="L511"><a href="#L511">511</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="s1">'source'</span> <span class="o">===</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L512"><a href="#L512">512</a></th><td>                                        <span class="c1">// check if the source is valid</span></td></tr><tr><th id="L513"><a href="#L513">513</a></th><td><span class="c1"></span>                                        <span class="nv">$invalid_urls</span>    <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_check_source_validity'</span><span class="p">,</span> <span class="nv">$value</span><span class="p">,</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="k">false</span> <span class="p">);</span></td></tr><tr><th id="L514"><a href="#L514">514</a></th><td>                                        <span class="nv">$source_is_valid</span> <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$invalid_urls</span> <span class="p">);</span></td></tr><tr><th id="L515"><a href="#L515">515</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L516"><a href="#L516">516</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="s1">'import_post_content'</span> <span class="o">===</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L517"><a href="#L517">517</a></th><td>                                        <span class="nx">add_filter</span><span class="p">(</span> <span class="s1">'wp_kses_allowed_html'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">'feedzy_wp_kses_allowed_html'</span> <span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span></td></tr><tr><th id="L518"><a href="#L518">518</a></th><td>                                        <span class="nv">$value</span> <span class="o">=</span> <span class="nx">feedzy_custom_tag_escape</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">);</span></td></tr><tr><th id="L519"><a href="#L519">519</a></th><td>                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L520"><a href="#L520">520</a></th><td>                                        <span class="nv">$value</span> <span class="o">=</span> <span class="nx">wp_kses</span><span class="p">(</span> <span class="nv">$value</span><span class="p">,</span> <span class="nx">wp_kses_allowed_html</span><span class="p">(</span> <span class="s1">'post'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L521"><a href="#L521">521</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L522"><a href="#L522">522</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="k">false</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L523"><a href="#L523">523</a></th><td>                                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span> <span class="p">);</span></td></tr><tr><th id="L524"><a href="#L524">524</a></th><td>                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L525"><a href="#L525">525</a></th><td>                                        <span class="nx">add_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span> <span class="p">);</span></td></tr><tr><th id="L526"><a href="#L526">526</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L527"><a href="#L527">527</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$value</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L528"><a href="#L528">528</a></th><td>                                        <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nv">$key</span> <span class="p">);</span></td></tr><tr><th id="L529"><a href="#L529">529</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L530"><a href="#L530">530</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L531"><a href="#L531">531</a></th><td>                        <span class="c1">// Added this to activate post if publish is clicked and sometimes it does not change status.</span></td></tr><tr><th id="L532"><a href="#L532">532</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$source_is_valid</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'custom_post_status'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'custom_post_status'</span><span class="p">]</span> <span class="o">===</span> <span class="s1">'Publish'</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L533"><a href="#L533">533</a></th><td>                                <span class="nv">$activate</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L534"><a href="#L534">534</a></th><td>                                        <span class="s1">'ID'</span>          <span class="o">=&gt;</span> <span class="nv">$post_id</span><span class="p">,</span></td></tr><tr><th id="L535"><a href="#L535">535</a></th><td>                                        <span class="s1">'post_status'</span> <span class="o">=&gt;</span> <span class="s1">'publish'</span><span class="p">,</span></td></tr><tr><th id="L536"><a href="#L536">536</a></th><td>                                <span class="p">);</span></td></tr><tr><th id="L537"><a href="#L537">537</a></th><td>                                <span class="nx">remove_action</span><span class="p">(</span> <span class="s1">'save_post_feedzy_imports'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">'save_feedzy_import_feed_meta'</span> <span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span></td></tr><tr><th id="L538"><a href="#L538">538</a></th><td>                                <span class="nx">wp_update_post</span><span class="p">(</span> <span class="nv">$activate</span> <span class="p">);</span></td></tr><tr><th id="L539"><a href="#L539">539</a></th><td>                                <span class="nx">add_action</span><span class="p">(</span> <span class="s1">'save_post_feedzy_imports'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">'save_feedzy_import_feed_meta'</span> <span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span></td></tr><tr><th id="L540"><a href="#L540">540</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L541"><a href="#L541">541</a></th><td></td></tr><tr><th id="L542"><a href="#L542">542</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'feedzy_save_fields'</span><span class="p">,</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nv">$post</span> <span class="p">);</span></td></tr><tr><th id="L543"><a href="#L543">543</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L544"><a href="#L544">544</a></th><td></td></tr><tr><th id="L545"><a href="#L545">545</a></th><td>                <span class="k">return</span> <span class="k">true</span><span class="p">;</span></td></tr><tr><th id="L546"><a href="#L546">546</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L547"><a href="#L547">547</a></th><td></td></tr><tr><th id="L548"><a href="#L548">548</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L549"><a href="#L549">549</a></th><td><span class="sd">         * Redirect save post to post listing.</span></td></tr><tr><th id="L550"><a href="#L550">550</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L551"><a href="#L551">551</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L552"><a href="#L552">552</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L553"><a href="#L553">553</a></th><td><span class="sd">         * @param string $location The url to redirect to.</span></td></tr><tr><th id="L554"><a href="#L554">554</a></th><td><span class="sd">         * @param int    $post_id The post ID.</span></td></tr><tr><th id="L555"><a href="#L555">555</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L556"><a href="#L556">556</a></th><td><span class="sd">         * @return string</span></td></tr><tr><th id="L557"><a href="#L557">557</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L558"><a href="#L558">558</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">redirect_post_location</span><span class="p">(</span> <span class="nv">$location</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L559"><a href="#L559">559</a></th><td>                <span class="nv">$post</span> <span class="o">=</span> <span class="nx">get_post</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">);</span></td></tr><tr><th id="L560"><a href="#L560">560</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="s1">'feedzy_imports'</span> <span class="o">===</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">post_type</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L561"><a href="#L561">561</a></th><td>                        <span class="c1">// if invalid source has been found, redirect back to edit screen</span></td></tr><tr><th id="L562"><a href="#L562">562</a></th><td><span class="c1"></span>                        <span class="c1">// where errors can be shown</span></td></tr><tr><th id="L563"><a href="#L563">563</a></th><td><span class="c1"></span>                        <span class="nv">$invalid</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'__transient_feedzy_invalid_source'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L564"><a href="#L564">564</a></th><td>                        <span class="nv">$invalid_dc_namespace</span>  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'__transient_feedzy_invalid_dc_namespace'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L565"><a href="#L565">565</a></th><td>                        <span class="nv">$invalid_source_errors</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'__transient_feedzy_invalid_source_errors'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L566"><a href="#L566">566</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$invalid</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$invalid_dc_namespace</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$invalid_source_errors</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L567"><a href="#L567">567</a></th><td>                                <span class="k">return</span> <span class="nx">admin_url</span><span class="p">(</span> <span class="s1">'edit.php?post_type=feedzy_imports'</span> <span class="p">);</span></td></tr><tr><th id="L568"><a href="#L568">568</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L569"><a href="#L569">569</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L570"><a href="#L570">570</a></th><td></td></tr><tr><th id="L571"><a href="#L571">571</a></th><td>                <span class="k">return</span> <span class="nv">$location</span><span class="p">;</span></td></tr><tr><th id="L572"><a href="#L572">572</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L573"><a href="#L573">573</a></th><td></td></tr><tr><th id="L574"><a href="#L574">574</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L575"><a href="#L575">575</a></th><td><span class="sd">         * Method to add header columns to import feeds table.</span></td></tr><tr><th id="L576"><a href="#L576">576</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L577"><a href="#L577">577</a></th><td><span class="sd">         * @param array $columns The columns array.</span></td></tr><tr><th id="L578"><a href="#L578">578</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L579"><a href="#L579">579</a></th><td><span class="sd">         * @return array|bool</span></td></tr><tr><th id="L580"><a href="#L580">580</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L581"><a href="#L581">581</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L582"><a href="#L582">582</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L583"><a href="#L583">583</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_import_columns</span><span class="p">(</span> <span class="nv">$columns</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L584"><a href="#L584">584</a></th><td>                <span class="nv">$columns</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Import Title'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L585"><a href="#L585">585</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$new_columns</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">array_insert_before</span><span class="p">(</span> <span class="s1">'date'</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">,</span> <span class="s1">'feedzy-source'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Source'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L586"><a href="#L586">586</a></th><td>                        <span class="nv">$columns</span> <span class="o">=</span> <span class="nv">$new_columns</span><span class="p">;</span></td></tr><tr><th id="L587"><a href="#L587">587</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L588"><a href="#L588">588</a></th><td>                        <span class="nv">$columns</span><span class="p">[</span><span class="s1">'feedzy-source'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Source'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L589"><a href="#L589">589</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L590"><a href="#L590">590</a></th><td></td></tr><tr><th id="L591"><a href="#L591">591</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$new_columns</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">array_insert_before</span><span class="p">(</span> <span class="s1">'date'</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">,</span> <span class="s1">'feedzy-status'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Current Status'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L592"><a href="#L592">592</a></th><td>                        <span class="nv">$columns</span> <span class="o">=</span> <span class="nv">$new_columns</span><span class="p">;</span></td></tr><tr><th id="L593"><a href="#L593">593</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L594"><a href="#L594">594</a></th><td>                        <span class="nv">$columns</span><span class="p">[</span><span class="s1">'feedzy-status'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Current Status'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L595"><a href="#L595">595</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L596"><a href="#L596">596</a></th><td></td></tr><tr><th id="L597"><a href="#L597">597</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$new_columns</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">array_insert_before</span><span class="p">(</span> <span class="s1">'date'</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">,</span> <span class="s1">'feedzy-next_run'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Next Run'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L598"><a href="#L598">598</a></th><td>                        <span class="nv">$columns</span> <span class="o">=</span> <span class="nv">$new_columns</span><span class="p">;</span></td></tr><tr><th id="L599"><a href="#L599">599</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L600"><a href="#L600">600</a></th><td>                        <span class="nv">$columns</span><span class="p">[</span><span class="s1">'feedzy-next_run'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Next Run'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L601"><a href="#L601">601</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L602"><a href="#L602">602</a></th><td></td></tr><tr><th id="L603"><a href="#L603">603</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$new_columns</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">array_insert_before</span><span class="p">(</span> <span class="s1">'date'</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">,</span> <span class="s1">'feedzy-last_run'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Last Run Status'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L604"><a href="#L604">604</a></th><td>                        <span class="nv">$columns</span> <span class="o">=</span> <span class="nv">$new_columns</span><span class="p">;</span></td></tr><tr><th id="L605"><a href="#L605">605</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L606"><a href="#L606">606</a></th><td>                        <span class="nv">$columns</span><span class="p">[</span><span class="s1">'feedzy-last_run'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Last Run Status'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L607"><a href="#L607">607</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L608"><a href="#L608">608</a></th><td></td></tr><tr><th id="L609"><a href="#L609">609</a></th><td>                <span class="nb">unset</span><span class="p">(</span> <span class="nv">$columns</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L610"><a href="#L610">610</a></th><td></td></tr><tr><th id="L611"><a href="#L611">611</a></th><td>                <span class="k">return</span> <span class="nv">$columns</span><span class="p">;</span></td></tr><tr><th id="L612"><a href="#L612">612</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L613"><a href="#L613">613</a></th><td></td></tr><tr><th id="L614"><a href="#L614">614</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L615"><a href="#L615">615</a></th><td><span class="sd">         * Utility method to insert before specific key</span></td></tr><tr><th id="L616"><a href="#L616">616</a></th><td><span class="sd">         * in an associative array.</span></td></tr><tr><th id="L617"><a href="#L617">617</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L618"><a href="#L618">618</a></th><td><span class="sd">         * @param string $key The key before to insert.</span></td></tr><tr><th id="L619"><a href="#L619">619</a></th><td><span class="sd">         * @param array  $array The array in which to insert the new key.</span></td></tr><tr><th id="L620"><a href="#L620">620</a></th><td><span class="sd">         * @param string $new_key The new key name.</span></td></tr><tr><th id="L621"><a href="#L621">621</a></th><td><span class="sd">         * @param mixed  $new_value The new key value.</span></td></tr><tr><th id="L622"><a href="#L622">622</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L623"><a href="#L623">623</a></th><td><span class="sd">         * @return array|bool</span></td></tr><tr><th id="L624"><a href="#L624">624</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L625"><a href="#L625">625</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L626"><a href="#L626">626</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L627"><a href="#L627">627</a></th><td>        <span class="k">protected</span> <span class="k">function</span> <span class="nf">array_insert_before</span><span class="p">(</span> <span class="nv">$key</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$array</span><span class="p">,</span> <span class="nv">$new_key</span><span class="p">,</span> <span class="nv">$new_value</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L628"><a href="#L628">628</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">array_key_exists</span><span class="p">(</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$array</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L629"><a href="#L629">629</a></th><td>                        <span class="nv">$new</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L630"><a href="#L630">630</a></th><td>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$array</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$value</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L631"><a href="#L631">631</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nv">$k</span> <span class="o">===</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L632"><a href="#L632">632</a></th><td>                                        <span class="nv">$new</span><span class="p">[</span> <span class="nv">$new_key</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$new_value</span><span class="p">;</span></td></tr><tr><th id="L633"><a href="#L633">633</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L634"><a href="#L634">634</a></th><td>                                <span class="nv">$new</span><span class="p">[</span> <span class="nv">$k</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span></td></tr><tr><th id="L635"><a href="#L635">635</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L636"><a href="#L636">636</a></th><td></td></tr><tr><th id="L637"><a href="#L637">637</a></th><td>                        <span class="k">return</span> <span class="nv">$new</span><span class="p">;</span></td></tr><tr><th id="L638"><a href="#L638">638</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L639"><a href="#L639">639</a></th><td></td></tr><tr><th id="L640"><a href="#L640">640</a></th><td>                <span class="k">return</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L641"><a href="#L641">641</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L642"><a href="#L642">642</a></th><td></td></tr><tr><th id="L643"><a href="#L643">643</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L644"><a href="#L644">644</a></th><td><span class="sd">         * Method to add a columns in the import feeds table.</span></td></tr><tr><th id="L645"><a href="#L645">645</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L646"><a href="#L646">646</a></th><td><span class="sd">         * @param string  $column The current column to check.</span></td></tr><tr><th id="L647"><a href="#L647">647</a></th><td><span class="sd">         * @param integer $post_id The post ID.</span></td></tr><tr><th id="L648"><a href="#L648">648</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L649"><a href="#L649">649</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L650"><a href="#L650">650</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L651"><a href="#L651">651</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L652"><a href="#L652">652</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">manage_feedzy_import_columns</span><span class="p">(</span> <span class="nv">$column</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L653"><a href="#L653">653</a></th><td>                <span class="k">global</span> <span class="nv">$post</span><span class="p">;</span></td></tr><tr><th id="L654"><a href="#L654">654</a></th><td>                <span class="k">switch</span> <span class="p">(</span> <span class="nv">$column</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L655"><a href="#L655">655</a></th><td>                        <span class="k">case</span> <span class="s1">'feedzy-source'</span><span class="o">:</span></td></tr><tr><th id="L656"><a href="#L656">656</a></th><td>                                <span class="nv">$src</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'source'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L657"><a href="#L657">657</a></th><td>                                <span class="c1">// if the source is a category, link it.</span></td></tr><tr><th id="L658"><a href="#L658">658</a></th><td><span class="c1"></span>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$src</span><span class="p">,</span> <span class="s1">'http'</span> <span class="p">)</span> <span class="o">===</span> <span class="k">false</span> <span class="o">&amp;&amp;</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$src</span><span class="p">,</span> <span class="s1">'https'</span> <span class="p">)</span> <span class="o">===</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L659"><a href="#L659">659</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="nb">function_exists</span><span class="p">(</span> <span class="s1">'feedzy_amazon_get_locale_hosts'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L660"><a href="#L660">660</a></th><td>                                                <span class="nv">$amazon_hosts</span> <span class="o">=</span> <span class="nx">feedzy_amazon_get_locale_hosts</span><span class="p">();</span></td></tr><tr><th id="L661"><a href="#L661">661</a></th><td>                                                <span class="nv">$src_path</span>     <span class="o">=</span> <span class="s1">'webservices.'</span> <span class="o">.</span> <span class="nx">wp_parse_url</span><span class="p">(</span> <span class="nv">$src</span><span class="p">,</span> <span class="nx">PHP_URL_PATH</span> <span class="p">);</span></td></tr><tr><th id="L662"><a href="#L662">662</a></th><td>                                                <span class="k">if</span> <span class="p">(</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$src_path</span><span class="p">,</span> <span class="nv">$amazon_hosts</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L663"><a href="#L663">663</a></th><td>                                                        <span class="nv">$src</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'%s: %s%s%s'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Amazon Product Advertising API'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="s1">'&lt;a&gt;'</span><span class="p">,</span> <span class="nv">$src</span><span class="p">,</span> <span class="s1">'&lt;/a&gt;'</span> <span class="p">);</span></td></tr><tr><th id="L664"><a href="#L664">664</a></th><td>                                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L665"><a href="#L665">665</a></th><td>                                                        <span class="nv">$src</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'%s: %s%s%s'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Feed Category'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="s1">'&lt;a href="'</span> <span class="o">.</span> <span class="nx">admin_url</span><span class="p">(</span> <span class="s1">'edit.php?post_type=feedzy_categories'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'" target="_blank"&gt;'</span><span class="p">,</span> <span class="nv">$src</span><span class="p">,</span> <span class="s1">'&lt;/a&gt;'</span> <span class="p">);</span></td></tr><tr><th id="L666"><a href="#L666">666</a></th><td>                                                <span class="p">}</span></td></tr><tr><th id="L667"><a href="#L667">667</a></th><td>                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L668"><a href="#L668">668</a></th><td>                                                <span class="nv">$src</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'%s: %s%s%s'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Feed Category'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="s1">'&lt;a href="'</span> <span class="o">.</span> <span class="nx">admin_url</span><span class="p">(</span> <span class="s1">'edit.php?post_type=feedzy_categories'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'" target="_blank"&gt;'</span><span class="p">,</span> <span class="nv">$src</span><span class="p">,</span> <span class="s1">'&lt;/a&gt;'</span> <span class="p">);</span></td></tr><tr><th id="L669"><a href="#L669">669</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L670"><a href="#L670">670</a></th><td>                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L671"><a href="#L671">671</a></th><td>                                        <span class="c1">// else link it to the feed but shorten it if it is too long.</span></td></tr><tr><th id="L672"><a href="#L672">672</a></th><td><span class="c1"></span>                                        <span class="nv">$too_long</span> <span class="o">=</span> <span class="mi">65</span><span class="p">;</span></td></tr><tr><th id="L673"><a href="#L673">673</a></th><td>                                        <span class="nv">$src</span>      <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'%s%s%s'</span><span class="p">,</span> <span class="s1">'&lt;a href="'</span> <span class="o">.</span> <span class="nv">$src</span> <span class="o">.</span> <span class="s1">'" target="_blank" title="'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Click to view'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'"&gt;'</span><span class="p">,</span> <span class="p">(</span> <span class="nb">strlen</span><span class="p">(</span> <span class="nv">$src</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="nv">$too_long</span> <span class="o">?</span> <span class="nx">substr</span><span class="p">(</span> <span class="nv">$src</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$too_long</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'...'</span> <span class="o">:</span> <span class="nv">$src</span> <span class="p">),</span> <span class="s1">'&lt;/a&gt;'</span> <span class="p">);</span></td></tr><tr><th id="L674"><a href="#L674">674</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L675"><a href="#L675">675</a></th><td>                                <span class="k">echo</span> <span class="nx">wp_kses_post</span><span class="p">(</span> <span class="nv">$src</span> <span class="p">);</span></td></tr><tr><th id="L676"><a href="#L676">676</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L677"><a href="#L677">677</a></th><td>                        <span class="k">case</span> <span class="s1">'feedzy-status'</span><span class="o">:</span></td></tr><tr><th id="L678"><a href="#L678">678</a></th><td>                                <span class="nv">$status</span> <span class="o">=</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">post_status</span><span class="p">;</span></td></tr><tr><th id="L679"><a href="#L679">679</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$status</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L680"><a href="#L680">680</a></th><td>                                        <span class="nx">esc_html_e</span><span class="p">(</span> <span class="s1">'Undefined'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L681"><a href="#L681">681</a></th><td>                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L682"><a href="#L682">682</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$status</span> <span class="o">===</span> <span class="s1">'publish'</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L683"><a href="#L683">683</a></th><td>                                                <span class="nv">$checked</span> <span class="o">=</span> <span class="s1">'checked'</span><span class="p">;</span></td></tr><tr><th id="L684"><a href="#L684">684</a></th><td>                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L685"><a href="#L685">685</a></th><td>                                                <span class="nv">$checked</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L686"><a href="#L686">686</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L687"><a href="#L687">687</a></th><td>                                        <span class="k">echo</span> <span class="nx">wp_kses</span><span class="p">(</span></td></tr><tr><th id="L688"><a href="#L688">688</a></th><td>                                                <span class="s1">'&lt;div class="switch"&gt;</span></td></tr><tr><th id="L689"><a href="#L689">689</a></th><td><span class="s1">                                                        &lt;input id="feedzy-toggle_'</span> <span class="o">.</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span> <span class="o">.</span> <span class="s1">'" class="feedzy-toggle feedzy-toggle-round" type="checkbox" value="'</span> <span class="o">.</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span> <span class="o">.</span> <span class="s1">'" '</span> <span class="o">.</span> <span class="nv">$checked</span> <span class="o">.</span> <span class="s1">'&gt;</span></td></tr><tr><th id="L690"><a href="#L690">690</a></th><td><span class="s1">                                                        &lt;label for="feedzy-toggle_'</span> <span class="o">.</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span> <span class="o">.</span> <span class="s1">'"&gt;&lt;/label&gt;</span></td></tr><tr><th id="L691"><a href="#L691">691</a></th><td><span class="s1">                                                        &lt;span class="feedzy-spinner spinner"&gt;&lt;/span&gt;</span></td></tr><tr><th id="L692"><a href="#L692">692</a></th><td><span class="s1">                                                &lt;/div&gt;'</span><span class="p">,</span></td></tr><tr><th id="L693"><a href="#L693">693</a></th><td>                                                <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_wp_kses_allowed_html'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">)</span></td></tr><tr><th id="L694"><a href="#L694">694</a></th><td>                                        <span class="p">);</span></td></tr><tr><th id="L695"><a href="#L695">695</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L696"><a href="#L696">696</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L697"><a href="#L697">697</a></th><td>                        <span class="k">case</span> <span class="s1">'feedzy-last_run'</span><span class="o">:</span></td></tr><tr><th id="L698"><a href="#L698">698</a></th><td>                                <span class="nv">$last</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'last_run'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L699"><a href="#L699">699</a></th><td>                                <span class="nv">$msg</span>  <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Never Run'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L700"><a href="#L700">700</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nv">$last</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L701"><a href="#L701">701</a></th><td>                                        <span class="nv">$now</span>  <span class="o">=</span> <span class="k">new</span> <span class="nx">DateTime</span><span class="p">();</span></td></tr><tr><th id="L702"><a href="#L702">702</a></th><td>                                        <span class="nv">$then</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DateTime</span><span class="p">();</span></td></tr><tr><th id="L703"><a href="#L703">703</a></th><td>                                        <span class="nv">$then</span> <span class="o">=</span> <span class="nv">$then</span><span class="o">-&gt;</span><span class="na">setTimestamp</span><span class="p">(</span> <span class="nv">$last</span> <span class="p">);</span></td></tr><tr><th id="L704"><a href="#L704">704</a></th><td>                                        <span class="nv">$in</span>   <span class="o">=</span> <span class="nv">$now</span><span class="o">-&gt;</span><span class="na">diff</span><span class="p">(</span> <span class="nv">$then</span> <span class="p">);</span></td></tr><tr><th id="L705"><a href="#L705">705</a></th><td>                                        <span class="nv">$msg</span>  <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Ran %1$d hours %2$d minutes ago'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="nv">$in</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span> <span class="s1">'%h'</span> <span class="p">),</span> <span class="nv">$in</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span> <span class="s1">'%i'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L706"><a href="#L706">706</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L707"><a href="#L707">707</a></th><td></td></tr><tr><th id="L708"><a href="#L708">708</a></th><td>                                <span class="nv">$msg</span> <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_last_run_details</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">);</span></td></tr><tr><th id="L709"><a href="#L709">709</a></th><td>                                <span class="k">echo</span><span class="p">(</span> <span class="nv">$msg</span> <span class="p">);</span> <span class="c1">//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped</span></td></tr><tr><th id="L710"><a href="#L710">710</a></th><td><span class="c1"></span></td></tr><tr><th id="L711"><a href="#L711">711</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="s1">'publish'</span> <span class="o">===</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">post_status</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L712"><a href="#L712">712</a></th><td>                                        <span class="k">echo</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'&lt;p&gt;&lt;input type="button" class="button button-primary feedzy-run-now" data-id="%d" value="%s"&gt;&lt;/p&gt;'</span><span class="p">,</span> <span class="nx">esc_attr</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">),</span> <span class="nx">esc_attr__</span><span class="p">(</span> <span class="s1">'Run Now'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L713"><a href="#L713">713</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L714"><a href="#L714">714</a></th><td></td></tr><tr><th id="L715"><a href="#L715">715</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L716"><a href="#L716">716</a></th><td>                        <span class="k">case</span> <span class="s1">'feedzy-next_run'</span><span class="o">:</span></td></tr><tr><th id="L717"><a href="#L717">717</a></th><td>                                <span class="nv">$next</span> <span class="o">=</span> <span class="nx">wp_next_scheduled</span><span class="p">(</span> <span class="s1">'feedzy_cron'</span> <span class="p">);</span></td></tr><tr><th id="L718"><a href="#L718">718</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nv">$next</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L719"><a href="#L719">719</a></th><td>                                        <span class="nv">$now</span>  <span class="o">=</span> <span class="k">new</span> <span class="nx">DateTime</span><span class="p">();</span></td></tr><tr><th id="L720"><a href="#L720">720</a></th><td>                                        <span class="nv">$then</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DateTime</span><span class="p">();</span></td></tr><tr><th id="L721"><a href="#L721">721</a></th><td>                                        <span class="nv">$then</span> <span class="o">=</span> <span class="nv">$then</span><span class="o">-&gt;</span><span class="na">setTimestamp</span><span class="p">(</span> <span class="nv">$next</span> <span class="p">);</span></td></tr><tr><th id="L722"><a href="#L722">722</a></th><td>                                        <span class="nv">$in</span>   <span class="o">=</span> <span class="nv">$now</span><span class="o">-&gt;</span><span class="na">diff</span><span class="p">(</span> <span class="nv">$then</span> <span class="p">);</span></td></tr><tr><th id="L723"><a href="#L723">723</a></th><td>                                        <span class="k">echo</span> <span class="nx">wp_kses_post</span><span class="p">(</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'In %1$d hours %2$d minutes'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="nv">$in</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span> <span class="s1">'%h'</span> <span class="p">),</span> <span class="nv">$in</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span> <span class="s1">'%i'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L724"><a href="#L724">724</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L725"><a href="#L725">725</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L726"><a href="#L726">726</a></th><td>                        <span class="k">default</span><span class="o">:</span></td></tr><tr><th id="L727"><a href="#L727">727</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L728"><a href="#L728">728</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L729"><a href="#L729">729</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L730"><a href="#L730">730</a></th><td></td></tr><tr><th id="L731"><a href="#L731">731</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L732"><a href="#L732">732</a></th><td><span class="sd">         * Generate the markup that displays the status.</span></td></tr><tr><th id="L733"><a href="#L733">733</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L734"><a href="#L734">734</a></th><td><span class="sd">         * @param integer $post_id The post ID.</span></td></tr><tr><th id="L735"><a href="#L735">735</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L736"><a href="#L736">736</a></th><td><span class="sd">         * @since   ?</span></td></tr><tr><th id="L737"><a href="#L737">737</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L738"><a href="#L738">738</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L739"><a href="#L739">739</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">get_last_run_details</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L740"><a href="#L740">740</a></th><td>                <span class="nv">$msg</span>    <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L741"><a href="#L741">741</a></th><td>                <span class="nv">$last</span>   <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'last_run'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L742"><a href="#L742">742</a></th><td>                <span class="nv">$status</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L743"><a href="#L743">743</a></th><td>                        <span class="s1">'total'</span>      <span class="o">=&gt;</span> <span class="s1">'-'</span><span class="p">,</span></td></tr><tr><th id="L744"><a href="#L744">744</a></th><td>                        <span class="s1">'items'</span>      <span class="o">=&gt;</span> <span class="s1">'-'</span><span class="p">,</span></td></tr><tr><th id="L745"><a href="#L745">745</a></th><td>                        <span class="s1">'duplicates'</span> <span class="o">=&gt;</span> <span class="s1">'-'</span><span class="p">,</span></td></tr><tr><th id="L746"><a href="#L746">746</a></th><td>                        <span class="s1">'cumulative'</span> <span class="o">=&gt;</span> <span class="s1">'-'</span><span class="p">,</span></td></tr><tr><th id="L747"><a href="#L747">747</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L748"><a href="#L748">748</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$last</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L749"><a href="#L749">749</a></th><td>                        <span class="nv">$status</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L750"><a href="#L750">750</a></th><td>                                <span class="s1">'total'</span>      <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L751"><a href="#L751">751</a></th><td>                                <span class="s1">'items'</span>      <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L752"><a href="#L752">752</a></th><td>                                <span class="s1">'duplicates'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L753"><a href="#L753">753</a></th><td>                                <span class="s1">'cumulative'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L754"><a href="#L754">754</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L755"><a href="#L755">755</a></th><td>                        <span class="nv">$status</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_complete_import_status</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">);</span></td></tr><tr><th id="L756"><a href="#L756">756</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L757"><a href="#L757">757</a></th><td></td></tr><tr><th id="L758"><a href="#L758">758</a></th><td>                <span class="c1">// link to the posts listing for this job.</span></td></tr><tr><th id="L759"><a href="#L759">759</a></th><td><span class="c1"></span>                <span class="nv">$job_linked_posts</span> <span class="o">=</span> <span class="nx">add_query_arg</span><span class="p">(</span></td></tr><tr><th id="L760"><a href="#L760">760</a></th><td>                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L761"><a href="#L761">761</a></th><td>                                <span class="s1">'feedzy_job_id'</span> <span class="o">=&gt;</span> <span class="nv">$post_id</span><span class="p">,</span></td></tr><tr><th id="L762"><a href="#L762">762</a></th><td>                                <span class="s1">'post_type'</span>     <span class="o">=&gt;</span> <span class="nx">get_post_meta</span><span class="p">(</span></td></tr><tr><th id="L763"><a href="#L763">763</a></th><td>                                        <span class="nv">$post_id</span><span class="p">,</span></td></tr><tr><th id="L764"><a href="#L764">764</a></th><td>                                        <span class="s1">'import_post_type'</span><span class="p">,</span></td></tr><tr><th id="L765"><a href="#L765">765</a></th><td>                                        <span class="k">true</span></td></tr><tr><th id="L766"><a href="#L766">766</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L767"><a href="#L767">767</a></th><td>                                <span class="s1">'_nonce'</span>        <span class="o">=&gt;</span> <span class="nx">wp_create_nonce</span><span class="p">(</span> <span class="s1">'job_run_linked_posts'</span> <span class="p">),</span></td></tr><tr><th id="L768"><a href="#L768">768</a></th><td>                        <span class="p">),</span></td></tr><tr><th id="L769"><a href="#L769">769</a></th><td>                        <span class="nx">admin_url</span><span class="p">(</span> <span class="s1">'edit.php'</span> <span class="p">)</span></td></tr><tr><th id="L770"><a href="#L770">770</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L771"><a href="#L771">771</a></th><td></td></tr><tr><th id="L772"><a href="#L772">772</a></th><td>                <span class="c1">// link to the posts listing for this job run.</span></td></tr><tr><th id="L773"><a href="#L773">773</a></th><td><span class="c1"></span>                <span class="nv">$job_run_linked_posts</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L774"><a href="#L774">774</a></th><td>                <span class="nv">$job_run_id</span>           <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'last_run_id'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L775"><a href="#L775">775</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$job_run_id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L776"><a href="#L776">776</a></th><td>                        <span class="nv">$job_run_linked_posts</span> <span class="o">=</span> <span class="nx">add_query_arg</span><span class="p">(</span></td></tr><tr><th id="L777"><a href="#L777">777</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L778"><a href="#L778">778</a></th><td>                                        <span class="s1">'feedzy_job_id'</span>   <span class="o">=&gt;</span> <span class="nv">$post_id</span><span class="p">,</span></td></tr><tr><th id="L779"><a href="#L779">779</a></th><td>                                        <span class="s1">'feedzy_job_time'</span> <span class="o">=&gt;</span> <span class="nv">$job_run_id</span><span class="p">,</span></td></tr><tr><th id="L780"><a href="#L780">780</a></th><td>                                        <span class="s1">'_nonce'</span>          <span class="o">=&gt;</span> <span class="nx">wp_create_nonce</span><span class="p">(</span> <span class="s1">'job_run_linked_posts'</span> <span class="p">),</span></td></tr><tr><th id="L781"><a href="#L781">781</a></th><td>                                        <span class="s1">'post_type'</span>       <span class="o">=&gt;</span> <span class="nx">get_post_meta</span><span class="p">(</span></td></tr><tr><th id="L782"><a href="#L782">782</a></th><td>                                                <span class="nv">$post_id</span><span class="p">,</span></td></tr><tr><th id="L783"><a href="#L783">783</a></th><td>                                                <span class="s1">'import_post_type'</span><span class="p">,</span></td></tr><tr><th id="L784"><a href="#L784">784</a></th><td>                                                <span class="k">true</span></td></tr><tr><th id="L785"><a href="#L785">785</a></th><td>                                        <span class="p">),</span></td></tr><tr><th id="L786"><a href="#L786">786</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L787"><a href="#L787">787</a></th><td>                                <span class="nx">admin_url</span><span class="p">(</span> <span class="s1">'edit.php'</span> <span class="p">)</span></td></tr><tr><th id="L788"><a href="#L788">788</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L789"><a href="#L789">789</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L790"><a href="#L790">790</a></th><td></td></tr><tr><th id="L791"><a href="#L791">791</a></th><td>                <span class="c1">// popup for items found.</span></td></tr><tr><th id="L792"><a href="#L792">792</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L793"><a href="#L793">793</a></th><td>                        <span class="nv">$msg</span> <span class="o">.=</span> <span class="s1">'&lt;div class="feedzy-items-found-'</span> <span class="o">.</span> <span class="nv">$post_id</span> <span class="o">.</span> <span class="s1">' feedzy-dialog" title="'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Items found'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'"&gt;&lt;ol&gt;'</span><span class="p">;</span></td></tr><tr><th id="L794"><a href="#L794">794</a></th><td>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$url</span> <span class="o">=&gt;</span> <span class="nv">$title</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L795"><a href="#L795">795</a></th><td>                                <span class="nv">$msg</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'&lt;li&gt;&lt;p&gt;&lt;a href="%s" target="_blank"&gt;%s&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;'</span><span class="p">,</span> <span class="nx">esc_url</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">),</span> <span class="nx">esc_html</span><span class="p">(</span> <span class="nv">$title</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L796"><a href="#L796">796</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L797"><a href="#L797">797</a></th><td>                        <span class="nv">$msg</span> <span class="o">.=</span> <span class="s1">'&lt;/ol&gt;&lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L798"><a href="#L798">798</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L799"><a href="#L799">799</a></th><td></td></tr><tr><th id="L800"><a href="#L800">800</a></th><td>                <span class="c1">// popup for duplicates found.</span></td></tr><tr><th id="L801"><a href="#L801">801</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L802"><a href="#L802">802</a></th><td>                        <span class="nv">$msg</span> <span class="o">.=</span> <span class="s1">'&lt;div class="feedzy-duplicates-found-'</span> <span class="o">.</span> <span class="nv">$post_id</span> <span class="o">.</span> <span class="s1">' feedzy-dialog" title="'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Duplicates found'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'"&gt;&lt;ol&gt;'</span><span class="p">;</span></td></tr><tr><th id="L803"><a href="#L803">803</a></th><td>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$url</span> <span class="o">=&gt;</span> <span class="nv">$title</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L804"><a href="#L804">804</a></th><td>                                <span class="nv">$msg</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'&lt;li&gt;&lt;p&gt;&lt;a href="%s" target="_blank"&gt;%s&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;'</span><span class="p">,</span> <span class="nx">esc_url</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">),</span> <span class="nx">esc_html</span><span class="p">(</span> <span class="nv">$title</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L805"><a href="#L805">805</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L806"><a href="#L806">806</a></th><td>                        <span class="nv">$msg</span> <span class="o">.=</span> <span class="s1">'&lt;/ol&gt;&lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L807"><a href="#L807">807</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L808"><a href="#L808">808</a></th><td></td></tr><tr><th id="L809"><a href="#L809">809</a></th><td>                <span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_import_errors</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">);</span></td></tr><tr><th id="L810"><a href="#L810">810</a></th><td>                <span class="c1">// popup for errors found.</span></td></tr><tr><th id="L811"><a href="#L811">811</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$errors</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L812"><a href="#L812">812</a></th><td>                        <span class="nv">$msg</span> <span class="o">.=</span> <span class="s1">'&lt;div class="feedzy-errors-found-'</span> <span class="o">.</span> <span class="nv">$post_id</span> <span class="o">.</span> <span class="s1">' feedzy-dialog" title="'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Errors'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'"&gt;'</span> <span class="o">.</span> <span class="nv">$errors</span> <span class="o">.</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L813"><a href="#L813">813</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L814"><a href="#L814">814</a></th><td></td></tr><tr><th id="L815"><a href="#L815">815</a></th><td>                <span class="c1">// remember, cypress will work off the data-value attributes.</span></td></tr><tr><th id="L816"><a href="#L816">816</a></th><td><span class="c1"></span>                <span class="nv">$msg</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span></td></tr><tr><th id="L817"><a href="#L817">817</a></th><td>                        <span class="s1">'&lt;script class="feedzy-last-run-data" type="text/template"&gt;</span></td></tr><tr><th id="L818"><a href="#L818">818</a></th><td><span class="s1">                                &lt;tr style="display: none"&gt;&lt;/tr&gt;</span></td></tr><tr><th id="L819"><a href="#L819">819</a></th><td><span class="s1">                                &lt;tr class="feedzy-import-status-row"&gt;</span></td></tr><tr><th id="L820"><a href="#L820">820</a></th><td><span class="s1">                                        &lt;td colspan="6" align="right"&gt;</span></td></tr><tr><th id="L821"><a href="#L821">821</a></th><td><span class="s1">                                                &lt;table&gt;</span></td></tr><tr><th id="L822"><a href="#L822">822</a></th><td><span class="s1">                                                        &lt;tr&gt;</span></td></tr><tr><th id="L823"><a href="#L823">823</a></th><td><span class="s1">                                                                &lt;td class="feedzy-items %s" data-value="%d"&gt;&lt;a class="feedzy-popup-details feedzy-dialog-open" title="%s" data-dialog="feedzy-items-found-%d"&gt;%s&lt;/a&gt;&lt;/td&gt;</span></td></tr><tr><th id="L824"><a href="#L824">824</a></th><td><span class="s1">                                                                &lt;td class="feedzy-duplicates %s" data-value="%d"&gt;&lt;a class="feedzy-popup-details feedzy-dialog-open" title="%s" data-dialog="feedzy-duplicates-found-%d"&gt;%s&lt;/a&gt;&lt;/td&gt;</span></td></tr><tr><th id="L825"><a href="#L825">825</a></th><td><span class="s1">                                                                &lt;td class="feedzy-imported %s" data-value="%d"&gt;&lt;a target="%s" href="%s" class="feedzy-popup-details" title="%s"&gt;%s&lt;/a&gt;&lt;/td&gt;</span></td></tr><tr><th id="L826"><a href="#L826">826</a></th><td><span class="s1">                                                                &lt;td class="feedzy-cumulative %s" data-value="%d"&gt;&lt;a target="%s" href="%s" class="feedzy-popup-details" title="%s"&gt;%s&lt;/a&gt;&lt;/td&gt;</span></td></tr><tr><th id="L827"><a href="#L827">827</a></th><td><span class="s1">                                                                &lt;td class="feedzy-error-status %s" data-value="%d"&gt;&lt;a class="feedzy-popup-details feedzy-dialog-open" data-dialog="feedzy-errors-found-%d" title="%s"&gt;%s&lt;/a&gt;&lt;/td&gt;</span></td></tr><tr><th id="L828"><a href="#L828">828</a></th><td><span class="s1">                                                        &lt;/tr&gt;</span></td></tr><tr><th id="L829"><a href="#L829">829</a></th><td><span class="s1">                                                        &lt;tr&gt;</span></td></tr><tr><th id="L830"><a href="#L830">830</a></th><td><span class="s1">                                                                &lt;td&gt;%s&lt;/td&gt;</span></td></tr><tr><th id="L831"><a href="#L831">831</a></th><td><span class="s1">                                                                &lt;td&gt;%s&lt;/td&gt;</span></td></tr><tr><th id="L832"><a href="#L832">832</a></th><td><span class="s1">                                                                &lt;td&gt;%s&lt;/td&gt;</span></td></tr><tr><th id="L833"><a href="#L833">833</a></th><td><span class="s1">                                                                &lt;td&gt;%s&lt;/td&gt;</span></td></tr><tr><th id="L834"><a href="#L834">834</a></th><td><span class="s1">                                                                &lt;td&gt;%s&lt;/td&gt;</span></td></tr><tr><th id="L835"><a href="#L835">835</a></th><td><span class="s1">                                                        &lt;/tr&gt;</span></td></tr><tr><th id="L836"><a href="#L836">836</a></th><td><span class="s1">                                                &lt;/table&gt;</span></td></tr><tr><th id="L837"><a href="#L837">837</a></th><td><span class="s1">                                        &lt;/td&gt;</span></td></tr><tr><th id="L838"><a href="#L838">838</a></th><td><span class="s1">                                &lt;/tr&gt;</span></td></tr><tr><th id="L839"><a href="#L839">839</a></th><td><span class="s1">                        &lt;/script&gt;'</span><span class="p">,</span></td></tr><tr><th id="L840"><a href="#L840">840</a></th><td>                        <span class="c1">// first cell</span></td></tr><tr><th id="L841"><a href="#L841">841</a></th><td><span class="c1"></span>                        <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'feedzy-has-popup'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L842"><a href="#L842">842</a></th><td>                        <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">count</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">],</span></td></tr><tr><th id="L843"><a href="#L843">843</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Items that were found in the feed'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L844"><a href="#L844">844</a></th><td>                        <span class="nv">$post_id</span><span class="p">,</span></td></tr><tr><th id="L845"><a href="#L845">845</a></th><td>                        <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">count</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">],</span></td></tr><tr><th id="L846"><a href="#L846">846</a></th><td>                        <span class="c1">// second cells</span></td></tr><tr><th id="L847"><a href="#L847">847</a></th><td><span class="c1"></span>                        <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'feedzy-has-popup'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L848"><a href="#L848">848</a></th><td>                        <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">count</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">],</span></td></tr><tr><th id="L849"><a href="#L849">849</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Items that were discarded as duplicates'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L850"><a href="#L850">850</a></th><td>                        <span class="nv">$post_id</span><span class="p">,</span></td></tr><tr><th id="L851"><a href="#L851">851</a></th><td>                        <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">count</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">],</span></td></tr><tr><th id="L852"><a href="#L852">852</a></th><td>                        <span class="c1">// third cell</span></td></tr><tr><th id="L853"><a href="#L853">853</a></th><td><span class="c1"></span>                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'total'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$job_run_linked_posts</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'feedzy-has-popup'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L854"><a href="#L854">854</a></th><td>                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'total'</span><span class="p">],</span></td></tr><tr><th id="L855"><a href="#L855">855</a></th><td>                        <span class="nb">defined</span><span class="p">(</span> <span class="s1">'TI_CYPRESS_TESTING'</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">''</span> <span class="o">:</span> <span class="s1">'_blank'</span><span class="p">,</span></td></tr><tr><th id="L856"><a href="#L856">856</a></th><td>                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'total'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$job_run_linked_posts</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$job_run_linked_posts</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L857"><a href="#L857">857</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Items that were imported'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L858"><a href="#L858">858</a></th><td>                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'total'</span><span class="p">],</span></td></tr><tr><th id="L859"><a href="#L859">859</a></th><td>                        <span class="c1">// fourth cell</span></td></tr><tr><th id="L860"><a href="#L860">860</a></th><td><span class="c1"></span>                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'cumulative'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="s1">'feedzy-has-popup'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L861"><a href="#L861">861</a></th><td>                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'cumulative'</span><span class="p">],</span></td></tr><tr><th id="L862"><a href="#L862">862</a></th><td>                        <span class="nb">defined</span><span class="p">(</span> <span class="s1">'TI_CYPRESS_TESTING'</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">''</span> <span class="o">:</span> <span class="s1">'_blank'</span><span class="p">,</span></td></tr><tr><th id="L863"><a href="#L863">863</a></th><td>                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'cumulative'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nv">$job_linked_posts</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L864"><a href="#L864">864</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Items that were imported across all runs'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L865"><a href="#L865">865</a></th><td>                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'cumulative'</span><span class="p">],</span></td></tr><tr><th id="L866"><a href="#L866">866</a></th><td>                        <span class="c1">// fifth cell</span></td></tr><tr><th id="L867"><a href="#L867">867</a></th><td><span class="c1"></span>                        <span class="k">empty</span><span class="p">(</span> <span class="nv">$last</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">''</span> <span class="o">:</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$errors</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'feedzy-has-popup import-error'</span> <span class="o">:</span> <span class="s1">'import-success'</span> <span class="p">),</span></td></tr><tr><th id="L868"><a href="#L868">868</a></th><td>                        <span class="k">empty</span><span class="p">(</span> <span class="nv">$last</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'-1'</span> <span class="o">:</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$errors</span> <span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">),</span></td></tr><tr><th id="L869"><a href="#L869">869</a></th><td>                        <span class="nv">$post_id</span><span class="p">,</span></td></tr><tr><th id="L870"><a href="#L870">870</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'View the errors'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L871"><a href="#L871">871</a></th><td>                        <span class="k">empty</span><span class="p">(</span> <span class="nv">$last</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'-'</span> <span class="o">:</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$errors</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'&lt;i class="dashicons dashicons-warning"&gt;&lt;/i&gt;'</span> <span class="o">:</span> <span class="s1">'&lt;i class="dashicons dashicons-yes-alt"&gt;&lt;/i&gt;'</span> <span class="p">),</span></td></tr><tr><th id="L872"><a href="#L872">872</a></th><td>                        <span class="c1">// second row</span></td></tr><tr><th id="L873"><a href="#L873">873</a></th><td><span class="c1"></span>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Found'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L874"><a href="#L874">874</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Duplicates'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L875"><a href="#L875">875</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Imported'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L876"><a href="#L876">876</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Cumulative'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L877"><a href="#L877">877</a></th><td>                        <span class="nx">__</span><span class="p">(</span> <span class="s1">'Status'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span></td></tr><tr><th id="L878"><a href="#L878">878</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L879"><a href="#L879">879</a></th><td></td></tr><tr><th id="L880"><a href="#L880">880</a></th><td>                <span class="k">return</span> <span class="nv">$msg</span><span class="p">;</span></td></tr><tr><th id="L881"><a href="#L881">881</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L882"><a href="#L882">882</a></th><td></td></tr><tr><th id="L883"><a href="#L883">883</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L884"><a href="#L884">884</a></th><td><span class="sd">         * Gets every aspect of the import job that would reflect its status.</span></td></tr><tr><th id="L885"><a href="#L885">885</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L886"><a href="#L886">886</a></th><td><span class="sd">         * @since   ?</span></td></tr><tr><th id="L887"><a href="#L887">887</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L888"><a href="#L888">888</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L889"><a href="#L889">889</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">get_complete_import_status</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L890"><a href="#L890">890</a></th><td>                <span class="nv">$items_count</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'imported_items_count'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L891"><a href="#L891">891</a></th><td>                <span class="nv">$items</span>       <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'imported_items_hash'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L892"><a href="#L892">892</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$items</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L893"><a href="#L893">893</a></th><td>                        <span class="nv">$items</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'imported_items'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L894"><a href="#L894">894</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L895"><a href="#L895">895</a></th><td>                <span class="nv">$count</span> <span class="o">=</span> <span class="nv">$items_count</span><span class="p">;</span></td></tr><tr><th id="L896"><a href="#L896">896</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="s1">''</span> <span class="o">===</span> <span class="nv">$count</span> <span class="o">&amp;&amp;</span> <span class="nv">$items</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L897"><a href="#L897">897</a></th><td>                        <span class="c1">// backward compatibility where imported_items_count post_meta has not been populated yet</span></td></tr><tr><th id="L898"><a href="#L898">898</a></th><td><span class="c1"></span>                        <span class="nv">$count</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span> <span class="nv">$items</span> <span class="p">);</span></td></tr><tr><th id="L899"><a href="#L899">899</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L900"><a href="#L900">900</a></th><td></td></tr><tr><th id="L901"><a href="#L901">901</a></th><td>                <span class="nv">$status</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L902"><a href="#L902">902</a></th><td>                        <span class="s1">'total'</span>      <span class="o">=&gt;</span> <span class="nv">$count</span><span class="p">,</span></td></tr><tr><th id="L903"><a href="#L903">903</a></th><td>                        <span class="s1">'items'</span>      <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L904"><a href="#L904">904</a></th><td>                        <span class="s1">'duplicates'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L905"><a href="#L905">905</a></th><td>                        <span class="s1">'cumulative'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L906"><a href="#L906">906</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L907"><a href="#L907">907</a></th><td></td></tr><tr><th id="L908"><a href="#L908">908</a></th><td>                <span class="nv">$import_info</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'import_info'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L909"><a href="#L909">909</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$import_info</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L910"><a href="#L910">910</a></th><td>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$import_info</span> <span class="k">as</span> <span class="nv">$label</span> <span class="o">=&gt;</span> <span class="nv">$value</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L911"><a href="#L911">911</a></th><td>                                <span class="k">switch</span> <span class="p">(</span> <span class="nv">$label</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L912"><a href="#L912">912</a></th><td>                                        <span class="k">case</span> <span class="s1">'total'</span><span class="o">:</span></td></tr><tr><th id="L913"><a href="#L913">913</a></th><td>                                                <span class="k">if</span> <span class="p">(</span> <span class="nb">count</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L914"><a href="#L914">914</a></th><td>                                                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'items'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span></td></tr><tr><th id="L915"><a href="#L915">915</a></th><td>                                                <span class="p">}</span></td></tr><tr><th id="L916"><a href="#L916">916</a></th><td>                                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L917"><a href="#L917">917</a></th><td>                                        <span class="k">case</span> <span class="s1">'duplicates'</span><span class="o">:</span></td></tr><tr><th id="L918"><a href="#L918">918</a></th><td>                                                <span class="k">if</span> <span class="p">(</span> <span class="nb">count</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L919"><a href="#L919">919</a></th><td>                                                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span></td></tr><tr><th id="L920"><a href="#L920">920</a></th><td>                                                <span class="p">}</span></td></tr><tr><th id="L921"><a href="#L921">921</a></th><td>                                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L922"><a href="#L922">922</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L923"><a href="#L923">923</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L924"><a href="#L924">924</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L925"><a href="#L925">925</a></th><td></td></tr><tr><th id="L926"><a href="#L926">926</a></th><td>                <span class="nv">$items</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'imported_items_hash'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L927"><a href="#L927">927</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$items</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L928"><a href="#L928">928</a></th><td>                        <span class="nv">$items</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'imported_items'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L929"><a href="#L929">929</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L930"><a href="#L930">930</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$items</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L931"><a href="#L931">931</a></th><td>                        <span class="nv">$status</span><span class="p">[</span><span class="s1">'cumulative'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span> <span class="nv">$items</span> <span class="p">);</span></td></tr><tr><th id="L932"><a href="#L932">932</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L933"><a href="#L933">933</a></th><td></td></tr><tr><th id="L934"><a href="#L934">934</a></th><td>                <span class="k">return</span> <span class="nv">$status</span><span class="p">;</span></td></tr><tr><th id="L935"><a href="#L935">935</a></th><td></td></tr><tr><th id="L936"><a href="#L936">936</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L937"><a href="#L937">937</a></th><td></td></tr><tr><th id="L938"><a href="#L938">938</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L939"><a href="#L939">939</a></th><td><span class="sd">         * Creates the data by extracting the 'import_errors' from each import.</span></td></tr><tr><th id="L940"><a href="#L940">940</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L941"><a href="#L941">941</a></th><td><span class="sd">         * @since   ?</span></td></tr><tr><th id="L942"><a href="#L942">942</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L943"><a href="#L943">943</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L944"><a href="#L944">944</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">get_import_errors</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L945"><a href="#L945">945</a></th><td>                <span class="nv">$msg</span>           <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L946"><a href="#L946">946</a></th><td>                <span class="nv">$import_errors</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'import_errors'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L947"><a href="#L947">947</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$import_errors</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L948"><a href="#L948">948</a></th><td>                        <span class="nv">$errors</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L949"><a href="#L949">949</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$import_errors</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L950"><a href="#L950">950</a></th><td>                                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$import_errors</span> <span class="k">as</span> <span class="nv">$err</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L951"><a href="#L951">951</a></th><td>                                        <span class="nv">$errors</span> <span class="o">.=</span> <span class="s1">'&lt;div&gt;&lt;i class="dashicons dashicons-warning"&gt;&lt;/i&gt;'</span> <span class="o">.</span> <span class="nv">$err</span> <span class="o">.</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L952"><a href="#L952">952</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L953"><a href="#L953">953</a></th><td>                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L954"><a href="#L954">954</a></th><td>                                <span class="nv">$errors</span> <span class="o">=</span> <span class="s1">'&lt;div&gt;&lt;i class="dashicons dashicons-warning"&gt;&lt;/i&gt;'</span> <span class="o">.</span> <span class="nv">$import_errors</span> <span class="o">.</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L955"><a href="#L955">955</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L956"><a href="#L956">956</a></th><td>                        <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">'&lt;div class="feedzy-error feedzy-api-error"&gt;'</span> <span class="o">.</span> <span class="nv">$errors</span> <span class="o">.</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L957"><a href="#L957">957</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L958"><a href="#L958">958</a></th><td></td></tr><tr><th id="L959"><a href="#L959">959</a></th><td>                <span class="nv">$pro_msg</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_run_status_errors'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="p">);</span></td></tr><tr><th id="L960"><a href="#L960">960</a></th><td></td></tr><tr><th id="L961"><a href="#L961">961</a></th><td>                <span class="c1">// the pro messages may not have the dashicons, so let's add them.</span></td></tr><tr><th id="L962"><a href="#L962">962</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$pro_msg</span> <span class="o">&amp;&amp;</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$pro_msg</span><span class="p">,</span> <span class="s1">'dashicons-warning'</span> <span class="p">)</span> <span class="o">===</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L963"><a href="#L963">963</a></th><td>                        <span class="nv">$errors</span>     <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L964"><a href="#L964">964</a></th><td>                        <span class="nv">$pro_errors</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span> <span class="s1">'&lt;br&gt;'</span><span class="p">,</span> <span class="nv">$pro_msg</span> <span class="p">);</span></td></tr><tr><th id="L965"><a href="#L965">965</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$pro_errors</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L966"><a href="#L966">966</a></th><td>                                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$pro_errors</span> <span class="k">as</span> <span class="nv">$err</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L967"><a href="#L967">967</a></th><td>                                        <span class="nv">$errors</span> <span class="o">.=</span> <span class="s1">'&lt;div&gt;&lt;i class="dashicons dashicons-warning"&gt;&lt;/i&gt;'</span> <span class="o">.</span> <span class="nv">$err</span> <span class="o">.</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L968"><a href="#L968">968</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L969"><a href="#L969">969</a></th><td>                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L970"><a href="#L970">970</a></th><td>                                <span class="nv">$errors</span> <span class="o">=</span> <span class="s1">'&lt;div&gt;&lt;i class="dashicons dashicons-warning"&gt;&lt;/i&gt;'</span> <span class="o">.</span> <span class="nv">$pro_errors</span> <span class="o">.</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L971"><a href="#L971">971</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L972"><a href="#L972">972</a></th><td>                        <span class="nv">$pro_msg</span> <span class="o">=</span> <span class="s1">'&lt;div class="feedzy-error feedzy-api-error"&gt;'</span> <span class="o">.</span> <span class="nv">$errors</span> <span class="o">.</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span></td></tr><tr><th id="L973"><a href="#L973">973</a></th><td></td></tr><tr><th id="L974"><a href="#L974">974</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L975"><a href="#L975">975</a></th><td></td></tr><tr><th id="L976"><a href="#L976">976</a></th><td>                <span class="k">return</span> <span class="nv">$msg</span> <span class="o">.</span> <span class="nv">$pro_msg</span><span class="p">;</span></td></tr><tr><th id="L977"><a href="#L977">977</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L978"><a href="#L978">978</a></th><td></td></tr><tr><th id="L979"><a href="#L979">979</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L980"><a href="#L980">980</a></th><td><span class="sd">         * AJAX single-entry method.</span></td></tr><tr><th id="L981"><a href="#L981">981</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L982"><a href="#L982">982</a></th><td><span class="sd">         * @since   3.4.1</span></td></tr><tr><th id="L983"><a href="#L983">983</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L984"><a href="#L984">984</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L985"><a href="#L985">985</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">ajax</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L986"><a href="#L986">986</a></th><td>                <span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="nx">FEEDZY_BASEFILE</span><span class="p">,</span> <span class="s1">'security'</span> <span class="p">);</span></td></tr><tr><th id="L987"><a href="#L987">987</a></th><td></td></tr><tr><th id="L988"><a href="#L988">988</a></th><td>                <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'feedzy_category_meta_noncename'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'security'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">);</span></td></tr><tr><th id="L989"><a href="#L989">989</a></th><td>                <span class="nv">$_action</span>                                 <span class="o">=</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'_action'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">);</span></td></tr><tr><th id="L990"><a href="#L990">990</a></th><td></td></tr><tr><th id="L991"><a href="#L991">991</a></th><td>                <span class="k">switch</span> <span class="p">(</span> <span class="nv">$_action</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L992"><a href="#L992">992</a></th><td>                        <span class="k">case</span> <span class="s1">'import_status'</span><span class="o">:</span></td></tr><tr><th id="L993"><a href="#L993">993</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">import_status</span><span class="p">();</span></td></tr><tr><th id="L994"><a href="#L994">994</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L995"><a href="#L995">995</a></th><td>                        <span class="k">case</span> <span class="s1">'get_taxonomies'</span><span class="o">:</span></td></tr><tr><th id="L996"><a href="#L996">996</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_taxonomies</span><span class="p">();</span></td></tr><tr><th id="L997"><a href="#L997">997</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L998"><a href="#L998">998</a></th><td>                        <span class="k">case</span> <span class="s1">'run_now'</span><span class="o">:</span></td></tr><tr><th id="L999"><a href="#L999">999</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">run_now</span><span class="p">();</span></td></tr><tr><th id="L1000"><a href="#L1000">1000</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L1001"><a href="#L1001">1001</a></th><td>                        <span class="k">case</span> <span class="s1">'purge'</span><span class="o">:</span></td></tr><tr><th id="L1002"><a href="#L1002">1002</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">purge_data</span><span class="p">();</span></td></tr><tr><th id="L1003"><a href="#L1003">1003</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L1004"><a href="#L1004">1004</a></th><td>                        <span class="k">case</span> <span class="s1">'dry_run'</span><span class="o">:</span></td></tr><tr><th id="L1005"><a href="#L1005">1005</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dry_run</span><span class="p">();</span></td></tr><tr><th id="L1006"><a href="#L1006">1006</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L1007"><a href="#L1007">1007</a></th><td>                        <span class="k">case</span> <span class="s1">'fetch_custom_fields'</span><span class="o">:</span></td></tr><tr><th id="L1008"><a href="#L1008">1008</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch_custom_fields</span><span class="p">();</span></td></tr><tr><th id="L1009"><a href="#L1009">1009</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L1010"><a href="#L1010">1010</a></th><td>                        <span class="k">case</span> <span class="s1">'wizard_import_feed'</span><span class="o">:</span></td></tr><tr><th id="L1011"><a href="#L1011">1011</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">wizard_import_feed</span><span class="p">();</span></td></tr><tr><th id="L1012"><a href="#L1012">1012</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L1013"><a href="#L1013">1013</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1014"><a href="#L1014">1014</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L1015"><a href="#L1015">1015</a></th><td></td></tr><tr><th id="L1016"><a href="#L1016">1016</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L1017"><a href="#L1017">1017</a></th><td><span class="sd">         * AJAX called method to update post status.</span></td></tr><tr><th id="L1018"><a href="#L1018">1018</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1019"><a href="#L1019">1019</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L1020"><a href="#L1020">1020</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L1021"><a href="#L1021">1021</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L1022"><a href="#L1022">1022</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">import_status</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L1023"><a href="#L1023">1023</a></th><td>                <span class="k">global</span> <span class="nv">$wpdb</span><span class="p">;</span></td></tr><tr><th id="L1024"><a href="#L1024">1024</a></th><td></td></tr><tr><th id="L1025"><a href="#L1025">1025</a></th><td>                <span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="nx">FEEDZY_BASEFILE</span><span class="p">,</span> <span class="s1">'security'</span> <span class="p">);</span></td></tr><tr><th id="L1026"><a href="#L1026">1026</a></th><td></td></tr><tr><th id="L1027"><a href="#L1027">1027</a></th><td>                <span class="nv">$id</span>      <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span></td></tr><tr><th id="L1028"><a href="#L1028">1028</a></th><td>                <span class="nv">$status</span>  <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'status'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'status'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1029"><a href="#L1029">1029</a></th><td>                <span class="nv">$publish</span> <span class="o">=</span> <span class="s1">'draft'</span><span class="p">;</span></td></tr><tr><th id="L1030"><a href="#L1030">1030</a></th><td>                <span class="c1">// no activation till source is not valid.</span></td></tr><tr><th id="L1031"><a href="#L1031">1031</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="s1">'true'</span> <span class="o">===</span> <span class="nv">$status</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1032"><a href="#L1032">1032</a></th><td>                        <span class="nv">$invalid_urls</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_check_source_validity'</span><span class="p">,</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$id</span><span class="p">,</span> <span class="s1">'source'</span><span class="p">,</span> <span class="k">true</span> <span class="p">),</span> <span class="nv">$id</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="k">false</span> <span class="p">);</span></td></tr><tr><th id="L1033"><a href="#L1033">1033</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$invalid_urls</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1034"><a href="#L1034">1034</a></th><td>                                <span class="nv">$msg</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_get_source_validity_error'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="nx">get_post</span><span class="p">(</span> <span class="nv">$id</span> <span class="p">),</span> <span class="s1">''</span> <span class="p">);</span></td></tr><tr><th id="L1035"><a href="#L1035">1035</a></th><td>                                <span class="nx">wp_send_json_error</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'msg'</span> <span class="o">=&gt;</span> <span class="nv">$msg</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1036"><a href="#L1036">1036</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1037"><a href="#L1037">1037</a></th><td></td></tr><tr><th id="L1038"><a href="#L1038">1038</a></th><td>                        <span class="nv">$publish</span> <span class="o">=</span> <span class="s1">'publish'</span><span class="p">;</span></td></tr><tr><th id="L1039"><a href="#L1039">1039</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1040"><a href="#L1040">1040</a></th><td></td></tr><tr><th id="L1041"><a href="#L1041">1041</a></th><td>                <span class="nv">$new_post_status</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1042"><a href="#L1042">1042</a></th><td>                        <span class="s1">'ID'</span>          <span class="o">=&gt;</span> <span class="nv">$id</span><span class="p">,</span></td></tr><tr><th id="L1043"><a href="#L1043">1043</a></th><td>                        <span class="s1">'post_status'</span> <span class="o">=&gt;</span> <span class="nv">$publish</span><span class="p">,</span></td></tr><tr><th id="L1044"><a href="#L1044">1044</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L1045"><a href="#L1045">1045</a></th><td></td></tr><tr><th id="L1046"><a href="#L1046">1046</a></th><td>                <span class="nx">remove_action</span><span class="p">(</span> <span class="s1">'save_post_feedzy_imports'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">'save_feedzy_import_feed_meta'</span> <span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span></td></tr><tr><th id="L1047"><a href="#L1047">1047</a></th><td>                <span class="nv">$post_id</span> <span class="o">=</span> <span class="nx">wp_update_post</span><span class="p">(</span> <span class="nv">$new_post_status</span> <span class="p">);</span></td></tr><tr><th id="L1048"><a href="#L1048">1048</a></th><td>                <span class="nx">add_action</span><span class="p">(</span> <span class="s1">'save_post_feedzy_imports'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">'save_feedzy_import_feed_meta'</span> <span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span></td></tr><tr><th id="L1049"><a href="#L1049">1049</a></th><td></td></tr><tr><th id="L1050"><a href="#L1050">1050</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$post_id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1051"><a href="#L1051">1051</a></th><td>                        <span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$post_id</span><span class="o">-&gt;</span><span class="na">get_error_messages</span><span class="p">();</span></td></tr><tr><th id="L1052"><a href="#L1052">1052</a></th><td>                        <span class="nx">wp_send_json_error</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'msg'</span> <span class="o">=&gt;</span> <span class="nb">implode</span><span class="p">(</span> <span class="s1">', '</span><span class="p">,</span> <span class="nv">$errors</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1053"><a href="#L1053">1053</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1054"><a href="#L1054">1054</a></th><td>                <span class="nx">wp_send_json_success</span><span class="p">();</span></td></tr><tr><th id="L1055"><a href="#L1055">1055</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L1056"><a href="#L1056">1056</a></th><td></td></tr><tr><th id="L1057"><a href="#L1057">1057</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L1058"><a href="#L1058">1058</a></th><td><span class="sd">         * AJAX method to get taxonomies for a given post_type.</span></td></tr><tr><th id="L1059"><a href="#L1059">1059</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1060"><a href="#L1060">1060</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L1061"><a href="#L1061">1061</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L1062"><a href="#L1062">1062</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L1063"><a href="#L1063">1063</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">get_taxonomies</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L1064"><a href="#L1064">1064</a></th><td>                <span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="nx">FEEDZY_BASEFILE</span><span class="p">,</span> <span class="s1">'security'</span> <span class="p">);</span></td></tr><tr><th id="L1065"><a href="#L1065">1065</a></th><td></td></tr><tr><th id="L1066"><a href="#L1066">1066</a></th><td>                <span class="nv">$post_type</span>  <span class="o">=</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'post_type'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">);</span></td></tr><tr><th id="L1067"><a href="#L1067">1067</a></th><td>                <span class="nv">$taxonomies</span> <span class="o">=</span> <span class="nx">get_object_taxonomies</span><span class="p">(</span></td></tr><tr><th id="L1068"><a href="#L1068">1068</a></th><td>                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1069"><a href="#L1069">1069</a></th><td>                                <span class="s1">'post_type'</span> <span class="o">=&gt;</span> <span class="nv">$post_type</span><span class="p">,</span></td></tr><tr><th id="L1070"><a href="#L1070">1070</a></th><td>                        <span class="p">)</span></td></tr><tr><th id="L1071"><a href="#L1071">1071</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L1072"><a href="#L1072">1072</a></th><td>                <span class="nv">$results</span>    <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1073"><a href="#L1073">1073</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$taxonomies</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1074"><a href="#L1074">1074</a></th><td>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$taxonomies</span> <span class="k">as</span> <span class="nv">$taxonomy</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1075"><a href="#L1075">1075</a></th><td>                                <span class="nv">$terms</span>                <span class="o">=</span> <span class="nx">get_terms</span><span class="p">(</span></td></tr><tr><th id="L1076"><a href="#L1076">1076</a></th><td>                                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1077"><a href="#L1077">1077</a></th><td>                                                <span class="s1">'taxonomy'</span>   <span class="o">=&gt;</span> <span class="nv">$taxonomy</span><span class="p">,</span></td></tr><tr><th id="L1078"><a href="#L1078">1078</a></th><td>                                                <span class="s1">'hide_empty'</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span></td></tr><tr><th id="L1079"><a href="#L1079">1079</a></th><td>                                                <span class="s1">'fields'</span>     <span class="o">=&gt;</span> <span class="s1">'id=&gt;name'</span><span class="p">,</span></td></tr><tr><th id="L1080"><a href="#L1080">1080</a></th><td>                                                <span class="s1">'number'</span>     <span class="o">=&gt;</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_post_taxonomy_limit'</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span> <span class="nv">$taxonomy</span> <span class="p">),</span></td></tr><tr><th id="L1081"><a href="#L1081">1081</a></th><td>                                        <span class="p">)</span></td></tr><tr><th id="L1082"><a href="#L1082">1082</a></th><td>                                <span class="p">);</span></td></tr><tr><th id="L1083"><a href="#L1083">1083</a></th><td>                                <span class="nv">$results</span><span class="p">[</span> <span class="nv">$taxonomy</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$terms</span><span class="p">;</span></td></tr><tr><th id="L1084"><a href="#L1084">1084</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1085"><a href="#L1085">1085</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1086"><a href="#L1086">1086</a></th><td>                <span class="k">echo</span> <span class="nx">wp_json_encode</span><span class="p">(</span> <span class="nv">$results</span> <span class="p">);</span></td></tr><tr><th id="L1087"><a href="#L1087">1087</a></th><td>                <span class="nx">wp_die</span><span class="p">();</span></td></tr><tr><th id="L1088"><a href="#L1088">1088</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L1089"><a href="#L1089">1089</a></th><td></td></tr><tr><th id="L1090"><a href="#L1090">1090</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L1091"><a href="#L1091">1091</a></th><td><span class="sd">         * Run a specific job.</span></td></tr><tr><th id="L1092"><a href="#L1092">1092</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1093"><a href="#L1093">1093</a></th><td><span class="sd">         * @since   1.6.1</span></td></tr><tr><th id="L1094"><a href="#L1094">1094</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L1095"><a href="#L1095">1095</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L1096"><a href="#L1096">1096</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">run_now</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L1097"><a href="#L1097">1097</a></th><td>                <span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="nx">FEEDZY_BASEFILE</span><span class="p">,</span> <span class="s1">'security'</span> <span class="p">);</span></td></tr><tr><th id="L1098"><a href="#L1098">1098</a></th><td></td></tr><tr><th id="L1099"><a href="#L1099">1099</a></th><td>                <span class="nv">$job</span>   <span class="o">=</span> <span class="nx">get_post</span><span class="p">(</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'id'</span><span class="p">,</span> <span class="nx">FILTER_SANITIZE_NUMBER_INT</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1100"><a href="#L1100">1100</a></th><td>                <span class="nv">$count</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">run_job</span><span class="p">(</span> <span class="nv">$job</span><span class="p">,</span> <span class="mi">100</span> <span class="p">);</span></td></tr><tr><th id="L1101"><a href="#L1101">1101</a></th><td></td></tr><tr><th id="L1102"><a href="#L1102">1102</a></th><td>                <span class="nv">$msg</span> <span class="o">=</span> <span class="nv">$count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Successfully run!'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">:</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Nothing imported!'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L1103"><a href="#L1103">1103</a></th><td>                <span class="nv">$msg</span> <span class="o">.=</span> <span class="s1">' ('</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Refresh this page for the updated status'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">')'</span><span class="p">;</span></td></tr><tr><th id="L1104"><a href="#L1104">1104</a></th><td></td></tr><tr><th id="L1105"><a href="#L1105">1105</a></th><td>                <span class="nx">wp_send_json_success</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'msg'</span> <span class="o">=&gt;</span> <span class="nv">$msg</span><span class="p">,</span> <span class="s1">'import_success'</span> <span class="o">=&gt;</span> <span class="nv">$count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1106"><a href="#L1106">1106</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L1107"><a href="#L1107">1107</a></th><td></td></tr><tr><th id="L1108"><a href="#L1108">1108</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L1109"><a href="#L1109">1109</a></th><td><span class="sd">         * Dry run a specific job so that the user is aware what would be imported.</span></td></tr><tr><th id="L1110"><a href="#L1110">1110</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1111"><a href="#L1111">1111</a></th><td><span class="sd">         * @since  ?</span></td></tr><tr><th id="L1112"><a href="#L1112">1112</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L1113"><a href="#L1113">1113</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L1114"><a href="#L1114">1114</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">dry_run</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L1115"><a href="#L1115">1115</a></th><td>                <span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="nx">FEEDZY_BASEFILE</span><span class="p">,</span> <span class="s1">'security'</span> <span class="p">);</span></td></tr><tr><th id="L1116"><a href="#L1116">1116</a></th><td></td></tr><tr><th id="L1117"><a href="#L1117">1117</a></th><td>                <span class="nv">$fields</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'fields'</span><span class="p">,</span> <span class="nx">FILTER_SANITIZE_URL</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1118"><a href="#L1118">1118</a></th><td>                <span class="nb">parse_str</span><span class="p">(</span> <span class="nv">$fields</span><span class="p">,</span> <span class="nv">$data</span> <span class="p">);</span></td></tr><tr><th id="L1119"><a href="#L1119">1119</a></th><td></td></tr><tr><th id="L1120"><a href="#L1120">1120</a></th><td>                <span class="nv">$feedzy_meta_data</span> <span class="o">=</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">'feedzy_meta_data'</span><span class="p">];</span></td></tr><tr><th id="L1121"><a href="#L1121">1121</a></th><td></td></tr><tr><th id="L1122"><a href="#L1122">1122</a></th><td>                <span class="nx">add_filter</span><span class="p">(</span></td></tr><tr><th id="L1123"><a href="#L1123">1123</a></th><td>                        <span class="s1">'feedzy_default_error'</span><span class="p">,</span></td></tr><tr><th id="L1124"><a href="#L1124">1124</a></th><td>                        <span class="k">function</span> <span class="p">(</span> <span class="nv">$errors</span><span class="p">,</span> <span class="nv">$feed</span><span class="p">,</span> <span class="nv">$url</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1125"><a href="#L1125">1125</a></th><td>                                <span class="nv">$errors</span> <span class="o">.=</span></td></tr><tr><th id="L1126"><a href="#L1126">1126</a></th><td>                                        <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'For %1$ssingle feeds%2$s, this could be because of the following reasons:'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="s1">'&lt;b&gt;'</span><span class="p">,</span> <span class="s1">'&lt;/b&gt;'</span> <span class="p">)</span></td></tr><tr><th id="L1127"><a href="#L1127">1127</a></th><td>                                        <span class="o">.</span> <span class="s1">'&lt;ol&gt;'</span></td></tr><tr><th id="L1128"><a href="#L1128">1128</a></th><td>                                        <span class="o">.</span> <span class="s1">'&lt;li&gt;'</span> <span class="o">.</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'%1$sSource invalid%2$s: Check that your source is valid by clicking the validate button adjacent to the source box.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="s1">'&lt;b&gt;'</span><span class="p">,</span> <span class="s1">'&lt;/b&gt;'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;/li&gt;'</span></td></tr><tr><th id="L1129"><a href="#L1129">1129</a></th><td>                                        <span class="o">.</span> <span class="s1">'&lt;li&gt;'</span> <span class="o">.</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'%1$sSource unavailable%2$s: Copy the source and paste it on the browser to check that it is available. It could be an intermittent issue.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="s1">'&lt;b&gt;'</span><span class="p">,</span> <span class="s1">'&lt;/b&gt;'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;/li&gt;'</span></td></tr><tr><th id="L1130"><a href="#L1130">1130</a></th><td>                                        <span class="o">.</span> <span class="s1">'&lt;li&gt;'</span> <span class="o">.</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'%1$sSource inaccessible from server%2$s: Check that your source is accessible from the server (not the browser). It could be an intermittent issue.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="s1">'&lt;b&gt;'</span><span class="p">,</span> <span class="s1">'&lt;/b&gt;'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;/li&gt;'</span></td></tr><tr><th id="L1131"><a href="#L1131">1131</a></th><td>                                        <span class="o">.</span> <span class="s1">'&lt;/ol&gt;'</span></td></tr><tr><th id="L1132"><a href="#L1132">1132</a></th><td>                                        <span class="o">.</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'For %1$smultiple feeds%2$s (comma-separated or in a Feedzy Category), this could be because of the following reasons:'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="s1">'&lt;b&gt;'</span><span class="p">,</span> <span class="s1">'&lt;/b&gt;'</span> <span class="p">)</span></td></tr><tr><th id="L1133"><a href="#L1133">1133</a></th><td>                                        <span class="o">.</span> <span class="s1">'&lt;ol&gt;'</span></td></tr><tr><th id="L1134"><a href="#L1134">1134</a></th><td>                                        <span class="o">.</span> <span class="s1">'&lt;li&gt;'</span> <span class="o">.</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'%1$sSource invalid%2$s: One or more feeds may be misbehaving. Check each feed individually as mentioned above to weed out the problematic feed.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="s1">'&lt;b&gt;'</span><span class="p">,</span> <span class="s1">'&lt;/b&gt;'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;/li&gt;'</span></td></tr><tr><th id="L1135"><a href="#L1135">1135</a></th><td>                                        <span class="o">.</span> <span class="s1">'&lt;/ol&gt;'</span><span class="p">;</span></td></tr><tr><th id="L1136"><a href="#L1136">1136</a></th><td></td></tr><tr><th id="L1137"><a href="#L1137">1137</a></th><td>                                <span class="k">return</span> <span class="nv">$errors</span><span class="p">;</span></td></tr><tr><th id="L1138"><a href="#L1138">1138</a></th><td>                        <span class="p">},</span></td></tr><tr><th id="L1139"><a href="#L1139">1139</a></th><td>                        <span class="mi">11</span><span class="p">,</span></td></tr><tr><th id="L1140"><a href="#L1140">1140</a></th><td>                        <span class="mi">3</span></td></tr><tr><th id="L1141"><a href="#L1141">1141</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L1142"><a href="#L1142">1142</a></th><td></td></tr><tr><th id="L1143"><a href="#L1143">1143</a></th><td>                <span class="c1">// we will add tags corresponding to the most potential problems.</span></td></tr><tr><th id="L1144"><a href="#L1144">1144</a></th><td><span class="c1"></span>                <span class="nv">$tags</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1145"><a href="#L1145">1145</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_business</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$feedzy_meta_data</span><span class="p">[</span><span class="s1">'import_post_content'</span><span class="p">],</span> <span class="s1">'full_content'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1146"><a href="#L1146">1146</a></th><td>                        <span class="nv">$tags</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">'item_full_content'</span><span class="p">;</span></td></tr><tr><th id="L1147"><a href="#L1147">1147</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1148"><a href="#L1148">1148</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$feedzy_meta_data</span><span class="p">[</span><span class="s1">'import_post_content'</span><span class="p">],</span> <span class="s1">'item_image'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="o">||</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$feedzy_meta_data</span><span class="p">[</span><span class="s1">'import_post_featured_img'</span><span class="p">],</span> <span class="s1">'item_image'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1149"><a href="#L1149">1149</a></th><td>                        <span class="nv">$tags</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">'item_image'</span><span class="p">;</span></td></tr><tr><th id="L1150"><a href="#L1150">1150</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1151"><a href="#L1151">1151</a></th><td></td></tr><tr><th id="L1152"><a href="#L1152">1152</a></th><td>                <span class="nv">$shortcode</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span></td></tr><tr><th id="L1153"><a href="#L1153">1153</a></th><td>                        <span class="s1">'[feedzy-rss feeds="%s" max="%d" feed_title=no meta=no summary=no thumb=no error_empty="%s" keywords_inc="%s" %s="%s" %s="%s" _dry_run_tags_="%s" _dryrun_="yes"]'</span><span class="p">,</span></td></tr><tr><th id="L1154"><a href="#L1154">1154</a></th><td>                        <span class="nv">$feedzy_meta_data</span><span class="p">[</span><span class="s1">'source'</span><span class="p">],</span></td></tr><tr><th id="L1155"><a href="#L1155">1155</a></th><td>                        <span class="nv">$feedzy_meta_data</span><span class="p">[</span><span class="s1">'import_feed_limit'</span><span class="p">],</span></td></tr><tr><th id="L1156"><a href="#L1156">1156</a></th><td>                        <span class="s1">''</span><span class="p">,</span> <span class="c1">// should be empty</span></td></tr><tr><th id="L1157"><a href="#L1157">1157</a></th><td><span class="c1"></span>                        <span class="nv">$feedzy_meta_data</span><span class="p">[</span><span class="s1">'inc_key'</span><span class="p">],</span></td></tr><tr><th id="L1158"><a href="#L1158">1158</a></th><td>                        <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="o">?</span> <span class="s1">'keywords_exc'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L1159"><a href="#L1159">1159</a></th><td>                        <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="o">?</span> <span class="nv">$feedzy_meta_data</span><span class="p">[</span><span class="s1">'exc_key'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L1160"><a href="#L1160">1160</a></th><td>                        <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="o">?</span> <span class="s1">'keywords_ban'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L1161"><a href="#L1161">1161</a></th><td>                        <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="o">?</span> <span class="nv">$feedzy_meta_data</span><span class="p">[</span><span class="s1">'exc_key'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L1162"><a href="#L1162">1162</a></th><td>                        <span class="nb">implode</span><span class="p">(</span> <span class="s1">','</span><span class="p">,</span> <span class="nv">$tags</span> <span class="p">)</span></td></tr><tr><th id="L1163"><a href="#L1163">1163</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L1164"><a href="#L1164">1164</a></th><td></td></tr><tr><th id="L1165"><a href="#L1165">1165</a></th><td>                <span class="nx">wp_send_json_success</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'output'</span> <span class="o">=&gt;</span> <span class="nx">do_shortcode</span><span class="p">(</span> <span class="nv">$shortcode</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1166"><a href="#L1166">1166</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L1167"><a href="#L1167">1167</a></th><td></td></tr><tr><th id="L1168"><a href="#L1168">1168</a></th><td></td></tr><tr><th id="L1169"><a href="#L1169">1169</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L1170"><a href="#L1170">1170</a></th><td><span class="sd">         * The Cron Job.</span></td></tr><tr><th id="L1171"><a href="#L1171">1171</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1172"><a href="#L1172">1172</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L1173"><a href="#L1173">1173</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L1174"><a href="#L1174">1174</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L1175"><a href="#L1175">1175</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">run_cron</span><span class="p">(</span> <span class="nv">$max</span> <span class="o">=</span> <span class="mi">100</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1176"><a href="#L1176">1176</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$max</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1177"><a href="#L1177">1177</a></th><td>                        <span class="nv">$max</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span></td></tr><tr><th id="L1178"><a href="#L1178">1178</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1179"><a href="#L1179">1179</a></th><td>                <span class="k">global</span> <span class="nv">$post</span><span class="p">;</span></td></tr><tr><th id="L1180"><a href="#L1180">1180</a></th><td>                <span class="nv">$args</span>           <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1181"><a href="#L1181">1181</a></th><td>                        <span class="s1">'post_type'</span>   <span class="o">=&gt;</span> <span class="s1">'feedzy_imports'</span><span class="p">,</span></td></tr><tr><th id="L1182"><a href="#L1182">1182</a></th><td>                        <span class="s1">'post_status'</span> <span class="o">=&gt;</span> <span class="s1">'publish'</span><span class="p">,</span></td></tr><tr><th id="L1183"><a href="#L1183">1183</a></th><td>                        <span class="s1">'numberposts'</span> <span class="o">=&gt;</span> <span class="mi">99</span><span class="p">,</span></td></tr><tr><th id="L1184"><a href="#L1184">1184</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L1185"><a href="#L1185">1185</a></th><td>                <span class="nv">$feedzy_imports</span> <span class="o">=</span> <span class="nx">get_posts</span><span class="p">(</span> <span class="nv">$args</span> <span class="p">);</span></td></tr><tr><th id="L1186"><a href="#L1186">1186</a></th><td>                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$feedzy_imports</span> <span class="k">as</span> <span class="nv">$job</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1187"><a href="#L1187">1187</a></th><td>                        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">run_job</span><span class="p">(</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$max</span> <span class="p">);</span></td></tr><tr><th id="L1188"><a href="#L1188">1188</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$result</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1189"><a href="#L1189">1189</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">run_job</span><span class="p">(</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$max</span> <span class="p">);</span></td></tr><tr><th id="L1190"><a href="#L1190">1190</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1191"><a href="#L1191">1191</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'feedzy_run_cron_extra'</span><span class="p">,</span> <span class="nv">$job</span> <span class="p">);</span></td></tr><tr><th id="L1192"><a href="#L1192">1192</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1193"><a href="#L1193">1193</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L1194"><a href="#L1194">1194</a></th><td></td></tr><tr><th id="L1195"><a href="#L1195">1195</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L1196"><a href="#L1196">1196</a></th><td><span class="sd">         * Runs a specific job.</span></td></tr><tr><th id="L1197"><a href="#L1197">1197</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1198"><a href="#L1198">1198</a></th><td><span class="sd">         * @return  int</span></td></tr><tr><th id="L1199"><a href="#L1199">1199</a></th><td><span class="sd">         * @since   1.6.1</span></td></tr><tr><th id="L1200"><a href="#L1200">1200</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L1201"><a href="#L1201">1201</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L1202"><a href="#L1202">1202</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">run_job</span><span class="p">(</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$max</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1203"><a href="#L1203">1203</a></th><td>                <span class="nv">$source</span>                   <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'source'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1204"><a href="#L1204">1204</a></th><td>                <span class="nv">$inc_key</span>                  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'inc_key'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1205"><a href="#L1205">1205</a></th><td>                <span class="nv">$exc_key</span>                  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'exc_key'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1206"><a href="#L1206">1206</a></th><td>                <span class="nv">$inc_on</span>                   <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'inc_on'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1207"><a href="#L1207">1207</a></th><td>                <span class="nv">$exc_on</span>                   <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'exc_on'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1208"><a href="#L1208">1208</a></th><td>                <span class="nv">$import_title</span>             <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_title'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1209"><a href="#L1209">1209</a></th><td>                <span class="nv">$import_title</span>             <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_import_trim_tags</span><span class="p">(</span> <span class="nv">$import_title</span> <span class="p">);</span></td></tr><tr><th id="L1210"><a href="#L1210">1210</a></th><td>                <span class="nv">$import_date</span>              <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_date'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1211"><a href="#L1211">1211</a></th><td>                <span class="nv">$post_excerpt</span>             <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_excerpt'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1212"><a href="#L1212">1212</a></th><td>                <span class="nv">$post_excerpt</span>             <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_import_trim_tags</span><span class="p">(</span> <span class="nv">$post_excerpt</span> <span class="p">);</span></td></tr><tr><th id="L1213"><a href="#L1213">1213</a></th><td>                <span class="nv">$import_content</span>           <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_content'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1214"><a href="#L1214">1214</a></th><td>                <span class="nv">$import_featured_img</span>      <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_featured_img'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1215"><a href="#L1215">1215</a></th><td>                <span class="nv">$import_post_type</span>         <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_type'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1216"><a href="#L1216">1216</a></th><td>                <span class="nv">$import_post_term</span>         <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_term'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1217"><a href="#L1217">1217</a></th><td>                <span class="nv">$import_feed_limit</span>        <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_feed_limit'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1218"><a href="#L1218">1218</a></th><td>                <span class="nv">$import_item_img_url</span>      <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_use_external_image'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1219"><a href="#L1219">1219</a></th><td>                <span class="nv">$import_remove_duplicates</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_remove_duplicates'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1220"><a href="#L1220">1220</a></th><td>                <span class="nv">$import_selected_language</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'language'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1221"><a href="#L1221">1221</a></th><td>                <span class="nv">$from_datetime</span>            <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'from_datetime'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1222"><a href="#L1222">1222</a></th><td>                <span class="nv">$to_datetime</span>              <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'to_datetime'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1223"><a href="#L1223">1223</a></th><td>                <span class="nv">$import_auto_translation</span>  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_auto_translation'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1224"><a href="#L1224">1224</a></th><td>                <span class="nv">$import_auto_translation</span>  <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_agency</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="s1">'yes'</span> <span class="o">===</span> <span class="nv">$import_auto_translation</span> <span class="o">?</span> <span class="k">true</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L1225"><a href="#L1225">1225</a></th><td>                <span class="nv">$import_translation_lang</span>  <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_auto_translation_lang'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1226"><a href="#L1226">1226</a></th><td>                <span class="nv">$max</span>                      <span class="o">=</span> <span class="nv">$import_feed_limit</span><span class="p">;</span></td></tr><tr><th id="L1227"><a href="#L1227">1227</a></th><td></td></tr><tr><th id="L1228"><a href="#L1228">1228</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">metadata_exists</span><span class="p">(</span> <span class="nv">$import_post_type</span><span class="p">,</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_status'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1229"><a href="#L1229">1229</a></th><td>                        <span class="nv">$import_post_status</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_status'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1230"><a href="#L1230">1230</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1231"><a href="#L1231">1231</a></th><td>                        <span class="nx">add_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_status'</span><span class="p">,</span> <span class="s1">'publish'</span> <span class="p">);</span></td></tr><tr><th id="L1232"><a href="#L1232">1232</a></th><td>                        <span class="nv">$import_post_status</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_post_status'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1233"><a href="#L1233">1233</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1234"><a href="#L1234">1234</a></th><td></td></tr><tr><th id="L1235"><a href="#L1235">1235</a></th><td>                <span class="c1">// the array of imported items that uses the old scheme of custom hashing the url and date</span></td></tr><tr><th id="L1236"><a href="#L1236">1236</a></th><td><span class="c1"></span>                <span class="nv">$imported_items</span>     <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1237"><a href="#L1237">1237</a></th><td>                <span class="nv">$imported_items_old</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'imported_items'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1238"><a href="#L1238">1238</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$imported_items_old</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1239"><a href="#L1239">1239</a></th><td>                        <span class="nv">$imported_items_old</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1240"><a href="#L1240">1240</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1241"><a href="#L1241">1241</a></th><td></td></tr><tr><th id="L1242"><a href="#L1242">1242</a></th><td>                <span class="c1">// the array of imported items that uses the new scheme of SimplePie's hash/id</span></td></tr><tr><th id="L1243"><a href="#L1243">1243</a></th><td><span class="c1"></span>                <span class="nv">$imported_items_new</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'imported_items_hash'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1244"><a href="#L1244">1244</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$imported_items_new</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1245"><a href="#L1245">1245</a></th><td>                        <span class="nv">$imported_items_new</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1246"><a href="#L1246">1246</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1247"><a href="#L1247">1247</a></th><td></td></tr><tr><th id="L1248"><a href="#L1248">1248</a></th><td>                <span class="c1">// Get default thumbnail ID.</span></td></tr><tr><th id="L1249"><a href="#L1249">1249</a></th><td><span class="c1"></span>                <span class="nv">$default_thumbnail</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'default-thumbnail-id'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'default-thumbnail-id'</span><span class="p">]</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span></td></tr><tr><th id="L1250"><a href="#L1250">1250</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1251"><a href="#L1251">1251</a></th><td>                        <span class="nv">$default_thumbnail</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'default_thumbnail_id'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1252"><a href="#L1252">1252</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1253"><a href="#L1253">1253</a></th><td></td></tr><tr><th id="L1254"><a href="#L1254">1254</a></th><td>                <span class="c1">// Note: this implementation will only work if only one of the fields is allowed to provide</span></td></tr><tr><th id="L1255"><a href="#L1255">1255</a></th><td><span class="c1"></span>                <span class="c1">// the date, because if the title can have UTC date and content can have local date then it</span></td></tr><tr><th id="L1256"><a href="#L1256">1256</a></th><td><span class="c1"></span>                <span class="c1">// all goes sideways.</span></td></tr><tr><th id="L1257"><a href="#L1257">1257</a></th><td><span class="c1"></span>                <span class="c1">// also if the user provides multiple date types, local will win.</span></td></tr><tr><th id="L1258"><a href="#L1258">1258</a></th><td><span class="c1"></span>                <span class="nv">$meta</span> <span class="o">=</span> <span class="s1">'yes'</span><span class="p">;</span></td></tr><tr><th id="L1259"><a href="#L1259">1259</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$import_title</span><span class="p">,</span> <span class="s1">'[#item_date_local]'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1260"><a href="#L1260">1260</a></th><td>                        <span class="nv">$meta</span> <span class="o">=</span> <span class="s1">'author, date, time, tz=local'</span><span class="p">;</span></td></tr><tr><th id="L1261"><a href="#L1261">1261</a></th><td>                <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$import_title</span><span class="p">,</span> <span class="s1">'[#item_date_feed]'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1262"><a href="#L1262">1262</a></th><td>                        <span class="nv">$meta</span> <span class="o">=</span> <span class="s1">'author, date, time, tz=no'</span><span class="p">;</span></td></tr><tr><th id="L1263"><a href="#L1263">1263</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1264"><a href="#L1264">1264</a></th><td></td></tr><tr><th id="L1265"><a href="#L1265">1265</a></th><td>                <span class="nv">$options</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span></td></tr><tr><th id="L1266"><a href="#L1266">1266</a></th><td>                        <span class="s1">'feedzy_shortcode_options'</span><span class="p">,</span></td></tr><tr><th id="L1267"><a href="#L1267">1267</a></th><td>                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1268"><a href="#L1268">1268</a></th><td>                                <span class="s1">'feeds'</span>           <span class="o">=&gt;</span> <span class="nv">$source</span><span class="p">,</span></td></tr><tr><th id="L1269"><a href="#L1269">1269</a></th><td>                                <span class="s1">'max'</span>             <span class="o">=&gt;</span> <span class="nv">$max</span><span class="p">,</span></td></tr><tr><th id="L1270"><a href="#L1270">1270</a></th><td>                                <span class="s1">'feed_title'</span>      <span class="o">=&gt;</span> <span class="s1">'no'</span><span class="p">,</span></td></tr><tr><th id="L1271"><a href="#L1271">1271</a></th><td>                                <span class="s1">'target'</span>          <span class="o">=&gt;</span> <span class="s1">'_blank'</span><span class="p">,</span></td></tr><tr><th id="L1272"><a href="#L1272">1272</a></th><td>                                <span class="s1">'title'</span>           <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L1273"><a href="#L1273">1273</a></th><td>                                <span class="s1">'meta'</span>            <span class="o">=&gt;</span> <span class="nv">$meta</span><span class="p">,</span></td></tr><tr><th id="L1274"><a href="#L1274">1274</a></th><td>                                <span class="s1">'summary'</span>         <span class="o">=&gt;</span> <span class="s1">'yes'</span><span class="p">,</span></td></tr><tr><th id="L1275"><a href="#L1275">1275</a></th><td>                                <span class="s1">'summarylength'</span>   <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L1276"><a href="#L1276">1276</a></th><td>                                <span class="s1">'thumb'</span>           <span class="o">=&gt;</span> <span class="s1">'auto'</span><span class="p">,</span></td></tr><tr><th id="L1277"><a href="#L1277">1277</a></th><td>                                <span class="s1">'default'</span>         <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L1278"><a href="#L1278">1278</a></th><td>                                <span class="s1">'size'</span>            <span class="o">=&gt;</span> <span class="s1">'250'</span><span class="p">,</span></td></tr><tr><th id="L1279"><a href="#L1279">1279</a></th><td>                                <span class="s1">'keywords_inc'</span>    <span class="o">=&gt;</span> <span class="nv">$inc_key</span><span class="p">,</span> <span class="c1">// this is not keywords_title</span></td></tr><tr><th id="L1280"><a href="#L1280">1280</a></th><td><span class="c1"></span>                                <span class="s1">'keywords_ban'</span>    <span class="o">=&gt;</span> <span class="nv">$exc_key</span><span class="p">,</span> <span class="c1">// to support old pro that does not support keywords_exc</span></td></tr><tr><th id="L1281"><a href="#L1281">1281</a></th><td><span class="c1"></span>                                <span class="s1">'keywords_exc'</span>    <span class="o">=&gt;</span> <span class="nv">$exc_key</span><span class="p">,</span> <span class="c1">// this is not keywords_ban</span></td></tr><tr><th id="L1282"><a href="#L1282">1282</a></th><td><span class="c1"></span>                                <span class="s1">'keywords_inc_on'</span> <span class="o">=&gt;</span> <span class="nv">$inc_on</span><span class="p">,</span></td></tr><tr><th id="L1283"><a href="#L1283">1283</a></th><td>                                <span class="s1">'keywords_exc_on'</span> <span class="o">=&gt;</span> <span class="nv">$exc_on</span><span class="p">,</span></td></tr><tr><th id="L1284"><a href="#L1284">1284</a></th><td>                                <span class="s1">'columns'</span>         <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span></td></tr><tr><th id="L1285"><a href="#L1285">1285</a></th><td>                                <span class="s1">'offset'</span>          <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L1286"><a href="#L1286">1286</a></th><td>                                <span class="s1">'multiple_meta'</span>   <span class="o">=&gt;</span> <span class="s1">'no'</span><span class="p">,</span></td></tr><tr><th id="L1287"><a href="#L1287">1287</a></th><td>                                <span class="s1">'refresh'</span>         <span class="o">=&gt;</span> <span class="s1">'55_mins'</span><span class="p">,</span></td></tr><tr><th id="L1288"><a href="#L1288">1288</a></th><td>                                <span class="s1">'from_datetime'</span>   <span class="o">=&gt;</span> <span class="nv">$from_datetime</span><span class="p">,</span></td></tr><tr><th id="L1289"><a href="#L1289">1289</a></th><td>                                <span class="s1">'to_datetime'</span>     <span class="o">=&gt;</span> <span class="nv">$to_datetime</span><span class="p">,</span></td></tr><tr><th id="L1290"><a href="#L1290">1290</a></th><td>                        <span class="p">),</span></td></tr><tr><th id="L1291"><a href="#L1291">1291</a></th><td>                        <span class="nv">$job</span></td></tr><tr><th id="L1292"><a href="#L1292">1292</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L1293"><a href="#L1293">1293</a></th><td></td></tr><tr><th id="L1294"><a href="#L1294">1294</a></th><td>                <span class="nv">$admin</span>   <span class="o">=</span> <span class="nx">Feedzy_Rss_Feeds</span><span class="o">::</span><span class="na">instance</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">get_admin</span><span class="p">();</span></td></tr><tr><th id="L1295"><a href="#L1295">1295</a></th><td>                <span class="nv">$options</span> <span class="o">=</span> <span class="nv">$admin</span><span class="o">-&gt;</span><span class="na">sanitize_attr</span><span class="p">(</span> <span class="nv">$options</span><span class="p">,</span> <span class="nv">$source</span> <span class="p">);</span></td></tr><tr><th id="L1296"><a href="#L1296">1296</a></th><td></td></tr><tr><th id="L1297"><a href="#L1297">1297</a></th><td>                <span class="nv">$options</span><span class="p">[</span><span class="s1">'__jobID'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">;</span></td></tr><tr><th id="L1298"><a href="#L1298">1298</a></th><td></td></tr><tr><th id="L1299"><a href="#L1299">1299</a></th><td>                <span class="nv">$last_run</span> <span class="o">=</span> <span class="nb">time</span><span class="p">();</span></td></tr><tr><th id="L1300"><a href="#L1300">1300</a></th><td>                <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'last_run'</span><span class="p">,</span> <span class="nv">$last_run</span> <span class="p">);</span></td></tr><tr><th id="L1301"><a href="#L1301">1301</a></th><td>                <span class="c1">// we will use this last_run_id to associate imports with a specific job run.</span></td></tr><tr><th id="L1302"><a href="#L1302">1302</a></th><td><span class="c1"></span>                <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'last_run_id'</span><span class="p">,</span> <span class="nv">$last_run</span> <span class="p">);</span></td></tr><tr><th id="L1303"><a href="#L1303">1303</a></th><td>                <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_errors'</span> <span class="p">);</span></td></tr><tr><th id="L1304"><a href="#L1304">1304</a></th><td>                <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_info'</span> <span class="p">);</span></td></tr><tr><th id="L1305"><a href="#L1305">1305</a></th><td></td></tr><tr><th id="L1306"><a href="#L1306">1306</a></th><td>                <span class="c1">// let's increase this time in case spinnerchief/wordai is being used.</span></td></tr><tr><th id="L1307"><a href="#L1307">1307</a></th><td><span class="c1"></span>                <span class="nb">set_time_limit</span><span class="p">(</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_max_execution_time'</span><span class="p">,</span> <span class="mi">500</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1308"><a href="#L1308">1308</a></th><td></td></tr><tr><th id="L1309"><a href="#L1309">1309</a></th><td>                <span class="nv">$count</span> <span class="o">=</span> <span class="nv">$index</span> <span class="o">=</span> <span class="nv">$import_image_errors</span> <span class="o">=</span> <span class="nv">$duplicates</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></td></tr><tr><th id="L1310"><a href="#L1310">1310</a></th><td></td></tr><tr><th id="L1311"><a href="#L1311">1311</a></th><td>                <span class="c1">// the array that captures errors about the import.</span></td></tr><tr><th id="L1312"><a href="#L1312">1312</a></th><td><span class="c1"></span>                <span class="nv">$import_errors</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1313"><a href="#L1313">1313</a></th><td></td></tr><tr><th id="L1314"><a href="#L1314">1314</a></th><td>                <span class="c1">// the array that captures additional information about the import.</span></td></tr><tr><th id="L1315"><a href="#L1315">1315</a></th><td><span class="c1"></span>                <span class="nv">$import_info</span>   <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1316"><a href="#L1316">1316</a></th><td>                <span class="nv">$results</span>       <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_job_feed</span><span class="p">(</span> <span class="nv">$options</span><span class="p">,</span> <span class="nv">$import_content</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1317"><a href="#L1317">1317</a></th><td>                <span class="nv">$language_code</span> <span class="o">=</span> <span class="nv">$results</span><span class="p">[</span><span class="s1">'feed'</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">get_language</span><span class="p">();</span></td></tr><tr><th id="L1318"><a href="#L1318">1318</a></th><td></td></tr><tr><th id="L1319"><a href="#L1319">1319</a></th><td>                <span class="nv">$xml_results</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1320"><a href="#L1320">1320</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">str_contains</span><span class="p">(</span> <span class="nv">$import_content</span><span class="p">,</span> <span class="s1">'_full_content'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1321"><a href="#L1321">1321</a></th><td>                        <span class="nv">$xml_results</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_job_feed</span><span class="p">(</span> <span class="nv">$options</span><span class="p">,</span> <span class="s1">'[#item_content]'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1322"><a href="#L1322">1322</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1323"><a href="#L1323">1323</a></th><td></td></tr><tr><th id="L1324"><a href="#L1324">1324</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$results</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1325"><a href="#L1325">1325</a></th><td>                        <span class="nv">$import_errors</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$results</span><span class="o">-&gt;</span><span class="na">get_error_message</span><span class="p">();</span></td></tr><tr><th id="L1326"><a href="#L1326">1326</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_errors'</span><span class="p">,</span> <span class="nv">$import_errors</span> <span class="p">);</span></td></tr><tr><th id="L1327"><a href="#L1327">1327</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'imported_items_count'</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span></td></tr><tr><th id="L1328"><a href="#L1328">1328</a></th><td></td></tr><tr><th id="L1329"><a href="#L1329">1329</a></th><td>                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L1330"><a href="#L1330">1330</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1331"><a href="#L1331">1331</a></th><td></td></tr><tr><th id="L1332"><a href="#L1332">1332</a></th><td>                <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$results</span><span class="p">[</span><span class="s1">'items'</span><span class="p">];</span></td></tr><tr><th id="L1333"><a href="#L1333">1333</a></th><td>                <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'feedzy_run_job_pre'</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$result</span> <span class="p">);</span></td></tr><tr><th id="L1334"><a href="#L1334">1334</a></th><td></td></tr><tr><th id="L1335"><a href="#L1335">1335</a></th><td>                <span class="c1">// check if we should be using the old scheme of custom hashing the url and date</span></td></tr><tr><th id="L1336"><a href="#L1336">1336</a></th><td><span class="c1"></span>                <span class="c1">// or the new scheme of depending on SimplePie's hash/id</span></td></tr><tr><th id="L1337"><a href="#L1337">1337</a></th><td><span class="c1"></span>                <span class="c1">// basically if the old scheme hasn't be used before, use the new scheme</span></td></tr><tr><th id="L1338"><a href="#L1338">1338</a></th><td><span class="c1"></span>                <span class="c1">// BUT if the old scheme has been used, continue with it.</span></td></tr><tr><th id="L1339"><a href="#L1339">1339</a></th><td><span class="c1"></span>                <span class="nv">$use_new_hash</span>   <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$imported_items_old</span> <span class="p">);</span></td></tr><tr><th id="L1340"><a href="#L1340">1340</a></th><td>                <span class="nv">$imported_items</span> <span class="o">=</span> <span class="nv">$use_new_hash</span> <span class="o">?</span> <span class="nv">$imported_items_new</span> <span class="o">:</span> <span class="nv">$imported_items_old</span><span class="p">;</span></td></tr><tr><th id="L1341"><a href="#L1341">1341</a></th><td></td></tr><tr><th id="L1342"><a href="#L1342">1342</a></th><td>                <span class="nv">$start_import</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span></td></tr><tr><th id="L1343"><a href="#L1343">1343</a></th><td>                <span class="c1">// bail if both title and content are empty because the post will not be created.</span></td></tr><tr><th id="L1344"><a href="#L1344">1344</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_title</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_content</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1345"><a href="#L1345">1345</a></th><td>                        <span class="nv">$import_errors</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Title &amp; Content are both empty.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L1346"><a href="#L1346">1346</a></th><td>                        <span class="nv">$start_import</span>    <span class="o">=</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L1347"><a href="#L1347">1347</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1348"><a href="#L1348">1348</a></th><td></td></tr><tr><th id="L1349"><a href="#L1349">1349</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$start_import</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1350"><a href="#L1350">1350</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_errors'</span><span class="p">,</span> <span class="nv">$import_errors</span> <span class="p">);</span></td></tr><tr><th id="L1351"><a href="#L1351">1351</a></th><td></td></tr><tr><th id="L1352"><a href="#L1352">1352</a></th><td>                        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span></td></tr><tr><th id="L1353"><a href="#L1353">1353</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1354"><a href="#L1354">1354</a></th><td></td></tr><tr><th id="L1355"><a href="#L1355">1355</a></th><td>                <span class="nv">$rewrite_service_endabled</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">rewrite_content_service_endabled</span><span class="p">();</span></td></tr><tr><th id="L1356"><a href="#L1356">1356</a></th><td></td></tr><tr><th id="L1357"><a href="#L1357">1357</a></th><td>                <span class="nv">$duplicates</span>       <span class="o">=</span> <span class="nv">$items_found</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1358"><a href="#L1358">1358</a></th><td>                <span class="nv">$found_duplicates</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1359"><a href="#L1359">1359</a></th><td>                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$result</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$item</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1360"><a href="#L1360">1360</a></th><td>                        <span class="nv">$item_obj</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">;</span></td></tr><tr><th id="L1361"><a href="#L1361">1361</a></th><td>                        <span class="c1">// find item index key when import full content.</span></td></tr><tr><th id="L1362"><a href="#L1362">1362</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$xml_results</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1363"><a href="#L1363">1363</a></th><td>                                <span class="nv">$item_unique_hash</span> <span class="o">=</span> <span class="nx">array_column</span><span class="p">(</span> <span class="nv">$xml_results</span><span class="p">[</span><span class="s1">'items'</span><span class="p">],</span> <span class="s1">'item_unique_hash'</span> <span class="p">);</span></td></tr><tr><th id="L1364"><a href="#L1364">1364</a></th><td>                                <span class="nv">$real_index_key</span>   <span class="o">=</span> <span class="nb">array_search</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_unique_hash'</span><span class="p">],</span> <span class="nv">$item_unique_hash</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1365"><a href="#L1365">1365</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$xml_results</span><span class="p">[</span><span class="s1">'items'</span><span class="p">][</span> <span class="nv">$real_index_key</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1366"><a href="#L1366">1366</a></th><td>                                        <span class="nv">$item_obj</span> <span class="o">=</span> <span class="nv">$xml_results</span><span class="p">[</span><span class="s1">'items'</span><span class="p">][</span> <span class="nv">$real_index_key</span> <span class="p">];</span></td></tr><tr><th id="L1367"><a href="#L1367">1367</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1368"><a href="#L1368">1368</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1369"><a href="#L1369">1369</a></th><td>                        <span class="nv">$item_hash</span>                        <span class="o">=</span> <span class="nv">$use_new_hash</span> <span class="o">?</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_id'</span><span class="p">]</span> <span class="o">:</span> <span class="nb">hash</span><span class="p">(</span> <span class="s1">'sha256'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'_'</span> <span class="o">.</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_date'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L1370"><a href="#L1370">1370</a></th><td>                        <span class="nv">$is_duplicate</span>                     <span class="o">=</span> <span class="nv">$use_new_hash</span> <span class="o">?</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$item_hash</span><span class="p">,</span> <span class="nv">$imported_items_new</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="o">:</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$item_hash</span><span class="p">,</span> <span class="nv">$imported_items_old</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1371"><a href="#L1371">1371</a></th><td>                        <span class="nv">$items_found</span><span class="p">[</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">];</span></td></tr><tr><th id="L1372"><a href="#L1372">1372</a></th><td></td></tr><tr><th id="L1373"><a href="#L1373">1373</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="s1">'yes'</span> <span class="o">===</span> <span class="nv">$import_remove_duplicates</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nv">$is_duplicate</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1374"><a href="#L1374">1374</a></th><td>                                <span class="nv">$is_duplicate_post</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is_duplicate_post</span><span class="p">(</span> <span class="nv">$import_post_type</span><span class="p">,</span> <span class="s1">'feedzy_item_url'</span><span class="p">,</span> <span class="nx">esc_url_raw</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1375"><a href="#L1375">1375</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$is_duplicate_post</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1376"><a href="#L1376">1376</a></th><td>                                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$is_duplicate_post</span> <span class="k">as</span> <span class="nv">$p</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1377"><a href="#L1377">1377</a></th><td>                                                <span class="nv">$found_duplicates</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$p</span><span class="p">,</span> <span class="s1">'feedzy_item_url'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1378"><a href="#L1378">1378</a></th><td>                                                <span class="nx">wp_delete_post</span><span class="p">(</span> <span class="nv">$p</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1379"><a href="#L1379">1379</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1380"><a href="#L1380">1380</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1381"><a href="#L1381">1381</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1382"><a href="#L1382">1382</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$is_duplicate</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1383"><a href="#L1383">1383</a></th><td>                                <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Ignoring %s as it is a duplicate (%s hash).'</span><span class="p">,</span> <span class="nv">$item_hash</span><span class="p">,</span> <span class="nv">$use_new_hash</span> <span class="o">?</span> <span class="s1">'new'</span> <span class="o">:</span> <span class="s1">'old'</span> <span class="p">),</span> <span class="s1">'warn'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1384"><a href="#L1384">1384</a></th><td>                                <span class="nv">$index</span> <span class="o">++</span><span class="p">;</span></td></tr><tr><th id="L1385"><a href="#L1385">1385</a></th><td>                                <span class="nv">$duplicates</span><span class="p">[</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">];</span></td></tr><tr><th id="L1386"><a href="#L1386">1386</a></th><td>                                <span class="k">continue</span><span class="p">;</span></td></tr><tr><th id="L1387"><a href="#L1387">1387</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1388"><a href="#L1388">1388</a></th><td></td></tr><tr><th id="L1389"><a href="#L1389">1389</a></th><td>                        <span class="nv">$author</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1390"><a href="#L1390">1390</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_author'</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1391"><a href="#L1391">1391</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">is_string</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_author'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1392"><a href="#L1392">1392</a></th><td>                                        <span class="nv">$author</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_author'</span><span class="p">];</span></td></tr><tr><th id="L1393"><a href="#L1393">1393</a></th><td>                                <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span> <span class="nb">is_object</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_author'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1394"><a href="#L1394">1394</a></th><td>                                        <span class="nv">$author</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_author'</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">get_name</span><span class="p">();</span></td></tr><tr><th id="L1395"><a href="#L1395">1395</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$author</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1396"><a href="#L1396">1396</a></th><td>                                                <span class="nv">$author</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_author'</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">get_email</span><span class="p">();</span></td></tr><tr><th id="L1397"><a href="#L1397">1397</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1398"><a href="#L1398">1398</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1399"><a href="#L1399">1399</a></th><td>                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1400"><a href="#L1400">1400</a></th><td>                                <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Author is empty for %s.'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">]</span> <span class="p">),</span> <span class="s1">'warn'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1401"><a href="#L1401">1401</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1402"><a href="#L1402">1402</a></th><td></td></tr><tr><th id="L1403"><a href="#L1403">1403</a></th><td>                        <span class="c1">// phpcs:ignore WordPress.DateTime.RestrictedFunctions.date_date</span></td></tr><tr><th id="L1404"><a href="#L1404">1404</a></th><td><span class="c1"></span>                        <span class="nv">$item_date</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span> <span class="nx">get_option</span><span class="p">(</span> <span class="s1">'date_format'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">' at '</span> <span class="o">.</span> <span class="nx">get_option</span><span class="p">(</span> <span class="s1">'time_format'</span> <span class="p">),</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_date'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L1405"><a href="#L1405">1405</a></th><td>                        <span class="nv">$item_date</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_date_formatted'</span><span class="p">];</span></td></tr><tr><th id="L1406"><a href="#L1406">1406</a></th><td></td></tr><tr><th id="L1407"><a href="#L1407">1407</a></th><td>                        <span class="c1">// Get translated item title.</span></td></tr><tr><th id="L1408"><a href="#L1408">1408</a></th><td><span class="c1"></span>                        <span class="nv">$translated_title</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1409"><a href="#L1409">1409</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$import_auto_translation</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$import_title</span><span class="p">,</span> <span class="s1">'[#translated_title]'</span> <span class="p">)</span> <span class="o">||</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$post_excerpt</span><span class="p">,</span> <span class="s1">'[#translated_title]'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1410"><a href="#L1410">1410</a></th><td>                                <span class="nv">$translated_title</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_auto_translate_services'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">],</span> <span class="s1">'[#translated_title]'</span><span class="p">,</span> <span class="nv">$import_translation_lang</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$language_code</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L1411"><a href="#L1411">1411</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1412"><a href="#L1412">1412</a></th><td></td></tr><tr><th id="L1413"><a href="#L1413">1413</a></th><td>                        <span class="nv">$post_title</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span></td></tr><tr><th id="L1414"><a href="#L1414">1414</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1415"><a href="#L1415">1415</a></th><td>                                        <span class="s1">'[#item_title]'</span><span class="p">,</span></td></tr><tr><th id="L1416"><a href="#L1416">1416</a></th><td>                                        <span class="s1">'[#item_author]'</span><span class="p">,</span></td></tr><tr><th id="L1417"><a href="#L1417">1417</a></th><td>                                        <span class="s1">'[#item_date]'</span><span class="p">,</span></td></tr><tr><th id="L1418"><a href="#L1418">1418</a></th><td>                                        <span class="s1">'[#item_date_local]'</span><span class="p">,</span></td></tr><tr><th id="L1419"><a href="#L1419">1419</a></th><td>                                        <span class="s1">'[#item_date_feed]'</span><span class="p">,</span></td></tr><tr><th id="L1420"><a href="#L1420">1420</a></th><td>                                        <span class="s1">'[#item_source]'</span><span class="p">,</span></td></tr><tr><th id="L1421"><a href="#L1421">1421</a></th><td>                                        <span class="s1">'[#translated_title]'</span><span class="p">,</span></td></tr><tr><th id="L1422"><a href="#L1422">1422</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L1423"><a href="#L1423">1423</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1424"><a href="#L1424">1424</a></th><td>                                        <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">],</span></td></tr><tr><th id="L1425"><a href="#L1425">1425</a></th><td>                                        <span class="nv">$author</span><span class="p">,</span></td></tr><tr><th id="L1426"><a href="#L1426">1426</a></th><td>                                        <span class="nv">$item_date</span><span class="p">,</span></td></tr><tr><th id="L1427"><a href="#L1427">1427</a></th><td>                                        <span class="nv">$item_date</span><span class="p">,</span></td></tr><tr><th id="L1428"><a href="#L1428">1428</a></th><td>                                        <span class="nv">$item_date</span><span class="p">,</span></td></tr><tr><th id="L1429"><a href="#L1429">1429</a></th><td>                                        <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_source'</span><span class="p">],</span></td></tr><tr><th id="L1430"><a href="#L1430">1430</a></th><td>                                        <span class="nv">$translated_title</span><span class="p">,</span></td></tr><tr><th id="L1431"><a href="#L1431">1431</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L1432"><a href="#L1432">1432</a></th><td>                                <span class="nv">$import_title</span></td></tr><tr><th id="L1433"><a href="#L1433">1433</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L1434"><a href="#L1434">1434</a></th><td></td></tr><tr><th id="L1435"><a href="#L1435">1435</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_business</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1436"><a href="#L1436">1436</a></th><td>                                <span class="nv">$post_title</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_parse_custom_tags'</span><span class="p">,</span> <span class="nv">$post_title</span><span class="p">,</span> <span class="nv">$item_obj</span> <span class="p">);</span></td></tr><tr><th id="L1437"><a href="#L1437">1437</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1438"><a href="#L1438">1438</a></th><td></td></tr><tr><th id="L1439"><a href="#L1439">1439</a></th><td>                        <span class="nv">$post_title</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_services'</span><span class="p">,</span> <span class="nv">$post_title</span><span class="p">,</span> <span class="s1">'title'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">],</span> <span class="nv">$job</span> <span class="p">);</span></td></tr><tr><th id="L1440"><a href="#L1440">1440</a></th><td></td></tr><tr><th id="L1441"><a href="#L1441">1441</a></th><td>                        <span class="c1">// Get translated item link text.</span></td></tr><tr><th id="L1442"><a href="#L1442">1442</a></th><td><span class="c1"></span>                        <span class="nv">$item_link_txt</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Read More'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L1443"><a href="#L1443">1443</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$import_auto_translation</span> <span class="o">&amp;&amp;</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$import_content</span><span class="p">,</span> <span class="s1">'[#item_url]'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1444"><a href="#L1444">1444</a></th><td>                                <span class="nv">$item_link_txt</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_auto_translate_services'</span><span class="p">,</span> <span class="nv">$item_link_txt</span><span class="p">,</span> <span class="s1">'[#item_url]'</span><span class="p">,</span> <span class="nv">$import_translation_lang</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$language_code</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L1445"><a href="#L1445">1445</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1446"><a href="#L1446">1446</a></th><td></td></tr><tr><th id="L1447"><a href="#L1447">1447</a></th><td>                        <span class="nv">$item_link</span> <span class="o">=</span> <span class="s1">'&lt;a href="'</span> <span class="o">.</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'" target="_blank" class="feedzy-rss-link-icon"&gt;'</span> <span class="o">.</span> <span class="nv">$item_link_txt</span> <span class="o">.</span> <span class="s1">'&lt;/a&gt;'</span><span class="p">;</span></td></tr><tr><th id="L1448"><a href="#L1448">1448</a></th><td></td></tr><tr><th id="L1449"><a href="#L1449">1449</a></th><td>                        <span class="c1">// Rewriter item title from feedzy API.</span></td></tr><tr><th id="L1450"><a href="#L1450">1450</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$rewrite_service_endabled</span> <span class="o">&amp;&amp;</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$post_title</span><span class="p">,</span> <span class="s1">'[#title_feedzy_rewrite]'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1451"><a href="#L1451">1451</a></th><td>                                <span class="nv">$title_feedzy_rewrite</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_content_rewrite_services'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">],</span> <span class="s1">'[#title_feedzy_rewrite]'</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L1452"><a href="#L1452">1452</a></th><td>                                <span class="nv">$post_title</span>           <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'[#title_feedzy_rewrite]'</span><span class="p">,</span> <span class="nv">$title_feedzy_rewrite</span><span class="p">,</span> <span class="nv">$post_title</span> <span class="p">);</span></td></tr><tr><th id="L1453"><a href="#L1453">1453</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1454"><a href="#L1454">1454</a></th><td></td></tr><tr><th id="L1455"><a href="#L1455">1455</a></th><td>                        <span class="nv">$item_link</span> <span class="o">=</span> <span class="s1">'&lt;a href="'</span> <span class="o">.</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'" target="_blank" class="feedzy-rss-link-icon"&gt;'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Read More'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;/a&gt;'</span><span class="p">;</span></td></tr><tr><th id="L1456"><a href="#L1456">1456</a></th><td></td></tr><tr><th id="L1457"><a href="#L1457">1457</a></th><td>                        <span class="nv">$image_html</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1458"><a href="#L1458">1458</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_img_path'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1459"><a href="#L1459">1459</a></th><td>                                <span class="nv">$image_html</span> <span class="o">=</span> <span class="s1">'&lt;img src="'</span> <span class="o">.</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_img_path'</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'" title="'</span> <span class="o">.</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'" /&gt;'</span><span class="p">;</span></td></tr><tr><th id="L1460"><a href="#L1460">1460</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1461"><a href="#L1461">1461</a></th><td></td></tr><tr><th id="L1462"><a href="#L1462">1462</a></th><td>                        <span class="c1">// Get translated item description.</span></td></tr><tr><th id="L1463"><a href="#L1463">1463</a></th><td><span class="c1"></span>                        <span class="nv">$translated_description</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1464"><a href="#L1464">1464</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$import_auto_translation</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$import_content</span><span class="p">,</span> <span class="s1">'[#translated_description]'</span> <span class="p">)</span> <span class="o">||</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$post_excerpt</span><span class="p">,</span> <span class="s1">'[#translated_description]'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1465"><a href="#L1465">1465</a></th><td>                                <span class="nv">$translated_description</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_auto_translate_services'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_full_description'</span><span class="p">],</span> <span class="s1">'[#translated_description]'</span><span class="p">,</span> <span class="nv">$import_translation_lang</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$language_code</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L1466"><a href="#L1466">1466</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1467"><a href="#L1467">1467</a></th><td></td></tr><tr><th id="L1468"><a href="#L1468">1468</a></th><td>                        <span class="c1">// Get translated item content.</span></td></tr><tr><th id="L1469"><a href="#L1469">1469</a></th><td><span class="c1"></span>                        <span class="nv">$translated_content</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1470"><a href="#L1470">1470</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$import_auto_translation</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$import_content</span><span class="p">,</span> <span class="s1">'[#translated_content]'</span> <span class="p">)</span> <span class="o">||</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$post_excerpt</span><span class="p">,</span> <span class="s1">'[#translated_content]'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1471"><a href="#L1471">1471</a></th><td>                                <span class="nv">$translated_content</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_content'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_content'</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_description'</span><span class="p">];</span></td></tr><tr><th id="L1472"><a href="#L1472">1472</a></th><td>                                <span class="nv">$translated_content</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_auto_translate_services'</span><span class="p">,</span> <span class="nv">$translated_content</span><span class="p">,</span> <span class="s1">'[#translated_content]'</span><span class="p">,</span> <span class="nv">$import_translation_lang</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$language_code</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L1473"><a href="#L1473">1473</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1474"><a href="#L1474">1474</a></th><td></td></tr><tr><th id="L1475"><a href="#L1475">1475</a></th><td>                        <span class="c1">// Used as a new line character in import content.</span></td></tr><tr><th id="L1476"><a href="#L1476">1476</a></th><td><span class="c1"></span>                        <span class="nv">$import_content</span> <span class="o">=</span> <span class="nb">rawurldecode</span><span class="p">(</span> <span class="nv">$import_content</span> <span class="p">);</span></td></tr><tr><th id="L1477"><a href="#L1477">1477</a></th><td>                        <span class="nv">$import_content</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="nx">PHP_EOL</span><span class="p">,</span> <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">,</span> <span class="nv">$import_content</span> <span class="p">);</span></td></tr><tr><th id="L1478"><a href="#L1478">1478</a></th><td>                        <span class="nv">$import_content</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$import_content</span> <span class="p">);</span></td></tr><tr><th id="L1479"><a href="#L1479">1479</a></th><td></td></tr><tr><th id="L1480"><a href="#L1480">1480</a></th><td>                        <span class="nv">$post_content</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span></td></tr><tr><th id="L1481"><a href="#L1481">1481</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1482"><a href="#L1482">1482</a></th><td>                                        <span class="s1">'[#item_description]'</span><span class="p">,</span></td></tr><tr><th id="L1483"><a href="#L1483">1483</a></th><td>                                        <span class="s1">'[#item_content]'</span><span class="p">,</span></td></tr><tr><th id="L1484"><a href="#L1484">1484</a></th><td>                                        <span class="s1">'[#item_image]'</span><span class="p">,</span></td></tr><tr><th id="L1485"><a href="#L1485">1485</a></th><td>                                        <span class="s1">'[#item_url]'</span><span class="p">,</span></td></tr><tr><th id="L1486"><a href="#L1486">1486</a></th><td>                                        <span class="s1">'[#item_categories]'</span><span class="p">,</span></td></tr><tr><th id="L1487"><a href="#L1487">1487</a></th><td>                                        <span class="s1">'[#item_source]'</span><span class="p">,</span></td></tr><tr><th id="L1488"><a href="#L1488">1488</a></th><td>                                        <span class="s1">'[#translated_description]'</span><span class="p">,</span></td></tr><tr><th id="L1489"><a href="#L1489">1489</a></th><td>                                        <span class="s1">'[#translated_content]'</span><span class="p">,</span></td></tr><tr><th id="L1490"><a href="#L1490">1490</a></th><td>                                        <span class="s1">'[#item_price]'</span><span class="p">,</span></td></tr><tr><th id="L1491"><a href="#L1491">1491</a></th><td>                                        <span class="s1">'[#item_author]'</span><span class="p">,</span></td></tr><tr><th id="L1492"><a href="#L1492">1492</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L1493"><a href="#L1493">1493</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1494"><a href="#L1494">1494</a></th><td>                                        <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_description'</span><span class="p">],</span></td></tr><tr><th id="L1495"><a href="#L1495">1495</a></th><td>                                        <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_content'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_content'</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_description'</span><span class="p">],</span></td></tr><tr><th id="L1496"><a href="#L1496">1496</a></th><td>                                        <span class="nv">$image_html</span><span class="p">,</span></td></tr><tr><th id="L1497"><a href="#L1497">1497</a></th><td>                                        <span class="nv">$item_link</span><span class="p">,</span></td></tr><tr><th id="L1498"><a href="#L1498">1498</a></th><td>                                        <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_categories'</span><span class="p">],</span></td></tr><tr><th id="L1499"><a href="#L1499">1499</a></th><td>                                        <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_source'</span><span class="p">],</span></td></tr><tr><th id="L1500"><a href="#L1500">1500</a></th><td>                                        <span class="nv">$translated_description</span><span class="p">,</span></td></tr><tr><th id="L1501"><a href="#L1501">1501</a></th><td>                                        <span class="nv">$translated_content</span><span class="p">,</span></td></tr><tr><th id="L1502"><a href="#L1502">1502</a></th><td>                                        <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_price'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_price'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">''</span><span class="p">,</span></td></tr><tr><th id="L1503"><a href="#L1503">1503</a></th><td>                                        <span class="nv">$author</span><span class="p">,</span></td></tr><tr><th id="L1504"><a href="#L1504">1504</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L1505"><a href="#L1505">1505</a></th><td>                                <span class="nv">$import_content</span></td></tr><tr><th id="L1506"><a href="#L1506">1506</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L1507"><a href="#L1507">1507</a></th><td></td></tr><tr><th id="L1508"><a href="#L1508">1508</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_business</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1509"><a href="#L1509">1509</a></th><td>                                <span class="nv">$full_content</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_full_content'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_full_content'</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_content'</span><span class="p">];</span></td></tr><tr><th id="L1510"><a href="#L1510">1510</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nx">str_contains</span><span class="p">(</span> <span class="nv">$import_content</span><span class="p">,</span> <span class="s1">'_full_content'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1511"><a href="#L1511">1511</a></th><td>                                        <span class="c1">// if full content is empty, log a message</span></td></tr><tr><th id="L1512"><a href="#L1512">1512</a></th><td><span class="c1"></span>                                        <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$full_content</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1513"><a href="#L1513">1513</a></th><td>                                                <span class="c1">// let's see if there is an error.</span></td></tr><tr><th id="L1514"><a href="#L1514">1514</a></th><td><span class="c1"></span>                                                <span class="nv">$full_content_error</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'full_content_error'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'full_content_error'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'full_content_error'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1515"><a href="#L1515">1515</a></th><td>                                                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$full_content_error</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1516"><a href="#L1516">1516</a></th><td>                                                        <span class="nv">$full_content_error</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Unknown'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L1517"><a href="#L1517">1517</a></th><td>                                                <span class="p">}</span></td></tr><tr><th id="L1518"><a href="#L1518">1518</a></th><td>                                                <span class="nv">$import_errors</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Full content is empty. Error: %s'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="nv">$full_content_error</span> <span class="p">);</span></td></tr><tr><th id="L1519"><a href="#L1519">1519</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1520"><a href="#L1520">1520</a></th><td></td></tr><tr><th id="L1521"><a href="#L1521">1521</a></th><td>                                        <span class="nv">$post_content</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span></td></tr><tr><th id="L1522"><a href="#L1522">1522</a></th><td>                                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1523"><a href="#L1523">1523</a></th><td>                                                        <span class="s1">'[#item_full_content]'</span><span class="p">,</span></td></tr><tr><th id="L1524"><a href="#L1524">1524</a></th><td>                                                <span class="p">),</span></td></tr><tr><th id="L1525"><a href="#L1525">1525</a></th><td>                                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1526"><a href="#L1526">1526</a></th><td>                                                        <span class="nv">$full_content</span><span class="p">,</span></td></tr><tr><th id="L1527"><a href="#L1527">1527</a></th><td>                                                <span class="p">),</span></td></tr><tr><th id="L1528"><a href="#L1528">1528</a></th><td>                                                <span class="nv">$post_content</span></td></tr><tr><th id="L1529"><a href="#L1529">1529</a></th><td>                                        <span class="p">);</span></td></tr><tr><th id="L1530"><a href="#L1530">1530</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1531"><a href="#L1531">1531</a></th><td>                                <span class="nv">$post_content</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_services'</span><span class="p">,</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="s1">'full_content'</span><span class="p">,</span> <span class="nv">$full_content</span><span class="p">,</span> <span class="nv">$job</span> <span class="p">);</span></td></tr><tr><th id="L1532"><a href="#L1532">1532</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1533"><a href="#L1533">1533</a></th><td>                        <span class="c1">// Item content action.</span></td></tr><tr><th id="L1534"><a href="#L1534">1534</a></th><td><span class="c1"></span>                        <span class="nv">$content_action</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">handle_content_actions</span><span class="p">(</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="s1">'item_content'</span> <span class="p">);</span></td></tr><tr><th id="L1535"><a href="#L1535">1535</a></th><td>                        <span class="nv">$post_content</span>   <span class="o">=</span> <span class="nv">$content_action</span><span class="o">-&gt;</span><span class="na">get_tags</span><span class="p">();</span></td></tr><tr><th id="L1536"><a href="#L1536">1536</a></th><td>                        <span class="c1">// Item content action process.</span></td></tr><tr><th id="L1537"><a href="#L1537">1537</a></th><td><span class="c1"></span>                        <span class="nv">$post_content</span> <span class="o">=</span> <span class="nv">$content_action</span><span class="o">-&gt;</span><span class="na">run_action_job</span><span class="p">(</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="nv">$import_translation_lang</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$language_code</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L1538"><a href="#L1538">1538</a></th><td>                        <span class="c1">// Parse custom tags.</span></td></tr><tr><th id="L1539"><a href="#L1539">1539</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_business</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1540"><a href="#L1540">1540</a></th><td>                                <span class="nv">$post_content</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_parse_custom_tags'</span><span class="p">,</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="nv">$item_obj</span> <span class="p">);</span></td></tr><tr><th id="L1541"><a href="#L1541">1541</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1542"><a href="#L1542">1542</a></th><td></td></tr><tr><th id="L1543"><a href="#L1543">1543</a></th><td>                        <span class="nv">$post_content</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_services'</span><span class="p">,</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="s1">'content'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_description'</span><span class="p">],</span> <span class="nv">$job</span> <span class="p">);</span></td></tr><tr><th id="L1544"><a href="#L1544">1544</a></th><td></td></tr><tr><th id="L1545"><a href="#L1545">1545</a></th><td>                        <span class="c1">// Translate full-content.</span></td></tr><tr><th id="L1546"><a href="#L1546">1546</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$import_auto_translation</span> <span class="o">&amp;&amp;</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="s1">'[#translated_full_content]'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1547"><a href="#L1547">1547</a></th><td>                                <span class="nv">$translated_full_content</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_auto_translate_services'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">],</span> <span class="s1">'[#translated_full_content]'</span><span class="p">,</span> <span class="nv">$import_translation_lang</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$language_code</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L1548"><a href="#L1548">1548</a></th><td>                                <span class="nv">$post_content</span>            <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'[#translated_full_content]'</span><span class="p">,</span> <span class="nb">rtrim</span><span class="p">(</span> <span class="nv">$translated_full_content</span><span class="p">,</span> <span class="s1">'.'</span> <span class="p">),</span> <span class="nv">$post_content</span> <span class="p">);</span></td></tr><tr><th id="L1549"><a href="#L1549">1549</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1550"><a href="#L1550">1550</a></th><td>                        <span class="c1">// Rewriter item content from feedzy API.</span></td></tr><tr><th id="L1551"><a href="#L1551">1551</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$rewrite_service_endabled</span> <span class="o">&amp;&amp;</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="s1">'[#content_feedzy_rewrite]'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1552"><a href="#L1552">1552</a></th><td>                                <span class="nv">$item_content</span>           <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_content'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_content'</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_description'</span><span class="p">];</span></td></tr><tr><th id="L1553"><a href="#L1553">1553</a></th><td>                                <span class="nv">$content_feedzy_rewrite</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_content_rewrite_services'</span><span class="p">,</span> <span class="nv">$item_content</span><span class="p">,</span> <span class="s1">'[#content_feedzy_rewrite]'</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L1554"><a href="#L1554">1554</a></th><td>                                <span class="nv">$post_content</span>           <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'[#content_feedzy_rewrite]'</span><span class="p">,</span> <span class="nv">$content_feedzy_rewrite</span><span class="p">,</span> <span class="nv">$post_content</span> <span class="p">);</span></td></tr><tr><th id="L1555"><a href="#L1555">1555</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1556"><a href="#L1556">1556</a></th><td></td></tr><tr><th id="L1557"><a href="#L1557">1557</a></th><td>                        <span class="c1">// Rewriter item full content from feedzy API.</span></td></tr><tr><th id="L1558"><a href="#L1558">1558</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$rewrite_service_endabled</span> <span class="o">&amp;&amp;</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="s1">'[#full_content_feedzy_rewrite]'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1559"><a href="#L1559">1559</a></th><td>                                <span class="nv">$full_content_feedzy_rewrite</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_invoke_content_rewrite_services'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">],</span> <span class="s1">'[#full_content_feedzy_rewrite]'</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$item</span> <span class="p">);</span></td></tr><tr><th id="L1560"><a href="#L1560">1560</a></th><td>                                <span class="nv">$post_content</span>                <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'[#full_content_feedzy_rewrite]'</span><span class="p">,</span> <span class="nv">$full_content_feedzy_rewrite</span><span class="p">,</span> <span class="nv">$post_content</span> <span class="p">);</span></td></tr><tr><th id="L1561"><a href="#L1561">1561</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1562"><a href="#L1562">1562</a></th><td></td></tr><tr><th id="L1563"><a href="#L1563">1563</a></th><td>                        <span class="c1">// phpcs:ignore WordPress.DateTime.RestrictedFunctions.date_date</span></td></tr><tr><th id="L1564"><a href="#L1564">1564</a></th><td><span class="c1"></span>                        <span class="nv">$item_date</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span> <span class="s1">'Y-m-d H:i:s'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_date'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L1565"><a href="#L1565">1565</a></th><td>                        <span class="c1">// phpcs:ignore WordPress.DateTime.RestrictedFunctions.date_date</span></td></tr><tr><th id="L1566"><a href="#L1566">1566</a></th><td><span class="c1"></span>                        <span class="nv">$now</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span> <span class="s1">'Y-m-d H:i:s'</span> <span class="p">);</span></td></tr><tr><th id="L1567"><a href="#L1567">1567</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$import_date</span> <span class="p">)</span> <span class="o">===</span> <span class="s1">''</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1568"><a href="#L1568">1568</a></th><td>                                <span class="nv">$post_date</span> <span class="o">=</span> <span class="nv">$now</span><span class="p">;</span></td></tr><tr><th id="L1569"><a href="#L1569">1569</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1570"><a href="#L1570">1570</a></th><td>                        <span class="nv">$post_date</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'[#item_date]'</span><span class="p">,</span> <span class="nv">$item_date</span><span class="p">,</span> <span class="nv">$import_date</span> <span class="p">);</span></td></tr><tr><th id="L1571"><a href="#L1571">1571</a></th><td>                        <span class="nv">$post_date</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'[#post_date]'</span><span class="p">,</span> <span class="nv">$now</span><span class="p">,</span> <span class="nv">$post_date</span> <span class="p">);</span></td></tr><tr><th id="L1572"><a href="#L1572">1572</a></th><td></td></tr><tr><th id="L1573"><a href="#L1573">1573</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">defined</span><span class="p">(</span> <span class="s1">'FEEDZY_ALLOW_UNSAFE_HTML'</span> <span class="p">)</span> <span class="o">||</span> <span class="o">!</span> <span class="nx">FEEDZY_ALLOW_UNSAFE_HTML</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1574"><a href="#L1574">1574</a></th><td>                                <span class="nv">$post_content</span> <span class="o">=</span> <span class="nx">wp_kses</span><span class="p">(</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_wp_kses_allowed_html'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1575"><a href="#L1575">1575</a></th><td></td></tr><tr><th id="L1576"><a href="#L1576">1576</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">function_exists</span><span class="p">(</span> <span class="s1">'use_block_editor_for_post_type'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1577"><a href="#L1577">1577</a></th><td>                                        <span class="k">require_once</span> <span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">'wp-admin/includes/post.php'</span><span class="p">;</span></td></tr><tr><th id="L1578"><a href="#L1578">1578</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1579"><a href="#L1579">1579</a></th><td></td></tr><tr><th id="L1580"><a href="#L1580">1580</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">function_exists</span><span class="p">(</span> <span class="s1">'use_block_editor_for_post_type'</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">use_block_editor_for_post_type</span><span class="p">(</span> <span class="nv">$import_post_type</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1581"><a href="#L1581">1581</a></th><td>                                        <span class="nv">$post_content</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$post_content</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'&lt;!-- wp:html --&gt;'</span> <span class="o">.</span> <span class="nx">trim</span><span class="p">(</span> <span class="nx">force_balance_tags</span><span class="p">(</span> <span class="nx">wpautop</span><span class="p">(</span> <span class="nv">$post_content</span><span class="p">,</span> <span class="s1">'br'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;!-- /wp:html --&gt;'</span> <span class="o">:</span> <span class="nv">$post_content</span><span class="p">;</span></td></tr><tr><th id="L1582"><a href="#L1582">1582</a></th><td>                                        <span class="nv">$post_content</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$post_content</span> <span class="p">);</span></td></tr><tr><th id="L1583"><a href="#L1583">1583</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1584"><a href="#L1584">1584</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1585"><a href="#L1585">1585</a></th><td></td></tr><tr><th id="L1586"><a href="#L1586">1586</a></th><td>                        <span class="nv">$item_post_excerpt</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span></td></tr><tr><th id="L1587"><a href="#L1587">1587</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1588"><a href="#L1588">1588</a></th><td>                                        <span class="s1">'[#item_title]'</span><span class="p">,</span></td></tr><tr><th id="L1589"><a href="#L1589">1589</a></th><td>                                        <span class="s1">'[#item_content]'</span><span class="p">,</span></td></tr><tr><th id="L1590"><a href="#L1590">1590</a></th><td>                                        <span class="s1">'[#item_description]'</span><span class="p">,</span></td></tr><tr><th id="L1591"><a href="#L1591">1591</a></th><td>                                        <span class="s1">'[#translated_title]'</span><span class="p">,</span></td></tr><tr><th id="L1592"><a href="#L1592">1592</a></th><td>                                        <span class="s1">'[#translated_content]'</span><span class="p">,</span></td></tr><tr><th id="L1593"><a href="#L1593">1593</a></th><td>                                        <span class="s1">'[#translated_description]'</span><span class="p">,</span></td></tr><tr><th id="L1594"><a href="#L1594">1594</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L1595"><a href="#L1595">1595</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1596"><a href="#L1596">1596</a></th><td>                                        <span class="nv">$post_title</span><span class="p">,</span></td></tr><tr><th id="L1597"><a href="#L1597">1597</a></th><td>                                        <span class="nv">$post_content</span><span class="p">,</span></td></tr><tr><th id="L1598"><a href="#L1598">1598</a></th><td>                                        <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_description'</span><span class="p">],</span></td></tr><tr><th id="L1599"><a href="#L1599">1599</a></th><td>                                        <span class="nv">$translated_title</span><span class="p">,</span></td></tr><tr><th id="L1600"><a href="#L1600">1600</a></th><td>                                        <span class="nv">$translated_content</span><span class="p">,</span></td></tr><tr><th id="L1601"><a href="#L1601">1601</a></th><td>                                        <span class="nv">$translated_description</span><span class="p">,</span></td></tr><tr><th id="L1602"><a href="#L1602">1602</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L1603"><a href="#L1603">1603</a></th><td>                                <span class="nv">$post_excerpt</span></td></tr><tr><th id="L1604"><a href="#L1604">1604</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L1605"><a href="#L1605">1605</a></th><td></td></tr><tr><th id="L1606"><a href="#L1606">1606</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_business</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1607"><a href="#L1607">1607</a></th><td>                                <span class="nv">$item_post_excerpt</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_parse_custom_tags'</span><span class="p">,</span> <span class="nv">$item_post_excerpt</span><span class="p">,</span> <span class="nv">$item_obj</span> <span class="p">);</span></td></tr><tr><th id="L1608"><a href="#L1608">1608</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1609"><a href="#L1609">1609</a></th><td></td></tr><tr><th id="L1610"><a href="#L1610">1610</a></th><td>                        <span class="nv">$new_post</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span></td></tr><tr><th id="L1611"><a href="#L1611">1611</a></th><td>                                <span class="s1">'feedzy_insert_post_args'</span><span class="p">,</span></td></tr><tr><th id="L1612"><a href="#L1612">1612</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1613"><a href="#L1613">1613</a></th><td>                                        <span class="s1">'post_type'</span>    <span class="o">=&gt;</span> <span class="nv">$import_post_type</span><span class="p">,</span></td></tr><tr><th id="L1614"><a href="#L1614">1614</a></th><td>                                        <span class="s1">'post_title'</span>   <span class="o">=&gt;</span> <span class="nx">wp_kses</span><span class="p">(</span> <span class="nv">$post_title</span><span class="p">,</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_wp_kses_allowed_html'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">)</span> <span class="p">),</span></td></tr><tr><th id="L1615"><a href="#L1615">1615</a></th><td>                                        <span class="s1">'post_content'</span> <span class="o">=&gt;</span> <span class="nv">$post_content</span><span class="p">,</span></td></tr><tr><th id="L1616"><a href="#L1616">1616</a></th><td>                                        <span class="s1">'post_date'</span>    <span class="o">=&gt;</span> <span class="nv">$post_date</span><span class="p">,</span></td></tr><tr><th id="L1617"><a href="#L1617">1617</a></th><td>                                        <span class="s1">'post_status'</span>  <span class="o">=&gt;</span> <span class="nv">$import_post_status</span><span class="p">,</span></td></tr><tr><th id="L1618"><a href="#L1618">1618</a></th><td>                                        <span class="s1">'post_excerpt'</span> <span class="o">=&gt;</span> <span class="nv">$item_post_excerpt</span><span class="p">,</span></td></tr><tr><th id="L1619"><a href="#L1619">1619</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L1620"><a href="#L1620">1620</a></th><td>                                <span class="nv">$item_obj</span><span class="p">,</span></td></tr><tr><th id="L1621"><a href="#L1621">1621</a></th><td>                                <span class="nv">$post_title</span><span class="p">,</span></td></tr><tr><th id="L1622"><a href="#L1622">1622</a></th><td>                                <span class="nv">$post_content</span><span class="p">,</span></td></tr><tr><th id="L1623"><a href="#L1623">1623</a></th><td>                                <span class="nv">$item_post_excerpt</span><span class="p">,</span></td></tr><tr><th id="L1624"><a href="#L1624">1624</a></th><td>                                <span class="nv">$index</span><span class="p">,</span></td></tr><tr><th id="L1625"><a href="#L1625">1625</a></th><td>                                <span class="nv">$job</span></td></tr><tr><th id="L1626"><a href="#L1626">1626</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L1627"><a href="#L1627">1627</a></th><td></td></tr><tr><th id="L1628"><a href="#L1628">1628</a></th><td>                        <span class="c1">// no point creating a post if either the title or the content is null.</span></td></tr><tr><th id="L1629"><a href="#L1629">1629</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="nb">is_null</span><span class="p">(</span> <span class="nv">$post_title</span> <span class="p">)</span> <span class="o">||</span> <span class="nb">is_null</span><span class="p">(</span> <span class="nv">$post_content</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1630"><a href="#L1630">1630</a></th><td>                                <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'NOT creating a new post as title (%s) or content (%s) is null.'</span><span class="p">,</span> <span class="nv">$post_title</span><span class="p">,</span> <span class="nv">$post_content</span> <span class="p">),</span> <span class="s1">'info'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1631"><a href="#L1631">1631</a></th><td>                                <span class="nv">$index</span> <span class="o">++</span><span class="p">;</span></td></tr><tr><th id="L1632"><a href="#L1632">1632</a></th><td>                                <span class="nv">$import_errors</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Title or Content is empty.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L1633"><a href="#L1633">1633</a></th><td>                                <span class="k">continue</span><span class="p">;</span></td></tr><tr><th id="L1634"><a href="#L1634">1634</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1635"><a href="#L1635">1635</a></th><td></td></tr><tr><th id="L1636"><a href="#L1636">1636</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="s1">'attachment'</span> <span class="o">===</span> <span class="nv">$import_post_type</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1637"><a href="#L1637">1637</a></th><td>                                <span class="nv">$image_url</span>       <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1638"><a href="#L1638">1638</a></th><td>                                <span class="nv">$img_success</span>     <span class="o">=</span> <span class="k">true</span><span class="p">;</span></td></tr><tr><th id="L1639"><a href="#L1639">1639</a></th><td>                                <span class="nv">$new_post_id</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></td></tr><tr><th id="L1640"><a href="#L1640">1640</a></th><td>                                <span class="nv">$default_img_tag</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_featured_img</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'[#item_image]'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1641"><a href="#L1641">1641</a></th><td></td></tr><tr><th id="L1642"><a href="#L1642">1642</a></th><td>                                <span class="c1">// image tag</span></td></tr><tr><th id="L1643"><a href="#L1643">1643</a></th><td><span class="c1"></span>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$default_img_tag</span><span class="p">,</span> <span class="s1">'[#item_image]'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1644"><a href="#L1644">1644</a></th><td>                                        <span class="c1">// image exists in item</span></td></tr><tr><th id="L1645"><a href="#L1645">1645</a></th><td><span class="c1"></span>                                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_img_path'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1646"><a href="#L1646">1646</a></th><td>                                                <span class="nv">$image_url</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'[#item_image]'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_img_path'</span><span class="p">],</span> <span class="nv">$default_img_tag</span> <span class="p">);</span></td></tr><tr><th id="L1647"><a href="#L1647">1647</a></th><td>                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1648"><a href="#L1648">1648</a></th><td>                                                <span class="nv">$img_success</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L1649"><a href="#L1649">1649</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1650"><a href="#L1650">1650</a></th><td>                                <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$default_img_tag</span><span class="p">,</span> <span class="s1">'[#item_custom'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1651"><a href="#L1651">1651</a></th><td>                                        <span class="c1">// custom image tag</span></td></tr><tr><th id="L1652"><a href="#L1652">1652</a></th><td><span class="c1"></span>                                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_business</span><span class="p">()</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_personal</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1653"><a href="#L1653">1653</a></th><td>                                                <span class="nv">$value</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_parse_custom_tags'</span><span class="p">,</span> <span class="nv">$default_img_tag</span><span class="p">,</span> <span class="nv">$item_obj</span> <span class="p">);</span></td></tr><tr><th id="L1654"><a href="#L1654">1654</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1655"><a href="#L1655">1655</a></th><td></td></tr><tr><th id="L1656"><a href="#L1656">1656</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$value</span><span class="p">,</span> <span class="s1">'[#item_custom'</span> <span class="p">)</span> <span class="o">===</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1657"><a href="#L1657">1657</a></th><td>                                                <span class="nv">$image_url</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span></td></tr><tr><th id="L1658"><a href="#L1658">1658</a></th><td>                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1659"><a href="#L1659">1659</a></th><td>                                                <span class="nv">$img_success</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L1660"><a href="#L1660">1660</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1661"><a href="#L1661">1661</a></th><td>                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1662"><a href="#L1662">1662</a></th><td>                                        <span class="nv">$image_url</span> <span class="o">=</span> <span class="nv">$default_img_tag</span><span class="p">;</span></td></tr><tr><th id="L1663"><a href="#L1663">1663</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1664"><a href="#L1664">1664</a></th><td></td></tr><tr><th id="L1665"><a href="#L1665">1665</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$image_url</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1666"><a href="#L1666">1666</a></th><td>                                        <span class="nv">$img_success</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate_featured_image</span><span class="p">(</span> <span class="nv">$image_url</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">],</span> <span class="nv">$import_errors</span><span class="p">,</span> <span class="nv">$import_info</span><span class="p">,</span> <span class="nv">$new_post</span> <span class="p">);</span></td></tr><tr><th id="L1667"><a href="#L1667">1667</a></th><td>                                        <span class="nv">$new_post_id</span> <span class="o">=</span> <span class="nv">$img_success</span><span class="p">;</span></td></tr><tr><th id="L1668"><a href="#L1668">1668</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1669"><a href="#L1669">1669</a></th><td></td></tr><tr><th id="L1670"><a href="#L1670">1670</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$img_success</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1671"><a href="#L1671">1671</a></th><td>                                        <span class="nv">$import_image_errors</span> <span class="o">++</span><span class="p">;</span></td></tr><tr><th id="L1672"><a href="#L1672">1672</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1673"><a href="#L1673">1673</a></th><td>                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1674"><a href="#L1674">1674</a></th><td>                                <span class="nv">$new_post_id</span> <span class="o">=</span> <span class="nx">wp_insert_post</span><span class="p">(</span> <span class="nv">$new_post</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1675"><a href="#L1675">1675</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1676"><a href="#L1676">1676</a></th><td></td></tr><tr><th id="L1677"><a href="#L1677">1677</a></th><td>                        <span class="c1">// Set post language.</span></td></tr><tr><th id="L1678"><a href="#L1678">1678</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="nb">function_exists</span><span class="p">(</span> <span class="s1">'pll_set_post_language'</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_selected_language</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1679"><a href="#L1679">1679</a></th><td>                                <span class="nx">pll_set_post_language</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nv">$import_selected_language</span> <span class="p">);</span></td></tr><tr><th id="L1680"><a href="#L1680">1680</a></th><td>                        <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span> <span class="nb">function_exists</span><span class="p">(</span> <span class="s1">'icl_get_languages'</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_selected_language</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1681"><a href="#L1681">1681</a></th><td>                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set_wpml_element_language_details</span><span class="p">(</span> <span class="nv">$import_post_type</span><span class="p">,</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nv">$import_selected_language</span> <span class="p">);</span></td></tr><tr><th id="L1682"><a href="#L1682">1682</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1683"><a href="#L1683">1683</a></th><td></td></tr><tr><th id="L1684"><a href="#L1684">1684</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$new_post_id</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$new_post_id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1685"><a href="#L1685">1685</a></th><td>                                <span class="nv">$error_reason</span> <span class="o">=</span> <span class="s1">'N/A'</span><span class="p">;</span></td></tr><tr><th id="L1686"><a href="#L1686">1686</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$new_post_id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1687"><a href="#L1687">1687</a></th><td>                                        <span class="nv">$error_reason</span> <span class="o">=</span> <span class="nv">$new_post_id</span><span class="o">-&gt;</span><span class="na">get_error_message</span><span class="p">();</span></td></tr><tr><th id="L1688"><a href="#L1688">1688</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$error_reason</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1689"><a href="#L1689">1689</a></th><td>                                                <span class="nv">$import_errors</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$error_reason</span><span class="p">;</span></td></tr><tr><th id="L1690"><a href="#L1690">1690</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1691"><a href="#L1691">1691</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1692"><a href="#L1692">1692</a></th><td>                                <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Unable to create a new post with params %s. Error: %s'</span><span class="p">,</span> <span class="nb">print_r</span><span class="p">(</span> <span class="nv">$new_post</span><span class="p">,</span> <span class="k">true</span> <span class="p">),</span> <span class="nv">$error_reason</span> <span class="p">),</span> <span class="s1">'error'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1693"><a href="#L1693">1693</a></th><td>                                <span class="nv">$index</span> <span class="o">++</span><span class="p">;</span></td></tr><tr><th id="L1694"><a href="#L1694">1694</a></th><td>                                <span class="k">continue</span><span class="p">;</span></td></tr><tr><th id="L1695"><a href="#L1695">1695</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1696"><a href="#L1696">1696</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'created new post with ID %d with post_content %s'</span><span class="p">,</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nv">$post_content</span> <span class="p">),</span> <span class="s1">'debug'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1697"><a href="#L1697">1697</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$item_hash</span><span class="p">,</span> <span class="nv">$found_duplicates</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1698"><a href="#L1698">1698</a></th><td>                                <span class="nv">$imported_items</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$item_hash</span><span class="p">;</span></td></tr><tr><th id="L1699"><a href="#L1699">1699</a></th><td>                                <span class="nv">$count</span> <span class="o">++</span><span class="p">;</span></td></tr><tr><th id="L1700"><a href="#L1700">1700</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1701"><a href="#L1701">1701</a></th><td></td></tr><tr><th id="L1702"><a href="#L1702">1702</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$import_post_term</span> <span class="o">!==</span> <span class="s1">'none'</span> <span class="o">&amp;&amp;</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$import_post_term</span><span class="p">,</span> <span class="s1">'_'</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1703"><a href="#L1703">1703</a></th><td>                                <span class="c1">// let's get the slug of the uncategorized category, even if it renamed.</span></td></tr><tr><th id="L1704"><a href="#L1704">1704</a></th><td><span class="c1"></span>                                <span class="nv">$uncategorized</span>    <span class="o">=</span> <span class="nx">get_category</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span></td></tr><tr><th id="L1705"><a href="#L1705">1705</a></th><td>                                <span class="nv">$terms</span>            <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span> <span class="s1">','</span><span class="p">,</span> <span class="nv">$import_post_term</span> <span class="p">);</span></td></tr><tr><th id="L1706"><a href="#L1706">1706</a></th><td>                                <span class="nv">$terms</span>            <span class="o">=</span> <span class="nb">array_filter</span><span class="p">(</span></td></tr><tr><th id="L1707"><a href="#L1707">1707</a></th><td>                                        <span class="nv">$terms</span><span class="p">,</span></td></tr><tr><th id="L1708"><a href="#L1708">1708</a></th><td>                                        <span class="k">function</span><span class="p">(</span> <span class="nv">$term</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1709"><a href="#L1709">1709</a></th><td>                                                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$term</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1710"><a href="#L1710">1710</a></th><td>                                                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L1711"><a href="#L1711">1711</a></th><td>                                                <span class="p">}</span></td></tr><tr><th id="L1712"><a href="#L1712">1712</a></th><td>                                                <span class="k">if</span> <span class="p">(</span> <span class="k">false</span> <span class="o">!==</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$term</span><span class="p">,</span> <span class="s1">'[#item_'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1713"><a href="#L1713">1713</a></th><td>                                                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L1714"><a href="#L1714">1714</a></th><td>                                                <span class="p">}</span></td></tr><tr><th id="L1715"><a href="#L1715">1715</a></th><td>                                                <span class="k">return</span> <span class="nv">$term</span><span class="p">;</span></td></tr><tr><th id="L1716"><a href="#L1716">1716</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1717"><a href="#L1717">1717</a></th><td>                                <span class="p">);</span></td></tr><tr><th id="L1718"><a href="#L1718">1718</a></th><td>                                <span class="nv">$default_category</span> <span class="o">=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nx">get_option</span><span class="p">(</span> <span class="s1">'default_category'</span> <span class="p">);</span></td></tr><tr><th id="L1719"><a href="#L1719">1719</a></th><td>                                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$terms</span> <span class="k">as</span> <span class="nv">$term</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1720"><a href="#L1720">1720</a></th><td>                                        <span class="c1">// this handles both x_2, where 2 is the term id and x is the taxonomy AND x_2_3_4 where 4 is the term id and the taxonomy name is "x 2 3 4".</span></td></tr><tr><th id="L1721"><a href="#L1721">1721</a></th><td><span class="c1"></span>                                        <span class="nv">$array</span>    <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span> <span class="s1">'_'</span><span class="p">,</span> <span class="nv">$term</span> <span class="p">);</span></td></tr><tr><th id="L1722"><a href="#L1722">1722</a></th><td>                                        <span class="nv">$term_id</span>  <span class="o">=</span> <span class="nb">array_pop</span><span class="p">(</span> <span class="nv">$array</span> <span class="p">);</span></td></tr><tr><th id="L1723"><a href="#L1723">1723</a></th><td>                                        <span class="nv">$taxonomy</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span> <span class="s1">'_'</span><span class="p">,</span> <span class="nv">$array</span> <span class="p">);</span></td></tr><tr><th id="L1724"><a href="#L1724">1724</a></th><td></td></tr><tr><th id="L1725"><a href="#L1725">1725</a></th><td>                                        <span class="c1">// uncategorized</span></td></tr><tr><th id="L1726"><a href="#L1726">1726</a></th><td><span class="c1"></span>                                        <span class="c1">// 1. may be the unmodified category ID 1</span></td></tr><tr><th id="L1727"><a href="#L1727">1727</a></th><td><span class="c1"></span>                                        <span class="c1">// 2. may have been recreated ('uncategorized') and may have a different slug in different languages.</span></td></tr><tr><th id="L1728"><a href="#L1728">1728</a></th><td><span class="c1"></span>                                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$default_category</span> <span class="o">===</span> <span class="nv">$uncategorized</span><span class="o">-&gt;</span><span class="na">term_id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1729"><a href="#L1729">1729</a></th><td>                                                <span class="nx">wp_remove_object_terms</span><span class="p">(</span></td></tr><tr><th id="L1730"><a href="#L1730">1730</a></th><td>                                                        <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nx">apply_filters</span><span class="p">(</span></td></tr><tr><th id="L1731"><a href="#L1731">1731</a></th><td>                                                                <span class="s1">'feedzy_uncategorized'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1732"><a href="#L1732">1732</a></th><td>                                                                        <span class="mi">1</span><span class="p">,</span></td></tr><tr><th id="L1733"><a href="#L1733">1733</a></th><td>                                                                        <span class="s1">'uncategorized'</span><span class="p">,</span></td></tr><tr><th id="L1734"><a href="#L1734">1734</a></th><td>                                                                        <span class="nv">$uncategorized</span><span class="o">-&gt;</span><span class="na">slug</span><span class="p">,</span></td></tr><tr><th id="L1735"><a href="#L1735">1735</a></th><td>                                                                <span class="p">),</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span></td></tr><tr><th id="L1736"><a href="#L1736">1736</a></th><td>                                                        <span class="p">),</span> <span class="s1">'category'</span></td></tr><tr><th id="L1737"><a href="#L1737">1737</a></th><td>                                                <span class="p">);</span></td></tr><tr><th id="L1738"><a href="#L1738">1738</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1739"><a href="#L1739">1739</a></th><td></td></tr><tr><th id="L1740"><a href="#L1740">1740</a></th><td>                                        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">wp_set_object_terms</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nb">intval</span><span class="p">(</span> <span class="nv">$term_id</span> <span class="p">),</span> <span class="nv">$taxonomy</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1741"><a href="#L1741">1741</a></th><td>                                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'After creating post in %s/%d, result = %s'</span><span class="p">,</span> <span class="nv">$taxonomy</span><span class="p">,</span> <span class="nv">$term_id</span><span class="p">,</span> <span class="nb">print_r</span><span class="p">(</span> <span class="nv">$result</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">),</span> <span class="s1">'debug'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1742"><a href="#L1742">1742</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1743"><a href="#L1743">1743</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1744"><a href="#L1744">1744</a></th><td></td></tr><tr><th id="L1745"><a href="#L1745">1745</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'feedzy_import_extra'</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$item_obj</span><span class="p">,</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nv">$import_errors</span><span class="p">,</span> <span class="nv">$import_info</span> <span class="p">);</span></td></tr><tr><th id="L1746"><a href="#L1746">1746</a></th><td></td></tr><tr><th id="L1747"><a href="#L1747">1747</a></th><td>                        <span class="nv">$default_img_tag</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$import_featured_img</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">'[#item_image]'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1748"><a href="#L1748">1748</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$default_img_tag</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="s1">'attachment'</span> <span class="o">!==</span> <span class="nv">$import_post_type</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1749"><a href="#L1749">1749</a></th><td>                                <span class="nv">$image_url</span>   <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L1750"><a href="#L1750">1750</a></th><td>                                <span class="nv">$img_success</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span></td></tr><tr><th id="L1751"><a href="#L1751">1751</a></th><td></td></tr><tr><th id="L1752"><a href="#L1752">1752</a></th><td>                                <span class="c1">// image tag</span></td></tr><tr><th id="L1753"><a href="#L1753">1753</a></th><td><span class="c1"></span>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$default_img_tag</span><span class="p">,</span> <span class="s1">'[#item_image]'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1754"><a href="#L1754">1754</a></th><td>                                        <span class="c1">// image exists in item</span></td></tr><tr><th id="L1755"><a href="#L1755">1755</a></th><td><span class="c1"></span>                                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_img_path'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1756"><a href="#L1756">1756</a></th><td>                                                <span class="nv">$image_url</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'[#item_image]'</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_img_path'</span><span class="p">],</span> <span class="nv">$default_img_tag</span> <span class="p">);</span></td></tr><tr><th id="L1757"><a href="#L1757">1757</a></th><td>                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1758"><a href="#L1758">1758</a></th><td>                                                <span class="nv">$img_success</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L1759"><a href="#L1759">1759</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1760"><a href="#L1760">1760</a></th><td>                                <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$default_img_tag</span><span class="p">,</span> <span class="s1">'[#item_custom'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1761"><a href="#L1761">1761</a></th><td>                                        <span class="c1">// custom image tag</span></td></tr><tr><th id="L1762"><a href="#L1762">1762</a></th><td><span class="c1"></span>                                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_business</span><span class="p">()</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_personal</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1763"><a href="#L1763">1763</a></th><td>                                                <span class="nv">$value</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_parse_custom_tags'</span><span class="p">,</span> <span class="nv">$default_img_tag</span><span class="p">,</span> <span class="nv">$item_obj</span> <span class="p">);</span></td></tr><tr><th id="L1764"><a href="#L1764">1764</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1765"><a href="#L1765">1765</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$value</span><span class="p">,</span> <span class="s1">'[#item_custom'</span> <span class="p">)</span> <span class="o">===</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1766"><a href="#L1766">1766</a></th><td>                                                <span class="nv">$image_url</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span></td></tr><tr><th id="L1767"><a href="#L1767">1767</a></th><td>                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1768"><a href="#L1768">1768</a></th><td>                                                <span class="nv">$img_success</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L1769"><a href="#L1769">1769</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1770"><a href="#L1770">1770</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1771"><a href="#L1771">1771</a></th><td></td></tr><tr><th id="L1772"><a href="#L1772">1772</a></th><td>                                <span class="c1">// Fetch image from graby.</span></td></tr><tr><th id="L1773"><a href="#L1773">1773</a></th><td><span class="c1"></span>                                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$image_url</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">wp_doing_cron</span><span class="p">()</span> <span class="o">||</span> <span class="nb">defined</span><span class="p">(</span> <span class="s1">'FEEDZY_PRO_FETCH_ITEM_IMG_URL'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1774"><a href="#L1774">1774</a></th><td>                                        <span class="c1">// if license does not exist, use the site url</span></td></tr><tr><th id="L1775"><a href="#L1775">1775</a></th><td><span class="c1"></span>                                        <span class="c1">// this should obviously never happen unless on dev instances.</span></td></tr><tr><th id="L1776"><a href="#L1776">1776</a></th><td><span class="c1"></span>                                        <span class="nv">$license</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'product_feedzy_license_key'</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'n/a - %s'</span><span class="p">,</span> <span class="nx">get_site_url</span><span class="p">()</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1777"><a href="#L1777">1777</a></th><td></td></tr><tr><th id="L1778"><a href="#L1778">1778</a></th><td>                                        <span class="nv">$response</span> <span class="o">=</span> <span class="nx">wp_remote_post</span><span class="p">(</span></td></tr><tr><th id="L1779"><a href="#L1779">1779</a></th><td>                                                <span class="nx">FEEDZY_PRO_FETCH_ITEM_IMG_URL</span><span class="p">,</span></td></tr><tr><th id="L1780"><a href="#L1780">1780</a></th><td>                                                <span class="nx">apply_filters</span><span class="p">(</span></td></tr><tr><th id="L1781"><a href="#L1781">1781</a></th><td>                                                        <span class="s1">'feedzy_fetch_item_image'</span><span class="p">,</span></td></tr><tr><th id="L1782"><a href="#L1782">1782</a></th><td>                                                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1783"><a href="#L1783">1783</a></th><td>                                                                <span class="s1">'timeout'</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="p">,</span></td></tr><tr><th id="L1784"><a href="#L1784">1784</a></th><td>                                                                <span class="s1">'body'</span>    <span class="o">=&gt;</span> <span class="nb">array_merge</span><span class="p">(</span></td></tr><tr><th id="L1785"><a href="#L1785">1785</a></th><td>                                                                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1786"><a href="#L1786">1786</a></th><td>                                                                                <span class="s1">'item_url'</span> <span class="o">=&gt;</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">],</span></td></tr><tr><th id="L1787"><a href="#L1787">1787</a></th><td>                                                                                <span class="s1">'license'</span>  <span class="o">=&gt;</span> <span class="nv">$license</span><span class="p">,</span></td></tr><tr><th id="L1788"><a href="#L1788">1788</a></th><td>                                                                                <span class="s1">'site_url'</span> <span class="o">=&gt;</span> <span class="nx">get_site_url</span><span class="p">(),</span></td></tr><tr><th id="L1789"><a href="#L1789">1789</a></th><td>                                                                        <span class="p">)</span></td></tr><tr><th id="L1790"><a href="#L1790">1790</a></th><td>                                                                <span class="p">),</span></td></tr><tr><th id="L1791"><a href="#L1791">1791</a></th><td>                                                        <span class="p">)</span></td></tr><tr><th id="L1792"><a href="#L1792">1792</a></th><td>                                                <span class="p">)</span></td></tr><tr><th id="L1793"><a href="#L1793">1793</a></th><td>                                        <span class="p">);</span></td></tr><tr><th id="L1794"><a href="#L1794">1794</a></th><td></td></tr><tr><th id="L1795"><a href="#L1795">1795</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$response</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1796"><a href="#L1796">1796</a></th><td>                                                <span class="k">if</span> <span class="p">(</span> <span class="nb">array_key_exists</span><span class="p">(</span> <span class="s1">'response'</span><span class="p">,</span> <span class="nv">$response</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">array_key_exists</span><span class="p">(</span> <span class="s1">'code'</span><span class="p">,</span> <span class="nv">$response</span><span class="p">[</span><span class="s1">'response'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">intval</span><span class="p">(</span> <span class="nv">$response</span><span class="p">[</span><span class="s1">'response'</span><span class="p">][</span><span class="s1">'code'</span><span class="p">]</span> <span class="p">)</span> <span class="o">!==</span> <span class="mi">200</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1797"><a href="#L1797">1797</a></th><td>                                                        <span class="c1">// phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r</span></td></tr><tr><th id="L1798"><a href="#L1798">1798</a></th><td><span class="c1"></span>                                                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'error in response = %s'</span><span class="p">,</span> <span class="nb">print_r</span><span class="p">(</span> <span class="nv">$response</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">),</span> <span class="s1">'error'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1799"><a href="#L1799">1799</a></th><td>                                                <span class="p">}</span></td></tr><tr><th id="L1800"><a href="#L1800">1800</a></th><td>                                                <span class="nv">$body</span> <span class="o">=</span> <span class="nx">wp_remote_retrieve_body</span><span class="p">(</span> <span class="nv">$response</span> <span class="p">);</span></td></tr><tr><th id="L1801"><a href="#L1801">1801</a></th><td>                                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$body</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1802"><a href="#L1802">1802</a></th><td>                                                        <span class="nv">$response_data</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span> <span class="nv">$body</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1803"><a href="#L1803">1803</a></th><td>                                                        <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$response_data</span><span class="p">[</span><span class="s1">'url'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1804"><a href="#L1804">1804</a></th><td>                                                                <span class="nv">$image_url</span> <span class="o">=</span> <span class="nv">$response_data</span><span class="p">[</span><span class="s1">'url'</span><span class="p">];</span></td></tr><tr><th id="L1805"><a href="#L1805">1805</a></th><td>                                                        <span class="p">}</span></td></tr><tr><th id="L1806"><a href="#L1806">1806</a></th><td>                                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1807"><a href="#L1807">1807</a></th><td>                                                        <span class="c1">// phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r</span></td></tr><tr><th id="L1808"><a href="#L1808">1808</a></th><td><span class="c1"></span>                                                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'error in body = %s'</span><span class="p">,</span> <span class="nb">print_r</span><span class="p">(</span> <span class="nv">$body</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">),</span> <span class="s1">'error'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1809"><a href="#L1809">1809</a></th><td>                                                <span class="p">}</span></td></tr><tr><th id="L1810"><a href="#L1810">1810</a></th><td>                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1811"><a href="#L1811">1811</a></th><td>                                                <span class="c1">// phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r</span></td></tr><tr><th id="L1812"><a href="#L1812">1812</a></th><td><span class="c1"></span>                                                <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'error in request = %s'</span><span class="p">,</span> <span class="nb">print_r</span><span class="p">(</span> <span class="nv">$response</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">),</span> <span class="s1">'error'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1813"><a href="#L1813">1813</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1814"><a href="#L1814">1814</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1815"><a href="#L1815">1815</a></th><td></td></tr><tr><th id="L1816"><a href="#L1816">1816</a></th><td>                                <span class="c1">// Item image action.</span></td></tr><tr><th id="L1817"><a href="#L1817">1817</a></th><td><span class="c1"></span>                                <span class="nv">$import_featured_img</span> <span class="o">=</span> <span class="nb">rawurldecode</span><span class="p">(</span> <span class="nv">$import_featured_img</span> <span class="p">);</span></td></tr><tr><th id="L1818"><a href="#L1818">1818</a></th><td>                                <span class="nv">$import_featured_img</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$import_featured_img</span> <span class="p">);</span></td></tr><tr><th id="L1819"><a href="#L1819">1819</a></th><td>                                <span class="nv">$img_action</span>          <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">handle_content_actions</span><span class="p">(</span> <span class="nv">$import_featured_img</span><span class="p">,</span> <span class="s1">'item_image'</span> <span class="p">);</span></td></tr><tr><th id="L1820"><a href="#L1820">1820</a></th><td>                                <span class="c1">// Item image action process.</span></td></tr><tr><th id="L1821"><a href="#L1821">1821</a></th><td><span class="c1"></span>                                <span class="nv">$image_url</span> <span class="o">=</span> <span class="nv">$img_action</span><span class="o">-&gt;</span><span class="na">run_action_job</span><span class="p">(</span> <span class="nv">$import_featured_img</span><span class="p">,</span> <span class="nv">$import_translation_lang</span><span class="p">,</span> <span class="nv">$job</span><span class="p">,</span> <span class="nv">$language_code</span><span class="p">,</span> <span class="nv">$item</span><span class="p">,</span> <span class="nv">$image_url</span> <span class="p">);</span></td></tr><tr><th id="L1822"><a href="#L1822">1822</a></th><td></td></tr><tr><th id="L1823"><a href="#L1823">1823</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$image_url</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1824"><a href="#L1824">1824</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="s1">'yes'</span> <span class="o">===</span> <span class="nv">$import_item_img_url</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1825"><a href="#L1825">1825</a></th><td>                                                <span class="c1">// Set external image URL.</span></td></tr><tr><th id="L1826"><a href="#L1826">1826</a></th><td><span class="c1"></span>                                                <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="s1">'feedzy_item_external_url'</span><span class="p">,</span> <span class="nv">$image_url</span> <span class="p">);</span></td></tr><tr><th id="L1827"><a href="#L1827">1827</a></th><td>                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1828"><a href="#L1828">1828</a></th><td>                                                <span class="c1">// if import_featured_img is a tag.</span></td></tr><tr><th id="L1829"><a href="#L1829">1829</a></th><td><span class="c1"></span>                                                <span class="nv">$img_success</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate_featured_image</span><span class="p">(</span> <span class="nv">$image_url</span><span class="p">,</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">],</span> <span class="nv">$import_errors</span><span class="p">,</span> <span class="nv">$import_info</span> <span class="p">);</span></td></tr><tr><th id="L1830"><a href="#L1830">1830</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L1831"><a href="#L1831">1831</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1832"><a href="#L1832">1832</a></th><td>                                <span class="c1">// Set default thumbnail image.</span></td></tr><tr><th id="L1833"><a href="#L1833">1833</a></th><td><span class="c1"></span>                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$img_success</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$default_thumbnail</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1834"><a href="#L1834">1834</a></th><td>                                        <span class="nv">$img_success</span> <span class="o">=</span> <span class="nx">set_post_thumbnail</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nv">$default_thumbnail</span> <span class="p">);</span></td></tr><tr><th id="L1835"><a href="#L1835">1835</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1836"><a href="#L1836">1836</a></th><td></td></tr><tr><th id="L1837"><a href="#L1837">1837</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$img_success</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1838"><a href="#L1838">1838</a></th><td>                                        <span class="nv">$import_image_errors</span> <span class="o">++</span><span class="p">;</span></td></tr><tr><th id="L1839"><a href="#L1839">1839</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1840"><a href="#L1840">1840</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1841"><a href="#L1841">1841</a></th><td></td></tr><tr><th id="L1842"><a href="#L1842">1842</a></th><td>                        <span class="nv">$index</span> <span class="o">++</span><span class="p">;</span></td></tr><tr><th id="L1843"><a href="#L1843">1843</a></th><td></td></tr><tr><th id="L1844"><a href="#L1844">1844</a></th><td>                        <span class="c1">// indicate that this post was imported by feedzy.</span></td></tr><tr><th id="L1845"><a href="#L1845">1845</a></th><td><span class="c1"></span>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="s1">'feedzy'</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span></td></tr><tr><th id="L1846"><a href="#L1846">1846</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="s1">'feedzy_item_url'</span><span class="p">,</span> <span class="nx">esc_url_raw</span><span class="p">(</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1847"><a href="#L1847">1847</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="s1">'feedzy_job'</span><span class="p">,</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span> <span class="p">);</span></td></tr><tr><th id="L1848"><a href="#L1848">1848</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="s1">'feedzy_item_author'</span><span class="p">,</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$author</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1849"><a href="#L1849">1849</a></th><td></td></tr><tr><th id="L1850"><a href="#L1850">1850</a></th><td>                        <span class="c1">// we can use this to associate the items that were imported in a particular run.</span></td></tr><tr><th id="L1851"><a href="#L1851">1851</a></th><td><span class="c1"></span>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="s1">'feedzy_job_time'</span><span class="p">,</span> <span class="nv">$last_run</span> <span class="p">);</span></td></tr><tr><th id="L1852"><a href="#L1852">1852</a></th><td></td></tr><tr><th id="L1853"><a href="#L1853">1853</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'feedzy_after_post_import'</span><span class="p">,</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nv">$item</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">settings</span> <span class="p">);</span></td></tr><tr><th id="L1854"><a href="#L1854">1854</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1855"><a href="#L1855">1855</a></th><td></td></tr><tr><th id="L1856"><a href="#L1856">1856</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$use_new_hash</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1857"><a href="#L1857">1857</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'imported_items_hash'</span><span class="p">,</span> <span class="nv">$imported_items</span> <span class="p">);</span></td></tr><tr><th id="L1858"><a href="#L1858">1858</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1859"><a href="#L1859">1859</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'imported_items'</span><span class="p">,</span> <span class="nv">$imported_items</span> <span class="p">);</span></td></tr><tr><th id="L1860"><a href="#L1860">1860</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1861"><a href="#L1861">1861</a></th><td>                <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'imported_items_count'</span><span class="p">,</span> <span class="nv">$count</span> <span class="p">);</span></td></tr><tr><th id="L1862"><a href="#L1862">1862</a></th><td></td></tr><tr><th id="L1863"><a href="#L1863">1863</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$import_image_errors</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1864"><a href="#L1864">1864</a></th><td>                        <span class="nv">$import_errors</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Unable to find an image for %1$d out of %2$d items imported'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="nv">$import_image_errors</span><span class="p">,</span> <span class="nv">$count</span> <span class="p">);</span></td></tr><tr><th id="L1865"><a href="#L1865">1865</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1866"><a href="#L1866">1866</a></th><td>                <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_errors'</span><span class="p">,</span> <span class="nv">$import_errors</span> <span class="p">);</span></td></tr><tr><th id="L1867"><a href="#L1867">1867</a></th><td></td></tr><tr><th id="L1868"><a href="#L1868">1868</a></th><td>                <span class="c1">// the order of these matters in how they are finally shown in the summary.</span></td></tr><tr><th id="L1869"><a href="#L1869">1869</a></th><td><span class="c1"></span>                <span class="nv">$import_info</span><span class="p">[</span><span class="s1">'total'</span><span class="p">]</span>      <span class="o">=</span> <span class="nv">$items_found</span><span class="p">;</span></td></tr><tr><th id="L1870"><a href="#L1870">1870</a></th><td>                <span class="nv">$import_info</span><span class="p">[</span><span class="s1">'duplicates'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$duplicates</span><span class="p">;</span></td></tr><tr><th id="L1871"><a href="#L1871">1871</a></th><td></td></tr><tr><th id="L1872"><a href="#L1872">1872</a></th><td>                <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'import_info'</span><span class="p">,</span> <span class="nv">$import_info</span> <span class="p">);</span></td></tr><tr><th id="L1873"><a href="#L1873">1873</a></th><td></td></tr><tr><th id="L1874"><a href="#L1874">1874</a></th><td>                <span class="k">return</span> <span class="nv">$count</span><span class="p">;</span></td></tr><tr><th id="L1875"><a href="#L1875">1875</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L1876"><a href="#L1876">1876</a></th><td></td></tr><tr><th id="L1877"><a href="#L1877">1877</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L1878"><a href="#L1878">1878</a></th><td><span class="sd">         * Method to return feed items to use on cron job.</span></td></tr><tr><th id="L1879"><a href="#L1879">1879</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1880"><a href="#L1880">1880</a></th><td><span class="sd">         * @param array  $options The options for the job.</span></td></tr><tr><th id="L1881"><a href="#L1881">1881</a></th><td><span class="sd">         * @param string $import_content The import content (along with the magic tags).</span></td></tr><tr><th id="L1882"><a href="#L1882">1882</a></th><td><span class="sd">         * @param bool   $raw_feed_also Whether to return the raw SimplePie object as well.</span></td></tr><tr><th id="L1883"><a href="#L1883">1883</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1884"><a href="#L1884">1884</a></th><td><span class="sd">         * @return mixed</span></td></tr><tr><th id="L1885"><a href="#L1885">1885</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L1886"><a href="#L1886">1886</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L1887"><a href="#L1887">1887</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L1888"><a href="#L1888">1888</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">get_job_feed</span><span class="p">(</span> <span class="nv">$options</span><span class="p">,</span> <span class="nv">$import_content</span> <span class="o">=</span> <span class="k">null</span><span class="p">,</span> <span class="nv">$raw_feed_also</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1889"><a href="#L1889">1889</a></th><td>                <span class="nv">$admin</span> <span class="o">=</span> <span class="nx">Feedzy_Rss_Feeds</span><span class="o">::</span><span class="na">instance</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">get_admin</span><span class="p">();</span></td></tr><tr><th id="L1890"><a href="#L1890">1890</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">method_exists</span><span class="p">(</span> <span class="nv">$admin</span><span class="p">,</span> <span class="s1">'normalize_urls'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1891"><a href="#L1891">1891</a></th><td>                        <span class="k">return</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1892"><a href="#L1892">1892</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1893"><a href="#L1893">1893</a></th><td>                <span class="nv">$feedURL</span>     <span class="o">=</span> <span class="nv">$admin</span><span class="o">-&gt;</span><span class="na">normalize_urls</span><span class="p">(</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">'feeds'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L1894"><a href="#L1894">1894</a></th><td>                <span class="nv">$source_type</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">'__jobID'</span><span class="p">],</span> <span class="s1">'__feedzy_source_type'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1895"><a href="#L1895">1895</a></th><td></td></tr><tr><th id="L1896"><a href="#L1896">1896</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="s1">'amazon'</span> <span class="o">===</span> <span class="nv">$source_type</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1897"><a href="#L1897">1897</a></th><td>                        <span class="nv">$feed</span> <span class="o">=</span> <span class="nv">$admin</span><span class="o">-&gt;</span><span class="na">init_amazon_api</span><span class="p">(</span></td></tr><tr><th id="L1898"><a href="#L1898">1898</a></th><td>                                <span class="nv">$feedURL</span><span class="p">,</span></td></tr><tr><th id="L1899"><a href="#L1899">1899</a></th><td>                                <span class="nb">isset</span><span class="p">(</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">'refresh'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">'refresh'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">'12_hours'</span><span class="p">,</span></td></tr><tr><th id="L1900"><a href="#L1900">1900</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1901"><a href="#L1901">1901</a></th><td>                                        <span class="s1">'number_of_item'</span> <span class="o">=&gt;</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">'max'</span><span class="p">],</span></td></tr><tr><th id="L1902"><a href="#L1902">1902</a></th><td>                                        <span class="s1">'no-cache'</span>       <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span></td></tr><tr><th id="L1903"><a href="#L1903">1903</a></th><td>                                <span class="p">)</span></td></tr><tr><th id="L1904"><a href="#L1904">1904</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L1905"><a href="#L1905">1905</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$feed</span><span class="o">-&gt;</span><span class="na">get_errors</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1906"><a href="#L1906">1906</a></th><td>                                <span class="k">return</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1907"><a href="#L1907">1907</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1908"><a href="#L1908">1908</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1909"><a href="#L1909">1909</a></th><td>                        <span class="nv">$feedURL</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_import_feed_url'</span><span class="p">,</span> <span class="nv">$feedURL</span><span class="p">,</span> <span class="nv">$import_content</span><span class="p">,</span> <span class="nv">$options</span> <span class="p">);</span></td></tr><tr><th id="L1910"><a href="#L1910">1910</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$feedURL</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1911"><a href="#L1911">1911</a></th><td>                                <span class="k">return</span> <span class="nv">$feedURL</span><span class="p">;</span></td></tr><tr><th id="L1912"><a href="#L1912">1912</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1913"><a href="#L1913">1913</a></th><td>                        <span class="nv">$feed</span> <span class="o">=</span> <span class="nv">$admin</span><span class="o">-&gt;</span><span class="na">fetch_feed</span><span class="p">(</span> <span class="nv">$feedURL</span><span class="p">,</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">'refresh'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">'refresh'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">'12_hours'</span><span class="p">,</span> <span class="nv">$options</span> <span class="p">);</span></td></tr><tr><th id="L1914"><a href="#L1914">1914</a></th><td></td></tr><tr><th id="L1915"><a href="#L1915">1915</a></th><td>                        <span class="nv">$feed</span><span class="o">-&gt;</span><span class="na">force_feed</span><span class="p">(</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L1916"><a href="#L1916">1916</a></th><td>                        <span class="nv">$feed</span><span class="o">-&gt;</span><span class="na">enable_order_by_date</span><span class="p">(</span> <span class="k">false</span> <span class="p">);</span></td></tr><tr><th id="L1917"><a href="#L1917">1917</a></th><td></td></tr><tr><th id="L1918"><a href="#L1918">1918</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nb">is_string</span><span class="p">(</span> <span class="nv">$feed</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1919"><a href="#L1919">1919</a></th><td>                                <span class="k">return</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1920"><a href="#L1920">1920</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1921"><a href="#L1921">1921</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1922"><a href="#L1922">1922</a></th><td>                <span class="nv">$sizes</span>      <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1923"><a href="#L1923">1923</a></th><td>                        <span class="s1">'width'</span>  <span class="o">=&gt;</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">'size'</span><span class="p">],</span></td></tr><tr><th id="L1924"><a href="#L1924">1924</a></th><td>                        <span class="s1">'height'</span> <span class="o">=&gt;</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">'size'</span><span class="p">],</span></td></tr><tr><th id="L1925"><a href="#L1925">1925</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L1926"><a href="#L1926">1926</a></th><td>                <span class="nv">$sizes</span>      <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_thumb_sizes'</span><span class="p">,</span> <span class="nv">$sizes</span><span class="p">,</span> <span class="nv">$feedURL</span> <span class="p">);</span></td></tr><tr><th id="L1927"><a href="#L1927">1927</a></th><td>                <span class="nv">$feed_items</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_get_feed_array'</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$options</span><span class="p">,</span> <span class="nv">$feed</span><span class="p">,</span> <span class="nv">$feedURL</span><span class="p">,</span> <span class="nv">$sizes</span> <span class="p">);</span></td></tr><tr><th id="L1928"><a href="#L1928">1928</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$raw_feed_also</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1929"><a href="#L1929">1929</a></th><td>                        <span class="k">return</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L1930"><a href="#L1930">1930</a></th><td>                                <span class="s1">'items'</span> <span class="o">=&gt;</span> <span class="nv">$feed_items</span><span class="p">,</span></td></tr><tr><th id="L1931"><a href="#L1931">1931</a></th><td>                                <span class="s1">'feed'</span>  <span class="o">=&gt;</span> <span class="nv">$feed</span><span class="p">,</span></td></tr><tr><th id="L1932"><a href="#L1932">1932</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L1933"><a href="#L1933">1933</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1934"><a href="#L1934">1934</a></th><td></td></tr><tr><th id="L1935"><a href="#L1935">1935</a></th><td>                <span class="k">return</span> <span class="nv">$feed_items</span><span class="p">;</span></td></tr><tr><th id="L1936"><a href="#L1936">1936</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L1937"><a href="#L1937">1937</a></th><td></td></tr><tr><th id="L1938"><a href="#L1938">1938</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L1939"><a href="#L1939">1939</a></th><td><span class="sd">         * Downloads and sets a post featured image if possible.</span></td></tr><tr><th id="L1940"><a href="#L1940">1940</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1941"><a href="#L1941">1941</a></th><td><span class="sd">         * @param string  $file The file URL.</span></td></tr><tr><th id="L1942"><a href="#L1942">1942</a></th><td><span class="sd">         * @param integer $post_id The post ID.</span></td></tr><tr><th id="L1943"><a href="#L1943">1943</a></th><td><span class="sd">         * @param string  $desc Description.</span></td></tr><tr><th id="L1944"><a href="#L1944">1944</a></th><td><span class="sd">         * @param array   $import_errors Array of import error messages.</span></td></tr><tr><th id="L1945"><a href="#L1945">1945</a></th><td><span class="sd">         * @param array   $import_info Array of import information messages.</span></td></tr><tr><th id="L1946"><a href="#L1946">1946</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L1947"><a href="#L1947">1947</a></th><td><span class="sd">         * @return bool</span></td></tr><tr><th id="L1948"><a href="#L1948">1948</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L1949"><a href="#L1949">1949</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L1950"><a href="#L1950">1950</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L1951"><a href="#L1951">1951</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">generate_featured_image</span><span class="p">(</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nv">$desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$import_errors</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$import_info</span><span class="p">,</span> <span class="nv">$post_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1952"><a href="#L1952">1952</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">function_exists</span><span class="p">(</span> <span class="s1">'post_exists'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1953"><a href="#L1953">1953</a></th><td>                        <span class="k">require_once</span> <span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">'wp-admin/includes/post.php'</span><span class="p">;</span></td></tr><tr><th id="L1954"><a href="#L1954">1954</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L1955"><a href="#L1955">1955</a></th><td>                <span class="c1">// Find existing attachment by item title.</span></td></tr><tr><th id="L1956"><a href="#L1956">1956</a></th><td><span class="c1"></span>                <span class="nv">$id</span> <span class="o">=</span> <span class="nx">post_exists</span><span class="p">(</span> <span class="nv">$desc</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">'attachment'</span> <span class="p">);</span></td></tr><tr><th id="L1957"><a href="#L1957">1957</a></th><td></td></tr><tr><th id="L1958"><a href="#L1958">1958</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1959"><a href="#L1959">1959</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Trying to generate featured image for %s and postID %d'</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="p">),</span> <span class="s1">'debug'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1960"><a href="#L1960">1960</a></th><td></td></tr><tr><th id="L1961"><a href="#L1961">1961</a></th><td>                        <span class="k">require_once</span> <span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">'wp-admin'</span> <span class="o">.</span> <span class="s1">'/includes/image.php'</span><span class="p">;</span></td></tr><tr><th id="L1962"><a href="#L1962">1962</a></th><td>                        <span class="k">require_once</span> <span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">'wp-admin'</span> <span class="o">.</span> <span class="s1">'/includes/file.php'</span><span class="p">;</span></td></tr><tr><th id="L1963"><a href="#L1963">1963</a></th><td>                        <span class="k">require_once</span> <span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">'wp-admin'</span> <span class="o">.</span> <span class="s1">'/includes/media.php'</span><span class="p">;</span></td></tr><tr><th id="L1964"><a href="#L1964">1964</a></th><td></td></tr><tr><th id="L1965"><a href="#L1965">1965</a></th><td>                        <span class="nv">$file_array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L1966"><a href="#L1966">1966</a></th><td>                        <span class="nv">$file</span>       <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$file</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span> <span class="mh">0xC2</span> <span class="p">)</span> <span class="o">.</span> <span class="nb">chr</span><span class="p">(</span> <span class="mh">0xA0</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L1967"><a href="#L1967">1967</a></th><td>                        <span class="nv">$local_file</span> <span class="o">=</span> <span class="nx">download_url</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">);</span></td></tr><tr><th id="L1968"><a href="#L1968">1968</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$local_file</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1969"><a href="#L1969">1969</a></th><td>                                <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Unable to download file = %s and postID %d'</span><span class="p">,</span> <span class="nb">print_r</span><span class="p">(</span> <span class="nv">$local_file</span><span class="p">,</span> <span class="k">true</span> <span class="p">),</span> <span class="nv">$post_id</span> <span class="p">),</span> <span class="s1">'error'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1970"><a href="#L1970">1970</a></th><td></td></tr><tr><th id="L1971"><a href="#L1971">1971</a></th><td>                                <span class="k">return</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L1972"><a href="#L1972">1972</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1973"><a href="#L1973">1973</a></th><td></td></tr><tr><th id="L1974"><a href="#L1974">1974</a></th><td>                        <span class="nv">$type</span> <span class="o">=</span> <span class="nb">mime_content_type</span><span class="p">(</span> <span class="nv">$local_file</span> <span class="p">);</span></td></tr><tr><th id="L1975"><a href="#L1975">1975</a></th><td>                        <span class="c1">// the file is downloaded with a .tmp extension</span></td></tr><tr><th id="L1976"><a href="#L1976">1976</a></th><td><span class="c1"></span>                        <span class="c1">// if the URL mentions the extension of the file, the upload succeeds</span></td></tr><tr><th id="L1977"><a href="#L1977">1977</a></th><td><span class="c1"></span>                        <span class="c1">// but if the URL is like https://source.unsplash.com/random, then the upload fails</span></td></tr><tr><th id="L1978"><a href="#L1978">1978</a></th><td><span class="c1"></span>                        <span class="c1">// so let's determine the file's mime type and then rename the .tmp file with that extension</span></td></tr><tr><th id="L1979"><a href="#L1979">1979</a></th><td><span class="c1"></span>                        <span class="k">if</span> <span class="p">(</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$type</span><span class="p">,</span> <span class="nb">array_values</span><span class="p">(</span> <span class="nx">get_allowed_mime_types</span><span class="p">()</span> <span class="p">),</span> <span class="k">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1980"><a href="#L1980">1980</a></th><td>                                <span class="nv">$new_local_file</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'.tmp'</span><span class="p">,</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">'image/'</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="nv">$type</span> <span class="p">),</span> <span class="nv">$local_file</span> <span class="p">);</span></td></tr><tr><th id="L1981"><a href="#L1981">1981</a></th><td>                                <span class="nv">$renamed</span>        <span class="o">=</span> <span class="nb">rename</span><span class="p">(</span> <span class="nv">$local_file</span><span class="p">,</span> <span class="nv">$new_local_file</span> <span class="p">);</span></td></tr><tr><th id="L1982"><a href="#L1982">1982</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nv">$renamed</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1983"><a href="#L1983">1983</a></th><td>                                        <span class="nv">$local_file</span> <span class="o">=</span> <span class="nv">$new_local_file</span><span class="p">;</span></td></tr><tr><th id="L1984"><a href="#L1984">1984</a></th><td>                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L1985"><a href="#L1985">1985</a></th><td>                                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Unable to rename file for postID %d'</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="p">),</span> <span class="s1">'error'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1986"><a href="#L1986">1986</a></th><td></td></tr><tr><th id="L1987"><a href="#L1987">1987</a></th><td>                                        <span class="k">return</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L1988"><a href="#L1988">1988</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L1989"><a href="#L1989">1989</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L1990"><a href="#L1990">1990</a></th><td></td></tr><tr><th id="L1991"><a href="#L1991">1991</a></th><td>                        <span class="nv">$file_array</span><span class="p">[</span><span class="s1">'tmp_name'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$local_file</span><span class="p">;</span></td></tr><tr><th id="L1992"><a href="#L1992">1992</a></th><td>                        <span class="nv">$file_array</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span>     <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span> <span class="nv">$local_file</span> <span class="p">);</span></td></tr><tr><th id="L1993"><a href="#L1993">1993</a></th><td></td></tr><tr><th id="L1994"><a href="#L1994">1994</a></th><td>                        <span class="nv">$id</span> <span class="o">=</span> <span class="nx">media_handle_sideload</span><span class="p">(</span> <span class="nv">$file_array</span><span class="p">,</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nv">$desc</span><span class="p">,</span> <span class="nv">$post_data</span> <span class="p">);</span></td></tr><tr><th id="L1995"><a href="#L1995">1995</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L1996"><a href="#L1996">1996</a></th><td>                                <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Unable to attach file for postID %d = %s'</span><span class="p">,</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nb">print_r</span><span class="p">(</span> <span class="nv">$id</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">),</span> <span class="s1">'error'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L1997"><a href="#L1997">1997</a></th><td>                                <span class="nb">unlink</span><span class="p">(</span> <span class="nv">$file_array</span><span class="p">[</span><span class="s1">'tmp_name'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L1998"><a href="#L1998">1998</a></th><td></td></tr><tr><th id="L1999"><a href="#L1999">1999</a></th><td>                                <span class="k">return</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L2000"><a href="#L2000">2000</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2001"><a href="#L2001">2001</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L2002"><a href="#L2002">2002</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Found an existing attachment(ID: %d) image for %s and postID %d'</span><span class="p">,</span> <span class="nv">$id</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="p">),</span> <span class="s1">'debug'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L2003"><a href="#L2003">2003</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2004"><a href="#L2004">2004</a></th><td></td></tr><tr><th id="L2005"><a href="#L2005">2005</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$post_data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2006"><a href="#L2006">2006</a></th><td>                        <span class="k">return</span> <span class="nv">$id</span><span class="p">;</span></td></tr><tr><th id="L2007"><a href="#L2007">2007</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2008"><a href="#L2008">2008</a></th><td></td></tr><tr><th id="L2009"><a href="#L2009">2009</a></th><td>                <span class="nv">$success</span> <span class="o">=</span> <span class="nx">set_post_thumbnail</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="nv">$id</span> <span class="p">);</span></td></tr><tr><th id="L2010"><a href="#L2010">2010</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">false</span> <span class="o">===</span> <span class="nv">$success</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2011"><a href="#L2011">2011</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Unable to attach file for postID %d for no apparent reason'</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="p">),</span> <span class="s1">'error'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L2012"><a href="#L2012">2012</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L2013"><a href="#L2013">2013</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'themeisle_log_event'</span><span class="p">,</span> <span class="nx">FEEDZY_NAME</span><span class="p">,</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'Attached file as featured image for postID %d'</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="p">),</span> <span class="s1">'info'</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="k">__LINE__</span> <span class="p">);</span></td></tr><tr><th id="L2014"><a href="#L2014">2014</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2015"><a href="#L2015">2015</a></th><td></td></tr><tr><th id="L2016"><a href="#L2016">2016</a></th><td>                <span class="k">return</span> <span class="nv">$success</span><span class="p">;</span></td></tr><tr><th id="L2017"><a href="#L2017">2017</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2018"><a href="#L2018">2018</a></th><td></td></tr><tr><th id="L2019"><a href="#L2019">2019</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2020"><a href="#L2020">2020</a></th><td><span class="sd">         * Registers a cron schedule.</span></td></tr><tr><th id="L2021"><a href="#L2021">2021</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2022"><a href="#L2022">2022</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L2023"><a href="#L2023">2023</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2024"><a href="#L2024">2024</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2025"><a href="#L2025">2025</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">add_cron</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2026"><a href="#L2026">2026</a></th><td>                <span class="nv">$time</span>     <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'fz_cron_execution'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_cron_execution</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'fz_cron_execution'</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="nb">time</span><span class="p">();</span></td></tr><tr><th id="L2027"><a href="#L2027">2027</a></th><td>                <span class="nv">$schedule</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'fz_cron_schedule'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'fz_cron_schedule'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">'hourly'</span><span class="p">;</span></td></tr><tr><th id="L2028"><a href="#L2028">2028</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'nonce'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'tab'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nx">wp_verify_nonce</span><span class="p">(</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'nonce'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">),</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'tab'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2029"><a href="#L2029">2029</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'fz_cron_execution'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'fz_cron_schedule'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'fz_execution_offset'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2030"><a href="#L2030">2030</a></th><td>                                <span class="nv">$execution</span> <span class="o">=</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'fz_cron_execution'</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2031"><a href="#L2031">2031</a></th><td>                                <span class="nv">$offset</span>    <span class="o">=</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'fz_execution_offset'</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2032"><a href="#L2032">2032</a></th><td>                                <span class="nv">$time</span>      <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_cron_execution</span><span class="p">(</span> <span class="nv">$execution</span><span class="p">,</span> <span class="nv">$offset</span> <span class="p">);</span></td></tr><tr><th id="L2033"><a href="#L2033">2033</a></th><td>                                <span class="nv">$schedule</span>  <span class="o">=</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'fz_cron_schedule'</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2034"><a href="#L2034">2034</a></th><td>                                <span class="nx">wp_clear_scheduled_hook</span><span class="p">(</span> <span class="s1">'feedzy_cron'</span> <span class="p">);</span></td></tr><tr><th id="L2035"><a href="#L2035">2035</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2036"><a href="#L2036">2036</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2037"><a href="#L2037">2037</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">false</span> <span class="o">===</span> <span class="nx">wp_next_scheduled</span><span class="p">(</span> <span class="s1">'feedzy_cron'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2038"><a href="#L2038">2038</a></th><td>                        <span class="nx">wp_schedule_event</span><span class="p">(</span> <span class="nv">$time</span><span class="p">,</span> <span class="nv">$schedule</span><span class="p">,</span> <span class="s1">'feedzy_cron'</span> <span class="p">);</span></td></tr><tr><th id="L2039"><a href="#L2039">2039</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2040"><a href="#L2040">2040</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2041"><a href="#L2041">2041</a></th><td></td></tr><tr><th id="L2042"><a href="#L2042">2042</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2043"><a href="#L2043">2043</a></th><td><span class="sd">         * Get cron job execution.</span></td></tr><tr><th id="L2044"><a href="#L2044">2044</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2045"><a href="#L2045">2045</a></th><td><span class="sd">         * @param string $execution Execution time.</span></td></tr><tr><th id="L2046"><a href="#L2046">2046</a></th><td><span class="sd">         * @param int    $offset Offset.</span></td></tr><tr><th id="L2047"><a href="#L2047">2047</a></th><td><span class="sd">         * @return int</span></td></tr><tr><th id="L2048"><a href="#L2048">2048</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2049"><a href="#L2049">2049</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">get_cron_execution</span><span class="p">(</span> <span class="nv">$execution</span><span class="p">,</span> <span class="nv">$offset</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2050"><a href="#L2050">2050</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$offset</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'fz_execution_offset'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2051"><a href="#L2051">2051</a></th><td>                        <span class="nv">$offset</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'fz_execution_offset'</span><span class="p">];</span></td></tr><tr><th id="L2052"><a href="#L2052">2052</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2053"><a href="#L2053">2053</a></th><td>                <span class="nv">$execution</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span> <span class="nv">$execution</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">strtotime</span><span class="p">(</span> <span class="nv">$execution</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">HOUR_IN_SECONDS</span> <span class="o">*</span> <span class="nv">$offset</span> <span class="p">)</span> <span class="o">:</span> <span class="nb">time</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">HOUR_IN_SECONDS</span> <span class="o">*</span> <span class="nv">$offset</span> <span class="p">);</span></td></tr><tr><th id="L2054"><a href="#L2054">2054</a></th><td>                <span class="k">return</span> <span class="nv">$execution</span><span class="p">;</span></td></tr><tr><th id="L2055"><a href="#L2055">2055</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2056"><a href="#L2056">2056</a></th><td></td></tr><tr><th id="L2057"><a href="#L2057">2057</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2058"><a href="#L2058">2058</a></th><td><span class="sd">         * Checks if WP Cron is enabled and if not, shows a notice.</span></td></tr><tr><th id="L2059"><a href="#L2059">2059</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2060"><a href="#L2060">2060</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2061"><a href="#L2061">2061</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2062"><a href="#L2062">2062</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">admin_notices</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2063"><a href="#L2063">2063</a></th><td>                <span class="nv">$screen</span>  <span class="o">=</span> <span class="nx">get_current_screen</span><span class="p">();</span></td></tr><tr><th id="L2064"><a href="#L2064">2064</a></th><td>                <span class="nv">$allowed</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'edit-feedzy_categories'</span><span class="p">,</span> <span class="s1">'edit-feedzy_imports'</span><span class="p">,</span> <span class="s1">'feedzy-rss_page_feedzy-settings'</span> <span class="p">);</span></td></tr><tr><th id="L2065"><a href="#L2065">2065</a></th><td>                <span class="c1">// only show in the feedzy screens.</span></td></tr><tr><th id="L2066"><a href="#L2066">2066</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$screen</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">,</span> <span class="nv">$allowed</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2067"><a href="#L2067">2067</a></th><td>                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L2068"><a href="#L2068">2068</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2069"><a href="#L2069">2069</a></th><td></td></tr><tr><th id="L2070"><a href="#L2070">2070</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">defined</span><span class="p">(</span> <span class="s1">'DISABLE_WP_CRON'</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">DISABLE_WP_CRON</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2071"><a href="#L2071">2071</a></th><td>                        <span class="k">echo</span> <span class="nx">wp_kses_post</span><span class="p">(</span> <span class="s1">'&lt;div class="notice notice-error feedzy-error-critical is-dismissible"&gt;&lt;p&gt;'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'WP Cron is disabled. Your feeds would not get updated. Please contact your hosting provider or system administrator'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;/p&gt;&lt;/div&gt;'</span> <span class="p">);</span></td></tr><tr><th id="L2072"><a href="#L2072">2072</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2073"><a href="#L2073">2073</a></th><td></td></tr><tr><th id="L2074"><a href="#L2074">2074</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">false</span> <span class="o">===</span> <span class="nx">wp_next_scheduled</span><span class="p">(</span> <span class="s1">'feedzy_cron'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2075"><a href="#L2075">2075</a></th><td>                        <span class="k">echo</span> <span class="nx">wp_kses_post</span><span class="p">(</span> <span class="s1">'&lt;div class="notice notice-error"&gt;&lt;p&gt;'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Unable to register cron job. Your feeds might not get updated'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'&lt;/p&gt;&lt;/div&gt;'</span> <span class="p">);</span></td></tr><tr><th id="L2076"><a href="#L2076">2076</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2077"><a href="#L2077">2077</a></th><td></td></tr><tr><th id="L2078"><a href="#L2078">2078</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2079"><a href="#L2079">2079</a></th><td></td></tr><tr><th id="L2080"><a href="#L2080">2080</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2081"><a href="#L2081">2081</a></th><td><span class="sd">         * Method to return license status.</span></td></tr><tr><th id="L2082"><a href="#L2082">2082</a></th><td><span class="sd">         * Used to filter PRO version types.</span></td></tr><tr><th id="L2083"><a href="#L2083">2083</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2084"><a href="#L2084">2084</a></th><td><span class="sd">         * @return bool</span></td></tr><tr><th id="L2085"><a href="#L2085">2085</a></th><td><span class="sd">         * @since   1.2.0</span></td></tr><tr><th id="L2086"><a href="#L2086">2086</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2087"><a href="#L2087">2087</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2088"><a href="#L2088">2088</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_is_business</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2089"><a href="#L2089">2089</a></th><td>                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_license_of_type</span><span class="p">(</span> <span class="k">false</span><span class="p">,</span> <span class="s1">'business'</span> <span class="p">);</span></td></tr><tr><th id="L2090"><a href="#L2090">2090</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2091"><a href="#L2091">2091</a></th><td></td></tr><tr><th id="L2092"><a href="#L2092">2092</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2093"><a href="#L2093">2093</a></th><td><span class="sd">         * Method to return if licence is agency.</span></td></tr><tr><th id="L2094"><a href="#L2094">2094</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2095"><a href="#L2095">2095</a></th><td><span class="sd">         * @return bool</span></td></tr><tr><th id="L2096"><a href="#L2096">2096</a></th><td><span class="sd">         * @since   1.3.2</span></td></tr><tr><th id="L2097"><a href="#L2097">2097</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2098"><a href="#L2098">2098</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2099"><a href="#L2099">2099</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_is_agency</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2100"><a href="#L2100">2100</a></th><td>                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_license_of_type</span><span class="p">(</span> <span class="k">false</span><span class="p">,</span> <span class="s1">'agency'</span> <span class="p">);</span></td></tr><tr><th id="L2101"><a href="#L2101">2101</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2102"><a href="#L2102">2102</a></th><td></td></tr><tr><th id="L2103"><a href="#L2103">2103</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2104"><a href="#L2104">2104</a></th><td><span class="sd">         * Method to return if licence is personal.</span></td></tr><tr><th id="L2105"><a href="#L2105">2105</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2106"><a href="#L2106">2106</a></th><td><span class="sd">         * @return bool</span></td></tr><tr><th id="L2107"><a href="#L2107">2107</a></th><td><span class="sd">         * @since   1.8.2</span></td></tr><tr><th id="L2108"><a href="#L2108">2108</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2109"><a href="#L2109">2109</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2110"><a href="#L2110">2110</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_is_personal</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2111"><a href="#L2111">2111</a></th><td>                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_license_of_type</span><span class="p">(</span> <span class="k">false</span><span class="p">,</span> <span class="s1">'pro'</span> <span class="p">);</span></td></tr><tr><th id="L2112"><a href="#L2112">2112</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2113"><a href="#L2113">2113</a></th><td></td></tr><tr><th id="L2114"><a href="#L2114">2114</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2115"><a href="#L2115">2115</a></th><td><span class="sd">         * Method to return the type of licence.</span></td></tr><tr><th id="L2116"><a href="#L2116">2116</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2117"><a href="#L2117">2117</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2118"><a href="#L2118">2118</a></th><td><span class="sd">         * @return bool</span></td></tr><tr><th id="L2119"><a href="#L2119">2119</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2120"><a href="#L2120">2120</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_is_license_of_type</span><span class="p">(</span> <span class="nv">$default</span><span class="p">,</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2121"><a href="#L2121">2121</a></th><td>                <span class="c1">// proceed to check the plan only if the license is active.</span></td></tr><tr><th id="L2122"><a href="#L2122">2122</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="p">(</span> <span class="nb">defined</span><span class="p">(</span> <span class="s1">'TI_UNIT_TESTING'</span> <span class="p">)</span> <span class="o">||</span> <span class="nb">defined</span><span class="p">(</span> <span class="s1">'TI_CYPRESS_TESTING'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2123"><a href="#L2123">2123</a></th><td>                        <span class="nv">$status</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_rss_feeds_pro_license_status'</span><span class="p">,</span> <span class="k">false</span> <span class="p">);</span></td></tr><tr><th id="L2124"><a href="#L2124">2124</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$status</span> <span class="o">!==</span> <span class="s1">'valid'</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2125"><a href="#L2125">2125</a></th><td>                                <span class="k">return</span> <span class="nv">$default</span><span class="p">;</span></td></tr><tr><th id="L2126"><a href="#L2126">2126</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2127"><a href="#L2127">2127</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2128"><a href="#L2128">2128</a></th><td>                <span class="nv">$plan</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'product_feedzy_license_plan'</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span></td></tr><tr><th id="L2129"><a href="#L2129">2129</a></th><td>                <span class="nv">$plan</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span> <span class="nv">$plan</span> <span class="p">);</span></td></tr><tr><th id="L2130"><a href="#L2130">2130</a></th><td>                <span class="k">switch</span> <span class="p">(</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2131"><a href="#L2131">2131</a></th><td>                        <span class="k">case</span> <span class="s1">'agency'</span><span class="o">:</span></td></tr><tr><th id="L2132"><a href="#L2132">2132</a></th><td>                                <span class="k">return</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$plan</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span> <span class="p">),</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L2133"><a href="#L2133">2133</a></th><td>                        <span class="k">case</span> <span class="s1">'business'</span><span class="o">:</span></td></tr><tr><th id="L2134"><a href="#L2134">2134</a></th><td>                                <span class="k">return</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$plan</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span> <span class="p">),</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L2135"><a href="#L2135">2135</a></th><td>                        <span class="k">case</span> <span class="s1">'pro'</span><span class="o">:</span></td></tr><tr><th id="L2136"><a href="#L2136">2136</a></th><td>                                <span class="k">return</span> <span class="p">(</span> <span class="nv">$plan</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">);</span></td></tr><tr><th id="L2137"><a href="#L2137">2137</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2138"><a href="#L2138">2138</a></th><td></td></tr><tr><th id="L2139"><a href="#L2139">2139</a></th><td>                <span class="k">return</span> <span class="nv">$default</span><span class="p">;</span></td></tr><tr><th id="L2140"><a href="#L2140">2140</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2141"><a href="#L2141">2141</a></th><td></td></tr><tr><th id="L2142"><a href="#L2142">2142</a></th><td></td></tr><tr><th id="L2143"><a href="#L2143">2143</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2144"><a href="#L2144">2144</a></th><td><span class="sd">         * Method for updating settings page via AJAX.</span></td></tr><tr><th id="L2145"><a href="#L2145">2145</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2146"><a href="#L2146">2146</a></th><td><span class="sd">         * @since   1.3.2</span></td></tr><tr><th id="L2147"><a href="#L2147">2147</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2148"><a href="#L2148">2148</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2149"><a href="#L2149">2149</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">update_settings_page</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2150"><a href="#L2150">2150</a></th><td>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">save_settings</span><span class="p">();</span></td></tr><tr><th id="L2151"><a href="#L2151">2151</a></th><td>                <span class="nx">wp_die</span><span class="p">();</span></td></tr><tr><th id="L2152"><a href="#L2152">2152</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2153"><a href="#L2153">2153</a></th><td></td></tr><tr><th id="L2154"><a href="#L2154">2154</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2155"><a href="#L2155">2155</a></th><td><span class="sd">         * Display settings fields for the tab.</span></td></tr><tr><th id="L2156"><a href="#L2156">2156</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2157"><a href="#L2157">2157</a></th><td><span class="sd">         * @since   1.3.2</span></td></tr><tr><th id="L2158"><a href="#L2158">2158</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2159"><a href="#L2159">2159</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2160"><a href="#L2160">2160</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">display_tab_settings</span><span class="p">(</span> <span class="nv">$fields</span><span class="p">,</span> <span class="nv">$tab</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2161"><a href="#L2161">2161</a></th><td>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">free_settings</span> <span class="o">=</span> <span class="nx">get_option</span><span class="p">(</span> <span class="s1">'feedzy-settings'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span></td></tr><tr><th id="L2162"><a href="#L2162">2162</a></th><td></td></tr><tr><th id="L2163"><a href="#L2163">2163</a></th><td>                <span class="nv">$fields</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2164"><a href="#L2164">2164</a></th><td>                        <span class="s1">'content'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render_view</span><span class="p">(</span> <span class="nv">$tab</span> <span class="p">),</span></td></tr><tr><th id="L2165"><a href="#L2165">2165</a></th><td>                        <span class="s1">'ajax'</span>    <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span></td></tr><tr><th id="L2166"><a href="#L2166">2166</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L2167"><a href="#L2167">2167</a></th><td></td></tr><tr><th id="L2168"><a href="#L2168">2168</a></th><td>                <span class="k">return</span> <span class="nv">$fields</span><span class="p">;</span></td></tr><tr><th id="L2169"><a href="#L2169">2169</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2170"><a href="#L2170">2170</a></th><td></td></tr><tr><th id="L2171"><a href="#L2171">2171</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2172"><a href="#L2172">2172</a></th><td><span class="sd">         * Method to save settings.</span></td></tr><tr><th id="L2173"><a href="#L2173">2173</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2174"><a href="#L2174">2174</a></th><td><span class="sd">         * @since   1.3.2</span></td></tr><tr><th id="L2175"><a href="#L2175">2175</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L2176"><a href="#L2176">2176</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2177"><a href="#L2177">2177</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">save_settings</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2178"><a href="#L2178">2178</a></th><td>                <span class="nx">update_option</span><span class="p">(</span> <span class="s1">'feedzy-rss-feeds-settings'</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">settings</span> <span class="p">);</span></td></tr><tr><th id="L2179"><a href="#L2179">2179</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2180"><a href="#L2180">2180</a></th><td></td></tr><tr><th id="L2181"><a href="#L2181">2181</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2182"><a href="#L2182">2182</a></th><td><span class="sd">         * Add settings tab.</span></td></tr><tr><th id="L2183"><a href="#L2183">2183</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2184"><a href="#L2184">2184</a></th><td><span class="sd">         * @since   1.3.2</span></td></tr><tr><th id="L2185"><a href="#L2185">2185</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2186"><a href="#L2186">2186</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2187"><a href="#L2187">2187</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">settings_tabs</span><span class="p">(</span> <span class="nv">$tabs</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2188"><a href="#L2188">2188</a></th><td>                <span class="nv">$tabs</span><span class="p">[</span><span class="s1">'misc'</span><span class="p">]</span>   <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Miscellaneous'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2189"><a href="#L2189">2189</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_business</span><span class="p">()</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_agency</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2190"><a href="#L2190">2190</a></th><td>                        <span class="nv">$tabs</span><span class="p">[</span><span class="s1">'openai'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'OpenAI'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2191"><a href="#L2191">2191</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2192"><a href="#L2192">2192</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2193"><a href="#L2193">2193</a></th><td>                        <span class="nv">$tabs</span><span class="p">[</span><span class="s1">'wordai'</span><span class="p">]</span>       <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'%s &lt;span class="pro-label"&gt;PRO&lt;/span&gt;'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'WordAi'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2194"><a href="#L2194">2194</a></th><td>                        <span class="nv">$tabs</span><span class="p">[</span><span class="s1">'spinnerchief'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'%s &lt;span class="pro-label"&gt;PRO&lt;/span&gt;'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'SpinnerChief'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2195"><a href="#L2195">2195</a></th><td>                        <span class="nv">$tabs</span><span class="p">[</span><span class="s1">'amazon-product-advertising'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'%s &lt;span class="pro-label"&gt;PRO&lt;/span&gt;'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Amazon Product Advertising'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2196"><a href="#L2196">2196</a></th><td>                        <span class="nv">$tabs</span><span class="p">[</span><span class="s1">'openai'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'%s &lt;span class="pro-label"&gt;PRO&lt;/span&gt;'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'OpenAI'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2197"><a href="#L2197">2197</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2198"><a href="#L2198">2198</a></th><td></td></tr><tr><th id="L2199"><a href="#L2199">2199</a></th><td>                <span class="k">return</span> <span class="nv">$tabs</span><span class="p">;</span></td></tr><tr><th id="L2200"><a href="#L2200">2200</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2201"><a href="#L2201">2201</a></th><td></td></tr><tr><th id="L2202"><a href="#L2202">2202</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2203"><a href="#L2203">2203</a></th><td><span class="sd">         * Save settings for the tab.</span></td></tr><tr><th id="L2204"><a href="#L2204">2204</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2205"><a href="#L2205">2205</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2206"><a href="#L2206">2206</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2207"><a href="#L2207">2207</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">save_tab_settings</span><span class="p">(</span> <span class="nv">$settings</span><span class="p">,</span> <span class="nv">$tab</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2208"><a href="#L2208">2208</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'nonce'</span><span class="p">]</span> <span class="p">)</span> <span class="o">||</span> <span class="o">!</span> <span class="nx">wp_verify_nonce</span><span class="p">(</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'nonce'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">),</span> <span class="nv">$tab</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2209"><a href="#L2209">2209</a></th><td>                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L2210"><a href="#L2210">2210</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2211"><a href="#L2211">2211</a></th><td></td></tr><tr><th id="L2212"><a href="#L2212">2212</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="s1">'misc'</span> <span class="o">===</span> <span class="nv">$tab</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2213"><a href="#L2213">2213</a></th><td>                        <span class="nv">$settings</span><span class="p">[</span><span class="s1">'canonical'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'canonical'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'canonical'</span><span class="p">,</span> <span class="nx">FILTER_SANITIZE_NUMBER_INT</span> <span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span></td></tr><tr><th id="L2214"><a href="#L2214">2214</a></th><td>                        <span class="nv">$settings</span><span class="p">[</span><span class="s1">'general'</span><span class="p">][</span><span class="s1">'rss-feeds'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'rss-feeds'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'rss-feeds'</span><span class="p">,</span> <span class="nx">FILTER_SANITIZE_NUMBER_INT</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L2215"><a href="#L2215">2215</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2216"><a href="#L2216">2216</a></th><td></td></tr><tr><th id="L2217"><a href="#L2217">2217</a></th><td>                <span class="k">return</span> <span class="nv">$settings</span><span class="p">;</span></td></tr><tr><th id="L2218"><a href="#L2218">2218</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2219"><a href="#L2219">2219</a></th><td></td></tr><tr><th id="L2220"><a href="#L2220">2220</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2221"><a href="#L2221">2221</a></th><td><span class="sd">         * Render a view page.</span></td></tr><tr><th id="L2222"><a href="#L2222">2222</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2223"><a href="#L2223">2223</a></th><td><span class="sd">         * @param string $name The name of the view.</span></td></tr><tr><th id="L2224"><a href="#L2224">2224</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2225"><a href="#L2225">2225</a></th><td><span class="sd">         * @return string</span></td></tr><tr><th id="L2226"><a href="#L2226">2226</a></th><td><span class="sd">         * @since   1.3.2</span></td></tr><tr><th id="L2227"><a href="#L2227">2227</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2228"><a href="#L2228">2228</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2229"><a href="#L2229">2229</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">render_view</span><span class="p">(</span> <span class="nv">$name</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2230"><a href="#L2230">2230</a></th><td>                <span class="nv">$file</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></td></tr><tr><th id="L2231"><a href="#L2231">2231</a></th><td>                <span class="k">switch</span> <span class="p">(</span> <span class="nv">$name</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2232"><a href="#L2232">2232</a></th><td>                        <span class="k">case</span> <span class="s1">'misc'</span><span class="o">:</span></td></tr><tr><th id="L2233"><a href="#L2233">2233</a></th><td>                                <span class="nv">$file</span> <span class="o">=</span> <span class="nx">FEEDZY_ABSPATH</span> <span class="o">.</span> <span class="s1">'/includes/views/'</span> <span class="o">.</span> <span class="nv">$name</span> <span class="o">.</span> <span class="s1">'-view.php'</span><span class="p">;</span></td></tr><tr><th id="L2234"><a href="#L2234">2234</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L2235"><a href="#L2235">2235</a></th><td>                        <span class="k">case</span> <span class="s1">'wordai'</span><span class="o">:</span></td></tr><tr><th id="L2236"><a href="#L2236">2236</a></th><td>                        <span class="k">case</span> <span class="s1">'spinnerchief'</span><span class="o">:</span></td></tr><tr><th id="L2237"><a href="#L2237">2237</a></th><td>                        <span class="k">case</span> <span class="s1">'amazon-product-advertising'</span><span class="o">:</span></td></tr><tr><th id="L2238"><a href="#L2238">2238</a></th><td>                        <span class="k">case</span> <span class="s1">'openai'</span><span class="o">:</span></td></tr><tr><th id="L2239"><a href="#L2239">2239</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2240"><a href="#L2240">2240</a></th><td>                                        <span class="nv">$file</span> <span class="o">=</span> <span class="nx">FEEDZY_ABSPATH</span> <span class="o">.</span> <span class="s1">'/includes/views/'</span> <span class="o">.</span> <span class="nv">$name</span> <span class="o">.</span> <span class="s1">'-view.php'</span><span class="p">;</span></td></tr><tr><th id="L2241"><a href="#L2241">2241</a></th><td>                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L2242"><a href="#L2242">2242</a></th><td>                                        <span class="nv">$file</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_render_view'</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$name</span> <span class="p">);</span></td></tr><tr><th id="L2243"><a href="#L2243">2243</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L2244"><a href="#L2244">2244</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L2245"><a href="#L2245">2245</a></th><td>                        <span class="k">default</span><span class="o">:</span></td></tr><tr><th id="L2246"><a href="#L2246">2246</a></th><td>                                <span class="nv">$file</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">'feedzy_render_view'</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$name</span> <span class="p">);</span></td></tr><tr><th id="L2247"><a href="#L2247">2247</a></th><td>                                <span class="k">break</span><span class="p">;</span></td></tr><tr><th id="L2248"><a href="#L2248">2248</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2249"><a href="#L2249">2249</a></th><td></td></tr><tr><th id="L2250"><a href="#L2250">2250</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$file</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2251"><a href="#L2251">2251</a></th><td>                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L2252"><a href="#L2252">2252</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2253"><a href="#L2253">2253</a></th><td></td></tr><tr><th id="L2254"><a href="#L2254">2254</a></th><td>                <span class="nb">ob_start</span><span class="p">();</span></td></tr><tr><th id="L2255"><a href="#L2255">2255</a></th><td>                <span class="k">include</span> <span class="nv">$file</span><span class="p">;</span></td></tr><tr><th id="L2256"><a href="#L2256">2256</a></th><td></td></tr><tr><th id="L2257"><a href="#L2257">2257</a></th><td>                <span class="k">return</span> <span class="nb">ob_get_clean</span><span class="p">();</span></td></tr><tr><th id="L2258"><a href="#L2258">2258</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2259"><a href="#L2259">2259</a></th><td></td></tr><tr><th id="L2260"><a href="#L2260">2260</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2261"><a href="#L2261">2261</a></th><td><span class="sd">         * Renders the HTML for the tags.</span></td></tr><tr><th id="L2262"><a href="#L2262">2262</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2263"><a href="#L2263">2263</a></th><td><span class="sd">         * @since   1.4.2</span></td></tr><tr><th id="L2264"><a href="#L2264">2264</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2265"><a href="#L2265">2265</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2266"><a href="#L2266">2266</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">render_magic_tags</span><span class="p">(</span> <span class="nv">$default</span><span class="p">,</span> <span class="nv">$tags</span><span class="p">,</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2267"><a href="#L2267">2267</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$tags</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2268"><a href="#L2268">2268</a></th><td>                        <span class="nv">$disabled</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L2269"><a href="#L2269">2269</a></th><td>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$tags</span> <span class="k">as</span> <span class="nv">$tag</span> <span class="o">=&gt;</span> <span class="nv">$label</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2270"><a href="#L2270">2270</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span> <span class="nv">$tag</span><span class="p">,</span> <span class="s1">':disabled'</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2271"><a href="#L2271">2271</a></th><td>                                        <span class="nv">$disabled</span><span class="p">[</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">':disabled'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="nv">$tag</span> <span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$label</span><span class="p">;</span></td></tr><tr><th id="L2272"><a href="#L2272">2272</a></th><td>                                        <span class="k">continue</span><span class="p">;</span></td></tr><tr><th id="L2273"><a href="#L2273">2273</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L2274"><a href="#L2274">2274</a></th><td>                                <span class="k">if</span> <span class="p">(</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$type</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'import_post_content'</span><span class="p">,</span> <span class="s1">'import_post_featured_img'</span> <span class="p">),</span> <span class="k">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2275"><a href="#L2275">2275</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$tag</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'item_content'</span><span class="p">,</span> <span class="s1">'item_description'</span><span class="p">,</span> <span class="s1">'item_full_content'</span><span class="p">,</span> <span class="s1">'item_categories'</span><span class="p">,</span> <span class="s1">'item_image'</span> <span class="p">),</span> <span class="k">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2276"><a href="#L2276">2276</a></th><td>                                                <span class="nv">$default</span> <span class="o">.=</span> <span class="s1">'&lt;a class="dropdown-item" href="#" data-field-name="'</span> <span class="o">.</span> <span class="nv">$type</span> <span class="o">.</span> <span class="s1">'" data-field-tag="'</span> <span class="o">.</span> <span class="nv">$tag</span> <span class="o">.</span> <span class="s1">'" data-action_popup="'</span> <span class="o">.</span> <span class="nv">$tag</span> <span class="o">.</span> <span class="s1">'"&gt;'</span> <span class="o">.</span> <span class="nv">$label</span> <span class="o">.</span> <span class="s1">' &lt;small&gt;[#'</span> <span class="o">.</span> <span class="nv">$tag</span> <span class="o">.</span> <span class="s1">']&lt;/small&gt;&lt;/a&gt;'</span><span class="p">;</span></td></tr><tr><th id="L2277"><a href="#L2277">2277</a></th><td>                                                <span class="k">continue</span><span class="p">;</span></td></tr><tr><th id="L2278"><a href="#L2278">2278</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L2279"><a href="#L2279">2279</a></th><td>                                        <span class="nv">$default</span> <span class="o">.=</span> <span class="s1">'&lt;a class="dropdown-item" href="#" data-field-name="'</span> <span class="o">.</span> <span class="nv">$type</span> <span class="o">.</span> <span class="s1">'" data-field-tag="'</span> <span class="o">.</span> <span class="nv">$tag</span> <span class="o">.</span> <span class="s1">'"&gt;'</span> <span class="o">.</span> <span class="nv">$label</span> <span class="o">.</span> <span class="s1">' &lt;small&gt;[#'</span> <span class="o">.</span> <span class="nv">$tag</span> <span class="o">.</span> <span class="s1">']&lt;/small&gt;&lt;/a&gt;'</span><span class="p">;</span></td></tr><tr><th id="L2280"><a href="#L2280">2280</a></th><td>                                        <span class="k">continue</span><span class="p">;</span></td></tr><tr><th id="L2281"><a href="#L2281">2281</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L2282"><a href="#L2282">2282</a></th><td>                                <span class="nv">$default</span> <span class="o">.=</span> <span class="s1">'&lt;a class="dropdown-item" href="#" data-field-name="'</span> <span class="o">.</span> <span class="nv">$type</span> <span class="o">.</span> <span class="s1">'" data-field-tag="'</span> <span class="o">.</span> <span class="nv">$tag</span> <span class="o">.</span> <span class="s1">'"&gt;'</span> <span class="o">.</span> <span class="nv">$label</span> <span class="o">.</span> <span class="s1">' -- &lt;small&gt;[#'</span> <span class="o">.</span> <span class="nv">$tag</span> <span class="o">.</span> <span class="s1">']&lt;/small&gt;&lt;/a&gt;'</span><span class="p">;</span></td></tr><tr><th id="L2283"><a href="#L2283">2283</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2284"><a href="#L2284">2284</a></th><td></td></tr><tr><th id="L2285"><a href="#L2285">2285</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$disabled</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2286"><a href="#L2286">2286</a></th><td>                                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$disabled</span> <span class="k">as</span> <span class="nv">$tag</span> <span class="o">=&gt;</span> <span class="nv">$label</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2287"><a href="#L2287">2287</a></th><td>                                        <span class="nv">$default</span> <span class="o">.=</span> <span class="s1">'&lt;span disabled title="'</span> <span class="o">.</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Upgrade your license to use this tag'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">'" class="dropdown-item"&gt;'</span> <span class="o">.</span> <span class="nv">$label</span> <span class="o">.</span> <span class="s1">' -- &lt;small&gt;[#'</span> <span class="o">.</span> <span class="nv">$tag</span> <span class="o">.</span> <span class="s1">']&lt;/small&gt;&lt;/span&gt;'</span><span class="p">;</span></td></tr><tr><th id="L2288"><a href="#L2288">2288</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L2289"><a href="#L2289">2289</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2290"><a href="#L2290">2290</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2291"><a href="#L2291">2291</a></th><td></td></tr><tr><th id="L2292"><a href="#L2292">2292</a></th><td>                <span class="k">return</span> <span class="nv">$default</span><span class="p">;</span></td></tr><tr><th id="L2293"><a href="#L2293">2293</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2294"><a href="#L2294">2294</a></th><td></td></tr><tr><th id="L2295"><a href="#L2295">2295</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2296"><a href="#L2296">2296</a></th><td><span class="sd">         * Renders the tags for the title.</span></td></tr><tr><th id="L2297"><a href="#L2297">2297</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2298"><a href="#L2298">2298</a></th><td><span class="sd">         * @param array $default The default tags, empty.</span></td></tr><tr><th id="L2299"><a href="#L2299">2299</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2300"><a href="#L2300">2300</a></th><td><span class="sd">         * @since   1.4.2</span></td></tr><tr><th id="L2301"><a href="#L2301">2301</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2302"><a href="#L2302">2302</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2303"><a href="#L2303">2303</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">magic_tags_title</span><span class="p">(</span> <span class="nv">$default</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2304"><a href="#L2304">2304</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">]</span>      <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Title'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2305"><a href="#L2305">2305</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_author'</span><span class="p">]</span>     <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Author'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2306"><a href="#L2306">2306</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_date'</span><span class="p">]</span>       <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Date (UTC/GMT)'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2307"><a href="#L2307">2307</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_date_local'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Date (local timezone)'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2308"><a href="#L2308">2308</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_date_feed'</span><span class="p">]</span>  <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Date (feed timezone)'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2309"><a href="#L2309">2309</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_source'</span><span class="p">]</span>     <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Source'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2310"><a href="#L2310">2310</a></th><td></td></tr><tr><th id="L2311"><a href="#L2311">2311</a></th><td>                <span class="c1">// disabled tags.</span></td></tr><tr><th id="L2312"><a href="#L2312">2312</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2313"><a href="#L2313">2313</a></th><td>                        <span class="nv">$default</span><span class="p">[</span><span class="s1">'title_spinnerchief:disabled'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'🚫 Title from SpinnerChief'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2314"><a href="#L2314">2314</a></th><td>                        <span class="nv">$default</span><span class="p">[</span><span class="s1">'title_wordai:disabled'</span><span class="p">]</span>       <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'🚫 Title from WordAI'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2315"><a href="#L2315">2315</a></th><td></td></tr><tr><th id="L2316"><a href="#L2316">2316</a></th><td>                        <span class="nv">$default</span><span class="p">[</span><span class="s1">'translated_title:disabled'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'🚫 Translated Title'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2317"><a href="#L2317">2317</a></th><td></td></tr><tr><th id="L2318"><a href="#L2318">2318</a></th><td>                        <span class="nv">$default</span><span class="p">[</span><span class="s1">'title_feedzy_rewrite:disabled'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'🚫 Paraphrased Title using Feedzy'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2319"><a href="#L2319">2319</a></th><td></td></tr><tr><th id="L2320"><a href="#L2320">2320</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2321"><a href="#L2321">2321</a></th><td></td></tr><tr><th id="L2322"><a href="#L2322">2322</a></th><td>                <span class="k">return</span> <span class="nv">$default</span><span class="p">;</span></td></tr><tr><th id="L2323"><a href="#L2323">2323</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2324"><a href="#L2324">2324</a></th><td></td></tr><tr><th id="L2325"><a href="#L2325">2325</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2326"><a href="#L2326">2326</a></th><td><span class="sd">         * Renders the tags for the date.</span></td></tr><tr><th id="L2327"><a href="#L2327">2327</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2328"><a href="#L2328">2328</a></th><td><span class="sd">         * @param array $default The default tags, empty.</span></td></tr><tr><th id="L2329"><a href="#L2329">2329</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2330"><a href="#L2330">2330</a></th><td><span class="sd">         * @since   1.4.2</span></td></tr><tr><th id="L2331"><a href="#L2331">2331</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2332"><a href="#L2332">2332</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2333"><a href="#L2333">2333</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">magic_tags_date</span><span class="p">(</span> <span class="nv">$default</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2334"><a href="#L2334">2334</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_date'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Date'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2335"><a href="#L2335">2335</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'post_date'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Post Date'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2336"><a href="#L2336">2336</a></th><td></td></tr><tr><th id="L2337"><a href="#L2337">2337</a></th><td>                <span class="k">return</span> <span class="nv">$default</span><span class="p">;</span></td></tr><tr><th id="L2338"><a href="#L2338">2338</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2339"><a href="#L2339">2339</a></th><td></td></tr><tr><th id="L2340"><a href="#L2340">2340</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2341"><a href="#L2341">2341</a></th><td><span class="sd">         * Renders the tags for the content.</span></td></tr><tr><th id="L2342"><a href="#L2342">2342</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2343"><a href="#L2343">2343</a></th><td><span class="sd">         * @param array $default The default tags, empty.</span></td></tr><tr><th id="L2344"><a href="#L2344">2344</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2345"><a href="#L2345">2345</a></th><td><span class="sd">         * @since   1.4.2</span></td></tr><tr><th id="L2346"><a href="#L2346">2346</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2347"><a href="#L2347">2347</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2348"><a href="#L2348">2348</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">magic_tags_content</span><span class="p">(</span> <span class="nv">$default</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2349"><a href="#L2349">2349</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_content'</span><span class="p">]</span>     <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Content'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2350"><a href="#L2350">2350</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_description'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Description'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2351"><a href="#L2351">2351</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_image'</span><span class="p">]</span>       <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Image'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2352"><a href="#L2352">2352</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_url'</span><span class="p">]</span>         <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item URL'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2353"><a href="#L2353">2353</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_categories'</span><span class="p">]</span>  <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Categories'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2354"><a href="#L2354">2354</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_source'</span><span class="p">]</span>      <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Source'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2355"><a href="#L2355">2355</a></th><td></td></tr><tr><th id="L2356"><a href="#L2356">2356</a></th><td>                <span class="c1">// disabled tags.</span></td></tr><tr><th id="L2357"><a href="#L2357">2357</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2358"><a href="#L2358">2358</a></th><td>                        <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_full_content:disabled'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'🚫 Item Full Content'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2359"><a href="#L2359">2359</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2360"><a href="#L2360">2360</a></th><td></td></tr><tr><th id="L2361"><a href="#L2361">2361</a></th><td>                <span class="k">return</span> <span class="nv">$default</span><span class="p">;</span></td></tr><tr><th id="L2362"><a href="#L2362">2362</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2363"><a href="#L2363">2363</a></th><td></td></tr><tr><th id="L2364"><a href="#L2364">2364</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2365"><a href="#L2365">2365</a></th><td><span class="sd">         * Renders the tags for the featured image.</span></td></tr><tr><th id="L2366"><a href="#L2366">2366</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2367"><a href="#L2367">2367</a></th><td><span class="sd">         * @param array $default The default tags, empty.</span></td></tr><tr><th id="L2368"><a href="#L2368">2368</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2369"><a href="#L2369">2369</a></th><td><span class="sd">         * @since   1.4.2</span></td></tr><tr><th id="L2370"><a href="#L2370">2370</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2371"><a href="#L2371">2371</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2372"><a href="#L2372">2372</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">magic_tags_image</span><span class="p">(</span> <span class="nv">$default</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2373"><a href="#L2373">2373</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_image'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Image'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2374"><a href="#L2374">2374</a></th><td></td></tr><tr><th id="L2375"><a href="#L2375">2375</a></th><td>                <span class="k">return</span> <span class="nv">$default</span><span class="p">;</span></td></tr><tr><th id="L2376"><a href="#L2376">2376</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2377"><a href="#L2377">2377</a></th><td></td></tr><tr><th id="L2378"><a href="#L2378">2378</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2379"><a href="#L2379">2379</a></th><td><span class="sd">         * Register the meta tags.</span></td></tr><tr><th id="L2380"><a href="#L2380">2380</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2381"><a href="#L2381">2381</a></th><td><span class="sd">         * @access      public</span></td></tr><tr><th id="L2382"><a href="#L2382">2382</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2383"><a href="#L2383">2383</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">wp</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2384"><a href="#L2384">2384</a></th><td>                <span class="k">global</span> <span class="nv">$wp_version</span><span class="p">;</span></td></tr><tr><th id="L2385"><a href="#L2385">2385</a></th><td></td></tr><tr><th id="L2386"><a href="#L2386">2386</a></th><td>                <span class="nv">$free_settings</span> <span class="o">=</span> <span class="nx">get_option</span><span class="p">(</span> <span class="s1">'feedzy-settings'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span></td></tr><tr><th id="L2387"><a href="#L2387">2387</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$free_settings</span><span class="p">[</span><span class="s1">'canonical'</span><span class="p">]</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">1</span> <span class="o">!==</span> <span class="nb">intval</span><span class="p">(</span> <span class="nv">$free_settings</span><span class="p">[</span><span class="s1">'canonical'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2388"><a href="#L2388">2388</a></th><td>                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L2389"><a href="#L2389">2389</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2390"><a href="#L2390">2390</a></th><td></td></tr><tr><th id="L2391"><a href="#L2391">2391</a></th><td>                <span class="c1">// Yoast.</span></td></tr><tr><th id="L2392"><a href="#L2392">2392</a></th><td><span class="c1"></span>                <span class="nx">add_filter</span><span class="p">(</span> <span class="s1">'wpseo_canonical'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">'get_canonical_url'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2393"><a href="#L2393">2393</a></th><td></td></tr><tr><th id="L2394"><a href="#L2394">2394</a></th><td>                <span class="c1">// All In One SEO.</span></td></tr><tr><th id="L2395"><a href="#L2395">2395</a></th><td><span class="c1"></span>                <span class="nx">add_filter</span><span class="p">(</span> <span class="s1">'aioseop_canonical_url'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">'get_canonical_url'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2396"><a href="#L2396">2396</a></th><td></td></tr><tr><th id="L2397"><a href="#L2397">2397</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">version_compare</span><span class="p">(</span> <span class="nv">$wp_version</span><span class="p">,</span> <span class="s1">'4.6.0'</span><span class="p">,</span> <span class="s1">'&gt;='</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2398"><a href="#L2398">2398</a></th><td>                        <span class="c1">// Fallback if none of the above plugins is present.</span></td></tr><tr><th id="L2399"><a href="#L2399">2399</a></th><td><span class="c1"></span>                        <span class="nx">add_filter</span><span class="p">(</span> <span class="s1">'get_canonical_url'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">'get_canonical_url'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2400"><a href="#L2400">2400</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2401"><a href="#L2401">2401</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2402"><a href="#L2402">2402</a></th><td></td></tr><tr><th id="L2403"><a href="#L2403">2403</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2404"><a href="#L2404">2404</a></th><td><span class="sd">         * Return the canonical URL.</span></td></tr><tr><th id="L2405"><a href="#L2405">2405</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2406"><a href="#L2406">2406</a></th><td><span class="sd">         * @access      public</span></td></tr><tr><th id="L2407"><a href="#L2407">2407</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2408"><a href="#L2408">2408</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">get_canonical_url</span><span class="p">(</span> <span class="nv">$canonical_url</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2409"><a href="#L2409">2409</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">is_singular</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2410"><a href="#L2410">2410</a></th><td>                        <span class="k">return</span> <span class="nv">$canonical_url</span><span class="p">;</span></td></tr><tr><th id="L2411"><a href="#L2411">2411</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2412"><a href="#L2412">2412</a></th><td></td></tr><tr><th id="L2413"><a href="#L2413">2413</a></th><td>                <span class="k">global</span> <span class="nv">$post</span><span class="p">;</span></td></tr><tr><th id="L2414"><a href="#L2414">2414</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$post</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2415"><a href="#L2415">2415</a></th><td>                        <span class="k">return</span> <span class="nv">$canonical_url</span><span class="p">;</span></td></tr><tr><th id="L2416"><a href="#L2416">2416</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2417"><a href="#L2417">2417</a></th><td></td></tr><tr><th id="L2418"><a href="#L2418">2418</a></th><td>                <span class="c1">// let's check if the post has been imported by feedzy.</span></td></tr><tr><th id="L2419"><a href="#L2419">2419</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">===</span> <span class="nb">intval</span><span class="p">(</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'feedzy'</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2420"><a href="#L2420">2420</a></th><td>                        <span class="nv">$url</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'feedzy_item_url'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L2421"><a href="#L2421">2421</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2422"><a href="#L2422">2422</a></th><td>                                <span class="nv">$canonical_url</span> <span class="o">=</span> <span class="nv">$url</span><span class="p">;</span></td></tr><tr><th id="L2423"><a href="#L2423">2423</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2424"><a href="#L2424">2424</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2425"><a href="#L2425">2425</a></th><td></td></tr><tr><th id="L2426"><a href="#L2426">2426</a></th><td>                <span class="k">return</span> <span class="nv">$canonical_url</span><span class="p">;</span></td></tr><tr><th id="L2427"><a href="#L2427">2427</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2428"><a href="#L2428">2428</a></th><td></td></tr><tr><th id="L2429"><a href="#L2429">2429</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2430"><a href="#L2430">2430</a></th><td><span class="sd">         * Add/remove row actions for each import.</span></td></tr><tr><th id="L2431"><a href="#L2431">2431</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2432"><a href="#L2432">2432</a></th><td><span class="sd">         * @since   ?</span></td></tr><tr><th id="L2433"><a href="#L2433">2433</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2434"><a href="#L2434">2434</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2435"><a href="#L2435">2435</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">add_import_actions</span><span class="p">(</span> <span class="nv">$actions</span><span class="p">,</span> <span class="nv">$post</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2436"><a href="#L2436">2436</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">post_type</span> <span class="o">===</span> <span class="s1">'feedzy_imports'</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2437"><a href="#L2437">2437</a></th><td>                        <span class="c1">// don't need quick edit.</span></td></tr><tr><th id="L2438"><a href="#L2438">2438</a></th><td><span class="c1"></span>                        <span class="nb">unset</span><span class="p">(</span> <span class="nv">$actions</span><span class="p">[</span><span class="s1">'inline hide-if-no-js'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L2439"><a href="#L2439">2439</a></th><td></td></tr><tr><th id="L2440"><a href="#L2440">2440</a></th><td>                        <span class="nv">$actions</span><span class="p">[</span><span class="s1">'feedzy_purge'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span></td></tr><tr><th id="L2441"><a href="#L2441">2441</a></th><td>                                <span class="s1">'&lt;a href="#" class="feedzy-purge" data-id="%d"&gt;%2$s&lt;/a&gt;&lt;span class="feedzy-spinner spinner"&gt;&lt;/span&gt;'</span><span class="p">,</span></td></tr><tr><th id="L2442"><a href="#L2442">2442</a></th><td>                                <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span></td></tr><tr><th id="L2443"><a href="#L2443">2443</a></th><td>                                <span class="nx">esc_html</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Purge &amp;amp; Reset'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">)</span></td></tr><tr><th id="L2444"><a href="#L2444">2444</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2445"><a href="#L2445">2445</a></th><td>                <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">===</span> <span class="nb">intval</span><span class="p">(</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'feedzy'</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2446"><a href="#L2446">2446</a></th><td>                        <span class="c1">// show an unclickable action that mentions that it is imported by us</span></td></tr><tr><th id="L2447"><a href="#L2447">2447</a></th><td><span class="c1"></span>                        <span class="c1">// so that users are aware</span></td></tr><tr><th id="L2448"><a href="#L2448">2448</a></th><td><span class="c1"></span>                        <span class="nv">$feedzy_job_id</span>     <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">,</span> <span class="s1">'feedzy_job'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L2449"><a href="#L2449">2449</a></th><td>                        <span class="nv">$actions</span><span class="p">[</span><span class="s1">'feedzy'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span> <span class="s1">'(%s %s)'</span><span class="p">,</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Imported by Feedzy from'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span> <span class="nx">get_the_title</span><span class="p">(</span> <span class="nv">$feedzy_job_id</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2450"><a href="#L2450">2450</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2451"><a href="#L2451">2451</a></th><td></td></tr><tr><th id="L2452"><a href="#L2452">2452</a></th><td>                <span class="k">return</span> <span class="nv">$actions</span><span class="p">;</span></td></tr><tr><th id="L2453"><a href="#L2453">2453</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2454"><a href="#L2454">2454</a></th><td></td></tr><tr><th id="L2455"><a href="#L2455">2455</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2456"><a href="#L2456">2456</a></th><td><span class="sd">         * AJAX called method to purge imported items.</span></td></tr><tr><th id="L2457"><a href="#L2457">2457</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2458"><a href="#L2458">2458</a></th><td><span class="sd">         * @since   ?</span></td></tr><tr><th id="L2459"><a href="#L2459">2459</a></th><td><span class="sd">         * @access  private</span></td></tr><tr><th id="L2460"><a href="#L2460">2460</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2461"><a href="#L2461">2461</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">purge_data</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2462"><a href="#L2462">2462</a></th><td>                <span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="nx">FEEDZY_BASEFILE</span><span class="p">,</span> <span class="s1">'security'</span> <span class="p">);</span></td></tr><tr><th id="L2463"><a href="#L2463">2463</a></th><td></td></tr><tr><th id="L2464"><a href="#L2464">2464</a></th><td>                <span class="nv">$id</span>                 <span class="o">=</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'id'</span><span class="p">,</span> <span class="nx">FILTER_SANITIZE_NUMBER_INT</span> <span class="p">);</span></td></tr><tr><th id="L2465"><a href="#L2465">2465</a></th><td>                <span class="nv">$del_imported_posts</span> <span class="o">=</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'del_imported_posts'</span><span class="p">,</span> <span class="nx">FILTER_VALIDATE_BOOLEAN</span> <span class="p">);</span></td></tr><tr><th id="L2466"><a href="#L2466">2466</a></th><td>                <span class="nv">$post</span>               <span class="o">=</span> <span class="nx">get_post</span><span class="p">(</span> <span class="nv">$id</span> <span class="p">);</span></td></tr><tr><th id="L2467"><a href="#L2467">2467</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="s1">'feedzy_imports'</span> <span class="o">!==</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">post_type</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2468"><a href="#L2468">2468</a></th><td>                        <span class="nx">wp_die</span><span class="p">();</span></td></tr><tr><th id="L2469"><a href="#L2469">2469</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2470"><a href="#L2470">2470</a></th><td></td></tr><tr><th id="L2471"><a href="#L2471">2471</a></th><td>                <span class="c1">// Delete imported posts.</span></td></tr><tr><th id="L2472"><a href="#L2472">2472</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$del_imported_posts</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2473"><a href="#L2473">2473</a></th><td>                        <span class="nv">$post_types</span>    <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$id</span><span class="p">,</span> <span class="s1">'import_post_type'</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L2474"><a href="#L2474">2474</a></th><td>                        <span class="nv">$imported_post</span> <span class="o">=</span> <span class="nx">get_posts</span><span class="p">(</span></td></tr><tr><th id="L2475"><a href="#L2475">2475</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2476"><a href="#L2476">2476</a></th><td>                                        <span class="s1">'post_type'</span>      <span class="o">=&gt;</span> <span class="nv">$post_types</span><span class="p">,</span></td></tr><tr><th id="L2477"><a href="#L2477">2477</a></th><td>                                        <span class="s1">'post_status'</span>    <span class="o">=&gt;</span> <span class="s1">'any'</span><span class="p">,</span></td></tr><tr><th id="L2478"><a href="#L2478">2478</a></th><td>                                        <span class="s1">'fields'</span>         <span class="o">=&gt;</span> <span class="s1">'ids'</span><span class="p">,</span></td></tr><tr><th id="L2479"><a href="#L2479">2479</a></th><td>                                        <span class="s1">'meta_key'</span>       <span class="o">=&gt;</span> <span class="s1">'feedzy_job'</span><span class="p">,</span> <span class="c1">// phpcs:ignore WordPress.DB.SlowDBQuery.slow_db_query_meta_key</span></td></tr><tr><th id="L2480"><a href="#L2480">2480</a></th><td><span class="c1"></span>                                        <span class="s1">'meta_value'</span>     <span class="o">=&gt;</span> <span class="nv">$id</span><span class="p">,</span> <span class="c1">// phpcs:ignore WordPress.DB.SlowDBQuery.slow_db_query_meta_value</span></td></tr><tr><th id="L2481"><a href="#L2481">2481</a></th><td><span class="c1"></span>                                        <span class="s1">'meta_compare'</span>   <span class="o">=&gt;</span> <span class="s1">'='</span><span class="p">,</span></td></tr><tr><th id="L2482"><a href="#L2482">2482</a></th><td>                                        <span class="s1">'posts_per_page'</span> <span class="o">=&gt;</span> <span class="mi">999</span><span class="p">,</span> <span class="c1">// phpcs:ignore WordPress.WP.PostsPerPage.posts_per_page_posts_per_page</span></td></tr><tr><th id="L2483"><a href="#L2483">2483</a></th><td><span class="c1"></span>                                <span class="p">)</span></td></tr><tr><th id="L2484"><a href="#L2484">2484</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2485"><a href="#L2485">2485</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$imported_post</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2486"><a href="#L2486">2486</a></th><td>                                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$imported_post</span> <span class="k">as</span> <span class="nv">$post_id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2487"><a href="#L2487">2487</a></th><td>                                        <span class="nx">wp_delete_post</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span></td></tr><tr><th id="L2488"><a href="#L2488">2488</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L2489"><a href="#L2489">2489</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2490"><a href="#L2490">2490</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2491"><a href="#L2491">2491</a></th><td></td></tr><tr><th id="L2492"><a href="#L2492">2492</a></th><td>                <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$id</span><span class="p">,</span> <span class="s1">'imported_items_hash'</span> <span class="p">);</span></td></tr><tr><th id="L2493"><a href="#L2493">2493</a></th><td>                <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$id</span><span class="p">,</span> <span class="s1">'imported_items'</span> <span class="p">);</span></td></tr><tr><th id="L2494"><a href="#L2494">2494</a></th><td>                <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$id</span><span class="p">,</span> <span class="s1">'imported_items_count'</span> <span class="p">);</span></td></tr><tr><th id="L2495"><a href="#L2495">2495</a></th><td>                <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$id</span><span class="p">,</span> <span class="s1">'import_errors'</span> <span class="p">);</span></td></tr><tr><th id="L2496"><a href="#L2496">2496</a></th><td>                <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$id</span><span class="p">,</span> <span class="s1">'import_info'</span> <span class="p">);</span></td></tr><tr><th id="L2497"><a href="#L2497">2497</a></th><td>                <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$id</span><span class="p">,</span> <span class="s1">'last_run'</span> <span class="p">);</span></td></tr><tr><th id="L2498"><a href="#L2498">2498</a></th><td>                <span class="nx">wp_die</span><span class="p">();</span></td></tr><tr><th id="L2499"><a href="#L2499">2499</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2500"><a href="#L2500">2500</a></th><td></td></tr><tr><th id="L2501"><a href="#L2501">2501</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2502"><a href="#L2502">2502</a></th><td><span class="sd">         * Load only those posts that are linked to a particular import job.</span></td></tr><tr><th id="L2503"><a href="#L2503">2503</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2504"><a href="#L2504">2504</a></th><td><span class="sd">         * @since   ?</span></td></tr><tr><th id="L2505"><a href="#L2505">2505</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2506"><a href="#L2506">2506</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2507"><a href="#L2507">2507</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">pre_get_posts</span><span class="p">(</span> <span class="nv">$query</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2508"><a href="#L2508">2508</a></th><td></td></tr><tr><th id="L2509"><a href="#L2509">2509</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">function_exists</span><span class="p">(</span> <span class="s1">'wp_verify_nonce'</span> <span class="p">)</span> <span class="o">||</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">wp_verify_nonce</span><span class="p">(</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_GET</span><span class="p">,</span> <span class="s1">'_nonce'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">),</span> <span class="s1">'job_run_linked_posts'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2510"><a href="#L2510">2510</a></th><td>                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L2511"><a href="#L2511">2511</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2512"><a href="#L2512">2512</a></th><td></td></tr><tr><th id="L2513"><a href="#L2513">2513</a></th><td>                <span class="nv">$feedzy_job_id</span>   <span class="o">=</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_GET</span><span class="p">,</span> <span class="s1">'feedzy_job_id'</span><span class="p">,</span> <span class="nx">FILTER_SANITIZE_NUMBER_INT</span> <span class="p">);</span></td></tr><tr><th id="L2514"><a href="#L2514">2514</a></th><td>                <span class="nv">$feedzy_job_time</span> <span class="o">=</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_GET</span><span class="p">,</span> <span class="s1">'feedzy_job_time'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">);</span></td></tr><tr><th id="L2515"><a href="#L2515">2515</a></th><td></td></tr><tr><th id="L2516"><a href="#L2516">2516</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nx">is_admin</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">is_main_query</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$feedzy_job_id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2517"><a href="#L2517">2517</a></th><td>                        <span class="nv">$meta_query</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2518"><a href="#L2518">2518</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2519"><a href="#L2519">2519</a></th><td>                                        <span class="s1">'key'</span>   <span class="o">=&gt;</span> <span class="s1">'feedzy'</span><span class="p">,</span></td></tr><tr><th id="L2520"><a href="#L2520">2520</a></th><td>                                        <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span></td></tr><tr><th id="L2521"><a href="#L2521">2521</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L2522"><a href="#L2522">2522</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2523"><a href="#L2523">2523</a></th><td>                                        <span class="s1">'key'</span>   <span class="o">=&gt;</span> <span class="s1">'feedzy_job'</span><span class="p">,</span></td></tr><tr><th id="L2524"><a href="#L2524">2524</a></th><td>                                        <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="nv">$feedzy_job_id</span><span class="p">,</span></td></tr><tr><th id="L2525"><a href="#L2525">2525</a></th><td>                                <span class="p">),</span></td></tr><tr><th id="L2526"><a href="#L2526">2526</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2527"><a href="#L2527">2527</a></th><td></td></tr><tr><th id="L2528"><a href="#L2528">2528</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$feedzy_job_time</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2529"><a href="#L2529">2529</a></th><td>                                <span class="nv">$meta_query</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2530"><a href="#L2530">2530</a></th><td>                                        <span class="s1">'key'</span>   <span class="o">=&gt;</span> <span class="s1">'feedzy_job_time'</span><span class="p">,</span></td></tr><tr><th id="L2531"><a href="#L2531">2531</a></th><td>                                        <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="nv">$feedzy_job_time</span><span class="p">,</span></td></tr><tr><th id="L2532"><a href="#L2532">2532</a></th><td>                                <span class="p">);</span></td></tr><tr><th id="L2533"><a href="#L2533">2533</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2534"><a href="#L2534">2534</a></th><td></td></tr><tr><th id="L2535"><a href="#L2535">2535</a></th><td>                        <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span> <span class="s1">'meta_query'</span><span class="p">,</span> <span class="nv">$meta_query</span> <span class="p">);</span></td></tr><tr><th id="L2536"><a href="#L2536">2536</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2537"><a href="#L2537">2537</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2538"><a href="#L2538">2538</a></th><td></td></tr><tr><th id="L2539"><a href="#L2539">2539</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2540"><a href="#L2540">2540</a></th><td><span class="sd">         * Add iframe to allowed wp_kses_post tags.</span></td></tr><tr><th id="L2541"><a href="#L2541">2541</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2542"><a href="#L2542">2542</a></th><td><span class="sd">         * @param array  $tags Allowed tags, attributes, and/or entities.</span></td></tr><tr><th id="L2543"><a href="#L2543">2543</a></th><td><span class="sd">         * @param string $context Context.</span></td></tr><tr><th id="L2544"><a href="#L2544">2544</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2545"><a href="#L2545">2545</a></th><td><span class="sd">         * @return array</span></td></tr><tr><th id="L2546"><a href="#L2546">2546</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2547"><a href="#L2547">2547</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_wp_kses_allowed_html</span><span class="p">(</span> <span class="nv">$tags</span><span class="p">,</span> <span class="nv">$context</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2548"><a href="#L2548">2548</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$tags</span><span class="p">[</span><span class="s1">'iframe'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2549"><a href="#L2549">2549</a></th><td>                        <span class="nv">$tags</span><span class="p">[</span><span class="s1">'iframe'</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2550"><a href="#L2550">2550</a></th><td>                                <span class="s1">'src'</span>             <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L2551"><a href="#L2551">2551</a></th><td>                                <span class="s1">'height'</span>          <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L2552"><a href="#L2552">2552</a></th><td>                                <span class="s1">'width'</span>           <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L2553"><a href="#L2553">2553</a></th><td>                                <span class="s1">'frameborder'</span>     <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L2554"><a href="#L2554">2554</a></th><td>                                <span class="s1">'allowfullscreen'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L2555"><a href="#L2555">2555</a></th><td>                                <span class="s1">'data-*'</span>          <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span></td></tr><tr><th id="L2556"><a href="#L2556">2556</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2557"><a href="#L2557">2557</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2558"><a href="#L2558">2558</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$tags</span><span class="p">[</span><span class="s1">'span'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2559"><a href="#L2559">2559</a></th><td>                        <span class="nv">$tags</span><span class="p">[</span><span class="s1">'span'</span><span class="p">][</span><span class="s1">'disabled'</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span></td></tr><tr><th id="L2560"><a href="#L2560">2560</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2561"><a href="#L2561">2561</a></th><td></td></tr><tr><th id="L2562"><a href="#L2562">2562</a></th><td>                <span class="k">return</span> <span class="nv">$tags</span><span class="p">;</span></td></tr><tr><th id="L2563"><a href="#L2563">2563</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2564"><a href="#L2564">2564</a></th><td></td></tr><tr><th id="L2565"><a href="#L2565">2565</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2566"><a href="#L2566">2566</a></th><td><span class="sd">         * Get post data using meta key and value.</span></td></tr><tr><th id="L2567"><a href="#L2567">2567</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2568"><a href="#L2568">2568</a></th><td><span class="sd">         * @param string $post_type Post type Default post.</span></td></tr><tr><th id="L2569"><a href="#L2569">2569</a></th><td><span class="sd">         * @param string $key Meta Key.</span></td></tr><tr><th id="L2570"><a href="#L2570">2570</a></th><td><span class="sd">         * @param string $value Meta value.</span></td></tr><tr><th id="L2571"><a href="#L2571">2571</a></th><td><span class="sd">         * @param string $compare Compare operator.</span></td></tr><tr><th id="L2572"><a href="#L2572">2572</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2573"><a href="#L2573">2573</a></th><td><span class="sd">         * @return mixed</span></td></tr><tr><th id="L2574"><a href="#L2574">2574</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2575"><a href="#L2575">2575</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">is_duplicate_post</span><span class="p">(</span> <span class="nv">$post_type</span> <span class="o">=</span> <span class="s1">'post'</span><span class="p">,</span> <span class="nv">$key</span> <span class="o">=</span> <span class="s1">''</span><span class="p">,</span> <span class="nv">$value</span> <span class="o">=</span> <span class="s1">''</span><span class="p">,</span> <span class="nv">$compare</span> <span class="o">=</span> <span class="s1">'='</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2576"><a href="#L2576">2576</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$key</span> <span class="p">)</span> <span class="o">||</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2577"><a href="#L2577">2577</a></th><td>                        <span class="k">return</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L2578"><a href="#L2578">2578</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2579"><a href="#L2579">2579</a></th><td>                <span class="c1">// Check post exists OR Not.</span></td></tr><tr><th id="L2580"><a href="#L2580">2580</a></th><td><span class="c1"></span>                <span class="nv">$data</span> <span class="o">=</span> <span class="nx">get_posts</span><span class="p">(</span></td></tr><tr><th id="L2581"><a href="#L2581">2581</a></th><td>                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2582"><a href="#L2582">2582</a></th><td>                                <span class="s1">'posts_per_page'</span> <span class="o">=&gt;</span> <span class="mi">80</span><span class="p">,</span></td></tr><tr><th id="L2583"><a href="#L2583">2583</a></th><td>                                <span class="s1">'post_type'</span>      <span class="o">=&gt;</span> <span class="nv">$post_type</span><span class="p">,</span></td></tr><tr><th id="L2584"><a href="#L2584">2584</a></th><td>                                <span class="s1">'meta_key'</span>       <span class="o">=&gt;</span> <span class="nv">$key</span><span class="p">,</span> <span class="c1">//phpcs:ignore WordPress.DB.SlowDBQuery.slow_db_query_meta_key</span></td></tr><tr><th id="L2585"><a href="#L2585">2585</a></th><td><span class="c1"></span>                                <span class="s1">'meta_value'</span>     <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">,</span> <span class="c1">//phpcs:ignore WordPress.DB.SlowDBQuery.slow_db_query_meta_value</span></td></tr><tr><th id="L2586"><a href="#L2586">2586</a></th><td><span class="c1"></span>                                <span class="s1">'meta_compare'</span>   <span class="o">=&gt;</span> <span class="nv">$compare</span><span class="p">,</span></td></tr><tr><th id="L2587"><a href="#L2587">2587</a></th><td>                                <span class="s1">'fields'</span>         <span class="o">=&gt;</span> <span class="s1">'ids'</span><span class="p">,</span></td></tr><tr><th id="L2588"><a href="#L2588">2588</a></th><td>                        <span class="p">)</span></td></tr><tr><th id="L2589"><a href="#L2589">2589</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L2590"><a href="#L2590">2590</a></th><td></td></tr><tr><th id="L2591"><a href="#L2591">2591</a></th><td>                <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span></td></tr><tr><th id="L2592"><a href="#L2592">2592</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2593"><a href="#L2593">2593</a></th><td></td></tr><tr><th id="L2594"><a href="#L2594">2594</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2595"><a href="#L2595">2595</a></th><td><span class="sd">         * Get post data using meta key and value.</span></td></tr><tr><th id="L2596"><a href="#L2596">2596</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2597"><a href="#L2597">2597</a></th><td><span class="sd">         * @param string $post_type Post type Default post.</span></td></tr><tr><th id="L2598"><a href="#L2598">2598</a></th><td><span class="sd">         * @param int    $post_id Post ID.</span></td></tr><tr><th id="L2599"><a href="#L2599">2599</a></th><td><span class="sd">         * @param string $language_code Selected language code.</span></td></tr><tr><th id="L2600"><a href="#L2600">2600</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2601"><a href="#L2601">2601</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">set_wpml_element_language_details</span><span class="p">(</span> <span class="nv">$post_type</span> <span class="o">=</span> <span class="s1">'post'</span><span class="p">,</span> <span class="nv">$post_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$language_code</span> <span class="o">=</span> <span class="s1">''</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2602"><a href="#L2602">2602</a></th><td>                <span class="k">global</span> <span class="nv">$sitepress</span><span class="p">;</span></td></tr><tr><th id="L2603"><a href="#L2603">2603</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$post_id</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$language_code</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2604"><a href="#L2604">2604</a></th><td>                        <span class="c1">// Get the translation id.</span></td></tr><tr><th id="L2605"><a href="#L2605">2605</a></th><td><span class="c1"></span>                        <span class="nv">$trid</span> <span class="o">=</span> <span class="nv">$sitepress</span><span class="o">-&gt;</span><span class="na">get_element_trid</span><span class="p">(</span> <span class="nv">$post_id</span><span class="p">,</span> <span class="s1">'post_'</span> <span class="o">.</span> <span class="nv">$post_type</span> <span class="p">);</span></td></tr><tr><th id="L2606"><a href="#L2606">2606</a></th><td></td></tr><tr><th id="L2607"><a href="#L2607">2607</a></th><td>                        <span class="c1">// Update the post language info.</span></td></tr><tr><th id="L2608"><a href="#L2608">2608</a></th><td><span class="c1"></span>                        <span class="nv">$language_args</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2609"><a href="#L2609">2609</a></th><td>                                <span class="s1">'element_id'</span>           <span class="o">=&gt;</span> <span class="nv">$post_id</span><span class="p">,</span></td></tr><tr><th id="L2610"><a href="#L2610">2610</a></th><td>                                <span class="s1">'element_type'</span>         <span class="o">=&gt;</span> <span class="s1">'post_'</span> <span class="o">.</span> <span class="nv">$post_type</span><span class="p">,</span></td></tr><tr><th id="L2611"><a href="#L2611">2611</a></th><td>                                <span class="s1">'trid'</span>                 <span class="o">=&gt;</span> <span class="nv">$trid</span><span class="p">,</span></td></tr><tr><th id="L2612"><a href="#L2612">2612</a></th><td>                                <span class="s1">'language_code'</span>        <span class="o">=&gt;</span> <span class="nv">$language_code</span><span class="p">,</span></td></tr><tr><th id="L2613"><a href="#L2613">2613</a></th><td>                                <span class="s1">'source_language_code'</span> <span class="o">=&gt;</span> <span class="k">null</span><span class="p">,</span></td></tr><tr><th id="L2614"><a href="#L2614">2614</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2615"><a href="#L2615">2615</a></th><td></td></tr><tr><th id="L2616"><a href="#L2616">2616</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'wpml_set_element_language_details'</span><span class="p">,</span> <span class="nv">$language_args</span> <span class="p">);</span></td></tr><tr><th id="L2617"><a href="#L2617">2617</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2618"><a href="#L2618">2618</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2619"><a href="#L2619">2619</a></th><td></td></tr><tr><th id="L2620"><a href="#L2620">2620</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2621"><a href="#L2621">2621</a></th><td><span class="sd">         * Fetch custom field by selected post type.</span></td></tr><tr><th id="L2622"><a href="#L2622">2622</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2623"><a href="#L2623">2623</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">fetch_custom_fields</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2624"><a href="#L2624">2624</a></th><td>                <span class="k">global</span> <span class="nv">$wpdb</span><span class="p">;</span></td></tr><tr><th id="L2625"><a href="#L2625">2625</a></th><td></td></tr><tr><th id="L2626"><a href="#L2626">2626</a></th><td>                <span class="c1">// @codingStandardsIgnoreStart</span></td></tr><tr><th id="L2627"><a href="#L2627">2627</a></th><td><span class="c1"></span>                <span class="nv">$post_type</span>  <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'post_type'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'post_type'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L2628"><a href="#L2628">2628</a></th><td>                <span class="nv">$search_key</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'search_key'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'search_key'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L2629"><a href="#L2629">2629</a></th><td>                <span class="c1">// @codingStandardsIgnoreEnd</span></td></tr><tr><th id="L2630"><a href="#L2630">2630</a></th><td><span class="c1"></span></td></tr><tr><th id="L2631"><a href="#L2631">2631</a></th><td>                <span class="nv">$like</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L2632"><a href="#L2632">2632</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$search_key</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2633"><a href="#L2633">2633</a></th><td>                        <span class="nv">$like</span> <span class="o">=</span> <span class="s2">" AND </span><span class="si">$wpdb-&gt;postmeta</span><span class="s2">.meta_key LIKE '%</span><span class="si">$search_key</span><span class="s2">%'"</span><span class="p">;</span></td></tr><tr><th id="L2634"><a href="#L2634">2634</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2635"><a href="#L2635">2635</a></th><td></td></tr><tr><th id="L2636"><a href="#L2636">2636</a></th><td>                <span class="c1">// phpcs:ignore</span></td></tr><tr><th id="L2637"><a href="#L2637">2637</a></th><td><span class="c1"></span>                <span class="nv">$query_result</span> <span class="o">=</span> <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="na">get_results</span><span class="p">(</span> <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span> <span class="s2">"SELECT DISTINCT(</span><span class="si">$wpdb-&gt;postmeta</span><span class="s2">.meta_key) FROM </span><span class="si">$wpdb-&gt;posts</span><span class="s2"> LEFT JOIN </span><span class="si">$wpdb-&gt;postmeta</span><span class="s2"> ON </span><span class="si">$wpdb-&gt;posts</span><span class="s2">.ID = </span><span class="si">$wpdb-&gt;postmeta</span><span class="s2">.post_id WHERE </span><span class="si">$wpdb-&gt;posts</span><span class="s2">.post_type = '%s' AND </span><span class="si">$wpdb-&gt;postmeta</span><span class="s2">.meta_key != '' AND </span><span class="si">$wpdb-&gt;postmeta</span><span class="s2">.meta_key NOT RegExp '(^[_0-9].+$)' AND </span><span class="si">$wpdb-&gt;postmeta</span><span class="s2">.meta_key NOT RegExp '(^[_feedzy].+$)' AND </span><span class="si">$wpdb-&gt;postmeta</span><span class="s2">.meta_key NOT RegExp '(^[0-9]+$)'</span><span class="si">$like</span><span class="s2"> LIMIT 0, 9999"</span><span class="p">,</span> <span class="nv">$post_type</span> <span class="p">),</span> <span class="nx">ARRAY_A</span> <span class="p">);</span></td></tr><tr><th id="L2638"><a href="#L2638">2638</a></th><td></td></tr><tr><th id="L2639"><a href="#L2639">2639</a></th><td>                <span class="nv">$acf_fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L2640"><a href="#L2640">2640</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nb">function_exists</span><span class="p">(</span> <span class="s1">'acf_get_field_groups'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2641"><a href="#L2641">2641</a></th><td>                        <span class="nv">$groups</span> <span class="o">=</span> <span class="nx">acf_get_field_groups</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'post_type'</span> <span class="o">=&gt;</span> <span class="nv">$post_type</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2642"><a href="#L2642">2642</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$groups</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2643"><a href="#L2643">2643</a></th><td>                                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$groups</span> <span class="k">as</span> <span class="nv">$group</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2644"><a href="#L2644">2644</a></th><td>                                        <span class="nv">$fields</span> <span class="o">=</span> <span class="nx">acf_get_fields</span><span class="p">(</span> <span class="nv">$group</span><span class="p">[</span><span class="s1">'key'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L2645"><a href="#L2645">2645</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$fields</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2646"><a href="#L2646">2646</a></th><td>                                                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$fields</span> <span class="k">as</span> <span class="nv">$field</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2647"><a href="#L2647">2647</a></th><td>                                                        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$search_key</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2648"><a href="#L2648">2648</a></th><td>                                                                <span class="k">if</span> <span class="p">(</span> <span class="nb">stripos</span><span class="p">(</span> <span class="nv">$field</span><span class="p">[</span><span class="s1">'name'</span><span class="p">],</span> <span class="nv">$search_key</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2649"><a href="#L2649">2649</a></th><td>                                                                        <span class="nv">$acf_fields</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s1">'name'</span><span class="p">];</span></td></tr><tr><th id="L2650"><a href="#L2650">2650</a></th><td>                                                                <span class="p">}</span></td></tr><tr><th id="L2651"><a href="#L2651">2651</a></th><td>                                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L2652"><a href="#L2652">2652</a></th><td>                                                                <span class="nv">$acf_fields</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s1">'name'</span><span class="p">];</span></td></tr><tr><th id="L2653"><a href="#L2653">2653</a></th><td>                                                        <span class="p">}</span></td></tr><tr><th id="L2654"><a href="#L2654">2654</a></th><td>                                                <span class="p">}</span></td></tr><tr><th id="L2655"><a href="#L2655">2655</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L2656"><a href="#L2656">2656</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L2657"><a href="#L2657">2657</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2658"><a href="#L2658">2658</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2659"><a href="#L2659">2659</a></th><td>                <span class="nv">$query_result</span> <span class="o">=</span> <span class="nb">is_array</span><span class="p">(</span> <span class="nv">$query_result</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$query_result</span> <span class="o">:</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L2660"><a href="#L2660">2660</a></th><td>                <span class="nv">$query_result</span> <span class="o">=</span> <span class="nx">array_column</span><span class="p">(</span> <span class="nv">$query_result</span><span class="p">,</span> <span class="s1">'meta_key'</span> <span class="p">);</span></td></tr><tr><th id="L2661"><a href="#L2661">2661</a></th><td>                <span class="nv">$query_result</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span> <span class="nv">$acf_fields</span><span class="p">,</span> <span class="nv">$query_result</span> <span class="p">);</span></td></tr><tr><th id="L2662"><a href="#L2662">2662</a></th><td>                <span class="nv">$query_result</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span> <span class="nv">$query_result</span> <span class="p">);</span></td></tr><tr><th id="L2663"><a href="#L2663">2663</a></th><td></td></tr><tr><th id="L2664"><a href="#L2664">2664</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$query_result</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2665"><a href="#L2665">2665</a></th><td>                        <span class="nx">wp_send_json_success</span><span class="p">(</span> <span class="nv">$query_result</span> <span class="p">);</span></td></tr><tr><th id="L2666"><a href="#L2666">2666</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L2667"><a href="#L2667">2667</a></th><td>                        <span class="nx">wp_send_json_error</span><span class="p">(</span></td></tr><tr><th id="L2668"><a href="#L2668">2668</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2669"><a href="#L2669">2669</a></th><td>                                        <span class="s1">'not_found_msg'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'No matches found'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">),</span></td></tr><tr><th id="L2670"><a href="#L2670">2670</a></th><td>                                <span class="p">)</span></td></tr><tr><th id="L2671"><a href="#L2671">2671</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2672"><a href="#L2672">2672</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2673"><a href="#L2673">2673</a></th><td>                <span class="nx">wp_die</span><span class="p">();</span></td></tr><tr><th id="L2674"><a href="#L2674">2674</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2675"><a href="#L2675">2675</a></th><td></td></tr><tr><th id="L2676"><a href="#L2676">2676</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2677"><a href="#L2677">2677</a></th><td><span class="sd">         * Renders the tags for the post excerpt.</span></td></tr><tr><th id="L2678"><a href="#L2678">2678</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2679"><a href="#L2679">2679</a></th><td><span class="sd">         * @access  public</span></td></tr><tr><th id="L2680"><a href="#L2680">2680</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2681"><a href="#L2681">2681</a></th><td><span class="sd">         * @param array $default The default tags, empty.</span></td></tr><tr><th id="L2682"><a href="#L2682">2682</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2683"><a href="#L2683">2683</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">magic_tags_post_excerpt</span><span class="p">(</span> <span class="nv">$default</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2684"><a href="#L2684">2684</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_title'</span><span class="p">]</span>       <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Title'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2685"><a href="#L2685">2685</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_content'</span><span class="p">]</span>     <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Content'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2686"><a href="#L2686">2686</a></th><td>                <span class="nv">$default</span><span class="p">[</span><span class="s1">'item_description'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Item Description'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2687"><a href="#L2687">2687</a></th><td>                <span class="c1">// disabled tags.</span></td></tr><tr><th id="L2688"><a href="#L2688">2688</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">feedzy_is_pro</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2689"><a href="#L2689">2689</a></th><td>                        <span class="nv">$default</span><span class="p">[</span><span class="s1">'translated_title:disabled'</span><span class="p">]</span>       <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'🚫 Translated Title'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2690"><a href="#L2690">2690</a></th><td>                        <span class="nv">$default</span><span class="p">[</span><span class="s1">'translated_content:disabled'</span><span class="p">]</span>     <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'🚫 Translated Content'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2691"><a href="#L2691">2691</a></th><td>                        <span class="nv">$default</span><span class="p">[</span><span class="s1">'translated_description:disabled'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'🚫 Translated Description'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2692"><a href="#L2692">2692</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2693"><a href="#L2693">2693</a></th><td></td></tr><tr><th id="L2694"><a href="#L2694">2694</a></th><td>                <span class="k">return</span> <span class="nv">$default</span><span class="p">;</span></td></tr><tr><th id="L2695"><a href="#L2695">2695</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2696"><a href="#L2696">2696</a></th><td></td></tr><tr><th id="L2697"><a href="#L2697">2697</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2698"><a href="#L2698">2698</a></th><td><span class="sd">         * Check feedzy rewrite content tool enabled or not.</span></td></tr><tr><th id="L2699"><a href="#L2699">2699</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2700"><a href="#L2700">2700</a></th><td><span class="sd">         * @return bool</span></td></tr><tr><th id="L2701"><a href="#L2701">2701</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2702"><a href="#L2702">2702</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">rewrite_content_service_endabled</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2703"><a href="#L2703">2703</a></th><td>                <span class="c1">// Check license type.</span></td></tr><tr><th id="L2704"><a href="#L2704">2704</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_business</span><span class="p">()</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feedzy_is_agency</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2705"><a href="#L2705">2705</a></th><td>                        <span class="k">return</span> <span class="k">true</span><span class="p">;</span></td></tr><tr><th id="L2706"><a href="#L2706">2706</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2707"><a href="#L2707">2707</a></th><td></td></tr><tr><th id="L2708"><a href="#L2708">2708</a></th><td>                <span class="k">return</span> <span class="k">false</span><span class="p">;</span></td></tr><tr><th id="L2709"><a href="#L2709">2709</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2710"><a href="#L2710">2710</a></th><td></td></tr><tr><th id="L2711"><a href="#L2711">2711</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2712"><a href="#L2712">2712</a></th><td><span class="sd">         * Clone import job.</span></td></tr><tr><th id="L2713"><a href="#L2713">2713</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2714"><a href="#L2714">2714</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_clone_import_job</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2715"><a href="#L2715">2715</a></th><td>                <span class="c1">// Check if import job ID has been provided and action.</span></td></tr><tr><th id="L2716"><a href="#L2716">2716</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'feedzy_job_id'</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2717"><a href="#L2717">2717</a></th><td>                        <span class="nx">wp_die</span><span class="p">(</span> <span class="nx">esc_html__</span><span class="p">(</span> <span class="s1">'No post to duplicate has been provided!'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2718"><a href="#L2718">2718</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2719"><a href="#L2719">2719</a></th><td></td></tr><tr><th id="L2720"><a href="#L2720">2720</a></th><td>                <span class="c1">// Nonce verification.</span></td></tr><tr><th id="L2721"><a href="#L2721">2721</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'clone_import'</span><span class="p">]</span> <span class="p">)</span> <span class="o">||</span> <span class="o">!</span> <span class="nx">wp_verify_nonce</span><span class="p">(</span> <span class="nx">sanitize_key</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'clone_import'</span><span class="p">]</span> <span class="p">)</span> <span class="p">),</span> <span class="nx">FEEDZY_BASENAME</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2722"><a href="#L2722">2722</a></th><td>                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L2723"><a href="#L2723">2723</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2724"><a href="#L2724">2724</a></th><td></td></tr><tr><th id="L2725"><a href="#L2725">2725</a></th><td>                <span class="c1">// Get the original import job ID.</span></td></tr><tr><th id="L2726"><a href="#L2726">2726</a></th><td><span class="c1"></span>                <span class="nv">$feedzy_job_id</span> <span class="o">=</span> <span class="nx">absint</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'feedzy_job_id'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L2727"><a href="#L2727">2727</a></th><td>                <span class="c1">// Get the original import job.</span></td></tr><tr><th id="L2728"><a href="#L2728">2728</a></th><td><span class="c1"></span>                <span class="nv">$feedzy_job</span> <span class="o">=</span> <span class="nx">get_post</span><span class="p">(</span> <span class="nv">$feedzy_job_id</span> <span class="p">);</span></td></tr><tr><th id="L2729"><a href="#L2729">2729</a></th><td></td></tr><tr><th id="L2730"><a href="#L2730">2730</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$feedzy_job</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2731"><a href="#L2731">2731</a></th><td>                        <span class="nv">$current_user</span>    <span class="o">=</span> <span class="nx">wp_get_current_user</span><span class="p">();</span></td></tr><tr><th id="L2732"><a href="#L2732">2732</a></th><td>                        <span class="nv">$new_post_author</span> <span class="o">=</span> <span class="nv">$current_user</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">;</span></td></tr><tr><th id="L2733"><a href="#L2733">2733</a></th><td></td></tr><tr><th id="L2734"><a href="#L2734">2734</a></th><td>                        <span class="c1">// new post data array</span></td></tr><tr><th id="L2735"><a href="#L2735">2735</a></th><td><span class="c1"></span>                        <span class="nv">$args</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2736"><a href="#L2736">2736</a></th><td>                                <span class="s1">'post_author'</span> <span class="o">=&gt;</span> <span class="nv">$new_post_author</span><span class="p">,</span></td></tr><tr><th id="L2737"><a href="#L2737">2737</a></th><td>                                <span class="s1">'post_status'</span> <span class="o">=&gt;</span> <span class="s1">'draft'</span><span class="p">,</span></td></tr><tr><th id="L2738"><a href="#L2738">2738</a></th><td>                                <span class="s1">'post_title'</span>  <span class="o">=&gt;</span> <span class="nv">$feedzy_job</span><span class="o">-&gt;</span><span class="na">post_title</span><span class="p">,</span></td></tr><tr><th id="L2739"><a href="#L2739">2739</a></th><td>                                <span class="s1">'post_type'</span>   <span class="o">=&gt;</span> <span class="nv">$feedzy_job</span><span class="o">-&gt;</span><span class="na">post_type</span><span class="p">,</span></td></tr><tr><th id="L2740"><a href="#L2740">2740</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2741"><a href="#L2741">2741</a></th><td></td></tr><tr><th id="L2742"><a href="#L2742">2742</a></th><td>                        <span class="c1">// insert the new import job by wp_insert_post() function.</span></td></tr><tr><th id="L2743"><a href="#L2743">2743</a></th><td><span class="c1"></span>                        <span class="nv">$new_post_id</span> <span class="o">=</span> <span class="nx">wp_insert_post</span><span class="p">(</span> <span class="nv">$args</span> <span class="p">);</span></td></tr><tr><th id="L2744"><a href="#L2744">2744</a></th><td>                        <span class="c1">// Get all post meta.</span></td></tr><tr><th id="L2745"><a href="#L2745">2745</a></th><td><span class="c1"></span>                        <span class="nv">$post_meta</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$feedzy_job_id</span> <span class="p">);</span></td></tr><tr><th id="L2746"><a href="#L2746">2746</a></th><td>                        <span class="c1">// Exclude metakey.</span></td></tr><tr><th id="L2747"><a href="#L2747">2747</a></th><td><span class="c1"></span>                        <span class="nv">$blacklist_metakey</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2748"><a href="#L2748">2748</a></th><td>                                <span class="s1">'import_errors'</span><span class="p">,</span></td></tr><tr><th id="L2749"><a href="#L2749">2749</a></th><td>                                <span class="s1">'import_info'</span><span class="p">,</span></td></tr><tr><th id="L2750"><a href="#L2750">2750</a></th><td>                                <span class="s1">'_edit_lock'</span><span class="p">,</span></td></tr><tr><th id="L2751"><a href="#L2751">2751</a></th><td>                                <span class="s1">'last_run_id'</span><span class="p">,</span></td></tr><tr><th id="L2752"><a href="#L2752">2752</a></th><td>                                <span class="s1">'last_run'</span><span class="p">,</span></td></tr><tr><th id="L2753"><a href="#L2753">2753</a></th><td>                                <span class="s1">'imported_items_hash'</span><span class="p">,</span></td></tr><tr><th id="L2754"><a href="#L2754">2754</a></th><td>                                <span class="s1">'imported_items_count'</span><span class="p">,</span></td></tr><tr><th id="L2755"><a href="#L2755">2755</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2756"><a href="#L2756">2756</a></th><td></td></tr><tr><th id="L2757"><a href="#L2757">2757</a></th><td>                        <span class="k">if</span> <span class="p">(</span> <span class="nv">$post_meta</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2758"><a href="#L2758">2758</a></th><td>                                <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$post_meta</span> <span class="k">as</span> <span class="nv">$meta_key</span> <span class="o">=&gt;</span> <span class="nv">$meta_values</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2759"><a href="#L2759">2759</a></th><td>                                        <span class="k">if</span> <span class="p">(</span> <span class="nb">in_array</span><span class="p">(</span> <span class="nv">$meta_key</span><span class="p">,</span> <span class="nv">$blacklist_metakey</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2760"><a href="#L2760">2760</a></th><td>                                                <span class="k">continue</span><span class="p">;</span></td></tr><tr><th id="L2761"><a href="#L2761">2761</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L2762"><a href="#L2762">2762</a></th><td>                                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$meta_values</span> <span class="k">as</span> <span class="nv">$meta_value</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2763"><a href="#L2763">2763</a></th><td>                                                <span class="nx">add_post_meta</span><span class="p">(</span> <span class="nv">$new_post_id</span><span class="p">,</span> <span class="nv">$meta_key</span><span class="p">,</span> <span class="nv">$meta_value</span> <span class="p">);</span></td></tr><tr><th id="L2764"><a href="#L2764">2764</a></th><td>                                        <span class="p">}</span></td></tr><tr><th id="L2765"><a href="#L2765">2765</a></th><td>                                <span class="p">}</span></td></tr><tr><th id="L2766"><a href="#L2766">2766</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2767"><a href="#L2767">2767</a></th><td></td></tr><tr><th id="L2768"><a href="#L2768">2768</a></th><td>                        <span class="nx">wp_safe_redirect</span><span class="p">(</span></td></tr><tr><th id="L2769"><a href="#L2769">2769</a></th><td>                                <span class="nx">add_query_arg</span><span class="p">(</span></td></tr><tr><th id="L2770"><a href="#L2770">2770</a></th><td>                                        <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2771"><a href="#L2771">2771</a></th><td>                                                <span class="s1">'post_type'</span> <span class="o">=&gt;</span> <span class="p">(</span> <span class="s1">'post'</span> <span class="o">!==</span> <span class="nx">get_post_type</span><span class="p">(</span> <span class="nv">$feedzy_job</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">get_post_type</span><span class="p">(</span> <span class="nv">$feedzy_job</span> <span class="p">)</span> <span class="o">:</span> <span class="k">false</span> <span class="p">),</span></td></tr><tr><th id="L2772"><a href="#L2772">2772</a></th><td>                                                <span class="s1">'saved'</span>     <span class="o">=&gt;</span> <span class="s1">'fz_duplicate_import_job_created'</span><span class="p">,</span></td></tr><tr><th id="L2773"><a href="#L2773">2773</a></th><td>                                        <span class="p">),</span></td></tr><tr><th id="L2774"><a href="#L2774">2774</a></th><td>                                        <span class="nx">admin_url</span><span class="p">(</span> <span class="s1">'edit.php'</span> <span class="p">)</span></td></tr><tr><th id="L2775"><a href="#L2775">2775</a></th><td>                                <span class="p">)</span></td></tr><tr><th id="L2776"><a href="#L2776">2776</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2777"><a href="#L2777">2777</a></th><td>                        <span class="k">exit</span><span class="p">;</span></td></tr><tr><th id="L2778"><a href="#L2778">2778</a></th><td>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></td></tr><tr><th id="L2779"><a href="#L2779">2779</a></th><td>                        <span class="nx">wp_die</span><span class="p">(</span> <span class="nx">esc_html__</span><span class="p">(</span> <span class="s1">'Post creation failed, could not find original post.'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">)</span> <span class="p">);</span></td></tr><tr><th id="L2780"><a href="#L2780">2780</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2781"><a href="#L2781">2781</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2782"><a href="#L2782">2782</a></th><td></td></tr><tr><th id="L2783"><a href="#L2783">2783</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2784"><a href="#L2784">2784</a></th><td><span class="sd">         * Display import job clone notice.</span></td></tr><tr><th id="L2785"><a href="#L2785">2785</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2786"><a href="#L2786">2786</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_import_clone_success_notice</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2787"><a href="#L2787">2787</a></th><td>                <span class="c1">// Get the current screen.</span></td></tr><tr><th id="L2788"><a href="#L2788">2788</a></th><td><span class="c1"></span>                <span class="nv">$screen</span> <span class="o">=</span> <span class="nx">get_current_screen</span><span class="p">();</span></td></tr><tr><th id="L2789"><a href="#L2789">2789</a></th><td></td></tr><tr><th id="L2790"><a href="#L2790">2790</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="s1">'edit'</span> <span class="o">!==</span> <span class="nv">$screen</span><span class="o">-&gt;</span><span class="na">base</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2791"><a href="#L2791">2791</a></th><td>                        <span class="k">return</span><span class="p">;</span></td></tr><tr><th id="L2792"><a href="#L2792">2792</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2793"><a href="#L2793">2793</a></th><td></td></tr><tr><th id="L2794"><a href="#L2794">2794</a></th><td>                <span class="c1">// Display success notice if clone succeed.</span></td></tr><tr><th id="L2795"><a href="#L2795">2795</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'saved'</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="s1">'fz_duplicate_import_job_created'</span> <span class="o">===</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'saved'</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span> <span class="c1">// phpcs:ignore WordPress.Security.NonceVerification</span></td></tr><tr><th id="L2796"><a href="#L2796">2796</a></th><td><span class="c1"></span>                        <span class="cp">?&gt;</span><span class="x"></span></td></tr><tr><th id="L2797"><a href="#L2797">2797</a></th><td><span class="x">&lt;div class="notice notice-success is-dismissible"&gt;</span></td></tr><tr><th id="L2798"><a href="#L2798">2798</a></th><td><span class="x">        &lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="nx">esc_html_e</span><span class="p">(</span> <span class="s1">'Duplicate import job created'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/p&gt;</span></td></tr><tr><th id="L2799"><a href="#L2799">2799</a></th><td><span class="x">&lt;/div&gt;</span></td></tr><tr><th id="L2800"><a href="#L2800">2800</a></th><td><span class="x">                        </span><span class="cp">&lt;?php</span></td></tr><tr><th id="L2801"><a href="#L2801">2801</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2802"><a href="#L2802">2802</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2803"><a href="#L2803">2803</a></th><td></td></tr><tr><th id="L2804"><a href="#L2804">2804</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2805"><a href="#L2805">2805</a></th><td><span class="sd">         * Trim tags.</span></td></tr><tr><th id="L2806"><a href="#L2806">2806</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2807"><a href="#L2807">2807</a></th><td><span class="sd">         * @param string $content Field value.</span></td></tr><tr><th id="L2808"><a href="#L2808">2808</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2809"><a href="#L2809">2809</a></th><td><span class="sd">         * @return string</span></td></tr><tr><th id="L2810"><a href="#L2810">2810</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2811"><a href="#L2811">2811</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">feedzy_import_trim_tags</span><span class="p">(</span> <span class="nv">$content</span> <span class="o">=</span> <span class="s1">''</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2812"><a href="#L2812">2812</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$content</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">is_string</span><span class="p">(</span> <span class="nv">$content</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2813"><a href="#L2813">2813</a></th><td>                        <span class="nv">$content</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span> <span class="s1">','</span><span class="p">,</span> <span class="nv">$content</span> <span class="p">);</span></td></tr><tr><th id="L2814"><a href="#L2814">2814</a></th><td>                        <span class="nv">$content</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span> <span class="s1">'trim'</span><span class="p">,</span> <span class="nv">$content</span> <span class="p">);</span></td></tr><tr><th id="L2815"><a href="#L2815">2815</a></th><td>                        <span class="nv">$content</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span> <span class="s1">' '</span><span class="p">,</span> <span class="nv">$content</span> <span class="p">);</span></td></tr><tr><th id="L2816"><a href="#L2816">2816</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2817"><a href="#L2817">2817</a></th><td></td></tr><tr><th id="L2818"><a href="#L2818">2818</a></th><td>                <span class="k">return</span> <span class="nv">$content</span><span class="p">;</span></td></tr><tr><th id="L2819"><a href="#L2819">2819</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2820"><a href="#L2820">2820</a></th><td></td></tr><tr><th id="L2821"><a href="#L2821">2821</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2822"><a href="#L2822">2822</a></th><td><span class="sd">         * Run a wizard import feed.</span></td></tr><tr><th id="L2823"><a href="#L2823">2823</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2824"><a href="#L2824">2824</a></th><td>        <span class="k">private</span> <span class="k">function</span> <span class="nf">wizard_import_feed</span><span class="p">()</span> <span class="p">{</span></td></tr><tr><th id="L2825"><a href="#L2825">2825</a></th><td>                <span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="nx">FEEDZY_BASEFILE</span><span class="p">,</span> <span class="s1">'security'</span> <span class="p">);</span></td></tr><tr><th id="L2826"><a href="#L2826">2826</a></th><td></td></tr><tr><th id="L2827"><a href="#L2827">2827</a></th><td>                <span class="nv">$post_type</span>   <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'post_type'</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nb">filter_input</span><span class="p">(</span> <span class="nx">INPUT_POST</span><span class="p">,</span> <span class="s1">'post_type'</span><span class="p">,</span> <span class="nx">FILTER_UNSAFE_RAW</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">''</span><span class="p">;</span></td></tr><tr><th id="L2828"><a href="#L2828">2828</a></th><td>                <span class="nv">$wizard_data</span> <span class="o">=</span> <span class="nx">get_option</span><span class="p">(</span> <span class="s1">'feedzy_wizard_data'</span><span class="p">,</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span></td></tr><tr><th id="L2829"><a href="#L2829">2829</a></th><td>                <span class="nv">$wizard_data</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wizard_data</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$wizard_data</span> <span class="o">:</span> <span class="k">array</span><span class="p">();</span></td></tr><tr><th id="L2830"><a href="#L2830">2830</a></th><td>                <span class="nv">$wizard_data</span><span class="p">[</span><span class="s1">'post_type'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$post_type</span><span class="p">;</span></td></tr><tr><th id="L2831"><a href="#L2831">2831</a></th><td></td></tr><tr><th id="L2832"><a href="#L2832">2832</a></th><td>                <span class="nv">$post_title</span> <span class="o">=</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Setup Wizard'</span><span class="p">,</span> <span class="s1">'feedzy-rss-feeds'</span> <span class="p">);</span></td></tr><tr><th id="L2833"><a href="#L2833">2833</a></th><td>                <span class="nv">$job_id</span>     <span class="o">=</span> <span class="nx">post_exists</span><span class="p">(</span> <span class="nv">$post_title</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">'feedzy_imports'</span> <span class="p">);</span></td></tr><tr><th id="L2834"><a href="#L2834">2834</a></th><td></td></tr><tr><th id="L2835"><a href="#L2835">2835</a></th><td>                <span class="nv">$response</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2836"><a href="#L2836">2836</a></th><td>                        <span class="s1">'status'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L2837"><a href="#L2837">2837</a></th><td>                <span class="p">);</span></td></tr><tr><th id="L2838"><a href="#L2838">2838</a></th><td></td></tr><tr><th id="L2839"><a href="#L2839">2839</a></th><td>                <span class="c1">// Delete previous meta data.</span></td></tr><tr><th id="L2840"><a href="#L2840">2840</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="nv">$job_id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2841"><a href="#L2841">2841</a></th><td>                        <span class="nv">$meta</span> <span class="o">=</span> <span class="nx">get_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span> <span class="p">);</span></td></tr><tr><th id="L2842"><a href="#L2842">2842</a></th><td>                        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$meta</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2843"><a href="#L2843">2843</a></th><td>                                <span class="nx">delete_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span><span class="p">,</span> <span class="nv">$key</span> <span class="p">);</span></td></tr><tr><th id="L2844"><a href="#L2844">2844</a></th><td>                        <span class="p">}</span></td></tr><tr><th id="L2845"><a href="#L2845">2845</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2846"><a href="#L2846">2846</a></th><td></td></tr><tr><th id="L2847"><a href="#L2847">2847</a></th><td>                <span class="c1">// Create new import job.</span></td></tr><tr><th id="L2848"><a href="#L2848">2848</a></th><td><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$job_id</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2849"><a href="#L2849">2849</a></th><td>                        <span class="nv">$job_id</span> <span class="o">=</span> <span class="nx">wp_insert_post</span><span class="p">(</span></td></tr><tr><th id="L2850"><a href="#L2850">2850</a></th><td>                                <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2851"><a href="#L2851">2851</a></th><td>                                        <span class="s1">'post_title'</span> <span class="o">=&gt;</span> <span class="nv">$post_title</span><span class="p">,</span></td></tr><tr><th id="L2852"><a href="#L2852">2852</a></th><td>                                        <span class="s1">'post_type'</span> <span class="o">=&gt;</span> <span class="s1">'feedzy_imports'</span><span class="p">,</span></td></tr><tr><th id="L2853"><a href="#L2853">2853</a></th><td>                                        <span class="s1">'post_status'</span> <span class="o">=&gt;</span> <span class="s1">'publish'</span><span class="p">,</span></td></tr><tr><th id="L2854"><a href="#L2854">2854</a></th><td>                                <span class="p">)</span></td></tr><tr><th id="L2855"><a href="#L2855">2855</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2856"><a href="#L2856">2856</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2857"><a href="#L2857">2857</a></th><td></td></tr><tr><th id="L2858"><a href="#L2858">2858</a></th><td>                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$job_id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2859"><a href="#L2859">2859</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span><span class="p">,</span> <span class="s1">'source'</span><span class="p">,</span> <span class="nv">$wizard_data</span><span class="p">[</span><span class="s1">'feed'</span><span class="p">]</span> <span class="p">);</span></td></tr><tr><th id="L2860"><a href="#L2860">2860</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span><span class="p">,</span> <span class="s1">'import_post_title'</span><span class="p">,</span> <span class="s1">'[#item_title]'</span> <span class="p">);</span></td></tr><tr><th id="L2861"><a href="#L2861">2861</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span><span class="p">,</span> <span class="s1">'import_post_date'</span><span class="p">,</span> <span class="s1">'[#item_date]'</span> <span class="p">);</span></td></tr><tr><th id="L2862"><a href="#L2862">2862</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span><span class="p">,</span> <span class="s1">'import_post_content'</span><span class="p">,</span> <span class="s1">'[#item_content]'</span> <span class="p">);</span></td></tr><tr><th id="L2863"><a href="#L2863">2863</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span><span class="p">,</span> <span class="s1">'import_post_content'</span><span class="p">,</span> <span class="s1">'[#item_content]'</span> <span class="p">);</span></td></tr><tr><th id="L2864"><a href="#L2864">2864</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span><span class="p">,</span> <span class="s1">'import_post_type'</span><span class="p">,</span> <span class="nv">$post_type</span> <span class="p">);</span></td></tr><tr><th id="L2865"><a href="#L2865">2865</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span><span class="p">,</span> <span class="s1">'import_post_status'</span><span class="p">,</span> <span class="s1">'publish'</span> <span class="p">);</span></td></tr><tr><th id="L2866"><a href="#L2866">2866</a></th><td>                        <span class="nx">update_post_meta</span><span class="p">(</span> <span class="nv">$job_id</span><span class="p">,</span> <span class="s1">'import_post_featured_img'</span><span class="p">,</span> <span class="s1">'[#item_image]'</span> <span class="p">);</span></td></tr><tr><th id="L2867"><a href="#L2867">2867</a></th><td></td></tr><tr><th id="L2868"><a href="#L2868">2868</a></th><td>                        <span class="c1">// Update wizard data.</span></td></tr><tr><th id="L2869"><a href="#L2869">2869</a></th><td><span class="c1"></span>                        <span class="nx">update_option</span><span class="p">(</span> <span class="s1">'feedzy_wizard_data'</span><span class="p">,</span> <span class="nv">$wizard_data</span> <span class="p">);</span></td></tr><tr><th id="L2870"><a href="#L2870">2870</a></th><td></td></tr><tr><th id="L2871"><a href="#L2871">2871</a></th><td>                        <span class="nv">$job</span>   <span class="o">=</span> <span class="nx">get_post</span><span class="p">(</span> <span class="nv">$job_id</span> <span class="p">);</span></td></tr><tr><th id="L2872"><a href="#L2872">2872</a></th><td>                        <span class="nv">$count</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">run_job</span><span class="p">(</span> <span class="nv">$job</span><span class="p">,</span> <span class="mi">10</span> <span class="p">);</span></td></tr><tr><th id="L2873"><a href="#L2873">2873</a></th><td>                        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">'feedzy_run_cron_extra'</span><span class="p">,</span> <span class="nv">$job</span> <span class="p">);</span></td></tr><tr><th id="L2874"><a href="#L2874">2874</a></th><td>                        <span class="nv">$response</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span></td></tr><tr><th id="L2875"><a href="#L2875">2875</a></th><td>                                <span class="s1">'status'</span> <span class="o">=&gt;</span> <span class="nv">$count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span></td></tr><tr><th id="L2876"><a href="#L2876">2876</a></th><td>                        <span class="p">);</span></td></tr><tr><th id="L2877"><a href="#L2877">2877</a></th><td>                <span class="p">}</span></td></tr><tr><th id="L2878"><a href="#L2878">2878</a></th><td>                <span class="nx">wp_send_json</span><span class="p">(</span> <span class="nv">$response</span> <span class="p">);</span></td></tr><tr><th id="L2879"><a href="#L2879">2879</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2880"><a href="#L2880">2880</a></th><td></td></tr><tr><th id="L2881"><a href="#L2881">2881</a></th><td>        <span class="sd">/**</span></td></tr><tr><th id="L2882"><a href="#L2882">2882</a></th><td><span class="sd">         * Handle item content actions.</span></td></tr><tr><th id="L2883"><a href="#L2883">2883</a></th><td><span class="sd">         *</span></td></tr><tr><th id="L2884"><a href="#L2884">2884</a></th><td><span class="sd">         * @param string $actions Item content actions.</span></td></tr><tr><th id="L2885"><a href="#L2885">2885</a></th><td><span class="sd">         * @param string $type Action type.</span></td></tr><tr><th id="L2886"><a href="#L2886">2886</a></th><td><span class="sd">         * @return object `Feedzy_Rss_Feeds_Actions` class instance.</span></td></tr><tr><th id="L2887"><a href="#L2887">2887</a></th><td><span class="sd">         */</span></td></tr><tr><th id="L2888"><a href="#L2888">2888</a></th><td>        <span class="k">public</span> <span class="k">function</span> <span class="nf">handle_content_actions</span><span class="p">(</span> <span class="nv">$actions</span> <span class="o">=</span> <span class="s1">''</span><span class="p">,</span> <span class="nv">$type</span> <span class="o">=</span> <span class="s1">''</span> <span class="p">)</span> <span class="p">{</span></td></tr><tr><th id="L2889"><a href="#L2889">2889</a></th><td>                <span class="nv">$action_instance</span>       <span class="o">=</span> <span class="nx">Feedzy_Rss_Feeds_Actions</span><span class="o">::</span><span class="na">instance</span><span class="p">();</span></td></tr><tr><th id="L2890"><a href="#L2890">2890</a></th><td>                <span class="nv">$action_instance</span><span class="o">-&gt;</span><span class="na">type</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span></td></tr><tr><th id="L2891"><a href="#L2891">2891</a></th><td>                <span class="nv">$action_instance</span><span class="o">-&gt;</span><span class="na">set_actions</span><span class="p">(</span> <span class="nv">$actions</span> <span class="p">);</span></td></tr><tr><th id="L2892"><a href="#L2892">2892</a></th><td>                <span class="nv">$action_instance</span><span class="o">-&gt;</span><span class="na">set_settings</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">settings</span> <span class="p">);</span></td></tr><tr><th id="L2893"><a href="#L2893">2893</a></th><td>                <span class="k">return</span> <span class="nv">$action_instance</span><span class="p">;</span></td></tr><tr><th id="L2894"><a href="#L2894">2894</a></th><td>        <span class="p">}</span></td></tr><tr><th id="L2895"><a href="#L2895">2895</a></th><td><span class="p">}</span></td></tr></tbody></table>

      </div>
      <div id="anydiff">
        <form action="/diff" method="get">
          <div style="display:none;"><input type="text" name="sfp_email" value="" /><input type="hidden" name="sfph_mail" value="" /></div><div class="buttons">
            <input type="hidden" name="new_path" value="/feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php" />
            <input type="hidden" name="old_path" value="/feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php" />
            <input type="hidden" name="new_rev" />
            <input type="hidden" name="old_rev" />
            <input type="submit" value="View changes..." title="Select paths and revs for Diff" />
          </div>
        </form>
      </div>
      <div id="help"><strong>Note:</strong> See <a href="/wiki/TracBrowser">TracBrowser</a>
        for help on using the repository browser.</div>
    </div>
    <div id="altlinks">
    <a class="preferences-link" href="/prefs">Trac UI Preferences</a>
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="/browser/feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php?format=txt">Plain Text</a>
        </li><li class="last">
          <a rel="nofollow" href="/export/3220479/feedzy-rss-feeds/tags/4.4.2/includes/admin/feedzy-rss-feeds-import.php">Original Format</a>
        </li>
      </ul>
</div>
    </div>
	<footer class="global-footer wp-block-group wp-block-wporg-global-footer">
<div class="wp-block-group global-footer__navigation-container is-layout-flow wp-block-group-is-layout-flow">
	<nav class="global-footer__navigation-important wp-block-navigation is-layout-flex wp-block-navigation-is-layout-flex" aria-label=""><ul class="wp-block-navigation__container"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/about/"><span class="wp-block-navigation-item__label">About</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/news/"><span class="wp-block-navigation-item__label">News</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/hosting/"><span class="wp-block-navigation-item__label">Hosting</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpressfoundation.org/donate/"><span class="wp-block-navigation-item__label">Donate</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://mercantile.wordpress.org/"><span class="wp-block-navigation-item__label">Swag</span></a></li></ul></nav>
	<nav class="global-footer__navigation-information wp-block-navigation is-layout-flex wp-block-navigation-is-layout-flex" aria-label=""><ul class="wp-block-navigation__container"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/documentation/"><span class="wp-block-navigation-item__label">Documentation</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://developer.wordpress.org/"><span class="wp-block-navigation-item__label">Developers</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://make.wordpress.org/"><span class="wp-block-navigation-item__label">Get Involved</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://learn.wordpress.org/"><span class="wp-block-navigation-item__label">Learn</span></a></li></ul></nav>
	<nav class="global-footer__navigation-resources wp-block-navigation is-layout-flex wp-block-navigation-is-layout-flex" aria-label=""><ul class="wp-block-navigation__container"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/showcase/"><span class="wp-block-navigation-item__label">Showcase</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/plugins/"><span class="wp-block-navigation-item__label">Plugins</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/themes/"><span class="wp-block-navigation-item__label">Themes</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/patterns/"><span class="wp-block-navigation-item__label">Patterns</span></a></li></ul></nav>
	<nav class="global-footer__navigation-community wp-block-navigation is-layout-flex wp-block-navigation-is-layout-flex" aria-label=""><ul class="wp-block-navigation__container"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://central.wordcamp.org/"><span class="wp-block-navigation-item__label">WordCamp</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.tv/"><span class="wp-block-navigation-item__label">WordPress.TV</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://buddypress.org/"><span class="wp-block-navigation-item__label">BuddyPress</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://bbpress.org/"><span class="wp-block-navigation-item__label">bbPress</span></a></li></ul></nav>
	<nav class="global-footer__navigation-external wp-block-navigation is-layout-flex wp-block-navigation-is-layout-flex" aria-label=""><ul class="wp-block-navigation__container"><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.com/?ref=wporg-footer"><span class="wp-block-navigation-item__label">WordPress.com</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://ma.tt/"><span class="wp-block-navigation-item__label">Matt</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://wordpress.org/about/privacy/"><span class="wp-block-navigation-item__label">Privacy</span></a></li><li class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content" href="https://publiccode.eu/"><span class="wp-block-navigation-item__label">Public Code</span></a></li></ul></nav>
</div>
<div class="wp-block-group global-footer__logos-container is-layout-flow wp-block-group-is-layout-flow">
	<div class="wp-block-group is-content-justification-left is-nowrap is-layout-flex wp-container-19 wp-block-group-is-layout-flex">
			<figure class="wp-block-image global-footer__wporg-logo-mark">
				<a href="https://wordpress.org/">
					<svg xmlns="http://www.w3.org/2000/svg" role="img" width="28" height="28" viewbox="0 0 28 28">
	<title>WordPress.org</title>
	<path fill="currentColor" d="M13.6052 0.923525C16.1432 0.923525 18.6137 1.67953 20.7062 3.09703C22.7447 4.47403 24.3512 6.41803 25.3097 8.68603C26.9837 12.6415 26.5382 17.164 24.1352 20.7145C22.7582 22.753 20.8142 24.3595 18.5462 25.318C14.5907 26.992 10.0682 26.5465 6.51772 24.1435C4.47922 22.7665 2.87272 20.8225 1.91422 18.5545C0.240225 14.599 0.685725 10.0765 3.08872 6.52603C4.46572 4.48753 6.40973 2.88103 8.67772 1.92253C10.2302 1.26103 11.9177 0.923525 13.6052 0.923525ZM13.6052 0.113525C6.15322 0.113525 0.105225 6.16153 0.105225 13.6135C0.105225 21.0655 6.15322 27.1135 13.6052 27.1135C21.0572 27.1135 27.1052 21.0655 27.1052 13.6135C27.1052 6.16153 21.0572 0.113525 13.6052 0.113525Z"></path>
	<path fill="currentColor" d="M2.36011 13.6133C2.36011 17.9198 4.81711 21.8618 8.70511 23.7383L3.33211 9.03684C2.68411 10.4813 2.36011 12.0338 2.36011 13.6133ZM21.2061 13.0463C21.2061 11.6558 20.7066 10.6973 20.2746 9.94134C19.8426 9.18534 19.1676 8.22684 19.1676 7.30884C19.1676 6.39084 19.9506 5.31084 21.0576 5.31084H21.2061C16.6296 1.11234 9.51511 1.42284 5.31661 6.01284C4.91161 6.45834 4.53361 6.93084 4.20961 7.43034H4.93861C6.11311 7.43034 7.93561 7.28184 7.93561 7.28184C8.54311 7.24134 8.61061 8.13234 8.00311 8.21334C8.00311 8.21334 7.39561 8.28084 6.72061 8.32134L10.8111 20.5118L13.2681 13.1273L11.5131 8.32134C10.9056 8.28084 10.3386 8.21334 10.3386 8.21334C9.73111 8.17284 9.79861 7.25484 10.4061 7.28184C10.4061 7.28184 12.2691 7.43034 13.3626 7.43034C14.4561 7.43034 16.3596 7.28184 16.3596 7.28184C16.9671 7.24134 17.0346 8.13234 16.4271 8.21334C16.4271 8.21334 15.8196 8.28084 15.1446 8.32134L19.2081 20.4173L20.3691 16.7453C20.8821 15.1388 21.1926 14.0048 21.1926 13.0328L21.2061 13.0463ZM13.7946 14.5853L10.4196 24.3998C12.6876 25.0613 15.1041 25.0073 17.3316 24.2243L17.2506 24.0758L13.7946 14.5853ZM23.4741 8.21334C23.5281 8.59134 23.5551 8.98284 23.5551 9.37434C23.5551 10.5218 23.3391 11.8043 22.7046 13.3973L19.2621 23.3333C24.5271 20.2688 26.4036 13.5593 23.4741 8.21334Z"></path>
</svg>				</a>
			</figure>
			<figure class="wp-block-image global-footer__wporg-logo-full">
				<a href="https://wordpress.org/">
					<svg xmlns="http://www.w3.org/2000/svg" role="img" width="329" height="52" viewbox="0 0 329 52">
	<title>WordPress.org</title>
	<path fill="currentColor" d="M4.33 26a21.68 21.68 0 0 0 12.22 19.5L6.21 17.18A21.66 21.66 0 0 0 4.33 26ZM26.38 27.89l-6.5 18.89a21.31 21.31 0 0 0 6.12.89 21.77 21.77 0 0 0 7.2-1.23 1.429 1.429 0 0 1-.16-.3l-6.66-18.25Z"></path>
	<path fill="currentColor" d="M26 0a26 26 0 1 0 0 52 26 26 0 0 0 0-52Zm20.27 39.66a24.47 24.47 0 0 1-29.78 8.86 24.49 24.49 0 0 1-13-13 24.4 24.4 0 0 1 5.23-26.8 24.46 24.46 0 0 1 26.79-5.24 24.49 24.49 0 0 1 13 13 24.42 24.42 0 0 1-2.25 23.17l.01.01Z"></path>
	<path fill="currentColor" d="M45 15.61c.103.736.153 1.477.15 2.22a20.38 20.38 0 0 1-1.65 7.76l-6.61 19.14A21.65 21.65 0 0 0 45 15.61ZM40.63 24.91a11.45 11.45 0 0 0-1.79-6c-1.1-1.78-2.13-3.29-2.13-5.08A3.76 3.76 0 0 1 40.35 10h.28A21.65 21.65 0 0 0 7.9 14.1h1.39c2.27 0 5.78-.27 5.78-.27a.9.9 0 0 1 .13 1.79s-1.17.13-2.47.2l7.88 23.47 4.75-14.22L22 15.84c-1.17-.07-2.27-.2-2.27-.2a.9.9 0 0 1 .14-1.79s3.57.27 5.7.27c2.13 0 5.78-.27 5.78-.27a.9.9 0 0 1 .14 1.79s-1.18.13-2.48.2l7.83 23.29 2.23-7.08a25.171 25.171 0 0 0 1.56-7.14ZM145.83 19.3h-10.34v1.1c3.23 0 3.75.69 3.75 4.79v7.4c0 4.1-.52 4.85-3.75 4.85-2.48-.35-4.16-1.68-6.47-4.22l-2.66-2.89c3.58-.63 5.49-2.89 5.49-5.43 0-3.18-2.72-5.6-7.8-5.6h-10.17v1.1c3.24 0 3.76.69 3.76 4.79v7.4c0 4.1-.52 4.85-3.76 4.85v1.1h11.5v-1.1c-3.24 0-3.76-.75-3.76-4.85v-2.08h1l6.42 8h16.81c8.26 0 11.85-4.39 11.85-9.65 0-5.26-3.61-9.56-11.87-9.56Zm-24.21 9.42V21H124a3.551 3.551 0 0 1 3.76 3.87 3.536 3.536 0 0 1-3.76 3.85h-2.38Zm24.38 8h-.4c-2.08 0-2.37-.52-2.37-3.18V21H146c6 0 7.11 4.39 7.11 7.8S152 36.75 146 36.75v-.03ZM93.49 13.52H82.62v1.16c3.7 0 4.22 1 3.07 4.39l-4 11.78L76 13.52h-1.1l-5.85 17.33-3.87-11.78c-1.22-3.59-.29-4.39 3.12-4.39v-1.16H55.47v1.16c3.35 0 4.28.86 5.66 5.08l6.42 19.76h.75l6-18.08 5.9 18.08h.8l6.59-19.76c1.44-4.22 2.31-5.08 5.95-5.08l-.05-1.16ZM101.34 18.55c-6.35 0-11.55 4.68-11.55 10.34s5.2 10.4 11.55 10.4c6.35 0 11.56-4.68 11.56-10.4 0-5.72-5.2-10.34-11.56-10.34Zm0 18.89c-5.31 0-7.16-4.74-7.16-8.55 0-3.81 1.85-8.55 7.16-8.55 5.31 0 7.23 4.79 7.23 8.55 0 3.76-1.85 8.55-7.23 8.55ZM170.67 13.52h-12v1.16c3.88 0 4.57.92 4.57 6.7v9.24c0 5.78-.69 6.76-4.57 6.76v1.16H172v-1.16c-3.88 0-4.57-1-4.57-6.76v-2.83h3.29c6 0 9.25-3.12 9.25-7.11s-3.35-7.16-9.3-7.16Zm0 12.13h-3.29v-10h3.29c3.24 0 4.74 2.31 4.74 5.08s-1.5 4.92-4.74 4.92ZM219.32 34.15c-.52 1.9-1.15 2.6-5.26 2.6h-.81c-3 0-3.52-.7-3.52-4.8v-2.66c4.51 0 4.85.41 4.85 3.41h1.1v-8.61h-1.1c0 3-.34 3.41-4.85 3.41V21h3.18c4.1 0 4.74.69 5.26 2.6l.28 1.1h.93l-.38-5.4h-17v1.1c3.23 0 3.75.69 3.75 4.79v7.4c0 3.75-.44 4.69-3 4.83-2.42-.37-4.09-1.69-6.37-4.2l-2.65-2.89c3.58-.63 5.49-2.89 5.49-5.43 0-3.18-2.72-5.6-7.8-5.6h-10.17v1.1c3.23 0 3.75.69 3.75 4.79v7.4c0 4.1-.52 4.85-3.75 4.85v1.1h11.49v-1.1c-3.23 0-3.75-.75-3.75-4.85v-2.08h1l6.41 8h23.75l.35-5.43h-.87l-.31 1.07ZM189 28.72V21h2.37a3.542 3.542 0 0 1 3.75 3.87 3.532 3.532 0 0 1-.998 2.77 3.532 3.532 0 0 1-2.752 1.05l-2.37.03ZM234.52 27.91l-3.18-1.56c-2.78-1.27-4-2.08-4-3.59 0-1.51 1.5-2.36 3.12-2.36 3.06 0 4.57 2.25 5 5h1.21v-6.85h-1.09a3.415 3.415 0 0 1-.75 1.56 7.25 7.25 0 0 0-4.51-1.5c-3.58 0-6.18 2.36-6.18 5.14 0 2.54 1.73 4.45 4 5.54l3.29 1.56c2.37 1.1 3.7 2.26 3.7 3.76 0 1.73-1.5 2.77-3.35 2.77-3.41 0-6.07-2.25-6.53-6.06h-1.15v8h1.09a4.194 4.194 0 0 1 .93-2 8.481 8.481 0 0 0 5.2 2c3.87 0 7-2.54 7-6.18.07-1.77-1.03-3.9-3.8-5.23ZM252 27.91l-3.18-1.56c-2.78-1.27-4-2.08-4-3.59 0-1.51 1.5-2.36 3.12-2.36 3.06 0 4.57 2.25 5 5h1.21v-6.85H253a3.415 3.415 0 0 1-.75 1.56 7.25 7.25 0 0 0-4.51-1.5c-3.58 0-6.18 2.36-6.18 5.14 0 2.54 1.73 4.45 4 5.54l3.29 1.56c2.37 1.1 3.7 2.26 3.7 3.76 0 1.73-1.5 2.77-3.35 2.77-3.41 0-6.07-2.25-6.53-6.06h-1.15v8h1.09a4.194 4.194 0 0 1 .93-2 8.481 8.481 0 0 0 5.2 2c3.87 0 7.05-2.54 7.05-6.18.07-1.77-1.03-3.9-3.79-5.23ZM277.56 18.75a10.481 10.481 0 0 0-10.68 10.17 10.47 10.47 0 0 0 10.68 10.16c5.9 0 10.71-4.58 10.71-10.16s-4.81-10.17-10.71-10.17Zm0 19c-5.52 0-7.63-4.91-7.63-8.88 0-3.97 2.07-8.87 7.63-8.87 5.56 0 7.66 4.94 7.66 8.92 0 3.98-2.11 8.88-7.66 8.88v-.05ZM301.71 33.79l-3.14-3.69c3.63-.38 5.71-2.59 5.71-5.38 0-3-2.44-5.42-6.89-5.42h-8.47v.7c2.66 0 3.05.51 3.05 3.72v10.39c0 3.21-.39 3.76-3.05 3.76v.67h8.66v-.67c-2.66 0-3.05-.55-3.05-3.76v-4H296l6.35 8.44h5.29v-.67c-1.88-.24-4.03-1.88-5.93-4.09ZM294.53 29v-8.52h2.82c2.79 0 4.08 1.93 4.08 4.24 0 2.31-1.29 4.28-4.08 4.28h-2.82ZM319.6 30.59v.64c2.21 0 3 .7 3 2.08 0 2.89-2.5 4.39-5.29 4.39-5.93 0-7.6-4.81-7.6-8.78 0-3.97 1.86-8.92 7-8.92 3.59 0 6.09 2.54 7 6.7h.64v-7h-.64a3.281 3.281 0 0 1-1.09 1.83 8.203 8.203 0 0 0-6-2.73 10.167 10.167 0 0 0-9.851 10.165 10.169 10.169 0 0 0 9.851 10.165c3.34 0 4.78-1.66 8.34-1.66V35c0-3.21.39-3.75 3.05-3.75v-.64l-8.41-.02ZM261.9 34.77a2.061 2.061 0 1 0 .288 4.112 2.061 2.061 0 0 0-.288-4.112Z"></path>
</svg>				</a>
			</figure>
			</div>
	<ul class="wp-block-social-links is-style-logos-only is-layout-flex wp-block-social-links-is-layout-flex">
		<li class="wp-social-link wp-social-link-facebook wp-block-social-link"><a href="https://www.facebook.com/WordPress/" class="wp-block-social-link-anchor"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" version="1.1" aria-hidden="true" focusable="false"><path d="M12 2C6.5 2 2 6.5 2 12c0 5 3.7 9.1 8.4 9.9v-7H7.9V12h2.5V9.8c0-2.5 1.5-3.9 3.8-3.9 1.1 0 2.2.2 2.2.2v2.5h-1.3c-1.2 0-1.6.8-1.6 1.6V12h2.8l-.4 2.9h-2.3v7C18.3 21.1 22 17 22 12c0-5.5-4.5-10-10-10z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Visit our Facebook page</span></a></li>
		<li class="wp-social-link wp-social-link-twitter wp-block-social-link"><a href="https://twitter.com/WordPress" class="wp-block-social-link-anchor"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" version="1.1" aria-hidden="true" focusable="false"><path d="M22.23,5.924c-0.736,0.326-1.527,0.547-2.357,0.646c0.847-0.508,1.498-1.312,1.804-2.27 c-0.793,0.47-1.671,0.812-2.606,0.996C18.324,4.498,17.257,4,16.077,4c-2.266,0-4.103,1.837-4.103,4.103 c0,0.322,0.036,0.635,0.106,0.935C8.67,8.867,5.647,7.234,3.623,4.751C3.27,5.357,3.067,6.062,3.067,6.814 c0,1.424,0.724,2.679,1.825,3.415c-0.673-0.021-1.305-0.206-1.859-0.513c0,0.017,0,0.034,0,0.052c0,1.988,1.414,3.647,3.292,4.023 c-0.344,0.094-0.707,0.144-1.081,0.144c-0.264,0-0.521-0.026-0.772-0.074c0.522,1.63,2.038,2.816,3.833,2.85 c-1.404,1.1-3.174,1.756-5.096,1.756c-0.331,0-0.658-0.019-0.979-0.057c1.816,1.164,3.973,1.843,6.29,1.843 c7.547,0,11.675-6.252,11.675-11.675c0-0.178-0.004-0.355-0.012-0.531C20.985,7.47,21.68,6.747,22.23,5.924z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Visit our Twitter account</span></a></li>
		<li class="wp-social-link wp-social-link-instagram wp-block-social-link"><a href="https://www.instagram.com/wordpress/" class="wp-block-social-link-anchor"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" version="1.1" aria-hidden="true" focusable="false"><path d="M12,4.622c2.403,0,2.688,0.009,3.637,0.052c0.877,0.04,1.354,0.187,1.671,0.31c0.42,0.163,0.72,0.358,1.035,0.673 c0.315,0.315,0.51,0.615,0.673,1.035c0.123,0.317,0.27,0.794,0.31,1.671c0.043,0.949,0.052,1.234,0.052,3.637 s-0.009,2.688-0.052,3.637c-0.04,0.877-0.187,1.354-0.31,1.671c-0.163,0.42-0.358,0.72-0.673,1.035 c-0.315,0.315-0.615,0.51-1.035,0.673c-0.317,0.123-0.794,0.27-1.671,0.31c-0.949,0.043-1.233,0.052-3.637,0.052 s-2.688-0.009-3.637-0.052c-0.877-0.04-1.354-0.187-1.671-0.31c-0.42-0.163-0.72-0.358-1.035-0.673 c-0.315-0.315-0.51-0.615-0.673-1.035c-0.123-0.317-0.27-0.794-0.31-1.671C4.631,14.688,4.622,14.403,4.622,12 s0.009-2.688,0.052-3.637c0.04-0.877,0.187-1.354,0.31-1.671c0.163-0.42,0.358-0.72,0.673-1.035 c0.315-0.315,0.615-0.51,1.035-0.673c0.317-0.123,0.794-0.27,1.671-0.31C9.312,4.631,9.597,4.622,12,4.622 M12,3 C9.556,3,9.249,3.01,8.289,3.054C7.331,3.098,6.677,3.25,6.105,3.472C5.513,3.702,5.011,4.01,4.511,4.511 c-0.5,0.5-0.808,1.002-1.038,1.594C3.25,6.677,3.098,7.331,3.054,8.289C3.01,9.249,3,9.556,3,12c0,2.444,0.01,2.751,0.054,3.711 c0.044,0.958,0.196,1.612,0.418,2.185c0.23,0.592,0.538,1.094,1.038,1.594c0.5,0.5,1.002,0.808,1.594,1.038 c0.572,0.222,1.227,0.375,2.185,0.418C9.249,20.99,9.556,21,12,21s2.751-0.01,3.711-0.054c0.958-0.044,1.612-0.196,2.185-0.418 c0.592-0.23,1.094-0.538,1.594-1.038c0.5-0.5,0.808-1.002,1.038-1.594c0.222-0.572,0.375-1.227,0.418-2.185 C20.99,14.751,21,14.444,21,12s-0.01-2.751-0.054-3.711c-0.044-0.958-0.196-1.612-0.418-2.185c-0.23-0.592-0.538-1.094-1.038-1.594 c-0.5-0.5-1.002-0.808-1.594-1.038c-0.572-0.222-1.227-0.375-2.185-0.418C14.751,3.01,14.444,3,12,3L12,3z M12,7.378 c-2.552,0-4.622,2.069-4.622,4.622S9.448,16.622,12,16.622s4.622-2.069,4.622-4.622S14.552,7.378,12,7.378z M12,15 c-1.657,0-3-1.343-3-3s1.343-3,3-3s3,1.343,3,3S13.657,15,12,15z M16.804,6.116c-0.596,0-1.08,0.484-1.08,1.08 s0.484,1.08,1.08,1.08c0.596,0,1.08-0.484,1.08-1.08S17.401,6.116,16.804,6.116z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Visit our Instagram account</span></a></li>
		<li class="wp-social-link wp-social-link-linkedin wp-block-social-link"><a href="https://www.linkedin.com/company/wordpress" class="wp-block-social-link-anchor"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" version="1.1" aria-hidden="true" focusable="false"><path d="M19.7,3H4.3C3.582,3,3,3.582,3,4.3v15.4C3,20.418,3.582,21,4.3,21h15.4c0.718,0,1.3-0.582,1.3-1.3V4.3 C21,3.582,20.418,3,19.7,3z M8.339,18.338H5.667v-8.59h2.672V18.338z M7.004,8.574c-0.857,0-1.549-0.694-1.549-1.548 c0-0.855,0.691-1.548,1.549-1.548c0.854,0,1.547,0.694,1.547,1.548C8.551,7.881,7.858,8.574,7.004,8.574z M18.339,18.338h-2.669 v-4.177c0-0.996-0.017-2.278-1.387-2.278c-1.389,0-1.601,1.086-1.601,2.206v4.249h-2.667v-8.59h2.559v1.174h0.037 c0.356-0.675,1.227-1.387,2.526-1.387c2.703,0,3.203,1.779,3.203,4.092V18.338z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Visit our LinkedIn account</span></a></li>
	</ul>
		<figure class="wp-block-image is-resized global-footer__code_is_poetry">
			<img src="https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg" alt="Code is Poetry" width="188" height="13" />
		</figure>
	</div>
</footer>		<script>//<![CDATA[
			( function() {
				var skipLink = document.getElementById( 'wporg-skip-link' ),
					skipLinkTarget, skipLinkTargetID;
				if ( ! skipLink ) {
					return;
				}
				skipLinkTarget = document.querySelector( skipLink.dataset.selector );
				if ( ! skipLinkTarget ) {
					skipLink.remove();
					return;
				}
				skipLinkTargetID = skipLinkTarget.id;
				if ( ! skipLinkTargetID ) {
					skipLinkTargetID = 'wp--skip-link--target';
					skipLinkTarget.id = skipLinkTargetID;
				}
				skipLink.href = '#' + skipLinkTargetID;
				skipLink.tabIndex = '';
			}() );
//]]></script>
		<style id="core-block-supports-inline-css" type="text/css">
.wp-container-6.wp-container-6{flex-direction:column;align-items:flex-start;}.wp-container-19.wp-container-19{flex-wrap:nowrap;justify-content:flex-start;}
</style>
<script type="text/javascript" id="wporg-global-header-script-js-extra">//<![CDATA[
/* <![CDATA[ */
var wporgGlobalHeaderI18n = {"openSearchLabel":"Open Search","closeSearchLabel":"Close Search","overflowMenuLabel":"More menu"};
/* ]]]]><![CDATA[> */
//]]></script>
<script type="text/javascript" src="https://wordpress.org/wp-content/plugins/jetpack/_inc/build/photon/photon.min.js?ver=20191001" id="jetpack-photon-js"></script>
<script type="text/javascript" src="https://s.w.org/wp-content/themes/pub/wporg/js/skip-link-focus-fix.min.js?ver=20151215" id="wporg-plugins-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="https://wordpress.org/wp-content/mu-plugins/pub-sync/blocks/global-header-footer/js/view.js?ver=1659374792" id="wporg-global-header-script-js"></script>
	<script>
	var wpTracCurrentUser = "anonymous";
	</script>
	<script src="https://s.w.org/style/js/navigation.min.js?20190128"></script>
	<script src="https://s.w.org/style/trac/jquery.caret.min.js?ver=2015-02-01"></script>
	<script src="https://s.w.org/style/trac/jquery.atwho.min.js?ver=1.0.1"></script>
	<script src="https://s.w.org/style/trac/wp-trac.js?212"></script>
</body>
</html>