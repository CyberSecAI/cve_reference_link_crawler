

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jan Kara <jack@suse.cz> | 2024-02-05 13:26:26 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-04-03 15:32:06 +0200 |
| commit | [cdd33d54e789d229d6d5007cbf3f53965ca1a5c6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6)) | |
| tree | [63caabc709ed7f6c9a6d9d5f641c5aae9783ea2c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6) | |
| parent | [cf778fff03be1ee88c49b72959650147573c3301](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cf778fff03be1ee88c49b72959650147573c3301) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6&id2=cf778fff03be1ee88c49b72959650147573c3301)) | |
| download | [linux-cdd33d54e789d229d6d5007cbf3f53965ca1a5c6.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-cdd33d54e789d229d6d5007cbf3f53965ca1a5c6.tar.gz) | |

fat: fix uninitialized field in nostale filehandles[ Upstream commit fde2497d2bc3a063d8af88b258dbadc86bd7b57c ]
When fat\_encode\_fh\_nostale() encodes file handle without a parent it
stores only first 10 bytes of the file handle. However the length of the
file handle must be a multiple of 4 so the file handle is actually 12
bytes long and the last two bytes remain uninitialized. This is not
great at we potentially leak uninitialized information with the handle
to userspace. Properly initialize the full handle length.
Link: [https://lkml.kernel.org/r/20240205122626.13701-1-jack@suse.cz](https://lkml.kernel.org/r/20240205122626.13701-1-jack%40suse.cz)
Reported-by: syzbot+3ce5dea5b1539ff36769@syzkaller.appspotmail.com
Fixes: ea3983ace6b7 ("fat: restructure export\_operations")
Signed-off-by: Jan Kara <jack@suse.cz>
Acked-by: OGAWA Hirofumi <hirofumi@mail.parknet.co.jp>
Cc: Amir Goldstein <amir73il@gmail.com>
Cc: <stable@vger.kernel.org>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6)

| -rw-r--r-- | [fs/fat/nfs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/fat/nfs.c?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/fs/fat/nfs.c b/fs/fat/nfs.cindex c52e63e10d35cd..509eea96a457d4 100644--- a/[fs/fat/nfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/fat/nfs.c?id=cf778fff03be1ee88c49b72959650147573c3301)+++ b/[fs/fat/nfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/fat/nfs.c?id=cdd33d54e789d229d6d5007cbf3f53965ca1a5c6)@@ -130,6 +130,12 @@ fat\_encode\_fh\_nostale(struct inode \*inode, \_\_u32 \*fh, int \*lenp, fid->parent\_i\_gen = parent->i\_generation; type = FILEID\_FAT\_WITH\_PARENT; \*lenp = FAT\_FID\_SIZE\_WITH\_PARENT;+ } else {+ /\*+ \* We need to initialize this field because the fh is actually+ \* 12 bytes long+ \*/+ fid->parent\_i\_pos\_hi = 0; }  return type; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 10:46:50 +0000

