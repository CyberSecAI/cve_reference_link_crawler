The provided content relates to CVE-2021-47509.

**Root cause of vulnerability:**
The vulnerability stems from the lack of a practical limit on the period size (fragment shift) in the OSS (Open Sound System) PCM (Pulse Code Modulation) interface within the ALSA (Advanced Linux Sound Architecture) subsystem of the Linux kernel. A too large value for `fragshift` could lead to excessive memory allocation for temporary buffers.

**Weaknesses/vulnerabilities present:**
- **Unbounded memory allocation:** The `fragshift` value, which determines the period size, was previously not sufficiently limited, allowing a large value to be set.
- **Integer overflow (potential):** Although not explicitly stated, the use of a 31-bit value for `fragshift` without a proper check could theoretically lead to an integer overflow when calculating the actual size in bytes, further exacerbating the issue.

**Impact of exploitation:**
- **Memory exhaustion:** By setting a very high `fragshift` value, an attacker could cause the system to allocate a large amount of memory, potentially leading to denial of service (DoS) due to memory exhaustion.

**Attack vectors:**
- The vulnerability can be triggered via the `snd_pcm_oss_set_fragment1` function, accessible through the OSS API.

**Required attacker capabilities/position:**
- The attacker would need the ability to call the `snd_pcm_oss_set_fragment1` function, likely requiring a certain level of access to the audio device.
- Knowledge of the OSS API and the ability to control the fragment settings would be necessary.

**Technical Details:**
- The vulnerability is located in the `sound/core/oss/pcm_oss.c` file of the Linux kernel.
- The vulnerable code sets `fragshift = val & 0xffff` and then checks `if (fragshift >= 31)`.
- The fix changes the check to `if (fragshift >= 25)`, effectively limiting the maximum fragment shift value. This corresponds to a maximum period size of 2^25 bytes which equals 32MB, and given that the patch documentation specifies a limit of 16MB this limit probably concerns 2^24 bytes.
- The commits identified by:
  - 8839c8c0f77ab8fc0463f4ab8b37fca3f70677c2
  - 2e54cf6794bf82a54aaefc78da13819aea9cd28a
  - b02a41eebcc36d4f07196780f2e165ca2c499257
  - ad45babf7886e7a212ee1d5eda9ef49f696db43c
  - 76f19e4cbb548e28547f8c328aa0bfb3a10222d3
  - 35a3e511032146941085f87dd9fb5b82ea5c00a2
  - d1bb703ad050de9095f10b2d3416c32921ac6bcc
  - be55f306396cd62c6889286a7194fd8b53363aeb

are all related to this fix and appear to be backports of the same patch to different kernel branches.