- **Root cause of vulnerability:** The `formatNumNoSeparators` function in MediaWiki's Language class could return unescaped HTML when processing a NaN (Not a Number) value, which could be passed to the function via the `PageNumber` class. Although the `PageNumber` class checks for numeric input, NaN is considered numeric in PHP and thus bypasses this check.
- **Weaknesses/vulnerabilities present:** Cross-site Scripting (XSS) due to the lack of proper output escaping for a specific code path. The `formatNumNoSeparators` function was not consistently escaping its output.
- **Impact of exploitation:** An attacker could inject malicious HTML/JavaScript code through a crafted page number, leading to arbitrary code execution in the victim's browser when the page is rendered.
- **Attack vectors:** The vulnerability is triggered when processing user-controlled input representing a page number that can be interpreted as a NaN value. This input flows through the `PageNumber` class and to the `formatNumNoSeparators` function.
- **Required attacker capabilities/position:** The attacker needs to be able to influence the page number input that is processed by the `ProofreadPage` extension.