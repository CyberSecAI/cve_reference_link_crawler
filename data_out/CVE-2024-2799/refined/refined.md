Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-2799

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient input sanitization and output escaping of user-supplied attributes within the "Royal Elementor Addons and Templates" WordPress plugin. Specifically, the plugin fails to properly sanitize HTML tags used in the Image Grid & Advanced Text widget.

**Weaknesses/Vulnerabilities Present:**
- **Stored Cross-Site Scripting (XSS):** The primary vulnerability is stored XSS. Malicious scripts can be injected through HTML tags within the vulnerable widgets and stored in the database. When a user views a page containing the injected script, it executes in their browser.
- **Insufficient Input Sanitization:** The plugin does not adequately sanitize user input, allowing arbitrary HTML tags and scripts to be submitted.
- **Improper Output Escaping:**  The plugin also fails to properly escape the user-supplied HTML tags and attributes when rendering pages.

**Impact of Exploitation:**
- **Arbitrary Script Execution:** Successful exploitation allows an attacker to inject arbitrary JavaScript code into a page.
- **Session Hijacking:**  Attackers could potentially steal cookies or session data by injecting scripts that make requests to attacker-controlled servers.
- **Malware Distribution:** Attackers could redirect users to malicious sites or force the download of malware.
- **Website Defacement:** Attackers can modify content, redirect users, or perform other malicious actions.

**Attack Vectors:**
- **Plugin's Vulnerable Widgets:** The vulnerability is located within the "Image Grid & Advanced Text" widgets of the Royal Elementor Addons and Templates plugin.
- **HTML Tag Injection:** Attackers can inject malicious JavaScript code by embedding it within HTML tags in the widget settings/content.

**Required Attacker Capabilities/Position:**
- **Authenticated User:** The attacker must have at least contributor-level access to the WordPress site. This allows them to create or edit content using the affected widgets.
- **Knowledge of Vulnerable Widgets:** The attacker must be aware of the specific widgets (Image Grid and Advanced Text) that are vulnerable.

**Additional Details:**
- The vulnerability affects versions of the plugin up to and including 1.3.971.
- The vulnerability has been fixed in version 1.3.972
- The provided diffs show how the `text_tag` and `element_title_tag` settings are now being validated against a whitelist of allowed HTML tags. A new function `validate_html_tags_wl` was introduced in `classes/utilities.php` to handle this validation.