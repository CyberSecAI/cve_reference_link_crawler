- **Root cause of vulnerability**: The module "Custom Checkout Fields, Add Custom Fields to Checkout" (customfields) up to version 2.2.7 has a vulnerability due to a lack of control in pathname construction and predictable tokens. This allows for path traversal attacks.
- **Weaknesses/vulnerabilities present**:
    - CWE-22: Improper Limitation of a Pathname to a Restricted Directory
    - Predictable tokens
    - Lack of control in path name construction
- **Impact of exploitation**:
    - A guest user can download personal information without restriction.
    - An attacker can view all files on the information system.
    - Stealing secrets to unlock admin controllers based on ajax scripts.
    - Exfiltration of all modules to facilitate pentesting.
    - Stealing table prefixes to facilitate SQL injections.
    - Bypassing WAF/htaccess restrictions to read forbidden files (e.g., logs).
    - Possible use of phar wrapper implicit deserialization for a chain attack.
- **Attack vectors**:
    - Network-based attack.
    - Path traversal through a crafted request.
    - Exploitation uses a PrestaShop front controller.
    - Base64 payload to bypass some WAFs.
- **Required attacker capabilities/position**:
    - No privileges required; the attacker can be a guest user.
    - No user interaction is required.
    - Basic understanding of path traversal and request manipulation.
    - The ability to send a crafted request to the vulnerable module.