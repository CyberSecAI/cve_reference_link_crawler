<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: Security vulnerability in fprintd</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://twitter.com/openwall">
Follow @Openwall on Twitter for new release announcements and other news</a>

</TABLE>
</TABLE>

<a href="../../../2024/06/13/3">[&lt;prev]</a> <a href="2">[next&gt;]</a> <a href="../../../2024/06/13/3">[&lt;thread-prev]</a> <a href="2">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;CACVjhxWgQ8hLOx=z=QM8WiFODiqSHEuSGBqaUkPRcbAuV49dgQ&#64;mail.gmail.com&gt;
Date: Fri, 14 Jun 2024 10:19:40 +0300
From: Yaron Shahrabani &lt;sh.yaron&#64;...il.com&gt;
To: oss-security&#64;...ts.openwall.com
Subject: Re: Security vulnerability in fprintd

Thank you all for your response and care.

I would like to point out that although I managed to demonstrate this
vulnerability with a virtual terminal in a graphical interface it also
applies to TTY, so even if I don't have any graphical interface I can still
exploit this vulnerability.

Adding a graphical awareness mechanism will solve the vulnerability for
graphical interface but not entirely (unless there's a way to switch to the
requesting TTY for approval).


Thank you!

On Thu, 13 Jun 2024, 23:36 Mark Esler, &lt;mark.esler&#64;...onical.com&gt; wrote:

&gt; At Marco's request, I am asking MITRE to either revoke CVE-2024-37408 or
&gt; for
&gt; MITRE to transfer CVE ownership to Canonical's CNA for revocation.
&gt;
&gt; On Thu, Jun 13, 2024 at 06:40:51PM +0200, Marco Trevisan wrote:
&gt; &gt; Hi Yaron,
&gt; &gt;
&gt; &gt; Thanks for taking time to look into this issue.
&gt; &gt;
&gt; &gt; We appreciate the analysis you did, although, as we already shared
&gt; &gt; privately, we don't think that this is a fprintd issue but rather an
&gt; &gt; architectural issue of how PAM modules interact with sudo that, by
&gt; &gt; design, does not permit an additional attention mechanism beyond
&gt; &gt; displaying a prompt in the terminal.
&gt; &gt;
&gt; &gt; It's important to note that no graphical PAM front-end (that we are
&gt; &gt; aware of) is affected by this problem. For example, the PolicyKit
&gt; &gt; dialog that gnome-shell integrates and also the GDM login and lock
&gt; &gt; screens will properly ensure user attention. Said differently, there
&gt; &gt; should be no user attention issue as long as fingerprint authentication
&gt; &gt; is restricted to properly implemented graphical front-ends. This is a
&gt; &gt; policy decision for administrators and distributors to ensure using the
&gt; &gt; PAM configuration.
&gt; &gt;
&gt; &gt; We would like to point out that similar behaviors may occur with any
&gt; &gt; PAM module that uses an out-of-band authentication mechanism (whether
&gt; &gt; using another device or not) that doesn't require the user to pay
&gt; &gt; attention to the main device (SSO, web authentication, hardware-token
&gt; &gt; based, â€¦).
&gt; &gt;
&gt; &gt; The discussed behavior completely depends on the PAM configuration
&gt; &gt; (which, in most cases, needs to be enabled by the user). If this is
&gt; &gt; considered an issue, then it cannot be resolved within fprintd (and
&gt; &gt; pam_fprintd.so in particular). Should this be considered an issue, then
&gt; &gt; it needs to be addressed by modifying the PAM configuration to restrict
&gt; &gt; pam_fprintd.so to front-ends that implement a proper attention
&gt; &gt; mechanism. This is out of scope for fprintd and must be done by
&gt; &gt; administrators and possibly distributions as part of a policy decision.
&gt; &gt; A policy decision that the reporter made when enabling fingerprint
&gt; &gt; authentication using pam-auth-update.
&gt; &gt;
&gt; &gt; As explained, this is not an fprintd issue, and it cannot be considered
&gt; &gt; a security flaw in fprintd, and therefore we believe that it should not
&gt; &gt; have been assigned a CVE number.
&gt; &gt;
&gt; &gt; Thank you again for caring about fingerprint security.
&gt; &gt;
&gt; &gt; The fprintd maintainers,
&gt; &gt;      Benjamin and Marco
&gt; &gt;
&gt; &gt;
&gt; &gt; Il giorno gio, 30/05/2024 alle 09.18 +0000, Yaron Shahrabani ha
&gt; &gt; scritto:
&gt; &gt; &gt; Hi everyone, I'm writing to this mailing list since I've already
&gt; &gt; &gt; shared the details with Benjamin Berg and Marco Trevisan privately,
&gt; &gt; &gt; and we have yet to conclude about this vulnerability.
&gt; &gt; &gt; This information was also disclosed to the fprintd mailing list:
&gt; &gt; &gt; <a href="https://lists.freedesktop.org/archives/fprint/2024-May/001231.html" rel="nofollow">https://lists.freedesktop.org/archives/fprint/2024-May/001231.html</a>
&gt; &gt; &gt;
&gt; &gt; &gt; My sudo is configured to approve access with pam_fprintd; this is the
&gt; &gt; &gt; config file:
&gt; &gt; &gt;
&gt; &gt; &gt; #%PAM-1.0
&gt; &gt; &gt;
&gt; &gt; &gt; auth            sufficient      pam_fprintd.so
&gt; &gt; &gt; auth            include         system-auth
&gt; &gt; &gt; account         include         system-auth
&gt; &gt; &gt; session         include         system-auth
&gt; &gt; &gt;
&gt; &gt; &gt; So, unless I'm not already authenticated, running the following
&gt; &gt; &gt; command:
&gt; &gt; &gt; sudo whoami
&gt; &gt; &gt; Replies with the following prompt:
&gt; &gt; &gt; Place your finger on the fingerprint reader
&gt; &gt; &gt;
&gt; &gt; &gt; Placing my finger on the fingerprint reader leads to the following
&gt; &gt; &gt; output:
&gt; &gt; &gt; root
&gt; &gt; &gt;
&gt; &gt; &gt; The security concern is that this process can also happen behind the
&gt; &gt; &gt; scenes, so if I'm running a script that has a sudo prompt to delete
&gt; &gt; &gt; something I care about, I can accidentally place my fingerprint on
&gt; &gt; &gt; the
&gt; &gt; &gt; fingerprint reader for any other reasons, and my beloved files will
&gt; &gt; &gt; be
&gt; &gt; &gt; removed.
&gt; &gt; &gt;
&gt; &gt; &gt; How do we recreate the issue?
&gt; &gt; &gt; You can open your favorite console app on Linux.
&gt; &gt; &gt; If it supports tabs open two tabs, if not just open another window.
&gt; &gt; &gt; On the first tab, type: sudo whoami
&gt; &gt; &gt; Switch to the second tab and type: echo Place your finger on the
&gt; &gt; &gt; fingerprint reader;cat
&gt; &gt; &gt; Place your fingerprint on the fingerprint reader
&gt; &gt; &gt; Return to the first tab (You should see that the command was approved
&gt; &gt; &gt; and the output is root)
&gt; &gt; &gt;
&gt; &gt; &gt; Assume the user was running some background process and didn't see
&gt; &gt; &gt; the
&gt; &gt; &gt; fingerprint prompt from the other terminal. The second terminal may
&gt; &gt; &gt; deceive the user into placing the finger on the fingerprint reader
&gt; &gt; &gt; and
&gt; &gt; &gt; elevating permissions without the user being fully aware.
&gt; &gt; &gt;
&gt; &gt; &gt; On Ubuntu, if I want to recreate the same configuration, all I have
&gt; &gt; &gt; to
&gt; &gt; &gt; do is enroll my fingerprints in System Settings,
&gt; &gt; &gt; then install the pam-auth-update and select the Fingerprint
&gt; &gt; &gt; authentication from the selection screen (apt specific) as described
&gt; &gt; &gt; in the following SO thread:
&gt; &gt; &gt;
&gt; <a href="https://askubuntu.com/questions/1015416/use-fingerprint-authentication-not-only-for-login" rel="nofollow">https://askubuntu.com/questions/1015416/use-fingerprint-authentication-not-only-for-login</a>
&gt; &gt; &gt; .
&gt; &gt; &gt;
&gt; &gt; &gt; This problem was solved in macOS by simply displaying a window; if
&gt; &gt; &gt; the
&gt; &gt; &gt; window is out of focus, the fingerprint won't work.
&gt; &gt; &gt; Since we can't rely on any graphical window on Linux since it can be
&gt; &gt; &gt; terminal only, we need to ensure that the user fingerprint is used
&gt; &gt; &gt; only for the sole purpose of the request and with full attention to
&gt; &gt; &gt; the specific action the fingerprint was requested for. Otherwise, the
&gt; &gt; &gt; fingerprint can be hijacked (just like clickjacking).
&gt; &gt; &gt;
&gt; &gt; &gt; Benjamin was kind enough to respond, and I allowed myself to
&gt; &gt; &gt; summarize
&gt; &gt; &gt; his reply:
&gt; &gt; &gt; It can happen with fprintd as with any other external authentication
&gt; &gt; &gt; method (aside from password, we have Bluetooth proximity, NFC Tag,
&gt; &gt; &gt; Smart Card, etc.), so it is not unique to fprintd.
&gt; &gt; &gt; Benjamin also offered mitigating ways, such as changing the
&gt; &gt; &gt; configuration or using pkexec instead of sudo.
&gt; &gt; &gt;
&gt; &gt; &gt; I addressed this issue with the sudo maintainer, Todd C. Miller, and
&gt; &gt; &gt; again, I allowed myself to summarize his response:
&gt; &gt; &gt; Although I understand the concern, I need a security attention
&gt; &gt; &gt; mechanism to fix it.
&gt; &gt; &gt;
&gt; &gt; &gt; CVSS 4.0 ranked this CVE as 7.3.
&gt; &gt; &gt;
&gt; &gt; &gt; Thank you,
&gt; &gt; &gt; PS, I'm not a security researcher, and I'm not affiliated with any
&gt; &gt; &gt; organization.
&gt; &gt; &gt;
&gt; &gt; &gt; Yaron Shahrabani - DevOps, Hebrew translator
&gt; &gt;
&gt;
&gt;
&gt;

</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
