<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: Security vulnerability in fprintd</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://twitter.com/openwall">
Follow @Openwall on Twitter for new release announcements and other news</a>

</TABLE>
</TABLE>

<a href="1">[&lt;prev]</a> <a href="3">[next&gt;]</a> <a href="../../../2024/05/30/3">[&lt;thread-prev]</a> <a href="3">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;70d2c42126ea78f0f5cd527c0fd16ccad772f523.camel&#64;3v1n0.net&gt;
Date: Thu, 13 Jun 2024 18:40:51 +0200
From: Marco Trevisan &lt;mail&#64;...n0.net&gt;
To: Yaron Shahrabani &lt;sh.yaron&#64;...il.com&gt;, oss-security&#64;...ts.openwall.com
Subject: Re: Security vulnerability in fprintd

Hi Yaron,

Thanks for taking time to look into this issue. 

We appreciate the analysis you did, although, as we already shared
privately, we don't think that this is a fprintd issue but rather an
architectural issue of how PAM modules interact with sudo that, by
design, does not permit an additional attention mechanism beyond
displaying a prompt in the terminal.

It's important to note that no graphical PAM front-end (that we are
aware of) is affected by this problem. For example, the PolicyKit
dialog that gnome-shell integrates and also the GDM login and lock
screens will properly ensure user attention. Said differently, there
should be no user attention issue as long as fingerprint authentication
is restricted to properly implemented graphical front-ends. This is a
policy decision for administrators and distributors to ensure using the
PAM configuration.

We would like to point out that similar behaviors may occur with any
PAM module that uses an out-of-band authentication mechanism (whether
using another device or not) that doesn't require the user to pay
attention to the main device (SSO, web authentication, hardware-token
based, …).

The discussed behavior completely depends on the PAM configuration
(which, in most cases, needs to be enabled by the user). If this is
considered an issue, then it cannot be resolved within fprintd (and
pam_fprintd.so in particular). Should this be considered an issue, then
it needs to be addressed by modifying the PAM configuration to restrict
pam_fprintd.so to front-ends that implement a proper attention
mechanism. This is out of scope for fprintd and must be done by
administrators and possibly distributions as part of a policy decision.
A policy decision that the reporter made when enabling fingerprint
authentication using pam-auth-update.

As explained, this is not an fprintd issue, and it cannot be considered
a security flaw in fprintd, and therefore we believe that it should not
have been assigned a CVE number.

Thank you again for caring about fingerprint security.

The fprintd maintainers,
     Benjamin and Marco


Il giorno gio, 30/05/2024 alle 09.18 +0000, Yaron Shahrabani ha
scritto:
&gt; Hi everyone, I'm writing to this mailing list since I've already
&gt; shared the details with Benjamin Berg and Marco Trevisan privately,
&gt; and we have yet to conclude about this vulnerability.
&gt; This information was also disclosed to the fprintd mailing list:
&gt; <a href="https://lists.freedesktop.org/archives/fprint/2024-May/001231.html" rel="nofollow">https://lists.freedesktop.org/archives/fprint/2024-May/001231.html</a>
&gt; 
&gt; My sudo is configured to approve access with pam_fprintd; this is the
&gt; config file:
&gt; 
&gt; #%PAM-1.0
&gt; 
&gt; auth            sufficient      pam_fprintd.so
&gt; auth            include         system-auth
&gt; account         include         system-auth
&gt; session         include         system-auth
&gt; 
&gt; So, unless I'm not already authenticated, running the following
&gt; command:
&gt; sudo whoami
&gt; Replies with the following prompt:
&gt; Place your finger on the fingerprint reader
&gt; 
&gt; Placing my finger on the fingerprint reader leads to the following
&gt; output:
&gt; root
&gt; 
&gt; The security concern is that this process can also happen behind the
&gt; scenes, so if I'm running a script that has a sudo prompt to delete
&gt; something I care about, I can accidentally place my fingerprint on
&gt; the
&gt; fingerprint reader for any other reasons, and my beloved files will
&gt; be
&gt; removed.
&gt; 
&gt; How do we recreate the issue?
&gt; You can open your favorite console app on Linux.
&gt; If it supports tabs open two tabs, if not just open another window.
&gt; On the first tab, type: sudo whoami
&gt; Switch to the second tab and type: echo Place your finger on the
&gt; fingerprint reader;cat
&gt; Place your fingerprint on the fingerprint reader
&gt; Return to the first tab (You should see that the command was approved
&gt; and the output is root)
&gt; 
&gt; Assume the user was running some background process and didn't see
&gt; the
&gt; fingerprint prompt from the other terminal. The second terminal may
&gt; deceive the user into placing the finger on the fingerprint reader
&gt; and
&gt; elevating permissions without the user being fully aware.
&gt; 
&gt; On Ubuntu, if I want to recreate the same configuration, all I have
&gt; to
&gt; do is enroll my fingerprints in System Settings,
&gt; then install the pam-auth-update and select the Fingerprint
&gt; authentication from the selection screen (apt specific) as described
&gt; in the following SO thread:
&gt; <a href="https://askubuntu.com/questions/1015416/use-fingerprint-authentication-not-only-for-login" rel="nofollow">https://askubuntu.com/questions/1015416/use-fingerprint-authentication-not-only-for-login</a>
&gt; .
&gt; 
&gt; This problem was solved in macOS by simply displaying a window; if
&gt; the
&gt; window is out of focus, the fingerprint won't work.
&gt; Since we can't rely on any graphical window on Linux since it can be
&gt; terminal only, we need to ensure that the user fingerprint is used
&gt; only for the sole purpose of the request and with full attention to
&gt; the specific action the fingerprint was requested for. Otherwise, the
&gt; fingerprint can be hijacked (just like clickjacking).
&gt; 
&gt; Benjamin was kind enough to respond, and I allowed myself to
&gt; summarize
&gt; his reply:
&gt; It can happen with fprintd as with any other external authentication
&gt; method (aside from password, we have Bluetooth proximity, NFC Tag,
&gt; Smart Card, etc.), so it is not unique to fprintd.
&gt; Benjamin also offered mitigating ways, such as changing the
&gt; configuration or using pkexec instead of sudo.
&gt; 
&gt; I addressed this issue with the sudo maintainer, Todd C. Miller, and
&gt; again, I allowed myself to summarize his response:
&gt; Although I understand the concern, I need a security attention
&gt; mechanism to fix it.
&gt; 
&gt; CVSS 4.0 ranked this CVE as 7.3.
&gt; 
&gt; Thank you,
&gt; PS, I'm not a security researcher, and I'm not affiliated with any
&gt; organization.
&gt; 
&gt; Yaron Shahrabani - DevOps, Hebrew translator


<span style="font-family: times;"><strong>Download attachment "</strong><a href="2/1" rel="nofollow" download>signature.asc</a><strong>" of type "</strong>application/pgp-signature<strong>" (859 bytes)</strong></span>
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
