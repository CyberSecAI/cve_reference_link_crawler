=== Content from github.com_5d72413a_20250108_112240.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFriendsOfPHP%2Fsecurity-advisories%2Fblob%2Fmaster%2Fsymfony%2Fsecurity-bundle%2FCVE-2022-24895.yaml)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFriendsOfPHP%2Fsecurity-advisories%2Fblob%2Fmaster%2Fsymfony%2Fsecurity-bundle%2FCVE-2022-24895.yaml)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=FriendsOfPHP%2Fsecurity-advisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FriendsOfPHP](/FriendsOfPHP)
/
**[security-advisories](/FriendsOfPHP/security-advisories)**
Public

* [Notifications](/login?return_to=%2FFriendsOfPHP%2Fsecurity-advisories) You must be signed in to change notification settings
* [Fork
  306](/login?return_to=%2FFriendsOfPHP%2Fsecurity-advisories)
* [Star
   2.1k](/login?return_to=%2FFriendsOfPHP%2Fsecurity-advisories)

* [Code](/FriendsOfPHP/security-advisories)
* [Issues
  0](/FriendsOfPHP/security-advisories/issues)
* [Pull requests
  1](/FriendsOfPHP/security-advisories/pulls)
* [Actions](/FriendsOfPHP/security-advisories/actions)
* [Security](/FriendsOfPHP/security-advisories/security)
* [Insights](/FriendsOfPHP/security-advisories/pulse)

Additional navigation options

* [Code](/FriendsOfPHP/security-advisories)
* [Issues](/FriendsOfPHP/security-advisories/issues)
* [Pull requests](/FriendsOfPHP/security-advisories/pulls)
* [Actions](/FriendsOfPHP/security-advisories/actions)
* [Security](/FriendsOfPHP/security-advisories/security)
* [Insights](/FriendsOfPHP/security-advisories/pulse)

## Files

 master
## Breadcrumbs

1. [security-advisories](/FriendsOfPHP/security-advisories/tree/master)
2. /[symfony](/FriendsOfPHP/security-advisories/tree/master/symfony)
3. /[security-bundle](/FriendsOfPHP/security-advisories/tree/master/symfony/security-bundle)
/
# CVE-2022-24895.yaml

 Blame  Blame
## Latest commit

## History

[History](/FriendsOfPHP/security-advisories/commits/master/symfony/security-bundle/CVE-2022-24895.yaml)86 lines (86 loc) · 2.53 KB master
## Breadcrumbs

1. [security-advisories](/FriendsOfPHP/security-advisories/tree/master)
2. /[symfony](/FriendsOfPHP/security-advisories/tree/master/symfony)
3. /[security-bundle](/FriendsOfPHP/security-advisories/tree/master/symfony/security-bundle)
/
# CVE-2022-24895.yaml

Top
## File metadata and controls

* Code
* Blame

86 lines (86 loc) · 2.53 KB[Raw](https://github.com/FriendsOfPHP/security-advisories/raw/refs/heads/master/symfony/security-bundle/CVE-2022-24895.yaml)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586title: "CVE-2022-24895: Possible CSRF token fixation"link: https://symfony.com/cve-2022-24895cve: CVE-2022-24895branches: 2.0.x: time: 2023-02-01 08:00:00 versions: ['>=2.0.0', '<2.1.0'] 2.1.x: time: 2023-02-01 08:00:00 versions: ['>=2.1.0', '<2.2.0'] 2.2.x: time: 2023-02-01 08:00:00 versions: ['>=2.2.0', '<2.3.0'] 2.3.x: time: 2023-02-01 08:00:00 versions: ['>=2.3.0', '<2.4.0'] 2.4.x: time: 2023-02-01 08:00:00 versions: ['>=2.4.0', '<2.5.0'] 2.5.x: time: 2023-02-01 08:00:00 versions: ['>=2.5.0', '<2.6.0'] 2.6.x: time: 2023-02-01 08:00:00 versions: ['>=2.6.0', '<2.7.0'] 2.7.x: time: 2023-02-01 08:00:00 versions: ['>=2.7.0', '<2.8.0'] 2.8.x: time: 2023-02-01 08:00:00 versions: ['>=2.8.0', '<3.0.0'] 3.0.x: time: 2023-02-01 08:00:00 versions: ['>=3.0.0', '<3.1.0'] 3.1.x: time: 2023-02-01 08:00:00 versions: ['>=3.1.0', '<3.2.0'] 3.2.x: time: 2023-02-01 08:00:00 versions: ['>=3.2.0', '<3.3.0'] 3.3.x: time: 2023-02-01 08:00:00 versions: ['>=3.3.0', '<3.4.0'] 3.4.x: time: 2023-02-01 08:00:00 versions: ['>=3.4.0', '<4.0.0'] 4.0.x: time: 2023-02-01 08:00:00 versions: ['>=4.0.0', '<4.1.0'] 4.1.x: time: 2023-02-01 08:00:00 versions: ['>=4.1.0', '<4.2.0'] 4.2.x: time: 2023-02-01 08:00:00 versions: ['>=4.2.0', '<4.3.0'] 4.3.x: time: 2023-02-01 08:00:00 versions: ['>=4.3.0', '<4.4.0'] 4.4.x: time: 2023-02-01 08:00:00 versions: ['>=4.4.0', '<4.4.50'] 5.0.x: time: 2023-02-01 08:00:00 versions: ['>=5.0.0', '<5.1.0'] 5.1.x: time: 2023-02-01 08:00:00 versions: ['>=5.1.0', '<5.2.0'] 5.2.x: time: 2023-02-01 08:00:00 versions: ['>=5.2.0', '<5.3.0'] 5.3.x: time: 2023-02-01 08:00:00 versions: ['>=5.3.0', '<5.4.0'] 5.4.x: time: 2023-02-01 08:00:00 versions: ['>=5.4.0', '<5.4.20'] 6.0.x: time: 2023-02-01 08:00:00 versions: ['>=6.0.0', '<6.0.20'] 6.1.x: time: 2023-02-01 08:00:00 versions: ['>=6.1.0', '<6.1.12'] 6.2.x: time: 2023-02-01 08:00:00 versions: ['>=6.2.0', '<6.2.6']reference: composer://symfony/security-bundle

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_8158864a_20250108_112242.html ===


---

[[Date Prev](msg00013.html)][[Date Next](msg00015.html)]
[[Thread Prev](msg00013.html)][[Thread Next](msg00015.html)]
[[Date Index](maillist.html#00014)]
[[Thread Index](threads.html#00014)]

# [SECURITY] [DLA 3493-1] symfony security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3493-1] symfony security update
* *From*: Guilhem Moulin <guilhem@debian.org>
* *Date*: Wed, 12 Jul 2023 01:19:27 +0200
* *Message-id*: <[[🔎]](/msgid-search/ZK3jf8MjQVYMd9hz%40debian.org) [ZK3jf8MjQVYMd9hz@debian.org](msg00014.html)>
* *Mail-followup-to*: debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3493-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Guilhem Moulin
July 11, 2023                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : symfony
Version        : 3.4.22+dfsg-2+deb10u2
CVE ID         : CVE-2021-21424 CVE-2022-24894 CVE-2022-24895

Multiple security vulnerabilities were found in symfony, a PHP framework
for web and console applications and a set of reusable PHP components,
which could lead to information disclosure or impersonation.

CVE-2021-21424

    James Isaac, Mathias Brodala and Laurent Minguet discovered that it
    was possible to enumerate users without relevant permissions due to
    different exception messages depending on whether the user existed
    or not.  It was also possible to enumerate users by using a timing
    attack, by comparing time elapsed when authenticating an existing
    user and authenticating a non-existing user.

    403s are now returned whether the user exists or not if a user
    cannot switch to a user or if the user does not exist.

CVE-2022-24894

    Soner Sayakci discovered that when the Symfony HTTP cache system is
    enabled, the response header might be stored with a `Set-Cookie`
    header and returned to some other clients, thereby allowing an
    attacker to retrieve the victim's session.

    The `HttpStore` constructor now takes a parameter containing a list
    of private headers that are removed from the HTTP response headers.
    The default value for this parameter is `Set-Cookie`, but it can be
    overridden or extended by the application.

CVE-2022-24895

    Marco Squarcina discovered that CSRF tokens aren't cleared upon
    login, which could enable same-site attackers to bypass the CSRF
    protection mechanism by performing an attack similar to a
    session-fixation.

For Debian 10 buster, these problems have been fixed in version
3.4.22+dfsg-2+deb10u2.

We recommend that you upgrade your symfony packages.

For the detailed security status of symfony please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/symfony>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpIAiR98zppC.pgp)**

*Description:* PGP signature

---



=== Content from github.com_fccc9ed2_20250108_112242.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsymfony%2Fsymfony%2Fcommit%2F5909d74ecee359ea4982fcf4331aaf2e489a1fd4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsymfony%2Fsymfony%2Fcommit%2F5909d74ecee359ea4982fcf4331aaf2e489a1fd4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=symfony%2Fsymfony)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[symfony](/symfony)
/
**[symfony](/symfony/symfony)**
Public

* [Notifications](/login?return_to=%2Fsymfony%2Fsymfony) You must be signed in to change notification settings
* [Fork
  9.5k](/login?return_to=%2Fsymfony%2Fsymfony)
* [Star
   29.9k](/login?return_to=%2Fsymfony%2Fsymfony)

* [Code](/symfony/symfony)
* [Issues
  559](/symfony/symfony/issues)
* [Pull requests
  330](/symfony/symfony/pulls)
* [Discussions](/symfony/symfony/discussions)
* [Actions](/symfony/symfony/actions)
* [Projects
  0](/symfony/symfony/projects)
* [Security](/symfony/symfony/security)
* [Insights](/symfony/symfony/pulse)

Additional navigation options

* [Code](/symfony/symfony)
* [Issues](/symfony/symfony/issues)
* [Pull requests](/symfony/symfony/pulls)
* [Discussions](/symfony/symfony/discussions)
* [Actions](/symfony/symfony/actions)
* [Projects](/symfony/symfony/projects)
* [Security](/symfony/symfony/security)
* [Insights](/symfony/symfony/pulse)

## Commit

[Permalink](/symfony/symfony/commit/5909d74ecee359ea4982fcf4331aaf2e489a1fd4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[Security/Http] Remove CSRF tokens from storage on successful login

[Browse files](/symfony/symfony/tree/5909d74ecee359ea4982fcf4331aaf2e489a1fd4)
Browse the repository at this point in the history

* Loading branch information

[![@nicolas-grekas](https://avatars.githubusercontent.com/u/243674?s=40&v=4)](/nicolas-grekas)

[nicolas-grekas](/symfony/symfony/commits?author=nicolas-grekas "View all commits by nicolas-grekas")
committed
Jan 24, 2023

1 parent
[fa1827c](/symfony/symfony/commit/fa1827c1dc8c519f1e2f17bcdbe71ee025cce318)

commit 5909d74

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**33 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/Symfony

  + Bundle/SecurityBundle

    - Resources/config

      * src/Symfony/Bundle/SecurityBundle/Resources/config/security.xml
        [security.xml](#diff-8cb807c9c5dc8d4c274e622bb209e94ee5c33eeb6eda251e4f79b33cdcacbf5e)
    - Tests/Functional

      * src/Symfony/Bundle/SecurityBundle/Tests/Functional/CsrfFormLoginTest.php
        [CsrfFormLoginTest.php](#diff-3b58048a17b3bed01b20b65601c5184c6a4afb9e1f9f92512787c28bb0347533)
      * src/Symfony/Bundle/SecurityBundle/Tests/Functional/LogoutTest.php
        [LogoutTest.php](#diff-c1a4581fd182f7bd35bbb4f0297fd62d1df49fb0b2a4b4210707f3a8131766d1)
    - src/Symfony/Bundle/SecurityBundle/composer.json
      [composer.json](#diff-b56b3bc84dfaea61c095bf946ac0aabf5595f265eb5031bf39efe707b8acf1c9)
  + Component/Security/Http

    - Session

      * src/Symfony/Component/Security/Http/Session/SessionAuthenticationStrategy.php
        [SessionAuthenticationStrategy.php](#diff-0ff1412624a79146c346925f2407eb4783b144da38ddb369ca30e49d046fab70)
    - Tests/Session

      * src/Symfony/Component/Security/Http/Tests/Session/SessionAuthenticationStrategyTest.php
        [SessionAuthenticationStrategyTest.php](#diff-8d11abde15c60862994498e8b3d1db8eb795926439d855f27f795877264bbd8a)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[src/Symfony/Bundle/SecurityBundle/Resources/config/security.xml](#diff-8cb807c9c5dc8d4c274e622bb209e94ee5c33eeb6eda251e4f79b33cdcacbf5e "src/Symfony/Bundle/SecurityBundle/Resources/config/security.xml")

Show comments

[View file](/symfony/symfony/blob/5909d74ecee359ea4982fcf4331aaf2e489a1fd4/src/Symfony/Bundle/SecurityBundle/Resources/config/security.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -63,6 +63,7 @@ |
|  |  |  |
|  |  | <service id="security.authentication.session\_strategy" class="Symfony\Component\Security\Http\Session\SessionAuthenticationStrategy"> |
|  |  | <argument>%security.authentication.session\_strategy.strategy%</argument> |
|  |  | <argument type="service" id="security.csrf.token\_storage" on-invalid="ignore" /> |
|  |  | </service> |
|  |  | <service id="Symfony\Component\Security\Http\Session\SessionAuthenticationStrategyInterface" alias="security.authentication.session\_strategy" /> |
|  |  |  |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[src/Symfony/Bundle/SecurityBundle/Tests/Functional/CsrfFormLoginTest.php](#diff-3b58048a17b3bed01b20b65601c5184c6a4afb9e1f9f92512787c28bb0347533 "src/Symfony/Bundle/SecurityBundle/Tests/Functional/CsrfFormLoginTest.php")

Show comments

[View file](/symfony/symfony/blob/5909d74ecee359ea4982fcf4331aaf2e489a1fd4/src/Symfony/Bundle/SecurityBundle/Tests/Functional/CsrfFormLoginTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,12 +19,15 @@ class CsrfFormLoginTest extends AbstractWebTestCase |
|  |  | public function testFormLoginAndLogoutWithCsrfTokens($config) |
|  |  | { |
|  |  | $client = $this->createClient(['test\_case' => 'CsrfFormLogin', 'root\_config' => $config]); |
|  |  | static::$container->get('security.csrf.token\_storage')->setToken('foo', 'bar'); |
|  |  |  |
|  |  | $form = $client->request('GET', '/login')->selectButton('login')->form(); |
|  |  | $form['user\_login[username]'] = 'johannes'; |
|  |  | $form['user\_login[password]'] = 'test'; |
|  |  | $client->submit($form); |
|  |  |  |
|  |  | $this->assertFalse(static::$container->get('security.csrf.token\_storage')->hasToken('foo')); |
|  |  |  |
|  |  | $this->assertRedirect($client->getResponse(), '/profile'); |
|  |  |  |
|  |  | $crawler = $client->followRedirect(); |
| Expand All | | @@ -48,11 +51,14 @@ public function testFormLoginAndLogoutWithCsrfTokens($config) |
|  |  | public function testFormLoginWithInvalidCsrfToken($config) |
|  |  | { |
|  |  | $client = $this->createClient(['test\_case' => 'CsrfFormLogin', 'root\_config' => $config]); |
|  |  | static::$container->get('security.csrf.token\_storage')->setToken('foo', 'bar'); |
|  |  |  |
|  |  | $form = $client->request('GET', '/login')->selectButton('login')->form(); |
|  |  | $form['user\_login[\_token]'] = ''; |
|  |  | $client->submit($form); |
|  |  |  |
|  |  | $this->assertTrue(static::$container->get('security.csrf.token\_storage')->hasToken('foo')); |
|  |  |  |
|  |  | $this->assertRedirect($client->getResponse(), '/login'); |
|  |  |  |
|  |  | $text = $client->followRedirect()->text(null, true); |
| Expand Down | |  |

4 changes: 1 addition & 3 deletions

4
[src/Symfony/Bundle/SecurityBundle/Tests/Functional/LogoutTest.php](#diff-c1a4581fd182f7bd35bbb4f0297fd62d1df49fb0b2a4b4210707f3a8131766d1 "src/Symfony/Bundle/SecurityBundle/Tests/Functional/LogoutTest.php")

Show comments

[View file](/symfony/symfony/blob/5909d74ecee359ea4982fcf4331aaf2e489a1fd4/src/Symfony/Bundle/SecurityBundle/Tests/Functional/LogoutTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,15 +36,13 @@ public function testSessionLessRememberMeLogout() |
|  |  | public function testCsrfTokensAreClearedOnLogout() |
|  |  | { |
|  |  | $client = $this->createClient(['test\_case' => 'LogoutWithoutSessionInvalidation', 'root\_config' => 'config.yml']); |
|  |  | static::$container->get('security.csrf.token\_storage')->setToken('foo', 'bar'); |
|  |  |  |
|  |  | $client->request('POST', '/login', [ |
|  |  | '\_username' => 'johannes', |
|  |  | '\_password' => 'test', |
|  |  | ]); |
|  |  |  |
|  |  | $this->assertTrue(static::$container->get('security.csrf.token\_storage')->hasToken('foo')); |
|  |  | $this->assertSame('bar', static::$container->get('security.csrf.token\_storage')->getToken('foo')); |
|  |  | static::$container->get('security.csrf.token\_storage')->setToken('foo', 'bar'); |
|  |  |  |
|  |  | $client->request('GET', '/logout'); |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/Symfony/Bundle/SecurityBundle/composer.json](#diff-b56b3bc84dfaea61c095bf946ac0aabf5595f265eb5031bf39efe707b8acf1c9 "src/Symfony/Bundle/SecurityBundle/composer.json")

Show comments

[View file](/symfony/symfony/blob/5909d74ecee359ea4982fcf4331aaf2e489a1fd4/src/Symfony/Bundle/SecurityBundle/composer.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,7 @@ |
|  |  | "symfony/security-core": "^4.4", |
|  |  | "symfony/security-csrf": "^4.2|^5.0", |
|  |  | "symfony/security-guard": "^4.2|^5.0", |
|  |  | "symfony/security-http": "^4.4.5" |
|  |  | "symfony/security-http": "^4.4.50" |
|  |  | }, |
|  |  | "require-dev": { |
|  |  | "doctrine/annotations": "^1.10.4", |
| Expand Down | |  |

14 changes: 11 additions & 3 deletions

14
[src/Symfony/Component/Security/Http/Session/SessionAuthenticationStrategy.php](#diff-0ff1412624a79146c346925f2407eb4783b144da38ddb369ca30e49d046fab70 "src/Symfony/Component/Security/Http/Session/SessionAuthenticationStrategy.php")

Show comments

[View file](/symfony/symfony/blob/5909d74ecee359ea4982fcf4331aaf2e489a1fd4/src/Symfony/Component/Security/Http/Session/SessionAuthenticationStrategy.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,6 +13,7 @@ |
|  |  |  |
|  |  | use Symfony\Component\HttpFoundation\Request; |
|  |  | use Symfony\Component\Security\Core\Authentication\Token\TokenInterface; |
|  |  | use Symfony\Component\Security\Csrf\TokenStorage\ClearableTokenStorageInterface; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The default session strategy implementation. |
| Expand All | | @@ -31,10 +32,15 @@ class SessionAuthenticationStrategy implements SessionAuthenticationStrategyInte |
|  |  | public const INVALIDATE = 'invalidate'; |
|  |  |  |
|  |  | private $strategy; |
|  |  | private $csrfTokenStorage = null; |
|  |  |  |
|  |  | public function \_\_construct(string $strategy) |
|  |  | public function \_\_construct(string $strategy, ClearableTokenStorageInterface $csrfTokenStorage = null) |
|  |  | { |
|  |  | $this->strategy = $strategy; |
|  |  |  |
|  |  | if (self::MIGRATE === $strategy) { |
|  |  | $this->csrfTokenStorage = $csrfTokenStorage; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand All | | @@ -47,10 +53,12 @@ public function onAuthentication(Request $request, TokenInterface $token) |
|  |  | return; |
|  |  |  |
|  |  | case self::MIGRATE: |
|  |  | // Note: this logic is duplicated in several authentication listeners |
|  |  | // until Symfony 5.0 due to a security fix with BC compat |
|  |  | $request->getSession()->migrate(true); |
|  |  |  |
|  |  | if ($this->csrfTokenStorage) { |
|  |  | $this->csrfTokenStorage->clear(); |
|  |  | } |
|  |  |  |
|  |  | return; |
|  |  |  |
|  |  | case self::INVALIDATE: |
| Expand Down | |  |

13 changes: 13 additions & 0 deletions

13
[src/Symfony/Component/Security/Http/Tests/Session/SessionAuthenticationStrategyTest.php](#diff-8d11abde15c60862994498e8b3d1db8eb795926439d855f27f795877264bbd8a "src/Symfony/Component/Security/Http/Tests/Session/SessionAuthenticationStrategyTest.php")

Show comments

[View file](/symfony/symfony/blob/5909d74ecee359ea4982fcf4331aaf2e489a1fd4/src/Symfony/Component/Security/Http/Tests/Session/SessionAuthenticationStrategyTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,6 +14,7 @@ |
|  |  | use PHPUnit\Framework\TestCase; |
|  |  | use Symfony\Component\HttpFoundation\Request; |
|  |  | use Symfony\Component\HttpFoundation\Session\SessionInterface; |
|  |  | use Symfony\Component\Security\Csrf\TokenStorage\ClearableTokenStorageInterface; |
|  |  | use Symfony\Component\Security\Http\Session\SessionAuthenticationStrategy; |
|  |  | use Symfony\Component\Security\Http\Tests\Fixtures\TokenInterface; |
|  |  |  |
| Expand Down  Expand Up | | @@ -57,6 +58,18 @@ public function testSessionIsInvalidated() |
|  |  | $strategy->onAuthentication($this->getRequest($session), $this->createMock(TokenInterface::class)); |
|  |  | } |
|  |  |  |
|  |  | public function testCsrfTokensAreCleared() |
|  |  | { |
|  |  | $session = $this->createMock(SessionInterface::class); |
|  |  | $session->expects($this->once())->method('migrate')->with($this->equalTo(true)); |
|  |  |  |
|  |  | $csrfStorage = $this->createMock(ClearableTokenStorageInterface::class); |
|  |  | $csrfStorage->expects($this->once())->method('clear'); |
|  |  |  |
|  |  | $strategy = new SessionAuthenticationStrategy(SessionAuthenticationStrategy::MIGRATE, $csrfStorage); |
|  |  | $strategy->onAuthentication($this->getRequest($session), $this->createMock(TokenInterface::class)); |
|  |  | } |
|  |  |  |
|  |  | private function getRequest($session = null) |
|  |  | { |
|  |  | $request = $this->createMock(Request::class); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5909d74`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsymfony%2Fsymfony%2Fcommit%2F5909d74ecee359ea4982fcf4331aaf2e489a1fd4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_59637af2_20250108_112241.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsymfony%2Fsecurity-bundle%2Fcommit%2F076fd2088ada33d760758d98ff07ddedbf567946)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsymfony%2Fsecurity-bundle%2Fcommit%2F076fd2088ada33d760758d98ff07ddedbf567946)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=symfony%2Fsecurity-bundle)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[symfony](/symfony)
/
**[security-bundle](/symfony/security-bundle)**
Public

* [Notifications](/login?return_to=%2Fsymfony%2Fsecurity-bundle) You must be signed in to change notification settings
* [Fork
  27](/login?return_to=%2Fsymfony%2Fsecurity-bundle)
* [Star
   2.5k](/login?return_to=%2Fsymfony%2Fsecurity-bundle)

* [Code](/symfony/security-bundle)
* [Pull requests
  0](/symfony/security-bundle/pulls)
* [Actions](/symfony/security-bundle/actions)
* [Security](/symfony/security-bundle/security)
* [Insights](/symfony/security-bundle/pulse)

Additional navigation options

* [Code](/symfony/security-bundle)
* [Pull requests](/symfony/security-bundle/pulls)
* [Actions](/symfony/security-bundle/actions)
* [Security](/symfony/security-bundle/security)
* [Insights](/symfony/security-bundle/pulse)

## Commit

[Permalink](/symfony/security-bundle/commit/076fd2088ada33d760758d98ff07ddedbf567946)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[Security/Http] Remove CSRF tokens from storage on successful login

[Browse files](/symfony/security-bundle/tree/076fd2088ada33d760758d98ff07ddedbf567946)
Browse the repository at this point in the history

* Loading branch information

[![@nicolas-grekas](https://avatars.githubusercontent.com/u/243674?s=40&v=4)](/nicolas-grekas)

[nicolas-grekas](/symfony/security-bundle/commits?author=nicolas-grekas "View all commits by nicolas-grekas")
committed
Jan 24, 2023

1 parent
[d2a6bf4](/symfony/security-bundle/commit/d2a6bf4aeb75e75d3faacf9bec286e0de58394b6)

commit 076fd20

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**9 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Resources/config

  + Resources/config/security.xml
    [security.xml](#diff-4fb3d6310ed5bd23d9a85bd9ad9e9d2447afae2152f76e98901fbf5da988b026)
* Tests/Functional

  + Tests/Functional/CsrfFormLoginTest.php
    [CsrfFormLoginTest.php](#diff-2f8da9e3f3c0ebd9c41eda772fcbe8a0a42a8d99abc7dc642e0b8f4f9bc6fbf2)
  + Tests/Functional/LogoutTest.php
    [LogoutTest.php](#diff-022b41a9b664af89be91e39995dcbfd41a2c463a262f28b2fb81b7c7ea32f789)
* composer.json
  [composer.json](#diff-d2ab9925cad7eac58e0ff4cc0d251a937ecf49e4b6bf57f8b95aab76648a9d34)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[Resources/config/security.xml](#diff-4fb3d6310ed5bd23d9a85bd9ad9e9d2447afae2152f76e98901fbf5da988b026 "Resources/config/security.xml")

Show comments

[View file](/symfony/security-bundle/blob/076fd2088ada33d760758d98ff07ddedbf567946/Resources/config/security.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -63,6 +63,7 @@ |
|  |  |  |
|  |  | <service id="security.authentication.session\_strategy" class="Symfony\Component\Security\Http\Session\SessionAuthenticationStrategy"> |
|  |  | <argument>%security.authentication.session\_strategy.strategy%</argument> |
|  |  | <argument type="service" id="security.csrf.token\_storage" on-invalid="ignore" /> |
|  |  | </service> |
|  |  | <service id="Symfony\Component\Security\Http\Session\SessionAuthenticationStrategyInterface" alias="security.authentication.session\_strategy" /> |
|  |  |  |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[Tests/Functional/CsrfFormLoginTest.php](#diff-2f8da9e3f3c0ebd9c41eda772fcbe8a0a42a8d99abc7dc642e0b8f4f9bc6fbf2 "Tests/Functional/CsrfFormLoginTest.php")

Show comments

[View file](/symfony/security-bundle/blob/076fd2088ada33d760758d98ff07ddedbf567946/Tests/Functional/CsrfFormLoginTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,12 +19,15 @@ class CsrfFormLoginTest extends AbstractWebTestCase |
|  |  | public function testFormLoginAndLogoutWithCsrfTokens($config) |
|  |  | { |
|  |  | $client = $this->createClient(['test\_case' => 'CsrfFormLogin', 'root\_config' => $config]); |
|  |  | static::$container->get('security.csrf.token\_storage')->setToken('foo', 'bar'); |
|  |  |  |
|  |  | $form = $client->request('GET', '/login')->selectButton('login')->form(); |
|  |  | $form['user\_login[username]'] = 'johannes'; |
|  |  | $form['user\_login[password]'] = 'test'; |
|  |  | $client->submit($form); |
|  |  |  |
|  |  | $this->assertFalse(static::$container->get('security.csrf.token\_storage')->hasToken('foo')); |
|  |  |  |
|  |  | $this->assertRedirect($client->getResponse(), '/profile'); |
|  |  |  |
|  |  | $crawler = $client->followRedirect(); |
| Expand All | | @@ -48,11 +51,14 @@ public function testFormLoginAndLogoutWithCsrfTokens($config) |
|  |  | public function testFormLoginWithInvalidCsrfToken($config) |
|  |  | { |
|  |  | $client = $this->createClient(['test\_case' => 'CsrfFormLogin', 'root\_config' => $config]); |
|  |  | static::$container->get('security.csrf.token\_storage')->setToken('foo', 'bar'); |
|  |  |  |
|  |  | $form = $client->request('GET', '/login')->selectButton('login')->form(); |
|  |  | $form['user\_login[\_token]'] = ''; |
|  |  | $client->submit($form); |
|  |  |  |
|  |  | $this->assertTrue(static::$container->get('security.csrf.token\_storage')->hasToken('foo')); |
|  |  |  |
|  |  | $this->assertRedirect($client->getResponse(), '/login'); |
|  |  |  |
|  |  | $text = $client->followRedirect()->text(null, true); |
| Expand Down | |  |

4 changes: 1 addition & 3 deletions

4
[Tests/Functional/LogoutTest.php](#diff-022b41a9b664af89be91e39995dcbfd41a2c463a262f28b2fb81b7c7ea32f789 "Tests/Functional/LogoutTest.php")

Show comments

[View file](/symfony/security-bundle/blob/076fd2088ada33d760758d98ff07ddedbf567946/Tests/Functional/LogoutTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,15 +36,13 @@ public function testSessionLessRememberMeLogout() |
|  |  | public function testCsrfTokensAreClearedOnLogout() |
|  |  | { |
|  |  | $client = $this->createClient(['test\_case' => 'LogoutWithoutSessionInvalidation', 'root\_config' => 'config.yml']); |
|  |  | static::$container->get('security.csrf.token\_storage')->setToken('foo', 'bar'); |
|  |  |  |
|  |  | $client->request('POST', '/login', [ |
|  |  | '\_username' => 'johannes', |
|  |  | '\_password' => 'test', |
|  |  | ]); |
|  |  |  |
|  |  | $this->assertTrue(static::$container->get('security.csrf.token\_storage')->hasToken('foo')); |
|  |  | $this->assertSame('bar', static::$container->get('security.csrf.token\_storage')->getToken('foo')); |
|  |  | static::$container->get('security.csrf.token\_storage')->setToken('foo', 'bar'); |
|  |  |  |
|  |  | $client->request('GET', '/logout'); |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[composer.json](#diff-d2ab9925cad7eac58e0ff4cc0d251a937ecf49e4b6bf57f8b95aab76648a9d34 "composer.json")

Show comments

[View file](/symfony/security-bundle/blob/076fd2088ada33d760758d98ff07ddedbf567946/composer.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,7 @@ |
|  |  | "symfony/security-core": "^4.4", |
|  |  | "symfony/security-csrf": "^4.2|^5.0", |
|  |  | "symfony/security-guard": "^4.2|^5.0", |
|  |  | "symfony/security-http": "^4.4.5" |
|  |  | "symfony/security-http": "^4.4.50" |
|  |  | }, |
|  |  | "require-dev": { |
|  |  | "doctrine/annotations": "^1.10.4", |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `076fd20`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsymfony%2Fsecurity-bundle%2Fcommit%2F076fd2088ada33d760758d98ff07ddedbf567946) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5d29666d_20250108_112242.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsymfony%2Fsymfony%2Fsecurity%2Fadvisories%2FGHSA-3gv2-29qc-v67m)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsymfony%2Fsymfony%2Fsecurity%2Fadvisories%2FGHSA-3gv2-29qc-v67m)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=symfony%2Fsymfony)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[symfony](/symfony)
/
**[symfony](/symfony/symfony)**
Public

* [Notifications](/login?return_to=%2Fsymfony%2Fsymfony) You must be signed in to change notification settings
* [Fork
  9.5k](/login?return_to=%2Fsymfony%2Fsymfony)
* [Star
   29.9k](/login?return_to=%2Fsymfony%2Fsymfony)

* [Code](/symfony/symfony)
* [Issues
  559](/symfony/symfony/issues)
* [Pull requests
  330](/symfony/symfony/pulls)
* [Discussions](/symfony/symfony/discussions)
* [Actions](/symfony/symfony/actions)
* [Projects
  0](/symfony/symfony/projects)
* [Security](/symfony/symfony/security)
* [Insights](/symfony/symfony/pulse)

Additional navigation options

* [Code](/symfony/symfony)
* [Issues](/symfony/symfony/issues)
* [Pull requests](/symfony/symfony/pulls)
* [Discussions](/symfony/symfony/discussions)
* [Actions](/symfony/symfony/actions)
* [Projects](/symfony/symfony/projects)
* [Security](/symfony/symfony/security)
* [Insights](/symfony/symfony/pulse)

# Possible CSRF token fixation

Low

[fabpot](/fabpot)
published
GHSA-3gv2-29qc-v67m
Feb 1, 2023

## Package

composer

symfony/security-bundle
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

>=2.0.0, <4.4.50
>= 5.0.0, < 5.4.20
>= 6.0.0, < 6.0.20
>= 6.1.0, < 6.1.12
>= 6.2.0, < 6.2.6

## Patched versions

4.4.50
5.4.20
6.0.20
6.1.12
6.2.6

## Description

## Description

When authenticating users Symfony by default regenerates the session ID upon login, but preserves the rest of session attributes. Because this does not clear CSRF tokens upon login, this might enables [same-site attackers](https://canitakeyoursubdomain.name/) to bypass the CSRF protection mechanism by performing an attack similar to a session-fixation.

## Resolution

Symfony removes all CSRF tokens from the session on successful login.

The patch for this issue is available [here](https://github.com/symfony/symfony/commit/5909d74ecee359ea4982fcf4331aaf2e489a1fd4) for branch 4.4.

## Credits

We would like to thank Marco Squarcina for reporting the issue and Nicolas Grekas for fixing it.

### Severity

Low

### CVE ID

CVE-2022-24895

### Weaknesses

No CWEs

### Credits

* [![@nicolas-grekas](https://avatars.githubusercontent.com/u/243674?s=40&v=4)](/nicolas-grekas)
  [nicolas-grekas](/nicolas-grekas)
  Analyst
* [![@lavish](https://avatars.githubusercontent.com/u/446674?s=40&v=4)](/lavish)
  [lavish](/lavish)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


