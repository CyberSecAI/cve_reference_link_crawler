

⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #6900

closed

### http2: timeout logging headers

Added by [Philippe Antoine](/users/1820) [10 months](/projects/suricata/activity?from=2024-03-28 "03/28/2024 08:54 AM") ago.
Updated [8 months](/projects/suricata/activity?from=2024-05-07 "05/07/2024 02:09 PM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[8.0.0-beta1](/versions/163 "04/01/2025")
Affected Versions:Label:CVE:[2024-32663](https://nvd.nist.gov/vuln/detail/CVE-2024-32663)Git IDs:

03442c9071b8d863d26b609d54c6eacf4de9e340

Severity:HIGHDisclosure Date:06/28/2024

---

**Description**

Found by oss-fuzz:
<https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=67661>

Investigating more in this issue

---

**Subtasks**
[2](/issues?parent_id=~6900&set_filter=true&status_id=%2A) (0 open — [2 closed](/issues?parent_id=~6900&set_filter=true&status_id=c))

|  | [Security #6901](/issues/6901): http2: timeout logging headers (7.0.x backport) | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |
|  | [Security #6978](/issues/6978): http2: timeout logging headers (6.0.x backport) | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |

---

**Related issues**
[3](/issues?issue_id=6846%2C6892%2C6973&set_filter=true&status_id=%2A) (0 open — [3 closed](/issues?issue_id=6846%2C6892%2C6973&set_filter=true&status_id=c))

|  | Related to Suricata - [Bug #6846](/issues/6846): alerts: wrongly using tx id 0 when there is no tx | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |
|  | Related to Suricata - [Security #6892](/issues/6892): http2: oom on copying compressed headers | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |
|  | Related to Suricata - [Bug #6973](/issues/6973): detect: log relevant frames app-layer metdata | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/6900?tab=history)
* [Notes](/issues/6900?tab=notes)
* [Property changes](/issues/6900?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Philippe Antoine](/users/1820) [10 months](/projects/suricata/activity?from=2024-03-28 "03/28/2024 08:54 AM") ago

* **Related to** *[Bug #6846](/issues/6846): alerts: wrongly using tx id 0 when there is no tx* added

ActionsCopy link
[#2](#note-2)
#### Updated by [Philippe Antoine](/users/1820) [10 months](/projects/suricata/activity?from=2024-03-28 "03/28/2024 08:55 AM") ago

Fix for [#6846](/issues/6846 "Bug: alerts: wrongly using tx id 0 when there is no tx (Closed)") fixes this timeout because we get multiple alerts for sid 2210045 and 2210029 which logs http2 app-layer data when it should not

ActionsCopy link
[#3](#note-3)
#### Updated by [Philippe Antoine](/users/1820) [10 months](/projects/suricata/activity?from=2024-03-28 "03/28/2024 08:55 AM") ago

* **Related to** *[Security #6892](/issues/6892): http2: oom on copying compressed headers* added

ActionsCopy link
[#4](#note-4)
#### Updated by [Philippe Antoine](/users/1820) [10 months](/projects/suricata/activity?from=2024-03-28 "03/28/2024 09:10 AM") ago

http2 logging does not take too much time because a single field is too long, but we log 35367 headers.

This get bad because of http2 headers compression where one byte in the network can refer up to `HTTP2_MAX_TABLESIZE` (65536 by default, configurable with `app-layer.protocols.http2.max-table-size` bytes previously seen on the network.

ActionsCopy link
[#5](#note-5)
#### Updated by [Philippe Antoine](/users/1820) [10 months](/projects/suricata/activity?from=2024-03-28 "03/28/2024 09:11 AM") ago

I guess this is critical

ActionsCopy link
[#6](#note-6)
#### Updated by [Philippe Antoine](/users/1820) [10 months](/projects/suricata/activity?from=2024-03-28 "03/28/2024 10:19 AM") ago

* **Status** changed from *New* to *In Review*
* **Label** *Needs backport to 7.0* added

ActionsCopy link
[#7](#note-7)
#### Updated by [OISF Ticketbot](/users/7712) [10 months](/projects/suricata/activity?from=2024-03-28 "03/28/2024 10:19 AM") ago

* **Subtask** *#6901* added

ActionsCopy link
[#8](#note-8)
#### Updated by [OISF Ticketbot](/users/7712) [10 months](/projects/suricata/activity?from=2024-03-28 "03/28/2024 10:19 AM") ago

* **Label** deleted (~~*Needs backport to 7.0*~~)

ActionsCopy link
[#10](#note-10)
#### Updated by [Victor Julien](/users/4) [9 months](/projects/suricata/activity?from=2024-04-23 "04/23/2024 04:48 AM") ago

* **CVE** set to *2024-32663*

ActionsCopy link
[#11](#note-11)
#### Updated by [Victor Julien](/users/4) [9 months](/projects/suricata/activity?from=2024-04-23 "04/23/2024 04:49 AM") ago

* **Label** *Needs backport to 6.0* added

ActionsCopy link
[#12](#note-12)
#### Updated by [OISF Ticketbot](/users/7712) [9 months](/projects/suricata/activity?from=2024-04-23 "04/23/2024 04:49 AM") ago

* **Subtask** *#6978* added

ActionsCopy link
[#13](#note-13)
#### Updated by [OISF Ticketbot](/users/7712) [9 months](/projects/suricata/activity?from=2024-04-23 "04/23/2024 04:49 AM") ago

* **Label** deleted (~~*Needs backport to 6.0*~~)

ActionsCopy link
[#14](#note-14)
#### Updated by [Victor Julien](/users/4) [9 months](/projects/suricata/activity?from=2024-04-23 "04/23/2024 04:56 AM") ago

* **Severity** changed from *MODERATE* to *HIGH*

ActionsCopy link
[#15](#note-15)
#### Updated by [Victor Julien](/users/4) [9 months](/projects/suricata/activity?from=2024-04-23 "04/23/2024 12:59 PM") ago

* **Status** changed from *In Review* to *Closed*
* **Git IDs** updated ([diff](/journals/33853/diff?detail_id=34441 "View differences"))

ActionsCopy link
[#16](#note-16)
#### Updated by [Philippe Antoine](/users/1820) [8 months](/projects/suricata/activity?from=2024-05-06 "05/06/2024 07:53 PM") ago

* **Related to** *[Bug #6973](/issues/6973): detect: log relevant frames app-layer metdata* added

ActionsCopy link
[#17](#note-17)
#### Updated by [Philippe Antoine](/users/1820) [8 months](/projects/suricata/activity?from=2024-05-06 "05/06/2024 07:54 PM") ago · Edited

For info, the oss-fuzz report is still open until [#6848](/issues/6848 "Bug: alerts: wrongly using tx id 0 when there is no tx (7.0.x backport) (Closed)") gets solved

ActionsCopy link
[#18](#note-18)
#### Updated by [Victor Julien](/users/4) [8 months](/projects/suricata/activity?from=2024-05-07 "05/07/2024 02:08 PM") ago

* **Private** changed from *Yes* to *No*

<https://github.com/OISF/suricata/security/advisories/GHSA-9jxm-qw9v-266r>

Actions
Copy link

Also available in: [Atom](/issues/6900.atom)
[PDF](/issues/6900.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...

