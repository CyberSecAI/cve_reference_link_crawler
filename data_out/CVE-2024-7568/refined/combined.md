=== Content from plugins.trac.wordpress.org_2406d0e8_20250110_123109.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3139340%2540favicon-generator%26old%3D3139340%2540favicon-generator)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/588623/favicon-generator "Changeset 588623 for favicon-generator")
* [Next Change](/changeset/3139341/favicon-generator "Changeset 3139341 for favicon-generator") →

---

# Changeset [3139340](/changeset/3139340 "Show full changeset") for [favicon-generator](/browser/favicon-generator?rev=3139340 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/22/2024 01:16:53 AM
([5 months](/timeline?from=2024-08-22T01%3A16%3A53Z&precision=second "See timeline at 08/22/2024 01:16:53 AM") ago)

Author:
brandondove
Message:

Final release before closing this plugin. This plugin's functionality exists in [WordPress](/wiki/WordPress) Core and is no longer necessary. So long, and thanks for all the fish.

Location:
[favicon-generator](/browser/favicon-generator?rev=3139340)
Files:

18 deleted
4 edited
1 copied

* [tags/2.1](/browser/favicon-generator/tags/2.1?rev=3139340 "Show entry in browser")
  (copied)
  *(copied from [favicon-generator/trunk](/browser/favicon-generator/trunk?rev=588060 "Show original file (revision 3139338)"))*
* [tags/2.1/gpl-3.0.txt](/browser/favicon-generator/trunk/gpl-3.0.txt?rev=96891 "Show what was removed (content at revision 3139338)")
  (deleted)
* [tags/2.1/large-menu-icon.png](/browser/favicon-generator/trunk/large-menu-icon.png?rev=207530 "Show what was removed (content at revision 3139338)")
  (deleted)
* [tags/2.1/menu-icon.ai](/browser/favicon-generator/trunk/menu-icon.ai?rev=207530 "Show what was removed (content at revision 3139338)")
  (deleted)
* [tags/2.1/menu-icon.png](/browser/favicon-generator/trunk/menu-icon.png?rev=207528 "Show what was removed (content at revision 3139338)")
  (deleted)
* [tags/2.1/php](/browser/favicon-generator/trunk/php?rev=207528 "Show what was removed (content at revision 3139338)")
  (deleted)
* [tags/2.1/pj-favicon-generator.php](/browser/favicon-generator/tags/2.1/pj-favicon-generator.php?rev=3139340 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [tags/2.1/readme.txt](/browser/favicon-generator/tags/2.1/readme.txt?rev=3139340 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [tags/2.1/screenshot-1.png](/browser/favicon-generator/trunk/screenshot-1.png?rev=96891 "Show what was removed (content at revision 3139338)")
  (deleted)
* [tags/2.1/screenshot-2.png](/browser/favicon-generator/trunk/screenshot-2.png?rev=96891 "Show what was removed (content at revision 3139338)")
  (deleted)
* [tags/2.1/styles](/browser/favicon-generator/trunk/styles?rev=207531 "Show what was removed (content at revision 3139338)")
  (deleted)
* [tags/2.1/uploads](/browser/favicon-generator/trunk/uploads?rev=96891 "Show what was removed (content at revision 3139338)")
  (deleted)
* [trunk/gpl-3.0.txt](/browser/favicon-generator/trunk/gpl-3.0.txt?rev=96891 "Show what was removed (content at revision 3139339)")
  (deleted)
* [trunk/large-menu-icon.png](/browser/favicon-generator/trunk/large-menu-icon.png?rev=207530 "Show what was removed (content at revision 3139339)")
  (deleted)
* [trunk/menu-icon.ai](/browser/favicon-generator/trunk/menu-icon.ai?rev=207530 "Show what was removed (content at revision 3139339)")
  (deleted)
* [trunk/menu-icon.png](/browser/favicon-generator/trunk/menu-icon.png?rev=207528 "Show what was removed (content at revision 3139339)")
  (deleted)
* [trunk/php](/browser/favicon-generator/trunk/php?rev=207528 "Show what was removed (content at revision 3139339)")
  (deleted)
* [trunk/pj-favicon-generator.php](/browser/favicon-generator/trunk/pj-favicon-generator.php?rev=3139340 "Show entry in browser")
  (modified)
  ([1 diff](#file17 "Show differences"))
* [trunk/readme.txt](/browser/favicon-generator/trunk/readme.txt?rev=3139340 "Show entry in browser")
  (modified)
  ([1 diff](#file18 "Show differences"))
* [trunk/screenshot-1.png](/browser/favicon-generator/trunk/screenshot-1.png?rev=96891 "Show what was removed (content at revision 3139339)")
  (deleted)
* [trunk/screenshot-2.png](/browser/favicon-generator/trunk/screenshot-2.png?rev=96891 "Show what was removed (content at revision 3139339)")
  (deleted)
* [trunk/styles](/browser/favicon-generator/trunk/styles?rev=207531 "Show what was removed (content at revision 3139339)")
  (deleted)
* [trunk/uploads](/browser/favicon-generator/trunk/uploads?rev=96891 "Show what was removed (content at revision 3139339)")
  (deleted)

### Legend:

Unmodified
Added
Removed

* ## [favicon-generator/tags/2.1/pj-favicon-generator.php](/changeset/3139340/favicon-generator/tags/2.1/pj-favicon-generator.php "Show the changeset 3139340 restricted to favicon-generator/tags/2.1/pj-favicon-generator.php")

  | [r588060](/browser/favicon-generator/trunk/pj-favicon-generator.php?rev=588060#L1 "Show revision 588060 of this file in browser") | [r3139340](/browser/favicon-generator/tags/2.1/pj-favicon-generator.php?rev=3139340#L1 "Show revision 3139340 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  | /\* |
  | 3 |  | Plugin Name: Favicon Generator |
  | 4 |  | Plugin URI: http://www.pixeljar.net/plugins/favicon-generator |
  | 5 |  | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=3441397 |
  | 6 |  | Description: This plugin will allow you to upload an image file of your choosing to be converted to a favicon for your WordPress site. |
  | 7 |  | Author: Brandon Dove, Jeffrey Zinn |
  | 8 |  | Version: 1.5 |
  | 9 |  | Author URI: http://www.pixeljar.net |
  |  | 2 | /\*\* |
  |  | 3 | \* Plugin Name: Favicon Generator (CLOSED) |
  |  | 4 | \* Plugin URI: http://www.pixeljar.com |
  |  | 5 | \* Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=3441397 |
  |  | 6 | \* Description: This plugin's functionality has been included in WordPress core for many years. It is no longer necessary to use this plugin. As such, this plugin can no longer be activated. |
  |  | 7 | \* Author: Pixel Jar |
  |  | 8 | \* Version: 2.1 |
  |  | 9 | \* Author URI: http://www.pixeljar.com |
  |  | 10 | \* License: GPL2 |
  |  | 11 | \* License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  |  | 12 | \* Text Domain: pjfavgen |
  |  | 13 | \* Domain Path: /lang |
  |  | 14 | \* Requires at least: 4.0 |
  |  | 15 | \* Tested up to: 6.6.1 |
  |  | 16 | \* |
  |  | 17 | \* Copyright 2024  Pixel jar  (email : info@pixeljar.com) |
  |  | 18 | \* |
  |  | 19 | \* This program is free software; you can redistribute it and/or modify |
  |  | 20 | \* it under the terms of the GNU General Public License as published by |
  |  | 21 | \* the Free Software Foundation; either version 2 of the License, or |
  |  | 22 | \* (at your option) any later version. |
  |  | 23 | \* |
  |  | 24 | \* This program is distributed in the hope that it will be useful, |
  |  | 25 | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
  |  | 26 | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
  |  | 27 | \* GNU General Public License for more details. |
  |  | 28 | \* |
  |  | 29 | \* You should have received a copy of the GNU General Public License |
  |  | 30 | \* along with this program; if not, write to the Free Software |
  |  | 31 | \* Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA |
  |  | 32 | \* |
  |  | 33 | \* @package WordPress |
  |  | 34 | \* @subpackage PJ\_Favicon\_Generator |
  |  | 35 | \*/ |
  | 10 | 36 |  |
  |  | 37 | /\*\* |
  |  | 38 | \* Deactivate the plugin as the functionality is now in WordPress core. |
  |  | 39 | \*/ |
  |  | 40 | function pj\_favicon\_generator\_deactivate() { |
  | 11 | 41 |  |
  | 12 |  | Copyright 2009  Pixel jar  (email : info@pixeljar.net) |
  |  | 42 | $plugin = plugin\_basename( \_\_FILE\_\_ ); |
  |  | 43 | if ( is\_plugin\_active( $plugin ) ) { |
  | 13 | 44 |  |
  | 14 |  | This program is free software; you can redistribute it and/or modify |
  | 15 |  | it under the terms of the GNU General Public License as published by |
  | 16 |  | the Free Software Foundation; either version 2 of the License, or |
  | 17 |  | (at your option) any later version. |
  |  | 45 | delete\_option( 'pj\_favicon\_generator\_options' ); |
  |  | 46 | deactivate\_plugins( $plugin, true ); |
  | 18 | 47 |  |
  | 19 |  | This program is distributed in the hope that it will be useful, |
  | 20 |  | but WITHOUT ANY WARRANTY; without even the implied warranty of |
  | 21 |  | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
  | 22 |  | GNU General Public License for more details. |
  |  | 48 | } |
  | 23 | 49 |  |
  | 24 |  | ~~You should have received a copy of the GNU General Public License~~ |
  | 25 |  | ~~along with this program; if not, write to the Free Software~~ |
  | 26 |  | ~~Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA~~ |
  | 27 |  | ~~\*/~~ |
  | 28 |  |  |
  | 29 |  | ~~if ( ! defined( 'PJFAV\_URL' ) )~~ |
  | 30 |  | ~~define( 'PJFAV\_URL', plugin\_dir\_url( \_\_FILE\_\_ ) );~~ |
  | 31 |  | ~~if ( ! defined( 'PJFAV\_DIR' ) )~~ |
  | 32 |  | ~~define( 'PJFAV\_DIR', plugin\_dir\_path( \_\_FILE\_\_ ) );~~ |
  | 33 |  |  |
  | 34 |  | ~~load\_plugin\_textdomain( 'pj-favicon-generator', PJFAV\_DIR );~~ |
  | 35 |  |  |
  | 36 |  | ~~function pj\_favicon\_admin\_scripts() {~~ |
  | 37 |  | ~~if ( isset($\_GET['page']) && $\_GET['page'] == "Favicon-Generator" )~~ |
  | 38 |  | ~~wp\_enqueue\_style( 'pjfav-admin-css', PJFAV\_URL.'styles/styles.css' );~~ |
  | 39 | 50 | } |
  | 40 |  | add\_action( 'admin\_init', 'pj\_favicon\_admin\_scripts', 1 ); |
  | 41 |  | register\_activation\_hook( \_\_FILE\_\_, array( &$pj\_favicon\_generator, 'activate' ) ); |
  | 42 |  | add\_action( 'admin\_notices', array(&$pj\_favicon\_generator, 'check\_installation') ); |
  | 43 |  |  |
  | 44 |  |  |
  | 45 |  | if (!class\_exists('pj\_favicon\_generator')) { |
  | 46 |  |  |
  | 47 |  | include ('php/Directory.php'); |
  | 48 |  | include ('php/Ico2\_1.php'); |
  | 49 |  | include ('php/Image.php'); |
  | 50 |  |  |
  | 51 |  | class pj\_favicon\_generator  { |
  | 52 |  |  |
  | 53 |  | /\*\* |
  | 54 |  | \* @var string   The name the options are saved under in the database. |
  | 55 |  | \*/ |
  | 56 |  | var $adminOptionsName = "pj\_favicon\_generator\_options"; |
  | 57 |  |  |
  | 58 |  | /\*\* |
  | 59 |  | \* @var array   The options that are saved in the database. |
  | 60 |  | \*/ |
  | 61 |  | var $adminOptions = array(); |
  | 62 |  |  |
  | 63 |  | /\*\* |
  | 64 |  | \* PHP 4 Compatible Constructor |
  | 65 |  | \*/ |
  | 66 |  | function pj\_favicon\_generator(){$this->\_\_construct();} |
  | 67 |  |  |
  | 68 |  | /\*\* |
  | 69 |  | \* PHP 5 Constructor |
  | 70 |  | \*/ |
  | 71 |  | function \_\_construct(){ |
  | 72 |  | $this->adminOptions = $this->getAdminOptions(); |
  | 73 |  | add\_action("admin\_menu", array(&$this,"add\_admin\_pages")); |
  | 74 |  | add\_action('wp\_head', array(&$this,'wp\_head\_intercept')); |
  | 75 |  | } |
  | 76 |  |  |
  | 77 |  | /\*\* |
  | 78 |  | \* Retrieves the options from the database. |
  | 79 |  | \* @return array |
  | 80 |  | \*/ |
  | 81 |  | function getAdminOptions() { |
  | 82 |  | $adminOptions = array( |
  | 83 |  | "favicon" => "<empty>", |
  | 84 |  | "donated" => "no" |
  | 85 |  | ); |
  | 86 |  | $savedOptions = get\_option($this->adminOptionsName); |
  | 87 |  | if (!empty($savedOptions)) { |
  | 88 |  | foreach ($savedOptions as $key => $option) { |
  | 89 |  | $adminOptions[$key] = $option; |
  | 90 |  | } |
  | 91 |  | } |
  | 92 |  | update\_option($this->adminOptionsName, $adminOptions); |
  | 93 |  | return $adminOptions; |
  | 94 |  | } |
  | 95 |  |  |
  | 96 |  | function saveAdminOptions(){ |
  | 97 |  | update\_option($this->adminOptionsName, $this->adminOptions); |
  | 98 |  | } |
  | 99 |  |  |
  | 100 |  | /\*\* |
  | 101 |  | \* Runs on plugin activation |
  | 102 |  | \*/ |
  | 103 |  | function activate () { |
  | 104 |  | $uploaddir = PJFAV\_DIR.'uploads/'; |
  | 105 |  | wp\_mkdir\_p( $uploaddir ); |
  | 106 |  | } |
  | 107 |  | /\*\* |
  | 108 |  | \* Checks to make sure that all |
  | 109 |  | \* required directories are set up properly |
  | 110 |  | \*/ |
  | 111 |  | function check\_installation() { |
  | 112 |  | if ( (stripos($\_SERVER['REQUEST\_URI'],'plugins.php') !== false) || (!empty($\_GET['page']) && $\_GET['page'] == "Favicon-Generator" ) ) : |
  | 113 |  | $dir\_list = ""; |
  | 114 |  | $dir\_list2 = ""; |
  | 115 |  |  |
  | 116 |  | $uploaddir = PJFAV\_DIR.'uploads/'; |
  | 117 |  | wp\_mkdir\_p( $uploaddir ); |
  | 118 |  |  |
  | 119 |  | if (!is\_dir(PJFAV\_DIR)){ |
  | 120 |  | $dir\_list2.= "<li>".PJFAV\_DIR . "</li>"; |
  | 121 |  | } elseif (!is\_writable(PJFAV\_DIR)){ |
  | 122 |  | $dir\_list.= "<li>".PJFAV\_DIR . "</li>"; |
  | 123 |  | } |
  | 124 |  |  |
  | 125 |  | if (!is\_dir($uploaddir)){ |
  | 126 |  | $dir\_list2.= "<li>".$uploaddir . "</li>"; |
  | 127 |  | } elseif (!is\_writable($uploaddir)){ |
  | 128 |  | $dir\_list.= "<li>".$uploaddir . "</li>"; |
  | 129 |  | } |
  | 130 |  |  |
  | 131 |  | if ($dir\_list2 != ""){ |
  | 132 |  | echo "<div id='pj-favicon-install-error-message' class='error'><p><strong>".\_\_('Favicon Generator is not ready yet.', 'pj-favicon-generator')."</strong> ".\_\_('must create the following folders (and must chmod 777):', 'pj-favicon-generator')."</p><ul>"; |
  | 133 |  | echo $dir\_list2; |
  | 134 |  | echo "</ul></div>"; |
  | 135 |  | } |
  | 136 |  | if ($dir\_list != ""){ |
  | 137 |  | echo "<div id='pj-favicon-install-error-message-2' class='error'><p><strong>".\_\_('Favicon Generator is not ready yet.', 'pj-favicon-generator')."</strong> ".\_\_('The following folders must be writable (usually chmod 777 is neccesary):', 'pj-favicon-generator')."</p><ul>"; |
  | 138 |  | echo $dir\_list; |
  | 139 |  | echo "</ul></div>"; |
  | 140 |  | } |
  | 141 |  | endif; |
  | 142 |  | } |
  | 143 |  |  |
  | 144 |  | /\*\* |
  | 145 |  | \* Creates the admin page. |
  | 146 |  | \*/ |
  | 147 |  | function add\_admin\_pages(){ |
  | 148 |  | add\_menu\_page("Favicon Generator", "Favicon Generator", 10, "Favicon-Generator", array(&$this,"output\_sub\_admin\_page\_0"), PJFAV\_URL.'/menu-icon.png'); |
  | 149 |  | } |
  | 150 |  |  |
  | 151 |  | /\*\* |
  | 152 |  | \* Outputs the HTML for the admin sub page. |
  | 153 |  | \*/ |
  | 154 |  | function output\_sub\_admin\_page\_0 () { |
  | 155 |  |  |
  | 156 |  | // PATHS |
  | 157 |  | $uploaddir = PJFAV\_DIR.'uploads/'; |
  | 158 |  | $uploadurl = PJFAV\_URL.'uploads/'; |
  | 159 |  | $submiturl = preg\_replace('/&[du]=[a-z0-9.%()\_-]\*\.(jpg|jpeg|gif|png)/is', '', $\_SERVER['REQUEST\_URI']); |
  | 160 |  |  |
  | 161 |  | $msg = ""; |
  | 162 |  |  |
  | 163 |  | // USER UPLOADED A NEW IMAGE |
  | 164 |  | if (!empty($\_FILES)) { |
  | 165 |  | $userfile = preg\_replace('/\\\\\'/', '', $\_FILES['favicon']['name']); |
  | 166 |  | $file\_size = $\_FILES['favicon']['size']; |
  | 167 |  | $file\_temp = $\_FILES['favicon']['tmp\_name']; |
  | 168 |  | $file\_err = $\_FILES['favicon']['error']; |
  | 169 |  | $file\_name = explode('.', $userfile); |
  | 170 |  | $file\_type = strtolower($file\_name[count($file\_name) - 1]); |
  | 171 |  | $uploadedfile = $uploaddir.$userfile; |
  | 172 |  |  |
  | 173 |  | if(!empty($userfile)) { |
  | 174 |  | $file\_type = strtolower($file\_type); |
  | 175 |  | $files = array('jpeg', 'jpg', 'gif', 'png'); |
  | 176 |  | $key = array\_search($file\_type, $files); |
  | 177 |  |  |
  | 178 |  | if(!$key) { |
  | 179 |  | $msg .= \_\_("ILLEGAL FILE TYPE. Only JPEG, JPG, GIF or PNG files are allowed.", 'pj-favicon-generator')."<br />"; |
  | 180 |  | } |
  | 181 |  |  |
  | 182 |  | // ERROR CHECKING |
  | 183 |  | $error\_count = count($file\_error); |
  | 184 |  | if($error\_count > 0) { |
  | 185 |  | for($i = 0; $i <= $error\_count; ++$i) { |
  | 186 |  | $msg .= $\_FILES['favicon']['error'][$i]."<br />"; |
  | 187 |  | } |
  | 188 |  | } else { |
  | 189 |  | if (is\_file(PJFAV\_DIR.'favicon.ico')) { |
  | 190 |  | if (!unlink(PJFAV\_DIR.'favicon.ico')) { |
  | 191 |  | $msg .= \_\_("There was an error deleting the old favicon.", 'pj-favicon-generator')."<br />"; |
  | 192 |  | } |
  | 193 |  | } |
  | 194 |  |  |
  | 195 |  | if(!move\_uploaded\_file($file\_temp, $uploadedfile)) { |
  | 196 |  | $msg .= \_\_("There was an error when uploading your file.", 'pj-favicon-generator')."<br />"; |
  | 197 |  | } |
  | 198 |  | if (!chmod($uploadedfile, 0777)) { |
  | 199 |  | $msg .= \_\_("There was an error when changing your favicon's permissions.", 'pj-favicon-generator')."<br />"; |
  | 200 |  | } |
  | 201 |  |  |
  | 202 |  | $img =new Image($uploadedfile); |
  | 203 |  | $img->resizeImage(16,16); |
  | 204 |  | $img->saveImage($uploadedfile); |
  | 205 |  |  |
  | 206 |  | switch ($file\_type) { |
  | 207 |  | case "jpeg": |
  | 208 |  | case "jpg": |
  | 209 |  | $im = imagecreatefromjpeg($uploadedfile); |
  | 210 |  | break; |
  | 211 |  | case "gif": |
  | 212 |  | $im = imagecreatefromgif($uploadedfile); |
  | 213 |  | break; |
  | 214 |  | case "png": |
  | 215 |  | $im = imagecreatefrompng($uploadedfile); |
  | 216 |  | imagealphablending($im, true); // setting alpha blending on |
  | 217 |  | imagesavealpha($im, true); // save alphablending setting (important) |
  | 218 |  | break; |
  | 219 |  | } |
  | 220 |  | // ImageICO function provided by JPEXS.com <http://www.jpexs.com/php.html> |
  | 221 |  | ImageIco($im, PJFAV\_DIR.'favicon.ico'); |
  | 222 |  | $this->adminOptions['favicon'] = $userfile; |
  | 223 |  | $this->saveAdminOptions(); |
  | 224 |  | $msg .= \_\_("Your favicon has been updated.", 'pj-favicon-generator'); |
  | 225 |  | } |
  | 226 |  |  |
  | 227 |  | } |
  | 228 |  | } |
  | 229 |  |  |
  | 230 |  | if (!empty($\_POST['donated'])) : |
  | 231 |  |  |
  | 232 |  | $this->adminOptions['donated'] = $\_POST['donated']; |
  | 233 |  | $this->saveAdminOptions(); |
  | 234 |  |  |
  | 235 |  | endif; |
  | 236 |  |  |
  | 237 |  | // USER HAS CHOSEN TO DELETE AN UPLOADED IMAGE |
  | 238 |  | if (!empty($\_GET['d']) && is\_file($uploaddir.$\_GET['d'])) { |
  | 239 |  | if (!unlink ($uploaddir.$\_GET['d'])) { |
  | 240 |  | $msg .= \_\_("There was a problem deleting the selected image.", 'pj-favicon-generator'); |
  | 241 |  | } else { |
  | 242 |  | $msg .= \_\_("The selected image has been deleted.", 'pj-favicon-generator'); |
  | 243 |  | } |
  | 244 |  | } |
  | 245 |  |  |
  | 246 |  | // USER HAS CHOSEN TO CHANGE HIS FAVICON TO A PREVIOUSLY UPLOADED IMAGE |
  | 247 |  | if (!empty($\_GET['u'])) { |
  | 248 |  | $file\_name = explode('.', $\_GET['u']); |
  | 249 |  | $file\_type = $file\_name[count($file\_name) - 1]; |
  | 250 |  | switch ($file\_type) { |
  | 251 |  | case "jpeg": |
  | 252 |  | case "jpg": |
  | 253 |  | $im = imagecreatefromjpeg($uploaddir.$\_GET['u']); |
  | 254 |  | break; |
  | 255 |  | case "gif": |
  | 256 |  | $im = imagecreatefromgif($uploaddir.$\_GET['u']); |
  | 257 |  | break; |
  | 258 |  | case "png": |
  | 259 |  | $im = imagecreatefrompng($uploaddir.$\_GET['u']); |
  | 260 |  | imagealphablending($im, true); // setting alpha blending on |
  | 261 |  | imagesavealpha($im, true); // save alphablending setting (important) |
  | 262 |  | break; |
  | 263 |  | } |
  | 264 |  |  |
  | 265 |  | // ImageICO function provided by JPEXS.com <http://www.jpexs.com/php.html> |
  | 266 |  | ImageIco($im, PJFAV\_DIR.'favicon.ico'); |
  | 267 |  | $this->adminOptions['favicon'] = $\_GET['u']; |
  | 268 |  | $this->saveAdminOptions(); |
  | 269 |  | $msg .= \_\_("Your favicon has been updated.", 'pj-favicon-generator'); |
  | 270 |  | } |
  | 271 |  | ?> |
  | 272 |  | <div class="wrap favicon-generator"> |
  | 273 |  | <div id="favicon-options" class="icon32" style="background: transparent url('<?php echo PJFAV\_URL; ?>large-menu-icon.png') no-repeat;"><br /></div> |
  | 274 |  | <h2>Favicon Generator</h2> |
  | 275 |  |  |
  | 276 |  | <?php |
  | 277 |  | $ads = '<script type="text/javascript">'; |
  | 278 |  | $ads.= 'var psHost = (("https:" == document.location.protocol) ? "https://" : "http://");'; |
  | 279 |  | $ads.= 'document.write(unescape("%3Cscript src=\'" + psHost + "pluginsponsors.com/direct/spsn/display.php?client=pj-favicon-generator&spot=\' type=\'text/javascript\'%3E%3C/script%3E"));'; |
  | 280 |  | $ads.= '</script>'; |
  | 281 |  | if ($this->adminOptions['donated'] == 'no') |
  | 282 |  | echo $ads; |
  | 283 |  | ?> |
  | 284 |  |  |
  | 285 |  | <form method="post" action="<?php echo $submiturl; ?>" enctype="multipart/form-data"> |
  | 286 |  | <?php wp\_nonce\_field('update-options'); ?> |
  | 287 |  |  |
  | 288 |  |  |
  | 289 |  | <h3><?php \_e('Upload a New Image', 'pj-favicon-generator'); ?></h3> |
  | 290 |  | <p><?php \_e('Acceptable file types are JPG, JPEG, GIF and PNG. Note that for this to work, you\'re going to need to have PHP configured with the GD2 library.', 'pj-favicon-generator'); ?></p> |
  | 291 |  |  |
  | 292 |  | <table class="form-table"> |
  | 293 |  | <?php if ($this->adminOptions['donated'] == 'no') : ?> |
  | 294 |  | <tr valign="top"> |
  | 295 |  | <th scope="row"><?php \_e('Donations', 'pj-favicon-generator'); ?></th> |
  | 296 |  | <td> |
  | 297 |  | <input type="radio" name="donated" value="no"<?php echo ($this->adminOptions['donated'] == 'no') ? ' checked="checked"' : '' ?> />  <?php \_e('I haven\'t donated to this plugin yet. <small>(<a href="https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=3441397" target="\_blank">What are you waiting for?</a>)</small>', 'pj-favicon-generator'); ?><br /> |
  | 298 |  | <input type="radio" name="donated" value="yes" /> <?php \_e('I\'ve donated to this plugin because I love it. Turn off the ads.', 'pj-favicon-generator'); ?><br /> |
  | 299 |  | <input type="submit" class="button-primary" name="save-donations" value="Save Changes" /> |
  | 300 |  | </td> |
  | 301 |  | </tr> |
  | 302 |  | <?php endif; ?> |
  | 303 |  | <tr valign="top"> |
  | 304 |  | <th scope="row"><?php \_e('Favicon Source', 'pj-favicon-generator'); ?></th> |
  | 305 |  | <td> |
  | 306 |  | <input type="file" name="favicon" id="favicon" /> |
  | 307 |  | <input type="submit" class="button" name="html-upload" value="Upload" /> |
  | 308 |  | </td> |
  | 309 |  | </tr> |
  | 310 |  | </table> |
  | 311 |  |  |
  | 312 |  | <h3><?php \_e('Select a Previously Uploaded File', 'pj-favicon-generator'); ?></h3> |
  | 313 |  | <p><?php \_e('Since this plugin stores every image you upload, you can upload as many images as you like. You can then come back from time to time and change your favicon. Select from the choices below.', 'pj-favicon-generator'); ?></p> |
  | 314 |  | <p><em><strong><?php \_e('Note:', 'pj-favicon-generator') ?></strong> <?php \_e('Some browsers hang on to old favicon images in their cache. This is an unfortunate side effect of caching. If you make a change to your favicon and don\'t immediately see the change, don\'t start banging your head against the wall. This is not an indication that this plugin is not working. Try <a href="http://en.wikipedia.org/wiki/Bypass\_your\_cache" target="\_blank">emptying your cache</a> and quitting the browser.', 'pj-favicon-generator'); ?></em></p> |
  | 315 |  | <?php |
  | 316 |  | $files = dirList($uploaddir); |
  | 317 |  | for ($i = 0; $i < count($files); $i++) : |
  | 318 |  | $active = ($files[$i] == $this->adminOptions['favicon']) ? true : false; |
  | 319 |  | echo '<div style="float: left; margin-top: 20px; padding: 10px; text-align: center;'.(($active) ? ' background-color: #dddddd' : '').'">'; |
  | 320 |  | echo '  <div class="choice-block" style="position: relative; width: 36px; height: 36px; border: 1px solid '.(($active) ? '#ff6666' : '#cccccc').';">'; |
  | 321 |  | echo '      <img src="'.$uploadurl.$files[$i].'" title="'.$files[$i].'" alt="'.$files[$i].'" class="favicon-choices" style="position: absolute; top: 10px; left: 10px; width: 16px; height: 16px;" />'; |
  | 322 |  | echo '  </div>'; |
  | 323 |  | echo '  <div>'; |
  | 324 |  | echo ($active) ? \_\_('Active', 'pj-favicon-generator').'<br />' : '      <a href="'.$submiturl.'&d='.$files[$i].'">'.\_\_('Delete', 'pj-favicon-generator').'</a><br />'; |
  | 325 |  | echo ($active) ? \_\_('Icon', 'pj-favicon-generator') : '     <a href="'.$submiturl.'&u='.$files[$i].'">'.\_\_('Use', 'pj-favicon-generator').'</a>'; |
  | 326 |  | echo '  </div>'; |
  | 327 |  | echo '</div>'; |
  | 328 |  |  |
  | 329 |  | endfor; |
  | 330 |  | echo '<div class="clear"></div>' |
  | 331 |  | ?> |
  | 332 |  | </form> |
  | 333 |  | </div> |
  | 334 |  | <?php |
  | 335 |  | } |
  | 336 |  |  |
  | 337 |  |  |
  | 338 |  | /\*\* |
  | 339 |  | \* Called by the action wp\_head |
  | 340 |  | \*/ |
  | 341 |  | function wp\_head\_intercept() { |
  | 342 |  | //this is a sample function that includes additional styles within the head of your template. |
  | 343 |  | echo '<link rel="shortcut icon" href="'.PJFAV\_URL.'favicon.ico" />'; |
  | 344 |  | // echo '<link rel="apple-touch-icon" href="'.PJFAV\_URL.'touchicon.png" />'; // coming soon! |
  | 345 |  | echo '<meta name="generator" content="Think-Press Favicon Generator v1.5" />'; |
  | 346 |  | } |
  | 347 |  |  |
  | 348 |  | } |
  | 349 |  | } |
  | 350 |  |  |
  | 351 |  | //instantiate the class |
  | 352 |  | if (class\_exists('pj\_favicon\_generator')) { |
  | 353 |  | $pj\_favicon\_generator = new pj\_favicon\_generator(); |
  | 354 |  | } |
  |  | 51 | add\_action( 'admin\_init', 'pj\_favicon\_generator\_deactivate' ); |
* ## [favicon-generator/tags/2.1/readme.txt](/changeset/3139340/favicon-generator/tags/2.1/readme.txt "Show the changeset 3139340 restricted to favicon-generator/tags/2.1/readme.txt")

  | [r588060](/browser/favicon-generator/trunk/readme.txt?rev=588060#L1 "Show revision 588060 of this file in browser") | [r3139340](/browser/favicon-generator/tags/2.1/readme.txt?rev=3139340#L1 "Show revision 3139340 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === Plugin Name === |
  | 2 |  | Contributors: brandondove, ~~jeffreyzinn~~ |
  |  | 2 | Contributors: brandondove, lordleiter |
  | 3 | 3 | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=3441397 |
  | 4 | 4 | Tags: favicon |
  | 5 |  | Requires at least: ~~2.8~~ |
  | 6 |  | Tested up to: ~~2.9.2~~ |
  | 7 |  | Stable tag: ~~1.5~~ |
  |  | 5 | Requires at least: 4.0 |
  |  | 6 | Tested up to: 6.6.1 |
  |  | 7 | Stable tag: 2.1 |
  | 8 | 8 |  |
  | 9 | 9 | == Description == |
  | 10 | 10 |  |
  | 11 |  | This plugin will allow you to upload an image in the format of a jpeg, gif or png and will convert the image into a <a href="http://en.wikipedia.org/wiki/Favicon" target="\_blank">favicon</a> formatted file. This file will be placed in your WordPress root directory and a link tag will then be added to your html output. |
  | 12 |  |  |
  | 13 |  | == Installation == |
  | 14 |  |  |
  | 15 |  | 1. Upload the `favicon-generator` folder to your `/wp-content/plugins/` directory. |
  | 16 |  | 2. Make sure that the `favicon-generator` folder and the `favicon-generator/uploads` folder have their permissions set to 777. |
  | 17 |  | 3. Activate the plugin through the 'Plugins' menu in WordPress. |
  | 18 |  |  |
  | 19 |  | == Frequently Asked Questions == |
  | 20 |  |  |
  | 21 |  | = What file types do you support? = |
  | 22 |  |  |
  | 23 |  | We support JPEG, GIF and PNG. Note: In order for this plugin to properly generate images, your server must have PHP configured with the GD2 library. |
  | 24 |  |  |
  | 25 |  | = How do I make this work? = |
  | 26 |  |  |
  | 27 |  | 1. Find the Favicon Generator section in WordPress. |
  | 28 |  | 2. Upload an image. Generally speaking this would be your logo or something of that nature. |
  | 29 |  | 3. That's it! Your website now has an awesome favicon. |
  | 30 |  |  |
  | 31 |  | = Why isn't my favicon showing up? = |
  | 32 |  |  |
  | 33 |  | Some browsers hang on to old favicon images in their cache. This is an unfortunate side effect of caching. If you make a change to your favicon and don't immediately see the change, don't start banging your head against the wall. This is not an indication that this plugin is not working. Try <a href="http://en.wikipedia.org/wiki/Bypass\_your\_cache" target="\_blank">emptying your cache</a> and quitting the browser. |
  | 34 |  |  |
  | 35 |  | If that doesn't work, it could also be because your theme doesn't make use of WordPress' wp\_head() function. If this is the case, sadly you'll have to edit your theme. This function is what allows us to automagically insert the favicon code. Most modern themes comply with this WordPress standard, so this really shouldn't be the problem unless you built your own custom theme or are using a really old theme. |
  | 36 |  |  |
  | 37 |  | == Version History == |
  | 38 |  |  |
  | 39 |  | = Version 1.1 = |
  | 40 |  |  |
  | 41 |  | 1. Added PHP 4 Compatibility |
  | 42 |  | 2. Updated the ImageIco library from <http://www.jpexs.com/php.html> |
  | 43 |  | 3. Cannot delete active favicon |
  | 44 |  | 4. Added highlight to active favicon |
  | 45 |  |  |
  | 46 |  | = Version 1.2 = |
  | 47 |  |  |
  | 48 |  | 1. Forgot to add the new ImageIco library via SVN. This version has it. Sorry about the mixup. |
  | 49 |  |  |
  | 50 |  | = Version 1.3 = |
  | 51 |  |  |
  | 52 |  | 1. AAAARGH! Include error was happening because I forgot about case sensitivity in Linux filesystems. Sorry, I'm on a mac. |
  | 53 |  |  |
  | 54 |  | = Version 1.4 = |
  | 55 |  |  |
  | 56 |  | 1. Supressed errors that appeared if the upload directory wasn't created. Added in creation of the upload directory to the init routines. |
  | 57 |  |  |
  | 58 |  | = Version 1.5 = |
  | 59 |  |  |
  | 60 |  | 1. Added support for ads from pluginsponsors.com to be placed on the admin page. A guy's gotta earn a living, right? |
  | 61 |  | 2. Tested functionality against WordPress version 2.9.2 |
  | 62 |  | 3. Increased the minimum WordPress version to 2.8 because, come on...who's still running WordPress 2.1? |
  | 63 |  | 4. Added checks to make sure certain necessary directories and permissions were set properly. |
  | 64 |  | 5. Suppressed ugly warnings that were displayed when the upload directories weren't set properly. |
  | 65 |  | 6. Added support for l10n. |
  | 66 |  |  |
  | 67 |  | == Screenshots == |
  | 68 |  |  |
  | 69 |  | 1. Favicon Generator configuration screen |
  | 70 |  | 2. Shows the favicon in place |
  |  | 11 | This plugin's functionality has been included in WordPress core for many years. It is no longer necessary to use this plugin. As such, this plugin can no longer be activated. |
* ## [favicon-generator/trunk/pj-favicon-generator.php](/changeset/3139340/favicon-generator/trunk/pj-favicon-generator.php "Show the changeset 3139340 restricted to favicon-generator/trunk/pj-favicon-generator.php")

  | [r588060](/browser/favicon-generator/trunk/pj-favicon-generator.php?rev=588060#L1 "Show revision 588060 of this file in browser") | [r3139340](/browser/favicon-generator/trunk/pj-favicon-generator.php?rev=3139340#L1 "Show revision 3139340 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  | /\* |
  | 3 |  | Plugin Name: Favicon Generator |
  | 4 |  | Plugin URI: http://www.pixeljar.net/plugins/favicon-generator |
  | 5 |  | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=3441397 |
  | 6 |  | Description: This plugin will allow you to upload an image file of your choosing to be converted to a favicon for your WordPress site. |
  | 7 |  | Author: Brandon Dove, Jeffrey Zinn |
  | 8 |  | Version: 1.5 |
  | 9 |  | Author URI: http://www.pixeljar.net |
  |  | 2 | /\*\* |
  |  | 3 | \* Plugin Name: Favicon Generator (CLOSED) |
  |  | 4 | \* Plugin URI: http://www.pixeljar.com |
  |  | 5 | \* Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=3441397 |
  |  | 6 | \* Description: This plugin's functionality has been included in WordPress core for many years. It is no longer necessary to use this plugin. As such, this plugin can no longer be activated. |
  |  | 7 | \* Author: Pixel Jar |
  |  | 8 | \* Version: 2.1 |
  |  | 9 | \* Author URI: http://www.pixeljar.com |
  |  | 10 | \* License: GPL2 |
  |  | 11 | \* License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  |  | 12 | \* Text Domain: pjfavgen |
  |  | 13 | \* Domain Path: /lang |
  |  | 14 | \* Requires at least: 4.0 |
  |  | 15 | \* Tested up to: 6.6.1 |
  |  | 16 | \* |
  |  | 17 | \* Copyright 2024  Pixel jar  (email : info@pixeljar.com) |
  |  | 18 | \* |
  |  | 19 | \* This program is free software; you can redistribute it and/or modify |
  |  | 20 | \* it under the terms of the GNU General Public License as published by |
  |  | 21 | \* the Free Software Foundation; either version 2 of the License, or |
  |  | 22 | \* (at your option) any later version. |
  |  | 23 | \* |
  |  | 24 | \* This program is distributed in the hope that it will be useful, |
  |  | 25 | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
  |  | 26 | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
  |  | 27 | \* GNU General Public License for more details. |
  |  | 28 | \* |
  |  | 29 | \* You should have received a copy of the GNU General Public License |
  |  | 30 | \* along with this program; if not, write to the Free Software |
  |  | 31 | \* Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA |
  |  | 32 | \* |
  |  | 33 | \* @package WordPress |
  |  | 34 | \* @subpackage PJ\_Favicon\_Generator |
  |  | 35 | \*/ |
  | 10 | 36 |  |
  |  | 37 | /\*\* |
  |  | 38 | \* Deactivate the plugin as the functionality is now in WordPress core. |
  |  | 39 | \*/ |
  |  | 40 | function pj\_favicon\_generator\_deactivate() { |
  | 11 | 41 |  |
  | 12 |  | Copyright 2009  Pixel jar  (email : info@pixeljar.net) |
  |  | 42 | $plugin = plugin\_basename( \_\_FILE\_\_ ); |
  |  | 43 | if ( is\_plugin\_active( $plugin ) ) { |
  | 13 | 44 |  |
  | 14 |  | This program is free software; you can redistribute it and/or modify |
  | 15 |  | it under the terms of the GNU General Public License as published by |
  | 16 |  | the Free Software Foundation; either version 2 of the License, or |
  | 17 |  | (at your option) any later version. |
  |  | 45 | delete\_option( 'pj\_favicon\_generator\_options' ); |
  |  | 46 | deactivate\_plugins( $plugin, true ); |
  | 18 | 47 |  |
  | 19 |  | This program is distributed in the hope that it will be useful, |
  | 20 |  | but WITHOUT ANY WARRANTY; without even the implied warranty of |
  | 21 |  | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
  | 22 |  | GNU General Public License for more details. |
  |  | 48 | } |
  | 23 | 49 |  |
  | 24 |  | ~~You should have received a copy of the GNU General Public License~~ |
  | 25 |  | ~~along with this program; if not, write to the Free Software~~ |
  | 26 |  | ~~Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA~~ |
  | 27 |  | ~~\*/~~ |
  | 28 |  |  |
  | 29 |  | ~~if ( ! defined( 'PJFAV\_URL' ) )~~ |
  | 30 |  | ~~define( 'PJFAV\_URL', plugin\_dir\_url( \_\_FILE\_\_ ) );~~ |
  | 31 |  | ~~if ( ! defined( 'PJFAV\_DIR' ) )~~ |
  | 32 |  | ~~define( 'PJFAV\_DIR', plugin\_dir\_path( \_\_FILE\_\_ ) );~~ |
  | 33 |  |  |
  | 34 |  | ~~load\_plugin\_textdomain( 'pj-favicon-generator', PJFAV\_DIR );~~ |
  | 35 |  |  |
  | 36 |  | ~~function pj\_favicon\_admin\_scripts() {~~ |
  | 37 |  | ~~if ( isset($\_GET['page']) && $\_GET['page'] == "Favicon-Generator" )~~ |
  | 38 |  | ~~wp\_enqueue\_style( 'pjfav-admin-css', PJFAV\_URL.'styles/styles.css' );~~ |
  | 39 | 50 | } |
  | 40 |  | add\_action( 'admin\_init', 'pj\_favicon\_admin\_scripts', 1 ); |
  | 41 |  | register\_activation\_hook( \_\_FILE\_\_, array( &$pj\_favicon\_generator, 'activate' ) ); |
  | 42 |  | add\_action( 'admin\_notices', array(&$pj\_favicon\_generator, 'check\_installation') ); |
  | 43 |  |  |
  | 44 |  |  |
  | 45 |  | if (!class\_exists('pj\_favicon\_generator')) { |
  | 46 |  |  |
  | 47 |  | include ('php/Directory.php'); |
  | 48 |  | include ('php/Ico2\_1.php'); |
  | 49 |  | include ('php/Image.php'); |
  | 50 |  |  |
  | 51 |  | class pj\_favicon\_generator  { |
  | 52 |  |  |
  | 53 |  | /\*\* |
  | 54 |  | \* @var string   The name the options are saved under in the database. |
  | 55 |  | \*/ |
  | 56 |  | var $adminOptionsName = "pj\_favicon\_generator\_options"; |
  | 57 |  |  |
  | 58 |  | /\*\* |
  | 59 |  | \* @var array   The options that are saved in the database. |
  | 60 |  | \*/ |
  | 61 |  | var $adminOptions = array(); |
  | 62 |  |  |
  | 63 |  | /\*\* |
  | 64 |  | \* PHP 4 Compatible Constructor |
  | 65 |  | \*/ |
  | 66 |  | function pj\_favicon\_generator(){$this->\_\_construct();} |
  | 67 |  |  |
  | 68 |  | /\*\* |
  | 69 |  | \* PHP 5 Constructor |
  | 70 |  | \*/ |
  | 71 |  | function \_\_construct(){ |
  | 72 |  | $this->adminOptions = $this->getAdminOptions(); |
  | 73 |  | add\_action("admin\_menu", array(&$this,"add\_admin\_pages")); |
  | 74 |  | add\_action('wp\_head', array(&$this,'wp\_head\_intercept')); |
  | 75 |  | } |
  | 76 |  |  |
  | 77 |  | /\*\* |
  | 78 |  | \* Retrieves the options from the database. |
  | 79 |  | \* @return array |
  | 80 |  | \*/ |
  | 81 |  | function getAdminOptions() { |
  | 82 |  | $adminOptions = array( |
  | 83 |  | "favicon" => "<empty>", |
  | 84 |  | "donated" => "no" |
  | 85 |  | ); |
  | 86 |  | $savedOptions = get\_option($this->adminOptionsName); |
  | 87 |  | if (!empty($savedOptions)) { |
  | 88 |  | foreach ($savedOptions as $key => $option) { |
  | 89 |  | $adminOptions[$key] = $option; |
  | 90 |  | } |
  | 91 |  | } |
  | 92 |  | update\_option($this->adminOptionsName, $adminOptions); |
  | 93 |  | return $adminOptions; |
  | 94 |  | } |
  | 95 |  |  |
  | 96 |  | function saveAdminOptions(){ |
  | 97 |  | update\_option($this->adminOptionsName, $this->adminOptions); |
  | 98 |  | } |
  | 99 |  |  |
  | 100 |  | /\*\* |
  | 101 |  | \* Runs on plugin activation |
  | 102 |  | \*/ |
  | 103 |  | function activate () { |
  | 104 |  | $uploaddir = PJFAV\_DIR.'uploads/'; |
  | 105 |  | wp\_mkdir\_p( $uploaddir ); |
  | 106 |  | } |
  | 107 |  | /\*\* |
  | 108 |  | \* Checks to make sure that all |
  | 109 |  | \* required directories are set up properly |
  | 110 |  | \*/ |
  | 111 |  | function check\_installation() { |
  | 112 |  | if ( (stripos($\_SERVER['REQUEST\_URI'],'plugins.php') !== false) || (!empty($\_GET['page']) && $\_GET['page'] == "Favicon-Generator" ) ) : |
  | 113 |  | $dir\_list = ""; |
  | 114 |  | $dir\_list2 = ""; |
  | 115 |  |  |
  | 116 |  | $uploaddir = PJFAV\_DIR.'uploads/'; |
  | 117 |  | wp\_mkdir\_p( $uploaddir ); |
  | 118 |  |  |
  | 119 |  | if (!is\_dir(PJFAV\_DIR)){ |
  | 120 |  | $dir\_list2.= "<li>".PJFAV\_DIR . "</li>"; |
  | 121 |  | } elseif (!is\_writable(PJFAV\_DIR)){ |
  | 122 |  | $dir\_list.= "<li>".PJFAV\_DIR . "</li>"; |
  | 123 |  | } |
  | 124 |  |  |
  | 125 |  | if (!is\_dir($uploaddir)){ |
  | 126 |  | $dir\_list2.= "<li>".$uploaddir . "</li>"; |
  | 127 |  | } elseif (!is\_writable($uploaddir)){ |
  | 128 |  | $dir\_list.= "<li>".$uploaddir . "</li>"; |
  | 129 |  | } |
  | 130 |  |  |
  | 131 |  | if ($dir\_list2 != ""){ |
  | 132 |  | echo "<div id='pj-favicon-install-error-message' class='error'><p><strong>".\_\_('Favicon Generator is not ready yet.', 'pj-favicon-generator')."</strong> ".\_\_('must create the following folders (and must chmod 777):', 'pj-favicon-generator')."</p><ul>"; |
  | 133 |  | echo $dir\_list2; |
  | 134 |  | echo "</ul></div>"; |
  | 135 |  | } |
  | 136 |  | if ($dir\_list != ""){ |
  | 137 |  | echo "<div id='pj-favicon-install-error-message-2' class='error'><p><strong>".\_\_('Favicon Generator is not ready yet.', 'pj-favicon-generator')."</strong> ".\_\_('The following folders must be writable (usually chmod 777 is neccesary):', 'pj-favicon-generator')."</p><ul>"; |
  | 138 |  | echo $dir\_list; |
  | 139 |  | echo "</ul></div>"; |
  | 140 |  | } |
  | 141 |  | endif; |
  | 142 |  | } |
  | 143 |  |  |
  | 144 |  | /\*\* |
  | 145 |  | \* Creates the admin page. |
  | 146 |  | \*/ |
  | 147 |  | function add\_admin\_pages(){ |
  | 148 |  | add\_menu\_page("Favicon Generator", "Favicon Generator", 10, "Favicon-Generator", array(&$this,"output\_sub\_admin\_page\_0"), PJFAV\_URL.'/menu-icon.png'); |
  | 149 |  | } |
  | 150 |  |  |
  | 151 |  | /\*\* |
  | 152 |  | \* Outputs the HTML for the admin sub page. |
  | 153 |  | \*/ |
  | 154 |  | function output\_sub\_admin\_page\_0 () { |
  | 155 |  |  |
  | 156 |  | // PATHS |
  | 157 |  | $uploaddir = PJFAV\_DIR.'uploads/'; |
  | 158 |  | $uploadurl = PJFAV\_URL.'uploads/'; |
  | 159 |  | $submiturl = preg\_replace('/&[du]=[a-z0-9.%()\_-]\*\.(jpg|jpeg|gif|png)/is', '', $\_SERVER['REQUEST\_URI']); |
  | 160 |  |  |
  | 161 |  | $msg = ""; |
  | 162 |  |  |
  | 163 |  | // USER UPLOADED A NEW IMAGE |
  | 164 |  | if (!empty($\_FILES)) { |
  | 165 |  | $userfile = preg\_replace('/\\\\\'/', '', $\_FILES['favicon']['name']); |
  | 166 |  | $file\_size = $\_FILES['favicon']['size']; |
  | 167 |  | $file\_temp = $\_FILES['favicon']['tmp\_name']; |
  | 168 |  | $file\_err = $\_FILES['favicon']['error']; |
  | 169 |  | $file\_name = explode('.', $userfile); |
  | 170 |  | $file\_type = strtolower($file\_name[count($file\_name) - 1]); |
  | 171 |  | $uploadedfile = $uploaddir.$userfile; |
  | 172 |  |  |
  | 173 |  | if(!empty($userfile)) { |
  | 174 |  | $file\_type = strtolower($file\_type); |
  | 175 |  | $files = array('jpeg', 'jpg', 'gif', 'png'); |
  | 176 |  | $key = array\_search($file\_type, $files); |
  | 177 |  |  |
  | 178 |  | if(!$key) { |
  | 179 |  | $msg .= \_\_("ILLEGAL FILE TYPE. Only JPEG, JPG, GIF or PNG files are allowed.", 'pj-favicon-generator')."<br />"; |
  | 180 |  | } |
  | 181 |  |  |
  | 182 |  | // ERROR CHECKING |
  | 183 |  | $error\_count = count($file\_error); |
  | 184 |  | if($error\_count > 0) { |
  | 185 |  | for($i = 0; $i <= $error\_count; ++$i) { |
  | 186 |  | $msg .= $\_FILES['favicon']['error'][$i]."<br />"; |
  | 187 |  | } |
  | 188 |  | } else { |
  | 189 |  | if (is\_file(PJFAV\_DIR.'favicon.ico')) { |
  | 190 |  | if (!unlink(PJFAV\_DIR.'favicon.ico')) { |
  | 191 |  | $msg .= \_\_("There was an error deleting the old favicon.", 'pj-favicon-generator')."<br />"; |
  | 192 |  | } |
  | 193 |  | } |
  | 194 |  |  |
  | 195 |  | if(!move\_uploaded\_file($file\_temp, $uploadedfile)) { |
  | 196 |  | $msg .= \_\_("There was an error when uploading your file.", 'pj-favicon-generator')."<br />"; |
  | 197 |  | } |
  | 198 |  | if (!chmod($uploadedfile, 0777)) { |
  | 199 |  | $msg .= \_\_("There was an error when changing your favicon's permissions.", 'pj-favicon-generator')."<br />"; |
  | 200 |  | } |
  | 201 |  |  |
  | 202 |  | $img =new Image($uploadedfile); |
  | 203 |  | $img->resizeImage(16,16); |
  | 204 |  | $img->saveImage($uploadedfile); |
  | 205 |  |  |
  | 206 |  | switch ($file\_type) { |
  | 207 |  | case "jpeg": |
  | 208 |  | case "jpg": |
  | 209 |  | $im = imagecreatefromjpeg($uploadedfile); |
  | 210 |  | break; |
  | 211 |  | case "gif": |
  | 212 |  | $im = imagecreatefromgif($uploadedfile); |
  | 213 |  | break; |
  | 214 |  | case "png": |
  | 215 |  | $im = imagecreatefrompng($uploadedfile); |
  | 216 |  | imagealphablending($im, true); // setting alpha blending on |
  | 217 |  | imagesavealpha($im, true); // save alphablending setting (important) |
  | 218 |  | break; |
  | 219 |  | } |
  | 220 |  | // ImageICO function provided by JPEXS.com <http://www.jpexs.com/php.html> |
  | 221 |  | ImageIco($im, PJFAV\_DIR.'favicon.ico'); |
  | 222 |  | $this->adminOptions['favicon'] = $userfile; |
  | 223 |  | $this->saveAdminOptions(); |
  | 224 |  | $msg .= \_\_("Your favicon has been updated.", 'pj-favicon-generator'); |
  | 225 |  | } |
  | 226 |  |  |
  | 227 |  | } |
  | 228 |  | } |
  | 229 |  |  |
  | 230 |  | if (!empty($\_POST['donated'])) : |
  | 231 |  |  |
  | 232 |  | $this->adminOptions['donated'] = $\_POST['donated']; |
  | 233 |  | $this->saveAdminOptions(); |
  | 234 |  |  |
  | 235 |  | endif; |
  | 236 |  |  |
  | 237 |  | // USER HAS CHOSEN TO DELETE AN UPLOADED IMAGE |
  | 238 |  | if (!empty($\_GET['d']) && is\_file($uploaddir.$\_GET['d'])) { |
  | 239 |  | if (!unlink ($uploaddir.$\_GET['d'])) { |
  | 240 |  | $msg .= \_\_("There was a problem deleting the selected image.", 'pj-favicon-generator'); |
  | 241 |  | } else { |
  | 242 |  | $msg .= \_\_("The selected image has been deleted.", 'pj-favicon-generator'); |
  | 243 |  | } |
  | 244 |  | } |
  | 245 |  |  |
  | 246 |  | // USER HAS CHOSEN TO CHANGE HIS FAVICON TO A PREVIOUSLY UPLOADED IMAGE |
  | 247 |  | if (!empty($\_GET['u'])) { |
  | 248 |  | $file\_name = explode('.', $\_GET['u']); |
  | 249 |  | $file\_type = $file\_name[count($file\_name) - 1]; |
  | 250 |  | switch ($file\_type) { |
  | 251 |  | case "jpeg": |
  | 252 |  | case "jpg": |
  | 253 |  | $im = imagecreatefromjpeg($uploaddir.$\_GET['u']); |
  | 254 |  | break; |
  | 255 |  | case "gif": |
  | 256 |  | $im = imagecreatefromgif($uploaddir.$\_GET['u']); |
  | 257 |  | break; |
  | 258 |  | case "png": |
  | 259 |  | $im = imagecreatefrompng($uploaddir.$\_GET['u']); |
  | 260 |  | imagealphablending($im, true); // setting alpha blending on |
  | 261 |  | imagesavealpha($im, true); // save alphablending setting (important) |
  | 262 |  | break; |
  | 263 |  | } |
  | 264 |  |  |
  | 265 |  | // ImageICO function provided by JPEXS.com <http://www.jpexs.com/php.html> |
  | 266 |  | ImageIco($im, PJFAV\_DIR.'favicon.ico'); |
  | 267 |  | $this->adminOptions['favicon'] = $\_GET['u']; |
  | 268 |  | $this->saveAdminOptions(); |
  | 269 |  | $msg .= \_\_("Your favicon has been updated.", 'pj-favicon-generator'); |
  | 270 |  | } |
  | 271 |  | ?> |
  | 272 |  | <div class="wrap favicon-generator"> |
  | 273 |  | <div id="favicon-options" class="icon32" style="background: transparent url('<?php echo PJFAV\_URL; ?>large-menu-icon.png') no-repeat;"><br /></div> |
  | 274 |  | <h2>Favicon Generator</h2> |
  | 275 |  |  |
  | 276 |  | <?php |
  | 277 |  | $ads = '<script type="text/javascript">'; |
  | 278 |  | $ads.= 'var psHost = (("https:" == document.location.protocol) ? "https://" : "http://");'; |
  | 279 |  | $ads.= 'document.write(unescape("%3Cscript src=\'" + psHost + "pluginsponsors.com/direct/spsn/display.php?client=pj-favicon-generator&spot=\' type=\'text/javascript\'%3E%3C/script%3E"));'; |
  | 280 |  | $ads.= '</script>'; |
  | 281 |  | if ($this->adminOptions['donated'] == 'no') |
  | 282 |  | echo $ads; |
  | 283 |  | ?> |
  | 284 |  |  |
  | 285 |  | <form method="post" action="<?php echo $submiturl; ?>" enctype="multipart/form-data"> |
  | 286 |  | <?php wp\_nonce\_field('update-options'); ?> |
  | 287 |  |  |
  | 288 |  |  |
  | 289 |  | <h3><?php \_e('Upload a New Image', 'pj-favicon-generator'); ?></h3> |
  | 290 |  | <p><?php \_e('Acceptable file types are JPG, JPEG, GIF and PNG. Note that for this to work, you\'re going to need to have PHP configured with the GD2 library.', 'pj-favicon-generator'); ?></p> |
  | 291 |  |  |
  | 292 |  | <table class="form-table"> |
  | 293 |  | <?php if ($this->adminOptions['donated'] == 'no') : ?> |
  | 294 |  | <tr valign="top"> |
  | 295 |  | <th scope="row"><?php \_e('Donations', 'pj-favicon-generator'); ?></th> |
  | 296 |  | <td> |
  | 297 |  | <input type="radio" name="donated" value="no"<?php echo ($this->adminOptions['donated'] == 'no') ? ' checked="checked"' : '' ?> />  <?php \_e('I haven\'t donated to this plugin yet. <small>(<a href="https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=3441397" target="\_blank">What are you waiting for?</a>)</small>', 'pj-favicon-generator'); ?><br /> |
  | 298 |  | <input type="radio" name="donated" value="yes" /> <?php \_e('I\'ve donated to this plugin because I love it. Turn off the ads.', 'pj-favicon-generator'); ?><br /> |
  | 299 |  | <input type="submit" class="button-primary" name="save-donations" value="Save Changes" /> |
  | 300 |  | </td> |
  | 301 |  | </tr> |
  | 302 |  | <?php endif; ?> |
  | 303 |  | <tr valign="top"> |
  | 304 |  | <th scope="row"><?php \_e('Favicon Source', 'pj-favicon-generator'); ?></th> |
  | 305 |  | <td> |
  | 306 |  | <input type="file" name="favicon" id="favicon" /> |
  | 307 |  | <input type="submit" class="button" name="html-upload" value="Upload" /> |
  | 308 |  | </td> |
  | 309 |  | </tr> |
  | 310 |  | </table> |
  | 311 |  |  |
  | 312 |  | <h3><?php \_e('Select a Previously Uploaded File', 'pj-favicon-generator'); ?></h3> |
  | 313 |  | <p><?php \_e('Since this plugin stores every image you upload, you can upload as many images as you like. You can then come back from time to time and change your favicon. Select from the choices below.', 'pj-favicon-generator'); ?></p> |
  | 314 |  | <p><em><strong><?php \_e('Note:', 'pj-favicon-generator') ?></strong> <?php \_e('Some browsers hang on to old favicon images in their cache. This is an unfortunate side effect of caching. If you make a change to your favicon and don\'t immediately see the change, don\'t start banging your head against the wall. This is not an indication that this plugin is not working. Try <a href="http://en.wikipedia.org/wiki/Bypass\_your\_cache" target="\_blank">emptying your cache</a> and quitting the browser.', 'pj-favicon-generator'); ?></em></p> |
  | 315 |  | <?php |
  | 316 |  | $files = dirList($uploaddir); |
  | 317 |  | for ($i = 0; $i < count($files); $i++) : |
  | 318 |  | $active = ($files[$i] == $this->adminOptions['favicon']) ? true : false; |
  | 319 |  | echo '<div style="float: left; margin-top: 20px; padding: 10px; text-align: center;'.(($active) ? ' background-color: #dddddd' : '').'">'; |
  | 320 |  | echo '  <div class="choice-block" style="position: relative; width: 36px; height: 36px; border: 1px solid '.(($active) ? '#ff6666' : '#cccccc').';">'; |
  | 321 |  | echo '      <img src="'.$uploadurl.$files[$i].'" title="'.$files[$i].'" alt="'.$files[$i].'" class="favicon-choices" style="position: absolute; top: 10px; left: 10px; width: 16px; height: 16px;" />'; |
  | 322 |  | echo '  </div>'; |
  | 323 |  | echo '  <div>'; |
  | 324 |  | echo ($active) ? \_\_('Active', 'pj-favicon-generator').'<br />' : '      <a href="'.$submiturl.'&d='.$files[$i].'">'.\_\_('Delete', 'pj-favicon-generator').'</a><br />'; |
  | 325 |  | echo ($active) ? \_\_('Icon', 'pj-favicon-generator') : '     <a href="'.$submiturl.'&u='.$files[$i].'">'.\_\_('Use', 'pj-favicon-generator').'</a>'; |
  | 326 |  | echo '  </div>'; |
  | 327 |  | echo '</div>'; |
  | 328 |  |  |
  | 329 |  | endfor; |
  | 330 |  | echo '<div class="clear"></div>' |
  | 331 |  | ?> |
  | 332 |  | </form> |
  | 333 |  | </div> |
  | 334 |  | <?php |
  | 335 |  | } |
  | 336 |  |  |
  | 337 |  |  |
  | 338 |  | /\*\* |
  | 339 |  | \* Called by the action wp\_head |
  | 340 |  | \*/ |
  | 341 |  | function wp\_head\_intercept() { |
  | 342 |  | //this is a sample function that includes additional styles within the head of your template. |
  | 343 |  | echo '<link rel="shortcut icon" href="'.PJFAV\_URL.'favicon.ico" />'; |
  | 344 |  | // echo '<link rel="apple-touch-icon" href="'.PJFAV\_URL.'touchicon.png" />'; // coming soon! |
  | 345 |  | echo '<meta name="generator" content="Think-Press Favicon Generator v1.5" />'; |
  | 346 |  | } |
  | 347 |  |  |
  | 348 |  | } |
  | 349 |  | } |
  | 350 |  |  |
  | 351 |  | //instantiate the class |
  | 352 |  | if (class\_exists('pj\_favicon\_generator')) { |
  | 353 |  | $pj\_favicon\_generator = new pj\_favicon\_generator(); |
  | 354 |  | } |
  |  | 51 | add\_action( 'admin\_init', 'pj\_favicon\_generator\_deactivate' ); |
* ## [favicon-generator/trunk/readme.txt](/changeset/3139340/favicon-generator/trunk/readme.txt "Show the changeset 3139340 restricted to favicon-generator/trunk/readme.txt")

  | [r588060](/browser/favicon-generator/trunk/readme.txt?rev=588060#L1 "Show revision 588060 of this file in browser") | [r3139340](/browser/favicon-generator/trunk/readme.txt?rev=3139340#L1 "Show revision 3139340 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === Plugin Name === |
  | 2 |  | Contributors: brandondove, ~~jeffreyzinn~~ |
  |  | 2 | Contributors: brandondove, lordleiter |
  | 3 | 3 | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=3441397 |
  | 4 | 4 | Tags: favicon |
  | 5 |  | Requires at least: ~~2.8~~ |
  | 6 |  | Tested up to: ~~2.9.2~~ |
  | 7 |  | Stable tag: ~~1.5~~ |
  |  | 5 | Requires at least: 4.0 |
  |  | 6 | Tested up to: 6.6.1 |
  |  | 7 | Stable tag: 2.1 |
  | 8 | 8 |  |
  | 9 | 9 | == Description == |
  | 10 | 10 |  |
  | 11 |  | This plugin will allow you to upload an image in the format of a jpeg, gif or png and will convert the image into a <a href="http://en.wikipedia.org/wiki/Favicon" target="\_blank">favicon</a> formatted file. This file will be placed in your WordPress root directory and a link tag will then be added to your html output. |
  | 12 |  |  |
  | 13 |  | == Installation == |
  | 14 |  |  |
  | 15 |  | 1. Upload the `favicon-generator` folder to your `/wp-content/plugins/` directory. |
  | 16 |  | 2. Make sure that the `favicon-generator` folder and the `favicon-generator/uploads` folder have their permissions set to 777. |
  | 17 |  | 3. Activate the plugin through the 'Plugins' menu in WordPress. |
  | 18 |  |  |
  | 19 |  | == Frequently Asked Questions == |
  | 20 |  |  |
  | 21 |  | = What file types do you support? = |
  | 22 |  |  |
  | 23 |  | We support JPEG, GIF and PNG. Note: In order for this plugin to properly generate images, your server must have PHP configured with the GD2 library. |
  | 24 |  |  |
  | 25 |  | = How do I make this work? = |
  | 26 |  |  |
  | 27 |  | 1. Find the Favicon Generator section in WordPress. |
  | 28 |  | 2. Upload an image. Generally speaking this would be your logo or something of that nature. |
  | 29 |  | 3. That's it! Your website now has an awesome favicon. |
  | 30 |  |  |
  | 31 |  | = Why isn't my favicon showing up? = |
  | 32 |  |  |
  | 33 |  | Some browsers hang on to old favicon images in their cache. This is an unfortunate side effect of caching. If you make a change to your favicon and don't immediately see the change, don't start banging your head against the wall. This is not an indication that this plugin is not working. Try <a href="http://en.wikipedia.org/wiki/Bypass\_your\_cache" target="\_blank">emptying your cache</a> and quitting the browser. |
  | 34 |  |  |
  | 35 |  | If that doesn't work, it could also be because your theme doesn't make use of WordPress' wp\_head() function. If this is the case, sadly you'll have to edit your theme. This function is what allows us to automagically insert the favicon code. Most modern themes comply with this WordPress standard, so this really shouldn't be the problem unless you built your own custom theme or are using a really old theme. |
  | 36 |  |  |
  | 37 |  | == Version History == |
  | 38 |  |  |
  | 39 |  | = Version 1.1 = |
  | 40 |  |  |
  | 41 |  | 1. Added PHP 4 Compatibility |
  | 42 |  | 2. Updated the ImageIco library from <http://www.jpexs.com/php.html> |
  | 43 |  | 3. Cannot delete active favicon |
  | 44 |  | 4. Added highlight to active favicon |
  | 45 |  |  |
  | 46 |  | = Version 1.2 = |
  | 47 |  |  |
  | 48 |  | 1. Forgot to add the new ImageIco library via SVN. This version has it. Sorry about the mixup. |
  | 49 |  |  |
  | 50 |  | = Version 1.3 = |
  | 51 |  |  |
  | 52 |  | 1. AAAARGH! Include error was happening because I forgot about case sensitivity in Linux filesystems. Sorry, I'm on a mac. |
  | 53 |  |  |
  | 54 |  | = Version 1.4 = |
  | 55 |  |  |
  | 56 |  | 1. Supressed errors that appeared if the upload directory wasn't created. Added in creation of the upload directory to the init routines. |
  | 57 |  |  |
  | 58 |  | = Version 1.5 = |
  | 59 |  |  |
  | 60 |  | 1. Added support for ads from pluginsponsors.com to be placed on the admin page. A guy's gotta earn a living, right? |
  | 61 |  | 2. Tested functionality against WordPress version 2.9.2 |
  | 62 |  | 3. Increased the minimum WordPress version to 2.8 because, come on...who's still running WordPress 2.1? |
  | 63 |  | 4. Added checks to make sure certain necessary directories and permissions were set properly. |
  | 64 |  | 5. Suppressed ugly warnings that were displayed when the upload directories weren't set properly. |
  | 65 |  | 6. Added support for l10n. |
  | 66 |  |  |
  | 67 |  | == Screenshots == |
  | 68 |  |  |
  | 69 |  | 1. Favicon Generator configuration screen |
  | 70 |  | 2. Shows the favicon in place |
  |  | 11 | This plugin's functionality has been included in WordPress core for many years. It is no longer necessary to use this plugin. As such, this plugin can no longer be activated. |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3139340)
* [Zip Archive](?format=zip&new=3139340)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_9a62e949_20250110_123110.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Favicon Generator <= 1.5 - Cross-Site Request Forgery to Arbitrary File Deletion

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Favicon Generator <= 1.5 - Cross-Site Request Forgery to Arbitrary File Deletion

9.6

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H)

| CVE | [CVE-2024-7568](https://www.cve.org/CVERecord?id=CVE-2024-7568) |
| --- | --- |
| CVSS | 9.6 (Critical) |
| Publicly Published | August 23, 2024 |
| Last Updated | August 27, 2024 |
| Researcher | [Marco Wotschka - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/marco-wotschka) |

### Description

The Favicon Generator plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.5. This is due to missing or incorrect nonce validation on the output\_sub\_admin\_page\_0 function. This makes it possible for unauthenticated attackers to delete arbitrary files on the server via a forged request granted they can trick a site administrator into performing an action such as clicking on a link. The plugin author deleted the functionality of the plugin to patch this issue and close the plugin, we recommend seeking an alternative to this plugin. CVE-2024-7864 appears to be a duplicate of this issue.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3139340%40favicon-generator&new=3139340%40favicon-generator&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffavicon-generator%2Ffavicon-generator-15-cross-site-request-forgery-to-arbitrary-file-deletion&t=Favicon%20Generator%20%3C%3D%201.5%20-%20Cross-Site%20Request%20Forgery%20to%20Arbitrary%20File%20Deletion "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffavicon-generator%2Ffavicon-generator-15-cross-site-request-forgery-to-arbitrary-file-deletion&text=Favicon%20Generator%20%3C%3D%201.5%20-%20Cross-Site%20Request%20Forgery%20to%20Arbitrary%20File%20Deletion "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffavicon-generator%2Ffavicon-generator-15-cross-site-request-forgery-to-arbitrary-file-deletion "LinkedIn")
Email

## Vulnerability Details for Favicon Generator (CLOSED)

#### [Favicon Generator (CLOSED)](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/favicon-generator)

| Software Type | Plugin |
| --- | --- |
| Software Slug | favicon-generator [(view on wordpress.org)](https://wordpress.org/plugins/favicon-generator) |
| Patched? | Yes |
| Remediation | Update to version 2.1, or a newer patched version |
| Affected Version | * <= 1.5 |
| Patched Version | * 2.1 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


