- **Root cause of vulnerability**: A change in commit 3f29cc82a84c, which split the validity of the state ID into `sc_status`, resulted in the `sc_type` field not being set to 0 when a state ID was unhashed. Consequently, the `nfs4_show_open()` function would attempt to dereference `sc_file` (which was NULL for closed files), causing a kernel oops.

- **Weaknesses/vulnerabilities present**: The primary weakness is the incorrect handling of closed file state IDs in the `nfs4_show_open()` function. It attempts to access file-related information even when the file has been closed, leading to a null pointer dereference.

- **Impact of exploitation**: The exploitation leads to a kernel panic/oops, causing a denial of service.

- **Attack vectors**: The vulnerability is triggered by reading the `/proc/fs/nfsd/clients/<client_id>/states` file on the NFS server after a client mounts using NFSv4.0, reads, and then closes a file.

- **Required attacker capabilities/position**: The attacker needs to have access to the NFS server's local filesystem to read the state file, and a client using NFSv4.0 to trigger the scenario that results in the closed file state.