





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>HTML injection in Global Search, can lead to XSS with CSP bypass in MR diff view (#481819) · Issues · GitLab.org / GitLab · GitLab</title>
<script nonce="3LSBZ+BFAm2bESPkiZ5B3g==">
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.com/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.analytics_url="https://collector.prd-278964.gl-product-analytics.com";gon.analytics_id="715db59f-f350-4bfd-aef8-e7a7f0c023f0";gon.sentry_dsn="https://f5573e26de8f4293b285e556c35dfd6e@new-sentry.gitlab.net/4";gon.sentry_environment="gprd";gon.sentry_clientside_traces_sample_rate=0.05;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LfAERQTAAAAAL4GYSiAMGLbcLyUIBSfPrDNJgeC";gon.gitlab_url="https://gitlab.com";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="16eb3cf9b58";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-bd26211944b9d072037ec97cb138f1a52cd03ef185cd38b8d1fcc963245199a1.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=true;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"duoChatDynamicDimension":false,"advancedContextResolver":true,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":true,"workItemsBeta":true,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"okrsMvc":false,"workItemEpics":true};gon.roadmap_epics_limit=1000;gon.subscriptions_url="https://customers.gitlab.com";gon.subscriptions_legacy_sign_in_url="https://customers.gitlab.com/customers/sign_in?legacy=true";gon.billing_accounts_url="https://customers.gitlab.com/billing_accounts";gon.payment_form_url="https://customers.gitlab.com/payment_forms/cc_validation";gon.payment_validation_form_id="payment_method_validation";gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="3LSBZ+BFAm2bESPkiZ5B3g==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/gitlab-org/gitlab/-/issues/481819/related_branches":{},"/gitlab-org/gitlab/-/issues/481819/discussions.json?per_page=20":{},"/gitlab-org/gitlab/-/issues/481819.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"481819","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"481819"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"zRc9tYOEesgC3kEI92175mSwM1JzuUSzMN3usneZSNoPTGRZwx00OjwB6NP8w1M9YAi1S6wUxYxHfrPr1MIpOw","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" />
<link rel="stylesheet" href="/assets/tailwind-6c5813e8879a33c27249cb9a52f31d2bbf48601dc2f8913e018566151f1a9c2f.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.41c18450.bundle.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/main.711a3a6f.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/tracker.37d73316.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/analytics.c1bb2d5a.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script nonce="3LSBZ+BFAm2bESPkiZ5B3g==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JHBH06VF0ZFAM0DQ45N3BS2K","plan":"gold","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":9970,"project_id":278964,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-cny-webservice-web-76b9f579f6-rrpfm","instance_version":"17.8.0","context_generated_at":"2025-01-11T20:31:01.210Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace9970/project278964/-/issues/481819";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" as="style" type="text/css" nonce="+0ycAjUj4rJ8XkQvxtn6nQ==">
<link rel="preload" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" as="style" type="text/css" nonce="+0ycAjUj4rJ8XkQvxtn6nQ==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="+0ycAjUj4rJ8XkQvxtn6nQ==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="+0ycAjUj4rJ8XkQvxtn6nQ==">



<script src="/assets/webpack/sentry.9e3f0408.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>

<script src="/assets/webpack/10.983bd1ac.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/13.4882db81.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/14.3d336eee.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ec7189d6.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.ddad2718.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.62f44622.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/super_sidebar.b6b24a2c.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-68d77824.0b1a923a.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>
<script src="/assets/webpack/pages.projects.issues.show.99433ee7.chunk.js" defer="defer" nonce="3LSBZ+BFAm2bESPkiZ5B3g=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="HTML injection in Global Search, can lead to XSS with CSP bypass in MR diff view (#481819) · Issues · GitLab.org / GitLab · GitLab" property="og:title">
<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/gitlab-org/gitlab/-/issues/481819" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="HTML injection in Global Search, can lead to XSS with CSP bypass in MR diff view (#481819) · Issues · GitLab.org / GitLab · GitLab" property="twitter:title">
<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab SecurityBot"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Tomas Bulva">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="G9cWMBwhDCamNznCKKjBY6iZHu8CHEDOypqJskxQP_HZjE_cXLhC1JjokBkjBum4rCGY9t2xwfG9OdTr7wteEA" />
<meta name="csp-nonce" content="3LSBZ+BFAm2bESPkiZ5B3g==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" id="favicon" data-original-href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="gitlab-org" data-group-full-path="gitlab-org" data-namespace-id="9970" data-page="projects:issues:show" data-page-type-id="481819" data-project="gitlab" data-project-full-path="gitlab-org/gitlab" data-project-id="278964">
<script nonce="3LSBZ+BFAm2bESPkiZ5B3g==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/gitlab-org/gitlab/-/autocomplete_sources/epics","iterations":"/gitlab-org/gitlab/-/autocomplete_sources/iterations","vulnerabilities":"/gitlab-org/gitlab/-/autocomplete_sources/vulnerabilities","members":"/gitlab-org/gitlab/-/autocomplete_sources/members?type=Issue\u0026type_id=481819","issues":"/gitlab-org/gitlab/-/autocomplete_sources/issues","mergeRequests":"/gitlab-org/gitlab/-/autocomplete_sources/merge_requests","labels":"/gitlab-org/gitlab/-/autocomplete_sources/labels?type=Issue\u0026type_id=481819","milestones":"/gitlab-org/gitlab/-/autocomplete_sources/milestones","commands":"/gitlab-org/gitlab/-/autocomplete_sources/commands?type=Issue\u0026type_id=481819","snippets":"/gitlab-org/gitlab/-/autocomplete_sources/snippets","contacts":"/gitlab-org/gitlab/-/autocomplete_sources/contacts?type=Issue\u0026type_id=481819","wikis":null};


//]]>
</script>
<script nonce="3LSBZ+BFAm2bESPkiZ5B3g==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a><a class="gl-badge badge badge-pill badge-success canary-badge" data-testid="canary_badge_link" href="https://next.gitlab.com" rel="noopener noreferrer" target="_blank"><span class="gl-badge-content">Next
</span></a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/gitlab-org/gitlab/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/gitlab-org/gitlab/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;GitLab&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;,&quot;entity_id&quot;:278964,&quot;link&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;packages_registry&quot;,&quot;title&quot;:&quot;Package Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/packages&quot;,&quot;link_classes&quot;:&quot;shortcuts-container-registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;infrastructure_registry&quot;,&quot;title&quot;:&quot;Terraform modules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/terraform_module_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:9970,&quot;name&quot;:&quot;GitLab.org&quot;,&quot;full_name&quot;:&quot;GitLab.org&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/gitlab-org/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/gitlab-org/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:278964,&quot;name&quot;:&quot;GitLab&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GitLab.org","item":"https://gitlab.com/gitlab-org"},{"@type":"ListItem","position":2,"name":"GitLab","item":"https://gitlab.com/gitlab-org/gitlab"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/gitlab-org/gitlab/-/issues"},{"@type":"ListItem","position":4,"name":"#481819","item":"https://gitlab.com/gitlab-org/gitlab/-/issues/481819"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GitLab.org&quot;,&quot;href&quot;:&quot;/gitlab-org&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/9970/project_avatar.png&quot;},{&quot;text&quot;:&quot;GitLab&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#481819&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues/481819&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/481819&quot;,&quot;new_issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/new?add_related_issue=481819&quot;,&quot;project_path&quot;:&quot;gitlab-org/gitlab&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2741139,&quot;reported_from_url&quot;:&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/481819&quot;,&quot;submit_as_spam_path&quot;:&quot;/gitlab-org/gitlab/-/issues/481819/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/481819&quot;,&quot;updateEndpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/481819.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#481819&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=481819\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:0,&quot;issuableTemplateNamesPath&quot;:&quot;/gitlab-org/gitlab/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;HTML injection in Global Search, can lead to XSS with CSP bypass in MR diff view&quot;,&quot;initialTitleText&quot;:&quot;HTML injection in Global Search, can lead to XSS with CSP bypass in MR diff view&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:247\&quot; dir=\&quot;auto\&quot;\u003e\u003cgl-emoji title=\&quot;warning sign\&quot; data-name=\&quot;warning\&quot; data-unicode-version=\&quot;4.0\&quot;\u003e⚠\u003c/gl-emoji\u003e \u003cstrong data-sourcepos=\&quot;1:11-1:247\&quot;\u003ePlease read \u003ca data-sourcepos=\&quot;1:25-1:125\&quot; href=\&quot;https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md\&quot;\u003ethe process\u003c/a\u003e on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:123\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;3:1-3:70\&quot;\u003e\u003ca data-sourcepos=\&quot;3:3-3:68\&quot; href=\&quot;https://hackerone.com/reports/2659386\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHackerOne report #2659386\u003c/a\u003e\u003c/strong\u003e by \u003ccode data-sourcepos=\&quot;3:76-3:82\&quot;\u003ejoaxcar\u003c/code\u003e on 2024-08-14, assigned to \u003ca href=\&quot;/kmorrison1\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;10425157\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Kevin Morrison\&quot;\u003e@kmorrison1\u003c/a\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:1-5:87\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;5:1-5:17\&quot; href=\&quot;#report\&quot;\u003eReport\u003c/a\u003e | \u003ca data-sourcepos=\&quot;5:21-5:47\&quot; href=\&quot;#attachments\&quot;\u003eAttachments\u003c/a\u003e | \u003ca data-sourcepos=\&quot;5:51-5:87\&quot; href=\&quot;#how-to-reproduce\&quot;\u003eHow To Reproduce\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;7:1-7:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#report\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-report\&quot;\u003e\u003c/a\u003eReport\u003c/h2\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;9:1-9:15\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-summary\&quot;\u003e\u003c/a\u003eSummary\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;10:1-10:79\&quot; dir=\&quot;auto\&quot;\u003eAn HTML injection exists in the \&quot;global search\&quot; popup when searching for files.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;12:1-12:117\&quot; dir=\&quot;auto\&quot;\u003eThis is the sink in \u003ccode data-sourcepos=\&quot;12:22-12:114\&quot;\u003eapp/assets/javascripts/super_sidebar/components/global_search/command_palette/search_item.vue\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;13:1-21:3\&quot; data-canonical-lang=\&quot;js\&quot; class=\&quot;code highlight js-syntax-highlight language-javascript\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e \u003cspan class=\&quot;nf\&quot;\u003ehighlightedName\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e()\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e      \u003cspan class=\&quot;k\&quot;\u003ereturn\u003c/span\u003e \u003cspan class=\&quot;nf\&quot;\u003ehighlight\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eitem\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003etext\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003esearchQuery\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;p\&quot;\u003e},\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e...\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003espan\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003ev\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003esafe\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003ehtml\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003ehighlightedName\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e \u003cspan class=\&quot;kd\&quot;\u003eclass\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003egl-text-gray-900\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\&quot;sr\&quot;\u003e/span\u0026gt; \u003c/span\u003e\u003cspan class=\&quot;err\&quot;\u003e \u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;23:1-23:122\&quot; dir=\&quot;auto\&quot;\u003ethe \u003ccode data-sourcepos=\&quot;23:6-23:14\&quot;\u003eitem.text\u003c/code\u003e is generated in \u003ccode data-sourcepos=\&quot;23:34-23:119\&quot;\u003eapp/assets/javascripts/super_sidebar/components/global_search/command_palette/utils.js\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;24:1-36:3\&quot; data-canonical-lang=\&quot;js\&quot; class=\&quot;code highlight js-syntax-highlight language-javascript\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003eexport\u003c/span\u003e \u003cspan class=\&quot;kd\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003efileMapper\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eprojectBlobPath\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003efile\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e  \u003cspan class=\&quot;k\&quot;\u003ereturn\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;na\&quot;\u003eicon\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e \u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;s1\&quot;\u003edoc-code\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;na\&quot;\u003etext\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003efile\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;na\&quot;\u003ehref\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e \u003cspan class=\&quot;nf\&quot;\u003ejoinPaths\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eprojectBlobPath\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003efile\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e),\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;na\&quot;\u003eextraAttrs\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e      \u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;s1\&quot;\u003edata-track-action\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003eTRACKING_CLICK_COMMAND_PALETTE_ITEM\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e      \u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;s1\&quot;\u003edata-track-label\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e \u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;s1\&quot;\u003efile\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;p\&quot;\u003e},\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e  \u003cspan class=\&quot;p\&quot;\u003e};\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e};\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;38:1-38:147\&quot; dir=\&quot;auto\&quot;\u003ethe data sent into here comes from here \u003ccode data-sourcepos=\&quot;38:42-38:144\&quot;\u003eapp/assets/javascripts/super_sidebar/components/global_search/command_palette/command_palette_items.vue\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;39:1-42:3\&quot; data-canonical-lang=\&quot;js\&quot; class=\&quot;code highlight js-syntax-highlight language-javascript\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;kd\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003eresponse\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003eawait\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003eaxios\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003eget\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eprojectFilesPath\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e          \u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eprojectFiles\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003eresponse\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e?.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003edata\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003emap\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003efileMapper\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ebind\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;kc\&quot;\u003enull\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eprojectBlobPath\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e));\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;44:1-44:93\&quot; dir=\&quot;auto\&quot;\u003eThis means that filenames are sent directly into \u003ccode data-sourcepos=\&quot;44:51-44:61\&quot;\u003ev-safe-html\u003c/code\u003e and filenames can contain HTML\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;46:1-46:109\&quot; dir=\&quot;auto\&quot;\u003eOne place in the app where this can lead to XSS in \u003ccode data-sourcepos=\&quot;46:53-46:80\&quot;\u003enew merge request diff pages\u003c/code\u003e bypassing CSP on gitlab.com\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;48:1-48:24\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-steps-to-reproduce\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h4\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;50:1-50:126\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;50:1-50:126\&quot;\u003eGo to \u003ca href=\&quot;https://gitlab.com/-/snippets/new\&quot;\u003ehttps://gitlab.com/-/snippets/new\u003c/a\u003e and create a new \u003ccode data-sourcepos=\&quot;50:62-50:67\&quot;\u003epublic\u003c/code\u003e snippet with a file called \u003ccode data-sourcepos=\&quot;50:98-50:107\&quot;\u003ealert.json\u003c/code\u003e and the content\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;51:1-53:5\&quot; data-canonical-lang=\&quot;json\&quot; class=\&quot;code highlight js-syntax-highlight language-json\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;json\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003cspan class=\&quot;nl\&quot;\u003e\&quot;html\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e\&quot;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e\u003cspan class=\&quot;w\&quot;\u003e  \u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;54:1-56:89\&quot; dir=\&quot;auto\&quot;\u003etake note of the snippet ID\u003cbr data-sourcepos=\&quot;54:30-54:30\&quot;\u003e\u0026#x000A;2. Create a new project\u003cbr data-sourcepos=\&quot;55:26-55:26\&quot;\u003e\u0026#x000A;3. In the project create a file with this name (replace \u003ccode data-sourcepos=\&quot;56:58-56:64\&quot;\u003e3737908\u003c/code\u003e with your snippet ID)\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;57:1-59:5\&quot; data-canonical-lang=\&quot;html\&quot; class=\&quot;code highlight js-syntax-highlight language-html\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;html\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026lt;i\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003eclass=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003einline-parallel-buttons\u003c/span\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026gt;\u0026lt;a\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003ehref=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\\-\\snippets\\3737908\\raw\\main\\alert\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003estyle=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;position:fixed;transform:translate3d(-2000px,-5000px,0px);width:10000px;height:20000px\&quot;\u003c/span\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026gt;\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u003cinsert-code-snippet\u003e\u003c/insert-code-snippet\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;60:1-64:0\&quot; start=\&quot;4\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;60:1-60:220\&quot;\u003eGo to \u003ccode data-sourcepos=\&quot;60:11-60:61\&quot;\u003ehttps://gitlab.com/GROUPNAME/PROJECTNAME/-/new/main\u003c/code\u003e and create a new file, fill out whatever but make sure to change the \u003ccode data-sourcepos=\&quot;60:134-60:146\&quot;\u003etarget branch\u003c/code\u003e from \u003ccode data-sourcepos=\&quot;60:155-60:158\&quot;\u003emain\u003c/code\u003e to \u003ccode data-sourcepos=\&quot;60:165-60:174\&quot;\u003enew_branch\u003c/code\u003e. Keep \&quot;start a new merge request\&quot; checked.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;61:1-61:27\&quot;\u003eClick \u003ccode data-sourcepos=\&quot;61:11-61:24\&quot;\u003ecommit changes\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;62:1-62:260\&quot;\u003eGo to \u003ccode data-sourcepos=\&quot;62:11-62:159\&quot;\u003ehttps://gitlab.com/GROUPNAME/PROJECTNAME/-/merge_requests/new/diffs?merge_request%5Bsource_branch%5D=new_branch\u0026amp;merge_request%5Btarget_branch%5D=main\u003c/code\u003e (note that the \u003ccode data-sourcepos=\&quot;62:178-62:204\&quot;\u003esource_branch%5D=new_branch\u003c/code\u003e if you did not name your branch like this in step 4)\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;63:1-64:0\&quot;\u003eClick \u003ccode data-sourcepos=\&quot;63:11-63:27\&quot;\u003eSearch or go to..\u003c/code\u003e in the upper left corner (or click \u003ccode data-sourcepos=\&quot;63:66-63:66\&quot;\u003e/\u003c/code\u003e or \u003ccode data-sourcepos=\&quot;63:73-63:73\&quot;\u003es\u003c/code\u003e which are shortcuts)\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;65:1-65:144\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/7f4b0c4c525a13704a4d462888c2cc4425a3c48f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62343663363633612d623665322d343561652d626561312d6261626363346365386561372f53637265656e73686f745f323032342d30382d31345f61745f32332e34302e34362e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;65:1-65:144\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;Screenshot_2024-08-14_at_23.40.46.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/7f4b0c4c525a13704a4d462888c2cc4425a3c48f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62343663363633612d623665322d343561652d626561312d6261626363346365386561372f53637265656e73686f745f323032342d30382d31345f61745f32332e34302e34362e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;67:1-70:0\&quot; start=\&quot;8\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;67:1-67:31\&quot;\u003eIn the search box type \u003ccode data-sourcepos=\&quot;67:28-67:28\&quot;\u003e~\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;68:1-68:116\&quot;\u003eThere should now be some result in the search list, but it will be the HTML that is now covering the whole page\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;69:1-70:0\&quot;\u003eClick anywhere on the page, and an alert box should pop\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;71:1-71:144\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/77f0a5fcb34fdcb9490b5e08015f5d0c0e41e15e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61333065323532622d303664362d346633642d386162652d3961303734383861663233652f53637265656e73686f745f323032342d30382d31345f61745f32332e34322e35302e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;71:1-71:144\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;Screenshot_2024-08-14_at_23.42.50.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/77f0a5fcb34fdcb9490b5e08015f5d0c0e41e15e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61333065323532622d303664362d346633642d386162652d3961303734383861663233652f53637265656e73686f745f323032342d30382d31345f61745f32332e34322e35302e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;73:1-73:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-impact\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;75:1-75:33\&quot; dir=\&quot;auto\&quot;\u003eXSS with CSP bypass on gitlab.com\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;77:1-77:41\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#what-is-the-current-bug-behavior\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-what-is-the-current-bug-behavior\&quot;\u003e\u003c/a\u003eWhat is the current \u003cem data-sourcepos=\&quot;77:27-77:31\&quot;\u003ebug\u003c/em\u003e behavior?\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;79:1-79:44\&quot; dir=\&quot;auto\&quot;\u003eFilenames are not escaped in global search\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;80:1-80:46\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#what-is-the-expected-correct-behavior\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-what-is-the-expected-correct-behavior\&quot;\u003e\u003c/a\u003eWhat is the expected \u003cem data-sourcepos=\&quot;80:28-80:36\&quot;\u003ecorrect\u003c/em\u003e behavior?\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;82:1-82:37\&quot; dir=\&quot;auto\&quot;\u003eFilenames should not render as HTML\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;83:1-83:22\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#output-of-checks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-output-of-checks\&quot;\u003e\u003c/a\u003eOutput of checks\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;85:1-85:30\&quot; dir=\&quot;auto\&quot;\u003eThis bug happens on GitLab.com\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;87:1-87:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#impact-1\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-impact-1\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;89:1-89:33\&quot; dir=\&quot;auto\&quot;\u003eXSS with CSP bypass on gitlab.com\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;91:1-91:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#attachments\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-attachments\&quot;\u003e\u003c/a\u003eAttachments\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;93:1-93:77\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;93:1-93:12\&quot;\u003eWarning:\u003c/strong\u003e Attachments received through HackerOne, please exercise caution!\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;95:1-97:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;95:1-95:145\&quot;\u003e\u003ca data-sourcepos=\&quot;95:3-95:145\&quot; href=\&quot;https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eScreenshot_2024-08-14_at_23.42.50.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;96:1-97:0\&quot;\u003e\u003ca data-sourcepos=\&quot;96:3-96:145\&quot; href=\&quot;https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eScreenshot_2024-08-14_at_23.40.46.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;98:1-98:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;#how-to-reproduce\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;anchor\&quot; id=\&quot;user-content-how-to-reproduce\&quot;\u003e\u003c/a\u003eHow To Reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;100:1-100:57\&quot; dir=\&quot;auto\&quot;\u003ePlease add \u003ca data-sourcepos=\&quot;100:12-100:40\&quot; href=\&quot;https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ereproducibility information\u003c/a\u003e to this section:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;102:1-105:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;102:1-102:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;103:1-103:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;104:1-104:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;:warning: **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**\n\n**[HackerOne report #2659386](https://hackerone.com/reports/2659386)** by `joaxcar` on 2024-08-14, assigned to @kmorrison1:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n####  Summary  \nAn HTML injection exists in the \&quot;global search\&quot; popup when searching for files.\n\nThis is the sink in `app/assets/javascripts/super_sidebar/components/global_search/command_palette/search_item.vue`  \n```js  \n highlightedName() {  \n      return highlight(this.item.text, this.searchQuery);  \n    },\n\n...\n\n\u003cspan v-safe-html=\&quot;highlightedName\&quot; class=\&quot;gl-text-gray-900\&quot;\u003e\u003c/span\u003e  \n```\n\nthe `item.text` is generated in `app/assets/javascripts/super_sidebar/components/global_search/command_palette/utils.js`  \n```js  \nexport const fileMapper = (projectBlobPath, file) =\u003e {  \n  return {  \n    icon: &#39;doc-code&#39;,  \n    text: file,  \n    href: joinPaths(projectBlobPath, file),  \n    extraAttrs: {  \n      &#39;data-track-action&#39;: TRACKING_CLICK_COMMAND_PALETTE_ITEM,  \n      &#39;data-track-label&#39;: &#39;file&#39;,  \n    },  \n  };  \n};  \n```\n\nthe data sent into here comes from here `app/assets/javascripts/super_sidebar/components/global_search/command_palette/command_palette_items.vue`  \n```js  \nconst response = await axios.get(this.projectFilesPath);  \n          this.projectFiles = response?.data.map(fileMapper.bind(null, this.projectBlobPath));  \n```\n\nThis means that filenames are sent directly into `v-safe-html` and filenames can contain HTML\n\nOne place in the app where this can lead to XSS in `new merge request diff pages` bypassing CSP on gitlab.com\n\n####  Steps to reproduce\n\n1. Go to https://gitlab.com/-/snippets/new and create a new `public` snippet with a file called `alert.json` and the content  \n```json  \n{\&quot;html\&quot;:\&quot;\u003cscript\u003ealert(document.domain)\u003c/script\u003e\&quot;}  \n```  \ntake note of the snippet ID  \n2. Create a new project  \n3. In the project create a file with this name (replace `3737908` with your snippet ID)  \n```html  \n\u003ci class=inline-parallel-buttons\u003e\u003ca href=\\-\\snippets\\3737908\\raw\\main\\alert style=\&quot;position:fixed;transform:translate3d(-2000px,-5000px,0px);width:10000px;height:20000px\&quot;\u003e  \n```  \n4. Go to `https://gitlab.com/GROUPNAME/PROJECTNAME/-/new/main` and create a new file, fill out whatever but make sure to change the `target branch` from `main` to `new_branch`. Keep \&quot;start a new merge request\&quot; checked.  \n5. Click `commit changes`  \n6. Go to `https://gitlab.com/GROUPNAME/PROJECTNAME/-/merge_requests/new/diffs?merge_request%5Bsource_branch%5D=new_branch\u0026merge_request%5Btarget_branch%5D=main` (note that the `source_branch%5D=new_branch` if you did not name your branch like this in step 4)  \n7. Click `Search or go to..` in the upper left corner (or click `/` or `s` which are shortcuts)\n\n![Screenshot_2024-08-14_at_23.40.46.png](https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png)\n\n8. In the search box type `~`  \n9. There should now be some result in the search list, but it will be the HTML that is now covering the whole page  \n10. Click anywhere on the page, and an alert box should pop\n\n![Screenshot_2024-08-14_at_23.42.50.png](https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png)\n\n####  Impact\n\nXSS with CSP bypass on gitlab.com\n\n####  What is the current *bug* behavior?\n\nFilenames are not escaped in global search  \n####  What is the expected *correct* behavior?\n\nFilenames should not render as HTML  \n####  Output of checks\n\nThis bug happens on GitLab.com\n\n####  Impact\n\nXSS with CSP bypass on gitlab.com\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [Screenshot_2024-08-14_at_23.42.50.png](https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png)\n* [Screenshot_2024-08-14_at_23.40.46.png](https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;gitlab-org/gitlab&quot;,&quot;iid&quot;:481819,&quot;issuableId&quot;:152263438,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2741139,&quot;authorName&quot;:&quot;GitLab SecurityBot&quot;,&quot;authorUsername&quot;:&quot;gitlab-securitybot&quot;,&quot;authorWebUrl&quot;:&quot;/gitlab-securitybot&quot;,&quot;createdAt&quot;:&quot;2024-08-29T14:39:54+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:278964,&quot;projectPath&quot;:&quot;gitlab&quot;,&quot;projectNamespace&quot;:&quot;gitlab-org&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">HTML injection in Global Search, can lead to XSS with CSP bypass in MR diff view</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:247" dir="auto"><gl-emoji title="warning sign" data-name="warning" data-unicode-version="4.0">⚠</gl-emoji> <strong data-sourcepos="1:11-1:247">Please read <a data-sourcepos="1:25-1:125" href="https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md">the process</a> on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.</strong></p>&#x000A;<p data-sourcepos="3:1-3:123" dir="auto"><strong data-sourcepos="3:1-3:70"><a data-sourcepos="3:3-3:68" href="https://hackerone.com/reports/2659386" rel="nofollow noreferrer noopener" target="_blank">HackerOne report #2659386</a></strong> by <code data-sourcepos="3:76-3:82">joaxcar</code> on 2024-08-14, assigned to <a href="/kmorrison1" data-reference-type="user" data-user="10425157" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Kevin Morrison">@kmorrison1</a>:</p>&#x000A;<p data-sourcepos="5:1-5:87" dir="auto"><a data-sourcepos="5:1-5:17" href="#report">Report</a> | <a data-sourcepos="5:21-5:47" href="#attachments">Attachments</a> | <a data-sourcepos="5:51-5:87" href="#how-to-reproduce">How To Reproduce</a></p>&#x000A;<h2 data-sourcepos="7:1-7:9" dir="auto">&#x000A;<a href="#report" aria-hidden="true" class="anchor" id="user-content-report"></a>Report</h2>&#x000A;<h4 data-sourcepos="9:1-9:15" dir="auto">&#x000A;<a href="#summary" aria-hidden="true" class="anchor" id="user-content-summary"></a>Summary</h4>&#x000A;<p data-sourcepos="10:1-10:79" dir="auto">An HTML injection exists in the "global search" popup when searching for files.</p>&#x000A;<p data-sourcepos="12:1-12:117" dir="auto">This is the sink in <code data-sourcepos="12:22-12:114">app/assets/javascripts/super_sidebar/components/global_search/command_palette/search_item.vue</code></p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="13:1-21:3" data-canonical-lang="js" class="code highlight js-syntax-highlight language-javascript" v-pre="true"><code><span id="LC1" class="line" lang="javascript"> <span class="nf">highlightedName</span><span class="p">()</span> <span class="p">{</span>  </span>&#x000A;<span id="LC2" class="line" lang="javascript">      <span class="k">return</span> <span class="nf">highlight</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">item</span><span class="p">.</span><span class="nx">text</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">searchQuery</span><span class="p">);</span>  </span>&#x000A;<span id="LC3" class="line" lang="javascript">    <span class="p">},</span></span>&#x000A;<span id="LC4" class="line" lang="javascript"></span>&#x000A;<span id="LC5" class="line" lang="javascript"><span class="p">...</span></span>&#x000A;<span id="LC6" class="line" lang="javascript"></span>&#x000A;<span id="LC7" class="line" lang="javascript"><span class="o">&lt;</span><span class="nx">span</span> <span class="nx">v</span><span class="o">-</span><span class="nx">safe</span><span class="o">-</span><span class="nx">html</span><span class="o">=</span><span class="dl">"</span><span class="s2">highlightedName</span><span class="dl">"</span> <span class="kd">class</span><span class="o">=</span><span class="dl">"</span><span class="s2">gl-text-gray-900</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/span&gt; </span><span class="err"> </span></span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="23:1-23:122" dir="auto">the <code data-sourcepos="23:6-23:14">item.text</code> is generated in <code data-sourcepos="23:34-23:119">app/assets/javascripts/super_sidebar/components/global_search/command_palette/utils.js</code></p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="24:1-36:3" data-canonical-lang="js" class="code highlight js-syntax-highlight language-javascript" v-pre="true"><code><span id="LC1" class="line" lang="javascript"><span class="k">export</span> <span class="kd">const</span> <span class="nx">fileMapper</span> <span class="o">=</span> <span class="p">(</span><span class="nx">projectBlobPath</span><span class="p">,</span> <span class="nx">file</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>  </span>&#x000A;<span id="LC2" class="line" lang="javascript">  <span class="k">return</span> <span class="p">{</span>  </span>&#x000A;<span id="LC3" class="line" lang="javascript">    <span class="na">icon</span><span class="p">:</span> <span class="dl">'</span><span class="s1">doc-code</span><span class="dl">'</span><span class="p">,</span>  </span>&#x000A;<span id="LC4" class="line" lang="javascript">    <span class="na">text</span><span class="p">:</span> <span class="nx">file</span><span class="p">,</span>  </span>&#x000A;<span id="LC5" class="line" lang="javascript">    <span class="na">href</span><span class="p">:</span> <span class="nf">joinPaths</span><span class="p">(</span><span class="nx">projectBlobPath</span><span class="p">,</span> <span class="nx">file</span><span class="p">),</span>  </span>&#x000A;<span id="LC6" class="line" lang="javascript">    <span class="na">extraAttrs</span><span class="p">:</span> <span class="p">{</span>  </span>&#x000A;<span id="LC7" class="line" lang="javascript">      <span class="dl">'</span><span class="s1">data-track-action</span><span class="dl">'</span><span class="p">:</span> <span class="nx">TRACKING_CLICK_COMMAND_PALETTE_ITEM</span><span class="p">,</span>  </span>&#x000A;<span id="LC8" class="line" lang="javascript">      <span class="dl">'</span><span class="s1">data-track-label</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">file</span><span class="dl">'</span><span class="p">,</span>  </span>&#x000A;<span id="LC9" class="line" lang="javascript">    <span class="p">},</span>  </span>&#x000A;<span id="LC10" class="line" lang="javascript">  <span class="p">};</span>  </span>&#x000A;<span id="LC11" class="line" lang="javascript"><span class="p">};</span>  </span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="38:1-38:147" dir="auto">the data sent into here comes from here <code data-sourcepos="38:42-38:144">app/assets/javascripts/super_sidebar/components/global_search/command_palette/command_palette_items.vue</code></p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="39:1-42:3" data-canonical-lang="js" class="code highlight js-syntax-highlight language-javascript" v-pre="true"><code><span id="LC1" class="line" lang="javascript"><span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">axios</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">projectFilesPath</span><span class="p">);</span>  </span>&#x000A;<span id="LC2" class="line" lang="javascript">          <span class="k">this</span><span class="p">.</span><span class="nx">projectFiles</span> <span class="o">=</span> <span class="nx">response</span><span class="p">?.</span><span class="nx">data</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="nx">fileMapper</span><span class="p">.</span><span class="nf">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">projectBlobPath</span><span class="p">));</span>  </span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="44:1-44:93" dir="auto">This means that filenames are sent directly into <code data-sourcepos="44:51-44:61">v-safe-html</code> and filenames can contain HTML</p>&#x000A;<p data-sourcepos="46:1-46:109" dir="auto">One place in the app where this can lead to XSS in <code data-sourcepos="46:53-46:80">new merge request diff pages</code> bypassing CSP on gitlab.com</p>&#x000A;<h4 data-sourcepos="48:1-48:24" dir="auto">&#x000A;<a href="#steps-to-reproduce" aria-hidden="true" class="anchor" id="user-content-steps-to-reproduce"></a>Steps to reproduce</h4>&#x000A;<ol data-sourcepos="50:1-50:126" dir="auto">&#x000A;<li data-sourcepos="50:1-50:126">Go to <a href="https://gitlab.com/-/snippets/new">https://gitlab.com/-/snippets/new</a> and create a new <code data-sourcepos="50:62-50:67">public</code> snippet with a file called <code data-sourcepos="50:98-50:107">alert.json</code> and the content</li>&#x000A;</ol>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="51:1-53:5" data-canonical-lang="json" class="code highlight js-syntax-highlight language-json" v-pre="true"><code><span id="LC1" class="line" lang="json"><span class="p">{</span><span class="nl">"html"</span><span class="p">:</span><span class="s2">"&lt;script&gt;alert(document.domain)&lt;/script&gt;"</span><span class="p">}</span><span class="w">  </span></span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<p data-sourcepos="54:1-56:89" dir="auto">take note of the snippet ID<br data-sourcepos="54:30-54:30">&#x000A;2. Create a new project<br data-sourcepos="55:26-55:26">&#x000A;3. In the project create a file with this name (replace <code data-sourcepos="56:58-56:64">3737908</code> with your snippet ID)</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="57:1-59:5" data-canonical-lang="html" class="code highlight js-syntax-highlight language-html" v-pre="true"><code><span id="LC1" class="line" lang="html"><span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">inline-parallel-buttons</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">\-\snippets\3737908\raw\main\alert</span> <span class="na">style=</span><span class="s">"position:fixed;transform:translate3d(-2000px,-5000px,0px);width:10000px;height:20000px"</span><span class="nt">&gt;</span>  </span></code></pre>&#x000A;<copy-code></copy-code><insert-code-snippet></insert-code-snippet>&#x000A;</div>&#x000A;<ol data-sourcepos="60:1-64:0" start="4" dir="auto">&#x000A;<li data-sourcepos="60:1-60:220">Go to <code data-sourcepos="60:11-60:61">https://gitlab.com/GROUPNAME/PROJECTNAME/-/new/main</code> and create a new file, fill out whatever but make sure to change the <code data-sourcepos="60:134-60:146">target branch</code> from <code data-sourcepos="60:155-60:158">main</code> to <code data-sourcepos="60:165-60:174">new_branch</code>. Keep "start a new merge request" checked.</li>&#x000A;<li data-sourcepos="61:1-61:27">Click <code data-sourcepos="61:11-61:24">commit changes</code>&#x000A;</li>&#x000A;<li data-sourcepos="62:1-62:260">Go to <code data-sourcepos="62:11-62:159">https://gitlab.com/GROUPNAME/PROJECTNAME/-/merge_requests/new/diffs?merge_request%5Bsource_branch%5D=new_branch&amp;merge_request%5Btarget_branch%5D=main</code> (note that the <code data-sourcepos="62:178-62:204">source_branch%5D=new_branch</code> if you did not name your branch like this in step 4)</li>&#x000A;<li data-sourcepos="63:1-64:0">Click <code data-sourcepos="63:11-63:27">Search or go to..</code> in the upper left corner (or click <code data-sourcepos="63:66-63:66">/</code> or <code data-sourcepos="63:73-63:73">s</code> which are shortcuts)</li>&#x000A;</ol>&#x000A;<p data-sourcepos="65:1-65:144" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/7f4b0c4c525a13704a4d462888c2cc4425a3c48f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62343663363633612d623665322d343561652d626561312d6261626363346365386561372f53637265656e73686f745f323032342d30382d31345f61745f32332e34302e34362e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png"><img data-sourcepos="65:1-65:144" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Screenshot_2024-08-14_at_23.40.46.png" data-canonical-src="https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/7f4b0c4c525a13704a4d462888c2cc4425a3c48f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62343663363633612d623665322d343561652d626561312d6261626363346365386561372f53637265656e73686f745f323032342d30382d31345f61745f32332e34302e34362e706e67"></a></p>&#x000A;<ol data-sourcepos="67:1-70:0" start="8" dir="auto">&#x000A;<li data-sourcepos="67:1-67:31">In the search box type <code data-sourcepos="67:28-67:28">~</code>&#x000A;</li>&#x000A;<li data-sourcepos="68:1-68:116">There should now be some result in the search list, but it will be the HTML that is now covering the whole page</li>&#x000A;<li data-sourcepos="69:1-70:0">Click anywhere on the page, and an alert box should pop</li>&#x000A;</ol>&#x000A;<p data-sourcepos="71:1-71:144" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/77f0a5fcb34fdcb9490b5e08015f5d0c0e41e15e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61333065323532622d303664362d346633642d386162652d3961303734383861663233652f53637265656e73686f745f323032342d30382d31345f61745f32332e34322e35302e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png"><img data-sourcepos="71:1-71:144" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Screenshot_2024-08-14_at_23.42.50.png" data-canonical-src="https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/77f0a5fcb34fdcb9490b5e08015f5d0c0e41e15e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61333065323532622d303664362d346633642d386162652d3961303734383861663233652f53637265656e73686f745f323032342d30382d31345f61745f32332e34322e35302e706e67"></a></p>&#x000A;<h4 data-sourcepos="73:1-73:12" dir="auto">&#x000A;<a href="#impact" aria-hidden="true" class="anchor" id="user-content-impact"></a>Impact</h4>&#x000A;<p data-sourcepos="75:1-75:33" dir="auto">XSS with CSP bypass on gitlab.com</p>&#x000A;<h4 data-sourcepos="77:1-77:41" dir="auto">&#x000A;<a href="#what-is-the-current-bug-behavior" aria-hidden="true" class="anchor" id="user-content-what-is-the-current-bug-behavior"></a>What is the current <em data-sourcepos="77:27-77:31">bug</em> behavior?</h4>&#x000A;<p data-sourcepos="79:1-79:44" dir="auto">Filenames are not escaped in global search</p>&#x000A;<h4 data-sourcepos="80:1-80:46" dir="auto">&#x000A;<a href="#what-is-the-expected-correct-behavior" aria-hidden="true" class="anchor" id="user-content-what-is-the-expected-correct-behavior"></a>What is the expected <em data-sourcepos="80:28-80:36">correct</em> behavior?</h4>&#x000A;<p data-sourcepos="82:1-82:37" dir="auto">Filenames should not render as HTML</p>&#x000A;<h4 data-sourcepos="83:1-83:22" dir="auto">&#x000A;<a href="#output-of-checks" aria-hidden="true" class="anchor" id="user-content-output-of-checks"></a>Output of checks</h4>&#x000A;<p data-sourcepos="85:1-85:30" dir="auto">This bug happens on GitLab.com</p>&#x000A;<h4 data-sourcepos="87:1-87:12" dir="auto">&#x000A;<a href="#impact-1" aria-hidden="true" class="anchor" id="user-content-impact-1"></a>Impact</h4>&#x000A;<p data-sourcepos="89:1-89:33" dir="auto">XSS with CSP bypass on gitlab.com</p>&#x000A;<h2 data-sourcepos="91:1-91:14" dir="auto">&#x000A;<a href="#attachments" aria-hidden="true" class="anchor" id="user-content-attachments"></a>Attachments</h2>&#x000A;<p data-sourcepos="93:1-93:77" dir="auto"><strong data-sourcepos="93:1-93:12">Warning:</strong> Attachments received through HackerOne, please exercise caution!</p>&#x000A;<ul data-sourcepos="95:1-97:0" dir="auto">&#x000A;<li data-sourcepos="95:1-95:145"><a data-sourcepos="95:3-95:145" href="https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png" rel="nofollow noreferrer noopener" target="_blank">Screenshot_2024-08-14_at_23.42.50.png</a></li>&#x000A;<li data-sourcepos="96:1-97:0"><a data-sourcepos="96:3-96:145" href="https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png" rel="nofollow noreferrer noopener" target="_blank">Screenshot_2024-08-14_at_23.40.46.png</a></li>&#x000A;</ul>&#x000A;<h2 data-sourcepos="98:1-98:19" dir="auto">&#x000A;<a href="#how-to-reproduce" aria-hidden="true" class="anchor" id="user-content-how-to-reproduce"></a>How To Reproduce</h2>&#x000A;<p data-sourcepos="100:1-100:57" dir="auto">Please add <a data-sourcepos="100:12-100:40" href="https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues" rel="nofollow noreferrer noopener" target="_blank">reproducibility information</a> to this section:</p>&#x000A;<ol data-sourcepos="102:1-105:0" dir="auto">&#x000A;<li data-sourcepos="102:1-102:2">&#x000A;</li>&#x000A;<li data-sourcepos="103:1-103:2">&#x000A;</li>&#x000A;<li data-sourcepos="104:1-104:2">&#x000A;</li>&#x000A;</ol></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/278964/issues/481819/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="481819" data-issue-path="/gitlab-org/gitlab/-/issues/481819" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="gitlab-org/gitlab" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="gitlab-org/gitlab" data-issuable-id="152263438" data-issuable-iid="481819" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/gitlab-org/gitlab/-/issues/481819/links" data-full-path="gitlab-org/gitlab" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="481819" data-project-path="gitlab-org/gitlab" id="js-related-merge-requests"></div>
<div data-url="/gitlab-org/gitlab/-/issues/481819/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:152263438,&quot;iid&quot;:481819,&quot;description&quot;:&quot;:warning: **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**\n\n**[HackerOne report #2659386](https://hackerone.com/reports/2659386)** by `joaxcar` on 2024-08-14, assigned to @kmorrison1:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n####  Summary  \nAn HTML injection exists in the \&quot;global search\&quot; popup when searching for files.\n\nThis is the sink in `app/assets/javascripts/super_sidebar/components/global_search/command_palette/search_item.vue`  \n```js  \n highlightedName() {  \n      return highlight(this.item.text, this.searchQuery);  \n    },\n\n...\n\n\u003cspan v-safe-html=\&quot;highlightedName\&quot; class=\&quot;gl-text-gray-900\&quot;\u003e\u003c/span\u003e  \n```\n\nthe `item.text` is generated in `app/assets/javascripts/super_sidebar/components/global_search/command_palette/utils.js`  \n```js  \nexport const fileMapper = (projectBlobPath, file) =\u003e {  \n  return {  \n    icon: &#39;doc-code&#39;,  \n    text: file,  \n    href: joinPaths(projectBlobPath, file),  \n    extraAttrs: {  \n      &#39;data-track-action&#39;: TRACKING_CLICK_COMMAND_PALETTE_ITEM,  \n      &#39;data-track-label&#39;: &#39;file&#39;,  \n    },  \n  };  \n};  \n```\n\nthe data sent into here comes from here `app/assets/javascripts/super_sidebar/components/global_search/command_palette/command_palette_items.vue`  \n```js  \nconst response = await axios.get(this.projectFilesPath);  \n          this.projectFiles = response?.data.map(fileMapper.bind(null, this.projectBlobPath));  \n```\n\nThis means that filenames are sent directly into `v-safe-html` and filenames can contain HTML\n\nOne place in the app where this can lead to XSS in `new merge request diff pages` bypassing CSP on gitlab.com\n\n####  Steps to reproduce\n\n1. Go to https://gitlab.com/-/snippets/new and create a new `public` snippet with a file called `alert.json` and the content  \n```json  \n{\&quot;html\&quot;:\&quot;\u003cscript\u003ealert(document.domain)\u003c/script\u003e\&quot;}  \n```  \ntake note of the snippet ID  \n2. Create a new project  \n3. In the project create a file with this name (replace `3737908` with your snippet ID)  \n```html  \n\u003ci class=inline-parallel-buttons\u003e\u003ca href=\\-\\snippets\\3737908\\raw\\main\\alert style=\&quot;position:fixed;transform:translate3d(-2000px,-5000px,0px);width:10000px;height:20000px\&quot;\u003e  \n```  \n4. Go to `https://gitlab.com/GROUPNAME/PROJECTNAME/-/new/main` and create a new file, fill out whatever but make sure to change the `target branch` from `main` to `new_branch`. Keep \&quot;start a new merge request\&quot; checked.  \n5. Click `commit changes`  \n6. Go to `https://gitlab.com/GROUPNAME/PROJECTNAME/-/merge_requests/new/diffs?merge_request%5Bsource_branch%5D=new_branch\u0026merge_request%5Btarget_branch%5D=main` (note that the `source_branch%5D=new_branch` if you did not name your branch like this in step 4)  \n7. Click `Search or go to..` in the upper left corner (or click `/` or `s` which are shortcuts)\n\n![Screenshot_2024-08-14_at_23.40.46.png](https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png)\n\n8. In the search box type `~`  \n9. There should now be some result in the search list, but it will be the HTML that is now covering the whole page  \n10. Click anywhere on the page, and an alert box should pop\n\n![Screenshot_2024-08-14_at_23.42.50.png](https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png)\n\n####  Impact\n\nXSS with CSP bypass on gitlab.com\n\n####  What is the current *bug* behavior?\n\nFilenames are not escaped in global search  \n####  What is the expected *correct* behavior?\n\nFilenames should not render as HTML  \n####  Output of checks\n\nThis bug happens on GitLab.com\n\n####  Impact\n\nXSS with CSP bypass on gitlab.com\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [Screenshot_2024-08-14_at_23.42.50.png](https://h1.sec.gitlab.net/a/a30e252b-06d6-4f3d-8abe-9a07488af23e/Screenshot_2024-08-14_at_23.42.50.png)\n* [Screenshot_2024-08-14_at_23.40.46.png](https://h1.sec.gitlab.net/a/b46c663a-b6e2-45ae-bea1-babcc4ce8ea7/Screenshot_2024-08-14_at_23.40.46.png)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;title&quot;:&quot;HTML injection in Global Search, can lead to XSS with CSP bypass in MR diff view&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:4477118,&quot;updated_by_id&quot;:1786152,&quot;created_at&quot;:&quot;2024-08-29T14:39:54Z&quot;,&quot;updated_at&quot;:&quot;2025-01-07T19:55:06Z&quot;,&quot;milestone&quot;:{&quot;id&quot;:4477118,&quot;iid&quot;:104,&quot;group_id&quot;:9970,&quot;title&quot;:&quot;17.5&quot;,&quot;description&quot;:&quot;&quot;,&quot;state&quot;:&quot;active&quot;,&quot;created_at&quot;:&quot;2024-03-05T01:39:45.239Z&quot;,&quot;updated_at&quot;:&quot;2024-03-05T01:39:45.239Z&quot;,&quot;due_date&quot;:&quot;2024-10-11&quot;,&quot;start_date&quot;:&quot;2024-09-14&quot;,&quot;expired&quot;:true,&quot;web_url&quot;:&quot;https://gitlab.com/groups/gitlab-org/-/milestones/104&quot;},&quot;labels&quot;:[{&quot;id&quot;:992791,&quot;title&quot;:&quot;Deliverable&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues scheduled for the current milestone.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2016-11-18T17:02:50.145Z&quot;,&quot;updated_at&quot;:&quot;2019-04-17T18:49:16.998Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:26696517,&quot;title&quot;:&quot;SLA::Breached&quot;,&quot;color&quot;:&quot;#ff0000&quot;,&quot;description&quot;:&quot;Vulnerability issues that have breached remediation SLO. Previously titled as Remediation SLO::Breach&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2022-09-03T08:21:13.968Z&quot;,&quot;updated_at&quot;:&quot;2024-09-03T02:31:04.514Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10413872,&quot;title&quot;:&quot;SLO::Missed&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;Label to signify that a bug issue has missed its targeted SLO (Service Level Objective). See https://docs.gitlab.com/ee/development/contributing/issue_workflow.html#priority-labels. Previously titled as missed-SLO&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-04-28T18:18:21.631Z&quot;,&quot;updated_at&quot;:&quot;2023-02-16T18:38:39.684Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17009645,&quot;title&quot;:&quot;Weakness::CWE-79&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Cross-site Scripting (XSS) - Stored&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-11-10T07:06:20.195Z&quot;,&quot;updated_at&quot;:&quot;2020-11-10T07:06:20.195Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4116705,&quot;title&quot;:&quot;devops::foundations&quot;,&quot;color&quot;:&quot;#e44d2a&quot;,&quot;description&quot;:&quot;Issues for the Foundations stage of the DevOps lifecycle (e.g. Import \u0026 Integrate, Personal Productivity, etc)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-23T15:35:30.635Z&quot;,&quot;updated_at&quot;:&quot;2024-08-13T17:20:38.144Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:11832434,&quot;title&quot;:&quot;group::global search&quot;,&quot;color&quot;:&quot;#a8d695&quot;,&quot;description&quot;:&quot;Issues belonging to the Global Search group of the Core Platform stage of the DevOps lifecycle.&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-08-20T18:45:33.452Z&quot;,&quot;updated_at&quot;:&quot;2023-11-01T05:00:33.054Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857523,&quot;title&quot;:&quot;priority::2&quot;,&quot;color&quot;:&quot;#ff8800&quot;,&quot;description&quot;:&quot;We will address this soon and will provide capacity from our team for it in the next few releases. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:01:55.497Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:35.254Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918396,&quot;title&quot;:&quot;section::core platform&quot;,&quot;color&quot;:&quot;#f0ad4e&quot;,&quot;description&quot;:&quot;Issues related to the Core Platform section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:13:49.847Z&quot;,&quot;updated_at&quot;:&quot;2023-11-01T04:59:02.371Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713902,&quot;title&quot;:&quot;severity::2&quot;,&quot;color&quot;:&quot;#ff8800&quot;,&quot;description&quot;:&quot;Critical - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:34.880Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:15.351Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:28669354,&quot;title&quot;:&quot;workflow::complete&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Applied after all MRs have merged and the issue has been verified if necessary&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-01-12T00:18:59.592Z&quot;,&quot;updated_at&quot;:&quot;2023-01-12T17:27:43.939Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:0,&quot;author_id&quot;:2741139,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:10776513,&quot;username&quot;:&quot;tbulva&quot;,&quot;name&quot;:&quot;Tomas Bulva&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.com/uploads/-/system/user/avatar/10776513/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/tbulva&quot;}],&quot;due_date&quot;:&quot;2024-09-28&quot;,&quot;project_id&quot;:278964,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/gitlab-org/gitlab/-/issues/481819&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/gitlab-org/gitlab/notes?target_id=152263438\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=481819\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:2,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:152263438,&quot;projectId&quot;:278964,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/gitlab-org/gitlab/-/issues/481819/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/gitlab-org/gitlab/-/issues/481819.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/gitlab-org/gitlab/-/issues/481819.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/gitlab-org/gitlab/noteable/issue/152263438/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736627461000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/gitlab-org/gitlab/-/issues/481819.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="gitlab-org" data-issue-id="152263438" data-issue-iid="481819" data-project-path="gitlab-org/gitlab"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="481819" data-issuable-type="issue" data-labels-fetch-path="/gitlab-org/gitlab/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/gitlab-org/gitlab/-/labels" data-project-issues-path="/gitlab-org/gitlab/-/issues" data-project-path="gitlab-org/gitlab" data-selected-labels="[{&quot;id&quot;:992791,&quot;title&quot;:&quot;Deliverable&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Issues scheduled for the current milestone.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2016-11-18T17:02:50.145Z&quot;,&quot;updated_at&quot;:&quot;2019-04-17T18:49:16.998Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:26696517,&quot;title&quot;:&quot;SLA::Breached&quot;,&quot;color&quot;:&quot;#ff0000&quot;,&quot;description&quot;:&quot;Vulnerability issues that have breached remediation SLO. Previously titled as Remediation SLO::Breach&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2022-09-03T08:21:13.968Z&quot;,&quot;updated_at&quot;:&quot;2024-09-03T02:31:04.514Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10413872,&quot;title&quot;:&quot;SLO::Missed&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;Label to signify that a bug issue has missed its targeted SLO (Service Level Objective). See https://docs.gitlab.com/ee/development/contributing/issue_workflow.html#priority-labels. Previously titled as missed-SLO&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-04-28T18:18:21.631Z&quot;,&quot;updated_at&quot;:&quot;2023-02-16T18:38:39.684Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17009645,&quot;title&quot;:&quot;Weakness::CWE-79&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Cross-site Scripting (XSS) - Stored&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-11-10T07:06:20.195Z&quot;,&quot;updated_at&quot;:&quot;2020-11-10T07:06:20.195Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4116705,&quot;title&quot;:&quot;devops::foundations&quot;,&quot;color&quot;:&quot;#e44d2a&quot;,&quot;description&quot;:&quot;Issues for the Foundations stage of the DevOps lifecycle (e.g. Import \u0026 Integrate, Personal Productivity, etc)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-23T15:35:30.635Z&quot;,&quot;updated_at&quot;:&quot;2024-08-13T17:20:38.144Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:11832434,&quot;title&quot;:&quot;group::global search&quot;,&quot;color&quot;:&quot;#a8d695&quot;,&quot;description&quot;:&quot;Issues belonging to the Global Search group of the Core Platform stage of the DevOps lifecycle.&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-08-20T18:45:33.452Z&quot;,&quot;updated_at&quot;:&quot;2023-11-01T05:00:33.054Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857523,&quot;title&quot;:&quot;priority::2&quot;,&quot;color&quot;:&quot;#ff8800&quot;,&quot;description&quot;:&quot;We will address this soon and will provide capacity from our team for it in the next few releases. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:01:55.497Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:35.254Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918396,&quot;title&quot;:&quot;section::core platform&quot;,&quot;color&quot;:&quot;#f0ad4e&quot;,&quot;description&quot;:&quot;Issues related to the Core Platform section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:13:49.847Z&quot;,&quot;updated_at&quot;:&quot;2023-11-01T04:59:02.371Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713902,&quot;title&quot;:&quot;severity::2&quot;,&quot;color&quot;:&quot;#ff8800&quot;,&quot;description&quot;:&quot;Critical - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:34.880Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:15.351Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:28669354,&quot;title&quot;:&quot;workflow::complete&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Applied after all MRs have merged and the issue has been verified if necessary&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2023-01-12T00:18:59.592Z&quot;,&quot;updated_at&quot;:&quot;2023-01-12T17:27:43.939Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="481819" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="gitlab-org" data-issue-id="152263438" data-issue-iid="481819" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="481819" data-project-path="gitlab-org/gitlab"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="gitlab-org/gitlab" data-iid="481819" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/gitlab-org/gitlab/-/issues/481819.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/gitlab-org/gitlab/-/issues/481819/toggle_subscription","moveIssueEndpoint":"/gitlab-org/gitlab/-/issues/481819/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=278964","editable":"","currentUser":{},"rootPath":"/","fullPath":"gitlab-org/gitlab","iid":481819,"id":152263438,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="3LSBZ+BFAm2bESPkiZ5B3g==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="3LSBZ+BFAm2bESPkiZ5B3g==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

