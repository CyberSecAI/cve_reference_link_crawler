=== Content from bugzilla.mozilla.org_27fcde0a_20250110_162059.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1840777)
* [XML](/show_bug.cgi?ctype=xml&id=1840777)

Closed
[Bug 1840777](/show_bug.cgi?id=1840777)
(CVE-2023-4054)

Opened 2 years ago
Closed 2 years ago

# .appref-ms file extension = Executable file may contain viruses or other malicious code

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

.appref-ms file extension = Executable file may contain viruses or other malicious code

## Categories

### (Firefox :: File Handling, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

117 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [116+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=116%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox-esr115 | [116+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=116%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=verified) |
| firefox117 | [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 | 116+ | verified |
| firefox-esr115 | 116+ | verified |
| firefox-esr128 | --- | --- |
| firefox115 |  | wontfix |
| firefox116 | + | verified |
| firefox117 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: Puf, Assigned: mak)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=40)  [mak](/user_profile?user_id=240353)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/6d06bb80f5c3ab73df0e30507caf881c?d=mm&size=40)  [Puf](/user_profile?user_id=687629)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-37208](/show_bug.cgi?id=1837675 "VERIFIED FIXED - Diagcab file extension = Executable files may contain viruses or other malicious code")

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main116+] [adv-ESR115.1+] [adv-ESR102.14+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-4054

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [adv-main116+] [adv-ESR115.1+] [adv-ESR102.14+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c25 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 2 obsolete files)

| [Firefox appref-ms.mp4](/attachment.cgi?id=9341443)  [2 years ago](#c1)  [Umar Farooq [:Puf]](/user_profile?user_id=687629)   170.57 KB, video/mp4 |  | [Details](/attachment.cgi?id=9341443&action=edit) |
| --- | --- | --- |
| [Bug 1840777. r=mtigley](/attachment.cgi?id=9342190)  [2 years ago](#c9)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9342190&action=edit) | [Review](/attachment.cgi?id=9342190) |
| [Bug 1840777. r=mtigley](/attachment.cgi?id=9342693)  [2 years ago](#c11)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9342693&action=edit) | [Review](/attachment.cgi?id=9342693) |
| [Bug 1840777.](/attachment.cgi?id=9342694)  [2 years ago](#c12)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c18 "2 years ago") | [Details](/attachment.cgi?id=9342694&action=edit) | [Review](/attachment.cgi?id=9342694) |
| [Bug 1840777. r=mtigley](/attachment.cgi?id=9342698)  [2 years ago](#c14)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9342698&action=edit) | [Review](/attachment.cgi?id=9342698) |
| [Bug 1840777. r=mtigley](/attachment.cgi?id=9343210)  [2 years ago](#c21)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#a1236963_75935 "2 years ago") | [Details](/attachment.cgi?id=9343210&action=edit) | [Review](/attachment.cgi?id=9343210) |
| [Bug 1840777](/attachment.cgi?id=9343449)  [2 years ago](#c27)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-esr102+](#c29 "2 years ago") | [Details](/attachment.cgi?id=9343449&action=edit) | [Review](/attachment.cgi?id=9343449) |
| [advisory.txt](/attachment.cgi?id=9346034)  [1 years ago](#c32)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   167 bytes, text/plain |  | [Details](/attachment.cgi?id=9346034&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Umar Farooq [:Puf]](/user_profile?user_id=687629)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1840777#c0)• 2 years ago |
|  | |

Firefox Version: [115.0] + [116.0a1]

Operating System: [Windows 10]

.appref-ms = ClickOnce application reference. Basically a .lnk for ClickOnce apps.

An appref-ms file can be created that will act similar to an LNK or shortcut file that will contain the URL of the deployment manifest and some other pieces of information.

Chrome Browser & Microsoft Edge :

file\_types {

# ClickOnce application reference. Basically a .lnk for ClickOnce apps.

extension: "appref-ms"

uma\_value: 144

ping\_setting: FULL\_PING

platform\_settings {

platform: PLATFORM\_TYPE\_WINDOWS

danger\_level: ALLOW\_ON\_USER\_GESTURE

auto\_open\_hint: DISALLOW\_AUTO\_OPEN

}

}

This File is Already Blocklisted in Chrome & Edge Browsers

it's better to Add Popop Warning [ Executable files may contain viruses or other malicious code that could harm your computer]

To .appref-ms file To Keep Safe System from malicious file/code

Flags: sec-bounty?

|  | [Umar Farooq [:Puf]](/user_profile?user_id=687629)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1840777#c1)• 2 years ago |
|  | |

Attached video
[Firefox appref-ms.mp4](attachment.cgi?id=9341443)
— [Details](attachment.cgi?id=9341443&action=edit)

|  | [Umar Farooq [:Puf]](/user_profile?user_id=687629)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1840777#c2)• 2 years ago |
|  | |

Step To Reproduce:

1. Create .appref-ms File.
2. Download Using Firefox Browser
3. Open File [No Warning]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1840777#c3)• 2 years ago |
|  | |

I haven't tested this myself, but I do see ".appref-ms" in [ApplicationReputationService::kBinaryFileExtensions](https://searchfox.org/mozilla-central/rev/c0adc2160976e2c118e2e5709d08aac071fddce9/toolkit/components/reputationservice/test/gtest/TestExecutableLists.cpp#27). I'm not sure if that's supposed to be sufficient or what.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a31294_406194)• 2 years ago |

Component: Security → File Handling

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1840777#c4)• 2 years ago |
|  | |

(It looks like that got added in [bug 1291472](/show_bug.cgi?id=1291472 "VERIFIED FIXED - Add more application reputation extensions").)

|  | [Umar Farooq [:Puf]](/user_profile?user_id=687629)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1840777#c5)• 2 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #3](/show_bug.cgi?id=1840777#c3 "VERIFIED FIXED - .appref-ms file extension = Executable file may contain viruses or other malicious code"))

> I haven't tested this myself, but I do see ".appref-ms" in [ApplicationReputationService::kBinaryFileExtensions](https://searchfox.org/mozilla-central/rev/c0adc2160976e2c118e2e5709d08aac071fddce9/toolkit/components/reputationservice/test/gtest/TestExecutableLists.cpp#27). I'm not sure if that's supposed to be sufficient or what.

But There Is No Popop Warning [ Executable files may contain viruses or other malicious code that could harm your computer] For this File ".appref-ms". I Have Attached POC Video Please Check Out Once

|  | [Umar Farooq [:Puf]](/user_profile?user_id=687629)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1840777#c6)• 2 years ago |
|  | |

I Have Done Testing in Both Latest Beta Version & nightly (64-bit)

There is [ No Warning]

<https://youtu.be/4FtVwiuBtx4> = Video Black Hat Explanation on Click Once Appref-ms Abuse

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1840777#c7)• 2 years ago |
|  | |

> (It looks like that got added in [bug 1291472](/show_bug.cgi?id=1291472 "VERIFIED FIXED - Add more application reputation extensions").)

That was for SafeBrowsing "application reputation" checking, but that doesn't necessarily block all files with that extension. It would only block "known bad ones" which isn't going to happen for a one-off attack.

It needs to be added to the executable list in [nsLocalFileCommon.cpp](https://searchfox.org/mozilla-central/source/xpcom/io/nsLocalFileCommon.cpp#31)

How hard would it be to set up some kind of auto-update or at least alerting for when Chrome updates their list?

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1840777#c8)• 2 years ago |
|  | |

Chrome has marked a lot of files as DISALLOW\_AUTO\_OPEN that we don't consider executable. But yes, it's a good idea to have a notification, we should speak with Marco Castelluccio and see if some automated tool could be setup. For now we can use third party tools to monitor their source page.

This addition was made quite in the past anyway (2016), I'm not sure why at the time it was only added to apprep.

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1840777#c9)• 2 years ago |
|  | |

Attached file
[Bug 1840777. r=mtigley](attachment.cgi?id=9342190)
— [Details](attachment.cgi?id=9342190&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a531436_600971)• 2 years ago |

Assignee: nobody → makStatus: NEW → ASSIGNED

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1840777#c10)• 2 years ago |
|  | |

Pushed by mak77@bonardo.net:
<https://hg.mozilla.org/integration/autoland/rev/3a49d8ea5a2f>
r=mtigley,Gijs

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1840777#c11)• 2 years ago |
|  | |

Attached file
[Bug 1840777. r=mtigley](attachment.cgi?id=9342693) (obsolete)
— [Details](attachment.cgi?id=9342693&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D182711>

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1840777#c12)• 2 years ago |
|  | |

Attached file
[Bug 1840777.](attachment.cgi?id=9342694)
— [Details](attachment.cgi?id=9342694&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D182711>

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a788989_240353)• 2 years ago |

[Attachment #9342693](/attachment.cgi?id=9342693&action=edit "Bug 1840777. r=mtigley") -
Attachment is obsolete: true

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1840777#c13)• 2 years ago |
|  | |

Comment on [attachment 9342694](/attachment.cgi?id=9342694 "Bug 1840777.") [[details]](/attachment.cgi?id=9342694&action=edit "Bug 1840777.")

[Bug 1840777](/show_bug.cgi?id=1840777 "VERIFIED FIXED - .appref-ms file extension = Executable file may contain viruses or other malicious code").

### Beta/Release Uplift Approval Request

* **User impact if declined**: sec-moderate
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Try downloading a appref-ms file. If you can't find one easily, rename one in a local file explorer and drag to the tabstrip. Expected behaviour is that once downloaded there's a prompt when trying to open it, rather than it immediately opening a Windows wizard to install something
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: just adding an extension to a list
* **String changes made/needed**:
* **Is Android affected?**: Yes
[Attachment #9342694](/attachment.cgi?id=9342694&action=edit "Bug 1840777.") -
Flags: approval-mozilla-beta?

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a789172_240353)• 2 years ago |

Flags: qe-verify+

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1840777#c14)• 2 years ago |
|  | |

Attached file
[Bug 1840777. r=mtigley](attachment.cgi?id=9342698) (obsolete)
— [Details](attachment.cgi?id=9342698&action=edit)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a789921_240353)• 2 years ago |

[Attachment #9342698](/attachment.cgi?id=9342698&action=edit "Bug 1840777. r=mtigley") -
Attachment is obsolete: true

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1840777#c15)• 2 years ago |
|  | |

Apart from ESR115 (looks like lando is broken yet, so waiting), Is it worth uplifting to ESR102?

Flags: needinfo?(dveditz)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a811543_600971)• 2 years ago |

[Attachment #9342694](/attachment.cgi?id=9342694&action=edit "Bug 1840777.") -
Attachment description: Bug 1840777. r=mtigley → Bug 1840777.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1840777#c16)• 2 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/3a49d8ea5a2f>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)Resolution: --- → FIXEDTarget Milestone: --- → 117 Branch

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a1049548_553429)• 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1840777#c17)• 2 years ago |
|  | |

Using Firefox 116.0b3 I don't get any notification once the `.appref-ms` file is downloaded and I click on the file. Using latest Nightly 117.0a1 with the fix on Windows 10 64bit the `".appref-ms" is the executable file. Executable files may contain viruses or other malicious code that could harm your computer. Use caution when opening this file. Are you sure you want to launch ".appref-ms"?` prompt is displayed when clicking on the downloaded file.

Here is the file I used, not mine (<https://github.com/jiaminliu/HW4/blob/master/Desktop/GitHub.appref-ms>) for testing purposes.

[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=verified)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1840777#c18)• 2 years ago |
|  | |

Comment on [attachment 9342694](/attachment.cgi?id=9342694 "Bug 1840777.") [[details]](/attachment.cgi?id=9342694&action=edit "Bug 1840777.")

[Bug 1840777](/show_bug.cgi?id=1840777 "VERIFIED FIXED - .appref-ms file extension = Executable file may contain viruses or other malicious code").

Approved for 116.0b4

[Attachment #9342694](/attachment.cgi?id=9342694&action=edit "Bug 1840777.") -
Attachment description: Bug 1840777. → Bug 1840777. r=mtigley
[Attachment #9342694](/attachment.cgi?id=9342694&action=edit "Bug 1840777.") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1840777#c19)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/e31ceee72448>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a1065378_690067)• 2 years ago |

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1840777#c20)• 2 years ago |
|  | |

(In reply to Bogdan Maris, Desktop QA from [comment #17](/show_bug.cgi?id=1840777#c17 "VERIFIED FIXED - .appref-ms file extension = Executable file may contain viruses or other malicious code"))

> Using Firefox 116.0b3 I don't get any notification once the `.appref-ms` file is downloaded and I click on the file. Using latest Nightly 117.0a1 with the fix on Windows 10 64bit the `".appref-ms" is the executable file. Executable files may contain viruses or other malicious code that could harm your computer. Use caution when opening this file. Are you sure you want to launch ".appref-ms"?` prompt is displayed when clicking on the downloaded file.
>
> Here is the file I used, not mine (<https://github.com/jiaminliu/HW4/blob/master/Desktop/GitHub.appref-ms>) for testing purposes.

Also verified as fixed using beta build <https://treeherder.mozilla.org/jobs?repo=mozilla-beta&revision=1dcdc0d37b33c854558ec0ef2561545b2254d192> which contains this fix.

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=verified)Flags: qe-verify+

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1840777#c21)• 2 years ago |
|  | |

Attached file
[Bug 1840777. r=mtigley](attachment.cgi?id=9343210)
— [Details](attachment.cgi?id=9343210&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D182711>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1840777#c22)• 2 years ago |
|  | |

# Uplift Approval Request

* **Steps to reproduce for manual QE testing**: Try downloading a appref-ms file. If you can't find one easily, rename one in a local file explorer and drag to the tabstrip. Expected behaviour is that once downloaded there's a prompt when trying to open it, rather than it immediately opening a Windows wizard to install something
* **Explanation of risk level**: just adding an extension to a list
* **Code covered by automated testing**: yes
* **Needs manual QE test**: yes
* **Is Android affected?**: yes
* **User impact if declined**: sec-moderate
* **Risk associated with taking this patch**: low
* **String changes made/needed**: none
* **Fix verified in Nightly**: yes
Flags: qe-verify+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1840777#c23)• 2 years ago |
|  | |

A patch has been attached on this bug, which was already closed. Filing a separate bug will ensure better tracking. If this was not by mistake and further action is needed, please alert the appropriate party. (Or: if the patch doesn't change behavior -- e.g. landing a test case, or fixing a typo -- then feel free to disregard this message)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a1150218_75935)• 2 years ago |

[tracking-firefox116](/buglist.cgi?f1=cf_tracking_firefox116&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B)
[tracking-firefox117](/buglist.cgi?f1=cf_tracking_firefox117&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox117&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [116+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=116%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [116+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=116%2B)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1840777#c24)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/6d84a1a2d030>

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a1150666_640478)• 2 years ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1840777#c25)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1840777&comment_id=16492072 "1 revision") |
|  | |

(In reply to Marco Bonardo [:mak] from [comment #15](/show_bug.cgi?id=1840777#c15 "VERIFIED FIXED - .appref-ms file extension = Executable file may contain viruses or other malicious code"))

> Apart from ESR115 (looks like lando is broken yet, so waiting), Is it worth uplifting to ESR102?

Yes, we should. ESR-102 is supported for another 3 months and this sec-moderate fix is essentially riskless.

Flags: sec-bounty?Flags: sec-bounty+Flags: needinfo?(dveditz)See Also: → [CVE-2023-37208](/show_bug.cgi?id=1837675 "VERIFIED FIXED - Diagcab file extension = Executable files may contain viruses or other malicious code")

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1840777#c26)• 2 years ago |
|  | |

(In reply to Bogdan Maris, Desktop QA from [comment #20](/show_bug.cgi?id=1840777#c20 "VERIFIED FIXED - .appref-ms file extension = Executable file may contain viruses or other malicious code"))

> (In reply to Bogdan Maris, Desktop QA from [comment #17](/show_bug.cgi?id=1840777#c17 "VERIFIED FIXED - .appref-ms file extension = Executable file may contain viruses or other malicious code"))
>
> > Using Firefox 116.0b3 I don't get any notification once the `.appref-ms` file is downloaded and I click on the file. Using latest Nightly 117.0a1 with the fix on Windows 10 64bit the `".appref-ms" is the executable file. Executable files may contain viruses or other malicious code that could harm your computer. Use caution when opening this file. Are you sure you want to launch ".appref-ms"?` prompt is displayed when clicking on the downloaded file.
> >
> > Here is the file I used, not mine (<https://github.com/jiaminliu/HW4/blob/master/Desktop/GitHub.appref-ms>) for testing purposes.
>
> Also verified as fixed using beta build <https://treeherder.mozilla.org/jobs?repo=mozilla-beta&revision=1dcdc0d37b33c854558ec0ef2561545b2254d192> which contains this fix.

Also verified as fixed using 115esr build <https://treeherder.mozilla.org/jobs?repo=mozilla-esr115&revision=6d84a1a2d030251a166f188a6bae95bb83fcd213> which contains this fix.

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1840777#c27)• 2 years ago |
|  | |

Attached file
[Bug 1840777](attachment.cgi?id=9343449)
— [Details](attachment.cgi?id=9343449&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1840777#c28)• 2 years ago |
|  | |

# Uplift Approval Request

* **Code covered by automated testing**: yes
* **Fix verified in Nightly**: yes
* **Risk associated with taking this patch**: low
* **Is Android affected?**: yes
* **Explanation of risk level**: just adding an extension to a list
* **String changes made/needed**: none
* **Needs manual QE test**: yes
* **User impact if declined**: sec-moderate
* **Steps to reproduce for manual QE testing**: Try downloading a appref-ms file. If you can't find one easily, rename one in a local file explorer and drag to the tabstrip. Expected behaviour is that once downloaded there's a prompt when trying to open it, rather than it immediately opening a Windows wizard to install something

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a1221934_600971)• 2 years ago |

[Attachment #9343449](/attachment.cgi?id=9343449&action=edit "Bug 1840777") -
Attachment description: WIP: Bug 1840777. → Bug 1840777
[Attachment #9343449](/attachment.cgi?id=9343449&action=edit "Bug 1840777") -
Flags: approval-mozilla-esr102?

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1840777#c29)• 2 years ago |
|  | |

Comment on [attachment 9343449](/attachment.cgi?id=9343449 "Bug 1840777") [[details]](/attachment.cgi?id=9343449&action=edit "Bug 1840777")

[Bug 1840777](/show_bug.cgi?id=1840777 "VERIFIED FIXED - .appref-ms file extension = Executable file may contain viruses or other malicious code")

Approved for 102.14esr

[Attachment #9343449](/attachment.cgi?id=9343449&action=edit "Bug 1840777") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a1236963_75935)• 2 years ago |

[Attachment #9343210](/attachment.cgi?id=9343210&action=edit "Bug 1840777. r=mtigley") -
Flags: approval-mozilla-esr115+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a1302543_600971)• 1 years ago |

[Attachment #9342694](/attachment.cgi?id=9342694&action=edit "Bug 1840777.") -
Attachment description: Bug 1840777. r=mtigley → Bug 1840777.

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1840777#c30)• 1 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/ff58df5cb718>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a1336393_690067)• 1 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering [PTO until 13 Jan]](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1840777#c31)• 1 years ago |
|  | |

Also verified that this is fixed on esr102 <https://treeherder.mozilla.org/jobs?repo=mozilla-esr102&revision=ff58df5cb71869d915e8db5b18615aa05a8e8344>

Status: RESOLVED → VERIFIED
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)Flags: qe-verify+

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a2473125_486733)• 1 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main116+][adv-ESR115.1+][adv-ESR112.14+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a2489715_486733)• 1 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main116+][adv-ESR115.1+][adv-ESR112.14+] → [reporter-external] [client-bounty-form] [verif?] [adv-main116+] [adv-ESR115.1+] [adv-ESR102.14+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1840777#c32)• 1 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9346034)
— [Details](attachment.cgi?id=9346034&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a16420066_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a16426533_1689)• 1 year ago |

Alias: CVE-2023-4054

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1840777#a29159495_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1840777&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Umar Farooq [:Puf]](/user_profile?user_id=687629)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_bbe4e8a1_20250110_162101.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-32

## Security Vulnerabilities fixed in Thunderbird 102.14

Announced
August 2, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.14

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-4045: Offscreen Canvas could have bypassed cross-origin restrictions](#CVE-2023-4045)

Reporter
Max Vlasov
Impact
high
##### Description

Offscreen Canvas did not properly track cross-origin tainting, which could have been used to access image data from another site in violation of same-origin policy.

##### References

* [Bug 1833876](https://bugzilla.mozilla.org/show_bug.cgi?id=1833876)

#### [#CVE-2023-4046: Incorrect value used during WASM compilation](#CVE-2023-4046)

Reporter
Alexander Guryanov
Impact
high
##### Description

In some circumstances, a stale value could have been used for a global variable in WASM JIT analysis. This resulted in incorrect compilation and a potentially exploitable crash in the content process.

##### References

* [Bug 1837686](https://bugzilla.mozilla.org/show_bug.cgi?id=1837686)

#### [#CVE-2023-4047: Potential permissions request bypass via clickjacking](#CVE-2023-4047)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1839073](https://bugzilla.mozilla.org/show_bug.cgi?id=1839073)

#### [#CVE-2023-4048: Crash in DOMParser due to out-of-memory conditions](#CVE-2023-4048)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bounds read could have led to an exploitable crash when parsing HTML with DOMParser in low memory situations.

##### References

* [Bug 1841368](https://bugzilla.mozilla.org/show_bug.cgi?id=1841368)

#### [#CVE-2023-4049: Fix potential race conditions when releasing platform objects](#CVE-2023-4049)

Reporter
Nika Layzell
Impact
high
##### Description

Race conditions in reference counting code were found through code inspection. These could have resulted in potentially exploitable use-after-free vulnerabilities.

##### References

* [Bug 1842658](https://bugzilla.mozilla.org/show_bug.cgi?id=1842658)

#### [#CVE-2023-4050: Stack buffer overflow in StorageManager](#CVE-2023-4050)

Reporter
Mark Brand
Impact
high
##### Description

In some cases, an untrusted input stream was copied to a stack buffer without checking its size. This resulted in a potentially exploitable crash which could have led to a sandbox escape.

##### References

* [Bug 1843038](https://bugzilla.mozilla.org/show_bug.cgi?id=1843038)

#### [#CVE-2023-4054: Lack of warning when opening appref-ms files](#CVE-2023-4054)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening appref-ms files, Firefox did not warn the user that these files may contain malicious code.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1840777](https://bugzilla.mozilla.org/show_bug.cgi?id=1840777)

#### [#CVE-2023-4055: Cookie jar overflow caused unexpected cookie jar state](#CVE-2023-4055)

Reporter
Marco Squarcina
Impact
low
##### Description

When the number of cookies per domain was exceeded in `document.cookie`, the actual cookie jar sent to the host was no longer consistent with expected cookie jar state. This could have caused requests to be sent with some cookies missing.

##### References

* [Bug 1782561](https://bugzilla.mozilla.org/show_bug.cgi?id=1782561)

#### [#CVE-2023-4056: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](#CVE-2023-4056)

Reporter
Dianna Smith, Ryan VanderMeulen, Timothy Nikkel, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, Firefox ESR 102.13, Thunderbird 115.0, and Thunderbird 102.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1820587%2C1824634%2C1839235%2C1842325%2C1843847)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_542934ad_20250110_162059.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-29

## Security Vulnerabilities fixed in Firefox 116

Announced
August 1, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 116

#### [#CVE-2023-4045: Offscreen Canvas could have bypassed cross-origin restrictions](#CVE-2023-4045)

Reporter
Max Vlasov
Impact
high
##### Description

Offscreen Canvas did not properly track cross-origin tainting, which could have been used to access image data from another site in violation of same-origin policy.

##### References

* [Bug 1833876](https://bugzilla.mozilla.org/show_bug.cgi?id=1833876)

#### [#CVE-2023-4046: Incorrect value used during WASM compilation](#CVE-2023-4046)

Reporter
Alexander Guryanov
Impact
high
##### Description

In some circumstances, a stale value could have been used for a global variable in WASM JIT analysis. This resulted in incorrect compilation and a potentially exploitable crash in the content process.

##### References

* [Bug 1837686](https://bugzilla.mozilla.org/show_bug.cgi?id=1837686)

#### [#CVE-2023-4047: Potential permissions request bypass via clickjacking](#CVE-2023-4047)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1839073](https://bugzilla.mozilla.org/show_bug.cgi?id=1839073)

#### [#CVE-2023-4048: Crash in DOMParser due to out-of-memory conditions](#CVE-2023-4048)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bounds read could have led to an exploitable crash when parsing HTML with DOMParser in low memory situations.

##### References

* [Bug 1841368](https://bugzilla.mozilla.org/show_bug.cgi?id=1841368)

#### [#CVE-2023-4049: Fix potential race conditions when releasing platform objects](#CVE-2023-4049)

Reporter
Nika Layzell
Impact
high
##### Description

Race conditions in reference counting code were found through code inspection. These could have resulted in potentially exploitable use-after-free vulnerabilities.

##### References

* [Bug 1842658](https://bugzilla.mozilla.org/show_bug.cgi?id=1842658)

#### [#CVE-2023-4050: Stack buffer overflow in StorageManager](#CVE-2023-4050)

Reporter
Mark Brand
Impact
high
##### Description

In some cases, an untrusted input stream was copied to a stack buffer without checking its size. This resulted in a potentially exploitable crash which could have led to a sandbox escape.

##### References

* [Bug 1843038](https://bugzilla.mozilla.org/show_bug.cgi?id=1843038)

#### [#CVE-2023-4051: Full screen notification obscured by file open dialog](#CVE-2023-4051)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1821884](https://bugzilla.mozilla.org/show_bug.cgi?id=1821884)

#### [#CVE-2023-4052: File deletion and privilege escalation through Firefox uninstaller](#CVE-2023-4052)

Reporter
ycdxsb
Impact
moderate
##### Description

The Firefox updater created a directory writable by non-privileged users. When uninstalling Firefox, any files in that directory would be recursively deleted with the permissions of the uninstalling user account. This could be combined with creation of a junction (a form of symbolic link) to allow arbitrary file deletion controlled by the non-privileged user.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1824420](https://bugzilla.mozilla.org/show_bug.cgi?id=1824420)

#### [#CVE-2023-4053: Full screen notification obscured by external program](#CVE-2023-4053)

Reporter
P Umar Farooq
Impact
moderate
##### Description

A website could have obscured the full screen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1839079](https://bugzilla.mozilla.org/show_bug.cgi?id=1839079)

#### [#CVE-2023-4054: Lack of warning when opening appref-ms files](#CVE-2023-4054)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening appref-ms files, Firefox did not warn the user that these files may contain malicious code.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1840777](https://bugzilla.mozilla.org/show_bug.cgi?id=1840777)

#### [#CVE-2023-4055: Cookie jar overflow caused unexpected cookie jar state](#CVE-2023-4055)

Reporter
Marco Squarcina
Impact
low
##### Description

When the number of cookies per domain was exceeded in `document.cookie`, the actual cookie jar sent to the host was no longer consistent with expected cookie jar state. This could have caused requests to be sent with some cookies missing.

##### References

* [Bug 1782561](https://bugzilla.mozilla.org/show_bug.cgi?id=1782561)

#### [#CVE-2023-4056: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](#CVE-2023-4056)

Reporter
Dianna Smith, Ryan VanderMeulen, Timothy Nikkel, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, Firefox ESR 102.13, Thunderbird 115.0, and Thunderbird 102.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1820587%2C1824634%2C1839235%2C1842325%2C1843847)

#### [#CVE-2023-4057: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](#CVE-2023-4057)

Reporter
The Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, and Thunderbird 115.0. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](https://bugzilla.mozilla.org/show_bug.cgi?id=1841682)

#### [#CVE-2023-4058: Memory safety bugs fixed in Firefox 116](#CVE-2023-4058)

Reporter
Andrew McCreight and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1819160%2C1828024)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_51c589c1_20250110_162101.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-33

## Security Vulnerabilities fixed in Thunderbird 115.1

Announced
August 2, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.1

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-4045: Offscreen Canvas could have bypassed cross-origin restrictions](#CVE-2023-4045)

Reporter
Max Vlasov
Impact
high
##### Description

Offscreen Canvas did not properly track cross-origin tainting, which could have been used to access image data from another site in violation of same-origin policy.

##### References

* [Bug 1833876](https://bugzilla.mozilla.org/show_bug.cgi?id=1833876)

#### [#CVE-2023-4046: Incorrect value used during WASM compilation](#CVE-2023-4046)

Reporter
Alexander Guryanov
Impact
high
##### Description

In some circumstances, a stale value could have been used for a global variable in WASM JIT analysis. This resulted in incorrect compilation and a potentially exploitable crash in the content process.

##### References

* [Bug 1837686](https://bugzilla.mozilla.org/show_bug.cgi?id=1837686)

#### [#CVE-2023-4047: Potential permissions request bypass via clickjacking](#CVE-2023-4047)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1839073](https://bugzilla.mozilla.org/show_bug.cgi?id=1839073)

#### [#CVE-2023-4048: Crash in DOMParser due to out-of-memory conditions](#CVE-2023-4048)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bounds read could have led to an exploitable crash when parsing HTML with DOMParser in low memory situations.

##### References

* [Bug 1841368](https://bugzilla.mozilla.org/show_bug.cgi?id=1841368)

#### [#CVE-2023-4049: Fix potential race conditions when releasing platform objects](#CVE-2023-4049)

Reporter
Nika Layzell
Impact
high
##### Description

Race conditions in reference counting code were found through code inspection. These could have resulted in potentially exploitable use-after-free vulnerabilities.

##### References

* [Bug 1842658](https://bugzilla.mozilla.org/show_bug.cgi?id=1842658)

#### [#CVE-2023-4050: Stack buffer overflow in StorageManager](#CVE-2023-4050)

Reporter
Mark Brand
Impact
high
##### Description

In some cases, an untrusted input stream was copied to a stack buffer without checking its size. This resulted in a potentially exploitable crash which could have led to a sandbox escape.

##### References

* [Bug 1843038](https://bugzilla.mozilla.org/show_bug.cgi?id=1843038)

#### [#CVE-2023-4052: File deletion and privilege escalation through Firefox uninstaller](#CVE-2023-4052)

Reporter
ycdxsb
Impact
moderate
##### Description

The Firefox updater created a directory writable by non-privileged users. When uninstalling Firefox, any files in that directory would be recursively deleted with the permissions of the uninstalling user account. This could be combined with creation of a junction (a form of symbolic link) to allow arbitrary file deletion controlled by the non-privileged user.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1824420](https://bugzilla.mozilla.org/show_bug.cgi?id=1824420)

#### [#CVE-2023-4054: Lack of warning when opening appref-ms files](#CVE-2023-4054)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening appref-ms files, Firefox did not warn the user that these files may contain malicious code.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1840777](https://bugzilla.mozilla.org/show_bug.cgi?id=1840777)

#### [#CVE-2023-4055: Cookie jar overflow caused unexpected cookie jar state](#CVE-2023-4055)

Reporter
Marco Squarcina
Impact
low
##### Description

When the number of cookies per domain was exceeded in `document.cookie`, the actual cookie jar sent to the host was no longer consistent with expected cookie jar state. This could have caused requests to be sent with some cookies missing.

##### References

* [Bug 1782561](https://bugzilla.mozilla.org/show_bug.cgi?id=1782561)

#### [#CVE-2023-4056: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](#CVE-2023-4056)

Reporter
Dianna Smith, Ryan VanderMeulen, Timothy Nikkel, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, Firefox ESR 102.13, Thunderbird 115.0, and Thunderbird 102.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1820587%2C1824634%2C1839235%2C1842325%2C1843847)

#### [#CVE-2023-4057: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](#CVE-2023-4057)

Reporter
The Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, and Thunderbird 115.0. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](https://bugzilla.mozilla.org/show_bug.cgi?id=1841682)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_19ba0880_20250110_162100.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-31

## Security Vulnerabilities fixed in Firefox ESR 115.1

Announced
August 1, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.1

#### [#CVE-2023-4045: Offscreen Canvas could have bypassed cross-origin restrictions](#CVE-2023-4045)

Reporter
Max Vlasov
Impact
high
##### Description

Offscreen Canvas did not properly track cross-origin tainting, which could have been used to access image data from another site in violation of same-origin policy.

##### References

* [Bug 1833876](https://bugzilla.mozilla.org/show_bug.cgi?id=1833876)

#### [#CVE-2023-4046: Incorrect value used during WASM compilation](#CVE-2023-4046)

Reporter
Alexander Guryanov
Impact
high
##### Description

In some circumstances, a stale value could have been used for a global variable in WASM JIT analysis. This resulted in incorrect compilation and a potentially exploitable crash in the content process.

##### References

* [Bug 1837686](https://bugzilla.mozilla.org/show_bug.cgi?id=1837686)

#### [#CVE-2023-4047: Potential permissions request bypass via clickjacking](#CVE-2023-4047)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1839073](https://bugzilla.mozilla.org/show_bug.cgi?id=1839073)

#### [#CVE-2023-4048: Crash in DOMParser due to out-of-memory conditions](#CVE-2023-4048)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bounds read could have led to an exploitable crash when parsing HTML with DOMParser in low memory situations.

##### References

* [Bug 1841368](https://bugzilla.mozilla.org/show_bug.cgi?id=1841368)

#### [#CVE-2023-4049: Fix potential race conditions when releasing platform objects](#CVE-2023-4049)

Reporter
Nika Layzell
Impact
high
##### Description

Race conditions in reference counting code were found through code inspection. These could have resulted in potentially exploitable use-after-free vulnerabilities.

##### References

* [Bug 1842658](https://bugzilla.mozilla.org/show_bug.cgi?id=1842658)

#### [#CVE-2023-4050: Stack buffer overflow in StorageManager](#CVE-2023-4050)

Reporter
Mark Brand
Impact
high
##### Description

In some cases, an untrusted input stream was copied to a stack buffer without checking its size. This resulted in a potentially exploitable crash which could have led to a sandbox escape.

##### References

* [Bug 1843038](https://bugzilla.mozilla.org/show_bug.cgi?id=1843038)

#### [#CVE-2023-4052: File deletion and privilege escalation through Firefox uninstaller](#CVE-2023-4052)

Reporter
ycdxsb
Impact
moderate
##### Description

The Firefox updater created a directory writable by non-privileged users. When uninstalling Firefox, any files in that directory would be recursively deleted with the permissions of the uninstalling user account. This could be combined with creation of a junction (a form of symbolic link) to allow arbitrary file deletion controlled by the non-privileged user.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1824420](https://bugzilla.mozilla.org/show_bug.cgi?id=1824420)

#### [#CVE-2023-4054: Lack of warning when opening appref-ms files](#CVE-2023-4054)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening appref-ms files, Firefox did not warn the user that these files may contain malicious code.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1840777](https://bugzilla.mozilla.org/show_bug.cgi?id=1840777)

#### [#CVE-2023-4055: Cookie jar overflow caused unexpected cookie jar state](#CVE-2023-4055)

Reporter
Marco Squarcina
Impact
low
##### Description

When the number of cookies per domain was exceeded in `document.cookie`, the actual cookie jar sent to the host was no longer consistent with expected cookie jar state. This could have caused requests to be sent with some cookies missing.

##### References

* [Bug 1782561](https://bugzilla.mozilla.org/show_bug.cgi?id=1782561)

#### [#CVE-2023-4056: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](#CVE-2023-4056)

Reporter
Dianna Smith, Ryan VanderMeulen, Timothy Nikkel, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, Firefox ESR 102.13, Thunderbird 115.0, and Thunderbird 102.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1820587%2C1824634%2C1839235%2C1842325%2C1843847)

#### [#CVE-2023-4057: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](#CVE-2023-4057)

Reporter
The Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, and Thunderbird 115.0. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](https://bugzilla.mozilla.org/show_bug.cgi?id=1841682)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_3725d6c8_20250110_162100.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-30

## Security Vulnerabilities fixed in Firefox ESR 102.14

Announced
August 1, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.14

#### [#CVE-2023-4045: Offscreen Canvas could have bypassed cross-origin restrictions](#CVE-2023-4045)

Reporter
Max Vlasov
Impact
high
##### Description

Offscreen Canvas did not properly track cross-origin tainting, which could have been used to access image data from another site in violation of same-origin policy.

##### References

* [Bug 1833876](https://bugzilla.mozilla.org/show_bug.cgi?id=1833876)

#### [#CVE-2023-4046: Incorrect value used during WASM compilation](#CVE-2023-4046)

Reporter
Alexander Guryanov
Impact
high
##### Description

In some circumstances, a stale value could have been used for a global variable in WASM JIT analysis. This resulted in incorrect compilation and a potentially exploitable crash in the content process.

##### References

* [Bug 1837686](https://bugzilla.mozilla.org/show_bug.cgi?id=1837686)

#### [#CVE-2023-4047: Potential permissions request bypass via clickjacking](#CVE-2023-4047)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1839073](https://bugzilla.mozilla.org/show_bug.cgi?id=1839073)

#### [#CVE-2023-4048: Crash in DOMParser due to out-of-memory conditions](#CVE-2023-4048)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bounds read could have led to an exploitable crash when parsing HTML with DOMParser in low memory situations.

##### References

* [Bug 1841368](https://bugzilla.mozilla.org/show_bug.cgi?id=1841368)

#### [#CVE-2023-4049: Fix potential race conditions when releasing platform objects](#CVE-2023-4049)

Reporter
Nika Layzell
Impact
high
##### Description

Race conditions in reference counting code were found through code inspection. These could have resulted in potentially exploitable use-after-free vulnerabilities.

##### References

* [Bug 1842658](https://bugzilla.mozilla.org/show_bug.cgi?id=1842658)

#### [#CVE-2023-4050: Stack buffer overflow in StorageManager](#CVE-2023-4050)

Reporter
Mark Brand
Impact
high
##### Description

In some cases, an untrusted input stream was copied to a stack buffer without checking its size. This resulted in a potentially exploitable crash which could have led to a sandbox escape.

##### References

* [Bug 1843038](https://bugzilla.mozilla.org/show_bug.cgi?id=1843038)

#### [#CVE-2023-4054: Lack of warning when opening appref-ms files](#CVE-2023-4054)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening appref-ms files, Firefox did not warn the user that these files may contain malicious code.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1840777](https://bugzilla.mozilla.org/show_bug.cgi?id=1840777)

#### [#CVE-2023-4055: Cookie jar overflow caused unexpected cookie jar state](#CVE-2023-4055)

Reporter
Marco Squarcina
Impact
low
##### Description

When the number of cookies per domain was exceeded in `document.cookie`, the actual cookie jar sent to the host was no longer consistent with expected cookie jar state. This could have caused requests to be sent with some cookies missing.

##### References

* [Bug 1782561](https://bugzilla.mozilla.org/show_bug.cgi?id=1782561)

#### [#CVE-2023-4056: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](#CVE-2023-4056)

Reporter
Dianna Smith, Ryan VanderMeulen, Timothy Nikkel, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, Firefox ESR 102.13, Thunderbird 115.0, and Thunderbird 102.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1820587%2C1824634%2C1839235%2C1842325%2C1843847)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


