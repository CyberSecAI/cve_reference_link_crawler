<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head> <title>curl - cookie for trailing dot TLD - CVE-2022-27779</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="/curl.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" href="/logo/curl-symbol.svg" type="image/svg+xml">
<link rel="alternate" type="application/rss+xml" title="cURL Releases" href="https://github.com/curl/curl/releases.atom">
<link rel="stylesheet" type="text/css" href="/manpage.css">
<style>
code {
    padding: 0px 4px 0px 4px;
    background-color: #f0f0f0;
}
 (prefers-color-scheme: dark) {
    code {
        padding: 0px 4px 0px 4px;
        background-color: #101010;
    }
}
</style>
</head>
<body>
<div class="main">
<div class="menu">
<a href="/docs/" class="menuitem" title="Documentation Overview">Docs Overview</a>
<div class="dropdown">
  <a class="dropbtn" href="/docs/projdocs.html">Project</a>
  <div class="dropdown-content">
    <a href="/docs/bugbounty.html">Bug Bounty</a>
    <a href="/docs/bugs.html">Bug Report</a>
    <a href="/docs/code-of-conduct.html">Code of conduct</a>
    <a href="/docs/libs.html">Dependencies</a>
    <a href="/donation.html">Donate</a>
    <a href="/docs/faq.html">FAQ</a>
    <a href="/docs/features.html">Features</a>
    <a href="/docs/governance.html">Governance</a>
    <a href="/docs/history.html">History</a>
    <a href="/docs/install.html">Install</a>
    <a href="/docs/knownbugs.html">Known Bugs</a>
    <a href="/logo/">Logo</a>
    <a href="/docs/todo.html">TODO</a>
    <a href="/about.html">website Info</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/protdocs.html">Protocols</a>
  <div class="dropdown-content">
    <a href="/docs/caextract.html">CA Extract</a>
    <a href="/docs/http-cookies.html">HTTP cookies</a>
    <a href="/docs/http3.html">HTTP/3</a>
    <a href="/docs/mqtt.html">MQTT</a>
    <a href="/docs/sslcerts.html">SSL certs</a>
    <a href="/docs/ssl-compared.html">SSL libs compared</a>
    <a href="/docs/url-syntax.html">URL syntax</a>
    <a href="/docs/websocket.html">WebSocket</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/reldocs.html">Releases</a>
  <div class="dropdown-content">
    <a href="/ch/">Changelog</a>
    <a href="/docs/security.html">curl CVEs</a>
    <a href="/docs/releases.html">Release Table</a>
    <a href="/docs/versions.html">Version Numbering</a>
    <a href="/docs/vulnerabilities.html">Vulnerabilities</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/tooldocs.html">Tool</a>
  <div class="dropdown-content">
    <a href="/docs/comparison-table.html">Comparison Table</a>
    <a href="/docs/manpage.html">curl man page</a>
    <a href="/docs/httpscripting.html">HTTP Scripting</a>
    <a href="/docs/mk-ca-bundle.html">mk-ca-bundle</a>
    <a href="/docs/tutorial.html">Tutorial</a>
    <a href="optionswhen.html">When options were added</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/whodocs.html">Who and Why</a>
  <div class="dropdown-content">
    <a href="/docs/companies.html">Companies</a>
    <a href="/docs/copyright.html">Copyright</a>
    <a href="/sponsors.html">Sponsors</a>
    <a href="/docs/thanks.html">Thanks</a>
    <a href="/docs/thename.html">The name</a>
  </div>
</div>
</div>
<div class="contents">
<div class="where"><a href="/">curl</a> / <a href="/docs/">Docs</a> / <a href="/docs/security.html">curl CVEs</a> / <b>cookie for trailing dot TLD</b></div>
<div class="relatedbox">
<b>Related:</b>
<br><a href="audits.html">Audits</a>
<br><a href="/docs/bugbounty.html">Bug Bounty</a>
<br><a href="/ch/">Changelog</a>
<br><a href="security.html">curl CVEs</a>
<br><a href="CVE-2022-27779.json">JSON metadata</a>
<br><a href="https://hackerone.com/reports/1553301">Original report</a>
<br><a href="/dev/vuln-disclosure.html">Vulnerability Disclosure</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<div class="relatedbox">
Awarded 2400 USD<br>
</div>
<h2>CVE-2022-27779</h2>
<h1 id="cookie-for-trailing-dot-tld">cookie for trailing dot TLD</h1>
<p>Project curl Security Advisory, May 11 2022 - <a
href="https://curl.se/docs/CVE-2022-27779.html">Permalink</a></p>
<h2 id="vulnerability">VULNERABILITY</h2>
<p>libcurl wrongly allows HTTP cookies to be set for Top Level Domains
(TLDs) if the hostname is provided with a trailing dot.</p>
<p>curl can be told to receive and send cookies when communicating using
HTTP(S). curl's "cookie engine" can be built with or without <a
href="https://publicsuffix.org/">Public Suffix List</a> awareness. If
PSL support not provided, a more rudimentary check exists to at least
prevent cookies from being set on TLDs. This check was broken if the
hostname in the URL uses a trailing dot.</p>
<p>This can allow arbitrary sites to set cookies that then would get
sent to a different and unrelated site or domain.</p>
<h2 id="info">INFO</h2>
<p>This vulnerability only exists when curl is built without <a
href="https://rockdaboot.github.io/libpsl/">libpsl</a>. Without this PSL
support built-in, curl is also destined to possibly leak cookies cross
sites simply due to how public suffixes work.</p>
<p>This flaw is similar to <a
href="https://curl.se/docs/CVE-2014-3620.html">CVE-2014-3620</a>,
although in 2014 curl did not have PSL support.</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned
the name CVE-2022-27779 to this issue.</p>
<p>CWE-201: Information Exposure Through Sent Data</p>
<p>Severity: Medium</p>
<h2 id="affected-versions">AFFECTED VERSIONS</h2>
<ul>
<li>Affected versions: curl <a href="vuln-7.82.0.html">7.82.0</a> to and including curl <a href="vuln-7.83.0.html">7.83.0</a></li>
<li>Not affected versions: curl &lt; <a href="vuln-7.82.0.html">7.82.0</a> and curl &gt;= <a href="vuln-7.83.1.html">7.83.1</a></li>
<li>Introduced-in: <a
href="https://github.com/curl/curl/commit/b27ad8e1d3e68e">https://github.com/curl/curl/commit/b27ad8e1d3e68e</a></li>
</ul>
<p>libcurl is used by many applications, but not always advertised as
such!</p>
<h2 id="solution">SOLUTION</h2>
<ul>
<li>Fixed-in: <a
href="https://github.com/curl/curl/commit/7e92d12b4e6911f">https://github.com/curl/curl/commit/7e92d12b4e6911f</a></li>
</ul>
<h2 id="recommendations">RECOMMENDATIONS</h2>
<p>A - Upgrade curl to version <a href="vuln-7.83.1.html">7.83.1</a></p>
<p>B - Apply the patch to your local version</p>
<p>C - Build libcurl with libpsl support</p>
<p>D - Do not use cookies</p>
<h2 id="timeline">TIMELINE</h2>
<p>This issue was reported to the curl project on April 28, 2022. We
contacted distros@openwall on May 5.</p>
<p>libcurl <a href="vuln-7.83.1.html">7.83.1</a> was released on May 11 2022, coordinated with the
publication of this advisory.</p>
<h2 id="credits">CREDITS</h2>
<ul>
<li>Reported-by: Axel Chong</li>
<li>Patched-by: Daniel Stenberg</li>
</ul>
<p>Thanks a lot!</p>
</div>
</div>
</body> </html>
