```text
{
  "vulnerability_details": {
    "root_cause": "The `wolfictl` tool's git functionality uses a central function `GetGitAuth` that retrieves a GitHub token from the `GITHUB_TOKEN` environment variable. This token is then used for authentication when interacting with git repositories. However, in some cases, the tool was passing this authentication without checking if the remote git repository was hosted on `github.com`.",
    "weaknesses": [
      "CWE-522",
      "CWE-668"
    ],
    "impact": "A local user's GitHub token can be leaked to non-GitHub git servers if the user executes `wolfictl check update` with a Melange configuration that includes a `git-checkout` directive referencing a non-github.com git repository or executes `wolfictl update <url>` with a non-github.com URL. The token is transmitted in the `Authorization` header of HTTP requests to the remote server.",
     "attack_vectors": [
        "Local execution of the `wolfictl check update` command with a malicious Melange configuration file.",
        "Local execution of the `wolfictl update` command with a malicious git URL as an argument."
    ],
    "required_capabilities": "The attacker must be able to control the Melange configuration files used by `wolfictl check update` or provide a git URL as an argument to `wolfictl update`. Additionally, the `GITHUB_TOKEN` environment variable must be set to a valid GitHub token during the execution of the vulnerable command."
  }
}
```