
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fissues%2F436)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fissues%2F436)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=xmldom%2Fxmldom)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xmldom](/xmldom)
/
**[xmldom](/xmldom/xmldom)**
Public

* [Notifications](/login?return_to=%2Fxmldom%2Fxmldom) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2Fxmldom%2Fxmldom)
* [Star
   370](/login?return_to=%2Fxmldom%2Fxmldom)

* [Code](/xmldom/xmldom)
* [Issues
  24](/xmldom/xmldom/issues)
* [Pull requests
  4](/xmldom/xmldom/pulls)
* [Discussions](/xmldom/xmldom/discussions)
* [Actions](/xmldom/xmldom/actions)
* [Projects
  1](/xmldom/xmldom/projects)
* [Security](/xmldom/xmldom/security)
* [Insights](/xmldom/xmldom/pulse)

Additional navigation options

* [Code](/xmldom/xmldom)
* [Issues](/xmldom/xmldom/issues)
* [Pull requests](/xmldom/xmldom/pulls)
* [Discussions](/xmldom/xmldom/discussions)
* [Actions](/xmldom/xmldom/actions)
* [Projects](/xmldom/xmldom/projects)
* [Security](/xmldom/xmldom/security)
* [Insights](/xmldom/xmldom/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fxmldom%2Fxmldom%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fxmldom%2Fxmldom%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [invalid] Prototype pollution found in dom.js #436

Closed

[secdevlpr26](/secdevlpr26) opened this issue
Oct 10, 2022
· 29 comments
 · Fixed by [#441](https://github.com/xmldom/xmldom/pull/441)

Closed

# [[invalid] Prototype pollution found in dom.js](#top) #436

[secdevlpr26](/secdevlpr26) opened this issue
Oct 10, 2022
· 29 comments
 · Fixed by [#441](https://github.com/xmldom/xmldom/pull/441)

Assignees
[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)

Labels
[invalid](/xmldom/xmldom/labels/invalid)
This doesn't seem right

Milestone
[0.9.0](/xmldom/xmldom/milestone/15 "0.9.0")

## Comments

[![@secdevlpr26](https://avatars.githubusercontent.com/u/31366114?s=80&v=4)](/secdevlpr26)

Copy link

### **[secdevlpr26](/secdevlpr26)** commented [Oct 10, 2022](#issue-1403710408)

| Prototype pollution vulnerability in function copy in dom.js in xmldom xmldom 0.6.0 via the p variable in dom.js.  The prototype pollution vulnerability can be mitigated with several best practices described here: <https://learn.snyk.io/lessons/prototype-pollution/javascript/> |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

Member

### **[karfau](/karfau)** commented [Oct 11, 2022](#issuecomment-1273953869)

| **If you find a vulnaribility, please follow the process documented in <https://github.com/xmldom/xmldom/blob/master/SECURITY.md> to disclose it properly.**  I'm not able to find any information related to the provided CVE id other then it has been reserved.  v0.6.0 contains the following vulnerabily, which has been fixed in the more recent version 0.7.0 s of the library:   * [GHSA-5fg8-2547-mr8q](https://github.com/xmldom/xmldom/security/advisories/GHSA-5fg8-2547-mr8q "GHSA-5fg8-2547-mr8q") ([CVE-2021-32796](https://github.com/advisories/GHSA-5fg8-2547-mr8q "CVE-2021-32796"))   the `latest` release of the library that has been published is 0.8.2 which fixes several other issues. Due to [#271](https://github.com/xmldom/xmldom/issues/271) the package can no longer be published under `xmldom` but is published under `@xmldom/xmldom` since 0.7.0.  Please check if the issue you are reporting is also present in a more recent version.  Closing this issue for now, feel free to provide more information in this issue or follow the steps described in <https://github.com/xmldom/xmldom/blob/master/SECURITY.md> . |
| --- |

All reactions

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
closed this as [completed](/xmldom/xmldom/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Oct 11, 2022](#event-7557979133)

[karfau](/karfau)
added a commit
that referenced
this issue
[Oct 11, 2022](#ref-commit-541e7f7)
[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)

`[fix: Avoid iterating over prototype properties](/xmldom/xmldom/commit/541e7f7510fb5eb89454d271cd89763263820a17 "fix: Avoid iterating over prototype properties

by no longer using the `in` operator.

https://github.com/xmldom/xmldom/issues/436")`
…

`[541e7f7](/xmldom/xmldom/commit/541e7f7510fb5eb89454d271cd89763263820a17)`

```
by no longer using the `in` operator.

[#436](https://github.com/xmldom/xmldom/issues/436)
```

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
mentioned this issue
[Oct 11, 2022](#ref-pullrequest-1403921917)

[fix: Avoid iterating over prototype properties
#437](/xmldom/xmldom/pull/437)
 Merged

[karfau](/karfau)
added a commit
that referenced
this issue
[Oct 11, 2022](#ref-commit-b5c1be1)
[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)

`[fix: Avoid iterating over prototype properties](/xmldom/xmldom/commit/b5c1be1a42810f7c7c3becdbaa1a93f69372645d "fix: Avoid iterating over prototype properties

by adding `hasOwnProperty` checks.

https://github.com/xmldom/xmldom/issues/436")`
…

`[b5c1be1](/xmldom/xmldom/commit/b5c1be1a42810f7c7c3becdbaa1a93f69372645d)`

```
by adding `hasOwnProperty` checks.

[#436](https://github.com/xmldom/xmldom/issues/436)
```

[karfau](/karfau)
added a commit
that referenced
this issue
[Oct 11, 2022](#ref-commit-6956ec4)
[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)

`[fix: Avoid iterating over prototype properties (](/xmldom/xmldom/commit/6956ec406fd4658dfb028a327c7a39238b24c3cd "fix: Avoid iterating over prototype properties (#437)

by adding `hasOwnProperty` checks.

https://github.com/xmldom/xmldom/issues/436")[#437](https://github.com/xmldom/xmldom/pull/437)[)](/xmldom/xmldom/commit/6956ec406fd4658dfb028a327c7a39238b24c3cd "fix: Avoid iterating over prototype properties (#437)

by adding `hasOwnProperty` checks.

https://github.com/xmldom/xmldom/issues/436")`
…

`[6956ec4](/xmldom/xmldom/commit/6956ec406fd4658dfb028a327c7a39238b24c3cd)`

```
by adding `hasOwnProperty` checks.

[#436](https://github.com/xmldom/xmldom/issues/436)
```

[karfau](/karfau)
added a commit
that referenced
this issue
[Oct 11, 2022](#ref-commit-7c0d4b7)
[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)

`[fix: Avoid iterating over prototype properties](/xmldom/xmldom/commit/7c0d4b7fbf74079060a2f135a369adeeccaf4b18 "fix: Avoid iterating over prototype properties

by adding `hasOwnProperty` checks.

https://github.com/xmldom/xmldom/issues/436")`
…

`[7c0d4b7](/xmldom/xmldom/commit/7c0d4b7fbf74079060a2f135a369adeeccaf4b18)`

```
by adding `hasOwnProperty` checks.

[#436](https://github.com/xmldom/xmldom/issues/436)
```

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
self-assigned this
[Oct 11, 2022](#event-7558545798)

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
added
[bug](/xmldom/xmldom/labels/bug)
Something isn't working
[Security](/xmldom/xmldom/labels/Security)
labels
[Oct 11, 2022](#event-7558547117)

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
added this to the [0.9.0](/xmldom/xmldom/milestone/15) milestone
[Oct 11, 2022](#event-7558547559)

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

Member

### **[karfau](/karfau)** commented [Oct 11, 2022](#issuecomment-1274064909) • edited Loading

| A [fix](#437) has been published as [0.8.3 (latest)](https://github.com/xmldom/xmldom/releases/tag/0.8.3), [0.7.6](https://github.com/xmldom/xmldom/releases/tag/0.7.6) and [0.9.0-beta.2 (next)](https://github.com/xmldom/xmldom/releases/tag/0.9.0-beta.2)  The security advisory has been published: [GHSA-9pgh-qqpf-7wqj](https://github.com/xmldom/xmldom/security/advisories/GHSA-9pgh-qqpf-7wqj "GHSA-9pgh-qqpf-7wqj") |
| --- |

All reactions

Sorry, something went wrong.

[![@jftanner](https://avatars.githubusercontent.com/u/10095474?s=80&u=85456f0444bdebb7bba3b5d78dc2a855b774490b&v=4)](/jftanner)

Copy link

### **[jftanner](/jftanner)** commented [Oct 12, 2022](#issuecomment-1276478413) • edited Loading

| Hi [@karfau](https://github.com/karfau). The [xml-encryption](https://www.npmjs.com/package/xml-encryption) and [xml-crypto](https://www.npmjs.com/package/xml-crypto) ([issue](https://github.com/yaronn/xml-crypto/issues/260)) are using `^0.7.0` for this package. Given their last update times, a new version of those packages may not be immediately forthcoming. So a fix on `0.7.x` would be greatly appreciated in the meantime!  I've created a PR that I *believe* properly backports your fix: [#441](https://github.com/xmldom/xmldom/pull/441) |
| --- |

All reactions

Sorry, something went wrong.

[![@jftanner](https://avatars.githubusercontent.com/u/10095474?s=40&u=85456f0444bdebb7bba3b5d78dc2a855b774490b&v=4)](/jftanner)
[jftanner](/jftanner)
mentioned this issue
[Oct 12, 2022](#ref-pullrequest-1406555643)

[fix: Backport PR-437 to 0.7.x branch
#441](/xmldom/xmldom/pull/441)
 Merged

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

Member

### **[karfau](/karfau)** commented [Oct 12, 2022](#issuecomment-1276515485)

| [@jftanner](https://github.com/jftanner) thanks a lot! I'm away from my computer with which I would be able to do a release until including Sunday the 16th of October. But you can be sure this will be the first thing i take care of when I'm back! |
| --- |

All reactions

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
linked a pull request
[Oct 12, 2022](#event-7574006541)
that will
close
this issue

[fix: Backport PR-437 to 0.7.x branch
#441](/xmldom/xmldom/pull/441)
 Merged

[![@jftanner](https://avatars.githubusercontent.com/u/10095474?s=80&u=85456f0444bdebb7bba3b5d78dc2a855b774490b&v=4)](/jftanner)

Copy link

### **[jftanner](/jftanner)** commented [Oct 12, 2022](#issuecomment-1276538964)

| Very happy to be of assistance! |
| --- |

All reactions

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

Member

### **[karfau](/karfau)** commented [Oct 16, 2022](#issuecomment-1280004407)

| version [0.7.6](https://github.com/xmldom/xmldom/releases/tag/0.7.6) is available |
| --- |

All reactions

Sorry, something went wrong.

[![@jftanner](https://avatars.githubusercontent.com/u/10095474?s=80&u=85456f0444bdebb7bba3b5d78dc2a855b774490b&v=4)](/jftanner)

Copy link

### **[jftanner](/jftanner)** commented [Oct 16, 2022](#issuecomment-1280004717)

| Thanks [@karfau](https://github.com/karfau)! |
| --- |

All reactions

Sorry, something went wrong.

[![@RyanCommits](https://avatars.githubusercontent.com/u/30220112?s=80&u=ef748f208fa0a1530504bc7addb3ff373e6b600d&v=4)](/RyanCommits)

Copy link

### **[RyanCommits](/RyanCommits)** commented [Oct 17, 2022](#issuecomment-1281047844)

| Looks like the problem still exists in 0.7.6 [https://security.snyk.io/package/npm/@xmldom%2Fxmldom/0.7.6](https://security.snyk.io/package/npm/%40xmldom/xmldom/0.7.6) |
| --- |

All reactions

Sorry, something went wrong.

[![@jftanner](https://avatars.githubusercontent.com/u/10095474?s=80&u=85456f0444bdebb7bba3b5d78dc2a855b774490b&v=4)](/jftanner)

Copy link

### **[jftanner](/jftanner)** commented [Oct 17, 2022](#issuecomment-1281054731) • edited Loading

| I think that's a false positive. Snyk doesn't know that 0.7.6 was a fix.  Looks like the CVE is being re-analyzed. Hopefully they'll pick up the fixed version. <https://nvd.nist.gov/vuln/detail/CVE-2022-37616> |
| --- |

All reactions

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

Member

### **[karfau](/karfau)** commented [Oct 17, 2022](#issuecomment-1281391352)

| Yes, there is a pnding PR to update the information on github side: [github/advisory-database#747](https://github.com/github/advisory-database/pull/747) |
| --- |

All reactions

Sorry, something went wrong.

[![@stephan281094](https://avatars.githubusercontent.com/u/4006802?s=40&v=4)](/stephan281094)
[stephan281094](/stephan281094)
mentioned this issue
[Oct 18, 2022](#ref-pullrequest-1413484214)

[Update dependencies
veganhacktivists/wd-player#14](/veganhacktivists/wd-player/pull/14)
 Merged

[ek2061](/ek2061)
added a commit
to hsipl/EC\_Shop-Frontend
that referenced
this issue
[Oct 23, 2022](#ref-commit-11b8316)
[![@ek2061](https://avatars.githubusercontent.com/u/15338242?s=40&u=7a33dfb207eb811474c198c0e6db0de35d27324a&v=4)](/ek2061)

`[fix(package): update msw to patch dependency security [issue](](/hsipl/EC_Shop-Frontend/commit/11b83165389a6dbbfc843715d1abd46b14aad0a9 "fix(package): update msw to patch dependency security [issue](https://github.com/xmldom/xmldom/issues/436)")[xmldom/…](https://github.com/xmldom/xmldom/issues/436)`
…

`[11b8316](/hsipl/EC_Shop-Frontend/commit/11b83165389a6dbbfc843715d1abd46b14aad0a9)`

```
[…xmldom#436](https://github.com/xmldom/xmldom/issues/436))
```

[![@jupenur](https://avatars.githubusercontent.com/u/3514914?s=80&u=1a3267864b03679006be1b8691edcb609f2a00fe&v=4)](/jupenur)

Copy link

### **[jupenur](/jupenur)** commented [Nov 1, 2022](#issuecomment-1298964496)

| [@karfau](https://github.com/karfau) I can't for the life of me figure out how [#437](https://github.com/xmldom/xmldom/pull/437) fixes a security issue. I see that the lack of `hasOwnProperty` is functionally somewhat incorrect, but not how that could be exploited in any way. Can you share any details? Is there a chance that this could actually be non-exploitable and a false positive to begin with?  Feel free to reach out to me in private if you don't want to comment in public. |
| --- |

All reactions

Sorry, something went wrong.

[![@jupenur](https://avatars.githubusercontent.com/u/3514914?s=80&u=1a3267864b03679006be1b8691edcb609f2a00fe&v=4)](/jupenur)

Copy link

### **[jupenur](/jupenur)** commented [Nov 1, 2022](#issuecomment-1298979254)

| [@karfau](https://github.com/karfau) looks like @Supraja9726 has been routinely opening issues like this in a bunch of repositories. Many of them have been closed as false positives by maintainers. Can you please confirm if you've actually been able to verify the security impact here? |
| --- |

All reactions

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

Member

### **[karfau](/karfau)** commented [Nov 1, 2022](#issuecomment-1299093536) • edited Loading

| Thx, [@jupenur](https://github.com/jupenur) for having a look.  I did not invest any time into trying to verify it (which is also not one of the things I know how to thoroughly do). Since it was announced in public I figured I find all potential cases like that in the code base and the missing checks to prevent all similar kind of issues, and publish a new version. There was also never any other response from @Supraja9726 after the initial report. |
| --- |

 👍
1
 jupenur reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@jdgregson](https://avatars.githubusercontent.com/u/3778841?s=80&u=22355dea7c49323adb8b54ea6072935d2ee0703a&v=4)](/jdgregson)

Copy link

### **[jdgregson](/jdgregson)** commented [Nov 8, 2022](#issuecomment-1307563456) • edited Loading

| After finding this same pattern in an app I am reviewing I set out to write exploit code and verify that the app was vulnerable. This pattern of `dest[attr] = src[attr]` is flagged for prototype pollution in many repositories. However, after several days I have been unable to reproduce the issue. I put together some test code to test for prototype pollution in the xmldom `copy` function, as well as the `merge` function from lodash which was supposedly vulnerable as well.  After running every payload and PoC I can find through these two functions forwards and backwards, I have not been able to pollute the prototype:  ``` function xmldomCopy(src, dest) {   for (var p in src) {     dest[p] = src[p];   } }  function lodashMerge(target, source) {   for (let attr in source) {     if (typeof(target[attr]) === 'object' && typeof(source[attr]) === 'object') {       lodashMerge(target[attr], source[attr]);     } else {       target[attr] = source[attr];     }   }   return target; }  const payloads = [   {foo: 'bar', test: {'__proto__': {'polluted': true}}},   {foo: 'bar', test: {'__proto__.polluted': true}},   {foo: 'bar', test: {'__proto__[polluted]': true}},   {foo: 'bar', __proto__: {'polluted': true}},   {foo: 'bar', '__proto__': {'polluted': true}},   {foo: 'bar', '__proto__': {'polluted': 'true'}},   {foo: 'bar', '__proto__.__proto__': {'polluted': true}},   {foo: 'bar', '__proto__.polluted': true},   {foo: 'bar', '__proto__[polluted]': true},   {foo: 'bar', '__proto__[polluted]=polluted': true},   {foo: 'bar', '{}.__proto__.polluted': true},   {foo: 'bar', 'test': {'prototype': {'polluted': true}}},   {foo: 'bar', 'test': {'proto[polluted]': {'polluted': true}}},   {foo: 'bar', 'proto[polluted]': true},   JSON.parse('{"constructor": {"prototype": {"polluted": true}}}'), ]  payloads.forEach((payload) => {   xmldomCopy(payload, {});   xmldomCopy({}, payload);   lodashMerge({}, payload);   lodashMerge(payload, {}); });  console.log('Polluted: ' + (new Object).polluted); // Polluted: undefined  ```  If anyone, including and especially the reporter could provide a working PoC affecting statements such as `dest[attr] = src[attr]` I would greatly appreciate it. The only cases I have found where `dest[attr] = src[attr]` leads to prototype pollution is when `dest` is pointing to `__proto__`, such as when `dest = dest[attr]` was executed while `attr` was `'__proto__'`. This is what happened in the flat module's `unflatten` prototype pollution case, but is not what is happening here. |
| --- |

 👍
2
 jftanner and GriffinSchneider reacted with thumbs up emoji
 🎉
1
 jftanner reacted with hooray emoji
 ❤️
2
 karfau and GriffinSchneider reacted with heart emoji

All reactions

* 👍
  2 reactions
* 🎉
  1 reaction
* ❤️
  2 reactions

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

Member

### **[karfau](/karfau)** commented [Nov 8, 2022](#issuecomment-1307592211) • edited Loading

| Thank you [@jdgregson](https://github.com/jdgregson) fro investing the time and focus. Do you suggest that I update the score of the advisory to indicate that there is no known exploit? (Update: Not sure that question makes any sense, I didn't find any related score as part of the CVSS guide.) |
| --- |

All reactions

Sorry, something went wrong.

[![@jupenur](https://avatars.githubusercontent.com/u/3514914?s=80&u=1a3267864b03679006be1b8691edcb609f2a00fe&v=4)](/jupenur)

Copy link

### **[jupenur](/jupenur)** commented [Nov 8, 2022](#issuecomment-1307600011)

| [@karfau](https://github.com/karfau) I think that would be a good idea. And possibly also asking for the CVE to be rejected by emailing GitHub's CNA at security-advisories@github.com. |
| --- |

All reactions

Sorry, something went wrong.

3 hidden items

Load more…

[![@jftanner](https://avatars.githubusercontent.com/u/10095474?s=80&u=85456f0444bdebb7bba3b5d78dc2a855b774490b&v=4)](/jftanner)

Copy link

### **[jftanner](/jftanner)** commented [Nov 8, 2022](#issuecomment-1307617855)

| The amount of time I've spent remediating this issue is exceptionally frustrating now. 😂  Thanks for your detailed analysis [@jdgregson](https://github.com/jdgregson). |
| --- |

 ❤️
1
 karfau reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
added
[invalid](/xmldom/xmldom/labels/invalid)
This doesn't seem right
and removed
[Security](/xmldom/xmldom/labels/Security)
labels
[Nov 8, 2022](#event-7765480946)

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
changed the title
~~CVE-2022-37616/ Prototype pollution found in dom.js~~
[invalid] Prototype pollution found in dom.js
[Nov 8, 2022](#event-7765484932)

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
removed
the
[bug](/xmldom/xmldom/labels/bug)
Something isn't working
label
[Nov 8, 2022](#event-7765485982)

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
mentioned this issue
[Nov 8, 2022](#ref-pullrequest-1440598725)

[[GHSA-9pgh-qqpf-7wqj] Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution') in @xmldom/xmldom and xmldom
github/advisory-database#808](/github/advisory-database/pull/808)
 Merged

[![@jdgregson](https://avatars.githubusercontent.com/u/3778841?s=80&u=22355dea7c49323adb8b54ea6072935d2ee0703a&v=4)](/jdgregson)

Copy link

### **[jdgregson](/jdgregson)** commented [Nov 8, 2022](#issuecomment-1307726280)

| There is [another answer](https://github.com/beautify-web/js-beautify/issues/2106#issuecomment-1295366484) to a report from this person showing that `dest[attr] = src[attr]` will not lead to prototype pollution.  I might go through and challenge each of this person's CVEs when I have some time. This behavior is irresponsible and harmful. |
| --- |

 ❤️
1
 karfau reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@secdevlpr26](https://avatars.githubusercontent.com/u/31366114?s=80&v=4)](/secdevlpr26)

Copy link

Author

### **[secdevlpr26](/secdevlpr26)** commented [Nov 9, 2022](#issuecomment-1308193888)

| Hello, Sorry for all the inconvenience caused. All the reports are based on the research work of my colleague (you can find her paper's link below) and I am reporting them here as per her analysis and records.  <https://dl.acm.org/doi/pdf/10.1145/3488932.3497769> - This is the published paper with the Github link to her static analysis tool. Thanks |
| --- |

 👎
1
 alex-kinokon reacted with thumbs down emoji

All reactions

* 👎
  1 reaction

Sorry, something went wrong.

[![@jdgregson](https://avatars.githubusercontent.com/u/3778841?s=80&u=22355dea7c49323adb8b54ea6072935d2ee0703a&v=4)](/jdgregson)

Copy link

### **[jdgregson](/jdgregson)** commented [Nov 9, 2022](#issuecomment-1308304657)

| Hi @Supraja9726, thanks for following up. I would be happy to read the paper and try to understand if there is a vulnerability we're missing or if this static analysis tool is finding false positives. However, the article appears to be locked behind a paywall. Is this article published publicly somewhere? |
| --- |

All reactions

Sorry, something went wrong.

[![@jupenur](https://avatars.githubusercontent.com/u/3514914?s=80&u=1a3267864b03679006be1b8691edcb609f2a00fe&v=4)](/jupenur)

Copy link

### **[jupenur](/jupenur)** commented [Nov 9, 2022](#issuecomment-1308566672)

| [@jdgregson](https://github.com/jdgregson) the PDF is available here, via Google Scholar: <http://users.encs.concordia.ca/~mmannan/publications/JS-vulnerability-aisaccs2022.pdf> |
| --- |

All reactions

Sorry, something went wrong.

[![@jwikman](https://avatars.githubusercontent.com/u/23032645?s=40&v=4)](/jwikman)
[jwikman](/jwikman)
mentioned this issue
[Nov 11, 2022](#ref-pullrequest-1431884722)

[build(deps): bump @xmldom/xmldom from 0.7.5 to 0.7.6 in /extension
jwikman/nab-al-tools#413](/jwikman/nab-al-tools/pull/413)
 Closed

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
pinned this issue
[Nov 11, 2022](#event-7793996742)

[![@robbytx](https://avatars.githubusercontent.com/u/1022789?s=40&v=4)](/robbytx)
[robbytx](/robbytx)
mentioned this issue
[Nov 15, 2022](#ref-issue-1397239832)

[[CVE-2022-37598]/ Prototype pollution found in ast.js
mishoo/UglifyJS#5699](/mishoo/UglifyJS/issues/5699)

Closed

[![@jdgregson](https://avatars.githubusercontent.com/u/3778841?s=40&u=22355dea7c49323adb8b54ea6072935d2ee0703a&v=4)](/jdgregson)
[jdgregson](/jdgregson)
mentioned this issue
[Nov 17, 2022](#ref-issue-1398256413)

[[CVE-2022-37601]/Prototype pollution found in parseQuery.js
webpack/loader-utils#212](/webpack/loader-utils/issues/212)

Closed

[![@secdevlpr26](https://avatars.githubusercontent.com/u/31366114?s=80&v=4)](/secdevlpr26)

Copy link

Author

### **[secdevlpr26](/secdevlpr26)** commented [Nov 18, 2022](#issuecomment-1319412826)

| Hello,  Please refer the below code:  ``` function xmldomCopy(src, dest) {   for (var p in src) {     dest[p] = src[p];   }   return dest; }  var payload = JSON.parse('{"__proto__": {"polluted": true}}') var new_obj = {} var new_obj = xmldomCopy(payload,new_obj); console.log(new_obj.polluted)  ```  Here, only the target object is polluted (and in several other repositories). A prototype injection/Prototype pollution is not just when global objects are polluted with recursive merge or deep cloning but also when a target object is polluted. This is still harmful in places where other objects might make use of the polluted ones. This leads to Remote code execution, DOS when affecting the existing functions like toString valueOf, etc.  This can be avoided by placing the necessary preventive measures while copying or cloning the objects. I thereby conclude that this is not a false report and advise you to kindly look into the issue.  Thanks |
| --- |

All reactions

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

Member

### **[karfau](/karfau)** commented [Nov 18, 2022](#issuecomment-1319552382)

| @Supraja9726   1. I don't think it is enough to copy some code from the repository to show that it can be misused. To prove the vulnerability this would need to be done by using the library as is, and show how to achieve what you say is possible. All the cases I found where there was a for in loop without checking the keys were in code that was not exported from the modules and was never iterating over any object created outside of this library. 2. The discussion is not about whether to "fix" it (this already took place weeks ago), but whether this can actually be exploited when using the library. |
| --- |

All reactions

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

Member

### **[karfau](/karfau)** commented [Nov 20, 2022](#issuecomment-1321093759)

| FYI: The request to mark the CVE as invalid led to the following response:  Regarding your CVE service request, logged on 2022-11-08T14:09:33, we have the following question or update:  After review we have marked the CVE record as disputed and have updated the record. Thank you for participating in the CVE Program. This request will now be closed.  Please do not hesitate to contact the CVE Team by replying to this email if you have any questions, or to provide more details. |
| --- |

All reactions

Sorry, something went wrong.

[![@mlynch](https://avatars.githubusercontent.com/u/11214?s=40&v=4)](/mlynch)
[mlynch](/mlynch)
mentioned this issue
[Nov 22, 2022](#ref-issue-1407872643)

[Security Issues on Dependency xmldom 0.7.5
ionic-team/trapeze#111](/ionic-team/trapeze/issues/111)

Closed

[![@jdgregson](https://avatars.githubusercontent.com/u/3778841?s=80&u=22355dea7c49323adb8b54ea6072935d2ee0703a&v=4)](/jdgregson)

Copy link

### **[jdgregson](/jdgregson)** commented [Nov 25, 2022](#issuecomment-1327776560) • edited Loading

| Thanks for the reply, @Supraja9726. I've given it some thought and have to reverse course. I agree that there is a security issue here, and it is not addressed by the PR that attempted to fix it.  My main misunderstanding was that prototype pollution always means that the global Object prototype was polluted, and as @Supraja9726 pointed out [here](https://github.com/xmldom/xmldom/issues/436#issuecomment-1319412826), there can be security impact if only one object is polluted via the `__proto__` attribute.  To demonstrate the issue, let's suppose a developer wants to allow users to update their profiles. To do this, they merge data sent by the user with the data they currently have stored. The developer is careful not to let users set sensitive attributes on their user object, and throws an exception if this is attempted:  ``` function xmldomCopyFixed(src, dest) {   for (var p in src) {     if (Object.prototype.hasOwnProperty.call(src, p)) {       dest[p] = src[p];     }   } }  function copyUserData(newUserData, storedUserData) {   const forbiddenKeys = ['isAdmin', 'isMod', 'hashedPassword'];   Object.keys(newUserData).forEach((key) => {     if (forbiddenKeys.indexOf(key) > -1) {       throw new Error(`Attempted to set forbidden key ${key}`);     }   });   xmldomCopyFixed(newUserData, storedUserData);   return storedUserData; }  ```  When a user attempts to explicitly set `isAdmin` to `true`, their request is rejected as designed:  ``` const userDataFromDatabase = {firstName: "John", lastName: "Doe", email: "johndoe231@example.com"}; const userDataFromPost = JSON.parse(`{"firstName": "Jon", "isAdmin": true}`); const updatedUserData = copyUserData(userDataFromPost, userDataFromDatabase); // Uncaught Error: Attempted to set forbidden key isAdmin  ```  However, if the user instead uses `"__proto__"` to set the `isAdmin` key, the request is allowed, and the resulting merged object has been polluted:  ``` const userDataFromDatabase2 = {firstName: "John", lastName: "Doe", email: "johndoe231@example.com"}; const userDataFromPost2 = JSON.parse(`{"firstName": "Jon", "__proto__": {"isAdmin": true}}`); const updatedUserData2 = copyUserData(userDataFromPost2, userDataFromDatabase2); console.log(updatedUserData2.isAdmin); // true  ```  This can lead to significant security impact in applications that use the `copy` function of `xmldom` to copy and merge objects which are sensitive and trusted. That said, I don't necessarily agree with the severity of the issue. Seems more like a high severity issue rather than critical to me. |
| --- |

All reactions

Sorry, something went wrong.

[![@jupenur](https://avatars.githubusercontent.com/u/3514914?s=80&u=1a3267864b03679006be1b8691edcb609f2a00fe&v=4)](/jupenur)

Copy link

### **[jupenur](/jupenur)** commented [Nov 25, 2022](#issuecomment-1327865690)

| This can lead to significant security impact in applications that use the copy function of xmldom to copy and merge objects which are sensitive and trusted.  How would an application use the copy function of xmldom for anything other than the very specific internal use-cases of the library itself? The copy function is not exported. |
| --- |

 👍
1
 karfau reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@skt1598](https://avatars.githubusercontent.com/u/26963023?s=40&v=4)](/skt1598)
[skt1598](/skt1598)
mentioned this issue
[Jan 16, 2023](#ref-issue-1534813679)

[xmldom Prototype Pollution
kempsteven/vue-html2pdf#161](/kempsteven/vue-html2pdf/issues/161)

Open

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this issue
[Mar 2, 2023](#ref-pullrequest-1606235582)

[Fix CVE–2022–37601
InternalBenchmarkDebricked/yarn#6](/InternalBenchmarkDebricked/yarn/pull/6)
 Open

[![@debricked-staging](https://avatars.githubusercontent.com/u/40488434?s=40&v=4)](/apps/debricked-staging)
[debricked-staging](/apps/debricked-staging)
bot
mentioned this issue
[Apr 11, 2023](#ref-pullrequest-1662627341)

[Fix CVE–2022–37601
InternalBenchmarkDebricked/angular#1](/InternalBenchmarkDebricked/angular/pull/1)
 Open

[![@louiechristie](https://avatars.githubusercontent.com/u/6807448?s=40&v=4)](/louiechristie)
[louiechristie](/louiechristie)
mentioned this issue
[Apr 26, 2023](#ref-pullrequest-1683891860)

[Bump @xmldom/xmldom from 0.7.5 to 0.7.10
louiechristie/mood-check-in#44](/louiechristie/mood-check-in/pull/44)
 Merged

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
[karfau](/karfau)
unpinned this issue
[Jun 11, 2023](#event-9494642102)

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this issue
[Sep 15, 2023](#ref-pullrequest-1898901939)

[Fix CVE–2022–37601
philipjonsen/gitlabhq#1](/philipjonsen/gitlabhq/pull/1)
 Merged

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this issue
[Nov 8, 2023](#ref-pullrequest-1982973973)

[Fix CVE–2022–37601
AnExampleCompany/Repo1#53](/AnExampleCompany/Repo1/pull/53)
 Open

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this issue
[Jan 31, 2024](#ref-pullrequest-2109607622)

[Fix CVE–2022–37601
Usman2ABN/repository-scanner#1](/Usman2ABN/repository-scanner/pull/1)
 Open

This was referenced Apr 20, 2024

[Fix CVE–2022–37601
garbsam97/tailwind#1](/garbsam97/tailwind/pull/1)
 Merged

[Fix CVE–2022–37601
garbsam97/harnesscd-example-apps#3](/garbsam97/harnesscd-example-apps/pull/3)
 Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fissues%2F436)

Assignees

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau) [karfau](/karfau)

Labels

[invalid](/xmldom/xmldom/labels/invalid)
This doesn't seem right

Projects

None yet

Milestone

 [**0.9.0**](/xmldom/xmldom/milestone/15 "0.9.0")

Development

Successfully merging a pull request may close this issue.

 [fix: Backport PR-437 to 0.7.x branch](/xmldom/xmldom/pull/441)

6 participants

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=52&v=4)](/karfau) [![@jupenur](https://avatars.githubusercontent.com/u/3514914?s=52&v=4)](/jupenur) [![@jdgregson](https://avatars.githubusercontent.com/u/3778841?s=52&v=4)](/jdgregson) [![@jftanner](https://avatars.githubusercontent.com/u/10095474?s=52&v=4)](/jftanner) [![@RyanCommits](https://avatars.githubusercontent.com/u/30220112?s=52&v=4)](/RyanCommits) [![@secdevlpr26](https://avatars.githubusercontent.com/u/31366114?s=52&v=4)](/secdevlpr26)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

