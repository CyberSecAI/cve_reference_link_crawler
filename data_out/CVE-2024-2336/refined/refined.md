Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from insufficient input sanitization and output escaping of user-supplied attributes within the Popup Maker plugin's shortcodes.

**Weaknesses/Vulnerabilities:**
- **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize user-provided input when processing shortcode attributes. This allows an attacker to inject malicious JavaScript code that is then stored in the database. When a user views a page containing the affected shortcode, the injected script is executed within their browser.
- **Improper Neutralization of Input During Web Page Generation:** The plugin does not properly encode or sanitize user-provided attributes before displaying them on a page.

**Impact of Exploitation:**
- An attacker can inject arbitrary web scripts into pages, which will execute when a user accesses the affected page.
- The injected scripts could be used to perform various malicious actions such as:
    - Stealing session cookies
    - Redirecting users to malicious websites
    - Displaying fake content
    - Defacing the website
    - Performing actions on behalf of the user

**Attack Vectors:**
- The vulnerability can be exploited through the plugin's shortcodes, which allow the inclusion of dynamic content in pages.
- Attackers inject malicious scripts into the shortcode's attributes, leveraging the lack of proper sanitization.

**Required Attacker Capabilities/Position:**
- **Authenticated Access:** The attacker needs to have an authenticated account on the WordPress site with at least "Contributor" level permissions. This level of access allows them to create and edit posts and pages where they can insert the malicious shortcodes.

**Additional Notes:**
- The vulnerability is present in all versions of the Popup Maker plugin up to and including 1.18.2.
- The vulnerability was fixed in version 1.18.3.
- The provided content includes a link to the specific code changes that fixed the vulnerability ([https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3053244%40popup-maker%2Ftrunk&old=2989642%40popup-maker%2Ftrunk&sfp_email=&sfph_mail=](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3053244%40popup-maker%2Ftrunk&old=2989642%40popup-maker%2Ftrunk&sfp_email=&sfph_mail=))
-  The fix includes changes to how the `PopupClose` shortcode handles attributes, specifically `href` attributes which were not properly escaped.