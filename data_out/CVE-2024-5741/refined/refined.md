- **Root cause of vulnerability:** An attacker with control over an agent can inject arbitrary HTML into the agent's output, which is then rendered in the inventory tree of the corresponding host within the Checkmk monitoring system.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS) vulnerability due to lack of sanitization of agent output.
- **Impact of exploitation:** An attacker can inject malicious HTML, potentially leading to the execution of arbitrary JavaScript in the context of the Checkmk web interface, which could result in session hijacking, data theft, or other malicious activities.
- **Attack vectors:** Exploiting a compromised agent to inject malicious HTML code within its output, which is then processed and displayed by the Checkmk server in the host's inventory tree.
- **Required attacker capabilities/position:** The attacker needs to have control over an agent monitored by Checkmk and that the "Do hardware/software inventory" rule is set for the compromised agent/host.