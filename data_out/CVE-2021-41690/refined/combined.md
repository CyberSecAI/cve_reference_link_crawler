=== Content from github.com_44a9f4df_20250111_073240.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDCMTK%2Fdcmtk)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDCMTK%2Fdcmtk)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=DCMTK%2Fdcmtk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DCMTK](/DCMTK)
/
**[dcmtk](/DCMTK/dcmtk)**
Public

* [Notifications](/login?return_to=%2FDCMTK%2Fdcmtk) You must be signed in to change notification settings
* [Fork
  319](/login?return_to=%2FDCMTK%2Fdcmtk)
* [Star
   760](/login?return_to=%2FDCMTK%2Fdcmtk)

Official DCMTK Github Mirror

[git.dcmtk.org/](https://git.dcmtk.org/ "https://git.dcmtk.org/")

[760
stars](/DCMTK/dcmtk/stargazers) [319
forks](/DCMTK/dcmtk/forks) [Branches](/DCMTK/dcmtk/branches) [Tags](/DCMTK/dcmtk/tags) [Activity](/DCMTK/dcmtk/activity)
 [Star](/login?return_to=%2FDCMTK%2Fdcmtk)

 [Notifications](/login?return_to=%2FDCMTK%2Fdcmtk) You must be signed in to change notification settings

* [Code](/DCMTK/dcmtk)
* [Pull requests
  12](/DCMTK/dcmtk/pulls)
* [Actions](/DCMTK/dcmtk/actions)
* [Security](/DCMTK/dcmtk/security)
* [Insights](/DCMTK/dcmtk/pulse)

Additional navigation options

* [Code](/DCMTK/dcmtk)
* [Pull requests](/DCMTK/dcmtk/pulls)
* [Actions](/DCMTK/dcmtk/actions)
* [Security](/DCMTK/dcmtk/security)
* [Insights](/DCMTK/dcmtk/pulse)

# DCMTK/dcmtk

    master[Branches](/DCMTK/dcmtk/branches)[Tags](/DCMTK/dcmtk/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[10,994 Commits](/DCMTK/dcmtk/commits/master/) | | |
| [.github/workflows](/DCMTK/dcmtk/tree/master/.github/workflows "This path skips through empty directories") | | [.github/workflows](/DCMTK/dcmtk/tree/master/.github/workflows "This path skips through empty directories") |  |  |
| [CMake](/DCMTK/dcmtk/tree/master/CMake "CMake") | | [CMake](/DCMTK/dcmtk/tree/master/CMake "CMake") |  |  |
| [config](/DCMTK/dcmtk/tree/master/config "config") | | [config](/DCMTK/dcmtk/tree/master/config "config") |  |  |
| [dcmapps](/DCMTK/dcmtk/tree/master/dcmapps "dcmapps") | | [dcmapps](/DCMTK/dcmtk/tree/master/dcmapps "dcmapps") |  |  |
| [dcmdata](/DCMTK/dcmtk/tree/master/dcmdata "dcmdata") | | [dcmdata](/DCMTK/dcmtk/tree/master/dcmdata "dcmdata") |  |  |
| [dcmect](/DCMTK/dcmtk/tree/master/dcmect "dcmect") | | [dcmect](/DCMTK/dcmtk/tree/master/dcmect "dcmect") |  |  |
| [dcmfg](/DCMTK/dcmtk/tree/master/dcmfg "dcmfg") | | [dcmfg](/DCMTK/dcmtk/tree/master/dcmfg "dcmfg") |  |  |
| [dcmimage](/DCMTK/dcmtk/tree/master/dcmimage "dcmimage") | | [dcmimage](/DCMTK/dcmtk/tree/master/dcmimage "dcmimage") |  |  |
| [dcmimgle](/DCMTK/dcmtk/tree/master/dcmimgle "dcmimgle") | | [dcmimgle](/DCMTK/dcmtk/tree/master/dcmimgle "dcmimgle") |  |  |
| [dcmiod](/DCMTK/dcmtk/tree/master/dcmiod "dcmiod") | | [dcmiod](/DCMTK/dcmtk/tree/master/dcmiod "dcmiod") |  |  |
| [dcmjpeg](/DCMTK/dcmtk/tree/master/dcmjpeg "dcmjpeg") | | [dcmjpeg](/DCMTK/dcmtk/tree/master/dcmjpeg "dcmjpeg") |  |  |
| [dcmjpls](/DCMTK/dcmtk/tree/master/dcmjpls "dcmjpls") | | [dcmjpls](/DCMTK/dcmtk/tree/master/dcmjpls "dcmjpls") |  |  |
| [dcmnet](/DCMTK/dcmtk/tree/master/dcmnet "dcmnet") | | [dcmnet](/DCMTK/dcmtk/tree/master/dcmnet "dcmnet") |  |  |
| [dcmpmap](/DCMTK/dcmtk/tree/master/dcmpmap "dcmpmap") | | [dcmpmap](/DCMTK/dcmtk/tree/master/dcmpmap "dcmpmap") |  |  |
| [dcmpstat](/DCMTK/dcmtk/tree/master/dcmpstat "dcmpstat") | | [dcmpstat](/DCMTK/dcmtk/tree/master/dcmpstat "dcmpstat") |  |  |
| [dcmqrdb](/DCMTK/dcmtk/tree/master/dcmqrdb "dcmqrdb") | | [dcmqrdb](/DCMTK/dcmtk/tree/master/dcmqrdb "dcmqrdb") |  |  |
| [dcmrt](/DCMTK/dcmtk/tree/master/dcmrt "dcmrt") | | [dcmrt](/DCMTK/dcmtk/tree/master/dcmrt "dcmrt") |  |  |
| [dcmseg](/DCMTK/dcmtk/tree/master/dcmseg "dcmseg") | | [dcmseg](/DCMTK/dcmtk/tree/master/dcmseg "dcmseg") |  |  |
| [dcmsign](/DCMTK/dcmtk/tree/master/dcmsign "dcmsign") | | [dcmsign](/DCMTK/dcmtk/tree/master/dcmsign "dcmsign") |  |  |
| [dcmsr](/DCMTK/dcmtk/tree/master/dcmsr "dcmsr") | | [dcmsr](/DCMTK/dcmtk/tree/master/dcmsr "dcmsr") |  |  |
| [dcmtls](/DCMTK/dcmtk/tree/master/dcmtls "dcmtls") | | [dcmtls](/DCMTK/dcmtk/tree/master/dcmtls "dcmtls") |  |  |
| [dcmtract](/DCMTK/dcmtk/tree/master/dcmtract "dcmtract") | | [dcmtract](/DCMTK/dcmtk/tree/master/dcmtract "dcmtract") |  |  |
| [dcmwlm](/DCMTK/dcmtk/tree/master/dcmwlm "dcmwlm") | | [dcmwlm](/DCMTK/dcmtk/tree/master/dcmwlm "dcmwlm") |  |  |
| [docs](/DCMTK/dcmtk/tree/master/docs "docs") | | [docs](/DCMTK/dcmtk/tree/master/docs "docs") |  |  |
| [doxygen](/DCMTK/dcmtk/tree/master/doxygen "doxygen") | | [doxygen](/DCMTK/dcmtk/tree/master/doxygen "doxygen") |  |  |
| [oficonv](/DCMTK/dcmtk/tree/master/oficonv "oficonv") | | [oficonv](/DCMTK/dcmtk/tree/master/oficonv "oficonv") |  |  |
| [oflog](/DCMTK/dcmtk/tree/master/oflog "oflog") | | [oflog](/DCMTK/dcmtk/tree/master/oflog "oflog") |  |  |
| [ofstd](/DCMTK/dcmtk/tree/master/ofstd "ofstd") | | [ofstd](/DCMTK/dcmtk/tree/master/ofstd "ofstd") |  |  |
| [.gitignore](/DCMTK/dcmtk/blob/master/.gitignore ".gitignore") | | [.gitignore](/DCMTK/dcmtk/blob/master/.gitignore ".gitignore") |  |  |
| [ANNOUNCE](/DCMTK/dcmtk/blob/master/ANNOUNCE "ANNOUNCE") | | [ANNOUNCE](/DCMTK/dcmtk/blob/master/ANNOUNCE "ANNOUNCE") |  |  |
| [CHANGES](/DCMTK/dcmtk/blob/master/CHANGES "CHANGES") | | [CHANGES](/DCMTK/dcmtk/blob/master/CHANGES "CHANGES") |  |  |
| [CMakeLists.txt](/DCMTK/dcmtk/blob/master/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/DCMTK/dcmtk/blob/master/CMakeLists.txt "CMakeLists.txt") |  |  |
| [CONTRIBUTING.md](/DCMTK/dcmtk/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/DCMTK/dcmtk/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [COPYRIGHT](/DCMTK/dcmtk/blob/master/COPYRIGHT "COPYRIGHT") | | [COPYRIGHT](/DCMTK/dcmtk/blob/master/COPYRIGHT "COPYRIGHT") |  |  |
| [CREDITS](/DCMTK/dcmtk/blob/master/CREDITS "CREDITS") | | [CREDITS](/DCMTK/dcmtk/blob/master/CREDITS "CREDITS") |  |  |
| [FAQ](/DCMTK/dcmtk/blob/master/FAQ "FAQ") | | [FAQ](/DCMTK/dcmtk/blob/master/FAQ "FAQ") |  |  |
| [HISTORY](/DCMTK/dcmtk/blob/master/HISTORY "HISTORY") | | [HISTORY](/DCMTK/dcmtk/blob/master/HISTORY "HISTORY") |  |  |
| [INSTALL](/DCMTK/dcmtk/blob/master/INSTALL "INSTALL") | | [INSTALL](/DCMTK/dcmtk/blob/master/INSTALL "INSTALL") |  |  |
| [Makefile](/DCMTK/dcmtk/blob/master/Makefile "Makefile") | | [Makefile](/DCMTK/dcmtk/blob/master/Makefile "Makefile") |  |  |
| [README](/DCMTK/dcmtk/blob/master/README "README") | | [README](/DCMTK/dcmtk/blob/master/README "README") |  |  |
| [README.md](/DCMTK/dcmtk/blob/master/README.md "README.md") | | [README.md](/DCMTK/dcmtk/blob/master/README.md "README.md") |  |  |
| [VERSION](/DCMTK/dcmtk/blob/master/VERSION "VERSION") | | [VERSION](/DCMTK/dcmtk/blob/master/VERSION "VERSION") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
# DCMTK

This DICOM toolkit (DCMTK) package consists of source code, documentation and installation instructions for a set of software libraries and applications implementing part of the DICOM/MEDICOM Standard.

DCMTK contains the following sub-packages, each in its own sub-directory:

* **config** - configuration utilities for DCMTK
* **dcmapps** - a collection of cross-module command line tools
* **dcmdata** - a data encoding/decoding library and utility apps
* **dcmect** - a library for working with Enhanced CT objects
* **dcmfg** - a library for working with functional groups
* **dcmimage** - adds support for color images to dcmimgle
* **dcmimgle** - an image processing library and utility apps
* **dcmiod** - a library for working with information objects and modules
* **dcmjpeg** - a compression/decompression library and utility apps
* **dcmjpls** - a compression/decompression library and utility apps
* **dcmnet** - a networking library and utility apps
* **dcmpmap** - a library for working with parametric map objects
* **dcmpstat** - a presentation state library and utility apps
* **dcmqrdb** - an image database server
* **dcmrt** - a radiation therapy library and utility apps
* **dcmseg** - a library for working with segmentation objects
* **dcmsign** - a digital signature library and utility apps
* **dcmsr** - a structured reporting library and utility apps
* **dcmtls** - security extensions for the network library
* **dcmtract** - a library for working with tractography results
* **dcmwlm** - a modality worklist database server
* **oficonv** - a character set conversion library
* **oflog** - a logging library based on log4cplus
* **ofstd** - a library of general purpose classes

Each sub-directory (except *config*) contains further sub-directories for application source code (*apps*), library source code (*libsrc*), library include files (*include*), configuration data (*etc*), documentation (*docs*), sample and support data (*data*) as well as test programs (*tests*).

To build and install the DCMTK package, see the [INSTALL](/DCMTK/dcmtk/blob/master/INSTALL) file. For copyright information, see the [COPYRIGHT](/DCMTK/dcmtk/blob/master/COPYRIGHT) file. For information about the history of this software, see the [HISTORY](/DCMTK/dcmtk/blob/master/HISTORY) file. For answers to frequently asked questions, please consult the [FAQ](https://forum.dcmtk.org/faq/).

In addition to the API documentation, which is also available [online](https://support.dcmtk.org/docs/), there is a [Wiki](https://support.dcmtk.org/wiki/) system where further information (e.g. HOWTOs) can be found.

If you find bugs or other problems with this software, we would appreciate hearing about them. Please send electronic mail to bugs@dcmtk.org. Please try to describe the problem in detail and, if possible, give a suggested fix. For more details on how to contribute, see the [CONTRIBUTING.md](/DCMTK/dcmtk/blob/master/CONTRIBUTING.md) file.

For general questions on how to compile, install or use the toolkit, we recommend the [public discussion forum](https://forum.dcmtk.org/).

## About

Official DCMTK Github Mirror

[git.dcmtk.org/](https://git.dcmtk.org/ "https://git.dcmtk.org/")

### Topics

[toolkit](/topics/toolkit "Topic: toolkit")
[dicom](/topics/dicom "Topic: dicom")
[dcmtk](/topics/dcmtk "Topic: dcmtk")
[bsd-3-clause](/topics/bsd-3-clause "Topic: bsd-3-clause")

### Resources

[Readme](#readme-ov-file)

[Activity](/DCMTK/dcmtk/activity)
[Custom properties](/DCMTK/dcmtk/custom-properties)
### Stars

[**760**
stars](/DCMTK/dcmtk/stargazers)
### Watchers

[**57**
watching](/DCMTK/dcmtk/watchers)
### Forks

[**319**
forks](/DCMTK/dcmtk/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FDCMTK%2Fdcmtk&report=DCMTK+%28user%29)

## [Releases 2](/DCMTK/dcmtk/releases)

[DCMTK-3.6.9
Latest

Dec 11, 2024](/DCMTK/dcmtk/releases/tag/DCMTK-3.6.9)
[+ 1 release](/DCMTK/dcmtk/releases)

## [Contributors 7](/DCMTK/dcmtk/graphs/contributors)

## Languages

* [C++
  50.2%](/DCMTK/dcmtk/search?l=c%2B%2B)
* [C
  46.7%](/DCMTK/dcmtk/search?l=c)
* [Roff
  2.2%](/DCMTK/dcmtk/search?l=roff)
* [CMake
  0.4%](/DCMTK/dcmtk/search?l=cmake)
* [Makefile
  0.3%](/DCMTK/dcmtk/search?l=makefile)
* [Shell
  0.2%](/DCMTK/dcmtk/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_485b22ee_20250111_073241.html ===


---

[[Date Prev](msg00021.html)][[Date Next](msg00023.html)]
[[Thread Prev](msg00021.html)][[Thread Next](msg00023.html)]
[[Date Index](maillist.html#00022)]
[[Thread Index](threads.html#00022)]

# [SECURITY] [DLA 3847-1] dcmtk security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3847-1] dcmtk security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Fri, 28 Jun 2024 21:30:13 +0300
* *Message-id*: <[[🔎]](/msgid-search/Zn8BNZMO34UHx9BV%40localhost) [Zn8BNZMO34UHx9BV@localhost](msg00022.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3847-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
June 28, 2024                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : dcmtk
Version        : 3.6.4-2.1+deb10u1
CVE ID         : CVE-2021-41687 CVE-2021-41688 CVE-2021-41689 CVE-2021-41690
                 CVE-2022-2121 CVE-2022-43272 CVE-2024-28130 CVE-2024-34508
                 CVE-2024-34509
Debian Bug     : 1014044 1027165 1070207

Multiple vulnerabilities havebenn fixed in DCMTK, a collection of
libraries and applications implementing large parts the DICOM standard
for medical images.

CVE-2021-41687

    Incorrect freeing of memory

CVE-2021-41688

    Incorrect freeing of memory

CVE-2021-41689

    NULL pointer dereference

CVE-2021-41690

    Incorrect freeing of memory

CVE-2022-2121

    NULL pointer dereference

CVE-2022-43272

    Memory leak in single process mode

CVE-2024-28130

    Segmentation faults due to incorrect typecast

CVE-2024-34508

    Segmentation fault via invalid DIMSE message

CVE-2024-34509

    Segmentation fault via invalid DIMSE message

For Debian 10 buster, these problems have been fixed in version
3.6.4-2.1+deb10u1.

We recommend that you upgrade your dcmtk packages.

For the detailed security status of dcmtk please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/dcmtk>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmZ/ASwACgkQiNJCh6LY
mLFeZw//TBpdZJ/9oACfcDvHcgIPxvbiwqDtSQHnOBAtoszcOuufm3W9asAHUyjd
wyKk4PKM3FOH+h26VOpkD5zeOWv8pxLYWwOzLz6dVMa6TFcgFVeagGdLWHLqyDW2
caCal1rmlFtFOaghGnuo6OLtAVtSVJG52QCIuNDZJBSsz9bNS7KTj/TPqK0v3KOE
AkE6ozVmSmBfmTQvWyZKGUgjKU6gnA0bqqJZHt8whlDD3MX9X+s26FJOHp5hlYKT
Kj0lsXPctT8eDwJWfZgOZC2c2i4ZMrR48XxLkiOnDsErq6RdkUvtvOh4p7MIxkVu
7sbw3hnCSaRaIUUCTd9H14EUucOfHgAS92tQFO5lzRqsJiXJ+EZSO2AsOdDwxbnD
a7/rVhfMaDxbbt8Qze9Xev65hHnJ7MKzf4L6uncaucy9Pp3p1SE/BL0pXHx+yc6p
C+I/9dc3MRtCJ8zqjXtKOiUQL/XuzFTETE9+VYRGsCDAN+2GzNSEUj33rhIa/V8a
Q3SVRCSLzXXPfRhldMmg78fWPgpapQinekr5IY0c2tEKkKtcgx0VPAJkomyBqy/i
UdrqRUo4zIk5J6h1s4MwgwWE/okLChGhbaLoDFuy8dxibUbkPTG/Gfq7vdDhydH+
UbsG1pSFast6edAKuwkwo8j+GBmpE48KSBhN2Jgc4WOzDH0I0SM=
=uvO5
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_b054cb5c_20250111_073241.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDCMTK%2Fdcmtk%2Fcommit%2Fa9697dfeb672b0b9412c00c7d36d801e27ec85cb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDCMTK%2Fdcmtk%2Fcommit%2Fa9697dfeb672b0b9412c00c7d36d801e27ec85cb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=DCMTK%2Fdcmtk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DCMTK](/DCMTK)
/
**[dcmtk](/DCMTK/dcmtk)**
Public

* [Notifications](/login?return_to=%2FDCMTK%2Fdcmtk) You must be signed in to change notification settings
* [Fork
  319](/login?return_to=%2FDCMTK%2Fdcmtk)
* [Star
   760](/login?return_to=%2FDCMTK%2Fdcmtk)

* [Code](/DCMTK/dcmtk)
* [Pull requests
  12](/DCMTK/dcmtk/pulls)
* [Actions](/DCMTK/dcmtk/actions)
* [Security](/DCMTK/dcmtk/security)
* [Insights](/DCMTK/dcmtk/pulse)

Additional navigation options

* [Code](/DCMTK/dcmtk)
* [Pull requests](/DCMTK/dcmtk/pulls)
* [Actions](/DCMTK/dcmtk/actions)
* [Security](/DCMTK/dcmtk/security)
* [Insights](/DCMTK/dcmtk/pulse)

## Commit

[Permalink](/DCMTK/dcmtk/commit/a9697dfeb672b0b9412c00c7d36d801e27ec85cb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixed poss. NULL pointer dereference/double free.

[Browse files](/DCMTK/dcmtk/tree/a9697dfeb672b0b9412c00c7d36d801e27ec85cb)
Browse the repository at this point in the history

```
Thanks to Jinsheng Ba <bajinsheng@u.nus.edu> for the report and some patches.
```

* Loading branch information

[![@michaelonken](https://avatars.githubusercontent.com/u/5758799?s=40&v=4)](/michaelonken)

[michaelonken](/DCMTK/dcmtk/commits?author=michaelonken "View all commits by michaelonken")
committed
Oct 1, 2021

1 parent
[92da003](/DCMTK/dcmtk/commit/92da003ffe1d874893252943ef5b2e4a365e8d52)

commit a9697df

 Show file tree

 Hide file tree

Showing
**13 changed files**
with
**201 additions**
and
**105 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* dcmnet

  + include/dcmtk/dcmnet

    - dcmnet/include/dcmtk/dcmnet/dulstruc.h
      [dulstruc.h](#diff-8f6d2a75b8018c4a97268b09ca81f04f8a0d68db18e48f4690d4fd620f25c003)
    - dcmnet/include/dcmtk/dcmnet/helpers.h
      [helpers.h](#diff-2c56a1b33f3a577c56859b32f3f4f8c54e1d32260544fba2546eeb525067692e)
  + libsrc

    - dcmnet/libsrc/CMakeLists.txt
      [CMakeLists.txt](#diff-41187475b3c06eefab797bb27575a794c3278d2afe2d37441cc7f7a0b6503314)
    - dcmnet/libsrc/Makefile.in
      [Makefile.in](#diff-30dbc2eda726b95efa4a498df881186c890feff65965f2992da52730ffd329a1)
    - dcmnet/libsrc/assoc.cc
      [assoc.cc](#diff-ccbd2df71cf1fcf8b7447659aa8d31ec6bce680477da95a7b45f4d106332fba3)
    - dcmnet/libsrc/dcuserid.cc
      [dcuserid.cc](#diff-bd53df822978abbbb9c5c674a478555875ec25fada7249a370ff0b9bb8cdfe96)
    - dcmnet/libsrc/dul.cc
      [dul.cc](#diff-c930c1134d736fbf6c374a5c3981694c81c7d498815363b29a78598bb6a26898)
    - dcmnet/libsrc/dulconst.cc
      [dulconst.cc](#diff-ecba05530939d75a887d703b901744b40cc41aeb7d7342688c5f90756b812164)
    - dcmnet/libsrc/dulextra.cc
      [dulextra.cc](#diff-8115110c8f2a4397f2b5c8ff6c2dce4610df1926399a29568f986985716453a3)
    - dcmnet/libsrc/dulfsm.cc
      [dulfsm.cc](#diff-266cce9db42d7e01fe1f351d6878ca5766c00a719791d5a87731f1aaf7893216)
    - dcmnet/libsrc/dulparse.cc
      [dulparse.cc](#diff-aa9d0a7124002108e9c21df96a97e1e2f59e3402429966bf1fa951edf41fc397)
    - dcmnet/libsrc/dulpres.cc
      [dulpres.cc](#diff-00fbb3449e66363abd429b0bd072c92b41868bea695b37138836cafc2b3901b7)
    - dcmnet/libsrc/helpers.cc
      [helpers.cc](#diff-ad817be2814dc748108faf9d199996ab6c9ddd59c2f881275c4409e9f0875cc8)

## There are no files selected for viewing

8 changes: 8 additions & 0 deletions

8
[dcmnet/libsrc/dulstruc.h → dcmnet/include/dcmtk/dcmnet/dulstruc.h](#diff-8f6d2a75b8018c4a97268b09ca81f04f8a0d68db18e48f4690d4fd620f25c003 "dcmnet/libsrc/dulstruc.h → dcmnet/include/dcmtk/dcmnet/dulstruc.h")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/include/dcmtk/dcmnet/dulstruc.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -71,6 +71,11 @@ |
|  |  | #include "dcmtk/config/osconfig.h" /\* make sure OS specific configuration is included first \*/ |
|  |  | #include "dcmtk/dcmnet/extneg.h" |
|  |  | #include "dcmtk/dcmnet/dcuserid.h" |
|  |  | #include "dcmtk/dcmnet/dicom.h" |
|  |  | #include "dcmtk/dcmnet/dntypes.h" |
|  |  | #include "dcmtk/dcmnet/dul.h" |
|  |  | #include "dcmtk/dcmnet/lst.h" |
|  |  |  |
|  |  |  |
|  |  | class DcmTransportConnection; |
|  |  | class DcmTransportLayer; |
| Expand Down  Expand Up | | @@ -290,6 +295,9 @@ typedef struct dul\_datapdu { |
|  |  | DUL\_PRESENTATIONDATAVALUE presentationDataValue; |
|  |  | } DUL\_DATAPDU; |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | #define DUL\_PROTOCOL (unsigned short) 0x01 |
|  |  |  |
|  |  | #define DUL\_TYPEAPPLICATIONCONTEXT (unsigned char)0x10 |
| Expand Down | |  |

38 changes: 38 additions & 0 deletions

38
[dcmnet/include/dcmtk/dcmnet/helpers.h](#diff-2c56a1b33f3a577c56859b32f3f4f8c54e1d32260544fba2546eeb525067692e "dcmnet/include/dcmtk/dcmnet/helpers.h")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/include/dcmtk/dcmnet/helpers.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,38 @@ |
|  |  | /\* |
|  |  | \* |
|  |  | \* Copyright (C) 2021, OFFIS e.V. |
|  |  | \* All rights reserved. See COPYRIGHT file for details. |
|  |  | \* |
|  |  | \* This software and supporting documentation were partly developed by |
|  |  | \* |
|  |  | \* OFFIS e.V. |
|  |  | \* R&D Division Health |
|  |  | \* Escherweg 2 |
|  |  | \* D-26121 Oldenburg, Germany |
|  |  | \* |
|  |  | \* |
|  |  | \* Module: dcmnet |
|  |  | \* |
|  |  | \* Author: Michael Onken |
|  |  | \* |
|  |  | \* Purpose: Collection of helper functions |
|  |  | \* |
|  |  | \*/ |
|  |  |  |
|  |  | #ifndef DCMHET\_HELPERS\_H |
|  |  | #define DCMHET\_HELPERS\_H |
|  |  |  |
|  |  | #include "dcmtk/ofstd/ofcond.h" |
|  |  | #include "dcmtk/dcmnet/dulstruc.h" |
|  |  |  |
|  |  | struct T\_ASC\_Parameters; |
|  |  | class LST\_HEAD; |
|  |  |  |
|  |  |  |
|  |  | void |
|  |  | destroyPresentationContextList(LST\_HEAD \*\* l); |
|  |  |  |
|  |  | void |
|  |  | destroyUserInformationLists(DUL\_USERINFO \* userInfo); |
|  |  |  |
|  |  | #endif |

1 change: 1 addition & 0 deletions

1
[dcmnet/libsrc/CMakeLists.txt](#diff-41187475b3c06eefab797bb27575a794c3278d2afe2d37441cc7f7a0b6503314 "dcmnet/libsrc/CMakeLists.txt")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/libsrc/CMakeLists.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,6 +35,7 @@ DCMTK\_ADD\_LIBRARY(dcmnet |
|  |  | dulpres.cc |
|  |  | dwrap.c |
|  |  | extneg.cc |
|  |  | helpers.cc |
|  |  | lst.cc |
|  |  | scp.cc |
|  |  | scpcfg.cc |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[dcmnet/libsrc/Makefile.in](#diff-30dbc2eda726b95efa4a498df881186c890feff65965f2992da52730ffd329a1 "dcmnet/libsrc/Makefile.in")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/libsrc/Makefile.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,7 @@ objs = assoc.o cond.o dcompat.o dimcancl.o dimcmd.o dimdump.o dimecho.o \ |
|  |  | dulfsm.o dulparse.o dulpres.o dul.o lst.o extneg.o dimget.o dcmlayer.o \ |
|  |  | dcmtrans.o dcasccfg.o dcasccff.o dccfuidh.o dccftsmp.o dccfpcmp.o \ |
|  |  | dccfrsmp.o dccfenmp.o dccfprmp.o dfindscu.o dstorscp.o dstorscu.o \ |
|  |  | dcuserid.o scu.o scp.o scpcfg.o scpthrd.o scppool.o dwrap.o |
|  |  | dcuserid.o helper.o scu.o scp.o scpcfg.o scpthrd.o scppool.o dwrap.o |
|  |  |  |
|  |  | library = libdcmnet.$(LIBEXT) |
|  |  |  |
| Expand Down | |  |

23 changes: 2 additions & 21 deletions

23
[dcmnet/libsrc/assoc.cc](#diff-ccbd2df71cf1fcf8b7447659aa8d31ec6bce680477da95a7b45f4d106332fba3 "dcmnet/libsrc/assoc.cc")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/libsrc/assoc.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -118,6 +118,7 @@ |
|  |  | #include "dcmtk/ofstd/ofconsol.h" |
|  |  | #include "dcmtk/ofstd/ofstd.h" |
|  |  | #include "dcmtk/dcmnet/dcmtrans.h" |
|  |  | #include "dcmtk/dcmnet/helpers.h" |
|  |  |  |
|  |  | /\* |
|  |  | \*\* Constant Definitions |
| Expand Down  Expand Up | | @@ -336,25 +337,6 @@ ASC\_createAssociationParameters(T\_ASC\_Parameters \*\* params, |
|  |  | return EC\_Normal; |
|  |  | } |
|  |  |  |
|  |  | static void |
|  |  | destroyPresentationContextList(LST\_HEAD \*\* lst) |
|  |  | { |
|  |  | DUL\_PRESENTATIONCONTEXT \*pc; |
|  |  | DUL\_TRANSFERSYNTAX \*ts; |
|  |  |  |
|  |  | if ((lst == NULL) || (\*lst == NULL)) |
|  |  | return; |
|  |  | while ((pc = (DUL\_PRESENTATIONCONTEXT\*) LST\_Dequeue(lst)) != NULL) { |
|  |  | if (pc->proposedTransferSyntax != NULL) { |
|  |  | while ((ts = (DUL\_TRANSFERSYNTAX\*) LST\_Dequeue(&pc->proposedTransferSyntax)) != NULL) { |
|  |  | free(ts); |
|  |  | } |
|  |  | LST\_Destroy(&pc->proposedTransferSyntax); |
|  |  | } |
|  |  | free(pc); |
|  |  | } |
|  |  | LST\_Destroy(lst); |
|  |  | } |
|  |  |  |
|  |  | OFCondition |
|  |  | ASC\_destroyAssociationParameters(T\_ASC\_Parameters \*\* params) |
| Expand Down  Expand Up | | @@ -1699,8 +1681,7 @@ ASC\_destroyAssociation(T\_ASC\_Association \*\* association) |
|  |  | } |
|  |  |  |
|  |  | if ((\*association)->params != NULL) { |
|  |  | cond = ASC\_destroyAssociationParameters(&(\*association)->params); |
|  |  | if (cond.bad()) return cond; |
|  |  | ASC\_destroyAssociationParameters(&(\*association)->params); |
|  |  | } |
|  |  |  |
|  |  | if ((\*association)->sendPDVBuffer != NULL) |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[dcmnet/libsrc/dcuserid.cc](#diff-bd53df822978abbbb9c5c674a478555875ec25fada7249a370ff0b9bb8cdfe96 "dcmnet/libsrc/dcuserid.cc")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/libsrc/dcuserid.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | /\* |
|  |  | \* |
|  |  | \* Copyright (C) 1997-2018, OFFIS e.V. |
|  |  | \* Copyright (C) 1997-2021, OFFIS e.V. |
|  |  | \* All rights reserved. See COPYRIGHT file for details. |
|  |  | \* |
|  |  | \* This software and supporting documentation were developed by |
| Expand All | | @@ -23,7 +23,7 @@ |
|  |  | #include "dcmtk/config/osconfig.h" /\* make sure OS specific configuration is included first \*/ |
|  |  | #include "dcmtk/dcmnet/dcuserid.h" |
|  |  | #include "dcmtk/dcmnet/dul.h" |
|  |  | #include "dulstruc.h" |
|  |  | #include "dcmtk/dcmnet/dulstruc.h" |
|  |  |  |
|  |  | /\* \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* \*/ |
|  |  | /\* Implementation of class UserIdentityNegotiationSubItem \*/ |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[dcmnet/libsrc/dul.cc](#diff-c930c1134d736fbf6c374a5c3981694c81c7d498815363b29a78598bb6a26898 "dcmnet/libsrc/dul.cc")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/libsrc/dul.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -125,7 +125,7 @@ END\_EXTERN\_C |
|  |  | #include "dcmtk/ofstd/ofstd.h" |
|  |  |  |
|  |  | #include "dcmtk/dcmnet/dul.h" |
|  |  | #include "dulstruc.h" |
|  |  | #include "dcmtk/dcmnet/dulstruc.h" |
|  |  | #include "dulpriv.h" |
|  |  | #include "dulfsm.h" |
|  |  | #include "dcmtk/dcmnet/dcmtrans.h" |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[dcmnet/libsrc/dulconst.cc](#diff-ecba05530939d75a887d703b901744b40cc41aeb7d7342688c5f90756b812164 "dcmnet/libsrc/dulconst.cc")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/libsrc/dulconst.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -72,7 +72,7 @@ |
|  |  | #include "dcmtk/dcmnet/diutil.h" |
|  |  | #include "dcmtk/dcmnet/lst.h" |
|  |  | #include "dcmtk/dcmnet/dul.h" |
|  |  | #include "dulstruc.h" |
|  |  | #include "dcmtk/dcmnet/dulstruc.h" |
|  |  | #include "dulpriv.h" |
|  |  | #include "dcmtk/ofstd/ofconsol.h" |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[dcmnet/libsrc/dulextra.cc](#diff-8115110c8f2a4397f2b5c8ff6c2dce4610df1926399a29568f986985716453a3 "dcmnet/libsrc/dulextra.cc")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/libsrc/dulextra.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -96,7 +96,7 @@ |
|  |  | #include "dcmtk/dcmnet/lst.h" |
|  |  | #include "dcmtk/dcmnet/cond.h" |
|  |  | #include "dcmtk/dcmnet/dul.h" |
|  |  | #include "dulstruc.h" |
|  |  | #include "dcmtk/dcmnet/dulstruc.h" |
|  |  | #include "dulpriv.h" |
|  |  | #include "dcmtk/dcmnet/dcmtrans.h" |
|  |  | #include "dcmtk/dcmnet/diutil.h" |
| Expand Down | |  |

51 changes: 2 additions & 49 deletions

51
[dcmnet/libsrc/dulfsm.cc](#diff-266cce9db42d7e01fe1f351d6878ca5766c00a719791d5a87731f1aaf7893216 "dcmnet/libsrc/dulfsm.cc")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/libsrc/dulfsm.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -105,7 +105,7 @@ END\_EXTERN\_C |
|  |  | #include "dcmtk/dcmnet/lst.h" |
|  |  | #include "dcmtk/dcmnet/cond.h" |
|  |  | #include "dcmtk/dcmnet/dul.h" |
|  |  | #include "dulstruc.h" |
|  |  | #include "dcmtk/dcmnet/dulstruc.h" |
|  |  | #include "dulpriv.h" |
|  |  | #include "dulfsm.h" |
|  |  | #include "dcmtk/ofstd/ofbmanip.h" |
| Expand All | | @@ -114,6 +114,7 @@ END\_EXTERN\_C |
|  |  | #include "dcmtk/dcmnet/dcmtrans.h" |
|  |  | #include "dcmtk/dcmnet/dcmlayer.h" |
|  |  | #include "dcmtk/dcmnet/diutil.h" |
|  |  | #include "dcmtk/dcmnet/helpers.h" |
|  |  | #include "dcmtk/ofstd/ofsockad.h" /\* for class OFSockAddr \*/ |
|  |  | #include <ctime> |
|  |  |  |
| Expand Down  Expand Up | | @@ -304,9 +305,6 @@ findPresentationCtx(LST\_HEAD \*\* lst, DUL\_PRESENTATIONCONTEXTID contextID); |
|  |  | PRV\_SCUSCPROLE \* |
|  |  | findSCUSCPRole(LST\_HEAD \*\* lst, char \*abstractSyntax); |
|  |  |  |
|  |  | void destroyPresentationContextList(LST\_HEAD \*\* l); |
|  |  | void destroyUserInformationLists(DUL\_USERINFO \* userInfo); |
|  |  |  |
|  |  | static volatile FSM\_Event\_Description Event\_Table[] = { |
|  |  | {A\_ASSOCIATE\_REQ\_LOCAL\_USER, "A-ASSOCIATE request (local user)"}, |
|  |  | {TRANS\_CONN\_CONFIRM\_LOCAL\_USER, "Transport conn confirmation (local)"}, |
| Expand Down  Expand Up | | @@ -3978,48 +3976,3 @@ findSCUSCPRole(LST\_HEAD \*\* lst, char \*abstractSyntax) |
|  |  | } |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | void |
|  |  | destroyPresentationContextList(LST\_HEAD \*\* l) |
|  |  | { |
|  |  | PRV\_PRESENTATIONCONTEXTITEM |
|  |  | \* prvCtx; |
|  |  | DUL\_SUBITEM |
|  |  | \* subItem; |
|  |  |  |
|  |  | if (\*l == NULL) |
|  |  | return; |
|  |  |  |
|  |  | prvCtx = (PRV\_PRESENTATIONCONTEXTITEM\*)LST\_Dequeue(l); |
|  |  | while (prvCtx != NULL) { |
|  |  | subItem = (DUL\_SUBITEM\*)LST\_Dequeue(&prvCtx->transferSyntaxList); |
|  |  | while (subItem != NULL) { |
|  |  | free(subItem); |
|  |  | subItem = (DUL\_SUBITEM\*)LST\_Dequeue(&prvCtx->transferSyntaxList); |
|  |  | } |
|  |  | LST\_Destroy(&prvCtx->transferSyntaxList); |
|  |  | free(prvCtx); |
|  |  | prvCtx = (PRV\_PRESENTATIONCONTEXTITEM\*)LST\_Dequeue(l); |
|  |  | } |
|  |  | LST\_Destroy(l); |
|  |  | } |
|  |  |  |
|  |  | void |
|  |  | destroyUserInformationLists(DUL\_USERINFO \* userInfo) |
|  |  | { |
|  |  | PRV\_SCUSCPROLE |
|  |  | \* role; |
|  |  |  |
|  |  | role = (PRV\_SCUSCPROLE\*)LST\_Dequeue(&userInfo->SCUSCPRoleList); |
|  |  | while (role != NULL) { |
|  |  | free(role); |
|  |  | role = (PRV\_SCUSCPROLE\*)LST\_Dequeue(&userInfo->SCUSCPRoleList); |
|  |  | } |
|  |  | LST\_Destroy(&userInfo->SCUSCPRoleList); |
|  |  |  |
|  |  | /\* extended negotiation \*/ |
|  |  | delete userInfo->extNegList; userInfo->extNegList = NULL; |
|  |  |  |
|  |  | /\* user identity negotiation \*/ |
|  |  | delete userInfo->usrIdent; userInfo->usrIdent = NULL; |
|  |  | } |

100 changes: 72 additions & 28 deletions

100
[dcmnet/libsrc/dulparse.cc](#diff-aa9d0a7124002108e9c21df96a97e1e2f59e3402429966bf1fa951edf41fc397 "dcmnet/libsrc/dulparse.cc")

Show comments

[View file](/DCMTK/dcmtk/blob/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/dcmnet/libsrc/dulparse.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -70,7 +70,8 @@ |
|  |  | #include "dcmtk/dcmnet/lst.h" |
|  |  | #include "dcmtk/dcmnet/dul.h" |
|  |  | #include "dcmtk/dcmnet/diutil.h" |
|  |  | #include "dulstruc.h" |
|  |  | #include "dcmtk/dcmnet/dulstruc.h" |
|  |  | #include "dcmtk/dcmnet/helpers.h" |
|  |  | #include "dulpriv.h" |
|  |  | #include "dcmtk/ofstd/ofconsol.h" |
|  |  |  |
| Expand Down  Expand Up | | @@ -142,9 +143,6 @@ parseAssociate(unsigned char \*buf, unsigned long pduLength, |
|  |  | \* context; |
|  |  |  |
|  |  | (void) memset(assoc, 0, sizeof(\*assoc)); |
|  |  | if ((assoc->presentationContextList = LST\_Create()) == NULL) return EC\_MemoryExhausted; |
|  |  | if ((assoc->userInfo.SCUSCPRoleList = LST\_Create()) == NULL) return EC\_MemoryExhausted; |
|  |  |  |
|  |  | // Check if the PDU actually is long enough for the fields we read |
|  |  | if (pduLength < 2 + 2 + 16 + 16 + 32) |
|  |  | return makeLengthError("associate PDU", pduLength, 2 + 2 + 16 + 16 + 32); |
| Expand Down  Expand Up | | @@ -205,6 +203,8 @@ parseAssociate(unsigned char \*buf, unsigned long pduLength, |
|  |  | << "Called AP Title: " << assoc->calledAPTitle << OFendl |
|  |  | << "Calling AP Title: " << assoc->callingAPTitle); |
|  |  | } |
|  |  | if ((assoc->presentationContextList = LST\_Create()) == NULL) return EC\_MemoryExhausted; |
|  |  | if ((assoc->userInfo.SCUSCPRoleList = LST\_Create()) == NULL) return EC\_MemoryExhausted; |
|  |  | while ((cond.good()) && (pduLength > 0)) |
|  |  | { |
|  |  | type = \*buf; |
| Expand All | | @@ -219,44 +219,80 @@ parseAssociate(unsigned char \*buf, unsigned long pduLength, |
|  |  | { |
|  |  | buf += itemLength; |
|  |  | if (!OFStandard::safeSubtract(pduLength, itemLength, pduLength)) |
|  |  | return makeUnderflowError("Application Context item", pduLength, itemLength); |
|  |  | DCMNET\_TRACE("Successfully parsed Application Context"); |
|  |  | { |
|  |  | cond = makeUnderflowError("Application Context item", pduLength, itemLength); |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | DCMNET\_TRACE("Successfully parsed Application Context"); |
|  |  | } |
|  |  | } |
|  |  | break; |
|  |  | case DUL\_TYPEPRESENTATIONCONTEXTRQ: |
|  |  | case DUL\_TYPEPRESENTATIONCONTEXTAC: |
|  |  | context = (PRV\_PRESENTATIONCONTEXTITEM\*)malloc(sizeof(PRV\_PRESENTATIONCONTEXTITEM)); |
|  |  | if (context == NULL) return EC\_MemoryExhausted; |
|  |  | (void) memset(context, 0, sizeof(\*context)); |
|  |  | cond = parsePresentationContext(type, context, buf, &itemLength, pduLength); |
|  |  | if (cond.bad()) return cond; |
|  |  | buf += itemLength; |
|  |  | if (!OFStandard::safeSubtract(pduLength, itemLength, pduLength)) |
|  |  | return makeUnderflowError("Presentation Context item", pduLength, itemLength); |
|  |  | LST\_Enqueue(&assoc->presentationContextList, (LST\_NODE\*)context); |
|  |  | DCMNET\_TRACE("Successfully parsed Presentation Context"); |
|  |  | if (context != NULL) |
|  |  | { |
|  |  | (void) memset(context, 0, sizeof(\*context)); |
|  |  | cond = parsePresentationContext(type, context, buf, &itemLength, pduLength); |
|  |  | if (cond.bad()) |
|  |  | { |
|  |  | free(context); |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | buf += itemLength; |
|  |  | if (!OFStandard::safeSubtract(pduLength, itemLength, pduLength)) |
|  |  | { |
|  |  | cond = makeUnderflowError("Presentation Context item", pduLength, itemLength); |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | LST\_Enqueue(&assoc->presentationContextList, (LST\_NODE\*)context); |
|  |  | DCMNET\_TRACE("Successfully parsed Presentation Context"); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | cond = EC\_MemoryExhausted; |
|  |  | } |
|  |  | break; |
|  |  | case DUL\_TYPEUSERINFO: |
|  |  | // parse user info, which can contain several sub-items like User |
|  |  | // Identity Negotiation or SOP Class Extended Negotiation |
|  |  | cond = parseUserInfo(&assoc->userInfo, buf, &itemLength, assoc->type, pduLength); |
|  |  | if (cond.bad()) |
|  |  | return cond; |
|  |  | buf += itemLength; |
|  |  | if (!OFStandard::safeSubtract(pduLength, itemLength, pduLength)) |
|  |  | return makeUnderflowError("User Information item", pduLength, itemLength); |
|  |  | DCMNET\_TRACE("Successfully parsed User Information"); |
|  |  | if (cond.good()) |
|  |  | { |
|  |  | buf += itemLength; |
|  |  | if (!OFStandard::safeSubtract(pduLength, itemLength, pduLength)) |
|  |  | { |
|  |  | cond = makeUnderflowError("User Information item", pduLength, itemLength); |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | DCMNET\_TRACE("Successfully parsed User Information"); |
|  |  | } |
|  |  | } |
|  |  | break; |
|  |  | default: |
|  |  | cond = parseDummy(buf, &itemLength, pduLength); |
|  |  | if (cond.bad()) |
|  |  | return cond; |
|  |  | buf += itemLength; |
|  |  | if (!OFStandard::safeSubtract(pduLength, itemLength, pduLength)) |
|  |  | return makeUnderflowError("unknown item type", pduLength, itemLength); |
|  |  | if (cond.good()) |
|  |  | { |
|  |  | buf += itemLength; |
|  |  | if (!OFStandard::safeSubtract(pduLength, itemLength, pduLength)) |
|  |  | { |
|  |  | cond = makeUnderflowError("unknown item type", pduLength, itemLength); |
|  |  | } |
|  |  | } |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | if (cond.bad()) |
|  |  | { |
|  |  | destroyPresentationContextList(&assoc->presentationContextList); |
|  |  | destroyUserInformationLists(&assoc->userInfo); |
|  |  | } |
|  |  | return cond; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -404,7 +440,11 @@ parsePresentationContext(unsigned char type, |
|  |  | subItem = (DUL\_SUBITEM\*)malloc(sizeof(DUL\_SUBITEM)); |
|  |  | if (subItem == NULL) return EC\_MemoryExhausted; |
|  |  | cond = parseSubItem(subItem, buf, &length, presentationLength); |
|  |  | if (cond.bad()) return cond; |
|  |  | if (cond.bad()) |
|  |  | { |
|  |  | free(subItem); |
|  |  | return cond; |
|  |  | } |
|  |  | LST\_Enqueue(&context->transferSyntaxList, (LST\_NODE\*)subItem); |
|  |  | buf += length; |
|  |  | if (!OFStandard::safeSubtract(presentationLength, length, presentationLength)) |
| Expand Down  Expand Up | | @@ -525,7 +565,11 @@ parseUserInfo(DUL\_USERINFO \* userInfo, |
|  |  | role = (PRV\_SCUSCPROLE\*)malloc(sizeof(PRV\_SCUSCPROLE)); |
|  |  | if (role == NULL) return EC\_MemoryExhausted; |
|  |  | cond = parseSCUSCPRole(role, buf, &length, userLength); |
|  |  | if (cond.bad()) return cond; |
|  |  | if (cond.bad()) |
|  |  | { |
|  |  | free(role); |
|  |  | return cond; |
|  |  | } |
|  |  | LST\_Enqueue(&userInfo->SCUSCPRoleList, (LST\_NODE\*)role); |
|  |  | buf += length; |
|  |  | if (!OFStandard::safeSubtract(userLength, OFstatic\_cast(short unsigned int, length), userLength)) |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a9697df`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDCMTK%2Fdcmtk%2Fcommit%2Fa9697dfeb672b0b9412c00c7d36d801e27ec85cb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


