Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
- The vulnerability lies in the `nghttp2` library's handling of `RST_STREAM` and `GOAWAY` frames in HTTP/2 connections. Specifically, when a `RST_STREAM` frame is received followed by a `GOAWAY` frame, the cleanup of pending requests and their associated data structures is not performed correctly.

**Weaknesses/vulnerabilities present:**
- **Memory Leak:** When `GOAWAY` is received after `RST_STREAM` the code path skips de-allocation of a header map and bookkeeping structures. This results in a memory leak within the `nghttp2` library. The error return code path in `nghttp2_session.c` at line 3346 prevents the necessary cleanup code from executing.

**Impact of exploitation:**
- **Denial of Service (DoS):** Repeatedly triggering this memory leak can lead to memory exhaustion, eventually causing the affected service (Envoy) to terminate.

**Attack vectors:**
- **Malicious Upstream Service:** The vulnerability is triggered by a specifically crafted response from an untrusted upstream service.
- The attacker needs to be able to send HTTP/2 responses to the vulnerable application (Envoy in this case).

**Required attacker capabilities/position:**
- The attacker needs to control an upstream server that communicates with the vulnerable service via HTTP/2.
- The attacker can send a stream of requests, then send a `RST_STREAM` frame for a request, immediately followed by a `GOAWAY` frame with max stream ID set to 0.

**Additional Details:**
- The vulnerable code is in `nghttp2_session.c` and the `submit_headers_shared` function within `nghttp2_submit.c` will show increased memory consumption in memory profiles.
- The vulnerability is triggered when `nghttp2` enters an error handling branch due to the connection being marked to not send any more requests.
- The issue occurs because the clean-up code for the outbound request is located after a return statement in the error handling branch
- The vulnerability is present in Envoy versions prior to 1.27.0, and has been fixed in versions 1.26.3, 1.25.8, 1.24.9 and 1.23.11.
- The CVE ID associated with this vulnerability is CVE-2023-35945.