### CVE-2024-6589

**Root cause of vulnerability:**
The vulnerability stems from the `render_content_block_template` function in the LearnPress plugin, which is susceptible to Local File Inclusion (LFI). The function improperly handles the `template` attribute, allowing for the inclusion of arbitrary files from the server.

**Weaknesses/vulnerabilities present:**
- Local File Inclusion (LFI): The plugin does not properly validate or sanitize the `template` attribute, leading to LFI.
- Improper control of filename for include/require statement in PHP.

**Impact of exploitation:**
- Arbitrary file inclusion and execution: Attackers can include and execute arbitrary files on the server.
- PHP code execution: By including files containing PHP code, attackers can execute arbitrary code.
- Bypassing access controls: Attackers can bypass access controls.
- Sensitive data disclosure: Sensitive information can be obtained by including specific files.
- Code execution: If an attacker can upload a malicious file, this can be included to achieve code execution.

**Attack vectors:**
- The vulnerability is triggered via the `render_content_block_template` function.
- The attacker needs to be authenticated with Contributor level access or above to exploit this vulnerability.

**Required attacker capabilities/position:**
- Authenticated attacker: The attacker needs to have at least Contributor-level access to the WordPress site.
- Network access: The attacker needs to be able to send requests to the WordPress site.
- Ability to upload "safe" files: The attacker needs to be able to upload files that can be included such as images, etc, in order to achieve code execution.