```
{
  "vulnerability_details": {
    "root_cause": "Integer overflow in the calculation of the buffer size for a DataBuf object.",
    "weaknesses": [
      "Uncontrolled memory allocation due to missing input sanitization and integer overflow.",
      "Lack of proper bounds checking."
    ],
    "impact": "Program crash due to excessive memory allocation, leading to a denial of service. The ASAN logs indicate a crash due to a very large allocation request, specifically `0xffffffffffffffff` bytes.",
    "attack_vectors": "Crafted image files with malicious metadata values. The vulnerability is triggered by providing a large `subBox.length` value that causes an integer overflow when subtracting `sizeof(box)` before the allocation.",
    "required_attacker_capabilities": "Ability to provide a specially crafted image file to the application using the Exiv2 library. No specific position is required."
  },
  "affected_packages": [
    {
      "package": "media-gfx/exiv2",
      "affected_versions": "< 0.28.1",
      "unaffected_versions": ">= 0.28.1"
    }
  ],
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2020-18899",
    "https://github.com/Exiv2/exiv2/issues/742",
    "https://github.com/Exiv2/exiv2/pull/753"
  ]
}
```