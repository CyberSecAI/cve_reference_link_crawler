





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Asset Proxy Bypass using non-ASCII character in asset URI (#419213) · Issues · GitLab.org / GitLab · GitLab</title>
<script nonce="xfGkNGE3FREfNtj8W5uRBw==">
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.com/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.analytics_url="https://collector.prd-278964.gl-product-analytics.com";gon.analytics_id="715db59f-f350-4bfd-aef8-e7a7f0c023f0";gon.sentry_dsn="https://f5573e26de8f4293b285e556c35dfd6e@new-sentry.gitlab.net/4";gon.sentry_environment="gprd";gon.sentry_clientside_traces_sample_rate=0.05;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LfAERQTAAAAAL4GYSiAMGLbcLyUIBSfPrDNJgeC";gon.gitlab_url="https://gitlab.com";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="16eb3cf9b58";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-bd26211944b9d072037ec97cb138f1a52cd03ef185cd38b8d1fcc963245199a1.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=true;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"duoChatDynamicDimension":false,"advancedContextResolver":true,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":true,"workItemsBeta":true,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"okrsMvc":false,"workItemEpics":true};gon.roadmap_epics_limit=1000;gon.subscriptions_url="https://customers.gitlab.com";gon.subscriptions_legacy_sign_in_url="https://customers.gitlab.com/customers/sign_in?legacy=true";gon.billing_accounts_url="https://customers.gitlab.com/billing_accounts";gon.payment_form_url="https://customers.gitlab.com/payment_forms/cc_validation";gon.payment_validation_form_id="payment_method_validation";gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="xfGkNGE3FREfNtj8W5uRBw==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/gitlab-org/gitlab/-/issues/419213/related_branches":{},"/gitlab-org/gitlab/-/issues/419213/discussions.json?per_page=20":{},"/gitlab-org/gitlab/-/issues/419213.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"419213","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"419213"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"hVBizQKznARgV_xkPh2hO160lWeccXahILM469TwyD5HCzshQirS9l6IVb81s4ngWgwTfkPc955XEGWyd6up3w","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" />
<link rel="stylesheet" href="/assets/tailwind-6c5813e8879a33c27249cb9a52f31d2bbf48601dc2f8913e018566151f1a9c2f.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.41c18450.bundle.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/main.711a3a6f.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/tracker.37d73316.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/analytics.c1bb2d5a.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script nonce="xfGkNGE3FREfNtj8W5uRBw==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JH9B20VNS7G9JWWG83Z3ZG2W","plan":"gold","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":9970,"project_id":278964,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-cny-webservice-web-76b9f579f6-dntb2","instance_version":"17.8.0","context_generated_at":"2025-01-11T00:08:40.304Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace9970/project278964/-/issues/419213";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" as="style" type="text/css" nonce="V7p8omIGqA2upXiIQhwDGw==">
<link rel="preload" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" as="style" type="text/css" nonce="V7p8omIGqA2upXiIQhwDGw==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="V7p8omIGqA2upXiIQhwDGw==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="V7p8omIGqA2upXiIQhwDGw==">



<script src="/assets/webpack/sentry.9e3f0408.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>

<script src="/assets/webpack/10.983bd1ac.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/13.4882db81.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/14.3d336eee.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ec7189d6.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.ddad2718.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.62f44622.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/super_sidebar.b6b24a2c.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-68d77824.0b1a923a.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>
<script src="/assets/webpack/pages.projects.issues.show.99433ee7.chunk.js" defer="defer" nonce="xfGkNGE3FREfNtj8W5uRBw=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Asset Proxy Bypass using non-ASCII character in asset URI (#419213) · Issues · GitLab.org / GitLab · GitLab" property="og:title">
<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/gitlab-org/gitlab/-/issues/419213" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Asset Proxy Bypass using non-ASCII character in asset URI (#419213) · Issues · GitLab.org / GitLab · GitLab" property="twitter:title">
<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab SecurityBot"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Dominic Couture">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="i9QSZuRfjRtUc6h1GDA9d0dOntCrSVU7GVMJ5c9yPrxJj0uKpMbD6WqsAa4TnhWsQ_YYyXTk1ARu8FS8bClfXQ" />
<meta name="csp-nonce" content="xfGkNGE3FREfNtj8W5uRBw==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" id="favicon" data-original-href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="⚠ Please read the process on how to fix security issues before starting to work on the issue. Vulnerabilities must be..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="gitlab-org" data-group-full-path="gitlab-org" data-namespace-id="9970" data-page="projects:issues:show" data-page-type-id="419213" data-project="gitlab" data-project-full-path="gitlab-org/gitlab" data-project-id="278964">
<script nonce="xfGkNGE3FREfNtj8W5uRBw==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/gitlab-org/gitlab/-/autocomplete_sources/epics","iterations":"/gitlab-org/gitlab/-/autocomplete_sources/iterations","vulnerabilities":"/gitlab-org/gitlab/-/autocomplete_sources/vulnerabilities","members":"/gitlab-org/gitlab/-/autocomplete_sources/members?type=Issue\u0026type_id=419213","issues":"/gitlab-org/gitlab/-/autocomplete_sources/issues","mergeRequests":"/gitlab-org/gitlab/-/autocomplete_sources/merge_requests","labels":"/gitlab-org/gitlab/-/autocomplete_sources/labels?type=Issue\u0026type_id=419213","milestones":"/gitlab-org/gitlab/-/autocomplete_sources/milestones","commands":"/gitlab-org/gitlab/-/autocomplete_sources/commands?type=Issue\u0026type_id=419213","snippets":"/gitlab-org/gitlab/-/autocomplete_sources/snippets","contacts":"/gitlab-org/gitlab/-/autocomplete_sources/contacts?type=Issue\u0026type_id=419213","wikis":null};


//]]>
</script>
<script nonce="xfGkNGE3FREfNtj8W5uRBw==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a><a class="gl-badge badge badge-pill badge-success canary-badge" data-testid="canary_badge_link" href="https://next.gitlab.com" rel="noopener noreferrer" target="_blank"><span class="gl-badge-content">Next
</span></a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/gitlab-org/gitlab/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/gitlab-org/gitlab/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;GitLab&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;,&quot;entity_id&quot;:278964,&quot;link&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;packages_registry&quot;,&quot;title&quot;:&quot;Package Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/packages&quot;,&quot;link_classes&quot;:&quot;shortcuts-container-registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;infrastructure_registry&quot;,&quot;title&quot;:&quot;Terraform modules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/terraform_module_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:9970,&quot;name&quot;:&quot;GitLab.org&quot;,&quot;full_name&quot;:&quot;GitLab.org&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/gitlab-org/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/gitlab-org/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:278964,&quot;name&quot;:&quot;GitLab&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GitLab.org","item":"https://gitlab.com/gitlab-org"},{"@type":"ListItem","position":2,"name":"GitLab","item":"https://gitlab.com/gitlab-org/gitlab"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/gitlab-org/gitlab/-/issues"},{"@type":"ListItem","position":4,"name":"#419213","item":"https://gitlab.com/gitlab-org/gitlab/-/issues/419213"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GitLab.org&quot;,&quot;href&quot;:&quot;/gitlab-org&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/9970/project_avatar.png&quot;},{&quot;text&quot;:&quot;GitLab&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#419213&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues/419213&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/419213&quot;,&quot;new_issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/new?add_related_issue=419213&quot;,&quot;project_path&quot;:&quot;gitlab-org/gitlab&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2741139,&quot;reported_from_url&quot;:&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/419213&quot;,&quot;submit_as_spam_path&quot;:&quot;/gitlab-org/gitlab/-/issues/419213/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/419213&quot;,&quot;updateEndpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/419213.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#419213&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=419213\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:1,&quot;issuableTemplateNamesPath&quot;:&quot;/gitlab-org/gitlab/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Asset Proxy Bypass using non-ASCII character in asset URI&quot;,&quot;initialTitleText&quot;:&quot;Asset Proxy Bypass using non-ASCII character in asset URI&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:247\&quot; dir=\&quot;auto\&quot;\u003e\u003cgl-emoji title=\&quot;warning sign\&quot; data-name=\&quot;warning\&quot; data-unicode-version=\&quot;4.0\&quot;\u003e⚠\u003c/gl-emoji\u003e \u003cstrong data-sourcepos=\&quot;1:11-1:247\&quot;\u003ePlease read \u003ca data-sourcepos=\&quot;1:25-1:125\&quot; href=\&quot;https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md\&quot;\u003ethe process\u003c/a\u003e on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:123\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;3:1-3:70\&quot;\u003e\u003ca data-sourcepos=\&quot;3:3-3:68\&quot; href=\&quot;https://hackerone.com/reports/2071411\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHackerOne report #2071411\u003c/a\u003e\u003c/strong\u003e by \u003ccode data-sourcepos=\&quot;3:76-3:84\&quot;\u003eafewgoats\u003c/code\u003e on 2023-07-16, assigned to \u003ca href=\&quot;/nmalcolm\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;9820844\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Nick Malcolm\&quot;\u003e@nmalcolm\u003c/a\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:1-5:87\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;5:1-5:17\&quot; href=\&quot;#report\&quot;\u003eReport\u003c/a\u003e | \u003ca data-sourcepos=\&quot;5:21-5:47\&quot; href=\&quot;#attachments\&quot;\u003eAttachments\u003c/a\u003e | \u003ca data-sourcepos=\&quot;5:51-5:87\&quot; href=\&quot;#how-to-reproduce\&quot;\u003eHow To Reproduce\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;7:1-7:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-report\&quot; class=\&quot;anchor\&quot; href=\&quot;#report\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eReport\u003c/h2\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;9:1-9:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSummary\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;11:1-11:134\&quot; dir=\&quot;auto\&quot;\u003eGitlab EE has an \u003ca data-sourcepos=\&quot;11:18-11:87\&quot; href=\&quot;https://docs.gitlab.com/ee/security/asset_proxy.html\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eAsset Proxying\u003c/a\u003e feature. This feature is active on gitlab.com.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;13:1-13:264\&quot; dir=\&quot;auto\&quot;\u003eWithout this feature, attackers can steal a user’s IP address by referencing images in issues and comments that the victim browses. The image hosting server can also see referer headers identifying the Gitlab instance and the user&#39;s cookies for that remote site.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;15:1-15:192\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;15:1-15:168\&quot; href=\&quot;https://gitlab.com/gitlab-org/gitlab/-/blob/1cec76cb4d2beed789dcc4c6c61ef09d33a7ec97/lib/banzai/filter/asset_proxy_filter.rb#L23-L27\&quot;\u003eBanzai::Filter::AssetProxyFilter\u003c/a\u003e has the following code:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;17:1-25:3\&quot; data-canonical-lang=\&quot;rb\&quot; class=\&quot;code highlight js-syntax-highlight language-ruby\&quot; lang=\&quot;ruby\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e          \u003cspan class=\&quot;k\&quot;\u003ebegin\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e            \u003cspan class=\&quot;n\&quot;\u003euri\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;no\&quot;\u003eURI\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003eparse\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eoriginal_src\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e          \u003cspan class=\&quot;k\&quot;\u003erescue\u003c/span\u003e \u003cspan class=\&quot;no\&quot;\u003eStandardError\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e            \u003cspan class=\&quot;k\&quot;\u003enext\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e          \u003cspan class=\&quot;k\&quot;\u003eend\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e          \u003cspan class=\&quot;o\&quot;\u003e...\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;ruby\&quot;\u003e          \u003cspan class=\&quot;n\&quot;\u003eelement\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;s1\&quot;\u003e&#39;src&#39;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e]\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003easset_proxy_url\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eoriginal_src\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;27:1-27:318\&quot; dir=\&quot;auto\&quot;\u003eWhich states that if \u003ccode data-sourcepos=\&quot;27:23-27:31\&quot;\u003eURI.parse\u003c/code\u003e raises an exception, we do not proxy the URL but use it as-is (\u003ccode data-sourcepos=\&quot;27:98-27:101\&quot;\u003enext\u003c/code\u003e). This is a fail-open check that is easy to satisfy with a valid URL. \u003ccode data-sourcepos=\&quot;27:175-27:183\&quot;\u003eURI.parse\u003c/code\u003e is much stricter than \u003ccode data-sourcepos=\&quot;27:209-27:230\&quot;\u003eAddressable::URI.parse\u003c/code\u003e. \u003ccode data-sourcepos=\&quot;27:235-27:243\&quot;\u003eURI.parse\u003c/code\u003e raises an exception on any URI containing a non-ASCII character anywhere.\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;29:1-42:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026gt; URI.parse(\&quot;https://example.com/x?$\&quot;)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e=\u0026gt; #\u0026lt;URI::HTTPS https://example.com/x?$\u0026gt;  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026gt; URI.parse(\&quot;https://example.com/x?`\&quot;)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e=\u0026gt; #\u0026lt;URI::HTTPS https://example.com/x?%60\u0026gt;  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026gt; URI.parse(\&quot;https://example.com/x?¬\&quot;)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://example.com/x?\\u00AC\&quot; (URI::InvalidURIError)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026gt; URI.parse(\&quot;https://example.com/x#£\&quot;)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://example.com/x#\\u00A3\&quot; (URI::InvalidURIError)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026gt; URI.parse(\&quot;https://example.com/笨蛋\&quot;)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://example.com/\\u7B28\\u86CB\&quot; (URI::InvalidURIError)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026gt; URI.parse(\&quot;https://㏊ckerone.com/\&quot;)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://\\u33CAckerone.com/\&quot; (URI::InvalidURIError)  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;44:1-45:149\&quot; dir=\&quot;auto\&quot;\u003eWhen adding an image using the \u003ccode data-sourcepos=\&quot;44:33-44:37\&quot;\u003e![]()\u003c/code\u003e markdown tags, the URL appears to be URL-encoded before hitting \u003ccode data-sourcepos=\&quot;44:105-44:120\&quot;\u003eAssetProxyFilter\u003c/code\u003e, so there is no bypass.\u003cbr data-sourcepos=\&quot;44:148-44:148\&quot;\u003e\u0026#x000A;When adding an image using \u003ccode data-sourcepos=\&quot;45:29-45:33\&quot;\u003e\u0026lt;img\u0026gt;\u003c/code\u003e HTML tags, however, the URL appears to go directly to \u003ccode data-sourcepos=\&quot;45:91-45:106\&quot;\u003eAssetProxyFilter\u003c/code\u003e, allowing the asset proxy to be bypassed.\u003c/p\u003e\u0026#x000A;\u003cdetails\u003e\u0026#x000A;\u003csummary\u003eClick to expand original H1 report, which includes steps to reproduce locally\u003c/summary\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;50:1-50:25\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h5\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;52:1-54:0\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;52:1-52:275\&quot;\u003eTurn on Asset Proxying by making the curl request at \u003ca href=\&quot;https://docs.gitlab.com/ee/security/asset_proxy.html\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://docs.gitlab.com/ee/security/asset_proxy.html\u003c/a\u003e). Installing camo is not required here, we just need Gitlab to rewrite images sources to some domain. Alternatively, just use gitlab.com as that has asset proxying.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;53:1-54:0\&quot;\u003eWrite markdown somewhere in Gitlab e.g. an issue comment. The following 3 markdown images load (or fail to load) via the asset proxy. Verify that they do not load directly from giphy.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;55:1-59:3\&quot; data-canonical-lang=\&quot;md\&quot; class=\&quot;code highlight js-syntax-highlight language-markdown\&quot; lang=\&quot;markdown\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;markdown\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e![\u003c/span\u003e\u003cspan class=\&quot;nv\&quot;\u003emarkdown image\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e](\u003c/span\u003e\u003cspan class=\&quot;sx\&quot;\u003ehttps://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;markdown\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e![\u003c/span\u003e\u003cspan class=\&quot;nv\&quot;\u003emarkdown image with non-ascii character\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e](\u003c/span\u003e\u003cspan class=\&quot;sx\&quot;\u003ehttps://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;markdown\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026lt;img\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003esrc=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003ealt=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;html image\&quot;\u003c/span\u003e \u003cspan class=\&quot;nt\&quot;\u003e/\u0026gt;\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;61:1-62:0\&quot; start=\&quot;3\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;61:1-62:0\&quot;\u003eNow try the following Markdown to bypass the asset proxy: an IMG tag where the URL contains a non-ASCII character \u003ccode data-sourcepos=\&quot;61:119-61:120\&quot;\u003e¬\u003c/code\u003e.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;63:1-65:5\&quot; data-canonical-lang=\&quot;md\&quot; class=\&quot;code highlight js-syntax-highlight language-markdown\&quot; lang=\&quot;markdown\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;markdown\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026lt;img\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003esrc=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003ealt=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;html image with non-ASCII character\&quot;\u003c/span\u003e \u003cspan class=\&quot;nt\&quot;\u003e/\u0026gt;\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;66:1-66:58\&quot;\u003eThe browser loads the URL directly from the remote server.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;68:1-68:48\&quot;\u003eThe request (view it in dev tools or a proxy):\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;69:1-72:0\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;69:1-69:37\&quot;\u003eWill reveal the user&#39;s IP address\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;70:1-70:61\&quot;\u003eContains a referer header identifying the Gitlab instance\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;71:1-72:0\&quot;\u003eContains cookies for the remote URL, identifying me to the remote server if I have cookies for it. As I have visited giphy.com, it sent \u003ccode data-sourcepos=\&quot;71:140-71:197\&quot;\u003edidomi_accept_cookie=1; euconsent-v2=...; didomi_token=...\u003c/code\u003e. If the image URL was Google, then Google cookies would be sent along with the request to Google (this was tested in Chrome).\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;73:1-73:75\&quot;\u003eNote that gitlab.com CSP allows all remote images \u003ccode data-sourcepos=\&quot;73:52-73:73\&quot;\u003eimg-src * data: blob:;\u003c/code\u003e.\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;75:1-75:13\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;77:1-77:316\&quot;\u003eThe Asset Proxy is a privacy and security feature to prevent visitors to pages on the Gitlab instance from being tracked by malicious users and malicious remote servers. This bug allows a malicious user to bypass this feature and add non-proxied image tags wherever markdown is accepted on Gitlab and track visitors.\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;79:1-79:42\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-current-bug-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-current-bug-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the current \u003cem data-sourcepos=\&quot;79:28-79:32\&quot;\u003ebug\u003c/em\u003e behavior?\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;81:1-81:119\&quot;\u003eEntering \u003ccode data-sourcepos=\&quot;81:11-81:59\&quot;\u003e\u0026lt;img src=\&quot;https://url-containing-non-ascii/£\&quot; /\u0026gt;\u003c/code\u003e in a Markdown field results in Asset Proxy being bypassed.\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;83:1-85:3\&quot; data-canonical-lang=\&quot;html\&quot; class=\&quot;code highlight js-syntax-highlight language-html\&quot; lang=\&quot;html\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;html\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003eclass=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;no-attachment-icon\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003ehref=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?%C2%AC\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003etarget=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;_blank\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003erel=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;nofollow noreferrer noopener\&quot;\u003c/span\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026gt;\u0026lt;img\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003esrc=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003ealt=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;x\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003edecoding=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;async\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003eclass=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;lazy\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003edata-src=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬\&quot;\u003c/span\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026gt;\u0026lt;/a\u0026gt;\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;87:1-87:38\&quot;\u003e(lazy-loaded but directly from source)\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;89:1-89:47\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-expected-correct-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-expected-correct-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the expected \u003cem data-sourcepos=\&quot;89:29-89:37\&quot;\u003ecorrect\u003c/em\u003e behavior?\u003c/h5\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;91:1-93:3\&quot; data-canonical-lang=\&quot;html\&quot; class=\&quot;code highlight js-syntax-highlight language-html\&quot; lang=\&quot;html\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;html\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003eclass=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;no-attachment-icon\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003ehref=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;https://proxy-gitlab.example.com/c5adcab7ef96e3081000c51459e8c1483863d751/68747470733a2f2f692e67697068792e636f6d2f6d656469612f336f4b49506e4169614d437773386e4f73452f67697068792e77656270\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003etarget=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;_blank\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003erel=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;nofollow noreferrer noopener\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003edata-canonical-src=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\&quot;\u003c/span\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026gt;\u0026lt;img\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003esrc=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003ealt=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;x\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003edata-canonical-src=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003edecoding=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;async\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003eclass=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;lazy\&quot;\u003c/span\u003e \u003cspan class=\&quot;na\&quot;\u003edata-src=\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e\&quot;https://proxy-gitlab.example.com/c5adcab7ef96e3081000c51459e8c1483863d751/68747470733a2f2f692e67697068792e636f6d2f6d656469612f336f4b49506e4169614d437773386e4f73452f67697068792e77656270\&quot;\u003c/span\u003e\u003cspan class=\&quot;nt\&quot;\u003e\u0026gt;\u0026lt;/a\u0026gt;\u003c/span\u003e  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;95:1-95:30\&quot;\u003e(via proxy-gitlab.example.com)\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;97:1-97:39\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-relevant-logs-andor-screenshots\&quot; class=\&quot;anchor\&quot; href=\&quot;#relevant-logs-andor-screenshots\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eRelevant logs and/or screenshots\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;99:1-99:108\&quot;\u003eComments showing proxied images (failed to load as no camo set up) and one image loaded bypassing the proxy.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;101:1-101:88\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/ed3f7e3581c637883f2e3cb1a2f6bd4f45ca7eb3/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65616666613563352d666233382d343463662d623437652d3435393034366532393961302f696d6167652e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;101:1-101:88\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;image.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/ed3f7e3581c637883f2e3cb1a2f6bd4f45ca7eb3/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65616666613563352d666233382d343463662d623437652d3435393034366532393961302f696d6167652e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;103:1-103:88\&quot;\u003eNetwork tab showing three (failed) image requests to proxy and one to the remote server.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;105:1-105:88\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/5f3dfade7cb8aa1c124c6812de34158d0eb028a0/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f31333239343430622d396566352d343531382d626634322d3863323738333533616334632f696d6167652e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;105:1-105:88\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;image.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/5f3dfade7cb8aa1c124c6812de34158d0eb028a0/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f31333239343430622d396566352d343531382d626634322d3863323738333533616334632f696d6167652e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;107:1-107:55\&quot;\u003eHTML of proxied (above) and unproxied (below) comments.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;109:1-109:88\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/4b1031e68b565efb184c175a23b38ef380112da5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66373866393565622d313364332d346638302d613630322d3436343836366163616136342f696d6167652e706e67\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png\&quot;\u003e\u003cimg data-sourcepos=\&quot;109:1-109:88\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;image.png\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/4b1031e68b565efb184c175a23b38ef380112da5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66373866393565622d313364332d346638302d613630322d3436343836366163616136342f696d6167652e706e67\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;111:1-111:23\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-output-of-checks\&quot; class=\&quot;anchor\&quot; href=\&quot;#output-of-checks\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eOutput of checks\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;113:1-113:30\&quot;\u003eThis bug happens on GitLab.com\u003c/p\u003e\u0026#x000A;\u003ch6 data-sourcepos=\&quot;115:1-115:42\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-results-of-gitlab-environment-info\&quot; class=\&quot;anchor\&quot; href=\&quot;#results-of-gitlab-environment-info\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eResults of GitLab environment info\u003c/h6\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;117:1-153:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot@gitlab:/# gitlab-rake gitlab:env:info\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eProxy:          no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eCurrent User:   git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing RVM:      no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRuby Version:   3.0.6p216  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGem Version:    3.4.13  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eBundler Version:2.4.14  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRake Version:   13.0.6  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRedis Version:  6.2.11  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSidekiq Version:6.5.7  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGo Version:     unknown\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:        16.1.2-ee  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRevision:       0642e8c5c91  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDirectory:      /opt/gitlab/embedded/service/gitlab-rails  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Adapter:     PostgreSQL  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Version:     13.11  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eURL:            https://gitlab.example.com  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eHTTP Clone URL: https://gitlab.example.com/some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSSH Clone URL:  git@gitlab.example.com:some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eElasticsearch:  no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGeo:            no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing LDAP:     no  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing Omniauth: yes  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOmniauth Providers: \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:        14.23.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRepository storages:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;155:1-155:12\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact-1\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact-1\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;157:1-158:82\&quot;\u003eThe Asset Proxy is a privacy and security feature to prevent visitors to pages on the Gitlab instance from being tracked by malicious users and malicious remote servers. This bug allows a malicious user to bypass this feature and add non-proxied image tags wherever markdown is accepted on Gitlab and track visitors.\u003cbr data-sourcepos=\&quot;157:319-157:319\&quot;\u003e\u0026#x000A;Impact depends on how much importance people place on privacy and the asset proxy.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;160:1-160:14\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-attachments\&quot; class=\&quot;anchor\&quot; href=\&quot;#attachments\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAttachments\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;162:1-162:77\&quot;\u003e\u003cstrong data-sourcepos=\&quot;162:1-162:12\&quot;\u003eWarning:\u003c/strong\u003e Attachments received through HackerOne, please exercise caution!\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;164:1-167:0\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;164:1-164:89\&quot;\u003e\u003ca data-sourcepos=\&quot;164:3-164:89\&quot; href=\&quot;https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eimage.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;165:1-165:89\&quot;\u003e\u003ca data-sourcepos=\&quot;165:3-165:89\&quot; href=\&quot;https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eimage.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;166:1-167:0\&quot;\u003e\u003ca data-sourcepos=\&quot;166:3-166:89\&quot; href=\&quot;https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eimage.png\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003c/details\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;170:1-170:33\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-how-to-reproduce-on-gitlabcom\&quot; class=\&quot;anchor\&quot; href=\&quot;#how-to-reproduce-on-gitlabcom\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eHow To Reproduce on GitLab.com\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;172:1-172:57\&quot; dir=\&quot;auto\&quot;\u003ePlease add [reproducibility information] to this section:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;174:1-176:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;174:1-174:32\&quot;\u003eCreate an Issue on GitLab.com\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;175:1-176:0\&quot;\u003eEnter the following markdown:\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;177:1-189:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e# Markdown\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e![](https://i.imgur.com/5ADf1jq.png)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e# HTML\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026lt;img src=\&quot;https://i.imgur.com/5ADf1jq.png\&quot; alt=\&quot;html image\&quot; /\u0026gt;\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e# HTML plus ascii\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026lt;img src=\&quot;https://i.imgur.com/5ADf1jq.png¬\&quot; alt=\&quot;html image\&quot; /\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;191:1-193:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;191:1-191:94\&quot;\u003eObserve that the first two images are requested via \u003ccode data-sourcepos=\&quot;191:57-191:86\&quot;\u003euser-content.gitlab-static.net\u003c/code\u003e (Good)\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;192:1-193:0\&quot;\u003eObserve that the third image, with the \u003ccode data-sourcepos=\&quot;192:44-192:45\&quot;\u003e¬\u003c/code\u003e, is requested direct to \u003ccode data-sourcepos=\&quot;192:73-192:83\&quot;\u003ei.imgur.com\u003c/code\u003e which is bypassing the asset proxy.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;194:1-194:121\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon gfm\&quot; href=\&quot;/-/project/278964/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png\&quot; target=\&quot;_blank\&quot; rel=\&quot;noopener noreferrer\&quot; data-canonical-src=\&quot;/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png\&quot; data-link=\&quot;true\&quot;\u003e\u003cimg data-sourcepos=\&quot;194:1-194:121\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;Screenshot_2023-07-20_at_4.34.43_PM\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy gfm\&quot; data-src=\&quot;/-/project/278964/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png\&quot; data-canonical-src=\&quot;/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png\&quot;\u003e\u003c/a\u003e\u003c/p\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;:warning: **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**\n\n**[HackerOne report #2071411](https://hackerone.com/reports/2071411)** by `afewgoats` on 2023-07-16, assigned to @nmalcolm:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n#####  Summary\n\nGitlab EE has an [Asset Proxying](https://docs.gitlab.com/ee/security/asset_proxy.html) feature. This feature is active on gitlab.com.\n\nWithout this feature, attackers can steal a user’s IP address by referencing images in issues and comments that the victim browses. The image hosting server can also see referer headers identifying the Gitlab instance and the user&#39;s cookies for that remote site.\n\n[Banzai::Filter::AssetProxyFilter](https://gitlab.com/gitlab-org/gitlab/-/blob/1cec76cb4d2beed789dcc4c6c61ef09d33a7ec97/lib/banzai/filter/asset_proxy_filter.rb#L23-L27) has the following code:\n\n```rb  \n          begin  \n            uri = URI.parse(original_src)  \n          rescue StandardError  \n            next  \n          end  \n          ...  \n          element[&#39;src&#39;] = asset_proxy_url(original_src)  \n```\n\nWhich states that if `URI.parse` raises an exception, we do not proxy the URL but use it as-is (`next`). This is a fail-open check that is easy to satisfy with a valid URL. `URI.parse` is much stricter than `Addressable::URI.parse`. `URI.parse` raises an exception on any URI containing a non-ASCII character anywhere.\n\n```  \n\u003e URI.parse(\&quot;https://example.com/x?$\&quot;)  \n=\u003e #\u003cURI::HTTPS https://example.com/x?$\u003e  \n\u003e URI.parse(\&quot;https://example.com/x?`\&quot;)  \n=\u003e #\u003cURI::HTTPS https://example.com/x?%60\u003e  \n\u003e URI.parse(\&quot;https://example.com/x?¬\&quot;)  \n    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://example.com/x?\\u00AC\&quot; (URI::InvalidURIError)  \n\u003e URI.parse(\&quot;https://example.com/x#£\&quot;)  \n    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://example.com/x#\\u00A3\&quot; (URI::InvalidURIError)  \n\u003e URI.parse(\&quot;https://example.com/笨蛋\&quot;)  \n    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://example.com/\\u7B28\\u86CB\&quot; (URI::InvalidURIError)  \n\u003e URI.parse(\&quot;https://㏊ckerone.com/\&quot;)  \n    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://\\u33CAckerone.com/\&quot; (URI::InvalidURIError)  \n```\n\nWhen adding an image using the `![]()` markdown tags, the URL appears to be URL-encoded before hitting `AssetProxyFilter`, so there is no bypass.  \nWhen adding an image using `\u003cimg\u003e` HTML tags, however, the URL appears to go directly to `AssetProxyFilter`, allowing the asset proxy to be bypassed.\n\n\u003cdetails\u003e\n\u003csummary\u003eClick to expand original H1 report, which includes steps to reproduce locally\u003c/summary\u003e\n\n#####  Steps to reproduce\n\n1. Turn on Asset Proxying by making the curl request at https://docs.gitlab.com/ee/security/asset_proxy.html). Installing camo is not required here, we just need Gitlab to rewrite images sources to some domain. Alternatively, just use gitlab.com as that has asset proxying.  \n2. Write markdown somewhere in Gitlab e.g. an issue comment. The following 3 markdown images load (or fail to load) via the asset proxy. Verify that they do not load directly from giphy.\n\n```md  \n![markdown image](https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp)  \n![markdown image with non-ascii character](https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬)  \n\u003cimg src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\&quot; alt=\&quot;html image\&quot; /\u003e  \n```\n\n3. Now try the following Markdown to bypass the asset proxy: an IMG tag where the URL contains a non-ASCII character `¬`.\n\n```md  \n\u003cimg src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬\&quot; alt=\&quot;html image with non-ASCII character\&quot; /\u003e  \n```  \nThe browser loads the URL directly from the remote server.\n\nThe request (view it in dev tools or a proxy):  \n* Will reveal the user&#39;s IP address  \n* Contains a referer header identifying the Gitlab instance  \n* Contains cookies for the remote URL, identifying me to the remote server if I have cookies for it. As I have visited giphy.com, it sent `didomi_accept_cookie=1; euconsent-v2=...; didomi_token=...`. If the image URL was Google, then Google cookies would be sent along with the request to Google (this was tested in Chrome).\n\nNote that gitlab.com CSP allows all remote images `img-src * data: blob:;`.\n\n#####  Impact\n\nThe Asset Proxy is a privacy and security feature to prevent visitors to pages on the Gitlab instance from being tracked by malicious users and malicious remote servers. This bug allows a malicious user to bypass this feature and add non-proxied image tags wherever markdown is accepted on Gitlab and track visitors.\n\n#####  What is the current *bug* behavior?\n\nEntering `\u003cimg src=\&quot;https://url-containing-non-ascii/£\&quot; /\u003e` in a Markdown field results in Asset Proxy being bypassed.\n\n```html  \n\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?%C2%AC\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot;\u003e\u003cimg src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;x\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬\&quot;\u003e\u003c/a\u003e  \n```\n\n(lazy-loaded but directly from source)\n\n#####  What is the expected *correct* behavior?\n\n```html  \n\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://proxy-gitlab.example.com/c5adcab7ef96e3081000c51459e8c1483863d751/68747470733a2f2f692e67697068792e636f6d2f6d656469612f336f4b49506e4169614d437773386e4f73452f67697068792e77656270\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\&quot;\u003e\u003cimg src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;x\&quot; data-canonical-src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://proxy-gitlab.example.com/c5adcab7ef96e3081000c51459e8c1483863d751/68747470733a2f2f692e67697068792e636f6d2f6d656469612f336f4b49506e4169614d437773386e4f73452f67697068792e77656270\&quot;\u003e\u003c/a\u003e  \n```\n\n(via proxy-gitlab.example.com)\n\n#####  Relevant logs and/or screenshots\n\nComments showing proxied images (failed to load as no camo set up) and one image loaded bypassing the proxy.\n\n![image.png](https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png)\n\nNetwork tab showing three (failed) image requests to proxy and one to the remote server.\n\n![image.png](https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png)\n\nHTML of proxied (above) and unproxied (below) comments.\n\n![image.png](https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png)\n\n#####  Output of checks\n\nThis bug happens on GitLab.com\n\n######  Results of GitLab environment info\n\n```  \nroot@gitlab:/# gitlab-rake gitlab:env:info\n\nSystem information  \nSystem:  \nProxy:          no  \nCurrent User:   git  \nUsing RVM:      no  \nRuby Version:   3.0.6p216  \nGem Version:    3.4.13  \nBundler Version:2.4.14  \nRake Version:   13.0.6  \nRedis Version:  6.2.11  \nSidekiq Version:6.5.7  \nGo Version:     unknown\n\nGitLab information  \nVersion:        16.1.2-ee  \nRevision:       0642e8c5c91  \nDirectory:      /opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:     PostgreSQL  \nDB Version:     13.11  \nURL:            https://gitlab.example.com  \nHTTP Clone URL: https://gitlab.example.com/some-group/some-project.git  \nSSH Clone URL:  git@gitlab.example.com:some-group/some-project.git  \nElasticsearch:  no  \nGeo:            no  \nUsing LDAP:     no  \nUsing Omniauth: yes  \nOmniauth Providers: \n\nGitLab Shell  \nVersion:        14.23.0  \nRepository storages:  \n- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket  \nGitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell  \n```\n\n####  Impact\n\nThe Asset Proxy is a privacy and security feature to prevent visitors to pages on the Gitlab instance from being tracked by malicious users and malicious remote servers. This bug allows a malicious user to bypass this feature and add non-proxied image tags wherever markdown is accepted on Gitlab and track visitors.  \nImpact depends on how much importance people place on privacy and the asset proxy.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [image.png](https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png)\n* [image.png](https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png)\n* [image.png](https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png)\n\n\u003c/details\u003e\n\n## How To Reproduce on GitLab.com\n\nPlease add [reproducibility information] to this section:\n\n1. Create an Issue on GitLab.com\n1. Enter the following markdown:\n\n```\n# Markdown\n\n![](https://i.imgur.com/5ADf1jq.png)\n\n# HTML\n\n\u003cimg src=\&quot;https://i.imgur.com/5ADf1jq.png\&quot; alt=\&quot;html image\&quot; /\u003e\n\n# HTML plus ascii\n\n\u003cimg src=\&quot;https://i.imgur.com/5ADf1jq.png¬\&quot; alt=\&quot;html image\&quot; /\u003e\n```\n\n1. Observe that the first two images are requested via `user-content.gitlab-static.net` (Good)\n2. Observe that the third image, with the `¬`, is requested direct to `i.imgur.com` which is bypassing the asset proxy.\n\n![Screenshot_2023-07-20_at_4.34.43_PM](/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png)&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;gitlab-org/gitlab&quot;,&quot;iid&quot;:419213,&quot;issuableId&quot;:131063629,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2741139,&quot;authorName&quot;:&quot;GitLab SecurityBot&quot;,&quot;authorUsername&quot;:&quot;gitlab-securitybot&quot;,&quot;authorWebUrl&quot;:&quot;/gitlab-securitybot&quot;,&quot;createdAt&quot;:&quot;2023-07-20T04:34:17+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:278964,&quot;projectPath&quot;:&quot;gitlab&quot;,&quot;projectNamespace&quot;:&quot;gitlab-org&quot;,&quot;updatedAt&quot;:&quot;2023-07-20T05:28:24+00:00&quot;,&quot;updatedBy&quot;:{&quot;name&quot;:&quot;Nick Malcolm&quot;,&quot;path&quot;:&quot;/nmalcolm&quot;},&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Asset Proxy Bypass using non-ASCII character in asset URI</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:247" dir="auto"><gl-emoji title="warning sign" data-name="warning" data-unicode-version="4.0">⚠</gl-emoji> <strong data-sourcepos="1:11-1:247">Please read <a data-sourcepos="1:25-1:125" href="https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md">the process</a> on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.</strong></p>&#x000A;<p data-sourcepos="3:1-3:123" dir="auto"><strong data-sourcepos="3:1-3:70"><a data-sourcepos="3:3-3:68" href="https://hackerone.com/reports/2071411" rel="nofollow noreferrer noopener" target="_blank">HackerOne report #2071411</a></strong> by <code data-sourcepos="3:76-3:84">afewgoats</code> on 2023-07-16, assigned to <a href="/nmalcolm" data-reference-type="user" data-user="9820844" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Nick Malcolm">@nmalcolm</a>:</p>&#x000A;<p data-sourcepos="5:1-5:87" dir="auto"><a data-sourcepos="5:1-5:17" href="#report">Report</a> | <a data-sourcepos="5:21-5:47" href="#attachments">Attachments</a> | <a data-sourcepos="5:51-5:87" href="#how-to-reproduce">How To Reproduce</a></p>&#x000A;<h2 data-sourcepos="7:1-7:9" dir="auto">&#x000A;<a id="user-content-report" class="anchor" href="#report" aria-hidden="true"></a>Report</h2>&#x000A;<h5 data-sourcepos="9:1-9:14" dir="auto">&#x000A;<a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h5>&#x000A;<p data-sourcepos="11:1-11:134" dir="auto">Gitlab EE has an <a data-sourcepos="11:18-11:87" href="https://docs.gitlab.com/ee/security/asset_proxy.html" rel="nofollow noreferrer noopener" target="_blank">Asset Proxying</a> feature. This feature is active on gitlab.com.</p>&#x000A;<p data-sourcepos="13:1-13:264" dir="auto">Without this feature, attackers can steal a user’s IP address by referencing images in issues and comments that the victim browses. The image hosting server can also see referer headers identifying the Gitlab instance and the user's cookies for that remote site.</p>&#x000A;<p data-sourcepos="15:1-15:192" dir="auto"><a data-sourcepos="15:1-15:168" href="https://gitlab.com/gitlab-org/gitlab/-/blob/1cec76cb4d2beed789dcc4c6c61ef09d33a7ec97/lib/banzai/filter/asset_proxy_filter.rb#L23-L27">Banzai::Filter::AssetProxyFilter</a> has the following code:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="17:1-25:3" data-canonical-lang="rb" class="code highlight js-syntax-highlight language-ruby" lang="ruby" v-pre="true"><code><span id="LC1" class="line" lang="ruby">          <span class="k">begin</span>  </span>&#x000A;<span id="LC2" class="line" lang="ruby">            <span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">original_src</span><span class="p">)</span>  </span>&#x000A;<span id="LC3" class="line" lang="ruby">          <span class="k">rescue</span> <span class="no">StandardError</span>  </span>&#x000A;<span id="LC4" class="line" lang="ruby">            <span class="k">next</span>  </span>&#x000A;<span id="LC5" class="line" lang="ruby">          <span class="k">end</span>  </span>&#x000A;<span id="LC6" class="line" lang="ruby">          <span class="o">...</span>  </span>&#x000A;<span id="LC7" class="line" lang="ruby">          <span class="n">element</span><span class="p">[</span><span class="s1">'src'</span><span class="p">]</span> <span class="o">=</span> <span class="n">asset_proxy_url</span><span class="p">(</span><span class="n">original_src</span><span class="p">)</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="27:1-27:318" dir="auto">Which states that if <code data-sourcepos="27:23-27:31">URI.parse</code> raises an exception, we do not proxy the URL but use it as-is (<code data-sourcepos="27:98-27:101">next</code>). This is a fail-open check that is easy to satisfy with a valid URL. <code data-sourcepos="27:175-27:183">URI.parse</code> is much stricter than <code data-sourcepos="27:209-27:230">Addressable::URI.parse</code>. <code data-sourcepos="27:235-27:243">URI.parse</code> raises an exception on any URI containing a non-ASCII character anywhere.</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="29:1-42:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">&gt; URI.parse("https://example.com/x?$")  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">=&gt; #&lt;URI::HTTPS https://example.com/x?$&gt;  </span>&#x000A;<span id="LC3" class="line" lang="plaintext">&gt; URI.parse("https://example.com/x?`")  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">=&gt; #&lt;URI::HTTPS https://example.com/x?%60&gt;  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">&gt; URI.parse("https://example.com/x?¬")  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split': URI must be ascii only "https://example.com/x?\u00AC" (URI::InvalidURIError)  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">&gt; URI.parse("https://example.com/x#£")  </span>&#x000A;<span id="LC8" class="line" lang="plaintext">    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split': URI must be ascii only "https://example.com/x#\u00A3" (URI::InvalidURIError)  </span>&#x000A;<span id="LC9" class="line" lang="plaintext">&gt; URI.parse("https://example.com/笨蛋")  </span>&#x000A;<span id="LC10" class="line" lang="plaintext">    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split': URI must be ascii only "https://example.com/\u7B28\u86CB" (URI::InvalidURIError)  </span>&#x000A;<span id="LC11" class="line" lang="plaintext">&gt; URI.parse("https://㏊ckerone.com/")  </span>&#x000A;<span id="LC12" class="line" lang="plaintext">    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split': URI must be ascii only "https://\u33CAckerone.com/" (URI::InvalidURIError)  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="44:1-45:149" dir="auto">When adding an image using the <code data-sourcepos="44:33-44:37">![]()</code> markdown tags, the URL appears to be URL-encoded before hitting <code data-sourcepos="44:105-44:120">AssetProxyFilter</code>, so there is no bypass.<br data-sourcepos="44:148-44:148">&#x000A;When adding an image using <code data-sourcepos="45:29-45:33">&lt;img&gt;</code> HTML tags, however, the URL appears to go directly to <code data-sourcepos="45:91-45:106">AssetProxyFilter</code>, allowing the asset proxy to be bypassed.</p>&#x000A;<details>&#x000A;<summary>Click to expand original H1 report, which includes steps to reproduce locally</summary>&#x000A;<h5 data-sourcepos="50:1-50:25">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to reproduce</h5>&#x000A;<ol data-sourcepos="52:1-54:0">&#x000A;<li data-sourcepos="52:1-52:275">Turn on Asset Proxying by making the curl request at <a href="https://docs.gitlab.com/ee/security/asset_proxy.html" rel="nofollow noreferrer noopener" target="_blank">https://docs.gitlab.com/ee/security/asset_proxy.html</a>). Installing camo is not required here, we just need Gitlab to rewrite images sources to some domain. Alternatively, just use gitlab.com as that has asset proxying.</li>&#x000A;<li data-sourcepos="53:1-54:0">Write markdown somewhere in Gitlab e.g. an issue comment. The following 3 markdown images load (or fail to load) via the asset proxy. Verify that they do not load directly from giphy.</li>&#x000A;</ol>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="55:1-59:3" data-canonical-lang="md" class="code highlight js-syntax-highlight language-markdown" lang="markdown" v-pre="true"><code><span id="LC1" class="line" lang="markdown"><span class="p">![</span><span class="nv">markdown image</span><span class="p">](</span><span class="sx">https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp</span><span class="p">)</span>  </span>&#x000A;<span id="LC2" class="line" lang="markdown"><span class="p">![</span><span class="nv">markdown image with non-ascii character</span><span class="p">](</span><span class="sx">https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬</span><span class="p">)</span>  </span>&#x000A;<span id="LC3" class="line" lang="markdown"><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp"</span> <span class="na">alt=</span><span class="s">"html image"</span> <span class="nt">/&gt;</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<ol data-sourcepos="61:1-62:0" start="3">&#x000A;<li data-sourcepos="61:1-62:0">Now try the following Markdown to bypass the asset proxy: an IMG tag where the URL contains a non-ASCII character <code data-sourcepos="61:119-61:120">¬</code>.</li>&#x000A;</ol>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="63:1-65:5" data-canonical-lang="md" class="code highlight js-syntax-highlight language-markdown" lang="markdown" v-pre="true"><code><span id="LC1" class="line" lang="markdown"><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬"</span> <span class="na">alt=</span><span class="s">"html image with non-ASCII character"</span> <span class="nt">/&gt;</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="66:1-66:58">The browser loads the URL directly from the remote server.</p>&#x000A;<p data-sourcepos="68:1-68:48">The request (view it in dev tools or a proxy):</p>&#x000A;<ul data-sourcepos="69:1-72:0">&#x000A;<li data-sourcepos="69:1-69:37">Will reveal the user's IP address</li>&#x000A;<li data-sourcepos="70:1-70:61">Contains a referer header identifying the Gitlab instance</li>&#x000A;<li data-sourcepos="71:1-72:0">Contains cookies for the remote URL, identifying me to the remote server if I have cookies for it. As I have visited giphy.com, it sent <code data-sourcepos="71:140-71:197">didomi_accept_cookie=1; euconsent-v2=...; didomi_token=...</code>. If the image URL was Google, then Google cookies would be sent along with the request to Google (this was tested in Chrome).</li>&#x000A;</ul>&#x000A;<p data-sourcepos="73:1-73:75">Note that gitlab.com CSP allows all remote images <code data-sourcepos="73:52-73:73">img-src * data: blob:;</code>.</p>&#x000A;<h5 data-sourcepos="75:1-75:13">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h5>&#x000A;<p data-sourcepos="77:1-77:316">The Asset Proxy is a privacy and security feature to prevent visitors to pages on the Gitlab instance from being tracked by malicious users and malicious remote servers. This bug allows a malicious user to bypass this feature and add non-proxied image tags wherever markdown is accepted on Gitlab and track visitors.</p>&#x000A;<h5 data-sourcepos="79:1-79:42">&#x000A;<a id="user-content-what-is-the-current-bug-behavior" class="anchor" href="#what-is-the-current-bug-behavior" aria-hidden="true"></a>What is the current <em data-sourcepos="79:28-79:32">bug</em> behavior?</h5>&#x000A;<p data-sourcepos="81:1-81:119">Entering <code data-sourcepos="81:11-81:59">&lt;img src="https://url-containing-non-ascii/£" /&gt;</code> in a Markdown field results in Asset Proxy being bypassed.</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="83:1-85:3" data-canonical-lang="html" class="code highlight js-syntax-highlight language-html" lang="html" v-pre="true"><code><span id="LC1" class="line" lang="html"><span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"no-attachment-icon"</span> <span class="na">href=</span><span class="s">"https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?%C2%AC"</span> <span class="na">target=</span><span class="s">"_blank"</span> <span class="na">rel=</span><span class="s">"nofollow noreferrer noopener"</span><span class="nt">&gt;&lt;img</span> <span class="na">src=</span><span class="s">"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="</span> <span class="na">alt=</span><span class="s">"x"</span> <span class="na">decoding=</span><span class="s">"async"</span> <span class="na">class=</span><span class="s">"lazy"</span> <span class="na">data-src=</span><span class="s">"https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬"</span><span class="nt">&gt;&lt;/a&gt;</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="87:1-87:38">(lazy-loaded but directly from source)</p>&#x000A;<h5 data-sourcepos="89:1-89:47">&#x000A;<a id="user-content-what-is-the-expected-correct-behavior" class="anchor" href="#what-is-the-expected-correct-behavior" aria-hidden="true"></a>What is the expected <em data-sourcepos="89:29-89:37">correct</em> behavior?</h5>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="91:1-93:3" data-canonical-lang="html" class="code highlight js-syntax-highlight language-html" lang="html" v-pre="true"><code><span id="LC1" class="line" lang="html"><span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"no-attachment-icon"</span> <span class="na">href=</span><span class="s">"https://proxy-gitlab.example.com/c5adcab7ef96e3081000c51459e8c1483863d751/68747470733a2f2f692e67697068792e636f6d2f6d656469612f336f4b49506e4169614d437773386e4f73452f67697068792e77656270"</span> <span class="na">target=</span><span class="s">"_blank"</span> <span class="na">rel=</span><span class="s">"nofollow noreferrer noopener"</span> <span class="na">data-canonical-src=</span><span class="s">"https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp"</span><span class="nt">&gt;&lt;img</span> <span class="na">src=</span><span class="s">"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="</span> <span class="na">alt=</span><span class="s">"x"</span> <span class="na">data-canonical-src=</span><span class="s">"https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp"</span> <span class="na">decoding=</span><span class="s">"async"</span> <span class="na">class=</span><span class="s">"lazy"</span> <span class="na">data-src=</span><span class="s">"https://proxy-gitlab.example.com/c5adcab7ef96e3081000c51459e8c1483863d751/68747470733a2f2f692e67697068792e636f6d2f6d656469612f336f4b49506e4169614d437773386e4f73452f67697068792e77656270"</span><span class="nt">&gt;&lt;/a&gt;</span>  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="95:1-95:30">(via proxy-gitlab.example.com)</p>&#x000A;<h5 data-sourcepos="97:1-97:39">&#x000A;<a id="user-content-relevant-logs-andor-screenshots" class="anchor" href="#relevant-logs-andor-screenshots" aria-hidden="true"></a>Relevant logs and/or screenshots</h5>&#x000A;<p data-sourcepos="99:1-99:108">Comments showing proxied images (failed to load as no camo set up) and one image loaded bypassing the proxy.</p>&#x000A;<p data-sourcepos="101:1-101:88"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/ed3f7e3581c637883f2e3cb1a2f6bd4f45ca7eb3/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65616666613563352d666233382d343463662d623437652d3435393034366532393961302f696d6167652e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png"><img data-sourcepos="101:1-101:88" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image.png" data-canonical-src="https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/ed3f7e3581c637883f2e3cb1a2f6bd4f45ca7eb3/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65616666613563352d666233382d343463662d623437652d3435393034366532393961302f696d6167652e706e67"></a></p>&#x000A;<p data-sourcepos="103:1-103:88">Network tab showing three (failed) image requests to proxy and one to the remote server.</p>&#x000A;<p data-sourcepos="105:1-105:88"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/5f3dfade7cb8aa1c124c6812de34158d0eb028a0/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f31333239343430622d396566352d343531382d626634322d3863323738333533616334632f696d6167652e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png"><img data-sourcepos="105:1-105:88" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image.png" data-canonical-src="https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/5f3dfade7cb8aa1c124c6812de34158d0eb028a0/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f31333239343430622d396566352d343531382d626634322d3863323738333533616334632f696d6167652e706e67"></a></p>&#x000A;<p data-sourcepos="107:1-107:55">HTML of proxied (above) and unproxied (below) comments.</p>&#x000A;<p data-sourcepos="109:1-109:88"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/4b1031e68b565efb184c175a23b38ef380112da5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66373866393565622d313364332d346638302d613630322d3436343836366163616136342f696d6167652e706e67" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png"><img data-sourcepos="109:1-109:88" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image.png" data-canonical-src="https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/4b1031e68b565efb184c175a23b38ef380112da5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66373866393565622d313364332d346638302d613630322d3436343836366163616136342f696d6167652e706e67"></a></p>&#x000A;<h5 data-sourcepos="111:1-111:23">&#x000A;<a id="user-content-output-of-checks" class="anchor" href="#output-of-checks" aria-hidden="true"></a>Output of checks</h5>&#x000A;<p data-sourcepos="113:1-113:30">This bug happens on GitLab.com</p>&#x000A;<h6 data-sourcepos="115:1-115:42">&#x000A;<a id="user-content-results-of-gitlab-environment-info" class="anchor" href="#results-of-gitlab-environment-info" aria-hidden="true"></a>Results of GitLab environment info</h6>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="117:1-153:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">root@gitlab:/# gitlab-rake gitlab:env:info</span>&#x000A;<span id="LC2" class="line" lang="plaintext"></span>&#x000A;<span id="LC3" class="line" lang="plaintext">System information  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">System:  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">Proxy:          no  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">Current User:   git  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">Using RVM:      no  </span>&#x000A;<span id="LC8" class="line" lang="plaintext">Ruby Version:   3.0.6p216  </span>&#x000A;<span id="LC9" class="line" lang="plaintext">Gem Version:    3.4.13  </span>&#x000A;<span id="LC10" class="line" lang="plaintext">Bundler Version:2.4.14  </span>&#x000A;<span id="LC11" class="line" lang="plaintext">Rake Version:   13.0.6  </span>&#x000A;<span id="LC12" class="line" lang="plaintext">Redis Version:  6.2.11  </span>&#x000A;<span id="LC13" class="line" lang="plaintext">Sidekiq Version:6.5.7  </span>&#x000A;<span id="LC14" class="line" lang="plaintext">Go Version:     unknown</span>&#x000A;<span id="LC15" class="line" lang="plaintext"></span>&#x000A;<span id="LC16" class="line" lang="plaintext">GitLab information  </span>&#x000A;<span id="LC17" class="line" lang="plaintext">Version:        16.1.2-ee  </span>&#x000A;<span id="LC18" class="line" lang="plaintext">Revision:       0642e8c5c91  </span>&#x000A;<span id="LC19" class="line" lang="plaintext">Directory:      /opt/gitlab/embedded/service/gitlab-rails  </span>&#x000A;<span id="LC20" class="line" lang="plaintext">DB Adapter:     PostgreSQL  </span>&#x000A;<span id="LC21" class="line" lang="plaintext">DB Version:     13.11  </span>&#x000A;<span id="LC22" class="line" lang="plaintext">URL:            https://gitlab.example.com  </span>&#x000A;<span id="LC23" class="line" lang="plaintext">HTTP Clone URL: https://gitlab.example.com/some-group/some-project.git  </span>&#x000A;<span id="LC24" class="line" lang="plaintext">SSH Clone URL:  git@gitlab.example.com:some-group/some-project.git  </span>&#x000A;<span id="LC25" class="line" lang="plaintext">Elasticsearch:  no  </span>&#x000A;<span id="LC26" class="line" lang="plaintext">Geo:            no  </span>&#x000A;<span id="LC27" class="line" lang="plaintext">Using LDAP:     no  </span>&#x000A;<span id="LC28" class="line" lang="plaintext">Using Omniauth: yes  </span>&#x000A;<span id="LC29" class="line" lang="plaintext">Omniauth Providers: </span>&#x000A;<span id="LC30" class="line" lang="plaintext"></span>&#x000A;<span id="LC31" class="line" lang="plaintext">GitLab Shell  </span>&#x000A;<span id="LC32" class="line" lang="plaintext">Version:        14.23.0  </span>&#x000A;<span id="LC33" class="line" lang="plaintext">Repository storages:  </span>&#x000A;<span id="LC34" class="line" lang="plaintext">- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket  </span>&#x000A;<span id="LC35" class="line" lang="plaintext">GitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="155:1-155:12">&#x000A;<a id="user-content-impact-1" class="anchor" href="#impact-1" aria-hidden="true"></a>Impact</h4>&#x000A;<p data-sourcepos="157:1-158:82">The Asset Proxy is a privacy and security feature to prevent visitors to pages on the Gitlab instance from being tracked by malicious users and malicious remote servers. This bug allows a malicious user to bypass this feature and add non-proxied image tags wherever markdown is accepted on Gitlab and track visitors.<br data-sourcepos="157:319-157:319">&#x000A;Impact depends on how much importance people place on privacy and the asset proxy.</p>&#x000A;<h2 data-sourcepos="160:1-160:14">&#x000A;<a id="user-content-attachments" class="anchor" href="#attachments" aria-hidden="true"></a>Attachments</h2>&#x000A;<p data-sourcepos="162:1-162:77"><strong data-sourcepos="162:1-162:12">Warning:</strong> Attachments received through HackerOne, please exercise caution!</p>&#x000A;<ul data-sourcepos="164:1-167:0">&#x000A;<li data-sourcepos="164:1-164:89"><a data-sourcepos="164:3-164:89" href="https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png" rel="nofollow noreferrer noopener" target="_blank">image.png</a></li>&#x000A;<li data-sourcepos="165:1-165:89"><a data-sourcepos="165:3-165:89" href="https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png" rel="nofollow noreferrer noopener" target="_blank">image.png</a></li>&#x000A;<li data-sourcepos="166:1-167:0"><a data-sourcepos="166:3-166:89" href="https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png" rel="nofollow noreferrer noopener" target="_blank">image.png</a></li>&#x000A;</ul>&#x000A;</details>&#x000A;<h2 data-sourcepos="170:1-170:33" dir="auto">&#x000A;<a id="user-content-how-to-reproduce-on-gitlabcom" class="anchor" href="#how-to-reproduce-on-gitlabcom" aria-hidden="true"></a>How To Reproduce on GitLab.com</h2>&#x000A;<p data-sourcepos="172:1-172:57" dir="auto">Please add [reproducibility information] to this section:</p>&#x000A;<ol data-sourcepos="174:1-176:0" dir="auto">&#x000A;<li data-sourcepos="174:1-174:32">Create an Issue on GitLab.com</li>&#x000A;<li data-sourcepos="175:1-176:0">Enter the following markdown:</li>&#x000A;</ol>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="177:1-189:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext"># Markdown</span>&#x000A;<span id="LC2" class="line" lang="plaintext"></span>&#x000A;<span id="LC3" class="line" lang="plaintext">![](https://i.imgur.com/5ADf1jq.png)</span>&#x000A;<span id="LC4" class="line" lang="plaintext"></span>&#x000A;<span id="LC5" class="line" lang="plaintext"># HTML</span>&#x000A;<span id="LC6" class="line" lang="plaintext"></span>&#x000A;<span id="LC7" class="line" lang="plaintext">&lt;img src="https://i.imgur.com/5ADf1jq.png" alt="html image" /&gt;</span>&#x000A;<span id="LC8" class="line" lang="plaintext"></span>&#x000A;<span id="LC9" class="line" lang="plaintext"># HTML plus ascii</span>&#x000A;<span id="LC10" class="line" lang="plaintext"></span>&#x000A;<span id="LC11" class="line" lang="plaintext">&lt;img src="https://i.imgur.com/5ADf1jq.png¬" alt="html image" /&gt;</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<ol data-sourcepos="191:1-193:0" dir="auto">&#x000A;<li data-sourcepos="191:1-191:94">Observe that the first two images are requested via <code data-sourcepos="191:57-191:86">user-content.gitlab-static.net</code> (Good)</li>&#x000A;<li data-sourcepos="192:1-193:0">Observe that the third image, with the <code data-sourcepos="192:44-192:45">¬</code>, is requested direct to <code data-sourcepos="192:73-192:83">i.imgur.com</code> which is bypassing the asset proxy.</li>&#x000A;</ol>&#x000A;<p data-sourcepos="194:1-194:121" dir="auto"><a class="no-attachment-icon gfm" href="/-/project/278964/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png" target="_blank" rel="noopener noreferrer" data-canonical-src="/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png" data-link="true"><img data-sourcepos="194:1-194:121" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Screenshot_2023-07-20_at_4.34.43_PM" decoding="async" class="lazy gfm" data-src="/-/project/278964/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png" data-canonical-src="/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png"></a></p></div>
</div>
<div class="edited-text gl-mt-4 gl-text-subtle gl-text-sm">Edited <time class="js-timeago issue-edited-ago js-issue-edited-ago" title="Jul 20, 2023 5:28am" datetime="2023-07-20T05:28:24Z" data-toggle="tooltip" data-placement="bottom" data-container="body">Jul 20, 2023</time> by <a class="author-link hover:gl-underline gl-text-subtle js-user-link" data-user-id="9820844" data-username="nmalcolm" data-name="Nick Malcolm" href="/nmalcolm"><span class="">Nick Malcolm</span></a></div>
</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/278964/issues/419213/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="419213" data-issue-path="/gitlab-org/gitlab/-/issues/419213" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="gitlab-org/gitlab" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="gitlab-org/gitlab" data-issuable-id="131063629" data-issuable-iid="419213" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/gitlab-org/gitlab/-/issues/419213/links" data-full-path="gitlab-org/gitlab" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="419213" data-project-path="gitlab-org/gitlab" id="js-related-merge-requests"></div>
<div data-url="/gitlab-org/gitlab/-/issues/419213/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:131063629,&quot;iid&quot;:419213,&quot;description&quot;:&quot;:warning: **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**\n\n**[HackerOne report #2071411](https://hackerone.com/reports/2071411)** by `afewgoats` on 2023-07-16, assigned to @nmalcolm:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n#####  Summary\n\nGitlab EE has an [Asset Proxying](https://docs.gitlab.com/ee/security/asset_proxy.html) feature. This feature is active on gitlab.com.\n\nWithout this feature, attackers can steal a user’s IP address by referencing images in issues and comments that the victim browses. The image hosting server can also see referer headers identifying the Gitlab instance and the user&#39;s cookies for that remote site.\n\n[Banzai::Filter::AssetProxyFilter](https://gitlab.com/gitlab-org/gitlab/-/blob/1cec76cb4d2beed789dcc4c6c61ef09d33a7ec97/lib/banzai/filter/asset_proxy_filter.rb#L23-L27) has the following code:\n\n```rb  \n          begin  \n            uri = URI.parse(original_src)  \n          rescue StandardError  \n            next  \n          end  \n          ...  \n          element[&#39;src&#39;] = asset_proxy_url(original_src)  \n```\n\nWhich states that if `URI.parse` raises an exception, we do not proxy the URL but use it as-is (`next`). This is a fail-open check that is easy to satisfy with a valid URL. `URI.parse` is much stricter than `Addressable::URI.parse`. `URI.parse` raises an exception on any URI containing a non-ASCII character anywhere.\n\n```  \n\u003e URI.parse(\&quot;https://example.com/x?$\&quot;)  \n=\u003e #\u003cURI::HTTPS https://example.com/x?$\u003e  \n\u003e URI.parse(\&quot;https://example.com/x?`\&quot;)  \n=\u003e #\u003cURI::HTTPS https://example.com/x?%60\u003e  \n\u003e URI.parse(\&quot;https://example.com/x?¬\&quot;)  \n    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://example.com/x?\\u00AC\&quot; (URI::InvalidURIError)  \n\u003e URI.parse(\&quot;https://example.com/x#£\&quot;)  \n    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://example.com/x#\\u00A3\&quot; (URI::InvalidURIError)  \n\u003e URI.parse(\&quot;https://example.com/笨蛋\&quot;)  \n    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://example.com/\\u7B28\\u86CB\&quot; (URI::InvalidURIError)  \n\u003e URI.parse(\&quot;https://㏊ckerone.com/\&quot;)  \n    /opt/gitlab/embedded/lib/ruby/gems/3.0.0/gems/uri-0.12.1/lib/uri/rfc3986_parser.rb:20:in `split&#39;: URI must be ascii only \&quot;https://\\u33CAckerone.com/\&quot; (URI::InvalidURIError)  \n```\n\nWhen adding an image using the `![]()` markdown tags, the URL appears to be URL-encoded before hitting `AssetProxyFilter`, so there is no bypass.  \nWhen adding an image using `\u003cimg\u003e` HTML tags, however, the URL appears to go directly to `AssetProxyFilter`, allowing the asset proxy to be bypassed.\n\n\u003cdetails\u003e\n\u003csummary\u003eClick to expand original H1 report, which includes steps to reproduce locally\u003c/summary\u003e\n\n#####  Steps to reproduce\n\n1. Turn on Asset Proxying by making the curl request at https://docs.gitlab.com/ee/security/asset_proxy.html). Installing camo is not required here, we just need Gitlab to rewrite images sources to some domain. Alternatively, just use gitlab.com as that has asset proxying.  \n2. Write markdown somewhere in Gitlab e.g. an issue comment. The following 3 markdown images load (or fail to load) via the asset proxy. Verify that they do not load directly from giphy.\n\n```md  \n![markdown image](https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp)  \n![markdown image with non-ascii character](https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬)  \n\u003cimg src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\&quot; alt=\&quot;html image\&quot; /\u003e  \n```\n\n3. Now try the following Markdown to bypass the asset proxy: an IMG tag where the URL contains a non-ASCII character `¬`.\n\n```md  \n\u003cimg src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬\&quot; alt=\&quot;html image with non-ASCII character\&quot; /\u003e  \n```  \nThe browser loads the URL directly from the remote server.\n\nThe request (view it in dev tools or a proxy):  \n* Will reveal the user&#39;s IP address  \n* Contains a referer header identifying the Gitlab instance  \n* Contains cookies for the remote URL, identifying me to the remote server if I have cookies for it. As I have visited giphy.com, it sent `didomi_accept_cookie=1; euconsent-v2=...; didomi_token=...`. If the image URL was Google, then Google cookies would be sent along with the request to Google (this was tested in Chrome).\n\nNote that gitlab.com CSP allows all remote images `img-src * data: blob:;`.\n\n#####  Impact\n\nThe Asset Proxy is a privacy and security feature to prevent visitors to pages on the Gitlab instance from being tracked by malicious users and malicious remote servers. This bug allows a malicious user to bypass this feature and add non-proxied image tags wherever markdown is accepted on Gitlab and track visitors.\n\n#####  What is the current *bug* behavior?\n\nEntering `\u003cimg src=\&quot;https://url-containing-non-ascii/£\&quot; /\u003e` in a Markdown field results in Asset Proxy being bypassed.\n\n```html  \n\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?%C2%AC\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot;\u003e\u003cimg src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;x\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp?¬\&quot;\u003e\u003c/a\u003e  \n```\n\n(lazy-loaded but directly from source)\n\n#####  What is the expected *correct* behavior?\n\n```html  \n\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://proxy-gitlab.example.com/c5adcab7ef96e3081000c51459e8c1483863d751/68747470733a2f2f692e67697068792e636f6d2f6d656469612f336f4b49506e4169614d437773386e4f73452f67697068792e77656270\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\&quot;\u003e\u003cimg src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;x\&quot; data-canonical-src=\&quot;https://i.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.webp\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://proxy-gitlab.example.com/c5adcab7ef96e3081000c51459e8c1483863d751/68747470733a2f2f692e67697068792e636f6d2f6d656469612f336f4b49506e4169614d437773386e4f73452f67697068792e77656270\&quot;\u003e\u003c/a\u003e  \n```\n\n(via proxy-gitlab.example.com)\n\n#####  Relevant logs and/or screenshots\n\nComments showing proxied images (failed to load as no camo set up) and one image loaded bypassing the proxy.\n\n![image.png](https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png)\n\nNetwork tab showing three (failed) image requests to proxy and one to the remote server.\n\n![image.png](https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png)\n\nHTML of proxied (above) and unproxied (below) comments.\n\n![image.png](https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png)\n\n#####  Output of checks\n\nThis bug happens on GitLab.com\n\n######  Results of GitLab environment info\n\n```  \nroot@gitlab:/# gitlab-rake gitlab:env:info\n\nSystem information  \nSystem:  \nProxy:          no  \nCurrent User:   git  \nUsing RVM:      no  \nRuby Version:   3.0.6p216  \nGem Version:    3.4.13  \nBundler Version:2.4.14  \nRake Version:   13.0.6  \nRedis Version:  6.2.11  \nSidekiq Version:6.5.7  \nGo Version:     unknown\n\nGitLab information  \nVersion:        16.1.2-ee  \nRevision:       0642e8c5c91  \nDirectory:      /opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:     PostgreSQL  \nDB Version:     13.11  \nURL:            https://gitlab.example.com  \nHTTP Clone URL: https://gitlab.example.com/some-group/some-project.git  \nSSH Clone URL:  git@gitlab.example.com:some-group/some-project.git  \nElasticsearch:  no  \nGeo:            no  \nUsing LDAP:     no  \nUsing Omniauth: yes  \nOmniauth Providers: \n\nGitLab Shell  \nVersion:        14.23.0  \nRepository storages:  \n- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket  \nGitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell  \n```\n\n####  Impact\n\nThe Asset Proxy is a privacy and security feature to prevent visitors to pages on the Gitlab instance from being tracked by malicious users and malicious remote servers. This bug allows a malicious user to bypass this feature and add non-proxied image tags wherever markdown is accepted on Gitlab and track visitors.  \nImpact depends on how much importance people place on privacy and the asset proxy.\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [image.png](https://h1.sec.gitlab.net/a/eaffa5c5-fb38-44cf-b47e-459046e299a0/image.png)\n* [image.png](https://h1.sec.gitlab.net/a/1329440b-9ef5-4518-bf42-8c278353ac4c/image.png)\n* [image.png](https://h1.sec.gitlab.net/a/f78f95eb-13d3-4f80-a602-464866acaa64/image.png)\n\n\u003c/details\u003e\n\n## How To Reproduce on GitLab.com\n\nPlease add [reproducibility information] to this section:\n\n1. Create an Issue on GitLab.com\n1. Enter the following markdown:\n\n```\n# Markdown\n\n![](https://i.imgur.com/5ADf1jq.png)\n\n# HTML\n\n\u003cimg src=\&quot;https://i.imgur.com/5ADf1jq.png\&quot; alt=\&quot;html image\&quot; /\u003e\n\n# HTML plus ascii\n\n\u003cimg src=\&quot;https://i.imgur.com/5ADf1jq.png¬\&quot; alt=\&quot;html image\&quot; /\u003e\n```\n\n1. Observe that the first two images are requested via `user-content.gitlab-static.net` (Good)\n2. Observe that the third image, with the `¬`, is requested direct to `i.imgur.com` which is bypassing the asset proxy.\n\n![Screenshot_2023-07-20_at_4.34.43_PM](/uploads/491ccc0a1cc99c395739c4e0b1b78981/Screenshot_2023-07-20_at_4.34.43_PM.png)&quot;,&quot;title&quot;:&quot;Asset Proxy Bypass using non-ASCII character in asset URI&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:4086191,&quot;created_at&quot;:&quot;2023-07-20T04:34:17Z&quot;,&quot;updated_at&quot;:&quot;2023-10-30T09:56:14Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[{&quot;id&quot;:22241940,&quot;title&quot;:&quot;Category:Team Planning&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;Plan, organize, and track team progress using Scrum, Kanban, SAFe, and other Agile methodologies.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-10-22T13:33:21.426Z&quot;,&quot;updated_at&quot;:&quot;2021-10-22T13:33:21.426Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:27911177,&quot;title&quot;:&quot;Weakness::CWE-20&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Improper Input Validation&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2022-11-17T15:19:16.269Z&quot;,&quot;updated_at&quot;:&quot;2022-11-17T15:19:16.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103451,&quot;title&quot;:&quot;devops::plan&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Plan stage of the DevOps lifecycle (e.g. Project Management, Agile Portfolio Management, Requirements Management)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:00:23.723Z&quot;,&quot;updated_at&quot;:&quot;2022-05-11T06:40:37.661Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10690691,&quot;title&quot;:&quot;group::project management&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Project Management group of the Plan stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/categories/#team-planning-group | PM: @gweaver&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-05-22T19:55:45.218Z&quot;,&quot;updated_at&quot;:&quot;2020-08-28T15:40:02.313Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857543,&quot;title&quot;:&quot;priority::4&quot;,&quot;color&quot;:&quot;#008000&quot;,&quot;description&quot;:&quot;We don&#39;t have visibility when this will be addressed. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:05:19.216Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:24:05.529Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713900,&quot;title&quot;:&quot;severity::4&quot;,&quot;color&quot;:&quot;#008000&quot;,&quot;description&quot;:&quot;Low - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:07.848Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:39.737Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:1,&quot;author_id&quot;:2741139,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:4992072,&quot;username&quot;:&quot;dcouture&quot;,&quot;name&quot;:&quot;Dominic Couture&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.com/uploads/-/system/user/avatar/4992072/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/dcouture&quot;}],&quot;due_date&quot;:&quot;2023-12-22&quot;,&quot;project_id&quot;:278964,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/gitlab-org/gitlab/-/issues/419213&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/gitlab-org/gitlab/notes?target_id=131063629\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=419213\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:131063629,&quot;projectId&quot;:278964,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/gitlab-org/gitlab/-/issues/419213/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/gitlab-org/gitlab/-/issues/419213.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/gitlab-org/gitlab/-/issues/419213.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/gitlab-org/gitlab/noteable/issue/131063629/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736554120000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/gitlab-org/gitlab/-/issues/419213.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="gitlab-org" data-issue-id="131063629" data-issue-iid="419213" data-project-path="gitlab-org/gitlab"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="419213" data-issuable-type="issue" data-labels-fetch-path="/gitlab-org/gitlab/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/gitlab-org/gitlab/-/labels" data-project-issues-path="/gitlab-org/gitlab/-/issues" data-project-path="gitlab-org/gitlab" data-selected-labels="[{&quot;id&quot;:22241940,&quot;title&quot;:&quot;Category:Team Planning&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;Plan, organize, and track team progress using Scrum, Kanban, SAFe, and other Agile methodologies.&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-10-22T13:33:21.426Z&quot;,&quot;updated_at&quot;:&quot;2021-10-22T13:33:21.426Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:27911177,&quot;title&quot;:&quot;Weakness::CWE-20&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Improper Input Validation&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2022-11-17T15:19:16.269Z&quot;,&quot;updated_at&quot;:&quot;2022-11-17T15:19:16.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103451,&quot;title&quot;:&quot;devops::plan&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Plan stage of the DevOps lifecycle (e.g. Project Management, Agile Portfolio Management, Requirements Management)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:00:23.723Z&quot;,&quot;updated_at&quot;:&quot;2022-05-11T06:40:37.661Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10690691,&quot;title&quot;:&quot;group::project management&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Project Management group of the Plan stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/categories/#team-planning-group | PM: @gweaver&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-05-22T19:55:45.218Z&quot;,&quot;updated_at&quot;:&quot;2020-08-28T15:40:02.313Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857543,&quot;title&quot;:&quot;priority::4&quot;,&quot;color&quot;:&quot;#008000&quot;,&quot;description&quot;:&quot;We don&#39;t have visibility when this will be addressed. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:05:19.216Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:24:05.529Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713900,&quot;title&quot;:&quot;severity::4&quot;,&quot;color&quot;:&quot;#008000&quot;,&quot;description&quot;:&quot;Low - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:07.848Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:39.737Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="419213" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="gitlab-org" data-issue-id="131063629" data-issue-iid="419213" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="419213" data-project-path="gitlab-org/gitlab"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="gitlab-org/gitlab" data-iid="419213" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/gitlab-org/gitlab/-/issues/419213.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/gitlab-org/gitlab/-/issues/419213/toggle_subscription","moveIssueEndpoint":"/gitlab-org/gitlab/-/issues/419213/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=278964","editable":"","currentUser":{},"rootPath":"/","fullPath":"gitlab-org/gitlab","iid":419213,"id":131063629,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="xfGkNGE3FREfNtj8W5uRBw==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="xfGkNGE3FREfNtj8W5uRBw==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

