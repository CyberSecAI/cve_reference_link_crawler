[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# Suite CRM v7.14.2 - RCE via LFI

## Summary

|  |  |
| --- | --- |
| **Name** | Suite CRM v7.14.2 - RCE via LFI |
| **Code name** | [Silva](https://en.wikipedia.org/wiki/Lil_Silva) |
| **Product** | Suite CRM |
| **Affected versions** | Version 7.14.2 |
|
| **State** | Public |
| **Release date** | 2024-02-19 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Local file inclusion (LFI) |
| **Rule** | [123. Local file inclusion (LFI)](https://docs.fluidattacks.com/criteria/vulnerabilities/123) |
| **Remote** | Yes |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H |
| **CVSSv3.1 Base Score** | 9.9 |
| **Exploit available** | No |
| **CVE ID(s)** | [CVE-2024-1644](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1644) |

## Description

Suite CRM version 7.14.2 allows including local php files. This is possible
because the application is vulnerable to LFI.

## Vulnerability

A local file inclusion (LFI) vulnerability has been identified in Suite CRM
that, under certain conditions, could allow an attacker to obtain remote
command execution. The attacker must have minimum privileges.

## Vulnerable path

Below I will show you the vulnerable path in code, from the source to the sink.

```
// Index.php
use App\Kernel;
use Symfony\Component\ErrorHandler\Debug;
use Symfony\Component\HttpFoundation\Request;

[...]

$legacyRoute = $kernel->getLegacyRoute($request);

if (!empty($legacyRoute)) {

    $path = './legacy';
    if (!empty($legacyRoute['dir'])) {
        $path .= '/' . $legacyRoute['dir'];
    }

    chdir($path);

    $access = $legacyRoute['access'] ?? false;
    if ($access === false) {
        http_response_code(404);
        exit;
    }

    if (file_exists($legacyRoute['file'])) {

        /* @noinspection PhpIncludeInspection */
        require $legacyRoute['file']; // Vulnerability Here
    } else {

        http_response_code(404);
        exit;
    }

}
[...]

```
```
// Kernel.php
public function getLegacyRoute(Request $request): array {
 $this->initializeBundles();
 $this->initializeContainer();

 if ($this->container->has('legacy.route.handler')) {
 return $this->container->get('legacy.route.handler')->getLegacyRoute($request);
    }

    return [];
}

```
```
// LegacyRouteHandler.php
public function getLegacyRoute(Request $request): array {
 [...]

 if ($this->isLegacyNonViewActionRoute($request)) {
 return $this->legacyNonViewActionRedirectHandler->getIncludeFile($request);
    }

    [...]
}

```
```
// LegacyRedirectHandler.php
public function getIncludeFile(Request $request): array {
 $baseUrl = $request->getPathInfo(); // Anything after the index.php file

 $baseUrl = substr($baseUrl, 1);

 if (strpos($baseUrl, '.php') === false) {
 $baseUrl .= 'index.php';
 }

 return [
 'dir' => '',
 'file' => $baseUrl, // Arbitrary path (with custom wrapper)
 'access' => true
    ];
}

```
## Evidence of exploitation

Create a product and upload a malicious image

Include the image from the previous step with the LFI to achieve RCE

## Our security policy

We have reserved the ID CVE-2024-1644 to refer to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: Suite CRM 7.14.2
* Operating System: MacOS

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by [Carlos
Bello](https://www.linkedin.com/in/carlos-andres-bello) from Fluid Attacks'
Offensive Team.

## References

**Vendor page** <https://github.com/salesagility/SuiteCRM/>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-01-05

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-01-05

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-01-10

Vendor replied acknowledging the report.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-01-10

Vendor Confirmed the vulnerability.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-02-19

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)

