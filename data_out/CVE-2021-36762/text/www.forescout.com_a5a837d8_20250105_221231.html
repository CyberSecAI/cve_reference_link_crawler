

* [Blog](https://www.forescout.com/blog/ "Blog")
* [Contact](/company/contact-us "Contact")
* [Login](https://www.forescout.com/support/login "Login")
  + [Community Portal](https://forescout.my.site.com/support/cp_communitylogin "Community Portal")
  + [Forescout Cloud (XDR/REM)](https://app.command.cysiv.com/login "Forescout Cloud (XDR/REM)")

Select Region

* [China (中文)](https://zh.forescout.com "China (中文)")
* [France (Français)](https://forescout.fr "France (Français)")
* [Germany (Deutsch)](https://forescout.de "Germany (Deutsch)")
* [Italy (Italiano)](https://forescout.it "Italy (Italiano)")
* [Japan (日本語)](https://forescout.jp "Japan (日本語)")
* [Latin America (Español)](https://forescout.lat "Latin America (Español)")
* [Spain (Español)](https://forescouttechnologies.es "Spain (Español)")

Open Search

[Forescout](https://www.forescout.com "Forescout")

* [Platform](/products "Platform")

  + [### Platform

    ![network security icon](/wp-content/uploads/2023/04/platform-diagram-in-screen.webp)

    Manage risks.

    Contain events.

    Mitigate threats.

    Learn More](/products/ "Platform")
  + [### Risk and Exposure Management

    ![REM icon](/wp-content/uploads/2023/07/REM-icon-color.svg)

    Identify exposures, prioritize risks, mitigate threats

    Learn More](/solutions/risk-and-exposure-management/ "Risk and Exposure Management")
  + [### Network Security

    ![network security icon](/wp-content/uploads/2023/07/Network-Security-icon-color.svg)

    Assess, segment and enforce with proactive and reactive controls

    Learn More](/solutions/network-security/ "Network Security")
  + [### Threat Detection and Response

    ![XDR icon](/wp-content/uploads/2023/07/XDR-icon-color.svg)

    Detect, investigate and respond to true threats and incidents

    Learn More](/solutions/threat-detection-and-response/ "Threat Detection & Response")
  + [### Operational Technology Security

    ![OT Security](/wp-content/uploads/2024/09/OT-security-icon.svg)

    Reduce operational and security risk in OT/ICS environments

    Learn More](https://www.forescout.com/solutions/ot-security/ "Operational Technology Security")
* [Solutions](https://www.forescout.com/solutions/ "Solutions")

  ### By Use Case

  + [Asset Inventory](/solutions/asset-inventory/ "Asset Inventory")
  + [IoT Security](/solutions/iot-security/ "IoT Security")
  + [OT Security](/solutions/ot-security/ "OT Security")
  + [Medical Device Security](/solutions/medical-device-security/ "Medical Device Security")
  + [Network Access Control](/solutions/network-access-control/ "Network Access Control")
  + [Network Segmentation](/solutions/network-segmentation/ "Network Segmentation")
  ###

  + [Zero Trust](/solutions/zero-trust/ "Zero Trust")
  + [Device Compliance](/solutions/device-compliance/ "Device Compliance")
  + [Security Automation](/solutions/security-automation/ "Security Automation")
  + [SIEM Modernization](/solutions/siem-modernization/ "SIEM Modernization")
  ### By Industry

  + [Financial Services](/solutions/financial-services/ "Financial Services")
  + [Government](/solutions/government/ "Government")
  + [Healthcare](/solutions/healthcare/ "Healthcare")
  + [Energy & Utilities](/solutions/power-utilities/ "Energy & Utilities")
  + [Oil & Gas](/solutions/oil-gas/ "Oil & Gas")
  + [Manufacturing](/solutions/manufacturing/ "Manufacturing")
  + [Education](/solutions/education/ "Education")
  ### SERVICES

  + [Assist for Forescout Threat Detection & Response](/products/assist-for-xdr/ "Assist for Forescout Threat Detection & Response")
  + [Professional Services](/products/professional-services/ "Professional Services")
* [Research](https://www.forescout.com/research-labs/ "Research")

  + [### Featured Research

    ![Unveiling the Persistent Risk of Connected Medical Devices](/wp-content/uploads/2024/10/FS-2024-VL-Risks-of-MDS-Report-Nav-v1-1200x628-1.jpg)The Persistent Risk of Connected Medical Devices

    Learn More](/research-labs/risk-of-connected-medical-devices/ "Featured Research")
  ### ForescoutVedere Labs

  + [About Vedere Labs](https://www.forescout.com/research-labs/ "About Vedere Labs")
  + [Our Threat Intelligence](https://www.forescout.com/research-labs/threat-intelligence/ "Our Threat Intelligence")
  + [Research Blogs](/research-labs#Research-Blogs "Research Blogs")
  + [Contact Vedere Labs](https://www.forescout.com/vedere-labs-contact/ "Contact Vedere Labs")
  ### Vulnerability

  + [Overview](https://www.forescout.com/research-labs-overview/ "Overview")
  + [Dray:Break](/research-labs/draytek-dray-break/ "Dray:Break")
  + [Sierra:21](https://www.forescout.com/research-labs/sierra21/ "Sierra:21")
  + [OT:ICEFALL](https://www.forescout.com/research-labs/ot-icefall/ "OT:ICEFALL")
  + [Vendor Security Advisories](https://www.forescout.com/research-labs/vendor-security-advisories/ "Vendor Security Advisories")
  ### Threat Reports

  + [Overview](https://www.forescout.com/threat-briefings/ "Overview")
  + [The Persistent Risk of IoMT](https://www.forescout.com/research-labs/risk-of-connected-medical-devices/ "The Persistent Risk of IoMT")
  + [2024H1 Threat Review](https://www.forescout.com/research-labs/2024h1-threat-review/ "2024H1 Threat Review")
  + [Rough Around the Edges](https://www.forescout.com/research-labs/ot-iot-routers-in-the-software-supply-chain/ "Rough Around the Edges")
  + [Riskiest Connected Devices](https://www.forescout.com/research-labs/riskiest-devices/ "Riskiest Connected Devices")
* [Customers](/support-hub "Customers")

  + [### What’s New

    ![Customer Hub](/wp-content/uploads/2023/04/Customer-login-350x175-1.jpg)

    Explore](/support-hub/whats-new/ "What's New")
  ### Support

  + [Support Options](https://www.forescout.com/support-hub/customer-support/ "Support Options")
  + [Technical Documentation](https://docs.forescout.com/ "Technical Documentation")
  + [End of Life](https://www.forescout.com/support-hub/end-of-life/ "End of Life")
  ### Learn

  + [Training Academy](/support-hub/training-academy/ "Training Academy")
  + [Course Calendar](https://www.forescout.com/support-hub/training/ "Course Calendar")
  + [How-To Videos](https://youtube.com/playlist?list=PL2HYJud3zBqebOv-7K89yJfOTygY7wTsV "How-To Videos")
  ### ENGAGE & EXPLORE

  + [User Community](https://www.forescoutcommunity.com "User Community")
  + [Customer Advocacy](https://www.forescout.com/support-hub/customer-advocacy/ "Customer Advocacy")
  + [Success Stories](/success-stories/ "Success Stories")
  + [Customer Events](/events/?event-type=customer-event "Customer Events")
  ### Optimize & Extend

  + [Forescout Marketplace](https://marketplace.forescout.com/en-US/home "Forescout Marketplace")
  + [Professional Services](https://www.forescout.com/support-hub/professional-services/ "Professional Services")
* [Resources](https://www.forescout.com/resources/ "Resources")

  + [### BLOG

    ![](/wp-content/uploads/2024/12/Cybersecurity-Predictions-2024-Nav-v1-1200x628-1.webp)7 Cybersecurity Predictions for 2025: Prepare for a Bumpy Ride

    Read Blog](/blog/7-cybersecurity-predictions-for-2025-prepare-for-a-bumpy-ride/ "Featured Blog")
  + [### WEBINAR

    ![](/wp-content/uploads/2024/10/FS-2024-VL-Persistent-Risks-MDS-Webinar-Feature-v1-1200x628-1.jpg)The Persistent Risk of Connected Medical Devices

    Register Now](/webinars/persistent-risk-of-connected-medical-devices-main/ "Featured Webinar")
  ### More Resources

  + [Compliance Center](/solutions/compliance-center/ "Compliance Center")
  + [Resource Center](https://www.forescout.com/resources/ "Resource Center")
  + [Blog](https://www.forescout.com/blog/ "Blog")
  + [Webinars](https://www.forescout.com/webinars/ "Webinars")
  + [Success Stories](/success-stories/ "Success Stories")
  + [Forescout vs. the Competition](/compare/ "Forescout vs. the Competition")
  + [Cybersecurity A-Z](/glossary/ "Cybersecurity A-Z")
* [Partners](/partners/ "Partners")

  + [### Marketplace

    ![marketplace](https://www.forescout.com/wp-content/uploads/2023/12/marketplace_350x175-5.jpg)

    Explore](https://marketplace.forescout.com/en-US/home "Marketplace")
  ### Strategic Alliances

  + [Microsoft](https://www.forescout.com/partners/technology-partners/microsoft/ "Microsoft")
  + [ServiceNow](https://www.forescout.com/partners/technology-partners/servicenow/ "ServiceNow")
  + [CrowdStrike](https://www.forescout.com/partners/technology-partners/crowdstrike/ "CrowdStrike")
  ### Channel Partners

  + [Distributors](https://www.forescout.com/partners/distributors/ "Distributors")
  + [Resellers](https://www.forescout.com/partners/resellers/ "Resellers")
  + [Managed Service Providers](/partners/msp "Managed Service Providers")
  + [Consulting Partners](https://www.forescout.com/partners/consulting-partners/ "Consulting Partners")
  ###

  + [Global System Integrators](https://www.forescout.com/partners/system-integrators/ "Global System Integrators")
  + [Deployment Partners](https://www.forescout.com/partners/service-delivery/ "Deployment Partners")
  + [Industrial Automation & Control Partners](https://www.forescout.com/partners/industrial-control-systems/ "Industrial Automation & Control Partners")
  ### Ecosystem Partners

  + [Overview](https://www.forescout.com/partners/technology-partners/ "Overview")
  + [Forescout Marketplace](https://marketplace.forescout.com "Forescout Marketplace")
  + [Hardware Partners](/partners/hardware-technology-partners/ "Hardware Partners")
* [Company](/company/ "Company")

  + [### About Us

    ![Forescout office](https://www.forescout.com/wp-content/uploads/2023/07/plano-office-350x175-1.jpg)

    Global Cybersecurity Leader, automated cybersecurity at scale

    Learn More](/company/ "About Us")
  + [### Latest News

    ![Featured Press Release](/wp-content/uploads/2023/12/news-on-computer-featured-300x150-1.jpg)

    What Devices Pose the Highest Security Risk? Forescout Answers…

    Learn More](/press-releases/what-devices-pose-the-highest-security-risk-forescout-answers-in-new-research-the-riskiest-connected-devices-in-2024/ "Latest News")
  ### More Forescout

  + [Events](https://www.forescout.com/events/ "Events")
  + [Awards & Recognition](https://www.forescout.com/company/awards/ "Awards & Recognition")
  + [Press & Media](https://www.forescout.com/company/news-press/ "Press & Media")
  + [Webinars](https://www.forescout.com/webinars/ "Webinars")
  ###

  + [Leadership](/company/#leadership "Leadership")
  + [Careers](https://www.forescout.com/company/careers/ "Careers")
  + [Contact Us](/company/contact-us "Contact Us")
  + [Legal](/company/legal/ "Legal")
* [DEMO](/demo/ "DEMO")

Show/Hide Menu

* [Platform](/products "Platform")
  Open Dropdown

  + [Platform](/products/ "Platform")
  + [Risk and Exposure Management](/solutions/risk-and-exposure-management/ "Risk and Exposure Management")
  + [Network Security](/solutions/network-security/ "Network Security")
  + [Threat Detection & Response](/solutions/threat-detection-and-response/ "Threat Detection & Response")
  + [Operational Technology Security](https://www.forescout.com/solutions/ot-security/ "Operational Technology Security")
* [Solutions](https://www.forescout.com/solutions/ "Solutions")
  Open Dropdown

  ### By Use Case

  + [Asset Inventory](/solutions/asset-inventory/ "Asset Inventory")
  + [IoT Security](/solutions/iot-security/ "IoT Security")
  + [OT Security](/solutions/ot-security/ "OT Security")
  + [Medical Device Security](/solutions/medical-device-security/ "Medical Device Security")
  + [Network Access Control](/solutions/network-access-control/ "Network Access Control")
  + [Network Segmentation](/solutions/network-segmentation/ "Network Segmentation")
  ###

  + [Zero Trust](/solutions/zero-trust/ "Zero Trust")
  + [Device Compliance](/solutions/device-compliance/ "Device Compliance")
  + [Security Automation](/solutions/security-automation/ "Security Automation")
  + [SIEM Modernization](/solutions/siem-modernization/ "SIEM Modernization")
  ### By Industry

  + [Financial Services](/solutions/financial-services/ "Financial Services")
  + [Government](/solutions/government/ "Government")
  + [Healthcare](/solutions/healthcare/ "Healthcare")
  + [Energy & Utilities](/solutions/power-utilities/ "Energy & Utilities")
  + [Oil & Gas](/solutions/oil-gas/ "Oil & Gas")
  + [Manufacturing](/solutions/manufacturing/ "Manufacturing")
  + [Education](/solutions/education/ "Education")
  ### SERVICES

  + [Assist for Forescout Threat Detection & Response](/products/assist-for-xdr/ "Assist for Forescout Threat Detection & Response")
  + [Professional Services](/products/professional-services/ "Professional Services")
* [Research](https://www.forescout.com/research-labs/ "Research")
  Open Dropdown

  + [Featured Research](/research-labs/risk-of-connected-medical-devices/ "Featured Research")
  ### ForescoutVedere Labs

  + [About Vedere Labs](https://www.forescout.com/research-labs/ "About Vedere Labs")
  + [Our Threat Intelligence](https://www.forescout.com/research-labs/threat-intelligence/ "Our Threat Intelligence")
  + [Research Blogs](/research-labs#Research-Blogs "Research Blogs")
  + [Contact Vedere Labs](https://www.forescout.com/vedere-labs-contact/ "Contact Vedere Labs")
  ### Vulnerability

  + [Overview](https://www.forescout.com/research-labs-overview/ "Overview")
  + [Dray:Break](/research-labs/draytek-dray-break/ "Dray:Break")
  + [Sierra:21](https://www.forescout.com/research-labs/sierra21/ "Sierra:21")
  + [OT:ICEFALL](https://www.forescout.com/research-labs/ot-icefall/ "OT:ICEFALL")
  + [Vendor Security Advisories](https://www.forescout.com/research-labs/vendor-security-advisories/ "Vendor Security Advisories")
  ### Threat Reports

  + [Overview](https://www.forescout.com/threat-briefings/ "Overview")
  + [The Persistent Risk of IoMT](https://www.forescout.com/research-labs/risk-of-connected-medical-devices/ "The Persistent Risk of IoMT")
  + [2024H1 Threat Review](https://www.forescout.com/research-labs/2024h1-threat-review/ "2024H1 Threat Review")
  + [Rough Around the Edges](https://www.forescout.com/research-labs/ot-iot-routers-in-the-software-supply-chain/ "Rough Around the Edges")
  + [Riskiest Connected Devices](https://www.forescout.com/research-labs/riskiest-devices/ "Riskiest Connected Devices")
* [Customers](/support-hub "Customers")
  Open Dropdown

  + [What's New](/support-hub/whats-new/ "What's New")
  ### Support

  + [Support Options](https://www.forescout.com/support-hub/customer-support/ "Support Options")
  + [Technical Documentation](https://docs.forescout.com/ "Technical Documentation")
  + [End of Life](https://www.forescout.com/support-hub/end-of-life/ "End of Life")
  ### Learn

  + [Training Academy](/support-hub/training-academy/ "Training Academy")
  + [Course Calendar](https://www.forescout.com/support-hub/training/ "Course Calendar")
  + [How-To Videos](https://youtube.com/playlist?list=PL2HYJud3zBqebOv-7K89yJfOTygY7wTsV "How-To Videos")
  ### ENGAGE & EXPLORE

  + [User Community](https://www.forescoutcommunity.com "User Community")
  + [Customer Advocacy](https://www.forescout.com/support-hub/customer-advocacy/ "Customer Advocacy")
  + [Success Stories](/success-stories/ "Success Stories")
  + [Customer Events](/events/?event-type=customer-event "Customer Events")
  ### Optimize & Extend

  + [Forescout Marketplace](https://marketplace.forescout.com/en-US/home "Forescout Marketplace")
  + [Professional Services](https://www.forescout.com/support-hub/professional-services/ "Professional Services")
* [Resources](https://www.forescout.com/resources/ "Resources")
  Open Dropdown

  + [Featured Blog](/blog/7-cybersecurity-predictions-for-2025-prepare-for-a-bumpy-ride/ "Featured Blog")
  + [Featured Webinar](/webinars/persistent-risk-of-connected-medical-devices-main/ "Featured Webinar")
  ### More Resources

  + [Compliance Center](/solutions/compliance-center/ "Compliance Center")
  + [Resource Center](https://www.forescout.com/resources/ "Resource Center")
  + [Blog](https://www.forescout.com/blog/ "Blog")
  + [Webinars](https://www.forescout.com/webinars/ "Webinars")
  + [Success Stories](/success-stories/ "Success Stories")
  + [Forescout vs. the Competition](/compare/ "Forescout vs. the Competition")
  + [Cybersecurity A-Z](/glossary/ "Cybersecurity A-Z")
* [Partners](/partners/ "Partners")
  Open Dropdown

  + [Marketplace](https://marketplace.forescout.com/en-US/home "Marketplace")
  ### Strategic Alliances

  + [Microsoft](https://www.forescout.com/partners/technology-partners/microsoft/ "Microsoft")
  + [ServiceNow](https://www.forescout.com/partners/technology-partners/servicenow/ "ServiceNow")
  + [CrowdStrike](https://www.forescout.com/partners/technology-partners/crowdstrike/ "CrowdStrike")
  ### Channel Partners

  + [Distributors](https://www.forescout.com/partners/distributors/ "Distributors")
  + [Resellers](https://www.forescout.com/partners/resellers/ "Resellers")
  + [Managed Service Providers](/partners/msp "Managed Service Providers")
  + [Consulting Partners](https://www.forescout.com/partners/consulting-partners/ "Consulting Partners")
  ###

  + [Global System Integrators](https://www.forescout.com/partners/system-integrators/ "Global System Integrators")
  + [Deployment Partners](https://www.forescout.com/partners/service-delivery/ "Deployment Partners")
  + [Industrial Automation & Control Partners](https://www.forescout.com/partners/industrial-control-systems/ "Industrial Automation & Control Partners")
  ### Ecosystem Partners

  + [Overview](https://www.forescout.com/partners/technology-partners/ "Overview")
  + [Forescout Marketplace](https://marketplace.forescout.com "Forescout Marketplace")
  + [Hardware Partners](/partners/hardware-technology-partners/ "Hardware Partners")
* [Company](/company/ "Company")
  Open Dropdown

  + [About Us](/company/ "About Us")
  + [Latest News](/press-releases/what-devices-pose-the-highest-security-risk-forescout-answers-in-new-research-the-riskiest-connected-devices-in-2024/ "Latest News")
  ### More Forescout

  + [Events](https://www.forescout.com/events/ "Events")
  + [Awards & Recognition](https://www.forescout.com/company/awards/ "Awards & Recognition")
  + [Press & Media](https://www.forescout.com/company/news-press/ "Press & Media")
  + [Webinars](https://www.forescout.com/webinars/ "Webinars")
  ###

  + [Leadership](/company/#leadership "Leadership")
  + [Careers](https://www.forescout.com/company/careers/ "Careers")
  + [Contact Us](/company/contact-us "Contact Us")
  + [Legal](/company/legal/ "Legal")
* [DEMO](/demo/ "DEMO")

Ornamental dots. Two rows of three dots. The top row is a light blue. The bottom row is one light blue dot followed by two orange dots.

Blog

# New Critical Operational Technology Vulnerabilities Found on NicheStack – Mitigation Advised

Forescout Research - Vedere Labs | August 4, 2021

Share This: [Share on Linkedin](https://www.linkedin.com/sharing/share-offsite/?url=https://www.forescout.com/blog/new-critical-operational-technology-vulnerabilities-found-on-nichestack "Share on Linkedin")[Share on Twitter](https://twitter.com/intent/tweet?url=https://www.forescout.com/blog/new-critical-operational-technology-vulnerabilities-found-on-nichestack&text=New Critical Operational Technology Vulnerabilities Found on NicheStack – Mitigation Advised "Share on Twitter")[Share on Facebook](https://www.facebook.com/sharer/sharer.php?u=https://www.forescout.com/blog/new-critical-operational-technology-vulnerabilities-found-on-nichestack "Share on Facebook")

[Forescout Research Labs](/research-labs/) and [JFrog](https://jfrog.com/) Security Research have discovered a set of 14 new vulnerabilities affecting the NicheStack TCP/IP stack, which we are collectively calling INFRA:HALT. The new vulnerabilities allow for remote code execution, denial of service, information leak, TCP spoofing, or DNS cache poisoning.

NicheStack is used in Operational Technology (OT) devices commonly found in several critical infrastructure sectors, and we estimate major OT device vendors are impacted by these vulnerabilities.

Forescout Research Labs and JFrog Security Research are committed to supporting vendors in identifying affected products (our [open-source TCP/IP stack detector](https://github.com/Forescout/project-memoria-detector) can be helpful in this respect) and to sharing our findings with the cybersecurity community. The nature of these vulnerabilities could lead to heightened risk and expose national critical infrastructure at a time when the industry is seeing an increase in OT attacks against global utilities, oil and gas pipeline operators as well as healthcare and the supply chain.

INFRA:HALT further illustrates the problems with TCP/IP stacks that we have seen before in [Project Memoria](/research-labs/project-memoria/). There are examples of memory corruption issues seen in AMNESIA:33 (on ICMPv4 and TCPv4, like CVE-2020-35683 and CVE-2020-35684), weak ISN generation seen in NUMBER:JACK (CVE-2020-35685), and DNSv4 issues seen in NAME:WRECK (CVE-2020-25767, CVE-2020-25926, CVE-2020-25927, CVE-2020-25928 and CVE-2021-31228).

The table below shows the newly discovered vulnerabilities. All versions of NicheStack before version 4.3 (the latest at the time of research), including NicheLite, are affected. The patches released by HCC Embedded are available [upon request](https://www.hcc-embedded.com/support/security-advisories). Rows are colored according to the CVSS score: yellow for medium or high and red for critical.

| **CVE ID** | **Vendor ID** | **Description** | **Affected component** | **Potential Impact** | **CVSSv3.1 Score** |
| --- | --- | --- | --- | --- | --- |
| **2020-25928** | [HCCSEC-000010](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000010) | The routine for parsing DNS responses does not check the “response data length” field of individual DNS answers, which may cause OOB-R/W. | DNSv4 | RCE | 9.8 |
| **2021-31226** | [HCCSEC-000003](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000003) | A heap buffer overflow exists in the code that parses the HTTP POST request due to lack of size validation. | HTTP | RCE | 9.1 |
| **2020-25767** | [HCCSEC-000007](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000007) | The routine for parsing DNS domain names does not check whether a compression pointer points within the bounds of a packet, which leads to OOB-R. | DNSv4 | DoS Infoleak | 7.5 |
| **2020-25927** | [HCCSEC-000009](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000009) | The routine for parsing DNS responses does not check whether the number of queries/responses specified in the packet header corresponds to the query/response data available in the DNS packet, leading to OOB-R. | DNSv4 | DoS | 8.2 |
| **2021-31227** | [HCCSEC-000004](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000004) | A heap buffer overflow exists in the code that parses the HTTP POST request due to an incorrect signed integer comparison. | HTTP | DoS | 7.5 |
| **2021-31400** | [HCCSEC-000014](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000014) | The TCP out of band urgent data processing function would invoke a panic function if the pointer to the end of the out of band urgent data points out of the TCP segment’s data. If the panic function hadn’t a trap invocation removed it will result in an infite loop and therefore a DoS (continuous loop or a device reset). | TCP | DoS | 7.5 |
| **2021-31401** | [HCCSEC-000015](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000015) | The TCP header processing code doesn’t sanitize the length of the IP length (header + data). With a crafted IP packet an integer overflow would occur whenever the length of the IP data is calculated by subtracting the length of the header from the length of the total IP packet. | TCP | App-dependent | 7.5 |
| **2020-35683** | [HCCSEC-000011](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000011) | The code that parses ICMP packets relies on an unchecked value of the IP payload size (extracted from the IP header) to compute the ICMP checksum. When the IP payload size is set to be smaller than the size of the IP header, the ICMP checksum computation function may read out of bounds. | ICMP | DoS | 7.5 |
| **2020-35684** | [HCCSEC-000012](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000012) | The code that parses TCP packets relies on an unchecked value of the IP payload size (extracted from the IP header) to compute the length of the TCP payload within the TCP checksum computation function. When the IP payload size is set to be smaller than the size of the IP header, the TCP checksum computation function may read out of bounds. A low-impact write-out-of-bounds is also possible. | TCP | DoS | 7.5 |
| **2020-35685** | [HCCSEC-000013](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000013) | TCP ISNs are generated in a predictable manner. | TCP | TCP spoofing | 7.5 |
| **2021-27565** | [HCCSEC-000017](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000017) | Whenever an unknown HTTP request is received, a panic is invoked. | HTTP | DoS | 7.5 |
| **2021-36762** | [HCCSEC-00001](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000016)6 | The TFTP packet processing function doesn’t ensure that a filename is null-terminated, therefore a subsequent call to strlen() upon the file name might read out of bounds of the protocol packet buffer. | TFTP | DoS | 7.5 |
| **2020-25926** | [HCCSEC-000005](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000005) [HCCSEC-000008](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000008) | The DNS client does not set sufficiently random transaction IDs. | DNSv4 | DNS cache poisoning | 4 |
| **2021-31228** | [HCCSEC-000006](https://www.hcc-embedded.com/support/security-advisories/product-security-advisory-hccsec-000006) | Attackers can predict the source port of DNS queries to send forged DNS response packets that will be accepted as valid answers to the DNS client’s request. | DNSv4 | DNS cache poisoning | 4 |

A video showing the effects of exploiting CVE-2020-25928 on Forescout Cyber Lab is available [here](https://www.youtube.com/watch?v=plgtt1BD-nI). More details about some of the vulnerabilities and their exploitation are available on our [technical report](/resources/infrahalt-discovering-mitigating-large-scale-ot-vulnerabilities/).

### Impact

NicheStack is a proprietary TCP/IP stack developed originally by InterNiche Technologies and acquired by HCC Embedded in 2016. The [earliest copyright messages indicate that the stack was created in 1996](https://doc.xdevs.com/doc/ALTERA/DK-AGX125/examples/board_update_portal/software_examples/bsp/ucosii_net_rozipfs/iniche/src/h/net.h), although InterNiche was founded in 1989. The stack was [extended to support IPv6 in 2003](https://www.automation.com/en-us/articles/2003-1/ixxat-automation-introduces-embedded-tcpip-stack-w). In the last two decades, the stack was distributed in several “flavors” by OEMs such as [STMicroelectronics](https://www.electronicspecifier.com/products/design-automation/stmicroelectronics-delivers-free-tcp-ip-stack-for-str91x-designers), [Freescale (NXP](https://www.nxp.com/products/processors-and-microcontrollers/legacy-mpu-mcus/32-bit-coldfire-mcus-mpus/coldfire-microcontrollers/coldfire-v2-mcus/interniches-coldfire-tcp-ip-stack%3ACOLDFIRE_TCPIP)), [Altera (Intel)](https://www.intel.com/content/www/us/en/programmable/products/processors/design-tools/embed-partners/ni2-network-stack.html) and [Microchip](https://ww1.microchip.com/downloads/en/Site_Resource/NicheStack%20IPv4-ProductBrief.pdf) for use with several (real-time) operating systems or its [own simple RTOS called NicheTask](https://www.nxp.com/docs/en/supporting-information/TCPIPSTACKOVR.pdf). It also [served as the basis](https://forum.segger.com/index.php/Thread/1099-DNS-CLIENT-UPDT-support-is-incomplete/)for other TCP/IP stacks, such as SEGGER’s [emNet](https://www.segger.com/products/connectivity/emnet/) (formerly embOS/IP).

Understanding where the vulnerable code is present is notoriously challenging. We try to estimate the impact of INFRA:HALT based on the evidence collected during our research, using three main sources:

1. **A legacy** [**website**](https://web.archive.org/web/20201022200519/http%3A/www.iniche.com%3A80/company/manylogos.php) listing the main customers of InterNiche. According to the website, most of the top industrial automation companies in the world use the stack. Besides those, the website mentions a total **of almost 200 device vendors.**
2. **Shodan Queries**. We queried Shodan, a search engine for connected devices, looking for devices showing some evidence of NicheStack (e.g., application-layer banners). As shown in Figure 16, with a query executed on 08/Mar/2021, we found more than **6400 instances of devices running NicheStack** (using the simple query “InterNiche”). Of those devices, the large majority (6360) run an HTTP server (query “InterNiche Technologies Webserver”), while the others ran mostly FTP (“Welcome to InterNiche embFtp server”), SSH (“SSH-2.0-InternicheSSHServer (c)InterNiche”) or Telnet (“Welcome to InterNiche Telnet Server”) servers.

[![](https://www.forescout.com/wp-content/uploads/2021/08/image1-248x300.png)](/wp-content/uploads/2021/08/image1-1.png)

*Figure 1 – Results for “InterNiche” on Shodan*

[![](/wp-content/uploads/2021/08/image2-256x300.png)](/wp-content/uploads/2021/08/image2-1.png)

*Figure 2 – Results for “InterNiche Technologies Webserver” on Shodan*

3. **Forescout Device Cloud.** Forescout Device Cloud is the world’s largest device knowledge base with 13+ million device fingerprints. We queried it for similar banners as Shodan, as well as other information, based on DHCP signatures, for instance. **We found more than 2500 device instances from 21 vendors**. The most affected customer industry vertical is Process Manufacturing, followed by Retail and Discrete Manufacturing.

![](https://www.forescout.com/wp-content/uploads/2021/07/INFRA-HALT_Figure3_Device-Functions-running-NicheStack-1024x587.png)*Device Functions running NicheStack (source: Forescout Device Cloud)*

![](https://www.forescout.com/wp-content/uploads/2021/07/INFRA-HALT_Figure_4-Devices-running-NicheStack-in-each-vertical-1024x476.png)*Devices running NicheStack in each vertical*

### Mitigation Recommendations

Complete protection against INFRA:HALT requires patching devices running the vulnerable versions of NicheStack. HCC Embedded has made its official patches available upon request and device vendors using this software should provide their own updates to customers.

Given that patching OT devices is notoriously difficult due to their mission-critical nature, we recommend the following mitigation strategy:

* **Discover and inventory devices running NicheStack**. Forescout Research Labs has released an [open-source script](https://github.com/Forescout/project-memoria-detector) that uses active fingerprinting to detect devices running NicheStack. The script is updated constantly with new signatures to follow the latest development of our research. **Forescout has also released an updated Security Policy Template (SPT) for eyeSight to detect devices running the stack (more details below).**
* **Enforce segmentation controls and proper network hygiene** to mitigate the risk from vulnerable devices. Restrict external communication paths and isolate or contain vulnerable devices in zones as a mitigating control if they cannot be patched or until they can be patched.
* **Monitor progressive patches released by affected device vendors** and devise a remediation plan for your vulnerable asset inventory balancing business risk and business continuity requirements.
* **Monitor all network traffic for malicious packets** that try to exploit known vulnerabilities or possible 0-days. Anomalous and malformed traffic should be blocked, or at least alert its presence to network operators. **Forescout has released a script for eyeInspect that detects exploitation attempts against the vulnerabilities in INFRA:HALT (more details below).**

#### The table below provides recommended mitigations for each vulnerability.

| **CVE** | **Affected component** | **Mitigation Recommendation** |
| --- | --- | --- |
| 2020-25928 | DNSv4 client | Disable the DNSv4 client if not needed, or block DNSv4 traffic.  Because there are several vulnerabilities that facilitate DNS spoofing attacks, using internal DNS servers may be not sufficient (attackers may be able to hijack the request-response matching). |
| 2021-27565 2021-31226 2021-31227 | HTTP | Disable HTTP if not needed, or whitelist HTTP connections. |
| 2021-31400 2021-31401 2020-35684 2020-35685 | TCP | For CVE-2021-31400, CVE-2021-31401, and CVE-2020-35684, monitor traffic for malformed IPv4/TCP packets and block them. E.g., having a vulnerable device behind a properly configured firewall should be sufficient. For CVE-2020-35685, we suggest using recommendations we outlined in our [NUMBER:JACK](/company/blog/numberjack-forescout-research-labs-finds-nine-isn-generation-vulnerabilities-affecting-tcpip-stacks/) report, whenever it is feasible. |
| 2020-35683 | ICMPv4 | Monitor traffic for malformed ICPMv4 packets and block them. |

Forescout Research Labs and JFrog Security Research are available to speak with vendors and asset owners that are affected by these vulnerabilities. If you would like to speak with us, please contact your account manager or send an email to [[email protected]](/cdn-cgi/l/email-protection#3e4c5b4d5b5f4c5d567e58514c5b4d5d514b4a105d5153).

### How Forescout can help?

[**eyeSight**](/products/eyesight/) uses the Security Policy Templates (SPTs) module to identify and group vulnerable/potentially vulnerable devices. A new version of the SPT package, which can identify devices vulnerable to INFRA:HALT can be downloaded [here](https://forescout.force.com/support/s/downloads).

Devices in scope for the policy are scanned using active and passive techniques for five protocols (HTTP, TCP, ICMP, Telnet and DCHP) and can match the policy in three categories – high, medium, and low certainty – as follows:

* HTTP and Telnet fingerprint matches give High Certainty. Known vulnerable vendor/models that are classified by Forescout are also used to give High Certainty matches.
* ICMP fingerprint matches give Medium Certainty.
* TCP and DHCP request options matches give Low Certainty.

#### The results of an example scan are shown in the figure below.

[![](https://www.forescout.com/wp-content/uploads/2021/08/screenshot-1.jpg)](/wp-content/uploads/2021/08/image5.png)

*Figure 5 – SPT scan showing devices with high certainty of being vulnerable*

[**eyeInspect**](/products/eyeinspect/) can detect exploitation attempts using the following scripts:

* “INFRA:HALT Monitor” detects exploitation attempts against the InterNiche webserver: **CVE-2021-27565**, **CVE-2021-31226**, **CVE-2021-31227**.
* “Threat Detection Add-Ons” contains detection logic for malformed DNS packets (among many others) that can detect various exploitation attempts against DNS clients, namely: **CVE-2020-25928**, **CVE-2020-25767**, and **CVE-2020-25927**. This script also detects exploitation attempts of vulnerabilities disclosed during the [NAME:WRECK](/research-labs/namewreck/) and [AMNESIA:33 research](/research-labs/amnesia33/).

#### The figure below shows the alert raised by eyeInspect when it detects an exploitation attempt against CVE-2021-31226.

[![](/wp-content/uploads/2021/08/screenshot-2.jpg)](/wp-content/uploads/2021/08/image5.png)

*Figure 6 – eyeInspect detecting the exploitation of CVE-2021-31226*

Finally, [eyeSegment](/platform/eyesegment/) provides network flow mapping of existing communications, which helps to identify unintended communications and enforce appropriate segmentation controls. Once vulnerable devices have been identified, they can be logically grouped to decrease the communications allowed to or from them, thereby limiting the likelihood of compromise and the blast radius if a compromise occurs.

#### The Challenges of Supply Chain Vulnerability Disclosure

In September 2020, Forescout and JFrog Security Research contacted HCC Embedded to notify them of a series of critical vulnerabilities we found on its privately owned TCP/IP stack NicheStack as part of Project Memoria.

[Coordinated vulnerability disclosure (CVD),](https://vuls.cert.org/confluence/display/Wiki/Coordinated%2BVulnerability%2BDisclosure%2BGuidance) especially supply chain vulnerabilities is a [complex process](https://insights.sei.cmu.edu/blog/vulnerability-coordination-and-concurrency-modeling/) that involves considerable effort from multiple stakeholders. By following the CVD model, Forescout and JFrog contacted several coordination agencies including the [Israel National Cyber Directorate](https://protect-us.mimecast.com/s/fRWgCVOyELc0mRwptyfLYG?domain=gov.il), which is in the process of establishing a research collaboration with Forescout, the [CERT](https://www.kb.cert.org/vuls/) Coordination Center, [BSI](https://www.bsi.bund.de/EN/Home/home_node.html) (the German Federal Cyber Security Authority), and [ICS-CERT](https://us-cert.cisa.gov/) (the Industrial Control Systems Cyber Emergency Response Team). [According to CISA](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=4718642), ‘Vulnerability Coordination is the process by which multiple stakeholders in a software vulnerability work together to analyze and address a vulnerability with the goal of eventually disclosing to the public the existence of the vulnerability and guidance on how to mitigate or fix the vulnerability”.

After a lengthy period of discussion, the disclosure date was set for August 4th, but still there are many vendors that have not confirmed or denied being vulnerable

Forescout and JFrog’s intent is to collaborate with affected vendors in a transparent manner, help them to identify impacted products and prepare advisories and only then publish the list of impacted vendors and models alongside a detailed technical report of the research.  This proven responsible disclosure process ensures all community stakeholders have the most complete information and time to prepare to take action on mitigation steps.

### Security Advisories

You can get up-to-date information about impacted vendors and devices on the following links:

* [Project Memoria advisories](https://github.com/Forescout/project-memoria-advisories), maintained by Forescout Research Labs. We encourage any member of the security community that finds missing security advisories related to any of the Project Memoria disclosures (including INFRA:HALT) to contribute to that page by creating a pull request.
* [ICS CERT Advisory](https://us-cert.cisa.gov/ics/advisories/icsa-21-217-01 "https://us-cert.cisa.gov/ics/advisories/icsa-21-217-01")

Share This: [Share on Linkedin](https://www.linkedin.com/sharing/share-offsite/?url=https://www.forescout.com/blog/new-critical-operational-technology-vulnerabilities-found-on-nichestack "Share on Linkedin")[Share on Twitter](https://twitter.com/intent/tweet?url=https://www.forescout.com/blog/new-critical-operational-technology-vulnerabilities-found-on-nichestack&text=New Critical Operational Technology Vulnerabilities Found on NicheStack – Mitigation Advised "Share on Twitter")[Share on Facebook](https://www.facebook.com/sharer/sharer.php?u=https://www.forescout.com/blog/new-critical-operational-technology-vulnerabilities-found-on-nichestack "Share on Facebook")

 [![Forescout](https://www.forescout.com/wp-content/themes/forescout_custom_theme2021/public/images/logo.svg)](https://www.forescout.com "Forescout")
##### Get the latest from Forescout

[Notice of Collection](https://www.forescout.com/company/legal/notice-of-collection/)

* [Solutions](/solutions/ "Solutions")
* [Platform](/products/ "Platform")
* [Forescout Research](https://www.forescout.com/research-labs/ "Forescout Research")
* [Resources](https://www.forescout.com/resources/ "Resources")

* [Partners](/partners/ "Partners")
* [Company](/company/ "Company")
* [Careers](https://www.forescout.com/company/careers/ "Careers")
* [Blog](https://www.forescout.com/blog/ "Blog")

* [Contact Us](/company/contact-us "Contact Us")
* [Cybersecurity A-Z](/glossary/ "Cybersecurity A-Z")

* [LinkedIn](https://www.linkedin.com/company/forescout-technologies "LinkedIn")
* [Twitter](https://twitter.com/Forescout "Twitter")
* [Facebook](https://www.facebook.com/ForescoutTechnologies "Facebook")
* [YouTube](https://www.youtube.com/user/forescout1 "YouTube")

© Forescout 2025

* [Privacy@Forescout](https://www.forescout.com/privacy-policy/ "Privacy@Forescout")
* [Terms of Use](https://www.forescout.com/terms-of-use/ "Terms of Use")
* [Legal](https://www.forescout.com/company/legal/ "Legal")

[Demo Request](/demo "Demo Request")[Forescout Platform](/products/ "Forescout Platform")[Top of Page](#main "Top of Page")

