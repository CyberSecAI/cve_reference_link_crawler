The provided content is related to CVE-2022-41024.

**Root cause of vulnerability:**
The root cause is a stack-based buffer overflow vulnerability in the `DetranCLI` command parsing functionality of Siretta QUARTZ-GOLD G5.0.1.5-210720-141020. The vulnerability occurs due to the usage of `sprintf` with unchecked input sizes when processing command parameters, leading to buffer overflows on the stack.

**Weaknesses/vulnerabilities present:**
The vulnerability is a classic stack-based buffer overflow (CWE-120). The `sprintf` function is used to format strings into a fixed-size buffer on the stack. When the command parameters provided exceed the buffer's size, a buffer overflow occurs.

**Impact of exploitation:**
Successful exploitation of this vulnerability can lead to arbitrary command execution. An attacker can potentially overwrite parts of the stack, including the return address, and take control of the affected device.

**Attack vectors:**
The attack vector is a specially crafted network packet sent to the device, containing the vulnerable command with oversized parameters.

**Required attacker capabilities/position:**
The attacker needs to be able to send network packets to the device and have the required privileges to access the `DetranCLI` interface. The CVSS score indicates that a high privilege is required.
More specifically the vulnerable command for CVE-2022-41024 is
```
no vpn pptp advanced name WORD dns (yes|no) mtu <128-16384> mru <128-16384> mppe (on|off) stateful (on|off)
```
and the vulnerable code is
```
sprintf(buff_0x100,"%d<%s<%d<%s<%s<%d<%d<%s",1,*argv,based_on_argv[1],argv[2],argv[3],based_on_argv[4],based_on_argv[5],"");
```
The attacker controls the `WORD` parameter, which is copied to stack buffer `buff_0x100` without proper size check.