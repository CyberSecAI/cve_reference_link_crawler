```
{
  "vulnerability": {
    "root_cause": "A regression was introduced in commit c73be61cede5 which moved the wakeup for pipe->wr_wait before actually raising pipe->max_usage in the pipe resizing process.",
    "weaknesses": [
      "Incorrect ordering of operations during pipe resizing.",
      "Race condition between pipe resizing and write operations."
    ],
    "impact": "A resized pipe that was full before the resize would result in the wakeup never triggering pipe_write, leading to a potential deadlock or hang situation.",
    "attack_vectors": "Exploiting the pipe resizing mechanism in a way that the pipe is full before the resize.",
    "required_capabilities": "Ability to trigger pipe resizing with a full pipe."
  },
  "patch": {
    "description": "The fix sets the @max_usage and @nr_accounted before waking writers if it isn't a watch queue in the pipe_resize_ring function.",
    "changes": [
      "Modified fs/pipe.c to set pipe->max_usage and pipe->nr_accounted before waking writers."
    ]
  }
}
```