<!DOCTYPE html>
<html lang='en'>
<head>
<title>
Jenkins Security Advisory 2023-07-26
</title>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<meta content='Jenkins â an open source automation server which enables developers around the world to reliably build, test, and deploy their software' name='description'>
<meta charset='utf-8'>
<meta content='width=device-width, initial-scale=1' name='viewport'>
<meta content='ie=edge' http-equiv='x-ua-compatible'>
<link href='https://www.jenkins.io/security/advisory/2023-07-26/' rel='canonical'>
<!-- Favicons -->
<link href='/favicon.ico' rel='shortcut icon' type='image/x-icon'>
<link href='/apple-touch-icon.png' rel='apple-touch-icon' sizes='180x180'>
<link href='/favicon-32x32.png' rel='icon' sizes='32x32' type='image/png'>
<link href='/favicon-16x16.png' rel='icon' sizes='16x16' type='image/png'>
<link href='/site.webmanifest' rel='manifest'>
<link color='#5bbad5' href='/safari-pinned-tab.svg' rel='mask-icon'>
<meta content='#2b5797' name='msapplication-TileColor'>
<meta content='#ffffff' name='theme-color'>
<meta content='Jenkins Security Advisory 2023-07-26' name='apple-mobile-web-app-title'>
<!-- Twitter Card data -->
<meta content='summary_large_image' name='twitter:card'>
<meta content='@JenkinsCI' name='twitter:site'>
<meta content='Jenkins Security Advisory 2023-07-26' name='twitter:title'>
<meta content='Jenkins â an open source automation server which enables developers around the world to reliably build, test, and deploy their software' name='twitter:description'>
<meta content='@JenkinsCI' name='twitter:creator'>
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content='/images/logo-title-opengraph.png' name='twitter:image'>
<!-- Open Graph data -->
<meta content='Jenkins Security Advisory 2023-07-26' property='og:title'>
<meta content='article' property='og:type'>
<meta content='https://www.jenkins.io/security/advisory/2023-07-26/' property='og:url'>
<meta content='Jenkins â an open source automation server which enables developers around the world to reliably build, test, and deploy their software' property='og:description'>
<meta content='Jenkins Security Advisory 2023-07-26' property='og:site_name'>
<meta content='/images/logo-title-opengraph.png' property='og:image'>
<link href='/assets/bower/bootstrap/css/bootstrap.min.css' media='screen' rel='stylesheet'>
<link href='/css/jenkins.css' media='screen' rel='stylesheet'>
<link href='/css/copy-to-clipboard.css' media='screen' rel='stylesheet'>
<link href='/stylesheets/styles.css' media='screen' rel='stylesheet'>
<!-- Non-obtrusive CSS styles -->
<link href='/css/footer.css' media='screen' rel='stylesheet'>
<link href='/css/font-awesome.min.css' media='screen' rel='stylesheet'>
<link href='https://cdn.jsdelivr.net/npm/@docsearch/css@3' rel='stylesheet'>
</head>
<body>
<script src='/assets/bower/jquery/jquery.min.js'></script>
<script src='/js/copy-to-clipboard.js'></script>
<jio-navbar class='fixed-nav' id='ji-toolbar' property='https://www.jenkins.io' showSearchBox theme='auto'></jio-navbar>

<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-lg-9 h' + i);
    }
  })
</script>

<div class='container'>
<div class='row body'>
<div class='col-lg-3'>
<div class='sidebar-nav tour'>
<p>
<a href="/security/" class="">Jenkins Security Home</a>
</p>
<strong>
For Administrators
</strong>
<ul>
<li>
<a href="/security/for-administrators/" class="">Overview</a>
</li>
<li>
<a href="/security/advisories/" class="">Security Advisories</a>
</li>
<li>
<a href="/security/issues/" class="">Security Issues</a>
</li>
<li>
<a href="/security/scheduling/" class="">Advisory Schedule</a>
</li>
<li>
<a href="/security/plugins/" class="">Vulnerabilities in Plugins</a>
</li>
<li>
<a href="/security/fixing/" class="">How We Fix Security Issues</a>
</li>
</ul>
<strong>
For Reporters
</strong>
<ul>
<li>
<a href="/security/reporting/" class="">Reporting Vulnerabilities</a>
</li>
<li>
<a href="/security/cna/" class="">Jenkins CNA</a>
</li>
</ul>
<strong>
For Maintainers
</strong>
<ul>
<li>
<a href="/security/for-maintainers/" class="">Overview</a>
</li>
<li>
<a href="/security/plugins/" class="">Vulnerabilities in Plugins</a>
</li>
</ul>
<strong>
Jenkins Security Team
</strong>
<ul>
<li>
<a href="/security/team/" class="">About</a>
</li>
<li>
<a href="/security/improvements/" class="">Contributions</a>
</li>
</ul>
</div>
</div>
<div class='col-lg-9'>
<h1>
Jenkins Security Advisory 2023-07-26
</h1>
<p>
This advisory announces vulnerabilities in the following Jenkins deliverables:
</p>
<p>
<ul>
<li>
Jenkins (core)
</li>
<li>
<a href='https://plugins.jenkins.io/bazaar'>
Bazaar
Plugin
</a>
</li>
<li>
<a href='https://plugins.jenkins.io/chef-identity'>
Chef Identity
Plugin
</a>
</li>
<li>
<a href='https://plugins.jenkins.io/gitlab-oauth'>
GitLab Authentication
Plugin
</a>
</li>
<li>
<a href='https://plugins.jenkins.io/gradle'>
Gradle
Plugin
</a>
</li>
<li>
<a href='https://plugins.jenkins.io/qualys-was'>
Qualys Web App Scanning Connector
Plugin
</a>
</li>
<li>
<a href='https://plugins.jenkins.io/servicenow-devops'>
ServiceNow DevOps
Plugin
</a>
</li>
</ul>
</p>
<h2>
Descriptions
</h2>
<h3 id='SECURITY-3188'>
Stored XSS vulnerability
</h3>
<strong>
SECURITY-3188
/
CVE-2023-39151
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H'>
High
</a>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Jenkins applies formatting to the console output of builds, transforming plain URLs into hyperlinks.</p>
</div>
<div class="paragraph">
<p>Jenkins 2.415 and earlier, LTS 2.401.2 and earlier does not sanitize or properly encode URLs of these hyperlinks in build logs.</p>
</div>
<div class="paragraph">
<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to control build log contents.</p>
</div>
<div class="paragraph">
<p>Jenkins 2.416, LTS 2.401.3, and LTS 2.414.1 encode URLs of affected hyperlink annotations in build logs.</p>
</div>
<h3 id='SECURITY-3208'>
Incorrect control flow in Gradle Plugin breaks credentials masking in the build log
</h3>
<strong>
SECURITY-3208
/
CVE-2023-39152
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N'>
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href='https://plugins.jenkins.io/gradle'>
<code>gradle</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Gradle Plugin 2.8 improperly invokes APIs available only on the controller from an agent when setting up build log annotations, causing an exception.</p>
</div>
<div class="paragraph">
<p>As a result, credentials may not be masked (i.e., replaced with asterisks) in the build log in some circumstances.</p>
</div>
<div class="paragraph">
<p>Gradle Plugin 2.8.1 improves the control flow and handles the exception, so that credentials masking is not affected.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
An improvement in <a href="https://plugins.jenkins.io/workflow-api/">Pipeline: API</a> 1232.v1679fa_2f0f76 prevents issues like this from affecting credentials masking in the future.
As of the publication of this advisory, the Jenkins security team is not aware of other plugins with a similar issue.
</td>
</tr>
</table>
</div>
<h3 id='SECURITY-2696'>
CSRF vulnerability in GitLab Authentication Plugin
</h3>
<strong>
SECURITY-2696
/
CVE-2023-39153
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N'>
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href='https://plugins.jenkins.io/gitlab-oauth'>
<code>gitlab-oauth</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>GitLab Authentication Plugin 1.17.1 and earlier does not implement a state parameter in its OAuth flow, a unique and non-guessable value associated with each authentication request.</p>
</div>
<div class="paragraph">
<p>This vulnerability allows attackers to trick users into logging in to the attacker&#8217;s account.</p>
</div>
<div class="paragraph">
<p>GitLab Authentication Plugin 1.18 implements a state parameter in its OAuth flow.</p>
</div>
<h3 id='SECURITY-3129'>
CSRF vulnerability and missing permission check in ServiceNow DevOps Plugin allow capturing credentials
</h3>
<strong>
SECURITY-3129
/
CVE-2023-3414 (CSRF), CVE-2023-3442 (missing permission check)
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N'>
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href='https://plugins.jenkins.io/servicenow-devops'>
<code>servicenow-devops</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>ServiceNow DevOps Plugin 1.38.0 and earlier does not perform a permission check in a method implementing form validation.</p>
</div>
<div class="paragraph">
<p>This allows attackers with Overall/Read permission to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.</p>
</div>
<div class="paragraph">
<p>Additionally, this form validation method does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.</p>
</div>
<div class="paragraph">
<p>ServiceNow DevOps Plugin 1.38.1 requires POST requests and Overall/Administer permission for the affected form validation method.</p>
</div>
<h3 id='SECURITY-3012'>
Incorrect permission checks in Qualys Web App Scanning Connector Plugin allow capturing credentials
</h3>
<strong>
SECURITY-3012
/
CVE-2023-39154
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N'>
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href='https://plugins.jenkins.io/qualys-was'>
<code>qualys-was</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Qualys Web App Scanning Connector Plugin 2.0.10 and earlier does not correctly perform permission checks in several HTTP endpoints.</p>
</div>
<div class="paragraph">
<p>This allows attackers with global Item/Configure permission to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.</p>
</div>
<div class="paragraph">
<p>Qualys Web App Scanning Connector Plugin 2.0.11 requires the appropriate permissions for the affected HTTP endpoints.</p>
</div>
<h3 id='SECURITY-3192'>
Secret displayed without masking by Chef Identity Plugin
</h3>
<strong>
SECURITY-3192
/
CVE-2023-39155
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N'>
Low
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href='https://plugins.jenkins.io/chef-identity'>
<code>chef-identity</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Chef Identity Plugin stores the user.pem key in its global configuration file <code>io.chef.jenkins.ChefIdentityBuildWrapper.xml</code> on the Jenkins controller as part of its configuration.</p>
</div>
<div class="paragraph">
<p>While this key is stored encrypted on disk, in Chef Identity Plugin 2.0.3 and earlier the global configuration form does not mask the user.pem key form field, increasing the potential for attackers to observe and capture it.</p>
</div>
<div class="paragraph">
<p>As of publication of this advisory, there is no fix.
<a href="/security/plugins/#unresolved">Learn why we announce this.</a></p>
</div>
<h3 id='SECURITY-3095'>
CSRF vulnerability in Bazaar Plugin
</h3>
<strong>
SECURITY-3095
/
CVE-2023-39156
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N'>
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href='https://plugins.jenkins.io/bazaar'>
<code>bazaar</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Bazaar Plugin 1.22 and earlier does not require POST requests for an HTTP endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.</p>
</div>
<div class="paragraph">
<p>This vulnerability allows attackers to delete previously created Bazaar SCM tags.</p>
</div>
<div class="paragraph">
<p>As of publication of this advisory, there is no fix.
<a href="/security/plugins/#unresolved">Learn why we announce this.</a></p>
</div>
<h2>
Severity
</h2>
<ul>
<li>
SECURITY-2696:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N'>
Medium
</a>
</li>
<li>
SECURITY-3012:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N'>
Medium
</a>
</li>
<li>
SECURITY-3095:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N'>
Medium
</a>
</li>
<li>
SECURITY-3129:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N'>
Medium
</a>
</li>
<li>
SECURITY-3188:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H'>
High
</a>
</li>
<li>
SECURITY-3192:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N'>
Low
</a>
</li>
<li>
SECURITY-3208:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N'>
Medium
</a>
</li>
</ul>
<h2>
Affected Versions
</h2>
<ul>
<li>
<strong>
Jenkins weekly
</strong>
up to and including
2.415
</li>
<li>
<strong>
Jenkins LTS
</strong>
up to and including
2.401.2
</li>
<li>
<strong>
Bazaar
Plugin
</strong>
up to and including
1.22
</li>
<li>
<strong>
Chef Identity
Plugin
</strong>
up to and including
2.0.3
</li>
<li>
<strong>
GitLab Authentication
Plugin
</strong>
up to and including
1.17.1
</li>
<li>
<strong>
Gradle
Plugin
</strong>
up to and including
2.8
</li>
<li>
<strong>
Qualys Web App Scanning Connector
Plugin
</strong>
up to and including
2.0.10
</li>
<li>
<strong>
ServiceNow DevOps
Plugin
</strong>
up to and including
1.38.0
</li>
</ul>
<h2>
Fix
</h2>
<ul>
<li>
<strong>
Jenkins weekly
</strong>
should be updated to version
2.416
</li>
<li>
<strong>
Jenkins LTS
</strong>
should be updated to version
2.401.3 or 2.414.1
</li>
<li>
<strong>
GitLab Authentication
Plugin
</strong>
should be updated to version
1.18
</li>
<li>
<strong>
Gradle
Plugin
</strong>
should be updated to version
2.8.1
</li>
<li>
<strong>
Qualys Web App Scanning Connector
Plugin
</strong>
should be updated to version
2.0.11
</li>
<li>
<strong>
ServiceNow DevOps
Plugin
</strong>
should be updated to version
1.38.1
</li>
</ul>
<p>
These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.
</p>
<p>
As of publication of this advisory, no fixes are available for the following plugins:
</p>
<ul>
<li>
Bazaar
Plugin
</li>
<li>
Chef Identity
Plugin
</li>
</ul>
<p>
<a href='/security/plugins/#unresolved'>
Learn why we announce these issues.
</a>
</p>
<h2>
Credit
</h2>
<p>
The Jenkins project would like to thank the reporters for discovering and
<a href='/security/#reporting-vulnerabilities'>
reporting
</a>
these vulnerabilities:
<ul>
<li>
<strong>
Alvaro MuÃ±oz (@pwntester), GitHub Security Lab
</strong>
for
SECURITY-3129
</li>
<li>
<strong>
Andrea Chiera, CloudBees, Inc.
</strong>
for
SECURITY-3192
</li>
<li>
<strong>
Kevin Guerroudj, CloudBees, Inc.
</strong>
for
SECURITY-3095
</li>
<li>
<strong>
Kevin Guerroudj, CloudBees, Inc. and Devin Nusbaum, CloudBees, Inc.
</strong>
for
SECURITY-3188
</li>
<li>
<strong>
Wadeck Follonier, CloudBees Inc.
</strong>
for
SECURITY-2696
</li>
<li>
<strong>
Yaroslav Afenkin, CloudBees, Inc.
</strong>
for
SECURITY-3012
</li>
</ul>
</p>

</div>
</div>
</div>


<script src='/assets/bower/anchor-js/anchor.min.js'></script>
<script src='/assets/bower/@popperjs/core/umd/popper.min.js'></script>
<script src='/assets/bower/bootstrap/js/bootstrap.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/lit@3.2.1/polyfill-support.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.8.0/webcomponents-loader.js'></script>
<script data='ionicons' defer='' src='https://cdnjs.cloudflare.com/ajax/libs/ionicons/7.4.0/ionicons/ionicons.esm.js' type='module'></script>
<script data='ionicons' defer='' nomodule='' src='https://cdnjs.cloudflare.com/ajax/libs/ionicons/7.4.0/ionicons/ionicons.js'></script>
<script defer='' src='https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm' type='module'></script>
<script defer='' nomodule='' src='https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/'></script>
<jio-footer githubBranch='master' githubRepo='jenkins-infra/jenkins.io' property='https://www.jenkins.io' reportAProblemTemplate='4-bug.yml' sourcePath='content/security/advisory/2023-07-26.adoc'></jio-footer>
<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
</body>
</html>
