

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3146603%2540remember-me-controls%26old%3D3146603%2540remember-me-controls)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2928246/remember-me-controls "Changeset 2928246 for remember-me-controls")
* Next Change →

---

# Changeset [3146603](/changeset/3146603 "Show full changeset") for [remember-me-controls](/browser/remember-me-controls?rev=3146603 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/04/2024 07:20:19 PM
([4 months](/timeline?from=2024-09-04T19%3A20%3A19Z&precision=second "See timeline at 09/04/2024 07:20:19 PM") ago)

Author:
coffee2code
Message:

Release v2.1:

* Change: Update plugin framework to 067
  + 067:
  + Change: Simplify `form_action_url()` to avoid using a server global
  + Change: Use `form_action_url()` in `plugin_action_links()` rather than duplicating its functionality
  + Change: Escape output of all translated strings
  + Change: Convert `register_filters()` to an abstract declaration
  + Change: Improve function documentation
  + Change: Adjust function documentation formatting to align with WP core
  + Change: Note compatibility through WP 6.5+
  + Change: Drop compatibility with version of WP older than 5.5
  + 066:
  + New: Add customization of capability needed to manage plugin settings (via new filter {plugin\_prefix}\_manage\_options\_capability)
  + Change: Make `get_hook()` public rather than protected
  + Change: Add styles for nested lists within settings descriptions
  + Change: Simplify `form_action_url()`
  + Change: Use `form_action_url()` in `plugin_action_links()` rather than duplicating its functionality
  + Change: Explicitly declare object variables rather than doing so dynamically. Fixes [#1](/ticket/1 "#1: defect: Just a test (closed: fixed)").
  + Change: Note compatibility through WP 6.4+
  + Change: Update copyright date (2024)
* Change: Ensure translations don't contain unintended markup
* Change: Add missing inline comments to translators
* Change: Note compatibility through WP 6.6+
* Change: Drop compatibility with versions of WP older than 5.5
* Change: Update copyright date (2024)
* New: Add `.gitignore` file
* Change: Remove development and testing-related files from release packaging
* Change: Reduce number of 'Tags' from `readme.txt`
* Change: Tweak text formatting in `README.md`
* Unit tests:
  + Hardening: Prevent direct web access to `bootstrap.php`. Props stealthcopter.
  + Allow tests to run against current versions of [WordPress](/wiki/WordPress)
  + New: Add `composer.json` for PHPUnit Polyfill dependency
  + Change: Prevent PHP warnings due to missing core-related generated files
  + Change: In bootstrap, store path to plugin directory in a constant

Location:
[remember-me-controls](/browser/remember-me-controls?rev=3146603)
Files:

4 deleted
10 edited
1 copied

* [tags/2.1](/browser/remember-me-controls/tags/2.1?rev=3146603 "Show entry in browser")
  (copied)
  *(copied from [remember-me-controls/trunk](/browser/remember-me-controls/trunk?rev=2928246 "Show original file (revision 3146602)"))*
* [tags/2.1/CHANGELOG.md](/browser/remember-me-controls/tags/2.1/CHANGELOG.md?rev=3146603 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tags/2.1/README.md](/browser/remember-me-controls/tags/2.1/README.md?rev=3146603 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [tags/2.1/c2c-plugin.php](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603 "Show entry in browser")
  (modified)
  ([45 diffs](#file3 "Show differences"))
* [tags/2.1/phpunit.xml.dist](/browser/remember-me-controls/trunk/phpunit.xml.dist?rev=2926197 "Show what was removed (content at revision 3146602)")
  (deleted)
* [tags/2.1/readme.txt](/browser/remember-me-controls/tags/2.1/readme.txt?rev=3146603 "Show entry in browser")
  (modified)
  ([4 diffs](#file5 "Show differences"))
* [tags/2.1/remember-me-controls.php](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603 "Show entry in browser")
  (modified)
  ([13 diffs](#file6 "Show differences"))
* [tags/2.1/tests](/browser/remember-me-controls/trunk/tests?rev=2928246 "Show what was removed (content at revision 3146602)")
  (deleted)
* [trunk/CHANGELOG.md](/browser/remember-me-controls/trunk/CHANGELOG.md?rev=3146603 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [trunk/README.md](/browser/remember-me-controls/trunk/README.md?rev=3146603 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [trunk/c2c-plugin.php](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603 "Show entry in browser")
  (modified)
  ([45 diffs](#file10 "Show differences"))
* [trunk/phpunit.xml.dist](/browser/remember-me-controls/trunk/phpunit.xml.dist?rev=2926197 "Show what was removed (content at revision 3146602)")
  (deleted)
* [trunk/readme.txt](/browser/remember-me-controls/trunk/readme.txt?rev=3146603 "Show entry in browser")
  (modified)
  ([4 diffs](#file12 "Show differences"))
* [trunk/remember-me-controls.php](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603 "Show entry in browser")
  (modified)
  ([13 diffs](#file13 "Show differences"))
* [trunk/tests](/browser/remember-me-controls/trunk/tests?rev=2928246 "Show what was removed (content at revision 3146602)")
  (deleted)

### Legend:

Unmodified
Added
Removed

* ## [remember-me-controls/tags/2.1/CHANGELOG.md](/changeset/3146603/remember-me-controls/tags/2.1/CHANGELOG.md "Show the changeset 3146603 restricted to remember-me-controls/tags/2.1/CHANGELOG.md")

  | [r2928246](/browser/remember-me-controls/trunk/CHANGELOG.md?rev=2928246#L1 "Show revision 2928246 of this file in browser") | [r3146603](/browser/remember-me-controls/tags/2.1/CHANGELOG.md?rev=3146603#L1 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | # Changelog |
  |  | 2 |  |
  |  | 3 | ## 2.1 \_(2024-09-01)\_ |
  |  | 4 |  |
  |  | 5 | ### Highlights: |
  |  | 6 |  |
  |  | 7 | This minor release primarily updates the plugin framework to the most current version (for security hardening and miscellaneous improvements), prevents translations from containing unintended markup, notes compatibility through WP 6.6+, drops compatibility with versions of WP older than 5.5, and removes unit tests from release packaging. |
  |  | 8 |  |
  |  | 9 | ### Details: |
  |  | 10 |  |
  |  | 11 | \* Change: Update plugin framework to 067 |
  |  | 12 | \* 067: |
  |  | 13 | \* Change: Simplify `form\_action\_url()` to avoid using a server global |
  |  | 14 | \* Change: Use `form\_action\_url()` in `plugin\_action\_links()` rather than duplicating its functionality |
  |  | 15 | \* Change: Escape output of all translated strings |
  |  | 16 | \* Change: Convert `register\_filters()` to an abstract declaration |
  |  | 17 | \* Change: Improve function documentation |
  |  | 18 | \* Change: Adjust function documentation formatting to align with WP core |
  |  | 19 | \* Change: Note compatibility through WP 6.5+ |
  |  | 20 | \* Change: Drop compatibility with version of WP older than 5.5 |
  |  | 21 | \* 066: |
  |  | 22 | \* New: Add customization of capability needed to manage plugin settings (via new filter {plugin\_prefix}\_manage\_options\_capability) |
  |  | 23 | \* Change: Make `get\_hook()` public rather than protected |
  |  | 24 | \* Change: Add styles for nested lists within settings descriptions |
  |  | 25 | \* Change: Simplify `form\_action\_url()` |
  |  | 26 | \* Change: Use `form\_action\_url()` in `plugin\_action\_links()` rather than duplicating its functionality |
  |  | 27 | \* Change: Explicitly declare object variables rather than doing so dynamically. Fixes #1. |
  |  | 28 | \* Change: Note compatibility through WP 6.4+ |
  |  | 29 | \* Change: Update copyright date (2024) |
  |  | 30 | \* Change: Ensure translations don't contain unintended markup |
  |  | 31 | \* Change: Add missing inline comments to translators |
  |  | 32 | \* Change: Note compatibility through WP 6.6+ |
  |  | 33 | \* Change: Drop compatibility with versions of WP older than 5.5 |
  |  | 34 | \* Change: Update copyright date (2024) |
  |  | 35 | \* New: Add `.gitignore` file |
  |  | 36 | \* Change: Remove development and testing-related files from release packaging |
  |  | 37 | \* Change: Reduce number of 'Tags' from `readme.txt` |
  |  | 38 | \* Change: Tweak text formatting in `README.md` |
  |  | 39 | \* Unit tests: |
  |  | 40 | \* Hardening: Prevent direct web access to `bootstrap.php`. Props stealthcopter. |
  |  | 41 | \* Allow tests to run against current versions of WordPress |
  |  | 42 | \* New: Add `composer.json` for PHPUnit Polyfill dependency |
  |  | 43 | \* Change: Prevent PHP warnings due to missing core-related generated files |
  |  | 44 | \* Change: In bootstrap, store path to plugin directory in a constant |
  | 2 | 45 |  |
  | 3 | 46 | ## 2.0.1 \_(2023-06-19)\_ |
* ## [remember-me-controls/tags/2.1/README.md](/changeset/3146603/remember-me-controls/tags/2.1/README.md "Show the changeset 3146603 restricted to remember-me-controls/tags/2.1/README.md")

  | [r2114548](/browser/remember-me-controls/trunk/README.md?rev=2114548#L15 "Show revision 2114548 of this file in browser") | [r3146603](/browser/remember-me-controls/tags/2.1/README.md?rev=3146603#L15 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | ## Additional Documentation |
  | 16 | 16 |  |
  | 17 |  | See [readme.txt](https://github.com/coffee2code/remember-me-controls/blob/master/readme.txt) for additional usage information. See [CHANGELOG.md](CHANGELOG.md) for the list of changes for each release. |
  |  | 17 | \* See [readme.txt](https://github.com/coffee2code/remember-me-controls/blob/master/readme.txt) for additional usage information. |
  |  | 18 | \* See [CHANGELOG.md](CHANGELOG.md) for the list of changes for each release. |
  | 18 | 19 |  |
  | 19 | 20 |  |
* ## [remember-me-controls/tags/2.1/c2c-plugin.php](/changeset/3146603/remember-me-controls/tags/2.1/c2c-plugin.php "Show the changeset 3146603 restricted to remember-me-controls/tags/2.1/c2c-plugin.php")

  | [r2926197](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L3 "Show revision 2926197 of this file in browser") | [r3146603](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L3 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @package C2C\_Plugin |
  | 4 | 4 | \* @author  Scott Reilly |
  | 5 |  | \* @version 06~~5~~ |
  |  | 5 | \* @version 067 |
  | 6 | 6 | \*/ |
  | 7 | 7 | /\* |
  | 8 | 8 | Basis for other plugins. |
  | 9 | 9 |  |
  | 10 |  | Compatible with WordPress ~~4.9 through 6.2~~+. |
  |  | 10 | Compatible with WordPress 5.5 through 6.5+. |
  | 11 | 11 |  |
  | 12 | 12 | \*/ |
  | 13 | 13 |  |
  | 14 | 14 | /\* |
  | 15 |  | Copyright (c) 2010-202~~3~~ by Scott Reilly (aka coffee2code) |
  |  | 15 | Copyright (c) 2010-2024 by Scott Reilly (aka coffee2code) |
  | 16 | 16 |  |
  | 17 | 17 | This program is free software; you can redistribute it and/or |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L32) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L32) |  |
  | 32 | 32 | defined( 'ABSPATH' ) or die(); |
  | 33 | 33 |  |
  | 34 |  | if ( ! class\_exists( 'c2c\_Plugin\_065' ) ) : |
  | 35 |  |  |
  | 36 |  | abstract class c2c\_Plugin\_065 { |
  |  | 34 | if ( ! class\_exists( 'c2c\_Plugin\_067' ) ) : |
  |  | 35 |  |
  |  | 36 | abstract class c2c\_Plugin\_067 { |
  |  | 37 |  |
  |  | 38 | /\*\* @var string The name of the option used to store plugin's settings. \*/ |
  |  | 39 | public $admin\_options\_name = ''; |
  |  | 40 |  |
  |  | 41 | /\*\* @var array Associative array of configuration settings for the plugin.  \*/ |
  |  | 42 | public $config = array(); |
  |  | 43 |  |
  |  | 44 | /\*\* @var bool Prevent overriding of the contextual help? \*/ |
  |  | 45 | public $disable\_contextual\_help = false; |
  |  | 46 |  |
  |  | 47 | /\*\* @var bool Prevent WP from checking for updates to this plugin? \*/ |
  |  | 48 | public $disable\_update\_check = false; |
  |  | 49 |  |
  |  | 50 | /\*\* @var string Prefix for all hooks. \*/ |
  |  | 51 | public $hook\_prefix; |
  |  | 52 |  |
  |  | 53 | /\*\* @var string Name assigned to the settings form. \*/ |
  |  | 54 | public $form\_name; |
  |  | 55 |  |
  |  | 56 | /\*\* @var string The name used for the plugin's settings page in the admin menu. \*/ |
  |  | 57 | public $menu\_name; |
  |  | 58 |  |
  |  | 59 | /\*\* @var string Full, localized version of the plugin name. \*/ |
  |  | 60 | public $name; |
  |  | 61 |  |
  |  | 62 | /\*\* @var string Nonce field value use on the settings form. \*/ |
  |  | 63 | public $nonce\_field; |
  |  | 64 |  |
  |  | 65 | /\*\* @var string The core settings page under which the plugin settings page will be listed in the admin menu. \*/ |
  |  | 66 | public $settings\_page; |
  |  | 67 |  |
  |  | 68 | /\*\* @var bool Should settings page be shown? Only applies if admin is enabled. \*/ |
  |  | 69 | public $show\_admin; |
  |  | 70 |  |
  |  | 71 | /\*\* @var string Textdomain for localization. \*/ |
  |  | 72 | public $textdomain; |
  |  | 73 |  |
  |  | 74 | /\*\* @var string Subdirectory, relative to plugin's root, to hold localization files. \*/ |
  |  | 75 | public $textdomain\_subdir; |
  |  | 76 |  |
  |  | 77 | /\*\* @var string Short (2-3 char) identifier for plugin author. \*/ |
  |  | 78 | public $author\_prefix; |
  |  | 79 |  |
  |  | 80 | /\*\* @var string A unique base ID for the plugin (generally a lower-case, dash-separated version of plugin name). \*/ |
  |  | 81 | public $id\_base; |
  |  | 82 |  |
  |  | 83 | /\*\* @var string The options page ID returned when the options page gets created. \*/ |
  |  | 84 | public $options\_page; |
  |  | 85 |  |
  |  | 86 | /\*\* @var string The path to the root of the plugin. \*/ |
  |  | 87 | public $plugin\_basename; |
  |  | 88 |  |
  |  | 89 | /\*\* @var string The path to the main plugin file. \*/ |
  |  | 90 | public $plugin\_file; |
  |  | 91 |  |
  |  | 92 | /\*\* @var string The URL to the main plugin file. \*/ |
  |  | 93 | public $plugin\_path; |
  |  | 94 |  |
  |  | 95 | /\*\* @var string The underscored version of $id\_base. \*/ |
  |  | 96 | public $u\_id\_base; |
  |  | 97 |  |
  |  | 98 | /\*\* @var string The current version of the plugin. \*/ |
  |  | 99 | public $version; |
  |  | 100 |  |
  | 37 | 101 | protected $plugin\_css\_version = '009'; |
  | 38 | 102 | protected $options            = array(); |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L48) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L112) |  |
  | 48 | 112 | 'inline\_help'      => '', |
  | 49 | 113 | 'input'            => '', |
  | 50 |  | 'input\_attributes' => ~~''~~, |
  |  | 114 | 'input\_attributes' => [], |
  | 51 | 115 | 'label'            => '', |
  | 52 | 116 | 'more\_help'        => '', |
  | 53 | 117 | 'no\_wrap'          => false, |
  | 54 | 118 | 'numbered'         => false, |
  | 55 |  | 'options'          => ~~''~~, |
  |  | 119 | 'options'          => [], |
  | 56 | 120 | 'output'           => '', // likely deprecated |
  | 57 | 121 | 'raw\_help'         => '', |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L70) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L134) |  |
  | 70 | 134 | \*/ |
  | 71 | 135 | public function c2c\_plugin\_version() { |
  | 72 |  | return '06~~5~~'; |
  |  | 136 | return '067'; |
  | 73 | 137 | } |
  | 74 | 138 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L85) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L149) |  |
  | 85 | 149 | $id\_base = sanitize\_title( $id\_base ); |
  | 86 | 150 | if ( ! file\_exists( $file ) ) { |
  | 87 |  | die( ~~sprintf( $this->get\_c2c\_string( 'Invalid file specified for C2C\_Plugin: %s' ), $file~~ ) ); |
  |  | 151 | die( esc\_html( sprintf( $this->get\_c2c\_string( 'Invalid file specified for C2C\_Plugin: %s' ), $file ) ) ); |
  | 88 | 152 | } |
  | 89 | 153 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L136) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L200) |  |
  | 136 | 200 | \*/ |
  | 137 | 201 | public function \_\_clone() { |
  | 138 |  | /\* translators: %s: Name of plugin class. \*/ |
  | 139 |  | throw new Error( sprintf( $this->get\_c2c\_string( '%s cannot be cloned.' ), \_\_CLASS\_\_ ) ); |
  |  | 202 | throw new Error( esc\_html( sprintf( $this->get\_c2c\_string( '%s cannot be cloned.' ), \_\_CLASS\_\_ ) ) ); |
  | 140 | 203 | } |
  | 141 | 204 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L147) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L210) |  |
  | 147 | 210 | \*/ |
  | 148 | 211 | public function \_\_wakeup() { |
  | 149 |  | /\* translators: %s: Name of plugin class. \*/ |
  | 150 |  | throw new Error( sprintf( $this->get\_c2c\_string( '%s cannot be unserialized.' ), \_\_CLASS\_\_ ) ); |
  |  | 212 | throw new Error( esc\_html( sprintf( $this->get\_c2c\_string( '%s cannot be unserialized.' ), \_\_CLASS\_\_ ) ) ); |
  | 151 | 213 | } |
  | 152 | 214 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L195) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L257) |  |
  | 195 | 257 | } |
  | 196 | 258 |  |
  | 197 |  | if ( $this->show\_admin && $this->settings\_page && ! empty( $this->config ) && current\_user\_can( ~~'manage\_options'~~ ) ) { |
  |  | 259 | if ( $this->show\_admin && $this->settings\_page && ! empty( $this->config ) && current\_user\_can( $this->get\_manage\_options\_capability() ) ) { |
  | 198 | 260 | add\_action( 'admin\_menu', array( $this, 'admin\_menu' ) ); |
  | 199 | 261 | if ( ! $this->disable\_contextual\_help ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L306) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L368) |  |
  | 306 | 368 |  |
  | 307 | 369 | /\*\* |
  |  | 370 | \* Returns the capability needed to configure the plugin via its settings page. |
  |  | 371 | \* |
  |  | 372 | \* Note: This does not actually check if the plugin has a settings page, only |
  |  | 373 | \* what the capability is that would be needed to use it if it was enabled. |
  |  | 374 | \* |
  |  | 375 | \* @since 066 |
  |  | 376 | \* |
  |  | 377 | \* @return string The capability. Default 'manage\_options'. |
  |  | 378 | \*/ |
  |  | 379 | public function get\_manage\_options\_capability() { |
  |  | 380 | $default\_cap = 'manage\_options'; |
  |  | 381 | /\*\* |
  |  | 382 | \* Filters the capability needed to configure the plugin via its settings page. |
  |  | 383 | \* |
  |  | 384 | \* @since 066 |
  |  | 385 | \* |
  |  | 386 | \* @param string $capability The capability. Default 'manage\_options'. |
  |  | 387 | \*/ |
  |  | 388 | $cap = apply\_filters( $this->get\_hook( 'manage\_options\_capability' ), $default\_cap ); |
  |  | 389 | if ( ! $cap || ! is\_string( $cap ) ) { |
  |  | 390 | $cap = $default\_cap; |
  |  | 391 | } |
  |  | 392 |  |
  |  | 393 | return $cap; |
  |  | 394 | } |
  |  | 395 |  |
  |  | 396 | /\*\* |
  | 308 | 397 | \* Initializes options. |
  | 309 | 398 | \*/ |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L334) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L423) |  |
  | 334 | 423 | $added = array( $this->admin\_options\_name => array( $this->admin\_options\_name ) ); |
  | 335 | 424 |  |
  | 336 |  | return function\_exists( 'add\_allowed\_options' ) |
  | 337 |  | ? add\_allowed\_options( $added, $options ) |
  | 338 |  | : add\_option\_whitelist( $added, $options ); |
  |  | 425 | return add\_allowed\_options( $added, $options ); |
  | 339 | 426 | } |
  | 340 | 427 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L351) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L438) |  |
  | 351 | 438 | } |
  | 352 | 439 |  |
  | 353 |  | if ( ~~empty( $localized\_heading\_text )~~ ) { |
  |  | 440 | if ( ! $localized\_heading\_text ) { |
  | 354 | 441 | $localized\_heading\_text = $this->name; |
  | 355 | 442 | } |
  | 356 | 443 | if ( $localized\_heading\_text ) { |
  | 357 |  | echo '<h1>' . ~~$localized\_heading\_text~~ . "</h1>\n"; |
  |  | 444 | echo '<h1>' . esc\_html( $localized\_heading\_text ) . "</h1>\n"; |
  | 358 | 445 | } |
  | 359 | 446 | if ( ! $this->disable\_contextual\_help ) { |
  | 360 |  | echo '<p class="see-help">' . ~~$this->get\_c2c\_string( 'See the "Help" link to the top-right of the page for more help.'~~ ) . "</p>\n"; |
  |  | 447 | echo '<p class="see-help">' . esc\_html( $this->get\_c2c\_string( 'See the "Help" link to the top-right of the page for more help.' ) ) . "</p>\n"; |
  | 361 | 448 | } |
  | 362 | 449 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L406) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L493) |  |
  | 406 | 493 | /\*\* |
  | 407 | 494 | \* Sanitizes user inputs prior to saving. |
  |  | 495 | \* |
  |  | 496 | \* @param string[] $inputs |
  |  | 497 | \* @return string[] Sanitized inputs. |
  | 408 | 498 | \*/ |
  | 409 | 499 | public function sanitize\_inputs( $inputs ) { |
  | 410 | 500 | do\_action( $this->get\_hook( 'before\_save\_options' ), $this ); |
  |  | 501 | // PHPCS: The Settings API already verifies nonce, so no need to do so here. |
  |  | 502 | // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 411 | 503 | if ( isset( $\_POST['Reset'] ) ) { |
  | 412 | 504 | $options = $this->reset\_options(); |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L444) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L536) |  |
  | 444 | 536 | } |
  | 445 | 537 | if ( ! empty( $val ) && ( ! is\_numeric( $val ) || ( intval( $val ) != round( $val ) ) ) ) { |
  | 446 |  | ~~/\* translators: %s: Label for setting. \*/~~ |
  | 447 | 538 | $msg = sprintf( $this->get\_c2c\_string( 'Expected integer value for: %s' ), $this->config[ $opt ]['label'] ); |
  | 448 | 539 | $error = true; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L507) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L598) |  |
  | 507 | 598 |  |
  | 508 | 599 | /\*\* |
  |  | 600 | \* Registers filters. |
  |  | 601 | \* |
  |  | 602 | \* @since 065 Changed to be abstract. |
  |  | 603 | \* |
  |  | 604 | \* NOTE: This occurs during the 'init' filter, so you can't use this to hook |
  |  | 605 | \* anything that happens earlier. |
  |  | 606 | \*/ |
  |  | 607 | abstract public function register\_filters(); |
  |  | 608 |  |
  |  | 609 | /\*\* |
  | 509 | 610 | \* Adds a new option to the plugin's configuration. |
  | 510 | 611 | \* |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L531) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L632) |  |
  | 531 | 632 |  |
  | 532 | 633 | /\*\* |
  | 533 |  | \* Verif~~y that the necessary configuration file~~s were set in the inheriting class. |
  |  | 634 | \* Verifies that the necessary configuration options were set in the inheriting class. |
  | 534 | 635 | \*/ |
  | 535 | 636 | public function verify\_config() { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L537) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L638) |  |
  | 537 | 638 | foreach ( $this->required\_config as $config ) { |
  | 538 | 639 | if ( empty( $this->$config ) ) { |
  | 539 |  | die( ~~sprintf( $this->get\_c2c\_string( "The plugin configuration option '%s' must be supplied." ), $config~~ ) ); |
  |  | 640 | die( esc\_html( sprintf( $this->get\_c2c\_string( "The plugin configuration option '%s' must be supplied." ), $config ) ) ); |
  | 540 | 641 | } |
  | 541 | 642 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L565) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L666) |  |
  | 565 | 666 | foreach ( $options as $opt ) { |
  | 566 | 667 | foreach ( $this->config\_attributes as $attrib => $default) { |
  |  | 668 | // Use the default if not configured. |
  | 567 | 669 | if ( ! isset( $this->config[ $opt ][ $attrib ] ) ) { |
  | 568 | 670 | $this->config[ $opt ][ $attrib ] = $default; |
  | 569 | 671 | } |
  |  | 672 | // Ensure configured value is of same datatype as default. |
  |  | 673 | else { |
  |  | 674 | // Config attributes that can be any datatype (or at least can differ from the default). |
  |  | 675 | $can\_be\_any\_datatype = [ 'default' ]; |
  |  | 676 |  |
  |  | 677 | $configured\_value = $this->config[ $opt ][ $attrib ]; |
  |  | 678 | $datatype = ''; |
  |  | 679 | if ( in\_array( $attrib, $can\_be\_any\_datatype ) ) { |
  |  | 680 | // Do nothing. |
  |  | 681 | } elseif ( is\_array( $default ) && ! is\_array( $configured\_value ) ) { |
  |  | 682 | $datatype = 'an array'; |
  |  | 683 | } elseif ( is\_bool( $default ) && ! is\_bool( $configured\_value ) ) { |
  |  | 684 | $datatype = 'a boolean'; |
  |  | 685 | } elseif ( is\_int( $default ) && ! is\_int( $configured\_value ) ) { |
  |  | 686 | $datatype = 'an integer'; |
  |  | 687 | } elseif ( is\_float( $default ) && ! is\_float( $configured\_value ) ) { |
  |  | 688 | $datatype = 'a float'; |
  |  | 689 | } elseif ( is\_string( $default ) && ! is\_string( $configured\_value ) ) { |
  |  | 690 | $datatype = 'a string'; |
  |  | 691 | } |
  |  | 692 |  |
  |  | 693 | if ( $datatype ) { |
  |  | 694 | \_doing\_it\_wrong( 'c2c\_Plugin::verify\_options', esc\_html( "The c2c\_Plugin configuration {$opt} attribute {$attrib} should be {$datatype} and thus the default is being used instead." ), '067' ); |
  |  | 695 | $this->config[ $opt ][ $attrib ] = $default; |
  |  | 696 | } |
  |  | 697 | } |
  | 570 | 698 | } |
  |  | 699 |  |
  | 571 | 700 | if ( 'array' === $this->config[ $opt ]['datatype'] && ! is\_array( $this->config[ $opt ]['default'] ) ) { |
  | 572 | 701 | $this->config[ $opt ]['default'] = $this->config[ $opt ]['default'] ? |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L586) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L715) |  |
  | 586 | 715 |  |
  | 587 | 716 | /\*\* |
  | 588 |  | ~~\* Registers filters.~~ |
  | 589 |  | ~~\* NOTE: This occurs during the 'init' filter, so you can't use this to hook~~ |
  | 590 |  | ~~\* anything that happens earlier.~~ |
  | 591 |  | ~~\*/~~ |
  | 592 |  | ~~public function register\_filters() {~~ |
  | 593 |  | ~~// This should be overridden in order to define filters.~~ |
  | 594 |  | ~~}~~ |
  | 595 |  |  |
  | 596 |  | ~~/\*\*~~ |
  | 597 | 717 | \* Returns markup for simple contextual help text, comprising solely of a |
  | 598 | 718 | \* thickboxed link to the plugin's hosted readme.txt file. |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L612) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L732) |  |
  | 612 | 732 | } |
  | 613 | 733 |  |
  | 614 |  | $help = '<h3>' . ~~$this->get\_c2c\_string( 'More Plugin Help'~~ ) . '</h3>'; |
  |  | 734 | $help = '<h3>' . esc\_html( $this->get\_c2c\_string( 'More Plugin Help' ) ) . '</h3>'; |
  | 615 | 735 | $help .= '<p class="more-help">'; |
  | 616 | 736 | $help .= sprintf( |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L618) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L738) |  |
  | 618 | 738 | esc\_attr( sprintf( $this->get\_c2c\_string( 'More information about %1$s %2$s' ), $this->name, $this->version ) ), |
  | 619 | 739 | esc\_url( admin\_url( "plugin-install.php?tab=plugin-information&amp;plugin={$this->id\_base}&amp;TB\_iframe=true&amp;width=640&amp;height=514" ) ), |
  | 620 |  | ~~$this->get\_c2c\_string( 'Click for more help on this plugin'~~ ), |
  | 621 |  | ~~$this->get\_c2c\_string( ' (especially check out the "Other Notes" tab, if present)'~~ ) |
  |  | 740 | esc\_html( $this->get\_c2c\_string( 'Click for more help on this plugin' ) ), |
  |  | 741 | esc\_html( $this->get\_c2c\_string( ' (especially check out the "Other Notes" tab, if present)' ) ) |
  | 622 | 742 | ); |
  | 623 | 743 | $help .= ".</p>\n"; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L641) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L761) |  |
  | 641 | 761 | $c2c\_plugin\_css\_was\_output = true; |
  | 642 | 762 | $logo = plugins\_url( 'c2c\_minilogo.png', $this->plugin\_file ); |
  |  | 763 |  |
  | 643 | 764 | /\*\* |
  | 644 |  | \* ~~Remember to increment the plugin\_css\_version variable if changing the CSS~~ |
  |  | 765 | \* Note: Remember to increment the plugin\_css\_version variable if changing the CSS. |
  | 645 | 766 | \*/ |
  | 646 |  | ~~echo <<<HTML~~ |
  |  | 767 | ?> |
  | 647 | 768 | <style> |
  | 648 | 769 | .long-text {width:98% !important;} |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L663) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L784) |  |
  | 663 | 784 | width:45%; |
  | 664 | 785 | min-height:40px; |
  | 665 |  | background:url('~~$logo~~') no-repeat center right; |
  |  | 786 | background:url('<?php echo esc\_url( $logo ); ?>') no-repeat center right; |
  | 666 | 787 | font-size:larger; |
  | 667 | 788 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L685) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L806) |  |
  | 685 | 806 | ul.description, ol.description {color:#646970;margin:10px 0;list-style:disc;} |
  | 686 | 807 | ul.description li, ol.description li {margin-left:1rem;} |
  |  | 808 | ul.description ul, ul.description ol, ol.description ul, ol.description ol {list-style:circle;margin-top:0.4rem;} |
  | 687 | 809 | </style> |
  | 688 |  |  |
  | 689 |  | HTML; |
  |  | 810 | <?php |
  | 690 | 811 | } |
  | 691 | 812 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L707) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L828) |  |
  | 707 | 828 | $menu\_func = 'add\_' . $func\_root . '\_page'; |
  | 708 | 829 | if ( function\_exists( $menu\_func ) ) { |
  | 709 |  | $this->options\_page = call\_user\_func( $menu\_func, $this->name, $this->menu\_name, ~~'manage\_options'~~, $this->plugin\_basename, array( $this, 'options\_page' ) ); |
  |  | 830 | $this->options\_page = call\_user\_func( $menu\_func, $this->name, $this->menu\_name, $this->get\_manage\_options\_capability(), $this->plugin\_basename, array( $this, 'options\_page' ) ); |
  | 710 | 831 | add\_action( 'load-' . $this->options\_page, array( $this, 'help\_tabs' ) ); |
  | 711 | 832 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L713) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L834) |  |
  | 713 | 834 |  |
  | 714 | 835 | /\*\* |
  | 715 |  | \* Initialize help tabs. |
  |  | 836 | \* Initializes help tabs. |
  | 716 | 837 | \* |
  | 717 | 838 | \* @since 034 |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L735) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L856) |  |
  | 735 | 856 | \* |
  | 736 | 857 | \* @since 034 |
  |  | 858 | \* |
  |  | 859 | \* @param WP\_Screen $screen |
  | 737 | 860 | \*/ |
  | 738 | 861 | public function help\_tabs\_content( $screen ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L752) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L875) |  |
  | 752 | 875 | \*/ |
  | 753 | 876 | public function plugin\_action\_links( $action\_links ) { |
  | 754 |  | $settings\_link = '<a href="' . ~~$this->settings\_page . '.php?page='.$this->plugin\_basename.~~'">' . $this->get\_c2c\_string( 'Settings' ) . '</a>'; |
  |  | 877 | $settings\_link = '<a href="' . esc\_url( $this->form\_action\_url() ) . '">' . $this->get\_c2c\_string( 'Settings' ) . '</a>'; |
  | 755 | 878 | array\_unshift( $action\_links, $settings\_link ); |
  | 756 | 879 | return $action\_links; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L759) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L882) |  |
  | 759 | 882 | /\*\* |
  | 760 | 883 | \* Adds donate link to plugin row. |
  |  | 884 | \* |
  |  | 885 | \* @param string[] $links Array of plugin row links. |
  |  | 886 | \* @param string   $file  Filename. |
  |  | 887 | \* @return string[] |
  | 761 | 888 | \*/ |
  | 762 | 889 | public function donate\_link( $links, $file ) { |
  | 763 |  | if ( $file == $this->plugin\_basename ) { |
  | 764 |  | $title         = $this->get\_c2c\_string( 'Coffee fuels my coding.' ); |
  | 765 |  | $links[] = '<a href="' . esc\_url( $this->donation\_url ) . '" title="' . esc\_attr( $title ) . '">' . $this->get\_c2c\_string( 'Donate' ) . '</a>'; |
  |  | 890 | if ( $file === $this->plugin\_basename ) { |
  |  | 891 | $title   = $this->get\_c2c\_string( 'Coffee fuels my coding.' ); |
  |  | 892 | $links[] = sprintf( |
  |  | 893 | '<a href="%s" title="%s">%s</a>', |
  |  | 894 | esc\_url( $this->donation\_url ), |
  |  | 895 | esc\_attr( $title ), |
  |  | 896 | esc\_html( $this->get\_c2c\_string( 'Donate' ) ) |
  |  | 897 | ); |
  | 766 | 898 | } |
  | 767 | 899 | return $links; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L769) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L901) |  |
  | 769 | 901 |  |
  | 770 | 902 | /\*\* |
  | 771 |  | \* ~~See if the setting is pertinent to this version of WP~~ |
  |  | 903 | \* Determines if the setting is pertinent to this version of WP. |
  | 772 | 904 | \* |
  | 773 | 905 | \* @since 013 |
  | 774 | 906 | \* |
  | 775 | 907 | \* @param string $opt The option name. |
  | 776 |  | \* |
  | 777 |  | \* @return bool If the option is valid for this version of WP. |
  |  | 908 | \* @return bool True if the option is valid for this version of WP, else false. |
  | 778 | 909 | \*/ |
  | 779 | 910 | protected function is\_option\_valid( $opt ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L796) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L927) |  |
  | 796 | 927 | \* |
  | 797 | 928 | \* @param bool $include\_non\_options Optional. Should non-options be included? Default is false. |
  | 798 |  | ~~\*~~ |
  | 799 | 929 | \* @return array Array of option names. |
  | 800 | 930 | \*/ |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L823) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L953) |  |
  | 823 | 953 | \* obtains the options and buffers the value. |
  | 824 | 954 | \* |
  | 825 |  | \* @param bool $with\_current\_values Optional. Should the currently saved values be returned?~~If false, then the plugin's defaults are returned. Default is true.~~ |
  | 826 |  | \* |
  | 827 |  | \* @return array The options array for the plugin~~(which is also stored in $this->options if !$with\_options)~~. |
  |  | 955 | \* @param bool $with\_current\_values Optional. Should the currently saved values be returned? |
  |  | 956 | \*                                  If false, then the plugin's defaults are returned. Default is true. |
  |  | 957 | \* @return array The options array for the plugin. |
  | 828 | 958 | \*/ |
  | 829 | 959 | public function get\_options( $with\_current\_values = true ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L871) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1001) |  |
  | 871 | 1001 | \* @since 037 |
  | 872 | 1002 | \* |
  | 873 |  | \* @param array $settings   The new setting~~value(s)~~ |
  |  | 1003 | \* @param array $settings   The new settings values. |
  | 874 | 1004 | \* @param bool  $with\_reset Should the options be reset, with the new settings overlaid on top of the default settings? |
  | 875 |  | ~~\*~~ |
  | 876 | 1005 | \* @return array |
  | 877 | 1006 | \*/ |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L889) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1018) |  |
  | 889 | 1018 | \* |
  | 890 | 1019 | \* @param string $prefix A prefix string, unique to the form. |
  | 891 |  | ~~\*~~ |
  | 892 | 1020 | \* @return string The name. |
  | 893 | 1021 | \*/ |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L897) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1025) |  |
  | 897 | 1025 |  |
  | 898 | 1026 | /\*\* |
  | 899 |  | \* Returns the ~~URL for a plugin's form to use for its action attribute~~ |
  | 900 |  | \* |
  | 901 |  | \* @return string The action URL |
  |  | 1027 | \* Returns the admin-relative URL for a plugin's form to use for its action attribute. |
  |  | 1028 | \* |
  |  | 1029 | \* @return string The action URL. |
  | 902 | 1030 | \*/ |
  | 903 | 1031 | protected function form\_action\_url() { |
  | 904 |  | return $~~\_SERVER['PHP\_SELF'] . '~~?page=' . $this->plugin\_basename; |
  | 905 |  | } |
  | 906 |  |  |
  | 907 |  | /\*\* |
  | 908 |  | \* ~~Check~~s if the plugin's settings page has been submitted. |
  |  | 1032 | return $this->settings\_page . '.php?page=' . $this->plugin\_basename; |
  |  | 1033 | } |
  |  | 1034 |  |
  |  | 1035 | /\*\* |
  |  | 1036 | \* Determines if the plugin's settings page has been submitted. |
  | 909 | 1037 | \* |
  | 910 | 1038 | \* @return bool True if the plugin's settings have been submitted for saving, else false. |
  | 911 | 1039 | \*/ |
  | 912 | 1040 | protected function is\_submitting\_form() { |
  |  | 1041 | // PHPCS: The POST value only being read and not meaningfully used. |
  |  | 1042 | // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 913 | 1043 | return ( isset( $\_POST['option\_page'] ) && ( $\_POST['option\_page'] == $this->admin\_options\_name ) ); |
  | 914 | 1044 | } |
  | 915 | 1045 |  |
  | 916 | 1046 | /\*\* |
  | 917 |  | \* ~~Check~~s if the current page is the plugin's settings page. |
  |  | 1047 | \* Determines if the current page is the plugin's settings page. |
  | 918 | 1048 | \* |
  | 919 | 1049 | \* Note: This should not be used during or before `'admin\_init'` since the |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L930) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1060) |  |
  | 930 | 1060 | \_doing\_it\_wrong( |
  | 931 | 1061 | \_\_METHOD\_\_, |
  | 932 |  | ~~sprintf( $this->get\_c2c\_string( 'The method %1$s should not be called until after the %2$s action.' ), 'is\_plugin\_admin\_page()', 'admin\_init'~~ ), |
  |  | 1062 | esc\_html( sprintf( $this->get\_c2c\_string( 'The method %1$s should not be called until after the %2$s action.' ), 'is\_plugin\_admin\_page()', 'admin\_init' ) ), |
  | 933 | 1063 | '063' |
  | 934 | 1064 | ); |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L944) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1074) |  |
  | 944 | 1074 | $current\_screen->id === $this->options\_page |
  | 945 | 1075 | ); |
  |  | 1076 | } |
  |  | 1077 |  |
  |  | 1078 | /\*\* |
  |  | 1079 | \* Returns escaped attributes string for an HTML tag. |
  |  | 1080 | \* |
  |  | 1081 | \* @since 067 |
  |  | 1082 | \* |
  |  | 1083 | \* @param string[] $attributes Associative array of attribute names and values. |
  |  | 1084 | \* @return string |
  |  | 1085 | \*/ |
  |  | 1086 | public function esc\_attributes( $attributes ) { |
  |  | 1087 | $string = ''; |
  |  | 1088 |  |
  |  | 1089 | foreach ( $attributes as $key => $value ) { |
  |  | 1090 | $string .= sprintf( |
  |  | 1091 | '%s="%s" ', |
  |  | 1092 | esc\_attr( wp\_strip\_all\_tags( $key ) ), |
  |  | 1093 | esc\_html( wp\_strip\_all\_tags( $value ) ) |
  |  | 1094 | ); |
  |  | 1095 | } |
  |  | 1096 |  |
  |  | 1097 | return trim( $string ); |
  | 946 | 1098 | } |
  | 947 | 1099 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L997) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1149) |  |
  | 997 | 1149 | } |
  | 998 | 1150 | $attributes = $this->config[ $opt ]['input\_attributes']; |
  |  | 1151 | if ( ! is\_array( $attributes ) ) { |
  |  | 1152 | $attributes = []; |
  |  | 1153 | } |
  | 999 | 1154 | $this->config[ $opt ]['class'][] = 'c2c-' . $input; |
  | 1000 | 1155 | if ( ( 'textarea' == $input || 'inline\_textarea' == $input ) && $this->config[ $opt ]['no\_wrap'] ) { |
  | 1001 |  | $attributes~~.= ' wrap="off"~~'; // Does not validate, but only cross-browser technique |
  |  | 1156 | $attributes['wrap'] = 'off'; // Does not validate, but only cross-browser technique |
  | 1002 | 1157 | } |
  | 1003 | 1158 | elseif ( in\_array( $input, array( 'text', 'long\_text', 'short\_text' ) ) ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1012) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1167) |  |
  | 1012 | 1167 | } |
  | 1013 | 1168 | $class = implode( ' ', $this->config[ $opt ]['class'] ); |
  | 1014 |  | $attribs = "name='{$popt}' id='{$opt}' class='{$class}' {$attributes}"; |
  |  | 1169 | $attributes['class'] = $class; |
  |  | 1170 | $attributes['id']    = $opt; |
  |  | 1171 | $attributes['name']  = $popt; |
  |  | 1172 |  |
  | 1015 | 1173 | if ( $input == '' ) { |
  | 1016 | 1174 | // Change of implementation prevents this from being possible (since this function only gets called for registered settings) |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1023) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1181) |  |
  | 1023 | 1181 | echo "</td><tr><td colspan='2'>"; |
  | 1024 | 1182 | } |
  | 1025 |  | echo "<textarea {$attribs}>{$value}</textarea>\n"; |
  |  | 1183 | printf( |
  |  | 1184 | '<textarea %s>%s</textarea>' . "\n", |
  |  | 1185 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1186 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1187 | $this->esc\_attributes( $attributes ), |
  |  | 1188 | wp\_kses\_post( $value ) |
  |  | 1189 | ); |
  | 1026 | 1190 | } elseif ( $input == 'select' ) { |
  | 1027 |  | echo "<select $attribs>"; |
  |  | 1191 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1192 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1193 | echo '<select ' . $this->esc\_attributes( $attributes ) . '>'; |
  | 1028 | 1194 | if ( $this->config[ $opt ]['datatype'] == 'hash' ) { |
  | 1029 | 1195 | foreach ( (array) $this->config[ $opt ]['options'] as $sopt => $sval ) { |
  | 1030 |  | echo "<option value='{$sopt}' " . selected( $value, $sopt, false ) . ">{$sval}</option>\n"; |
  |  | 1196 | printf( |
  |  | 1197 | '<option value="%s" ' . selected( $value, $sopt, false ) . ">%s</option>\n", |
  |  | 1198 | esc\_attr( $sopt ), |
  |  | 1199 | esc\_html( $sval ) |
  |  | 1200 | ); |
  | 1031 | 1201 | } |
  | 1032 | 1202 | } else { |
  | 1033 | 1203 | foreach ( (array) $this->config[ $opt ]['options'] as $sopt ) { |
  | 1034 |  | echo "<option value='{$sopt}' " . selected( $value, $sopt, false ) . ">{$sopt}</option>\n"; |
  |  | 1204 | printf( |
  |  | 1205 | '<option value="%s" ' . selected( $value, $sopt, false ) . ">%s</option>\n", |
  |  | 1206 | esc\_attr( $sopt ), |
  |  | 1207 | esc\_attr( $sopt ) |
  |  | 1208 | ); |
  | 1035 | 1209 | } |
  | 1036 | 1210 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1039) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1213) |  |
  | 1039 | 1213 | echo '<fieldset class="c2c-fieldset">' . "\n"; |
  | 1040 | 1214 | foreach ( (array) $this->config[ $opt ]['options'] as $sopt ) { |
  | 1041 |  | echo "<input type='checkbox' {$attribs} value='{$sopt}' " . checked( in\_array( $sopt, $value ), true, false ) . ">{$sopt}</input><br />\n"; |
  | 1042 |  | } |
  |  | 1215 | printf( |
  |  | 1216 | '<input type="checkbox" %s value="%s" ' . checked( in\_array( $sopt, $value ), true, false ) . ">%s</input><br />\n", |
  |  | 1217 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1218 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1219 | $this->esc\_attributes( $attributes ), |
  |  | 1220 | esc\_attr( $sopt ), |
  |  | 1221 | esc\_html( $sopt ) |
  |  | 1222 | ); |
  |  | 1223 | } |
  | 1043 | 1224 | echo '</fieldset>'; |
  | 1044 | 1225 | } elseif ( $input == 'checkbox' ) { |
  | 1045 |  | echo "<input type='{$input}' {$attribs} value='1' " . checked( $value, 1, false ) . " />\n"; |
  |  | 1226 | printf( |
  |  | 1227 | '<input type="%s" %s value="1" ' . checked( $value, 1, false ) . ' />' . "\n", |
  |  | 1228 | esc\_attr( $input ), |
  |  | 1229 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1230 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1231 | $this->esc\_attributes( $attributes ) |
  |  | 1232 | ); |
  | 1046 | 1233 | if ( ! empty( $this->config[ $opt ]['help'] ) ) { |
  | 1047 |  | printf( "<label class='description' for='%s'>%s</label>\n", $opt, $this->config[ $opt ]['help'] ); |
  |  | 1234 | printf( |
  |  | 1235 | "<label class='description' for='%s'>%s</label>\n", |
  |  | 1236 | esc\_attr( $opt ), |
  |  | 1237 | wp\_kses\_post( $this->config[ $opt ]['help'] ) |
  |  | 1238 | ); |
  | 1048 | 1239 | $this->config[ $opt ]['help'] = ''; |
  | 1049 | 1240 | } |
  | 1050 | 1241 | } else { // Only 'text' and 'password' should fall through to here. |
  | 1051 |  | echo "<input type='{$input}' {$attribs} value='" . esc\_attr( $value ) . "' />\n"; |
  |  | 1242 | printf( |
  |  | 1243 | '<input type="%s" %s value="%s" />' . "\n", |
  |  | 1244 | esc\_attr( $input ), |
  |  | 1245 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1246 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1247 | $this->esc\_attributes( $attributes ), |
  |  | 1248 | esc\_attr( $value ) |
  |  | 1249 | ); |
  | 1052 | 1250 | } |
  | 1053 | 1251 | // Help intended to be inline (usually with a text field; checkboxes naturally have their help inline) |
  | 1054 | 1252 | if ( $help = apply\_filters( $this->get\_hook( 'option\_help'), $this->config[ $opt ]['inline\_help'], $opt, 'inline\_help' ) ) { |
  | 1055 |  | echo ~~"<p class='description inline-description'>{$help}~~</p>\n"; |
  |  | 1253 | echo '<p class="description inline-description">' . wp\_kses\_post( $help ) . "</p>\n"; |
  | 1056 | 1254 | } |
  | 1057 | 1255 | // Help intended to be shown below an input field. |
  | 1058 | 1256 | if ( $help = apply\_filters( $this->get\_hook( 'option\_help'), $this->config[ $opt ]['help'], $opt, 'help' ) ) { |
  | 1059 |  | echo ~~"<p class='description'>{$help}~~</p>\n"; |
  |  | 1257 | echo '<p class="description">' . wp\_kses\_post( $help ) . "</p>\n"; |
  | 1060 | 1258 | } |
  | 1061 | 1259 | // Additional paragraph of help intended to follow the main 'help'. |
  | 1062 | 1260 | if ( $help = apply\_filters( $this->get\_hook( 'option\_help'), $this->config[ $opt ]['more\_help'], $opt, 'more\_help' ) ) { |
  | 1063 |  | echo ~~"<p class='description'>{$help}~~</p>\n"; |
  |  | 1261 | echo '<p class="description">' . wp\_kses\_post( $help ) . "</p>\n"; |
  | 1064 | 1262 | } |
  | 1065 | 1263 | // Additional help of custom markup (block elements that wouldn't fit into the default help paragraph markup). |
  | 1066 | 1264 | if ( $help = apply\_filters( $this->get\_hook( 'option\_help'), $this->config[ $opt ]['raw\_help'], $opt, 'raw\_help' ) ) { |
  | 1067 |  | echo ~~$help~~ . "\n"; |
  |  | 1265 | echo wp\_kses\_post( $help ) . "\n"; |
  | 1068 | 1266 | } |
  | 1069 | 1267 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1079) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1277) |  |
  | 1079 | 1277 |  |
  | 1080 | 1278 | if ( $this->saved\_settings ) { |
  | 1081 |  | echo "<div id='message' class='updated fade'><p><strong>" . ~~$this->saved\_settings\_msg~~ . '</strong></p></div>'; |
  |  | 1279 | echo "<div id='message' class='updated fade'><p><strong>" . esc\_html( $this->saved\_settings\_msg ) . '</strong></p></div>'; |
  | 1082 | 1280 | } |
  | 1083 | 1281 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1103) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1301) |  |
  | 1103 | 1301 | echo '<div id="c2c" class="wrap"><div>' . "\n"; |
  | 1104 | 1302 | printf( |
  | 1105 |  | ~~$this->get\_c2c\_string( 'This plugin brought to you by %s.'~~ ), |
  |  | 1303 | wp\_kses\_data( $this->get\_c2c\_string( 'This plugin brought to you by %s.' ) ), |
  | 1106 | 1304 | '<a href="https://coffee2code.com" title="' . esc\_attr( $this->get\_c2c\_string( 'The plugin author homepage.' ) ) . '">Scott Reilly (coffee2code)</a>' |
  | 1107 | 1305 | ); |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1110) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1308) |  |
  | 1110 | 1308 | esc\_url( $this->donation\_url ), |
  | 1111 | 1309 | esc\_attr( $this->get\_c2c\_string( "Thanks for the consideration; it's much appreciated." ) ), |
  | 1112 |  | ~~$this->get\_c2c\_string( 'If this plugin has been useful to you, please consider a donation.'~~ ) |
  |  | 1310 | esc\_html( $this->get\_c2c\_string( 'If this plugin has been useful to you, please consider a donation.' ) ) |
  | 1113 | 1311 | ); |
  | 1114 | 1312 | echo "</div>\n"; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1121) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1319) |  |
  | 1121 | 1319 | \* |
  | 1122 | 1320 | \* @param string $hook The name of a hook, to be made plugin-specific. |
  | 1123 |  | ~~\*~~ |
  | 1124 | 1321 | \* @return string The plugin-specific version of the hook name. |
  | 1125 | 1322 | \*/ |
  | 1126 |  | p~~rotected~~ function get\_hook( $hook ) { |
  |  | 1323 | public function get\_hook( $hook ) { |
  | 1127 | 1324 | return $this->hook\_prefix . '\_' . $hook; |
  | 1128 | 1325 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1133) | […](/browser/remember-me-controls/tags/2.1/c2c-plugin.php?rev=3146603#L1330) |  |
  | 1133 | 1330 | \* @since 005 |
  | 1134 | 1331 | \* |
  | 1135 |  | \* @return string The URL |
  |  | 1332 | \* @return string The URL. |
  | 1136 | 1333 | \*/ |
  | 1137 | 1334 | public function readme\_url() { |
* ## [remember-me-controls/tags/2.1/readme.txt](/changeset/3146603/remember-me-controls/tags/2.1/readme.txt "Show the changeset 3146603 restricted to remember-me-controls/tags/2.1/readme.txt")

  | [r2928246](/browser/remember-me-controls/trunk/readme.txt?rev=2928246#L2 "Show revision 2928246 of this file in browser") | [r3146603](/browser/remember-me-controls/tags/2.1/readme.txt?rev=3146603#L2 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | Contributors: coffee2code |
  | 3 | 3 | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=6ARCFJ9TX3522 |
  | 4 |  | Tags: login, remember, remember me, cookie, session~~, coffee2code~~ |
  |  | 4 | Tags: login, remember, remember me, cookie, session |
  | 5 | 5 | License: GPLv2 or later |
  | 6 | 6 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | 7 |  | Requires at least: ~~4.9~~ |
  | 8 |  | Tested up to: 6.~~2~~ |
  | 9 |  | Stable tag: 2.~~0.~~1 |
  |  | 7 | Requires at least: 5.5 |
  |  | 8 | Tested up to: 6.6 |
  |  | 9 | Stable tag: 2.1 |
  | 10 | 10 |  |
  | 11 | 11 | Have "Remember Me" checked by default on the login page and configure how long a login is remembered. Or disable the feature altogether. |
  | […](/browser/remember-me-controls/trunk/readme.txt?rev=2928246#L96) | […](/browser/remember-me-controls/tags/2.1/readme.txt?rev=3146603#L96) |  |
  | 96 | 96 | = Does this plugin include unit tests? = |
  | 97 | 97 |  |
  | 98 |  | Yes. |
  |  | 98 | Yes. The tests are not packaged in the release .zip file or included in plugins.svn.wordpress.org, but can be found in the [plugin's GitHub repository](https://github.com/coffee2code/remember-me-controls/). |
  | 99 | 99 |  |
  | 100 | 100 |  |
  | […](/browser/remember-me-controls/trunk/readme.txt?rev=2928246#L107) | […](/browser/remember-me-controls/tags/2.1/readme.txt?rev=3146603#L107) |  |
  | 107 | 107 |  |
  | 108 | 108 | == Changelog == |
  |  | 109 |  |
  |  | 110 | = 2.1 (2024-09-01) = |
  |  | 111 | Highlights: |
  |  | 112 |  |
  |  | 113 | This minor release primarily updates the plugin framework to the most current version (for security hardening and miscellaneous improvements), prevents translations from containing unintended markup, notes compatibility through WP 6.6+, drops compatibility with versions of WP older than 5.5, and removes unit tests from release packaging. |
  |  | 114 |  |
  |  | 115 | Details: |
  |  | 116 |  |
  |  | 117 | \* Change: Update plugin framework to 067 |
  |  | 118 | \* 067: |
  |  | 119 | \* Change: Simplify `form\_action\_url()` to avoid using a server global |
  |  | 120 | \* Change: Use `form\_action\_url()` in `plugin\_action\_links()` rather than duplicating its functionality |
  |  | 121 | \* Change: Escape output of all translated strings |
  |  | 122 | \* Change: Convert `register\_filters()` to an abstract declaration |
  |  | 123 | \* Change: Improve function documentation |
  |  | 124 | \* Change: Adjust function documentation formatting to align with WP core |
  |  | 125 | \* Change: Note compatibility through WP 6.5+ |
  |  | 126 | \* Change: Drop compatibility with version of WP older than 5.5 |
  |  | 127 | \* 066: |
  |  | 128 | \* New: Add customization of capability needed to manage plugin settings (via new filter {plugin\_prefix}\_manage\_options\_capability) |
  |  | 129 | \* Change: Make `get\_hook()` public rather than protected |
  |  | 130 | \* Change: Add styles for nested lists within settings descriptions |
  |  | 131 | \* Change: Simplify `form\_action\_url()` |
  |  | 132 | \* Change: Use `form\_action\_url()` in `plugin\_action\_links()` rather than duplicating its functionality |
  |  | 133 | \* Change: Explicitly declare object variables rather than doing so dynamically. Fixes #1. |
  |  | 134 | \* Change: Note compatibility through WP 6.4+ |
  |  | 135 | \* Change: Update copyright date (2024) |
  |  | 136 | \* Change: Ensure translations don't contain unintended markup |
  |  | 137 | \* Change: Add missing inline comments to translators |
  |  | 138 | \* Change: Note compatibility through WP 6.6+ |
  |  | 139 | \* Change: Drop compatibility with versions of WP older than 5.5 |
  |  | 140 | \* Change: Update copyright date (2024) |
  |  | 141 | \* New: Add `.gitignore` file |
  |  | 142 | \* Change: Remove development and testing-related files from release packaging |
  |  | 143 | \* Change: Reduce number of 'Tags' from `readme.txt` |
  |  | 144 | \* Change: Tweak text formatting in `README.md` |
  |  | 145 | \* Unit tests: |
  |  | 146 | \* Hardening: Prevent direct web access to `bootstrap.php` |
  |  | 147 | \* Allow tests to run against current versions of WordPress |
  |  | 148 | \* New: Add `composer.json` for PHPUnit Polyfill dependency |
  |  | 149 | \* Change: Prevent PHP warnings due to missing core-related generated files |
  |  | 150 | \* Change: In bootstrap, store path to plugin directory in a constant |
  | 109 | 151 |  |
  | 110 | 152 | = 2.0.1 (2023-06-19) = |
  | […](/browser/remember-me-controls/trunk/readme.txt?rev=2928246#L208) | […](/browser/remember-me-controls/tags/2.1/readme.txt?rev=3146603#L250) |  |
  | 208 | 250 | \* Change: In bootstrap, add backcompat for PHPUnit pre-v6.0 |
  | 209 | 251 |  |
  | 210 |  | ~~= 1.9.1 (2021-02-13) =~~ |
  | 211 |  | ~~\* Fix: Add missing textdomain. Props @kittmedia.~~ |
  | 212 |  | ~~\* Change: Enhance a FAQ answer to make clear that an existing login session will not be affected by an update to the remember me duration (must log in again)~~ |
  | 213 |  | ~~\* Change: Note compatibility through WP 5.6+~~ |
  | 214 |  | ~~\* Change: Update copyright date (2021)~~ |
  | 215 |  |  |
  | 216 | 252 | \_Full changelog is available in [CHANGELOG.md](https://github.com/coffee2code/remember-me-controls/blob/master/CHANGELOG.md).\_ |
  | 217 | 253 |  |
  | 218 | 254 |  |
  | 219 | 255 | == Upgrade Notice == |
  |  | 256 |  |
  |  | 257 | = 2.1 = |
  |  | 258 | Minor update: updated plugin framework, prevented translations from containing unintended markup, noted compatibility through WP 6.6+, dropped compatibility with versions of WP older than 5.5, removed unit tests from release packaging, and updated copyright date (2024) |
  | 220 | 259 |  |
  | 221 | 260 | = 2.0.1 = |
* ## [remember-me-controls/tags/2.1/remember-me-controls.php](/changeset/3146603/remember-me-controls/tags/2.1/remember-me-controls.php "Show the changeset 3146603 restricted to remember-me-controls/tags/2.1/remember-me-controls.php")

  | [r2928246](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L2 "Show revision 2928246 of this file in browser") | [r3146603](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L2 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Plugin Name: Remember Me Controls |
  | 4 |  | \* Version:     2.~~0.~~1 |
  |  | 4 | \* Version:     2.1 |
  | 5 | 5 | \* Plugin URI:  https://coffee2code.com/wp-plugins/remember-me-controls/ |
  | 6 | 6 | \* Author:      Scott Reilly |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L11) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L11) |  |
  | 11 | 11 | \* Description: Have "Remember Me" checked by default on the login page and configure how long a login is remembered. Or disable the feature altogether. |
  | 12 | 12 | \* |
  | 13 |  | \* Compatible with WordPress ~~4.9+ through 6.2~~+. |
  |  | 13 | \* Compatible with WordPress 5.5+ through 6.6+. |
  | 14 | 14 | \* |
  | 15 | 15 | \* =>> Read the accompanying readme.txt file for instructions and documentation. |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L19) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L19) |  |
  | 19 | 19 | \* @package Remember\_Me\_Controls |
  | 20 | 20 | \* @author  Scott Reilly |
  | 21 |  | \* @version 2.~~0.~~1 |
  |  | 21 | \* @version 2.1 |
  | 22 | 22 | \*/ |
  | 23 | 23 |  |
  | 24 | 24 | /\* |
  | 25 |  | Copyright (c) 2009-202~~3~~ by Scott Reilly (aka coffee2code) |
  |  | 25 | Copyright (c) 2009-2024 by Scott Reilly (aka coffee2code) |
  | 26 | 26 |  |
  | 27 | 27 | This program is free software; you can redistribute it and/or |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L46) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L46) |  |
  | 46 | 46 | require\_once( dirname( \_\_FILE\_\_ ) . DIRECTORY\_SEPARATOR . 'c2c-plugin.php' ); |
  | 47 | 47 |  |
  | 48 |  | final class c2c\_RememberMeControls extends c2c\_Plugin\_06~~5~~ { |
  |  | 48 | final class c2c\_RememberMeControls extends c2c\_Plugin\_067 { |
  | 49 | 49 |  |
  | 50 | 50 | /\*\* |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L80) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L80) |  |
  | 80 | 80 | \*/ |
  | 81 | 81 | protected function \_\_construct() { |
  | 82 |  | parent::\_\_construct( '2.~~0.~~1', 'remember-me-controls', 'c2c', \_\_FILE\_\_, array() ); |
  |  | 82 | parent::\_\_construct( '2.1', 'remember-me-controls', 'c2c', \_\_FILE\_\_, array() ); |
  | 83 | 83 | register\_activation\_hook( \_\_FILE\_\_, array( \_\_CLASS\_\_, 'activation' ) ); |
  | 84 | 84 |  |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L233) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L233) |  |
  | 233 | 233 | => \_\_( 'Donate', 'remember-me-controls' ), |
  | 234 | 234 | 'Expected integer value for: %s' |
  |  | 235 | /\* translators: %s: Setting name. \*/ |
  | 235 | 236 | => \_\_( 'Expected integer value for: %s', 'remember-me-controls' ), |
  | 236 | 237 | 'If this plugin has been useful to you, please consider a donation' |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L288) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L289) |  |
  | 288 | 289 | parent::options\_page\_description( \_\_( 'Remember Me Controls Settings', 'remember-me-controls' ) ); |
  | 289 | 290 |  |
  | 290 |  | echo '<p>' . \_\_( 'Take control of the "Remember Me" login feature for WordPress by customizing its behavior or disabling it altogether.', 'remember-me-controls' ) . "</p>\n"; |
  | 291 |  | echo '<p>' . \_\_( 'For those unfamiliar, "Remember Me" is a checkbox present when logging into WordPress. If checked, by default WordPress will remember the login session for 14 days. If unchecked, the login session will be remembered for only 2 days. Once a login session expires, WordPress will require you to log in again if you wish to continue using the admin section of the site.', 'remember-me-controls' ) . "</p>\n"; |
  | 292 |  | echo '<p>' . \_\_( 'NOTE: WordPress remembers who you are based on cookies stored in your web browser. If you use a different web browser, clear your cookies, use a browser on a different machine, the site owner invalidates all existing login sessions, or you uninstall/reinstall (and possibly even just restart) your browser then you will have to log in again since WordPress will not be able to locate the cookies needed to identify you.', 'remember-me-controls' ) . "</p>\n"; |
  | 293 |  | echo '<p>' . \_\_( 'NOTE: Any changes to the duration of a login session only take effect on subsequent logins and will not affect currently active sessions.', 'remember-me-controls' ) . "</p>\n"; |
  |  | 291 | echo '<p>' . esc\_html\_\_( 'Take control of the "Remember Me" login feature for WordPress by customizing its behavior or disabling it altogether.', 'remember-me-controls' ) . "</p>\n"; |
  |  | 292 | echo '<p>' . esc\_html\_\_( 'For those unfamiliar, "Remember Me" is a checkbox present when logging into WordPress. If checked, by default WordPress will remember the login session for 14 days. If unchecked, the login session will be remembered for only 2 days. Once a login session expires, WordPress will require you to log in again if you wish to continue using the admin section of the site.', 'remember-me-controls' ) . "</p>\n"; |
  |  | 293 | echo '<p>' . esc\_html\_\_( 'NOTE: WordPress remembers who you are based on cookies stored in your web browser. If you use a different web browser, clear your cookies, use a browser on a different machine, the site owner invalidates all existing login sessions, or you uninstall/reinstall (and possibly even just restart) your browser then you will have to log in again since WordPress will not be able to locate the cookies needed to identify you.', 'remember-me-controls' ) . "</p>\n"; |
  |  | 294 | echo '<p>' . esc\_html\_\_( 'NOTE: Any changes to the duration of a login session only take effect on subsequent logins and will not affect currently active sessions.', 'remember-me-controls' ) . "</p>\n"; |
  | 294 | 295 |  |
  | 295 | 296 | $this->display\_current\_login\_duration(); |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L314) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L315) |  |
  | 314 | 315 | if ( $years ) { |
  | 315 | 316 | $year\_string = sprintf( |
  |  | 317 | /\* translators: %d: number of years \*/ |
  | 316 | 318 | \_n( '%d year', '%d years', $years, 'remember-me-controls' ), |
  | 317 | 319 | $years |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L325) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L327) |  |
  | 325 | 327 | if ( $months ) { |
  | 326 | 328 | $month\_string = sprintf( |
  |  | 329 | /\* translators: %d: number of months \*/ |
  | 327 | 330 | \_n( '%d month', '%d months', $months, 'remember-me-controls' ), |
  | 328 | 331 | $months |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L336) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L339) |  |
  | 336 | 339 | if ( $days ) { |
  | 337 | 340 | $day\_string = sprintf( |
  |  | 341 | /\* translators: %d: number of days \*/ |
  | 338 | 342 | \_n( '%d day', '%d days', $days, 'remember-me-controls' ), |
  | 339 | 343 | $days |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L347) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L351) |  |
  | 347 | 351 | if ( $hours ) { |
  | 348 | 352 | $hour\_string = sprintf( |
  |  | 353 | /\* translators: %d: number of hours \*/ |
  | 349 | 354 | \_n( '%d hour', '%d hours', $hours, 'remember-me-controls' ), |
  | 350 | 355 | $hours |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L382) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L387) |  |
  | 382 | 387 | $max = floor( $duration\_in\_sec / YEAR\_IN\_SECONDS ); |
  | 383 | 388 | $human\_duration = sprintf( |
  |  | 389 | /\* translators: %d: number of years \*/ |
  | 384 | 390 | \_n( '%d year', '%d years', $max, 'remember-me-controls' ), |
  | 385 | 391 | $max |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L416) | […](/browser/remember-me-controls/tags/2.1/remember-me-controls.php?rev=3146603#L422) |  |
  | 416 | 422 | echo '<div class="c2c-remember-me-duration-banner">'; |
  | 417 | 423 | printf( |
  | 418 |  | \_\_( 'Currently, a remembered user login session will last up to <strong>%s</strong>.', 'remember-me-controls' ), |
  | 419 |  | $hours |
  |  | 424 | wp\_kses( |
  |  | 425 | /\* translators: %s: Already translated string using words to express the duration of a remember login session. \*/ |
  |  | 426 | \_\_( 'Currently, a remembered user login session will last up to <strong>%s</strong>.', 'remember-me-controls' ), |
  |  | 427 | [ 'strong' => array() ] |
  |  | 428 | ), |
  |  | 429 | esc\_html( $hours ) |
  | 420 | 430 | ); |
  | 421 | 431 | echo '</div>' . "\n"; |
* ## [remember-me-controls/trunk/CHANGELOG.md](/changeset/3146603/remember-me-controls/trunk/CHANGELOG.md "Show the changeset 3146603 restricted to remember-me-controls/trunk/CHANGELOG.md")

  | [r2928246](/browser/remember-me-controls/trunk/CHANGELOG.md?rev=2928246#L1 "Show revision 2928246 of this file in browser") | [r3146603](/browser/remember-me-controls/trunk/CHANGELOG.md?rev=3146603#L1 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | # Changelog |
  |  | 2 |  |
  |  | 3 | ## 2.1 \_(2024-09-01)\_ |
  |  | 4 |  |
  |  | 5 | ### Highlights: |
  |  | 6 |  |
  |  | 7 | This minor release primarily updates the plugin framework to the most current version (for security hardening and miscellaneous improvements), prevents translations from containing unintended markup, notes compatibility through WP 6.6+, drops compatibility with versions of WP older than 5.5, and removes unit tests from release packaging. |
  |  | 8 |  |
  |  | 9 | ### Details: |
  |  | 10 |  |
  |  | 11 | \* Change: Update plugin framework to 067 |
  |  | 12 | \* 067: |
  |  | 13 | \* Change: Simplify `form\_action\_url()` to avoid using a server global |
  |  | 14 | \* Change: Use `form\_action\_url()` in `plugin\_action\_links()` rather than duplicating its functionality |
  |  | 15 | \* Change: Escape output of all translated strings |
  |  | 16 | \* Change: Convert `register\_filters()` to an abstract declaration |
  |  | 17 | \* Change: Improve function documentation |
  |  | 18 | \* Change: Adjust function documentation formatting to align with WP core |
  |  | 19 | \* Change: Note compatibility through WP 6.5+ |
  |  | 20 | \* Change: Drop compatibility with version of WP older than 5.5 |
  |  | 21 | \* 066: |
  |  | 22 | \* New: Add customization of capability needed to manage plugin settings (via new filter {plugin\_prefix}\_manage\_options\_capability) |
  |  | 23 | \* Change: Make `get\_hook()` public rather than protected |
  |  | 24 | \* Change: Add styles for nested lists within settings descriptions |
  |  | 25 | \* Change: Simplify `form\_action\_url()` |
  |  | 26 | \* Change: Use `form\_action\_url()` in `plugin\_action\_links()` rather than duplicating its functionality |
  |  | 27 | \* Change: Explicitly declare object variables rather than doing so dynamically. Fixes #1. |
  |  | 28 | \* Change: Note compatibility through WP 6.4+ |
  |  | 29 | \* Change: Update copyright date (2024) |
  |  | 30 | \* Change: Ensure translations don't contain unintended markup |
  |  | 31 | \* Change: Add missing inline comments to translators |
  |  | 32 | \* Change: Note compatibility through WP 6.6+ |
  |  | 33 | \* Change: Drop compatibility with versions of WP older than 5.5 |
  |  | 34 | \* Change: Update copyright date (2024) |
  |  | 35 | \* New: Add `.gitignore` file |
  |  | 36 | \* Change: Remove development and testing-related files from release packaging |
  |  | 37 | \* Change: Reduce number of 'Tags' from `readme.txt` |
  |  | 38 | \* Change: Tweak text formatting in `README.md` |
  |  | 39 | \* Unit tests: |
  |  | 40 | \* Hardening: Prevent direct web access to `bootstrap.php`. Props stealthcopter. |
  |  | 41 | \* Allow tests to run against current versions of WordPress |
  |  | 42 | \* New: Add `composer.json` for PHPUnit Polyfill dependency |
  |  | 43 | \* Change: Prevent PHP warnings due to missing core-related generated files |
  |  | 44 | \* Change: In bootstrap, store path to plugin directory in a constant |
  | 2 | 45 |  |
  | 3 | 46 | ## 2.0.1 \_(2023-06-19)\_ |
* ## [remember-me-controls/trunk/README.md](/changeset/3146603/remember-me-controls/trunk/README.md "Show the changeset 3146603 restricted to remember-me-controls/trunk/README.md")

  | [r2114548](/browser/remember-me-controls/trunk/README.md?rev=2114548#L15 "Show revision 2114548 of this file in browser") | [r3146603](/browser/remember-me-controls/trunk/README.md?rev=3146603#L15 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | ## Additional Documentation |
  | 16 | 16 |  |
  | 17 |  | See [readme.txt](https://github.com/coffee2code/remember-me-controls/blob/master/readme.txt) for additional usage information. See [CHANGELOG.md](CHANGELOG.md) for the list of changes for each release. |
  |  | 17 | \* See [readme.txt](https://github.com/coffee2code/remember-me-controls/blob/master/readme.txt) for additional usage information. |
  |  | 18 | \* See [CHANGELOG.md](CHANGELOG.md) for the list of changes for each release. |
  | 18 | 19 |  |
  | 19 | 20 |  |
* ## [remember-me-controls/trunk/c2c-plugin.php](/changeset/3146603/remember-me-controls/trunk/c2c-plugin.php "Show the changeset 3146603 restricted to remember-me-controls/trunk/c2c-plugin.php")

  | [r2926197](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L3 "Show revision 2926197 of this file in browser") | [r3146603](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L3 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @package C2C\_Plugin |
  | 4 | 4 | \* @author  Scott Reilly |
  | 5 |  | \* @version 06~~5~~ |
  |  | 5 | \* @version 067 |
  | 6 | 6 | \*/ |
  | 7 | 7 | /\* |
  | 8 | 8 | Basis for other plugins. |
  | 9 | 9 |  |
  | 10 |  | Compatible with WordPress ~~4.9 through 6.2~~+. |
  |  | 10 | Compatible with WordPress 5.5 through 6.5+. |
  | 11 | 11 |  |
  | 12 | 12 | \*/ |
  | 13 | 13 |  |
  | 14 | 14 | /\* |
  | 15 |  | Copyright (c) 2010-202~~3~~ by Scott Reilly (aka coffee2code) |
  |  | 15 | Copyright (c) 2010-2024 by Scott Reilly (aka coffee2code) |
  | 16 | 16 |  |
  | 17 | 17 | This program is free software; you can redistribute it and/or |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L32) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L32) |  |
  | 32 | 32 | defined( 'ABSPATH' ) or die(); |
  | 33 | 33 |  |
  | 34 |  | if ( ! class\_exists( 'c2c\_Plugin\_065' ) ) : |
  | 35 |  |  |
  | 36 |  | abstract class c2c\_Plugin\_065 { |
  |  | 34 | if ( ! class\_exists( 'c2c\_Plugin\_067' ) ) : |
  |  | 35 |  |
  |  | 36 | abstract class c2c\_Plugin\_067 { |
  |  | 37 |  |
  |  | 38 | /\*\* @var string The name of the option used to store plugin's settings. \*/ |
  |  | 39 | public $admin\_options\_name = ''; |
  |  | 40 |  |
  |  | 41 | /\*\* @var array Associative array of configuration settings for the plugin.  \*/ |
  |  | 42 | public $config = array(); |
  |  | 43 |  |
  |  | 44 | /\*\* @var bool Prevent overriding of the contextual help? \*/ |
  |  | 45 | public $disable\_contextual\_help = false; |
  |  | 46 |  |
  |  | 47 | /\*\* @var bool Prevent WP from checking for updates to this plugin? \*/ |
  |  | 48 | public $disable\_update\_check = false; |
  |  | 49 |  |
  |  | 50 | /\*\* @var string Prefix for all hooks. \*/ |
  |  | 51 | public $hook\_prefix; |
  |  | 52 |  |
  |  | 53 | /\*\* @var string Name assigned to the settings form. \*/ |
  |  | 54 | public $form\_name; |
  |  | 55 |  |
  |  | 56 | /\*\* @var string The name used for the plugin's settings page in the admin menu. \*/ |
  |  | 57 | public $menu\_name; |
  |  | 58 |  |
  |  | 59 | /\*\* @var string Full, localized version of the plugin name. \*/ |
  |  | 60 | public $name; |
  |  | 61 |  |
  |  | 62 | /\*\* @var string Nonce field value use on the settings form. \*/ |
  |  | 63 | public $nonce\_field; |
  |  | 64 |  |
  |  | 65 | /\*\* @var string The core settings page under which the plugin settings page will be listed in the admin menu. \*/ |
  |  | 66 | public $settings\_page; |
  |  | 67 |  |
  |  | 68 | /\*\* @var bool Should settings page be shown? Only applies if admin is enabled. \*/ |
  |  | 69 | public $show\_admin; |
  |  | 70 |  |
  |  | 71 | /\*\* @var string Textdomain for localization. \*/ |
  |  | 72 | public $textdomain; |
  |  | 73 |  |
  |  | 74 | /\*\* @var string Subdirectory, relative to plugin's root, to hold localization files. \*/ |
  |  | 75 | public $textdomain\_subdir; |
  |  | 76 |  |
  |  | 77 | /\*\* @var string Short (2-3 char) identifier for plugin author. \*/ |
  |  | 78 | public $author\_prefix; |
  |  | 79 |  |
  |  | 80 | /\*\* @var string A unique base ID for the plugin (generally a lower-case, dash-separated version of plugin name). \*/ |
  |  | 81 | public $id\_base; |
  |  | 82 |  |
  |  | 83 | /\*\* @var string The options page ID returned when the options page gets created. \*/ |
  |  | 84 | public $options\_page; |
  |  | 85 |  |
  |  | 86 | /\*\* @var string The path to the root of the plugin. \*/ |
  |  | 87 | public $plugin\_basename; |
  |  | 88 |  |
  |  | 89 | /\*\* @var string The path to the main plugin file. \*/ |
  |  | 90 | public $plugin\_file; |
  |  | 91 |  |
  |  | 92 | /\*\* @var string The URL to the main plugin file. \*/ |
  |  | 93 | public $plugin\_path; |
  |  | 94 |  |
  |  | 95 | /\*\* @var string The underscored version of $id\_base. \*/ |
  |  | 96 | public $u\_id\_base; |
  |  | 97 |  |
  |  | 98 | /\*\* @var string The current version of the plugin. \*/ |
  |  | 99 | public $version; |
  |  | 100 |  |
  | 37 | 101 | protected $plugin\_css\_version = '009'; |
  | 38 | 102 | protected $options            = array(); |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L48) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L112) |  |
  | 48 | 112 | 'inline\_help'      => '', |
  | 49 | 113 | 'input'            => '', |
  | 50 |  | 'input\_attributes' => ~~''~~, |
  |  | 114 | 'input\_attributes' => [], |
  | 51 | 115 | 'label'            => '', |
  | 52 | 116 | 'more\_help'        => '', |
  | 53 | 117 | 'no\_wrap'          => false, |
  | 54 | 118 | 'numbered'         => false, |
  | 55 |  | 'options'          => ~~''~~, |
  |  | 119 | 'options'          => [], |
  | 56 | 120 | 'output'           => '', // likely deprecated |
  | 57 | 121 | 'raw\_help'         => '', |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L70) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L134) |  |
  | 70 | 134 | \*/ |
  | 71 | 135 | public function c2c\_plugin\_version() { |
  | 72 |  | return '06~~5~~'; |
  |  | 136 | return '067'; |
  | 73 | 137 | } |
  | 74 | 138 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L85) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L149) |  |
  | 85 | 149 | $id\_base = sanitize\_title( $id\_base ); |
  | 86 | 150 | if ( ! file\_exists( $file ) ) { |
  | 87 |  | die( ~~sprintf( $this->get\_c2c\_string( 'Invalid file specified for C2C\_Plugin: %s' ), $file~~ ) ); |
  |  | 151 | die( esc\_html( sprintf( $this->get\_c2c\_string( 'Invalid file specified for C2C\_Plugin: %s' ), $file ) ) ); |
  | 88 | 152 | } |
  | 89 | 153 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L136) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L200) |  |
  | 136 | 200 | \*/ |
  | 137 | 201 | public function \_\_clone() { |
  | 138 |  | /\* translators: %s: Name of plugin class. \*/ |
  | 139 |  | throw new Error( sprintf( $this->get\_c2c\_string( '%s cannot be cloned.' ), \_\_CLASS\_\_ ) ); |
  |  | 202 | throw new Error( esc\_html( sprintf( $this->get\_c2c\_string( '%s cannot be cloned.' ), \_\_CLASS\_\_ ) ) ); |
  | 140 | 203 | } |
  | 141 | 204 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L147) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L210) |  |
  | 147 | 210 | \*/ |
  | 148 | 211 | public function \_\_wakeup() { |
  | 149 |  | /\* translators: %s: Name of plugin class. \*/ |
  | 150 |  | throw new Error( sprintf( $this->get\_c2c\_string( '%s cannot be unserialized.' ), \_\_CLASS\_\_ ) ); |
  |  | 212 | throw new Error( esc\_html( sprintf( $this->get\_c2c\_string( '%s cannot be unserialized.' ), \_\_CLASS\_\_ ) ) ); |
  | 151 | 213 | } |
  | 152 | 214 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L195) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L257) |  |
  | 195 | 257 | } |
  | 196 | 258 |  |
  | 197 |  | if ( $this->show\_admin && $this->settings\_page && ! empty( $this->config ) && current\_user\_can( ~~'manage\_options'~~ ) ) { |
  |  | 259 | if ( $this->show\_admin && $this->settings\_page && ! empty( $this->config ) && current\_user\_can( $this->get\_manage\_options\_capability() ) ) { |
  | 198 | 260 | add\_action( 'admin\_menu', array( $this, 'admin\_menu' ) ); |
  | 199 | 261 | if ( ! $this->disable\_contextual\_help ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L306) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L368) |  |
  | 306 | 368 |  |
  | 307 | 369 | /\*\* |
  |  | 370 | \* Returns the capability needed to configure the plugin via its settings page. |
  |  | 371 | \* |
  |  | 372 | \* Note: This does not actually check if the plugin has a settings page, only |
  |  | 373 | \* what the capability is that would be needed to use it if it was enabled. |
  |  | 374 | \* |
  |  | 375 | \* @since 066 |
  |  | 376 | \* |
  |  | 377 | \* @return string The capability. Default 'manage\_options'. |
  |  | 378 | \*/ |
  |  | 379 | public function get\_manage\_options\_capability() { |
  |  | 380 | $default\_cap = 'manage\_options'; |
  |  | 381 | /\*\* |
  |  | 382 | \* Filters the capability needed to configure the plugin via its settings page. |
  |  | 383 | \* |
  |  | 384 | \* @since 066 |
  |  | 385 | \* |
  |  | 386 | \* @param string $capability The capability. Default 'manage\_options'. |
  |  | 387 | \*/ |
  |  | 388 | $cap = apply\_filters( $this->get\_hook( 'manage\_options\_capability' ), $default\_cap ); |
  |  | 389 | if ( ! $cap || ! is\_string( $cap ) ) { |
  |  | 390 | $cap = $default\_cap; |
  |  | 391 | } |
  |  | 392 |  |
  |  | 393 | return $cap; |
  |  | 394 | } |
  |  | 395 |  |
  |  | 396 | /\*\* |
  | 308 | 397 | \* Initializes options. |
  | 309 | 398 | \*/ |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L334) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L423) |  |
  | 334 | 423 | $added = array( $this->admin\_options\_name => array( $this->admin\_options\_name ) ); |
  | 335 | 424 |  |
  | 336 |  | return function\_exists( 'add\_allowed\_options' ) |
  | 337 |  | ? add\_allowed\_options( $added, $options ) |
  | 338 |  | : add\_option\_whitelist( $added, $options ); |
  |  | 425 | return add\_allowed\_options( $added, $options ); |
  | 339 | 426 | } |
  | 340 | 427 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L351) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L438) |  |
  | 351 | 438 | } |
  | 352 | 439 |  |
  | 353 |  | if ( ~~empty( $localized\_heading\_text )~~ ) { |
  |  | 440 | if ( ! $localized\_heading\_text ) { |
  | 354 | 441 | $localized\_heading\_text = $this->name; |
  | 355 | 442 | } |
  | 356 | 443 | if ( $localized\_heading\_text ) { |
  | 357 |  | echo '<h1>' . ~~$localized\_heading\_text~~ . "</h1>\n"; |
  |  | 444 | echo '<h1>' . esc\_html( $localized\_heading\_text ) . "</h1>\n"; |
  | 358 | 445 | } |
  | 359 | 446 | if ( ! $this->disable\_contextual\_help ) { |
  | 360 |  | echo '<p class="see-help">' . ~~$this->get\_c2c\_string( 'See the "Help" link to the top-right of the page for more help.'~~ ) . "</p>\n"; |
  |  | 447 | echo '<p class="see-help">' . esc\_html( $this->get\_c2c\_string( 'See the "Help" link to the top-right of the page for more help.' ) ) . "</p>\n"; |
  | 361 | 448 | } |
  | 362 | 449 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L406) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L493) |  |
  | 406 | 493 | /\*\* |
  | 407 | 494 | \* Sanitizes user inputs prior to saving. |
  |  | 495 | \* |
  |  | 496 | \* @param string[] $inputs |
  |  | 497 | \* @return string[] Sanitized inputs. |
  | 408 | 498 | \*/ |
  | 409 | 499 | public function sanitize\_inputs( $inputs ) { |
  | 410 | 500 | do\_action( $this->get\_hook( 'before\_save\_options' ), $this ); |
  |  | 501 | // PHPCS: The Settings API already verifies nonce, so no need to do so here. |
  |  | 502 | // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 411 | 503 | if ( isset( $\_POST['Reset'] ) ) { |
  | 412 | 504 | $options = $this->reset\_options(); |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L444) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L536) |  |
  | 444 | 536 | } |
  | 445 | 537 | if ( ! empty( $val ) && ( ! is\_numeric( $val ) || ( intval( $val ) != round( $val ) ) ) ) { |
  | 446 |  | ~~/\* translators: %s: Label for setting. \*/~~ |
  | 447 | 538 | $msg = sprintf( $this->get\_c2c\_string( 'Expected integer value for: %s' ), $this->config[ $opt ]['label'] ); |
  | 448 | 539 | $error = true; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L507) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L598) |  |
  | 507 | 598 |  |
  | 508 | 599 | /\*\* |
  |  | 600 | \* Registers filters. |
  |  | 601 | \* |
  |  | 602 | \* @since 065 Changed to be abstract. |
  |  | 603 | \* |
  |  | 604 | \* NOTE: This occurs during the 'init' filter, so you can't use this to hook |
  |  | 605 | \* anything that happens earlier. |
  |  | 606 | \*/ |
  |  | 607 | abstract public function register\_filters(); |
  |  | 608 |  |
  |  | 609 | /\*\* |
  | 509 | 610 | \* Adds a new option to the plugin's configuration. |
  | 510 | 611 | \* |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L531) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L632) |  |
  | 531 | 632 |  |
  | 532 | 633 | /\*\* |
  | 533 |  | \* Verif~~y that the necessary configuration file~~s were set in the inheriting class. |
  |  | 634 | \* Verifies that the necessary configuration options were set in the inheriting class. |
  | 534 | 635 | \*/ |
  | 535 | 636 | public function verify\_config() { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L537) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L638) |  |
  | 537 | 638 | foreach ( $this->required\_config as $config ) { |
  | 538 | 639 | if ( empty( $this->$config ) ) { |
  | 539 |  | die( ~~sprintf( $this->get\_c2c\_string( "The plugin configuration option '%s' must be supplied." ), $config~~ ) ); |
  |  | 640 | die( esc\_html( sprintf( $this->get\_c2c\_string( "The plugin configuration option '%s' must be supplied." ), $config ) ) ); |
  | 540 | 641 | } |
  | 541 | 642 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L565) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L666) |  |
  | 565 | 666 | foreach ( $options as $opt ) { |
  | 566 | 667 | foreach ( $this->config\_attributes as $attrib => $default) { |
  |  | 668 | // Use the default if not configured. |
  | 567 | 669 | if ( ! isset( $this->config[ $opt ][ $attrib ] ) ) { |
  | 568 | 670 | $this->config[ $opt ][ $attrib ] = $default; |
  | 569 | 671 | } |
  |  | 672 | // Ensure configured value is of same datatype as default. |
  |  | 673 | else { |
  |  | 674 | // Config attributes that can be any datatype (or at least can differ from the default). |
  |  | 675 | $can\_be\_any\_datatype = [ 'default' ]; |
  |  | 676 |  |
  |  | 677 | $configured\_value = $this->config[ $opt ][ $attrib ]; |
  |  | 678 | $datatype = ''; |
  |  | 679 | if ( in\_array( $attrib, $can\_be\_any\_datatype ) ) { |
  |  | 680 | // Do nothing. |
  |  | 681 | } elseif ( is\_array( $default ) && ! is\_array( $configured\_value ) ) { |
  |  | 682 | $datatype = 'an array'; |
  |  | 683 | } elseif ( is\_bool( $default ) && ! is\_bool( $configured\_value ) ) { |
  |  | 684 | $datatype = 'a boolean'; |
  |  | 685 | } elseif ( is\_int( $default ) && ! is\_int( $configured\_value ) ) { |
  |  | 686 | $datatype = 'an integer'; |
  |  | 687 | } elseif ( is\_float( $default ) && ! is\_float( $configured\_value ) ) { |
  |  | 688 | $datatype = 'a float'; |
  |  | 689 | } elseif ( is\_string( $default ) && ! is\_string( $configured\_value ) ) { |
  |  | 690 | $datatype = 'a string'; |
  |  | 691 | } |
  |  | 692 |  |
  |  | 693 | if ( $datatype ) { |
  |  | 694 | \_doing\_it\_wrong( 'c2c\_Plugin::verify\_options', esc\_html( "The c2c\_Plugin configuration {$opt} attribute {$attrib} should be {$datatype} and thus the default is being used instead." ), '067' ); |
  |  | 695 | $this->config[ $opt ][ $attrib ] = $default; |
  |  | 696 | } |
  |  | 697 | } |
  | 570 | 698 | } |
  |  | 699 |  |
  | 571 | 700 | if ( 'array' === $this->config[ $opt ]['datatype'] && ! is\_array( $this->config[ $opt ]['default'] ) ) { |
  | 572 | 701 | $this->config[ $opt ]['default'] = $this->config[ $opt ]['default'] ? |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L586) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L715) |  |
  | 586 | 715 |  |
  | 587 | 716 | /\*\* |
  | 588 |  | ~~\* Registers filters.~~ |
  | 589 |  | ~~\* NOTE: This occurs during the 'init' filter, so you can't use this to hook~~ |
  | 590 |  | ~~\* anything that happens earlier.~~ |
  | 591 |  | ~~\*/~~ |
  | 592 |  | ~~public function register\_filters() {~~ |
  | 593 |  | ~~// This should be overridden in order to define filters.~~ |
  | 594 |  | ~~}~~ |
  | 595 |  |  |
  | 596 |  | ~~/\*\*~~ |
  | 597 | 717 | \* Returns markup for simple contextual help text, comprising solely of a |
  | 598 | 718 | \* thickboxed link to the plugin's hosted readme.txt file. |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L612) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L732) |  |
  | 612 | 732 | } |
  | 613 | 733 |  |
  | 614 |  | $help = '<h3>' . ~~$this->get\_c2c\_string( 'More Plugin Help'~~ ) . '</h3>'; |
  |  | 734 | $help = '<h3>' . esc\_html( $this->get\_c2c\_string( 'More Plugin Help' ) ) . '</h3>'; |
  | 615 | 735 | $help .= '<p class="more-help">'; |
  | 616 | 736 | $help .= sprintf( |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L618) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L738) |  |
  | 618 | 738 | esc\_attr( sprintf( $this->get\_c2c\_string( 'More information about %1$s %2$s' ), $this->name, $this->version ) ), |
  | 619 | 739 | esc\_url( admin\_url( "plugin-install.php?tab=plugin-information&amp;plugin={$this->id\_base}&amp;TB\_iframe=true&amp;width=640&amp;height=514" ) ), |
  | 620 |  | ~~$this->get\_c2c\_string( 'Click for more help on this plugin'~~ ), |
  | 621 |  | ~~$this->get\_c2c\_string( ' (especially check out the "Other Notes" tab, if present)'~~ ) |
  |  | 740 | esc\_html( $this->get\_c2c\_string( 'Click for more help on this plugin' ) ), |
  |  | 741 | esc\_html( $this->get\_c2c\_string( ' (especially check out the "Other Notes" tab, if present)' ) ) |
  | 622 | 742 | ); |
  | 623 | 743 | $help .= ".</p>\n"; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L641) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L761) |  |
  | 641 | 761 | $c2c\_plugin\_css\_was\_output = true; |
  | 642 | 762 | $logo = plugins\_url( 'c2c\_minilogo.png', $this->plugin\_file ); |
  |  | 763 |  |
  | 643 | 764 | /\*\* |
  | 644 |  | \* ~~Remember to increment the plugin\_css\_version variable if changing the CSS~~ |
  |  | 765 | \* Note: Remember to increment the plugin\_css\_version variable if changing the CSS. |
  | 645 | 766 | \*/ |
  | 646 |  | ~~echo <<<HTML~~ |
  |  | 767 | ?> |
  | 647 | 768 | <style> |
  | 648 | 769 | .long-text {width:98% !important;} |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L663) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L784) |  |
  | 663 | 784 | width:45%; |
  | 664 | 785 | min-height:40px; |
  | 665 |  | background:url('~~$logo~~') no-repeat center right; |
  |  | 786 | background:url('<?php echo esc\_url( $logo ); ?>') no-repeat center right; |
  | 666 | 787 | font-size:larger; |
  | 667 | 788 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L685) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L806) |  |
  | 685 | 806 | ul.description, ol.description {color:#646970;margin:10px 0;list-style:disc;} |
  | 686 | 807 | ul.description li, ol.description li {margin-left:1rem;} |
  |  | 808 | ul.description ul, ul.description ol, ol.description ul, ol.description ol {list-style:circle;margin-top:0.4rem;} |
  | 687 | 809 | </style> |
  | 688 |  |  |
  | 689 |  | HTML; |
  |  | 810 | <?php |
  | 690 | 811 | } |
  | 691 | 812 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L707) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L828) |  |
  | 707 | 828 | $menu\_func = 'add\_' . $func\_root . '\_page'; |
  | 708 | 829 | if ( function\_exists( $menu\_func ) ) { |
  | 709 |  | $this->options\_page = call\_user\_func( $menu\_func, $this->name, $this->menu\_name, ~~'manage\_options'~~, $this->plugin\_basename, array( $this, 'options\_page' ) ); |
  |  | 830 | $this->options\_page = call\_user\_func( $menu\_func, $this->name, $this->menu\_name, $this->get\_manage\_options\_capability(), $this->plugin\_basename, array( $this, 'options\_page' ) ); |
  | 710 | 831 | add\_action( 'load-' . $this->options\_page, array( $this, 'help\_tabs' ) ); |
  | 711 | 832 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L713) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L834) |  |
  | 713 | 834 |  |
  | 714 | 835 | /\*\* |
  | 715 |  | \* Initialize help tabs. |
  |  | 836 | \* Initializes help tabs. |
  | 716 | 837 | \* |
  | 717 | 838 | \* @since 034 |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L735) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L856) |  |
  | 735 | 856 | \* |
  | 736 | 857 | \* @since 034 |
  |  | 858 | \* |
  |  | 859 | \* @param WP\_Screen $screen |
  | 737 | 860 | \*/ |
  | 738 | 861 | public function help\_tabs\_content( $screen ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L752) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L875) |  |
  | 752 | 875 | \*/ |
  | 753 | 876 | public function plugin\_action\_links( $action\_links ) { |
  | 754 |  | $settings\_link = '<a href="' . ~~$this->settings\_page . '.php?page='.$this->plugin\_basename.~~'">' . $this->get\_c2c\_string( 'Settings' ) . '</a>'; |
  |  | 877 | $settings\_link = '<a href="' . esc\_url( $this->form\_action\_url() ) . '">' . $this->get\_c2c\_string( 'Settings' ) . '</a>'; |
  | 755 | 878 | array\_unshift( $action\_links, $settings\_link ); |
  | 756 | 879 | return $action\_links; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L759) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L882) |  |
  | 759 | 882 | /\*\* |
  | 760 | 883 | \* Adds donate link to plugin row. |
  |  | 884 | \* |
  |  | 885 | \* @param string[] $links Array of plugin row links. |
  |  | 886 | \* @param string   $file  Filename. |
  |  | 887 | \* @return string[] |
  | 761 | 888 | \*/ |
  | 762 | 889 | public function donate\_link( $links, $file ) { |
  | 763 |  | if ( $file == $this->plugin\_basename ) { |
  | 764 |  | $title         = $this->get\_c2c\_string( 'Coffee fuels my coding.' ); |
  | 765 |  | $links[] = '<a href="' . esc\_url( $this->donation\_url ) . '" title="' . esc\_attr( $title ) . '">' . $this->get\_c2c\_string( 'Donate' ) . '</a>'; |
  |  | 890 | if ( $file === $this->plugin\_basename ) { |
  |  | 891 | $title   = $this->get\_c2c\_string( 'Coffee fuels my coding.' ); |
  |  | 892 | $links[] = sprintf( |
  |  | 893 | '<a href="%s" title="%s">%s</a>', |
  |  | 894 | esc\_url( $this->donation\_url ), |
  |  | 895 | esc\_attr( $title ), |
  |  | 896 | esc\_html( $this->get\_c2c\_string( 'Donate' ) ) |
  |  | 897 | ); |
  | 766 | 898 | } |
  | 767 | 899 | return $links; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L769) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L901) |  |
  | 769 | 901 |  |
  | 770 | 902 | /\*\* |
  | 771 |  | \* ~~See if the setting is pertinent to this version of WP~~ |
  |  | 903 | \* Determines if the setting is pertinent to this version of WP. |
  | 772 | 904 | \* |
  | 773 | 905 | \* @since 013 |
  | 774 | 906 | \* |
  | 775 | 907 | \* @param string $opt The option name. |
  | 776 |  | \* |
  | 777 |  | \* @return bool If the option is valid for this version of WP. |
  |  | 908 | \* @return bool True if the option is valid for this version of WP, else false. |
  | 778 | 909 | \*/ |
  | 779 | 910 | protected function is\_option\_valid( $opt ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L796) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L927) |  |
  | 796 | 927 | \* |
  | 797 | 928 | \* @param bool $include\_non\_options Optional. Should non-options be included? Default is false. |
  | 798 |  | ~~\*~~ |
  | 799 | 929 | \* @return array Array of option names. |
  | 800 | 930 | \*/ |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L823) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L953) |  |
  | 823 | 953 | \* obtains the options and buffers the value. |
  | 824 | 954 | \* |
  | 825 |  | \* @param bool $with\_current\_values Optional. Should the currently saved values be returned?~~If false, then the plugin's defaults are returned. Default is true.~~ |
  | 826 |  | \* |
  | 827 |  | \* @return array The options array for the plugin~~(which is also stored in $this->options if !$with\_options)~~. |
  |  | 955 | \* @param bool $with\_current\_values Optional. Should the currently saved values be returned? |
  |  | 956 | \*                                  If false, then the plugin's defaults are returned. Default is true. |
  |  | 957 | \* @return array The options array for the plugin. |
  | 828 | 958 | \*/ |
  | 829 | 959 | public function get\_options( $with\_current\_values = true ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L871) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1001) |  |
  | 871 | 1001 | \* @since 037 |
  | 872 | 1002 | \* |
  | 873 |  | \* @param array $settings   The new setting~~value(s)~~ |
  |  | 1003 | \* @param array $settings   The new settings values. |
  | 874 | 1004 | \* @param bool  $with\_reset Should the options be reset, with the new settings overlaid on top of the default settings? |
  | 875 |  | ~~\*~~ |
  | 876 | 1005 | \* @return array |
  | 877 | 1006 | \*/ |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L889) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1018) |  |
  | 889 | 1018 | \* |
  | 890 | 1019 | \* @param string $prefix A prefix string, unique to the form. |
  | 891 |  | ~~\*~~ |
  | 892 | 1020 | \* @return string The name. |
  | 893 | 1021 | \*/ |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L897) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1025) |  |
  | 897 | 1025 |  |
  | 898 | 1026 | /\*\* |
  | 899 |  | \* Returns the ~~URL for a plugin's form to use for its action attribute~~ |
  | 900 |  | \* |
  | 901 |  | \* @return string The action URL |
  |  | 1027 | \* Returns the admin-relative URL for a plugin's form to use for its action attribute. |
  |  | 1028 | \* |
  |  | 1029 | \* @return string The action URL. |
  | 902 | 1030 | \*/ |
  | 903 | 1031 | protected function form\_action\_url() { |
  | 904 |  | return $~~\_SERVER['PHP\_SELF'] . '~~?page=' . $this->plugin\_basename; |
  | 905 |  | } |
  | 906 |  |  |
  | 907 |  | /\*\* |
  | 908 |  | \* ~~Check~~s if the plugin's settings page has been submitted. |
  |  | 1032 | return $this->settings\_page . '.php?page=' . $this->plugin\_basename; |
  |  | 1033 | } |
  |  | 1034 |  |
  |  | 1035 | /\*\* |
  |  | 1036 | \* Determines if the plugin's settings page has been submitted. |
  | 909 | 1037 | \* |
  | 910 | 1038 | \* @return bool True if the plugin's settings have been submitted for saving, else false. |
  | 911 | 1039 | \*/ |
  | 912 | 1040 | protected function is\_submitting\_form() { |
  |  | 1041 | // PHPCS: The POST value only being read and not meaningfully used. |
  |  | 1042 | // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 913 | 1043 | return ( isset( $\_POST['option\_page'] ) && ( $\_POST['option\_page'] == $this->admin\_options\_name ) ); |
  | 914 | 1044 | } |
  | 915 | 1045 |  |
  | 916 | 1046 | /\*\* |
  | 917 |  | \* ~~Check~~s if the current page is the plugin's settings page. |
  |  | 1047 | \* Determines if the current page is the plugin's settings page. |
  | 918 | 1048 | \* |
  | 919 | 1049 | \* Note: This should not be used during or before `'admin\_init'` since the |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L930) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1060) |  |
  | 930 | 1060 | \_doing\_it\_wrong( |
  | 931 | 1061 | \_\_METHOD\_\_, |
  | 932 |  | ~~sprintf( $this->get\_c2c\_string( 'The method %1$s should not be called until after the %2$s action.' ), 'is\_plugin\_admin\_page()', 'admin\_init'~~ ), |
  |  | 1062 | esc\_html( sprintf( $this->get\_c2c\_string( 'The method %1$s should not be called until after the %2$s action.' ), 'is\_plugin\_admin\_page()', 'admin\_init' ) ), |
  | 933 | 1063 | '063' |
  | 934 | 1064 | ); |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L944) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1074) |  |
  | 944 | 1074 | $current\_screen->id === $this->options\_page |
  | 945 | 1075 | ); |
  |  | 1076 | } |
  |  | 1077 |  |
  |  | 1078 | /\*\* |
  |  | 1079 | \* Returns escaped attributes string for an HTML tag. |
  |  | 1080 | \* |
  |  | 1081 | \* @since 067 |
  |  | 1082 | \* |
  |  | 1083 | \* @param string[] $attributes Associative array of attribute names and values. |
  |  | 1084 | \* @return string |
  |  | 1085 | \*/ |
  |  | 1086 | public function esc\_attributes( $attributes ) { |
  |  | 1087 | $string = ''; |
  |  | 1088 |  |
  |  | 1089 | foreach ( $attributes as $key => $value ) { |
  |  | 1090 | $string .= sprintf( |
  |  | 1091 | '%s="%s" ', |
  |  | 1092 | esc\_attr( wp\_strip\_all\_tags( $key ) ), |
  |  | 1093 | esc\_html( wp\_strip\_all\_tags( $value ) ) |
  |  | 1094 | ); |
  |  | 1095 | } |
  |  | 1096 |  |
  |  | 1097 | return trim( $string ); |
  | 946 | 1098 | } |
  | 947 | 1099 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L997) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1149) |  |
  | 997 | 1149 | } |
  | 998 | 1150 | $attributes = $this->config[ $opt ]['input\_attributes']; |
  |  | 1151 | if ( ! is\_array( $attributes ) ) { |
  |  | 1152 | $attributes = []; |
  |  | 1153 | } |
  | 999 | 1154 | $this->config[ $opt ]['class'][] = 'c2c-' . $input; |
  | 1000 | 1155 | if ( ( 'textarea' == $input || 'inline\_textarea' == $input ) && $this->config[ $opt ]['no\_wrap'] ) { |
  | 1001 |  | $attributes~~.= ' wrap="off"~~'; // Does not validate, but only cross-browser technique |
  |  | 1156 | $attributes['wrap'] = 'off'; // Does not validate, but only cross-browser technique |
  | 1002 | 1157 | } |
  | 1003 | 1158 | elseif ( in\_array( $input, array( 'text', 'long\_text', 'short\_text' ) ) ) { |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1012) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1167) |  |
  | 1012 | 1167 | } |
  | 1013 | 1168 | $class = implode( ' ', $this->config[ $opt ]['class'] ); |
  | 1014 |  | $attribs = "name='{$popt}' id='{$opt}' class='{$class}' {$attributes}"; |
  |  | 1169 | $attributes['class'] = $class; |
  |  | 1170 | $attributes['id']    = $opt; |
  |  | 1171 | $attributes['name']  = $popt; |
  |  | 1172 |  |
  | 1015 | 1173 | if ( $input == '' ) { |
  | 1016 | 1174 | // Change of implementation prevents this from being possible (since this function only gets called for registered settings) |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1023) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1181) |  |
  | 1023 | 1181 | echo "</td><tr><td colspan='2'>"; |
  | 1024 | 1182 | } |
  | 1025 |  | echo "<textarea {$attribs}>{$value}</textarea>\n"; |
  |  | 1183 | printf( |
  |  | 1184 | '<textarea %s>%s</textarea>' . "\n", |
  |  | 1185 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1186 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1187 | $this->esc\_attributes( $attributes ), |
  |  | 1188 | wp\_kses\_post( $value ) |
  |  | 1189 | ); |
  | 1026 | 1190 | } elseif ( $input == 'select' ) { |
  | 1027 |  | echo "<select $attribs>"; |
  |  | 1191 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1192 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1193 | echo '<select ' . $this->esc\_attributes( $attributes ) . '>'; |
  | 1028 | 1194 | if ( $this->config[ $opt ]['datatype'] == 'hash' ) { |
  | 1029 | 1195 | foreach ( (array) $this->config[ $opt ]['options'] as $sopt => $sval ) { |
  | 1030 |  | echo "<option value='{$sopt}' " . selected( $value, $sopt, false ) . ">{$sval}</option>\n"; |
  |  | 1196 | printf( |
  |  | 1197 | '<option value="%s" ' . selected( $value, $sopt, false ) . ">%s</option>\n", |
  |  | 1198 | esc\_attr( $sopt ), |
  |  | 1199 | esc\_html( $sval ) |
  |  | 1200 | ); |
  | 1031 | 1201 | } |
  | 1032 | 1202 | } else { |
  | 1033 | 1203 | foreach ( (array) $this->config[ $opt ]['options'] as $sopt ) { |
  | 1034 |  | echo "<option value='{$sopt}' " . selected( $value, $sopt, false ) . ">{$sopt}</option>\n"; |
  |  | 1204 | printf( |
  |  | 1205 | '<option value="%s" ' . selected( $value, $sopt, false ) . ">%s</option>\n", |
  |  | 1206 | esc\_attr( $sopt ), |
  |  | 1207 | esc\_attr( $sopt ) |
  |  | 1208 | ); |
  | 1035 | 1209 | } |
  | 1036 | 1210 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1039) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1213) |  |
  | 1039 | 1213 | echo '<fieldset class="c2c-fieldset">' . "\n"; |
  | 1040 | 1214 | foreach ( (array) $this->config[ $opt ]['options'] as $sopt ) { |
  | 1041 |  | echo "<input type='checkbox' {$attribs} value='{$sopt}' " . checked( in\_array( $sopt, $value ), true, false ) . ">{$sopt}</input><br />\n"; |
  | 1042 |  | } |
  |  | 1215 | printf( |
  |  | 1216 | '<input type="checkbox" %s value="%s" ' . checked( in\_array( $sopt, $value ), true, false ) . ">%s</input><br />\n", |
  |  | 1217 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1218 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1219 | $this->esc\_attributes( $attributes ), |
  |  | 1220 | esc\_attr( $sopt ), |
  |  | 1221 | esc\_html( $sopt ) |
  |  | 1222 | ); |
  |  | 1223 | } |
  | 1043 | 1224 | echo '</fieldset>'; |
  | 1044 | 1225 | } elseif ( $input == 'checkbox' ) { |
  | 1045 |  | echo "<input type='{$input}' {$attribs} value='1' " . checked( $value, 1, false ) . " />\n"; |
  |  | 1226 | printf( |
  |  | 1227 | '<input type="%s" %s value="1" ' . checked( $value, 1, false ) . ' />' . "\n", |
  |  | 1228 | esc\_attr( $input ), |
  |  | 1229 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1230 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1231 | $this->esc\_attributes( $attributes ) |
  |  | 1232 | ); |
  | 1046 | 1233 | if ( ! empty( $this->config[ $opt ]['help'] ) ) { |
  | 1047 |  | printf( "<label class='description' for='%s'>%s</label>\n", $opt, $this->config[ $opt ]['help'] ); |
  |  | 1234 | printf( |
  |  | 1235 | "<label class='description' for='%s'>%s</label>\n", |
  |  | 1236 | esc\_attr( $opt ), |
  |  | 1237 | wp\_kses\_post( $this->config[ $opt ]['help'] ) |
  |  | 1238 | ); |
  | 1048 | 1239 | $this->config[ $opt ]['help'] = ''; |
  | 1049 | 1240 | } |
  | 1050 | 1241 | } else { // Only 'text' and 'password' should fall through to here. |
  | 1051 |  | echo "<input type='{$input}' {$attribs} value='" . esc\_attr( $value ) . "' />\n"; |
  |  | 1242 | printf( |
  |  | 1243 | '<input type="%s" %s value="%s" />' . "\n", |
  |  | 1244 | esc\_attr( $input ), |
  |  | 1245 | // PHPCS: The keys and values of all attributes are being escaped by esc\_attributes(), so this is safe. |
  |  | 1246 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 1247 | $this->esc\_attributes( $attributes ), |
  |  | 1248 | esc\_attr( $value ) |
  |  | 1249 | ); |
  | 1052 | 1250 | } |
  | 1053 | 1251 | // Help intended to be inline (usually with a text field; checkboxes naturally have their help inline) |
  | 1054 | 1252 | if ( $help = apply\_filters( $this->get\_hook( 'option\_help'), $this->config[ $opt ]['inline\_help'], $opt, 'inline\_help' ) ) { |
  | 1055 |  | echo ~~"<p class='description inline-description'>{$help}~~</p>\n"; |
  |  | 1253 | echo '<p class="description inline-description">' . wp\_kses\_post( $help ) . "</p>\n"; |
  | 1056 | 1254 | } |
  | 1057 | 1255 | // Help intended to be shown below an input field. |
  | 1058 | 1256 | if ( $help = apply\_filters( $this->get\_hook( 'option\_help'), $this->config[ $opt ]['help'], $opt, 'help' ) ) { |
  | 1059 |  | echo ~~"<p class='description'>{$help}~~</p>\n"; |
  |  | 1257 | echo '<p class="description">' . wp\_kses\_post( $help ) . "</p>\n"; |
  | 1060 | 1258 | } |
  | 1061 | 1259 | // Additional paragraph of help intended to follow the main 'help'. |
  | 1062 | 1260 | if ( $help = apply\_filters( $this->get\_hook( 'option\_help'), $this->config[ $opt ]['more\_help'], $opt, 'more\_help' ) ) { |
  | 1063 |  | echo ~~"<p class='description'>{$help}~~</p>\n"; |
  |  | 1261 | echo '<p class="description">' . wp\_kses\_post( $help ) . "</p>\n"; |
  | 1064 | 1262 | } |
  | 1065 | 1263 | // Additional help of custom markup (block elements that wouldn't fit into the default help paragraph markup). |
  | 1066 | 1264 | if ( $help = apply\_filters( $this->get\_hook( 'option\_help'), $this->config[ $opt ]['raw\_help'], $opt, 'raw\_help' ) ) { |
  | 1067 |  | echo ~~$help~~ . "\n"; |
  |  | 1265 | echo wp\_kses\_post( $help ) . "\n"; |
  | 1068 | 1266 | } |
  | 1069 | 1267 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1079) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1277) |  |
  | 1079 | 1277 |  |
  | 1080 | 1278 | if ( $this->saved\_settings ) { |
  | 1081 |  | echo "<div id='message' class='updated fade'><p><strong>" . ~~$this->saved\_settings\_msg~~ . '</strong></p></div>'; |
  |  | 1279 | echo "<div id='message' class='updated fade'><p><strong>" . esc\_html( $this->saved\_settings\_msg ) . '</strong></p></div>'; |
  | 1082 | 1280 | } |
  | 1083 | 1281 |  |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1103) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1301) |  |
  | 1103 | 1301 | echo '<div id="c2c" class="wrap"><div>' . "\n"; |
  | 1104 | 1302 | printf( |
  | 1105 |  | ~~$this->get\_c2c\_string( 'This plugin brought to you by %s.'~~ ), |
  |  | 1303 | wp\_kses\_data( $this->get\_c2c\_string( 'This plugin brought to you by %s.' ) ), |
  | 1106 | 1304 | '<a href="https://coffee2code.com" title="' . esc\_attr( $this->get\_c2c\_string( 'The plugin author homepage.' ) ) . '">Scott Reilly (coffee2code)</a>' |
  | 1107 | 1305 | ); |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1110) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1308) |  |
  | 1110 | 1308 | esc\_url( $this->donation\_url ), |
  | 1111 | 1309 | esc\_attr( $this->get\_c2c\_string( "Thanks for the consideration; it's much appreciated." ) ), |
  | 1112 |  | ~~$this->get\_c2c\_string( 'If this plugin has been useful to you, please consider a donation.'~~ ) |
  |  | 1310 | esc\_html( $this->get\_c2c\_string( 'If this plugin has been useful to you, please consider a donation.' ) ) |
  | 1113 | 1311 | ); |
  | 1114 | 1312 | echo "</div>\n"; |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1121) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1319) |  |
  | 1121 | 1319 | \* |
  | 1122 | 1320 | \* @param string $hook The name of a hook, to be made plugin-specific. |
  | 1123 |  | ~~\*~~ |
  | 1124 | 1321 | \* @return string The plugin-specific version of the hook name. |
  | 1125 | 1322 | \*/ |
  | 1126 |  | p~~rotected~~ function get\_hook( $hook ) { |
  |  | 1323 | public function get\_hook( $hook ) { |
  | 1127 | 1324 | return $this->hook\_prefix . '\_' . $hook; |
  | 1128 | 1325 | } |
  | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=2926197#L1133) | […](/browser/remember-me-controls/trunk/c2c-plugin.php?rev=3146603#L1330) |  |
  | 1133 | 1330 | \* @since 005 |
  | 1134 | 1331 | \* |
  | 1135 |  | \* @return string The URL |
  |  | 1332 | \* @return string The URL. |
  | 1136 | 1333 | \*/ |
  | 1137 | 1334 | public function readme\_url() { |
* ## [remember-me-controls/trunk/readme.txt](/changeset/3146603/remember-me-controls/trunk/readme.txt "Show the changeset 3146603 restricted to remember-me-controls/trunk/readme.txt")

  | [r2928246](/browser/remember-me-controls/trunk/readme.txt?rev=2928246#L2 "Show revision 2928246 of this file in browser") | [r3146603](/browser/remember-me-controls/trunk/readme.txt?rev=3146603#L2 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | Contributors: coffee2code |
  | 3 | 3 | Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=\_s-xclick&hosted\_button\_id=6ARCFJ9TX3522 |
  | 4 |  | Tags: login, remember, remember me, cookie, session~~, coffee2code~~ |
  |  | 4 | Tags: login, remember, remember me, cookie, session |
  | 5 | 5 | License: GPLv2 or later |
  | 6 | 6 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | 7 |  | Requires at least: ~~4.9~~ |
  | 8 |  | Tested up to: 6.~~2~~ |
  | 9 |  | Stable tag: 2.~~0.~~1 |
  |  | 7 | Requires at least: 5.5 |
  |  | 8 | Tested up to: 6.6 |
  |  | 9 | Stable tag: 2.1 |
  | 10 | 10 |  |
  | 11 | 11 | Have "Remember Me" checked by default on the login page and configure how long a login is remembered. Or disable the feature altogether. |
  | […](/browser/remember-me-controls/trunk/readme.txt?rev=2928246#L96) | […](/browser/remember-me-controls/trunk/readme.txt?rev=3146603#L96) |  |
  | 96 | 96 | = Does this plugin include unit tests? = |
  | 97 | 97 |  |
  | 98 |  | Yes. |
  |  | 98 | Yes. The tests are not packaged in the release .zip file or included in plugins.svn.wordpress.org, but can be found in the [plugin's GitHub repository](https://github.com/coffee2code/remember-me-controls/). |
  | 99 | 99 |  |
  | 100 | 100 |  |
  | […](/browser/remember-me-controls/trunk/readme.txt?rev=2928246#L107) | […](/browser/remember-me-controls/trunk/readme.txt?rev=3146603#L107) |  |
  | 107 | 107 |  |
  | 108 | 108 | == Changelog == |
  |  | 109 |  |
  |  | 110 | = 2.1 (2024-09-01) = |
  |  | 111 | Highlights: |
  |  | 112 |  |
  |  | 113 | This minor release primarily updates the plugin framework to the most current version (for security hardening and miscellaneous improvements), prevents translations from containing unintended markup, notes compatibility through WP 6.6+, drops compatibility with versions of WP older than 5.5, and removes unit tests from release packaging. |
  |  | 114 |  |
  |  | 115 | Details: |
  |  | 116 |  |
  |  | 117 | \* Change: Update plugin framework to 067 |
  |  | 118 | \* 067: |
  |  | 119 | \* Change: Simplify `form\_action\_url()` to avoid using a server global |
  |  | 120 | \* Change: Use `form\_action\_url()` in `plugin\_action\_links()` rather than duplicating its functionality |
  |  | 121 | \* Change: Escape output of all translated strings |
  |  | 122 | \* Change: Convert `register\_filters()` to an abstract declaration |
  |  | 123 | \* Change: Improve function documentation |
  |  | 124 | \* Change: Adjust function documentation formatting to align with WP core |
  |  | 125 | \* Change: Note compatibility through WP 6.5+ |
  |  | 126 | \* Change: Drop compatibility with version of WP older than 5.5 |
  |  | 127 | \* 066: |
  |  | 128 | \* New: Add customization of capability needed to manage plugin settings (via new filter {plugin\_prefix}\_manage\_options\_capability) |
  |  | 129 | \* Change: Make `get\_hook()` public rather than protected |
  |  | 130 | \* Change: Add styles for nested lists within settings descriptions |
  |  | 131 | \* Change: Simplify `form\_action\_url()` |
  |  | 132 | \* Change: Use `form\_action\_url()` in `plugin\_action\_links()` rather than duplicating its functionality |
  |  | 133 | \* Change: Explicitly declare object variables rather than doing so dynamically. Fixes #1. |
  |  | 134 | \* Change: Note compatibility through WP 6.4+ |
  |  | 135 | \* Change: Update copyright date (2024) |
  |  | 136 | \* Change: Ensure translations don't contain unintended markup |
  |  | 137 | \* Change: Add missing inline comments to translators |
  |  | 138 | \* Change: Note compatibility through WP 6.6+ |
  |  | 139 | \* Change: Drop compatibility with versions of WP older than 5.5 |
  |  | 140 | \* Change: Update copyright date (2024) |
  |  | 141 | \* New: Add `.gitignore` file |
  |  | 142 | \* Change: Remove development and testing-related files from release packaging |
  |  | 143 | \* Change: Reduce number of 'Tags' from `readme.txt` |
  |  | 144 | \* Change: Tweak text formatting in `README.md` |
  |  | 145 | \* Unit tests: |
  |  | 146 | \* Hardening: Prevent direct web access to `bootstrap.php` |
  |  | 147 | \* Allow tests to run against current versions of WordPress |
  |  | 148 | \* New: Add `composer.json` for PHPUnit Polyfill dependency |
  |  | 149 | \* Change: Prevent PHP warnings due to missing core-related generated files |
  |  | 150 | \* Change: In bootstrap, store path to plugin directory in a constant |
  | 109 | 151 |  |
  | 110 | 152 | = 2.0.1 (2023-06-19) = |
  | […](/browser/remember-me-controls/trunk/readme.txt?rev=2928246#L208) | […](/browser/remember-me-controls/trunk/readme.txt?rev=3146603#L250) |  |
  | 208 | 250 | \* Change: In bootstrap, add backcompat for PHPUnit pre-v6.0 |
  | 209 | 251 |  |
  | 210 |  | ~~= 1.9.1 (2021-02-13) =~~ |
  | 211 |  | ~~\* Fix: Add missing textdomain. Props @kittmedia.~~ |
  | 212 |  | ~~\* Change: Enhance a FAQ answer to make clear that an existing login session will not be affected by an update to the remember me duration (must log in again)~~ |
  | 213 |  | ~~\* Change: Note compatibility through WP 5.6+~~ |
  | 214 |  | ~~\* Change: Update copyright date (2021)~~ |
  | 215 |  |  |
  | 216 | 252 | \_Full changelog is available in [CHANGELOG.md](https://github.com/coffee2code/remember-me-controls/blob/master/CHANGELOG.md).\_ |
  | 217 | 253 |  |
  | 218 | 254 |  |
  | 219 | 255 | == Upgrade Notice == |
  |  | 256 |  |
  |  | 257 | = 2.1 = |
  |  | 258 | Minor update: updated plugin framework, prevented translations from containing unintended markup, noted compatibility through WP 6.6+, dropped compatibility with versions of WP older than 5.5, removed unit tests from release packaging, and updated copyright date (2024) |
  | 220 | 259 |  |
  | 221 | 260 | = 2.0.1 = |
* ## [remember-me-controls/trunk/remember-me-controls.php](/changeset/3146603/remember-me-controls/trunk/remember-me-controls.php "Show the changeset 3146603 restricted to remember-me-controls/trunk/remember-me-controls.php")

  | [r2928246](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L2 "Show revision 2928246 of this file in browser") | [r3146603](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L2 "Show revision 3146603 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Plugin Name: Remember Me Controls |
  | 4 |  | \* Version:     2.~~0.~~1 |
  |  | 4 | \* Version:     2.1 |
  | 5 | 5 | \* Plugin URI:  https://coffee2code.com/wp-plugins/remember-me-controls/ |
  | 6 | 6 | \* Author:      Scott Reilly |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L11) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L11) |  |
  | 11 | 11 | \* Description: Have "Remember Me" checked by default on the login page and configure how long a login is remembered. Or disable the feature altogether. |
  | 12 | 12 | \* |
  | 13 |  | \* Compatible with WordPress ~~4.9+ through 6.2~~+. |
  |  | 13 | \* Compatible with WordPress 5.5+ through 6.6+. |
  | 14 | 14 | \* |
  | 15 | 15 | \* =>> Read the accompanying readme.txt file for instructions and documentation. |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L19) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L19) |  |
  | 19 | 19 | \* @package Remember\_Me\_Controls |
  | 20 | 20 | \* @author  Scott Reilly |
  | 21 |  | \* @version 2.~~0.~~1 |
  |  | 21 | \* @version 2.1 |
  | 22 | 22 | \*/ |
  | 23 | 23 |  |
  | 24 | 24 | /\* |
  | 25 |  | Copyright (c) 2009-202~~3~~ by Scott Reilly (aka coffee2code) |
  |  | 25 | Copyright (c) 2009-2024 by Scott Reilly (aka coffee2code) |
  | 26 | 26 |  |
  | 27 | 27 | This program is free software; you can redistribute it and/or |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L46) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L46) |  |
  | 46 | 46 | require\_once( dirname( \_\_FILE\_\_ ) . DIRECTORY\_SEPARATOR . 'c2c-plugin.php' ); |
  | 47 | 47 |  |
  | 48 |  | final class c2c\_RememberMeControls extends c2c\_Plugin\_06~~5~~ { |
  |  | 48 | final class c2c\_RememberMeControls extends c2c\_Plugin\_067 { |
  | 49 | 49 |  |
  | 50 | 50 | /\*\* |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L80) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L80) |  |
  | 80 | 80 | \*/ |
  | 81 | 81 | protected function \_\_construct() { |
  | 82 |  | parent::\_\_construct( '2.~~0.~~1', 'remember-me-controls', 'c2c', \_\_FILE\_\_, array() ); |
  |  | 82 | parent::\_\_construct( '2.1', 'remember-me-controls', 'c2c', \_\_FILE\_\_, array() ); |
  | 83 | 83 | register\_activation\_hook( \_\_FILE\_\_, array( \_\_CLASS\_\_, 'activation' ) ); |
  | 84 | 84 |  |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L233) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L233) |  |
  | 233 | 233 | => \_\_( 'Donate', 'remember-me-controls' ), |
  | 234 | 234 | 'Expected integer value for: %s' |
  |  | 235 | /\* translators: %s: Setting name. \*/ |
  | 235 | 236 | => \_\_( 'Expected integer value for: %s', 'remember-me-controls' ), |
  | 236 | 237 | 'If this plugin has been useful to you, please consider a donation' |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L288) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L289) |  |
  | 288 | 289 | parent::options\_page\_description( \_\_( 'Remember Me Controls Settings', 'remember-me-controls' ) ); |
  | 289 | 290 |  |
  | 290 |  | echo '<p>' . \_\_( 'Take control of the "Remember Me" login feature for WordPress by customizing its behavior or disabling it altogether.', 'remember-me-controls' ) . "</p>\n"; |
  | 291 |  | echo '<p>' . \_\_( 'For those unfamiliar, "Remember Me" is a checkbox present when logging into WordPress. If checked, by default WordPress will remember the login session for 14 days. If unchecked, the login session will be remembered for only 2 days. Once a login session expires, WordPress will require you to log in again if you wish to continue using the admin section of the site.', 'remember-me-controls' ) . "</p>\n"; |
  | 292 |  | echo '<p>' . \_\_( 'NOTE: WordPress remembers who you are based on cookies stored in your web browser. If you use a different web browser, clear your cookies, use a browser on a different machine, the site owner invalidates all existing login sessions, or you uninstall/reinstall (and possibly even just restart) your browser then you will have to log in again since WordPress will not be able to locate the cookies needed to identify you.', 'remember-me-controls' ) . "</p>\n"; |
  | 293 |  | echo '<p>' . \_\_( 'NOTE: Any changes to the duration of a login session only take effect on subsequent logins and will not affect currently active sessions.', 'remember-me-controls' ) . "</p>\n"; |
  |  | 291 | echo '<p>' . esc\_html\_\_( 'Take control of the "Remember Me" login feature for WordPress by customizing its behavior or disabling it altogether.', 'remember-me-controls' ) . "</p>\n"; |
  |  | 292 | echo '<p>' . esc\_html\_\_( 'For those unfamiliar, "Remember Me" is a checkbox present when logging into WordPress. If checked, by default WordPress will remember the login session for 14 days. If unchecked, the login session will be remembered for only 2 days. Once a login session expires, WordPress will require you to log in again if you wish to continue using the admin section of the site.', 'remember-me-controls' ) . "</p>\n"; |
  |  | 293 | echo '<p>' . esc\_html\_\_( 'NOTE: WordPress remembers who you are based on cookies stored in your web browser. If you use a different web browser, clear your cookies, use a browser on a different machine, the site owner invalidates all existing login sessions, or you uninstall/reinstall (and possibly even just restart) your browser then you will have to log in again since WordPress will not be able to locate the cookies needed to identify you.', 'remember-me-controls' ) . "</p>\n"; |
  |  | 294 | echo '<p>' . esc\_html\_\_( 'NOTE: Any changes to the duration of a login session only take effect on subsequent logins and will not affect currently active sessions.', 'remember-me-controls' ) . "</p>\n"; |
  | 294 | 295 |  |
  | 295 | 296 | $this->display\_current\_login\_duration(); |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L314) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L315) |  |
  | 314 | 315 | if ( $years ) { |
  | 315 | 316 | $year\_string = sprintf( |
  |  | 317 | /\* translators: %d: number of years \*/ |
  | 316 | 318 | \_n( '%d year', '%d years', $years, 'remember-me-controls' ), |
  | 317 | 319 | $years |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L325) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L327) |  |
  | 325 | 327 | if ( $months ) { |
  | 326 | 328 | $month\_string = sprintf( |
  |  | 329 | /\* translators: %d: number of months \*/ |
  | 327 | 330 | \_n( '%d month', '%d months', $months, 'remember-me-controls' ), |
  | 328 | 331 | $months |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L336) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L339) |  |
  | 336 | 339 | if ( $days ) { |
  | 337 | 340 | $day\_string = sprintf( |
  |  | 341 | /\* translators: %d: number of days \*/ |
  | 338 | 342 | \_n( '%d day', '%d days', $days, 'remember-me-controls' ), |
  | 339 | 343 | $days |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L347) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L351) |  |
  | 347 | 351 | if ( $hours ) { |
  | 348 | 352 | $hour\_string = sprintf( |
  |  | 353 | /\* translators: %d: number of hours \*/ |
  | 349 | 354 | \_n( '%d hour', '%d hours', $hours, 'remember-me-controls' ), |
  | 350 | 355 | $hours |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L382) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L387) |  |
  | 382 | 387 | $max = floor( $duration\_in\_sec / YEAR\_IN\_SECONDS ); |
  | 383 | 388 | $human\_duration = sprintf( |
  |  | 389 | /\* translators: %d: number of years \*/ |
  | 384 | 390 | \_n( '%d year', '%d years', $max, 'remember-me-controls' ), |
  | 385 | 391 | $max |
  | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=2928246#L416) | […](/browser/remember-me-controls/trunk/remember-me-controls.php?rev=3146603#L422) |  |
  | 416 | 422 | echo '<div class="c2c-remember-me-duration-banner">'; |
  | 417 | 423 | printf( |
  | 418 |  | \_\_( 'Currently, a remembered user login session will last up to <strong>%s</strong>.', 'remember-me-controls' ), |
  | 419 |  | $hours |
  |  | 424 | wp\_kses( |
  |  | 425 | /\* translators: %s: Already translated string using words to express the duration of a remember login session. \*/ |
  |  | 426 | \_\_( 'Currently, a remembered user login session will last up to <strong>%s</strong>.', 'remember-me-controls' ), |
  |  | 427 | [ 'strong' => array() ] |
  |  | 428 | ), |
  |  | 429 | esc\_html( $hours ) |
  | 420 | 430 | ); |
  | 421 | 431 | echo '</div>' . "\n"; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3146603)
* [Zip Archive](?format=zip&new=3146603)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

