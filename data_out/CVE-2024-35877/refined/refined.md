```
{
  "cveId": "CVE-2024-35877",
  "description": "The provided content describes a patch for a vulnerability in the Linux kernel related to PAT (Page Attribute Table) handling in Copy-On-Write (COW) mappings. Specifically, it addresses an issue where the kernel could incorrectly recover the PFN (Page Frame Number) and cache mode for pages within COW mappings.",
  "vulnerabilityDetails": {
    "rootCause": "The root cause is that when a page in a COW mapping is written to for the first time, the original PTE (Page Table Entry) is replaced with a new PTE pointing to an anonymous folio. The existing mechanism that recovers PFN and cache mode using follow_phys() cannot reliably operate on such PTEs within COW mappings.",
    "weaknesses": [
      "Incorrect PFN recovery",
      "Incorrect cache mode recovery",
      "Potential memory leak",
      "WARN_ON_ONCE() trigger leading to Kernel panic"
    ],
    "impact": "Failure to correctly track and untrack pages with PAT can lead to memory leaks and trigger a WARN_ON_ONCE() in untrack_pfn(). In the past, this could lead to calling memtype_free() with the wrong range, possibly leaking memory. When track_pfn_copy() is called in a fork operation on a VMA, if the first page was replaced by anon folio the call will fail with -EINVAL.",
    "attackVectors": [
      "Local privilege escalation through crafted mmap calls"
    ],
    "requiredCapabilities": "The attacker requires the ability to create mmap regions with PAT flags and trigger a copy-on-write scenario, likely via a specifically crafted user application. The reproducer requires `liburing`.",
      "additionalNotes": "The patch updates the follow_phys() function to not return PFNs for anonymous folios in COW mappings and adds a fallback mechanism to obtain the PFN from `vma->vm_pgoff`. Additionally, the track_pfn_copy() will fail if the first page is replaced with an anon folio, preventing errors, and potential memory leaks/corruption. The patch also addresses a WARN_ON_ONCE() triggered by incorrect PFN tracking."
  }
}
```