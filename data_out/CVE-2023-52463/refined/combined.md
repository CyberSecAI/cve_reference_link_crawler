=== Content from git.kernel.org_f8a9caa0_20250111_090706.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d4a714873db0866cc471521114eeac4a5072d548)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d4a714873db0866cc471521114eeac4a5072d548)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d4a714873db0866cc471521114eeac4a5072d548)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d4a714873db0866cc471521114eeac4a5072d548)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ilias Apalodimas <ilias.apalodimas@linaro.org> | 2023-11-07 14:40:56 +0900 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-25 15:44:39 -0800 |
| commit | [d4a714873db0866cc471521114eeac4a5072d548](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d4a714873db0866cc471521114eeac4a5072d548) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d4a714873db0866cc471521114eeac4a5072d548)) | |
| tree | [3b9fd04ee146ceee9f0de7f73ba34299abedaf49](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d4a714873db0866cc471521114eeac4a5072d548) | |
| parent | [f14d36e6e97fe935a20e0ceb159c100f90b6627c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f14d36e6e97fe935a20e0ceb159c100f90b6627c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d4a714873db0866cc471521114eeac4a5072d548&id2=f14d36e6e97fe935a20e0ceb159c100f90b6627c)) | |
| download | [linux-d4a714873db0866cc471521114eeac4a5072d548.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d4a714873db0866cc471521114eeac4a5072d548.tar.gz) | |

efivarfs: force RO when remounting if SetVariable is not supported[ Upstream commit 0e8d2444168dd519fea501599d150e62718ed2fe ]
If SetVariable at runtime is not supported by the firmware we never assign
a callback for that function. At the same time mount the efivarfs as
RO so no one can call that. However, we never check the permission flags
when someone remounts the filesystem as RW. As a result this leads to a
crash looking like this:
$ mount -o remount,rw /sys/firmware/efi/efivars
$ efi-updatevar -f PK.auth PK
[ 303.279166] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000
[ 303.280482] Mem abort info:
[ 303.280854] ESR = 0x0000000086000004
[ 303.281338] EC = 0x21: IABT (current EL), IL = 32 bits
[ 303.282016] SET = 0, FnV = 0
[ 303.282414] EA = 0, S1PTW = 0
[ 303.282821] FSC = 0x04: level 0 translation fault
[ 303.283771] user pgtable: 4k pages, 48-bit VAs, pgdp=000000004258c000
[ 303.284913] [0000000000000000] pgd=0000000000000000, p4d=0000000000000000
[ 303.286076] Internal error: Oops: 0000000086000004 [#1] PREEMPT SMP
[ 303.286936] Modules linked in: qrtr tpm\_tis tpm\_tis\_core crct10dif\_ce arm\_smccc\_trng rng\_core drm fuse ip\_tables x\_tables ipv6
[ 303.288586] CPU: 1 PID: 755 Comm: efi-updatevar Not tainted 6.3.0-rc1-00108-gc7d0c4695c68 #1
[ 303.289748] Hardware name: Unknown Unknown Product/Unknown Product, BIOS 2023.04-00627-g88336918701d 04/01/2023
[ 303.291150] pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 303.292123] pc : 0x0
[ 303.292443] lr : efivar\_set\_variable\_locked+0x74/0xec
[ 303.293156] sp : ffff800008673c10
[ 303.293619] x29: ffff800008673c10 x28: ffff0000037e8000 x27: 0000000000000000
[ 303.294592] x26: 0000000000000800 x25: ffff000002467400 x24: 0000000000000027
[ 303.295572] x23: ffffd49ea9832000 x22: ffff0000020c9800 x21: ffff000002467000
[ 303.296566] x20: 0000000000000001 x19: 00000000000007fc x18: 0000000000000000
[ 303.297531] x17: 0000000000000000 x16: 0000000000000000 x15: 0000aaaac807ab54
[ 303.298495] x14: ed37489f673633c0 x13: 71c45c606de13f80 x12: 47464259e219acf4
[ 303.299453] x11: ffff000002af7b01 x10: 0000000000000003 x9 : 0000000000000002
[ 303.300431] x8 : 0000000000000010 x7 : ffffd49ea8973230 x6 : 0000000000a85201
[ 303.301412] x5 : 0000000000000000 x4 : ffff0000020c9800 x3 : 00000000000007fc
[ 303.302370] x2 : 0000000000000027 x1 : ffff000002467400 x0 : ffff000002467000
[ 303.303341] Call trace:
[ 303.303679] 0x0
[ 303.303938] efivar\_entry\_set\_get\_size+0x98/0x16c
[ 303.304585] efivarfs\_file\_write+0xd0/0x1a4
[ 303.305148] vfs\_write+0xc4/0x2e4
[ 303.305601] ksys\_write+0x70/0x104
[ 303.306073] \_\_arm64\_sys\_write+0x1c/0x28
[ 303.306622] invoke\_syscall+0x48/0x114
[ 303.307156] el0\_svc\_common.constprop.0+0x44/0xec
[ 303.307803] do\_el0\_svc+0x38/0x98
[ 303.308268] el0\_svc+0x2c/0x84
[ 303.308702] el0t\_64\_sync\_handler+0xf4/0x120
[ 303.309293] el0t\_64\_sync+0x190/0x194
[ 303.309794] Code: ???????? ???????? ???????? ???????? (????????)
[ 303.310612] ---[ end trace 0000000000000000 ]---
Fix this by adding a .reconfigure() function to the fs operations which
we can use to check the requested flags and deny anything that's not RO
if the firmware doesn't implement SetVariable at runtime.
Fixes: f88814cc2578 ("efi/efivars: Expose RT service availability via efivars abstraction")
Signed-off-by: Ilias Apalodimas <ilias.apalodimas@linaro.org>
Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d4a714873db0866cc471521114eeac4a5072d548)

| -rw-r--r-- | [fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/efivarfs/super.c?id=d4a714873db0866cc471521114eeac4a5072d548) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/fs/efivarfs/super.c b/fs/efivarfs/super.cindex 77240953a92e0e..869537f1a550dd 100644--- a/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=f14d36e6e97fe935a20e0ceb159c100f90b6627c)+++ b/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=d4a714873db0866cc471521114eeac4a5072d548)@@ -15,6 +15,7 @@ #include <linux/slab.h> #include <linux/magic.h> #include <linux/statfs.h>+#include <linux/printk.h>  #include "internal.h" @@ -333,9 +334,20 @@ static int efivarfs\_get\_tree(struct fs\_context \*fc) return get\_tree\_single(fc, efivarfs\_fill\_super); } +static int efivarfs\_reconfigure(struct fs\_context \*fc)+{+ if (!efivar\_supports\_writes() && !(fc->sb\_flags & SB\_RDONLY)) {+ pr\_err("Firmware does not support SetVariableRT. Can not remount with rw\n");+ return -EINVAL;+ }++ return 0;+}+ static const struct fs\_context\_operations efivarfs\_context\_ops = { .get\_tree = efivarfs\_get\_tree, .parse\_param = efivarfs\_parse\_param,+ .reconfigure = efivarfs\_reconfigure, };  static int efivarfs\_init\_fs\_context(struct fs\_context \*fc) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:05:43 +0000



=== Content from git.kernel.org_d598736d_20250111_090704.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0e8d2444168dd519fea501599d150e62718ed2fe)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0e8d2444168dd519fea501599d150e62718ed2fe)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0e8d2444168dd519fea501599d150e62718ed2fe)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0e8d2444168dd519fea501599d150e62718ed2fe)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ilias Apalodimas <ilias.apalodimas@linaro.org> | 2023-11-07 14:40:56 +0900 |
| --- | --- | --- |
| committer | Ard Biesheuvel <ardb@kernel.org> | 2023-12-11 11:19:17 +0100 |
| commit | [0e8d2444168dd519fea501599d150e62718ed2fe](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0e8d2444168dd519fea501599d150e62718ed2fe) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0e8d2444168dd519fea501599d150e62718ed2fe)) | |
| tree | [eed535d9798b9a6a0a415cf94ea577e199e1371d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0e8d2444168dd519fea501599d150e62718ed2fe) | |
| parent | [2cc14f52aeb78ce3f29677c2de1f06c0e91471ab](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2cc14f52aeb78ce3f29677c2de1f06c0e91471ab) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0e8d2444168dd519fea501599d150e62718ed2fe&id2=2cc14f52aeb78ce3f29677c2de1f06c0e91471ab)) | |
| download | [linux-0e8d2444168dd519fea501599d150e62718ed2fe.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0e8d2444168dd519fea501599d150e62718ed2fe.tar.gz) | |

efivarfs: force RO when remounting if SetVariable is not supportedIf SetVariable at runtime is not supported by the firmware we never assign
a callback for that function. At the same time mount the efivarfs as
RO so no one can call that. However, we never check the permission flags
when someone remounts the filesystem as RW. As a result this leads to a
crash looking like this:
$ mount -o remount,rw /sys/firmware/efi/efivars
$ efi-updatevar -f PK.auth PK
[ 303.279166] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000
[ 303.280482] Mem abort info:
[ 303.280854] ESR = 0x0000000086000004
[ 303.281338] EC = 0x21: IABT (current EL), IL = 32 bits
[ 303.282016] SET = 0, FnV = 0
[ 303.282414] EA = 0, S1PTW = 0
[ 303.282821] FSC = 0x04: level 0 translation fault
[ 303.283771] user pgtable: 4k pages, 48-bit VAs, pgdp=000000004258c000
[ 303.284913] [0000000000000000] pgd=0000000000000000, p4d=0000000000000000
[ 303.286076] Internal error: Oops: 0000000086000004 [#1] PREEMPT SMP
[ 303.286936] Modules linked in: qrtr tpm\_tis tpm\_tis\_core crct10dif\_ce arm\_smccc\_trng rng\_core drm fuse ip\_tables x\_tables ipv6
[ 303.288586] CPU: 1 PID: 755 Comm: efi-updatevar Not tainted 6.3.0-rc1-00108-gc7d0c4695c68 #1
[ 303.289748] Hardware name: Unknown Unknown Product/Unknown Product, BIOS 2023.04-00627-g88336918701d 04/01/2023
[ 303.291150] pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 303.292123] pc : 0x0
[ 303.292443] lr : efivar\_set\_variable\_locked+0x74/0xec
[ 303.293156] sp : ffff800008673c10
[ 303.293619] x29: ffff800008673c10 x28: ffff0000037e8000 x27: 0000000000000000
[ 303.294592] x26: 0000000000000800 x25: ffff000002467400 x24: 0000000000000027
[ 303.295572] x23: ffffd49ea9832000 x22: ffff0000020c9800 x21: ffff000002467000
[ 303.296566] x20: 0000000000000001 x19: 00000000000007fc x18: 0000000000000000
[ 303.297531] x17: 0000000000000000 x16: 0000000000000000 x15: 0000aaaac807ab54
[ 303.298495] x14: ed37489f673633c0 x13: 71c45c606de13f80 x12: 47464259e219acf4
[ 303.299453] x11: ffff000002af7b01 x10: 0000000000000003 x9 : 0000000000000002
[ 303.300431] x8 : 0000000000000010 x7 : ffffd49ea8973230 x6 : 0000000000a85201
[ 303.301412] x5 : 0000000000000000 x4 : ffff0000020c9800 x3 : 00000000000007fc
[ 303.302370] x2 : 0000000000000027 x1 : ffff000002467400 x0 : ffff000002467000
[ 303.303341] Call trace:
[ 303.303679] 0x0
[ 303.303938] efivar\_entry\_set\_get\_size+0x98/0x16c
[ 303.304585] efivarfs\_file\_write+0xd0/0x1a4
[ 303.305148] vfs\_write+0xc4/0x2e4
[ 303.305601] ksys\_write+0x70/0x104
[ 303.306073] \_\_arm64\_sys\_write+0x1c/0x28
[ 303.306622] invoke\_syscall+0x48/0x114
[ 303.307156] el0\_svc\_common.constprop.0+0x44/0xec
[ 303.307803] do\_el0\_svc+0x38/0x98
[ 303.308268] el0\_svc+0x2c/0x84
[ 303.308702] el0t\_64\_sync\_handler+0xf4/0x120
[ 303.309293] el0t\_64\_sync+0x190/0x194
[ 303.309794] Code: ???????? ???????? ???????? ???????? (????????)
[ 303.310612] ---[ end trace 0000000000000000 ]---
Fix this by adding a .reconfigure() function to the fs operations which
we can use to check the requested flags and deny anything that's not RO
if the firmware doesn't implement SetVariable at runtime.
Fixes: f88814cc2578 ("efi/efivars: Expose RT service availability via efivars abstraction")
Signed-off-by: Ilias Apalodimas <ilias.apalodimas@linaro.org>
Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0e8d2444168dd519fea501599d150e62718ed2fe)

| -rw-r--r-- | [fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/efivarfs/super.c?id=0e8d2444168dd519fea501599d150e62718ed2fe) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/fs/efivarfs/super.c b/fs/efivarfs/super.cindex 77240953a92e0e..869537f1a550dd 100644--- a/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=2cc14f52aeb78ce3f29677c2de1f06c0e91471ab)+++ b/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=0e8d2444168dd519fea501599d150e62718ed2fe)@@ -15,6 +15,7 @@ #include <linux/slab.h> #include <linux/magic.h> #include <linux/statfs.h>+#include <linux/printk.h>  #include "internal.h" @@ -333,9 +334,20 @@ static int efivarfs\_get\_tree(struct fs\_context \*fc) return get\_tree\_single(fc, efivarfs\_fill\_super); } +static int efivarfs\_reconfigure(struct fs\_context \*fc)+{+ if (!efivar\_supports\_writes() && !(fc->sb\_flags & SB\_RDONLY)) {+ pr\_err("Firmware does not support SetVariableRT. Can not remount with rw\n");+ return -EINVAL;+ }++ return 0;+}+ static const struct fs\_context\_operations efivarfs\_context\_ops = { .get\_tree = efivarfs\_get\_tree, .parse\_param = efivarfs\_parse\_param,+ .reconfigure = efivarfs\_reconfigure, };  static int efivarfs\_init\_fs\_context(struct fs\_context \*fc) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:05:41 +0000



=== Content from lists.debian.org_8e2a4762_20250111_090707.html ===


---

[[Date Prev](msg00015.html)][[Date Next](msg00017.html)]
[[Thread Prev](msg00015.html)][[Thread Next](msg00017.html)]
[[Date Index](maillist.html#00016)]
[[Thread Index](threads.html#00016)]

# [SECURITY] [DLA 3841-1] linux-5.10 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3841-1] linux-5.10 security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Tue, 25 Jun 2024 21:41:14 +0200
* *Message-id*: <[[🔎]](/msgid-search/ZnsdWnKC38pb009r%40decadent.org.uk) [ZnsdWnKC38pb009r@decadent.org.uk](msg00016.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3841-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
June 25, 2024                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux-5.10
Version        : 5.10.209-2~deb10u1
CVE ID         : CVE-2023-6040 CVE-2023-6356 CVE-2023-6535 CVE-2023-6536
                 CVE-2023-6606 CVE-2023-6915 CVE-2023-39198 CVE-2023-46838
                 CVE-2023-51779 CVE-2023-52340 CVE-2023-52436 CVE-2023-52438
                 CVE-2023-52439 CVE-2023-52443 CVE-2023-52444 CVE-2023-52445
                 CVE-2023-52448 CVE-2023-52449 CVE-2023-52451 CVE-2023-52454
                 CVE-2023-52456 CVE-2023-52457 CVE-2023-52462 CVE-2023-52463
                 CVE-2023-52464 CVE-2023-52467 CVE-2023-52469 CVE-2023-52470
                 CVE-2023-52609 CVE-2023-52612 CVE-2023-52675 CVE-2023-52679
                 CVE-2023-52683 CVE-2023-52686 CVE-2023-52690 CVE-2023-52691
                 CVE-2023-52693 CVE-2023-52694 CVE-2023-52696 CVE-2023-52698
                 CVE-2024-0646 CVE-2024-1086 CVE-2024-24860 CVE-2024-26586
                 CVE-2024-26597 CVE-2024-26598 CVE-2024-26633

Several vulnerabilities were discovered in the Linux kernel that may
lead to a privilege escalation, denial of service or information
leaks.

For Debian 10 buster, these problems were fixed earlier in version
5.10.209-2~deb10u1.  This update additionally included many more bug
fixes from stable updates 5.10.206-5.10.209 inclusive.

For the detailed security status of linux-5.10 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux-5.10>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpU6AD6rO3sK.pgp)**

*Description:* PGP signature

---



=== Content from git.kernel.org_236cbbb3_20250111_090703.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ilias Apalodimas <ilias.apalodimas@linaro.org> | 2023-11-07 14:40:56 +0900 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-25 15:35:14 -0800 |
| commit | [0049fe7e4a85849bdd778cdb72e51a791ff3d737](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737)) | |
| tree | [1f2f241c461862e689c474340a2f9b1f4e8668e4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737) | |
| parent | [408bbd1e1746fe33e51f4c81c2febd7d3841d031](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=408bbd1e1746fe33e51f4c81c2febd7d3841d031) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737&id2=408bbd1e1746fe33e51f4c81c2febd7d3841d031)) | |
| download | [linux-0049fe7e4a85849bdd778cdb72e51a791ff3d737.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0049fe7e4a85849bdd778cdb72e51a791ff3d737.tar.gz) | |

efivarfs: force RO when remounting if SetVariable is not supported[ Upstream commit 0e8d2444168dd519fea501599d150e62718ed2fe ]
If SetVariable at runtime is not supported by the firmware we never assign
a callback for that function. At the same time mount the efivarfs as
RO so no one can call that. However, we never check the permission flags
when someone remounts the filesystem as RW. As a result this leads to a
crash looking like this:
$ mount -o remount,rw /sys/firmware/efi/efivars
$ efi-updatevar -f PK.auth PK
[ 303.279166] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000
[ 303.280482] Mem abort info:
[ 303.280854] ESR = 0x0000000086000004
[ 303.281338] EC = 0x21: IABT (current EL), IL = 32 bits
[ 303.282016] SET = 0, FnV = 0
[ 303.282414] EA = 0, S1PTW = 0
[ 303.282821] FSC = 0x04: level 0 translation fault
[ 303.283771] user pgtable: 4k pages, 48-bit VAs, pgdp=000000004258c000
[ 303.284913] [0000000000000000] pgd=0000000000000000, p4d=0000000000000000
[ 303.286076] Internal error: Oops: 0000000086000004 [#1] PREEMPT SMP
[ 303.286936] Modules linked in: qrtr tpm\_tis tpm\_tis\_core crct10dif\_ce arm\_smccc\_trng rng\_core drm fuse ip\_tables x\_tables ipv6
[ 303.288586] CPU: 1 PID: 755 Comm: efi-updatevar Not tainted 6.3.0-rc1-00108-gc7d0c4695c68 #1
[ 303.289748] Hardware name: Unknown Unknown Product/Unknown Product, BIOS 2023.04-00627-g88336918701d 04/01/2023
[ 303.291150] pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 303.292123] pc : 0x0
[ 303.292443] lr : efivar\_set\_variable\_locked+0x74/0xec
[ 303.293156] sp : ffff800008673c10
[ 303.293619] x29: ffff800008673c10 x28: ffff0000037e8000 x27: 0000000000000000
[ 303.294592] x26: 0000000000000800 x25: ffff000002467400 x24: 0000000000000027
[ 303.295572] x23: ffffd49ea9832000 x22: ffff0000020c9800 x21: ffff000002467000
[ 303.296566] x20: 0000000000000001 x19: 00000000000007fc x18: 0000000000000000
[ 303.297531] x17: 0000000000000000 x16: 0000000000000000 x15: 0000aaaac807ab54
[ 303.298495] x14: ed37489f673633c0 x13: 71c45c606de13f80 x12: 47464259e219acf4
[ 303.299453] x11: ffff000002af7b01 x10: 0000000000000003 x9 : 0000000000000002
[ 303.300431] x8 : 0000000000000010 x7 : ffffd49ea8973230 x6 : 0000000000a85201
[ 303.301412] x5 : 0000000000000000 x4 : ffff0000020c9800 x3 : 00000000000007fc
[ 303.302370] x2 : 0000000000000027 x1 : ffff000002467400 x0 : ffff000002467000
[ 303.303341] Call trace:
[ 303.303679] 0x0
[ 303.303938] efivar\_entry\_set\_get\_size+0x98/0x16c
[ 303.304585] efivarfs\_file\_write+0xd0/0x1a4
[ 303.305148] vfs\_write+0xc4/0x2e4
[ 303.305601] ksys\_write+0x70/0x104
[ 303.306073] \_\_arm64\_sys\_write+0x1c/0x28
[ 303.306622] invoke\_syscall+0x48/0x114
[ 303.307156] el0\_svc\_common.constprop.0+0x44/0xec
[ 303.307803] do\_el0\_svc+0x38/0x98
[ 303.308268] el0\_svc+0x2c/0x84
[ 303.308702] el0t\_64\_sync\_handler+0xf4/0x120
[ 303.309293] el0t\_64\_sync+0x190/0x194
[ 303.309794] Code: ???????? ???????? ???????? ???????? (????????)
[ 303.310612] ---[ end trace 0000000000000000 ]---
Fix this by adding a .reconfigure() function to the fs operations which
we can use to check the requested flags and deny anything that's not RO
if the firmware doesn't implement SetVariable at runtime.
Fixes: f88814cc2578 ("efi/efivars: Expose RT service availability via efivars abstraction")
Signed-off-by: Ilias Apalodimas <ilias.apalodimas@linaro.org>
Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737)

| -rw-r--r-- | [fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/efivarfs/super.c?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/fs/efivarfs/super.c b/fs/efivarfs/super.cindex 996271473609a0..05c01694e8526a 100644--- a/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=408bbd1e1746fe33e51f4c81c2febd7d3841d031)+++ b/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=0049fe7e4a85849bdd778cdb72e51a791ff3d737)@@ -14,6 +14,7 @@ #include <linux/slab.h> #include <linux/magic.h> #include <linux/statfs.h>+#include <linux/printk.h>  #include "internal.h" @@ -275,8 +276,19 @@ static int efivarfs\_get\_tree(struct fs\_context \*fc) return get\_tree\_single(fc, efivarfs\_fill\_super); } +static int efivarfs\_reconfigure(struct fs\_context \*fc)+{+ if (!efivar\_supports\_writes() && !(fc->sb\_flags & SB\_RDONLY)) {+ pr\_err("Firmware does not support SetVariableRT. Can not remount with rw\n");+ return -EINVAL;+ }++ return 0;+}+ static const struct fs\_context\_operations efivarfs\_context\_ops = { .get\_tree = efivarfs\_get\_tree,+ .reconfigure = efivarfs\_reconfigure, };  static int efivarfs\_init\_fs\_context(struct fs\_context \*fc) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:05:40 +0000



=== Content from git.kernel.org_40c01764_20250111_090705.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ilias Apalodimas <ilias.apalodimas@linaro.org> | 2023-11-07 14:40:56 +0900 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-25 14:52:33 -0800 |
| commit | [2aa141f8bc580f8f9811dfe4e0e6009812b73826](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826)) | |
| tree | [88a2cb1ae973ee1fdb3a9d0581811b5046b97579](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826) | |
| parent | [a4529a08d3704c17ea9c7277d180e46b99250ded](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a4529a08d3704c17ea9c7277d180e46b99250ded) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826&id2=a4529a08d3704c17ea9c7277d180e46b99250ded)) | |
| download | [linux-2aa141f8bc580f8f9811dfe4e0e6009812b73826.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2aa141f8bc580f8f9811dfe4e0e6009812b73826.tar.gz) | |

efivarfs: force RO when remounting if SetVariable is not supported[ Upstream commit 0e8d2444168dd519fea501599d150e62718ed2fe ]
If SetVariable at runtime is not supported by the firmware we never assign
a callback for that function. At the same time mount the efivarfs as
RO so no one can call that. However, we never check the permission flags
when someone remounts the filesystem as RW. As a result this leads to a
crash looking like this:
$ mount -o remount,rw /sys/firmware/efi/efivars
$ efi-updatevar -f PK.auth PK
[ 303.279166] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000
[ 303.280482] Mem abort info:
[ 303.280854] ESR = 0x0000000086000004
[ 303.281338] EC = 0x21: IABT (current EL), IL = 32 bits
[ 303.282016] SET = 0, FnV = 0
[ 303.282414] EA = 0, S1PTW = 0
[ 303.282821] FSC = 0x04: level 0 translation fault
[ 303.283771] user pgtable: 4k pages, 48-bit VAs, pgdp=000000004258c000
[ 303.284913] [0000000000000000] pgd=0000000000000000, p4d=0000000000000000
[ 303.286076] Internal error: Oops: 0000000086000004 [#1] PREEMPT SMP
[ 303.286936] Modules linked in: qrtr tpm\_tis tpm\_tis\_core crct10dif\_ce arm\_smccc\_trng rng\_core drm fuse ip\_tables x\_tables ipv6
[ 303.288586] CPU: 1 PID: 755 Comm: efi-updatevar Not tainted 6.3.0-rc1-00108-gc7d0c4695c68 #1
[ 303.289748] Hardware name: Unknown Unknown Product/Unknown Product, BIOS 2023.04-00627-g88336918701d 04/01/2023
[ 303.291150] pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 303.292123] pc : 0x0
[ 303.292443] lr : efivar\_set\_variable\_locked+0x74/0xec
[ 303.293156] sp : ffff800008673c10
[ 303.293619] x29: ffff800008673c10 x28: ffff0000037e8000 x27: 0000000000000000
[ 303.294592] x26: 0000000000000800 x25: ffff000002467400 x24: 0000000000000027
[ 303.295572] x23: ffffd49ea9832000 x22: ffff0000020c9800 x21: ffff000002467000
[ 303.296566] x20: 0000000000000001 x19: 00000000000007fc x18: 0000000000000000
[ 303.297531] x17: 0000000000000000 x16: 0000000000000000 x15: 0000aaaac807ab54
[ 303.298495] x14: ed37489f673633c0 x13: 71c45c606de13f80 x12: 47464259e219acf4
[ 303.299453] x11: ffff000002af7b01 x10: 0000000000000003 x9 : 0000000000000002
[ 303.300431] x8 : 0000000000000010 x7 : ffffd49ea8973230 x6 : 0000000000a85201
[ 303.301412] x5 : 0000000000000000 x4 : ffff0000020c9800 x3 : 00000000000007fc
[ 303.302370] x2 : 0000000000000027 x1 : ffff000002467400 x0 : ffff000002467000
[ 303.303341] Call trace:
[ 303.303679] 0x0
[ 303.303938] efivar\_entry\_set\_get\_size+0x98/0x16c
[ 303.304585] efivarfs\_file\_write+0xd0/0x1a4
[ 303.305148] vfs\_write+0xc4/0x2e4
[ 303.305601] ksys\_write+0x70/0x104
[ 303.306073] \_\_arm64\_sys\_write+0x1c/0x28
[ 303.306622] invoke\_syscall+0x48/0x114
[ 303.307156] el0\_svc\_common.constprop.0+0x44/0xec
[ 303.307803] do\_el0\_svc+0x38/0x98
[ 303.308268] el0\_svc+0x2c/0x84
[ 303.308702] el0t\_64\_sync\_handler+0xf4/0x120
[ 303.309293] el0t\_64\_sync+0x190/0x194
[ 303.309794] Code: ???????? ???????? ???????? ???????? (????????)
[ 303.310612] ---[ end trace 0000000000000000 ]---
Fix this by adding a .reconfigure() function to the fs operations which
we can use to check the requested flags and deny anything that's not RO
if the firmware doesn't implement SetVariable at runtime.
Fixes: f88814cc2578 ("efi/efivars: Expose RT service availability via efivars abstraction")
Signed-off-by: Ilias Apalodimas <ilias.apalodimas@linaro.org>
Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826)

| -rw-r--r-- | [fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/efivarfs/super.c?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/fs/efivarfs/super.c b/fs/efivarfs/super.cindex 15880a68faadc5..3626816b174ad7 100644--- a/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=a4529a08d3704c17ea9c7277d180e46b99250ded)+++ b/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=2aa141f8bc580f8f9811dfe4e0e6009812b73826)@@ -13,6 +13,7 @@ #include <linux/ucs2\_string.h> #include <linux/slab.h> #include <linux/magic.h>+#include <linux/printk.h>  #include "internal.h" @@ -231,8 +232,19 @@ static int efivarfs\_get\_tree(struct fs\_context \*fc) return get\_tree\_single(fc, efivarfs\_fill\_super); } +static int efivarfs\_reconfigure(struct fs\_context \*fc)+{+ if (!efivar\_supports\_writes() && !(fc->sb\_flags & SB\_RDONLY)) {+ pr\_err("Firmware does not support SetVariableRT. Can not remount with rw\n");+ return -EINVAL;+ }++ return 0;+}+ static const struct fs\_context\_operations efivarfs\_context\_ops = { .get\_tree = efivarfs\_get\_tree,+ .reconfigure = efivarfs\_reconfigure, };  static int efivarfs\_init\_fs\_context(struct fs\_context \*fc) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:05:42 +0000



=== Content from git.kernel.org_90b61032_20250111_090707.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d4a9aa7db574a0da64307729cc031fb68597aa8b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d4a9aa7db574a0da64307729cc031fb68597aa8b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d4a9aa7db574a0da64307729cc031fb68597aa8b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d4a9aa7db574a0da64307729cc031fb68597aa8b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ilias Apalodimas <ilias.apalodimas@linaro.org> | 2023-11-07 14:40:56 +0900 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-25 15:27:20 -0800 |
| commit | [d4a9aa7db574a0da64307729cc031fb68597aa8b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d4a9aa7db574a0da64307729cc031fb68597aa8b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d4a9aa7db574a0da64307729cc031fb68597aa8b)) | |
| tree | [7e839c1b55a0450e1b90c0d970068500db7abde7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d4a9aa7db574a0da64307729cc031fb68597aa8b) | |
| parent | [321b3a5592c8a9d6b654c7c64833ea67dbb33149](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=321b3a5592c8a9d6b654c7c64833ea67dbb33149) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d4a9aa7db574a0da64307729cc031fb68597aa8b&id2=321b3a5592c8a9d6b654c7c64833ea67dbb33149)) | |
| download | [linux-d4a9aa7db574a0da64307729cc031fb68597aa8b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d4a9aa7db574a0da64307729cc031fb68597aa8b.tar.gz) | |

efivarfs: force RO when remounting if SetVariable is not supported[ Upstream commit 0e8d2444168dd519fea501599d150e62718ed2fe ]
If SetVariable at runtime is not supported by the firmware we never assign
a callback for that function. At the same time mount the efivarfs as
RO so no one can call that. However, we never check the permission flags
when someone remounts the filesystem as RW. As a result this leads to a
crash looking like this:
$ mount -o remount,rw /sys/firmware/efi/efivars
$ efi-updatevar -f PK.auth PK
[ 303.279166] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000
[ 303.280482] Mem abort info:
[ 303.280854] ESR = 0x0000000086000004
[ 303.281338] EC = 0x21: IABT (current EL), IL = 32 bits
[ 303.282016] SET = 0, FnV = 0
[ 303.282414] EA = 0, S1PTW = 0
[ 303.282821] FSC = 0x04: level 0 translation fault
[ 303.283771] user pgtable: 4k pages, 48-bit VAs, pgdp=000000004258c000
[ 303.284913] [0000000000000000] pgd=0000000000000000, p4d=0000000000000000
[ 303.286076] Internal error: Oops: 0000000086000004 [#1] PREEMPT SMP
[ 303.286936] Modules linked in: qrtr tpm\_tis tpm\_tis\_core crct10dif\_ce arm\_smccc\_trng rng\_core drm fuse ip\_tables x\_tables ipv6
[ 303.288586] CPU: 1 PID: 755 Comm: efi-updatevar Not tainted 6.3.0-rc1-00108-gc7d0c4695c68 #1
[ 303.289748] Hardware name: Unknown Unknown Product/Unknown Product, BIOS 2023.04-00627-g88336918701d 04/01/2023
[ 303.291150] pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 303.292123] pc : 0x0
[ 303.292443] lr : efivar\_set\_variable\_locked+0x74/0xec
[ 303.293156] sp : ffff800008673c10
[ 303.293619] x29: ffff800008673c10 x28: ffff0000037e8000 x27: 0000000000000000
[ 303.294592] x26: 0000000000000800 x25: ffff000002467400 x24: 0000000000000027
[ 303.295572] x23: ffffd49ea9832000 x22: ffff0000020c9800 x21: ffff000002467000
[ 303.296566] x20: 0000000000000001 x19: 00000000000007fc x18: 0000000000000000
[ 303.297531] x17: 0000000000000000 x16: 0000000000000000 x15: 0000aaaac807ab54
[ 303.298495] x14: ed37489f673633c0 x13: 71c45c606de13f80 x12: 47464259e219acf4
[ 303.299453] x11: ffff000002af7b01 x10: 0000000000000003 x9 : 0000000000000002
[ 303.300431] x8 : 0000000000000010 x7 : ffffd49ea8973230 x6 : 0000000000a85201
[ 303.301412] x5 : 0000000000000000 x4 : ffff0000020c9800 x3 : 00000000000007fc
[ 303.302370] x2 : 0000000000000027 x1 : ffff000002467400 x0 : ffff000002467000
[ 303.303341] Call trace:
[ 303.303679] 0x0
[ 303.303938] efivar\_entry\_set\_get\_size+0x98/0x16c
[ 303.304585] efivarfs\_file\_write+0xd0/0x1a4
[ 303.305148] vfs\_write+0xc4/0x2e4
[ 303.305601] ksys\_write+0x70/0x104
[ 303.306073] \_\_arm64\_sys\_write+0x1c/0x28
[ 303.306622] invoke\_syscall+0x48/0x114
[ 303.307156] el0\_svc\_common.constprop.0+0x44/0xec
[ 303.307803] do\_el0\_svc+0x38/0x98
[ 303.308268] el0\_svc+0x2c/0x84
[ 303.308702] el0t\_64\_sync\_handler+0xf4/0x120
[ 303.309293] el0t\_64\_sync+0x190/0x194
[ 303.309794] Code: ???????? ???????? ???????? ???????? (????????)
[ 303.310612] ---[ end trace 0000000000000000 ]---
Fix this by adding a .reconfigure() function to the fs operations which
we can use to check the requested flags and deny anything that's not RO
if the firmware doesn't implement SetVariable at runtime.
Fixes: f88814cc2578 ("efi/efivars: Expose RT service availability via efivars abstraction")
Signed-off-by: Ilias Apalodimas <ilias.apalodimas@linaro.org>
Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d4a9aa7db574a0da64307729cc031fb68597aa8b)

| -rw-r--r-- | [fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/efivarfs/super.c?id=d4a9aa7db574a0da64307729cc031fb68597aa8b) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/fs/efivarfs/super.c b/fs/efivarfs/super.cindex 6780fc81cc11f0..f5966cd9591897 100644--- a/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=321b3a5592c8a9d6b654c7c64833ea67dbb33149)+++ b/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=d4a9aa7db574a0da64307729cc031fb68597aa8b)@@ -13,6 +13,7 @@ #include <linux/ucs2\_string.h> #include <linux/slab.h> #include <linux/magic.h>+#include <linux/printk.h>  #include "internal.h" @@ -226,8 +227,19 @@ static int efivarfs\_get\_tree(struct fs\_context \*fc) return get\_tree\_single(fc, efivarfs\_fill\_super); } +static int efivarfs\_reconfigure(struct fs\_context \*fc)+{+ if (!efivar\_supports\_writes() && !(fc->sb\_flags & SB\_RDONLY)) {+ pr\_err("Firmware does not support SetVariableRT. Can not remount with rw\n");+ return -EINVAL;+ }++ return 0;+}+ static const struct fs\_context\_operations efivarfs\_context\_ops = { .get\_tree = efivarfs\_get\_tree,+ .reconfigure = efivarfs\_reconfigure, };  static int efivarfs\_init\_fs\_context(struct fs\_context \*fc) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:05:44 +0000



=== Content from git.kernel.org_6a039055_20250111_090705.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ilias Apalodimas <ilias.apalodimas@linaro.org> | 2023-11-07 14:40:56 +0900 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-25 14:37:40 -0800 |
| commit | [94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8)) | |
| tree | [3cc734939bbaf562d1665390ab5c7030b496b1a0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8) | |
| parent | [44a88650ba55e6a7f2ec485d2c2413ba7e216f01](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=44a88650ba55e6a7f2ec485d2c2413ba7e216f01) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8&id2=44a88650ba55e6a7f2ec485d2c2413ba7e216f01)) | |
| download | [linux-94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8.tar.gz) | |

efivarfs: force RO when remounting if SetVariable is not supported[ Upstream commit 0e8d2444168dd519fea501599d150e62718ed2fe ]
If SetVariable at runtime is not supported by the firmware we never assign
a callback for that function. At the same time mount the efivarfs as
RO so no one can call that. However, we never check the permission flags
when someone remounts the filesystem as RW. As a result this leads to a
crash looking like this:
$ mount -o remount,rw /sys/firmware/efi/efivars
$ efi-updatevar -f PK.auth PK
[ 303.279166] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000
[ 303.280482] Mem abort info:
[ 303.280854] ESR = 0x0000000086000004
[ 303.281338] EC = 0x21: IABT (current EL), IL = 32 bits
[ 303.282016] SET = 0, FnV = 0
[ 303.282414] EA = 0, S1PTW = 0
[ 303.282821] FSC = 0x04: level 0 translation fault
[ 303.283771] user pgtable: 4k pages, 48-bit VAs, pgdp=000000004258c000
[ 303.284913] [0000000000000000] pgd=0000000000000000, p4d=0000000000000000
[ 303.286076] Internal error: Oops: 0000000086000004 [#1] PREEMPT SMP
[ 303.286936] Modules linked in: qrtr tpm\_tis tpm\_tis\_core crct10dif\_ce arm\_smccc\_trng rng\_core drm fuse ip\_tables x\_tables ipv6
[ 303.288586] CPU: 1 PID: 755 Comm: efi-updatevar Not tainted 6.3.0-rc1-00108-gc7d0c4695c68 #1
[ 303.289748] Hardware name: Unknown Unknown Product/Unknown Product, BIOS 2023.04-00627-g88336918701d 04/01/2023
[ 303.291150] pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[ 303.292123] pc : 0x0
[ 303.292443] lr : efivar\_set\_variable\_locked+0x74/0xec
[ 303.293156] sp : ffff800008673c10
[ 303.293619] x29: ffff800008673c10 x28: ffff0000037e8000 x27: 0000000000000000
[ 303.294592] x26: 0000000000000800 x25: ffff000002467400 x24: 0000000000000027
[ 303.295572] x23: ffffd49ea9832000 x22: ffff0000020c9800 x21: ffff000002467000
[ 303.296566] x20: 0000000000000001 x19: 00000000000007fc x18: 0000000000000000
[ 303.297531] x17: 0000000000000000 x16: 0000000000000000 x15: 0000aaaac807ab54
[ 303.298495] x14: ed37489f673633c0 x13: 71c45c606de13f80 x12: 47464259e219acf4
[ 303.299453] x11: ffff000002af7b01 x10: 0000000000000003 x9 : 0000000000000002
[ 303.300431] x8 : 0000000000000010 x7 : ffffd49ea8973230 x6 : 0000000000a85201
[ 303.301412] x5 : 0000000000000000 x4 : ffff0000020c9800 x3 : 00000000000007fc
[ 303.302370] x2 : 0000000000000027 x1 : ffff000002467400 x0 : ffff000002467000
[ 303.303341] Call trace:
[ 303.303679] 0x0
[ 303.303938] efivar\_entry\_set\_get\_size+0x98/0x16c
[ 303.304585] efivarfs\_file\_write+0xd0/0x1a4
[ 303.305148] vfs\_write+0xc4/0x2e4
[ 303.305601] ksys\_write+0x70/0x104
[ 303.306073] \_\_arm64\_sys\_write+0x1c/0x28
[ 303.306622] invoke\_syscall+0x48/0x114
[ 303.307156] el0\_svc\_common.constprop.0+0x44/0xec
[ 303.307803] do\_el0\_svc+0x38/0x98
[ 303.308268] el0\_svc+0x2c/0x84
[ 303.308702] el0t\_64\_sync\_handler+0xf4/0x120
[ 303.309293] el0t\_64\_sync+0x190/0x194
[ 303.309794] Code: ???????? ???????? ???????? ???????? (????????)
[ 303.310612] ---[ end trace 0000000000000000 ]---
Fix this by adding a .reconfigure() function to the fs operations which
we can use to check the requested flags and deny anything that's not RO
if the firmware doesn't implement SetVariable at runtime.
Fixes: f88814cc2578 ("efi/efivars: Expose RT service availability via efivars abstraction")
Signed-off-by: Ilias Apalodimas <ilias.apalodimas@linaro.org>
Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8)

| -rw-r--r-- | [fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/efivarfs/super.c?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/fs/efivarfs/super.c b/fs/efivarfs/super.cindex 15880a68faadc5..3626816b174ad7 100644--- a/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=44a88650ba55e6a7f2ec485d2c2413ba7e216f01)+++ b/[fs/efivarfs/super.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/efivarfs/super.c?id=94c742324ed7e42c5bd6a9ed22e4ec6d764db4d8)@@ -13,6 +13,7 @@ #include <linux/ucs2\_string.h> #include <linux/slab.h> #include <linux/magic.h>+#include <linux/printk.h>  #include "internal.h" @@ -231,8 +232,19 @@ static int efivarfs\_get\_tree(struct fs\_context \*fc) return get\_tree\_single(fc, efivarfs\_fill\_super); } +static int efivarfs\_reconfigure(struct fs\_context \*fc)+{+ if (!efivar\_supports\_writes() && !(fc->sb\_flags & SB\_RDONLY)) {+ pr\_err("Firmware does not support SetVariableRT. Can not remount with rw\n");+ return -EINVAL;+ }++ return 0;+}+ static const struct fs\_context\_operations efivarfs\_context\_ops = { .get\_tree = efivarfs\_get\_tree,+ .reconfigure = efivarfs\_reconfigure, };  static int efivarfs\_init\_fs\_context(struct fs\_context \*fc) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:05:43 +0000


