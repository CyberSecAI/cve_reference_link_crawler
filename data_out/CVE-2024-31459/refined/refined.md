```
{
  "vulnerability": {
    "root_cause": "The `api_plugin_hook()` function in the `lib/plugin.php` file reads data from the `plugin_hooks` and `plugin_config` tables, and directly concatenates the data into a file path used for inclusion, without proper sanitization or validation.",
    "weaknesses": [
      "File inclusion vulnerability due to unsanitized file path construction."
    ],
    "impact": "Remote Code Execution (RCE) can be achieved by combining this file inclusion vulnerability with SQL injection vulnerabilities to insert malicious data into the database, allowing for the inclusion of arbitrary files containing malicious code.",
    "attack_vectors": [
      "The attack vector requires exploiting an SQL injection vulnerability (e.g., GHSA-gj3f-p326-gh8r) to inject malicious data into the `plugin_hooks` and `plugin_config` tables. The malicious data is crafted to construct a file path to a file that contains attacker-controlled code.",
       "The vulnerability is triggered when the  `api_plugin_hook()` function is called, leading to file inclusion."
    ],
    "attacker_capabilities": "An attacker needs to have the ability to exploit SQL injection vulnerabilities to insert malicious data into the database. The attacker needs to be able to trigger the function api_plugin_hook()"
  },
  "cve": "CVE-2024-31459",
  "additional_information": {
    "poc": "The provided Proof of Concept (PoC) demonstrates how to inject malicious data into the database using SQL injection, specifically targeting the `plugin_hooks` and `plugin_config` tables. The injected data manipulates the file path to include a malicious file, leading to arbitrary code execution. Additionally, the PoC references another vulnerability (GHSA-pfh9-gwm6-86vp) to demonstrate how to write the malicious code to the system logs."
  }
}
```