=== Content from gitlab.com_8ad4d57b_20250111_205313.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Heap-based Buffer Overflow in the storestring() function

Hi,

While fuzzing dpic [68ab9432](/aplevich/dpic/-/commit/68ab94321d9ea978b68906d16a315efab4758353 "Colored svg sprintf text and appended %") with Hongfuzz, I found a Heap-based Buffer Overflow in the storestring() function, in dpic.y.

Attaching a reproducer, the issue can be reproduced by running: [test02](/-/project/5973503/uploads/3ff24b9bd05fee4373e168b8375ecf69/test02)

`dpic test02`

```
=================================================================
==1522230==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x621000006100 at pc 0x000000527df7 bp 0x7ffcc985f3d0 sp 0x7ffcc985f3c8
WRITE of size 1 at 0x621000006100 thread T0
    #0 0x527df6 in storestring /src/dpic/dpic.y:4266:51
    #1 0x4fac82 in yyparse /src/dpic/dpic.y:911:5
    #2 0x4e67b3 in main /src/dpic/main.c:1795:13
    #3 0x7f3bdc9fa0b2 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)
    #4 0x41c48d in _start (/src/dpic/dpic+0x41c48d)

0x621000006100 is located 0 bytes to the right of 4096-byte region [0x621000005100,0x621000006100)
allocated by thread T0 here:
    #0 0x4976ed in malloc (/src/dpic/dpic+0x4976ed)
    #1 0x5273c4 in storestring /src/dpic/dpic.y:4260:15

SUMMARY: AddressSanitizer: heap-buffer-overflow /src/dpic/dpic.y:4266:51 in storestring
Shadow bytes around the buggy address:
  0x0c427fff8bd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c427fff8be0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c427fff8bf0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c427fff8c00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c427fff8c10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c427fff8c20:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff8c30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff8c40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff8c50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff8c60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff8c70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==1522230==ABORTING
```

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_7f3ec0d0_20250111_205312.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
d317e406**

authored
Apr 10, 2021
by
**[![Dwight Aplevich's avatar](https://secure.gravatar.com/avatar/8fa75824c361476cc033ee48a38ef2e57bf4387b84d70591c5230ac711868901?s=96&d=identicon "Dwight Aplevich")](/aplevich)
[Dwight Aplevich](/aplevich)**

[Browse files](/aplevich/dpic/-/tree/d317e4066c17f9ceb359b3af13264c32f6fb43cf)

### Improved robustness to fuzzed input

parent
[68ab9432](/aplevich/dpic/-/commit/68ab94321d9ea978b68906d16a315efab4758353)

Loading

Loading

Loading

* [Changes
  33](/aplevich/dpic/-/commit/d317e4066c17f9ceb359b3af13264c32f6fb43cf)

[Expand all](/aplevich/dpic/-/commit/d317e4066c17f9ceb359b3af13264c32f6fb43cf?expanded=1)
[Hide whitespace changes](/aplevich/dpic/-/commit/d317e4066c17f9ceb359b3af13264c32f6fb43cf?action=show&controller=projects%2Fcommit&id=d317e4066c17f9ceb359b3af13264c32f6fb43cf&namespace_id=aplevich&project_id=dpic&w=1)
[Inline](/aplevich/dpic/-/commit/d317e4066c17f9ceb359b3af13264c32f6fb43cf?view=inline)
[Side-by-side](/aplevich/dpic/-/commit/d317e4066c17f9ceb359b3af13264c32f6fb43cf?view=parallel)

Loading

* [Neeraj Pal](/bsdb0y)
  @bsdb0y

  mentioned in issue [#8 (closed)](/aplevich/dpic/-/issues/8 "Heap-based Buffer Overflow in the makevar() function")

  路

  [May 09, 2021](#note_570971433)

  mentioned in issue [#8 (closed)](/aplevich/dpic/-/issues/8 "Heap-based Buffer Overflow in the makevar() function")

  mentioned in issue #8

  Toggle commit list
* [Neeraj Pal](/bsdb0y)
  @bsdb0y

  mentioned in issue [#9 (closed)](/aplevich/dpic/-/issues/9 "Heap Use After Free in the cmpstring() function")

  路

  [May 09, 2021](#note_570974531)

  mentioned in issue [#9 (closed)](/aplevich/dpic/-/issues/9 "Heap Use After Free in the cmpstring() function")

  mentioned in issue #9

  Toggle commit list
* [Neeraj Pal](/bsdb0y)
  @bsdb0y

  mentioned in issue [#10 (closed)](/aplevich/dpic/-/issues/10 "Heap Use After Free in the deletestringbox() function (different than #7)")

  路

  [May 09, 2021](#note_570975790)

  mentioned in issue [#10 (closed)](/aplevich/dpic/-/issues/10 "Heap Use After Free in the deletestringbox() function (different than #7)")

  mentioned in issue #10

  Toggle commit list
* [Neeraj Pal](/bsdb0y)
  @bsdb0y

  mentioned in issue [#11 (closed)](/aplevich/dpic/-/issues/11 "Global Buffer Overflow in the trimname() function")

  路

  [May 09, 2021](#note_570987834)

  mentioned in issue [#11 (closed)](/aplevich/dpic/-/issues/11 "Global Buffer Overflow in the trimname() function")

  mentioned in issue #11

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment


