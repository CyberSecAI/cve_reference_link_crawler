=== Content from github.com_0db032f5_20250111_170846.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNC3-LU%2FTestingPlatform%2Fsecurity%2Fadvisories%2FGHSA-9fhc-f3mr-w6h6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNC3-LU%2FTestingPlatform%2Fsecurity%2Fadvisories%2FGHSA-9fhc-f3mr-w6h6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=NC3-LU%2FTestingPlatform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NC3-LU](/NC3-LU)
/
**[TestingPlatform](/NC3-LU/TestingPlatform)**
Public

* [Notifications](/login?return_to=%2FNC3-LU%2FTestingPlatform) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FNC3-LU%2FTestingPlatform)
* [Star
   6](/login?return_to=%2FNC3-LU%2FTestingPlatform)

* [Code](/NC3-LU/TestingPlatform)
* [Issues
  0](/NC3-LU/TestingPlatform/issues)
* [Pull requests
  7](/NC3-LU/TestingPlatform/pulls)
* [Discussions](/NC3-LU/TestingPlatform/discussions)
* [Actions](/NC3-LU/TestingPlatform/actions)
* [Security](/NC3-LU/TestingPlatform/security)
* [Insights](/NC3-LU/TestingPlatform/pulse)

Additional navigation options

* [Code](/NC3-LU/TestingPlatform)
* [Issues](/NC3-LU/TestingPlatform/issues)
* [Pull requests](/NC3-LU/TestingPlatform/pulls)
* [Discussions](/NC3-LU/TestingPlatform/discussions)
* [Actions](/NC3-LU/TestingPlatform/actions)
* [Security](/NC3-LU/TestingPlatform/security)
* [Insights](/NC3-LU/TestingPlatform/pulse)

# Ability to DoS the testing infrastructure by overwriting files

Critical

[cedricbonhomme](/cedricbonhomme)
published
GHSA-9fhc-f3mr-w6h6
Nov 20, 2023

## Package

testing/helpers.py

## Affected versions

2.1.0

## Patched versions

2.1.1

## Description

### Summary

(1) User input is not filtered correctly. Nmap options are accepted. In this particular case, the option to create log files is accepted in addition to a host name (and even without). A log file is created at the location specified.

(2) These files are created as root. If the file exists, the existing file is being rendered useless.

### Details

see PoC

### PoC

Harmless: Enter in the host/IP field: -oN newfile.txt

new file is created in merged/apps/

Harmfull: Enter in the host/IP field: -oN testing/views.py

file merged/apps/testing/views.py is overwritten by the log of nmap

### Impact

Denial of service of the application

### Severity

Critical

### CVE ID

CVE-2023-48310

### Weaknesses

No CWEs

### Credits

* [![@cedricbonhomme](https://avatars.githubusercontent.com/u/465400?s=40&v=4)](/cedricbonhomme)
  [cedricbonhomme](/cedricbonhomme)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c22495e2_20250111_170845.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNC3-LU%2FTestingPlatform%2Fcommit%2F7b3e7ca869a4845aa7445f874c22c5929315c3a7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNC3-LU%2FTestingPlatform%2Fcommit%2F7b3e7ca869a4845aa7445f874c22c5929315c3a7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=NC3-LU%2FTestingPlatform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NC3-LU](/NC3-LU)
/
**[TestingPlatform](/NC3-LU/TestingPlatform)**
Public

* [Notifications](/login?return_to=%2FNC3-LU%2FTestingPlatform) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FNC3-LU%2FTestingPlatform)
* [Star
   6](/login?return_to=%2FNC3-LU%2FTestingPlatform)

* [Code](/NC3-LU/TestingPlatform)
* [Issues
  0](/NC3-LU/TestingPlatform/issues)
* [Pull requests
  7](/NC3-LU/TestingPlatform/pulls)
* [Discussions](/NC3-LU/TestingPlatform/discussions)
* [Actions](/NC3-LU/TestingPlatform/actions)
* [Security](/NC3-LU/TestingPlatform/security)
* [Insights](/NC3-LU/TestingPlatform/pulse)

Additional navigation options

* [Code](/NC3-LU/TestingPlatform)
* [Issues](/NC3-LU/TestingPlatform/issues)
* [Pull requests](/NC3-LU/TestingPlatform/pulls)
* [Discussions](/NC3-LU/TestingPlatform/discussions)
* [Actions](/NC3-LU/TestingPlatform/actions)
* [Security](/NC3-LU/TestingPlatform/security)
* [Insights](/NC3-LU/TestingPlatform/pulse)

## Commit

[Permalink](/NC3-LU/TestingPlatform/commit/7b3e7ca869a4845aa7445f874c22c5929315c3a7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

chg: [security] Added new domain name validator used in the file test…

[Browse files](/NC3-LU/TestingPlatform/tree/7b3e7ca869a4845aa7445f874c22c5929315c3a7)
Browse the repository at this point in the history

```
…ing/helpers.py ([GHSA-9fhc-f3mr-w6h6](https://github.com/NC3-LU/TestingPlatform/security/advisories/GHSA-9fhc-f3mr-w6h6 "GHSA-9fhc-f3mr-w6h6")).
```

* Loading branch information

[![@cedricbonhomme](https://avatars.githubusercontent.com/u/465400?s=40&v=4)](/cedricbonhomme)

[cedricbonhomme](/NC3-LU/TestingPlatform/commits?author=cedricbonhomme "View all commits by cedricbonhomme")
committed
Nov 20, 2023

1 parent
[49d94e6](/NC3-LU/TestingPlatform/commit/49d94e650a5fb58d077490684e54ea2feb3b3730)

commit 7b3e7ca

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**95 additions**
and
**68 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* api

  + api/serializers.py
    [serializers.py](#diff-1acc662da69290fd8ce4137ddec9d9cc131df53d76d6d107a13c95550781e81e)
  + api/validators.py
    [validators.py](#diff-a0183352fafe54e798fe1a0661d01e1b7aa2f183774ea51a24be8ae0bc79ac38)
  + api/views.py
    [views.py](#diff-7fb412808754eb12ee1b172c34c44eb9ce58b3bba43d62ffcb986ad7917588a8)
* pyproject.toml
  [pyproject.toml](#diff-50c86b7ed8ac2cf95bd48334961bf0530cdc77b5a56f852c5c61b89d735fd711)
* testing

  + testing/helpers.py
    [helpers.py](#diff-77cdeb90a496f735f646643ce714c741c46ea7a668ac6760c3de7a2c2ac8310b)
  + testing/validators.py
    [validators.py](#diff-f125ab4f4c411acec1cf5469697dd001b0f0a2457306ad22cfe90e18596b9a0d)

## There are no files selected for viewing

12 changes: 11 additions & 1 deletion

12
[api/serializers.py](#diff-1acc662da69290fd8ce4137ddec9d9cc131df53d76d6d107a13c95550781e81e "api/serializers.py")

Show comments

[View file](/NC3-LU/TestingPlatform/blob/7b3e7ca869a4845aa7445f874c22c5929315c3a7/api/serializers.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,7 @@ |
|  |  | from authentication.models import User |
|  |  | from automation.models import HttpAutomatedTest, PingAutomatedTest |
|  |  | from testing.models import TlsScanHistory |
|  |  | from testing.validators import domain\_name |
|  |  |  |
|  |  | # |
|  |  | # Model: User |
| Expand Down  Expand Up | | @@ -118,12 +119,21 @@ class Meta: |
|  |  |  |
|  |  | class DomainNameSerializer(serializers.Serializer): |
|  |  | domain\_name = serializers.CharField( |
|  |  | max\_length=200, required=True, help\_text="Domain name." |
|  |  | max\_length=200, |
|  |  | required=True, |
|  |  | help\_text="Domain name.", |
|  |  | validators=[domain\_name], |
|  |  | ) |
|  |  |  |
|  |  | class Meta: |
|  |  | fields = ["domain\_name"] |
|  |  |  |
|  |  | def validate\_domain\_name(self, value): |
|  |  | """ |
|  |  | Check that value is a valid domain name. |
|  |  | """ |
|  |  | return domain\_name(value) |
|  |  |  |
|  |  |  |
|  |  | class DomainNameAndServiceSerializer(serializers.Serializer): |
|  |  | domain\_name = serializers.CharField( |
| Expand Down | |  |

36 changes: 0 additions & 36 deletions

36
[api/validators.py](#diff-a0183352fafe54e798fe1a0661d01e1b7aa2f183774ea51a24be8ae0bc79ac38 "api/validators.py")

Show comments

[View file](/NC3-LU/TestingPlatform/blob/49d94e650a5fb58d077490684e54ea2feb3b3730/api/validators.py)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

1 change: 1 addition & 0 deletions

1
[api/views.py](#diff-7fb412808754eb12ee1b172c34c44eb9ce58b3bba43d62ffcb986ad7917588a8 "api/views.py")

Show comments

[View file](/NC3-LU/TestingPlatform/blob/7b3e7ca869a4845aa7445f874c22c5929315c3a7/api/views.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -387,6 +387,7 @@ def create(self, request, \*args, \*\*kwargs): |
|  |  | Checks the presence of a SOA record. |
|  |  | """ |
|  |  | domain\_name = request.data.get("domain\_name", None) |
|  |  | DomainNameSerializer(domain\_name) |
|  |  | result = check\_soa\_record(domain\_name) |
|  |  | return Response(result, status=status.HTTP\_200\_OK) |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[pyproject.toml](#diff-50c86b7ed8ac2cf95bd48334961bf0530cdc77b5a56f852c5c61b89d735fd711 "pyproject.toml")

Show comments

[View file](/NC3-LU/TestingPlatform/blob/7b3e7ca869a4845aa7445f874c22c5929315c3a7/pyproject.toml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | [tool.poetry] |
|  |  | name = "testing-platform" |
|  |  | version = "0.1.0" |
|  |  | version = "0.1.1" |
|  |  | description = "NC3 Testing Platform" |
|  |  | authors = [ |
|  |  | "Romain Kieffer <romain.kieffer@nc3.lu>", |
| Expand Down | |  |

60 changes: 30 additions & 30 deletions

60
[testing/helpers.py](#diff-77cdeb90a496f735f646643ce714c741c46ea7a668ac6760c3de7a2c2ac8310b "testing/helpers.py")

Show comments

[View file](/NC3-LU/TestingPlatform/blob/7b3e7ca869a4845aa7445f874c22c5929315c3a7/testing/helpers.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,45 +20,21 @@ |
|  |  | from weasyprint import CSS, HTML |
|  |  |  |
|  |  | from testing.models import TlsScanHistory |
|  |  | from testing.validators import domain\_name, full\_domain\_validator |
|  |  |  |
|  |  | from .cipher\_scoring import load\_cipher\_info |
|  |  |  |
|  |  | logger = logging.getLogger(\_\_name\_\_) |
|  |  |  |
|  |  |  |
|  |  | def full\_domain\_validator(hostname): |
|  |  | """ |
|  |  | Fully validates a domain name as compilant with the standard rules: |
|  |  | - Composed of series of labels concatenated with dots, as are all domain names. |
|  |  | - Each label must be between 1 and 63 characters long. |
|  |  | - The entire hostname (including the delimiting dots) has a maximum of 255 characters. |
|  |  | - Only characters 'a' through 'z' (in a case-insensitive manner), the digits '0' through '9'. |
|  |  | - Labels can't start or end with a hyphen. |
|  |  | """ |
|  |  | HOSTNAME\_LABEL\_PATTERN = re.compile(r"(?!-)[A-Z\d-]+(?<!-)$", re.IGNORECASE) |
|  |  | if not hostname: |
|  |  | return |
|  |  | if len(hostname) > 255: |
|  |  | raise Exception( |
|  |  | "The domain name cannot be composed of more than 255 characters." |
|  |  | ) |
|  |  | if hostname[-1:] == ".": |
|  |  | hostname = hostname[:-1] # strip exactly one dot from the right, if present |
|  |  | for label in hostname.split("."): |
|  |  | if len(label) > 63: |
|  |  | raise Exception( |
|  |  | "The label '%(label)s' is too long (maximum is 63 characters)." |
|  |  | % {"label": label} |
|  |  | ) |
|  |  | if not HOSTNAME\_LABEL\_PATTERN.match(label): |
|  |  | raise Exception(f"Unallowed characters in label '{label}'.") |
|  |  | return hostname |
|  |  |  |
|  |  |  |
|  |  | def get\_http\_report(target, rescan): |
|  |  | ################################ |
|  |  | # HTTP SCAN Mozilla Observatory |
|  |  | ################################ |
|  |  | try: |
|  |  | domain\_name(target) |
|  |  | except Exception: |
|  |  | return {"error": "You entered an invalid hostname!"} |
|  |  | response = {} |
|  |  |  |
|  |  | logger.info(f"http scan: scanning {target}, with rescan set to {rescan}") |
| Expand Down  Expand Up | | @@ -220,8 +196,12 @@ def get\_tls\_report(target, rescan): |
|  |  | return fetch\_tls |
|  |  |  |
|  |  |  |
|  |  | def check\_soa\_record(target: str) -> bool: |
|  |  | def check\_soa\_record(target: str) -> Union[bool, Dict]: |
|  |  | """Checks the presence of a SOA record for the Email Systems Testing.""" |
|  |  | try: |
|  |  | domain\_name(target) |
|  |  | except Exception: |
|  |  | return {"status": False, "statusmessage": "The given domain is invalid!"} |
|  |  | result = False |
|  |  | try: |
|  |  | answers = dns.resolver.query(target, "SOA") |
| Expand All | | @@ -235,6 +215,10 @@ def email\_check(target: str) -> Dict[str, Any]: |
|  |  | """Parses and validates MX, SPF, and DMARC records, |
|  |  | Checks for DNSSEC deployment, Checks for STARTTLS and TLS support. |
|  |  | Checks for the validity of the DKIM public key.""" |
|  |  | try: |
|  |  | domain\_name(target) |
|  |  | except Exception: |
|  |  | return {"status": False, "statusmessage": "The given domain is invalid!"} |
|  |  | result = {} |
|  |  | env = os.environ.copy() |
|  |  | cmd = [ |
| Expand Down  Expand Up | | @@ -498,6 +482,10 @@ def ipv6\_check( |
|  |  |  |
|  |  |  |
|  |  | def web\_server\_check(domain: str): |
|  |  | try: |
|  |  | domain\_name(domain) |
|  |  | except Exception: |
|  |  | return {"status": False, "statusmessage": "The given domain is invalid!"} |
|  |  | nmap = nmap3.Nmap() |
|  |  | logger.info(f"server scan: testing {domain}") |
|  |  | service\_scans = nmap.nmap\_version\_detection( |
| Expand Down  Expand Up | | @@ -540,6 +528,10 @@ def web\_server\_check(domain: str): |
|  |  |  |
|  |  |  |
|  |  | def web\_server\_check\_no\_raw\_socket(hostname): |
|  |  | try: |
|  |  | domain\_name(hostname) |
|  |  | except Exception: |
|  |  | return {"status": False, "statusmessage": "The given domain is invalid!"} |
|  |  | api\_endpoint = "https://vulners.com/api/v3/burp/software/" |
|  |  | header = { |
|  |  | "User-Agent": "Vulners NMAP Plugin 1.7", |
| Expand Down  Expand Up | | @@ -597,6 +589,10 @@ def tls\_version\_check(domain: str, service): |
|  |  | """ |
|  |  | Checks the version of TLS. |
|  |  | """ |
|  |  | try: |
|  |  | domain\_name(domain) |
|  |  | except Exception: |
|  |  | return {"status": False, "statusmessage": "The given domain is invalid!"} |
|  |  | nmap = nmap3.Nmap() |
|  |  | logger.info(f"tls scan: Scanning host/domain {domain}") |
|  |  | tls\_scans = nmap.nmap\_version\_detection(domain, args="--script ssl-enum-ciphers") |
| Expand Down  Expand Up | | @@ -660,6 +656,10 @@ def tls\_version\_check(domain: str, service): |
|  |  | def check\_dkim\_public\_key(domain: str, selectors: list): |
|  |  | """Looks for a DKIM public key in a DNS field and verifies that it can be used to |
|  |  | encrypt data.""" |
|  |  | try: |
|  |  | domain\_name(domain) |
|  |  | except Exception: |
|  |  | return {"status": False, "statusmessage": "The given domain is invalid!"} |
|  |  | if len(selectors) == 0: |
|  |  | # TODO Check to get proper selector or have a database of selectors |
|  |  | selectors = [ |
| Expand Down | |  |

52 changes: 52 additions & 0 deletions

52
[testing/validators.py](#diff-f125ab4f4c411acec1cf5469697dd001b0f0a2457306ad22cfe90e18596b9a0d "testing/validators.py")

Show comments

[View file](/NC3-LU/TestingPlatform/blob/7b3e7ca869a4845aa7445f874c22c5929315c3a7/testing/validators.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,52 @@ |
|  |  | import re |
|  |  |  |
|  |  | from rest\_framework.serializers import ValidationError |
|  |  |  |
|  |  | pattern = re.compile( |
|  |  | r"^(([a-zA-Z]{1})|([a-zA-Z]{1}[a-zA-Z]{1})|" |
|  |  | r"([a-zA-Z]{1}[0-9]{1})|([0-9]{1}[a-zA-Z]{1})|" |
|  |  | r"([a-zA-Z0-9][-\_.a-zA-Z0-9]{0,61}[a-zA-Z0-9]))\." |
|  |  | r"([a-zA-Z]{2,13}|[a-zA-Z0-9-]{2,30}.[a-zA-Z]{2,3})$" |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | def domain\_name(value): |
|  |  | """ |
|  |  | Return whether or not given value is a valid domain. |
|  |  | See: |
|  |  | https://validators.readthedocs.io/en/latest/\_modules/validators/domain.html#domain |
|  |  | """ |
|  |  | res = pattern.match(value) |
|  |  | if res: |
|  |  | return True |
|  |  | else: |
|  |  | raise ValidationError("This field must be a domain name.") |
|  |  |  |
|  |  |  |
|  |  | def full\_domain\_validator(hostname): |
|  |  | """ |
|  |  | Fully validates a domain name as compilant with the standard rules: |
|  |  | - Composed of series of labels concatenated with dots, as are all domain names. |
|  |  | - Each label must be between 1 and 63 characters long. |
|  |  | - The entire hostname (including the delimiting dots) has a maximum of 255 characters. |
|  |  | - Only characters 'a' through 'z' (in a case-insensitive manner), the digits '0' through '9'. |
|  |  | - Labels can't start or end with a hyphen. |
|  |  | """ |
|  |  | HOSTNAME\_LABEL\_PATTERN = re.compile(r"(?!-)[A-Z\d-]+(?<!-)$", re.IGNORECASE) |
|  |  | if not hostname: |
|  |  | return |
|  |  | if len(hostname) > 255: |
|  |  | raise Exception( |
|  |  | "The domain name cannot be composed of more than 255 characters." |
|  |  | ) |
|  |  | if hostname[-1:] == ".": |
|  |  | hostname = hostname[:-1] # strip exactly one dot from the right, if present |
|  |  | for label in hostname.split("."): |
|  |  | if len(label) > 63: |
|  |  | raise Exception( |
|  |  | "The label '%(label)s' is too long (maximum is 63 characters)." |
|  |  | % {"label": label} |
|  |  | ) |
|  |  | if not HOSTNAME\_LABEL\_PATTERN.match(label): |
|  |  | raise Exception(f"Unallowed characters in label '{label}'.") |
|  |  | return hostname |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7b3e7ca`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNC3-LU%2FTestingPlatform%2Fcommit%2F7b3e7ca869a4845aa7445f874c22c5929315c3a7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_69922457_20250111_170846.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNC3-LU%2FTestingPlatform%2Fsecurity%2Fadvisories%2FGHSA-mmpf-rw6c-67mm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNC3-LU%2FTestingPlatform%2Fsecurity%2Fadvisories%2FGHSA-mmpf-rw6c-67mm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=NC3-LU%2FTestingPlatform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NC3-LU](/NC3-LU)
/
**[TestingPlatform](/NC3-LU/TestingPlatform)**
Public

* [Notifications](/login?return_to=%2FNC3-LU%2FTestingPlatform) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FNC3-LU%2FTestingPlatform)
* [Star
   6](/login?return_to=%2FNC3-LU%2FTestingPlatform)

* [Code](/NC3-LU/TestingPlatform)
* [Issues
  0](/NC3-LU/TestingPlatform/issues)
* [Pull requests
  7](/NC3-LU/TestingPlatform/pulls)
* [Discussions](/NC3-LU/TestingPlatform/discussions)
* [Actions](/NC3-LU/TestingPlatform/actions)
* [Security](/NC3-LU/TestingPlatform/security)
* [Insights](/NC3-LU/TestingPlatform/pulse)

Additional navigation options

* [Code](/NC3-LU/TestingPlatform)
* [Issues](/NC3-LU/TestingPlatform/issues)
* [Pull requests](/NC3-LU/TestingPlatform/pulls)
* [Discussions](/NC3-LU/TestingPlatform/discussions)
* [Actions](/NC3-LU/TestingPlatform/actions)
* [Security](/NC3-LU/TestingPlatform/security)
* [Insights](/NC3-LU/TestingPlatform/pulse)

# Input for scanning can be any CIDR blocks passed to nmap

Critical

[cedricbonhomme](/cedricbonhomme)
published
GHSA-mmpf-rw6c-67mm
Nov 20, 2023

## Package

testing/helpers.py

## Affected versions

2.1.0

## Patched versions

2.1.1

## Description

### Summary

Input for scanning can be any CIDR blocks passed to nmap. You can scan 0.0.0.0/0 or even local networks.

### Details

No need for more details ;-)

### PoC

Fill the form for scanning.

### Impact

### Fix

The commit [7b3e7ca](https://github.com/NC3-LU/TestingPlatform/commit/7b3e7ca869a4845aa7445f874c22c5929315c3a7) fixes [GHSA-mmpf-rw6c-67mm](https://github.com/NC3-LU/TestingPlatform/security/advisories/GHSA-mmpf-rw6c-67mm "GHSA-mmpf-rw6c-67mm") and [GHSA-9fhc-f3mr-w6h6](https://github.com/NC3-LU/TestingPlatform/security/advisories/GHSA-9fhc-f3mr-w6h6 "GHSA-9fhc-f3mr-w6h6").

It's the same commit because the same security measure has been implemented (check of the user's input with a regular expression).

### Severity

Critical

### CVE ID

CVE-2023-48310

### Weaknesses

No CWEs

### Credits

* [![@adulau](https://avatars.githubusercontent.com/u/3309?s=40&v=4)](/adulau)
  [adulau](/adulau)
  Reporter
* [![@cedricbonhomme](https://avatars.githubusercontent.com/u/465400?s=40&v=4)](/cedricbonhomme)
  [cedricbonhomme](/cedricbonhomme)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_95b1c1d2_20250111_170845.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNC3-LU%2FTestingPlatform%2Freleases%2Ftag%2Fv2.1.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNC3-LU%2FTestingPlatform%2Freleases%2Ftag%2Fv2.1.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=NC3-LU%2FTestingPlatform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NC3-LU](/NC3-LU)
/
**[TestingPlatform](/NC3-LU/TestingPlatform)**
Public

* [Notifications](/login?return_to=%2FNC3-LU%2FTestingPlatform) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FNC3-LU%2FTestingPlatform)
* [Star
   6](/login?return_to=%2FNC3-LU%2FTestingPlatform)

* [Code](/NC3-LU/TestingPlatform/tree/v2.1.1)
* [Issues
  0](/NC3-LU/TestingPlatform/issues)
* [Pull requests
  7](/NC3-LU/TestingPlatform/pulls)
* [Discussions](/NC3-LU/TestingPlatform/discussions)
* [Actions](/NC3-LU/TestingPlatform/actions)
* [Security](/NC3-LU/TestingPlatform/security)
* [Insights](/NC3-LU/TestingPlatform/pulse)

Additional navigation options

* [Code](/NC3-LU/TestingPlatform/tree/v2.1.1)
* [Issues](/NC3-LU/TestingPlatform/issues)
* [Pull requests](/NC3-LU/TestingPlatform/pulls)
* [Discussions](/NC3-LU/TestingPlatform/discussions)
* [Actions](/NC3-LU/TestingPlatform/actions)
* [Security](/NC3-LU/TestingPlatform/security)
* [Insights](/NC3-LU/TestingPlatform/pulse)

1. [Releases](/NC3-LU/TestingPlatform/releases)
2. [v2.1.1](/NC3-LU/TestingPlatform/releases/tag/v2.1.1)

# Testing Platform 2.1.1

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/NC3-LU/TestingPlatform/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.1.1)

 Loading

[View all tags](/NC3-LU/TestingPlatform/tags)

![@cedricbonhomme](https://avatars.githubusercontent.com/u/465400?s=40&v=4)
[cedricbonhomme](/cedricbonhomme)
released this
20 Nov 22:25

·
[88 commits](/NC3-LU/TestingPlatform/compare/v2.1.1...main)
to main
since this release

[v2.1.1](/NC3-LU/TestingPlatform/tree/v2.1.1)

This tag was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/465400?s=64&v=4)](/cedricbonhomme)
[cedricbonhomme](/cedricbonhomme)
Cédric Bonhomme

GPG key ID: A1CB94DE57B7A70D

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`7714c2f`](/NC3-LU/TestingPlatform/commit/7714c2fb9a376a4e03048d55a0e27c6b7dfa936c)

This commit was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/465400?s=64&v=4)](/cedricbonhomme)
[cedricbonhomme](/cedricbonhomme)
Cédric Bonhomme

GPG key ID: A1CB94DE57B7A70D

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

Security fix ([GHSA-mmpf-rw6c-67mm](https://github.com/NC3-LU/TestingPlatform/security/advisories/GHSA-mmpf-rw6c-67mm) and [GHSA-9fhc-f3mr-w6h6](https://github.com/NC3-LU/TestingPlatform/security/advisories/GHSA-9fhc-f3mr-w6h6)): [7b3e7ca](https://github.com/NC3-LU/TestingPlatform/commit/7b3e7ca869a4845aa7445f874c22c5929315c3a7)

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


