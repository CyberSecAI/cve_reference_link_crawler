

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dave Jiang <dave.jiang@intel.com> | 2021-02-16 17:13:42 -0700 |
| --- | --- | --- |
| committer | Vinod Koul <vkoul@kernel.org> | 2021-04-12 13:26:03 +0530 |
| commit | [ea941ac294d75d0ace50797aebf0056f6f8f7a7f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f)) | |
| tree | [eee850638b0e6ecda1c6b3057bd390398f9971bb](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f) | |
| parent | [868833fbffbe51c487df4f95d4de9194264a4b30](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=868833fbffbe51c487df4f95d4de9194264a4b30) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f&id2=868833fbffbe51c487df4f95d4de9194264a4b30)) | |
| download | [linux-ea941ac294d75d0ace50797aebf0056f6f8f7a7f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ea941ac294d75d0ace50797aebf0056f6f8f7a7f.tar.gz) | |

dmaengine: idxd: Fix clobbering of SWERR overflow bit on writebackCurrent code blindly writes over the SWERR and the OVERFLOW bits. Write
back the bits actually read instead so the driver avoids clobbering the
OVERFLOW bit that comes after the register is read.
Fixes: bfe1d56091c1 ("dmaengine: idxd: Init and probe for Intel data accelerators")
Reported-by: Sanjay Kumar <sanjay.k.kumar@intel.com>
Signed-off-by: Dave Jiang <dave.jiang@intel.com>
Link: [https://lore.kernel.org/r/161352082229.3511254.1002151220537623503.stgit@djiang5-desk3.ch.intel.com](https://lore.kernel.org/r/161352082229.3511254.1002151220537623503.stgit%40djiang5-desk3.ch.intel.com)
Signed-off-by: Vinod Koul <vkoul@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f)

| -rw-r--r-- | [drivers/dma/idxd/irq.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma/idxd/irq.c?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 1 deletions

| diff --git a/drivers/dma/idxd/irq.c b/drivers/dma/idxd/irq.cindex a60ca11a5784a9..f1463fc581125a 100644--- a/[drivers/dma/idxd/irq.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/idxd/irq.c?id=868833fbffbe51c487df4f95d4de9194264a4b30)+++ b/[drivers/dma/idxd/irq.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma/idxd/irq.c?id=ea941ac294d75d0ace50797aebf0056f6f8f7a7f)@@ -124,7 +124,9 @@ static int process\_misc\_interrupts(struct idxd\_device \*idxd, u32 cause) for (i = 0; i < 4; i++) idxd->sw\_err.bits[i] = ioread64(idxd->reg\_base + IDXD\_SWERR\_OFFSET + i \* sizeof(u64));- iowrite64(IDXD\_SWERR\_ACK, idxd->reg\_base + IDXD\_SWERR\_OFFSET);++ iowrite64(idxd->sw\_err.bits[0] & IDXD\_SWERR\_ACK,+ idxd->reg\_base + IDXD\_SWERR\_OFFSET);  if (idxd->sw\_err.valid && idxd->sw\_err.wq\_idx\_valid) { int id = idxd->sw\_err.wq\_idx; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 17:31:25 +0000

