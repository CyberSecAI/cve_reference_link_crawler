

![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2023/11/07  Last Updated:2023/11/07
# JVN#29195731 EC-CUBE 3 series and 4 series vulnerable to arbitrary code execution

## Overview

EC-CUBE 3 series and 4 series provided by EC-CUBE CO.,LTD. contain an arbitrary code execution vulnerability.

## Products Affected

* EC-CUBE 4 series
  + EC-CUBE 4.0.0 to 4.0.6-p3
  + EC-CUBE 4.1.0 to 4.1.2-p2
  + EC-CUBE 4.2.0 to 4.2.2
* EC-CUBE 3 series
  + EC-CUBE 3.0.0 to 3.0.18-p6

## Description

EC-CUBE 3 series and 4 series provided by EC-CUBE CO.,LTD. contain an arbitrary code execution vulnerability ([CWE-94](https://cwe.mitre.org/data/definitions/94.html)) due to improper settings of the product's template engine "Twig".

## Impact

Arbitrary code may be executed on the server where the product is running by a user with an administrative privilege.

## Solution

**Update the software**

Update the software according to the information provided by the developer.

The developer has released EC-CUBE 4.2.3 that addresses this vulnerability.

**Apply the Workaround**

The developer has released the patches for the users who cannot apply the update.

For more information, refer to the information provided by the developer.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| EC-CUBE CO.,LTD. | [Vulnerable](491122/index.html) | 2023/11/07 | [EC-CUBE CO.,LTD. website](https://www.ec-cube.net/info/weakness/) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
Base Score:
7.2

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:L/Au:S/C:P/I:P/A:P
Base Score:
6.5

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Takeshi Miura of N.F.Laboratories Inc. reported this vulnerability to EC-CUBE CO.,LTD.

EC-CUBE CO.,LTD. Inc. reported this case to JPCERT/CC to notify users of its solution through JVN.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2023-46845](https://www.cve.org/CVERecord?id=CVE-2023-46845) |
| JVN iPedia | [JVNDB-2023-000107](https://jvndb.jvn.jp/jvndb/JVNDB-2023-000107) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2023 JPCERT/CC and IPA. All rights reserved.

