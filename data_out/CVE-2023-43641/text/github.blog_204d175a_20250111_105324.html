
[Skip to content](#start-of-content)
[Skip to sidebar](#sidebar)

/
[Blog](https://github.blog/)

* [Changelog](https://github.blog/changelog/)
* [Docs](https://docs.github.com/)
* [Customer stories](https://github.com/customer-stories)

[Use Copilot for free](https://github.com/features/copilot?utm_source=topnav&utm_medium=blog&utm_campaign=copilotfree)
[Contact sales](https://github.com/enterprise/contact?ref_cta=contact20sales&ref_loc=banner&ref_page=blog)

* [AI & ML](https://github.blog/ai-and-ml/)
  + [AI & ML](https://github.blog/ai-and-ml/)

    Learn about artificial intelligence and machine learning across the GitHub ecosystem and the wider industry.

    - [Generative AI](https://github.blog/ai-and-ml/generative-ai/)

      Learn how to build with generative AI.
    - [GitHub Copilot](https://github.blog/ai-and-ml/github-copilot/)

      Change how you work with GitHub Copilot.
    - [LLMs](https://github.blog/ai-and-ml/llms/)

      Everything developers need to know about LLMs.
    - [Machine learning](https://github.blog/ai-and-ml/machine-learning/)

      Machine learning tips, tricks, and best practices.
  + ![](https://github.blog/wp-content/uploads/2024/06/AI-DarkMode-4.png?resize=800%2C425)[How AI code generation works](https://github.blog/ai-and-ml/generative-ai/how-ai-code-generation-works/)

    Explore the capabilities and benefits of AI code generation and how it can improve your developer experience.

    Learn more
* [Developer skills](https://github.blog/developer-skills/)
  + [Developer skills](https://github.blog/developer-skills/)

    Resources for developers to grow in their skills and careers.

    - [Application development](https://github.blog/developer-skills/application-development/)

      Insights and best practices for building apps.
    - [Career growth](https://github.blog/developer-skills/career-growth/)

      Tips & tricks to grow as a professional developer.
    - [GitHub](https://github.blog/developer-skills/github/)

      Improve how you use GitHub at work.
    - [GitHub Education](https://github.blog/developer-skills/github-education/)

      Learn how to move into your first professional role.
    - [Programming languages & frameworks](https://github.blog/developer-skills/programming-languages-and-frameworks/)

      Stay current on what’s new (or new again).
  + ![](https://github.blog/wp-content/uploads/2024/05/Enterprise-DarkMode-3.png?resize=800%2C425)[Get started with GitHub documentation](https://docs.github.com/en/get-started)

    Learn how to start building, shipping, and maintaining software with GitHub.

    Learn more
* [Engineering](https://github.blog/engineering/)
  + [Engineering](https://github.blog/engineering/)

    Get an inside look at how we’re building the home for all developers.

    - [Architecture & optimization](https://github.blog/engineering/architecture-optimization/)

      Discover how we deliver a performant and highly available experience across the GitHub platform.
    - [Engineering principles](https://github.blog/engineering/engineering-principles/)

      Explore best practices for building software at scale with a majority remote team.
    - [Infrastructure](https://github.blog/engineering/infrastructure/)

      Get a glimpse at the technology underlying the world’s leading AI-powered developer platform.
    - [Platform security](https://github.blog/engineering/platform-security/)

      Learn how we build security into everything we do across the developer lifecycle.
    - [User experience](https://github.blog/engineering/user-experience/)

      Find out what goes into making GitHub the home for all developers.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.42.45 AM.png?resize=800%2C425)[How we use GitHub to be more productive, collaborative, and secure](https://github.blog/engineering/how-we-use-github-to-be-more-productive-collaborative-and-secure/)

    Our engineering and security teams do some incredible work. Let’s take a look at how we use GitHub to be more productive, build collaboratively, and shift security left.

    Learn more
* [Enterprise software](https://github.blog/enterprise-software/)
  + [Enterprise software](https://github.blog/enterprise-software/)

    Explore how to write, build, and deploy enterprise software at scale.

    - [Automation](https://github.blog/enterprise-software/automation/)

      Automating your way to faster and more secure ships.
    - [CI/CD](https://github.blog/enterprise-software/ci-cd/)

      Guides on continuous integration and delivery.
    - [Collaboration](https://github.blog/enterprise-software/collaboration/)

      Tips, tools, and tricks to improve developer collaboration.
    - [DevOps](https://github.blog/enterprise-software/devops/)

      DevOps resources for enterprise engineering teams.
    - [DevSecOps](https://github.blog/enterprise-software/devsecops/)

      How to integrate security into the SDLC.
    - [Governance & compliance](https://github.blog/enterprise-software/governance-and-compliance/)

      Ensuring your builds stay clean.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.43.47 AM.png?resize=800%2C425)[How enterprise engineering teams can successfully adopt AI](https://resources.github.com/artificial-intelligence/how-enterprise-engineering-teams-can-successfully-adopt-ai/)

    Learn how to bring AI to your engineering teams and maximize the value that you get from it.

    Learn more
* [News & insights](https://github.blog/news-insights/)
  + [News & insights](https://github.blog/news-insights/)

    Keep up with what’s new and notable from inside GitHub.

    - [Company news](https://github.blog/news-insights/company-news/)

      An inside look at news and product updates from GitHub.
    - [Product](https://github.blog/news-insights/product-news/)

      The latest on GitHub’s platform, products, and tools.
    - [Octoverse](https://github.blog/news-insights/octoverse/)

      Insights into the state of open source on GitHub.
    - [Policy](https://github.blog/news-insights/policy-news-and-insights/)

      The latest policy and regulatory changes in software.
    - [Research](https://github.blog/news-insights/research/)

      Data-driven insights around the developer ecosystem.
    - [The library](https://github.blog/news-insights/the-library/)

      Older news and updates from GitHub.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.44.23 AM.png?resize=800%2C425)[Unlocking the power of unstructured data with RAG](https://github.blog/ai-and-ml/llms/unlocking-the-power-of-unstructured-data-with-rag/)

    Learn how to use retrieval-augmented generation (RAG) to capture more insights.

    Learn more
* [Open Source](https://github.blog/open-source/)
  + [Open Source](https://github.blog/open-source/)

    Everything open source on GitHub.

    - [Git](https://github.blog/open-source/git/)

      The latest Git updates.
    - [Maintainers](https://github.blog/open-source/maintainers/)

      Spotlighting open source maintainers.
    - [Social impact](https://github.blog/open-source/social-impact/)

      How open source is driving positive change.
    - [Gaming](https://github.blog/open-source/gaming/)

      Explore open source games on GitHub.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.46.23 AM.png?resize=800%2C425)[An introduction to innersource](https://resources.github.com/software-development/innersource/)

    Organizations worldwide are incorporating open source methodologies into the way they build and ship their own software.

    Learn more
* [Security](https://github.blog/security/)
  + [Security](https://github.blog/security/)

    Stay up to date on everything security.

    - [Application security](https://github.blog/security/application-security/)

      Application security, explained.
    - [Supply chain security](https://github.blog/security/supply-chain-security/)

      Demystifying supply chain security.
    - [Vulnerability research](https://github.blog/security/vulnerability-research/)

      Updates from the GitHub Security Lab.
    - [Web application security](https://github.blog/security/web-application-security/)

      Helpful tips on securing web applications.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.47.04 AM.png?resize=800%2C425)[The enterprise guide to AI-powered DevSecOps](https://resources.github.com/security/the-enterprise-guide-to-ai-powered-devsecops/)

    Learn about core challenges in DevSecOps, and how you can start addressing them with AI and automation.

    Learn more

Search

## Categories

* [AI & ML](https://github.blog/ai-and-ml/)
  + Back[AI & ML](https://github.blog/ai-and-ml/)

    Learn about artificial intelligence and machine learning across the GitHub ecosystem and the wider industry.

    - [Generative AI](https://github.blog/ai-and-ml/generative-ai/)

      Learn how to build with generative AI.
    - [GitHub Copilot](https://github.blog/ai-and-ml/github-copilot/)

      Change how you work with GitHub Copilot.
    - [LLMs](https://github.blog/ai-and-ml/llms/)

      Everything developers need to know about LLMs.
    - [Machine learning](https://github.blog/ai-and-ml/machine-learning/)

      Machine learning tips, tricks, and best practices.
  + [How AI code generation works](https://github.blog/ai-and-ml/generative-ai/how-ai-code-generation-works/)

    Explore the capabilities and benefits of AI code generation and how it can improve your developer experience.

    [Learn more](https://github.blog/ai-and-ml/generative-ai/how-ai-code-generation-works/)
* [Developer skills](https://github.blog/developer-skills/)
  + Back[Developer skills](https://github.blog/developer-skills/)

    Resources for developers to grow in their skills and careers.

    - [Application development](https://github.blog/developer-skills/application-development/)

      Insights and best practices for building apps.
    - [Career growth](https://github.blog/developer-skills/career-growth/)

      Tips & tricks to grow as a professional developer.
    - [GitHub](https://github.blog/developer-skills/github/)

      Improve how you use GitHub at work.
    - [GitHub Education](https://github.blog/developer-skills/github-education/)

      Learn how to move into your first professional role.
    - [Programming languages & frameworks](https://github.blog/developer-skills/programming-languages-and-frameworks/)

      Stay current on what’s new (or new again).
  + [Get started with GitHub documentation](https://docs.github.com/en/get-started)

    Learn how to start building, shipping, and maintaining software with GitHub.

    [Learn more](https://docs.github.com/en/get-started)
* [Engineering](https://github.blog/engineering/)
  + Back[Engineering](https://github.blog/engineering/)

    Get an inside look at how we’re building the home for all developers.

    - [Architecture & optimization](https://github.blog/engineering/architecture-optimization/)

      Discover how we deliver a performant and highly available experience across the GitHub platform.
    - [Engineering principles](https://github.blog/engineering/engineering-principles/)

      Explore best practices for building software at scale with a majority remote team.
    - [Infrastructure](https://github.blog/engineering/infrastructure/)

      Get a glimpse at the technology underlying the world’s leading AI-powered developer platform.
    - [Platform security](https://github.blog/engineering/platform-security/)

      Learn how we build security into everything we do across the developer lifecycle.
    - [User experience](https://github.blog/engineering/user-experience/)

      Find out what goes into making GitHub the home for all developers.
  + [How we use GitHub to be more productive, collaborative, and secure](https://github.blog/engineering/how-we-use-github-to-be-more-productive-collaborative-and-secure/)

    Our engineering and security teams do some incredible work. Let’s take a look at how we use GitHub to be more productive, build collaboratively, and shift security left.

    [Learn more](https://github.blog/engineering/how-we-use-github-to-be-more-productive-collaborative-and-secure/)
* [Enterprise software](https://github.blog/enterprise-software/)
  + Back[Enterprise software](https://github.blog/enterprise-software/)

    Explore how to write, build, and deploy enterprise software at scale.

    - [Automation](https://github.blog/enterprise-software/automation/)

      Automating your way to faster and more secure ships.
    - [CI/CD](https://github.blog/enterprise-software/ci-cd/)

      Guides on continuous integration and delivery.
    - [Collaboration](https://github.blog/enterprise-software/collaboration/)

      Tips, tools, and tricks to improve developer collaboration.
    - [DevOps](https://github.blog/enterprise-software/devops/)

      DevOps resources for enterprise engineering teams.
    - [DevSecOps](https://github.blog/enterprise-software/devsecops/)

      How to integrate security into the SDLC.
    - [Governance & compliance](https://github.blog/enterprise-software/governance-and-compliance/)

      Ensuring your builds stay clean.
  + [How enterprise engineering teams can successfully adopt AI](https://resources.github.com/artificial-intelligence/how-enterprise-engineering-teams-can-successfully-adopt-ai/)

    Learn how to bring AI to your engineering teams and maximize the value that you get from it.

    [Learn more](https://resources.github.com/artificial-intelligence/how-enterprise-engineering-teams-can-successfully-adopt-ai/)
* [News & insights](https://github.blog/news-insights/)
  + Back[News & insights](https://github.blog/news-insights/)

    Keep up with what’s new and notable from inside GitHub.

    - [Company news](https://github.blog/news-insights/company-news/)

      An inside look at news and product updates from GitHub.
    - [Product](https://github.blog/news-insights/product-news/)

      The latest on GitHub’s platform, products, and tools.
    - [Octoverse](https://github.blog/news-insights/octoverse/)

      Insights into the state of open source on GitHub.
    - [Policy](https://github.blog/news-insights/policy-news-and-insights/)

      The latest policy and regulatory changes in software.
    - [Research](https://github.blog/news-insights/research/)

      Data-driven insights around the developer ecosystem.
    - [The library](https://github.blog/news-insights/the-library/)

      Older news and updates from GitHub.
  + [Unlocking the power of unstructured data with RAG](https://github.blog/ai-and-ml/llms/unlocking-the-power-of-unstructured-data-with-rag/)

    Learn how to use retrieval-augmented generation (RAG) to capture more insights.

    [Learn more](https://github.blog/ai-and-ml/llms/unlocking-the-power-of-unstructured-data-with-rag/)
* [Open Source](https://github.blog/open-source/)
  + Back[Open Source](https://github.blog/open-source/)

    Everything open source on GitHub.

    - [Git](https://github.blog/open-source/git/)

      The latest Git updates.
    - [Maintainers](https://github.blog/open-source/maintainers/)

      Spotlighting open source maintainers.
    - [Social impact](https://github.blog/open-source/social-impact/)

      How open source is driving positive change.
    - [Gaming](https://github.blog/open-source/gaming/)

      Explore open source games on GitHub.
  + [An introduction to innersource](https://resources.github.com/software-development/innersource/)

    Organizations worldwide are incorporating open source methodologies into the way they build and ship their own software.

    [Learn more](https://resources.github.com/software-development/innersource/)
* [Security](https://github.blog/security/)
  + Back[Security](https://github.blog/security/)

    Stay up to date on everything security.

    - [Application security](https://github.blog/security/application-security/)

      Application security, explained.
    - [Supply chain security](https://github.blog/security/supply-chain-security/)

      Demystifying supply chain security.
    - [Vulnerability research](https://github.blog/security/vulnerability-research/)

      Updates from the GitHub Security Lab.
    - [Web application security](https://github.blog/security/web-application-security/)

      Helpful tips on securing web applications.
  + [The enterprise guide to AI-powered DevSecOps](https://resources.github.com/security/the-enterprise-guide-to-ai-powered-devsecops/)

    Learn about core challenges in DevSecOps, and how you can start addressing them with AI and automation.

    [Learn more](https://resources.github.com/security/the-enterprise-guide-to-ai-powered-devsecops/)

* [Changelog](https://github.blog/changelog/)
* [Docs](https://docs.github.com/)
* [Customer stories](https://github.com/customer-stories)

[Contact sales](https://github.com/enterprise/contact?ref_cta=contact20sales&ref_loc=banner&ref_page=blog)
[Use Copilot for free](https://github.com/features/copilot?utm_source=topnav&utm_medium=blog&utm_campaign=copilotfree)

[Home](https://github.blog/) / [Security](https://github.blog/security/) / [Vulnerability research](https://github.blog/security/vulnerability-research/)
# Coordinated Disclosure: 1-Click RCE on GNOME (CVE-2023-43641)

CVE-2023-43641 is a vulnerability in libcue, which can lead to code execution by downloading a file on GNOME.

![](https://github.blog/wp-content/uploads/2023/10/Security-DarkMode-4.png?resize=1200%2C630)

[Kevin Backhouse](https://github.blog/author/kevinbackhouse/ "Posts by Kevin Backhouse")·[@kevinbackhouse](https://github.com/kevinbackhouse)

October 9, 2023
|

8 minutes

* Share:

Today, in coordination with [Ilya Lipnitskiy](https://github.com/lipnitsk) (the maintainer of libcue) and the [distros mailing list](https://oss-security.openwall.org/wiki/mailing-lists/distros), the GitHub Security Lab is disclosing [CVE-2023-43641](https://github.com/lipnitsk/libcue/security/advisories/GHSA-5982-x7hv-r9cj), a memory corruption vulnerability in [libcue](https://github.com/lipnitsk/libcue). We have also sent a text-only version of this blog post to the [oss-security list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

It’s quite likely that you have never heard of libcue before, and are wondering why it’s important. This situation is neatly illustrated by [xkcd 2347](https://xkcd.com/2347/):

[![](https://i0.wp.com/imgs.xkcd.com/comics/dependency.png?resize=385%2C489&ssl=1)](https://xkcd.com/2347/)

libcue is a library used for parsing [cue sheets](https://en.wikipedia.org/wiki/Cue_sheet_%28computing%29)—a metadata format for describing the layout of the tracks on a CD. Cue sheets are often used in combination with the [FLAC](https://en.wikipedia.org/wiki/FLAC) audio file format, which means that libcue is a dependency of some audio players, such as [Audacious](https://audacious-media-player.org/). But the reason why I decided to audit libcue for security vulnerabilities is that it’s used by [tracker-miners](https://gitlab.gnome.org/GNOME/tracker-miners): an application that’s included with [GNOME](https://www.gnome.org/)—the default graphical desktop environment of many open source operating systems.[1](#fn-74613-1 "Read footnote.") The purpose of tracker-miners is to index the files in your home directory to make them easily searchable. For example, the index is used by this search bar:

![](https://github.blog/wp-content/uploads/2023/10/rickastley.png?w=1024&resize=1024%2C576)

The index is automatically updated when you add or modify a file in certain subdirectories of your home directory, in particular including `~/Downloads`. To make a long story short, that means that inadvertently clicking a malicious link is all it takes for an attacker to exploit CVE-2023-43641 and get code execution on your computer:

<https://github.blog/wp-content/uploads/2023/10/CVE-2023-43641-poc.mp4#t=0.001>

The video shows me clicking a link in a webpage[2](#fn-74613-2 "Read footnote."), which causes a cue sheet to be downloaded. Because the file is saved to `~/Downloads`, it is then automatically scanned by tracker-miners. And because it has a `.cue` filename extension, tracker-miners uses libcue to parse the file. The file exploits the vulnerability in libcue to gain code execution and pop a calculator. Cue sheets are just one of [many](https://gitlab.gnome.org/GNOME/tracker-miners/-/tree/83054c8c145f12c83289e6c424f55b87a5b609d9/src/tracker-extract) file formats supported by tracker-miners. For example, it also includes scanners for [HTML](https://gitlab.gnome.org/GNOME/tracker-miners/-/blob/83054c8c145f12c83289e6c424f55b87a5b609d9/src/tracker-extract/tracker-extract-html.c), [JPEG](https://gitlab.gnome.org/GNOME/tracker-miners/-/blob/83054c8c145f12c83289e6c424f55b87a5b609d9/src/tracker-extract/tracker-extract-jpeg.c), and [PDF](https://gitlab.gnome.org/GNOME/tracker-miners/-/blob/83054c8c145f12c83289e6c424f55b87a5b609d9/src/tracker-extract/tracker-extract-pdf.c).

I am delaying publication of the proof of concept (PoC) used in the video, to give users time to install the patch. But if you’d like to test if your system is vulnerable, try downloading [this file](https://github.com/github/securitylab/blob/3cb0ebc37170149ef5e91a3bd641631c4eeedd06/SecurityExploits/libcue/track_set_index_CVE-2023-43641/CVE-2023-43641-poc-simple.cue), which contains a much simpler version of the PoC that merely causes a (benign) crash.

The offsets in the full PoC need to be tuned for different distributions. I have *only* done this for Ubuntu 23.04 and Fedora 38, the most recent releases of [Ubuntu](https://ubuntu.com/) and [Fedora](https://fedoraproject.org/) at this time. In my testing, I have found that the PoC works very reliably when run on the correct distribution (and will trigger a SIGSEGV when run on the wrong distribution). I have not created PoCs for any other distributions, but I believe that all distributions that run GNOME are potentially exploitable.

## The bug in libcue

libcue is quite a small project. It’s primarily a [bison](https://www.gnu.org/software/bison) grammar for cue sheets, with a few data structures for storing the parsed data. A simple example of a cue sheet looks like this:

```
REM GENRE "Pop, dance pop"
REM DATE 1987
PERFORMER "Rick Astley"
TITLE "Whenever You Need Somebody"
FILE "Whenever You Need Somebody.mp3" MP3
  TRACK 01 AUDIO
    TITLE "Never Gonna Give You Up"
    PERFORMER "Rick Astley"
    SONGWRITER "Mike Stock, Matt Aitken, Pete Waterman"
    INDEX 01 00:00:00
  TRACK 02 AUDIO
    TITLE "Whenever You Need Somebody"
    PERFORMER "Rick Astley"
    SONGWRITER "Mike Stock, Matt Aitken, Pete Waterman"
    INDEX 01 03:35:00

```

The vulnerability is in the handling of the `INDEX` syntax. Replacing one of those `INDEX` statements with this will trigger the bug:

```
INDEX 4294567296 0

```

There are two parts to the problem. The first is that the scanner ([cue\_scanner.l, line 132](https://github.com/lipnitsk/libcue/blob/1b0f3917b8f908c81bb646ce42f29cf7c86443a1/cue_scanner.l#L132)) uses `[atoi](https://manpages.ubuntu.com/manpages/jammy/en/man3/atoi.3.html)` to scan the integers:

```
[[:digit:]]+    { yylval.ival = atoi(yytext); return NUMBER; }

```

`atoi` does not check for integer overflow, so it is easy to construct a negative index. For example, 4294567296 is converted to -400000 by `atoi`.

The second part of the problem (and this is the actual vulnerability) is that `[track_set_index](https://github.com/lipnitsk/libcue/blob/1b0f3917b8f908c81bb646ce42f29cf7c86443a1/cd.c#L340-L348)` does not check that `i ≥ 0`:

```
void track_set_index(Track *track, int i, long ind)
{
    if (i > MAXINDEX) {
        fprintf(stderr, "too many indexes\n");
                return;
    }

    track->index[i] = ind;
}

```

If `i` is negative, then this code can write to an address outside the bounds of the array. Since the value of `ind` is also attacker-controlled, this is a very powerful vulnerability.

The bug is simple to fix by adding an extra condition to the if-statement in `track_set_index`. This is the proposed patch:

```
diff --git a/cd.c b/cd.c
index cf77a18..4bbea19 100644
--- a/cd.c
+++ b/cd.c
@@ -339,7 +339,7 @@ track_get_rem(const Track* track)

 void track_set_index(Track *track, int i, long ind)
 {
-       if (i > MAXINDEX) {
+       if (i < 0 || i > MAXINDEX) {
                fprintf(stderr, "too many indexes\n");
                return;
        }

```
## More about tracker-miners

I want to be clear that this bug is *not* a vulnerability in tracker-miners. But I have focused on tracker-miners because it magnifies the impact of this bug due to the way that it automatically scans the files in your `~/Downloads` directory.

tracker-miners consists of two processes:

1. tracker-miner-fs
2. tracker-extract

The first, tracker-miner-fs, is a background process which is always running, whereas the second, tracker-extract, is only started on demand to scan new files. tracker-miner-fs uses [inotify](https://manpages.ubuntu.com/manpages/jammy/en/man7/inotify.7.html) to monitor specific directories, such as `~/Downloads`, `~/Music`, and `~/Videos`. When a new file is created, it launches tracker-extract to scan the file. tracker-extract sends the results back to tracker-miner-fs (which maintains the index) and then usually shuts down again after a few seconds. The vulnerability only affects tracker-extract, because that’s where libcue is used. Both processes run as the current user, so this vulnerability would need to be chained with a separate privilege escalation vulnerability for an attacker to gain admin privileges.

The vulnerability will not trigger if tracker-miners is not running. To check if it is, I use the command `ps aux | grep track`. It usually shows that tracker-miner-fs is running and that tracker-extract isn’t. If *neither* is running (which I think is rare), then using the search bar (press the “super” key and type something) should automatically restart tracker-miner-fs. As far as I know, tracker-miners is quite tightly integrated into GNOME, so there’s no easy way to switch it off. There’s certainly nothing like a simple checkbox in the settings dialog. There’s some discussion [here](https://askubuntu.com/a/1187273) about how to switch it off by modifying your systemd configuration.

The two-process architecture of tracker-miners is helpful for exploitation. Firstly, it’s much easier to predict the memory layout in a freshly started process than in one that’s already been running for hours, so the fact that tracker-extract is only started on-demand is very convenient. Even better, tracker-extract always creates a fresh thread to scan the downloaded file, and I’ve found that the heap layout in the thread’s malloc arena is *very* consistent: it varies between distributions, so, for example, Ubuntu 23.04 has a slightly different layout than Fedora 38, but on the same distribution the layout is identical every single time. Secondly, because tracker-extract is restarted on demand, an attacker could potentially crash it many times until their exploit succeeds. Due to the consistency of the heap layout, I’ve found that my exploit works very reliably without needing to use this, but I could imagine an attacker loading a zip file with thousands of copies of their exploit to increase their chance of success when the victim unzips the download.

### tracker-miners seccomp sandbox escape

The difficult part of exploiting this vulnerability was finding a way to bypass [ASLR](https://en.wikipedia.org/wiki/Address_space_layout_randomization). But what I *didn’t* realize when I started writing the PoC, is that tracker-extract also has a [seccomp sandbox](https://gitlab.gnome.org/GNOME/tracker-miners/-/blob/83054c8c145f12c83289e6c424f55b87a5b609d9/src/libtracker-miners-common/tracker-seccomp.c) which is intended to prevent this kind of exploit from working. It was a nasty surprise when I thought I had all the pieces in place for a working PoC and it failed with the error message: `Disallowed syscall "close_range" caught in sandbox`. But I still failed to understand that I was attempting a sandbox escape here. I just thought I needed to take a different code path that didn’t use the `close_range` function. So I tried a different route, it worked, and I didn’t give it any more thought until the GNOME developers asked how I’d managed to escape the sandbox. It turned out that I’d discovered the escape entirely by accident: while I was working on the new route, I unwittingly made a change to the PoC that solved it. I have since discovered that I could have got the original PoC working with a one-line change. I’ll go into more detail on this in a follow-up blog post when I publish the PoC, but for now I’ll just mention that, in response to this, [Carlos Garnacho](https://gitlab.gnome.org/carlosg) has very quickly implemented [some changes](https://gitlab.gnome.org/GNOME/tracker-miners/-/commit/f0c880a0ec0e650dbdc037c59e58e07442f82fef) to strengthen the sandbox, which will prevent this exploitation path from working in the future.

## Conclusion

Sometimes a vulnerability in a seemingly innocuous library can have a large impact. Due to the way that it’s used by tracker-miners, this vulnerability in libcue became a 1-click RCE. If you use GNOME, please update today!

I’m delaying the release of the full PoC to give users time to install the update, but planning to publish a follow-up blog post soon with details of how the full PoC works. Save an unpatched VM with Ubuntu 23.04 or Fedora 38 if you’d like to test the full PoC when I release it.

#### Notes

---

1. I currently run Ubuntu 23.04 as my main OS and I *love* the GNOME desktop environment. [↩](#fnref-74613-1 "Return to main content.")
2. The webpage in the video is [https://bugs.launchpad.net/ubuntu/+source/libcue/+bug/2036595](https://bugs.launchpad.net/ubuntu/%2Bsource/libcue/%2Bbug/2036595), which is where I first notified Ubuntu’s security team about this vulnerability. They suggested that I contact the distros list. [↩](#fnref-74613-2 "Return to main content.")

---

## Written by

![Kevin Backhouse](https://avatars.githubusercontent.com/u/4358136?v=4&s=200)

### [Kevin Backhouse](https://github.blog/author/kevinbackhouse/)

[@kevinbackhouse](https://github.com/kevinbackhouse)

I'm a security researcher on the GitHub Security Lab team. I try to help make open source software more secure by searching for vulnerabilities and working with maintainers to get them fixed.

* [GitHub Security Lab](https://github.blog/tag/github-security-lab/)

## More on [GitHub Security Lab](https://github.blog/tag/github-security-lab/)

### [How to secure your GitHub Actions workflows with CodeQL](https://github.blog/security/application-security/how-to-secure-your-github-actions-workflows-with-codeql/)

In the last few months, we secured 75+ GitHub Actions workflows in open source projects, disclosing 90+ different vulnerabilities. Out of this research we produced new support for workflows in CodeQL, empowering you to secure yours.

[Alvaro Munoz](https://github.blog/author/pwntester/ "Posts by Alvaro Munoz")

### [Announcing CodeQL Community Packs](https://github.blog/security/vulnerability-research/announcing-codeql-community-packs/)

We are excited to introduce the new CodeQL Community Packs, a comprehensive set of queries and models designed to enhance your code analysis capabilities. These packs are tailored to augment…

[Alvaro Munoz](https://github.blog/author/pwntester/ "Posts by Alvaro Munoz")

## Related posts

![](https://github.blog/wp-content/uploads/2023/12/Security-DarkMode-1.png?resize=400%2C212)
[Application security](https://github.blog/security/application-security/)
### [How to secure your GitHub Actions workflows with CodeQL](https://github.blog/security/application-security/how-to-secure-your-github-actions-workflows-with-codeql/)

In the last few months, we secured 75+ GitHub Actions workflows in open source projects, disclosing 90+ different vulnerabilities. Out of this research we produced new support for workflows in CodeQL, empowering you to secure yours.

[Alvaro Munoz](https://github.blog/author/pwntester/ "Posts by Alvaro Munoz")

![](https://github.blog/wp-content/uploads/2024/01/Security-DarkMode-1.png?resize=400%2C212)
[Security](https://github.blog/security/)
### [Announcing CodeQL Community Packs](https://github.blog/security/vulnerability-research/announcing-codeql-community-packs/)

We are excited to introduce the new CodeQL Community Packs, a comprehensive set of queries and models designed to enhance your code analysis capabilities. These packs are tailored to augment…

[Alvaro Munoz](https://github.blog/author/pwntester/ "Posts by Alvaro Munoz")

![](https://github.blog/wp-content/uploads/2024/02/Security-LightMode-1-1.png?resize=400%2C212)
[Security](https://github.blog/security/)
### [Uncovering GStreamer secrets](https://github.blog/security/vulnerability-research/uncovering-gstreamer-secrets/)

In this post, I’ll walk you through the vulnerabilities I uncovered in the GStreamer library and how I built a custom fuzzing generator to target MP4 files.

[Antonio Morales](https://github.blog/author/antoniomorales/ "Posts by Antonio Morales")

## Explore more from GitHub

![Docs](https://github.blog/wp-content/uploads/2024/07/Icon-Circle.svg)
### Docs

Everything you need to master GitHub, all in one place.

[Go to Docs](https://docs.github.com/)

![GitHub Universe 2023](https://github.blog/wp-content/uploads/2023/08/Icon-Circle.svg)
### GitHub Universe 2023

Get free virtual tickets to the global developer event for AI, security, and DevEx.

[Get free tickets](https://githubuniverse.com/)

![GitHub Copilot](https://github.blog/wp-content/uploads/2022/05/Copilot_Blog_Icon-1.svg)
### GitHub Copilot

Don’t fly solo. Try 30 days for free.

[Learn more](https://github.blog/ai-and-ml/github-copilot/)

![Work at GitHub!](https://github.blog/wp-content/uploads/2022/05/careers.svg)
### Work at GitHub!

Check out our current job openings.

[Apply now](https://www.github.careers/careers-home)

## We do newsletters, too

Discover tips, technical guides, and best practices in our biweekly newsletter just for devs.

Your email address

Subscribe

Yes please, I’d like GitHub and affiliates to use my information for personalized communications, targeted advertising and campaign effectiveness. See the [GitHub Privacy Statement](https://github.com/site/privacy) for more details.

Subscribe

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Enterprise](https://github.com/enterprise)
* [Customer Stories](https://github.com/customer-stories?type=enterprise)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com/)
## Platform

* [Developer API](https://developer.github.com/)
* [Partners](https://partner.github.com/)
* [Atom](https://atom.io/)
* [Electron](https://www.electronjs.org/)
* [GitHub Desktop](https://desktop.github.com/)
## Support

* [Docs](https://docs.github.com/)
* [Community Forum](https://github.community/)
* [Training](https://services.github.com/)
* [Status](https://www.githubstatus.com/)
* [Contact](https://support.github.com/)
## Company

* [About](https://github.com/about)
* [Blog](https://github.blog/)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Shop](https://shop.github.com/)

* [LinkedIn icon

  GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram icon

  GitHub on Instagram](https://www.instagram.com/github/)
* [YouTube icon

  GitHub on YouTube](https://www.youtube.com/github)
* [X icon

  GitHub on X](https://twitter.com/github)
* [TikTok icon

  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch icon

  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub icon

  GitHub’s organization on GitHub](https://github.com/github)

* © 2025 GitHub, Inc.
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Manage Cookies
* Do not share my personal information

