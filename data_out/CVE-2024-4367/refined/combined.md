=== Content from seclists.org_c619af82_20250111_023947.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](36)
[By Date](date.html#30)
[![Next](/images/right-icon-16x16.png)](37)

[![Previous](/images/left-icon-16x16.png)](36)
[By Thread](index.html#30)
[![Next](/images/right-icon-16x16.png)](37)

![](/shared/images/nst-icons.svg#search)

# OXAS-ADV-2024-0004: OX App Suite Security Advisory

---

*From*: Martin Heiland via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Mon, 19 Aug 2024 09:34:00 +0200 (CEST)

---

```
Dear subscribers,

We're sharing our latest advisory with you and like to thank everyone who contributed in finding and solving those
vulnerabilities. Feel free to join our bug bounty programs for OX App Suite, Dovecot and PowerDNS at YesWeHack.

This advisory has also been published at
<https://documentation.open-xchange.com/appsuite/security/advisories/html/2024/oxas-adv-2024-0004.html>.

Yours sincerely,
 Martin Heiland, Open-Xchange GmbH

Classification: TLP:GREEN

Internal reference: appsuite/web-apps/ui/-/issues/372
Type: CWE-80 (Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS))
Component: frontend
Report confidence: Confirmed
Solution status: Fixed by vendor
Last affected revision: OX App Suite frontend 7.10.6-rev44
First fixed revision: OX App Suite frontend 7.10.6-rev45
Discovery date: 2024-06-08
Solution date: 2024-06-13
CVE: CVE-2024-4367
CVSS: 6.1 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

Details:
Arbitrary JavaScript execution in PDF.js. Arbitrary JavaScript execution in PDF.js.

Risk:
This update provides safe configuration of a third-party component as a preventive measure to avoid exploitation in the
context of OX App Suite. Exploits for this vulnerability are publicly available.

Solution:
Please deploy the provided updates and patch releases. The relevant components have been updated to mitigate potential
exploitation.

```

**Attachment:
[signature.asc](att-30/signature_asc.bin)**

*Description:*

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](36)
[By Date](date.html#30)
[![Next](/images/right-icon-16x16.png)](37)

[![Previous](/images/left-icon-16x16.png)](36)
[By Thread](index.html#30)
[![Next](/images/right-icon-16x16.png)](37)

### Current thread:

* **OXAS-ADV-2024-0004: OX App Suite Security Advisory** *Martin Heiland via Fulldisclosure (Aug 22)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from lists.debian.org_09d8e427_20250111_023949.html ===


---

[[Date Prev](msg00011.html)][[Date Next](msg00013.html)]
[[Thread Prev](msg00011.html)][[Thread Next](msg00013.html)]
[[Date Index](maillist.html#00012)]
[[Thread Index](threads.html#00012)]

# [SECURITY] [DLA 3817-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3817-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Mon, 20 May 2024 10:14:55 +0200
* *Message-id*: <[[üîé]](/msgid-search/20240520081455.236B22AE29F%40andromeda)¬†[20240520081455.236B22AE29F@andromeda](msg00012.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3817-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
May 20, 2024                                  <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.11.0-1~deb10u1
CVE ID         : CVE-2024-4367 CVE-2024-4767 CVE-2024-4768 CVE-2024-4769
                 CVE-2024-4770 CVE-2024-4777

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:115.11.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmZLBnwACgkQnUbEiOQ2
gwJl/RAAsyI2RUHJ/+UF9LZ2PqYGa5zI8o9nFTc4C9T1H5p3LVTx+4jOIa/xryDY
h7c/Z0fJx0T49bsWNVGgrYnGAIWqEcAReJpZmHwPp0wt4r6IOOxAwrkcHGI6qSXG
Mrw0nmA+j0dqocIbD8WnV55jCj/rffuhG2C2UZKtO8q3b6U98mG9GjKv53dx0CN7
znX+R8hYDLuKLlGJENIP+Wq+CLIRvC5N9oA7clob4j30tFLSrNjPfP+/ShOKmPil
r3AJOwRsshEAabRHSUhYhcGNPYy6GiP4OklCcoGdYqZ0rHZor/0guwAdszl1QFJV
1HRlM67BKHn5aP0h3re9quyJ8Ex3dTleCLfBT7lKzhv1dJxywox73QfjmB5tr2ez
4xVJNQwcI+QFSJHYY2Ft606TufzpcjKzhfdnrezEk2Zvkl4fN3vAmN8o5p7W3rUG
fRwfvKR2WHJnXFP067G3C5rG2IYQHnoM3Fry9tjp91MANRWXHG0z7j6YZF6+Desm
3F1wZLyS252kcnuP0krXJNoI97UJ5mkVE0Q6wVtXsUQmGqxJ392S/X6whYHJ59Wl
BnCIZjPqofY7AcdhfNEKNPrA9M+jQw2rs4EUy3+BDexu+aEAyjsSPpirvFo4FmX+
5WyhDOOZbzP91rnABwPGytLmMwuMKaoUxVI5MwGeDt2vlNARo/U=
=r4Qc
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_0af25c4f_20250111_023950.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we‚Äôd like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured ‚Äî we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-21

## Security Vulnerabilities fixed in Firefox 126

Announced
May 14, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 126

*Updated November 6, 2024 to add CVE-2024-10941 which was fixed in Firefox 126 but not included in the original advisory.*

#### [#CVE-2024-4764: Use-after-free when audio input connected with multiple consumers](#CVE-2024-4764)

Reporter
Jan-Ivar Bruaroey
Impact
high
##### Description

Multiple WebRTC threads could have claimed a newly connected audio input leading to use-after-free.

##### References

* [Bug 1879093](https://bugzilla.mozilla.org/show_bug.cgi?id=1879093)

#### [#CVE-2024-4367: Arbitrary JavaScript execution in PDF.js](#CVE-2024-4367)

Reporter
Thomas Rinsma of Codean Labs
Impact
high
##### Description

A type check was missing when handling fonts in PDF.js, which would allow arbitrary JavaScript execution in the PDF.js context.

##### References

* [Bug 1893645](https://bugzilla.mozilla.org/show_bug.cgi?id=1893645)

#### [#CVE-2024-4765: Web application manifests could have been overwritten via hash collision](#CVE-2024-4765)

Reporter
Dana Keeler
Impact
moderate
##### Description

Web application manifests were stored by using an insecure MD5 hash which allowed for a hash collision to overwrite another application's manifest. This could have been exploited to run arbitrary code in another application's context.
*This issue only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871109](https://bugzilla.mozilla.org/show_bug.cgi?id=1871109)

#### [#CVE-2024-4766: Fullscreen notification could have been obscured on Firefox for Android](#CVE-2024-4766)

Reporter
Hafiizh
Impact
moderate
##### Description

Different techniques existed to obscure the fullscreen notification in Firefox for Android. These could have led to potential user confusion and spoofing attacks.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871214](https://bugzilla.mozilla.org/show_bug.cgi?id=1871214)
* [Bug 1871217](https://bugzilla.mozilla.org/show_bug.cgi?id=1871217)

#### [#CVE-2024-4767: IndexedDB files retained in private browsing mode](#CVE-2024-4767)

Reporter
Kim Do Hun via Tor Browser
Impact
moderate
##### Description

If the `browser.privatebrowsing.autostart` preference is enabled, IndexedDB files were not properly deleted when the window was closed. This preference is disabled by default in Firefox.

##### References

* [Bug 1878577](https://bugzilla.mozilla.org/show_bug.cgi?id=1878577)

#### [#CVE-2024-4768: Potential permissions request bypass via clickjacking](#CVE-2024-4768)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications' interaction with WebAuthn made it easier for an attacker to trick a user into granting permissions.

##### References

* [Bug 1886082](https://bugzilla.mozilla.org/show_bug.cgi?id=1886082)

#### [#CVE-2024-4769: Cross-origin responses could be distinguished between script and non-script content-types](#CVE-2024-4769)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1886108](https://bugzilla.mozilla.org/show_bug.cgi?id=1886108)

#### [#CVE-2024-4770: Use-after-free could occur when printing to PDF](#CVE-2024-4770)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When saving a page to PDF, certain font styles could have led to a potential use-after-free crash.

##### References

* [Bug 1893270](https://bugzilla.mozilla.org/show_bug.cgi?id=1893270)

#### [#CVE-2024-4771: Failed allocation could lead to use-after-free](#CVE-2024-4771)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A memory allocation check was missing which would lead to a use-after-free if the allocation failed. This could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1893891](https://bugzilla.mozilla.org/show_bug.cgi?id=1893891)

#### [#CVE-2024-4772: Use of insecure rand() function to generate nonce](#CVE-2024-4772)

Reporter
Hanno B√∂ck
Impact
low
##### Description

An HTTP digest authentication nonce value was generated using `rand()` which could lead to predictable values.

##### References

* [Bug 1870579](https://bugzilla.mozilla.org/show_bug.cgi?id=1870579)

#### [#CVE-2024-4773: URL bar could be cleared after network error](#CVE-2024-4773)

Reporter
Islam
Impact
low
##### Description

When a network error occurred during page load, the prior content could have remained in view with a blank URL bar. This could have been used to obfuscate a spoofed web site.

##### References

* [Bug 1875248](https://bugzilla.mozilla.org/show_bug.cgi?id=1875248)

#### [#CVE-2024-4774: Undefined behavior in ShmemCharMapHashEntry()](#CVE-2024-4774)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShmemCharMapHashEntry()` code was susceptible to potentially undefined behavior by bypassing the move semantics for one of its data members.

##### References

* [Bug 1886598](https://bugzilla.mozilla.org/show_bug.cgi?id=1886598)

#### [#CVE-2024-4775: Invalid memory access in the built-in profiler](#CVE-2024-4775)

Reporter
Lukas Bernhard
Impact
low
##### Description

An iterator stop condition was missing when handling WASM code in the built-in profiler, potentially leading to invalid memory access and undefined behavior. *Note:* This issue only affects the application when the profiler is running.

##### References

* [Bug 1887332](https://bugzilla.mozilla.org/show_bug.cgi?id=1887332)

#### [#CVE-2024-4776: Window may remain disabled after file dialog is shown in full-screen](#CVE-2024-4776)

Reporter
Raphael
Impact
low
##### Description

A file dialog shown while in full-screen mode could have resulted in the window remaining disabled.

##### References

* [Bug 1887343](https://bugzilla.mozilla.org/show_bug.cgi?id=1887343)

#### [#CVE-2024-10941: Browser crash from invalid URI](#CVE-2024-10941)

Reporter
Anthony De Los Santos
Impact
low
##### Description

A malicious website could have included an iframe with an malformed URI resulting in a non-exploitable browser crash.

##### References

* [Bug 1880879](https://bugzilla.mozilla.org/show_bug.cgi?id=1880879)
* [Bug 1887614](https://bugzilla.mozilla.org/show_bug.cgi?id=1887614)

#### [#CVE-2024-4777: Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](#CVE-2024-4777)

Reporter
Daniel Holbert and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1878199%2C1893340)

#### [#CVE-2024-4778: Memory safety bugs fixed in Firefox 126](#CVE-2024-4778)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1838834%2C1889291%2C1889595%2C1890204%2C1891545)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation‚Äôs](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ¬©1998‚Äì2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_5d512764_20250111_023951.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we‚Äôd like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured ‚Äî we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-22

## Security Vulnerabilities fixed in Firefox ESR 115.11

Announced
May 14, 2024
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.11

#### [#CVE-2024-4367: Arbitrary JavaScript execution in PDF.js](#CVE-2024-4367)

Reporter
Thomas Rinsma of Codean Labs
Impact
high
##### Description

A type check was missing when handling fonts in PDF.js, which would allow arbitrary JavaScript execution in the PDF.js context.

##### References

* [Bug 1893645](https://bugzilla.mozilla.org/show_bug.cgi?id=1893645)

#### [#CVE-2024-4767: IndexedDB files retained in private browsing mode](#CVE-2024-4767)

Reporter
Kim Do Hun via Tor Browser
Impact
moderate
##### Description

If the `browser.privatebrowsing.autostart` preference is enabled, IndexedDB files were not properly deleted when the window was closed. This preference is disabled by default in Firefox.

##### References

* [Bug 1878577](https://bugzilla.mozilla.org/show_bug.cgi?id=1878577)

#### [#CVE-2024-4768: Potential permissions request bypass via clickjacking](#CVE-2024-4768)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications' interaction with WebAuthn made it easier for an attacker to trick a user into granting permissions.

##### References

* [Bug 1886082](https://bugzilla.mozilla.org/show_bug.cgi?id=1886082)

#### [#CVE-2024-4769: Cross-origin responses could be distinguished between script and non-script content-types](#CVE-2024-4769)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1886108](https://bugzilla.mozilla.org/show_bug.cgi?id=1886108)

#### [#CVE-2024-4770: Use-after-free could occur when printing to PDF](#CVE-2024-4770)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When saving a page to PDF, certain font styles could have led to a potential use-after-free crash.

##### References

* [Bug 1893270](https://bugzilla.mozilla.org/show_bug.cgi?id=1893270)

#### [#CVE-2024-4777: Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](#CVE-2024-4777)

Reporter
Daniel Holbert and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1878199%2C1893340)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation‚Äôs](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ¬©1998‚Äì2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_7a57585d_20250111_023949.html ===


---

[[Date Prev](msg00009.html)][[Date Next](msg00011.html)]
[[Thread Prev](msg00009.html)][[Thread Next](msg00011.html)]
[[Date Index](maillist.html#00010)]
[[Thread Index](threads.html#00010)]

# [SECURITY] [DLA 3815-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3815-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Thu, 16 May 2024 09:16:17 +0200
* *Message-id*: <[[üîé]](/msgid-search/20240516071617.BBD6C2AC952%40andromeda)¬†[20240516071617.BBD6C2AC952@andromeda](msg00010.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3815-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
May 16, 2024                                  <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.11.0esr-1~deb10u1
CVE ID         : CVE-2024-4367 CVE-2024-4767 CVE-2024-4768 CVE-2024-4769
                 CVE-2024-4770 CVE-2024-4777

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code or clickjacking.

For Debian 10 buster, these problems have been fixed in version
115.11.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmZFsrkACgkQnUbEiOQ2
gwIwtQ/+LedFNznXvmGjWnQH6pXvjPj9xB2jrnfTM/B0E+7Wz0ZqkB71nWMIKTCP
oQaNBvug0IjSJ4/Qs5ekgu70h1UJpP7lpAIQwuzu2if+t1Az5mJXZU7zxqL8CGN9
dFwJd5J0nsZEfxkR4G2Q20QlUMOLtvbWvlEw0VQll59XZDMv+Y+2Ej55bz67rqn+
3FqGsYQakWLl1lxMH1LuHdjg2WyAb4zwMPhE0ILVD6yBridjo1ulPL0BF9MDnTtQ
U5T8Vr2X/RReiLlQHcJSWxl+jWfLiLEj20mQ2fANQBEEGt5eU5kjJjYA9X+WTq85
J9SR05StfAT5GpbzaV0AR5yV7d6dlPIg6WS6J/356MWpEhtR2xwcrzyGX6r6n4dP
6MEAlxeOi2vhdRZ+xqftMoIPS1UinHCewUtXmoUgH9SaisZGajtdR2aoGBuN90Tm
mctfKOdc+5siriOKD5+8oVk0pq1O4+IK5IZ3bKAhc3BkNmkJnGcb8z4LJfSGGxI3
RFPfsQqDpK7irie7teSXfNOyUDDgNV72ZrinMRP0tzoDZOuuy1VsnEXhIi8tW7n5
bIAHrz1/0W7/08R3OZ2yO7Ki1FR7lU4fdbiGZTGfnxfzYz4EPuu8Hd8C3QlxsDsF
VSBkXY642X0NV/ivgKmgUlmOyPqTRDLZptF2Ee15EgobZV2nQH4=
=RES1
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_ce9a2297_20250111_023949.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ¬∑
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary‚ñæ

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ‚ñæ

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1893645)
* [XML](/show_bug.cgi?ctype=xml&id=1893645)

Closed
[Bug 1893645](/show_bug.cgi?id=1893645)
(CVE-2024-4367)

Opened 9 months ago
Closed 9 months ago

# Arbitrary Javascript injection in PDF.js through FontMatrix

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Arbitrary Javascript injection in PDF.js through FontMatrix

## Categories

### (Firefox :: PDF Viewer, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
‚ñæ

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=PDF%20Viewer#PDF%20Viewer)

PDF Viewer
‚ñæ

Firefox :: PDF Viewer
For bugs related to Firefox's built-in PDF viewing capabilities (also known as pdf.js).
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=PDF%20Viewer&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=PDF%20Viewer&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=PDF%20Viewer)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

127 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [126+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=126%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox125 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=verified) |
| firefox127 | [+](/buglist.cgi?f1=cf_tracking_firefox127&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr115 | 126+ | verified |
| firefox-esr128 | --- | --- |
| firefox125 |  | wontfix |
| firefox126 | + | verified |
| firefox127 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: thomasrinsma, Assigned: calixte)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1c26d49ffb62a4106644da39c7e6fb4c?d=mm&size=40)  [calixte](/user_profile?user_id=560431)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/67422cb9320550e5eb0a9793b5cb07d5?d=mm&size=40)  [thomasrinsma](/user_profile?user_id=737882)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1c26d49ffb62a4106644da39c7e6fb4c?d=mm&size=40)  [calixte](/user_profile?user_id=560431)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1893789](/show_bug.cgi?id=1893789 "RESOLVED FIXED - Update PDF.js to new version 90d4b9c2c0df7cadbd5c2388431b208f08da1ed6 from 2024-04-24 18:16:01")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1893645&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1893645)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1906415](/show_bug.cgi?id=1906415 "RESOLVED DUPLICATE - „ÄêPDFJS„ÄëÔºöXSS attack"), [1939692](/show_bug.cgi?id=1939692 "VERIFIED DUPLICATE - Arbitrary Javascript injection in PDF.js through FontMatrix")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[github.com/mozilla/pdf.js/security/ad...](https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq "https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq")

[codeanlabs.com/blog/research/cve-2024...](https://codeanlabs.com/blog/research/cve-2024-4367-arbitrary-js-execution-in-pdf-js/ "https://codeanlabs.com/blog/research/cve-2024-4367-arbitrary-js-execution-in-pdf-js/")

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main126+] [adv-ESR115.11+] )

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-4367

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [adv-main126+] [adv-ESR115.11+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c14 "9 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 1 obsolete file)

| [js\_injection\_poc.pdf](/attachment.cgi?id=9398837)  [9 months ago](#c0)  [Thomas Rinsma](/user_profile?user_id=737882)   25.84 KB, application/pdf |  | [Details](/attachment.cgi?id=9398837&action=edit) |
| --- | --- | --- |
| [Bug 1893645 - Simplify the way to pass font data to the main thread](/attachment.cgi?id=9399337)  [9 months ago](#c9)  [Calixte Denizet (:calixte)](/user_profile?user_id=560431)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-beta+](#a348203_600971 "9 months ago") | [Details](/attachment.cgi?id=9399337&action=edit) | [Review](/attachment.cgi?id=9399337) |
| [Bug 1893645 - Simplify the way to pass font data to the main thread](/attachment.cgi?id=9399345)  [9 months ago](#c10)  [Calixte Denizet (:calixte)](/user_profile?user_id=560431)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-esr115+](#a428057_600971 "9 months ago") | [Details](/attachment.cgi?id=9399345&action=edit) | [Review](/attachment.cgi?id=9399345) |
| [advisory.txt](/attachment.cgi?id=9401098)  [8 months ago](#c21)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   186 bytes, text/plain |  | [Details](/attachment.cgi?id=9401098&action=edit) |
| [advisory.txt](/attachment.cgi?id=9401110)  [8 months ago](#c23)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   201 bytes, text/plain |  | [Details](/attachment.cgi?id=9401110&action=edit) |
| [poc\_CVE-2024-4367.pdf](/attachment.cgi?id=9403069)  [8 months ago](#c28)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   20.06 KB, application/pdf |  | [Details](/attachment.cgi?id=9403069&action=edit) |

Show Obsolete

Bottom ‚Üì
Tags ‚ñæ

* Reset

Timeline ‚ñæ

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Thomas Rinsma](/user_profile?user_id=737882)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1893645#c0)‚Ä¢ 9 months ago |
|  | |

Attached file
[js\_injection\_poc.pdf](attachment.cgi?id=9398837)
‚Äî [Details](attachment.cgi?id=9398837&action=edit)

(Tested with Firefox 124.0b9 on Ubuntu and with PDF.js latest from Git.)

Arbitrary Javascript code can be executed in the PDF.js context (unrelated to the Javascript sandbox) by abusing a lack of type checking in the glyph path compilation process, specifically when a Type 1 font is involved. A prerequisite is that `isEvalSupported` needs to be true (it is by default).

This results in a somewhat universal XSS when a PDF is opened with Firefox (cross-origin restrictions are still in place). An attacker can control the PDF.js window and do things like spy on the user‚Äôs activity, trigger downloads using `pdf.js.message` events (even file:// URLs can be ‚Äúdownloaded‚Äù in this way) or leak the PDF‚Äôs local file path from `window.PDFViewerApplication.url`.

In the cases where PDF.js is used in a web-application, this leads to a stored XSS attack on the respective page‚Äôs origin.

# Details

The method `FontFaceObject.getPathGenerator(...)` compiles glyphs to Javascript functions that will return the associated path. In case `isEvalSupported` is set to true, it does this by concatenating them into a list of Javascript statements and creating a Function object out of that: (<https://github.com/mozilla/pdf.js/blob/90d4b9c2c0df7cadbd5c2388431b208f08da1ed6/src/display/font_loader.js#L450> )

```
    // If we can, compile cmds into JS for MAXIMUM SPEED...
    if (this.isEvalSupported && FeatureTest.isEvalSupported) {
      const jsBuf = [];
      for (const current of cmds) {
        const args = current.args !== undefined ? current.args.join(",") : "";
        jsBuf.push("c.", current.cmd, "(", args, ");\n");
      }
      // eslint-disable-next-line no-new-func
      return (this.compiledGlyphs[character] = new Function(
        "c",
        "size",
        jsBuf.join("")
      ));
    }

```

This list of commands, `cmds`, is generated by the method `CompiledFont.compileGlyph(...)` and the `compileGlyphImpl` variants for the different font types: (trimmed from <https://github.com/mozilla/pdf.js/blob/90d4b9c2c0df7cadbd5c2388431b208f08da1ed6/src/core/font_renderer.js#L798> )

```
  compileGlyph(code, glyphId) {
    ...
    let fontMatrix = this.fontMatrix;
    ...
    const cmds = [
      { cmd: "save" },
      { cmd: "transform", args: fontMatrix.slice() },
      { cmd: "scale", args: ["size", "-size"] },
    ];
    this.compileGlyphImpl(code, cmds, glyphId);

    cmds.push({ cmd: "restore" });

    return cmds;
  }

```

For the arguments of the `transform` command it takes the `fontMatrix` array from the current font object. It turns out that under specific circumstances (seemingly only for Type1 fonts) this array is grabbed from a PDF dictionary and not (also) from the font data itself. Hence, the array can contain arbitrary PDF primitives including strings. The retrieval happens in `PartialEvaluator.translateFont`:

```
    const properties = {
      ...
      fontMatrix: dict.getArray("FontMatrix") || FONT_IDENTITY_MATRIX,
      ...
    };

```

(Note: with other font types this does not appear to be a problem as the `FontMatrix` is later grabbed from the font data itself (e.g. CFF dicts or Type1 ‚ÄúPostScript‚Äù parsing) where the parsers explicitly expect numeric array elements. Even if it is not present in the font data, it is overwritten with a standard matrix.)

This means that string-type elements get concatenated literally in the resulting Javascript. Hence we can craft a PDF with a Type1 font and a `Font` object with this `FontMatrix` definition;

```
  /FontMatrix [1 2 3 4 5 (6\); alert\('foobar')]

```

resulting in this Javascript code being executed when the glyph is rendered:

```
c.save();
c.transform(1,2,3,4,5,6); alert('foobar');
c.scale(size,-size);
c.moveTo(0,0);
c.restore();

```

Attached is a plain-text minimal PoC.

# Possible solution

Type-validation could be added either in `compileGlyph`, or in `translateFont`. In the latter case, maybe it is beneficial to implement something like `dict.getNumericArray` in addition to `dict.getArray` for situations like this.

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a6291_159069)‚Ä¢ 9 months ago |

Component: Security ‚Üí PDF Viewer

|  | [Calixte Denizet (:calixte)](/user_profile?user_id=560431)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1893645#c1)‚Ä¢ 9 months ago |
|  | |

Thank you for this bug report.

Assignee: nobody ‚Üí cdenizetSeverity: -- ‚Üí S2Status: UNCONFIRMED ‚Üí ASSIGNED
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected)
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected)
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)Ever confirmed: truePriority: -- ‚Üí P1

|  | [Calixte Denizet (:calixte)](/user_profile?user_id=560431)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1893645#c2)‚Ä¢ 9 months ago |
|  | |

Here's a patch:

<https://github.com/calixteman/pdf.js/commit/bcbc9615d1867032c70807607752c233cc650807>

:Snuffleupagus, could you review it please ?

Flags: needinfo?(jonas.jenwald)

|  | [Jonas Jenwald [:Snuffleupagus]](/user_profile?user_id=480726) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1893645#c3)‚Ä¢ 9 months ago |
|  | |

The reason that `eval` is being used is to improve performance during fallback glyph-rendering, how does removing that affect things?

Please share some benchmarking data for relevant PDFs with embedded fonts, using `disableFontFace = true` to trigger this code-path.

Flags: needinfo?(jonas.jenwald)

|  | [Calixte Denizet (:calixte)](/user_profile?user_id=560431)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1893645#c4)‚Ä¢ 9 months ago |
|  | |

In term of performance, it's almost the same.

I got two profiles in dev edittion 126 with a local setup and in using `http://localhost:8888/web/viewer.html?file=/test/pdfs/tracemonkey.pdf#zoom=1`

* with the patch: <https://profiler.firefox.com/public/e8twyj8xsy9k3kmm9b7h6e0a284h4m1jf3w2sr8/calltree/?globalTrackOrder=0w2&implementation=js&thread=3&timelineType=category&v=10>

  235ms is spent in `glyphDrawer`
* without the patch: <https://profiler.firefox.com/public/1xccy1wvhm8fc9res7s0v8kmn338eyyd6dw810r/calltree/?globalTrackOrder=0w2&implementation=js&thread=3&v=10>

  251ms is spent in `anonymous`.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a153914_1689)‚Ä¢ 9 months ago |

[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- ‚Üí [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)
[tracking-firefox127](/buglist.cgi?f1=cf_tracking_firefox127&o1=isnotempty):
--- ‚Üí [+](/buglist.cgi?f1=cf_tracking_firefox127&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- ‚Üí [126+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=126%2B)Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Marco Castelluccio [:marco]](/user_profile?user_id=420453) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a255981_420453)‚Ä¢ 9 months ago |

Depends on: [1893789](/show_bug.cgi?id=1893789 "RESOLVED FIXED - Update PDF.js to new version 90d4b9c2c0df7cadbd5c2388431b208f08da1ed6 from 2024-04-24 18:16:01")

|  | [Marco Castelluccio [:marco]](/user_profile?user_id=420453) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a268033_420453)‚Ä¢ 9 months ago |

Status: ASSIGNED ‚Üí RESOLVEDClosed: 9 months ago
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected) ‚Üí [fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed)Resolution: --- ‚Üí FIXEDTarget Milestone: --- ‚Üí 127 Branch

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1893645#c5)‚Ä¢ 9 months ago |
|  | |

:marco/:calixte what's the plan for uplifting this for beta and esr115?

Are you going to attach a patch that we can uplift?

Flags: needinfo?(mcastelluccio)Flags: needinfo?(cdenizet)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1893645#c6)‚Ä¢ 9 months ago |
|  | |

sec-high bugs that affect more than Nightly should get sec-approval before landing.

See: <https://firefox-source-docs.mozilla.org/bug-mgmt/processes/security-approval.html>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a280651_75935)‚Ä¢ 9 months ago |

Group: firefox-core-security ‚Üí core-security-release
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix)

|  | [Thomas Rinsma](/user_profile?user_id=737882)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1893645#c7)‚Ä¢ 9 months ago |
|  | |

Thanks all for picking this up so fast!

I see that v4.2.67 of PDF.js (and hence pdfjs-dist on NPM) has been released containing the fix, but without an explicit security advisory. This means that users of the package (and its wrappers like `react-pdf`) will not be warned via services like `npm audit` and Snyk. Maybe this can still be done? I am not entirely sure how that process works to be honest, maybe the easiest is via a Github security advisory?

I was also about to request a CVE but noticed that Mozilla is a numbering authority itself. Let me know if there's still something I can help with there.

|  | [Calixte Denizet (:calixte)](/user_profile?user_id=560431)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1893645#c8)‚Ä¢ 9 months ago |
|  | |

:dmeehan, yes I'll attach some patches today.

:mccr8, I'm sorry about that.

:Thomas, I don't know, probably :dveditz can answer.

Flags: needinfo?(cdenizet)

|  | [Marco Castelluccio [:marco]](/user_profile?user_id=420453) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a326494_420453)‚Ä¢ 9 months ago |

Flags: needinfo?(mcastelluccio) ‚Üí needinfo?(dveditz)

|  | [Calixte Denizet (:calixte)](/user_profile?user_id=560431)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1893645#c9)‚Ä¢ 9 months ago |
|  | |

Attached file
[Bug 1893645 - Simplify the way to pass font data to the main thread](attachment.cgi?id=9399337)
‚Äî [Details](attachment.cgi?id=9399337&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a341056_600971)‚Ä¢ 9 months ago |

[Attachment #9399337](/attachment.cgi?id=9399337&action=edit "Bug 1893645 - Simplify the way to pass font data to the main thread") -
Flags: approval-mozilla-beta?

|  | [Calixte Denizet (:calixte)](/user_profile?user_id=560431)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1893645#c10)‚Ä¢ 9 months ago |
|  | |

Attached file
[Bug 1893645 - Simplify the way to pass font data to the main thread](attachment.cgi?id=9399345)
‚Äî [Details](attachment.cgi?id=9399345&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a341723_600971)‚Ä¢ 9 months ago |

[Attachment #9399345](/attachment.cgi?id=9399345&action=edit "Bug 1893645 - Simplify the way to pass font data to the main thread") -
Flags: approval-mozilla-esr115?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1893645#c11)‚Ä¢ 9 months ago |
|  | |

### beta Uplift Approval Request

* **User impact if declined**: Some arbitrary js can be executed within the viewer
* **Code covered by automated testing**: yes
* **Fix verified in Nightly**: no
* **Needs manual QE test**: yes
* **Steps to reproduce for manual QE testing**: Open the pdf attached to the bug and no popup should be triggered
* **Risk associated with taking this patch**: low
* **Explanation of risk level**: It's a self contained change and usually fonts aren't rendered in using the specific pdf.js font render but in using the Firefox one
* **String changes made/needed**: No
* **Is Android affected?**: yes
Flags: qe-verify+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1893645#c12)‚Ä¢ 9 months ago |
|  | |

### esr115 Uplift Approval Request

* **User impact if declined**: Some arbitrary js can be executed within the viewer
* **Code covered by automated testing**: yes
* **Fix verified in Nightly**: no
* **Needs manual QE test**: yes
* **Steps to reproduce for manual QE testing**: Open the pdf attached to the bug and no popup should be triggered
* **Risk associated with taking this patch**: low
* **Explanation of risk level**: It's a self contained change and usually fonts aren't rendered in using the specific pdf.js font render but in using the Firefox one
* **String changes made/needed**: No
* **Is Android affected?**: yes

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a348203_600971)‚Ä¢ 9 months ago |

[Attachment #9399337](/attachment.cgi?id=9399337&action=edit "Bug 1893645 - Simplify the way to pass font data to the main thread") -
Flags: approval-mozilla-beta? ‚Üí approval-mozilla-beta+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a348389_640478)‚Ä¢ 9 months ago |

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected) ‚Üí [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1893645#c13)‚Ä¢ 9 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/32756264a810>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1893645#c14)‚Ä¢ 9 months ago |
|  | |

This is worse for website-hosted PDF.js (XSS) but that's not covered by our bounty program. There doesn't seem to be a UXSS risk here, but the resource:// privileged context would be able to navigate to URLs that web content is blocked from (chrome:// urls with arbitrary parameters, file:// urls). You could easily trigger a download and save using PDFjs capabilities, and then open the attackers content as a file:// URL. If there was a content-process RCE bug that would get the attacker into a process with a weaker sandbox, giving access to the entire file system.

Flags: sec-bounty? ‚Üí sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1893645#c15)‚Ä¢ 9 months ago |
|  | |

(In reply to Thomas Rinsma from [comment #7](/show_bug.cgi?id=1893645#c7 "VERIFIED FIXED - Arbitrary Javascript injection in PDF.js through FontMatrix"))

> Thanks all for picking this up so fast!
>
> I see that v4.2.67 of PDF.js (and hence pdfjs-dist on NPM) has been released containing the fix, but without an explicit security advisory. This means that users of the package (and its wrappers like `react-pdf`) will not be warned via services like `npm audit` and Snyk. Maybe this can still be done? I am not entirely sure how that process works to be honest, maybe the easiest is via a Github security advisory?
>
> I was also about to request a CVE but noticed that Mozilla is a numbering authority itself. Let me know if there's still something I can help with there.

Yes, an advisory should be released via both Github and the normal advisory process. `CVE-2024-4367` can be used for the Github Advisory; calixte if you have trouble writing the advisory, feel free to reach out in #secinf on Slack

Alias: CVE-2024-4367Flags: needinfo?(dveditz) ‚Üí needinfo?(cdenizet)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a428057_600971)‚Ä¢ 8 months ago |

[Attachment #9399345](/attachment.cgi?id=9399345&action=edit "Bug 1893645 - Simplify the way to pass font data to the main thread") -
Flags: approval-mozilla-esr115? ‚Üí approval-mozilla-esr115+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a449855_640478)‚Ä¢ 8 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) ‚Üí [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1893645#c16)‚Ä¢ 8 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/710a50f0f51d>

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a484944_488993)‚Ä¢ 8 months ago |

QA Whiteboard: [qa-triaged]

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1893645#c17)‚Ä¢ 8 months ago |
|  | |

At a higher level I wonder if we can use `Cu.sandbox()` for the generated JS bits, which would at least have contained the vulnerability here. Is there a plan for this or something similar here to defend-in-depth a bit more?

(I seemingly neglected to send this comment a few days ago, before the patch went up - I see now that the patch removed this particular use of eval entirely, but on m-c in searchfox I still see an `isEvalSupported` property - are there other places where `eval` or `new Function` or similar is used?)

|  | [Calixte Denizet (:calixte)](/user_profile?user_id=560431)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1893645#c18)‚Ä¢ 8 months ago |
|  | |

We still use `new Function` in:

<https://github.com/mozilla/pdf.js/blob/master/src/core/function.js#L428-L436>

I audited this code few days ago and I didn't see anything wrong, the generated function is executed in the worker so there's no access to the DOM.

`eval` is used here in order to improve performance of some postscript functions, so I'm not sure that sending the execution in a sandbox and adding a sync point would help to keep the same performance.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1893645#c19)‚Ä¢ 8 months ago |
|  | |

We've published an advisory at <https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq> - we will write a similar advisory for Firefox explaining its impact in that context and use the same CVE.

Flags: needinfo?(cdenizet)See Also: ‚Üí <https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq>

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1893645#c20)‚Ä¢ 8 months ago |
|  | |

I have reproduced this bug using an affected Nightly 127.0a1 (2024-04-26) on macOS 13 with STR from [comment 12](/show_bug.cgi?id=1893645#c12 "VERIFIED FIXED - Arbitrary Javascript injection in PDF.js through FontMatrix").

The issue is verified as fixed on latest Nightly 127.0a1, Release 126.0 and Esr 115.11.0 under Win 11 x64, macOS 13 and Ubuntu 20.04.

Status: RESOLVED ‚Üí VERIFIED
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) ‚Üí [verified](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=verified)
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed) ‚Üí [verified](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=verified)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) ‚Üí [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)Flags: qe-verify+

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a1150306_486733)‚Ä¢ 8 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] ‚Üí [reporter-external] [client-bounty-form] [verif?] [adv-main126+] [adv-ESR115.11+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1893645#c21)‚Ä¢ 8 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9401098) (obsolete)
‚Äî [Details](attachment.cgi?id=9401098&action=edit)

|  | [Thomas Rinsma](/user_profile?user_id=737882)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1893645#c22)‚Ä¢ 8 months ago |
|  | |

:truber, not sure about any policies but would it be possible to add my organization name ("Codean Labs") to the credit in the advisory?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a1213393_406194)‚Ä¢ 8 months ago |

Flags: needinfo?(jschwartzentruber)

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1893645#c23)‚Ä¢ 8 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9401110)
‚Äî [Details](attachment.cgi?id=9401110&action=edit)

(In reply to Thomas Rinsma from [comment #22](/show_bug.cgi?id=1893645#c22 "VERIFIED FIXED - Arbitrary Javascript injection in PDF.js through FontMatrix"))

> :truber, not sure about any policies but would it be possible to add my organization name ("Codean Labs") to the credit in the advisory?

Done

[Attachment #9401098](/attachment.cgi?id=9401098&action=edit "advisory.txt") -
Attachment is obsolete: trueFlags: needinfo?(jschwartzentruber)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1893645#c24)‚Ä¢ 8 months ago ‚Ä¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1893645&comment_id=16929826 "1 revision") |
|  | |

(In reply to Calixte Denizet (:calixte) from [comment #18](/show_bug.cgi?id=1893645#c18 "VERIFIED FIXED - Arbitrary Javascript injection in PDF.js through FontMatrix"))

> We still use `new Function` in:
>
> <https://github.com/mozilla/pdf.js/blob/master/src/core/function.js#L428-L436>
>
> I audited this code few days ago and I didn't see anything wrong, the generated function is executed in the worker so there's no access to the DOM.
>
> `eval` is used here in order to improve performance of some postscript functions, so I'm not sure that sending the execution in a sandbox and adding a sync point would help to keep the same performance.

A gecko sandbox does not affect performance of the code running inside the sandbox at all - it ends up running the same JS but in a different scope / with a different level of privilege. The only thing that would potentially be affected would be the marshalling of complex things into and out of the sandbox (as they'd have to be `structuredClone`'d or use xpc wrappers), but that seems less likely to be an issue here as it looks like these postscript functions deal with numbers only? I'm not a JS engine expert but I would expect those to be performant just fine. Can we file a follow-up bug to investigate and get someone on the JS team to weigh in? Maybe it ends up wontfix if we really think the trade-off isn't worth it, but it seems worth at least checking if it could work. :-)

Flags: needinfo?(cdenizet)

|  | [Calixte Denizet (:calixte)](/user_profile?user_id=560431)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1893645#c25)‚Ä¢ 8 months ago |
|  | |

That's fair:

<https://bugzilla.mozilla.org/show_bug.cgi?id=1896200>

Flags: needinfo?(cdenizet)

|  | [Calixte Denizet (:calixte)](/user_profile?user_id=560431)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1893645#c26)‚Ä¢ 8 months ago |
|  | |

> A gecko sandbox does not affect performance of the code running inside the sandbox at all

I know it's possible to have a sandbox outside a worker and then my point was about having a sync point in the worker waiting for the results of the computations. But if it's possible to have a sandbox in the worker, then it could be interesting.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1893645#c27)‚Ä¢ 8 months ago |
|  | |

The PDF.js advisory at <https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq>

currently shows "Affected versions <= 4.1.392". Since PDF.js as a library is used by third-party websites which would be impacted more severely than Firefox, I wondered whether this is a recent regression and checked the affected versions. Other than the latest release, there a period in 2016-2017 where the bug was absent.

PDF.js versions and statuses:

* [v4.2.67](https://github.com/mozilla/pdf.js/releases/tag/v4.2.67) (released April 29, 2024) **unaffected** (fixed)
  + Commit: <https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6>
  + Pull request: <https://github.com/mozilla/pdf.js/pull/18015>
* [v4.1.392](https://github.com/mozilla/pdf.js/releases/tag/v4.1.392) (released April 11, 2024) affected (release before this bug was fixed)
* [v1.10.88](https://github.com/mozilla/pdf.js/releases/tag/v1.10.88) (released Oct 27, 2017) affected (re-introduces the security vulnerability due to a typo fix)
  + Commit: <https://github.com/mozilla/pdf.js/commit/ab4d5be19294e3dc2972efd07d1c1373cc8e7e85>
  + Pull request: <https://github.com/mozilla/pdf.js/pull/9008>
* [v1.9.426](https://github.com/mozilla/pdf.js/releases/tag/v1.9.426) (released Aug 15, 2017) **unaffected** (release before the next affected version)
* [v1.5.188](https://github.com/mozilla/pdf.js/releases/tag/v1.5.188) (released Apr 21, 2016) **unaffected** (mitigated the security vulnerability by an accidental typo)
  + commit: <https://github.com/mozilla/pdf.js/commit/1d12aed5cac6a0caccb0550e0aad4ef9f6bb263d>
  + Pull request: <https://github.com/mozilla/pdf.js/pull/7126> - the typo is later fixed by PR 9008.
* [v1.4.20](https://github.com/mozilla/pdf.js/releases/tag/v1.4.20) (released Jan 27, 2016) affected (release before the next release that accidentally fixed the vulnerable code)
* [v0.8.1181](https://github.com/mozilla/pdf.js/releases/tag/v0.8.1181) (released Apr 10, 2014) affected (first public release of PDF.js)
  + Commit: <https://github.com/mozilla/pdf.js/commit/0e133f00902b9fef8422a932385a61a38ca85545>
  + Pull request: <https://github.com/mozilla/pdf.js/pull/3195>

Note: some may use the master branch of PDF.js instead of specific releases. Firefox is an example:

* Firefox 58 - affected, PDF.js version 2.0.106
* Firefox 57 - unaffected, PDF.js version 1.9.583

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1893645#c28)‚Ä¢ 8 months ago |
|  | |

Attached file
[poc\_CVE-2024-4367.pdf](attachment.cgi?id=9403069)
‚Äî [Details](attachment.cgi?id=9403069&action=edit)

The original PoC ([js\_injection\_poc.pdf](https://bugzilla.mozilla.org/attachment.cgi?id=9398837)) did not reproduce the vulnerability in older PDF.js versions. Here is an updated PoC.

There are three changes:

* The dictionary at `7 0 obj` was modified; I added `/Length1 2462`
* The JS snippet was modified; I added a conditional to fall back to `document.URL` if `window.PDFViewerApplication` is undefined.
* I recalculated the offsets in the Xref table (`qpdf js_injection_poc.pdf poc_CVE-2024-4367.pdf`)

To test whether a PDF.js version is vulnerable, open the PDF file in the viewer. If vulnerable, an alert dialog will pop up as seen in the original report.

Note: the absence of the dialog does not imply a non-vulnerable PDF.js installation. For example, if the PDF Viewer is loaded in a iframe sandbox or CSP sandbox without `allow-modals`, then the dialog does not pop up. For a version-based vulnerability assessment, see <https://bugzilla.mozilla.org/show_bug.cgi?id=1893645#c27>

|  | [Thomas Rinsma](/user_profile?user_id=737882)  Reporter |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1893645#c29)‚Ä¢ 8 months ago |
|  | |

Thank you Rob for the thorough analysis. Given that this may be useful for people externally as well, do you mind if I add the version overview and/or generalized PoC to the public [blog post](https://codeanlabs.com/blog/research/cve-2024-4367-arbitrary-js-execution-in-pdf-js/)?

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1893645#c30)‚Ä¢ 8 months ago |
|  | |

I have posted the same version overview at <https://github.com/mozilla/pdf.js/pull/18015#issuecomment-2124596367>, along with a remark that "unaffected" does not mean that these versions are safe to use. That is because these older versions are affected by a different vulnerability ([bug 1452075](/show_bug.cgi?id=1452075 "VERIFIED FIXED - PDF Viewer will run code from PDF files, missing validation for /Domain and /Range parameters") aka [CVE-2018-5158](https://www.cve.org/CVERecord?id=CVE-2018-5158)).

Feel free to share my PoC (and name). For context, the old PoC did not work in PDF.js<=1.4.20 despite it being vulnerable, the new one does.

Since your blog has already been shared, it is likely that the PoC has already been copied by others. I therefore recommend to clearly state that the PoC has been updated to cover older versions, in case people come across your original PoC and wonder why it didn't reproduce despite allegedly being vulnerable.

|  | [Thomas Rinsma](/user_profile?user_id=737882)  Reporter |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1893645#c31)‚Ä¢ 8 months ago |
|  | |

Clear, thanks for the guidance. I've added the information.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a2245288_406194)‚Ä¢ 8 months ago |

See Also: ‚Üí <https://codeanlabs.com/blog/research/cve-2024-4367-arbitrary-js-execution-in-pdf-js/>

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a2955127_5898)‚Ä¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a6315248_159069)‚Ä¢ 6 months ago |

Duplicate of this bug: [1906415](/show_bug.cgi?id=1906415 "RESOLVED DUPLICATE - „ÄêPDFJS„ÄëÔºöXSS attack")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1893645#c33)‚Ä¢ 4 months ago |
|  | |

No point in keeping this hidden given the reporter's blog post

Group: core-security-release

|  | [Jonas Jenwald [:Snuffleupagus]](/user_profile?user_id=480726) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a21671583_480726)‚Ä¢ 9 days ago |

Duplicate of this bug: [1939692](/show_bug.cgi?id=1939692 "VERIFIED DUPLICATE - Arbitrary Javascript injection in PDF.js through FontMatrix")

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a21768957_575867)‚Ä¢ 8 days ago |

Depends on: [1939847](/show_bug.cgi?id=1939847 "RESOLVED DUPLICATE - Update PDF.js to new version 5905eb1253cfec26e9e39608f8a587888580b45b from 2025-01-01 13:45:30")

|  | [Jonas Jenwald [:Snuffleupagus]](/user_profile?user_id=480726) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1893645#a21769158_480726)‚Ä¢ 8 days ago |

No longer depends on: [1939847](/show_bug.cgi?id=1939847 "RESOLVED DUPLICATE - Update PDF.js to new version 5905eb1253cfec26e9e39608f8a587888580b45b from 2025-01-01 13:45:30")
You need to [log in](/show_bug.cgi?id=1893645&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ‚Üë

## Attachment

Hide Details

### General

Creator:  [Thomas Rinsma](/user_profile?user_id=737882)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_3621e25b_20250111_023952.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we‚Äôd like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured ‚Äî we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-23

## Security Vulnerabilities fixed in Thunderbird 115.11

Announced
May 15, 2024
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.11

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2024-4367: Arbitrary JavaScript execution in PDF.js](#CVE-2024-4367)

Reporter
Thomas Rinsma of Codean Labs
Impact
high
##### Description

A type check was missing when handling fonts in PDF.js, which would allow arbitrary JavaScript execution in the PDF.js context.

##### References

* [Bug 1893645](https://bugzilla.mozilla.org/show_bug.cgi?id=1893645)

#### [#CVE-2024-4767: IndexedDB files retained in private browsing mode](#CVE-2024-4767)

Reporter
Kim Do Hun via Tor Browser
Impact
moderate
##### Description

If the `browser.privatebrowsing.autostart` preference is enabled, IndexedDB files were not properly deleted when the window was closed. This preference is disabled by default in Thunderbird.

##### References

* [Bug 1878577](https://bugzilla.mozilla.org/show_bug.cgi?id=1878577)

#### [#CVE-2024-4768: Potential permissions request bypass via clickjacking](#CVE-2024-4768)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications' interaction with WebAuthn made it easier for an attacker to trick a user into granting permissions.

##### References

* [Bug 1886082](https://bugzilla.mozilla.org/show_bug.cgi?id=1886082)

#### [#CVE-2024-4769: Cross-origin responses could be distinguished between script and non-script content-types](#CVE-2024-4769)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1886108](https://bugzilla.mozilla.org/show_bug.cgi?id=1886108)

#### [#CVE-2024-4770: Use-after-free could occur when printing to PDF](#CVE-2024-4770)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When saving a page to PDF, certain font styles could have led to a potential use-after-free crash.

##### References

* [Bug 1893270](https://bugzilla.mozilla.org/show_bug.cgi?id=1893270)

#### [#CVE-2024-4777: Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](#CVE-2024-4777)

Reporter
Daniel Holbert and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1878199%2C1893340)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation‚Äôs](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ¬©1998‚Äì2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


