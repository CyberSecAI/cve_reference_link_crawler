- **Root cause of vulnerability**: Improper sanitization of user-provided input within the SMS notification script. Specifically, the "Pager Address" field was not properly escaped before being used in a shell command, leading to command injection.
- **Weaknesses/vulnerabilities present**: Command injection vulnerability due to insufficient input sanitization and usage of `os.system`.
- **Impact of exploitation**: Successful exploitation allows an attacker to execute arbitrary shell commands within the context of the Checkmk site.
- **Attack vectors**: The attacker must have the ability to modify a user's Pager Address field, either directly via the User Management interface, or indirectly through external interfaces like LDAP User Synchronization.
- **Required attacker capabilities/position**: The attacker requires user management permissions, which are equivalent to administrative access, or the ability to modify the "Pager Address" field through external means such as LDAP user sync. An attacker also needs to exploit the SMS notification functionality to trigger the vulnerability.