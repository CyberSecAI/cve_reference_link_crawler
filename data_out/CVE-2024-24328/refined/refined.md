- **Root cause of vulnerability:** The `enable` parameter within the `setMacFilterRules` request is vulnerable to OS command injection. The provided value is passed to the `Uci_Set_Str` function which is used to build a system command, without proper sanitization, allowing an attacker to inject arbitrary commands.
- **Weaknesses/vulnerabilities present:** OS command injection. Lack of sanitization of user-supplied input.
- **Impact of exploitation:** Arbitrary OS commands can be executed on the target system. The attacker can potentially gain complete control over the device.
- **Attack vectors:** Sending a crafted HTTP POST request to the `/cgi-bin/cstecgi.cgi` endpoint, specifically targeting the `setMacFilterRules` topic and injecting a command within the `enable` parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the router's web interface. This could be achieved remotely if the web interface is exposed, or from within the local network.