
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fsecurity-research%2Fsecurity%2Fadvisories%2FGHSA-6529-6jv3-66q2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fsecurity-research%2Fsecurity%2Fadvisories%2FGHSA-6529-6jv3-66q2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=google%2Fsecurity-research)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[google](/google)
/
**[security-research](/google/security-research)**
Public

* [Notifications](/login?return_to=%2Fgoogle%2Fsecurity-research) You must be signed in to change notification settings
* [Fork
  421](/login?return_to=%2Fgoogle%2Fsecurity-research)
* [Star
   3.5k](/login?return_to=%2Fgoogle%2Fsecurity-research)

* [Code](/google/security-research)
* [Issues
  8](/google/security-research/issues)
* [Pull requests
  13](/google/security-research/pulls)
* [Actions](/google/security-research/actions)
* [Security](/google/security-research/security)
* [Insights](/google/security-research/pulse)

Additional navigation options

* [Code](/google/security-research)
* [Issues](/google/security-research/issues)
* [Pull requests](/google/security-research/pulls)
* [Actions](/google/security-research/actions)
* [Security](/google/security-research/security)
* [Insights](/google/security-research/pulse)

# Lightdash - Stored Cross-Site Scripting

High

[rcorrea35](/rcorrea35)
published
GHSA-6529-6jv3-66q2
Aug 29, 2024

## Package

No package listed

## Affected versions

0.1024.6

## Patched versions

0.1042.2

## Description

### Summary

Multiple stored cross-site scripting (“XSS”) vulnerabilities in the markdown dashboard and dashboard comment functionality of Lightdash version 0.1024.6 allows remote authenticated threat actors to inject malicious scripts into vulnerable web pages. A threat actor could potentially exploit this vulnerability to store malicious JavaScript which executes in the context of a user’s session with the application.

### Severity

**HIGH** - Exploitation of this vulnerability could allow a threat actor to impersonate a user through request forgery, session hijacking, or an account takeover. In addition, a threat actor could access or exfiltrate any data the victim user can access.

### Proof of Concept

Multiple instances of stored XSS exist within the affected version:

**Instance 1: Markdown Dashboard**

Affected Endpoint (Storage): `PATCH /api/v1/dashboards/<DashboardIdentifier>`

Affected Endpoint (Execution): `GET /projects/<ProjectIdentifier>/dashboards/<DashboardIdentifier>/view`

Affected Parameters: `content`

Reproduction Steps:

1. Log in as a user with the permissions to create a new dashboard and create a markdown dashboard
2. Edit the dashboard and insert the payload `<iframe src=”javascript:alert(document.domain)”>`. Save the dashboard
3. Observe payload execution when the dashboard is loaded.
4. Navigate away, return to the dashboard, and observe that the payload is still executed and was stored by the application.

An example request to store an XSS payload in the markdown dashboard is shown below. The XSS will be triggered when viewing the injected dashboard.

```
PATCH /api/v1/dashboards/<DashboardIdentifier> HTTP/2
Host: lightdash-host
...
Accept-Language: en-US,en;q=0.9
Priority: u=1, i

{"tiles":[{"uuid":"<UniqueIdentifier>","x":0,"y":0,"h":9,"w":15,"type":"markdown","properties":{"title":"title","hideTitle":false,"content":"start\n<iframe src=\"javascript:alert(document.domain)\" style=\"position: absolute;width:0;height:0;border:0;\">frame</iframe>\nend\n"}}],"filters":{"dimensions":[],"metrics":[],"tableCalculations":[]},"name":"my dashboard"}

```

**Instance 2: Dashboard Comments**

Affected Endpoint (Storage): `POST /api/v1/comments/dashboards/<DashboardIdentifier>/<UniqueIdentifier>`

Affected Endpoint (Execution): `GET /projects/<ProjectIdentifier>/<DashboardIdentifier>/view`

Affected Parameters: `textHtml`

Reproduction Steps:

1. Log into the application and navigate to a shared dashboard
2. Use the dashboard comment functionality to add a new comment. Optional: use the comment `@` functionality to target a potential victim account
3. Intercept the request with Burp Suite and insert the payload `<details/open/ontoggle=alert(document.domain)>` into the value of `textHtml`
4. Forward the request and observe that the payload executes when viewing the dashboard comments

An example HTTP request to store the XSS payload in a comment is shown below. After submitting the comment the XSS will be triggered when viewing dashboard comments.

```
POST /api/v1/comments/dashboards/<DashboardIdentifier>/<UniqueIdentifier> HTTP/2
Host: lightdash-host
...
Accept-Language: en-US,en;q=0.9
Priority: u=1, i

{"text":"@<user>","textHtml":"<p><strong><span style=\"color: #228be6; font-weight: 500;\">@user</span></strong> test<details/open/ontoggle=alert(document.domain)></p>","mentions":["<MentionIdentifier>"]}

```
### Further Analysis

A threat actor needs permissions to create dashboards and make dashboard comments, such as those granted with the Administrator or Editor roles. The threat actor must only identify the affected scope, submit the XSS payload, and wait for an unsuspecting user to visit the affected page. The application contains functionality to tag users and notify them of new comments, which increases the likelihood of a user browsing to a page and triggering payload execution.

This vulnerability can be used to force a user to export a dashboard, trigger CVE-2024-6586, and leak the user’s session token to a threat actor, resulting in session takeover.

#### Vendor Analysis

The vendor determined that the root cause of this issue was markdown + comment components execute scripts. The issue was remediated in version 0.1042.2.

#### Remediation Information

Remediated Version: <https://github.com/lightdash/lightdash/releases/tag/0.1042.2>

**Remediation patch 1**

Description: sanitizes HTML for markdown tiles

Git Patch: <https://patch-diff.githubusercontent.com/raw/lightdash/lightdash/pull/9510.patch>

GitHub Pull Request: [lightdash/lightdash#9510](https://github.com/lightdash/lightdash/pull/9510)

**Remediation patch 2**

Description: sanitizes HTML for comments

Git Patch: <https://patch-diff.githubusercontent.com/raw/lightdash/lightdash/pull/9359.patch>

GitHub Pull Request: [lightdash/lightdash#9359](https://github.com/lightdash/lightdash/pull/9359)

### Timeline

**Date reported**: 03/07/2024

**Date fixed**: 03/26/2024

**Date disclosed**: 08/30/2024

### Severity

High

8.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N

### CVE ID

CVE-2024-6585

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@kennethchiong](https://avatars.githubusercontent.com/u/40924313?s=40&v=4)](/kennethchiong)
  [kennethchiong](/kennethchiong)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

