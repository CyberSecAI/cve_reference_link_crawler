

[HashiCorp Discuss](/)

# [HCSEC-2024-05 - Vault Cert Auth Method Did Not Correctly Validate Non-CA Certificates](/t/hcsec-2024-05-vault-cert-auth-method-did-not-correctly-validate-non-ca-certificates/63382)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[eastebry](https://discuss.hashicorp.com/u/eastebry)

March 4, 2024, 7:10pm

1

**Bulletin ID:** HCSEC-2024-05

**Affected Products / Versions:** Vault and Vault Enterprise up to 1.15.4, 1.14.9; fixed in 1.15.5 and 1.14.10.

**Publication Date:** March 4, 2024

**Summary**

Vault and Vault Enterprise (“Vault”) TLS certificate auth method did not correctly validate client certificates when configured with a non-CA certificate as [trusted certificate](https://developer.hashicorp.com/vault/api-docs/auth/cert#certificate). In this configuration, an attacker may be able to craft a malicious certificate that could be used to bypass authentication. This vulnerability, CVE-2024-2048, is fixed in Vault 1.15.5 and 1.14.10.

**Background**

Vault offers a wide range of [auth methods](https://developer.hashicorp.com/vault/api-docs/auth) for authentication, including [TLS client certificates](https://developer.hashicorp.com/vault/api-docs/auth/cert). Vault’s TLS auth method supports trusted certificates signed by certificate authorities as well as non-CA signed certificates.

**Details**

Vault relies on Golang’s TLS libraries to validate client certificates, in combination with further checks in Vault’s code. It was discovered that in the case of non-CA signed trusted certificates, Vault insufficiently validated this certificate. As a result, this attacker could use a maliciously crafted certificate to bypass authentication, should the attacker have out-of-band access to information about this public trusted certificate.

**Remediation**

Customers using the TLS auth method with a non-CA certificate as a trusted certificate in their Vault installation should evaluate the risk associated with this issue and consider upgrading to Vault Enterprise 1.15.5, 1.14.10, or newer. Please refer to [Upgrading Vault](https://learn.hashicorp.com/tutorials/vault/sop-upgrade?in=vault/standard-procedures) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by Nathanial “d0nut” Lattimer who reported it to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-07 - Vault TLS Cert Auth Method Did Not Correctly Validate OCSP Responses](https://discuss.hashicorp.com/t/hcsec-2024-07-vault-tls-cert-auth-method-did-not-correctly-validate-ocsp-responses/64573)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4985 | April 4, 2024 |
| [HCSEC-2022-24 - Vault's TLS Cert Auth Method Only Loaded CRL After First Request](https://discuss.hashicorp.com/t/hcsec-2022-24-vaults-tls-cert-auth-method-only-loaded-crl-after-first-request/45483)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 6817 | October 12, 2022 |
| [HCSEC-2021-10 - Vault’s Cassandra Integrations Did Not Validate TLS Certificates](https://discuss.hashicorp.com/t/hcsec-2021-10-vault-s-cassandra-integrations-did-not-validate-tls-certificates/23463)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7481 | April 21, 2021 |
| [HCSEC-2020-16 - Vault’s AWS Auth Method Allows Authentication Bypass](https://discuss.hashicorp.com/t/hcsec-2020-16-vault-s-aws-auth-method-allows-authentication-bypass/18101)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4360 | November 25, 2020 |
| [TLS certificates auth method : can this be used With certificates issued by Microsoft CA platform?](https://discuss.hashicorp.com/t/tls-certificates-auth-method-can-this-be-used-with-certificates-issued-by-microsoft-ca-platform/66323)  [Vault](/c/vault/30) [vault](https://discuss.hashicorp.com/tag/vault) | 2 | 72 | April 24, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

