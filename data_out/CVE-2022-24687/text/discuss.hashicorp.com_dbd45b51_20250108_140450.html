

[HashiCorp Discuss](/)

# [HCSEC-2022-05 - Consul Ingress Gateway Panic Can Shutdown Servers](/t/hcsec-2022-05-consul-ingress-gateway-panic-can-shutdown-servers/35739)

[Security](/c/security/52)

[security-consul](https://discuss.hashicorp.com/tag/security-consul)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

February 15, 2022, 7:16pm

1

**Bulletin ID:** HCSEC-2022-05

**Affected Products / Versions:** Consul and Consul Enterprise 1.8.0 through 1.9.14, 1.10.7, and 1.11.2; fixed in 1.9.15, 1.10.8, and 1.11.3.

**Publication Date:** February 15, 2022

**Summary**

Consul and Consul Enterprise (“Consul”) clusters with at least one Ingress Gateway allow a user with `service:write` permissions to register a specifically-defined service that will cause the Consul server to panic. This vulnerability, CVE-2022-24687, was fixed in Consul 1.9.15, 1.10.8, and 1.11.3.

**Background**

Consul may be configured to provide [Ingress Gateways](https://www.consul.io/docs/connect/gateways/ingress-gateway), enabling connectivity within your organizational network from services outside the Consul service mesh to services in the mesh. An ingress gateway is a type of proxy and must be registered as a service in Consul, with the kind set to `ingress-gateway`.

**Details**

It was reported that clusters with at least one ingress gateway configured may allow a user with `service:write` permission to register a specifically-defined service that can cause the Consul server to panic and shutdown.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Consul or Consul Enterprise 1.9.15, 1.10.8, and 1.11.3, or newer. Please refer to [Upgrading Consul](https://www.consul.io/docs/upgrading) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by an external party who reported it to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-06 - Consul Server Panic when Ingress and API Gateways Configured with Peering Connections](https://discuss.hashicorp.com/t/hcsec-2023-06-consul-server-panic-when-ingress-and-api-gateways-configured-with-peering-connections/51197)  [Security](/c/security/52) | 0 | 5700 | March 9, 2023 |
| [HCSEC-2020-10 - Consul Server Crash With Invalid Service-Router Config Entry](https://discuss.hashicorp.com/t/hcsec-2020-10-consul-server-crash-with-invalid-service-router-config-entry/18093)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 4100 | November 25, 2020 |
| [HCSEC-2021-17 - Consul’s Envoy TLS Configuration Did Not Validate Destination Service Subject Alternative Names](https://discuss.hashicorp.com/t/hcsec-2021-17-consul-s-envoy-tls-configuration-did-not-validate-destination-service-subject-alternative-names/26856)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7739 | July 15, 2021 |
| [HCSEC-2021-24 - Consul Missing Authorization Check on Txn.Apply Endpoint](https://discuss.hashicorp.com/t/hcsec-2021-24-consul-missing-authorization-check-on-txn-apply-endpoint/29026)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7715 | September 1, 2021 |
| [HCSEC-2022-28 - Consul Cluster Peering Leaks Imported Nodes/Services Information](https://discuss.hashicorp.com/t/hcsec-2022-28-consul-cluster-peering-leaks-imported-nodes-services-information/46946)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 6286 | November 15, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

