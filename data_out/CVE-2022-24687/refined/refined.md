Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
- A specifically crafted service registration, when an Ingress Gateway is configured, can cause a panic in the Consul server.

**Weaknesses/vulnerabilities present:**
- Improper handling of service registration data in the presence of Ingress Gateways.

**Impact of exploitation:**
- Denial of Service (DoS) - The Consul server panics and shuts down.

**Attack vectors:**
- A user with `service:write` permissions can register a malicious service definition.
- The vulnerability is triggered when there is at least one Ingress Gateway configured in the Consul cluster.

**Required attacker capabilities/position:**
- The attacker must have `service:write` permissions within the Consul cluster.
- An Ingress Gateway must be configured within the target Consul cluster.

**Additional details:**
- The vulnerability is identified as HCSEC-2022-05 by HashiCorp
- NetApp products are affected by this vulnerability if they incorporate vulnerable versions of HashiCorp Consul Enterprise.
- Affected versions include: Consul and Consul Enterprise 1.8.0 through 1.9.14, 1.10.0 through 1.10.7, and 1.11.0 through 1.11.2.
- Patched versions are 1.9.15, 1.10.8, and 1.11.3, or newer