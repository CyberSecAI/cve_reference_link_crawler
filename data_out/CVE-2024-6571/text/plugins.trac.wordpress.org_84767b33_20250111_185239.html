

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3122915%2540imageseo%26old%3D3122915%2540imageseo)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3122128/imageseo "Changeset 3122128 for imageseo")
* [Next Change](/changeset/3123724/imageseo "Changeset 3123724 for imageseo") →

---

# Changeset [3122915](/changeset/3122915 "Show full changeset") for [imageseo](/browser/imageseo?rev=3122915 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/22/2024 06:26:26 AM
([6 months](/timeline?from=2024-07-22T06%3A26%3A26Z&precision=second "See timeline at 07/22/2024 06:26:26 AM") ago)

Author:
wpchill
Message:

Update to version 3.1.2 from GitHub

Location:
[imageseo](/browser/imageseo?rev=3122915)
Files:

34 added
18 deleted
50 edited
1 copied

* [assets/icon.svg](/browser/imageseo/assets/icon.svg?rev=3122915 "Show entry in browser")
  (modified)
  ([1 prop](#file0 "Show differences"))
* [assets/screenshot-1.png](/browser/imageseo/assets/screenshot-1.png?rev=3122915 "Show entry in browser")
  (modified)
  ([previous](/browser/imageseo/assets/screenshot-1.png?rev=3122128 "Show previous version in browser"))
* [assets/screenshot-2.png](/browser/imageseo/assets/screenshot-2.png?rev=3122915 "Show entry in browser")
  (modified)
  ([previous](/browser/imageseo/assets/screenshot-2.png?rev=3122128 "Show previous version in browser"))
* [assets/screenshot-3.png](/browser/imageseo/assets/screenshot-3.png?rev=3122915 "Show entry in browser")
  (modified)
  ([previous](/browser/imageseo/assets/screenshot-3.png?rev=3122128 "Show previous version in browser"))
* [assets/screenshot-4.png](/browser/imageseo/assets/screenshot-4.png?rev=3122915 "Show entry in browser")
  (modified)
  ([previous](/browser/imageseo/assets/screenshot-4.png?rev=3122128 "Show previous version in browser"))
* [assets/screenshot-5.png](/browser/imageseo/assets/screenshot-5.png?rev=3122915 "Show entry in browser")
  (modified)
  ([previous](/browser/imageseo/assets/screenshot-5.png?rev=3122128 "Show previous version in browser"))
* [assets/screenshot-6.png](/browser/imageseo/assets/screenshot-6.png?rev=3122915 "Show entry in browser")
  (modified)
  ([previous](/browser/imageseo/assets/screenshot-6.png?rev=3122128 "Show previous version in browser"))
* [assets/screenshot-7.png](/browser/imageseo/assets/screenshot-7.png?rev=3122915 "Show entry in browser")
  (modified)
  ([previous](/browser/imageseo/assets/screenshot-7.png?rev=3122128 "Show previous version in browser"))
* [tags/3.1.2](/browser/imageseo/tags/3.1.2?rev=3122915 "Show entry in browser")
  (copied)
  *(copied from [imageseo/trunk](/browser/imageseo/trunk?rev=3121409 "Show original file (revision 3122913)"))*
* [tags/3.1.2/.github](/browser/imageseo/tags/3.1.2/.github?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.github/workflows](/browser/imageseo/tags/3.1.2/.github/workflows?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.github/workflows/deploy.yml](/browser/imageseo/tags/3.1.2/.github/workflows/deploy.yml?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org](/browser/imageseo/tags/3.1.2/.wordpress-org?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/banner-1544x500.png](/browser/imageseo/tags/3.1.2/.wordpress-org/banner-1544x500.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/banner-772x250.png](/browser/imageseo/tags/3.1.2/.wordpress-org/banner-772x250.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/icon-128x128.png](/browser/imageseo/tags/3.1.2/.wordpress-org/icon-128x128.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/icon-256x256.png](/browser/imageseo/tags/3.1.2/.wordpress-org/icon-256x256.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/icon.svg](/browser/imageseo/tags/3.1.2/.wordpress-org/icon.svg?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/screenshot-1.png](/browser/imageseo/tags/3.1.2/.wordpress-org/screenshot-1.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/screenshot-2.png](/browser/imageseo/tags/3.1.2/.wordpress-org/screenshot-2.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/screenshot-3.png](/browser/imageseo/tags/3.1.2/.wordpress-org/screenshot-3.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/screenshot-4.png](/browser/imageseo/tags/3.1.2/.wordpress-org/screenshot-4.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/screenshot-5.png](/browser/imageseo/tags/3.1.2/.wordpress-org/screenshot-5.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/screenshot-6.png](/browser/imageseo/tags/3.1.2/.wordpress-org/screenshot-6.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/.wordpress-org/screenshot-7.png](/browser/imageseo/tags/3.1.2/.wordpress-org/screenshot-7.png?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/dist/adminv2/index.asset.php](/browser/imageseo/tags/3.1.2/dist/adminv2/index.asset.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file25 "Show differences"))
* [tags/3.1.2/dist/adminv2/index.js](/browser/imageseo/tags/3.1.2/dist/adminv2/index.js?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file26 "Show differences"))
* [tags/3.1.2/dist/settingsv2/index.asset.php](/browser/imageseo/tags/3.1.2/dist/settingsv2/index.asset.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file27 "Show differences"))
* [tags/3.1.2/dist/settingsv2/index.css](/browser/imageseo/tags/3.1.2/dist/settingsv2/index.css?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file28 "Show differences"))
* [tags/3.1.2/dist/settingsv2/index.js](/browser/imageseo/tags/3.1.2/dist/settingsv2/index.js?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file29 "Show differences"))
* [tags/3.1.2/imageseo.php](/browser/imageseo/tags/3.1.2/imageseo.php?rev=3122915 "Show entry in browser")
  (modified)
  ([3 diffs](#file30 "Show differences"))
* [tags/3.1.2/readme.txt](/browser/imageseo/tags/3.1.2/readme.txt?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file31 "Show differences"))
* [tags/3.1.2/src/Actions/Admin/MediaLibrary.php](/browser/imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php?rev=3122915 "Show entry in browser")
  (modified)
  ([7 diffs](#file32 "Show differences"))
* [tags/3.1.2/src/Actions/RestApi.php](/browser/imageseo/tags/3.1.2/src/Actions/RestApi.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file33 "Show differences"))
* [tags/3.1.2/src/Actions/VendorProtect.php](/browser/imageseo/tags/3.1.2/src/Actions/VendorProtect.php?rev=3122915 "Show entry in browser")
  (added)
* [tags/3.1.2/src/Admin/SettingsPage.php](/browser/imageseo/tags/3.1.2/src/Admin/SettingsPage.php?rev=3122915 "Show entry in browser")
  (modified)
  ([7 diffs](#file35 "Show differences"))
* [tags/3.1.2/src/Processes/OnUploadImage.php](/browser/imageseo/tags/3.1.2/src/Processes/OnUploadImage.php?rev=3122915 "Show entry in browser")
  (modified)
  ([4 diffs](#file36 "Show differences"))
* [tags/3.1.2/src/Services/BulkOptimizer.php](/browser/imageseo/tags/3.1.2/src/Services/BulkOptimizer.php?rev=3122915 "Show entry in browser")
  (modified)
  ([4 diffs](#file37 "Show differences"))
* [tags/3.1.2/src/Services/Option.php](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915 "Show entry in browser")
  (modified)
  ([9 diffs](#file38 "Show differences"))
* [tags/3.1.2/src/Traits/Debug.php](/browser/imageseo/tags/3.1.2/src/Traits/Debug.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file39 "Show differences"))
* [tags/3.1.2/thirds/action-scheduler/README.md](/browser/imageseo/trunk/thirds/action-scheduler/README.md?rev=2702820 "Show what was removed (content at revision 3122913)")
  (deleted)
* [tags/3.1.2/thirds/action-scheduler/lib/cron-expression/README.md](/browser/imageseo/trunk/thirds/action-scheduler/lib/cron-expression/README.md?rev=2702820 "Show what was removed (content at revision 3122913)")
  (deleted)
* [tags/3.1.2/thirds/action-scheduler/vendor](/browser/imageseo/trunk/thirds/action-scheduler/vendor?rev=3011770 "Show what was removed (content at revision 3122913)")
  (deleted)
* [tags/3.1.2/vendor/autoload.php](/browser/imageseo/tags/3.1.2/vendor/autoload.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file43 "Show differences"))
* [tags/3.1.2/vendor/cocur/slugify/bin](/browser/imageseo/trunk/vendor/cocur/slugify/bin?rev=2226147 "Show what was removed (content at revision 3122913)")
  (deleted)
* [tags/3.1.2/vendor/cocur/slugify/composer.json](/browser/imageseo/trunk/vendor/cocur/slugify/composer.json?rev=2226147 "Show what was removed (content at revision 3122913)")
  (deleted)
* [tags/3.1.2/vendor/cocur/slugify/phpunit.xml.dist](/browser/imageseo/trunk/vendor/cocur/slugify/phpunit.xml.dist?rev=2226147 "Show what was removed (content at revision 3122913)")
  (deleted)
* [tags/3.1.2/vendor/composer/ClassLoader.php](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915 "Show entry in browser")
  (modified)
  ([25 diffs](#file47 "Show differences"))
* [tags/3.1.2/vendor/composer/InstalledVersions.php](/browser/imageseo/tags/3.1.2/vendor/composer/InstalledVersions.php?rev=3122915 "Show entry in browser")
  (modified)
  ([4 diffs](#file48 "Show differences"))
* [tags/3.1.2/vendor/composer/autoload\_real.php](/browser/imageseo/tags/3.1.2/vendor/composer/autoload_real.php?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file49 "Show differences"))
* [tags/3.1.2/vendor/composer/autoload\_static.php](/browser/imageseo/tags/3.1.2/vendor/composer/autoload_static.php?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file50 "Show differences"))
* [tags/3.1.2/vendor/composer/installed.php](/browser/imageseo/tags/3.1.2/vendor/composer/installed.php?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file51 "Show differences"))
* [tags/3.1.2/vendor/imageseo/imageseo-php/README.md](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/README.md?rev=2226147 "Show what was removed (content at revision 3122913)")
  (deleted)
* [tags/3.1.2/vendor/imageseo/imageseo-php/composer.json](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/composer.json?rev=2226147 "Show what was removed (content at revision 3122913)")
  (deleted)
* [tags/3.1.2/vendor/imageseo/imageseo-php/composer.lock](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/composer.lock?rev=2226147 "Show what was removed (content at revision 3122913)")
  (deleted)
* [tags/3.1.2/vendor/imageseo/imageseo-php/src/Client/Resources.php](/browser/imageseo/tags/3.1.2/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file55 "Show differences"))
* [trunk/.github](/browser/imageseo/trunk/.github?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.github/workflows](/browser/imageseo/trunk/.github/workflows?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.github/workflows/deploy.yml](/browser/imageseo/trunk/.github/workflows/deploy.yml?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org](/browser/imageseo/trunk/.wordpress-org?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/banner-1544x500.png](/browser/imageseo/trunk/.wordpress-org/banner-1544x500.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/banner-772x250.png](/browser/imageseo/trunk/.wordpress-org/banner-772x250.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/icon-128x128.png](/browser/imageseo/trunk/.wordpress-org/icon-128x128.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/icon-256x256.png](/browser/imageseo/trunk/.wordpress-org/icon-256x256.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/icon.svg](/browser/imageseo/trunk/.wordpress-org/icon.svg?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/screenshot-1.png](/browser/imageseo/trunk/.wordpress-org/screenshot-1.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/screenshot-2.png](/browser/imageseo/trunk/.wordpress-org/screenshot-2.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/screenshot-3.png](/browser/imageseo/trunk/.wordpress-org/screenshot-3.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/screenshot-4.png](/browser/imageseo/trunk/.wordpress-org/screenshot-4.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/screenshot-5.png](/browser/imageseo/trunk/.wordpress-org/screenshot-5.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/screenshot-6.png](/browser/imageseo/trunk/.wordpress-org/screenshot-6.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/.wordpress-org/screenshot-7.png](/browser/imageseo/trunk/.wordpress-org/screenshot-7.png?rev=3122915 "Show entry in browser")
  (added)
* [trunk/dist/adminv2/index.asset.php](/browser/imageseo/trunk/dist/adminv2/index.asset.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file72 "Show differences"))
* [trunk/dist/adminv2/index.js](/browser/imageseo/trunk/dist/adminv2/index.js?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file73 "Show differences"))
* [trunk/dist/settingsv2/index.asset.php](/browser/imageseo/trunk/dist/settingsv2/index.asset.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file74 "Show differences"))
* [trunk/dist/settingsv2/index.css](/browser/imageseo/trunk/dist/settingsv2/index.css?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file75 "Show differences"))
* [trunk/dist/settingsv2/index.js](/browser/imageseo/trunk/dist/settingsv2/index.js?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file76 "Show differences"))
* [trunk/imageseo.php](/browser/imageseo/trunk/imageseo.php?rev=3122915 "Show entry in browser")
  (modified)
  ([3 diffs](#file77 "Show differences"))
* [trunk/readme.txt](/browser/imageseo/trunk/readme.txt?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file78 "Show differences"))
* [trunk/src/Actions/Admin/MediaLibrary.php](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3122915 "Show entry in browser")
  (modified)
  ([7 diffs](#file79 "Show differences"))
* [trunk/src/Actions/RestApi.php](/browser/imageseo/trunk/src/Actions/RestApi.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file80 "Show differences"))
* [trunk/src/Actions/VendorProtect.php](/browser/imageseo/trunk/src/Actions/VendorProtect.php?rev=3122915 "Show entry in browser")
  (added)
* [trunk/src/Admin/SettingsPage.php](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3122915 "Show entry in browser")
  (modified)
  ([7 diffs](#file82 "Show differences"))
* [trunk/src/Processes/OnUploadImage.php](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3122915 "Show entry in browser")
  (modified)
  ([4 diffs](#file83 "Show differences"))
* [trunk/src/Services/BulkOptimizer.php](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3122915 "Show entry in browser")
  (modified)
  ([4 diffs](#file84 "Show differences"))
* [trunk/src/Services/Option.php](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915 "Show entry in browser")
  (modified)
  ([9 diffs](#file85 "Show differences"))
* [trunk/src/Traits/Debug.php](/browser/imageseo/trunk/src/Traits/Debug.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file86 "Show differences"))
* [trunk/thirds/action-scheduler/README.md](/browser/imageseo/trunk/thirds/action-scheduler/README.md?rev=2702820 "Show what was removed (content at revision 3122914)")
  (deleted)
* [trunk/thirds/action-scheduler/lib/cron-expression/README.md](/browser/imageseo/trunk/thirds/action-scheduler/lib/cron-expression/README.md?rev=2702820 "Show what was removed (content at revision 3122914)")
  (deleted)
* [trunk/thirds/action-scheduler/vendor](/browser/imageseo/trunk/thirds/action-scheduler/vendor?rev=3011770 "Show what was removed (content at revision 3122914)")
  (deleted)
* [trunk/vendor/autoload.php](/browser/imageseo/trunk/vendor/autoload.php?rev=3122915 "Show entry in browser")
  (modified)
  ([1 diff](#file90 "Show differences"))
* [trunk/vendor/cocur/slugify/bin](/browser/imageseo/trunk/vendor/cocur/slugify/bin?rev=2226147 "Show what was removed (content at revision 3122914)")
  (deleted)
* [trunk/vendor/cocur/slugify/composer.json](/browser/imageseo/trunk/vendor/cocur/slugify/composer.json?rev=2226147 "Show what was removed (content at revision 3122914)")
  (deleted)
* [trunk/vendor/cocur/slugify/phpunit.xml.dist](/browser/imageseo/trunk/vendor/cocur/slugify/phpunit.xml.dist?rev=2226147 "Show what was removed (content at revision 3122914)")
  (deleted)
* [trunk/vendor/composer/ClassLoader.php](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915 "Show entry in browser")
  (modified)
  ([25 diffs](#file94 "Show differences"))
* [trunk/vendor/composer/InstalledVersions.php](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=3122915 "Show entry in browser")
  (modified)
  ([4 diffs](#file95 "Show differences"))
* [trunk/vendor/composer/autoload\_real.php](/browser/imageseo/trunk/vendor/composer/autoload_real.php?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file96 "Show differences"))
* [trunk/vendor/composer/autoload\_static.php](/browser/imageseo/trunk/vendor/composer/autoload_static.php?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file97 "Show differences"))
* [trunk/vendor/composer/installed.php](/browser/imageseo/trunk/vendor/composer/installed.php?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file98 "Show differences"))
* [trunk/vendor/imageseo/imageseo-php/README.md](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/README.md?rev=2226147 "Show what was removed (content at revision 3122914)")
  (deleted)
* [trunk/vendor/imageseo/imageseo-php/composer.json](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/composer.json?rev=2226147 "Show what was removed (content at revision 3122914)")
  (deleted)
* [trunk/vendor/imageseo/imageseo-php/composer.lock](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/composer.lock?rev=2226147 "Show what was removed (content at revision 3122914)")
  (deleted)
* [trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3122915 "Show entry in browser")
  (modified)
  ([2 diffs](#file102 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [imageseo/assets/icon.svg](/changeset/3122915/imageseo/assets/icon.svg "Show the changeset 3122915 restricted to imageseo/assets/icon.svg")

  + Property
    **svn:mime-type**
    set to
    *`image/svg+xml`*
* ## [imageseo/tags/3.1.2/dist/adminv2/index.asset.php](/changeset/3122915/imageseo/tags/3.1.2/dist/adminv2/index.asset.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/dist/adminv2/index.asset.php")

  | [r3093706](/browser/imageseo/trunk/dist/adminv2/index.asset.php?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/dist/adminv2/index.asset.php?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('react', 'wp-api-fetch', 'wp-components', 'wp-element', 'wp-i18n'), 'version' => '~~9770ee0bcdd9f55be14e~~'); |
  |  | 1 | <?php return array('dependencies' => array('react', 'wp-api-fetch', 'wp-components', 'wp-element', 'wp-i18n'), 'version' => '2eed19bf6cfb92ed1b2b'); |
* ## [imageseo/tags/3.1.2/dist/adminv2/index.js](/changeset/3122915/imageseo/tags/3.1.2/dist/adminv2/index.js "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/dist/adminv2/index.js")

  | [r3093706](/browser/imageseo/trunk/dist/adminv2/index.js?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/dist/adminv2/index.js?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | (()=>{"use strict";var e={n:t=>{var a=t&&t.\_\_esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};window.React;const t=window.wp.components,a=window.wp.element,n=window.wp.i18n,i=window.wp.apiFetch;var s=e.n(i);const o=async e=>{try{return await s()({path:"imageseo/v1/optimize-image/",method:"POST",data:e})}catch(e){console.error("Error calling the api:",e)}},r=async e=>{try{return await s()({path:"imageseo/v1/save-property/",method:"POST",data:e})}catch(e){console.error("Error calling the api:",e)}},c=new class{constructor(){this.listeners={}}subscribe(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}publish(e,t){this.listeners[e]&&this.listeners[e].forEach((e=>e(t)))}unsubscribe(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((e=>e!==t)))}};function l({attachmentId:e,alt:i}){const[s,l]=(0,a.useState)(i),[m,u]=(0,a.useState)(!1),[d,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,\_]=(0,a.useState)("");return React.createElement(t.Flex,{direction:"column"},React.createElement(t.FlexItem,null,React.createElement(t.TextControl,{label:(0,n.\_\_)("Alt","imageseo"),value:s||"",onChange:l})),React.createElement(t.FlexItem,null,React.createElement(t.ButtonGroup,null,React.createElement(t.Button,{style:{margin:"0 6px"},onClick:async()=>{m||(u(!0),g(!1),\_("save"),r({id:e,action:"saveAlt",value:s}).then((e=>{u(!1),e?.error||(l(e.altText||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Alt saved","imageseo"),status:"info"}))})).catch((e=>{console.error(e),u(!1),p(!0),g(!1),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},~~isPrimary:!0,isBusy:m},"save"===b&&d&&h?(0,n.\_\_)("Saved","imageseo"):(0,n.\_\_)("Save","imageseo")),React.createElement(t.Button,{variant:"tertiary",onClick:async()=>{m||(u(!0),g(!1),\_("optimize"),o({id:e,action:"optimizeAlt"}).then((e=>{u(!1),e?.error||(l(e.altText||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Alt optimized","imageseo"),status:"info"}))})).catch((e=>{c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"}),console.error(e),u(!1),p(!0),g(!1)})))},isBusy:m},"optimize"===b&&d&&h?(0,n.\_\_)("Optimized","imageseo"):(0,n.\_\_)("Optimize","imageseo")))))}function m({attachmentId:e,filename:i}){const[s,l]=(0,a.useState)(i),[m,u]=(0,a.useState)(!1),[d,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,\_]=(0,a.useState)("");return React.createElement(React.Fragment,null,React.createElement(t.Flex,{direction:"column"},React.createElement(t.FlexItem,null,React.createElement(t.TextControl,{label:(0,n.\_\_)("Filename","imageseo"),value:s||"",onChange:l})),React.createElement(t.FlexItem,null,React.createElement(t.ButtonGroup,null,React.createElement(t.Button,{style:{margin:"0 6px"},onClick:async()=>{m||(u(!0),g(!1),\_("save"),r({id:e,action:"saveFilename",value:s}).then((e=>{u(!1),e?.error||(p(!0),g(!0),l(e.filename||""),c.publish("snackbar",{content:(0,n.\_\_)("Filename saved","imageseo"),status:"info"}))})).catch((e=>{console.error(e),p(!0),g(!1),u(!1),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},isPrimary:!0~~,isBusy:m},"save"===b&&d&&h?(0,n.\_\_)("Saved","imageseo"):(0,n.\_\_)("Save","imageseo")),React.createElement(t.Button,{variant:"tertiary",onClick:async()=>{m||(\_("optimize"),u(!0),g(!1),o({id:e,action:"optimizeFilename"}).then((e=>{u(!1),e?.error||(l(e.filename||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Filename optimized","imageseo"),status:"info"}))})).catch((e=>{console.error(e),u(!1),g(!1),p(!0),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},isBusy:m},"optimize"===b&&d&&h?(0,n.\_\_)("Optimized","imageseo"):(0,n.\_\_)("Optimize","imageseo"))))))}function u(){const[e,n]=(0,a.useState)([]),i=(0,a.useCallback)((e=>{const t={id:(new Date).getTime(),...e,content:e?.content||"",politeness:e?.politeness||"polite",actions:e?.actions||[],explicitDismiss:e?.explicitDismiss||!1};n((e=>[...e,t]))}),[]),s=(0,a.useCallback)((e=>{n((t=>t.filter((t=>t.id!==e))))}),[]);return(0,a.useEffect)((()=>(console.log("Snackbar mounted"),c.subscribe("snackbar",i),()=>{c.unsubscribe("snackbar",i)})),[i]),React.createElement(t.SnackbarList,{notices:e,onRemove:s})}document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".media-column-imageseo-alt"),t=document.querySelectorAll(".media-column-imageseo-filename");e.forEach((e=>{const t=(0,a.createRoot)(e),n=e.getAttribute("data-id"),i=e.getAttribute("data-alt");t.render(React.createElement(l,{attachmentId:n,alt:i}))})),t.forEach((e=>{const t=(0,a.createRoot)(e),n=e.getAttribute("data-id"),i=e.getAttribute("data-filename");t.render(React.createElement(m,{attachmentId:n,filename:i}))}));const n=document.getElementById("wpbody-content"),i=document.createElement("div"),s=document.createElement("div");s.setAttribute("id","imageseo-snackbar-wrapper"),i.setAttribute("id","imageseo-snackbar-root"),s.style.position="fixed",s.style.left="10px",s.style.right="10px",s.style.bottom="10px",s.style.zIndex="1000",s.style.textAlign="center",s.style.width="100%",s.style.height="50px",s.style.pointerEvents="none",n.prepend(s),s.appendChild(i),(0,a.createRoot)(document.getElementById("imageseo-snackbar-root")).render(React.createElement(u,null))}))})(); |
  |  | 1 | (()=>{"use strict";var e={n:t=>{var a=t&&t.\_\_esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};window.React;const t=window.wp.components,a=window.wp.element,n=window.wp.i18n,i=window.wp.apiFetch;var s=e.n(i);const o=async e=>{try{return await s()({path:"imageseo/v1/optimize-image/",method:"POST",data:e})}catch(e){console.error("Error calling the api:",e)}},r=async e=>{try{return await s()({path:"imageseo/v1/save-property/",method:"POST",data:e})}catch(e){console.error("Error calling the api:",e)}},c=new class{constructor(){this.listeners={}}subscribe(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}publish(e,t){this.listeners[e]&&this.listeners[e].forEach((e=>e(t)))}unsubscribe(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((e=>e!==t)))}};function l({attachmentId:e,alt:i}){const[s,l]=(0,a.useState)(i),[m,u]=(0,a.useState)(!1),[d,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,\_]=(0,a.useState)("");return React.createElement(t.Flex,{direction:"column"},React.createElement(t.FlexItem,null,React.createElement(t.TextControl,{label:(0,n.\_\_)("Alt","imageseo"),value:s||"",onChange:l})),React.createElement(t.FlexItem,null,React.createElement(t.ButtonGroup,null,React.createElement(t.Button,{style:{margin:"0 6px"},onClick:async()=>{m||(u(!0),g(!1),\_("save"),r({id:e,action:"saveAlt",value:s}).then((e=>{u(!1),e?.error||(l(e.altText||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Alt saved","imageseo"),status:"info"}))})).catch((e=>{console.error(e),u(!1),p(!0),g(!1),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},variant:"primary",isBusy:m},"save"===b&&d&&h?(0,n.\_\_)("Saved","imageseo"):(0,n.\_\_)("Save","imageseo")),React.createElement(t.Button,{variant:"tertiary",onClick:async()=>{m||(u(!0),g(!1),\_("optimize"),o({id:e,action:"optimizeAlt"}).then((e=>{u(!1),e?.error||(l(e.altText||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Alt optimized","imageseo"),status:"info"}))})).catch((e=>{c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"}),console.error(e),u(!1),p(!0),g(!1)})))},isBusy:m},"optimize"===b&&d&&h?(0,n.\_\_)("Optimized","imageseo"):(0,n.\_\_)("Optimize","imageseo")))))}function m({attachmentId:e,filename:i}){const[s,l]=(0,a.useState)(i),[m,u]=(0,a.useState)(!1),[d,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,\_]=(0,a.useState)("");return React.createElement(React.Fragment,null,React.createElement(t.Flex,{direction:"column"},React.createElement(t.FlexItem,null,React.createElement(t.TextControl,{label:(0,n.\_\_)("Filename","imageseo"),value:s||"",onChange:l})),React.createElement(t.FlexItem,null,React.createElement(t.ButtonGroup,null,React.createElement(t.Button,{style:{margin:"0 6px"},onClick:async()=>{m||(u(!0),g(!1),\_("save"),r({id:e,action:"saveFilename",value:s}).then((e=>{u(!1),e?.error||(p(!0),g(!0),l(e.filename||""),c.publish("snackbar",{content:(0,n.\_\_)("Filename saved","imageseo"),status:"info"}))})).catch((e=>{console.error(e),p(!0),g(!1),u(!1),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},variant:"primary",isBusy:m},"save"===b&&d&&h?(0,n.\_\_)("Saved","imageseo"):(0,n.\_\_)("Save","imageseo")),React.createElement(t.Button,{variant:"tertiary",onClick:async()=>{m||(\_("optimize"),u(!0),g(!1),o({id:e,action:"optimizeFilename"}).then((e=>{u(!1),e?.error||(l(e.filename||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Filename optimized","imageseo"),status:"info"}))})).catch((e=>{console.error(e),u(!1),g(!1),p(!0),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},isBusy:m},"optimize"===b&&d&&h?(0,n.\_\_)("Optimized","imageseo"):(0,n.\_\_)("Optimize","imageseo"))))))}function u(){const[e,n]=(0,a.useState)([]),i=(0,a.useCallback)((e=>{const t={id:(new Date).getTime(),...e,content:e?.content||"",politeness:e?.politeness||"polite",actions:e?.actions||[],explicitDismiss:e?.explicitDismiss||!1};n((e=>[...e,t]))}),[]),s=(0,a.useCallback)((e=>{n((t=>t.filter((t=>t.id!==e))))}),[]);return(0,a.useEffect)((()=>(console.log("Snackbar mounted"),c.subscribe("snackbar",i),()=>{c.unsubscribe("snackbar",i)})),[i]),React.createElement(t.SnackbarList,{notices:e,onRemove:s})}document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".media-column-imageseo-alt"),t=document.querySelectorAll(".media-column-imageseo-filename");e.forEach((e=>{const t=(0,a.createRoot)(e),n=e.getAttribute("data-id"),i=e.getAttribute("data-alt");t.render(React.createElement(l,{attachmentId:n,alt:i}))})),t.forEach((e=>{const t=(0,a.createRoot)(e),n=e.getAttribute("data-id"),i=e.getAttribute("data-filename");t.render(React.createElement(m,{attachmentId:n,filename:i}))}));const n=document.getElementById("wpbody-content"),i=document.createElement("div"),s=document.createElement("div");s.setAttribute("id","imageseo-snackbar-wrapper"),i.setAttribute("id","imageseo-snackbar-root"),s.style.position="fixed",s.style.left="10px",s.style.right="10px",s.style.bottom="10px",s.style.zIndex="1000",s.style.textAlign="center",s.style.width="100%",s.style.height="50px",s.style.pointerEvents="none",n.prepend(s),s.appendChild(i),(0,a.createRoot)(document.getElementById("imageseo-snackbar-root")).render(React.createElement(u,null))}))})(); |
* ## [imageseo/tags/3.1.2/dist/settingsv2/index.asset.php](/changeset/3122915/imageseo/tags/3.1.2/dist/settingsv2/index.asset.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/dist/settingsv2/index.asset.php")

  | [r3093706](/browser/imageseo/trunk/dist/settingsv2/index.asset.php?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/dist/settingsv2/index.asset.php?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('react', 'wp-api-fetch', 'wp-components', 'wp-element', 'wp-i18n'), 'version' => '~~c15c473d467a705c9f0a~~'); |
  |  | 1 | <?php return array('dependencies' => array('react', 'wp-api-fetch', 'wp-components', 'wp-element', 'wp-i18n'), 'version' => '4a37b100f7190a817199'); |
* ## [imageseo/tags/3.1.2/dist/settingsv2/index.css](/changeset/3122915/imageseo/tags/3.1.2/dist/settingsv2/index.css "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/dist/settingsv2/index.css")

  | [r3093706](/browser/imageseo/trunk/dist/settingsv2/index.css?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/dist/settingsv2/index.css?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | #imageseo-settings-v2{margin~~-right:20px;margin-top:20px;.media-uploader-container{cursor:pointer}.media-uploader{width:330px;.components-base-control\_\_field{align-items:center;display:flex;justify-content:space-between;img{max-width:150px}}}.header-container{align-items:center;display:flex;justify-content:space-between;width:100%}.header{align-items:center;display:flex;justify-content:center;.logo{margin-right:10px;width:35px}.visit-website{margin-left:10px}~~}.cta{align-items:center;justify-content:center}.cta,.welcome-screen{display:flex;flex-direction:column}.welcome-screen{margin:30px auto 0;width:700px}.form-container{margin-top:30px;.components-base-control{margin-bottom:15px}}.social-card-screen{align-items:center;-moz-column-gap:30px;column-gap:30px;display:flex;justify-content:space-between;margin-top:30px;.components-base-control{margin-bottom:15px}.previewer{align-items:center;border:1px solid #949494;border-radius:5px;display:flex;height:340px;justify-content:space-between;width:700px;.bg-image{background-position:50%;background-repeat:no-repeat;background-size:cover}.bg-image,.content{flex-grow:1;height:100%;width:50%}.content{align-items:center;display:flex;flex-direction:column;justify-content:center}.padded{padding:20px}.logo{max-width:100px}}}.bulk-optimizer-screen{-moz-column-gap:30px;column-gap:30px;display:flex;flex-direction:row;margin-top:30px;.form{flex-grow:1}.components-base-control{margin-bottom:15px}.optimizer{align-items:center;border:1px solid #949494;border-radius:5px;display:flex;flex-direction:column;justify-content:center;padding:20px;width:45%;.progress{align-items:center;display:flex;flex-direction:column;justify-content:center;progress{margin-top:15px}}}}.settings-screen{margin-top:30px;.components-base-control{margin-bottom:15px}}} |
  |  | 1 | #imageseo-settings-v2{margin:20px auto;max-width:960px;.media-uploader-container{cursor:pointer}.media-uploader{width:330px;.components-base-control\_\_field{align-items:center;display:flex;justify-content:space-between;img{max-width:150px}}}.header-container{align-items:center;display:flex;justify-content:space-between;width:100%}.header{align-items:center;display:flex;justify-content:center;.logo{margin-right:10px;width:35px}.visit-website{margin-left:10px}}.remaining-credits-info{background-color:#ffd958;font-weight:700;padding:9px 12px}.cta{align-items:center;justify-content:center}.cta,.welcome-screen{display:flex;flex-direction:column}.welcome-screen{margin:30px auto 0;width:700px}.form-container{margin-top:30px;.components-base-control{margin-bottom:15px}}.social-card-screen{align-items:center;-moz-column-gap:30px;column-gap:30px;display:flex;justify-content:space-between;margin-top:30px;.components-base-control{margin-bottom:15px}.previewer{align-items:center;border:1px solid #949494;border-radius:5px;display:flex;height:340px;justify-content:space-between;width:700px;.bg-image{background-position:50%;background-repeat:no-repeat;background-size:cover}.bg-image,.content{flex-grow:1;height:100%;width:50%}.content{align-items:center;display:flex;flex-direction:column;justify-content:center}.padded{padding:20px}.logo{max-width:100px}}}.bulk-optimizer-screen{-moz-column-gap:30px;column-gap:30px;display:flex;flex-direction:row;margin-top:30px;.form{flex-grow:1}.components-base-control{margin-bottom:15px}.optimizer{align-items:center;border:1px solid #949494;border-radius:5px;display:flex;flex-direction:column;justify-content:center;padding:20px;width:45%;.progress{align-items:center;display:flex;flex-direction:column;justify-content:center;progress{margin-top:15px}}}}.settings-screen{margin-top:30px;.components-base-control{margin-bottom:15px}}} |
* ## [imageseo/tags/3.1.2/dist/settingsv2/index.js](/changeset/3122915/imageseo/tags/3.1.2/dist/settingsv2/index.js "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/dist/settingsv2/index.js")

  | [r3093706](/browser/imageseo/trunk/dist/settingsv2/index.js?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/dist/settingsv2/index.js?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | (()=>{"use strict";var e={~~63:(e,t,a)=>{var n=a(609),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=n.useState,i=n.useEffect,l=n.useLayoutEffect,s=n.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!o(e,a)}catch(e){return!0}}var m="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),n=r({inst:{value:a,getSnapshot:t}}),o=n[0].inst,m=n[1];return l((function(){o.value=a,o.getSnapshot=t,c(o)&&m({inst:o})}),[e,a,t]),i((function(){return c(o)&&m({inst:o}),e((function(){c(o)&&m({inst:o})}))}),[e]),s(a),a};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:m},888:(e,t,a)=>{e.exports=a(63)},609:e=>{e.exports=window.React}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.\_\_esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.\*$/,"").replace(/\?.\*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e=a(609);const t=window.wp.components,n=window.wp.element,o=a.p+"images/default\_logo.a24dbeff.png",r=window.wp.i18n,i=window.wp.apiFetch;var l=a.n(i);const s=async e=>await l()({path:e,method:"GET"}),c=async([e,t])=>(await l()({path:e,method:"POST",data:t})).data;var m=a(888);const u=()=>{},d=u(),g=Object,p=e=>e===d,\_=e=>"function"==typeof e,f=(e,t)=>({...e,...t}),E=new WeakMap;let h=0;const R=e=>{const t=typeof e,a=e&&e.constructor,n=a==Date;let o,r;if(g(e)!==e||n||a==RegExp)o=n?e.toJSON():"symbol"==t?e.toString():"string"==t?JSON.stringify(e):""+e;else{if(o=E.get(e),o)return o;if(o=++h+"~",E.set(e,o),a==Array){for(o="@",r=0;r<e.length;r++)o+=R(e[r])+",";E.set(e,o)}if(a==g){o="#";const t=g.keys(e).sort();for(;!p(r=t.pop());)p(e[r])||(o+=r+":"+R(e[r])+",");E.set(e,o)}}return o},v=new WeakMap,y={},b={},w="undefined",S=typeof window!=w,C=typeof document!=w,T=(e,t)=>{const a=v.get(e);return[()=>!p(t)&&e.get(t)||y,n=>{if(!p(t)){const o=e.get(t);t in b||(b[t]=o),a[5](t,f(o,n),o||y)}},a[6],()=>!p(t)&&t in b?b[t]:!p(t)&&e.get(t)||y]};let x=!0;const[k,O]=S&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[u,u],L={isOnline:()=>x,isVisible:()=>{const e=C&&document.visibilityState;return p(e)||"hidden"!==e}},N={initFocus:e=>(C&&document.addEventListener("visibilitychange",e),k("focus",e),()=>{C&&document.removeEventListener("visibilitychange",e),O("focus",e)}),initReconnect:e=>{const t=()=>{x=!0,e()},a=()=>{x=!1};return k("online",t),k("offline",a),()=>{O("online",t),O("offline",a)}}},M=!e.useId,I=!S||"Deno"in window,P=I?e.useEffect:e.useLayoutEffect,A="undefined"!=typeof navigator&&navigator.connection,F=!I&&A&&(["slow-2g","2g"].includes(A.effectiveType)||A.saveData),B=e=>{if(\_(e))try{e=e()}catch(t){e=""}const t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?R(e):"",t]};let z=0;const D=()=>++z;async function V(...e){const[t,a,n,o]=e,r=f({populateCache:!0,throwOnError:!0},"boolean"==typeof o?{revalidate:o}:o||{});let i=r.populateCache;const l=r.rollbackOnError;let s=r.optimisticData;const c=r.throwOnError;if(\_(a)){const e=a,n=[],o=t.keys();for(const a of o)!/^\$(inf|sub)\$/.test(a)&&e(t.get(a).\_k)&&n.push(a);return Promise.all(n.map(m))}return m(a);async function m(a){const[o]=B(a);if(!o)return;const[m,u]=T(t,o),[g,f,E,h]=v.get(t),R=()=>{const e=g[o];return(\_(r.revalidate)?r.revalidate(m().data,a):!1!==r.revalidate)&&(delete E[o],delete h[o],e&&e[0])?e[0](2).then((()=>m().data)):m().data};if(e.length<3)return R();let y,b=n;const w=D();f[o]=[w,0];const S=!p(s),C=m(),x=C.data,k=C.\_c,O=p(k)?x:k;if(S&&(s=\_(s)?s(O,x):s,u({data:s,\_c:O})),\_(b))try{b=b(O)}catch(e){y=e}if(b&&\_(b.then)){if(b=await b.catch((e=>{y=e})),w!==f[o][0]){if(y)throw y;return b}y&&S&&(e=>"function"==typeof l?l(e):!1!==l)(y)&&(i=!0,u({data:O,\_c:d}))}if(i&&!y)if(\_(i)){const e=i(b,O);u({data:e,error:d,\_c:d})}else u({data:b,error:d,\_c:d});if(f[o][1]=D(),Promise.resolve(R()).then((()=>{u({\_c:d})})),!y)return b;if(c)throw y}}const G=(e,t)=>{for(const a in e)e[a][0]&&e[a][0](t)},$=(e,t)=>{if(!v.has(e)){const a=f(N,t),n={},o=V.bind(d,e);let r=u;const i={},l=(e,t)=>{const a=i[e]||[];return i[e]=a,a.push(t),()=>a.splice(a.indexOf(t),1)},s=(t,a,n)=>{e.set(t,a);const o=i[t];if(o)for(const e of o)e(a,n)},c=()=>{if(!v.has(e)&&(v.set(e,[n,{},{},{},o,s,l]),!I)){const t=a.initFocus(setTimeout.bind(d,G.bind(d,n,0))),o=a.initReconnect(setTimeout.bind(d,G.bind(d,n,1)));r=()=>{t&&t(),o&&o(),v.delete(e)}}};return c(),[e,o,c,r]}return[e,v.get(e)[4]]},[W,H]=$(new Map),j=f({onLoadingSlow:u,onSuccess:u,onError:u,onErrorRetry:(e,\_\_,t,a,n)=>{const o=t.errorRetryCount,r=n.retryCount,i=~~((Math.random()+.5)\*(1<<(r<8?r:8)))\*t.errorRetryInterval;!p(o)&&r>o||setTimeout(a,i,n)},onDiscarded:u,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:F?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:F?5e3:3e3,compare:(e,t)=>R(e)==R(t),isPaused:()=>!1,cache:W,mutate:H,fallback:{}},L),U=(e,t)=>{const a=f(e,t);if(t){const{use:n,fallback:o}=e,{use:r,fallback:i}=t;n&&r&&(a.use=n.concat(r)),o&&i&&(a.fallback=f(o,i))}return a},K=(0,e.createContext)({}),Y=S&&window.\_\_SWR\_DEVTOOLS\_USE\_\_,q=Y?window.\_\_SWR\_DEVTOOLS\_USE\_\_:[],J=q.concat((e=>(t,a,n)=>e(t,a&&((...e)=>{const[n]=B(t),[,,,o]=v.get(W);if(n.startsWith("$inf$"))return a(...e);const r=o[n];return p(r)?a(...e):(delete o[n],r)}),n)));Y&&(window.\_\_SWR\_DEVTOOLS\_REACT\_\_=e);const X=e.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(e.status="pending",e.then((t=>{e.status="fulfilled",e.value=t}),(t=>{e.status="rejected",e.reason=t})),e)}),Q={dedupe:!0},Z=(g.defineProperty((t=>{const{value:a}=t,n=(0,e.useContext)(K),o=\_(a),r=(0,e.useMemo)((()=>o?a(n):a),[o,n,a]),i=(0,e.useMemo)((()=>o?r:U(n,r)),[o,n,r]),l=r&&r.provider,s=(0,e.useRef)(d);l&&!s.current&&(s.current=$(l(i.cache||W),r));const c=s.current;return c&&(i.cache=c[0],i.mutate=c[1]),P((()=>{if(c)return c[2]&&c[2](),c[3]}),[]),(0,e.createElement)(K.Provider,f(t,{value:i}))}),"defaultValue",{value:j}),ee=(t,a,n)=>{const{cache:o,compare:r,suspense:i,fallbackData:l,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:u,refreshWhenHidden:g,refreshWhenOffline:E,keepPreviousData:h}=n,[R,y,b,C]=v.get(o),[x,k]=B(t),O=(0,e.useRef)(!1),L=(0,e.useRef)(!1),N=(0,e.useRef)(x),A=(0,e.useRef)(a),F=(0,e.useRef)(n),z=()=>F.current,G=()=>z().isVisible()&&z().isOnline(),[$,W,H,j]=T(o,x),U=(0,e.useRef)({}).current,K=p(l)?n.fallback[x]:l,Y=(e,t)=>{for(const a in U){const n=a;if("data"===n){if(!r(e[n],t[n])){if(!p(e[n]))return!1;if(!r(re,t[n]))return!1}}else if(t[n]!==e[n])return!1}return!0},q=(0,e.useMemo)((()=>{const e=!!x&&!!a&&(p(s)?!z().isPaused()&&!i&&(!!p(c)||c):s),t=t=>{const a=f(t);return delete a.\_k,e?{isValidating:!0,isLoading:!0,...a}:a},n=$(),o=j(),r=t(n),l=n===o?r:t(o);let m=r;return[()=>{const e=t($());return Y(e,m)?(m.data=e.data,m.isLoading=e.isLoading,m.isValidating=e.isValidating,m.error=e.error,m):(m=e,e)},()=>l]}),[o,x]),J=(0,m.useSyncExternalStore)((0,e.useCallback)((e=>H(x,((t,a)=>{Y(a,t)||e()}))),[o,x]),q[0],q[1]),Z=!O.current,ee=R[x]&&R[x].length>0,te=J.data,ae=p(te)?K:te,ne=J.error,oe=(0,e.useRef)(ae),re=h?p(te)?oe.current:te:ae,ie=!(ee&&!p(ne))&&(Z&&!p(s)?s:!z().isPaused()&&(i?!p(ae)&&c:p(ae)||c)),le=!!(x&&a&&Z&&ie),se=p(J.isValidating)?le:J.isValidating,ce=p(J.isLoading)?le:J.isLoading,me=(0,e.useCallback)((async e=>{const t=A.current;if(!x||!t||L.current||z().isPaused())return!1;let a,o,i=!0;const l=e||{},s=!b[x]||!l.dedupe,c=()=>M?!L.current&&x===N.current&&O.current:x===N.current,m={isValidating:!1,isLoading:!1},u=()=>{W(m)},g=()=>{const e=b[x];e&&e[1]===o&&delete b[x]},f={isValidating:!0};p($().data)&&(f.isLoading=!0);try{if(s&&(W(f),n.loadingTimeout&&p($().data)&&setTimeout((()=>{i&&c()&&z().onLoadingSlow(x,n)}),n.loadingTimeout),b[x]=[t(k),D()]),[a,o]=b[x],a=await a,s&&setTimeout(g,n.dedupingInterval),!b[x]||b[x][1]!==o)return s&&c()&&z().onDiscarded(x),!1;m.error=d;const e=y[x];if(!p(e)&&(o<=e[0]||o<=e[1]||0===e[1]))return u(),s&&c()&&z().onDiscarded(x),!1;const l=$().data;m.data=r(l,a)?l:a,s&&c()&&z().onSuccess(a,x,n)}catch(e){g();const t=z(),{shouldRetryOnError:a}=t;t.isPaused()||(m.error=e,s&&c()&&(t.onError(e,x,t),(!0===a||\_(a)&&a(e))&&(z().revalidateOnFocus&&z().revalidateOnReconnect&&!G()||t.onErrorRetry(e,x,t,(e=>{const t=R[x];t&&t[0]&&t[0](3,e)}),{retryCount:(l.retryCount||0)+1,dedupe:!0}))))}return i=!1,u(),!0}),[x,o]),ue=(0,e.useCallback)(((...e)=>V(o,N.current,...e)),[]);if(P((()=>{A.current=a,F.current=n,p(te)||(oe.current=te)})),P((()=>{if(!x)return;const e=me.bind(d,Q);let t=0;const a=((e,t,a)=>{const n=t[e]||(t[e]=[]);return n.push(a),()=>{const e=n.indexOf(a);e>=0&&(n[e]=n[n.length-1],n.pop())}})(x,R,((a,n={})=>{if(0==a){const a=Date.now();z().revalidateOnFocus&&a>t&&G()&&(t=a+z().focusThrottleInterval,e())}else if(1==a)z().revalidateOnReconnect&&G()&&e();else{if(2==a)return me();if(3==a)return me(n)}}));return L.current=!1,N.current=x,O.current=!0,W({\_k:k}),ie&&(p(ae)||I?e():(n=e,S&&typeof window.requestAnimationFrame!=w?window.requestAnimationFrame(n):setTimeout(n,1))),()=>{L.current=!0,a()};var n}),[x]),P((()=>{let e;function t(){const t=\_(u)?u($().data):u;t&&-1!==e&&(e=setTimeout(a,t))}function a(){$().error||!g&&!z().isVisible()||!E&&!z().isOnline()?t():me(Q).then(t)}return t(),()=>{e&&(clearTimeout(e),e=-1)}}),[u,g,E,x]),(0,e.useDebugValue)(re),i&&p(ae)&&x){if(!M&&I)throw new Error("Fallback data is required when using suspense in SSR.");A.current=a,F.current=n,L.current=!1;const e=C[x];if(!p(e)){const t=ue(e);X(t)}if(!p(ne))throw ne;{const e=me(Q);p(re)||(e.status="fulfilled",e.value=!0),X(e)}}return{mutate:ue,get data(){return U.data=!0,re},get error(){return U.error=!0,ne},get isValidating(){return U.isValidating=!0,se},get isLoading(){return U.isLoading=!0,ce}}},function(...t){const a=f(j,(0,e.useContext)(K)),[n,o,r]=(e=>\_(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}])(t),i=U(a,r);let l=ee;const{use:s}=i,c=(s||[]).concat(J);for(let e=c.length;e--;)l=c[e](l);return l(n,o||i.fetcher||null,i)});var ee;const te={options:"undefined"!=typeof imageSeoSettings?imageSeoSettings:{},global:"undefined"!=typeof imageSeoGlobal?imageSeoGlobal:{}},ae="SET\_OPTIONS",ne="OPTIONS\_MODIFIED",oe=(e,t)=>{switch(t.type){case ae:return{...e,options:{...e.options,...t.payload}};case ne:return{...e,optionsModified:t.payload};default:return e}},re=(0,n.createContext)(te),ie=({children:e})=>{const t=(0,n.useRef)(!0),[a,o]=(0,n.useState)([]),[i,s]=(0,n.useState)(!1),[c,m]=(0,n.useReducer)(oe,te),[u,d]=((e,t,a={leading:!1})=>{const[o,r]=(0,n.useState)(e),i=(0,n.useRef)(null),l=(0,n.useRef)(!0),s=()=>window.clearTimeout(i.current);return(0,n.useEffect)((()=>s),[]),[o,(0,n.useCallback)((e=>{s(),l.current&&a.leading?r(e):i.current=window.setTimeout((()=>{l.current=!0,r(e)}),t),l.current=!1}),[a.leading,t])]})(te.options,500),g=(0,n.useCallback)(((e,t=!1)=>{m({type:ae,payload:e}),t||(m({type:ne,payload:!0}),d({...c.options,...e}))}),[d,c.options]),p=(0,n.useCallback)((e=>{const t={id:(new Date).getTime(),...e,content:e?.content||"",politeness:e?.politeness||"polite",actions:e?.actions||[],explicitDismiss:e?.explicitDismiss||!1};o((e=>[...e,t]))}),[]),\_=(0,n.useCallback)((e=>{o((t=>t.filter((t=>t.id!==e))))}),[]),f=(0,n.useMemo)((()=>({options:c.options,global:c.global,loading:i,setOptions:g,addNotice:p,removeNotice:\_,notices:a})),[p,i,a,\_,g,c.global,c.options]),E=(0,n.useMemo)((()=>u),[u]);return(0,n.useEffect)((()=>{t.current||c.optionsModified&&(async(e,t)=>{try{const{user:e,...a}=t;await l()({path:"imageseo/v1/settings",method:"POST",data:{...a}})}catch(e){console.error("Error saving settings:",e)}})(0,E).then((()=>{s(!1),p({status:"info",content:(0,r.\_\_)("Options saved","imageseo")})})).catch((e=>{console.warn(e),p({status:"error",content:(0,r.\_\_)("Error saving options","imageseo")}),s(!1)}))}),[p,E,c.optionsModified]),(0,n.useEffect)((()=>{t.current&&(t.current=!1)}),[]),React.createElement(re.Provider,{value:f},e)},le=()=>{const e=(0,n.useContext)(re);if(void 0===e)throw new Error("useSettings must be used within a SettingsProvider");return e},se=({heading:e,children:a,saveButton:i})=>{const{options:l}=le(),{data:s,isLoading:m}=(e=>{const[t,a]=(0,n.useState)(!0),{setOptions:o,addNotice:r}=le(),{data:i,error:l,isLoading:s,mutate:m}=Z([e?"/imageseo/v1/validate-api-key":null,{apiKey:e}],c,{onError:()=>{a(!1)},onSuccess:e=>{if(a(!1),e?.message)return o({allowed:!1}),void r({status:"error",content:e.message});o({allowed:!0},!0)}});return{data:i,error:l,isLoading:t,isFetching:s,mutate:m}})(l.apiKey),u=(0,n.useMemo)((()=>{if(m||!s)return 0;if("Invalid API Key"===s?.message)return 0;const{user:e}=s,t=e?.plan?.limitImages+e?.bonusStockImages-e?.currentRequestImages;return isNaN(t)?0:t}),[s,m]),d=(0,n.useCallback)((()=>{window.open("https://app.imageseo.com/plan/","\_blank")}),[]);return React.createElement(t.Animate,{type:m?"loading":""},(({className:n})=>React.createElement(t.Card,null,React.createElement(t.CardHeader,null,React.createElement("div",{className:"header-container"},React.createElement("div",{className:"header"},React.createElement("img",{className:"logo",src:o,alt:"logo"}),React.createElement(t.\_\_experimentalHeading,{align:"center"},e),React.createElement(t.ExternalLink,{className:"visit-website",href:"https://www.imageseo.com",target:"\_blank"},(0,r.\_\_)("Visit website","imageseo"))),React.createElement("div",{className:"cta"},React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("Remaining credits:","imageseo")," ",u),React.createElement("span",null,React.createElement(t.Button,{variant:"primary",onClick:d},(0,r.\_\_)("Buy more!","imageseo")))))),React.createElement(t.CardBody,{className:n},a),React.createElement(t.CardFooter,null,React.createElement(t.\_\_experimentalText,null,""),i&&React.createElement(t.Button,{type:"submit",variant:"secondary"},(0,r.\_\_)("Save","imageseo"))))))},ce=()=>{const{options:e,global:a,setOptions:o,addNotice:i}=le(),[s,c]=(0,n.useState)(!1),[m,u]=(0,n.useState)(e?.allowed),[d,g]=(0,n.useState)(""),[p,\_]=(0,n.useState)({firstName:a?.user?.firstName||"",lastName:a?.user?.lastName||"",email:a?.user?.email||"",password:"",terms:!1,news:!1}),f=async()=>{try{g(""),c(!0);const t=await l()({path:"/imageseo/v1/validate-api-key",method:"POST",data:{apiKey:e.apiKey}});if(void 0!==t?.data?.message)return o({allowed:!1}),g(t?.data?.message),c(!1),void i({status:"error",content:t?.data?.message});c(!1),o({allowed:!0}),i({status:"success",content:(0,r.\_\_)("API key validated","imageseo")})}catch(e){c(!1),i({status:"error",content:(0,r.\_\_)("Error validating API key","imageseo")}),console.error("Error validating API key:",e)}},E=async()=>{try{c(!0);const e=await l()({path:"/imageseo/v1/register",method:"POST",data:p});if(Object.prototype.hasOwnProperty.call(e,"success")&&!e?.success)throw new Error(Array.isArray(e?.data?.message)?e?.data?.message.join(","):e?.data?.message);if(e?.message)throw i({status:"error",content:e?.message}),new Error("Something went wrong");o({apiKey:e?.projects?.[0]?.apiKey,allowed:!0},!1),i({status:"success",content:(0,r.\_\_)("Account created","imageseo")}),u(!0),c(!1)}catch(e){console.log(e),c(!1),i({status:"error",content:e.message}),console.error("Error registering account:",e)}},h=(e,t)=>{\_({...p,[e]:t})};return React.createElement("div",{className:"welcome-screen"},React.createElement(t.\_\_experimentalHeading,{order:3,lineHeight:2,align:"center"},(0,r.\_\_)("Welcome to ImageSEO","imageseo")),React.createElement(t.\_\_experimentalText,{align:"center"},(0,r.\_\_)("We are happy to see you here! ImageSEO is a WordPress plugin that helps you to optimize your images for search engines and social media.","imageseo")),React.createElement(t.Animate,{type:s?"loading":""},(({className:a})=>React.createElement(React.Fragment,null,m?React.createElement("div",{className:`form-container ${a||""}`},React.createElement(t.TextControl,{label:(0,r.\_\_)("API Key","imageseo"),value:e?.apiKey||"",onChange:e=>o({apiKey:e})}),React.createElement(t.Flex,{justifyContent:"spaceBetween"},React.createElement(t.FlexItem,null,React.createElement(t.Button,{disabled:s,isPrimary:!0,onClick:f},s?(0,r.\_\_)("Validating…","imageseo"):(0,r.\_\_)("Validate key","imageseo"))),!e?.allowed&&React.createElement(t.FlexItem,null,React.createElement(t.Button,{isTertiary:!0,onClick:()=>u(!1)},(0,r.\_\_)("I want to register for a free account","imageseo"))),e?.allowed&&React.createElement(t.FlexItem,null,React.createElement(t.Icon,{icon:"yes",style:{color:"#52c41a"}}),React.createElement(t.\_\_experimentalText,{variant:"muted"},(0,r.\_\_)("API key validated","imageseo")))),d&&React.createElement(t.\_\_experimentalText,{variant:"error"},d)):React.createElement("div",{className:`form-container ${a||""}`},React.createElement(t.TextControl,{label:(0,r.\_\_)("First name","imageseo"),value:p.firstName,onChange:e=>h("firstName",e)}),React.createElement(t.TextControl,{label:(0,r.\_\_)("Last name","imageseo"),value:p.lastName,onChange:e=>h("lastName",e)}),React.createElement(t.TextControl,{label:(0,r.\_\_)("Email","imageseo"),type:"email",value:p.email,onChange:e=>h("email",e)}),React.createElement(t.TextControl,{type:"password",label:(0,r.\_\_)("Password","imageseo"),value:p.password,onChange:e=>h("password",e)}),React.createElement(t.CheckboxControl,{label:(0,r.\_\_)("I agree to the terms and conditions","imageseo"),help:React.createElement(t.\_\_experimentalText,{variant:"muted"},(0,r.\_\_)("By creating an account, you agree to our terms and conditions.","imageseo"),React.createElement(t.ExternalLink,{style:{marginLeft:5},href:"https://imageseo.io/terms-conditions/"},(0,r.\_\_)("Read more","imageseo"))),checked:p.terms,onChange:e=>h("terms",e)}),React.createElement(t.CheckboxControl,{label:(0,r.\_\_)("I want to receive news and updates","imageseo"),help:(0,r.\_\_)("You can unsubscribe at any time","imageseo"),checked:p.news,onChange:e=>h("news",e)}),React.createElement(t.Flex,null,React.createElement(t.FlexItem,null,React.createElement(t.Button,{isPrimary:!0,disabled:s,onClick:E},(0,r.\_\_)("Create account","imageseo"))),React.createElement(t.FlexItem,null,React.createElement(t.Button,{isTertiary:!0,disabled:s,onClick:()=>u(!0)},(0,r.\_\_)("I already have an account","imageseo")))))))))},me=({id:e,label:a,help:o,value:i,onChange:l})=>{const[s,c]=(0,n.useState)(i),m=()=>{const e=wp.media({title:(0,r.\_\_)("Select or Upload Media","imageseo"),button:{text:(0,r.\_\_)("Use this item","imageseo")},multiple:!1});e.on("select",(()=>{const t=e.state().get("selection").first().toJSON();c(t.url),l(t.url)})),e.open()};return React.createElement("div",{className:"media-uploader-container",onClick:m},React.createElement(t.BaseControl,{id:e,label:a,help:o,className:"media-uploader"},!s&&React.createElement(t.Button,{isPrimary:!0,onClick:m},(0,r.\_\_)("Select Image","imageseo")),s&&React.createElement("img",{src:s,alt:"Selected"})))},ue=()=>{const{options:e,setOptions:a}=le();return React.createElement("div",null,React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Subtitle","imageseo"),checked:e.socialMediaSettings?.visibilitySubTitle,onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,visibilitySubTitle:t}})},help:(0,r.\_\_)("Show the price product or author depending on the page ( Product price (WooCommerce only) )","imageseo")}),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Subtitle 2","imageseo"),checked:e.socialMediaSettings?.visibilitySubTitleTwo,onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,visibilitySubTitleTwo:t}})},help:(0,r.\_\_)("Show the reading time of an article or the number of reviews (WooCommerce only).","imageseo")}),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Stars rating","imageseo"),checked:e.socialMediaSettings?.visibilityRating,onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,visibilityRating:t}})},help:(0,r.\_\_)("Show the stars linked to a review of your product for example.","imageseo")}),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Author avatar","imageseo"),checked:e.socialMediaSettings?.visibilityAvatar,onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,visibilityAvatar:t}})},help:(0,r.\_\_)("Only used for post content.","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControl,{style:{width:300},value:e.socialMediaSettings?.layout||"CARD\_LEFT",label:(0,r.\_\_)("Layout","imageseo"),help:(0,r.\_\_)("Choose the layout of the social card.","imageseo"),onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,layout:t}})}},React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"CARD\_LEFT",label:(0,r.\_\_)("Card left","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"CARD\_RIGHT",label:(0,r.\_\_)("Card right","imageseo")})),React.createElement(t.\_\_experimentalToggleGroupControl,{value:e.socialMediaSettings?.textAlignment||"top",onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,textAlignment:t}})},label:(0,r.\_\_)("Text alignment","imageseo")},React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"top",label:(0,r.\_\_)("Top","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"center",label:(0,r.\_\_)("Center","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"bottom",label:(0,r.\_\_)("Bottom","imageseo")})),React.createElement(t.\_\_experimentalGrid,{columns:3},React.createElement(t.BaseControl,{id:"text-color",label:(0,r.\_\_)("Text color","imageseo")},React.createElement(t.ColorPicker,{defaultValue:e.socialMediaSettings?.textColor||"#000000",onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,textColor:t}})}})),React.createElement(t.BaseControl,{id:"background-color",label:(0,r.\_\_)("Background color","imageseo")},React.createElement(t.ColorPicker,{defaultValue:e.socialMediaSettings?.contentBackgroundColor||"#ffffff",onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,contentBackgroundColor:t}})}})),e.socialMediaSettings?.visibilityRating&&React.createElement(t.BaseControl,{id:"star-color",label:(0,r.\_\_)("Star color","imageseo")},React.createElement(t.ColorPicker,{defaultValue:e.socialMediaSettings?.starColor||"#F8CA00",onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,starColor:t}})}}))),React.createElement(me,{label:(0,r.\_\_)("Logo","imageseo"),value:e?.socialMediaSettings?.logoUrl,help:(0,r.\_\_)("Click to upload a logo","imageseo"),onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,logoUrl:t}})}}),React.createElement(t.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(me,{label:(0,r.\_\_)("Background image","imageseo"),value:e?.socialMediaSettings?.defaultBgImg,help:(0,r.\_\_)("Click to upload a background Image","imageseo"),onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,defaultBgImg:t}})}}))},de=a.p+"images/avatar-default.00d4ecf9.jpg",ge=({color:e})=>React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:e||"rgb(248, 202, 0)",stroke:e||"rgb(248, 202, 0)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-star"},React.createElement("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})),pe=()=>{const{options:e}=le(),a=e?.socialMediaSettings||{},{layout:n,defaultBgImg:o,logoUrl:i,textColor:l,visibilitySubTitle:s,visibilitySubTitleTwo:c,visibilityRating:m,visibilityAvatar:u,contentBackgroundColor:d,starColor:g}=a;return React.createElement("div",{className:"previewer"},"CARD\_LEFT"===n&&React.createElement("div",{className:"bg-image",style:{backgroundImage:`url(${o})`}}),React.createElement("div",{className:"content",style:{backgroundColor:d}},React.createElement("div",{className:"padded"},React.createElement("img",{src:i,alt:"logo",className:"logo"}),React.createElement(t.\_\_experimentalHeading,{level:2,lineHeight:1.5,style:{color:l}},(0,r.\_\_)("Lorem ipsum (post title)","imageseo")),s&&React.createElement(t.\_\_experimentalHeading,{level:3,lineHeight:1.5,style:{color:l}},(0,r.\_\_)("Lorem ipsum (sub title)","imageseo")),c&&React.createElement(t.\_\_experimentalHeading,{level:4,lineHeight:1.5,style:{color:l}},(0,r.\_\_)("Lorem ipsum (sub title two)","imageseo")),u&&React.createElement("img",{src:de,alt:"default avatar",className:"avatar"}),m&&React.createElement("div",null,React.createElement(ge,{color:g}),React.createElement(ge,{color:g}),React.createElement(ge,{color:g}),React.createElement(ge,{color:g}),React.createElement(ge,{color:g})))),"CARD\_RIGHT"===n&&React.createElement("div",{className:"bg-image",style:{backgroundImage:`url(${o})`}}))},\_e=()=>{const{loading:e}=le();return React.createElement(t.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""} social-card-screen`},React.createElement(ue,null),React.createElement(pe,null))))},fe=()=>{const[e,t]=(0,n.useState)(!0),{data:a,error:o,isLoading:r,mutate:i}=Z("/imageseo/v1/image-query",s,{onError:()=>{t(!1)},onSuccess:()=>{t(!1)},revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1});return{data:a,error:o,isLoading:e,isFetching:r,mutate:i}},Ee=()=>{const{options:e,setOptions:a,global:n}=le(),{mutate:o}=fe();return React.createElement("div",{className:"form"},React.createElement(t.SelectControl,{label:(0,r.\_\_)("Images to optimize","imageseo"),value:e?.altFilter||"ALL",onChange:e=>{a({altFilter:e}),o()},options:(n.altSpecification||[]).map((e=>({value:e.id,label:e.label})))}),React.createElement(t.SelectControl,{label:(0,r.\_\_)("Optimize alt text","imageseo"),value:e?.altFill||"FILL\_ALL",onChange:e=>{a({altFill:e}),o()},options:[{value:"FILL\_ALL",label:(0,r.\_\_)("Optimize all ALT texts","imageseo")},{value:"FILL\_ONLY\_EMPTY",label:(0,r.\_\_)("Optimize only missing ALT texts","imageseo")}]}),React.createElement(t.ToggleControl,{checked:e?.optimizeFile,onChange:e=>{a({optimizeFile:e})},label:(0,r.\_\_)("Rename files","imageseo")}))},he=()=>{const[e,t]=(0,n.useState)(!0),{data:a,error:o,isLoading:r,mutate:i}=Z("/imageseo/v1/get-bulk-optimizer-status",s,{onError:()=>{t(!1)},onSuccess:()=>{t(!1)},refreshInterval:1e4});return{data:a,error:o,isLoading:e,isFetching:r,mutate:i}},Re=()=>{const{global:e,options:a,addNotice:o}=le(),{data:i,isLoading:s,error:c,mutate:m}=he(),{data:u,mutate:d}=fe(),g=async()=>{await l()({path:"/imageseo/v1/start-bulk-optimizer",method:"POST"}),m(),o({status:"success",content:(0,r.\_\_)("Optimizer started","imageseo")})},p=(0,n.useMemo)((()=>i?.report?.errors?.length>0&&void 0!==i?.report?.errors?.find((e=>"You have reached the limit of images to optimize"===e.trim()))),[i?.report?.errors]);return s?React.createElement(t.Placeholder,{className:"optimizer",icon:"update",label:(0,r.\_\_)("Loading","imageseo"),instructions:(0,r.\_\_)("Loading…","imageseo")}):c?React.createElement(t.Placeholder,{className:"optimizer",icon:"warning",label:(0,r.\_\_)("Error","imageseo"),instructions:(0,r.\_\_)("An error occurred while fetching the optimizer status.","imageseo")}):"idle"===i?.status&&p?React.createElement("div",{className:"optimizer"},React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("You have reached the limit of images to optimize.","imageseo")),React.createElement(t.\_\_experimentalSpacer,{marginY:"5"}),React.createElement(t.Button,{isPrimary:!0,disabled:"running"===i?.status,onClick:g},(0,r.\_\_)("Try again","imageseo"))):React.createElement("div",{className:"optimizer"},"idle"===i?.status&&React.createElement(React.Fragment,null,"NEXTGEN\_GALLERY"===a?.altFilter&&React.createElement(t.\_\_experimentalText,null,(0,r.sprintf)((0,r.\_\_)("There are %1$s images in your NEXTGEN library and %2$s don't have an alternative text.","imageseo"),e.bulkQuery.ids.length||0,e.bulkQuery.nonOptimized.length||0)),"NEXTGEN\_GALLERY"!==a?.altFilter&&React.createElement(t.\_\_experimentalText,null,(0,r.sprintf)((0,r.\_\_)("There are %1$s images in your media library and %2$s don't have an alternative text.","imageseo"),u?.totalImages||0,u?.totalNoAlt||0)),React.createElement(t.\_\_experimentalSpacer,{marginY:"5"}),React.createElement(t.Button,{isPrimary:!0,disabled:"running"===i?.status,onClick:g},(0,r.\_\_)("Start optimization","imageseo"))),"running"===i?.status&&React.createElement("div",{className:"progress"},React.createElement(t.\_\_experimentalText,null,(0,r.sprintf)((0,r.\_\_)("Optimizing %1$s images. ( %2$s/%3$s )","imageseo"),i?.report?.total,i?.report?.optimized,i?.report?.total)),React.createElement("progress",{value:i?.report?.optimized/i?.report?.total\*100,max:100}),React.createElement(t.\_\_experimentalSpacer,{marginY:"3"}),React.createElement(t.Button,{isPrimary:!0,onClick:async()=>{await l()({path:"/imageseo/v1/stop-bulk-optimizer",method:"POST"}),m(),d(),o({status:"success",content:(0,r.\_\_)("Optimizer stopped","imageseo")})}},(0,r.\_\_)("Stop optimizer","imageseo"))))},ve=()=>{const{loading:e}=le(),{data:a}=he();return React.createElement(t.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""}`},React.createElement(t.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(t.\_\_experimentalHeading,{level:4},"running"===a?.status?(0,r.\_\_)("Current report","imageseo"):(0,r.\_\_)("Last report","imageseo")),React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("Optimized: ","imageseo")," ",a?.report.optimized),React.createElement("br",null),React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("Skipped: ","imageseo")," ",a?.report.skipped),React.createElement("br",null),React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("Failed: ","imageseo")," ",a?.report.failed))))},ye=()=>{const{loading:e}=le();return React.createElement(t.Animate,{type:e?"loading":""},(({className:e})=>React.createElement(React.Fragment,null,React.createElement("div",{className:`${e||""} bulk-optimizer-screen`},React.createElement(Ee,null),React.createElement(Re,null)),React.createElement(ve,null))))},be=()=>{const{options:e,global:a,setOptions:o}=le(),i=(0,n.useMemo)((()=>{const t=e?.defaultLanguageIa||a?.currentLanguage||"en";return t.includes("\_")?t.split("\_")[0]:t}),[a?.currentLanguage,e?.defaultLanguageIa]);return React.createElement("div",null,React.createElement(t.\_\_experimentalHeading,{level:4,lineHeight:2},(0,r.\_\_)("On-upload optimization","imageseo")),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Fill alt","imageseo"),help:(0,r.\_\_)("The plugin will automatically write an alternative to the images you will upload.","imageseo"),checked:e.activeAltWriteUpload,onChange:e=>o({activeAltWriteUpload:e})}),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Rename files","imageseo"),help:(0,r.\_\_)("The plugin will automatically rewrite with SEO friendly content the name of the images you will upload.","imageseo"),checked:e.activeRenameWriteUpload,onChange:e=>o({activeRenameWriteUpload:e})}),React.createElement(t.SelectControl,{label:(0,r.\_\_)("Language","imageseo"),options:a.languages||[],onChange:e=>{o({defaultLanguageIa:e})},value:i}),React.createElement(t.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(t.\_\_experimentalHeading,{level:4,lineHeight:2},(0,r.\_\_)("Social media card generator","imageseo")),React.createElement(t.\_\_experimentalText,{style:{marginBottom:15,display:"inline-block"}},(0,r.\_\_)("Automatic generation for the following post types:","imageseo")),a?.allowedPostTypes?.map((a=>React.createElement("div",{key:a.value,style:{maxWidth:300}},React.createElement(t.ToggleControl,{\_\_nextHasNoMarginBottom:!0,checked:(e?.socialMediaPostTypes||[]).includes(a.value),label:a.label,onChange:t=>((t,a)=>{a&&!(e?.socialMediaPostTypes||[]).includes(t)&&o({socialMediaPostTypes:[...e?.socialMediaPostTypes||[],t]}),!a&&(e?.socialMediaPostTypes||[]).includes(t)&&o({socialMediaPostTypes:(e?.socialMediaPostTypes||[]).filter((e=>e!==t))})})(a.value,t)})))))},we=()=>{const{loading:e}=le();return React.createElement(t.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""} social-card-screen`},React.createElement(be,null))))},Se=()=>{const[e,a]=(0,n.useState)(!1),{data:o,isLoading:r}=Z("/imageseo/v1/optimizer-errors",s,{refreshInterval:1e4}),{data:i,isLoading:l}=Z("/imageseo/v1/debug-info",s,{refreshInterval:1e4});return(0,n.useEffect)((()=>{localStorage.getItem("imageseo\_debug\_log")&&a(!0)}),[]),e?r?React.createElement(t.Spinner,null):React.createElement(React.Fragment,null,React.createElement("h4",null,"Error Log"),React.createElement("pre",null,JSON.stringify(o,null,2)),React.createElement("h4",null,"Debug Info"),React.createElement("pre",null,JSON.stringify(i,null,2))):null},Ce=new URLSearchParams(window.location.search).get("activeTab"),Te=localStorage.getItem("imageseo\_debug\_log");function xe(){const{options:e,notices:a,removeNotice:o}=le(),[i,l]=(0,n.useState)(Ce||"welcome");return React.createElement(React.Fragment,null,React.createElement(se,{heading:(0,r.\_\_)("ImageSEO","imageseo")},React.createElement(t.\_\_experimentalToggleGroupControl,{label:"",onChange:e=>{l(e);const t=new URL(window.location.href);t.searchParams.set("activeTab",e),window.history.replaceState(null,null,t)},value:i,isBlock:!0},React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"welcome",label:(0,r.\_\_)("Welcome","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"socialcard",label:(0,r.\_\_)("Social card","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"bulkoptimizer",label:(0,r.\_\_)("Bulk optimization","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"settings",label:(0,r.\_\_)("Settings","imageseo")})),"welcome"===i&&React.createElement(ce,null),"socialcard"===i&&React.createElement(\_e,null),"bulkoptimizer"===i&&React.createElement(ye,null),"settings"===i&&React.createElement(we,null)),Te&&React.createElement(Se,null),React.createElement(t.SnackbarList,{notices:a,onRemove:o}))}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("imageseo-settings-v2");(0,n.createRoot)(e).render(React.createElement(ie,null,React.createElement(x~~e,null)))}))})()})(); |
  |  | 1 | (()=>{"use strict";var e={580:e=>{var t=/["'&<>]/;e.exports=function(e){var a,n=""+e,r=t.exec(n);if(!r)return n;var i="",o=0,l=0;for(o=r.index;o<n.length;o++){switch(n.charCodeAt(o)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 39:a="&#39;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}l!==o&&(i+=n.substring(l,o)),l=o+1,i+=a}return l!==o?i+n.substring(l,o):i}},63:(e,t,a)=>{var n=a(609),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useState,o=n.useEffect,l=n.useLayoutEffect,s=n.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!r(e,a)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),n=i({inst:{value:a,getSnapshot:t}}),r=n[0].inst,u=n[1];return l((function(){r.value=a,r.getSnapshot=t,c(r)&&u({inst:r})}),[e,a,t]),o((function(){return c(r)&&u({inst:r}),e((function(){c(r)&&u({inst:r})}))}),[e]),s(a),a};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:u},888:(e,t,a)=>{e.exports=a(63)},609:e=>{e.exports=window.React}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.\_\_esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.\*$/,"").replace(/\?.\*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e=a(609),t=a.n(e);const n=window.wp.components,r=window.wp.element,i=a.p+"images/default\_logo.a24dbeff.png",o=window.wp.i18n,l=window.wp.apiFetch;var s=a.n(l);const c=async e=>await s()({path:e,method:"GET"}),u=async([e,t])=>(await s()({path:e,method:"POST",data:t})).data;var m=a(888);const d=()=>{},g=d(),p=Object,h=e=>e===g,f=e=>"function"==typeof e,\_=(e,t)=>({...e,...t}),v=new WeakMap;let y=0;const b=e=>{const t=typeof e,a=e&&e.constructor,n=a==Date;let r,i;if(p(e)!==e||n||a==RegExp)r=n?e.toJSON():"symbol"==t?e.toString():"string"==t?JSON.stringify(e):""+e;else{if(r=v.get(e),r)return r;if(r=++y+"~",v.set(e,r),a==Array){for(r="@",i=0;i<e.length;i++)r+=b(e[i])+",";v.set(e,r)}if(a==p){r="#";const t=p.keys(e).sort();for(;!h(i=t.pop());)h(e[i])||(r+=i+":"+b(e[i])+",");v.set(e,r)}}return r},E=new WeakMap,R={},w={},S="undefined",C=typeof window!=S,T=typeof document!=S,x=(e,t)=>{const a=E.get(e);return[()=>!h(t)&&e.get(t)||R,n=>{if(!h(t)){const r=e.get(t);t in w||(w[t]=r),a[5](t,\_(r,n),r||R)}},a[6],()=>!h(t)&&t in w?w[t]:!h(t)&&e.get(t)||R]};let k=!0;const[N,O]=C&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[d,d],L={isOnline:()=>k,isVisible:()=>{const e=T&&document.visibilityState;return h(e)||"hidden"!==e}},I={initFocus:e=>(T&&document.addEventListener("visibilitychange",e),N("focus",e),()=>{T&&document.removeEventListener("visibilitychange",e),O("focus",e)}),initReconnect:e=>{const t=()=>{k=!0,e()},a=()=>{k=!1};return N("online",t),N("offline",a),()=>{O("online",t),O("offline",a)}}},M=!e.useId,A=!C||"Deno"in window,P=A?e.useEffect:e.useLayoutEffect,F="undefined"!=typeof navigator&&navigator.connection,z=!A&&F&&(["slow-2g","2g"].includes(F.effectiveType)||F.saveData),B=e=>{if(f(e))try{e=e()}catch(t){e=""}const t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?b(e):"",t]};let D=0;const H=()=>++D;async function $(...e){const[t,a,n,r]=e,i=\_({populateCache:!0,throwOnError:!0},"boolean"==typeof r?{revalidate:r}:r||{});let o=i.populateCache;const l=i.rollbackOnError;let s=i.optimisticData;const c=i.throwOnError;if(f(a)){const e=a,n=[],r=t.keys();for(const a of r)!/^\$(inf|sub)\$/.test(a)&&e(t.get(a).\_k)&&n.push(a);return Promise.all(n.map(u))}return u(a);async function u(a){const[r]=B(a);if(!r)return;const[u,m]=x(t,r),[d,p,\_,v]=E.get(t),y=()=>{const e=d[r];return(f(i.revalidate)?i.revalidate(u().data,a):!1!==i.revalidate)&&(delete \_[r],delete v[r],e&&e[0])?e[0](2).then((()=>u().data)):u().data};if(e.length<3)return y();let b,R=n;const w=H();p[r]=[w,0];const S=!h(s),C=u(),T=C.data,k=C.\_c,N=h(k)?T:k;if(S&&(s=f(s)?s(N,T):s,m({data:s,\_c:N})),f(R))try{R=R(N)}catch(e){b=e}if(R&&f(R.then)){if(R=await R.catch((e=>{b=e})),w!==p[r][0]){if(b)throw b;return R}b&&S&&(e=>"function"==typeof l?l(e):!1!==l)(b)&&(o=!0,m({data:N,\_c:g}))}if(o&&!b)if(f(o)){const e=o(R,N);m({data:e,error:g,\_c:g})}else m({data:R,error:g,\_c:g});if(p[r][1]=H(),Promise.resolve(y()).then((()=>{m({\_c:g})})),!b)return R;if(c)throw b}}const j=(e,t)=>{for(const a in e)e[a][0]&&e[a][0](t)},V=(e,t)=>{if(!E.has(e)){const a=\_(I,t),n={},r=$.bind(g,e);let i=d;const o={},l=(e,t)=>{const a=o[e]||[];return o[e]=a,a.push(t),()=>a.splice(a.indexOf(t),1)},s=(t,a,n)=>{e.set(t,a);const r=o[t];if(r)for(const e of r)e(a,n)},c=()=>{if(!E.has(e)&&(E.set(e,[n,{},{},{},r,s,l]),!A)){const t=a.initFocus(setTimeout.bind(g,j.bind(g,n,0))),r=a.initReconnect(setTimeout.bind(g,j.bind(g,n,1)));i=()=>{t&&t(),r&&r(),E.delete(e)}}};return c(),[e,r,c,i]}return[e,E.get(e)[4]]},[G,W]=V(new Map),U=\_({onLoadingSlow:d,onSuccess:d,onError:d,onErrorRetry:(e,\_\_,t,a,n)=>{const r=t.errorRetryCount,i=n.retryCount,o=~~((Math.random()+.5)\*(1<<(i<8?i:8)))\*t.errorRetryInterval;!h(r)&&i>r||setTimeout(a,o,n)},onDiscarded:d,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:z?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:z?5e3:3e3,compare:(e,t)=>b(e)==b(t),isPaused:()=>!1,cache:G,mutate:W,fallback:{}},L),K=(e,t)=>{const a=\_(e,t);if(t){const{use:n,fallback:r}=e,{use:i,fallback:o}=t;n&&i&&(a.use=n.concat(i)),r&&o&&(a.fallback=\_(r,o))}return a},Y=(0,e.createContext)({}),q=C&&window.\_\_SWR\_DEVTOOLS\_USE\_\_,J=q?window.\_\_SWR\_DEVTOOLS\_USE\_\_:[],X=J.concat((e=>(t,a,n)=>e(t,a&&((...e)=>{const[n]=B(t),[,,,r]=E.get(G);if(n.startsWith("$inf$"))return a(...e);const i=r[n];return h(i)?a(...e):(delete r[n],i)}),n)));q&&(window.\_\_SWR\_DEVTOOLS\_REACT\_\_=e);const Q=e.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(e.status="pending",e.then((t=>{e.status="fulfilled",e.value=t}),(t=>{e.status="rejected",e.reason=t})),e)}),Z={dedupe:!0},ee=(p.defineProperty((t=>{const{value:a}=t,n=(0,e.useContext)(Y),r=f(a),i=(0,e.useMemo)((()=>r?a(n):a),[r,n,a]),o=(0,e.useMemo)((()=>r?i:K(n,i)),[r,n,i]),l=i&&i.provider,s=(0,e.useRef)(g);l&&!s.current&&(s.current=V(l(o.cache||G),i));const c=s.current;return c&&(o.cache=c[0],o.mutate=c[1]),P((()=>{if(c)return c[2]&&c[2](),c[3]}),[]),(0,e.createElement)(Y.Provider,\_(t,{value:o}))}),"defaultValue",{value:U}),te=(t,a,n)=>{const{cache:r,compare:i,suspense:o,fallbackData:l,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:u,refreshWhenHidden:d,refreshWhenOffline:p,keepPreviousData:v}=n,[y,b,R,w]=E.get(r),[T,k]=B(t),N=(0,e.useRef)(!1),O=(0,e.useRef)(!1),L=(0,e.useRef)(T),I=(0,e.useRef)(a),F=(0,e.useRef)(n),z=()=>F.current,D=()=>z().isVisible()&&z().isOnline(),[j,V,G,W]=x(r,T),U=(0,e.useRef)({}).current,K=h(l)?n.fallback[T]:l,Y=(e,t)=>{for(const a in U){const n=a;if("data"===n){if(!i(e[n],t[n])){if(!h(e[n]))return!1;if(!i(ie,t[n]))return!1}}else if(t[n]!==e[n])return!1}return!0},q=(0,e.useMemo)((()=>{const e=!!T&&!!a&&(h(s)?!z().isPaused()&&!o&&(!!h(c)||c):s),t=t=>{const a=\_(t);return delete a.\_k,e?{isValidating:!0,isLoading:!0,...a}:a},n=j(),r=W(),i=t(n),l=n===r?i:t(r);let u=i;return[()=>{const e=t(j());return Y(e,u)?(u.data=e.data,u.isLoading=e.isLoading,u.isValidating=e.isValidating,u.error=e.error,u):(u=e,e)},()=>l]}),[r,T]),J=(0,m.useSyncExternalStore)((0,e.useCallback)((e=>G(T,((t,a)=>{Y(a,t)||e()}))),[r,T]),q[0],q[1]),X=!N.current,ee=y[T]&&y[T].length>0,te=J.data,ae=h(te)?K:te,ne=J.error,re=(0,e.useRef)(ae),ie=v?h(te)?re.current:te:ae,oe=!(ee&&!h(ne))&&(X&&!h(s)?s:!z().isPaused()&&(o?!h(ae)&&c:h(ae)||c)),le=!!(T&&a&&X&&oe),se=h(J.isValidating)?le:J.isValidating,ce=h(J.isLoading)?le:J.isLoading,ue=(0,e.useCallback)((async e=>{const t=I.current;if(!T||!t||O.current||z().isPaused())return!1;let a,r,o=!0;const l=e||{},s=!R[T]||!l.dedupe,c=()=>M?!O.current&&T===L.current&&N.current:T===L.current,u={isValidating:!1,isLoading:!1},m=()=>{V(u)},d=()=>{const e=R[T];e&&e[1]===r&&delete R[T]},p={isValidating:!0};h(j().data)&&(p.isLoading=!0);try{if(s&&(V(p),n.loadingTimeout&&h(j().data)&&setTimeout((()=>{o&&c()&&z().onLoadingSlow(T,n)}),n.loadingTimeout),R[T]=[t(k),H()]),[a,r]=R[T],a=await a,s&&setTimeout(d,n.dedupingInterval),!R[T]||R[T][1]!==r)return s&&c()&&z().onDiscarded(T),!1;u.error=g;const e=b[T];if(!h(e)&&(r<=e[0]||r<=e[1]||0===e[1]))return m(),s&&c()&&z().onDiscarded(T),!1;const l=j().data;u.data=i(l,a)?l:a,s&&c()&&z().onSuccess(a,T,n)}catch(e){d();const t=z(),{shouldRetryOnError:a}=t;t.isPaused()||(u.error=e,s&&c()&&(t.onError(e,T,t),(!0===a||f(a)&&a(e))&&(z().revalidateOnFocus&&z().revalidateOnReconnect&&!D()||t.onErrorRetry(e,T,t,(e=>{const t=y[T];t&&t[0]&&t[0](3,e)}),{retryCount:(l.retryCount||0)+1,dedupe:!0}))))}return o=!1,m(),!0}),[T,r]),me=(0,e.useCallback)(((...e)=>$(r,L.current,...e)),[]);if(P((()=>{I.current=a,F.current=n,h(te)||(re.current=te)})),P((()=>{if(!T)return;const e=ue.bind(g,Z);let t=0;const a=((e,t,a)=>{const n=t[e]||(t[e]=[]);return n.push(a),()=>{const e=n.indexOf(a);e>=0&&(n[e]=n[n.length-1],n.pop())}})(T,y,((a,n={})=>{if(0==a){const a=Date.now();z().revalidateOnFocus&&a>t&&D()&&(t=a+z().focusThrottleInterval,e())}else if(1==a)z().revalidateOnReconnect&&D()&&e();else{if(2==a)return ue();if(3==a)return ue(n)}}));return O.current=!1,L.current=T,N.current=!0,V({\_k:k}),oe&&(h(ae)||A?e():(n=e,C&&typeof window.requestAnimationFrame!=S?window.requestAnimationFrame(n):setTimeout(n,1))),()=>{O.current=!0,a()};var n}),[T]),P((()=>{let e;function t(){const t=f(u)?u(j().data):u;t&&-1!==e&&(e=setTimeout(a,t))}function a(){j().error||!d&&!z().isVisible()||!p&&!z().isOnline()?t():ue(Z).then(t)}return t(),()=>{e&&(clearTimeout(e),e=-1)}}),[u,d,p,T]),(0,e.useDebugValue)(ie),o&&h(ae)&&T){if(!M&&A)throw new Error("Fallback data is required when using suspense in SSR.");I.current=a,F.current=n,O.current=!1;const e=w[T];if(!h(e)){const t=me(e);Q(t)}if(!h(ne))throw ne;{const e=ue(Z);h(ie)||(e.status="fulfilled",e.value=!0),Q(e)}}return{mutate:me,get data(){return U.data=!0,ie},get error(){return U.error=!0,ne},get isValidating(){return U.isValidating=!0,se},get isLoading(){return U.isLoading=!0,ce}}},function(...t){const a=\_(U,(0,e.useContext)(Y)),[n,r,i]=(e=>f(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}])(t),o=K(a,i);let l=te;const{use:s}=o,c=(s||[]).concat(X);for(let e=c.length;e--;)l=c[e](l);return l(n,r||o.fetcher||null,o)});var te;const ae={options:"undefined"!=typeof imageSeoSettings?imageSeoSettings:{},global:"undefined"!=typeof imageSeoGlobal?imageSeoGlobal:{}},ne="SET\_OPTIONS",re="OPTIONS\_MODIFIED",ie=(e,t)=>{switch(t.type){case ne:return{...e,options:{...e.options,...t.payload}};case re:return{...e,optionsModified:t.payload};default:return e}},oe=(0,r.createContext)(ae),le=({children:e})=>{const t=(0,r.useRef)(!0),[a,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!1),[c,u]=(0,r.useReducer)(ie,ae),[m,d]=((e,t,a={leading:!1})=>{const[n,i]=(0,r.useState)(e),o=(0,r.useRef)(null),l=(0,r.useRef)(!0),s=()=>window.clearTimeout(o.current);return(0,r.useEffect)((()=>s),[]),[n,(0,r.useCallback)((e=>{s(),l.current&&a.leading?i(e):o.current=window.setTimeout((()=>{l.current=!0,i(e)}),t),l.current=!1}),[a.leading,t])]})(ae.options,500),g=(0,r.useCallback)(((e,t=!1)=>{u({type:ne,payload:e}),t||(u({type:re,payload:!0}),d({...c.options,...e}))}),[d,c.options]),p=(0,r.useCallback)((e=>{const t={id:(new Date).getTime(),...e,content:e?.content||"",politeness:e?.politeness||"polite",actions:e?.actions||[],explicitDismiss:e?.explicitDismiss||!1};n((e=>[...e,t]))}),[]),h=(0,r.useCallback)((e=>{n((t=>t.filter((t=>t.id!==e))))}),[]),f=(0,r.useMemo)((()=>({options:c.options,global:c.global,loading:i,setOptions:g,addNotice:p,removeNotice:h,notices:a})),[p,i,a,h,g,c.global,c.options]),\_=(0,r.useMemo)((()=>m),[m]);return(0,r.useEffect)((()=>{t.current||c.optionsModified&&(async(e,t)=>{try{const{user:e,...a}=t;await s()({path:"imageseo/v1/settings",method:"POST",data:{...a}})}catch(e){console.error("Error saving settings:",e)}})(0,\_).then((()=>{l(!1),p({status:"info",content:(0,o.\_\_)("Options saved","imageseo")})})).catch((e=>{console.warn(e),p({status:"error",content:(0,o.\_\_)("Error saving options","imageseo")}),l(!1)}))}),[p,\_,c.optionsModified]),(0,r.useEffect)((()=>{t.current&&(t.current=!1)}),[]),React.createElement(oe.Provider,{value:f},e)},se=()=>{const e=(0,r.useContext)(oe);if(void 0===e)throw new Error("useSettings must be used within a SettingsProvider");return e},ce=({heading:e,children:t,saveButton:a})=>{const{options:l}=se(),{data:s,isLoading:c}=(e=>{const[t,a]=(0,r.useState)(!0),{setOptions:n,addNotice:i}=se(),{data:o,error:l,isLoading:s,mutate:c}=ee([e?"/imageseo/v1/validate-api-key":null,{apiKey:e}],u,{onError:()=>{a(!1)},onSuccess:e=>{if(a(!1),e?.message)return n({allowed:!1}),void i({status:"error",content:e.message});n({allowed:!0},!0)}});return{data:o,error:l,isLoading:t,isFetching:s,mutate:c}})(l.apiKey),m=(0,r.useMemo)((()=>!(c||!s)&&"Invalid API Key"!==s?.message),[s,c]),d=(0,r.useMemo)((()=>{if(c||!s)return 0;if("Invalid API Key"===s?.message)return 0;const{user:e}=s,t=e?.plan?.limitImages+e?.bonusStockImages-e?.currentRequestImages;return isNaN(t)?0:t}),[s,c]),g=(0,r.useCallback)((()=>{window.open("https://app.imageseo.com/plan/","\_blank")}),[]);return React.createElement(n.Animate,{type:c?"loading":""},(({className:r})=>React.createElement(n.Card,null,React.createElement(n.CardHeader,null,React.createElement("div",{className:"header-container"},React.createElement("div",{className:"header"},React.createElement("img",{className:"logo",src:i,alt:"logo"}),React.createElement(n.\_\_experimentalHeading,{align:"center"},e),React.createElement(n.ExternalLink,{className:"visit-website",href:"https://www.imageseo.com",target:"\_blank"},(0,o.\_\_)("Visit website","imageseo"))),React.createElement("div",null,m&&React.createElement("span",{className:"remaining-credits-info"},c?React.createElement(n.Spinner,null):sprintf((0,o.\_\_)("Remaining credits %d","imageseo"),d))),React.createElement("div",{className:"cta"},React.createElement("span",null,React.createElement(n.Button,{variant:"primary",onClick:g},(0,o.\_\_)("Buy more credits","imageseo")))))),React.createElement(n.CardBody,{className:r},t),React.createElement(n.CardFooter,null,React.createElement(n.\_\_experimentalText,null,""),a&&React.createElement(n.Button,{type:"submit",variant:"secondary"},(0,o.\_\_)("Save","imageseo"))))))},ue={a:{content:9,self:!1,type:105},address:{invalid:["h1","h2","h3","h4","h5","h6","address","article","aside","section","div","header","footer"],self:!1},audio:{children:["track","source"]},br:{type:9,void:!0},body:{content:127},button:{content:8,type:105},caption:{content:1,parent:["table"]},col:{parent:["colgroup"],void:!0},colgroup:{children:["col"],parent:["table"]},details:{children:["summary"],type:97},dd:{content:1,parent:["dl"]},dl:{children:["dt","dd"],type:1},dt:{content:1,invalid:["footer","header"],parent:["dl"]},figcaption:{content:1,parent:["figure"]},footer:{invalid:["footer","header"]},header:{invalid:["footer","header"]},hr:{type:1,void:!0},img:{void:!0},li:{content:1,parent:["ul","ol","menu"]},main:{self:!1},ol:{children:["li"],type:1},picture:{children:["source","img"],type:25},rb:{parent:["ruby","rtc"]},rp:{parent:["ruby","rtc"]},rt:{content:8,parent:["ruby","rtc"]},rtc:{content:8,parent:["ruby"]},ruby:{children:["rb","rp","rt","rtc"]},source:{parent:["audio","video","picture"],void:!0},summary:{content:8,parent:["details"]},table:{children:["caption","colgroup","thead","tbody","tfoot","tr"],type:1},tbody:{parent:["table"],children:["tr"]},td:{content:1,parent:["tr"]},tfoot:{parent:["table"],children:["tr"]},th:{content:1,parent:["tr"]},thead:{parent:["table"],children:["tr"]},tr:{parent:["table","tbody","thead","tfoot"],children:["th","td"]},track:{parent:["audio","video"],void:!0},ul:{children:["li"],type:1},video:{children:["track","source"]},wbr:{type:9,void:!0}};function me(e){return t=>{ue[t]={...e,...ue[t]}}}["address","main","div","figure","p","pre"].forEach(me({content:1,type:65})),["abbr","b","bdi","bdo","cite","code","data","dfn","em","i","kbd","mark","q","ruby","samp","strong","sub","sup","time","u","var"].forEach(me({content:8,type:73})),["p","pre"].forEach(me({content:8,type:65})),["s","small","span","del","ins"].forEach(me({content:8,type:9})),["article","aside","footer","header","nav","section","blockquote"].forEach(me({content:1,type:67})),["h1","h2","h3","h4","h5","h6"].forEach(me({content:8,type:69})),["audio","canvas","iframe","img","video"].forEach(me({type:89}));const de=Object.freeze(ue),ge=["applet","base","body","command","embed","frame","frameset","head","html","link","meta","noscript","object","script","style","title"],pe=Object.keys(de).filter((e=>"canvas"!==e&&"iframe"!==e)),he=Object.freeze({alt:1,cite:1,class:1,colspan:3,controls:4,datetime:1,default:4,disabled:4,dir:1,height:1,href:1,id:1,kind:1,label:1,lang:1,loading:1,loop:4,media:1,muted:4,poster:1,rel:1,role:1,rowspan:3,scope:1,sizes:1,span:3,start:3,style:5,src:1,srclang:1,srcset:1,tabindex:1,target:1,title:1,type:1,width:1}),fe=Object.freeze({class:"className",colspan:"colSpan",datetime:"dateTime",rowspan:"rowSpan",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex"});function \_e(){return \_e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},\_e.apply(this,arguments)}function ve({attributes:e={},className:a,children:n=null,selfClose:r=!1,tagName:i}){const o=i;return r?t().createElement(o,\_e({className:a},e)):t().createElement(o,\_e({className:a},e),n)}class ye{attribute(e,t){return t}node(e,t){return t}}var be=a(580),Ee=a.n(be);function Re(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const we=/(url|image|image-set)\(/i;class Se extends ye{attribute(e,t){return"style"===e&&Object.keys(t).forEach((e=>{String(t[e]).match(we)&&delete t[e]})),t}}const Ce=/^<(!doctype|(html|head|body)(\s|>))/i,Te=/^(aria-|data-|\w+:)/iu,xe=/{{{(\w+)\/?}}}/;function ke(){if("undefined"!=typeof window&&"undefined"!=typeof document)return document.implementation.createHTMLDocument("Interweave")}class Ne{constructor(e,t={},a=[],n=[]){var r;Re(this,"allowed",void 0),Re(this,"banned",void 0),Re(this,"blocked",void 0),Re(this,"container",void 0),Re(this,"content",[]),Re(this,"props",void 0),Re(this,"matchers",void 0),Re(this,"filters",void 0),Re(this,"keyIndex",void 0),this.props=t,this.matchers=a,this.filters=[...n,new Se],this.keyIndex=-1,this.container=this.createContainer(e||""),this.allowed=new Set(null!==(r=t.allowList)&&void 0!==r?r:pe),this.banned=new Set(ge),this.blocked=new Set(t.blockList)}applyAttributeFilters(e,t){return this.filters.reduce(((t,a)=>null!==t&&"function"==typeof a.attribute?a.attribute(e,t):t),t)}applyNodeFilters(e,t){return this.filters.reduce(((t,a)=>null!==t&&"function"==typeof a.node?a.node(e,t):t),t)}applyMatchers(e,t){const a={},{props:n}=this;let r=e,i=0,o=null;return this.matchers.forEach((e=>{const l=e.asTag().toLowerCase(),s=this.getTagConfig(l);if(n[e.inverseName]||!this.isTagAllowed(l))return;if(!this.canRenderChild(t,s))return;let c="";for(;r&&(o=e.match(r));){const{index:t,length:l,match:s,valid:u,void:m,...d}=o,g=e.propName+String(i);t>0&&(c+=r.slice(0,t)),u?(c+=m?`{{{${g}/}}}`:`{{{${g}}}}${s}{{{/${g}}}}`,this.keyIndex+=1,i+=1,a[g]={children:s,matcher:e,props:{...n,...d,key:this.keyIndex}}):c+=s,e.greedy?(r=c+r.slice(t+l),c=""):r=r.slice(t+(l||s.length))}e.greedy||(r=c+r)})),0===i?e:this.replaceTokens(r,a)}canRenderChild(e,t){return!(!e.tagName||!t.tagName)&&!e.void&&(e.children.length>0?e.children.includes(t.tagName):!(e.invalid.length>0&&e.invalid.includes(t.tagName))&&(t.parent.length>0?t.parent.includes(e.tagName):!(!e.self&&e.tagName===t.tagName)&&Boolean(e&&e.content&t.type)))}convertLineBreaks(e){const{noHtml:t,disableLineBreaks:a}=this.props;if(t||a||e.match(/<((?:\/[ a-z]+)|(?:[ a-z]+\/))>/gi))return e;let n=e.replace(/\r\n/g,"\n");return n=n.replace(/\n{3,}/g,"\n\n\n"),n=n.replace(/\n/g,"<br/>"),n}createContainer(e){var t;const n=(void 0!==a.g&&a.g.INTERWEAVE\_SSR\_POLYFILL||ke)();if(!n)return;const r=null!==(t=this.props.containerTagName)&&void 0!==t?t:"body",i="body"===r||"fragment"===r?n.body:n.createElement(r);return e.match(Ce)||(i.innerHTML=this.convertLineBreaks(this.props.escapeHtml?Ee()(e):e)),i}extractAttributes(e){const{allowAttributes:t}=this.props,a={};let n=0;return 1===e.nodeType&&e.attributes?([...e.attributes].forEach((r=>{const{name:i,value:o}=r,l=i.toLowerCase(),s=he[l]||he[i];if(!this.isSafe(e))return;if(!l.match(Te)&&(!t&&(!s||2===s)||l.startsWith("on")||o.replace(/(\s|\0|&#x0([9AD]);)/,"").match(/(javascript|vbscript|livescript|xss):/i)))return;let c="style"===l?this.extractStyleAttribute(e):o;4===s?c=!0:3===s?c=Number.parseFloat(String(c)):5!==s&&(c=String(c)),a[fe[l]||l]=this.applyAttributeFilters(l,c),n+=1})),0===n?null:a):null}extractStyleAttribute(e){const t={};return Array.from(e.style).forEach((a=>{const n=e.style[a];"string"!=typeof n&&"number"!=typeof n||(t[a.replace(/-([a-z])/g,((e,t)=>String(t).toUpperCase()))]=n)})),t}getTagConfig(e){const t={children:[],content:0,invalid:[],parent:[],self:!0,tagName:"",type:0,void:!1};return de[e]?{...t,...de[e],tagName:e}:t}isSafe(e){if("undefined"!=typeof HTMLAnchorElement&&e instanceof HTMLAnchorElement){const t=e.getAttribute("href");if(null!=t&&t.startsWith("#"))return!0;const a=e.protocol.toLowerCase();return":"===a||"http:"===a||"https:"===a||"mailto:"===a||"tel:"===a}return!0}isTagAllowed(e){return!this.banned.has(e)&&!this.blocked.has(e)&&(this.props.allowElements||this.allowed.has(e))}parse(){return this.container?this.parseNode(this.container,this.getTagConfig(this.container.nodeName.toLowerCase())):[]}parseNode(e,a){const{noHtml:n,noHtmlExceptMatchers:r,allowElements:i,transform:o,transformOnlyAllowList:l}=this.props;let s=[],c="";return[...e.childNodes].forEach((e=>{if(1===e.nodeType){const m=e.nodeName.toLowerCase(),d=this.getTagConfig(m);c&&(s.push(c),c="");const g=this.applyNodeFilters(m,e);if(!g)return;let p;if(o&&(!l||this.isTagAllowed(m))){this.keyIndex+=1;const e=this.keyIndex;p=this.parseNode(g,d);const a=o(g,p,d);if(null===a)return;if(void 0!==a)return void s.push(t().cloneElement(a,{key:e}));this.keyIndex=e-1}if(this.banned.has(m))return;if(n||r&&"br"!==m||!this.isTagAllowed(m)||!i&&!this.canRenderChild(a,d))s=[...s,...this.parseNode(g,d.tagName?d:a)];else{var u;this.keyIndex+=1;const e=this.extractAttributes(g),a={tagName:m};e&&(a.attributes=e),d.void&&(a.selfClose=d.void),s.push(t().createElement(ve,{...a,key:this.keyIndex},null!==(u=p)&&void 0!==u?u:this.parseNode(g,d)))}}else if(3===e.nodeType){const t=n&&!r?e.textContent:this.applyMatchers(e.textContent||"",a);Array.isArray(t)?s=[...s,...t]:c+=t}})),c&&s.push(c),s}replaceTokens(e,t){if(!e.includes("{{{"))return e;const a=[];let n=e,r=null;for(;r=n.match(xe);){const[e,i]=r,o=r.index,l=e.includes("/");o>0&&(a.push(n.slice(0,o)),n=n.slice(o));const{children:s,matcher:c,props:u}=t[i];let m;if(l)m=e.length,a.push(c.createElement(s,u));else{const r=n.match(new RegExp(`{{{/${i}}}}`));m=r.index+r[0].length,a.push(c.createElement(this.replaceTokens(n.slice(e.length,r.index),t),u))}n=n.slice(m)}return n.length>0&&a.push(n),0===a.length?"":1===a.length&&"string"==typeof a[0]?a[0]:a}}function Oe(e){var a;const{attributes:n,className:r,containerTagName:i,content:o,emptyContent:l,parsedContent:s,tagName:c,noWrap:u}=e,m=null!==(a=null!=i?i:c)&&void 0!==a?a:"span",d="fragment"===m||u;let g;if(s)g=s;else{const t=new Ne(null!=o?o:"",e).parse();t.length>0&&(g=t)}return g||(g=l),d?t().createElement(t().Fragment,null,g):t().createElement(ve,{attributes:n,className:r,tagName:m},g)}const Le=()=>{const{options:e,global:t,setOptions:a,addNotice:i}=se(),[l,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(e?.allowed),[d,g]=(0,r.useState)(""),[p,h]=(0,r.useState)({firstName:t?.user?.firstName||"",lastName:t?.user?.lastName||"",email:t?.user?.email||"",password:"",terms:!1,news:!1}),f=async()=>{try{g(""),c(!0);const t=await s()({path:"/imageseo/v1/validate-api-key",method:"POST",data:{apiKey:e.apiKey}});if(void 0!==t?.data?.message)return a({allowed:!1}),g(t?.data?.message),c(!1),void i({status:"error",content:t?.data?.message});c(!1),a({allowed:!0}),i({status:"success",content:(0,o.\_\_)("API key validated","imageseo")})}catch(e){c(!1),i({status:"error",content:(0,o.\_\_)("Error validating API key","imageseo")}),console.error("Error validating API key:",e)}},\_=async()=>{try{c(!0);const e=await s()({path:"/imageseo/v1/register",method:"POST",data:p});if(Object.prototype.hasOwnProperty.call(e,"success")&&!e?.success)throw new Error(Array.isArray(e?.data?.message)?e?.data?.message.join(","):e?.data?.message);if(e?.message)throw i({status:"error",content:e?.message}),new Error("Something went wrong");a({apiKey:e?.projects?.[0]?.apiKey,allowed:!0},!1),i({status:"success",content:(0,o.\_\_)("Account created","imageseo")}),m(!0),c(!1)}catch(e){console.log(e),c(!1),i({status:"error",content:e.message}),console.error("Error registering account:",e)}},v=(e,t)=>{h({...p,[e]:t})};return React.createElement("div",{className:"welcome-screen"},React.createElement(n.\_\_experimentalHeading,{order:3,lineHeight:2,align:"center"},(0,o.\_\_)("Welcome to ImageSEO","imageseo")),React.createElement(n.\_\_experimentalText,{align:"center"},React.createElement(Oe,{content:sprintf((0,o.\_\_)("To get started with ImageSEO you will need your own API key. If you don't have an API key already, you should %s register an account %s to get one.","imageseo"),'<a href="https://app.imageseo.com/" target="\_blank">',"</a>")})),React.createElement(n.Animate,{type:l?"loading":""},(({className:t})=>React.createElement(React.Fragment,null,u?React.createElement("div",{className:`form-container ${t||""}`},React.createElement(n.TextControl,{label:(0,o.\_\_)("API Key","imageseo"),value:e?.apiKey||"",onChange:e=>a({apiKey:e})}),React.createElement(n.Flex,{justifyContent:"spaceBetween"},React.createElement(n.FlexItem,null,React.createElement(n.Button,{disabled:l,variant:"primary",onClick:f},l?(0,o.\_\_)("Validating…","imageseo"):(0,o.\_\_)("Validate key","imageseo"))),!e?.allowed&&React.createElement(n.FlexItem,null,React.createElement(n.Button,{variant:"secondary",onClick:()=>m(!1)},(0,o.\_\_)("I want to register for a free account","imageseo"))),e?.allowed&&React.createElement(n.FlexItem,null,React.createElement(n.Icon,{icon:"yes",style:{color:"#52c41a"}}),React.createElement(n.\_\_experimentalText,{variant:"muted"},(0,o.\_\_)("API key validated","imageseo")))),d&&React.createElement(n.\_\_experimentalText,{variant:"error"},d)):React.createElement("div",{className:`form-container ${t||""}`},React.createElement(n.TextControl,{label:(0,o.\_\_)("First name","imageseo"),value:p.firstName,onChange:e=>v("firstName",e)}),React.createElement(n.TextControl,{label:(0,o.\_\_)("Last name","imageseo"),value:p.lastName,onChange:e=>v("lastName",e)}),React.createElement(n.TextControl,{label:(0,o.\_\_)("Email","imageseo"),type:"email",value:p.email,onChange:e=>v("email",e)}),React.createElement(n.TextControl,{type:"password",label:(0,o.\_\_)("Password","imageseo"),value:p.password,onChange:e=>v("password",e)}),React.createElement(n.CheckboxControl,{label:(0,o.\_\_)("I agree to the terms and conditions","imageseo"),help:React.createElement(n.\_\_experimentalText,{variant:"muted"},(0,o.\_\_)("By creating an account, you agree to our terms and conditions.","imageseo"),React.createElement(n.ExternalLink,{style:{marginLeft:5},href:"https://imageseo.io/terms-conditions/"},(0,o.\_\_)("Read more","imageseo"))),checked:p.terms,onChange:e=>v("terms",e)}),React.createElement(n.CheckboxControl,{label:(0,o.\_\_)("I want to receive news and updates","imageseo"),help:(0,o.\_\_)("You can unsubscribe at any time","imageseo"),checked:p.news,onChange:e=>v("news",e)}),React.createElement(n.Flex,null,React.createElement(n.FlexItem,null,React.createElement(n.Button,{variant:"primary",disabled:l,onClick:\_},(0,o.\_\_)("Create account","imageseo"))),React.createElement(n.FlexItem,null,React.createElement(n.Button,{variant:"secondary",disabled:l,onClick:()=>m(!0)},(0,o.\_\_)("I already have an account","imageseo")))))))))},Ie=({id:e,label:t,help:a,value:i,onChange:l})=>{const[s,c]=(0,r.useState)(i),u=()=>{const e=wp.media({title:(0,o.\_\_)("Select or Upload Media","imageseo"),button:{text:(0,o.\_\_)("Use this item","imageseo")},multiple:!1});e.on("select",(()=>{const t=e.state().get("selection").first().toJSON();c(t.url),l(t.url)})),e.open()};return React.createElement("div",{className:"media-uploader-container",onClick:u},React.createElement(n.BaseControl,{id:e,label:t,help:a,className:"media-uploader"},!s&&React.createElement(n.Button,{variant:"primary",onClick:u},(0,o.\_\_)("Select Image","imageseo")),s&&React.createElement("img",{src:s,alt:"Selected"})))},Me=()=>{const{options:e,setOptions:t}=se();return React.createElement("div",null,React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Subtitle","imageseo"),checked:e.socialMediaSettings?.visibilitySubTitle,onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,visibilitySubTitle:a}})},help:(0,o.\_\_)("Show the price product or author depending on the page ( Product price (WooCommerce only) )","imageseo")}),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Subtitle 2","imageseo"),checked:e.socialMediaSettings?.visibilitySubTitleTwo,onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,visibilitySubTitleTwo:a}})},help:(0,o.\_\_)("Show the reading time of an article or the number of reviews (WooCommerce only).","imageseo")}),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Stars rating","imageseo"),checked:e.socialMediaSettings?.visibilityRating,onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,visibilityRating:a}})},help:(0,o.\_\_)("Show the stars linked to a review of your product for example.","imageseo")}),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Author avatar","imageseo"),checked:e.socialMediaSettings?.visibilityAvatar,onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,visibilityAvatar:a}})},help:(0,o.\_\_)("Only used for post content.","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControl,{style:{width:300},value:e.socialMediaSettings?.layout||"CARD\_LEFT",label:(0,o.\_\_)("Layout","imageseo"),help:(0,o.\_\_)("Choose the layout of the social card.","imageseo"),onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,layout:a}})}},React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"CARD\_LEFT",label:(0,o.\_\_)("Card left","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"CARD\_RIGHT",label:(0,o.\_\_)("Card right","imageseo")})),React.createElement(n.\_\_experimentalToggleGroupControl,{value:e.socialMediaSettings?.textAlignment||"top",onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,textAlignment:a}})},label:(0,o.\_\_)("Text alignment","imageseo")},React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"top",label:(0,o.\_\_)("Top","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"center",label:(0,o.\_\_)("Center","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"bottom",label:(0,o.\_\_)("Bottom","imageseo")})),React.createElement(n.\_\_experimentalGrid,{columns:3},React.createElement(n.BaseControl,{id:"text-color",label:(0,o.\_\_)("Text color","imageseo")},React.createElement(n.ColorPicker,{defaultValue:e.socialMediaSettings?.textColor||"#000000",onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,textColor:a}})}})),React.createElement(n.BaseControl,{id:"background-color",label:(0,o.\_\_)("Background color","imageseo")},React.createElement(n.ColorPicker,{defaultValue:e.socialMediaSettings?.contentBackgroundColor||"#ffffff",onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,contentBackgroundColor:a}})}})),e.socialMediaSettings?.visibilityRating&&React.createElement(n.BaseControl,{id:"star-color",label:(0,o.\_\_)("Star color","imageseo")},React.createElement(n.ColorPicker,{defaultValue:e.socialMediaSettings?.starColor||"#F8CA00",onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,starColor:a}})}}))),React.createElement(Ie,{label:(0,o.\_\_)("Logo","imageseo"),value:e?.socialMediaSettings?.logoUrl,help:(0,o.\_\_)("Click to upload a logo","imageseo"),onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,logoUrl:a}})}}),React.createElement(n.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(Ie,{label:(0,o.\_\_)("Background image","imageseo"),value:e?.socialMediaSettings?.defaultBgImg,help:(0,o.\_\_)("Click to upload a background Image","imageseo"),onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,defaultBgImg:a}})}}))},Ae=a.p+"images/avatar-default.00d4ecf9.jpg",Pe=({color:e})=>React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:e||"rgb(248, 202, 0)",stroke:e||"rgb(248, 202, 0)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-star"},React.createElement("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})),Fe=()=>{const{options:e}=se(),t=e?.socialMediaSettings||{},{layout:a,defaultBgImg:r,logoUrl:i,textColor:l,visibilitySubTitle:s,visibilitySubTitleTwo:c,visibilityRating:u,visibilityAvatar:m,contentBackgroundColor:d,starColor:g}=t;return React.createElement("div",{className:"previewer"},"CARD\_LEFT"===a&&React.createElement("div",{className:"bg-image",style:{backgroundImage:`url(${r})`}}),React.createElement("div",{className:"content",style:{backgroundColor:d}},React.createElement("div",{className:"padded"},React.createElement("img",{src:i,alt:"logo",className:"logo"}),React.createElement(n.\_\_experimentalHeading,{level:2,lineHeight:1.5,style:{color:l}},(0,o.\_\_)("Lorem ipsum (post title)","imageseo")),s&&React.createElement(n.\_\_experimentalHeading,{level:3,lineHeight:1.5,style:{color:l}},(0,o.\_\_)("Lorem ipsum (sub title)","imageseo")),c&&React.createElement(n.\_\_experimentalHeading,{level:4,lineHeight:1.5,style:{color:l}},(0,o.\_\_)("Lorem ipsum (sub title two)","imageseo")),m&&React.createElement("img",{src:Ae,alt:"default avatar",className:"avatar"}),u&&React.createElement("div",null,React.createElement(Pe,{color:g}),React.createElement(Pe,{color:g}),React.createElement(Pe,{color:g}),React.createElement(Pe,{color:g}),React.createElement(Pe,{color:g})))),"CARD\_RIGHT"===a&&React.createElement("div",{className:"bg-image",style:{backgroundImage:`url(${r})`}}))},ze=()=>{const{loading:e}=se();return React.createElement(n.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""} social-card-screen`},React.createElement(Me,null),React.createElement(Fe,null))))},Be=()=>{const[e,t]=(0,r.useState)(!0),{data:a,error:n,isLoading:i,mutate:o}=ee("/imageseo/v1/image-query",c,{onError:()=>{t(!1)},onSuccess:()=>{t(!1)},revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1});return{data:a,error:n,isLoading:e,isFetching:i,mutate:o}},De=()=>{const{options:e,setOptions:t,global:a}=se(),{mutate:r}=Be();return React.createElement("div",{className:"form"},React.createElement(n.SelectControl,{label:(0,o.\_\_)("Images to optimize","imageseo"),value:e?.altFilter||"ALL",onChange:e=>{t({altFilter:e}),r()},options:(a.altSpecification||[]).map((e=>({value:e.id,label:e.label})))}),React.createElement(n.SelectControl,{label:(0,o.\_\_)("Optimize alt text","imageseo"),value:e?.altFill||"FILL\_ALL",onChange:e=>{t({altFill:e}),r()},options:[{value:"FILL\_ALL",label:(0,o.\_\_)("Optimize all ALT texts","imageseo")},{value:"FILL\_ONLY\_EMPTY",label:(0,o.\_\_)("Optimize only missing ALT texts","imageseo")}]}),React.createElement(n.ToggleControl,{checked:e?.optimizeTitle,onChange:e=>{t({optimizeTitle:e})},label:(0,o.\_\_)("Optimize title","imageseo")}),React.createElement(n.ToggleControl,{checked:e?.optimizeCaption,onChange:e=>{t({optimizeCaption:e})},label:(0,o.\_\_)("Optimize caption","imageseo")}),React.createElement(n.ToggleControl,{checked:e?.optimizeFile,onChange:e=>{t({optimizeFile:e})},label:(0,o.\_\_)("Rename files","imageseo")}))},He=()=>{const[e,t]=(0,r.useState)(!0),{data:a,error:n,isLoading:i,mutate:o}=ee("/imageseo/v1/get-bulk-optimizer-status",c,{onError:()=>{t(!1)},onSuccess:()=>{t(!1)},refreshInterval:1e4});return{data:a,error:n,isLoading:e,isFetching:i,mutate:o}},$e=()=>{const{global:e,options:t,addNotice:a}=se(),{data:i,isLoading:l,error:c,mutate:u}=He(),{data:m,mutate:d}=Be(),g=async()=>{await s()({path:"/imageseo/v1/start-bulk-optimizer",method:"POST"}),u(),a({status:"success",content:(0,o.\_\_)("Optimizer started","imageseo")})},p=(0,r.useMemo)((()=>i?.report?.errors?.length>0&&void 0!==i?.report?.errors?.find((e=>"You have reached the limit of images to optimize"===e.trim()))),[i?.report?.errors]);return l?React.createElement(n.Placeholder,{className:"optimizer",icon:"update",label:(0,o.\_\_)("Loading","imageseo"),instructions:(0,o.\_\_)("Loading…","imageseo")}):c?React.createElement(n.Placeholder,{className:"optimizer",icon:"warning",label:(0,o.\_\_)("Error","imageseo"),instructions:(0,o.\_\_)("An error occurred while fetching the optimizer status.","imageseo")}):"idle"===i?.status&&p?React.createElement("div",{className:"optimizer"},React.createElement(n.\_\_experimentalText,null,(0,o.\_\_)("You have reached the limit of images to optimize.","imageseo")),React.createElement(n.\_\_experimentalSpacer,{marginY:"5"}),React.createElement(n.Button,{variant:"primary",disabled:"running"===i?.status,onClick:g},(0,o.\_\_)("Try again","imageseo"))):React.createElement("div",{className:"optimizer"},"idle"===i?.status&&React.createElement(React.Fragment,null,"NEXTGEN\_GALLERY"===t?.altFilter&&React.createElement(n.\_\_experimentalText,null,(0,o.sprintf)((0,o.\_\_)("There are %1$s images in your NEXTGEN library and %2$s don't have an alternative text.","imageseo"),e.bulkQuery.ids.length||0,e.bulkQuery.nonOptimized.length||0)),"NEXTGEN\_GALLERY"!==t?.altFilter&&React.createElement(n.\_\_experimentalText,null,(0,o.sprintf)((0,o.\_\_)("There are %1$s images in your media library and %2$s don't have an alternative text.","imageseo"),m?.totalImages||0,m?.totalNoAlt||0)),React.createElement(n.\_\_experimentalSpacer,{marginY:"5"}),React.createElement(n.Button,{variant:"primary",disabled:"running"===i?.status,onClick:g},(0,o.\_\_)("Start optimization","imageseo"))),"running"===i?.status&&React.createElement("div",{className:"progress"},React.createElement(n.\_\_experimentalText,null,(0,o.sprintf)((0,o.\_\_)("Optimizing %1$s images. ( %2$s/%3$s )","imageseo"),i?.report?.total,i?.report?.optimized,i?.report?.total)),React.createElement("progress",{value:i?.report?.optimized/i?.report?.total\*100,max:100}),React.createElement(n.\_\_experimentalSpacer,{marginY:"3"}),React.createElement(n.Button,{variant:"primary",onClick:async()=>{await s()({path:"/imageseo/v1/stop-bulk-optimizer",method:"POST"}),u(),d(),a({status:"success",content:(0,o.\_\_)("Optimizer stopped","imageseo")})}},(0,o.\_\_)("Stop optimizer","imageseo"))))},je=()=>{const{loading:e}=se(),{data:t}=He();return React.createElement(n.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""}`},React.createElement(n.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(n.\_\_experimentalHeading,{level:4},"running"===t?.status?(0,o.\_\_)("Current report","imageseo"):(0,o.\_\_)("Last report","imageseo")),React.createElement(n.\_\_experimentalText,null,(0,o.\_\_)("Optimized: ","imageseo")," ",t?.report.optimized),React.createElement("br",null),React.createElement(n.\_\_experimentalText,null,(0,o.\_\_)("Skipped: ","imageseo")," ",t?.report.skipped),React.createElement("br",null),React.createElement(n.\_\_experimentalText,null,(0,o.\_\_)("Failed: ","imageseo")," ",t?.report.failed))))},Ve=()=>{const{loading:e}=se();return React.createElement(n.Animate,{type:e?"loading":""},(({className:e})=>React.createElement(React.Fragment,null,React.createElement("div",{className:`${e||""} bulk-optimizer-screen`},React.createElement(De,null),React.createElement($e,null)),React.createElement(je,null))))},Ge=()=>{const{options:e,global:t,setOptions:a}=se(),i=(0,r.useMemo)((()=>{const a=e?.defaultLanguageIa||t?.currentLanguage||"en";return a.includes("\_")?a.split("\_")[0]:a}),[t?.currentLanguage,e?.defaultLanguageIa]);return React.createElement("div",null,React.createElement(n.\_\_experimentalHeading,{level:4,lineHeight:2},(0,o.\_\_)("On-upload optimization","imageseo")),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Fill alt","imageseo"),help:(0,o.\_\_)("The plugin will automatically write an alternative to the images you will upload.","imageseo"),checked:e.activeAltWriteUpload,onChange:e=>a({activeAltWriteUpload:e})}),React.createElement(n.ToggleControl,{checked:e?.activeOptimizeTitle,onChange:e=>{a({activeOptimizeTitle:e})},help:(0,o.\_\_)("The plugin will automatically rewrite with SEO friendly content the title of the images you will upload.","imageseo"),label:(0,o.\_\_)("Optimize title","imageseo")}),React.createElement(n.ToggleControl,{checked:e?.activeOptimizeCaption,onChange:e=>{a({activeOptimizeCaption:e})},help:(0,o.\_\_)("The plugin will automatically rewrite with SEO friendly content the caption of the images you will upload.","imageseo"),label:(0,o.\_\_)("Optimize caption","imageseo")}),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Rename files","imageseo"),help:(0,o.\_\_)("The plugin will automatically rewrite with SEO friendly content the name of the images you will upload.","imageseo"),checked:e.activeRenameWriteUpload,onChange:e=>a({activeRenameWriteUpload:e})}),React.createElement(n.SelectControl,{label:(0,o.\_\_)("Language","imageseo"),options:t.languages||[],onChange:e=>{a({defaultLanguageIa:e})},value:i}),React.createElement(n.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(n.\_\_experimentalHeading,{level:4,lineHeight:2},(0,o.\_\_)("Social media card generator","imageseo")),React.createElement(n.\_\_experimentalText,{style:{marginBottom:15,display:"inline-block"}},(0,o.\_\_)("Automatic generation for the following post types:","imageseo")),t?.allowedPostTypes?.map((t=>React.createElement("div",{key:t.value,style:{maxWidth:300}},React.createElement(n.ToggleControl,{\_\_nextHasNoMarginBottom:!0,checked:(e?.socialMediaPostTypes||[]).includes(t.value),label:t.label,onChange:n=>((t,n)=>{n&&!(e?.socialMediaPostTypes||[]).includes(t)&&a({socialMediaPostTypes:[...e?.socialMediaPostTypes||[],t]}),!n&&(e?.socialMediaPostTypes||[]).includes(t)&&a({socialMediaPostTypes:(e?.socialMediaPostTypes||[]).filter((e=>e!==t))})})(t.value,n)})))))},We=()=>{const{loading:e}=se();return React.createElement(n.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""} social-card-screen`},React.createElement(Ge,null))))},Ue=()=>{const[e,t]=(0,r.useState)(!1),{data:a,isLoading:i}=ee("/imageseo/v1/optimizer-errors",c,{refreshInterval:1e4}),{data:o,isLoading:l}=ee("/imageseo/v1/debug-info",c,{refreshInterval:1e4});return(0,r.useEffect)((()=>{localStorage.getItem("imageseo\_debug\_log")&&t(!0)}),[]),e?i?React.createElement(n.Spinner,null):React.createElement(React.Fragment,null,React.createElement("h4",null,"Error Log"),React.createElement("pre",null,JSON.stringify(a,null,2)),React.createElement("h4",null,"Debug Info"),React.createElement("pre",null,JSON.stringify(o,null,2))):null},Ke=new URLSearchParams(window.location.search).get("activeTab"),Ye=localStorage.getItem("imageseo\_debug\_log");function qe(){const{options:e,notices:t,removeNotice:a}=se(),[i,l]=(0,r.useState)(Ke||"welcome");return React.createElement(React.Fragment,null,React.createElement(ce,{heading:(0,o.\_\_)("ImageSEO","imageseo")},React.createElement(n.\_\_experimentalToggleGroupControl,{label:"",onChange:e=>{l(e);const t=new URL(window.location.href);t.searchParams.set("activeTab",e),window.history.replaceState(null,null,t)},value:i,isBlock:!0},React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"welcome",label:(0,o.\_\_)("Welcome","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"socialcard",label:(0,o.\_\_)("Social card","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"bulkoptimizer",label:(0,o.\_\_)("Bulk optimization","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"settings",label:(0,o.\_\_)("Settings","imageseo")})),"welcome"===i&&React.createElement(Le,null),"socialcard"===i&&React.createElement(ze,null),"bulkoptimizer"===i&&React.createElement(Ve,null),"settings"===i&&React.createElement(We,null)),Ye&&React.createElement(Ue,null),React.createElement(n.SnackbarList,{notices:t,onRemove:a}))}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("imageseo-settings-v2");(0,r.createRoot)(e).render(React.createElement(le,null,React.createElement(qe,null)))}))})()})(); |
* ## [imageseo/tags/3.1.2/imageseo.php](/changeset/3122915/imageseo/tags/3.1.2/imageseo.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/imageseo.php")

  | [r3121409](/browser/imageseo/trunk/imageseo.php?rev=3121409#L6 "Show revision 3121409 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/imageseo.php?rev=3122915#L6 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | \* Description:              Optimize your images for search engines. Search engine optimization and web marketing strategy often neglect their images. |
  | 7 | 7 | \* Author:                   WPChill |
  | 8 |  | \* Version:                  3.1.~~1~~ |
  |  | 8 | \* Version:                  3.1.2 |
  | 9 | 9 | \* Author URI:               https://www.wpchill.com/ |
  | 10 | 10 | \* License:                  GPLv3 or later |
  | […](/browser/imageseo/trunk/imageseo.php?rev=3121409#L12) | […](/browser/imageseo/tags/3.1.2/imageseo.php?rev=3122915#L12) |  |
  | 12 | 12 | \* Requires PHP:             7.0 |
  | 13 | 13 | \* Text Domain:              imageseo |
  |  | 14 | \* Tested up to:             6.6 |
  | 14 | 15 | \* Domain Path:              /languages/ |
  | 15 |  | ~~\* Tested up to:             6.6~~ |
  | 16 | 16 | \* |
  | 17 | 17 | \* Copyright 2019-2023        WPUmbrella      aurelio@wp-umbrella.com |
  | […](/browser/imageseo/trunk/imageseo.php?rev=3121409#L55) | […](/browser/imageseo/tags/3.1.2/imageseo.php?rev=3122915#L55) |  |
  | 55 | 55 | define( 'IMAGESEO\_SLUG', 'imageseo' ); |
  | 56 | 56 | define( 'IMAGESEO\_OPTION\_GROUP', 'group-imageseo' ); |
  | 57 |  | define( 'IMAGESEO\_VERSION', '3.1.~~1~~' ); |
  |  | 57 | define( 'IMAGESEO\_VERSION', '3.1.2' ); |
  | 58 | 58 | define( 'IMAGESEO\_PHP\_MIN', '7.4' ); |
  | 59 | 59 | define( 'IMAGESEO\_DEBUG', false ); |
* ## [imageseo/tags/3.1.2/readme.txt](/changeset/3122915/imageseo/tags/3.1.2/readme.txt "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/readme.txt")

  | [r3116447](/browser/imageseo/trunk/readme.txt?rev=3116447#L5 "Show revision 3116447 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/readme.txt?rev=3122915#L5 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Tested up to: 6.6 |
  | 6 | 6 | Requires PHP: 7.4 |
  | 7 |  | Stable tag: 3.1.~~1~~ |
  |  | 7 | Stable tag: 3.1.2 |
  | 8 | 8 | License: GPLv3 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-3.0.html |
  | […](/browser/imageseo/trunk/readme.txt?rev=3116447#L126) | […](/browser/imageseo/tags/3.1.2/readme.txt?rev=3122915#L126) |  |
  | 126 | 126 |  |
  | 127 | 127 | == Changelog == |
  |  | 128 | = 3.1.2 - 19.07.2024 = |
  |  | 129 | Added: Optimize image title |
  |  | 130 | Added: Optimize image caption |
  |  | 131 | Changed: UI Changes and wording |
  |  | 132 | Fixed: Vulnerability issue |
  |  | 133 |  |
  | 128 | 134 | = 3.1.1 - 8.07.2024 = |
  | 129 | 135 | Added: Filter to know when api key is validated |
* ## [imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php](/changeset/3122915/imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php")

  | [r3093706](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L5 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php?rev=3122915#L5 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | use ImageSeoWP\Processes\OnUploadImage; |
  | 6 | 6 |  |
  | 7 |  | if (~~!defined('ABSPATH')~~) { |
  |  | 7 | if ( ! defined( 'ABSPATH' ) ) { |
  | 8 | 8 | exit; |
  | 9 | 9 | } |
  | 10 | 10 |  |
  | 11 |  | class MediaLibrary |
  | 12 |  | { |
  |  | 11 | class MediaLibrary { |
  |  | 12 |  |
  | 13 | 13 | public object $optionService; |
  | 14 | 14 | public object $reportImageService; |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L16) | […](/browser/imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php?rev=3122915#L16) |  |
  | 16 | 16 | public object $altService; |
  | 17 | 17 |  |
  | 18 |  | public function \_\_construct() |
  | 19 |  | { |
  | 20 |  | $this->optionService = imageseo\_get\_service('Option'); |
  | 21 |  | $this->reportImageService = imageseo\_get\_service('ReportImage'); |
  | 22 |  | $this->generateFilename = imageseo\_get\_service('GenerateFilename'); |
  | 23 |  | $this->altService = imageseo\_get\_service('Alt'); |
  |  | 18 | public function \_\_construct() { |
  |  | 19 | $this->optionService      = imageseo\_get\_service( 'Option' ); |
  |  | 20 | $this->reportImageService = imageseo\_get\_service( 'ReportImage' ); |
  |  | 21 | $this->generateFilename   = imageseo\_get\_service( 'GenerateFilename' ); |
  |  | 22 | $this->altService         = imageseo\_get\_service( 'Alt' ); |
  | 24 | 23 | } |
  | 25 | 24 |  |
  | 26 |  | public function hooks() |
  | 27 |  | { |
  | 28 |  | if (!imageseo\_allowed()) { |
  |  | 25 | public function hooks() { |
  |  | 26 | if ( ! imageseo\_allowed() ) { |
  | 29 | 27 | return; |
  | 30 | 28 | } |
  | 31 | 29 |  |
  | 32 |  | add\_filter(~~'manage\_media\_columns', [$this, 'manageMediaColumns']~~); |
  | 33 |  | add\_action(~~'manage\_media\_custom\_column', [$this, 'manageMediaCustomColumn'], 10, 2~~); |
  |  | 30 | add\_filter( 'manage\_media\_columns', array( $this, 'manageMediaColumns' ) ); |
  |  | 31 | add\_action( 'manage\_media\_custom\_column', array( $this, 'manageMediaCustomColumn' ), 10, 2 ); |
  | 34 | 32 |  |
  | 35 |  | add\_action(~~'wp\_ajax\_imageseo\_media\_alt\_update', [$this, 'ajaxAltUpdate']~~); |
  |  | 33 | add\_action( 'wp\_ajax\_imageseo\_media\_alt\_update', array( $this, 'ajaxAltUpdate' ) ); |
  | 36 | 34 |  |
  | 37 |  | add\_filter(~~'wp\_generate\_attachment\_metadata', [$this, 'createProcessOnUpload'], 10, 2~~); |
  | 38 |  | add\_action(~~'delete\_attachment', [$this, 'updateDeleteCount'], 100~~); |
  | 39 |  | add\_action(~~'admin\_enqueue\_scripts', [$this, 'enqueue\_scripts']~~); |
  |  | 35 | add\_filter( 'wp\_generate\_attachment\_metadata', array( $this, 'createProcessOnUpload' ), 10, 2 ); |
  |  | 36 | add\_action( 'delete\_attachment', array( $this, 'updateDeleteCount' ), 100 ); |
  |  | 37 | add\_action( 'admin\_enqueue\_scripts', array( $this, 'enqueue\_scripts' ) ); |
  | 40 | 38 | } |
  | 41 | 39 |  |
  | 42 |  | public function muteOnUpload() |
  | 43 |  | { |
  | 44 |  | remove\_filter('wp\_generate\_attachment\_metadata', [$this, 'createProcessOnUpload'], 10, 2); |
  |  | 40 | public function muteOnUpload() { |
  |  | 41 | remove\_filter( 'wp\_generate\_attachment\_metadata', array( $this, 'createProcessOnUpload' ), 10, 2 ); |
  | 45 | 42 | } |
  | 46 | 43 |  |
  | 47 |  | public function createProcessOnUpload($metadata, $attachmentId) |
  | 48 |  | { |
  | 49 |  | if (!wp\_attachment\_is\_image($attachmentId)) { |
  |  | 44 | public function createProcessOnUpload( $metadata, $attachmentId ) { |
  |  | 45 | if ( ! wp\_attachment\_is\_image( $attachmentId ) ) { |
  | 50 | 46 | return $metadata; |
  | 51 | 47 | } |
  | 52 | 48 |  |
  | 53 |  | $activeAltOnUpload = $this->optionService->getOption('activeAltWriteUpload'); |
  | 54 |  | $activeRenameOnUpload = $this->optionService->getOption('activeRenameWriteUpload'); |
  |  | 49 | $activeAltOnUpload     = $this->optionService->getOption( 'activeAltWriteUpload' ); |
  |  | 50 | $activeRenameOnUpload  = $this->optionService->getOption( 'activeRenameWriteUpload' ); |
  |  | 51 | $activeOptimizeTitle   = $this->optionService->getOption( 'activeOptimizeTitle' ); |
  |  | 52 | $activeOptimizeCaption = $this->optionService->getOption( 'activeOptimizeCaption' ); |
  | 55 | 53 |  |
  | 56 |  | $total = get\_option(~~'imageseo\_get\_total\_images'~~); |
  | 57 |  | if (~~$total~~) { |
  | 58 |  | update\_option(~~'imageseo\_get\_total\_images', (int) $total + 1, false~~); |
  |  | 54 | $total = get\_option( 'imageseo\_get\_total\_images' ); |
  |  | 55 | if ( $total ) { |
  |  | 56 | update\_option( 'imageseo\_get\_total\_images', (int) $total + 1, false ); |
  | 59 | 57 | } |
  | 60 | 58 |  |
  | 61 |  | if (~~!$activeAltOnUpload~~) { |
  | 62 |  | $total = get\_option(~~'imageseo\_get\_number\_image\_non\_optimize\_alt'~~); |
  | 63 |  | if (~~$total~~) { |
  | 64 |  | update\_option(~~'imageseo\_get\_number\_image\_non\_optimize\_alt', (int) $total + 1, false~~); |
  |  | 59 | if ( ! $activeAltOnUpload ) { |
  |  | 60 | $total = get\_option( 'imageseo\_get\_number\_image\_non\_optimize\_alt' ); |
  |  | 61 | if ( $total ) { |
  |  | 62 | update\_option( 'imageseo\_get\_number\_image\_non\_optimize\_alt', (int) $total + 1, false ); |
  | 65 | 63 | } |
  | 66 | 64 | } |
  | 67 | 65 |  |
  | 68 |  | if (~~!$activeAltOnUpload && !$activeRenameOnUpload~~) { |
  |  | 66 | if ( ! $activeAltOnUpload && ! $activeRenameOnUpload ) { |
  | 69 | 67 | return $metadata; |
  | 70 | 68 | } |
  | 71 | 69 |  |
  | 72 | 70 | $asyncRequest = OnUploadImage::getInstance(); |
  | 73 |  | $asyncRequest->data([ |
  | 74 |  | 'attachment\_id' => $attachmentId, |
  | 75 |  | 'active\_alt\_on\_upload' => $activeAltOnUpload, |
  | 76 |  | 'active\_rename\_on\_upload' => $activeRenameOnUpload, |
  | 77 |  | ]); |
  |  | 71 | $asyncRequest->data( |
  |  | 72 | array( |
  |  | 73 | 'attachmentId'            => $attachmentId, |
  |  | 74 | 'activeAltWriteUpload'    => $activeAltOnUpload, |
  |  | 75 | 'activeRenameWriteUpload' => $activeRenameOnUpload, |
  |  | 76 | 'activeOptimizeTitle'     => $activeOptimizeTitle, |
  |  | 77 | 'activeOptimizeCaption'   => $activeOptimizeCaption, |
  |  | 78 | ) |
  |  | 79 | ); |
  | 78 | 80 |  |
  | 79 | 81 | $asyncRequest->dispatch(); |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L84) | […](/browser/imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php?rev=3122915#L86) |  |
  | 84 | 86 | \* @param int $attachmentId |
  | 85 | 87 | \*/ |
  | 86 |  | public function updateDeleteCount(int $attachmentId) |
  | 87 |  | { |
  | 88 |  | if (!wp\_attachment\_is\_image($attachmentId)) { |
  |  | 88 | public function updateDeleteCount( int $attachmentId ) { |
  |  | 89 | if ( ! wp\_attachment\_is\_image( $attachmentId ) ) { |
  | 89 | 90 | return; |
  | 90 | 91 | } |
  | 91 | 92 |  |
  | 92 |  | $alt = $this->altService->getAlt(~~$attachmentId~~); |
  |  | 93 | $alt = $this->altService->getAlt( $attachmentId ); |
  | 93 | 94 |  |
  | 94 |  | $total = get\_option(~~'imageseo\_get\_number\_image\_non\_optimize\_alt'~~); |
  | 95 |  | if (~~$total~~) { |
  | 96 |  | update\_option(~~'imageseo\_get\_number\_image\_non\_optimize\_alt', (int) $total - 1, false~~); |
  |  | 95 | $total = get\_option( 'imageseo\_get\_number\_image\_non\_optimize\_alt' ); |
  |  | 96 | if ( $total ) { |
  |  | 97 | update\_option( 'imageseo\_get\_number\_image\_non\_optimize\_alt', (int) $total - 1, false ); |
  | 97 | 98 | } |
  | 98 | 99 |  |
  | 99 |  | $total = get\_option(~~'imageseo\_get\_total\_images'~~); |
  | 100 |  | if (~~$total~~) { |
  | 101 |  | update\_option(~~'imageseo\_get\_total\_images', (int) $total - 1, false~~); |
  |  | 100 | $total = get\_option( 'imageseo\_get\_total\_images' ); |
  |  | 101 | if ( $total ) { |
  |  | 102 | update\_option( 'imageseo\_get\_total\_images', (int) $total - 1, false ); |
  | 102 | 103 | } |
  | 103 | 104 | } |
  | 104 | 105 |  |
  | 105 |  | public function ajaxAltUpdate() |
  | 106 |  | { |
  | 107 |  | check\_ajax\_referer('imageseo\_upload\_nonce', '\_nonce'); |
  |  | 106 | public function ajaxAltUpdate() { |
  |  | 107 | check\_ajax\_referer( 'imageseo\_upload\_nonce', '\_nonce' ); |
  | 108 | 108 |  |
  | 109 |  | if (!current\_user\_can('manage\_options')) { |
  | 110 |  | wp\_send\_json\_error([ |
  | 111 |  | 'code' => 'not\_authorized', |
  | 112 |  | ]); |
  |  | 109 | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 110 | wp\_send\_json\_error( |
  |  | 111 | array( |
  |  | 112 | 'code' => 'not\_authorized', |
  |  | 113 | ) |
  |  | 114 | ); |
  | 113 | 115 | exit; |
  | 114 | 116 | } |
  | 115 | 117 |  |
  | 116 |  | $postId = absint(~~$\_POST['post\_id']~~); |
  | 117 |  | $alt ~~= wp\_strip\_all\_tags($\_POST['alt']~~); |
  |  | 118 | $postId = absint( $\_POST['post\_id'] ); |
  |  | 119 | $alt    = wp\_strip\_all\_tags( $\_POST['alt'] ); |
  | 118 | 120 |  |
  | 119 |  | imageseo\_get\_service(~~'Alt')->updateAlt($postId, $alt~~); |
  |  | 121 | imageseo\_get\_service( 'Alt' )->updateAlt( $postId, $alt ); |
  | 120 | 122 | } |
  | 121 | 123 |  |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L123) | […](/browser/imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php?rev=3122915#L125) |  |
  | 123 | 125 | \* Activate array. |
  | 124 | 126 | \*/ |
  | 125 |  | public function manageMediaColumns($columns) |
  | 126 |  | { |
  | 127 |  | $columns['imageseo\_alt'] = \_\_('Alt (imageseo)', 'imageseo'); |
  | 128 |  | $columns['imageseo\_filename'] = \_\_('Filename (imageseo)', 'imageseo'); |
  |  | 127 | public function manageMediaColumns( $columns ) { |
  |  | 128 | $columns['imageseo\_alt']      = \_\_( 'Alt (imageseo)', 'imageseo' ); |
  |  | 129 | $columns['imageseo\_filename'] = \_\_( 'Filename (imageseo)', 'imageseo' ); |
  | 129 | 130 |  |
  | 130 | 131 | return $columns; |
  | 131 | 132 | } |
  | 132 | 133 |  |
  | 133 |  | protected function renderAlt($attachmentId) |
  | 134 |  | { |
  | 135 |  | $alt = wp\_strip\_all\_tags($this->altService->getAlt($attachmentId)); ?> |
  | 136 |  | <div class="media-column-imageseo-alt" data-id="<?php echo absint($attachmentId); ?>" data-alt="<?php echo $alt; ?>"> |
  |  | 134 | protected function renderAlt( $attachmentId ) { |
  |  | 135 | $alt = wp\_strip\_all\_tags( $this->altService->getAlt( $attachmentId ) ); ?> |
  |  | 136 | <div class="media-column-imageseo-alt" data-id="<?php echo absint( $attachmentId ); ?>" data-alt="<?php echo $alt; ?>"> |
  | 137 | 137 | </div> |
  | 138 |  | <?php |
  |  | 138 | <?php |
  | 139 | 139 | } |
  | 140 | 140 |  |
  | 141 |  | public function renderFilename($attachmentId) |
  | 142 |  | { |
  | 143 |  | $filename = $this->generateFilename->getFilenameByAttachmentId($attachmentId); |
  | 144 |  | ?> |
  | 145 |  | <div class="media-column-imageseo-filename" data-id="<?php echo absint($attachmentId); ?>" data-filename="<?php echo esc\_html($filename); ?>"></div> |
  | 146 |  | <?php |
  |  | 141 | public function renderFilename( $attachmentId ) { |
  |  | 142 | $filename = $this->generateFilename->getFilenameByAttachmentId( $attachmentId ); |
  |  | 143 | ?> |
  |  | 144 | <div class="media-column-imageseo-filename" data-id="<?php echo absint( $attachmentId ); ?>" data-filename="<?php echo esc\_html( $filename ); ?>"></div> |
  |  | 145 | <?php |
  | 147 | 146 | } |
  | 148 | 147 |  |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L151) | […](/browser/imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php?rev=3122915#L150) |  |
  | 151 | 150 | \* @param $attachmentId |
  | 152 | 151 | \*/ |
  | 153 |  | public function manageMediaCustomColumn(string $columnName, $attachmentId) |
  | 154 |  | { |
  | 155 |  | switch ($columnName) { |
  |  | 152 | public function manageMediaCustomColumn( string $columnName, $attachmentId ) { |
  |  | 153 | switch ( $columnName ) { |
  | 156 | 154 | case 'imageseo\_alt': |
  | 157 |  | $this->renderAlt(~~$attachmentId~~); |
  |  | 155 | $this->renderAlt( $attachmentId ); |
  | 158 | 156 | break; |
  | 159 | 157 | case 'imageseo\_filename': |
  | 160 |  | $this->renderFilename(~~$attachmentId~~); |
  |  | 158 | $this->renderFilename( $attachmentId ); |
  | 161 | 159 | break; |
  | 162 | 160 | } |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L169) | […](/browser/imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php?rev=3122915#L167) |  |
  | 169 | 167 | \* @return void |
  | 170 | 168 | \*/ |
  | 171 |  | public function enqueue\_scripts($page) |
  | 172 |  | { |
  | 173 |  | if ($page !== 'upload.php') { |
  |  | 169 | public function enqueue\_scripts( $page ) { |
  |  | 170 | if ( $page !== 'upload.php' ) { |
  | 174 | 171 | return; |
  | 175 | 172 | } |
  | 176 | 173 |  |
  | 177 | 174 | $asset\_script\_path = IMAGESEO\_DIR\_DIST . '/adminv2/index.asset.php'; |
  | 178 |  | $asset\_file = require $asset\_script\_path; |
  |  | 175 | $asset\_file        = require $asset\_script\_path; |
  | 179 | 176 | wp\_enqueue\_media(); |
  | 180 | 177 | wp\_enqueue\_script( |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L187) | […](/browser/imageseo/tags/3.1.2/src/Actions/Admin/MediaLibrary.php?rev=3122915#L184) |  |
  | 187 | 184 | 'imageseo-admin-v2', |
  | 188 | 185 | IMAGESEO\_URL\_DIST . '/adminv2/index.css', |
  | 189 |  | ~~['wp-components']~~, |
  |  | 186 | array( 'wp-components' ), |
  | 190 | 187 | $asset\_file['version'] |
  | 191 | 188 | ); |
* ## [imageseo/tags/3.1.2/src/Actions/RestApi.php](/changeset/3122915/imageseo/tags/3.1.2/src/Actions/RestApi.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/src/Actions/RestApi.php")

  | [r3114144](/browser/imageseo/trunk/src/Actions/RestApi.php?rev=3114144#L358 "Show revision 3114144 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/src/Actions/RestApi.php?rev=3122915#L358 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 358 | 358 | $options['activeRenameWriteUpload']    = (bool) $value; |
  | 359 | 359 | $options['active\_rename\_write\_upload'] = (bool) $value; |
  |  | 360 | break; |
  |  | 361 | case 'optimizeTitle': |
  |  | 362 | case 'optimizeCaption': |
  |  | 363 | case 'activeOptimizeTitle': |
  |  | 364 | case 'activeOptimizeCaption': |
  |  | 365 | $options[ $key ] = (bool) $value; |
  | 360 | 366 | break; |
  | 361 | 367 | case 'default\_language\_ia': |
* ## [imageseo/tags/3.1.2/src/Admin/SettingsPage.php](/changeset/3122915/imageseo/tags/3.1.2/src/Admin/SettingsPage.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/src/Admin/SettingsPage.php")

  | [r3093706](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L6 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/src/Admin/SettingsPage.php?rev=3122915#L6 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | use ImageSeoWP\Helpers\Pages; |
  | 7 | 7 |  |
  | 8 |  | class SettingsPage |
  | 9 |  | { |
  |  | 8 | class SettingsPage { |
  |  | 9 |  |
  | 10 | 10 |  |
  | 11 | 11 | public static $instance; |
  | 12 | 12 |  |
  | 13 |  | public static function get\_instance(): SettingsPage |
  | 14 |  | { |
  |  | 13 | public static function get\_instance(): SettingsPage { |
  | 15 | 14 |  |
  | 16 |  | if (~~!isset(self::$instance) && !(self::$instance instanceof SettingsPage)~~) { |
  |  | 15 | if ( ! isset( self::$instance ) && ! ( self::$instance instanceof SettingsPage ) ) { |
  | 17 | 16 | self::$instance = new SettingsPage(); |
  | 18 | 17 | } |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L21) | […](/browser/imageseo/tags/3.1.2/src/Admin/SettingsPage.php?rev=3122915#L20) |  |
  | 21 | 20 | } |
  | 22 | 21 |  |
  | 23 |  | private function \_\_construct() |
  | 24 |  | { |
  |  | 22 | private function \_\_construct() { |
  | 25 | 23 | $this->hooks(); |
  | 26 | 24 | } |
  | 27 | 25 |  |
  | 28 |  | private function hooks() |
  | 29 |  | { |
  | 30 |  | add\_action('admin\_menu', array($this, 'plugin\_menu')); |
  | 31 |  | add\_action('admin\_enqueue\_scripts', array($this, 'enqueue\_scripts')); |
  |  | 26 | private function hooks() { |
  |  | 27 | add\_action( 'admin\_menu', array( $this, 'plugin\_menu' ) ); |
  |  | 28 | add\_action( 'admin\_enqueue\_scripts', array( $this, 'enqueue\_scripts' ) ); |
  | 32 | 29 | } |
  | 33 | 30 |  |
  | 34 |  | public function plugin\_menu() |
  | 35 |  | { |
  |  | 31 | public function plugin\_menu() { |
  | 36 | 32 | add\_menu\_page( |
  | 37 | 33 | 'Image SEO', |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L39) | […](/browser/imageseo/tags/3.1.2/src/Admin/SettingsPage.php?rev=3122915#L35) |  |
  | 39 | 35 | 'manage\_options', |
  | 40 | 36 | Pages::SETTINGS, |
  | 41 |  | ~~[~~ |
  |  | 37 | array( |
  | 42 | 38 | $this, |
  | 43 |  | 'imageseo\_settings' |
  | 44 |  | ~~]~~, |
  |  | 39 | 'imageseo\_settings', |
  |  | 40 | ), |
  | 45 | 41 | 'dashicons-imageseo-logo' |
  | 46 | 42 | ); |
  | 47 | 43 | } |
  | 48 | 44 |  |
  | 49 |  | public function imageseo\_settings() |
  | 50 |  | { |
  |  | 45 | public function imageseo\_settings() { |
  | 51 | 46 | echo '<div id="imageseo-settings-v2"></div>'; |
  | 52 | 47 | } |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L57) | […](/browser/imageseo/tags/3.1.2/src/Admin/SettingsPage.php?rev=3122915#L52) |  |
  | 57 | 52 | \* @return string |
  | 58 | 53 | \*/ |
  | 59 |  | public static function get\_url() |
  | 60 |  | { |
  | 61 |  | return admin\_url('admin.php?page=imageseo-settings'); |
  |  | 54 | public static function get\_url() { |
  |  | 55 | return admin\_url( 'admin.php?page=imageseo-settings' ); |
  | 62 | 56 | } |
  | 63 | 57 |  |
  | 64 |  | public function enqueue\_scripts() |
  | 65 |  | { |
  | 66 |  | if (!isset($\_GET['page']) || $\_GET['page'] !== Pages::SETTINGS) { |
  |  | 58 | public function enqueue\_scripts() { |
  |  | 59 | if ( ! isset( $\_GET['page'] ) || $\_GET['page'] !== Pages::SETTINGS ) { |
  | 67 | 60 | return; |
  | 68 | 61 | } |
  | 69 | 62 |  |
  | 70 | 63 | try { |
  | 71 |  | $all\_post\_types     = imageseo\_get\_service(~~'WordPressData'~~)->getAllPostTypesSocialMedia(); |
  |  | 64 | $all\_post\_types     = imageseo\_get\_service( 'WordPressData' )->getAllPostTypesSocialMedia(); |
  | 72 | 65 | $allowed\_post\_types = array(); |
  | 73 |  | foreach (~~$all\_post\_types as $post\_type~~) { |
  | 74 |  | $allowed\_post\_types[] = ~~[~~ |
  |  | 66 | foreach ( $all\_post\_types as $post\_type ) { |
  |  | 67 | $allowed\_post\_types[] = array( |
  | 75 | 68 | 'value' => $post\_type->name, |
  | 76 |  | 'label' => $post\_type->label |
  | 77 |  | ~~]~~; |
  |  | 69 | 'label' => $post\_type->label, |
  |  | 70 | ); |
  | 78 | 71 | } |
  | 79 | 72 |  |
  | 80 |  | $language\_codes = imageseo\_get\_service(~~'ClientApi'~~)->getLanguages(); |
  |  | 73 | $language\_codes = imageseo\_get\_service( 'ClientApi' )->getLanguages(); |
  | 81 | 74 |  |
  | 82 |  | $totalImages = imageseo\_get\_service(~~'QueryImages'~~)->getTotalImages( |
  | 83 |  | ~~[~~ |
  | 84 |  | 'withCache'  => ~~fals~~e, |
  | 85 |  | 'forceQuery' => true |
  | 86 |  | ~~]~~ |
  |  | 75 | $totalImages = imageseo\_get\_service( 'QueryImages' )->getTotalImages( |
  |  | 76 | array( |
  |  | 77 | 'withCache'  => true, |
  |  | 78 | 'forceQuery' => true, |
  |  | 79 | ) |
  | 87 | 80 | ); |
  | 88 |  | $totalNoAlt  = imageseo\_get\_service(~~'QueryImages'~~)->getNumberImageNonOptimizeAlt( |
  | 89 |  | ~~[~~ |
  | 90 |  | 'withCache'  => ~~fals~~e, |
  | 91 |  | 'forceQuery' => true |
  | 92 |  | ~~]~~ |
  |  | 81 | $totalNoAlt  = imageseo\_get\_service( 'QueryImages' )->getNumberImageNonOptimizeAlt( |
  |  | 82 | array( |
  |  | 83 | 'withCache'  => true, |
  |  | 84 | 'forceQuery' => true, |
  |  | 85 | ) |
  | 93 | 86 | ); |
  | 94 | 87 |  |
  | 95 |  | $bulkQuery = imageseo\_get\_service(~~'BulkOptimizerQuery'~~)->getImages(); |
  |  | 88 | $bulkQuery = imageseo\_get\_service( 'BulkOptimizerQuery' )->getImages(); |
  | 96 | 89 |  |
  | 97 |  | $languages = ~~[]~~; |
  | 98 |  | foreach (~~$language\_codes as $language~~) { |
  | 99 |  | $languages[] = ~~[~~ |
  |  | 90 | $languages = array(); |
  |  | 91 | foreach ( $language\_codes as $language ) { |
  |  | 92 | $languages[] = array( |
  | 100 | 93 | 'value' => $language['code'], |
  | 101 |  | 'label' => $language['name'] |
  | 102 |  | ~~]~~; |
  |  | 94 | 'label' => $language['name'], |
  |  | 95 | ); |
  | 103 | 96 | } |
  | 104 | 97 |  |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L110) | […](/browser/imageseo/tags/3.1.2/src/Admin/SettingsPage.php?rev=3122915#L103) |  |
  | 110 | 103 | 'email'     => '', |
  | 111 | 104 | 'firstName' => '', |
  | 112 |  | 'lastName'  => '' |
  |  | 105 | 'lastName'  => '', |
  | 113 | 106 | ); |
  | 114 | 107 |  |
  | 115 |  | if (~~in\_array('administrator', $current\_user->roles)~~) { |
  |  | 108 | if ( in\_array( 'administrator', $current\_user->roles ) ) { |
  | 116 | 109 | $user\_info['email']     = $current\_user->user\_email; |
  | 117 | 110 | $user\_info['firstName'] = $current\_user->user\_firstname; |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L119) | […](/browser/imageseo/tags/3.1.2/src/Admin/SettingsPage.php?rev=3122915#L112) |  |
  | 119 | 112 | } |
  | 120 | 113 |  |
  | 121 |  | $camelCased = ~~[]~~; |
  |  | 114 | $camelCased = array(); |
  | 122 | 115 |  |
  | 123 |  | foreach (~~$options as $key => $value~~) { |
  | 124 |  | if (~~strpos($key, '\_') === -1~~) { |
  | 125 |  | $camelCased[~~$key~~] = $value; |
  |  | 116 | foreach ( $options as $key => $value ) { |
  |  | 117 | if ( strpos( $key, '\_' ) === -1 ) { |
  |  | 118 | $camelCased[ $key ] = $value; |
  | 126 | 119 | continue; |
  | 127 | 120 | } |
  | 128 | 121 |  |
  | 129 |  | $camelCaseKey                = lcfirst(~~str\_replace('\_', '', ucwords($key, '\_'))~~); |
  | 130 |  | $camelCased[~~$camelCaseKey~~] = $value; |
  |  | 122 | $camelCaseKey                = lcfirst( str\_replace( '\_', '', ucwords( $key, '\_' ) ) ); |
  |  | 123 | $camelCased[ $camelCaseKey ] = $value; |
  | 131 | 124 | } |
  | 132 | 125 |  |
  | 133 | 126 | $camelCased['user'] = $user\_info; |
  | 134 | 127 |  |
  | 135 |  | $global = ~~[~~ |
  |  | 128 | $global = array( |
  | 136 | 129 | 'languages'        => $languages, |
  | 137 |  | 'nonce'            => wp\_create\_nonce(~~'wp\_rest'~~), |
  | 138 |  | 'apiUrl'           => get\_rest\_url(~~null, 'imageseo/v1'~~), |
  |  | 130 | 'nonce'            => wp\_create\_nonce( 'wp\_rest' ), |
  |  | 131 | 'apiUrl'           => get\_rest\_url( null, 'imageseo/v1' ), |
  | 139 | 132 | 'user'             => $user\_info, |
  | 140 | 133 | 'currentLanguage'  => $current\_language, |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L144) | […](/browser/imageseo/tags/3.1.2/src/Admin/SettingsPage.php?rev=3122915#L137) |  |
  | 144 | 137 | 'altSpecification' => AltSpecification::getMetas(), |
  | 145 | 138 | 'bulkQuery'        => $bulkQuery, |
  | 146 |  | ~~]~~; |
  |  | 139 | ); |
  | 147 | 140 | wp\_add\_inline\_script( |
  | 148 | 141 | 'imageseo-v2', |
  | 149 |  | 'const imageSeoGlobal = ' . json\_encode(~~$global~~), |
  |  | 142 | 'const imageSeoGlobal = ' . json\_encode( $global ), |
  | 150 | 143 | 'before' |
  | 151 | 144 | ); |
  | 152 | 145 | wp\_add\_inline\_script( |
  | 153 | 146 | 'imageseo-v2', |
  | 154 |  | 'const imageSeoSettings = ' . json\_encode(~~$camelCased~~), |
  |  | 147 | 'const imageSeoSettings = ' . json\_encode( $camelCased ), |
  | 155 | 148 | 'before' |
  | 156 | 149 | ); |
  | 157 |  | } catch (~~\Exception $e~~) { |
  |  | 150 | } catch ( \Exception $e ) { |
  | 158 | 151 | // Do nothing |
  | 159 | 152 | } |
* ## [imageseo/tags/3.1.2/src/Processes/OnUploadImage.php](/changeset/3122915/imageseo/tags/3.1.2/src/Processes/OnUploadImage.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/src/Processes/OnUploadImage.php")

  | [r3093706](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3093706#L8 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/src/Processes/OnUploadImage.php?rev=3122915#L8 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | use ImageSeoWP\Traits\ApiHandler; |
  | 9 | 9 |  |
  | 10 |  | if (~~!defined('ABSPATH')~~) { |
  |  | 10 | if ( ! defined( 'ABSPATH' ) ) { |
  | 11 | 11 | exit; |
  | 12 | 12 | } |
  | 13 | 13 |  |
  | 14 |  | class OnUploadImage extends WPAsyncRequest |
  | 15 |  | { |
  |  | 14 | class OnUploadImage extends WPAsyncRequest { |
  |  | 15 |  |
  | 16 | 16 | use ApiHandler; |
  | 17 | 17 |  |
  | […](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3093706#L21) | […](/browser/imageseo/tags/3.1.2/src/Processes/OnUploadImage.php?rev=3122915#L21) |  |
  | 21 | 21 | public static $instance; |
  | 22 | 22 |  |
  | 23 |  | public static function getInstance(): OnUploadImage |
  | 24 |  | { |
  | 25 |  | if (!isset(self::$instance) && !(self::$instance instanceof OnUploadImage)) { |
  |  | 23 | public static function getInstance(): OnUploadImage { |
  |  | 24 | if ( ! isset( self::$instance ) && ! ( self::$instance instanceof OnUploadImage ) ) { |
  | 26 | 25 | self::$instance = new OnUploadImage(); |
  | 27 | 26 | } |
  | […](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3093706#L30) | […](/browser/imageseo/tags/3.1.2/src/Processes/OnUploadImage.php?rev=3122915#L29) |  |
  | 30 | 29 | } |
  | 31 | 30 |  |
  | 32 |  | protected function handle() |
  | 33 |  | { |
  |  | 31 | protected function handle() { |
  | 34 | 32 | $this->setServices(); |
  | 35 | 33 |  |
  | 36 |  | if (~~imageseo\_get\_service('UserInfo')->hasLimitExcedeed()~~) { |
  |  | 34 | if ( imageseo\_get\_service( 'UserInfo' )->hasLimitExcedeed() ) { |
  | 37 | 35 | return; |
  | 38 | 36 | } |
  | 39 | 37 |  |
  | 40 |  | $attachmentId = $\_POST['attachment\_id']; |
  | 41 |  | $fillAlt      = $\_POST['active\_alt\_on\_upload']; |
  | 42 |  | $renameFile   = $\_POST['active\_rename\_on\_upload']; |
  |  | 38 | $attachmentId     = $\_POST['attachmentId']; |
  |  | 39 | $optimizeAlt      = $\_POST['activeAltWriteUpload']; |
  |  | 40 | $optimizeFilename = $\_POST['activeRenameWriteUpload']; |
  |  | 41 | $optimizeTitle    = $\_POST['activeOptimizeTitle']; |
  |  | 42 | $optimizeCaption  = $\_POST['activeOptimizeCaption']; |
  | 43 | 43 |  |
  | 44 |  | if (~~empty($attachmentId)~~) { |
  |  | 44 | if ( empty( $attachmentId ) ) { |
  | 45 | 45 | return; |
  | 46 | 46 | } |
  | 47 | 47 |  |
  | 48 |  | if (empty($fillAlt) && empty($renameFile)) { |
  |  | 48 | if ( empty( $optimizeAlt ) |
  |  | 49 | && empty( $optimizeFilename ) |
  |  | 50 | && empty( $optimizeTitle ) |
  |  | 51 | && empty( $optimizeCaption ) |
  |  | 52 | ) { |
  | 49 | 53 | return; |
  | 50 | 54 | } |
  | 51 | 55 |  |
  | 52 |  | $extension = $this->generateFilename->getExtensionFilenameByAttachmentId(~~$attachmentId~~); |
  | 53 |  | if (~~!in\_array($extension, ['png', 'jpg', 'jpeg'])~~) { |
  |  | 56 | $extension = $this->generateFilename->getExtensionFilenameByAttachmentId( $attachmentId ); |
  |  | 57 | if ( ! in\_array( $extension, array( 'png', 'jpg', 'jpeg' ) ) ) { |
  | 54 | 58 | return; |
  | 55 | 59 | } |
  | 56 | 60 |  |
  | 57 |  | $images = ~~[~~ |
  | 58 |  | $this->createApiImage(~~$attachmentId)~~ |
  | 59 |  | ~~]~~; |
  |  | 61 | $images = array( |
  |  | 62 | $this->createApiImage( $attachmentId ), |
  |  | 63 | ); |
  | 60 | 64 |  |
  | 61 |  | $response = $this->sendRequestToApi(~~$images, true~~); |
  |  | 65 | $response = $this->sendRequestToApi( $images, true ); |
  | 62 | 66 |  |
  | 63 |  | if (~~$response instanceof Exception~~) { |
  | 64 |  | error\_log(~~$response->getMessage()~~); |
  |  | 67 | if ( $response instanceof Exception ) { |
  |  | 68 | error\_log( $response->getMessage() ); |
  | 65 | 69 |  |
  | 66 | 70 | return; |
  | 67 | 71 | } |
  | 68 | 72 |  |
  | 69 |  | if (~~!isset($response['batchId'])~~) { |
  |  | 73 | if ( ! isset( $response['batchId'] ) ) { |
  | 70 | 74 | return; |
  | 71 | 75 | } |
  | 72 | 76 |  |
  | 73 | 77 | $batchId = $response['batchId']; |
  | 74 |  | $items   = $this->getItemsByBatchId(~~$batchId~~); |
  | 75 |  | if (~~$items instanceof Exception~~) { |
  | 76 |  | error\_log(~~$items->getMessage()~~); |
  |  | 78 | $items   = $this->getItemsByBatchId( $batchId ); |
  |  | 79 | if ( $items instanceof Exception ) { |
  |  | 80 | error\_log( $items->getMessage() ); |
  | 77 | 81 |  |
  | 78 | 82 | return; |
  | […](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3093706#L82) | […](/browser/imageseo/tags/3.1.2/src/Processes/OnUploadImage.php?rev=3122915#L86) |  |
  | 82 | 86 | $attachmentId = $image['internalId']; |
  | 83 | 87 |  |
  | 84 |  | if (~~$fillAlt~~) { |
  | 85 |  | $this->altService->updateAlt(~~$image['internalId'], $image['altText']~~); |
  |  | 88 | if ( $optimizeAlt ) { |
  |  | 89 | $this->altService->updateAlt( $image['internalId'], $image['altText'] ); |
  | 86 | 90 | } |
  | 87 | 91 |  |
  | 88 |  | if (~~$renameFile~~) { |
  | 89 |  | $extension = $this->generateFilename->getExtensionFilenameByAttachmentId(~~$attachmentId~~); |
  |  | 92 | if ( $optimizeFilename ) { |
  |  | 93 | $extension = $this->generateFilename->getExtensionFilenameByAttachmentId( $attachmentId ); |
  | 90 | 94 | $this->fileService->updateFilename( |
  | 91 | 95 | $image['internalId'], |
  | 92 |  | sprintf(~~'%s.%s', $image['filename'], $extension~~) |
  |  | 96 | sprintf( '%s.%s', $image['filename'], $extension ) |
  | 93 | 97 | ); |
  | 94 | 98 | } |
  | 95 | 99 |  |
  | 96 |  | update\_post\_meta($attachmentId, AttachmentMeta::REPORT, $image); |
  |  | 100 | if ( $optimizeTitle && |
  |  | 101 | isset( $image['title'] ) && |
  |  | 102 | ! empty( $image['title'] ) |
  |  | 103 | ) { |
  |  | 104 | $post\_data = array( |
  |  | 105 | 'ID'         => $attachmentId, |
  |  | 106 | 'post\_title' => $image['title'], |
  |  | 107 | ); |
  |  | 108 |  |
  |  | 109 | wp\_update\_post( $post\_data ); |
  |  | 110 | } |
  |  | 111 |  |
  |  | 112 | if ( $optimizeCaption && |
  |  | 113 | isset( $image['caption'] ) && |
  |  | 114 | ! empty( $image['caption'] ) ) { |
  |  | 115 | $post\_data = array( |
  |  | 116 | 'ID'           => $attachmentId, |
  |  | 117 | 'post\_excerpt' => $image['caption'], |
  |  | 118 | ); |
  |  | 119 |  |
  |  | 120 | wp\_update\_post( $post\_data ); |
  |  | 121 | } |
  |  | 122 |  |
  |  | 123 | update\_post\_meta( $attachmentId, AttachmentMeta::REPORT, $image ); |
  | 97 | 124 | } |
  | 98 | 125 | } |
* ## [imageseo/tags/3.1.2/src/Services/BulkOptimizer.php](/changeset/3122915/imageseo/tags/3.1.2/src/Services/BulkOptimizer.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/src/Services/BulkOptimizer.php")

  | [r3093706](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3093706#L333 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/src/Services/BulkOptimizer.php?rev=3122915#L333 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 333 | 333 | $failed           = array(); |
  | 334 | 334 |  |
  |  | 335 | $actions = array( |
  |  | 336 | 'alt'      => $this->optionService->getOption( 'altFill' ), |
  |  | 337 | 'filename' => $this->optionService->getOption( 'optimizeFile' ), |
  |  | 338 | 'title'    => $this->optionService->getOption( 'optimizeTitle' ), |
  |  | 339 | 'caption'  => $this->optionService->getOption( 'optimizeCaption' ), |
  |  | 340 | ); |
  |  | 341 |  |
  | 335 | 342 | $report = get\_option( 'imageseo\_bulk\_optimizer\_last\_report' ); |
  | 336 | 343 | foreach ( $batchData as $image ) { |
  | 337 | 344 | if ( $image['resolved'] ) { |
  | 338 |  | $this->handleResolvedImage( $image, $isNextGen, $~~optimizeFilename~~, $optimized ); |
  |  | 345 | $this->handleResolvedImage( $image, $isNextGen, $actions, $optimized ); |
  | 339 | 346 | continue; |
  | 340 | 347 | } |
  | […](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3093706#L366) | […](/browser/imageseo/tags/3.1.2/src/Services/BulkOptimizer.php?rev=3122915#L373) |  |
  | 366 | 373 | } |
  | 367 | 374 |  |
  | 368 |  | private function handleResolvedImage( $image, $isNextGen, $~~optimizeFilename~~, &$optimized ) { |
  |  | 375 | private function handleResolvedImage( $image, $isNextGen, $actions, &$optimized ) { |
  | 369 | 376 | $attachmentId = $isNextGen |
  | 370 | 377 | ? imageseo\_get\_service( 'QueryNextGen' )->getPostIdByNextGenId( $image['internalId'] ) : $image['internalId']; |
  | […](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3093706#L397) | […](/browser/imageseo/tags/3.1.2/src/Services/BulkOptimizer.php?rev=3122915#L404) |  |
  | 397 | 404 | } |
  | 398 | 405 |  |
  | 399 |  | if ( ~~$optimizeFilename~~ && ! $skipFilename ) { |
  |  | 406 | if ( in\_array( 'filename', $actions ) && ! $skipFilename ) { |
  | 400 | 407 | $extension = $this->extractExtension( $image['imageUrl'] ); |
  | 401 | 408 |  |
  | […](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3093706#L412) | […](/browser/imageseo/tags/3.1.2/src/Services/BulkOptimizer.php?rev=3122915#L419) |  |
  | 412 | 419 | } |
  | 413 | 420 |  |
  |  | 421 | if ( in\_array( 'title', $actions ) && |
  |  | 422 | isset( $image['title'] ) && |
  |  | 423 | ! empty( $image['title'] ) |
  |  | 424 | ) { |
  |  | 425 | $post\_data = array( |
  |  | 426 | 'ID'         => $attachmentId, |
  |  | 427 | 'post\_title' => $image['title'], |
  |  | 428 | ); |
  |  | 429 |  |
  |  | 430 | wp\_update\_post( $post\_data ); |
  |  | 431 | } |
  |  | 432 |  |
  |  | 433 | if ( in\_array( 'caption', $actions ) && |
  |  | 434 | isset( $image['caption'] ) && |
  |  | 435 | ! empty( $image['caption'] ) ) { |
  |  | 436 | $post\_data = array( |
  |  | 437 | 'ID'           => $attachmentId, |
  |  | 438 | 'post\_excerpt' => $image['caption'], |
  |  | 439 | ); |
  |  | 440 |  |
  |  | 441 | wp\_update\_post( $post\_data ); |
  |  | 442 | } |
  |  | 443 |  |
  | 414 | 444 | $optimized[] = $image['internalId']; |
  | 415 | 445 | } |
* ## [imageseo/tags/3.1.2/src/Services/Option.php](/changeset/3122915/imageseo/tags/3.1.2/src/Services/Option.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/src/Services/Option.php")

  | [r3093706](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L3 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915#L3 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | namespace ImageSeoWP\Services; |
  | 4 | 4 |  |
  | 5 |  | if (~~!defined('ABSPATH')~~) { |
  |  | 5 | if ( ! defined( 'ABSPATH' ) ) { |
  | 6 | 6 | exit; |
  | 7 | 7 | } |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L9) | […](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915#L9) |  |
  | 9 | 9 | use ImageSeoWP\Helpers\SocialMedia; |
  | 10 | 10 |  |
  | 11 |  | class Option |
  | 12 |  | { |
  |  | 11 | class Option { |
  |  | 12 |  |
  | 13 | 13 | /\*\* |
  | 14 | 14 | \* @var array |
  | 15 | 15 | \*/ |
  | 16 |  | protected $optionsDefault = ~~[~~ |
  |  | 16 | protected $optionsDefault = array( |
  | 17 | 17 | 'api\_key'                    => '', |
  | 18 | 18 | 'allowed'                    => false, |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L21) | […](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915#L21) |  |
  | 21 | 21 | 'default\_language\_ia'        => IMAGESEO\_LOCALE, |
  | 22 | 22 | 'alt\_template\_default'       => '[keyword\_1] - [keyword\_2]', |
  | 23 |  | 'social\_media\_post\_types'    => ~~[~~ |
  |  | 23 | 'social\_media\_post\_types'    => array( |
  | 24 | 24 | 'post', |
  | 25 |  | ~~]~~, |
  | 26 |  | 'social\_media\_type'          => ~~[~~ |
  |  | 25 | ), |
  |  | 26 | 'social\_media\_type'          => array( |
  | 27 | 27 | SocialMedia::OPEN\_GRAPH['name'], |
  | 28 |  | ~~]~~, |
  | 29 |  | 'social\_media\_settings'      => ~~[~~ |
  |  | 28 | ), |
  |  | 29 | 'social\_media\_settings'      => array( |
  | 30 | 30 | 'layout'                 => 'CARD\_LEFT', |
  | 31 | 31 | 'textColor'              => '#000000', |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L38) | […](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915#L38) |  |
  | 38 | 38 | 'logoUrl'                => IMAGESEO\_URL\_DIST . '/images/favicon.png', |
  | 39 | 39 | 'defaultBgImg'           => IMAGESEO\_URL\_DIST . '/images/default\_logo.png', |
  | 40 |  | 'textAlignment'          => 'top' |
  | 41 |  | ~~]~~, |
  |  | 40 | 'textAlignment'          => 'top', |
  |  | 41 | ), |
  | 42 | 42 | 'altFilter'                  => 'ALL', |
  | 43 | 43 | 'altFill'                    => 'FILL\_ALL', |
  | 44 | 44 | 'optimizeAlt'                => 0, |
  | 45 | 45 | 'language'                   => IMAGESEO\_LOCALE, |
  | 46 |  | ]; |
  |  | 46 | 'optimizeTitle'              => false, |
  |  | 47 | 'optimizeCaption'            => false, |
  |  | 48 | 'activeOptimizeTitle'        => true, |
  |  | 49 | 'activeOptimizeCaption'      => true, |
  |  | 50 | ); |
  | 47 | 51 |  |
  | 48 | 52 | /\*\* |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L51) | […](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915#L55) |  |
  | 51 | 55 | \* @return array |
  | 52 | 56 | \*/ |
  | 53 |  | public function getOptionsDefault() |
  | 54 |  | { |
  | 55 |  | return $this->convert\_to\_camel\_case($this->optionsDefault); |
  |  | 57 | public function getOptionsDefault() { |
  |  | 58 | return $this->convert\_to\_camel\_case( $this->optionsDefault ); |
  | 56 | 59 | } |
  | 57 | 60 |  |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L59) | […](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915#L62) |  |
  | 59 | 62 | \* @return array |
  | 60 | 63 | \*/ |
  | 61 |  | public function getOptions() |
  | 62 |  | { |
  |  | 64 | public function getOptions() { |
  | 63 | 65 | return apply\_filters( |
  | 64 | 66 | 'imageseo\_get\_options', |
  | 65 |  | wp\_parse\_args(~~get\_option(IMAGESEO\_SLUG), $this->getOptionsDefault()~~) |
  |  | 67 | wp\_parse\_args( get\_option( IMAGESEO\_SLUG ), $this->getOptionsDefault() ) |
  | 66 | 68 | ); |
  | 67 | 69 | } |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L72) | […](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915#L74) |  |
  | 72 | 74 | \* @return array |
  | 73 | 75 | \*/ |
  | 74 |  | public function getOption($name) |
  | 75 |  | { |
  |  | 76 | public function getOption( $name ) { |
  | 76 | 77 | $options = $this->getOptions(); |
  | 77 |  | if (~~!array\_key\_exists($name, $options)~~) { |
  |  | 78 | if ( ! array\_key\_exists( $name, $options ) ) { |
  | 78 | 79 | return null; |
  | 79 | 80 | } |
  | 80 | 81 |  |
  | 81 |  | return apply\_filters(~~'imageseo\_' . $name . '\_option', $options[$name]~~); |
  |  | 82 | return apply\_filters( 'imageseo\_' . $name . '\_option', $options[ $name ] ); |
  | 82 | 83 | } |
  | 83 | 84 |  |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L87) | […](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915#L88) |  |
  | 87 | 88 | \* @return $this |
  | 88 | 89 | \*/ |
  | 89 |  | public function setOptions($options) |
  | 90 |  | { |
  | 91 |  | update\_option(IMAGESEO\_SLUG, $options); |
  |  | 90 | public function setOptions( $options ) { |
  |  | 91 | update\_option( IMAGESEO\_SLUG, $options ); |
  | 92 | 92 |  |
  | 93 | 93 | return $this; |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L100) | […](/browser/imageseo/tags/3.1.2/src/Services/Option.php?rev=3122915#L100) |  |
  | 100 | 100 | \* @return $this |
  | 101 | 101 | \*/ |
  | 102 |  | public function setOptionByKey($key, $value) |
  | 103 |  | { |
  | 104 |  | $options = $this->getOptions(); |
  | 105 |  | $options[$key] = $value; |
  | 106 |  | $this->setOptions($options); |
  |  | 102 | public function setOptionByKey( $key, $value ) { |
  |  | 103 | $options         = $this->getOptions(); |
  |  | 104 | $options[ $key ] = $value; |
  |  | 105 | $this->setOptions( $options ); |
  | 107 | 106 |  |
  | 108 | 107 | return $this; |
  | 109 | 108 | } |
  | 110 | 109 |  |
  | 111 |  | private function convert\_to\_camel\_case($options) |
  | 112 |  | { |
  | 113 |  | $camelCased = []; |
  |  | 110 | private function convert\_to\_camel\_case( $options ) { |
  |  | 111 | $camelCased = array(); |
  | 114 | 112 |  |
  | 115 |  | foreach (~~$options as $key => $value~~) { |
  | 116 |  | if (~~strpos($key, '\_') === -1~~) { |
  | 117 |  | $camelCased[~~$key~~] = $value; |
  |  | 113 | foreach ( $options as $key => $value ) { |
  |  | 114 | if ( strpos( $key, '\_' ) === -1 ) { |
  |  | 115 | $camelCased[ $key ] = $value; |
  | 118 | 116 | continue; |
  | 119 |  | }~~;~~ |
  |  | 117 | } |
  | 120 | 118 |  |
  | 121 |  | $camelCaseKey ~~= lcfirst(str\_replace('\_', '', ucwords($key, '\_'))~~); |
  | 122 |  | $camelCased[~~$camelCaseKey~~] = $value; |
  |  | 119 | $camelCaseKey                = lcfirst( str\_replace( '\_', '', ucwords( $key, '\_' ) ) ); |
  |  | 120 | $camelCased[ $camelCaseKey ] = $value; |
  | 123 | 121 | } |
  | 124 | 122 |  |
* ## [imageseo/tags/3.1.2/src/Traits/Debug.php](/changeset/3122915/imageseo/tags/3.1.2/src/Traits/Debug.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/src/Traits/Debug.php")

  | [r3093706](/browser/imageseo/trunk/src/Traits/Debug.php?rev=3093706#L3 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/src/Traits/Debug.php?rev=3122915#L3 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | namespace ImageSeoWP\Traits; |
  | 4 | 4 |  |
  | 5 |  | trait Debug |
  | 6 |  | { |
  | 7 |  | p~~ublic function resetDebug()~~ |
  | 8 |  | { |
  | 9 |  | update\_option(~~$this->debugOption, []~~); |
  |  | 5 | trait Debug { |
  |  | 6 |  |
  |  | 7 | private $debugLock = 'imageseo\_bulk\_optimizer\_debug\_lock'; |
  |  | 8 | public function resetDebug() { |
  |  | 9 | update\_option( $this->debugOption, array() ); |
  | 10 | 10 | } |
  | 11 | 11 |  |
  | 12 |  | public function getDebug() |
  | 13 |  | { |
  | 14 |  | return get\_option($this->debugOption, []); |
  |  | 12 | public function getDebug() { |
  |  | 13 | return get\_option( $this->debugOption, array() ); |
  | 15 | 14 | } |
  | 16 | 15 |  |
  | 17 |  | public function writeDebug($value) |
  | 18 |  | { |
  | 19 |  | $currentDebug = get\_option($this->debugOption, []); |
  | 20 |  | if ($this->debug) { |
  | 21 |  | if (is\_array($value)) |
  | 22 |  | update\_option($this->debugOption, array\_merge( |
  | 23 |  | $currentDebug, |
  | 24 |  | is\_array($value) ? $value : [$value] |
  | 25 |  | )); |
  |  | 16 | public function writeDebug( $value ) { |
  |  | 17 | while ( get\_transient( $this->debugLock ) ) { |
  |  | 18 | usleep( 1000 ); |
  | 26 | 19 | } |
  |  | 20 | set\_transient( $this->debugLock, true, 10 ); |
  |  | 21 |  |
  |  | 22 | $currentDebug = $this->getDebug(); |
  |  | 23 | if ( $this->debug ) { |
  |  | 24 | if ( is\_array( $value ) ) { |
  |  | 25 | update\_option( |
  |  | 26 | $this->debugOption, |
  |  | 27 | array\_merge( |
  |  | 28 | $currentDebug, |
  |  | 29 | $value |
  |  | 30 | ) |
  |  | 31 | ); |
  |  | 32 | } else { |
  |  | 33 | $currentDebug[] = $value; |
  |  | 34 | update\_option( $this->debugOption, $currentDebug ); |
  |  | 35 | } |
  |  | 36 | } |
  |  | 37 |  |
  |  | 38 | delete\_transient( $this->debugLock ); |
  | 27 | 39 | } |
  | 28 | 40 | } |
* ## [imageseo/tags/3.1.2/vendor/autoload.php](/changeset/3122915/imageseo/tags/3.1.2/vendor/autoload.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/vendor/autoload.php")

  | [r3011770](/browser/imageseo/trunk/vendor/autoload.php?rev=3011770#L4 "Show revision 3011770 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/vendor/autoload.php?rev=3122915#L4 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 |  |
  | 5 | 5 | if (PHP\_VERSION\_ID < 50600) { |
  | 6 |  | echo 'Composer 2.3.0 dropped support for autoloading on PHP <5.6 and you are running '.PHP\_VERSION.', please upgrade PHP or use Composer 2.2 LTS via "composer self-update --2.2". Aborting.'.PHP\_EOL; |
  | 7 |  | exit(1); |
  |  | 6 | if (!headers\_sent()) { |
  |  | 7 | header('HTTP/1.1 500 Internal Server Error'); |
  |  | 8 | } |
  |  | 9 | $err = 'Composer 2.3.0 dropped support for autoloading on PHP <5.6 and you are running '.PHP\_VERSION.', please upgrade PHP or use Composer 2.2 LTS via "composer self-update --2.2". Aborting.'.PHP\_EOL; |
  |  | 10 | if (!ini\_get('display\_errors')) { |
  |  | 11 | if (PHP\_SAPI === 'cli' || PHP\_SAPI === 'phpdbg') { |
  |  | 12 | fwrite(STDERR, $err); |
  |  | 13 | } elseif (!headers\_sent()) { |
  |  | 14 | echo $err; |
  |  | 15 | } |
  |  | 16 | } |
  |  | 17 | trigger\_error( |
  |  | 18 | $err, |
  |  | 19 | E\_USER\_ERROR |
  |  | 20 | ); |
  | 8 | 21 | } |
  | 9 | 22 |  |
  | 10 | 23 | require\_once \_\_DIR\_\_ . '/composer/autoload\_real.php'; |
  | 11 | 24 |  |
  | 12 |  | return ComposerAutoloaderInit~~8aee80435795f097aba54ac01df0b70f~~::getLoader(); |
  |  | 25 | return ComposerAutoloaderInite97648f350088b8744107ebf06d18a01::getLoader(); |
* ## [imageseo/tags/3.1.2/vendor/composer/ClassLoader.php](/changeset/3122915/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/vendor/composer/ClassLoader.php")

  | [r2836500](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L43 "Show revision 2836500 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L43 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 43 | 43 | class ClassLoader |
  | 44 | 44 | { |
  | 45 |  | /\*\* @var ?string \*/ |
  |  | 45 | /\*\* @var \Closure(string):void \*/ |
  |  | 46 | private static $includeFile; |
  |  | 47 |  |
  |  | 48 | /\*\* @var string|null \*/ |
  | 46 | 49 | private $vendorDir; |
  | 47 | 50 |  |
  | 48 | 51 | // PSR-4 |
  | 49 | 52 | /\*\* |
  | 50 |  | \* @var array[] |
  | 51 |  | \* @psalm-var array<string, array<string, int>> |
  |  | 53 | \* @var array<string, array<string, int>> |
  | 52 | 54 | \*/ |
  | 53 | 55 | private $prefixLengthsPsr4 = array(); |
  | 54 | 56 | /\*\* |
  | 55 |  | \* @var array[] |
  | 56 |  | \* @psalm-var array<string, array<int, string>> |
  |  | 57 | \* @var array<string, list<string>> |
  | 57 | 58 | \*/ |
  | 58 | 59 | private $prefixDirsPsr4 = array(); |
  | 59 | 60 | /\*\* |
  | 60 |  | \* @var array[] |
  | 61 |  | \* @psalm-var array<string, string> |
  |  | 61 | \* @var list<string> |
  | 62 | 62 | \*/ |
  | 63 | 63 | private $fallbackDirsPsr4 = array(); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L65) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L65) |  |
  | 65 | 65 | // PSR-0 |
  | 66 | 66 | /\*\* |
  | 67 |  | \* @var array[] |
  | 68 |  | \* @psalm-var array<string, array<string, string[]>> |
  |  | 67 | \* List of PSR-0 prefixes |
  |  | 68 | \* |
  |  | 69 | \* Structured as array('F (first letter)' => array('Foo\Bar (full prefix)' => array('path', 'path2'))) |
  |  | 70 | \* |
  |  | 71 | \* @var array<string, array<string, list<string>>> |
  | 69 | 72 | \*/ |
  | 70 | 73 | private $prefixesPsr0 = array(); |
  | 71 | 74 | /\*\* |
  | 72 |  | \* @var array[] |
  | 73 |  | \* @psalm-var array<string, string> |
  |  | 75 | \* @var list<string> |
  | 74 | 76 | \*/ |
  | 75 | 77 | private $fallbackDirsPsr0 = array(); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L79) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L81) |  |
  | 79 | 81 |  |
  | 80 | 82 | /\*\* |
  | 81 |  | \* @var string[] |
  | 82 |  | \* @psalm-var array<string, string> |
  |  | 83 | \* @var array<string, string> |
  | 83 | 84 | \*/ |
  | 84 | 85 | private $classMap = array(); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L88) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L89) |  |
  | 88 | 89 |  |
  | 89 | 90 | /\*\* |
  | 90 |  | \* @var bool[] |
  | 91 |  | \* @psalm-var array<string, bool> |
  |  | 91 | \* @var array<string, bool> |
  | 92 | 92 | \*/ |
  | 93 | 93 | private $missingClasses = array(); |
  | 94 | 94 |  |
  | 95 |  | /\*\* @var ~~?string~~ \*/ |
  |  | 95 | /\*\* @var string|null \*/ |
  | 96 | 96 | private $apcuPrefix; |
  | 97 | 97 |  |
  | 98 | 98 | /\*\* |
  | 99 |  | \* @var ~~self[]~~ |
  |  | 99 | \* @var array<string, self> |
  | 100 | 100 | \*/ |
  | 101 | 101 | private static $registeredLoaders = array(); |
  | 102 | 102 |  |
  | 103 | 103 | /\*\* |
  | 104 |  | \* @param ~~?string~~ $vendorDir |
  |  | 104 | \* @param string|null $vendorDir |
  | 105 | 105 | \*/ |
  | 106 | 106 | public function \_\_construct($vendorDir = null) |
  | 107 | 107 | { |
  | 108 | 108 | $this->vendorDir = $vendorDir; |
  | 109 |  | } |
  | 110 |  |  |
  | 111 |  | /\*\* |
  | 112 |  | \* @return string[] |
  |  | 109 | self::initializeIncludeClosure(); |
  |  | 110 | } |
  |  | 111 |  |
  |  | 112 | /\*\* |
  |  | 113 | \* @return array<string, list<string>> |
  | 113 | 114 | \*/ |
  | 114 | 115 | public function getPrefixes() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L122) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L123) |  |
  | 122 | 123 |  |
  | 123 | 124 | /\*\* |
  | 124 |  | \* @return array[] |
  | 125 |  | \* @psalm-return array<string, array<int, string>> |
  |  | 125 | \* @return array<string, list<string>> |
  | 126 | 126 | \*/ |
  | 127 | 127 | public function getPrefixesPsr4() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L131) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L131) |  |
  | 131 | 131 |  |
  | 132 | 132 | /\*\* |
  | 133 |  | \* @return array[] |
  | 134 |  | \* @psalm-return array<string, string> |
  |  | 133 | \* @return list<string> |
  | 135 | 134 | \*/ |
  | 136 | 135 | public function getFallbackDirs() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L140) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L139) |  |
  | 140 | 139 |  |
  | 141 | 140 | /\*\* |
  | 142 |  | \* @return array[] |
  | 143 |  | \* @psalm-return array<string, string> |
  |  | 141 | \* @return list<string> |
  | 144 | 142 | \*/ |
  | 145 | 143 | public function getFallbackDirsPsr4() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L149) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L147) |  |
  | 149 | 147 |  |
  | 150 | 148 | /\*\* |
  | 151 |  | \* @return string[] Array of classname => path |
  | 152 |  | \* @psalm-return array<string, string> |
  |  | 149 | \* @return array<string, string> Array of classname => path |
  | 153 | 150 | \*/ |
  | 154 | 151 | public function getClassMap() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L158) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L155) |  |
  | 158 | 155 |  |
  | 159 | 156 | /\*\* |
  | 160 |  | \* @param string[] $classMap Class to filename map |
  | 161 |  | \* @psalm-param array<string, string> $classMap |
  |  | 157 | \* @param array<string, string> $classMap Class to filename map |
  | 162 | 158 | \* |
  | 163 | 159 | \* @return void |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L176) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L172) |  |
  | 176 | 172 | \* appending or prepending to the ones previously set for this prefix. |
  | 177 | 173 | \* |
  | 178 |  | \* @param string          $prefix  The prefix |
  | 179 |  | \* @param ~~string[]~~|string $paths   The PSR-0 root directories |
  | 180 |  | \* @param bool            $prepend Whether to prepend the directories |
  |  | 174 | \* @param string              $prefix  The prefix |
  |  | 175 | \* @param list<string>|string $paths   The PSR-0 root directories |
  |  | 176 | \* @param bool                $prepend Whether to prepend the directories |
  | 181 | 177 | \* |
  | 182 | 178 | \* @return void |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L184) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L180) |  |
  | 184 | 180 | public function add($prefix, $paths, $prepend = false) |
  | 185 | 181 | { |
  |  | 182 | $paths = (array) $paths; |
  | 186 | 183 | if (!$prefix) { |
  | 187 | 184 | if ($prepend) { |
  | 188 | 185 | $this->fallbackDirsPsr0 = array\_merge( |
  | 189 |  | ~~(array)~~ $paths, |
  |  | 186 | $paths, |
  | 190 | 187 | $this->fallbackDirsPsr0 |
  | 191 | 188 | ); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L193) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L190) |  |
  | 193 | 190 | $this->fallbackDirsPsr0 = array\_merge( |
  | 194 | 191 | $this->fallbackDirsPsr0, |
  | 195 |  | ~~(array)~~ $paths |
  |  | 192 | $paths |
  | 196 | 193 | ); |
  | 197 | 194 | } |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L202) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L199) |  |
  | 202 | 199 | $first = $prefix[0]; |
  | 203 | 200 | if (!isset($this->prefixesPsr0[$first][$prefix])) { |
  | 204 |  | $this->prefixesPsr0[$first][$prefix] = ~~(array)~~ $paths; |
  |  | 201 | $this->prefixesPsr0[$first][$prefix] = $paths; |
  | 205 | 202 |  |
  | 206 | 203 | return; |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L208) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L205) |  |
  | 208 | 205 | if ($prepend) { |
  | 209 | 206 | $this->prefixesPsr0[$first][$prefix] = array\_merge( |
  | 210 |  | ~~(array)~~ $paths, |
  |  | 207 | $paths, |
  | 211 | 208 | $this->prefixesPsr0[$first][$prefix] |
  | 212 | 209 | ); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L214) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L211) |  |
  | 214 | 211 | $this->prefixesPsr0[$first][$prefix] = array\_merge( |
  | 215 | 212 | $this->prefixesPsr0[$first][$prefix], |
  | 216 |  | ~~(array)~~ $paths |
  |  | 213 | $paths |
  | 217 | 214 | ); |
  | 218 | 215 | } |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L223) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L220) |  |
  | 223 | 220 | \* appending or prepending to the ones previously set for this namespace. |
  | 224 | 221 | \* |
  | 225 |  | \* @param string          $prefix  The prefix/namespace, with trailing '\\' |
  | 226 |  | \* @param ~~string[]~~|string $paths   The PSR-4 base directories |
  | 227 |  | \* @param bool            $prepend Whether to prepend the directories |
  |  | 222 | \* @param string              $prefix  The prefix/namespace, with trailing '\\' |
  |  | 223 | \* @param list<string>|string $paths   The PSR-4 base directories |
  |  | 224 | \* @param bool                $prepend Whether to prepend the directories |
  | 228 | 225 | \* |
  | 229 | 226 | \* @throws \InvalidArgumentException |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L233) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L230) |  |
  | 233 | 230 | public function addPsr4($prefix, $paths, $prepend = false) |
  | 234 | 231 | { |
  |  | 232 | $paths = (array) $paths; |
  | 235 | 233 | if (!$prefix) { |
  | 236 | 234 | // Register directories for the root namespace. |
  | 237 | 235 | if ($prepend) { |
  | 238 | 236 | $this->fallbackDirsPsr4 = array\_merge( |
  | 239 |  | ~~(array)~~ $paths, |
  |  | 237 | $paths, |
  | 240 | 238 | $this->fallbackDirsPsr4 |
  | 241 | 239 | ); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L243) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L241) |  |
  | 243 | 241 | $this->fallbackDirsPsr4 = array\_merge( |
  | 244 | 242 | $this->fallbackDirsPsr4, |
  | 245 |  | ~~(array)~~ $paths |
  |  | 243 | $paths |
  | 246 | 244 | ); |
  | 247 | 245 | } |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L253) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L251) |  |
  | 253 | 251 | } |
  | 254 | 252 | $this->prefixLengthsPsr4[$prefix[0]][$prefix] = $length; |
  | 255 |  | $this->prefixDirsPsr4[$prefix] = ~~(array)~~ $paths; |
  |  | 253 | $this->prefixDirsPsr4[$prefix] = $paths; |
  | 256 | 254 | } elseif ($prepend) { |
  | 257 | 255 | // Prepend directories for an already registered namespace. |
  | 258 | 256 | $this->prefixDirsPsr4[$prefix] = array\_merge( |
  | 259 |  | ~~(array)~~ $paths, |
  |  | 257 | $paths, |
  | 260 | 258 | $this->prefixDirsPsr4[$prefix] |
  | 261 | 259 | ); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L264) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L262) |  |
  | 264 | 262 | $this->prefixDirsPsr4[$prefix] = array\_merge( |
  | 265 | 263 | $this->prefixDirsPsr4[$prefix], |
  | 266 |  | ~~(array)~~ $paths |
  |  | 264 | $paths |
  | 267 | 265 | ); |
  | 268 | 266 | } |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L273) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L271) |  |
  | 273 | 271 | \* replacing any others previously set for this prefix. |
  | 274 | 272 | \* |
  | 275 |  | \* @param string          $prefix The prefix |
  | 276 |  | \* @param ~~string[]~~|string $paths  The PSR-0 base directories |
  |  | 273 | \* @param string              $prefix The prefix |
  |  | 274 | \* @param list<string>|string $paths  The PSR-0 base directories |
  | 277 | 275 | \* |
  | 278 | 276 | \* @return void |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L291) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L289) |  |
  | 291 | 289 | \* replacing any others previously set for this namespace. |
  | 292 | 290 | \* |
  | 293 |  | \* @param string          $prefix The prefix/namespace, with trailing '\\' |
  | 294 |  | \* @param ~~string[]~~|string $paths  The PSR-4 base directories |
  |  | 291 | \* @param string              $prefix The prefix/namespace, with trailing '\\' |
  |  | 292 | \* @param list<string>|string $paths  The PSR-4 base directories |
  | 295 | 293 | \* |
  | 296 | 294 | \* @throws \InvalidArgumentException |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L426) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L424) |  |
  | 426 | 424 | { |
  | 427 | 425 | if ($file = $this->findFile($class)) { |
  | 428 |  | includeFile($file); |
  |  | 426 | $includeFile = self::$includeFile; |
  |  | 427 | $includeFile($file); |
  | 429 | 428 |  |
  | 430 | 429 | return true; |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L477) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L476) |  |
  | 477 | 476 |  |
  | 478 | 477 | /\*\* |
  | 479 |  | \* Returns the currently registered loaders ~~index~~ed by their corresponding vendor directories. |
  | 480 |  | \* |
  | 481 |  | \* @return ~~self[]~~ |
  |  | 478 | \* Returns the currently registered loaders keyed by their corresponding vendor directories. |
  |  | 479 | \* |
  |  | 480 | \* @return array<string, self> |
  | 482 | 481 | \*/ |
  | 483 | 482 | public static function getRegisteredLoaders() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L556) | […](/browser/imageseo/tags/3.1.2/vendor/composer/ClassLoader.php?rev=3122915#L555) |  |
  | 556 | 555 | return false; |
  | 557 | 556 | } |
  |  | 557 |  |
  |  | 558 | /\*\* |
  |  | 559 | \* @return void |
  |  | 560 | \*/ |
  |  | 561 | private static function initializeIncludeClosure() |
  |  | 562 | { |
  |  | 563 | if (self::$includeFile !== null) { |
  |  | 564 | return; |
  |  | 565 | } |
  |  | 566 |  |
  |  | 567 | /\*\* |
  |  | 568 | \* Scope isolated include. |
  |  | 569 | \* |
  |  | 570 | \* Prevents access to $this/self from included files. |
  |  | 571 | \* |
  |  | 572 | \* @param  string $file |
  |  | 573 | \* @return void |
  |  | 574 | \*/ |
  |  | 575 | self::$includeFile = \Closure::bind(static function($file) { |
  |  | 576 | include $file; |
  |  | 577 | }, null, null); |
  |  | 578 | } |
  | 558 | 579 | } |
  | 559 |  |  |
  | 560 |  | ~~/\*\*~~ |
  | 561 |  | ~~\* Scope isolated include.~~ |
  | 562 |  | ~~\*~~ |
  | 563 |  | ~~\* Prevents access to $this/self from included files.~~ |
  | 564 |  | ~~\*~~ |
  | 565 |  | ~~\* @param  string $file~~ |
  | 566 |  | ~~\* @return void~~ |
  | 567 |  | ~~\* @private~~ |
  | 568 |  | ~~\*/~~ |
  | 569 |  | ~~function includeFile($file)~~ |
  | 570 |  | ~~{~~ |
  | 571 |  | ~~include $file;~~ |
  | 572 |  | ~~}~~ |
* ## [imageseo/tags/3.1.2/vendor/composer/InstalledVersions.php](/changeset/3122915/imageseo/tags/3.1.2/vendor/composer/InstalledVersions.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/vendor/composer/InstalledVersions.php")

  | [r2836500](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=2836500#L99 "Show revision 2836500 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/vendor/composer/InstalledVersions.php?rev=3122915#L99 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 99 | 99 | foreach (self::getInstalled() as $installed) { |
  | 100 | 100 | if (isset($installed['versions'][$packageName])) { |
  | 101 |  | return $includeDevRequirements || ~~empty($installed['versions'][$packageName]['dev\_requirement'])~~; |
  |  | 101 | return $includeDevRequirements || !isset($installed['versions'][$packageName]['dev\_requirement']) || $installed['versions'][$packageName]['dev\_requirement'] === false; |
  | 102 | 102 | } |
  | 103 | 103 | } |
  | […](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=2836500#L120) | […](/browser/imageseo/tags/3.1.2/vendor/composer/InstalledVersions.php?rev=3122915#L120) |  |
  | 120 | 120 | public static function satisfies(VersionParser $parser, $packageName, $constraint) |
  | 121 | 121 | { |
  | 122 |  | $constraint = $parser->parseConstraints($constraint); |
  |  | 122 | $constraint = $parser->parseConstraints((string) $constraint); |
  | 123 | 123 | $provided = $parser->parseConstraints(self::getVersionRanges($packageName)); |
  | 124 | 124 |  |
  | […](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=2836500#L329) | […](/browser/imageseo/tags/3.1.2/vendor/composer/InstalledVersions.php?rev=3122915#L329) |  |
  | 329 | 329 | $installed[] = self::$installedByVendor[$vendorDir]; |
  | 330 | 330 | } elseif (is\_file($vendorDir.'/composer/installed.php')) { |
  | 331 |  | $installed[] = self::$installedByVendor[$vendorDir] = require $vendorDir.'/composer/installed.php'; |
  |  | 331 | /\*\* @var array{root: array{name: string, pretty\_version: string, version: string, reference: string|null, type: string, install\_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty\_version?: string, version?: string, reference?: string|null, type?: string, install\_path?: string, aliases?: string[], dev\_requirement: bool, replaced?: string[], provided?: string[]}>} $required \*/ |
  |  | 332 | $required = require $vendorDir.'/composer/installed.php'; |
  |  | 333 | $installed[] = self::$installedByVendor[$vendorDir] = $required; |
  | 332 | 334 | if (null === self::$installed && strtr($vendorDir.'/composer', '\\', '/') === strtr(\_\_DIR\_\_, '\\', '/')) { |
  | 333 | 335 | self::$installed = $installed[count($installed) - 1]; |
  | […](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=2836500#L341) | […](/browser/imageseo/tags/3.1.2/vendor/composer/InstalledVersions.php?rev=3122915#L343) |  |
  | 341 | 343 | // and not from its source location in the composer/composer package, see https://github.com/composer/composer/issues/9937 |
  | 342 | 344 | if (substr(\_\_DIR\_\_, -8, 1) !== 'C') { |
  | 343 |  | self::$installed = require \_\_DIR\_\_ . '/installed.php'; |
  |  | 345 | /\*\* @var array{root: array{name: string, pretty\_version: string, version: string, reference: string|null, type: string, install\_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty\_version?: string, version?: string, reference?: string|null, type?: string, install\_path?: string, aliases?: string[], dev\_requirement: bool, replaced?: string[], provided?: string[]}>} $required \*/ |
  |  | 346 | $required = require \_\_DIR\_\_ . '/installed.php'; |
  |  | 347 | self::$installed = $required; |
  | 344 | 348 | } else { |
  | 345 | 349 | self::$installed = array(); |
  | 346 | 350 | } |
  | 347 | 351 | } |
  | 348 |  | $installed[] = self::$installed; |
  |  | 352 |  |
  |  | 353 | if (self::$installed !== array()) { |
  |  | 354 | $installed[] = self::$installed; |
  |  | 355 | } |
  | 349 | 356 |  |
  | 350 | 357 | return $installed; |
* ## [imageseo/tags/3.1.2/vendor/composer/autoload\_real.php](/changeset/3122915/imageseo/tags/3.1.2/vendor/composer/autoload_real.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/vendor/composer/autoload_real.php")

  | [r3093706](/browser/imageseo/trunk/vendor/composer/autoload_real.php?rev=3093706#L3 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/vendor/composer/autoload_real.php?rev=3122915#L3 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload\_real.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | class ComposerAutoloaderInit~~8aee80435795f097aba54ac01df0b70f~~ |
  |  | 5 | class ComposerAutoloaderInite97648f350088b8744107ebf06d18a01 |
  | 6 | 6 | { |
  | 7 | 7 | private static $loader; |
  | […](/browser/imageseo/trunk/vendor/composer/autoload_real.php?rev=3093706#L25) | […](/browser/imageseo/tags/3.1.2/vendor/composer/autoload_real.php?rev=3122915#L25) |  |
  | 25 | 25 | require \_\_DIR\_\_ . '/platform\_check.php'; |
  | 26 | 26 |  |
  | 27 |  | spl\_autoload\_register(array('ComposerAutoloaderInit~~8aee80435795f097aba54ac01df0b70f~~', 'loadClassLoader'), true, true); |
  |  | 27 | spl\_autoload\_register(array('ComposerAutoloaderInite97648f350088b8744107ebf06d18a01', 'loadClassLoader'), true, true); |
  | 28 | 28 | self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(\_\_DIR\_\_)); |
  | 29 |  | spl\_autoload\_unregister(array('ComposerAutoloaderInit~~8aee80435795f097aba54ac01df0b70f~~', 'loadClassLoader')); |
  |  | 29 | spl\_autoload\_unregister(array('ComposerAutoloaderInite97648f350088b8744107ebf06d18a01', 'loadClassLoader')); |
  | 30 | 30 |  |
  | 31 | 31 | require \_\_DIR\_\_ . '/autoload\_static.php'; |
  | 32 |  | call\_user\_func(\Composer\Autoload\ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~::getInitializer($loader)); |
  |  | 32 | call\_user\_func(\Composer\Autoload\ComposerStaticInite97648f350088b8744107ebf06d18a01::getInitializer($loader)); |
  | 33 | 33 |  |
  | 34 | 34 | $loader->register(true); |
* ## [imageseo/tags/3.1.2/vendor/composer/autoload\_static.php](/changeset/3122915/imageseo/tags/3.1.2/vendor/composer/autoload_static.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/vendor/composer/autoload_static.php")

  | [r3093706](/browser/imageseo/trunk/vendor/composer/autoload_static.php?rev=3093706#L5 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/vendor/composer/autoload_static.php?rev=3122915#L5 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | namespace Composer\Autoload; |
  | 6 | 6 |  |
  | 7 |  | class ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~ |
  |  | 7 | class ComposerStaticInite97648f350088b8744107ebf06d18a01 |
  | 8 | 8 | { |
  | 9 | 9 | public static $prefixLengthsPsr4 = array ( |
  | […](/browser/imageseo/trunk/vendor/composer/autoload_static.php?rev=3093706#L41) | […](/browser/imageseo/tags/3.1.2/vendor/composer/autoload_static.php?rev=3122915#L41) |  |
  | 41 | 41 | { |
  | 42 | 42 | return \Closure::bind(function () use ($loader) { |
  | 43 |  | $loader->prefixLengthsPsr4 = ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~::$prefixLengthsPsr4; |
  | 44 |  | $loader->prefixDirsPsr4 = ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~::$prefixDirsPsr4; |
  | 45 |  | $loader->classMap = ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~::$classMap; |
  |  | 43 | $loader->prefixLengthsPsr4 = ComposerStaticInite97648f350088b8744107ebf06d18a01::$prefixLengthsPsr4; |
  |  | 44 | $loader->prefixDirsPsr4 = ComposerStaticInite97648f350088b8744107ebf06d18a01::$prefixDirsPsr4; |
  |  | 45 | $loader->classMap = ComposerStaticInite97648f350088b8744107ebf06d18a01::$classMap; |
  | 46 | 46 |  |
  | 47 | 47 | }, null, ClassLoader::class); |
* ## [imageseo/tags/3.1.2/vendor/composer/installed.php](/changeset/3122915/imageseo/tags/3.1.2/vendor/composer/installed.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/vendor/composer/installed.php")

  | [r3093706](/browser/imageseo/trunk/vendor/composer/installed.php?rev=3093706#L2 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/vendor/composer/installed.php?rev=3122915#L2 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | 'root' => array( |
  | 3 | 3 | 'name' => 'imageseo/imageseo-wordpress', |
  | 4 |  | 'pretty\_version' => '~~dev-master~~', |
  | 5 |  | 'version' => '~~dev-master~~', |
  | 6 |  | 'reference' => '~~8da9a48b3edece64c45d1a166359c75831a07d6b~~', |
  |  | 4 | 'pretty\_version' => '3.1.2', |
  |  | 5 | 'version' => '3.1.2.0', |
  |  | 6 | 'reference' => '37959f46c31b6d83226ee1ff796b9ff6facf6296', |
  | 7 | 7 | 'type' => 'project', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/imageseo/trunk/vendor/composer/installed.php?rev=3093706#L32) | […](/browser/imageseo/tags/3.1.2/vendor/composer/installed.php?rev=3122915#L32) |  |
  | 32 | 32 | ), |
  | 33 | 33 | 'imageseo/imageseo-wordpress' => array( |
  | 34 |  | 'pretty\_version' => '~~dev-master~~', |
  | 35 |  | 'version' => '~~dev-master~~', |
  | 36 |  | 'reference' => '~~8da9a48b3edece64c45d1a166359c75831a07d6b~~', |
  |  | 34 | 'pretty\_version' => '3.1.2', |
  |  | 35 | 'version' => '3.1.2.0', |
  |  | 36 | 'reference' => '37959f46c31b6d83226ee1ff796b9ff6facf6296', |
  | 37 | 37 | 'type' => 'project', |
  | 38 | 38 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
* ## [imageseo/tags/3.1.2/vendor/imageseo/imageseo-php/src/Client/Resources.php](/changeset/3122915/imageseo/tags/3.1.2/vendor/imageseo/imageseo-php/src/Client/Resources.php "Show the changeset 3122915 restricted to imageseo/tags/3.1.2/vendor/imageseo/imageseo-php/src/Client/Resources.php")

  | [r3011770](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3011770#L11 "Show revision 3011770 of this file in browser") | [r3122915](/browser/imageseo/tags/3.1.2/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3122915#L11 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | \*/ |
  | 12 | 12 | protected $resources = []; |
  | 13 |  |  |
  |  | 13 |  |
  | 14 | 14 | /\*\* |
  | 15 | 15 | \* @param string $path |
  | […](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3011770#L28) | […](/browser/imageseo/tags/3.1.2/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3122915#L28) |  |
  | 28 | 28 | continue; |
  | 29 | 29 | } |
  | 30 |  |  |
  |  | 30 |  |
  | 31 | 31 | $key = $class::RESOURCE\_NAME; |
  | 32 | 32 |  |
* ## [imageseo/trunk/dist/adminv2/index.asset.php](/changeset/3122915/imageseo/trunk/dist/adminv2/index.asset.php "Show the changeset 3122915 restricted to imageseo/trunk/dist/adminv2/index.asset.php")

  | [r3093706](/browser/imageseo/trunk/dist/adminv2/index.asset.php?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/dist/adminv2/index.asset.php?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('react', 'wp-api-fetch', 'wp-components', 'wp-element', 'wp-i18n'), 'version' => '~~9770ee0bcdd9f55be14e~~'); |
  |  | 1 | <?php return array('dependencies' => array('react', 'wp-api-fetch', 'wp-components', 'wp-element', 'wp-i18n'), 'version' => '2eed19bf6cfb92ed1b2b'); |
* ## [imageseo/trunk/dist/adminv2/index.js](/changeset/3122915/imageseo/trunk/dist/adminv2/index.js "Show the changeset 3122915 restricted to imageseo/trunk/dist/adminv2/index.js")

  | [r3093706](/browser/imageseo/trunk/dist/adminv2/index.js?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/dist/adminv2/index.js?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | (()=>{"use strict";var e={n:t=>{var a=t&&t.\_\_esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};window.React;const t=window.wp.components,a=window.wp.element,n=window.wp.i18n,i=window.wp.apiFetch;var s=e.n(i);const o=async e=>{try{return await s()({path:"imageseo/v1/optimize-image/",method:"POST",data:e})}catch(e){console.error("Error calling the api:",e)}},r=async e=>{try{return await s()({path:"imageseo/v1/save-property/",method:"POST",data:e})}catch(e){console.error("Error calling the api:",e)}},c=new class{constructor(){this.listeners={}}subscribe(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}publish(e,t){this.listeners[e]&&this.listeners[e].forEach((e=>e(t)))}unsubscribe(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((e=>e!==t)))}};function l({attachmentId:e,alt:i}){const[s,l]=(0,a.useState)(i),[m,u]=(0,a.useState)(!1),[d,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,\_]=(0,a.useState)("");return React.createElement(t.Flex,{direction:"column"},React.createElement(t.FlexItem,null,React.createElement(t.TextControl,{label:(0,n.\_\_)("Alt","imageseo"),value:s||"",onChange:l})),React.createElement(t.FlexItem,null,React.createElement(t.ButtonGroup,null,React.createElement(t.Button,{style:{margin:"0 6px"},onClick:async()=>{m||(u(!0),g(!1),\_("save"),r({id:e,action:"saveAlt",value:s}).then((e=>{u(!1),e?.error||(l(e.altText||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Alt saved","imageseo"),status:"info"}))})).catch((e=>{console.error(e),u(!1),p(!0),g(!1),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},~~isPrimary:!0,isBusy:m},"save"===b&&d&&h?(0,n.\_\_)("Saved","imageseo"):(0,n.\_\_)("Save","imageseo")),React.createElement(t.Button,{variant:"tertiary",onClick:async()=>{m||(u(!0),g(!1),\_("optimize"),o({id:e,action:"optimizeAlt"}).then((e=>{u(!1),e?.error||(l(e.altText||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Alt optimized","imageseo"),status:"info"}))})).catch((e=>{c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"}),console.error(e),u(!1),p(!0),g(!1)})))},isBusy:m},"optimize"===b&&d&&h?(0,n.\_\_)("Optimized","imageseo"):(0,n.\_\_)("Optimize","imageseo")))))}function m({attachmentId:e,filename:i}){const[s,l]=(0,a.useState)(i),[m,u]=(0,a.useState)(!1),[d,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,\_]=(0,a.useState)("");return React.createElement(React.Fragment,null,React.createElement(t.Flex,{direction:"column"},React.createElement(t.FlexItem,null,React.createElement(t.TextControl,{label:(0,n.\_\_)("Filename","imageseo"),value:s||"",onChange:l})),React.createElement(t.FlexItem,null,React.createElement(t.ButtonGroup,null,React.createElement(t.Button,{style:{margin:"0 6px"},onClick:async()=>{m||(u(!0),g(!1),\_("save"),r({id:e,action:"saveFilename",value:s}).then((e=>{u(!1),e?.error||(p(!0),g(!0),l(e.filename||""),c.publish("snackbar",{content:(0,n.\_\_)("Filename saved","imageseo"),status:"info"}))})).catch((e=>{console.error(e),p(!0),g(!1),u(!1),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},isPrimary:!0~~,isBusy:m},"save"===b&&d&&h?(0,n.\_\_)("Saved","imageseo"):(0,n.\_\_)("Save","imageseo")),React.createElement(t.Button,{variant:"tertiary",onClick:async()=>{m||(\_("optimize"),u(!0),g(!1),o({id:e,action:"optimizeFilename"}).then((e=>{u(!1),e?.error||(l(e.filename||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Filename optimized","imageseo"),status:"info"}))})).catch((e=>{console.error(e),u(!1),g(!1),p(!0),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},isBusy:m},"optimize"===b&&d&&h?(0,n.\_\_)("Optimized","imageseo"):(0,n.\_\_)("Optimize","imageseo"))))))}function u(){const[e,n]=(0,a.useState)([]),i=(0,a.useCallback)((e=>{const t={id:(new Date).getTime(),...e,content:e?.content||"",politeness:e?.politeness||"polite",actions:e?.actions||[],explicitDismiss:e?.explicitDismiss||!1};n((e=>[...e,t]))}),[]),s=(0,a.useCallback)((e=>{n((t=>t.filter((t=>t.id!==e))))}),[]);return(0,a.useEffect)((()=>(console.log("Snackbar mounted"),c.subscribe("snackbar",i),()=>{c.unsubscribe("snackbar",i)})),[i]),React.createElement(t.SnackbarList,{notices:e,onRemove:s})}document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".media-column-imageseo-alt"),t=document.querySelectorAll(".media-column-imageseo-filename");e.forEach((e=>{const t=(0,a.createRoot)(e),n=e.getAttribute("data-id"),i=e.getAttribute("data-alt");t.render(React.createElement(l,{attachmentId:n,alt:i}))})),t.forEach((e=>{const t=(0,a.createRoot)(e),n=e.getAttribute("data-id"),i=e.getAttribute("data-filename");t.render(React.createElement(m,{attachmentId:n,filename:i}))}));const n=document.getElementById("wpbody-content"),i=document.createElement("div"),s=document.createElement("div");s.setAttribute("id","imageseo-snackbar-wrapper"),i.setAttribute("id","imageseo-snackbar-root"),s.style.position="fixed",s.style.left="10px",s.style.right="10px",s.style.bottom="10px",s.style.zIndex="1000",s.style.textAlign="center",s.style.width="100%",s.style.height="50px",s.style.pointerEvents="none",n.prepend(s),s.appendChild(i),(0,a.createRoot)(document.getElementById("imageseo-snackbar-root")).render(React.createElement(u,null))}))})(); |
  |  | 1 | (()=>{"use strict";var e={n:t=>{var a=t&&t.\_\_esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};window.React;const t=window.wp.components,a=window.wp.element,n=window.wp.i18n,i=window.wp.apiFetch;var s=e.n(i);const o=async e=>{try{return await s()({path:"imageseo/v1/optimize-image/",method:"POST",data:e})}catch(e){console.error("Error calling the api:",e)}},r=async e=>{try{return await s()({path:"imageseo/v1/save-property/",method:"POST",data:e})}catch(e){console.error("Error calling the api:",e)}},c=new class{constructor(){this.listeners={}}subscribe(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}publish(e,t){this.listeners[e]&&this.listeners[e].forEach((e=>e(t)))}unsubscribe(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((e=>e!==t)))}};function l({attachmentId:e,alt:i}){const[s,l]=(0,a.useState)(i),[m,u]=(0,a.useState)(!1),[d,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,\_]=(0,a.useState)("");return React.createElement(t.Flex,{direction:"column"},React.createElement(t.FlexItem,null,React.createElement(t.TextControl,{label:(0,n.\_\_)("Alt","imageseo"),value:s||"",onChange:l})),React.createElement(t.FlexItem,null,React.createElement(t.ButtonGroup,null,React.createElement(t.Button,{style:{margin:"0 6px"},onClick:async()=>{m||(u(!0),g(!1),\_("save"),r({id:e,action:"saveAlt",value:s}).then((e=>{u(!1),e?.error||(l(e.altText||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Alt saved","imageseo"),status:"info"}))})).catch((e=>{console.error(e),u(!1),p(!0),g(!1),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},variant:"primary",isBusy:m},"save"===b&&d&&h?(0,n.\_\_)("Saved","imageseo"):(0,n.\_\_)("Save","imageseo")),React.createElement(t.Button,{variant:"tertiary",onClick:async()=>{m||(u(!0),g(!1),\_("optimize"),o({id:e,action:"optimizeAlt"}).then((e=>{u(!1),e?.error||(l(e.altText||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Alt optimized","imageseo"),status:"info"}))})).catch((e=>{c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"}),console.error(e),u(!1),p(!0),g(!1)})))},isBusy:m},"optimize"===b&&d&&h?(0,n.\_\_)("Optimized","imageseo"):(0,n.\_\_)("Optimize","imageseo")))))}function m({attachmentId:e,filename:i}){const[s,l]=(0,a.useState)(i),[m,u]=(0,a.useState)(!1),[d,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,\_]=(0,a.useState)("");return React.createElement(React.Fragment,null,React.createElement(t.Flex,{direction:"column"},React.createElement(t.FlexItem,null,React.createElement(t.TextControl,{label:(0,n.\_\_)("Filename","imageseo"),value:s||"",onChange:l})),React.createElement(t.FlexItem,null,React.createElement(t.ButtonGroup,null,React.createElement(t.Button,{style:{margin:"0 6px"},onClick:async()=>{m||(u(!0),g(!1),\_("save"),r({id:e,action:"saveFilename",value:s}).then((e=>{u(!1),e?.error||(p(!0),g(!0),l(e.filename||""),c.publish("snackbar",{content:(0,n.\_\_)("Filename saved","imageseo"),status:"info"}))})).catch((e=>{console.error(e),p(!0),g(!1),u(!1),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},variant:"primary",isBusy:m},"save"===b&&d&&h?(0,n.\_\_)("Saved","imageseo"):(0,n.\_\_)("Save","imageseo")),React.createElement(t.Button,{variant:"tertiary",onClick:async()=>{m||(\_("optimize"),u(!0),g(!1),o({id:e,action:"optimizeFilename"}).then((e=>{u(!1),e?.error||(l(e.filename||""),p(!0),g(!0),c.publish("snackbar",{content:(0,n.\_\_)("Filename optimized","imageseo"),status:"info"}))})).catch((e=>{console.error(e),u(!1),g(!1),p(!0),c.publish("snackbar",{content:(0,n.\_\_)("Something went wrong!","imageseo"),status:"error"})})))},isBusy:m},"optimize"===b&&d&&h?(0,n.\_\_)("Optimized","imageseo"):(0,n.\_\_)("Optimize","imageseo"))))))}function u(){const[e,n]=(0,a.useState)([]),i=(0,a.useCallback)((e=>{const t={id:(new Date).getTime(),...e,content:e?.content||"",politeness:e?.politeness||"polite",actions:e?.actions||[],explicitDismiss:e?.explicitDismiss||!1};n((e=>[...e,t]))}),[]),s=(0,a.useCallback)((e=>{n((t=>t.filter((t=>t.id!==e))))}),[]);return(0,a.useEffect)((()=>(console.log("Snackbar mounted"),c.subscribe("snackbar",i),()=>{c.unsubscribe("snackbar",i)})),[i]),React.createElement(t.SnackbarList,{notices:e,onRemove:s})}document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".media-column-imageseo-alt"),t=document.querySelectorAll(".media-column-imageseo-filename");e.forEach((e=>{const t=(0,a.createRoot)(e),n=e.getAttribute("data-id"),i=e.getAttribute("data-alt");t.render(React.createElement(l,{attachmentId:n,alt:i}))})),t.forEach((e=>{const t=(0,a.createRoot)(e),n=e.getAttribute("data-id"),i=e.getAttribute("data-filename");t.render(React.createElement(m,{attachmentId:n,filename:i}))}));const n=document.getElementById("wpbody-content"),i=document.createElement("div"),s=document.createElement("div");s.setAttribute("id","imageseo-snackbar-wrapper"),i.setAttribute("id","imageseo-snackbar-root"),s.style.position="fixed",s.style.left="10px",s.style.right="10px",s.style.bottom="10px",s.style.zIndex="1000",s.style.textAlign="center",s.style.width="100%",s.style.height="50px",s.style.pointerEvents="none",n.prepend(s),s.appendChild(i),(0,a.createRoot)(document.getElementById("imageseo-snackbar-root")).render(React.createElement(u,null))}))})(); |
* ## [imageseo/trunk/dist/settingsv2/index.asset.php](/changeset/3122915/imageseo/trunk/dist/settingsv2/index.asset.php "Show the changeset 3122915 restricted to imageseo/trunk/dist/settingsv2/index.asset.php")

  | [r3093706](/browser/imageseo/trunk/dist/settingsv2/index.asset.php?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/dist/settingsv2/index.asset.php?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('react', 'wp-api-fetch', 'wp-components', 'wp-element', 'wp-i18n'), 'version' => '~~c15c473d467a705c9f0a~~'); |
  |  | 1 | <?php return array('dependencies' => array('react', 'wp-api-fetch', 'wp-components', 'wp-element', 'wp-i18n'), 'version' => '4a37b100f7190a817199'); |
* ## [imageseo/trunk/dist/settingsv2/index.css](/changeset/3122915/imageseo/trunk/dist/settingsv2/index.css "Show the changeset 3122915 restricted to imageseo/trunk/dist/settingsv2/index.css")

  | [r3093706](/browser/imageseo/trunk/dist/settingsv2/index.css?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/dist/settingsv2/index.css?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | #imageseo-settings-v2{margin~~-right:20px;margin-top:20px;.media-uploader-container{cursor:pointer}.media-uploader{width:330px;.components-base-control\_\_field{align-items:center;display:flex;justify-content:space-between;img{max-width:150px}}}.header-container{align-items:center;display:flex;justify-content:space-between;width:100%}.header{align-items:center;display:flex;justify-content:center;.logo{margin-right:10px;width:35px}.visit-website{margin-left:10px}~~}.cta{align-items:center;justify-content:center}.cta,.welcome-screen{display:flex;flex-direction:column}.welcome-screen{margin:30px auto 0;width:700px}.form-container{margin-top:30px;.components-base-control{margin-bottom:15px}}.social-card-screen{align-items:center;-moz-column-gap:30px;column-gap:30px;display:flex;justify-content:space-between;margin-top:30px;.components-base-control{margin-bottom:15px}.previewer{align-items:center;border:1px solid #949494;border-radius:5px;display:flex;height:340px;justify-content:space-between;width:700px;.bg-image{background-position:50%;background-repeat:no-repeat;background-size:cover}.bg-image,.content{flex-grow:1;height:100%;width:50%}.content{align-items:center;display:flex;flex-direction:column;justify-content:center}.padded{padding:20px}.logo{max-width:100px}}}.bulk-optimizer-screen{-moz-column-gap:30px;column-gap:30px;display:flex;flex-direction:row;margin-top:30px;.form{flex-grow:1}.components-base-control{margin-bottom:15px}.optimizer{align-items:center;border:1px solid #949494;border-radius:5px;display:flex;flex-direction:column;justify-content:center;padding:20px;width:45%;.progress{align-items:center;display:flex;flex-direction:column;justify-content:center;progress{margin-top:15px}}}}.settings-screen{margin-top:30px;.components-base-control{margin-bottom:15px}}} |
  |  | 1 | #imageseo-settings-v2{margin:20px auto;max-width:960px;.media-uploader-container{cursor:pointer}.media-uploader{width:330px;.components-base-control\_\_field{align-items:center;display:flex;justify-content:space-between;img{max-width:150px}}}.header-container{align-items:center;display:flex;justify-content:space-between;width:100%}.header{align-items:center;display:flex;justify-content:center;.logo{margin-right:10px;width:35px}.visit-website{margin-left:10px}}.remaining-credits-info{background-color:#ffd958;font-weight:700;padding:9px 12px}.cta{align-items:center;justify-content:center}.cta,.welcome-screen{display:flex;flex-direction:column}.welcome-screen{margin:30px auto 0;width:700px}.form-container{margin-top:30px;.components-base-control{margin-bottom:15px}}.social-card-screen{align-items:center;-moz-column-gap:30px;column-gap:30px;display:flex;justify-content:space-between;margin-top:30px;.components-base-control{margin-bottom:15px}.previewer{align-items:center;border:1px solid #949494;border-radius:5px;display:flex;height:340px;justify-content:space-between;width:700px;.bg-image{background-position:50%;background-repeat:no-repeat;background-size:cover}.bg-image,.content{flex-grow:1;height:100%;width:50%}.content{align-items:center;display:flex;flex-direction:column;justify-content:center}.padded{padding:20px}.logo{max-width:100px}}}.bulk-optimizer-screen{-moz-column-gap:30px;column-gap:30px;display:flex;flex-direction:row;margin-top:30px;.form{flex-grow:1}.components-base-control{margin-bottom:15px}.optimizer{align-items:center;border:1px solid #949494;border-radius:5px;display:flex;flex-direction:column;justify-content:center;padding:20px;width:45%;.progress{align-items:center;display:flex;flex-direction:column;justify-content:center;progress{margin-top:15px}}}}.settings-screen{margin-top:30px;.components-base-control{margin-bottom:15px}}} |
* ## [imageseo/trunk/dist/settingsv2/index.js](/changeset/3122915/imageseo/trunk/dist/settingsv2/index.js "Show the changeset 3122915 restricted to imageseo/trunk/dist/settingsv2/index.js")

  | [r3093706](/browser/imageseo/trunk/dist/settingsv2/index.js?rev=3093706#L1 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/dist/settingsv2/index.js?rev=3122915#L1 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | (()=>{"use strict";var e={~~63:(e,t,a)=>{var n=a(609),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=n.useState,i=n.useEffect,l=n.useLayoutEffect,s=n.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!o(e,a)}catch(e){return!0}}var m="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),n=r({inst:{value:a,getSnapshot:t}}),o=n[0].inst,m=n[1];return l((function(){o.value=a,o.getSnapshot=t,c(o)&&m({inst:o})}),[e,a,t]),i((function(){return c(o)&&m({inst:o}),e((function(){c(o)&&m({inst:o})}))}),[e]),s(a),a};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:m},888:(e,t,a)=>{e.exports=a(63)},609:e=>{e.exports=window.React}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.\_\_esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.\*$/,"").replace(/\?.\*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e=a(609);const t=window.wp.components,n=window.wp.element,o=a.p+"images/default\_logo.a24dbeff.png",r=window.wp.i18n,i=window.wp.apiFetch;var l=a.n(i);const s=async e=>await l()({path:e,method:"GET"}),c=async([e,t])=>(await l()({path:e,method:"POST",data:t})).data;var m=a(888);const u=()=>{},d=u(),g=Object,p=e=>e===d,\_=e=>"function"==typeof e,f=(e,t)=>({...e,...t}),E=new WeakMap;let h=0;const R=e=>{const t=typeof e,a=e&&e.constructor,n=a==Date;let o,r;if(g(e)!==e||n||a==RegExp)o=n?e.toJSON():"symbol"==t?e.toString():"string"==t?JSON.stringify(e):""+e;else{if(o=E.get(e),o)return o;if(o=++h+"~",E.set(e,o),a==Array){for(o="@",r=0;r<e.length;r++)o+=R(e[r])+",";E.set(e,o)}if(a==g){o="#";const t=g.keys(e).sort();for(;!p(r=t.pop());)p(e[r])||(o+=r+":"+R(e[r])+",");E.set(e,o)}}return o},v=new WeakMap,y={},b={},w="undefined",S=typeof window!=w,C=typeof document!=w,T=(e,t)=>{const a=v.get(e);return[()=>!p(t)&&e.get(t)||y,n=>{if(!p(t)){const o=e.get(t);t in b||(b[t]=o),a[5](t,f(o,n),o||y)}},a[6],()=>!p(t)&&t in b?b[t]:!p(t)&&e.get(t)||y]};let x=!0;const[k,O]=S&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[u,u],L={isOnline:()=>x,isVisible:()=>{const e=C&&document.visibilityState;return p(e)||"hidden"!==e}},N={initFocus:e=>(C&&document.addEventListener("visibilitychange",e),k("focus",e),()=>{C&&document.removeEventListener("visibilitychange",e),O("focus",e)}),initReconnect:e=>{const t=()=>{x=!0,e()},a=()=>{x=!1};return k("online",t),k("offline",a),()=>{O("online",t),O("offline",a)}}},M=!e.useId,I=!S||"Deno"in window,P=I?e.useEffect:e.useLayoutEffect,A="undefined"!=typeof navigator&&navigator.connection,F=!I&&A&&(["slow-2g","2g"].includes(A.effectiveType)||A.saveData),B=e=>{if(\_(e))try{e=e()}catch(t){e=""}const t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?R(e):"",t]};let z=0;const D=()=>++z;async function V(...e){const[t,a,n,o]=e,r=f({populateCache:!0,throwOnError:!0},"boolean"==typeof o?{revalidate:o}:o||{});let i=r.populateCache;const l=r.rollbackOnError;let s=r.optimisticData;const c=r.throwOnError;if(\_(a)){const e=a,n=[],o=t.keys();for(const a of o)!/^\$(inf|sub)\$/.test(a)&&e(t.get(a).\_k)&&n.push(a);return Promise.all(n.map(m))}return m(a);async function m(a){const[o]=B(a);if(!o)return;const[m,u]=T(t,o),[g,f,E,h]=v.get(t),R=()=>{const e=g[o];return(\_(r.revalidate)?r.revalidate(m().data,a):!1!==r.revalidate)&&(delete E[o],delete h[o],e&&e[0])?e[0](2).then((()=>m().data)):m().data};if(e.length<3)return R();let y,b=n;const w=D();f[o]=[w,0];const S=!p(s),C=m(),x=C.data,k=C.\_c,O=p(k)?x:k;if(S&&(s=\_(s)?s(O,x):s,u({data:s,\_c:O})),\_(b))try{b=b(O)}catch(e){y=e}if(b&&\_(b.then)){if(b=await b.catch((e=>{y=e})),w!==f[o][0]){if(y)throw y;return b}y&&S&&(e=>"function"==typeof l?l(e):!1!==l)(y)&&(i=!0,u({data:O,\_c:d}))}if(i&&!y)if(\_(i)){const e=i(b,O);u({data:e,error:d,\_c:d})}else u({data:b,error:d,\_c:d});if(f[o][1]=D(),Promise.resolve(R()).then((()=>{u({\_c:d})})),!y)return b;if(c)throw y}}const G=(e,t)=>{for(const a in e)e[a][0]&&e[a][0](t)},$=(e,t)=>{if(!v.has(e)){const a=f(N,t),n={},o=V.bind(d,e);let r=u;const i={},l=(e,t)=>{const a=i[e]||[];return i[e]=a,a.push(t),()=>a.splice(a.indexOf(t),1)},s=(t,a,n)=>{e.set(t,a);const o=i[t];if(o)for(const e of o)e(a,n)},c=()=>{if(!v.has(e)&&(v.set(e,[n,{},{},{},o,s,l]),!I)){const t=a.initFocus(setTimeout.bind(d,G.bind(d,n,0))),o=a.initReconnect(setTimeout.bind(d,G.bind(d,n,1)));r=()=>{t&&t(),o&&o(),v.delete(e)}}};return c(),[e,o,c,r]}return[e,v.get(e)[4]]},[W,H]=$(new Map),j=f({onLoadingSlow:u,onSuccess:u,onError:u,onErrorRetry:(e,\_\_,t,a,n)=>{const o=t.errorRetryCount,r=n.retryCount,i=~~((Math.random()+.5)\*(1<<(r<8?r:8)))\*t.errorRetryInterval;!p(o)&&r>o||setTimeout(a,i,n)},onDiscarded:u,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:F?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:F?5e3:3e3,compare:(e,t)=>R(e)==R(t),isPaused:()=>!1,cache:W,mutate:H,fallback:{}},L),U=(e,t)=>{const a=f(e,t);if(t){const{use:n,fallback:o}=e,{use:r,fallback:i}=t;n&&r&&(a.use=n.concat(r)),o&&i&&(a.fallback=f(o,i))}return a},K=(0,e.createContext)({}),Y=S&&window.\_\_SWR\_DEVTOOLS\_USE\_\_,q=Y?window.\_\_SWR\_DEVTOOLS\_USE\_\_:[],J=q.concat((e=>(t,a,n)=>e(t,a&&((...e)=>{const[n]=B(t),[,,,o]=v.get(W);if(n.startsWith("$inf$"))return a(...e);const r=o[n];return p(r)?a(...e):(delete o[n],r)}),n)));Y&&(window.\_\_SWR\_DEVTOOLS\_REACT\_\_=e);const X=e.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(e.status="pending",e.then((t=>{e.status="fulfilled",e.value=t}),(t=>{e.status="rejected",e.reason=t})),e)}),Q={dedupe:!0},Z=(g.defineProperty((t=>{const{value:a}=t,n=(0,e.useContext)(K),o=\_(a),r=(0,e.useMemo)((()=>o?a(n):a),[o,n,a]),i=(0,e.useMemo)((()=>o?r:U(n,r)),[o,n,r]),l=r&&r.provider,s=(0,e.useRef)(d);l&&!s.current&&(s.current=$(l(i.cache||W),r));const c=s.current;return c&&(i.cache=c[0],i.mutate=c[1]),P((()=>{if(c)return c[2]&&c[2](),c[3]}),[]),(0,e.createElement)(K.Provider,f(t,{value:i}))}),"defaultValue",{value:j}),ee=(t,a,n)=>{const{cache:o,compare:r,suspense:i,fallbackData:l,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:u,refreshWhenHidden:g,refreshWhenOffline:E,keepPreviousData:h}=n,[R,y,b,C]=v.get(o),[x,k]=B(t),O=(0,e.useRef)(!1),L=(0,e.useRef)(!1),N=(0,e.useRef)(x),A=(0,e.useRef)(a),F=(0,e.useRef)(n),z=()=>F.current,G=()=>z().isVisible()&&z().isOnline(),[$,W,H,j]=T(o,x),U=(0,e.useRef)({}).current,K=p(l)?n.fallback[x]:l,Y=(e,t)=>{for(const a in U){const n=a;if("data"===n){if(!r(e[n],t[n])){if(!p(e[n]))return!1;if(!r(re,t[n]))return!1}}else if(t[n]!==e[n])return!1}return!0},q=(0,e.useMemo)((()=>{const e=!!x&&!!a&&(p(s)?!z().isPaused()&&!i&&(!!p(c)||c):s),t=t=>{const a=f(t);return delete a.\_k,e?{isValidating:!0,isLoading:!0,...a}:a},n=$(),o=j(),r=t(n),l=n===o?r:t(o);let m=r;return[()=>{const e=t($());return Y(e,m)?(m.data=e.data,m.isLoading=e.isLoading,m.isValidating=e.isValidating,m.error=e.error,m):(m=e,e)},()=>l]}),[o,x]),J=(0,m.useSyncExternalStore)((0,e.useCallback)((e=>H(x,((t,a)=>{Y(a,t)||e()}))),[o,x]),q[0],q[1]),Z=!O.current,ee=R[x]&&R[x].length>0,te=J.data,ae=p(te)?K:te,ne=J.error,oe=(0,e.useRef)(ae),re=h?p(te)?oe.current:te:ae,ie=!(ee&&!p(ne))&&(Z&&!p(s)?s:!z().isPaused()&&(i?!p(ae)&&c:p(ae)||c)),le=!!(x&&a&&Z&&ie),se=p(J.isValidating)?le:J.isValidating,ce=p(J.isLoading)?le:J.isLoading,me=(0,e.useCallback)((async e=>{const t=A.current;if(!x||!t||L.current||z().isPaused())return!1;let a,o,i=!0;const l=e||{},s=!b[x]||!l.dedupe,c=()=>M?!L.current&&x===N.current&&O.current:x===N.current,m={isValidating:!1,isLoading:!1},u=()=>{W(m)},g=()=>{const e=b[x];e&&e[1]===o&&delete b[x]},f={isValidating:!0};p($().data)&&(f.isLoading=!0);try{if(s&&(W(f),n.loadingTimeout&&p($().data)&&setTimeout((()=>{i&&c()&&z().onLoadingSlow(x,n)}),n.loadingTimeout),b[x]=[t(k),D()]),[a,o]=b[x],a=await a,s&&setTimeout(g,n.dedupingInterval),!b[x]||b[x][1]!==o)return s&&c()&&z().onDiscarded(x),!1;m.error=d;const e=y[x];if(!p(e)&&(o<=e[0]||o<=e[1]||0===e[1]))return u(),s&&c()&&z().onDiscarded(x),!1;const l=$().data;m.data=r(l,a)?l:a,s&&c()&&z().onSuccess(a,x,n)}catch(e){g();const t=z(),{shouldRetryOnError:a}=t;t.isPaused()||(m.error=e,s&&c()&&(t.onError(e,x,t),(!0===a||\_(a)&&a(e))&&(z().revalidateOnFocus&&z().revalidateOnReconnect&&!G()||t.onErrorRetry(e,x,t,(e=>{const t=R[x];t&&t[0]&&t[0](3,e)}),{retryCount:(l.retryCount||0)+1,dedupe:!0}))))}return i=!1,u(),!0}),[x,o]),ue=(0,e.useCallback)(((...e)=>V(o,N.current,...e)),[]);if(P((()=>{A.current=a,F.current=n,p(te)||(oe.current=te)})),P((()=>{if(!x)return;const e=me.bind(d,Q);let t=0;const a=((e,t,a)=>{const n=t[e]||(t[e]=[]);return n.push(a),()=>{const e=n.indexOf(a);e>=0&&(n[e]=n[n.length-1],n.pop())}})(x,R,((a,n={})=>{if(0==a){const a=Date.now();z().revalidateOnFocus&&a>t&&G()&&(t=a+z().focusThrottleInterval,e())}else if(1==a)z().revalidateOnReconnect&&G()&&e();else{if(2==a)return me();if(3==a)return me(n)}}));return L.current=!1,N.current=x,O.current=!0,W({\_k:k}),ie&&(p(ae)||I?e():(n=e,S&&typeof window.requestAnimationFrame!=w?window.requestAnimationFrame(n):setTimeout(n,1))),()=>{L.current=!0,a()};var n}),[x]),P((()=>{let e;function t(){const t=\_(u)?u($().data):u;t&&-1!==e&&(e=setTimeout(a,t))}function a(){$().error||!g&&!z().isVisible()||!E&&!z().isOnline()?t():me(Q).then(t)}return t(),()=>{e&&(clearTimeout(e),e=-1)}}),[u,g,E,x]),(0,e.useDebugValue)(re),i&&p(ae)&&x){if(!M&&I)throw new Error("Fallback data is required when using suspense in SSR.");A.current=a,F.current=n,L.current=!1;const e=C[x];if(!p(e)){const t=ue(e);X(t)}if(!p(ne))throw ne;{const e=me(Q);p(re)||(e.status="fulfilled",e.value=!0),X(e)}}return{mutate:ue,get data(){return U.data=!0,re},get error(){return U.error=!0,ne},get isValidating(){return U.isValidating=!0,se},get isLoading(){return U.isLoading=!0,ce}}},function(...t){const a=f(j,(0,e.useContext)(K)),[n,o,r]=(e=>\_(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}])(t),i=U(a,r);let l=ee;const{use:s}=i,c=(s||[]).concat(J);for(let e=c.length;e--;)l=c[e](l);return l(n,o||i.fetcher||null,i)});var ee;const te={options:"undefined"!=typeof imageSeoSettings?imageSeoSettings:{},global:"undefined"!=typeof imageSeoGlobal?imageSeoGlobal:{}},ae="SET\_OPTIONS",ne="OPTIONS\_MODIFIED",oe=(e,t)=>{switch(t.type){case ae:return{...e,options:{...e.options,...t.payload}};case ne:return{...e,optionsModified:t.payload};default:return e}},re=(0,n.createContext)(te),ie=({children:e})=>{const t=(0,n.useRef)(!0),[a,o]=(0,n.useState)([]),[i,s]=(0,n.useState)(!1),[c,m]=(0,n.useReducer)(oe,te),[u,d]=((e,t,a={leading:!1})=>{const[o,r]=(0,n.useState)(e),i=(0,n.useRef)(null),l=(0,n.useRef)(!0),s=()=>window.clearTimeout(i.current);return(0,n.useEffect)((()=>s),[]),[o,(0,n.useCallback)((e=>{s(),l.current&&a.leading?r(e):i.current=window.setTimeout((()=>{l.current=!0,r(e)}),t),l.current=!1}),[a.leading,t])]})(te.options,500),g=(0,n.useCallback)(((e,t=!1)=>{m({type:ae,payload:e}),t||(m({type:ne,payload:!0}),d({...c.options,...e}))}),[d,c.options]),p=(0,n.useCallback)((e=>{const t={id:(new Date).getTime(),...e,content:e?.content||"",politeness:e?.politeness||"polite",actions:e?.actions||[],explicitDismiss:e?.explicitDismiss||!1};o((e=>[...e,t]))}),[]),\_=(0,n.useCallback)((e=>{o((t=>t.filter((t=>t.id!==e))))}),[]),f=(0,n.useMemo)((()=>({options:c.options,global:c.global,loading:i,setOptions:g,addNotice:p,removeNotice:\_,notices:a})),[p,i,a,\_,g,c.global,c.options]),E=(0,n.useMemo)((()=>u),[u]);return(0,n.useEffect)((()=>{t.current||c.optionsModified&&(async(e,t)=>{try{const{user:e,...a}=t;await l()({path:"imageseo/v1/settings",method:"POST",data:{...a}})}catch(e){console.error("Error saving settings:",e)}})(0,E).then((()=>{s(!1),p({status:"info",content:(0,r.\_\_)("Options saved","imageseo")})})).catch((e=>{console.warn(e),p({status:"error",content:(0,r.\_\_)("Error saving options","imageseo")}),s(!1)}))}),[p,E,c.optionsModified]),(0,n.useEffect)((()=>{t.current&&(t.current=!1)}),[]),React.createElement(re.Provider,{value:f},e)},le=()=>{const e=(0,n.useContext)(re);if(void 0===e)throw new Error("useSettings must be used within a SettingsProvider");return e},se=({heading:e,children:a,saveButton:i})=>{const{options:l}=le(),{data:s,isLoading:m}=(e=>{const[t,a]=(0,n.useState)(!0),{setOptions:o,addNotice:r}=le(),{data:i,error:l,isLoading:s,mutate:m}=Z([e?"/imageseo/v1/validate-api-key":null,{apiKey:e}],c,{onError:()=>{a(!1)},onSuccess:e=>{if(a(!1),e?.message)return o({allowed:!1}),void r({status:"error",content:e.message});o({allowed:!0},!0)}});return{data:i,error:l,isLoading:t,isFetching:s,mutate:m}})(l.apiKey),u=(0,n.useMemo)((()=>{if(m||!s)return 0;if("Invalid API Key"===s?.message)return 0;const{user:e}=s,t=e?.plan?.limitImages+e?.bonusStockImages-e?.currentRequestImages;return isNaN(t)?0:t}),[s,m]),d=(0,n.useCallback)((()=>{window.open("https://app.imageseo.com/plan/","\_blank")}),[]);return React.createElement(t.Animate,{type:m?"loading":""},(({className:n})=>React.createElement(t.Card,null,React.createElement(t.CardHeader,null,React.createElement("div",{className:"header-container"},React.createElement("div",{className:"header"},React.createElement("img",{className:"logo",src:o,alt:"logo"}),React.createElement(t.\_\_experimentalHeading,{align:"center"},e),React.createElement(t.ExternalLink,{className:"visit-website",href:"https://www.imageseo.com",target:"\_blank"},(0,r.\_\_)("Visit website","imageseo"))),React.createElement("div",{className:"cta"},React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("Remaining credits:","imageseo")," ",u),React.createElement("span",null,React.createElement(t.Button,{variant:"primary",onClick:d},(0,r.\_\_)("Buy more!","imageseo")))))),React.createElement(t.CardBody,{className:n},a),React.createElement(t.CardFooter,null,React.createElement(t.\_\_experimentalText,null,""),i&&React.createElement(t.Button,{type:"submit",variant:"secondary"},(0,r.\_\_)("Save","imageseo"))))))},ce=()=>{const{options:e,global:a,setOptions:o,addNotice:i}=le(),[s,c]=(0,n.useState)(!1),[m,u]=(0,n.useState)(e?.allowed),[d,g]=(0,n.useState)(""),[p,\_]=(0,n.useState)({firstName:a?.user?.firstName||"",lastName:a?.user?.lastName||"",email:a?.user?.email||"",password:"",terms:!1,news:!1}),f=async()=>{try{g(""),c(!0);const t=await l()({path:"/imageseo/v1/validate-api-key",method:"POST",data:{apiKey:e.apiKey}});if(void 0!==t?.data?.message)return o({allowed:!1}),g(t?.data?.message),c(!1),void i({status:"error",content:t?.data?.message});c(!1),o({allowed:!0}),i({status:"success",content:(0,r.\_\_)("API key validated","imageseo")})}catch(e){c(!1),i({status:"error",content:(0,r.\_\_)("Error validating API key","imageseo")}),console.error("Error validating API key:",e)}},E=async()=>{try{c(!0);const e=await l()({path:"/imageseo/v1/register",method:"POST",data:p});if(Object.prototype.hasOwnProperty.call(e,"success")&&!e?.success)throw new Error(Array.isArray(e?.data?.message)?e?.data?.message.join(","):e?.data?.message);if(e?.message)throw i({status:"error",content:e?.message}),new Error("Something went wrong");o({apiKey:e?.projects?.[0]?.apiKey,allowed:!0},!1),i({status:"success",content:(0,r.\_\_)("Account created","imageseo")}),u(!0),c(!1)}catch(e){console.log(e),c(!1),i({status:"error",content:e.message}),console.error("Error registering account:",e)}},h=(e,t)=>{\_({...p,[e]:t})};return React.createElement("div",{className:"welcome-screen"},React.createElement(t.\_\_experimentalHeading,{order:3,lineHeight:2,align:"center"},(0,r.\_\_)("Welcome to ImageSEO","imageseo")),React.createElement(t.\_\_experimentalText,{align:"center"},(0,r.\_\_)("We are happy to see you here! ImageSEO is a WordPress plugin that helps you to optimize your images for search engines and social media.","imageseo")),React.createElement(t.Animate,{type:s?"loading":""},(({className:a})=>React.createElement(React.Fragment,null,m?React.createElement("div",{className:`form-container ${a||""}`},React.createElement(t.TextControl,{label:(0,r.\_\_)("API Key","imageseo"),value:e?.apiKey||"",onChange:e=>o({apiKey:e})}),React.createElement(t.Flex,{justifyContent:"spaceBetween"},React.createElement(t.FlexItem,null,React.createElement(t.Button,{disabled:s,isPrimary:!0,onClick:f},s?(0,r.\_\_)("Validating…","imageseo"):(0,r.\_\_)("Validate key","imageseo"))),!e?.allowed&&React.createElement(t.FlexItem,null,React.createElement(t.Button,{isTertiary:!0,onClick:()=>u(!1)},(0,r.\_\_)("I want to register for a free account","imageseo"))),e?.allowed&&React.createElement(t.FlexItem,null,React.createElement(t.Icon,{icon:"yes",style:{color:"#52c41a"}}),React.createElement(t.\_\_experimentalText,{variant:"muted"},(0,r.\_\_)("API key validated","imageseo")))),d&&React.createElement(t.\_\_experimentalText,{variant:"error"},d)):React.createElement("div",{className:`form-container ${a||""}`},React.createElement(t.TextControl,{label:(0,r.\_\_)("First name","imageseo"),value:p.firstName,onChange:e=>h("firstName",e)}),React.createElement(t.TextControl,{label:(0,r.\_\_)("Last name","imageseo"),value:p.lastName,onChange:e=>h("lastName",e)}),React.createElement(t.TextControl,{label:(0,r.\_\_)("Email","imageseo"),type:"email",value:p.email,onChange:e=>h("email",e)}),React.createElement(t.TextControl,{type:"password",label:(0,r.\_\_)("Password","imageseo"),value:p.password,onChange:e=>h("password",e)}),React.createElement(t.CheckboxControl,{label:(0,r.\_\_)("I agree to the terms and conditions","imageseo"),help:React.createElement(t.\_\_experimentalText,{variant:"muted"},(0,r.\_\_)("By creating an account, you agree to our terms and conditions.","imageseo"),React.createElement(t.ExternalLink,{style:{marginLeft:5},href:"https://imageseo.io/terms-conditions/"},(0,r.\_\_)("Read more","imageseo"))),checked:p.terms,onChange:e=>h("terms",e)}),React.createElement(t.CheckboxControl,{label:(0,r.\_\_)("I want to receive news and updates","imageseo"),help:(0,r.\_\_)("You can unsubscribe at any time","imageseo"),checked:p.news,onChange:e=>h("news",e)}),React.createElement(t.Flex,null,React.createElement(t.FlexItem,null,React.createElement(t.Button,{isPrimary:!0,disabled:s,onClick:E},(0,r.\_\_)("Create account","imageseo"))),React.createElement(t.FlexItem,null,React.createElement(t.Button,{isTertiary:!0,disabled:s,onClick:()=>u(!0)},(0,r.\_\_)("I already have an account","imageseo")))))))))},me=({id:e,label:a,help:o,value:i,onChange:l})=>{const[s,c]=(0,n.useState)(i),m=()=>{const e=wp.media({title:(0,r.\_\_)("Select or Upload Media","imageseo"),button:{text:(0,r.\_\_)("Use this item","imageseo")},multiple:!1});e.on("select",(()=>{const t=e.state().get("selection").first().toJSON();c(t.url),l(t.url)})),e.open()};return React.createElement("div",{className:"media-uploader-container",onClick:m},React.createElement(t.BaseControl,{id:e,label:a,help:o,className:"media-uploader"},!s&&React.createElement(t.Button,{isPrimary:!0,onClick:m},(0,r.\_\_)("Select Image","imageseo")),s&&React.createElement("img",{src:s,alt:"Selected"})))},ue=()=>{const{options:e,setOptions:a}=le();return React.createElement("div",null,React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Subtitle","imageseo"),checked:e.socialMediaSettings?.visibilitySubTitle,onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,visibilitySubTitle:t}})},help:(0,r.\_\_)("Show the price product or author depending on the page ( Product price (WooCommerce only) )","imageseo")}),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Subtitle 2","imageseo"),checked:e.socialMediaSettings?.visibilitySubTitleTwo,onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,visibilitySubTitleTwo:t}})},help:(0,r.\_\_)("Show the reading time of an article or the number of reviews (WooCommerce only).","imageseo")}),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Stars rating","imageseo"),checked:e.socialMediaSettings?.visibilityRating,onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,visibilityRating:t}})},help:(0,r.\_\_)("Show the stars linked to a review of your product for example.","imageseo")}),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Author avatar","imageseo"),checked:e.socialMediaSettings?.visibilityAvatar,onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,visibilityAvatar:t}})},help:(0,r.\_\_)("Only used for post content.","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControl,{style:{width:300},value:e.socialMediaSettings?.layout||"CARD\_LEFT",label:(0,r.\_\_)("Layout","imageseo"),help:(0,r.\_\_)("Choose the layout of the social card.","imageseo"),onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,layout:t}})}},React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"CARD\_LEFT",label:(0,r.\_\_)("Card left","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"CARD\_RIGHT",label:(0,r.\_\_)("Card right","imageseo")})),React.createElement(t.\_\_experimentalToggleGroupControl,{value:e.socialMediaSettings?.textAlignment||"top",onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,textAlignment:t}})},label:(0,r.\_\_)("Text alignment","imageseo")},React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"top",label:(0,r.\_\_)("Top","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"center",label:(0,r.\_\_)("Center","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"bottom",label:(0,r.\_\_)("Bottom","imageseo")})),React.createElement(t.\_\_experimentalGrid,{columns:3},React.createElement(t.BaseControl,{id:"text-color",label:(0,r.\_\_)("Text color","imageseo")},React.createElement(t.ColorPicker,{defaultValue:e.socialMediaSettings?.textColor||"#000000",onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,textColor:t}})}})),React.createElement(t.BaseControl,{id:"background-color",label:(0,r.\_\_)("Background color","imageseo")},React.createElement(t.ColorPicker,{defaultValue:e.socialMediaSettings?.contentBackgroundColor||"#ffffff",onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,contentBackgroundColor:t}})}})),e.socialMediaSettings?.visibilityRating&&React.createElement(t.BaseControl,{id:"star-color",label:(0,r.\_\_)("Star color","imageseo")},React.createElement(t.ColorPicker,{defaultValue:e.socialMediaSettings?.starColor||"#F8CA00",onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,starColor:t}})}}))),React.createElement(me,{label:(0,r.\_\_)("Logo","imageseo"),value:e?.socialMediaSettings?.logoUrl,help:(0,r.\_\_)("Click to upload a logo","imageseo"),onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,logoUrl:t}})}}),React.createElement(t.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(me,{label:(0,r.\_\_)("Background image","imageseo"),value:e?.socialMediaSettings?.defaultBgImg,help:(0,r.\_\_)("Click to upload a background Image","imageseo"),onChange:t=>{a({...e,socialMediaSettings:{...e.socialMediaSettings,defaultBgImg:t}})}}))},de=a.p+"images/avatar-default.00d4ecf9.jpg",ge=({color:e})=>React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:e||"rgb(248, 202, 0)",stroke:e||"rgb(248, 202, 0)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-star"},React.createElement("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})),pe=()=>{const{options:e}=le(),a=e?.socialMediaSettings||{},{layout:n,defaultBgImg:o,logoUrl:i,textColor:l,visibilitySubTitle:s,visibilitySubTitleTwo:c,visibilityRating:m,visibilityAvatar:u,contentBackgroundColor:d,starColor:g}=a;return React.createElement("div",{className:"previewer"},"CARD\_LEFT"===n&&React.createElement("div",{className:"bg-image",style:{backgroundImage:`url(${o})`}}),React.createElement("div",{className:"content",style:{backgroundColor:d}},React.createElement("div",{className:"padded"},React.createElement("img",{src:i,alt:"logo",className:"logo"}),React.createElement(t.\_\_experimentalHeading,{level:2,lineHeight:1.5,style:{color:l}},(0,r.\_\_)("Lorem ipsum (post title)","imageseo")),s&&React.createElement(t.\_\_experimentalHeading,{level:3,lineHeight:1.5,style:{color:l}},(0,r.\_\_)("Lorem ipsum (sub title)","imageseo")),c&&React.createElement(t.\_\_experimentalHeading,{level:4,lineHeight:1.5,style:{color:l}},(0,r.\_\_)("Lorem ipsum (sub title two)","imageseo")),u&&React.createElement("img",{src:de,alt:"default avatar",className:"avatar"}),m&&React.createElement("div",null,React.createElement(ge,{color:g}),React.createElement(ge,{color:g}),React.createElement(ge,{color:g}),React.createElement(ge,{color:g}),React.createElement(ge,{color:g})))),"CARD\_RIGHT"===n&&React.createElement("div",{className:"bg-image",style:{backgroundImage:`url(${o})`}}))},\_e=()=>{const{loading:e}=le();return React.createElement(t.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""} social-card-screen`},React.createElement(ue,null),React.createElement(pe,null))))},fe=()=>{const[e,t]=(0,n.useState)(!0),{data:a,error:o,isLoading:r,mutate:i}=Z("/imageseo/v1/image-query",s,{onError:()=>{t(!1)},onSuccess:()=>{t(!1)},revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1});return{data:a,error:o,isLoading:e,isFetching:r,mutate:i}},Ee=()=>{const{options:e,setOptions:a,global:n}=le(),{mutate:o}=fe();return React.createElement("div",{className:"form"},React.createElement(t.SelectControl,{label:(0,r.\_\_)("Images to optimize","imageseo"),value:e?.altFilter||"ALL",onChange:e=>{a({altFilter:e}),o()},options:(n.altSpecification||[]).map((e=>({value:e.id,label:e.label})))}),React.createElement(t.SelectControl,{label:(0,r.\_\_)("Optimize alt text","imageseo"),value:e?.altFill||"FILL\_ALL",onChange:e=>{a({altFill:e}),o()},options:[{value:"FILL\_ALL",label:(0,r.\_\_)("Optimize all ALT texts","imageseo")},{value:"FILL\_ONLY\_EMPTY",label:(0,r.\_\_)("Optimize only missing ALT texts","imageseo")}]}),React.createElement(t.ToggleControl,{checked:e?.optimizeFile,onChange:e=>{a({optimizeFile:e})},label:(0,r.\_\_)("Rename files","imageseo")}))},he=()=>{const[e,t]=(0,n.useState)(!0),{data:a,error:o,isLoading:r,mutate:i}=Z("/imageseo/v1/get-bulk-optimizer-status",s,{onError:()=>{t(!1)},onSuccess:()=>{t(!1)},refreshInterval:1e4});return{data:a,error:o,isLoading:e,isFetching:r,mutate:i}},Re=()=>{const{global:e,options:a,addNotice:o}=le(),{data:i,isLoading:s,error:c,mutate:m}=he(),{data:u,mutate:d}=fe(),g=async()=>{await l()({path:"/imageseo/v1/start-bulk-optimizer",method:"POST"}),m(),o({status:"success",content:(0,r.\_\_)("Optimizer started","imageseo")})},p=(0,n.useMemo)((()=>i?.report?.errors?.length>0&&void 0!==i?.report?.errors?.find((e=>"You have reached the limit of images to optimize"===e.trim()))),[i?.report?.errors]);return s?React.createElement(t.Placeholder,{className:"optimizer",icon:"update",label:(0,r.\_\_)("Loading","imageseo"),instructions:(0,r.\_\_)("Loading…","imageseo")}):c?React.createElement(t.Placeholder,{className:"optimizer",icon:"warning",label:(0,r.\_\_)("Error","imageseo"),instructions:(0,r.\_\_)("An error occurred while fetching the optimizer status.","imageseo")}):"idle"===i?.status&&p?React.createElement("div",{className:"optimizer"},React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("You have reached the limit of images to optimize.","imageseo")),React.createElement(t.\_\_experimentalSpacer,{marginY:"5"}),React.createElement(t.Button,{isPrimary:!0,disabled:"running"===i?.status,onClick:g},(0,r.\_\_)("Try again","imageseo"))):React.createElement("div",{className:"optimizer"},"idle"===i?.status&&React.createElement(React.Fragment,null,"NEXTGEN\_GALLERY"===a?.altFilter&&React.createElement(t.\_\_experimentalText,null,(0,r.sprintf)((0,r.\_\_)("There are %1$s images in your NEXTGEN library and %2$s don't have an alternative text.","imageseo"),e.bulkQuery.ids.length||0,e.bulkQuery.nonOptimized.length||0)),"NEXTGEN\_GALLERY"!==a?.altFilter&&React.createElement(t.\_\_experimentalText,null,(0,r.sprintf)((0,r.\_\_)("There are %1$s images in your media library and %2$s don't have an alternative text.","imageseo"),u?.totalImages||0,u?.totalNoAlt||0)),React.createElement(t.\_\_experimentalSpacer,{marginY:"5"}),React.createElement(t.Button,{isPrimary:!0,disabled:"running"===i?.status,onClick:g},(0,r.\_\_)("Start optimization","imageseo"))),"running"===i?.status&&React.createElement("div",{className:"progress"},React.createElement(t.\_\_experimentalText,null,(0,r.sprintf)((0,r.\_\_)("Optimizing %1$s images. ( %2$s/%3$s )","imageseo"),i?.report?.total,i?.report?.optimized,i?.report?.total)),React.createElement("progress",{value:i?.report?.optimized/i?.report?.total\*100,max:100}),React.createElement(t.\_\_experimentalSpacer,{marginY:"3"}),React.createElement(t.Button,{isPrimary:!0,onClick:async()=>{await l()({path:"/imageseo/v1/stop-bulk-optimizer",method:"POST"}),m(),d(),o({status:"success",content:(0,r.\_\_)("Optimizer stopped","imageseo")})}},(0,r.\_\_)("Stop optimizer","imageseo"))))},ve=()=>{const{loading:e}=le(),{data:a}=he();return React.createElement(t.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""}`},React.createElement(t.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(t.\_\_experimentalHeading,{level:4},"running"===a?.status?(0,r.\_\_)("Current report","imageseo"):(0,r.\_\_)("Last report","imageseo")),React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("Optimized: ","imageseo")," ",a?.report.optimized),React.createElement("br",null),React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("Skipped: ","imageseo")," ",a?.report.skipped),React.createElement("br",null),React.createElement(t.\_\_experimentalText,null,(0,r.\_\_)("Failed: ","imageseo")," ",a?.report.failed))))},ye=()=>{const{loading:e}=le();return React.createElement(t.Animate,{type:e?"loading":""},(({className:e})=>React.createElement(React.Fragment,null,React.createElement("div",{className:`${e||""} bulk-optimizer-screen`},React.createElement(Ee,null),React.createElement(Re,null)),React.createElement(ve,null))))},be=()=>{const{options:e,global:a,setOptions:o}=le(),i=(0,n.useMemo)((()=>{const t=e?.defaultLanguageIa||a?.currentLanguage||"en";return t.includes("\_")?t.split("\_")[0]:t}),[a?.currentLanguage,e?.defaultLanguageIa]);return React.createElement("div",null,React.createElement(t.\_\_experimentalHeading,{level:4,lineHeight:2},(0,r.\_\_)("On-upload optimization","imageseo")),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Fill alt","imageseo"),help:(0,r.\_\_)("The plugin will automatically write an alternative to the images you will upload.","imageseo"),checked:e.activeAltWriteUpload,onChange:e=>o({activeAltWriteUpload:e})}),React.createElement(t.ToggleControl,{label:(0,r.\_\_)("Rename files","imageseo"),help:(0,r.\_\_)("The plugin will automatically rewrite with SEO friendly content the name of the images you will upload.","imageseo"),checked:e.activeRenameWriteUpload,onChange:e=>o({activeRenameWriteUpload:e})}),React.createElement(t.SelectControl,{label:(0,r.\_\_)("Language","imageseo"),options:a.languages||[],onChange:e=>{o({defaultLanguageIa:e})},value:i}),React.createElement(t.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(t.\_\_experimentalHeading,{level:4,lineHeight:2},(0,r.\_\_)("Social media card generator","imageseo")),React.createElement(t.\_\_experimentalText,{style:{marginBottom:15,display:"inline-block"}},(0,r.\_\_)("Automatic generation for the following post types:","imageseo")),a?.allowedPostTypes?.map((a=>React.createElement("div",{key:a.value,style:{maxWidth:300}},React.createElement(t.ToggleControl,{\_\_nextHasNoMarginBottom:!0,checked:(e?.socialMediaPostTypes||[]).includes(a.value),label:a.label,onChange:t=>((t,a)=>{a&&!(e?.socialMediaPostTypes||[]).includes(t)&&o({socialMediaPostTypes:[...e?.socialMediaPostTypes||[],t]}),!a&&(e?.socialMediaPostTypes||[]).includes(t)&&o({socialMediaPostTypes:(e?.socialMediaPostTypes||[]).filter((e=>e!==t))})})(a.value,t)})))))},we=()=>{const{loading:e}=le();return React.createElement(t.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""} social-card-screen`},React.createElement(be,null))))},Se=()=>{const[e,a]=(0,n.useState)(!1),{data:o,isLoading:r}=Z("/imageseo/v1/optimizer-errors",s,{refreshInterval:1e4}),{data:i,isLoading:l}=Z("/imageseo/v1/debug-info",s,{refreshInterval:1e4});return(0,n.useEffect)((()=>{localStorage.getItem("imageseo\_debug\_log")&&a(!0)}),[]),e?r?React.createElement(t.Spinner,null):React.createElement(React.Fragment,null,React.createElement("h4",null,"Error Log"),React.createElement("pre",null,JSON.stringify(o,null,2)),React.createElement("h4",null,"Debug Info"),React.createElement("pre",null,JSON.stringify(i,null,2))):null},Ce=new URLSearchParams(window.location.search).get("activeTab"),Te=localStorage.getItem("imageseo\_debug\_log");function xe(){const{options:e,notices:a,removeNotice:o}=le(),[i,l]=(0,n.useState)(Ce||"welcome");return React.createElement(React.Fragment,null,React.createElement(se,{heading:(0,r.\_\_)("ImageSEO","imageseo")},React.createElement(t.\_\_experimentalToggleGroupControl,{label:"",onChange:e=>{l(e);const t=new URL(window.location.href);t.searchParams.set("activeTab",e),window.history.replaceState(null,null,t)},value:i,isBlock:!0},React.createElement(t.\_\_experimentalToggleGroupControlOption,{type:"button",value:"welcome",label:(0,r.\_\_)("Welcome","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"socialcard",label:(0,r.\_\_)("Social card","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"bulkoptimizer",label:(0,r.\_\_)("Bulk optimization","imageseo")}),React.createElement(t.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"settings",label:(0,r.\_\_)("Settings","imageseo")})),"welcome"===i&&React.createElement(ce,null),"socialcard"===i&&React.createElement(\_e,null),"bulkoptimizer"===i&&React.createElement(ye,null),"settings"===i&&React.createElement(we,null)),Te&&React.createElement(Se,null),React.createElement(t.SnackbarList,{notices:a,onRemove:o}))}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("imageseo-settings-v2");(0,n.createRoot)(e).render(React.createElement(ie,null,React.createElement(x~~e,null)))}))})()})(); |
  |  | 1 | (()=>{"use strict";var e={580:e=>{var t=/["'&<>]/;e.exports=function(e){var a,n=""+e,r=t.exec(n);if(!r)return n;var i="",o=0,l=0;for(o=r.index;o<n.length;o++){switch(n.charCodeAt(o)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 39:a="&#39;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}l!==o&&(i+=n.substring(l,o)),l=o+1,i+=a}return l!==o?i+n.substring(l,o):i}},63:(e,t,a)=>{var n=a(609),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useState,o=n.useEffect,l=n.useLayoutEffect,s=n.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!r(e,a)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),n=i({inst:{value:a,getSnapshot:t}}),r=n[0].inst,u=n[1];return l((function(){r.value=a,r.getSnapshot=t,c(r)&&u({inst:r})}),[e,a,t]),o((function(){return c(r)&&u({inst:r}),e((function(){c(r)&&u({inst:r})}))}),[e]),s(a),a};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:u},888:(e,t,a)=>{e.exports=a(63)},609:e=>{e.exports=window.React}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.\_\_esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.\*$/,"").replace(/\?.\*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e=a(609),t=a.n(e);const n=window.wp.components,r=window.wp.element,i=a.p+"images/default\_logo.a24dbeff.png",o=window.wp.i18n,l=window.wp.apiFetch;var s=a.n(l);const c=async e=>await s()({path:e,method:"GET"}),u=async([e,t])=>(await s()({path:e,method:"POST",data:t})).data;var m=a(888);const d=()=>{},g=d(),p=Object,h=e=>e===g,f=e=>"function"==typeof e,\_=(e,t)=>({...e,...t}),v=new WeakMap;let y=0;const b=e=>{const t=typeof e,a=e&&e.constructor,n=a==Date;let r,i;if(p(e)!==e||n||a==RegExp)r=n?e.toJSON():"symbol"==t?e.toString():"string"==t?JSON.stringify(e):""+e;else{if(r=v.get(e),r)return r;if(r=++y+"~",v.set(e,r),a==Array){for(r="@",i=0;i<e.length;i++)r+=b(e[i])+",";v.set(e,r)}if(a==p){r="#";const t=p.keys(e).sort();for(;!h(i=t.pop());)h(e[i])||(r+=i+":"+b(e[i])+",");v.set(e,r)}}return r},E=new WeakMap,R={},w={},S="undefined",C=typeof window!=S,T=typeof document!=S,x=(e,t)=>{const a=E.get(e);return[()=>!h(t)&&e.get(t)||R,n=>{if(!h(t)){const r=e.get(t);t in w||(w[t]=r),a[5](t,\_(r,n),r||R)}},a[6],()=>!h(t)&&t in w?w[t]:!h(t)&&e.get(t)||R]};let k=!0;const[N,O]=C&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[d,d],L={isOnline:()=>k,isVisible:()=>{const e=T&&document.visibilityState;return h(e)||"hidden"!==e}},I={initFocus:e=>(T&&document.addEventListener("visibilitychange",e),N("focus",e),()=>{T&&document.removeEventListener("visibilitychange",e),O("focus",e)}),initReconnect:e=>{const t=()=>{k=!0,e()},a=()=>{k=!1};return N("online",t),N("offline",a),()=>{O("online",t),O("offline",a)}}},M=!e.useId,A=!C||"Deno"in window,P=A?e.useEffect:e.useLayoutEffect,F="undefined"!=typeof navigator&&navigator.connection,z=!A&&F&&(["slow-2g","2g"].includes(F.effectiveType)||F.saveData),B=e=>{if(f(e))try{e=e()}catch(t){e=""}const t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?b(e):"",t]};let D=0;const H=()=>++D;async function $(...e){const[t,a,n,r]=e,i=\_({populateCache:!0,throwOnError:!0},"boolean"==typeof r?{revalidate:r}:r||{});let o=i.populateCache;const l=i.rollbackOnError;let s=i.optimisticData;const c=i.throwOnError;if(f(a)){const e=a,n=[],r=t.keys();for(const a of r)!/^\$(inf|sub)\$/.test(a)&&e(t.get(a).\_k)&&n.push(a);return Promise.all(n.map(u))}return u(a);async function u(a){const[r]=B(a);if(!r)return;const[u,m]=x(t,r),[d,p,\_,v]=E.get(t),y=()=>{const e=d[r];return(f(i.revalidate)?i.revalidate(u().data,a):!1!==i.revalidate)&&(delete \_[r],delete v[r],e&&e[0])?e[0](2).then((()=>u().data)):u().data};if(e.length<3)return y();let b,R=n;const w=H();p[r]=[w,0];const S=!h(s),C=u(),T=C.data,k=C.\_c,N=h(k)?T:k;if(S&&(s=f(s)?s(N,T):s,m({data:s,\_c:N})),f(R))try{R=R(N)}catch(e){b=e}if(R&&f(R.then)){if(R=await R.catch((e=>{b=e})),w!==p[r][0]){if(b)throw b;return R}b&&S&&(e=>"function"==typeof l?l(e):!1!==l)(b)&&(o=!0,m({data:N,\_c:g}))}if(o&&!b)if(f(o)){const e=o(R,N);m({data:e,error:g,\_c:g})}else m({data:R,error:g,\_c:g});if(p[r][1]=H(),Promise.resolve(y()).then((()=>{m({\_c:g})})),!b)return R;if(c)throw b}}const j=(e,t)=>{for(const a in e)e[a][0]&&e[a][0](t)},V=(e,t)=>{if(!E.has(e)){const a=\_(I,t),n={},r=$.bind(g,e);let i=d;const o={},l=(e,t)=>{const a=o[e]||[];return o[e]=a,a.push(t),()=>a.splice(a.indexOf(t),1)},s=(t,a,n)=>{e.set(t,a);const r=o[t];if(r)for(const e of r)e(a,n)},c=()=>{if(!E.has(e)&&(E.set(e,[n,{},{},{},r,s,l]),!A)){const t=a.initFocus(setTimeout.bind(g,j.bind(g,n,0))),r=a.initReconnect(setTimeout.bind(g,j.bind(g,n,1)));i=()=>{t&&t(),r&&r(),E.delete(e)}}};return c(),[e,r,c,i]}return[e,E.get(e)[4]]},[G,W]=V(new Map),U=\_({onLoadingSlow:d,onSuccess:d,onError:d,onErrorRetry:(e,\_\_,t,a,n)=>{const r=t.errorRetryCount,i=n.retryCount,o=~~((Math.random()+.5)\*(1<<(i<8?i:8)))\*t.errorRetryInterval;!h(r)&&i>r||setTimeout(a,o,n)},onDiscarded:d,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:z?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:z?5e3:3e3,compare:(e,t)=>b(e)==b(t),isPaused:()=>!1,cache:G,mutate:W,fallback:{}},L),K=(e,t)=>{const a=\_(e,t);if(t){const{use:n,fallback:r}=e,{use:i,fallback:o}=t;n&&i&&(a.use=n.concat(i)),r&&o&&(a.fallback=\_(r,o))}return a},Y=(0,e.createContext)({}),q=C&&window.\_\_SWR\_DEVTOOLS\_USE\_\_,J=q?window.\_\_SWR\_DEVTOOLS\_USE\_\_:[],X=J.concat((e=>(t,a,n)=>e(t,a&&((...e)=>{const[n]=B(t),[,,,r]=E.get(G);if(n.startsWith("$inf$"))return a(...e);const i=r[n];return h(i)?a(...e):(delete r[n],i)}),n)));q&&(window.\_\_SWR\_DEVTOOLS\_REACT\_\_=e);const Q=e.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(e.status="pending",e.then((t=>{e.status="fulfilled",e.value=t}),(t=>{e.status="rejected",e.reason=t})),e)}),Z={dedupe:!0},ee=(p.defineProperty((t=>{const{value:a}=t,n=(0,e.useContext)(Y),r=f(a),i=(0,e.useMemo)((()=>r?a(n):a),[r,n,a]),o=(0,e.useMemo)((()=>r?i:K(n,i)),[r,n,i]),l=i&&i.provider,s=(0,e.useRef)(g);l&&!s.current&&(s.current=V(l(o.cache||G),i));const c=s.current;return c&&(o.cache=c[0],o.mutate=c[1]),P((()=>{if(c)return c[2]&&c[2](),c[3]}),[]),(0,e.createElement)(Y.Provider,\_(t,{value:o}))}),"defaultValue",{value:U}),te=(t,a,n)=>{const{cache:r,compare:i,suspense:o,fallbackData:l,revalidateOnMount:s,revalidateIfStale:c,refreshInterval:u,refreshWhenHidden:d,refreshWhenOffline:p,keepPreviousData:v}=n,[y,b,R,w]=E.get(r),[T,k]=B(t),N=(0,e.useRef)(!1),O=(0,e.useRef)(!1),L=(0,e.useRef)(T),I=(0,e.useRef)(a),F=(0,e.useRef)(n),z=()=>F.current,D=()=>z().isVisible()&&z().isOnline(),[j,V,G,W]=x(r,T),U=(0,e.useRef)({}).current,K=h(l)?n.fallback[T]:l,Y=(e,t)=>{for(const a in U){const n=a;if("data"===n){if(!i(e[n],t[n])){if(!h(e[n]))return!1;if(!i(ie,t[n]))return!1}}else if(t[n]!==e[n])return!1}return!0},q=(0,e.useMemo)((()=>{const e=!!T&&!!a&&(h(s)?!z().isPaused()&&!o&&(!!h(c)||c):s),t=t=>{const a=\_(t);return delete a.\_k,e?{isValidating:!0,isLoading:!0,...a}:a},n=j(),r=W(),i=t(n),l=n===r?i:t(r);let u=i;return[()=>{const e=t(j());return Y(e,u)?(u.data=e.data,u.isLoading=e.isLoading,u.isValidating=e.isValidating,u.error=e.error,u):(u=e,e)},()=>l]}),[r,T]),J=(0,m.useSyncExternalStore)((0,e.useCallback)((e=>G(T,((t,a)=>{Y(a,t)||e()}))),[r,T]),q[0],q[1]),X=!N.current,ee=y[T]&&y[T].length>0,te=J.data,ae=h(te)?K:te,ne=J.error,re=(0,e.useRef)(ae),ie=v?h(te)?re.current:te:ae,oe=!(ee&&!h(ne))&&(X&&!h(s)?s:!z().isPaused()&&(o?!h(ae)&&c:h(ae)||c)),le=!!(T&&a&&X&&oe),se=h(J.isValidating)?le:J.isValidating,ce=h(J.isLoading)?le:J.isLoading,ue=(0,e.useCallback)((async e=>{const t=I.current;if(!T||!t||O.current||z().isPaused())return!1;let a,r,o=!0;const l=e||{},s=!R[T]||!l.dedupe,c=()=>M?!O.current&&T===L.current&&N.current:T===L.current,u={isValidating:!1,isLoading:!1},m=()=>{V(u)},d=()=>{const e=R[T];e&&e[1]===r&&delete R[T]},p={isValidating:!0};h(j().data)&&(p.isLoading=!0);try{if(s&&(V(p),n.loadingTimeout&&h(j().data)&&setTimeout((()=>{o&&c()&&z().onLoadingSlow(T,n)}),n.loadingTimeout),R[T]=[t(k),H()]),[a,r]=R[T],a=await a,s&&setTimeout(d,n.dedupingInterval),!R[T]||R[T][1]!==r)return s&&c()&&z().onDiscarded(T),!1;u.error=g;const e=b[T];if(!h(e)&&(r<=e[0]||r<=e[1]||0===e[1]))return m(),s&&c()&&z().onDiscarded(T),!1;const l=j().data;u.data=i(l,a)?l:a,s&&c()&&z().onSuccess(a,T,n)}catch(e){d();const t=z(),{shouldRetryOnError:a}=t;t.isPaused()||(u.error=e,s&&c()&&(t.onError(e,T,t),(!0===a||f(a)&&a(e))&&(z().revalidateOnFocus&&z().revalidateOnReconnect&&!D()||t.onErrorRetry(e,T,t,(e=>{const t=y[T];t&&t[0]&&t[0](3,e)}),{retryCount:(l.retryCount||0)+1,dedupe:!0}))))}return o=!1,m(),!0}),[T,r]),me=(0,e.useCallback)(((...e)=>$(r,L.current,...e)),[]);if(P((()=>{I.current=a,F.current=n,h(te)||(re.current=te)})),P((()=>{if(!T)return;const e=ue.bind(g,Z);let t=0;const a=((e,t,a)=>{const n=t[e]||(t[e]=[]);return n.push(a),()=>{const e=n.indexOf(a);e>=0&&(n[e]=n[n.length-1],n.pop())}})(T,y,((a,n={})=>{if(0==a){const a=Date.now();z().revalidateOnFocus&&a>t&&D()&&(t=a+z().focusThrottleInterval,e())}else if(1==a)z().revalidateOnReconnect&&D()&&e();else{if(2==a)return ue();if(3==a)return ue(n)}}));return O.current=!1,L.current=T,N.current=!0,V({\_k:k}),oe&&(h(ae)||A?e():(n=e,C&&typeof window.requestAnimationFrame!=S?window.requestAnimationFrame(n):setTimeout(n,1))),()=>{O.current=!0,a()};var n}),[T]),P((()=>{let e;function t(){const t=f(u)?u(j().data):u;t&&-1!==e&&(e=setTimeout(a,t))}function a(){j().error||!d&&!z().isVisible()||!p&&!z().isOnline()?t():ue(Z).then(t)}return t(),()=>{e&&(clearTimeout(e),e=-1)}}),[u,d,p,T]),(0,e.useDebugValue)(ie),o&&h(ae)&&T){if(!M&&A)throw new Error("Fallback data is required when using suspense in SSR.");I.current=a,F.current=n,O.current=!1;const e=w[T];if(!h(e)){const t=me(e);Q(t)}if(!h(ne))throw ne;{const e=ue(Z);h(ie)||(e.status="fulfilled",e.value=!0),Q(e)}}return{mutate:me,get data(){return U.data=!0,ie},get error(){return U.error=!0,ne},get isValidating(){return U.isValidating=!0,se},get isLoading(){return U.isLoading=!0,ce}}},function(...t){const a=\_(U,(0,e.useContext)(Y)),[n,r,i]=(e=>f(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}])(t),o=K(a,i);let l=te;const{use:s}=o,c=(s||[]).concat(X);for(let e=c.length;e--;)l=c[e](l);return l(n,r||o.fetcher||null,o)});var te;const ae={options:"undefined"!=typeof imageSeoSettings?imageSeoSettings:{},global:"undefined"!=typeof imageSeoGlobal?imageSeoGlobal:{}},ne="SET\_OPTIONS",re="OPTIONS\_MODIFIED",ie=(e,t)=>{switch(t.type){case ne:return{...e,options:{...e.options,...t.payload}};case re:return{...e,optionsModified:t.payload};default:return e}},oe=(0,r.createContext)(ae),le=({children:e})=>{const t=(0,r.useRef)(!0),[a,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!1),[c,u]=(0,r.useReducer)(ie,ae),[m,d]=((e,t,a={leading:!1})=>{const[n,i]=(0,r.useState)(e),o=(0,r.useRef)(null),l=(0,r.useRef)(!0),s=()=>window.clearTimeout(o.current);return(0,r.useEffect)((()=>s),[]),[n,(0,r.useCallback)((e=>{s(),l.current&&a.leading?i(e):o.current=window.setTimeout((()=>{l.current=!0,i(e)}),t),l.current=!1}),[a.leading,t])]})(ae.options,500),g=(0,r.useCallback)(((e,t=!1)=>{u({type:ne,payload:e}),t||(u({type:re,payload:!0}),d({...c.options,...e}))}),[d,c.options]),p=(0,r.useCallback)((e=>{const t={id:(new Date).getTime(),...e,content:e?.content||"",politeness:e?.politeness||"polite",actions:e?.actions||[],explicitDismiss:e?.explicitDismiss||!1};n((e=>[...e,t]))}),[]),h=(0,r.useCallback)((e=>{n((t=>t.filter((t=>t.id!==e))))}),[]),f=(0,r.useMemo)((()=>({options:c.options,global:c.global,loading:i,setOptions:g,addNotice:p,removeNotice:h,notices:a})),[p,i,a,h,g,c.global,c.options]),\_=(0,r.useMemo)((()=>m),[m]);return(0,r.useEffect)((()=>{t.current||c.optionsModified&&(async(e,t)=>{try{const{user:e,...a}=t;await s()({path:"imageseo/v1/settings",method:"POST",data:{...a}})}catch(e){console.error("Error saving settings:",e)}})(0,\_).then((()=>{l(!1),p({status:"info",content:(0,o.\_\_)("Options saved","imageseo")})})).catch((e=>{console.warn(e),p({status:"error",content:(0,o.\_\_)("Error saving options","imageseo")}),l(!1)}))}),[p,\_,c.optionsModified]),(0,r.useEffect)((()=>{t.current&&(t.current=!1)}),[]),React.createElement(oe.Provider,{value:f},e)},se=()=>{const e=(0,r.useContext)(oe);if(void 0===e)throw new Error("useSettings must be used within a SettingsProvider");return e},ce=({heading:e,children:t,saveButton:a})=>{const{options:l}=se(),{data:s,isLoading:c}=(e=>{const[t,a]=(0,r.useState)(!0),{setOptions:n,addNotice:i}=se(),{data:o,error:l,isLoading:s,mutate:c}=ee([e?"/imageseo/v1/validate-api-key":null,{apiKey:e}],u,{onError:()=>{a(!1)},onSuccess:e=>{if(a(!1),e?.message)return n({allowed:!1}),void i({status:"error",content:e.message});n({allowed:!0},!0)}});return{data:o,error:l,isLoading:t,isFetching:s,mutate:c}})(l.apiKey),m=(0,r.useMemo)((()=>!(c||!s)&&"Invalid API Key"!==s?.message),[s,c]),d=(0,r.useMemo)((()=>{if(c||!s)return 0;if("Invalid API Key"===s?.message)return 0;const{user:e}=s,t=e?.plan?.limitImages+e?.bonusStockImages-e?.currentRequestImages;return isNaN(t)?0:t}),[s,c]),g=(0,r.useCallback)((()=>{window.open("https://app.imageseo.com/plan/","\_blank")}),[]);return React.createElement(n.Animate,{type:c?"loading":""},(({className:r})=>React.createElement(n.Card,null,React.createElement(n.CardHeader,null,React.createElement("div",{className:"header-container"},React.createElement("div",{className:"header"},React.createElement("img",{className:"logo",src:i,alt:"logo"}),React.createElement(n.\_\_experimentalHeading,{align:"center"},e),React.createElement(n.ExternalLink,{className:"visit-website",href:"https://www.imageseo.com",target:"\_blank"},(0,o.\_\_)("Visit website","imageseo"))),React.createElement("div",null,m&&React.createElement("span",{className:"remaining-credits-info"},c?React.createElement(n.Spinner,null):sprintf((0,o.\_\_)("Remaining credits %d","imageseo"),d))),React.createElement("div",{className:"cta"},React.createElement("span",null,React.createElement(n.Button,{variant:"primary",onClick:g},(0,o.\_\_)("Buy more credits","imageseo")))))),React.createElement(n.CardBody,{className:r},t),React.createElement(n.CardFooter,null,React.createElement(n.\_\_experimentalText,null,""),a&&React.createElement(n.Button,{type:"submit",variant:"secondary"},(0,o.\_\_)("Save","imageseo"))))))},ue={a:{content:9,self:!1,type:105},address:{invalid:["h1","h2","h3","h4","h5","h6","address","article","aside","section","div","header","footer"],self:!1},audio:{children:["track","source"]},br:{type:9,void:!0},body:{content:127},button:{content:8,type:105},caption:{content:1,parent:["table"]},col:{parent:["colgroup"],void:!0},colgroup:{children:["col"],parent:["table"]},details:{children:["summary"],type:97},dd:{content:1,parent:["dl"]},dl:{children:["dt","dd"],type:1},dt:{content:1,invalid:["footer","header"],parent:["dl"]},figcaption:{content:1,parent:["figure"]},footer:{invalid:["footer","header"]},header:{invalid:["footer","header"]},hr:{type:1,void:!0},img:{void:!0},li:{content:1,parent:["ul","ol","menu"]},main:{self:!1},ol:{children:["li"],type:1},picture:{children:["source","img"],type:25},rb:{parent:["ruby","rtc"]},rp:{parent:["ruby","rtc"]},rt:{content:8,parent:["ruby","rtc"]},rtc:{content:8,parent:["ruby"]},ruby:{children:["rb","rp","rt","rtc"]},source:{parent:["audio","video","picture"],void:!0},summary:{content:8,parent:["details"]},table:{children:["caption","colgroup","thead","tbody","tfoot","tr"],type:1},tbody:{parent:["table"],children:["tr"]},td:{content:1,parent:["tr"]},tfoot:{parent:["table"],children:["tr"]},th:{content:1,parent:["tr"]},thead:{parent:["table"],children:["tr"]},tr:{parent:["table","tbody","thead","tfoot"],children:["th","td"]},track:{parent:["audio","video"],void:!0},ul:{children:["li"],type:1},video:{children:["track","source"]},wbr:{type:9,void:!0}};function me(e){return t=>{ue[t]={...e,...ue[t]}}}["address","main","div","figure","p","pre"].forEach(me({content:1,type:65})),["abbr","b","bdi","bdo","cite","code","data","dfn","em","i","kbd","mark","q","ruby","samp","strong","sub","sup","time","u","var"].forEach(me({content:8,type:73})),["p","pre"].forEach(me({content:8,type:65})),["s","small","span","del","ins"].forEach(me({content:8,type:9})),["article","aside","footer","header","nav","section","blockquote"].forEach(me({content:1,type:67})),["h1","h2","h3","h4","h5","h6"].forEach(me({content:8,type:69})),["audio","canvas","iframe","img","video"].forEach(me({type:89}));const de=Object.freeze(ue),ge=["applet","base","body","command","embed","frame","frameset","head","html","link","meta","noscript","object","script","style","title"],pe=Object.keys(de).filter((e=>"canvas"!==e&&"iframe"!==e)),he=Object.freeze({alt:1,cite:1,class:1,colspan:3,controls:4,datetime:1,default:4,disabled:4,dir:1,height:1,href:1,id:1,kind:1,label:1,lang:1,loading:1,loop:4,media:1,muted:4,poster:1,rel:1,role:1,rowspan:3,scope:1,sizes:1,span:3,start:3,style:5,src:1,srclang:1,srcset:1,tabindex:1,target:1,title:1,type:1,width:1}),fe=Object.freeze({class:"className",colspan:"colSpan",datetime:"dateTime",rowspan:"rowSpan",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex"});function \_e(){return \_e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},\_e.apply(this,arguments)}function ve({attributes:e={},className:a,children:n=null,selfClose:r=!1,tagName:i}){const o=i;return r?t().createElement(o,\_e({className:a},e)):t().createElement(o,\_e({className:a},e),n)}class ye{attribute(e,t){return t}node(e,t){return t}}var be=a(580),Ee=a.n(be);function Re(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const we=/(url|image|image-set)\(/i;class Se extends ye{attribute(e,t){return"style"===e&&Object.keys(t).forEach((e=>{String(t[e]).match(we)&&delete t[e]})),t}}const Ce=/^<(!doctype|(html|head|body)(\s|>))/i,Te=/^(aria-|data-|\w+:)/iu,xe=/{{{(\w+)\/?}}}/;function ke(){if("undefined"!=typeof window&&"undefined"!=typeof document)return document.implementation.createHTMLDocument("Interweave")}class Ne{constructor(e,t={},a=[],n=[]){var r;Re(this,"allowed",void 0),Re(this,"banned",void 0),Re(this,"blocked",void 0),Re(this,"container",void 0),Re(this,"content",[]),Re(this,"props",void 0),Re(this,"matchers",void 0),Re(this,"filters",void 0),Re(this,"keyIndex",void 0),this.props=t,this.matchers=a,this.filters=[...n,new Se],this.keyIndex=-1,this.container=this.createContainer(e||""),this.allowed=new Set(null!==(r=t.allowList)&&void 0!==r?r:pe),this.banned=new Set(ge),this.blocked=new Set(t.blockList)}applyAttributeFilters(e,t){return this.filters.reduce(((t,a)=>null!==t&&"function"==typeof a.attribute?a.attribute(e,t):t),t)}applyNodeFilters(e,t){return this.filters.reduce(((t,a)=>null!==t&&"function"==typeof a.node?a.node(e,t):t),t)}applyMatchers(e,t){const a={},{props:n}=this;let r=e,i=0,o=null;return this.matchers.forEach((e=>{const l=e.asTag().toLowerCase(),s=this.getTagConfig(l);if(n[e.inverseName]||!this.isTagAllowed(l))return;if(!this.canRenderChild(t,s))return;let c="";for(;r&&(o=e.match(r));){const{index:t,length:l,match:s,valid:u,void:m,...d}=o,g=e.propName+String(i);t>0&&(c+=r.slice(0,t)),u?(c+=m?`{{{${g}/}}}`:`{{{${g}}}}${s}{{{/${g}}}}`,this.keyIndex+=1,i+=1,a[g]={children:s,matcher:e,props:{...n,...d,key:this.keyIndex}}):c+=s,e.greedy?(r=c+r.slice(t+l),c=""):r=r.slice(t+(l||s.length))}e.greedy||(r=c+r)})),0===i?e:this.replaceTokens(r,a)}canRenderChild(e,t){return!(!e.tagName||!t.tagName)&&!e.void&&(e.children.length>0?e.children.includes(t.tagName):!(e.invalid.length>0&&e.invalid.includes(t.tagName))&&(t.parent.length>0?t.parent.includes(e.tagName):!(!e.self&&e.tagName===t.tagName)&&Boolean(e&&e.content&t.type)))}convertLineBreaks(e){const{noHtml:t,disableLineBreaks:a}=this.props;if(t||a||e.match(/<((?:\/[ a-z]+)|(?:[ a-z]+\/))>/gi))return e;let n=e.replace(/\r\n/g,"\n");return n=n.replace(/\n{3,}/g,"\n\n\n"),n=n.replace(/\n/g,"<br/>"),n}createContainer(e){var t;const n=(void 0!==a.g&&a.g.INTERWEAVE\_SSR\_POLYFILL||ke)();if(!n)return;const r=null!==(t=this.props.containerTagName)&&void 0!==t?t:"body",i="body"===r||"fragment"===r?n.body:n.createElement(r);return e.match(Ce)||(i.innerHTML=this.convertLineBreaks(this.props.escapeHtml?Ee()(e):e)),i}extractAttributes(e){const{allowAttributes:t}=this.props,a={};let n=0;return 1===e.nodeType&&e.attributes?([...e.attributes].forEach((r=>{const{name:i,value:o}=r,l=i.toLowerCase(),s=he[l]||he[i];if(!this.isSafe(e))return;if(!l.match(Te)&&(!t&&(!s||2===s)||l.startsWith("on")||o.replace(/(\s|\0|&#x0([9AD]);)/,"").match(/(javascript|vbscript|livescript|xss):/i)))return;let c="style"===l?this.extractStyleAttribute(e):o;4===s?c=!0:3===s?c=Number.parseFloat(String(c)):5!==s&&(c=String(c)),a[fe[l]||l]=this.applyAttributeFilters(l,c),n+=1})),0===n?null:a):null}extractStyleAttribute(e){const t={};return Array.from(e.style).forEach((a=>{const n=e.style[a];"string"!=typeof n&&"number"!=typeof n||(t[a.replace(/-([a-z])/g,((e,t)=>String(t).toUpperCase()))]=n)})),t}getTagConfig(e){const t={children:[],content:0,invalid:[],parent:[],self:!0,tagName:"",type:0,void:!1};return de[e]?{...t,...de[e],tagName:e}:t}isSafe(e){if("undefined"!=typeof HTMLAnchorElement&&e instanceof HTMLAnchorElement){const t=e.getAttribute("href");if(null!=t&&t.startsWith("#"))return!0;const a=e.protocol.toLowerCase();return":"===a||"http:"===a||"https:"===a||"mailto:"===a||"tel:"===a}return!0}isTagAllowed(e){return!this.banned.has(e)&&!this.blocked.has(e)&&(this.props.allowElements||this.allowed.has(e))}parse(){return this.container?this.parseNode(this.container,this.getTagConfig(this.container.nodeName.toLowerCase())):[]}parseNode(e,a){const{noHtml:n,noHtmlExceptMatchers:r,allowElements:i,transform:o,transformOnlyAllowList:l}=this.props;let s=[],c="";return[...e.childNodes].forEach((e=>{if(1===e.nodeType){const m=e.nodeName.toLowerCase(),d=this.getTagConfig(m);c&&(s.push(c),c="");const g=this.applyNodeFilters(m,e);if(!g)return;let p;if(o&&(!l||this.isTagAllowed(m))){this.keyIndex+=1;const e=this.keyIndex;p=this.parseNode(g,d);const a=o(g,p,d);if(null===a)return;if(void 0!==a)return void s.push(t().cloneElement(a,{key:e}));this.keyIndex=e-1}if(this.banned.has(m))return;if(n||r&&"br"!==m||!this.isTagAllowed(m)||!i&&!this.canRenderChild(a,d))s=[...s,...this.parseNode(g,d.tagName?d:a)];else{var u;this.keyIndex+=1;const e=this.extractAttributes(g),a={tagName:m};e&&(a.attributes=e),d.void&&(a.selfClose=d.void),s.push(t().createElement(ve,{...a,key:this.keyIndex},null!==(u=p)&&void 0!==u?u:this.parseNode(g,d)))}}else if(3===e.nodeType){const t=n&&!r?e.textContent:this.applyMatchers(e.textContent||"",a);Array.isArray(t)?s=[...s,...t]:c+=t}})),c&&s.push(c),s}replaceTokens(e,t){if(!e.includes("{{{"))return e;const a=[];let n=e,r=null;for(;r=n.match(xe);){const[e,i]=r,o=r.index,l=e.includes("/");o>0&&(a.push(n.slice(0,o)),n=n.slice(o));const{children:s,matcher:c,props:u}=t[i];let m;if(l)m=e.length,a.push(c.createElement(s,u));else{const r=n.match(new RegExp(`{{{/${i}}}}`));m=r.index+r[0].length,a.push(c.createElement(this.replaceTokens(n.slice(e.length,r.index),t),u))}n=n.slice(m)}return n.length>0&&a.push(n),0===a.length?"":1===a.length&&"string"==typeof a[0]?a[0]:a}}function Oe(e){var a;const{attributes:n,className:r,containerTagName:i,content:o,emptyContent:l,parsedContent:s,tagName:c,noWrap:u}=e,m=null!==(a=null!=i?i:c)&&void 0!==a?a:"span",d="fragment"===m||u;let g;if(s)g=s;else{const t=new Ne(null!=o?o:"",e).parse();t.length>0&&(g=t)}return g||(g=l),d?t().createElement(t().Fragment,null,g):t().createElement(ve,{attributes:n,className:r,tagName:m},g)}const Le=()=>{const{options:e,global:t,setOptions:a,addNotice:i}=se(),[l,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(e?.allowed),[d,g]=(0,r.useState)(""),[p,h]=(0,r.useState)({firstName:t?.user?.firstName||"",lastName:t?.user?.lastName||"",email:t?.user?.email||"",password:"",terms:!1,news:!1}),f=async()=>{try{g(""),c(!0);const t=await s()({path:"/imageseo/v1/validate-api-key",method:"POST",data:{apiKey:e.apiKey}});if(void 0!==t?.data?.message)return a({allowed:!1}),g(t?.data?.message),c(!1),void i({status:"error",content:t?.data?.message});c(!1),a({allowed:!0}),i({status:"success",content:(0,o.\_\_)("API key validated","imageseo")})}catch(e){c(!1),i({status:"error",content:(0,o.\_\_)("Error validating API key","imageseo")}),console.error("Error validating API key:",e)}},\_=async()=>{try{c(!0);const e=await s()({path:"/imageseo/v1/register",method:"POST",data:p});if(Object.prototype.hasOwnProperty.call(e,"success")&&!e?.success)throw new Error(Array.isArray(e?.data?.message)?e?.data?.message.join(","):e?.data?.message);if(e?.message)throw i({status:"error",content:e?.message}),new Error("Something went wrong");a({apiKey:e?.projects?.[0]?.apiKey,allowed:!0},!1),i({status:"success",content:(0,o.\_\_)("Account created","imageseo")}),m(!0),c(!1)}catch(e){console.log(e),c(!1),i({status:"error",content:e.message}),console.error("Error registering account:",e)}},v=(e,t)=>{h({...p,[e]:t})};return React.createElement("div",{className:"welcome-screen"},React.createElement(n.\_\_experimentalHeading,{order:3,lineHeight:2,align:"center"},(0,o.\_\_)("Welcome to ImageSEO","imageseo")),React.createElement(n.\_\_experimentalText,{align:"center"},React.createElement(Oe,{content:sprintf((0,o.\_\_)("To get started with ImageSEO you will need your own API key. If you don't have an API key already, you should %s register an account %s to get one.","imageseo"),'<a href="https://app.imageseo.com/" target="\_blank">',"</a>")})),React.createElement(n.Animate,{type:l?"loading":""},(({className:t})=>React.createElement(React.Fragment,null,u?React.createElement("div",{className:`form-container ${t||""}`},React.createElement(n.TextControl,{label:(0,o.\_\_)("API Key","imageseo"),value:e?.apiKey||"",onChange:e=>a({apiKey:e})}),React.createElement(n.Flex,{justifyContent:"spaceBetween"},React.createElement(n.FlexItem,null,React.createElement(n.Button,{disabled:l,variant:"primary",onClick:f},l?(0,o.\_\_)("Validating…","imageseo"):(0,o.\_\_)("Validate key","imageseo"))),!e?.allowed&&React.createElement(n.FlexItem,null,React.createElement(n.Button,{variant:"secondary",onClick:()=>m(!1)},(0,o.\_\_)("I want to register for a free account","imageseo"))),e?.allowed&&React.createElement(n.FlexItem,null,React.createElement(n.Icon,{icon:"yes",style:{color:"#52c41a"}}),React.createElement(n.\_\_experimentalText,{variant:"muted"},(0,o.\_\_)("API key validated","imageseo")))),d&&React.createElement(n.\_\_experimentalText,{variant:"error"},d)):React.createElement("div",{className:`form-container ${t||""}`},React.createElement(n.TextControl,{label:(0,o.\_\_)("First name","imageseo"),value:p.firstName,onChange:e=>v("firstName",e)}),React.createElement(n.TextControl,{label:(0,o.\_\_)("Last name","imageseo"),value:p.lastName,onChange:e=>v("lastName",e)}),React.createElement(n.TextControl,{label:(0,o.\_\_)("Email","imageseo"),type:"email",value:p.email,onChange:e=>v("email",e)}),React.createElement(n.TextControl,{type:"password",label:(0,o.\_\_)("Password","imageseo"),value:p.password,onChange:e=>v("password",e)}),React.createElement(n.CheckboxControl,{label:(0,o.\_\_)("I agree to the terms and conditions","imageseo"),help:React.createElement(n.\_\_experimentalText,{variant:"muted"},(0,o.\_\_)("By creating an account, you agree to our terms and conditions.","imageseo"),React.createElement(n.ExternalLink,{style:{marginLeft:5},href:"https://imageseo.io/terms-conditions/"},(0,o.\_\_)("Read more","imageseo"))),checked:p.terms,onChange:e=>v("terms",e)}),React.createElement(n.CheckboxControl,{label:(0,o.\_\_)("I want to receive news and updates","imageseo"),help:(0,o.\_\_)("You can unsubscribe at any time","imageseo"),checked:p.news,onChange:e=>v("news",e)}),React.createElement(n.Flex,null,React.createElement(n.FlexItem,null,React.createElement(n.Button,{variant:"primary",disabled:l,onClick:\_},(0,o.\_\_)("Create account","imageseo"))),React.createElement(n.FlexItem,null,React.createElement(n.Button,{variant:"secondary",disabled:l,onClick:()=>m(!0)},(0,o.\_\_)("I already have an account","imageseo")))))))))},Ie=({id:e,label:t,help:a,value:i,onChange:l})=>{const[s,c]=(0,r.useState)(i),u=()=>{const e=wp.media({title:(0,o.\_\_)("Select or Upload Media","imageseo"),button:{text:(0,o.\_\_)("Use this item","imageseo")},multiple:!1});e.on("select",(()=>{const t=e.state().get("selection").first().toJSON();c(t.url),l(t.url)})),e.open()};return React.createElement("div",{className:"media-uploader-container",onClick:u},React.createElement(n.BaseControl,{id:e,label:t,help:a,className:"media-uploader"},!s&&React.createElement(n.Button,{variant:"primary",onClick:u},(0,o.\_\_)("Select Image","imageseo")),s&&React.createElement("img",{src:s,alt:"Selected"})))},Me=()=>{const{options:e,setOptions:t}=se();return React.createElement("div",null,React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Subtitle","imageseo"),checked:e.socialMediaSettings?.visibilitySubTitle,onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,visibilitySubTitle:a}})},help:(0,o.\_\_)("Show the price product or author depending on the page ( Product price (WooCommerce only) )","imageseo")}),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Subtitle 2","imageseo"),checked:e.socialMediaSettings?.visibilitySubTitleTwo,onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,visibilitySubTitleTwo:a}})},help:(0,o.\_\_)("Show the reading time of an article or the number of reviews (WooCommerce only).","imageseo")}),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Stars rating","imageseo"),checked:e.socialMediaSettings?.visibilityRating,onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,visibilityRating:a}})},help:(0,o.\_\_)("Show the stars linked to a review of your product for example.","imageseo")}),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Author avatar","imageseo"),checked:e.socialMediaSettings?.visibilityAvatar,onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,visibilityAvatar:a}})},help:(0,o.\_\_)("Only used for post content.","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControl,{style:{width:300},value:e.socialMediaSettings?.layout||"CARD\_LEFT",label:(0,o.\_\_)("Layout","imageseo"),help:(0,o.\_\_)("Choose the layout of the social card.","imageseo"),onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,layout:a}})}},React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"CARD\_LEFT",label:(0,o.\_\_)("Card left","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"CARD\_RIGHT",label:(0,o.\_\_)("Card right","imageseo")})),React.createElement(n.\_\_experimentalToggleGroupControl,{value:e.socialMediaSettings?.textAlignment||"top",onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,textAlignment:a}})},label:(0,o.\_\_)("Text alignment","imageseo")},React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"top",label:(0,o.\_\_)("Top","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"center",label:(0,o.\_\_)("Center","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"bottom",label:(0,o.\_\_)("Bottom","imageseo")})),React.createElement(n.\_\_experimentalGrid,{columns:3},React.createElement(n.BaseControl,{id:"text-color",label:(0,o.\_\_)("Text color","imageseo")},React.createElement(n.ColorPicker,{defaultValue:e.socialMediaSettings?.textColor||"#000000",onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,textColor:a}})}})),React.createElement(n.BaseControl,{id:"background-color",label:(0,o.\_\_)("Background color","imageseo")},React.createElement(n.ColorPicker,{defaultValue:e.socialMediaSettings?.contentBackgroundColor||"#ffffff",onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,contentBackgroundColor:a}})}})),e.socialMediaSettings?.visibilityRating&&React.createElement(n.BaseControl,{id:"star-color",label:(0,o.\_\_)("Star color","imageseo")},React.createElement(n.ColorPicker,{defaultValue:e.socialMediaSettings?.starColor||"#F8CA00",onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,starColor:a}})}}))),React.createElement(Ie,{label:(0,o.\_\_)("Logo","imageseo"),value:e?.socialMediaSettings?.logoUrl,help:(0,o.\_\_)("Click to upload a logo","imageseo"),onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,logoUrl:a}})}}),React.createElement(n.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(Ie,{label:(0,o.\_\_)("Background image","imageseo"),value:e?.socialMediaSettings?.defaultBgImg,help:(0,o.\_\_)("Click to upload a background Image","imageseo"),onChange:a=>{t({...e,socialMediaSettings:{...e.socialMediaSettings,defaultBgImg:a}})}}))},Ae=a.p+"images/avatar-default.00d4ecf9.jpg",Pe=({color:e})=>React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:e||"rgb(248, 202, 0)",stroke:e||"rgb(248, 202, 0)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-star"},React.createElement("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})),Fe=()=>{const{options:e}=se(),t=e?.socialMediaSettings||{},{layout:a,defaultBgImg:r,logoUrl:i,textColor:l,visibilitySubTitle:s,visibilitySubTitleTwo:c,visibilityRating:u,visibilityAvatar:m,contentBackgroundColor:d,starColor:g}=t;return React.createElement("div",{className:"previewer"},"CARD\_LEFT"===a&&React.createElement("div",{className:"bg-image",style:{backgroundImage:`url(${r})`}}),React.createElement("div",{className:"content",style:{backgroundColor:d}},React.createElement("div",{className:"padded"},React.createElement("img",{src:i,alt:"logo",className:"logo"}),React.createElement(n.\_\_experimentalHeading,{level:2,lineHeight:1.5,style:{color:l}},(0,o.\_\_)("Lorem ipsum (post title)","imageseo")),s&&React.createElement(n.\_\_experimentalHeading,{level:3,lineHeight:1.5,style:{color:l}},(0,o.\_\_)("Lorem ipsum (sub title)","imageseo")),c&&React.createElement(n.\_\_experimentalHeading,{level:4,lineHeight:1.5,style:{color:l}},(0,o.\_\_)("Lorem ipsum (sub title two)","imageseo")),m&&React.createElement("img",{src:Ae,alt:"default avatar",className:"avatar"}),u&&React.createElement("div",null,React.createElement(Pe,{color:g}),React.createElement(Pe,{color:g}),React.createElement(Pe,{color:g}),React.createElement(Pe,{color:g}),React.createElement(Pe,{color:g})))),"CARD\_RIGHT"===a&&React.createElement("div",{className:"bg-image",style:{backgroundImage:`url(${r})`}}))},ze=()=>{const{loading:e}=se();return React.createElement(n.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""} social-card-screen`},React.createElement(Me,null),React.createElement(Fe,null))))},Be=()=>{const[e,t]=(0,r.useState)(!0),{data:a,error:n,isLoading:i,mutate:o}=ee("/imageseo/v1/image-query",c,{onError:()=>{t(!1)},onSuccess:()=>{t(!1)},revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1});return{data:a,error:n,isLoading:e,isFetching:i,mutate:o}},De=()=>{const{options:e,setOptions:t,global:a}=se(),{mutate:r}=Be();return React.createElement("div",{className:"form"},React.createElement(n.SelectControl,{label:(0,o.\_\_)("Images to optimize","imageseo"),value:e?.altFilter||"ALL",onChange:e=>{t({altFilter:e}),r()},options:(a.altSpecification||[]).map((e=>({value:e.id,label:e.label})))}),React.createElement(n.SelectControl,{label:(0,o.\_\_)("Optimize alt text","imageseo"),value:e?.altFill||"FILL\_ALL",onChange:e=>{t({altFill:e}),r()},options:[{value:"FILL\_ALL",label:(0,o.\_\_)("Optimize all ALT texts","imageseo")},{value:"FILL\_ONLY\_EMPTY",label:(0,o.\_\_)("Optimize only missing ALT texts","imageseo")}]}),React.createElement(n.ToggleControl,{checked:e?.optimizeTitle,onChange:e=>{t({optimizeTitle:e})},label:(0,o.\_\_)("Optimize title","imageseo")}),React.createElement(n.ToggleControl,{checked:e?.optimizeCaption,onChange:e=>{t({optimizeCaption:e})},label:(0,o.\_\_)("Optimize caption","imageseo")}),React.createElement(n.ToggleControl,{checked:e?.optimizeFile,onChange:e=>{t({optimizeFile:e})},label:(0,o.\_\_)("Rename files","imageseo")}))},He=()=>{const[e,t]=(0,r.useState)(!0),{data:a,error:n,isLoading:i,mutate:o}=ee("/imageseo/v1/get-bulk-optimizer-status",c,{onError:()=>{t(!1)},onSuccess:()=>{t(!1)},refreshInterval:1e4});return{data:a,error:n,isLoading:e,isFetching:i,mutate:o}},$e=()=>{const{global:e,options:t,addNotice:a}=se(),{data:i,isLoading:l,error:c,mutate:u}=He(),{data:m,mutate:d}=Be(),g=async()=>{await s()({path:"/imageseo/v1/start-bulk-optimizer",method:"POST"}),u(),a({status:"success",content:(0,o.\_\_)("Optimizer started","imageseo")})},p=(0,r.useMemo)((()=>i?.report?.errors?.length>0&&void 0!==i?.report?.errors?.find((e=>"You have reached the limit of images to optimize"===e.trim()))),[i?.report?.errors]);return l?React.createElement(n.Placeholder,{className:"optimizer",icon:"update",label:(0,o.\_\_)("Loading","imageseo"),instructions:(0,o.\_\_)("Loading…","imageseo")}):c?React.createElement(n.Placeholder,{className:"optimizer",icon:"warning",label:(0,o.\_\_)("Error","imageseo"),instructions:(0,o.\_\_)("An error occurred while fetching the optimizer status.","imageseo")}):"idle"===i?.status&&p?React.createElement("div",{className:"optimizer"},React.createElement(n.\_\_experimentalText,null,(0,o.\_\_)("You have reached the limit of images to optimize.","imageseo")),React.createElement(n.\_\_experimentalSpacer,{marginY:"5"}),React.createElement(n.Button,{variant:"primary",disabled:"running"===i?.status,onClick:g},(0,o.\_\_)("Try again","imageseo"))):React.createElement("div",{className:"optimizer"},"idle"===i?.status&&React.createElement(React.Fragment,null,"NEXTGEN\_GALLERY"===t?.altFilter&&React.createElement(n.\_\_experimentalText,null,(0,o.sprintf)((0,o.\_\_)("There are %1$s images in your NEXTGEN library and %2$s don't have an alternative text.","imageseo"),e.bulkQuery.ids.length||0,e.bulkQuery.nonOptimized.length||0)),"NEXTGEN\_GALLERY"!==t?.altFilter&&React.createElement(n.\_\_experimentalText,null,(0,o.sprintf)((0,o.\_\_)("There are %1$s images in your media library and %2$s don't have an alternative text.","imageseo"),m?.totalImages||0,m?.totalNoAlt||0)),React.createElement(n.\_\_experimentalSpacer,{marginY:"5"}),React.createElement(n.Button,{variant:"primary",disabled:"running"===i?.status,onClick:g},(0,o.\_\_)("Start optimization","imageseo"))),"running"===i?.status&&React.createElement("div",{className:"progress"},React.createElement(n.\_\_experimentalText,null,(0,o.sprintf)((0,o.\_\_)("Optimizing %1$s images. ( %2$s/%3$s )","imageseo"),i?.report?.total,i?.report?.optimized,i?.report?.total)),React.createElement("progress",{value:i?.report?.optimized/i?.report?.total\*100,max:100}),React.createElement(n.\_\_experimentalSpacer,{marginY:"3"}),React.createElement(n.Button,{variant:"primary",onClick:async()=>{await s()({path:"/imageseo/v1/stop-bulk-optimizer",method:"POST"}),u(),d(),a({status:"success",content:(0,o.\_\_)("Optimizer stopped","imageseo")})}},(0,o.\_\_)("Stop optimizer","imageseo"))))},je=()=>{const{loading:e}=se(),{data:t}=He();return React.createElement(n.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""}`},React.createElement(n.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(n.\_\_experimentalHeading,{level:4},"running"===t?.status?(0,o.\_\_)("Current report","imageseo"):(0,o.\_\_)("Last report","imageseo")),React.createElement(n.\_\_experimentalText,null,(0,o.\_\_)("Optimized: ","imageseo")," ",t?.report.optimized),React.createElement("br",null),React.createElement(n.\_\_experimentalText,null,(0,o.\_\_)("Skipped: ","imageseo")," ",t?.report.skipped),React.createElement("br",null),React.createElement(n.\_\_experimentalText,null,(0,o.\_\_)("Failed: ","imageseo")," ",t?.report.failed))))},Ve=()=>{const{loading:e}=se();return React.createElement(n.Animate,{type:e?"loading":""},(({className:e})=>React.createElement(React.Fragment,null,React.createElement("div",{className:`${e||""} bulk-optimizer-screen`},React.createElement(De,null),React.createElement($e,null)),React.createElement(je,null))))},Ge=()=>{const{options:e,global:t,setOptions:a}=se(),i=(0,r.useMemo)((()=>{const a=e?.defaultLanguageIa||t?.currentLanguage||"en";return a.includes("\_")?a.split("\_")[0]:a}),[t?.currentLanguage,e?.defaultLanguageIa]);return React.createElement("div",null,React.createElement(n.\_\_experimentalHeading,{level:4,lineHeight:2},(0,o.\_\_)("On-upload optimization","imageseo")),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Fill alt","imageseo"),help:(0,o.\_\_)("The plugin will automatically write an alternative to the images you will upload.","imageseo"),checked:e.activeAltWriteUpload,onChange:e=>a({activeAltWriteUpload:e})}),React.createElement(n.ToggleControl,{checked:e?.activeOptimizeTitle,onChange:e=>{a({activeOptimizeTitle:e})},help:(0,o.\_\_)("The plugin will automatically rewrite with SEO friendly content the title of the images you will upload.","imageseo"),label:(0,o.\_\_)("Optimize title","imageseo")}),React.createElement(n.ToggleControl,{checked:e?.activeOptimizeCaption,onChange:e=>{a({activeOptimizeCaption:e})},help:(0,o.\_\_)("The plugin will automatically rewrite with SEO friendly content the caption of the images you will upload.","imageseo"),label:(0,o.\_\_)("Optimize caption","imageseo")}),React.createElement(n.ToggleControl,{label:(0,o.\_\_)("Rename files","imageseo"),help:(0,o.\_\_)("The plugin will automatically rewrite with SEO friendly content the name of the images you will upload.","imageseo"),checked:e.activeRenameWriteUpload,onChange:e=>a({activeRenameWriteUpload:e})}),React.createElement(n.SelectControl,{label:(0,o.\_\_)("Language","imageseo"),options:t.languages||[],onChange:e=>{a({defaultLanguageIa:e})},value:i}),React.createElement(n.\_\_experimentalDivider,{style:{marginTop:15,marginBottom:15}}),React.createElement(n.\_\_experimentalHeading,{level:4,lineHeight:2},(0,o.\_\_)("Social media card generator","imageseo")),React.createElement(n.\_\_experimentalText,{style:{marginBottom:15,display:"inline-block"}},(0,o.\_\_)("Automatic generation for the following post types:","imageseo")),t?.allowedPostTypes?.map((t=>React.createElement("div",{key:t.value,style:{maxWidth:300}},React.createElement(n.ToggleControl,{\_\_nextHasNoMarginBottom:!0,checked:(e?.socialMediaPostTypes||[]).includes(t.value),label:t.label,onChange:n=>((t,n)=>{n&&!(e?.socialMediaPostTypes||[]).includes(t)&&a({socialMediaPostTypes:[...e?.socialMediaPostTypes||[],t]}),!n&&(e?.socialMediaPostTypes||[]).includes(t)&&a({socialMediaPostTypes:(e?.socialMediaPostTypes||[]).filter((e=>e!==t))})})(t.value,n)})))))},We=()=>{const{loading:e}=se();return React.createElement(n.Animate,{type:e?"loading":""},(({className:e})=>React.createElement("div",{className:`${e||""} social-card-screen`},React.createElement(Ge,null))))},Ue=()=>{const[e,t]=(0,r.useState)(!1),{data:a,isLoading:i}=ee("/imageseo/v1/optimizer-errors",c,{refreshInterval:1e4}),{data:o,isLoading:l}=ee("/imageseo/v1/debug-info",c,{refreshInterval:1e4});return(0,r.useEffect)((()=>{localStorage.getItem("imageseo\_debug\_log")&&t(!0)}),[]),e?i?React.createElement(n.Spinner,null):React.createElement(React.Fragment,null,React.createElement("h4",null,"Error Log"),React.createElement("pre",null,JSON.stringify(a,null,2)),React.createElement("h4",null,"Debug Info"),React.createElement("pre",null,JSON.stringify(o,null,2))):null},Ke=new URLSearchParams(window.location.search).get("activeTab"),Ye=localStorage.getItem("imageseo\_debug\_log");function qe(){const{options:e,notices:t,removeNotice:a}=se(),[i,l]=(0,r.useState)(Ke||"welcome");return React.createElement(React.Fragment,null,React.createElement(ce,{heading:(0,o.\_\_)("ImageSEO","imageseo")},React.createElement(n.\_\_experimentalToggleGroupControl,{label:"",onChange:e=>{l(e);const t=new URL(window.location.href);t.searchParams.set("activeTab",e),window.history.replaceState(null,null,t)},value:i,isBlock:!0},React.createElement(n.\_\_experimentalToggleGroupControlOption,{type:"button",value:"welcome",label:(0,o.\_\_)("Welcome","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"socialcard",label:(0,o.\_\_)("Social card","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"bulkoptimizer",label:(0,o.\_\_)("Bulk optimization","imageseo")}),React.createElement(n.\_\_experimentalToggleGroupControlOption,{disabled:!e?.allowed||!1,type:"button",value:"settings",label:(0,o.\_\_)("Settings","imageseo")})),"welcome"===i&&React.createElement(Le,null),"socialcard"===i&&React.createElement(ze,null),"bulkoptimizer"===i&&React.createElement(Ve,null),"settings"===i&&React.createElement(We,null)),Ye&&React.createElement(Ue,null),React.createElement(n.SnackbarList,{notices:t,onRemove:a}))}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("imageseo-settings-v2");(0,r.createRoot)(e).render(React.createElement(le,null,React.createElement(qe,null)))}))})()})(); |
* ## [imageseo/trunk/imageseo.php](/changeset/3122915/imageseo/trunk/imageseo.php "Show the changeset 3122915 restricted to imageseo/trunk/imageseo.php")

  | [r3121409](/browser/imageseo/trunk/imageseo.php?rev=3121409#L6 "Show revision 3121409 of this file in browser") | [r3122915](/browser/imageseo/trunk/imageseo.php?rev=3122915#L6 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | \* Description:              Optimize your images for search engines. Search engine optimization and web marketing strategy often neglect their images. |
  | 7 | 7 | \* Author:                   WPChill |
  | 8 |  | \* Version:                  3.1.~~1~~ |
  |  | 8 | \* Version:                  3.1.2 |
  | 9 | 9 | \* Author URI:               https://www.wpchill.com/ |
  | 10 | 10 | \* License:                  GPLv3 or later |
  | […](/browser/imageseo/trunk/imageseo.php?rev=3121409#L12) | […](/browser/imageseo/trunk/imageseo.php?rev=3122915#L12) |  |
  | 12 | 12 | \* Requires PHP:             7.0 |
  | 13 | 13 | \* Text Domain:              imageseo |
  |  | 14 | \* Tested up to:             6.6 |
  | 14 | 15 | \* Domain Path:              /languages/ |
  | 15 |  | ~~\* Tested up to:             6.6~~ |
  | 16 | 16 | \* |
  | 17 | 17 | \* Copyright 2019-2023        WPUmbrella      aurelio@wp-umbrella.com |
  | […](/browser/imageseo/trunk/imageseo.php?rev=3121409#L55) | […](/browser/imageseo/trunk/imageseo.php?rev=3122915#L55) |  |
  | 55 | 55 | define( 'IMAGESEO\_SLUG', 'imageseo' ); |
  | 56 | 56 | define( 'IMAGESEO\_OPTION\_GROUP', 'group-imageseo' ); |
  | 57 |  | define( 'IMAGESEO\_VERSION', '3.1.~~1~~' ); |
  |  | 57 | define( 'IMAGESEO\_VERSION', '3.1.2' ); |
  | 58 | 58 | define( 'IMAGESEO\_PHP\_MIN', '7.4' ); |
  | 59 | 59 | define( 'IMAGESEO\_DEBUG', false ); |
* ## [imageseo/trunk/readme.txt](/changeset/3122915/imageseo/trunk/readme.txt "Show the changeset 3122915 restricted to imageseo/trunk/readme.txt")

  | [r3116447](/browser/imageseo/trunk/readme.txt?rev=3116447#L5 "Show revision 3116447 of this file in browser") | [r3122915](/browser/imageseo/trunk/readme.txt?rev=3122915#L5 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Tested up to: 6.6 |
  | 6 | 6 | Requires PHP: 7.4 |
  | 7 |  | Stable tag: 3.1.~~1~~ |
  |  | 7 | Stable tag: 3.1.2 |
  | 8 | 8 | License: GPLv3 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-3.0.html |
  | […](/browser/imageseo/trunk/readme.txt?rev=3116447#L126) | […](/browser/imageseo/trunk/readme.txt?rev=3122915#L126) |  |
  | 126 | 126 |  |
  | 127 | 127 | == Changelog == |
  |  | 128 | = 3.1.2 - 19.07.2024 = |
  |  | 129 | Added: Optimize image title |
  |  | 130 | Added: Optimize image caption |
  |  | 131 | Changed: UI Changes and wording |
  |  | 132 | Fixed: Vulnerability issue |
  |  | 133 |  |
  | 128 | 134 | = 3.1.1 - 8.07.2024 = |
  | 129 | 135 | Added: Filter to know when api key is validated |
* ## [imageseo/trunk/src/Actions/Admin/MediaLibrary.php](/changeset/3122915/imageseo/trunk/src/Actions/Admin/MediaLibrary.php "Show the changeset 3122915 restricted to imageseo/trunk/src/Actions/Admin/MediaLibrary.php")

  | [r3093706](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L5 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3122915#L5 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | use ImageSeoWP\Processes\OnUploadImage; |
  | 6 | 6 |  |
  | 7 |  | if (~~!defined('ABSPATH')~~) { |
  |  | 7 | if ( ! defined( 'ABSPATH' ) ) { |
  | 8 | 8 | exit; |
  | 9 | 9 | } |
  | 10 | 10 |  |
  | 11 |  | class MediaLibrary |
  | 12 |  | { |
  |  | 11 | class MediaLibrary { |
  |  | 12 |  |
  | 13 | 13 | public object $optionService; |
  | 14 | 14 | public object $reportImageService; |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L16) | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3122915#L16) |  |
  | 16 | 16 | public object $altService; |
  | 17 | 17 |  |
  | 18 |  | public function \_\_construct() |
  | 19 |  | { |
  | 20 |  | $this->optionService = imageseo\_get\_service('Option'); |
  | 21 |  | $this->reportImageService = imageseo\_get\_service('ReportImage'); |
  | 22 |  | $this->generateFilename = imageseo\_get\_service('GenerateFilename'); |
  | 23 |  | $this->altService = imageseo\_get\_service('Alt'); |
  |  | 18 | public function \_\_construct() { |
  |  | 19 | $this->optionService      = imageseo\_get\_service( 'Option' ); |
  |  | 20 | $this->reportImageService = imageseo\_get\_service( 'ReportImage' ); |
  |  | 21 | $this->generateFilename   = imageseo\_get\_service( 'GenerateFilename' ); |
  |  | 22 | $this->altService         = imageseo\_get\_service( 'Alt' ); |
  | 24 | 23 | } |
  | 25 | 24 |  |
  | 26 |  | public function hooks() |
  | 27 |  | { |
  | 28 |  | if (!imageseo\_allowed()) { |
  |  | 25 | public function hooks() { |
  |  | 26 | if ( ! imageseo\_allowed() ) { |
  | 29 | 27 | return; |
  | 30 | 28 | } |
  | 31 | 29 |  |
  | 32 |  | add\_filter(~~'manage\_media\_columns', [$this, 'manageMediaColumns']~~); |
  | 33 |  | add\_action(~~'manage\_media\_custom\_column', [$this, 'manageMediaCustomColumn'], 10, 2~~); |
  |  | 30 | add\_filter( 'manage\_media\_columns', array( $this, 'manageMediaColumns' ) ); |
  |  | 31 | add\_action( 'manage\_media\_custom\_column', array( $this, 'manageMediaCustomColumn' ), 10, 2 ); |
  | 34 | 32 |  |
  | 35 |  | add\_action(~~'wp\_ajax\_imageseo\_media\_alt\_update', [$this, 'ajaxAltUpdate']~~); |
  |  | 33 | add\_action( 'wp\_ajax\_imageseo\_media\_alt\_update', array( $this, 'ajaxAltUpdate' ) ); |
  | 36 | 34 |  |
  | 37 |  | add\_filter(~~'wp\_generate\_attachment\_metadata', [$this, 'createProcessOnUpload'], 10, 2~~); |
  | 38 |  | add\_action(~~'delete\_attachment', [$this, 'updateDeleteCount'], 100~~); |
  | 39 |  | add\_action(~~'admin\_enqueue\_scripts', [$this, 'enqueue\_scripts']~~); |
  |  | 35 | add\_filter( 'wp\_generate\_attachment\_metadata', array( $this, 'createProcessOnUpload' ), 10, 2 ); |
  |  | 36 | add\_action( 'delete\_attachment', array( $this, 'updateDeleteCount' ), 100 ); |
  |  | 37 | add\_action( 'admin\_enqueue\_scripts', array( $this, 'enqueue\_scripts' ) ); |
  | 40 | 38 | } |
  | 41 | 39 |  |
  | 42 |  | public function muteOnUpload() |
  | 43 |  | { |
  | 44 |  | remove\_filter('wp\_generate\_attachment\_metadata', [$this, 'createProcessOnUpload'], 10, 2); |
  |  | 40 | public function muteOnUpload() { |
  |  | 41 | remove\_filter( 'wp\_generate\_attachment\_metadata', array( $this, 'createProcessOnUpload' ), 10, 2 ); |
  | 45 | 42 | } |
  | 46 | 43 |  |
  | 47 |  | public function createProcessOnUpload($metadata, $attachmentId) |
  | 48 |  | { |
  | 49 |  | if (!wp\_attachment\_is\_image($attachmentId)) { |
  |  | 44 | public function createProcessOnUpload( $metadata, $attachmentId ) { |
  |  | 45 | if ( ! wp\_attachment\_is\_image( $attachmentId ) ) { |
  | 50 | 46 | return $metadata; |
  | 51 | 47 | } |
  | 52 | 48 |  |
  | 53 |  | $activeAltOnUpload = $this->optionService->getOption('activeAltWriteUpload'); |
  | 54 |  | $activeRenameOnUpload = $this->optionService->getOption('activeRenameWriteUpload'); |
  |  | 49 | $activeAltOnUpload     = $this->optionService->getOption( 'activeAltWriteUpload' ); |
  |  | 50 | $activeRenameOnUpload  = $this->optionService->getOption( 'activeRenameWriteUpload' ); |
  |  | 51 | $activeOptimizeTitle   = $this->optionService->getOption( 'activeOptimizeTitle' ); |
  |  | 52 | $activeOptimizeCaption = $this->optionService->getOption( 'activeOptimizeCaption' ); |
  | 55 | 53 |  |
  | 56 |  | $total = get\_option(~~'imageseo\_get\_total\_images'~~); |
  | 57 |  | if (~~$total~~) { |
  | 58 |  | update\_option(~~'imageseo\_get\_total\_images', (int) $total + 1, false~~); |
  |  | 54 | $total = get\_option( 'imageseo\_get\_total\_images' ); |
  |  | 55 | if ( $total ) { |
  |  | 56 | update\_option( 'imageseo\_get\_total\_images', (int) $total + 1, false ); |
  | 59 | 57 | } |
  | 60 | 58 |  |
  | 61 |  | if (~~!$activeAltOnUpload~~) { |
  | 62 |  | $total = get\_option(~~'imageseo\_get\_number\_image\_non\_optimize\_alt'~~); |
  | 63 |  | if (~~$total~~) { |
  | 64 |  | update\_option(~~'imageseo\_get\_number\_image\_non\_optimize\_alt', (int) $total + 1, false~~); |
  |  | 59 | if ( ! $activeAltOnUpload ) { |
  |  | 60 | $total = get\_option( 'imageseo\_get\_number\_image\_non\_optimize\_alt' ); |
  |  | 61 | if ( $total ) { |
  |  | 62 | update\_option( 'imageseo\_get\_number\_image\_non\_optimize\_alt', (int) $total + 1, false ); |
  | 65 | 63 | } |
  | 66 | 64 | } |
  | 67 | 65 |  |
  | 68 |  | if (~~!$activeAltOnUpload && !$activeRenameOnUpload~~) { |
  |  | 66 | if ( ! $activeAltOnUpload && ! $activeRenameOnUpload ) { |
  | 69 | 67 | return $metadata; |
  | 70 | 68 | } |
  | 71 | 69 |  |
  | 72 | 70 | $asyncRequest = OnUploadImage::getInstance(); |
  | 73 |  | $asyncRequest->data([ |
  | 74 |  | 'attachment\_id' => $attachmentId, |
  | 75 |  | 'active\_alt\_on\_upload' => $activeAltOnUpload, |
  | 76 |  | 'active\_rename\_on\_upload' => $activeRenameOnUpload, |
  | 77 |  | ]); |
  |  | 71 | $asyncRequest->data( |
  |  | 72 | array( |
  |  | 73 | 'attachmentId'            => $attachmentId, |
  |  | 74 | 'activeAltWriteUpload'    => $activeAltOnUpload, |
  |  | 75 | 'activeRenameWriteUpload' => $activeRenameOnUpload, |
  |  | 76 | 'activeOptimizeTitle'     => $activeOptimizeTitle, |
  |  | 77 | 'activeOptimizeCaption'   => $activeOptimizeCaption, |
  |  | 78 | ) |
  |  | 79 | ); |
  | 78 | 80 |  |
  | 79 | 81 | $asyncRequest->dispatch(); |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L84) | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3122915#L86) |  |
  | 84 | 86 | \* @param int $attachmentId |
  | 85 | 87 | \*/ |
  | 86 |  | public function updateDeleteCount(int $attachmentId) |
  | 87 |  | { |
  | 88 |  | if (!wp\_attachment\_is\_image($attachmentId)) { |
  |  | 88 | public function updateDeleteCount( int $attachmentId ) { |
  |  | 89 | if ( ! wp\_attachment\_is\_image( $attachmentId ) ) { |
  | 89 | 90 | return; |
  | 90 | 91 | } |
  | 91 | 92 |  |
  | 92 |  | $alt = $this->altService->getAlt(~~$attachmentId~~); |
  |  | 93 | $alt = $this->altService->getAlt( $attachmentId ); |
  | 93 | 94 |  |
  | 94 |  | $total = get\_option(~~'imageseo\_get\_number\_image\_non\_optimize\_alt'~~); |
  | 95 |  | if (~~$total~~) { |
  | 96 |  | update\_option(~~'imageseo\_get\_number\_image\_non\_optimize\_alt', (int) $total - 1, false~~); |
  |  | 95 | $total = get\_option( 'imageseo\_get\_number\_image\_non\_optimize\_alt' ); |
  |  | 96 | if ( $total ) { |
  |  | 97 | update\_option( 'imageseo\_get\_number\_image\_non\_optimize\_alt', (int) $total - 1, false ); |
  | 97 | 98 | } |
  | 98 | 99 |  |
  | 99 |  | $total = get\_option(~~'imageseo\_get\_total\_images'~~); |
  | 100 |  | if (~~$total~~) { |
  | 101 |  | update\_option(~~'imageseo\_get\_total\_images', (int) $total - 1, false~~); |
  |  | 100 | $total = get\_option( 'imageseo\_get\_total\_images' ); |
  |  | 101 | if ( $total ) { |
  |  | 102 | update\_option( 'imageseo\_get\_total\_images', (int) $total - 1, false ); |
  | 102 | 103 | } |
  | 103 | 104 | } |
  | 104 | 105 |  |
  | 105 |  | public function ajaxAltUpdate() |
  | 106 |  | { |
  | 107 |  | check\_ajax\_referer('imageseo\_upload\_nonce', '\_nonce'); |
  |  | 106 | public function ajaxAltUpdate() { |
  |  | 107 | check\_ajax\_referer( 'imageseo\_upload\_nonce', '\_nonce' ); |
  | 108 | 108 |  |
  | 109 |  | if (!current\_user\_can('manage\_options')) { |
  | 110 |  | wp\_send\_json\_error([ |
  | 111 |  | 'code' => 'not\_authorized', |
  | 112 |  | ]); |
  |  | 109 | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 110 | wp\_send\_json\_error( |
  |  | 111 | array( |
  |  | 112 | 'code' => 'not\_authorized', |
  |  | 113 | ) |
  |  | 114 | ); |
  | 113 | 115 | exit; |
  | 114 | 116 | } |
  | 115 | 117 |  |
  | 116 |  | $postId = absint(~~$\_POST['post\_id']~~); |
  | 117 |  | $alt ~~= wp\_strip\_all\_tags($\_POST['alt']~~); |
  |  | 118 | $postId = absint( $\_POST['post\_id'] ); |
  |  | 119 | $alt    = wp\_strip\_all\_tags( $\_POST['alt'] ); |
  | 118 | 120 |  |
  | 119 |  | imageseo\_get\_service(~~'Alt')->updateAlt($postId, $alt~~); |
  |  | 121 | imageseo\_get\_service( 'Alt' )->updateAlt( $postId, $alt ); |
  | 120 | 122 | } |
  | 121 | 123 |  |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L123) | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3122915#L125) |  |
  | 123 | 125 | \* Activate array. |
  | 124 | 126 | \*/ |
  | 125 |  | public function manageMediaColumns($columns) |
  | 126 |  | { |
  | 127 |  | $columns['imageseo\_alt'] = \_\_('Alt (imageseo)', 'imageseo'); |
  | 128 |  | $columns['imageseo\_filename'] = \_\_('Filename (imageseo)', 'imageseo'); |
  |  | 127 | public function manageMediaColumns( $columns ) { |
  |  | 128 | $columns['imageseo\_alt']      = \_\_( 'Alt (imageseo)', 'imageseo' ); |
  |  | 129 | $columns['imageseo\_filename'] = \_\_( 'Filename (imageseo)', 'imageseo' ); |
  | 129 | 130 |  |
  | 130 | 131 | return $columns; |
  | 131 | 132 | } |
  | 132 | 133 |  |
  | 133 |  | protected function renderAlt($attachmentId) |
  | 134 |  | { |
  | 135 |  | $alt = wp\_strip\_all\_tags($this->altService->getAlt($attachmentId)); ?> |
  | 136 |  | <div class="media-column-imageseo-alt" data-id="<?php echo absint($attachmentId); ?>" data-alt="<?php echo $alt; ?>"> |
  |  | 134 | protected function renderAlt( $attachmentId ) { |
  |  | 135 | $alt = wp\_strip\_all\_tags( $this->altService->getAlt( $attachmentId ) ); ?> |
  |  | 136 | <div class="media-column-imageseo-alt" data-id="<?php echo absint( $attachmentId ); ?>" data-alt="<?php echo $alt; ?>"> |
  | 137 | 137 | </div> |
  | 138 |  | <?php |
  |  | 138 | <?php |
  | 139 | 139 | } |
  | 140 | 140 |  |
  | 141 |  | public function renderFilename($attachmentId) |
  | 142 |  | { |
  | 143 |  | $filename = $this->generateFilename->getFilenameByAttachmentId($attachmentId); |
  | 144 |  | ?> |
  | 145 |  | <div class="media-column-imageseo-filename" data-id="<?php echo absint($attachmentId); ?>" data-filename="<?php echo esc\_html($filename); ?>"></div> |
  | 146 |  | <?php |
  |  | 141 | public function renderFilename( $attachmentId ) { |
  |  | 142 | $filename = $this->generateFilename->getFilenameByAttachmentId( $attachmentId ); |
  |  | 143 | ?> |
  |  | 144 | <div class="media-column-imageseo-filename" data-id="<?php echo absint( $attachmentId ); ?>" data-filename="<?php echo esc\_html( $filename ); ?>"></div> |
  |  | 145 | <?php |
  | 147 | 146 | } |
  | 148 | 147 |  |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L151) | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3122915#L150) |  |
  | 151 | 150 | \* @param $attachmentId |
  | 152 | 151 | \*/ |
  | 153 |  | public function manageMediaCustomColumn(string $columnName, $attachmentId) |
  | 154 |  | { |
  | 155 |  | switch ($columnName) { |
  |  | 152 | public function manageMediaCustomColumn( string $columnName, $attachmentId ) { |
  |  | 153 | switch ( $columnName ) { |
  | 156 | 154 | case 'imageseo\_alt': |
  | 157 |  | $this->renderAlt(~~$attachmentId~~); |
  |  | 155 | $this->renderAlt( $attachmentId ); |
  | 158 | 156 | break; |
  | 159 | 157 | case 'imageseo\_filename': |
  | 160 |  | $this->renderFilename(~~$attachmentId~~); |
  |  | 158 | $this->renderFilename( $attachmentId ); |
  | 161 | 159 | break; |
  | 162 | 160 | } |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L169) | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3122915#L167) |  |
  | 169 | 167 | \* @return void |
  | 170 | 168 | \*/ |
  | 171 |  | public function enqueue\_scripts($page) |
  | 172 |  | { |
  | 173 |  | if ($page !== 'upload.php') { |
  |  | 169 | public function enqueue\_scripts( $page ) { |
  |  | 170 | if ( $page !== 'upload.php' ) { |
  | 174 | 171 | return; |
  | 175 | 172 | } |
  | 176 | 173 |  |
  | 177 | 174 | $asset\_script\_path = IMAGESEO\_DIR\_DIST . '/adminv2/index.asset.php'; |
  | 178 |  | $asset\_file = require $asset\_script\_path; |
  |  | 175 | $asset\_file        = require $asset\_script\_path; |
  | 179 | 176 | wp\_enqueue\_media(); |
  | 180 | 177 | wp\_enqueue\_script( |
  | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3093706#L187) | […](/browser/imageseo/trunk/src/Actions/Admin/MediaLibrary.php?rev=3122915#L184) |  |
  | 187 | 184 | 'imageseo-admin-v2', |
  | 188 | 185 | IMAGESEO\_URL\_DIST . '/adminv2/index.css', |
  | 189 |  | ~~['wp-components']~~, |
  |  | 186 | array( 'wp-components' ), |
  | 190 | 187 | $asset\_file['version'] |
  | 191 | 188 | ); |
* ## [imageseo/trunk/src/Actions/RestApi.php](/changeset/3122915/imageseo/trunk/src/Actions/RestApi.php "Show the changeset 3122915 restricted to imageseo/trunk/src/Actions/RestApi.php")

  | [r3114144](/browser/imageseo/trunk/src/Actions/RestApi.php?rev=3114144#L358 "Show revision 3114144 of this file in browser") | [r3122915](/browser/imageseo/trunk/src/Actions/RestApi.php?rev=3122915#L358 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 358 | 358 | $options['activeRenameWriteUpload']    = (bool) $value; |
  | 359 | 359 | $options['active\_rename\_write\_upload'] = (bool) $value; |
  |  | 360 | break; |
  |  | 361 | case 'optimizeTitle': |
  |  | 362 | case 'optimizeCaption': |
  |  | 363 | case 'activeOptimizeTitle': |
  |  | 364 | case 'activeOptimizeCaption': |
  |  | 365 | $options[ $key ] = (bool) $value; |
  | 360 | 366 | break; |
  | 361 | 367 | case 'default\_language\_ia': |
* ## [imageseo/trunk/src/Admin/SettingsPage.php](/changeset/3122915/imageseo/trunk/src/Admin/SettingsPage.php "Show the changeset 3122915 restricted to imageseo/trunk/src/Admin/SettingsPage.php")

  | [r3093706](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L6 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3122915#L6 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | use ImageSeoWP\Helpers\Pages; |
  | 7 | 7 |  |
  | 8 |  | class SettingsPage |
  | 9 |  | { |
  |  | 8 | class SettingsPage { |
  |  | 9 |  |
  | 10 | 10 |  |
  | 11 | 11 | public static $instance; |
  | 12 | 12 |  |
  | 13 |  | public static function get\_instance(): SettingsPage |
  | 14 |  | { |
  |  | 13 | public static function get\_instance(): SettingsPage { |
  | 15 | 14 |  |
  | 16 |  | if (~~!isset(self::$instance) && !(self::$instance instanceof SettingsPage)~~) { |
  |  | 15 | if ( ! isset( self::$instance ) && ! ( self::$instance instanceof SettingsPage ) ) { |
  | 17 | 16 | self::$instance = new SettingsPage(); |
  | 18 | 17 | } |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L21) | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3122915#L20) |  |
  | 21 | 20 | } |
  | 22 | 21 |  |
  | 23 |  | private function \_\_construct() |
  | 24 |  | { |
  |  | 22 | private function \_\_construct() { |
  | 25 | 23 | $this->hooks(); |
  | 26 | 24 | } |
  | 27 | 25 |  |
  | 28 |  | private function hooks() |
  | 29 |  | { |
  | 30 |  | add\_action('admin\_menu', array($this, 'plugin\_menu')); |
  | 31 |  | add\_action('admin\_enqueue\_scripts', array($this, 'enqueue\_scripts')); |
  |  | 26 | private function hooks() { |
  |  | 27 | add\_action( 'admin\_menu', array( $this, 'plugin\_menu' ) ); |
  |  | 28 | add\_action( 'admin\_enqueue\_scripts', array( $this, 'enqueue\_scripts' ) ); |
  | 32 | 29 | } |
  | 33 | 30 |  |
  | 34 |  | public function plugin\_menu() |
  | 35 |  | { |
  |  | 31 | public function plugin\_menu() { |
  | 36 | 32 | add\_menu\_page( |
  | 37 | 33 | 'Image SEO', |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L39) | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3122915#L35) |  |
  | 39 | 35 | 'manage\_options', |
  | 40 | 36 | Pages::SETTINGS, |
  | 41 |  | ~~[~~ |
  |  | 37 | array( |
  | 42 | 38 | $this, |
  | 43 |  | 'imageseo\_settings' |
  | 44 |  | ~~]~~, |
  |  | 39 | 'imageseo\_settings', |
  |  | 40 | ), |
  | 45 | 41 | 'dashicons-imageseo-logo' |
  | 46 | 42 | ); |
  | 47 | 43 | } |
  | 48 | 44 |  |
  | 49 |  | public function imageseo\_settings() |
  | 50 |  | { |
  |  | 45 | public function imageseo\_settings() { |
  | 51 | 46 | echo '<div id="imageseo-settings-v2"></div>'; |
  | 52 | 47 | } |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L57) | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3122915#L52) |  |
  | 57 | 52 | \* @return string |
  | 58 | 53 | \*/ |
  | 59 |  | public static function get\_url() |
  | 60 |  | { |
  | 61 |  | return admin\_url('admin.php?page=imageseo-settings'); |
  |  | 54 | public static function get\_url() { |
  |  | 55 | return admin\_url( 'admin.php?page=imageseo-settings' ); |
  | 62 | 56 | } |
  | 63 | 57 |  |
  | 64 |  | public function enqueue\_scripts() |
  | 65 |  | { |
  | 66 |  | if (!isset($\_GET['page']) || $\_GET['page'] !== Pages::SETTINGS) { |
  |  | 58 | public function enqueue\_scripts() { |
  |  | 59 | if ( ! isset( $\_GET['page'] ) || $\_GET['page'] !== Pages::SETTINGS ) { |
  | 67 | 60 | return; |
  | 68 | 61 | } |
  | 69 | 62 |  |
  | 70 | 63 | try { |
  | 71 |  | $all\_post\_types     = imageseo\_get\_service(~~'WordPressData'~~)->getAllPostTypesSocialMedia(); |
  |  | 64 | $all\_post\_types     = imageseo\_get\_service( 'WordPressData' )->getAllPostTypesSocialMedia(); |
  | 72 | 65 | $allowed\_post\_types = array(); |
  | 73 |  | foreach (~~$all\_post\_types as $post\_type~~) { |
  | 74 |  | $allowed\_post\_types[] = ~~[~~ |
  |  | 66 | foreach ( $all\_post\_types as $post\_type ) { |
  |  | 67 | $allowed\_post\_types[] = array( |
  | 75 | 68 | 'value' => $post\_type->name, |
  | 76 |  | 'label' => $post\_type->label |
  | 77 |  | ~~]~~; |
  |  | 69 | 'label' => $post\_type->label, |
  |  | 70 | ); |
  | 78 | 71 | } |
  | 79 | 72 |  |
  | 80 |  | $language\_codes = imageseo\_get\_service(~~'ClientApi'~~)->getLanguages(); |
  |  | 73 | $language\_codes = imageseo\_get\_service( 'ClientApi' )->getLanguages(); |
  | 81 | 74 |  |
  | 82 |  | $totalImages = imageseo\_get\_service(~~'QueryImages'~~)->getTotalImages( |
  | 83 |  | ~~[~~ |
  | 84 |  | 'withCache'  => ~~fals~~e, |
  | 85 |  | 'forceQuery' => true |
  | 86 |  | ~~]~~ |
  |  | 75 | $totalImages = imageseo\_get\_service( 'QueryImages' )->getTotalImages( |
  |  | 76 | array( |
  |  | 77 | 'withCache'  => true, |
  |  | 78 | 'forceQuery' => true, |
  |  | 79 | ) |
  | 87 | 80 | ); |
  | 88 |  | $totalNoAlt  = imageseo\_get\_service(~~'QueryImages'~~)->getNumberImageNonOptimizeAlt( |
  | 89 |  | ~~[~~ |
  | 90 |  | 'withCache'  => ~~fals~~e, |
  | 91 |  | 'forceQuery' => true |
  | 92 |  | ~~]~~ |
  |  | 81 | $totalNoAlt  = imageseo\_get\_service( 'QueryImages' )->getNumberImageNonOptimizeAlt( |
  |  | 82 | array( |
  |  | 83 | 'withCache'  => true, |
  |  | 84 | 'forceQuery' => true, |
  |  | 85 | ) |
  | 93 | 86 | ); |
  | 94 | 87 |  |
  | 95 |  | $bulkQuery = imageseo\_get\_service(~~'BulkOptimizerQuery'~~)->getImages(); |
  |  | 88 | $bulkQuery = imageseo\_get\_service( 'BulkOptimizerQuery' )->getImages(); |
  | 96 | 89 |  |
  | 97 |  | $languages = ~~[]~~; |
  | 98 |  | foreach (~~$language\_codes as $language~~) { |
  | 99 |  | $languages[] = ~~[~~ |
  |  | 90 | $languages = array(); |
  |  | 91 | foreach ( $language\_codes as $language ) { |
  |  | 92 | $languages[] = array( |
  | 100 | 93 | 'value' => $language['code'], |
  | 101 |  | 'label' => $language['name'] |
  | 102 |  | ~~]~~; |
  |  | 94 | 'label' => $language['name'], |
  |  | 95 | ); |
  | 103 | 96 | } |
  | 104 | 97 |  |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L110) | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3122915#L103) |  |
  | 110 | 103 | 'email'     => '', |
  | 111 | 104 | 'firstName' => '', |
  | 112 |  | 'lastName'  => '' |
  |  | 105 | 'lastName'  => '', |
  | 113 | 106 | ); |
  | 114 | 107 |  |
  | 115 |  | if (~~in\_array('administrator', $current\_user->roles)~~) { |
  |  | 108 | if ( in\_array( 'administrator', $current\_user->roles ) ) { |
  | 116 | 109 | $user\_info['email']     = $current\_user->user\_email; |
  | 117 | 110 | $user\_info['firstName'] = $current\_user->user\_firstname; |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L119) | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3122915#L112) |  |
  | 119 | 112 | } |
  | 120 | 113 |  |
  | 121 |  | $camelCased = ~~[]~~; |
  |  | 114 | $camelCased = array(); |
  | 122 | 115 |  |
  | 123 |  | foreach (~~$options as $key => $value~~) { |
  | 124 |  | if (~~strpos($key, '\_') === -1~~) { |
  | 125 |  | $camelCased[~~$key~~] = $value; |
  |  | 116 | foreach ( $options as $key => $value ) { |
  |  | 117 | if ( strpos( $key, '\_' ) === -1 ) { |
  |  | 118 | $camelCased[ $key ] = $value; |
  | 126 | 119 | continue; |
  | 127 | 120 | } |
  | 128 | 121 |  |
  | 129 |  | $camelCaseKey                = lcfirst(~~str\_replace('\_', '', ucwords($key, '\_'))~~); |
  | 130 |  | $camelCased[~~$camelCaseKey~~] = $value; |
  |  | 122 | $camelCaseKey                = lcfirst( str\_replace( '\_', '', ucwords( $key, '\_' ) ) ); |
  |  | 123 | $camelCased[ $camelCaseKey ] = $value; |
  | 131 | 124 | } |
  | 132 | 125 |  |
  | 133 | 126 | $camelCased['user'] = $user\_info; |
  | 134 | 127 |  |
  | 135 |  | $global = ~~[~~ |
  |  | 128 | $global = array( |
  | 136 | 129 | 'languages'        => $languages, |
  | 137 |  | 'nonce'            => wp\_create\_nonce(~~'wp\_rest'~~), |
  | 138 |  | 'apiUrl'           => get\_rest\_url(~~null, 'imageseo/v1'~~), |
  |  | 130 | 'nonce'            => wp\_create\_nonce( 'wp\_rest' ), |
  |  | 131 | 'apiUrl'           => get\_rest\_url( null, 'imageseo/v1' ), |
  | 139 | 132 | 'user'             => $user\_info, |
  | 140 | 133 | 'currentLanguage'  => $current\_language, |
  | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3093706#L144) | […](/browser/imageseo/trunk/src/Admin/SettingsPage.php?rev=3122915#L137) |  |
  | 144 | 137 | 'altSpecification' => AltSpecification::getMetas(), |
  | 145 | 138 | 'bulkQuery'        => $bulkQuery, |
  | 146 |  | ~~]~~; |
  |  | 139 | ); |
  | 147 | 140 | wp\_add\_inline\_script( |
  | 148 | 141 | 'imageseo-v2', |
  | 149 |  | 'const imageSeoGlobal = ' . json\_encode(~~$global~~), |
  |  | 142 | 'const imageSeoGlobal = ' . json\_encode( $global ), |
  | 150 | 143 | 'before' |
  | 151 | 144 | ); |
  | 152 | 145 | wp\_add\_inline\_script( |
  | 153 | 146 | 'imageseo-v2', |
  | 154 |  | 'const imageSeoSettings = ' . json\_encode(~~$camelCased~~), |
  |  | 147 | 'const imageSeoSettings = ' . json\_encode( $camelCased ), |
  | 155 | 148 | 'before' |
  | 156 | 149 | ); |
  | 157 |  | } catch (~~\Exception $e~~) { |
  |  | 150 | } catch ( \Exception $e ) { |
  | 158 | 151 | // Do nothing |
  | 159 | 152 | } |
* ## [imageseo/trunk/src/Processes/OnUploadImage.php](/changeset/3122915/imageseo/trunk/src/Processes/OnUploadImage.php "Show the changeset 3122915 restricted to imageseo/trunk/src/Processes/OnUploadImage.php")

  | [r3093706](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3093706#L8 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3122915#L8 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | use ImageSeoWP\Traits\ApiHandler; |
  | 9 | 9 |  |
  | 10 |  | if (~~!defined('ABSPATH')~~) { |
  |  | 10 | if ( ! defined( 'ABSPATH' ) ) { |
  | 11 | 11 | exit; |
  | 12 | 12 | } |
  | 13 | 13 |  |
  | 14 |  | class OnUploadImage extends WPAsyncRequest |
  | 15 |  | { |
  |  | 14 | class OnUploadImage extends WPAsyncRequest { |
  |  | 15 |  |
  | 16 | 16 | use ApiHandler; |
  | 17 | 17 |  |
  | […](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3093706#L21) | […](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3122915#L21) |  |
  | 21 | 21 | public static $instance; |
  | 22 | 22 |  |
  | 23 |  | public static function getInstance(): OnUploadImage |
  | 24 |  | { |
  | 25 |  | if (!isset(self::$instance) && !(self::$instance instanceof OnUploadImage)) { |
  |  | 23 | public static function getInstance(): OnUploadImage { |
  |  | 24 | if ( ! isset( self::$instance ) && ! ( self::$instance instanceof OnUploadImage ) ) { |
  | 26 | 25 | self::$instance = new OnUploadImage(); |
  | 27 | 26 | } |
  | […](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3093706#L30) | […](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3122915#L29) |  |
  | 30 | 29 | } |
  | 31 | 30 |  |
  | 32 |  | protected function handle() |
  | 33 |  | { |
  |  | 31 | protected function handle() { |
  | 34 | 32 | $this->setServices(); |
  | 35 | 33 |  |
  | 36 |  | if (~~imageseo\_get\_service('UserInfo')->hasLimitExcedeed()~~) { |
  |  | 34 | if ( imageseo\_get\_service( 'UserInfo' )->hasLimitExcedeed() ) { |
  | 37 | 35 | return; |
  | 38 | 36 | } |
  | 39 | 37 |  |
  | 40 |  | $attachmentId = $\_POST['attachment\_id']; |
  | 41 |  | $fillAlt      = $\_POST['active\_alt\_on\_upload']; |
  | 42 |  | $renameFile   = $\_POST['active\_rename\_on\_upload']; |
  |  | 38 | $attachmentId     = $\_POST['attachmentId']; |
  |  | 39 | $optimizeAlt      = $\_POST['activeAltWriteUpload']; |
  |  | 40 | $optimizeFilename = $\_POST['activeRenameWriteUpload']; |
  |  | 41 | $optimizeTitle    = $\_POST['activeOptimizeTitle']; |
  |  | 42 | $optimizeCaption  = $\_POST['activeOptimizeCaption']; |
  | 43 | 43 |  |
  | 44 |  | if (~~empty($attachmentId)~~) { |
  |  | 44 | if ( empty( $attachmentId ) ) { |
  | 45 | 45 | return; |
  | 46 | 46 | } |
  | 47 | 47 |  |
  | 48 |  | if (empty($fillAlt) && empty($renameFile)) { |
  |  | 48 | if ( empty( $optimizeAlt ) |
  |  | 49 | && empty( $optimizeFilename ) |
  |  | 50 | && empty( $optimizeTitle ) |
  |  | 51 | && empty( $optimizeCaption ) |
  |  | 52 | ) { |
  | 49 | 53 | return; |
  | 50 | 54 | } |
  | 51 | 55 |  |
  | 52 |  | $extension = $this->generateFilename->getExtensionFilenameByAttachmentId(~~$attachmentId~~); |
  | 53 |  | if (~~!in\_array($extension, ['png', 'jpg', 'jpeg'])~~) { |
  |  | 56 | $extension = $this->generateFilename->getExtensionFilenameByAttachmentId( $attachmentId ); |
  |  | 57 | if ( ! in\_array( $extension, array( 'png', 'jpg', 'jpeg' ) ) ) { |
  | 54 | 58 | return; |
  | 55 | 59 | } |
  | 56 | 60 |  |
  | 57 |  | $images = ~~[~~ |
  | 58 |  | $this->createApiImage(~~$attachmentId)~~ |
  | 59 |  | ~~]~~; |
  |  | 61 | $images = array( |
  |  | 62 | $this->createApiImage( $attachmentId ), |
  |  | 63 | ); |
  | 60 | 64 |  |
  | 61 |  | $response = $this->sendRequestToApi(~~$images, true~~); |
  |  | 65 | $response = $this->sendRequestToApi( $images, true ); |
  | 62 | 66 |  |
  | 63 |  | if (~~$response instanceof Exception~~) { |
  | 64 |  | error\_log(~~$response->getMessage()~~); |
  |  | 67 | if ( $response instanceof Exception ) { |
  |  | 68 | error\_log( $response->getMessage() ); |
  | 65 | 69 |  |
  | 66 | 70 | return; |
  | 67 | 71 | } |
  | 68 | 72 |  |
  | 69 |  | if (~~!isset($response['batchId'])~~) { |
  |  | 73 | if ( ! isset( $response['batchId'] ) ) { |
  | 70 | 74 | return; |
  | 71 | 75 | } |
  | 72 | 76 |  |
  | 73 | 77 | $batchId = $response['batchId']; |
  | 74 |  | $items   = $this->getItemsByBatchId(~~$batchId~~); |
  | 75 |  | if (~~$items instanceof Exception~~) { |
  | 76 |  | error\_log(~~$items->getMessage()~~); |
  |  | 78 | $items   = $this->getItemsByBatchId( $batchId ); |
  |  | 79 | if ( $items instanceof Exception ) { |
  |  | 80 | error\_log( $items->getMessage() ); |
  | 77 | 81 |  |
  | 78 | 82 | return; |
  | […](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3093706#L82) | […](/browser/imageseo/trunk/src/Processes/OnUploadImage.php?rev=3122915#L86) |  |
  | 82 | 86 | $attachmentId = $image['internalId']; |
  | 83 | 87 |  |
  | 84 |  | if (~~$fillAlt~~) { |
  | 85 |  | $this->altService->updateAlt(~~$image['internalId'], $image['altText']~~); |
  |  | 88 | if ( $optimizeAlt ) { |
  |  | 89 | $this->altService->updateAlt( $image['internalId'], $image['altText'] ); |
  | 86 | 90 | } |
  | 87 | 91 |  |
  | 88 |  | if (~~$renameFile~~) { |
  | 89 |  | $extension = $this->generateFilename->getExtensionFilenameByAttachmentId(~~$attachmentId~~); |
  |  | 92 | if ( $optimizeFilename ) { |
  |  | 93 | $extension = $this->generateFilename->getExtensionFilenameByAttachmentId( $attachmentId ); |
  | 90 | 94 | $this->fileService->updateFilename( |
  | 91 | 95 | $image['internalId'], |
  | 92 |  | sprintf(~~'%s.%s', $image['filename'], $extension~~) |
  |  | 96 | sprintf( '%s.%s', $image['filename'], $extension ) |
  | 93 | 97 | ); |
  | 94 | 98 | } |
  | 95 | 99 |  |
  | 96 |  | update\_post\_meta($attachmentId, AttachmentMeta::REPORT, $image); |
  |  | 100 | if ( $optimizeTitle && |
  |  | 101 | isset( $image['title'] ) && |
  |  | 102 | ! empty( $image['title'] ) |
  |  | 103 | ) { |
  |  | 104 | $post\_data = array( |
  |  | 105 | 'ID'         => $attachmentId, |
  |  | 106 | 'post\_title' => $image['title'], |
  |  | 107 | ); |
  |  | 108 |  |
  |  | 109 | wp\_update\_post( $post\_data ); |
  |  | 110 | } |
  |  | 111 |  |
  |  | 112 | if ( $optimizeCaption && |
  |  | 113 | isset( $image['caption'] ) && |
  |  | 114 | ! empty( $image['caption'] ) ) { |
  |  | 115 | $post\_data = array( |
  |  | 116 | 'ID'           => $attachmentId, |
  |  | 117 | 'post\_excerpt' => $image['caption'], |
  |  | 118 | ); |
  |  | 119 |  |
  |  | 120 | wp\_update\_post( $post\_data ); |
  |  | 121 | } |
  |  | 122 |  |
  |  | 123 | update\_post\_meta( $attachmentId, AttachmentMeta::REPORT, $image ); |
  | 97 | 124 | } |
  | 98 | 125 | } |
* ## [imageseo/trunk/src/Services/BulkOptimizer.php](/changeset/3122915/imageseo/trunk/src/Services/BulkOptimizer.php "Show the changeset 3122915 restricted to imageseo/trunk/src/Services/BulkOptimizer.php")

  | [r3093706](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3093706#L333 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3122915#L333 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 333 | 333 | $failed           = array(); |
  | 334 | 334 |  |
  |  | 335 | $actions = array( |
  |  | 336 | 'alt'      => $this->optionService->getOption( 'altFill' ), |
  |  | 337 | 'filename' => $this->optionService->getOption( 'optimizeFile' ), |
  |  | 338 | 'title'    => $this->optionService->getOption( 'optimizeTitle' ), |
  |  | 339 | 'caption'  => $this->optionService->getOption( 'optimizeCaption' ), |
  |  | 340 | ); |
  |  | 341 |  |
  | 335 | 342 | $report = get\_option( 'imageseo\_bulk\_optimizer\_last\_report' ); |
  | 336 | 343 | foreach ( $batchData as $image ) { |
  | 337 | 344 | if ( $image['resolved'] ) { |
  | 338 |  | $this->handleResolvedImage( $image, $isNextGen, $~~optimizeFilename~~, $optimized ); |
  |  | 345 | $this->handleResolvedImage( $image, $isNextGen, $actions, $optimized ); |
  | 339 | 346 | continue; |
  | 340 | 347 | } |
  | […](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3093706#L366) | […](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3122915#L373) |  |
  | 366 | 373 | } |
  | 367 | 374 |  |
  | 368 |  | private function handleResolvedImage( $image, $isNextGen, $~~optimizeFilename~~, &$optimized ) { |
  |  | 375 | private function handleResolvedImage( $image, $isNextGen, $actions, &$optimized ) { |
  | 369 | 376 | $attachmentId = $isNextGen |
  | 370 | 377 | ? imageseo\_get\_service( 'QueryNextGen' )->getPostIdByNextGenId( $image['internalId'] ) : $image['internalId']; |
  | […](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3093706#L397) | […](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3122915#L404) |  |
  | 397 | 404 | } |
  | 398 | 405 |  |
  | 399 |  | if ( ~~$optimizeFilename~~ && ! $skipFilename ) { |
  |  | 406 | if ( in\_array( 'filename', $actions ) && ! $skipFilename ) { |
  | 400 | 407 | $extension = $this->extractExtension( $image['imageUrl'] ); |
  | 401 | 408 |  |
  | […](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3093706#L412) | […](/browser/imageseo/trunk/src/Services/BulkOptimizer.php?rev=3122915#L419) |  |
  | 412 | 419 | } |
  | 413 | 420 |  |
  |  | 421 | if ( in\_array( 'title', $actions ) && |
  |  | 422 | isset( $image['title'] ) && |
  |  | 423 | ! empty( $image['title'] ) |
  |  | 424 | ) { |
  |  | 425 | $post\_data = array( |
  |  | 426 | 'ID'         => $attachmentId, |
  |  | 427 | 'post\_title' => $image['title'], |
  |  | 428 | ); |
  |  | 429 |  |
  |  | 430 | wp\_update\_post( $post\_data ); |
  |  | 431 | } |
  |  | 432 |  |
  |  | 433 | if ( in\_array( 'caption', $actions ) && |
  |  | 434 | isset( $image['caption'] ) && |
  |  | 435 | ! empty( $image['caption'] ) ) { |
  |  | 436 | $post\_data = array( |
  |  | 437 | 'ID'           => $attachmentId, |
  |  | 438 | 'post\_excerpt' => $image['caption'], |
  |  | 439 | ); |
  |  | 440 |  |
  |  | 441 | wp\_update\_post( $post\_data ); |
  |  | 442 | } |
  |  | 443 |  |
  | 414 | 444 | $optimized[] = $image['internalId']; |
  | 415 | 445 | } |
* ## [imageseo/trunk/src/Services/Option.php](/changeset/3122915/imageseo/trunk/src/Services/Option.php "Show the changeset 3122915 restricted to imageseo/trunk/src/Services/Option.php")

  | [r3093706](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L3 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915#L3 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | namespace ImageSeoWP\Services; |
  | 4 | 4 |  |
  | 5 |  | if (~~!defined('ABSPATH')~~) { |
  |  | 5 | if ( ! defined( 'ABSPATH' ) ) { |
  | 6 | 6 | exit; |
  | 7 | 7 | } |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L9) | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915#L9) |  |
  | 9 | 9 | use ImageSeoWP\Helpers\SocialMedia; |
  | 10 | 10 |  |
  | 11 |  | class Option |
  | 12 |  | { |
  |  | 11 | class Option { |
  |  | 12 |  |
  | 13 | 13 | /\*\* |
  | 14 | 14 | \* @var array |
  | 15 | 15 | \*/ |
  | 16 |  | protected $optionsDefault = ~~[~~ |
  |  | 16 | protected $optionsDefault = array( |
  | 17 | 17 | 'api\_key'                    => '', |
  | 18 | 18 | 'allowed'                    => false, |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L21) | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915#L21) |  |
  | 21 | 21 | 'default\_language\_ia'        => IMAGESEO\_LOCALE, |
  | 22 | 22 | 'alt\_template\_default'       => '[keyword\_1] - [keyword\_2]', |
  | 23 |  | 'social\_media\_post\_types'    => ~~[~~ |
  |  | 23 | 'social\_media\_post\_types'    => array( |
  | 24 | 24 | 'post', |
  | 25 |  | ~~]~~, |
  | 26 |  | 'social\_media\_type'          => ~~[~~ |
  |  | 25 | ), |
  |  | 26 | 'social\_media\_type'          => array( |
  | 27 | 27 | SocialMedia::OPEN\_GRAPH['name'], |
  | 28 |  | ~~]~~, |
  | 29 |  | 'social\_media\_settings'      => ~~[~~ |
  |  | 28 | ), |
  |  | 29 | 'social\_media\_settings'      => array( |
  | 30 | 30 | 'layout'                 => 'CARD\_LEFT', |
  | 31 | 31 | 'textColor'              => '#000000', |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L38) | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915#L38) |  |
  | 38 | 38 | 'logoUrl'                => IMAGESEO\_URL\_DIST . '/images/favicon.png', |
  | 39 | 39 | 'defaultBgImg'           => IMAGESEO\_URL\_DIST . '/images/default\_logo.png', |
  | 40 |  | 'textAlignment'          => 'top' |
  | 41 |  | ~~]~~, |
  |  | 40 | 'textAlignment'          => 'top', |
  |  | 41 | ), |
  | 42 | 42 | 'altFilter'                  => 'ALL', |
  | 43 | 43 | 'altFill'                    => 'FILL\_ALL', |
  | 44 | 44 | 'optimizeAlt'                => 0, |
  | 45 | 45 | 'language'                   => IMAGESEO\_LOCALE, |
  | 46 |  | ]; |
  |  | 46 | 'optimizeTitle'              => false, |
  |  | 47 | 'optimizeCaption'            => false, |
  |  | 48 | 'activeOptimizeTitle'        => true, |
  |  | 49 | 'activeOptimizeCaption'      => true, |
  |  | 50 | ); |
  | 47 | 51 |  |
  | 48 | 52 | /\*\* |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L51) | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915#L55) |  |
  | 51 | 55 | \* @return array |
  | 52 | 56 | \*/ |
  | 53 |  | public function getOptionsDefault() |
  | 54 |  | { |
  | 55 |  | return $this->convert\_to\_camel\_case($this->optionsDefault); |
  |  | 57 | public function getOptionsDefault() { |
  |  | 58 | return $this->convert\_to\_camel\_case( $this->optionsDefault ); |
  | 56 | 59 | } |
  | 57 | 60 |  |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L59) | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915#L62) |  |
  | 59 | 62 | \* @return array |
  | 60 | 63 | \*/ |
  | 61 |  | public function getOptions() |
  | 62 |  | { |
  |  | 64 | public function getOptions() { |
  | 63 | 65 | return apply\_filters( |
  | 64 | 66 | 'imageseo\_get\_options', |
  | 65 |  | wp\_parse\_args(~~get\_option(IMAGESEO\_SLUG), $this->getOptionsDefault()~~) |
  |  | 67 | wp\_parse\_args( get\_option( IMAGESEO\_SLUG ), $this->getOptionsDefault() ) |
  | 66 | 68 | ); |
  | 67 | 69 | } |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L72) | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915#L74) |  |
  | 72 | 74 | \* @return array |
  | 73 | 75 | \*/ |
  | 74 |  | public function getOption($name) |
  | 75 |  | { |
  |  | 76 | public function getOption( $name ) { |
  | 76 | 77 | $options = $this->getOptions(); |
  | 77 |  | if (~~!array\_key\_exists($name, $options)~~) { |
  |  | 78 | if ( ! array\_key\_exists( $name, $options ) ) { |
  | 78 | 79 | return null; |
  | 79 | 80 | } |
  | 80 | 81 |  |
  | 81 |  | return apply\_filters(~~'imageseo\_' . $name . '\_option', $options[$name]~~); |
  |  | 82 | return apply\_filters( 'imageseo\_' . $name . '\_option', $options[ $name ] ); |
  | 82 | 83 | } |
  | 83 | 84 |  |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L87) | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915#L88) |  |
  | 87 | 88 | \* @return $this |
  | 88 | 89 | \*/ |
  | 89 |  | public function setOptions($options) |
  | 90 |  | { |
  | 91 |  | update\_option(IMAGESEO\_SLUG, $options); |
  |  | 90 | public function setOptions( $options ) { |
  |  | 91 | update\_option( IMAGESEO\_SLUG, $options ); |
  | 92 | 92 |  |
  | 93 | 93 | return $this; |
  | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3093706#L100) | […](/browser/imageseo/trunk/src/Services/Option.php?rev=3122915#L100) |  |
  | 100 | 100 | \* @return $this |
  | 101 | 101 | \*/ |
  | 102 |  | public function setOptionByKey($key, $value) |
  | 103 |  | { |
  | 104 |  | $options = $this->getOptions(); |
  | 105 |  | $options[$key] = $value; |
  | 106 |  | $this->setOptions($options); |
  |  | 102 | public function setOptionByKey( $key, $value ) { |
  |  | 103 | $options         = $this->getOptions(); |
  |  | 104 | $options[ $key ] = $value; |
  |  | 105 | $this->setOptions( $options ); |
  | 107 | 106 |  |
  | 108 | 107 | return $this; |
  | 109 | 108 | } |
  | 110 | 109 |  |
  | 111 |  | private function convert\_to\_camel\_case($options) |
  | 112 |  | { |
  | 113 |  | $camelCased = []; |
  |  | 110 | private function convert\_to\_camel\_case( $options ) { |
  |  | 111 | $camelCased = array(); |
  | 114 | 112 |  |
  | 115 |  | foreach (~~$options as $key => $value~~) { |
  | 116 |  | if (~~strpos($key, '\_') === -1~~) { |
  | 117 |  | $camelCased[~~$key~~] = $value; |
  |  | 113 | foreach ( $options as $key => $value ) { |
  |  | 114 | if ( strpos( $key, '\_' ) === -1 ) { |
  |  | 115 | $camelCased[ $key ] = $value; |
  | 118 | 116 | continue; |
  | 119 |  | }~~;~~ |
  |  | 117 | } |
  | 120 | 118 |  |
  | 121 |  | $camelCaseKey ~~= lcfirst(str\_replace('\_', '', ucwords($key, '\_'))~~); |
  | 122 |  | $camelCased[~~$camelCaseKey~~] = $value; |
  |  | 119 | $camelCaseKey                = lcfirst( str\_replace( '\_', '', ucwords( $key, '\_' ) ) ); |
  |  | 120 | $camelCased[ $camelCaseKey ] = $value; |
  | 123 | 121 | } |
  | 124 | 122 |  |
* ## [imageseo/trunk/src/Traits/Debug.php](/changeset/3122915/imageseo/trunk/src/Traits/Debug.php "Show the changeset 3122915 restricted to imageseo/trunk/src/Traits/Debug.php")

  | [r3093706](/browser/imageseo/trunk/src/Traits/Debug.php?rev=3093706#L3 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/src/Traits/Debug.php?rev=3122915#L3 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | namespace ImageSeoWP\Traits; |
  | 4 | 4 |  |
  | 5 |  | trait Debug |
  | 6 |  | { |
  | 7 |  | p~~ublic function resetDebug()~~ |
  | 8 |  | { |
  | 9 |  | update\_option(~~$this->debugOption, []~~); |
  |  | 5 | trait Debug { |
  |  | 6 |  |
  |  | 7 | private $debugLock = 'imageseo\_bulk\_optimizer\_debug\_lock'; |
  |  | 8 | public function resetDebug() { |
  |  | 9 | update\_option( $this->debugOption, array() ); |
  | 10 | 10 | } |
  | 11 | 11 |  |
  | 12 |  | public function getDebug() |
  | 13 |  | { |
  | 14 |  | return get\_option($this->debugOption, []); |
  |  | 12 | public function getDebug() { |
  |  | 13 | return get\_option( $this->debugOption, array() ); |
  | 15 | 14 | } |
  | 16 | 15 |  |
  | 17 |  | public function writeDebug($value) |
  | 18 |  | { |
  | 19 |  | $currentDebug = get\_option($this->debugOption, []); |
  | 20 |  | if ($this->debug) { |
  | 21 |  | if (is\_array($value)) |
  | 22 |  | update\_option($this->debugOption, array\_merge( |
  | 23 |  | $currentDebug, |
  | 24 |  | is\_array($value) ? $value : [$value] |
  | 25 |  | )); |
  |  | 16 | public function writeDebug( $value ) { |
  |  | 17 | while ( get\_transient( $this->debugLock ) ) { |
  |  | 18 | usleep( 1000 ); |
  | 26 | 19 | } |
  |  | 20 | set\_transient( $this->debugLock, true, 10 ); |
  |  | 21 |  |
  |  | 22 | $currentDebug = $this->getDebug(); |
  |  | 23 | if ( $this->debug ) { |
  |  | 24 | if ( is\_array( $value ) ) { |
  |  | 25 | update\_option( |
  |  | 26 | $this->debugOption, |
  |  | 27 | array\_merge( |
  |  | 28 | $currentDebug, |
  |  | 29 | $value |
  |  | 30 | ) |
  |  | 31 | ); |
  |  | 32 | } else { |
  |  | 33 | $currentDebug[] = $value; |
  |  | 34 | update\_option( $this->debugOption, $currentDebug ); |
  |  | 35 | } |
  |  | 36 | } |
  |  | 37 |  |
  |  | 38 | delete\_transient( $this->debugLock ); |
  | 27 | 39 | } |
  | 28 | 40 | } |
* ## [imageseo/trunk/vendor/autoload.php](/changeset/3122915/imageseo/trunk/vendor/autoload.php "Show the changeset 3122915 restricted to imageseo/trunk/vendor/autoload.php")

  | [r3011770](/browser/imageseo/trunk/vendor/autoload.php?rev=3011770#L4 "Show revision 3011770 of this file in browser") | [r3122915](/browser/imageseo/trunk/vendor/autoload.php?rev=3122915#L4 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 |  |
  | 5 | 5 | if (PHP\_VERSION\_ID < 50600) { |
  | 6 |  | echo 'Composer 2.3.0 dropped support for autoloading on PHP <5.6 and you are running '.PHP\_VERSION.', please upgrade PHP or use Composer 2.2 LTS via "composer self-update --2.2". Aborting.'.PHP\_EOL; |
  | 7 |  | exit(1); |
  |  | 6 | if (!headers\_sent()) { |
  |  | 7 | header('HTTP/1.1 500 Internal Server Error'); |
  |  | 8 | } |
  |  | 9 | $err = 'Composer 2.3.0 dropped support for autoloading on PHP <5.6 and you are running '.PHP\_VERSION.', please upgrade PHP or use Composer 2.2 LTS via "composer self-update --2.2". Aborting.'.PHP\_EOL; |
  |  | 10 | if (!ini\_get('display\_errors')) { |
  |  | 11 | if (PHP\_SAPI === 'cli' || PHP\_SAPI === 'phpdbg') { |
  |  | 12 | fwrite(STDERR, $err); |
  |  | 13 | } elseif (!headers\_sent()) { |
  |  | 14 | echo $err; |
  |  | 15 | } |
  |  | 16 | } |
  |  | 17 | trigger\_error( |
  |  | 18 | $err, |
  |  | 19 | E\_USER\_ERROR |
  |  | 20 | ); |
  | 8 | 21 | } |
  | 9 | 22 |  |
  | 10 | 23 | require\_once \_\_DIR\_\_ . '/composer/autoload\_real.php'; |
  | 11 | 24 |  |
  | 12 |  | return ComposerAutoloaderInit~~8aee80435795f097aba54ac01df0b70f~~::getLoader(); |
  |  | 25 | return ComposerAutoloaderInite97648f350088b8744107ebf06d18a01::getLoader(); |
* ## [imageseo/trunk/vendor/composer/ClassLoader.php](/changeset/3122915/imageseo/trunk/vendor/composer/ClassLoader.php "Show the changeset 3122915 restricted to imageseo/trunk/vendor/composer/ClassLoader.php")

  | [r2836500](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L43 "Show revision 2836500 of this file in browser") | [r3122915](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L43 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 43 | 43 | class ClassLoader |
  | 44 | 44 | { |
  | 45 |  | /\*\* @var ?string \*/ |
  |  | 45 | /\*\* @var \Closure(string):void \*/ |
  |  | 46 | private static $includeFile; |
  |  | 47 |  |
  |  | 48 | /\*\* @var string|null \*/ |
  | 46 | 49 | private $vendorDir; |
  | 47 | 50 |  |
  | 48 | 51 | // PSR-4 |
  | 49 | 52 | /\*\* |
  | 50 |  | \* @var array[] |
  | 51 |  | \* @psalm-var array<string, array<string, int>> |
  |  | 53 | \* @var array<string, array<string, int>> |
  | 52 | 54 | \*/ |
  | 53 | 55 | private $prefixLengthsPsr4 = array(); |
  | 54 | 56 | /\*\* |
  | 55 |  | \* @var array[] |
  | 56 |  | \* @psalm-var array<string, array<int, string>> |
  |  | 57 | \* @var array<string, list<string>> |
  | 57 | 58 | \*/ |
  | 58 | 59 | private $prefixDirsPsr4 = array(); |
  | 59 | 60 | /\*\* |
  | 60 |  | \* @var array[] |
  | 61 |  | \* @psalm-var array<string, string> |
  |  | 61 | \* @var list<string> |
  | 62 | 62 | \*/ |
  | 63 | 63 | private $fallbackDirsPsr4 = array(); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L65) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L65) |  |
  | 65 | 65 | // PSR-0 |
  | 66 | 66 | /\*\* |
  | 67 |  | \* @var array[] |
  | 68 |  | \* @psalm-var array<string, array<string, string[]>> |
  |  | 67 | \* List of PSR-0 prefixes |
  |  | 68 | \* |
  |  | 69 | \* Structured as array('F (first letter)' => array('Foo\Bar (full prefix)' => array('path', 'path2'))) |
  |  | 70 | \* |
  |  | 71 | \* @var array<string, array<string, list<string>>> |
  | 69 | 72 | \*/ |
  | 70 | 73 | private $prefixesPsr0 = array(); |
  | 71 | 74 | /\*\* |
  | 72 |  | \* @var array[] |
  | 73 |  | \* @psalm-var array<string, string> |
  |  | 75 | \* @var list<string> |
  | 74 | 76 | \*/ |
  | 75 | 77 | private $fallbackDirsPsr0 = array(); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L79) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L81) |  |
  | 79 | 81 |  |
  | 80 | 82 | /\*\* |
  | 81 |  | \* @var string[] |
  | 82 |  | \* @psalm-var array<string, string> |
  |  | 83 | \* @var array<string, string> |
  | 83 | 84 | \*/ |
  | 84 | 85 | private $classMap = array(); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L88) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L89) |  |
  | 88 | 89 |  |
  | 89 | 90 | /\*\* |
  | 90 |  | \* @var bool[] |
  | 91 |  | \* @psalm-var array<string, bool> |
  |  | 91 | \* @var array<string, bool> |
  | 92 | 92 | \*/ |
  | 93 | 93 | private $missingClasses = array(); |
  | 94 | 94 |  |
  | 95 |  | /\*\* @var ~~?string~~ \*/ |
  |  | 95 | /\*\* @var string|null \*/ |
  | 96 | 96 | private $apcuPrefix; |
  | 97 | 97 |  |
  | 98 | 98 | /\*\* |
  | 99 |  | \* @var ~~self[]~~ |
  |  | 99 | \* @var array<string, self> |
  | 100 | 100 | \*/ |
  | 101 | 101 | private static $registeredLoaders = array(); |
  | 102 | 102 |  |
  | 103 | 103 | /\*\* |
  | 104 |  | \* @param ~~?string~~ $vendorDir |
  |  | 104 | \* @param string|null $vendorDir |
  | 105 | 105 | \*/ |
  | 106 | 106 | public function \_\_construct($vendorDir = null) |
  | 107 | 107 | { |
  | 108 | 108 | $this->vendorDir = $vendorDir; |
  | 109 |  | } |
  | 110 |  |  |
  | 111 |  | /\*\* |
  | 112 |  | \* @return string[] |
  |  | 109 | self::initializeIncludeClosure(); |
  |  | 110 | } |
  |  | 111 |  |
  |  | 112 | /\*\* |
  |  | 113 | \* @return array<string, list<string>> |
  | 113 | 114 | \*/ |
  | 114 | 115 | public function getPrefixes() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L122) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L123) |  |
  | 122 | 123 |  |
  | 123 | 124 | /\*\* |
  | 124 |  | \* @return array[] |
  | 125 |  | \* @psalm-return array<string, array<int, string>> |
  |  | 125 | \* @return array<string, list<string>> |
  | 126 | 126 | \*/ |
  | 127 | 127 | public function getPrefixesPsr4() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L131) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L131) |  |
  | 131 | 131 |  |
  | 132 | 132 | /\*\* |
  | 133 |  | \* @return array[] |
  | 134 |  | \* @psalm-return array<string, string> |
  |  | 133 | \* @return list<string> |
  | 135 | 134 | \*/ |
  | 136 | 135 | public function getFallbackDirs() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L140) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L139) |  |
  | 140 | 139 |  |
  | 141 | 140 | /\*\* |
  | 142 |  | \* @return array[] |
  | 143 |  | \* @psalm-return array<string, string> |
  |  | 141 | \* @return list<string> |
  | 144 | 142 | \*/ |
  | 145 | 143 | public function getFallbackDirsPsr4() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L149) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L147) |  |
  | 149 | 147 |  |
  | 150 | 148 | /\*\* |
  | 151 |  | \* @return string[] Array of classname => path |
  | 152 |  | \* @psalm-return array<string, string> |
  |  | 149 | \* @return array<string, string> Array of classname => path |
  | 153 | 150 | \*/ |
  | 154 | 151 | public function getClassMap() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L158) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L155) |  |
  | 158 | 155 |  |
  | 159 | 156 | /\*\* |
  | 160 |  | \* @param string[] $classMap Class to filename map |
  | 161 |  | \* @psalm-param array<string, string> $classMap |
  |  | 157 | \* @param array<string, string> $classMap Class to filename map |
  | 162 | 158 | \* |
  | 163 | 159 | \* @return void |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L176) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L172) |  |
  | 176 | 172 | \* appending or prepending to the ones previously set for this prefix. |
  | 177 | 173 | \* |
  | 178 |  | \* @param string          $prefix  The prefix |
  | 179 |  | \* @param ~~string[]~~|string $paths   The PSR-0 root directories |
  | 180 |  | \* @param bool            $prepend Whether to prepend the directories |
  |  | 174 | \* @param string              $prefix  The prefix |
  |  | 175 | \* @param list<string>|string $paths   The PSR-0 root directories |
  |  | 176 | \* @param bool                $prepend Whether to prepend the directories |
  | 181 | 177 | \* |
  | 182 | 178 | \* @return void |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L184) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L180) |  |
  | 184 | 180 | public function add($prefix, $paths, $prepend = false) |
  | 185 | 181 | { |
  |  | 182 | $paths = (array) $paths; |
  | 186 | 183 | if (!$prefix) { |
  | 187 | 184 | if ($prepend) { |
  | 188 | 185 | $this->fallbackDirsPsr0 = array\_merge( |
  | 189 |  | ~~(array)~~ $paths, |
  |  | 186 | $paths, |
  | 190 | 187 | $this->fallbackDirsPsr0 |
  | 191 | 188 | ); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L193) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L190) |  |
  | 193 | 190 | $this->fallbackDirsPsr0 = array\_merge( |
  | 194 | 191 | $this->fallbackDirsPsr0, |
  | 195 |  | ~~(array)~~ $paths |
  |  | 192 | $paths |
  | 196 | 193 | ); |
  | 197 | 194 | } |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L202) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L199) |  |
  | 202 | 199 | $first = $prefix[0]; |
  | 203 | 200 | if (!isset($this->prefixesPsr0[$first][$prefix])) { |
  | 204 |  | $this->prefixesPsr0[$first][$prefix] = ~~(array)~~ $paths; |
  |  | 201 | $this->prefixesPsr0[$first][$prefix] = $paths; |
  | 205 | 202 |  |
  | 206 | 203 | return; |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L208) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L205) |  |
  | 208 | 205 | if ($prepend) { |
  | 209 | 206 | $this->prefixesPsr0[$first][$prefix] = array\_merge( |
  | 210 |  | ~~(array)~~ $paths, |
  |  | 207 | $paths, |
  | 211 | 208 | $this->prefixesPsr0[$first][$prefix] |
  | 212 | 209 | ); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L214) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L211) |  |
  | 214 | 211 | $this->prefixesPsr0[$first][$prefix] = array\_merge( |
  | 215 | 212 | $this->prefixesPsr0[$first][$prefix], |
  | 216 |  | ~~(array)~~ $paths |
  |  | 213 | $paths |
  | 217 | 214 | ); |
  | 218 | 215 | } |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L223) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L220) |  |
  | 223 | 220 | \* appending or prepending to the ones previously set for this namespace. |
  | 224 | 221 | \* |
  | 225 |  | \* @param string          $prefix  The prefix/namespace, with trailing '\\' |
  | 226 |  | \* @param ~~string[]~~|string $paths   The PSR-4 base directories |
  | 227 |  | \* @param bool            $prepend Whether to prepend the directories |
  |  | 222 | \* @param string              $prefix  The prefix/namespace, with trailing '\\' |
  |  | 223 | \* @param list<string>|string $paths   The PSR-4 base directories |
  |  | 224 | \* @param bool                $prepend Whether to prepend the directories |
  | 228 | 225 | \* |
  | 229 | 226 | \* @throws \InvalidArgumentException |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L233) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L230) |  |
  | 233 | 230 | public function addPsr4($prefix, $paths, $prepend = false) |
  | 234 | 231 | { |
  |  | 232 | $paths = (array) $paths; |
  | 235 | 233 | if (!$prefix) { |
  | 236 | 234 | // Register directories for the root namespace. |
  | 237 | 235 | if ($prepend) { |
  | 238 | 236 | $this->fallbackDirsPsr4 = array\_merge( |
  | 239 |  | ~~(array)~~ $paths, |
  |  | 237 | $paths, |
  | 240 | 238 | $this->fallbackDirsPsr4 |
  | 241 | 239 | ); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L243) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L241) |  |
  | 243 | 241 | $this->fallbackDirsPsr4 = array\_merge( |
  | 244 | 242 | $this->fallbackDirsPsr4, |
  | 245 |  | ~~(array)~~ $paths |
  |  | 243 | $paths |
  | 246 | 244 | ); |
  | 247 | 245 | } |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L253) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L251) |  |
  | 253 | 251 | } |
  | 254 | 252 | $this->prefixLengthsPsr4[$prefix[0]][$prefix] = $length; |
  | 255 |  | $this->prefixDirsPsr4[$prefix] = ~~(array)~~ $paths; |
  |  | 253 | $this->prefixDirsPsr4[$prefix] = $paths; |
  | 256 | 254 | } elseif ($prepend) { |
  | 257 | 255 | // Prepend directories for an already registered namespace. |
  | 258 | 256 | $this->prefixDirsPsr4[$prefix] = array\_merge( |
  | 259 |  | ~~(array)~~ $paths, |
  |  | 257 | $paths, |
  | 260 | 258 | $this->prefixDirsPsr4[$prefix] |
  | 261 | 259 | ); |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L264) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L262) |  |
  | 264 | 262 | $this->prefixDirsPsr4[$prefix] = array\_merge( |
  | 265 | 263 | $this->prefixDirsPsr4[$prefix], |
  | 266 |  | ~~(array)~~ $paths |
  |  | 264 | $paths |
  | 267 | 265 | ); |
  | 268 | 266 | } |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L273) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L271) |  |
  | 273 | 271 | \* replacing any others previously set for this prefix. |
  | 274 | 272 | \* |
  | 275 |  | \* @param string          $prefix The prefix |
  | 276 |  | \* @param ~~string[]~~|string $paths  The PSR-0 base directories |
  |  | 273 | \* @param string              $prefix The prefix |
  |  | 274 | \* @param list<string>|string $paths  The PSR-0 base directories |
  | 277 | 275 | \* |
  | 278 | 276 | \* @return void |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L291) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L289) |  |
  | 291 | 289 | \* replacing any others previously set for this namespace. |
  | 292 | 290 | \* |
  | 293 |  | \* @param string          $prefix The prefix/namespace, with trailing '\\' |
  | 294 |  | \* @param ~~string[]~~|string $paths  The PSR-4 base directories |
  |  | 291 | \* @param string              $prefix The prefix/namespace, with trailing '\\' |
  |  | 292 | \* @param list<string>|string $paths  The PSR-4 base directories |
  | 295 | 293 | \* |
  | 296 | 294 | \* @throws \InvalidArgumentException |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L426) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L424) |  |
  | 426 | 424 | { |
  | 427 | 425 | if ($file = $this->findFile($class)) { |
  | 428 |  | includeFile($file); |
  |  | 426 | $includeFile = self::$includeFile; |
  |  | 427 | $includeFile($file); |
  | 429 | 428 |  |
  | 430 | 429 | return true; |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L477) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L476) |  |
  | 477 | 476 |  |
  | 478 | 477 | /\*\* |
  | 479 |  | \* Returns the currently registered loaders ~~index~~ed by their corresponding vendor directories. |
  | 480 |  | \* |
  | 481 |  | \* @return ~~self[]~~ |
  |  | 478 | \* Returns the currently registered loaders keyed by their corresponding vendor directories. |
  |  | 479 | \* |
  |  | 480 | \* @return array<string, self> |
  | 482 | 481 | \*/ |
  | 483 | 482 | public static function getRegisteredLoaders() |
  | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=2836500#L556) | […](/browser/imageseo/trunk/vendor/composer/ClassLoader.php?rev=3122915#L555) |  |
  | 556 | 555 | return false; |
  | 557 | 556 | } |
  |  | 557 |  |
  |  | 558 | /\*\* |
  |  | 559 | \* @return void |
  |  | 560 | \*/ |
  |  | 561 | private static function initializeIncludeClosure() |
  |  | 562 | { |
  |  | 563 | if (self::$includeFile !== null) { |
  |  | 564 | return; |
  |  | 565 | } |
  |  | 566 |  |
  |  | 567 | /\*\* |
  |  | 568 | \* Scope isolated include. |
  |  | 569 | \* |
  |  | 570 | \* Prevents access to $this/self from included files. |
  |  | 571 | \* |
  |  | 572 | \* @param  string $file |
  |  | 573 | \* @return void |
  |  | 574 | \*/ |
  |  | 575 | self::$includeFile = \Closure::bind(static function($file) { |
  |  | 576 | include $file; |
  |  | 577 | }, null, null); |
  |  | 578 | } |
  | 558 | 579 | } |
  | 559 |  |  |
  | 560 |  | ~~/\*\*~~ |
  | 561 |  | ~~\* Scope isolated include.~~ |
  | 562 |  | ~~\*~~ |
  | 563 |  | ~~\* Prevents access to $this/self from included files.~~ |
  | 564 |  | ~~\*~~ |
  | 565 |  | ~~\* @param  string $file~~ |
  | 566 |  | ~~\* @return void~~ |
  | 567 |  | ~~\* @private~~ |
  | 568 |  | ~~\*/~~ |
  | 569 |  | ~~function includeFile($file)~~ |
  | 570 |  | ~~{~~ |
  | 571 |  | ~~include $file;~~ |
  | 572 |  | ~~}~~ |
* ## [imageseo/trunk/vendor/composer/InstalledVersions.php](/changeset/3122915/imageseo/trunk/vendor/composer/InstalledVersions.php "Show the changeset 3122915 restricted to imageseo/trunk/vendor/composer/InstalledVersions.php")

  | [r2836500](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=2836500#L99 "Show revision 2836500 of this file in browser") | [r3122915](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=3122915#L99 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 99 | 99 | foreach (self::getInstalled() as $installed) { |
  | 100 | 100 | if (isset($installed['versions'][$packageName])) { |
  | 101 |  | return $includeDevRequirements || ~~empty($installed['versions'][$packageName]['dev\_requirement'])~~; |
  |  | 101 | return $includeDevRequirements || !isset($installed['versions'][$packageName]['dev\_requirement']) || $installed['versions'][$packageName]['dev\_requirement'] === false; |
  | 102 | 102 | } |
  | 103 | 103 | } |
  | […](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=2836500#L120) | […](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=3122915#L120) |  |
  | 120 | 120 | public static function satisfies(VersionParser $parser, $packageName, $constraint) |
  | 121 | 121 | { |
  | 122 |  | $constraint = $parser->parseConstraints($constraint); |
  |  | 122 | $constraint = $parser->parseConstraints((string) $constraint); |
  | 123 | 123 | $provided = $parser->parseConstraints(self::getVersionRanges($packageName)); |
  | 124 | 124 |  |
  | […](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=2836500#L329) | […](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=3122915#L329) |  |
  | 329 | 329 | $installed[] = self::$installedByVendor[$vendorDir]; |
  | 330 | 330 | } elseif (is\_file($vendorDir.'/composer/installed.php')) { |
  | 331 |  | $installed[] = self::$installedByVendor[$vendorDir] = require $vendorDir.'/composer/installed.php'; |
  |  | 331 | /\*\* @var array{root: array{name: string, pretty\_version: string, version: string, reference: string|null, type: string, install\_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty\_version?: string, version?: string, reference?: string|null, type?: string, install\_path?: string, aliases?: string[], dev\_requirement: bool, replaced?: string[], provided?: string[]}>} $required \*/ |
  |  | 332 | $required = require $vendorDir.'/composer/installed.php'; |
  |  | 333 | $installed[] = self::$installedByVendor[$vendorDir] = $required; |
  | 332 | 334 | if (null === self::$installed && strtr($vendorDir.'/composer', '\\', '/') === strtr(\_\_DIR\_\_, '\\', '/')) { |
  | 333 | 335 | self::$installed = $installed[count($installed) - 1]; |
  | […](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=2836500#L341) | […](/browser/imageseo/trunk/vendor/composer/InstalledVersions.php?rev=3122915#L343) |  |
  | 341 | 343 | // and not from its source location in the composer/composer package, see https://github.com/composer/composer/issues/9937 |
  | 342 | 344 | if (substr(\_\_DIR\_\_, -8, 1) !== 'C') { |
  | 343 |  | self::$installed = require \_\_DIR\_\_ . '/installed.php'; |
  |  | 345 | /\*\* @var array{root: array{name: string, pretty\_version: string, version: string, reference: string|null, type: string, install\_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty\_version?: string, version?: string, reference?: string|null, type?: string, install\_path?: string, aliases?: string[], dev\_requirement: bool, replaced?: string[], provided?: string[]}>} $required \*/ |
  |  | 346 | $required = require \_\_DIR\_\_ . '/installed.php'; |
  |  | 347 | self::$installed = $required; |
  | 344 | 348 | } else { |
  | 345 | 349 | self::$installed = array(); |
  | 346 | 350 | } |
  | 347 | 351 | } |
  | 348 |  | $installed[] = self::$installed; |
  |  | 352 |  |
  |  | 353 | if (self::$installed !== array()) { |
  |  | 354 | $installed[] = self::$installed; |
  |  | 355 | } |
  | 349 | 356 |  |
  | 350 | 357 | return $installed; |
* ## [imageseo/trunk/vendor/composer/autoload\_real.php](/changeset/3122915/imageseo/trunk/vendor/composer/autoload_real.php "Show the changeset 3122915 restricted to imageseo/trunk/vendor/composer/autoload_real.php")

  | [r3093706](/browser/imageseo/trunk/vendor/composer/autoload_real.php?rev=3093706#L3 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/vendor/composer/autoload_real.php?rev=3122915#L3 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload\_real.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | class ComposerAutoloaderInit~~8aee80435795f097aba54ac01df0b70f~~ |
  |  | 5 | class ComposerAutoloaderInite97648f350088b8744107ebf06d18a01 |
  | 6 | 6 | { |
  | 7 | 7 | private static $loader; |
  | […](/browser/imageseo/trunk/vendor/composer/autoload_real.php?rev=3093706#L25) | […](/browser/imageseo/trunk/vendor/composer/autoload_real.php?rev=3122915#L25) |  |
  | 25 | 25 | require \_\_DIR\_\_ . '/platform\_check.php'; |
  | 26 | 26 |  |
  | 27 |  | spl\_autoload\_register(array('ComposerAutoloaderInit~~8aee80435795f097aba54ac01df0b70f~~', 'loadClassLoader'), true, true); |
  |  | 27 | spl\_autoload\_register(array('ComposerAutoloaderInite97648f350088b8744107ebf06d18a01', 'loadClassLoader'), true, true); |
  | 28 | 28 | self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(\_\_DIR\_\_)); |
  | 29 |  | spl\_autoload\_unregister(array('ComposerAutoloaderInit~~8aee80435795f097aba54ac01df0b70f~~', 'loadClassLoader')); |
  |  | 29 | spl\_autoload\_unregister(array('ComposerAutoloaderInite97648f350088b8744107ebf06d18a01', 'loadClassLoader')); |
  | 30 | 30 |  |
  | 31 | 31 | require \_\_DIR\_\_ . '/autoload\_static.php'; |
  | 32 |  | call\_user\_func(\Composer\Autoload\ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~::getInitializer($loader)); |
  |  | 32 | call\_user\_func(\Composer\Autoload\ComposerStaticInite97648f350088b8744107ebf06d18a01::getInitializer($loader)); |
  | 33 | 33 |  |
  | 34 | 34 | $loader->register(true); |
* ## [imageseo/trunk/vendor/composer/autoload\_static.php](/changeset/3122915/imageseo/trunk/vendor/composer/autoload_static.php "Show the changeset 3122915 restricted to imageseo/trunk/vendor/composer/autoload_static.php")

  | [r3093706](/browser/imageseo/trunk/vendor/composer/autoload_static.php?rev=3093706#L5 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/vendor/composer/autoload_static.php?rev=3122915#L5 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | namespace Composer\Autoload; |
  | 6 | 6 |  |
  | 7 |  | class ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~ |
  |  | 7 | class ComposerStaticInite97648f350088b8744107ebf06d18a01 |
  | 8 | 8 | { |
  | 9 | 9 | public static $prefixLengthsPsr4 = array ( |
  | […](/browser/imageseo/trunk/vendor/composer/autoload_static.php?rev=3093706#L41) | […](/browser/imageseo/trunk/vendor/composer/autoload_static.php?rev=3122915#L41) |  |
  | 41 | 41 | { |
  | 42 | 42 | return \Closure::bind(function () use ($loader) { |
  | 43 |  | $loader->prefixLengthsPsr4 = ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~::$prefixLengthsPsr4; |
  | 44 |  | $loader->prefixDirsPsr4 = ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~::$prefixDirsPsr4; |
  | 45 |  | $loader->classMap = ComposerStaticInit~~8aee80435795f097aba54ac01df0b70f~~::$classMap; |
  |  | 43 | $loader->prefixLengthsPsr4 = ComposerStaticInite97648f350088b8744107ebf06d18a01::$prefixLengthsPsr4; |
  |  | 44 | $loader->prefixDirsPsr4 = ComposerStaticInite97648f350088b8744107ebf06d18a01::$prefixDirsPsr4; |
  |  | 45 | $loader->classMap = ComposerStaticInite97648f350088b8744107ebf06d18a01::$classMap; |
  | 46 | 46 |  |
  | 47 | 47 | }, null, ClassLoader::class); |
* ## [imageseo/trunk/vendor/composer/installed.php](/changeset/3122915/imageseo/trunk/vendor/composer/installed.php "Show the changeset 3122915 restricted to imageseo/trunk/vendor/composer/installed.php")

  | [r3093706](/browser/imageseo/trunk/vendor/composer/installed.php?rev=3093706#L2 "Show revision 3093706 of this file in browser") | [r3122915](/browser/imageseo/trunk/vendor/composer/installed.php?rev=3122915#L2 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | 'root' => array( |
  | 3 | 3 | 'name' => 'imageseo/imageseo-wordpress', |
  | 4 |  | 'pretty\_version' => '~~dev-master~~', |
  | 5 |  | 'version' => '~~dev-master~~', |
  | 6 |  | 'reference' => '~~8da9a48b3edece64c45d1a166359c75831a07d6b~~', |
  |  | 4 | 'pretty\_version' => '3.1.2', |
  |  | 5 | 'version' => '3.1.2.0', |
  |  | 6 | 'reference' => '37959f46c31b6d83226ee1ff796b9ff6facf6296', |
  | 7 | 7 | 'type' => 'project', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/imageseo/trunk/vendor/composer/installed.php?rev=3093706#L32) | […](/browser/imageseo/trunk/vendor/composer/installed.php?rev=3122915#L32) |  |
  | 32 | 32 | ), |
  | 33 | 33 | 'imageseo/imageseo-wordpress' => array( |
  | 34 |  | 'pretty\_version' => '~~dev-master~~', |
  | 35 |  | 'version' => '~~dev-master~~', |
  | 36 |  | 'reference' => '~~8da9a48b3edece64c45d1a166359c75831a07d6b~~', |
  |  | 34 | 'pretty\_version' => '3.1.2', |
  |  | 35 | 'version' => '3.1.2.0', |
  |  | 36 | 'reference' => '37959f46c31b6d83226ee1ff796b9ff6facf6296', |
  | 37 | 37 | 'type' => 'project', |
  | 38 | 38 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
* ## [imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php](/changeset/3122915/imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php "Show the changeset 3122915 restricted to imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php")

  | [r3011770](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3011770#L11 "Show revision 3011770 of this file in browser") | [r3122915](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3122915#L11 "Show revision 3122915 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | \*/ |
  | 12 | 12 | protected $resources = []; |
  | 13 |  |  |
  |  | 13 |  |
  | 14 | 14 | /\*\* |
  | 15 | 15 | \* @param string $path |
  | […](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3011770#L28) | […](/browser/imageseo/trunk/vendor/imageseo/imageseo-php/src/Client/Resources.php?rev=3122915#L28) |  |
  | 28 | 28 | continue; |
  | 29 | 29 | } |
  | 30 |  |  |
  |  | 30 |  |
  | 31 | 31 | $key = $class::RESOURCE\_NAME; |
  | 32 | 32 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3122915)
* [Zip Archive](?format=zip&new=3122915)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

