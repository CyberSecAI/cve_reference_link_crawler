

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c8686c014b5e872ba7e334f33ca553f14446fc29)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c8686c014b5e872ba7e334f33ca553f14446fc29)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c8686c014b5e872ba7e334f33ca553f14446fc29)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c8686c014b5e872ba7e334f33ca553f14446fc29)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yangxi Xiang <xyangxi5@gmail.com> | 2022-06-28 17:33:22 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-04-13 12:50:09 +0200 |
| commit | [c8686c014b5e872ba7e334f33ca553f14446fc29](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c8686c014b5e872ba7e334f33ca553f14446fc29) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c8686c014b5e872ba7e334f33ca553f14446fc29)) | |
| tree | [992f675906e0a958ee48c4b501f86a7f15a2a5bb](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c8686c014b5e872ba7e334f33ca553f14446fc29) | |
| parent | [fc7dfe3d123f00e720be80b920da287810a1f37d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fc7dfe3d123f00e720be80b920da287810a1f37d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c8686c014b5e872ba7e334f33ca553f14446fc29&id2=fc7dfe3d123f00e720be80b920da287810a1f37d)) | |
| download | [linux-c8686c014b5e872ba7e334f33ca553f14446fc29.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c8686c014b5e872ba7e334f33ca553f14446fc29.tar.gz) | |

vt: fix memory overlapping when deleting chars in the buffercommit 39cdb68c64d84e71a4a717000b6e5de208ee60cc upstream.
A memory overlapping copy occurs when deleting a long line. This memory
overlapping copy can cause data corruption when scr\_memcpyw is optimized
to memcpy because memcpy does not ensure its behavior if the destination
buffer overlaps with the source buffer. The line buffer is not always
broken, because the memcpy utilizes the hardware acceleration, whose
result is not deterministic.
Fix this problem by using replacing the scr\_memcpyw with scr\_memmovew.
Fixes: 81732c3b2fed ("tty vt: Fix line garbage in virtual console on command line edition")
Cc: stable <stable@kernel.org>
Signed-off-by: Yangxi Xiang <xyangxi5@gmail.com>
Link: [https://lore.kernel.org/r/20220628093322.5688-1-xyangxi5@gmail.com](https://lore.kernel.org/r/20220628093322.5688-1-xyangxi5%40gmail.com)
[ KN: vc\_state is not a separate structure in LTS v4.19, v5.4. Adjusted the patch
accordingly by using vc\_x instead of state.x for backport. ]
Signed-off-by: Kuntal Nayak <kuntal.nayak@broadcom.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c8686c014b5e872ba7e334f33ca553f14446fc29)

| -rw-r--r-- | [drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vt/vt.c?id=c8686c014b5e872ba7e334f33ca553f14446fc29) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/tty/vt/vt.c b/drivers/tty/vt/vt.cindex 3e5088a17bbea5..abcacd377e09ba 100644--- a/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=fc7dfe3d123f00e720be80b920da287810a1f37d)+++ b/[drivers/tty/vt/vt.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vt/vt.c?id=c8686c014b5e872ba7e334f33ca553f14446fc29)@@ -855,7 +855,7 @@ static void delete\_char(struct vc\_data \*vc, unsigned int nr) unsigned short \*p = (unsigned short \*) vc->vc\_pos;  vc\_uniscr\_delete(vc, nr);- scr\_memcpyw(p, p + nr, (vc->vc\_cols - vc->vc\_x - nr) \* 2);+ scr\_memmovew(p, p + nr, (vc->vc\_cols - vc->vc\_x - nr) \* 2); scr\_memsetw(p + vc->vc\_cols - vc->vc\_x - nr, vc->vc\_video\_erase\_char, nr \* 2); vc->vc\_need\_wrap = 0; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:00:26 +0000

