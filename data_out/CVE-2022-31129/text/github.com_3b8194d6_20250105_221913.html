
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmoment%2Fmoment%2Fpull%2F6015)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmoment%2Fmoment%2Fpull%2F6015)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=moment%2Fmoment)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[moment](/moment)
/
**[moment](/moment/moment)**
Public

* [Notifications](/login?return_to=%2Fmoment%2Fmoment) You must be signed in to change notification settings
* [Fork
  7k](/login?return_to=%2Fmoment%2Fmoment)
* [Star
   48k](/login?return_to=%2Fmoment%2Fmoment)

* [Code](/moment/moment)
* [Issues
  229](/moment/moment/issues)
* [Pull requests
  38](/moment/moment/pulls)
* [Actions](/moment/moment/actions)
* [Projects
  0](/moment/moment/projects)
* [Security](/moment/moment/security)
* [Insights](/moment/moment/pulse)

Additional navigation options

* [Code](/moment/moment)
* [Issues](/moment/moment/issues)
* [Pull requests](/moment/moment/pulls)
* [Actions](/moment/moment/actions)
* [Projects](/moment/moment/projects)
* [Security](/moment/moment/security)
* [Insights](/moment/moment/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmoment%2Fmoment%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmoment%2Fmoment%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [bugfix] Fix redos in preprocessRFC2822 regex #6015

 Merged

[ichernev](/ichernev)
merged 3 commits into
[moment:develop](/moment/moment/tree/develop "moment/moment:develop")
from
[vovikhangcdv:fix-redos-in-preprocessRFC2822](/vovikhangcdv/moment/tree/fix-redos-in-preprocessRFC2822 "vovikhangcdv/moment:fix-redos-in-preprocessRFC2822")

Jul 6, 2022

 Merged

# [[bugfix] Fix redos in preprocessRFC2822 regex](#top) #6015

[ichernev](/ichernev)
merged 3 commits into
[moment:develop](/moment/moment/tree/develop "moment/moment:develop")
from
[vovikhangcdv:fix-redos-in-preprocessRFC2822](/vovikhangcdv/moment/tree/fix-redos-in-preprocessRFC2822 "vovikhangcdv/moment:fix-redos-in-preprocessRFC2822")

Jul 6, 2022

[Conversation
15](/moment/moment/pull/6015)
[Commits
3](/moment/moment/pull/6015/commits)
[Checks
0](/moment/moment/pull/6015/checks)
[Files changed](/moment/moment/pull/6015/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=60&v=4)](/vovikhangcdv)

Copy link

Contributor

### @vovikhangcdv **[vovikhangcdv](/vovikhangcdv)** commented [Jun 8, 2022](#issue-1264144359) • edited Loading

Fixes: [#6012](https://github.com/moment/moment/issues/6012)

Using the "look-ahead" mechanism regex in `preprocessRFC2822()` to resolve the problem [Regular Expression Denial of Service (ReDoS)#6012](https://github.com/moment/moment/issues/6012)

Sorry, something went wrong.

All reactions

 [vovikhangcdv](/vovikhangcdv)
added 2 commits
[June 7, 2022 13:39](#commits-pushed-dc0d180)

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=40&v=4)](/vovikhangcdv)

`[fix redos in preprocessRFC2822 regex](/moment/moment/pull/6015/commits/dc0d180e90d8a84f7ff13572363330a22b3ea504 "fix redos in preprocessRFC2822 regex

Fixes: [#2936](https://github.com/moment/moment/issues/6012)

Directly match the comment tokens in preprocessRFC2822 regex to resolve the problem [Regular Expression Denial of Service (ReDoS)#6012](https://github.com/moment/moment/issues/6012)")`
 …

`[dc0d180](/moment/moment/pull/6015/commits/dc0d180e90d8a84f7ff13572363330a22b3ea504)`

```
Fixes: [[moment#2936](https://github.com/moment/moment/issues/2936)]([moment#6012](https://github.com/moment/moment/issues/6012))

Directly match the comment tokens in preprocessRFC2822 regex to resolve the problem [Regular Expression Denial of Service (ReDoS)[moment#6012](https://github.com/moment/moment/issues/6012)]([moment#6012](https://github.com/moment/moment/issues/6012))
```

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=40&v=4)](/vovikhangcdv)

`[fix redos using local backtracking regex](/moment/moment/pull/6015/commits/bfd4f2375d5c1a2106246721d693a9611dddfbfe "fix redos using local backtracking regex

change the direct matching regex to a local backtracking regex to support all characters in the token comment")`
 …

`[bfd4f23](/moment/moment/pull/6015/commits/bfd4f2375d5c1a2106246721d693a9611dddfbfe)`

```
change the direct matching regex to a local backtracking regex to support all characters in the token comment
```

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=40&u=3de48d7560c89a5bbe873a8e4700b439e72d1fe5&v=4)](/vovikhangcdv)
[vovikhangcdv](/vovikhangcdv)
mentioned this pull request
[Jun 8, 2022](#ref-pullrequest-1262804941)

[[bugfix] fix redos in preprocessRFC2822 regex
#6013](/moment/moment/pull/6013)
 Closed

[![@ichernev](https://avatars.githubusercontent.com/u/757060?s=80&u=0c7583422d4c2b5572616f9e542e110bf5dd15f7&v=4)](/ichernev)

Copy link

Contributor

### **[ichernev](/ichernev)** commented [Jun 10, 2022](#issuecomment-1152315727)

| [@vovikhangcdv](https://github.com/vovikhangcdv) can you explain a bit how this is being fixed?  From the linked issue it looks like any open-close relationship that we have to track (not sure if there are more), has the same issue. Also is this compatible all the way back to Roman Empire JavaScript? |
| --- |

All reactions

Sorry, something went wrong.

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=80&u=3de48d7560c89a5bbe873a8e4700b439e72d1fe5&v=4)](/vovikhangcdv)

Copy link

Contributor

Author

### **[vovikhangcdv](/vovikhangcdv)** commented [Jun 11, 2022](#issuecomment-1152961973)

| Hi [@ichernev](https://github.com/ichernev), Great to see your response. There are some things we need to clarify.   ---   1. How this is being fixed?  **Firstly, look back to the original regex: `/\([^)]*\)|[\n\t]/g`.** The hotspot is `\([^)]*\)`. The process would be, sequentially:  [image](https://user-images.githubusercontent.com/45411113/173192511-2fc4d17b-db0f-4302-8fc3-3f8861adff6f.png)   1. Try to match the `(` character. 2. Try to match all those characters that are not `)`, ***as many times as possible (greedy)***. 3. Try to match the `)` character.   This process will be executed for the full input string and repeated with substring (remove the start character) until *match all the three steps* **or** *all characters are checked*.  Consider the evil payload format: `"(".repeat(X)` (the worst-case). This payload will exploit the greedy mechanism of step 2 and the backtracking mechanism of the failure matching process. For each `(`, step 2 will check all the rest of the substring characters (it costs `X - num_of_checked_substring` substeps) which certainly fails and the process has to backtrack and repeat for total X substrings. **This is a polynomial complexity problem.**  **Now, look to the suggested fix: `/\((?:(?!\().)*\)|[\n\t]/gs`.** The hotspot (after remove a non-capture group `(?:)`) is:`\(((?!\().)*\)`  [image](https://user-images.githubusercontent.com/45411113/173192836-766784c4-be8b-4d2d-8b4b-e587855fbb56.png)  The matching process would be similar to the old regex, except that step 2 uses non-greedy searching but a "look-ahead" mechanism. It will immediately fail when it matches the second `(` characters (cost one step instead of `X - num_of_checked_substring` substeps like the above example). **It means the matching process only costs linear steps based on the length of the input string.**   ---   2. There are a lot of regular expressions used in this project. Are there any similar issues in this project? How we can find and fix it?  The mission of `moment` is a third-party package that helps other projects and applications achieve their goals. I believe that eliminating all possible security vulnerabilities is crucial work for the community. Give a huge thank you and all the awesome contributors of this project. I see a lot of effort to reduce the risk of ReDos attack vector in the past ([#2936](https://github.com/moment/moment/issues/2936), [#4163](https://github.com/moment/moment/issues/4163), and other relative commits). After carefully looking at the codebase, this is the only ReDoS vulnerability left I could find. To prevent this kind of vulnerability in the future, we just need to carefully use efficient regexes. The [recheck](https://devina.io/redos-checker) (see [the online version](https://devina.io/redos-checker)) is a useful tool to check the complexity of regex, just make sure that only the safe or linear regexes should be used.   ---   3. Is this compatible all the way back to Roman Empire JavaScript?  I am not sure what you asking about. But if you are concerned about the compatibility of the fix, I have tested the fix and confirm that it passed *160,555* test cases of unit tests. Or if I missing something, please let me know, and we will figure it out together.   ---   References:   * [Regular expression Denial of Service - ReDoS (OWASP)](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS) * [Protect Against Regex Denial Of Service - ReDoS](https://blog.logrocket.com/protect-against-regex-denial-of-service-redos-attacks/) * [Staicu, Cristian-Alexandru, and Michael Pradel. "Freezing the Web: A Study of {ReDoS} Vulnerabilities in {JavaScript-based} Web Servers." 27th USENIX Security Symposium (USENIX Security 18). 2018.](https://www.usenix.org/conference/usenixsecurity18/presentation/staicu) |
| --- |

 👍
12
 rstf, d12frosted, bood-dev, orhun, grorp, EikkoMass, isatria, Konano, swyrwiak-cu, philipsinnott, and 2 more reacted with thumbs up emoji
 ❤️
7
 espen, mustafababil, weiran, aripjanovsh, MichaelChan-Pong, orhun, and swyrwiak-cu reacted with heart emoji

All reactions

* 👍
  12 reactions
* ❤️
  7 reactions

Sorry, something went wrong.

[![@emer7](https://avatars.githubusercontent.com/u/21377166?s=80&u=ab54b1a23a29efaf81ca95fe3cb866fdc006074e&v=4)](/emer7)

Copy link

### **[emer7](/emer7)** commented [Jun 22, 2022](#issuecomment-1162700527)

| Hi is there update to this fix? Thank you |
| --- |

All reactions

Sorry, something went wrong.

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=80&u=3de48d7560c89a5bbe873a8e4700b439e72d1fe5&v=4)](/vovikhangcdv)

Copy link

Contributor

Author

### **[vovikhangcdv](/vovikhangcdv)** commented [Jun 23, 2022](#issuecomment-1163859749)

| Hi [@ichernev](https://github.com/ichernev), could you review the PR? |
| --- |

All reactions

Sorry, something went wrong.

[![@emer7](https://avatars.githubusercontent.com/u/21377166?s=80&u=ab54b1a23a29efaf81ca95fe3cb866fdc006074e&v=4)](/emer7)

Copy link

### **[emer7](/emer7)** commented [Jul 5, 2022](#issuecomment-1174567694)

| Hi [@ichernev](https://github.com/ichernev), any update for this PR? Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@ichernev](https://avatars.githubusercontent.com/u/757060?s=80&u=0c7583422d4c2b5572616f9e542e110bf5dd15f7&v=4)](/ichernev)

Copy link

Contributor

### **[ichernev](/ichernev)** commented [Jul 5, 2022](#issuecomment-1175238081)

| Hey, sorry for the delay, I'll release a build in the coming days with the fix, I was a bit worried about the lookahead (if it was supported), but the current implementation uses whitelist, which is better. |
| --- |

All reactions

Sorry, something went wrong.

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=80&u=3de48d7560c89a5bbe873a8e4700b439e72d1fe5&v=4)](/vovikhangcdv)

Copy link

Contributor

Author

### **[vovikhangcdv](/vovikhangcdv)** commented [Jul 5, 2022](#issuecomment-1175275312)

| Hey, sorry for the delay, I'll release a build in the coming days with the fix, I was a bit worried about the lookahead (if it was supported), but the current implementation uses whitelist, which is better.  Good to see you back. If you can confirm the issue, could you validate my report on [Hunter](https://huntr.dev/bounties/f0952b67-f2ff-44a9-a9cd-99e0a87cb633/)?. It will help my work too. Thank you, [@ichernev](https://github.com/ichernev). |
| --- |

All reactions

Sorry, something went wrong.

[![@ichernev](https://avatars.githubusercontent.com/u/757060?s=80&u=0c7583422d4c2b5572616f9e542e110bf5dd15f7&v=4)](/ichernev)

Copy link

Contributor

### **[ichernev](/ichernev)** commented [Jul 5, 2022](#issuecomment-1175346981)

| How about we change `(/\([^)]*\)|[\n\t]/g` to `(/\([^()]*\)|[\n\t]/g`? As far as I get it you should avoid matching more open brackets, so we can just prevent that. |
| --- |

All reactions

Sorry, something went wrong.

[![@ichernev](https://avatars.githubusercontent.com/u/757060?s=80&u=0c7583422d4c2b5572616f9e542e110bf5dd15f7&v=4)](/ichernev)

Copy link

Contributor

### **[ichernev](/ichernev)** commented [Jul 5, 2022](#issuecomment-1175458926)

| [@vovikhangcdv](https://github.com/vovikhangcdv)  I can merge the fix with `[^()]`, I can give further attribution to you if necessary (i.e make a security advisory in github), for reporting it. I'll use your excellent description from a few comments above. |
| --- |

All reactions

Sorry, something went wrong.

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=40&v=4)](/vovikhangcdv)

`[update regex by avoid matching more open brackets](/moment/moment/pull/6015/commits/4bbb9f3ccbe231de40207503f344fe5ce97584f4 "update regex by avoid matching more open brackets

update regex to avoid matching more open brackets from @ichernev suggestion")`
 …

`[4bbb9f3](/moment/moment/pull/6015/commits/4bbb9f3ccbe231de40207503f344fe5ce97584f4)`

```
update regex to avoid matching more open brackets from [@ichernev](https://github.com/ichernev) suggestion
```

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=80&u=3de48d7560c89a5bbe873a8e4700b439e72d1fe5&v=4)](/vovikhangcdv)

Copy link

Contributor

Author

### **[vovikhangcdv](/vovikhangcdv)** commented [Jul 6, 2022](#issuecomment-1175729404)

| Hey [@ichernev](https://github.com/ichernev), I can confirm your solution solves the security issue and work well. I have added a commit change from your suggestion. |
| --- |

All reactions

Sorry, something went wrong.

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=80&u=3de48d7560c89a5bbe873a8e4700b439e72d1fe5&v=4)](/vovikhangcdv)

Copy link

Contributor

Author

### **[vovikhangcdv](/vovikhangcdv)** commented [Jul 6, 2022](#issuecomment-1175732281) • edited Loading

| [@vovikhangcdv](https://github.com/vovikhangcdv)  I can merge the fix with `[^()]`, I can give further attribution to you if necessary (i.e make a security advisory in github), for reporting it. I'll use your excellent description from a few comments above.  As a researcher, being credited on `moment` security advisory or assigned CVE is my pleasure. I would appreciate that. Thank you [@ichernev](https://github.com/ichernev). |
| --- |

All reactions

Sorry, something went wrong.

[![@ichernev](https://avatars.githubusercontent.com/u/757060?s=80&u=0c7583422d4c2b5572616f9e542e110bf5dd15f7&v=4)](/ichernev)

Copy link

Contributor

### **[ichernev](/ichernev)** commented [Jul 6, 2022](#issuecomment-1176082890)

| Reading through the specification of the date format, it looks like formally a comment (stuff in brackets) can have a nested comment inside:  ``` FWS             =       ([*WSP CRLF] 1*WSP) /   ; Folding white space                         obs-FWS  ctext           =       NO-WS-CTL /     ; Non white space controls                          %d33-39 /       ; The rest of the US-ASCII                         %d42-91 /       ;  characters not including "(",                         %d93-126        ;  ")", or "\"  ccontent        =       ctext / quoted-pair / comment  comment         =       "(" *([FWS] ccontent) [FWS] ")"  CFWS            =       *([FWS] comment) (([FWS] comment) / FWS)  ```  note how `comment` includes `ccontent` which might include `comment`. Also note that CFWS is part of the `obs-` tokens, short for *obsolete*, so if this was obsolete in 2001 it might be safe to move on :)  To be fair, the Ruby standard library fails to parse dates with comments, so I'm not 100% sure we should deal with this crap. But if we do, there should be code to track open/closed parenthesis, if there is anything unbalanced the parsing should fail (because there are no brackets allowed in the actual string). This code is linear, so won't introduce bottlenecks.  If we keep the current comment approach (disallow open and close paren inside comment), it will "capture" (and remove) only the inner most comment, and the parsing will fail if there are nested comments (which, given the legacy-ness of all of this might be fine :)). |
| --- |

 👍
1
 vovikhangcdv reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=80&u=3de48d7560c89a5bbe873a8e4700b439e72d1fe5&v=4)](/vovikhangcdv)

Copy link

Contributor

Author

### **[vovikhangcdv](/vovikhangcdv)** commented [Jul 6, 2022](#issuecomment-1176230850)

| Yeh, I had noticed about nested comment in RFC2822 when trying to fix the issue before and was quite struggling with it :)). But looking at the old version of what `moment` did, I thought that was intended ignoring and done the same way :). |
| --- |

All reactions

Sorry, something went wrong.

[![@ichernev](https://avatars.githubusercontent.com/u/757060?s=40&u=0c7583422d4c2b5572616f9e542e110bf5dd15f7&v=4)](/ichernev)
[ichernev](/ichernev)
merged commit [`7aebb16`](/moment/moment/commit/7aebb1617fc9bced87ab6bc4c317644019b23ce7)
into
moment:develop

[Jul 6, 2022](https://github.com/moment/moment/pull/6015#event-6943854874)

[ichernev](/ichernev)
added a commit
that referenced
this pull request
[Jul 6, 2022](#ref-commit-b4e6153)
[![@ichernev](https://avatars.githubusercontent.com/u/757060?s=40&u=0c7583422d4c2b5572616f9e542e110bf5dd15f7&v=4)](/ichernev)

`[Revert "[bugfix] Fix redos in preprocessRFC2822 regex (](/moment/moment/commit/b4e615307ee350b58ac9899e3587ce43972b0753 "Revert \"[bugfix] Fix redos in preprocessRFC2822 regex (#6015)\"

This reverts commit 7aebb1617fc9bced87ab6bc4c317644019b23ce7.")[#6015](https://github.com/moment/moment/pull/6015)[)"](/moment/moment/commit/b4e615307ee350b58ac9899e3587ce43972b0753 "Revert \"[bugfix] Fix redos in preprocessRFC2822 regex (#6015)\"

This reverts commit 7aebb1617fc9bced87ab6bc4c317644019b23ce7.")`
…

`[b4e6153](/moment/moment/commit/b4e615307ee350b58ac9899e3587ce43972b0753)`

```
This reverts commit [7aebb16](https://github.com/moment/moment/commit/7aebb1617fc9bced87ab6bc4c317644019b23ce7).
```

[ichernev](/ichernev)
pushed a commit
that referenced
this pull request
[Jul 6, 2022](#ref-commit-9a3b589)
[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=40&u=3de48d7560c89a5bbe873a8e4700b439e72d1fe5&v=4)](/vovikhangcdv) [![@ichernev](https://avatars.githubusercontent.com/u/757060?s=40&v=4)](/ichernev)

`[[bugfix] Fix redos in preprocessRFC2822 regex (](/moment/moment/commit/9a3b5894f3d5d602948ac8a02e4ee528a49ca3a3 "[bugfix] Fix redos in preprocessRFC2822 regex (#6015)

* fix ReDoS in preprocessRFC2822 regex

Fixes: [#2936](https://github.com/moment/moment/issues/6012)

Disallow nested rfc2822 comments to prevent quadratic regex execution time (i.e each open bracket is considered at most twice).")[#6015](https://github.com/moment/moment/pull/6015)[)](/moment/moment/commit/9a3b5894f3d5d602948ac8a02e4ee528a49ca3a3 "[bugfix] Fix redos in preprocessRFC2822 regex (#6015)

* fix ReDoS in preprocessRFC2822 regex

Fixes: [#2936](https://github.com/moment/moment/issues/6012)

Disallow nested rfc2822 comments to prevent quadratic regex execution time (i.e each open bracket is considered at most twice).")`
…

`[9a3b589](/moment/moment/commit/9a3b5894f3d5d602948ac8a02e4ee528a49ca3a3)`

```
* fix ReDoS in preprocessRFC2822 regex

Fixes: [[#2936](https://github.com/moment/moment/issues/2936)]([#6012](https://github.com/moment/moment/issues/6012))

Disallow nested rfc2822 comments to prevent quadratic regex execution time (i.e each open bracket is considered at most twice).
```

 [![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=40&u=3de48d7560c89a5bbe873a8e4700b439e72d1fe5&v=4)](/vovikhangcdv)
[vovikhangcdv](/vovikhangcdv)
deleted the
fix-redos-in-preprocessRFC2822

branch
[July 6, 2022 16:00](#event-6944105238)

[![@ichernev](https://avatars.githubusercontent.com/u/757060?s=80&u=0c7583422d4c2b5572616f9e542e110bf5dd15f7&v=4)](/ichernev)

Copy link

Contributor

### **[ichernev](/ichernev)** commented [Jul 6, 2022](#issuecomment-1176431627)

| Advisory link: [GHSA-wc69-rhjr-hc9g](https://github.com/moment/moment/security/advisories/GHSA-wc69-rhjr-hc9g "GHSA-wc69-rhjr-hc9g") |
| --- |

 ❤️
2
 vovikhangcdv and JamieSlome reacted with heart emoji

All reactions

* ❤️
  2 reactions

Sorry, something went wrong.

[![@melloware](https://avatars.githubusercontent.com/u/4399574?s=40&v=4)](/melloware)
[melloware](/melloware)
mentioned this pull request
[Jul 7, 2022](#ref-issue-1297365640)

[Moment.js 2.29.4 CVE-2022-31129
primefaces/primefaces#8968](/primefaces/primefaces/issues/8968)

Closed

[![@JamieSlome](https://avatars.githubusercontent.com/u/55323451?s=80&u=c125f829f1fd011e9c564e82e3fb87ad98d7e0a4&v=4)](/JamieSlome)

Copy link

### **[JamieSlome](/JamieSlome)** commented [Jul 8, 2022](#issuecomment-1178632212)

| [@ichernev](https://github.com/ichernev) - would it be possible to add the following [report URL](https://huntr.dev/bounties/f0952b67-f2ff-44a9-a9cd-99e0a87cb633/) to the advisory? |
| --- |

All reactions

Sorry, something went wrong.

[![@sync-by-unito](https://avatars.githubusercontent.com/in/64202?s=40&v=4)](/apps/sync-by-unito)
[sync-by-unito](/apps/sync-by-unito)
bot
mentioned this pull request
[Jul 8, 2022](#ref-pullrequest-1298633465)

[Removed by SecOps for dependency update cleanup
apollographql/vscode-graphql#77](/apollographql/vscode-graphql/pull/77)
 Closed

[![@devonpis](https://avatars.githubusercontent.com/u/13789367?s=40&v=4)](/devonpis)
[devonpis](/devonpis)
mentioned this pull request
[Jul 11, 2022](#ref-issue-1300366316)

[Dependabot has a high severity alert on moment
formio/formio.js#4768](/formio/formio.js/issues/4768)

Closed

[![@eexit](https://avatars.githubusercontent.com/u/57098?s=40&v=4)](/eexit)
[eexit](/eexit)
mentioned this pull request
[Jul 12, 2022](#ref-pullrequest-1265806063)

[Upgrade moment to 2.29.3
TryGhost/Ghost-Storage-Base#66](/TryGhost/Ghost-Storage-Base/pull/66)
 Open

[![@adleong](https://avatars.githubusercontent.com/u/3979810?s=40&v=4)](/adleong)
[adleong](/adleong)
mentioned this pull request
[Jul 13, 2022](#ref-pullrequest-1302735152)

[web: Update moment for CVE-2022-31129
linkerd/linkerd2#8856](/linkerd/linkerd2/pull/8856)
 Merged

[![@unlikelyzero](https://avatars.githubusercontent.com/u/12446869?s=40&v=4)](/unlikelyzero)
[unlikelyzero](/unlikelyzero)
mentioned this pull request
[Jul 14, 2022](#ref-pullrequest-1305341845)

[Update moment
nasa/openmct#5509](/nasa/openmct/pull/5509)
 Merged

15 tasks

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this pull request
[Jul 18, 2022](#ref-pullrequest-1307910015)

[Fix CVE–2022–31129
suculent/thinx-device-api#400](/suculent/thinx-device-api/pull/400)
 Merged

This was referenced Jul 26, 2022

[Cx62f5bb1b-fa5e @ Npm-moment-2.20.1
Svetlana-github/test#168](/Svetlana-github/test/issues/168)

Open

[CVE-2022-31129 @ Npm-moment-2.20.1
Svetlana-github/test#171](/Svetlana-github/test/issues/171)

Open

[jhuckaby](/jhuckaby)
added a commit
to jhuckaby/Cronicle
that referenced
this pull request
[Jul 29, 2022](#ref-commit-b939bf4)
[![@jhuckaby](https://avatars.githubusercontent.com/u/700765?s=40&v=4)](/jhuckaby)

`[Bumped moment to v2.29.4 for vuln](/jhuckaby/Cronicle/commit/b939bf4253bad1d476887577f0ef9093ad9b09c8 "Bumped moment to v2.29.4 for vuln

https://github.com/moment/moment/pull/6015")`
…

`[b939bf4](/jhuckaby/Cronicle/commit/b939bf4253bad1d476887577f0ef9093ad9b09c8)`

```
[moment/moment#6015](https://github.com/moment/moment/pull/6015)
```

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Aug 1, 2022](#ref-issue-1325073739)

[CVE-2022-31129 - high detected in moment['2.19.3']
Robthreefold/goof#279](/Robthreefold/goof/issues/279)

Open

[![@stondino00](https://avatars.githubusercontent.com/u/54154986?s=40&v=4)](/stondino00)
[stondino00](/stondino00)
mentioned this pull request
[Aug 7, 2022](#ref-issue-1331084376)

[Security Dependency Update Moment.js to 2.29.4 in Nextcloud 24.0.4
nextcloud/server#33478](/nextcloud/server/issues/33478)

Closed

9 tasks

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this pull request
[Aug 8, 2022](#ref-pullrequest-1331906682)

[Fix CVE–2022–31129
OS2iot/OS2iot-frontend#113](/OS2iot/OS2iot-frontend/pull/113)
 Closed

[![@nicoloboschi](https://avatars.githubusercontent.com/u/23314389?s=40&v=4)](/nicoloboschi)
[nicoloboschi](/nicoloboschi)
mentioned this pull request
[Aug 30, 2022](#ref-pullrequest-1355848941)

[[security] Upgrade moment.js to 2.29.4
datastax/pulsar-admin-console#81](/datastax/pulsar-admin-console/pull/81)
 Merged

[michaeljmarshall](/michaeljmarshall)
pushed a commit
to datastax/pulsar-admin-console
that referenced
this pull request
[Aug 30, 2022](#ref-commit-4e6b3f4)
[![@nicoloboschi](https://avatars.githubusercontent.com/u/23314389?s=40&u=2014e20e246530fa89bd902fe703b6f9e6ecf833&v=4)](/nicoloboschi)

`[[security] Upgrade moment.js to 2.29.4 (](/datastax/pulsar-admin-console/commit/4e6b3f46f867b1fc7595136f64cbbb49947253f7 "[security] Upgrade moment.js to 2.29.4 (#81)

See https://github.com/moment/moment/pull/6015")[#81](https://github.com/datastax/pulsar-admin-console/pull/81)[)](/datastax/pulsar-admin-console/commit/4e6b3f46f867b1fc7595136f64cbbb49947253f7 "[security] Upgrade moment.js to 2.29.4 (#81)

See https://github.com/moment/moment/pull/6015")`
…

`[4e6b3f4](/datastax/pulsar-admin-console/commit/4e6b3f46f867b1fc7595136f64cbbb49947253f7)`

```
See [moment/moment#6015](https://github.com/moment/moment/pull/6015)
```

[![@craigfay](https://avatars.githubusercontent.com/u/31521775?s=40&v=4)](/craigfay)
[craigfay](/craigfay)
mentioned this pull request
[Sep 6, 2022](#ref-pullrequest-1363688636)

[[CF] (Security) Upgrade "rollup-plugin-license" to resolve vulnerability in MomentJS
Econify/moonshine-css#29](/Econify/moonshine-css/pull/29)
 Merged

[![@jorritfolmer](https://avatars.githubusercontent.com/u/11555154?s=40&v=4)](/jorritfolmer)
[jorritfolmer](/jorritfolmer)
mentioned this pull request
[Oct 21, 2022](#ref-issue-1418122715)

[Splunkbase blocking issues for cloud vetting v4.1.0
jorritfolmer/TA-dmarc#45](/jorritfolmer/TA-dmarc/issues/45)

Closed

[![@debricked-staging](https://avatars.githubusercontent.com/u/40488434?s=40&v=4)](/apps/debricked-staging)
[debricked-staging](/apps/debricked-staging)
bot
mentioned this pull request
[Nov 9, 2022](#ref-pullrequest-1442520802)

[Fix CVE–2022–31129
InternalBenchmarkDebricked/VulnerableYarnAndNpmRepo#13](/InternalBenchmarkDebricked/VulnerableYarnAndNpmRepo/pull/13)
 Open

[![@RobertMickleCx](https://avatars.githubusercontent.com/u/88998525?s=40&v=4)](/RobertMickleCx)
[RobertMickleCx](/RobertMickleCx)
mentioned this pull request
[Mar 7, 2023](#ref-issue-1614188192)

[Cx62f5bb1b-fa5e @ Npm-moment-2.24.0
RobertMickleCx/NodeGoat#279](/RobertMickleCx/NodeGoat/issues/279)

Open

[eventualbuddha](/eventualbuddha)
added a commit
to votingworks/vxsuite
that referenced
this pull request
[Mar 20, 2023](#ref-commit-a368f66)
[![@eventualbuddha](https://avatars.githubusercontent.com/u/1938?s=40&v=4)](/eventualbuddha)

`[chore: upgrade luxon](/votingworks/vxsuite/commit/a368f66c112577fb2be28994b7693f8a69708d01 "chore: upgrade luxon

Mitigation for CVE-2023-22467 (see https://github.com/moment/moment/pull/6015#issuecomment-1152961973)")`
…

`[a368f66](/votingworks/vxsuite/commit/a368f66c112577fb2be28994b7693f8a69708d01)`

```
Mitigation for [CVE-2023-22467](https://github.com/advisories/GHSA-3xq5-wjfh-ppjc "CVE-2023-22467") (see [moment/moment#6015 (comment)](https://github.com/moment/moment/pull/6015#issuecomment-1152961973))
```

[![@eventualbuddha](https://avatars.githubusercontent.com/u/1938?s=40&v=4)](/eventualbuddha)
[eventualbuddha](/eventualbuddha)
mentioned this pull request
[Mar 20, 2023](#ref-pullrequest-1632506617)

[chore: upgrade luxon
votingworks/vxsuite#3152](/votingworks/vxsuite/pull/3152)
 Merged

4 tasks

[eventualbuddha](/eventualbuddha)
added a commit
to votingworks/vxsuite
that referenced
this pull request
[Mar 21, 2023](#ref-commit-f11f07b)
[![@eventualbuddha](https://avatars.githubusercontent.com/u/1938?s=40&v=4)](/eventualbuddha)

`[chore: upgrade luxon (](/votingworks/vxsuite/commit/f11f07b6dfc1c1b6abddde649aa4c7d6861ce1e7 "chore: upgrade luxon (#3152)

* chore: upgrade luxon

Mitigation for CVE-2023-22467 (see https://github.com/moment/moment/pull/6015#issuecomment-1152961973)

* chore: update `@types/luxon` and fix usage")[#3152](https://github.com/votingworks/vxsuite/pull/3152)[)](/votingworks/vxsuite/commit/f11f07b6dfc1c1b6abddde649aa4c7d6861ce1e7 "chore: upgrade luxon (#3152)

* chore: upgrade luxon

Mitigation for CVE-2023-22467 (see https://github.com/moment/moment/pull/6015#issuecomment-1152961973)

* chore: update `@types/luxon` and fix usage")`
…

`[f11f07b](/votingworks/vxsuite/commit/f11f07b6dfc1c1b6abddde649aa4c7d6861ce1e7)`

```
* chore: upgrade luxon

Mitigation for [CVE-2023-22467](https://github.com/advisories/GHSA-3xq5-wjfh-ppjc "CVE-2023-22467") (see [moment/moment#6015 (comment)](https://github.com/moment/moment/pull/6015#issuecomment-1152961973))

* chore: update `@types/luxon` and fix usage
```

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Apr 4, 2023](#ref-issue-1654011336)

[High severity - Regular Expression Denial of Service (ReDoS) vulnerability in moment (package.json)
jordaniac89/juice-shop#96](/jordaniac89/juice-shop/issues/96)

Open

This was referenced Apr 5, 2023

[Cx62f5bb1b-fa5e @ Npm-moment-2.29.1
yangricardo/nextjs-tailwind-reacthook-form-ant-design-template#4](/yangricardo/nextjs-tailwind-reacthook-form-ant-design-template/issues/4)

Closed

[CVE-2022-31129 @ Npm-moment-2.29.1
yangricardo/nextjs-tailwind-reacthook-form-ant-design-template#15](/yangricardo/nextjs-tailwind-reacthook-form-ant-design-template/issues/15)

Closed

[![@oliviertassinari](https://avatars.githubusercontent.com/u/3165635?s=40&v=4)](/oliviertassinari)
[oliviertassinari](/oliviertassinari)
mentioned this pull request
[Apr 9, 2023](#ref-pullrequest-1636415556)

[Bump luxon to ^3.2.0 [SECURITY]
mui/mui-x#8347](/mui/mui-x/pull/8347)
 Merged

1 task

[![@nickgraz](https://avatars.githubusercontent.com/u/9541815?s=40&v=4)](/nickgraz)
[nickgraz](/nickgraz)
mentioned this pull request
[Apr 2, 2024](#ref-pullrequest-2060983019)

[Bump moment from 2.29.4 to 2.30.1
terraware/terraware-web#1974](/terraware/terraware-web/pull/1974)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[May 17, 2024](#ref-pullrequest-2299470246)

[More code analysis checks and integrations
kkovaletp/photoview#20](/kkovaletp/photoview/pull/20)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Oct 14, 2024](#ref-pullrequest-2581293011)

[Check dependencies
uniget-org/tools#7651](/uniget-org/tools/pull/7651)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmoment%2Fmoment%2Fpull%2F6015)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Regular Expression Denial of Service (ReDoS)](https://github.com/moment/moment/issues/6012)

4 participants

[![@vovikhangcdv](https://avatars.githubusercontent.com/u/45411113?s=52&v=4)](/vovikhangcdv) [![@ichernev](https://avatars.githubusercontent.com/u/757060?s=52&v=4)](/ichernev) [![@emer7](https://avatars.githubusercontent.com/u/21377166?s=52&v=4)](/emer7) [![@JamieSlome](https://avatars.githubusercontent.com/u/55323451?s=52&v=4)](/JamieSlome)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

