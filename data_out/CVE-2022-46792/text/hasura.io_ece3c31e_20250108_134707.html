[Announcing PromptQL: Build AI apps with Agentic Data Access](https://promptql.hasura.io/) [![Hasura Logo](https://res.cloudinary.com/dh8fp23nd/image/upload/v1686659126/website%20v3/hasura-primary_y9cdnn.svg)](/)

/

Product Developer Resources [Customers](/customers) [Pricing](/pricing) [What is Hasura?](https://hasura.io/products)[Compare Plans](https://hasura.io/pricing)[Get started](https://console.hasura.io/)

Connectors

[PostgreSQL](https://hasura.io/graphql/database/postgresql)[MySQL](https://hasura.io/graphql/database/mysql)[Elasticsearch](https://hasura.io/graphql/database/elasticsearch)[SQL Server](https://hasura.io/graphql/database/sql-server)[MongoDB](https://hasura.io/graphql/database/mongodb)[Snowflake](https://hasura.io/graphql/database/snowflake)[Clickhouse](https://hasura.io/graphql/database/clickhouse)[More](https://hasura.io/connectors)

Developer

[Documentation](https://hasura.io/docs/3.0/index/)[Connector Hub](https://hasura.io/connectors)[Tutorials](https://hasura.io/learn/)[Community](https://hasura.io/community)[Discord](https://discord.com/invite/hasura)[Discussions](https://github.com/hasura/graphql-engine/discussions)[Meetups](https://www.meetup.com/pro/hasura/)[Hasura Community Call](https://hasura.io/events/community-call/latest)

Resources

[Blogs](https://hasura.io/blog)[Webinars](https://hasura.io/events?category=Webinar#wall-section)[Graphql Hub](https://hasura.io/graphql/)[Events](https://hasura.io/events)[Whitepapers](https://hasura.io/resources)[Supergraph Manifesto](https://supergraph.io/)

/

[Contact Us](/contact-us)[Get Started](https://console.hasura.io/?pg=critical-vulnerability-in-hasuras-graphql-engine-v2-10-0)![hasura-header-illustration](https://res.cloudinary.com/dh8fp23nd/image/upload/v1705670474/website%20v3/customers/mutations_1_tdh5ir_yf6n7k.png)ProductDeveloperResources[Customers](https://hasura.io/customers)[Contact Us](https://hasura.io/contact-us)[Get Started](https://console.hasura.io/?pg=critical-vulnerability-in-hasuras-graphql-engine-v2-10-0)[All](/blog)[Latest Stories](/blog#wall-section)[APIs](/blog/tagged/apis)[Authorization](/blog/tagged/authorization)[Performance](/blog/tagged/performance)[Security](/blog/tagged/security)Search for a blog

/

1. [Home](/blog)
2. [Community](/blog/tagged/community)
3. [Critical Vulnerability in Hasura GraphQL Engine v2.10.0-v2.15](/blog/critical-vulnerability-in-hasuras-graphql-engine-v2-10-0)
# Critical Vulnerability in Hasura GraphQL Engine v2.10.0-v2.15

### Introduction

On November 21st, Hasura became aware of a critical security vulnerability within our GraphQL Engine “Update Many” API, which was introduced in version 2.10.0.  The vulnerability was identified by Morten Hillbom and Issaaf Kattan from Nhost's customer company [Celsia.io](https://www.celsia.io). There was a Missing Authorization vulnerability which allowed some expansion of update capabilities of a user. This vulnerability impacted row level authorization on Update Many calls to Postgres datastores.

### Details

In the implementation of the new Update Many API for Postgres backends, there was a bug in the code which would enforce the row level authorization mechanisms.  Since this was within the Update Many API, a user could perform an update on any column they had update permissions to on any row within the target table, and subsequently retrieve any columns they had select permissions on from any impacted rows. In order for this to be exploited, the Update Many API would need to be called against a Postgres datastore, the API would need to not have been disabled using the configuration added in 2.14.0, the caller of the API would need to have update permissions on the target table, and the API would need to not be restricted by Allow Lists.

### Timeline

As noted in the introduction, we became aware of the vulnerability on November 21st, however, this is not a complete representation of the issues encountered.  Morten Hillbom and Issaaf Kattan identified an issue around row level matching and permissions around November 16th which they tracked down to the GraphQL Engine Update Many API.  They reached out following our documented process of emailing [[email protected]](/cdn-cgi/l/email-protection#e280978b8e86a28a8391979083cc8b8d) and provided details about the estimated scope and impact of the vulnerability, however, the email alias listed in the documentation had become misconfigured and was no longer sending its emails to the support ticketing tool. This resulted in our team not seeing the email. Fortunately, they persisted and reached out to Johan Eliasson at [Nhost](https://nhost.io/), who was able to use direct contacts to bring the vulnerability to our attention on November 21st.

Recognizing the dangers inherent in missing authorization and authorization bypass, we quickly investigated and began patching the vulnerability. By the end of the day on November 21st, we had produced a patch and deployed it to our cloud hosted environments. During the night and into the next day, November 22nd, we completed backports of the patch and released builds of all affected versions back to 2.10. Once patches were available, a [security advisory](https://github.com/hasura/graphql-engine/security/advisories/GHSA-g7mj-g7f4-hgrg) was published on GitHub and notifications were sent out on our [security mailing list](https://groups.google.com/g/hasura-security-announce) and to our Cloud and Enterprise customers with limited details and ~10 business days lead to this notification, in order to give users who self-manage Hasura deployments the time needed to apply the patches.

Starting on November 22nd, we created queries to try to track adoption so we would know when it was safest to release these details.

### Remediating Activities

In response to this vulnerability, Hasura has released patches for all impacted versions starting from 2.10 when the vulnerability was introduced and removed all vulnerable versions from docker hub. Hasura continues to monitor usage of vulnerable versions and strongly encourages users to update as soon as possible. For users on 2.14.0 or later, they may turn off the impacted API using --experimental-features=hide\_update\_many\_fields.

In addition to supplying patched versions, Hasura is doing the following:

1. Updating all documentation to use email distribution lists/aliases in order to ensure a human is receiving all messages, even if they are also going into an automated message box
2. Completing an audit of existing mailboxes to ensure all reports have been properly tracked and addressed
3. Updating testing procedures and automated tests in order to prevent regression
4. Redesigning the authorization implementation in order to better ensure all APIs enforce every type of authorization
5. Reviewing Dynamic Application Security Testing (DAST) tool coverage and processes
6. Improving Vulnerability Management processes to ensure layered defenses
7. Building and managing customer notification lists, so we can more easily and readily communicate vulnerabilities in particular types of deploys (Cloud, CE, EE, Postgres, Snowflake, etc.)
8. Updating [Security Best Practices](https://hasura.io/docs/latest/deployment/best-practices/security/) for using Hasura to include layered defenses such as Allow Lists and access reviews.

### Identifying Impacts

You can look into calls to the Update Many API within your services and review any tables which have been the target of these calls. If you have disabled API and telemetry logging or are not certain you keep all of these records long enough, then you should do a consistency check across all of your Postgres datastores behind Hasura 2.10.0 to 2.15.0.

We take these issues very seriously and will be making numerous changes to prevent and respond better in the future. If you have questions, or need assistance, please reach out to [[email protected]](/cdn-cgi/l/email-protection#0b787e7b7b64797f4b636a787e796a256264).

[Timothy Cline](/blog/%40timothy)

07 Dec, 2022

3 MIN READ

###### Share

[Community](/blog/tagged/community)[Security](/blog/tagged/security)[![banner-illustration-image](https://res.cloudinary.com/hasura-cms-uploads/image/upload/v1717758885/sg_arch_guide_b3b306a1af_2d0d85fc1d.png)
##

Read the guide](https://hasura.io/resources/supergraph-architecture-guide)Blog07 Dec, 2022
###### Share

Related reading[Community](/blog/tagged/community)[Announcements](/blog/tagged/announcements)[06 Sep, 2023

2 MIN READ

##### Highlights of August Community Call: Launch Day

In our Community Call: Launch Day event on August 31, we launched some exciting new features. In this blog, we’ll share details about these features, as well as the demo recordings and some useful content to get started with them.](/blog/highlights-of-august-community-call-launch-day)[Community](/blog/tagged/community)[21 Sep, 2022

2 MIN READ

##### Introducing Hasura User Groups (HUGs)

Hasura User Groups are a collective of Hasura user meetups in various locations around the world run by local Hasura champions.](/blog/introducing-hasura-users-groups-hugs)[Community](/blog/tagged/community)[16 Feb, 2022

4 MIN READ

##### Hasura Team Q&A on Reactiflux: Questions & Notes

The Hasura Team (Tanmai Gopal, Praveen Durairaju and Jesse Martin) took part in the latest Q&A on Reactiflux and we had a lot of interesting questions from the community. We have handpicked the ones related to Hasura and featured them in this post.](/blog/hasura-team-q-a-reactiflux-questions-notes)![Email](https://res.cloudinary.com/dh8fp23nd/image/upload/v1686839086/v3-website/mail_yhjkr4.png)Subscribe to stay up-to-date on all things Hasura. One newsletter, once a month.
##### Loading...

![v3-pattern](https://res.cloudinary.com/dh8fp23nd/image/upload/v1686839086/v3-website/illu_vqqsdb.png)Accelerate development and data access with radically reduced complexity.[Get started for free](https://console.hasura.io/?pg=critical-vulnerability-in-hasuras-graphql-engine-v2-10-0&plcmt=pre-footer&cta=get-started-for-free&tech=default)[![Hasura](https://res.cloudinary.com/dh8fp23nd/image/upload/v1686659126/website%20v3/hasura-primary_y9cdnn.svg)](https://hasura.io/)Platform[Hasura DDN](https://hasura.io/products)[Connectors](https://hasura.io/connectors)[Pricing](https://hasura.io/pricing)[Security](https://hasura.io/security/)Build[Docs](https://hasura.io/docs/3.0/index/)[Tutorials](https://hasura.io/learn/)[GitHub](https://github.com/hasura)Learn[Blog](https://hasura.io/blog)[Events](https://hasura.io/events)[Supergraph.io](https://supergraph.io/)[GraphQL Hub](https://hasura.io/graphql/)Company[Our Story](https://hasura.io/about/)[Careers](https://hasura.io/careers/)[Partners](https://hasura.io/partners)[Legal](https://hasura.io/legal)[Cookie Policy](https://hasura.io/legal/hasura-cookie-policy)[Privacy Policy](https://hasura.io/legal/hasura-privacy-policy)Connect[Community](https://hasura.io/community)[Discord](https://discord.com/invite/hasura)[Forum](https://github.com/hasura/graphql-engine/discussions)[Meetups](https://www.meetup.com/pro/hasura/)[Monthly call](https://hasura.io/events/community-call/latest)[Support](https://hasura.io/support-hub)[Contact Us](https://hasura.io/contact-us)© 2025 Hasura Inc. All rights reserved