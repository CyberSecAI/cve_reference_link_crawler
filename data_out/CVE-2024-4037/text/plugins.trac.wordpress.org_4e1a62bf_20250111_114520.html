

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3078746%2540wp-photo-album-plus%26old%3D3078746%2540wp-photo-album-plus)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3077582/wp-photo-album-plus "Changeset 3077582 for wp-photo-album-plus")
* [Next Change](/changeset/3078783/wp-photo-album-plus "Changeset 3078783 for wp-photo-album-plus") →

---

# Changeset [3078746](/changeset/3078746 "Show full changeset") for [wp-photo-album-plus](/browser/wp-photo-album-plus?rev=3078746 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
04/29/2024 01:29:29 PM
([9 months](/timeline?from=2024-04-29T13%3A29%3A29Z&precision=second "See timeline at 04/29/2024 01:29:29 PM") ago)

Author:
opajaap
Message:

8.7.02.002

Location:
[wp-photo-album-plus/trunk](/browser/wp-photo-album-plus/trunk?rev=3078746)
Files:

17 edited

* [blocks/common/index.php](/browser/wp-photo-album-plus/trunk/blocks/common/index.php?rev=3078746 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [changelog.txt](/browser/wp-photo-album-plus/trunk/changelog.txt?rev=3078746 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [wppa-admin-local-js.php](/browser/wp-photo-album-plus/trunk/wppa-admin-local-js.php?rev=3078746 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [wppa-ajax.php](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3078746 "Show entry in browser")
  (modified)
  ([8 diffs](#file3 "Show differences"))
* [wppa-album-admin-autosave.php](/browser/wp-photo-album-plus/trunk/wppa-album-admin-autosave.php?rev=3078746 "Show entry in browser")
  (modified)
  ([3 diffs](#file4 "Show differences"))
* [wppa-filter.php](/browser/wp-photo-album-plus/trunk/wppa-filter.php?rev=3078746 "Show entry in browser")
  (modified)
  ([3 diffs](#file5 "Show differences"))
* [wppa-functions.php](/browser/wp-photo-album-plus/trunk/wppa-functions.php?rev=3078746 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))
* [wppa-listtable.php](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746 "Show entry in browser")
  (modified)
  ([24 diffs](#file7 "Show differences"))
* [wppa-slideshow-widget.php](/browser/wp-photo-album-plus/trunk/wppa-slideshow-widget.php?rev=3078746 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [wppa-stats-widget.php](/browser/wp-photo-album-plus/trunk/wppa-stats-widget.php?rev=3078746 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [wppa-stereo-widget.php](/browser/wp-photo-album-plus/trunk/wppa-stereo-widget.php?rev=3078746 "Show entry in browser")
  (modified)
  ([2 diffs](#file10 "Show differences"))
* [wppa-super-view-widget.php](/browser/wp-photo-album-plus/trunk/wppa-super-view-widget.php?rev=3078746 "Show entry in browser")
  (modified)
  ([3 diffs](#file11 "Show differences"))
* [wppa-tagcloud-widget.php](/browser/wp-photo-album-plus/trunk/wppa-tagcloud-widget.php?rev=3078746 "Show entry in browser")
  (modified)
  ([3 diffs](#file12 "Show differences"))
* [wppa-thumbnail-widget.php](/browser/wp-photo-album-plus/trunk/wppa-thumbnail-widget.php?rev=3078746 "Show entry in browser")
  (modified)
  ([3 diffs](#file13 "Show differences"))
* [wppa-topten-widget.php](/browser/wp-photo-album-plus/trunk/wppa-topten-widget.php?rev=3078746 "Show entry in browser")
  (modified)
  ([3 diffs](#file14 "Show differences"))
* [wppa-upldr-widget.php](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3078746 "Show entry in browser")
  (modified)
  ([7 diffs](#file15 "Show differences"))
* [wppa.php](/browser/wp-photo-album-plus/trunk/wppa.php?rev=3078746 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-photo-album-plus/trunk/blocks/common/index.php](/changeset/3078746/wp-photo-album-plus/trunk/blocks/common/index.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/blocks/common/index.php")

  | [r2973494](/browser/wp-photo-album-plus/trunk/blocks/common/index.php?rev=2973494#L3 "Show revision 2973494 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/blocks/common/index.php?rev=3078746#L3 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* WPPA common block functions |
  | 4 | 4 | \* |
  | 5 |  | \* Version: 8.~~5.01.001~~ |
  |  | 5 | \* Version: 8.7.02.002 |
  | 6 | 6 | \*/ |
  | 7 | 7 |  |
  | […](/browser/wp-photo-album-plus/trunk/blocks/common/index.php?rev=2973494#L20) | […](/browser/wp-photo-album-plus/trunk/blocks/common/index.php?rev=3078746#L20) |  |
  | 20 | 20 | { |
  | 21 | 21 | // Get all album names and ids |
  | 22 |  | $albums = $wpdb->get\_results(   "SELECT id, name |
  | 23 |  | FROM $wpdb->wppa\_albums", |
  | 24 |  | ARRAY\_A |
  | 25 |  | ); |
  |  | 22 | $albums = $wpdb->get\_results( "SELECT id, name FROM $wpdb->wppa\_albums", ARRAY\_A ); |
  | 26 | 23 |  |
  | 27 | 24 | // Add paths |
* ## [wp-photo-album-plus/trunk/changelog.txt](/changeset/3078746/wp-photo-album-plus/trunk/changelog.txt "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/changelog.txt")

  | [r3077580](/browser/wp-photo-album-plus/trunk/changelog.txt?rev=3077580#L4 "Show revision 3077580 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/changelog.txt?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 |  |
  | 5 | 5 | \* Some Album settings on the Albums -> Edit screen did not work or even caused a security error. Fixed. |
  |  | 6 | \* Changing settings on the Albums -> Edit screen that affects the cover display are now back to update the cover preview. |
  |  | 7 | \* Security fixes a.o. one can no longer execute arbitrary shortcodes using the delay mechanism via ajax calls. |
  | 6 | 8 |  |
  | 7 | 9 | = 8.7.01 = |
* ## [wp-photo-album-plus/trunk/wppa-admin-local-js.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-admin-local-js.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-admin-local-js.php")

  | [r3074859](/browser/wp-photo-album-plus/trunk/wppa-admin-local-js.php?rev=3074859#L4 "Show revision 3074859 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-admin-local-js.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* local js code for admin pages |
  | 6 |  | \* Version 8.7.0~~1.003~~ |
  |  | 6 | \* Version 8.7.02.002 |
  | 7 | 7 | \* |
  | 8 | 8 | \*/ |
  | […](/browser/wp-photo-album-plus/trunk/wppa-admin-local-js.php?rev=3074859#L441) | […](/browser/wp-photo-album-plus/trunk/wppa-admin-local-js.php?rev=3078746#L441) |  |
  | 441 | 441 | function wppaGetCoverPreview( albumId, divId ) { |
  | 442 | 442 |  |
  |  | 443 | var alb = albumId; |
  |  | 444 |  |
  | 443 | 445 | jQuery.ajax( { |
  | 444 | 446 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-admin-local-js.php?rev=3074859#L446) | […](/browser/wp-photo-album-plus/trunk/wppa-admin-local-js.php?rev=3078746#L448) |  |
  | 446 | 448 | data:       "action=wppa" + |
  | 447 | 449 | "&wppa-action=getshortcodedrendered" + |
  | 448 |  | "&shortcode=[wppa type=\"cover\" album=\""+alb~~umId~~+"\"]", |
  |  | 450 | "&shortcode=[wppa type=\"cover\" album=\""+alb+"\"]", |
  | 449 | 451 | async:      true, |
  | 450 | 452 | type:       "GET", |
* ## [wp-photo-album-plus/trunk/wppa-ajax.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-ajax.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-ajax.php")

  | [r3074859](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3074859#L3 "Show revision 3074859 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3078746#L3 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* |
  | 4 | 4 | \* Functions used in ajax requests |
  | 5 |  | \* Version: 8.7.0~~1.003~~ |
  |  | 5 | \* Version: 8.7.02.002 |
  | 6 | 6 | \* |
  | 7 | 7 | \*/ |
  | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3074859#L1142) | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3078746#L1142) |  |
  | 1142 | 1142 | $shouldbe = wp\_create\_nonce( 'wppa-check' ); |
  | 1143 | 1143 | wppa\_log( 'err', 'Nonce expected = '.$shouldbe.', found = '.$nonce); |
  | 1144 |  | echo esc\_html( $nonce ); |
  | 1145 |  | wppa\_secfail( '99' ); |
  | 1146 |  | } |
  |  | 1144 | echo wp\_json\_encode( ['html' => \_\_( 'Security check failure', 'wp-photo-album-plus' ), 'js' => ''] ); |
  |  | 1145 | wppa\_exit(); |
  |  | 1146 | } |
  |  | 1147 |  |
  |  | 1148 | // Is it a valid shortcode? |
  |  | 1149 | $shortcode = wppa\_get( 'shortcode' ); |
  |  | 1150 | if ( $shortcode != '[wppa]' && substr( $shortcode, 0, 6 ) != '[wppa ' && ( substr( $shortcode, 0, 7 ) != '[photo ' || ! wppa\_switch( 'photo\_shortcode\_enabled' ) ) ) { |
  |  | 1151 | wppa\_log('war', 'Shortcode '.$shortcode.' rejected'); |
  |  | 1152 | echo wp\_json\_encode( ['html' => \_\_( 'Shortcodee check failure', 'wp-photo-album-plus' ), 'js' => ''] ); |
  |  | 1153 | wppa\_exit(); |
  |  | 1154 | } |
  |  | 1155 | wppa\_log('misc', 'Shortcode '.$shortcode.' accepted'); |
  | 1147 | 1156 |  |
  | 1148 | 1157 | // Yes |
  | 1149 | 1158 | ob\_start(); |
  | 1150 | 1159 | wppa\_load\_theme(); |
  | 1151 |  | ~~$shortcode = wppa\_get( 'shortcode' );~~ |
  | 1152 | 1160 | wppa( 'mocc', wppa\_get( 'mocc' ) - 1 ); |
  | 1153 | 1161 | $result = do\_shortcode( str\_replace( '%23', '#', $shortcode ) ); |
  | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3074859#L1162) | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3078746#L1170) |  |
  | 1162 | 1170 | if ( $result['js'] ) { |
  | 1163 | 1171 | $js .= $result['js']; |
  | 1164 |  |  |
  | 1165 |  | ~~// Issue warning message~~ |
  | 1166 |  | ~~wppa\_log( 'dbg', strlen( $result['js'] ) . ' chars of unexpected js found in ajax getshortcodedrenderedfenodelay. $\_REQUEST = ' . htmlspecialchars( var\_export( $\_REQUEST, true ) ) );~~ |
  | 1167 | 1172 | } |
  | 1168 | 1173 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3074859#L1181) | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3078746#L1186) |  |
  | 1181 | 1186 |  |
  | 1182 | 1187 | // Output |
  | 1183 |  | $the\_result = wp\_json\_encode( ['html' => $html, 'js' => $js] ); |
  | 1184 |  | echo $the\_result; |
  |  | 1188 | echo wp\_json\_encode( ['html' => $html, 'js' => $js] ); |
  | 1185 | 1189 |  |
  | 1186 | 1190 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3074859#L1646) | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3078746#L1650) |  |
  | 1646 | 1650 |  |
  | 1647 | 1651 | // Output |
  | 1648 |  | $the\_result = wp\_json\_encode( ['html' => $html, 'js' => $js] ); |
  | 1649 |  | echo $the\_result; |
  |  | 1652 | echo wp\_json\_encode( ['html' => $html, 'js' => $js] ); |
  | 1650 | 1653 |  |
  | 1651 | 1654 | $tim\_2  = microtime( true ); |
  | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3074859#L4178) | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3078746#L4181) |  |
  | 4178 | 4181 | $pool       = wppa\_get\_potd\_pool\_html(); |
  | 4179 | 4182 |  |
  | 4180 |  | $result = wp\_json\_encode( ['offset' => $offset, 'seqno' => $seqno, 'preview' => $preview, 'pool' => $pool] ); |
  | 4181 |  | echo $result; |
  |  | 4183 | echo wp\_json\_encode( ['offset' => $offset, 'seqno' => $seqno, 'preview' => $preview, 'pool' => $pool] ); |
  | 4182 | 4184 | break; |
  | 4183 | 4185 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3074859#L4190) | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3078746#L4192) |  |
  | 4190 | 4192 | wppa\_create\_all\_textual\_watermark\_files(); |
  | 4191 | 4193 |  |
  | 4192 |  | $result = wp\_json\_encode( ['url' => $url] ); |
  | 4193 |  | wppa\_log( 'misc', 'echoing:'.$result); |
  | 4194 |  | echo $result; |
  |  | 4194 | echo wp\_json\_encode( ['url' => $url] ); |
  | 4195 | 4195 | break; |
  | 4196 | 4196 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3074859#L4349) | […](/browser/wp-photo-album-plus/trunk/wppa-ajax.php?rev=3078746#L4349) |  |
  | 4349 | 4349 | } |
  | 4350 | 4350 |  |
  | 4351 |  | $result = '||' . $err . '||' . wp\_json\_encode( $data ); |
  | 4352 |  |  |
  | 4353 |  | wppa\_log( 'dbg', $result ); |
  | 4354 |  |  |
  | 4355 |  | echo $result; |
  |  | 4351 | echo esc\_html( '||' . $err . '||' ) . wp\_json\_encode( $data ); |
  | 4356 | 4352 | wppa\_exit(); |
  | 4357 | 4353 | } |
* ## [wp-photo-album-plus/trunk/wppa-album-admin-autosave.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-album-admin-autosave.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-album-admin-autosave.php")

  | [r3077580](/browser/wp-photo-album-plus/trunk/wppa-album-admin-autosave.php?rev=3077580#L4 "Show revision 3077580 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-album-admin-autosave.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* create, edit and delete albums |
  | 6 |  | \* Version 8.7.02.00~~1~~ |
  |  | 6 | \* Version 8.7.02.002 |
  | 7 | 7 | \* |
  | 8 | 8 | \*/ |
  | […](/browser/wp-photo-album-plus/trunk/wppa-album-admin-autosave.php?rev=3077580#L474) | […](/browser/wp-photo-album-plus/trunk/wppa-album-admin-autosave.php?rev=3078746#L474) |  |
  | 474 | 474 |  |
  | 475 | 475 | // Local js functions |
  | 476 |  | $the\_js = 'jQuery(document).ready(function(){wppaGetCoverPreview('.$id.', "cover-preview-"+~~'.$id.~~')});'; |
  |  | 476 | $the\_js = 'jQuery(document).ready(function(){wppaGetCoverPreview('.$id.', "cover-preview-"+\''.$crid.'\')});'; |
  | 477 | 477 | wppa\_add\_inline\_script( 'wppa-admin', $the\_js, false ); |
  | 478 | 478 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-album-admin-autosave.php?rev=3077580#L1869) | […](/browser/wp-photo-album-plus/trunk/wppa-album-admin-autosave.php?rev=3078746#L1869) |  |
  | 1869 | 1869 | // wppaGetCoverPreview( albumId, divId ) |
  | 1870 | 1870 | // Preview album cover |
  | 1871 |  | wppa\_echo( '<div id="cover-preview-'.$id.'" style="clear:both;max-width:100%"></div>' ); |
  |  | 1871 | wppa\_echo( '<div id="cover-preview-'.$crid.'" style="clear:both;max-width:100%"></div>' ); |
  | 1872 | 1872 |  |
  | 1873 | 1873 | wppa\_echo('</fieldset>'); |
* ## [wp-photo-album-plus/trunk/wppa-filter.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-filter.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-filter.php")

  | [r3072310](/browser/wp-photo-album-plus/trunk/wppa-filter.php?rev=3072310#L4 "Show revision 3072310 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-filter.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* get the albums via shortcode handler |
  | 6 |  | \* Version: 8.7.0~~1.001~~ |
  |  | 6 | \* Version: 8.7.02.002 |
  | 7 | 7 | \* |
  | 8 | 8 | \*/ |
  | […](/browser/wp-photo-album-plus/trunk/wppa-filter.php?rev=3072310#L725) | […](/browser/wp-photo-album-plus/trunk/wppa-filter.php?rev=3078746#L725) |  |
  | 725 | 725 | global $wppa\_forced\_mocc; |
  | 726 | 726 | global $wppa\_is\_caching; |
  |  | 727 | global $wpdb; |
  | 727 | 728 |  |
  | 728 | 729 | $atts = [ |
  | […](/browser/wp-photo-album-plus/trunk/wppa-filter.php?rev=3072310#L811) | […](/browser/wp-photo-album-plus/trunk/wppa-filter.php?rev=3078746#L812) |  |
  | 811 | 812 | } |
  | 812 | 813 |  |
  |  | 814 | // If album is encrypted, decrypt it ( happens in cover preview ) |
  |  | 815 | if ( isset( $xatts['album'] ) ) { |
  |  | 816 | $a = $wpdb->get\_var( $wpdb->prepare( "SELECT id FROM $wpdb->wppa\_albums WHERE crypt = %s", $xatts['album'] ) ); |
  |  | 817 | if ( $a ) $xatts['album'] = $a; |
  |  | 818 | } |
  |  | 819 |  |
  | 813 | 820 | // Caching? |
  | 814 | 821 | switch( wppa\_opt( 'cache\_overrule' ) ) { |
* ## [wp-photo-album-plus/trunk/wppa-functions.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-functions.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-functions.php")

  | [r3072310](/browser/wp-photo-album-plus/trunk/wppa-functions.php?rev=3072310#L4 "Show revision 3072310 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-functions.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* Various functions |
  | 6 |  | \* Version: 8.7.0~~1.001~~ |
  |  | 6 | \* Version: 8.7.02.002 |
  | 7 | 7 | \* |
  | 8 | 8 | \*/ |
  | […](/browser/wp-photo-album-plus/trunk/wppa-functions.php?rev=3072310#L4826) | […](/browser/wp-photo-album-plus/trunk/wppa-functions.php?rev=3078746#L4826) |  |
  | 4826 | 4826 | $ok = wp\_verify\_nonce( $nonce, 'wppa-check' ); |
  | 4827 | 4827 | if ( ! $ok ) { |
  | 4828 |  | die( '<b>' . ~~\_\_( 'ERROR: Illegal attempt to upload a file.', 'wp-photo-album-plus' ) . '</b>'~~); |
  |  | 4828 | die( '<b>' . esc\_html\_\_( 'ERROR: Illegal attempt to upload a file.', 'wp-photo-album-plus' ) . '</b>' ); |
  | 4829 | 4829 | } |
  | 4830 | 4830 |  |
* ## [wp-photo-album-plus/trunk/wppa-listtable.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-listtable.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-listtable.php")

  | [r2910633](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L5 "Show revision 2910633 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L5 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Copy of wp version |
  | 6 | 6 | \* Modified by OpaJaap |
  | 7 |  | \* Version 8.~~4.01.001~~ |
  |  | 7 | \* Version 8.7.02.002 |
  | 8 | 8 | \* |
  | 9 | 9 | \*/ |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L168) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L168) |  |
  | 168 | 168 | // Message to be displayed when there are no items |
  | 169 | 169 | public function no\_items() { |
  | 170 |  | \_e( 'No items found.' ); |
  |  | 170 | esc\_html\_e( 'No items found.' ); |
  | 171 | 171 | } |
  | 172 | 172 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L193) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L193) |  |
  | 193 | 193 | ?> |
  | 194 | 194 | <p class="search-box"> |
  | 195 |  | <label class="screen-reader-text" for="<?php echo esc\_attr( $input\_id ); ?>"><?php echo ~~$text~~; ?>:</label> |
  |  | 195 | <label class="screen-reader-text" for="<?php echo esc\_attr( $input\_id ); ?>"><?php echo esc\_html( $text ); ?>:</label> |
  | 196 | 196 | <input type="search" id="<?php echo esc\_attr( $input\_id ); ?>" name="s" value="<?php \_admin\_search\_query(); ?>" /> |
  | 197 | 197 | <?php submit\_button( $text, '', '', false, array( 'id' => 'search-submit' ) ); ?> |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L267) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L267) |  |
  | 267 | 267 | // Displays the list of views available on this table. |
  | 268 | 268 | public function views() { |
  |  | 269 | } |
  |  | 270 | /\* |
  | 269 | 271 | $views = $this->get\_views(); |
  | 270 | 272 | /\*\* |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L278) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L280) |  |
  | 278 | 280 | \* @param string[] $views An array of available list table views. |
  | 279 | 281 | \*/ |
  |  | 282 | /\* |
  | 280 | 283 | $views = apply\_filters( "views\_{$this->screen->id}", $views ); |
  | 281 | 284 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L293) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L296) |  |
  | 293 | 296 | echo '</ul>'; |
  | 294 | 297 | } |
  |  | 298 | \*/ |
  | 295 | 299 |  |
  | 296 | 300 | // Retrieves the list of bulk actions available for this table. |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L301) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L305) |  |
  | 301 | 305 | // Displays the bulk actions dropdown. |
  | 302 | 306 | protected function bulk\_actions( $which = '' ) { |
  |  | 307 | } |
  |  | 308 | /\* |
  | 303 | 309 | if ( is\_null( $this->\_actions ) ) { |
  | 304 | 310 | $this->\_actions = $this->get\_bulk\_actions(); |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L315) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L321) |  |
  | 315 | 321 | \* @param array $actions An array of the available bulk actions. |
  | 316 | 322 | \*/ |
  |  | 323 | /\* |
  | 317 | 324 | $this->\_actions = apply\_filters( "bulk\_actions-{$this->screen->id}", $this->\_actions ); // phpcs:ignore WordPress.NamingConventions.ValidHookName.UseUnderscores |
  | 318 | 325 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L352) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L359) |  |
  | 352 | 359 | echo "\n"; |
  | 353 | 360 | } |
  |  | 361 | \*/ |
  | 354 | 362 |  |
  | 355 | 363 | // Gets the current action selected from the bulk actions dropdown. |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L465) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L473) |  |
  | 465 | 473 | $m = isset( $\_GET['m'] ) ? (int) $\_GET['m'] : 0; |
  | 466 | 474 | ?> |
  | 467 |  | <label for="filter-by-date" class="screen-reader-text"><?php ~~echo get\_post\_type\_object( $post\_type )->labels->filter\_by\_date~~; ?></label> |
  |  | 475 | <label for="filter-by-date" class="screen-reader-text"><?php wppa\_echo( get\_post\_type\_object( $post\_type )->labels->filter\_by\_date ); ?></label> |
  | 468 | 476 | <select name="m" id="filter-by-date"> |
  | 469 |  | <option<?php selected( $m, 0 ); ?> value="0"><?php \_e( 'All dates' ); ?></option> |
  |  | 477 | <option<?php selected( $m, 0 ); ?> value="0"><?php esc\_html\_e( 'All dates' ); ?></option> |
  | 470 | 478 | <?php |
  | 471 | 479 | foreach ( $months as $arc\_row ) { |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L482) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L490) |  |
  | 482 | 490 | esc\_attr( $arc\_row->year . $month ), |
  | 483 | 491 | /\* translators: 1: Month name, 2: 4-digit year. \*/ |
  | 484 |  | sprintf( ( '%1$s %2$d' ), ~~$wp\_locale->get\_month( $month ), $year~~ ) |
  |  | 492 | sprintf( ( '%1$s %2$d' ), esc\_html( $wp\_locale->get\_month( $month ) ), esc\_html( $year ) ) |
  | 485 | 493 | ); |
  | 486 | 494 | } |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L492) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L500) |  |
  | 492 | 500 | // Displays a view switcher. |
  | 493 | 501 | protected function view\_switcher( $current\_mode ) { |
  |  | 502 | } |
  |  | 503 | /\* |
  | 494 | 504 | ?> |
  | 495 | 505 | <input type="hidden" name="mode" value="<?php echo esc\_attr( $current\_mode ); ?>" /> |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L516) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L526) |  |
  | 516 | 526 | <?php |
  | 517 | 527 | } |
  |  | 528 | \*/ |
  | 518 | 529 |  |
  | 519 | 530 | // Displays a comment count bubble. |
  | 520 | 531 | protected function comments\_bubble( $post\_id, $pending\_comments ) { |
  |  | 532 | } |
  |  | 533 | /\* |
  | 521 | 534 | $approved\_comments = get\_comments\_number(); |
  | 522 | 535 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L526) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L539) |  |
  | 526 | 539 | $approved\_only\_phrase = sprintf( |
  | 527 | 540 | /\* translators: %s: Number of comments. \*/ |
  |  | 541 | /\* |
  | 528 | 542 | \_n( '%s comment', '%s comments', $approved\_comments ), |
  | 529 | 543 | $approved\_comments\_number |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L532) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L546) |  |
  | 532 | 546 | $approved\_phrase = sprintf( |
  | 533 | 547 | /\* translators: %s: Number of comments. \*/ |
  |  | 548 | /\* |
  | 534 | 549 | \_n( '%s approved comment', '%s approved comments', $approved\_comments ), |
  | 535 | 550 | $approved\_comments\_number |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L538) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L553) |  |
  | 538 | 553 | $pending\_phrase = sprintf( |
  | 539 | 554 | /\* translators: %s: Number of comments. \*/ |
  |  | 555 | /\* |
  | 540 | 556 | \_n( '%s pending comment', '%s pending comments', $pending\_comments ), |
  | 541 | 557 | $pending\_comments\_number |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L603) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L619) |  |
  | 603 | 619 | } |
  | 604 | 620 | } |
  |  | 621 | \*/ |
  | 605 | 622 |  |
  | 606 | 623 | // Gets the current page number. |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L810) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L827) |  |
  | 810 | 827 | $this->\_pagination = "<div class='tablenav-pages{$page\_class}'>$output</div>"; |
  | 811 | 828 |  |
  | 812 |  | ~~echo $this->\_pagination~~; |
  |  | 829 | wppa\_echo( $this->\_pagination ); |
  | 813 | 830 | } |
  | 814 | 831 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L1057) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L1074) |  |
  | 1057 | 1074 | } |
  | 1058 | 1075 |  |
  | 1059 |  | ~~echo "<$tag $scope $id $class>$column\_display\_name</$tag>"~~; |
  |  | 1076 | wppa\_echo( "<$tag $scope $id $class>$column\_display\_name</$tag>" ); |
  | 1060 | 1077 | } |
  | 1061 | 1078 | } |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L1073) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L1090) |  |
  | 1073 | 1090 | $this->screen->render\_screen\_reader\_content( 'heading\_list' ); |
  | 1074 | 1091 | ?> |
  | 1075 |  | <table class="wp-list-table <?php ~~echo implode( ' ', $this->get\_table\_classes(~~) ); ?>"> |
  |  | 1092 | <table class="wp-list-table <?php wppa\_echo( implode( ' ', $this->get\_table\_classes() ) ); ?>"> |
  | 1076 | 1093 | <thead> |
  | 1077 | 1094 | <tr> |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L1083) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L1100) |  |
  | 1083 | 1100 | <?php |
  | 1084 | 1101 | if ( $singular ) { |
  | 1085 |  | ~~echo " data-wp-lists='list:$singular'"~~; |
  |  | 1102 | wppa\_echo( " data-wp-lists='list:$singular'" ); |
  | 1086 | 1103 | } |
  | 1087 | 1104 | ?> |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L1162) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L1179) |  |
  | 1162 | 1179 | $this->display\_rows(); |
  | 1163 | 1180 | } else { |
  | 1164 |  | ~~echo '<tr class="no-items"><td class="colspanchange" colspan="' . $this->get\_column\_count() . '">'~~; |
  |  | 1181 | wppa\_echo( '<tr class="no-items"><td class="colspanchange" colspan="' . $this->get\_column\_count() . '">' ); |
  | 1165 | 1182 | $this->no\_items(); |
  | 1166 | 1183 | echo '</td></tr>'; |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L1230) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L1247) |  |
  | 1230 | 1247 |  |
  | 1231 | 1248 | if ( 'cb' === $column\_name ) { |
  | 1232 |  | ~~echo '<th scope="row" class="check-column">'~~; |
  | 1233 |  | ~~echo $this->column\_cb( $item~~ ); |
  | 1234 |  | ~~echo '</th>'~~; |
  |  | 1249 | wppa\_echo( '<th scope="row" class="check-column">' ); |
  |  | 1250 | wppa\_echo( $this->column\_cb( $item ) ); |
  |  | 1251 | wppa\_echo( '</th>' ); |
  | 1235 | 1252 | } elseif ( method\_exists( $this, '\_column\_' . $column\_name ) ) { |
  | 1236 |  | ~~echo~~ call\_user\_func( |
  |  | 1253 | wppa\_echo( call\_user\_func( |
  | 1237 | 1254 | array( $this, '\_column\_' . $column\_name ), |
  | 1238 | 1255 | $item, |
  | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=2910633#L1240) | […](/browser/wp-photo-album-plus/trunk/wppa-listtable.php?rev=3078746#L1257) |  |
  | 1240 | 1257 | $data, |
  | 1241 | 1258 | $primary |
  | 1242 |  | ); |
  |  | 1259 | ) ); |
  | 1243 | 1260 | } elseif ( method\_exists( $this, 'column\_' . $column\_name ) ) { |
  | 1244 |  | ~~echo "<td $attributes>"~~; |
  | 1245 |  | ~~echo call\_user\_func( array( $this, 'column\_' . $column\_name ), $item~~ ); |
  | 1246 |  | ~~echo $this->handle\_row\_actions( $item, $column\_name, $primary~~ ); |
  | 1247 |  | ~~echo '</td>'~~; |
  |  | 1261 | wppa\_echo( "<td $attributes>" ); |
  |  | 1262 | wppa\_echo( call\_user\_func( array( $this, 'column\_' . $column\_name ), $item ) ); |
  |  | 1263 | wppa\_echo( $this->handle\_row\_actions( $item, $column\_name, $primary ) ); |
  |  | 1264 | wppa\_echo( '</td>' ); |
  | 1248 | 1265 | } else { |
  | 1249 |  | ~~echo "<td $attributes>"~~; |
  | 1250 |  | ~~echo $this->column\_default( $item, $column\_name~~ ); |
  | 1251 |  | ~~echo $this->handle\_row\_actions( $item, $column\_name, $primary~~ ); |
  | 1252 |  | ~~echo '</td>'~~; |
  |  | 1266 | wppa\_echo( "<td $attributes>" ); |
  |  | 1267 | wppa\_echo( $this->column\_default( $item, $column\_name ) ); |
  |  | 1268 | wppa\_echo( $this->handle\_row\_actions( $item, $column\_name, $primary ) ); |
  |  | 1269 | wppa\_echo( '</td>' ); |
  | 1253 | 1270 | } |
  | 1254 | 1271 | } |
* ## [wp-photo-album-plus/trunk/wppa-slideshow-widget.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-slideshow-widget.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-slideshow-widget.php")

  | [r3075861](/browser/wp-photo-album-plus/trunk/wppa-slideshow-widget.php?rev=3075861#L4 "Show revision 3075861 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-slideshow-widget.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* display a slideshow in the sidebar |
  | 6 |  | \* Version: 8.7.0~~1.001~~ |
  |  | 6 | \* Version: 8.7.02.002 |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-slideshow-widget.php?rev=3075861#L47) | […](/browser/wp-photo-album-plus/trunk/wppa-slideshow-widget.php?rev=3078746#L47) |  |
  | 47 | 47 | echo wppa\_get\_contents( $cachefile ); |
  | 48 | 48 | wppa\_update\_option( 'wppa\_cache\_hits', wppa\_get\_option( 'wppa\_cache\_hits', 0 ) +1 ); |
  | 49 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title, true~~ ); |
  |  | 49 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title, true ) ); |
  | 50 | 50 | wppa( 'in\_widget', false ); |
  | 51 | 51 | return; |
* ## [wp-photo-album-plus/trunk/wppa-stats-widget.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-stats-widget.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-stats-widget.php")

  | [r3075861](/browser/wp-photo-album-plus/trunk/wppa-stats-widget.php?rev=3075861#L4 "Show revision 3075861 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-stats-widget.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* display the stats widget |
  | 6 |  | \* Version 8.7.0~~1.001~~ |
  |  | 6 | \* Version 8.7.02.002 |
  | 7 | 7 | \* |
  | 8 | 8 | \*/ |
  | […](/browser/wp-photo-album-plus/trunk/wppa-stats-widget.php?rev=3075861#L134) | […](/browser/wp-photo-album-plus/trunk/wppa-stats-widget.php?rev=3078746#L134) |  |
  | 134 | 134 |  |
  | 135 | 135 | wppa\_echo( $result ); |
  | 136 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title~~ ); |
  |  | 136 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title ) ); |
  | 137 | 137 |  |
  | 138 | 138 | wppa( 'in\_widget', false ); |
* ## [wp-photo-album-plus/trunk/wppa-stereo-widget.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-stereo-widget.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-stereo-widget.php")

  | [r2938690](/browser/wp-photo-album-plus/trunk/wppa-stereo-widget.php?rev=2938690#L4 "Show revision 2938690 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-stereo-widget.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* display the top rated photos |
  | 6 |  | \* Version: 8.~~4.03~~.002 |
  |  | 6 | \* Version: 8.7.02.002 |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-stereo-widget.php?rev=2938690#L46) | […](/browser/wp-photo-album-plus/trunk/wppa-stereo-widget.php?rev=3078746#L46) |  |
  | 46 | 46 |  |
  | 47 | 47 | wppa\_echo( $result ); |
  | 48 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title~~ ); |
  |  | 48 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title ) ); |
  | 49 | 49 |  |
  | 50 | 50 | wppa( 'in\_widget', false ); |
* ## [wp-photo-album-plus/trunk/wppa-super-view-widget.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-super-view-widget.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-super-view-widget.php")

  | [r2938690](/browser/wp-photo-album-plus/trunk/wppa-super-view-widget.php?rev=2938690#L4 "Show revision 2938690 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-super-view-widget.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* ask the album / display you want |
  | 6 |  | \* Version: 8.~~4.03~~.002 |
  |  | 6 | \* Version: 8.7.02.002 |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-super-view-widget.php?rev=2938690#L37) | […](/browser/wp-photo-album-plus/trunk/wppa-super-view-widget.php?rev=3078746#L37) |  |
  | 37 | 37 | // Cache? |
  | 38 | 38 | if ( $cache && wppa\_is\_file( $cachefile ) ) { |
  | 39 |  | ~~echo wppa\_get\_contents( $cachefile~~ ); |
  |  | 39 | wppa\_echo( wppa\_get\_contents( $cachefile ) ); |
  | 40 | 40 | wppa\_update\_option( 'wppa\_cache\_hits', wppa\_get\_option( 'wppa\_cache\_hits', 0 ) +1 ); |
  | 41 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title, true~~ ); |
  |  | 41 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title, true ) ); |
  | 42 | 42 | wppa( 'in\_widget', false ); |
  | 43 | 43 | return; |
  | […](/browser/wp-photo-album-plus/trunk/wppa-super-view-widget.php?rev=2938690#L59) | […](/browser/wp-photo-album-plus/trunk/wppa-super-view-widget.php?rev=3078746#L59) |  |
  | 59 | 59 |  |
  | 60 | 60 | wppa\_echo( $result ); |
  | 61 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title~~ ); |
  |  | 61 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title ) ); |
  | 62 | 62 |  |
  | 63 | 63 | // Cache? |
* ## [wp-photo-album-plus/trunk/wppa-tagcloud-widget.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-tagcloud-widget.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-tagcloud-widget.php")

  | [r2938690](/browser/wp-photo-album-plus/trunk/wppa-tagcloud-widget.php?rev=2938690#L4 "Show revision 2938690 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-tagcloud-widget.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* display the tagcloud widget |
  | 6 |  | \* Version 8.~~4.03~~.002 |
  |  | 6 | \* Version 8.7.02.002 |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-tagcloud-widget.php?rev=2938690#L37) | […](/browser/wp-photo-album-plus/trunk/wppa-tagcloud-widget.php?rev=3078746#L37) |  |
  | 37 | 37 | // Cache? |
  | 38 | 38 | if ( $cache && wppa\_is\_file( $cachefile ) ) { |
  | 39 |  | ~~echo wppa\_get\_contents( $cachefile~~ ); |
  |  | 39 | wppa\_echo( wppa\_get\_contents( $cachefile ) ); |
  | 40 | 40 | wppa\_update\_option( 'wppa\_cache\_hits', wppa\_get\_option( 'wppa\_cache\_hits', 0 ) +1 ); |
  | 41 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title, true~~ ); |
  |  | 41 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title, true ) ); |
  | 42 | 42 | wppa( 'in\_widget', false ); |
  | 43 | 43 | return; |
  | […](/browser/wp-photo-album-plus/trunk/wppa-tagcloud-widget.php?rev=2938690#L65) | […](/browser/wp-photo-album-plus/trunk/wppa-tagcloud-widget.php?rev=3078746#L65) |  |
  | 65 | 65 |  |
  | 66 | 66 | wppa\_echo( $result ); |
  | 67 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title~~ ); |
  |  | 67 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title ) ); |
  | 68 | 68 |  |
  | 69 | 69 | // Cache? |
* ## [wp-photo-album-plus/trunk/wppa-thumbnail-widget.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-thumbnail-widget.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-thumbnail-widget.php")

  | [r2938690](/browser/wp-photo-album-plus/trunk/wppa-thumbnail-widget.php?rev=2938690#L4 "Show revision 2938690 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-thumbnail-widget.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* display thumbnail photos |
  | 6 |  | \* Version 8.~~4.03~~.002 |
  |  | 6 | \* Version 8.7.02.002 |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-thumbnail-widget.php?rev=2938690#L38) | […](/browser/wp-photo-album-plus/trunk/wppa-thumbnail-widget.php?rev=3078746#L38) |  |
  | 38 | 38 | // Cache? |
  | 39 | 39 | if ( $cache && wppa\_is\_file( $cachefile ) ) { |
  | 40 |  | ~~echo wppa\_get\_contents( $cachefile~~ ); |
  |  | 40 | wppa\_echo( wppa\_get\_contents( $cachefile ) ); |
  | 41 | 41 | wppa\_update\_option( 'wppa\_cache\_hits', wppa\_get\_option( 'wppa\_cache\_hits', 0 ) +1 ); |
  | 42 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title, true~~ ); |
  |  | 42 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title, true ) ); |
  | 43 | 43 | wppa( 'in\_widget', false ); |
  | 44 | 44 | return; |
  | […](/browser/wp-photo-album-plus/trunk/wppa-thumbnail-widget.php?rev=2938690#L157) | […](/browser/wp-photo-album-plus/trunk/wppa-thumbnail-widget.php?rev=3078746#L157) |  |
  | 157 | 157 |  |
  | 158 | 158 | wppa\_echo( $result ); |
  | 159 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title~~ ); |
  |  | 159 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title ) ); |
  | 160 | 160 |  |
  | 161 | 161 | // Cache? |
* ## [wp-photo-album-plus/trunk/wppa-topten-widget.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-topten-widget.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-topten-widget.php")

  | [r2938690](/browser/wp-photo-album-plus/trunk/wppa-topten-widget.php?rev=2938690#L4 "Show revision 2938690 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-topten-widget.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* display the top rated photos |
  | 6 |  | \* Version 8.~~4.03~~.002 |
  |  | 6 | \* Version 8.7.02.002 |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-topten-widget.php?rev=2938690#L52) | […](/browser/wp-photo-album-plus/trunk/wppa-topten-widget.php?rev=3078746#L52) |  |
  | 52 | 52 | // Cache? |
  | 53 | 53 | if ( $cache && wppa\_is\_file( $cachefile ) ) { |
  | 54 |  | ~~echo wppa\_get\_contents( $cachefile~~ ); |
  |  | 54 | wppa\_echo( wppa\_get\_contents( $cachefile ) ); |
  | 55 | 55 | wppa\_update\_option( 'wppa\_cache\_hits', wppa\_get\_option( 'wppa\_cache\_hits', 0 ) +1 ); |
  | 56 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title, true~~ ); |
  |  | 56 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title, true ) ); |
  | 57 | 57 | wppa( 'in\_widget', false ); |
  | 58 | 58 | return; |
  | […](/browser/wp-photo-album-plus/trunk/wppa-topten-widget.php?rev=2938690#L511) | […](/browser/wp-photo-album-plus/trunk/wppa-topten-widget.php?rev=3078746#L511) |  |
  | 511 | 511 |  |
  | 512 | 512 | wppa\_echo( $result ); |
  | 513 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title~~ ); |
  |  | 513 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title ) ); |
  | 514 | 514 |  |
  | 515 | 515 | // Cache? |
* ## [wp-photo-album-plus/trunk/wppa-upldr-widget.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa-upldr-widget.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa-upldr-widget.php")

  | [r3044124](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3044124#L4 "Show revision 3044124 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3078746#L4 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* display a list of users linking to their photos |
  | 6 |  | \* Version 8.~~6.04.005~~ |
  |  | 6 | \* Version 8.7.02.002 |
  | 7 | 7 | \*/ |
  | 8 | 8 |  |
  | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3044124#L108) | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3078746#L108) |  |
  | 108 | 108 | } |
  | 109 | 109 | else { |
  | 110 |  | $widget\_content = |
  | 111 |  | \_\_( 'There are too many registered users in the system for this widget' , 'wp-photo-album-plus' ); |
  | 112 |  | echo "\n" . $before\_widget; |
  | 113 |  | if ( !empty( $widget\_title ) ) { echo $before\_title . $widget\_title . $after\_title; } |
  | 114 |  | echo $widget\_content . $after\_widget; |
  |  | 110 | $result = $before\_widget; |
  |  | 111 | if ( ! empty( $widget\_title ) ) { |
  |  | 112 | $result .= $before\_title . $widget\_title . $after\_title; |
  |  | 113 | } |
  |  | 114 | $result .= $widget\_content . $after\_widget; |
  |  | 115 | wppa\_echo( $result ); |
  | 115 | 116 | return; |
  | 116 | 117 | } |
  | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3044124#L169) | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3078746#L170) |  |
  | 169 | 170 |  |
  | 170 | 171 | // Output |
  | 171 |  | $result = ~~"\n" .~~ $before\_widget; |
  |  | 172 | $result = $before\_widget; |
  | 172 | 173 | if ( ! empty( $widget\_title ) ) { |
  | 173 | 174 | $result .= $before\_title . $widget\_title . $after\_title; |
  | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3044124#L176) | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3078746#L177) |  |
  | 176 | 177 |  |
  | 177 | 178 | wppa\_echo( $result ); |
  | 178 |  | ~~echo wppa\_widget\_timer( 'show', $widget\_title~~ ); |
  |  | 179 | wppa\_echo( wppa\_widget\_timer( 'show', $widget\_title ) ); |
  | 179 | 180 |  |
  | 180 | 181 | wppa( 'in\_widget', false ); |
  | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3044124#L227) | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3078746#L228) |  |
  | 227 | 228 | \_\_( 'Enter loginnames seperated by commas', 'wp-photo-album-plus' ) |
  | 228 | 229 | ); |
  | 229 |  | ?> |
  | 230 |  |  |
  | 231 |  |  |
  | 232 |  | <p><label for="<?php echo $this->get\_field\_id('parent'); ?>"><?php \_e('Look only in albums (including sub albums):', 'wp-photo-album-plus' ); ?></label> |
  | 233 |  | <input type="hidden" id="<?php echo $this->get\_field\_id('parent'); ?>" name="<?php echo $this->get\_field\_name('parent'); ?>" value="<?php echo $instance['parent'] ?>" /> |
  | 234 |  | <?php if ( $instance['parent'] ) echo '<br/><small>( '.$instance['parent'].' )</small>' ?> |
  | 235 |  | <select class="widefat" multiple onchange="wppaGetSelEnumToId( 'parentalbums-<?php echo $this->get\_widget\_id() ?>', '<?php echo $this->get\_field\_id('parent') ?>' )" id="<?php echo $this->get\_field\_id('parent-list'); ?>" name="<?php echo $this->get\_field\_name('parent-list'); ?>" > |
  | 236 |  | <?php |
  |  | 230 |  |
  |  | 231 | $result = ' |
  |  | 232 | <p> |
  |  | 233 | <label for="' . $this->get\_field\_id('parent') . '">' . esc\_html( 'Look only in albums (including sub albums):', 'wp-photo-album-plus' ) . '</label> |
  |  | 234 | <input type="hidden" id="' . $this->get\_field\_id('parent') . '" name="' . $this->get\_field\_name('parent') . '" value="' . $instance['parent'] . '">'; |
  |  | 235 | if ( $instance['parent'] ) $result .= '<br/><small>( ' . $instance['parent'] . ' )</small>'; |
  |  | 236 | $result .= ' |
  |  | 237 | <select |
  |  | 238 | class="widefat" |
  |  | 239 | multiple |
  |  | 240 | onchange="wppaGetSelEnumToId( \'parentalbums-' . $this->get\_widget\_id() . '\', \'' . $this->get\_field\_id('parent') . '\' )" |
  |  | 241 | id="' . $this->get\_field\_id('parent-list') . '" name="' . $this->get\_field\_name('parent-list') . '" |
  |  | 242 | >'; |
  |  | 243 |  |
  | 237 | 244 | // Prepare albuminfo |
  | 238 | 245 | if ( wppa\_has\_many\_albums() ) { |
  | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3044124#L249) | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3078746#L256) |  |
  | 249 | 256 | // Please select |
  | 250 | 257 | $sel = $instance['parent'] ? '' : 'selected '; |
  | 251 |  | ~~echo '<option class="parentalbums-'.$this->get\_widget\_id().'" value="" '.$sel.'>-- '.~~\_\_('All albums', 'wp-photo-album-plus' ).' --</option>'; |
  |  | 258 | $result .= '<option class="parentalbums-'.$this->get\_widget\_id().'" value="" '.$sel.'>-- '.esc\_html\_\_('All albums', 'wp-photo-album-plus' ).' --</option>'; |
  | 252 | 259 |  |
  | 253 | 260 | // Find the albums currently selected |
  | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3044124#L258) | […](/browser/wp-photo-album-plus/trunk/wppa-upldr-widget.php?rev=3078746#L265) |  |
  | 258 | 265 | $s = in\_array( $album['id'], $selalbs ); |
  | 259 | 266 | $sel = $s ? 'selected ' : ''; |
  | 260 |  | ~~echo '<option class="parentalbums-'.$this->get\_widget\_id().'" value="' . esc\_attr( $album['id'] ) . '" '.$sel.'>'.stripslashes( \_\_( $album['name'] , 'wp-photo-album-plus' )~~ ) . ' (' . $album['id'] . ')</option>'; |
  | 261 |  | } |
  | 262 |  | ~~?>~~ |
  |  | 267 | $result .= '<option class="parentalbums-'.$this->get\_widget\_id().'" value="' . esc\_attr( $album['id'] ) . '" '.$sel.'>'. esc\_html\_\_( $album['name'] , 'wp-photo-album-plus' ) . ' (' . $album['id'] . ')</option>'; |
  |  | 268 | } |
  |  | 269 | $result .= ' |
  | 263 | 270 | </select> |
  | 264 |  | </p> |
  | 265 |  | <?php |
  |  | 271 | </p>'; |
  |  | 272 | wppa\_echo( $result ); |
  |  | 273 |  |
  | 266 | 274 | // Ownercount |
  | 267 | 275 | wppa\_widget\_checkbox( $this, 'showownercount', $instance['showownercount'], \_\_( 'Show count of owners', 'wp-photo-album-plus' ) ); |
* ## [wp-photo-album-plus/trunk/wppa.php](/changeset/3078746/wp-photo-album-plus/trunk/wppa.php "Show the changeset 3078746 restricted to wp-photo-album-plus/trunk/wppa.php")

  | [r3077580](/browser/wp-photo-album-plus/trunk/wppa.php?rev=3077580#L3 "Show revision 3077580 of this file in browser") | [r3078746](/browser/wp-photo-album-plus/trunk/wppa.php?rev=3078746#L3 "Show revision 3078746 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* Plugin Name: WP Photo Album Plus |
  | 4 | 4 | \* Description: Easily manage and display your photo albums and slideshows within your WordPress site. |
  | 5 |  | \* Version: 8.7.02.00~~1~~ |
  |  | 5 | \* Version: 8.7.02.002 |
  | 6 | 6 | \* Author: J.N. Breetvelt a.k.a. OpaJaap |
  | 7 | 7 | \* Author URI: http://wppa.opajaap.nl/ |
  | […](/browser/wp-photo-album-plus/trunk/wppa.php?rev=3077580#L24) | […](/browser/wp-photo-album-plus/trunk/wppa.php?rev=3078746#L24) |  |
  | 24 | 24 |  |
  | 25 | 25 | /\* WPPA Version \*/ |
  | 26 |  | global $wppa\_version;       $wppa\_version = '8.7.02.00~~1~~';                           // WPPA software version |
  |  | 26 | global $wppa\_version;       $wppa\_version = '8.7.02.002';                           // WPPA software version |
  | 27 | 27 | global $wppa\_revno;         $wppa\_revno = str\_replace( '.', '', $wppa\_version );    // WPPA db version |
  | 28 | 28 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3078746)
* [Zip Archive](?format=zip&new=3078746)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

